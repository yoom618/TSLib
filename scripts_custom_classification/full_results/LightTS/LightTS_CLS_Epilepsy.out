Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm512_cs103_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.767961025238037
Epoch: 1, Steps: 9 | Train Loss: 1.370 Vali Loss: 1.335 Vali Acc: 0.261 Test Loss: 1.335 Test Acc: 0.261
Validation loss decreased (inf --> -0.260856).  Saving model ...
Epoch: 2 cost time: 0.5433049201965332
Epoch: 2, Steps: 9 | Train Loss: 1.288 Vali Loss: 1.265 Vali Acc: 0.391 Test Loss: 1.265 Test Acc: 0.391
Validation loss decreased (-0.260856 --> -0.391292).  Saving model ...
Epoch: 3 cost time: 0.5896756649017334
Epoch: 3, Steps: 9 | Train Loss: 1.203 Vali Loss: 1.192 Vali Acc: 0.428 Test Loss: 1.192 Test Acc: 0.428
Validation loss decreased (-0.391292 --> -0.427524).  Saving model ...
Epoch: 4 cost time: 0.6954848766326904
Epoch: 4, Steps: 9 | Train Loss: 1.103 Vali Loss: 1.135 Vali Acc: 0.464 Test Loss: 1.135 Test Acc: 0.464
Validation loss decreased (-0.427524 --> -0.463757).  Saving model ...
Epoch: 5 cost time: 0.5500736236572266
Epoch: 5, Steps: 9 | Train Loss: 1.006 Vali Loss: 1.097 Vali Acc: 0.529 Test Loss: 1.097 Test Acc: 0.529
Validation loss decreased (-0.463757 --> -0.528975).  Saving model ...
Epoch: 6 cost time: 0.6051955223083496
Epoch: 6, Steps: 9 | Train Loss: 0.924 Vali Loss: 1.066 Vali Acc: 0.500 Test Loss: 1.066 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5984203815460205
Epoch: 7, Steps: 9 | Train Loss: 0.863 Vali Loss: 1.049 Vali Acc: 0.486 Test Loss: 1.049 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6279942989349365
Epoch: 8, Steps: 9 | Train Loss: 0.812 Vali Loss: 1.025 Vali Acc: 0.486 Test Loss: 1.025 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.5590388774871826
Epoch: 9, Steps: 9 | Train Loss: 0.754 Vali Loss: 1.014 Vali Acc: 0.529 Test Loss: 1.014 Test Acc: 0.529
Validation loss decreased (-0.528975 --> -0.528975).  Saving model ...
Epoch: 10 cost time: 0.6347990036010742
Epoch: 10, Steps: 9 | Train Loss: 0.688 Vali Loss: 1.001 Vali Acc: 0.543 Test Loss: 1.001 Test Acc: 0.543
Validation loss decreased (-0.528975 --> -0.543468).  Saving model ...
Epoch: 11 cost time: 0.6046755313873291
Epoch: 11, Steps: 9 | Train Loss: 0.646 Vali Loss: 0.990 Vali Acc: 0.580 Test Loss: 0.990 Test Acc: 0.580
Validation loss decreased (-0.543468 --> -0.579700).  Saving model ...
Epoch: 12 cost time: 0.5990824699401855
Epoch: 12, Steps: 9 | Train Loss: 0.582 Vali Loss: 0.965 Vali Acc: 0.594 Test Loss: 0.965 Test Acc: 0.594
Validation loss decreased (-0.579700 --> -0.594193).  Saving model ...
Epoch: 13 cost time: 0.5784623622894287
Epoch: 13, Steps: 9 | Train Loss: 0.503 Vali Loss: 0.945 Vali Acc: 0.616 Test Loss: 0.945 Test Acc: 0.616
Validation loss decreased (-0.594193 --> -0.615933).  Saving model ...
Epoch: 14 cost time: 0.5886240005493164
Epoch: 14, Steps: 9 | Train Loss: 0.454 Vali Loss: 0.956 Vali Acc: 0.638 Test Loss: 0.956 Test Acc: 0.638
Validation loss decreased (-0.615933 --> -0.637672).  Saving model ...
Epoch: 15 cost time: 0.567596435546875
Epoch: 15, Steps: 9 | Train Loss: 0.355 Vali Loss: 0.970 Vali Acc: 0.645 Test Loss: 0.970 Test Acc: 0.645
Validation loss decreased (-0.637672 --> -0.644918).  Saving model ...
Epoch: 16 cost time: 0.6029336452484131
Epoch: 16, Steps: 9 | Train Loss: 0.278 Vali Loss: 0.932 Vali Acc: 0.659 Test Loss: 0.932 Test Acc: 0.659
Validation loss decreased (-0.644918 --> -0.659411).  Saving model ...
Epoch: 17 cost time: 0.5428521633148193
Epoch: 17, Steps: 9 | Train Loss: 0.193 Vali Loss: 1.035 Vali Acc: 0.638 Test Loss: 1.035 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.4957115650177002
Epoch: 18, Steps: 9 | Train Loss: 0.135 Vali Loss: 0.948 Vali Acc: 0.667 Test Loss: 0.948 Test Acc: 0.667
Validation loss decreased (-0.659411 --> -0.666657).  Saving model ...
Epoch: 19 cost time: 0.4892294406890869
Epoch: 19, Steps: 9 | Train Loss: 0.097 Vali Loss: 0.983 Vali Acc: 0.681 Test Loss: 0.983 Test Acc: 0.681
Validation loss decreased (-0.666657 --> -0.681150).  Saving model ...
Epoch: 20 cost time: 0.5449538230895996
Epoch: 20, Steps: 9 | Train Loss: 0.072 Vali Loss: 1.069 Vali Acc: 0.688 Test Loss: 1.069 Test Acc: 0.688
Validation loss decreased (-0.681150 --> -0.688395).  Saving model ...
Epoch: 21 cost time: 0.5009393692016602
Epoch: 21, Steps: 9 | Train Loss: 0.048 Vali Loss: 1.116 Vali Acc: 0.710 Test Loss: 1.116 Test Acc: 0.710
Validation loss decreased (-0.688395 --> -0.710134).  Saving model ...
Epoch: 22 cost time: 0.5994429588317871
Epoch: 22, Steps: 9 | Train Loss: 0.035 Vali Loss: 1.222 Vali Acc: 0.696 Test Loss: 1.222 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.534069299697876
Epoch: 23, Steps: 9 | Train Loss: 0.025 Vali Loss: 1.269 Vali Acc: 0.696 Test Loss: 1.269 Test Acc: 0.696
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.509044885635376
Epoch: 24, Steps: 9 | Train Loss: 0.019 Vali Loss: 1.319 Vali Acc: 0.696 Test Loss: 1.319 Test Acc: 0.696
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.6764249801635742
Epoch: 25, Steps: 9 | Train Loss: 0.014 Vali Loss: 1.362 Vali Acc: 0.710 Test Loss: 1.362 Test Acc: 0.710
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.5225975513458252
Epoch: 26, Steps: 9 | Train Loss: 0.011 Vali Loss: 1.456 Vali Acc: 0.688 Test Loss: 1.456 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.7611649036407471
Epoch: 27, Steps: 9 | Train Loss: 0.009 Vali Loss: 1.531 Vali Acc: 0.688 Test Loss: 1.531 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.585463285446167
Epoch: 28, Steps: 9 | Train Loss: 0.007 Vali Loss: 1.529 Vali Acc: 0.681 Test Loss: 1.529 Test Acc: 0.681
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.5443646907806396
Epoch: 29, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.584 Vali Acc: 0.681 Test Loss: 1.584 Test Acc: 0.681
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.5784268379211426
Epoch: 30, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.619 Vali Acc: 0.681 Test Loss: 1.619 Test Acc: 0.681
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.5987293720245361
Epoch: 31, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.630 Vali Acc: 0.681 Test Loss: 1.630 Test Acc: 0.681
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm512_cs103_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.7101449275362319
model parameter : 184106
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm512_cs69_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.5866742134094238
Epoch: 1, Steps: 9 | Train Loss: 1.372 Vali Loss: 1.411 Vali Acc: 0.246 Test Loss: 1.411 Test Acc: 0.246
Validation loss decreased (inf --> -0.246363).  Saving model ...
Epoch: 2 cost time: 0.553717851638794
Epoch: 2, Steps: 9 | Train Loss: 1.311 Vali Loss: 1.326 Vali Acc: 0.312 Test Loss: 1.326 Test Acc: 0.312
Validation loss decreased (-0.246363 --> -0.311581).  Saving model ...
Epoch: 3 cost time: 0.7096600532531738
Epoch: 3, Steps: 9 | Train Loss: 1.210 Vali Loss: 1.229 Vali Acc: 0.442 Test Loss: 1.229 Test Acc: 0.442
Validation loss decreased (-0.311581 --> -0.442017).  Saving model ...
Epoch: 4 cost time: 0.596621036529541
Epoch: 4, Steps: 9 | Train Loss: 1.095 Vali Loss: 1.159 Vali Acc: 0.457 Test Loss: 1.159 Test Acc: 0.457
Validation loss decreased (-0.442017 --> -0.456510).  Saving model ...
Epoch: 5 cost time: 0.5926859378814697
Epoch: 5, Steps: 9 | Train Loss: 1.013 Vali Loss: 1.104 Vali Acc: 0.486 Test Loss: 1.104 Test Acc: 0.486
Validation loss decreased (-0.456510 --> -0.485496).  Saving model ...
Epoch: 6 cost time: 0.5317702293395996
Epoch: 6, Steps: 9 | Train Loss: 0.928 Vali Loss: 1.067 Vali Acc: 0.543 Test Loss: 1.067 Test Acc: 0.543
Validation loss decreased (-0.485496 --> -0.543468).  Saving model ...
Epoch: 7 cost time: 0.698573112487793
Epoch: 7, Steps: 9 | Train Loss: 0.855 Vali Loss: 1.022 Vali Acc: 0.536 Test Loss: 1.022 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6007745265960693
Epoch: 8, Steps: 9 | Train Loss: 0.771 Vali Loss: 0.964 Vali Acc: 0.616 Test Loss: 0.964 Test Acc: 0.616
Validation loss decreased (-0.543468 --> -0.615932).  Saving model ...
Epoch: 9 cost time: 0.5697300434112549
Epoch: 9, Steps: 9 | Train Loss: 0.682 Vali Loss: 0.889 Vali Acc: 0.645 Test Loss: 0.889 Test Acc: 0.645
Validation loss decreased (-0.615932 --> -0.644919).  Saving model ...
Epoch: 10 cost time: 0.7612078189849854
Epoch: 10, Steps: 9 | Train Loss: 0.570 Vali Loss: 0.770 Vali Acc: 0.688 Test Loss: 0.770 Test Acc: 0.688
Validation loss decreased (-0.644919 --> -0.688398).  Saving model ...
Epoch: 11 cost time: 0.7574608325958252
Epoch: 11, Steps: 9 | Train Loss: 0.417 Vali Loss: 0.608 Vali Acc: 0.775 Test Loss: 0.608 Test Acc: 0.775
Validation loss decreased (-0.688398 --> -0.775356).  Saving model ...
Epoch: 12 cost time: 0.5916991233825684
Epoch: 12, Steps: 9 | Train Loss: 0.267 Vali Loss: 0.487 Vali Acc: 0.841 Test Loss: 0.487 Test Acc: 0.841
Validation loss decreased (-0.775356 --> -0.840575).  Saving model ...
Epoch: 13 cost time: 0.6667859554290771
Epoch: 13, Steps: 9 | Train Loss: 0.177 Vali Loss: 0.447 Vali Acc: 0.848 Test Loss: 0.447 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847822).  Saving model ...
Epoch: 14 cost time: 0.6290910243988037
Epoch: 14, Steps: 9 | Train Loss: 0.128 Vali Loss: 0.436 Vali Acc: 0.848 Test Loss: 0.436 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 15 cost time: 0.5609233379364014
Epoch: 15, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.350 Vali Acc: 0.855 Test Loss: 0.350 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855069).  Saving model ...
Epoch: 16 cost time: 0.6303451061248779
Epoch: 16, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.366 Vali Acc: 0.884 Test Loss: 0.366 Test Acc: 0.884
Validation loss decreased (-0.855069 --> -0.884054).  Saving model ...
Epoch: 17 cost time: 0.7745072841644287
Epoch: 17, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.418 Vali Acc: 0.841 Test Loss: 0.418 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5905797481536865
Epoch: 18, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.345 Vali Acc: 0.891 Test Loss: 0.345 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891301).  Saving model ...
Epoch: 19 cost time: 0.6490378379821777
Epoch: 19, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.355 Vali Acc: 0.891 Test Loss: 0.355 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5744984149932861
Epoch: 20, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.429 Vali Acc: 0.884 Test Loss: 0.429 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6183731555938721
Epoch: 21, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.410 Vali Acc: 0.891 Test Loss: 0.410 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6561465263366699
Epoch: 22, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.400 Vali Acc: 0.899 Test Loss: 0.400 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898547).  Saving model ...
Epoch: 23 cost time: 0.6224300861358643
Epoch: 23, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.382 Vali Acc: 0.891 Test Loss: 0.382 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6532483100891113
Epoch: 24, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.392 Vali Acc: 0.899 Test Loss: 0.392 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 25 cost time: 0.7091717720031738
Epoch: 25, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.416 Vali Acc: 0.899 Test Loss: 0.416 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5990095138549805
Epoch: 26, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.436 Vali Acc: 0.884 Test Loss: 0.436 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.798781156539917
Epoch: 27, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.425 Vali Acc: 0.884 Test Loss: 0.425 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.7004663944244385
Epoch: 28, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.402 Vali Acc: 0.899 Test Loss: 0.402 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.7004055976867676
Epoch: 29, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.410 Vali Acc: 0.899 Test Loss: 0.410 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.7851836681365967
Epoch: 30, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.437 Vali Acc: 0.891 Test Loss: 0.437 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.5719082355499268
Epoch: 31, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.437 Vali Acc: 0.884 Test Loss: 0.437 Test Acc: 0.884
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.6797747611999512
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.430 Vali Acc: 0.891 Test Loss: 0.430 Test Acc: 0.891
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.6262989044189453
Epoch: 33, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.426 Vali Acc: 0.891 Test Loss: 0.426 Test Acc: 0.891
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.6957054138183594
Epoch: 34, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.431 Vali Acc: 0.891 Test Loss: 0.431 Test Acc: 0.891
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm512_cs69_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 175622
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm512_cs52_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.9244627952575684
Epoch: 1, Steps: 9 | Train Loss: 1.387 Vali Loss: 1.348 Vali Acc: 0.391 Test Loss: 1.348 Test Acc: 0.391
Validation loss decreased (inf --> -0.391291).  Saving model ...
Epoch: 2 cost time: 0.7623295783996582
Epoch: 2, Steps: 9 | Train Loss: 1.307 Vali Loss: 1.258 Vali Acc: 0.435 Test Loss: 1.258 Test Acc: 0.435
Validation loss decreased (-0.391291 --> -0.434770).  Saving model ...
Epoch: 3 cost time: 0.6612286567687988
Epoch: 3, Steps: 9 | Train Loss: 1.196 Vali Loss: 1.167 Vali Acc: 0.471 Test Loss: 1.167 Test Acc: 0.471
Validation loss decreased (-0.434770 --> -0.471003).  Saving model ...
Epoch: 4 cost time: 0.5582709312438965
Epoch: 4, Steps: 9 | Train Loss: 1.074 Vali Loss: 1.083 Vali Acc: 0.551 Test Loss: 1.083 Test Acc: 0.551
Validation loss decreased (-0.471003 --> -0.550714).  Saving model ...
Epoch: 5 cost time: 0.5746548175811768
Epoch: 5, Steps: 9 | Train Loss: 0.974 Vali Loss: 1.012 Vali Acc: 0.587 Test Loss: 1.012 Test Acc: 0.587
Validation loss decreased (-0.550714 --> -0.586946).  Saving model ...
Epoch: 6 cost time: 0.5811316967010498
Epoch: 6, Steps: 9 | Train Loss: 0.874 Vali Loss: 0.939 Vali Acc: 0.601 Test Loss: 0.939 Test Acc: 0.601
Validation loss decreased (-0.586946 --> -0.601440).  Saving model ...
Epoch: 7 cost time: 0.5274176597595215
Epoch: 7, Steps: 9 | Train Loss: 0.753 Vali Loss: 0.822 Vali Acc: 0.717 Test Loss: 0.822 Test Acc: 0.717
Validation loss decreased (-0.601440 --> -0.717383).  Saving model ...
Epoch: 8 cost time: 0.6386749744415283
Epoch: 8, Steps: 9 | Train Loss: 0.605 Vali Loss: 0.672 Vali Acc: 0.775 Test Loss: 0.672 Test Acc: 0.775
Validation loss decreased (-0.717383 --> -0.775356).  Saving model ...
Epoch: 9 cost time: 0.6462557315826416
Epoch: 9, Steps: 9 | Train Loss: 0.447 Vali Loss: 0.518 Vali Acc: 0.826 Test Loss: 0.518 Test Acc: 0.826
Validation loss decreased (-0.775356 --> -0.826082).  Saving model ...
Epoch: 10 cost time: 0.712571382522583
Epoch: 10, Steps: 9 | Train Loss: 0.295 Vali Loss: 0.414 Vali Acc: 0.855 Test Loss: 0.414 Test Acc: 0.855
Validation loss decreased (-0.826082 --> -0.855068).  Saving model ...
Epoch: 11 cost time: 0.5256540775299072
Epoch: 11, Steps: 9 | Train Loss: 0.196 Vali Loss: 0.374 Vali Acc: 0.870 Test Loss: 0.374 Test Acc: 0.870
Validation loss decreased (-0.855068 --> -0.869561).  Saving model ...
Epoch: 12 cost time: 0.605562686920166
Epoch: 12, Steps: 9 | Train Loss: 0.136 Vali Loss: 0.333 Vali Acc: 0.884 Test Loss: 0.333 Test Acc: 0.884
Validation loss decreased (-0.869561 --> -0.884055).  Saving model ...
Epoch: 13 cost time: 0.5981614589691162
Epoch: 13, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.310 Vali Acc: 0.899 Test Loss: 0.310 Test Acc: 0.899
Validation loss decreased (-0.884055 --> -0.898548).  Saving model ...
Epoch: 14 cost time: 0.5322151184082031
Epoch: 14, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.282 Vali Acc: 0.913 Test Loss: 0.282 Test Acc: 0.913
Validation loss decreased (-0.898548 --> -0.913041).  Saving model ...
Epoch: 15 cost time: 0.5976383686065674
Epoch: 15, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.307 Vali Acc: 0.906 Test Loss: 0.307 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7124085426330566
Epoch: 16, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.314 Vali Acc: 0.913 Test Loss: 0.314 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6943542957305908
Epoch: 17, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.277 Vali Acc: 0.928 Test Loss: 0.277 Test Acc: 0.928
Validation loss decreased (-0.913041 --> -0.927533).  Saving model ...
Epoch: 18 cost time: 0.6352024078369141
Epoch: 18, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.317 Vali Acc: 0.913 Test Loss: 0.317 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6571934223175049
Epoch: 19, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.342 Vali Acc: 0.913 Test Loss: 0.342 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.681344747543335
Epoch: 20, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.338 Vali Acc: 0.913 Test Loss: 0.338 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6455655097961426
Epoch: 21, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.338 Vali Acc: 0.920 Test Loss: 0.338 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7394137382507324
Epoch: 22, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.343 Vali Acc: 0.928 Test Loss: 0.343 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.6539449691772461
Epoch: 23, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.361 Vali Acc: 0.920 Test Loss: 0.361 Test Acc: 0.920
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.6544795036315918
Epoch: 24, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.380 Vali Acc: 0.920 Test Loss: 0.380 Test Acc: 0.920
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.6330499649047852
Epoch: 25, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.386 Vali Acc: 0.920 Test Loss: 0.386 Test Acc: 0.920
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.708045244216919
Epoch: 26, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.379 Vali Acc: 0.920 Test Loss: 0.379 Test Acc: 0.920
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.6542432308197021
Epoch: 27, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.392 Vali Acc: 0.913 Test Loss: 0.392 Test Acc: 0.913
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm512_cs52_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.927536231884058
model parameter : 171494
model size : 0.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm512_cs42_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.8248686790466309
Epoch: 1, Steps: 9 | Train Loss: 1.390 Vali Loss: 1.356 Vali Acc: 0.406 Test Loss: 1.356 Test Acc: 0.406
Validation loss decreased (inf --> -0.405784).  Saving model ...
Epoch: 2 cost time: 0.5256633758544922
Epoch: 2, Steps: 9 | Train Loss: 1.306 Vali Loss: 1.271 Vali Acc: 0.507 Test Loss: 1.271 Test Acc: 0.507
Validation loss decreased (-0.405784 --> -0.507234).  Saving model ...
Epoch: 3 cost time: 0.5056004524230957
Epoch: 3, Steps: 9 | Train Loss: 1.191 Vali Loss: 1.168 Vali Acc: 0.514 Test Loss: 1.168 Test Acc: 0.514
Validation loss decreased (-0.507234 --> -0.514481).  Saving model ...
Epoch: 4 cost time: 0.6571309566497803
Epoch: 4, Steps: 9 | Train Loss: 1.079 Vali Loss: 1.094 Vali Acc: 0.478 Test Loss: 1.094 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5499308109283447
Epoch: 5, Steps: 9 | Train Loss: 0.972 Vali Loss: 1.033 Vali Acc: 0.565 Test Loss: 1.033 Test Acc: 0.565
Validation loss decreased (-0.514481 --> -0.565207).  Saving model ...
Epoch: 6 cost time: 0.5249929428100586
Epoch: 6, Steps: 9 | Train Loss: 0.872 Vali Loss: 0.952 Vali Acc: 0.616 Test Loss: 0.952 Test Acc: 0.616
Validation loss decreased (-0.565207 --> -0.615933).  Saving model ...
Epoch: 7 cost time: 0.5789680480957031
Epoch: 7, Steps: 9 | Train Loss: 0.757 Vali Loss: 0.836 Vali Acc: 0.717 Test Loss: 0.836 Test Acc: 0.717
Validation loss decreased (-0.615933 --> -0.717383).  Saving model ...
Epoch: 8 cost time: 0.6533908843994141
Epoch: 8, Steps: 9 | Train Loss: 0.619 Vali Loss: 0.676 Vali Acc: 0.797 Test Loss: 0.676 Test Acc: 0.797
Validation loss decreased (-0.717383 --> -0.797095).  Saving model ...
Epoch: 9 cost time: 0.5980722904205322
Epoch: 9, Steps: 9 | Train Loss: 0.437 Vali Loss: 0.490 Vali Acc: 0.833 Test Loss: 0.490 Test Acc: 0.833
Validation loss decreased (-0.797095 --> -0.833328).  Saving model ...
Epoch: 10 cost time: 0.5204179286956787
Epoch: 10, Steps: 9 | Train Loss: 0.283 Vali Loss: 0.368 Vali Acc: 0.877 Test Loss: 0.368 Test Acc: 0.877
Validation loss decreased (-0.833328 --> -0.876808).  Saving model ...
Epoch: 11 cost time: 0.5427539348602295
Epoch: 11, Steps: 9 | Train Loss: 0.182 Vali Loss: 0.321 Vali Acc: 0.899 Test Loss: 0.321 Test Acc: 0.899
Validation loss decreased (-0.876808 --> -0.898548).  Saving model ...
Epoch: 12 cost time: 0.7727265357971191
Epoch: 12, Steps: 9 | Train Loss: 0.108 Vali Loss: 0.266 Vali Acc: 0.913 Test Loss: 0.266 Test Acc: 0.913
Validation loss decreased (-0.898548 --> -0.913041).  Saving model ...
Epoch: 13 cost time: 0.5707995891571045
Epoch: 13, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.258 Vali Acc: 0.913 Test Loss: 0.258 Test Acc: 0.913
Validation loss decreased (-0.913041 --> -0.913041).  Saving model ...
Epoch: 14 cost time: 0.5771138668060303
Epoch: 14, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.327 Vali Acc: 0.891 Test Loss: 0.327 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6529603004455566
Epoch: 15, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.333 Vali Acc: 0.906 Test Loss: 0.333 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7381925582885742
Epoch: 16, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.266 Vali Acc: 0.928 Test Loss: 0.266 Test Acc: 0.928
Validation loss decreased (-0.913041 --> -0.927534).  Saving model ...
Epoch: 17 cost time: 0.7124218940734863
Epoch: 17, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.270 Vali Acc: 0.928 Test Loss: 0.270 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6251747608184814
Epoch: 18, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.311 Vali Acc: 0.920 Test Loss: 0.311 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6045088768005371
Epoch: 19, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.318 Vali Acc: 0.920 Test Loss: 0.318 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7319812774658203
Epoch: 20, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.289 Vali Acc: 0.920 Test Loss: 0.289 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.6626980304718018
Epoch: 21, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.300 Vali Acc: 0.920 Test Loss: 0.300 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8536086082458496
Epoch: 22, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.327 Vali Acc: 0.920 Test Loss: 0.327 Test Acc: 0.920
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.7485387325286865
Epoch: 23, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.321 Vali Acc: 0.920 Test Loss: 0.321 Test Acc: 0.920
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.7056300640106201
Epoch: 24, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.330 Vali Acc: 0.920 Test Loss: 0.330 Test Acc: 0.920
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.777130126953125
Epoch: 25, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.331 Vali Acc: 0.920 Test Loss: 0.331 Test Acc: 0.920
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.6284160614013672
Epoch: 26, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.334 Vali Acc: 0.920 Test Loss: 0.334 Test Acc: 0.920
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm512_cs42_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.927536231884058
model parameter : 169368
model size : 0.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm512_cs35_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.9508841037750244
Epoch: 1, Steps: 9 | Train Loss: 1.432 Vali Loss: 1.416 Vali Acc: 0.246 Test Loss: 1.416 Test Acc: 0.246
Validation loss decreased (inf --> -0.246363).  Saving model ...
Epoch: 2 cost time: 0.5875067710876465
Epoch: 2, Steps: 9 | Train Loss: 1.342 Vali Loss: 1.330 Vali Acc: 0.355 Test Loss: 1.330 Test Acc: 0.355
Validation loss decreased (-0.246363 --> -0.355059).  Saving model ...
Epoch: 3 cost time: 0.5859763622283936
Epoch: 3, Steps: 9 | Train Loss: 1.227 Vali Loss: 1.227 Vali Acc: 0.536 Test Loss: 1.227 Test Acc: 0.536
Validation loss decreased (-0.355059 --> -0.536220).  Saving model ...
Epoch: 4 cost time: 0.5683906078338623
Epoch: 4, Steps: 9 | Train Loss: 1.116 Vali Loss: 1.150 Vali Acc: 0.529 Test Loss: 1.150 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5383307933807373
Epoch: 5, Steps: 9 | Train Loss: 1.013 Vali Loss: 1.095 Vali Acc: 0.500 Test Loss: 1.095 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6216940879821777
Epoch: 6, Steps: 9 | Train Loss: 0.946 Vali Loss: 1.046 Vali Acc: 0.565 Test Loss: 1.046 Test Acc: 0.565
Validation loss decreased (-0.536220 --> -0.565207).  Saving model ...
Epoch: 7 cost time: 0.6192162036895752
Epoch: 7, Steps: 9 | Train Loss: 0.842 Vali Loss: 1.010 Vali Acc: 0.580 Test Loss: 1.010 Test Acc: 0.580
Validation loss decreased (-0.565207 --> -0.579700).  Saving model ...
Epoch: 8 cost time: 0.5534470081329346
Epoch: 8, Steps: 9 | Train Loss: 0.774 Vali Loss: 0.947 Vali Acc: 0.623 Test Loss: 0.947 Test Acc: 0.623
Validation loss decreased (-0.579700 --> -0.623179).  Saving model ...
Epoch: 9 cost time: 0.618645429611206
Epoch: 9, Steps: 9 | Train Loss: 0.662 Vali Loss: 0.870 Vali Acc: 0.652 Test Loss: 0.870 Test Acc: 0.652
Validation loss decreased (-0.623179 --> -0.652165).  Saving model ...
Epoch: 10 cost time: 0.6044607162475586
Epoch: 10, Steps: 9 | Train Loss: 0.544 Vali Loss: 0.740 Vali Acc: 0.754 Test Loss: 0.740 Test Acc: 0.754
Validation loss decreased (-0.652165 --> -0.753616).  Saving model ...
Epoch: 11 cost time: 0.7156977653503418
Epoch: 11, Steps: 9 | Train Loss: 0.397 Vali Loss: 0.588 Vali Acc: 0.775 Test Loss: 0.588 Test Acc: 0.775
Validation loss decreased (-0.753616 --> -0.775356).  Saving model ...
Epoch: 12 cost time: 0.6319613456726074
Epoch: 12, Steps: 9 | Train Loss: 0.277 Vali Loss: 0.528 Vali Acc: 0.819 Test Loss: 0.528 Test Acc: 0.819
Validation loss decreased (-0.775356 --> -0.818835).  Saving model ...
Epoch: 13 cost time: 0.602116584777832
Epoch: 13, Steps: 9 | Train Loss: 0.184 Vali Loss: 0.414 Vali Acc: 0.862 Test Loss: 0.414 Test Acc: 0.862
Validation loss decreased (-0.818835 --> -0.862315).  Saving model ...
Epoch: 14 cost time: 0.5492520332336426
Epoch: 14, Steps: 9 | Train Loss: 0.122 Vali Loss: 0.405 Vali Acc: 0.848 Test Loss: 0.405 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5863368511199951
Epoch: 15, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.338 Vali Acc: 0.877 Test Loss: 0.338 Test Acc: 0.877
Validation loss decreased (-0.862315 --> -0.876808).  Saving model ...
Epoch: 16 cost time: 0.49993324279785156
Epoch: 16, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.291 Vali Acc: 0.891 Test Loss: 0.291 Test Acc: 0.891
Validation loss decreased (-0.876808 --> -0.891301).  Saving model ...
Epoch: 17 cost time: 0.5607943534851074
Epoch: 17, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.272 Vali Acc: 0.899 Test Loss: 0.272 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898548).  Saving model ...
Epoch: 18 cost time: 0.5844345092773438
Epoch: 18, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.293 Vali Acc: 0.899 Test Loss: 0.293 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5518667697906494
Epoch: 19, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.276 Vali Acc: 0.913 Test Loss: 0.276 Test Acc: 0.913
Validation loss decreased (-0.898548 --> -0.913041).  Saving model ...
Epoch: 20 cost time: 0.578265905380249
Epoch: 20, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.291 Vali Acc: 0.913 Test Loss: 0.291 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.776648759841919
Epoch: 21, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.309 Vali Acc: 0.913 Test Loss: 0.309 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6428656578063965
Epoch: 22, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.281 Vali Acc: 0.928 Test Loss: 0.281 Test Acc: 0.928
Validation loss decreased (-0.913041 --> -0.927533).  Saving model ...
Epoch: 23 cost time: 0.5877137184143066
Epoch: 23, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.322 Vali Acc: 0.920 Test Loss: 0.322 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6387145519256592
Epoch: 24, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.287 Vali Acc: 0.928 Test Loss: 0.287 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5602536201477051
Epoch: 25, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.302 Vali Acc: 0.913 Test Loss: 0.302 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.7119884490966797
Epoch: 26, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.302 Vali Acc: 0.920 Test Loss: 0.302 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.47684478759765625
Epoch: 27, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.313 Vali Acc: 0.920 Test Loss: 0.313 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.5622382164001465
Epoch: 28, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.312 Vali Acc: 0.920 Test Loss: 0.312 Test Acc: 0.920
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.5905864238739014
Epoch: 29, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.307 Vali Acc: 0.928 Test Loss: 0.307 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.542447566986084
Epoch: 30, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.313 Vali Acc: 0.928 Test Loss: 0.313 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.6000363826751709
Epoch: 31, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.329 Vali Acc: 0.913 Test Loss: 0.329 Test Acc: 0.913
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.6243939399719238
Epoch: 32, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.324 Vali Acc: 0.928 Test Loss: 0.324 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm512_cs35_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.927536231884058
model parameter : 167602
model size : 0.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm512_cs30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.830744981765747
Epoch: 1, Steps: 9 | Train Loss: 1.426 Vali Loss: 1.365 Vali Acc: 0.225 Test Loss: 1.365 Test Acc: 0.225
Validation loss decreased (inf --> -0.224624).  Saving model ...
Epoch: 2 cost time: 0.5588622093200684
Epoch: 2, Steps: 9 | Train Loss: 1.345 Vali Loss: 1.277 Vali Acc: 0.297 Test Loss: 1.277 Test Acc: 0.297
Validation loss decreased (-0.224624 --> -0.297089).  Saving model ...
Epoch: 3 cost time: 0.5180656909942627
Epoch: 3, Steps: 9 | Train Loss: 1.227 Vali Loss: 1.182 Vali Acc: 0.442 Test Loss: 1.182 Test Acc: 0.442
Validation loss decreased (-0.297089 --> -0.442017).  Saving model ...
Epoch: 4 cost time: 0.5636706352233887
Epoch: 4, Steps: 9 | Train Loss: 1.095 Vali Loss: 1.102 Vali Acc: 0.486 Test Loss: 1.102 Test Acc: 0.486
Validation loss decreased (-0.442017 --> -0.485496).  Saving model ...
Epoch: 5 cost time: 0.5732581615447998
Epoch: 5, Steps: 9 | Train Loss: 1.002 Vali Loss: 1.045 Vali Acc: 0.514 Test Loss: 1.045 Test Acc: 0.514
Validation loss decreased (-0.485496 --> -0.514482).  Saving model ...
Epoch: 6 cost time: 0.6084909439086914
Epoch: 6, Steps: 9 | Train Loss: 0.894 Vali Loss: 0.983 Vali Acc: 0.565 Test Loss: 0.983 Test Acc: 0.565
Validation loss decreased (-0.514482 --> -0.565208).  Saving model ...
Epoch: 7 cost time: 0.5878982543945312
Epoch: 7, Steps: 9 | Train Loss: 0.799 Vali Loss: 0.923 Vali Acc: 0.638 Test Loss: 0.923 Test Acc: 0.638
Validation loss decreased (-0.565208 --> -0.637672).  Saving model ...
Epoch: 8 cost time: 0.5953178405761719
Epoch: 8, Steps: 9 | Train Loss: 0.701 Vali Loss: 0.844 Vali Acc: 0.674 Test Loss: 0.844 Test Acc: 0.674
Validation loss decreased (-0.637672 --> -0.673905).  Saving model ...
Epoch: 9 cost time: 0.569000244140625
Epoch: 9, Steps: 9 | Train Loss: 0.547 Vali Loss: 0.691 Vali Acc: 0.754 Test Loss: 0.691 Test Acc: 0.754
Validation loss decreased (-0.673905 --> -0.753616).  Saving model ...
Epoch: 10 cost time: 0.644169807434082
Epoch: 10, Steps: 9 | Train Loss: 0.394 Vali Loss: 0.534 Vali Acc: 0.812 Test Loss: 0.534 Test Acc: 0.812
Validation loss decreased (-0.753616 --> -0.811589).  Saving model ...
Epoch: 11 cost time: 0.632282018661499
Epoch: 11, Steps: 9 | Train Loss: 0.234 Vali Loss: 0.420 Vali Acc: 0.862 Test Loss: 0.420 Test Acc: 0.862
Validation loss decreased (-0.811589 --> -0.862315).  Saving model ...
Epoch: 12 cost time: 0.5458827018737793
Epoch: 12, Steps: 9 | Train Loss: 0.146 Vali Loss: 0.361 Vali Acc: 0.899 Test Loss: 0.361 Test Acc: 0.899
Validation loss decreased (-0.862315 --> -0.898547).  Saving model ...
Epoch: 13 cost time: 0.611379861831665
Epoch: 13, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.301 Vali Acc: 0.906 Test Loss: 0.301 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905794).  Saving model ...
Epoch: 14 cost time: 0.537874698638916
Epoch: 14, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.283 Vali Acc: 0.899 Test Loss: 0.283 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6060140132904053
Epoch: 15, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.274 Vali Acc: 0.913 Test Loss: 0.274 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913041).  Saving model ...
Epoch: 16 cost time: 0.5968382358551025
Epoch: 16, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.267 Vali Acc: 0.913 Test Loss: 0.267 Test Acc: 0.913
Validation loss decreased (-0.913041 --> -0.913041).  Saving model ...
Epoch: 17 cost time: 0.5214371681213379
Epoch: 17, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.268 Vali Acc: 0.913 Test Loss: 0.268 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.589087724685669
Epoch: 18, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.260 Vali Acc: 0.913 Test Loss: 0.260 Test Acc: 0.913
Validation loss decreased (-0.913041 --> -0.913041).  Saving model ...
Epoch: 19 cost time: 0.5449209213256836
Epoch: 19, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.246 Vali Acc: 0.928 Test Loss: 0.246 Test Acc: 0.928
Validation loss decreased (-0.913041 --> -0.927534).  Saving model ...
Epoch: 20 cost time: 0.5333151817321777
Epoch: 20, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.240 Vali Acc: 0.942 Test Loss: 0.240 Test Acc: 0.942
Validation loss decreased (-0.927534 --> -0.942027).  Saving model ...
Epoch: 21 cost time: 0.5936603546142578
Epoch: 21, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.250 Vali Acc: 0.942 Test Loss: 0.250 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6592545509338379
Epoch: 22, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.255 Vali Acc: 0.942 Test Loss: 0.255 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6703808307647705
Epoch: 23, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.245 Vali Acc: 0.935 Test Loss: 0.245 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.5871419906616211
Epoch: 24, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.247 Vali Acc: 0.928 Test Loss: 0.247 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.6245887279510498
Epoch: 25, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.245 Vali Acc: 0.928 Test Loss: 0.245 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.5787491798400879
Epoch: 26, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.245 Vali Acc: 0.935 Test Loss: 0.245 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.569901704788208
Epoch: 27, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.249 Vali Acc: 0.942 Test Loss: 0.249 Test Acc: 0.942
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.581092357635498
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.250 Vali Acc: 0.935 Test Loss: 0.250 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.45786237716674805
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.935 Test Loss: 0.253 Test Acc: 0.935
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.564894437789917
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.254 Vali Acc: 0.935 Test Loss: 0.254 Test Acc: 0.935
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm512_cs30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9420289855072463
model parameter : 166352
model size : 0.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm512_cs26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.755051612854004
Epoch: 1, Steps: 9 | Train Loss: 1.433 Vali Loss: 1.364 Vali Acc: 0.362 Test Loss: 1.364 Test Acc: 0.362
Validation loss decreased (inf --> -0.362305).  Saving model ...
Epoch: 2 cost time: 0.6444578170776367
Epoch: 2, Steps: 9 | Train Loss: 1.362 Vali Loss: 1.287 Vali Acc: 0.413 Test Loss: 1.287 Test Acc: 0.413
Validation loss decreased (-0.362305 --> -0.413031).  Saving model ...
Epoch: 3 cost time: 0.5973126888275146
Epoch: 3, Steps: 9 | Train Loss: 1.258 Vali Loss: 1.202 Vali Acc: 0.464 Test Loss: 1.202 Test Acc: 0.464
Validation loss decreased (-0.413031 --> -0.463756).  Saving model ...
Epoch: 4 cost time: 0.4616713523864746
Epoch: 4, Steps: 9 | Train Loss: 1.145 Vali Loss: 1.131 Vali Acc: 0.507 Test Loss: 1.131 Test Acc: 0.507
Validation loss decreased (-0.463756 --> -0.507235).  Saving model ...
Epoch: 5 cost time: 0.49550485610961914
Epoch: 5, Steps: 9 | Train Loss: 1.074 Vali Loss: 1.077 Vali Acc: 0.507 Test Loss: 1.077 Test Acc: 0.507
Validation loss decreased (-0.507235 --> -0.507236).  Saving model ...
Epoch: 6 cost time: 0.5802311897277832
Epoch: 6, Steps: 9 | Train Loss: 0.970 Vali Loss: 1.045 Vali Acc: 0.543 Test Loss: 1.045 Test Acc: 0.543
Validation loss decreased (-0.507236 --> -0.543468).  Saving model ...
Epoch: 7 cost time: 0.5121071338653564
Epoch: 7, Steps: 9 | Train Loss: 0.899 Vali Loss: 1.011 Vali Acc: 0.558 Test Loss: 1.011 Test Acc: 0.558
Validation loss decreased (-0.543468 --> -0.557961).  Saving model ...
Epoch: 8 cost time: 0.5912296772003174
Epoch: 8, Steps: 9 | Train Loss: 0.821 Vali Loss: 0.980 Vali Acc: 0.558 Test Loss: 0.980 Test Acc: 0.558
Validation loss decreased (-0.557961 --> -0.557961).  Saving model ...
Epoch: 9 cost time: 0.5347335338592529
Epoch: 9, Steps: 9 | Train Loss: 0.737 Vali Loss: 0.951 Vali Acc: 0.587 Test Loss: 0.951 Test Acc: 0.587
Validation loss decreased (-0.557961 --> -0.586947).  Saving model ...
Epoch: 10 cost time: 0.5318105220794678
Epoch: 10, Steps: 9 | Train Loss: 0.661 Vali Loss: 0.902 Vali Acc: 0.638 Test Loss: 0.902 Test Acc: 0.638
Validation loss decreased (-0.586947 --> -0.637672).  Saving model ...
Epoch: 11 cost time: 0.5984675884246826
Epoch: 11, Steps: 9 | Train Loss: 0.555 Vali Loss: 0.819 Vali Acc: 0.688 Test Loss: 0.819 Test Acc: 0.688
Validation loss decreased (-0.637672 --> -0.688398).  Saving model ...
Epoch: 12 cost time: 0.5174574851989746
Epoch: 12, Steps: 9 | Train Loss: 0.423 Vali Loss: 0.719 Vali Acc: 0.732 Test Loss: 0.719 Test Acc: 0.732
Validation loss decreased (-0.688398 --> -0.731877).  Saving model ...
Epoch: 13 cost time: 0.498340368270874
Epoch: 13, Steps: 9 | Train Loss: 0.292 Vali Loss: 0.582 Vali Acc: 0.775 Test Loss: 0.582 Test Acc: 0.775
Validation loss decreased (-0.731877 --> -0.775356).  Saving model ...
Epoch: 14 cost time: 0.49101758003234863
Epoch: 14, Steps: 9 | Train Loss: 0.196 Vali Loss: 0.559 Vali Acc: 0.804 Test Loss: 0.559 Test Acc: 0.804
Validation loss decreased (-0.775356 --> -0.804342).  Saving model ...
Epoch: 15 cost time: 0.583167552947998
Epoch: 15, Steps: 9 | Train Loss: 0.121 Vali Loss: 0.495 Vali Acc: 0.833 Test Loss: 0.495 Test Acc: 0.833
Validation loss decreased (-0.804342 --> -0.833328).  Saving model ...
Epoch: 16 cost time: 0.6210587024688721
Epoch: 16, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.489 Vali Acc: 0.841 Test Loss: 0.489 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840575).  Saving model ...
Epoch: 17 cost time: 0.5323774814605713
Epoch: 17, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.470 Vali Acc: 0.833 Test Loss: 0.470 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6636278629302979
Epoch: 18, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.460 Vali Acc: 0.841 Test Loss: 0.460 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 19 cost time: 0.5773622989654541
Epoch: 19, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.435 Vali Acc: 0.870 Test Loss: 0.435 Test Acc: 0.870
Validation loss decreased (-0.840575 --> -0.869561).  Saving model ...
Epoch: 20 cost time: 0.5173840522766113
Epoch: 20, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.496 Vali Acc: 0.841 Test Loss: 0.496 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5659587383270264
Epoch: 21, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.468 Vali Acc: 0.862 Test Loss: 0.468 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6410791873931885
Epoch: 22, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.456 Vali Acc: 0.862 Test Loss: 0.456 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.5297427177429199
Epoch: 23, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.481 Vali Acc: 0.862 Test Loss: 0.481 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.6411008834838867
Epoch: 24, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.492 Vali Acc: 0.862 Test Loss: 0.492 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.6447803974151611
Epoch: 25, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.485 Vali Acc: 0.862 Test Loss: 0.485 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.6225190162658691
Epoch: 26, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.504 Vali Acc: 0.862 Test Loss: 0.504 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.6613531112670898
Epoch: 27, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.519 Vali Acc: 0.862 Test Loss: 0.519 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.6433978080749512
Epoch: 28, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.522 Vali Acc: 0.862 Test Loss: 0.522 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.5809504985809326
Epoch: 29, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.526 Vali Acc: 0.862 Test Loss: 0.526 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm512_cs26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 164950
model size : 0.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm512_cs23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.754465103149414
Epoch: 1, Steps: 9 | Train Loss: 1.458 Vali Loss: 1.478 Vali Acc: 0.246 Test Loss: 1.478 Test Acc: 0.246
Validation loss decreased (inf --> -0.246362).  Saving model ...
Epoch: 2 cost time: 0.6144282817840576
Epoch: 2, Steps: 9 | Train Loss: 1.372 Vali Loss: 1.373 Vali Acc: 0.319 Test Loss: 1.373 Test Acc: 0.319
Validation loss decreased (-0.246362 --> -0.318827).  Saving model ...
Epoch: 3 cost time: 0.6222472190856934
Epoch: 3, Steps: 9 | Train Loss: 1.251 Vali Loss: 1.260 Vali Acc: 0.471 Test Loss: 1.260 Test Acc: 0.471
Validation loss decreased (-0.318827 --> -0.471002).  Saving model ...
Epoch: 4 cost time: 0.5438737869262695
Epoch: 4, Steps: 9 | Train Loss: 1.125 Vali Loss: 1.162 Vali Acc: 0.522 Test Loss: 1.162 Test Acc: 0.522
Validation loss decreased (-0.471002 --> -0.521728).  Saving model ...
Epoch: 5 cost time: 0.6335709095001221
Epoch: 5, Steps: 9 | Train Loss: 1.022 Vali Loss: 1.083 Vali Acc: 0.522 Test Loss: 1.083 Test Acc: 0.522
Validation loss decreased (-0.521728 --> -0.521728).  Saving model ...
Epoch: 6 cost time: 0.5934422016143799
Epoch: 6, Steps: 9 | Train Loss: 0.917 Vali Loss: 1.006 Vali Acc: 0.543 Test Loss: 1.006 Test Acc: 0.543
Validation loss decreased (-0.521728 --> -0.543468).  Saving model ...
Epoch: 7 cost time: 0.5005910396575928
Epoch: 7, Steps: 9 | Train Loss: 0.802 Vali Loss: 0.907 Vali Acc: 0.652 Test Loss: 0.907 Test Acc: 0.652
Validation loss decreased (-0.543468 --> -0.652165).  Saving model ...
Epoch: 8 cost time: 0.5541625022888184
Epoch: 8, Steps: 9 | Train Loss: 0.669 Vali Loss: 0.768 Vali Acc: 0.710 Test Loss: 0.768 Test Acc: 0.710
Validation loss decreased (-0.652165 --> -0.710137).  Saving model ...
Epoch: 9 cost time: 0.4938075542449951
Epoch: 9, Steps: 9 | Train Loss: 0.525 Vali Loss: 0.593 Vali Acc: 0.812 Test Loss: 0.593 Test Acc: 0.812
Validation loss decreased (-0.710137 --> -0.811588).  Saving model ...
Epoch: 10 cost time: 0.5793216228485107
Epoch: 10, Steps: 9 | Train Loss: 0.341 Vali Loss: 0.435 Vali Acc: 0.855 Test Loss: 0.435 Test Acc: 0.855
Validation loss decreased (-0.811588 --> -0.855068).  Saving model ...
Epoch: 11 cost time: 0.5925800800323486
Epoch: 11, Steps: 9 | Train Loss: 0.207 Vali Loss: 0.328 Vali Acc: 0.884 Test Loss: 0.328 Test Acc: 0.884
Validation loss decreased (-0.855068 --> -0.884055).  Saving model ...
Epoch: 12 cost time: 0.5832245349884033
Epoch: 12, Steps: 9 | Train Loss: 0.123 Vali Loss: 0.289 Vali Acc: 0.884 Test Loss: 0.289 Test Acc: 0.884
Validation loss decreased (-0.884055 --> -0.884055).  Saving model ...
Epoch: 13 cost time: 0.5880410671234131
Epoch: 13, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.283 Vali Acc: 0.899 Test Loss: 0.283 Test Acc: 0.899
Validation loss decreased (-0.884055 --> -0.898548).  Saving model ...
Epoch: 14 cost time: 0.5526862144470215
Epoch: 14, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.294 Vali Acc: 0.899 Test Loss: 0.294 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5448987483978271
Epoch: 15, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.240 Vali Acc: 0.920 Test Loss: 0.240 Test Acc: 0.920
Validation loss decreased (-0.898548 --> -0.920287).  Saving model ...
Epoch: 16 cost time: 0.5647323131561279
Epoch: 16, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.236 Vali Acc: 0.913 Test Loss: 0.236 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6036381721496582
Epoch: 17, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.271 Vali Acc: 0.913 Test Loss: 0.271 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6459414958953857
Epoch: 18, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.299 Vali Acc: 0.906 Test Loss: 0.299 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.6093685626983643
Epoch: 19, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.296 Vali Acc: 0.913 Test Loss: 0.296 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.5761725902557373
Epoch: 20, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.306 Vali Acc: 0.920 Test Loss: 0.306 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.5888497829437256
Epoch: 21, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.323 Vali Acc: 0.913 Test Loss: 0.323 Test Acc: 0.913
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.6098728179931641
Epoch: 22, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.343 Vali Acc: 0.913 Test Loss: 0.343 Test Acc: 0.913
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.6275279521942139
Epoch: 23, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.344 Vali Acc: 0.913 Test Loss: 0.344 Test Acc: 0.913
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.5456407070159912
Epoch: 24, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.339 Vali Acc: 0.920 Test Loss: 0.339 Test Acc: 0.920
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.6482853889465332
Epoch: 25, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.345 Vali Acc: 0.928 Test Loss: 0.345 Test Acc: 0.928
Validation loss decreased (-0.920287 --> -0.927533).  Saving model ...
Epoch: 26 cost time: 0.5652480125427246
Epoch: 26, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.370 Vali Acc: 0.913 Test Loss: 0.370 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6318755149841309
Epoch: 27, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.391 Vali Acc: 0.906 Test Loss: 0.391 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6857070922851562
Epoch: 28, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.390 Vali Acc: 0.913 Test Loss: 0.390 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.5999641418457031
Epoch: 29, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.379 Vali Acc: 0.920 Test Loss: 0.379 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.6687533855438232
Epoch: 30, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.390 Vali Acc: 0.920 Test Loss: 0.390 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.5443127155303955
Epoch: 31, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.403 Vali Acc: 0.913 Test Loss: 0.403 Test Acc: 0.913
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.4911367893218994
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.414 Vali Acc: 0.913 Test Loss: 0.414 Test Acc: 0.913
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.5712647438049316
Epoch: 33, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.414 Vali Acc: 0.913 Test Loss: 0.414 Test Acc: 0.913
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.5857362747192383
Epoch: 34, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.418 Vali Acc: 0.913 Test Loss: 0.418 Test Acc: 0.913
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.7368242740631104
Epoch: 35, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.420 Vali Acc: 0.913 Test Loss: 0.420 Test Acc: 0.913
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm512_cs23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.927536231884058
model parameter : 164014
model size : 0.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm512_cs21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.775437593460083
Epoch: 1, Steps: 9 | Train Loss: 1.424 Vali Loss: 1.365 Vali Acc: 0.391 Test Loss: 1.365 Test Acc: 0.391
Validation loss decreased (inf --> -0.391291).  Saving model ...
Epoch: 2 cost time: 0.6081533432006836
Epoch: 2, Steps: 9 | Train Loss: 1.336 Vali Loss: 1.280 Vali Acc: 0.442 Test Loss: 1.280 Test Acc: 0.442
Validation loss decreased (-0.391291 --> -0.442016).  Saving model ...
Epoch: 3 cost time: 0.5905978679656982
Epoch: 3, Steps: 9 | Train Loss: 1.230 Vali Loss: 1.192 Vali Acc: 0.500 Test Loss: 1.192 Test Acc: 0.500
Validation loss decreased (-0.442016 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 0.519819974899292
Epoch: 4, Steps: 9 | Train Loss: 1.121 Vali Loss: 1.122 Vali Acc: 0.514 Test Loss: 1.122 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.514482).  Saving model ...
Epoch: 5 cost time: 0.7146103382110596
Epoch: 5, Steps: 9 | Train Loss: 1.016 Vali Loss: 1.069 Vali Acc: 0.522 Test Loss: 1.069 Test Acc: 0.522
Validation loss decreased (-0.514482 --> -0.521728).  Saving model ...
Epoch: 6 cost time: 0.6348147392272949
Epoch: 6, Steps: 9 | Train Loss: 0.932 Vali Loss: 1.031 Vali Acc: 0.572 Test Loss: 1.031 Test Acc: 0.572
Validation loss decreased (-0.521728 --> -0.572453).  Saving model ...
Epoch: 7 cost time: 0.6615893840789795
Epoch: 7, Steps: 9 | Train Loss: 0.861 Vali Loss: 0.989 Vali Acc: 0.594 Test Loss: 0.989 Test Acc: 0.594
Validation loss decreased (-0.572453 --> -0.594193).  Saving model ...
Epoch: 8 cost time: 0.6576886177062988
Epoch: 8, Steps: 9 | Train Loss: 0.766 Vali Loss: 0.933 Vali Acc: 0.601 Test Loss: 0.933 Test Acc: 0.601
Validation loss decreased (-0.594193 --> -0.601440).  Saving model ...
Epoch: 9 cost time: 0.6141259670257568
Epoch: 9, Steps: 9 | Train Loss: 0.664 Vali Loss: 0.838 Vali Acc: 0.674 Test Loss: 0.838 Test Acc: 0.674
Validation loss decreased (-0.601440 --> -0.673905).  Saving model ...
Epoch: 10 cost time: 0.6269018650054932
Epoch: 10, Steps: 9 | Train Loss: 0.530 Vali Loss: 0.673 Vali Acc: 0.732 Test Loss: 0.673 Test Acc: 0.732
Validation loss decreased (-0.673905 --> -0.731877).  Saving model ...
Epoch: 11 cost time: 0.5816686153411865
Epoch: 11, Steps: 9 | Train Loss: 0.373 Vali Loss: 0.519 Vali Acc: 0.797 Test Loss: 0.519 Test Acc: 0.797
Validation loss decreased (-0.731877 --> -0.797096).  Saving model ...
Epoch: 12 cost time: 0.648090124130249
Epoch: 12, Steps: 9 | Train Loss: 0.234 Vali Loss: 0.417 Vali Acc: 0.855 Test Loss: 0.417 Test Acc: 0.855
Validation loss decreased (-0.797096 --> -0.855068).  Saving model ...
Epoch: 13 cost time: 0.5332274436950684
Epoch: 13, Steps: 9 | Train Loss: 0.154 Vali Loss: 0.414 Vali Acc: 0.862 Test Loss: 0.414 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862315).  Saving model ...
Epoch: 14 cost time: 0.6844758987426758
Epoch: 14, Steps: 9 | Train Loss: 0.102 Vali Loss: 0.324 Vali Acc: 0.891 Test Loss: 0.324 Test Acc: 0.891
Validation loss decreased (-0.862315 --> -0.891301).  Saving model ...
Epoch: 15 cost time: 0.7664823532104492
Epoch: 15, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.289 Vali Acc: 0.891 Test Loss: 0.289 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 16 cost time: 0.6466867923736572
Epoch: 16, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.317 Vali Acc: 0.891 Test Loss: 0.317 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5709059238433838
Epoch: 17, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.303 Vali Acc: 0.891 Test Loss: 0.303 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7119314670562744
Epoch: 18, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.270 Vali Acc: 0.913 Test Loss: 0.270 Test Acc: 0.913
Validation loss decreased (-0.891301 --> -0.913041).  Saving model ...
Epoch: 19 cost time: 0.5852835178375244
Epoch: 19, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.266 Vali Acc: 0.913 Test Loss: 0.266 Test Acc: 0.913
Validation loss decreased (-0.913041 --> -0.913041).  Saving model ...
Epoch: 20 cost time: 0.7619822025299072
Epoch: 20, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.244 Vali Acc: 0.920 Test Loss: 0.244 Test Acc: 0.920
Validation loss decreased (-0.913041 --> -0.920287).  Saving model ...
Epoch: 21 cost time: 0.5940234661102295
Epoch: 21, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.256 Vali Acc: 0.906 Test Loss: 0.256 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5264768600463867
Epoch: 22, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.286 Vali Acc: 0.913 Test Loss: 0.286 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6728603839874268
Epoch: 23, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.280 Vali Acc: 0.913 Test Loss: 0.280 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.6444871425628662
Epoch: 24, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.273 Vali Acc: 0.906 Test Loss: 0.273 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.6455478668212891
Epoch: 25, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.274 Vali Acc: 0.906 Test Loss: 0.274 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.6436970233917236
Epoch: 26, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.280 Vali Acc: 0.906 Test Loss: 0.280 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.6788012981414795
Epoch: 27, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.291 Vali Acc: 0.906 Test Loss: 0.291 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.56418776512146
Epoch: 28, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.291 Vali Acc: 0.913 Test Loss: 0.291 Test Acc: 0.913
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.5982162952423096
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.291 Vali Acc: 0.913 Test Loss: 0.291 Test Acc: 0.913
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.7243893146514893
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.298 Vali Acc: 0.913 Test Loss: 0.298 Test Acc: 0.913
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm512_cs21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 164162
model size : 0.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm512_cs19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.8596787452697754
Epoch: 1, Steps: 9 | Train Loss: 1.401 Vali Loss: 1.343 Vali Acc: 0.297 Test Loss: 1.343 Test Acc: 0.297
Validation loss decreased (inf --> -0.297088).  Saving model ...
Epoch: 2 cost time: 0.5361735820770264
Epoch: 2, Steps: 9 | Train Loss: 1.317 Vali Loss: 1.259 Vali Acc: 0.384 Test Loss: 1.259 Test Acc: 0.384
Validation loss decreased (-0.297088 --> -0.384045).  Saving model ...
Epoch: 3 cost time: 0.5368883609771729
Epoch: 3, Steps: 9 | Train Loss: 1.215 Vali Loss: 1.168 Vali Acc: 0.493 Test Loss: 1.168 Test Acc: 0.493
Validation loss decreased (-0.384045 --> -0.492742).  Saving model ...
Epoch: 4 cost time: 0.5830271244049072
Epoch: 4, Steps: 9 | Train Loss: 1.094 Vali Loss: 1.085 Vali Acc: 0.522 Test Loss: 1.085 Test Acc: 0.522
Validation loss decreased (-0.492742 --> -0.521728).  Saving model ...
Epoch: 5 cost time: 0.47085022926330566
Epoch: 5, Steps: 9 | Train Loss: 0.991 Vali Loss: 1.017 Vali Acc: 0.565 Test Loss: 1.017 Test Acc: 0.565
Validation loss decreased (-0.521728 --> -0.565207).  Saving model ...
Epoch: 6 cost time: 0.4948899745941162
Epoch: 6, Steps: 9 | Train Loss: 0.879 Vali Loss: 0.935 Vali Acc: 0.638 Test Loss: 0.935 Test Acc: 0.638
Validation loss decreased (-0.565207 --> -0.637672).  Saving model ...
Epoch: 7 cost time: 0.5398411750793457
Epoch: 7, Steps: 9 | Train Loss: 0.752 Vali Loss: 0.827 Vali Acc: 0.681 Test Loss: 0.827 Test Acc: 0.681
Validation loss decreased (-0.637672 --> -0.681151).  Saving model ...
Epoch: 8 cost time: 0.5172321796417236
Epoch: 8, Steps: 9 | Train Loss: 0.584 Vali Loss: 0.688 Vali Acc: 0.768 Test Loss: 0.688 Test Acc: 0.768
Validation loss decreased (-0.681151 --> -0.768109).  Saving model ...
Epoch: 9 cost time: 0.4779479503631592
Epoch: 9, Steps: 9 | Train Loss: 0.409 Vali Loss: 0.535 Vali Acc: 0.790 Test Loss: 0.535 Test Acc: 0.790
Validation loss decreased (-0.768109 --> -0.789850).  Saving model ...
Epoch: 10 cost time: 0.5046372413635254
Epoch: 10, Steps: 9 | Train Loss: 0.282 Vali Loss: 0.472 Vali Acc: 0.790 Test Loss: 0.472 Test Acc: 0.790
Validation loss decreased (-0.789850 --> -0.789850).  Saving model ...
Epoch: 11 cost time: 0.5926594734191895
Epoch: 11, Steps: 9 | Train Loss: 0.194 Vali Loss: 0.407 Vali Acc: 0.826 Test Loss: 0.407 Test Acc: 0.826
Validation loss decreased (-0.789850 --> -0.826083).  Saving model ...
Epoch: 12 cost time: 0.5681273937225342
Epoch: 12, Steps: 9 | Train Loss: 0.137 Vali Loss: 0.405 Vali Acc: 0.848 Test Loss: 0.405 Test Acc: 0.848
Validation loss decreased (-0.826083 --> -0.847822).  Saving model ...
Epoch: 13 cost time: 0.4364128112792969
Epoch: 13, Steps: 9 | Train Loss: 0.096 Vali Loss: 0.361 Vali Acc: 0.870 Test Loss: 0.361 Test Acc: 0.870
Validation loss decreased (-0.847822 --> -0.869562).  Saving model ...
Epoch: 14 cost time: 0.6357831954956055
Epoch: 14, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.367 Vali Acc: 0.862 Test Loss: 0.367 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5496602058410645
Epoch: 15, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.384 Vali Acc: 0.855 Test Loss: 0.384 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.4599425792694092
Epoch: 16, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.385 Vali Acc: 0.862 Test Loss: 0.385 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5126523971557617
Epoch: 17, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.373 Vali Acc: 0.877 Test Loss: 0.373 Test Acc: 0.877
Validation loss decreased (-0.869562 --> -0.876808).  Saving model ...
Epoch: 18 cost time: 0.4807589054107666
Epoch: 18, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.377 Vali Acc: 0.855 Test Loss: 0.377 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5224487781524658
Epoch: 19, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.345 Vali Acc: 0.891 Test Loss: 0.345 Test Acc: 0.891
Validation loss decreased (-0.876808 --> -0.891301).  Saving model ...
Epoch: 20 cost time: 0.4238877296447754
Epoch: 20, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.406 Vali Acc: 0.870 Test Loss: 0.406 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6109952926635742
Epoch: 21, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.434 Vali Acc: 0.877 Test Loss: 0.434 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5200858116149902
Epoch: 22, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.439 Vali Acc: 0.862 Test Loss: 0.439 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.4351201057434082
Epoch: 23, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.409 Vali Acc: 0.877 Test Loss: 0.409 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.555119514465332
Epoch: 24, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.395 Vali Acc: 0.877 Test Loss: 0.395 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.4534151554107666
Epoch: 25, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.411 Vali Acc: 0.870 Test Loss: 0.411 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.547222375869751
Epoch: 26, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.430 Vali Acc: 0.870 Test Loss: 0.430 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.5461368560791016
Epoch: 27, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.433 Vali Acc: 0.870 Test Loss: 0.433 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.5704467296600342
Epoch: 28, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.455 Vali Acc: 0.862 Test Loss: 0.455 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.6163530349731445
Epoch: 29, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.470 Vali Acc: 0.862 Test Loss: 0.470 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm512_cs19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 163490
model size : 0.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm512_cs18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.8177614212036133
Epoch: 1, Steps: 9 | Train Loss: 1.428 Vali Loss: 1.446 Vali Acc: 0.297 Test Loss: 1.446 Test Acc: 0.297
Validation loss decreased (inf --> -0.297087).  Saving model ...
Epoch: 2 cost time: 0.6601660251617432
Epoch: 2, Steps: 9 | Train Loss: 1.360 Vali Loss: 1.355 Vali Acc: 0.297 Test Loss: 1.355 Test Acc: 0.297
Validation loss decreased (-0.297087 --> -0.297088).  Saving model ...
Epoch: 3 cost time: 0.509528636932373
Epoch: 3, Steps: 9 | Train Loss: 1.240 Vali Loss: 1.252 Vali Acc: 0.355 Test Loss: 1.252 Test Acc: 0.355
Validation loss decreased (-0.297088 --> -0.355060).  Saving model ...
Epoch: 4 cost time: 0.5477714538574219
Epoch: 4, Steps: 9 | Train Loss: 1.118 Vali Loss: 1.163 Vali Acc: 0.442 Test Loss: 1.163 Test Acc: 0.442
Validation loss decreased (-0.355060 --> -0.442017).  Saving model ...
Epoch: 5 cost time: 0.5521755218505859
Epoch: 5, Steps: 9 | Train Loss: 1.009 Vali Loss: 1.092 Vali Acc: 0.478 Test Loss: 1.092 Test Acc: 0.478
Validation loss decreased (-0.442017 --> -0.478250).  Saving model ...
Epoch: 6 cost time: 0.5562877655029297
Epoch: 6, Steps: 9 | Train Loss: 0.930 Vali Loss: 1.037 Vali Acc: 0.514 Test Loss: 1.037 Test Acc: 0.514
Validation loss decreased (-0.478250 --> -0.514482).  Saving model ...
Epoch: 7 cost time: 0.5795238018035889
Epoch: 7, Steps: 9 | Train Loss: 0.823 Vali Loss: 0.967 Vali Acc: 0.580 Test Loss: 0.967 Test Acc: 0.580
Validation loss decreased (-0.514482 --> -0.579700).  Saving model ...
Epoch: 8 cost time: 0.6203534603118896
Epoch: 8, Steps: 9 | Train Loss: 0.718 Vali Loss: 0.837 Vali Acc: 0.688 Test Loss: 0.837 Test Acc: 0.688
Validation loss decreased (-0.579700 --> -0.688397).  Saving model ...
Epoch: 9 cost time: 0.4752483367919922
Epoch: 9, Steps: 9 | Train Loss: 0.571 Vali Loss: 0.679 Vali Acc: 0.754 Test Loss: 0.679 Test Acc: 0.754
Validation loss decreased (-0.688397 --> -0.753616).  Saving model ...
Epoch: 10 cost time: 0.5282418727874756
Epoch: 10, Steps: 9 | Train Loss: 0.384 Vali Loss: 0.534 Vali Acc: 0.841 Test Loss: 0.534 Test Acc: 0.841
Validation loss decreased (-0.753616 --> -0.840574).  Saving model ...
Epoch: 11 cost time: 0.5134625434875488
Epoch: 11, Steps: 9 | Train Loss: 0.254 Vali Loss: 0.454 Vali Acc: 0.841 Test Loss: 0.454 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840575).  Saving model ...
Epoch: 12 cost time: 0.6282138824462891
Epoch: 12, Steps: 9 | Train Loss: 0.176 Vali Loss: 0.434 Vali Acc: 0.819 Test Loss: 0.434 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6474432945251465
Epoch: 13, Steps: 9 | Train Loss: 0.134 Vali Loss: 0.385 Vali Acc: 0.855 Test Loss: 0.385 Test Acc: 0.855
Validation loss decreased (-0.840575 --> -0.855069).  Saving model ...
Epoch: 14 cost time: 0.5715181827545166
Epoch: 14, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.350 Vali Acc: 0.899 Test Loss: 0.350 Test Acc: 0.899
Validation loss decreased (-0.855069 --> -0.898547).  Saving model ...
Epoch: 15 cost time: 0.539168119430542
Epoch: 15, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.317 Vali Acc: 0.913 Test Loss: 0.317 Test Acc: 0.913
Validation loss decreased (-0.898547 --> -0.913040).  Saving model ...
Epoch: 16 cost time: 0.5368576049804688
Epoch: 16, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.336 Vali Acc: 0.906 Test Loss: 0.336 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6262290477752686
Epoch: 17, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.360 Vali Acc: 0.906 Test Loss: 0.360 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.48128604888916016
Epoch: 18, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.315 Vali Acc: 0.899 Test Loss: 0.315 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.6679794788360596
Epoch: 19, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.314 Vali Acc: 0.913 Test Loss: 0.314 Test Acc: 0.913
Validation loss decreased (-0.913040 --> -0.913040).  Saving model ...
Epoch: 20 cost time: 0.5606427192687988
Epoch: 20, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.308 Vali Acc: 0.920 Test Loss: 0.308 Test Acc: 0.920
Validation loss decreased (-0.913040 --> -0.920287).  Saving model ...
Epoch: 21 cost time: 0.4537074565887451
Epoch: 21, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.306 Vali Acc: 0.920 Test Loss: 0.306 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 22 cost time: 0.6167473793029785
Epoch: 22, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.320 Vali Acc: 0.928 Test Loss: 0.320 Test Acc: 0.928
Validation loss decreased (-0.920287 --> -0.927533).  Saving model ...
Epoch: 23 cost time: 0.5515768527984619
Epoch: 23, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.319 Vali Acc: 0.928 Test Loss: 0.319 Test Acc: 0.928
Validation loss decreased (-0.927533 --> -0.927533).  Saving model ...
Epoch: 24 cost time: 0.41287803649902344
Epoch: 24, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.325 Vali Acc: 0.928 Test Loss: 0.325 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.483783483505249
Epoch: 25, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.333 Vali Acc: 0.928 Test Loss: 0.333 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.5051519870758057
Epoch: 26, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.343 Vali Acc: 0.928 Test Loss: 0.343 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.47029757499694824
Epoch: 27, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.339 Vali Acc: 0.928 Test Loss: 0.339 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.6217517852783203
Epoch: 28, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.346 Vali Acc: 0.928 Test Loss: 0.346 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.6476743221282959
Epoch: 29, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.356 Vali Acc: 0.928 Test Loss: 0.356 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.531207799911499
Epoch: 30, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.353 Vali Acc: 0.928 Test Loss: 0.353 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.6002833843231201
Epoch: 31, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.353 Vali Acc: 0.928 Test Loss: 0.353 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.56109619140625
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.364 Vali Acc: 0.920 Test Loss: 0.364 Test Acc: 0.920
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.5526361465454102
Epoch: 33, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.364 Vali Acc: 0.928 Test Loss: 0.364 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm512_cs18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.927536231884058
model parameter : 164726
model size : 0.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm512_cs16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.7686164379119873
Epoch: 1, Steps: 9 | Train Loss: 1.382 Vali Loss: 1.364 Vali Acc: 0.355 Test Loss: 1.364 Test Acc: 0.355
Validation loss decreased (inf --> -0.355059).  Saving model ...
Epoch: 2 cost time: 0.5312678813934326
Epoch: 2, Steps: 9 | Train Loss: 1.314 Vali Loss: 1.297 Vali Acc: 0.399 Test Loss: 1.297 Test Acc: 0.399
Validation loss decreased (-0.355059 --> -0.398538).  Saving model ...
Epoch: 3 cost time: 0.5310862064361572
Epoch: 3, Steps: 9 | Train Loss: 1.210 Vali Loss: 1.225 Vali Acc: 0.457 Test Loss: 1.225 Test Acc: 0.457
Validation loss decreased (-0.398538 --> -0.456509).  Saving model ...
Epoch: 4 cost time: 0.5620801448822021
Epoch: 4, Steps: 9 | Train Loss: 1.094 Vali Loss: 1.163 Vali Acc: 0.486 Test Loss: 1.163 Test Acc: 0.486
Validation loss decreased (-0.456509 --> -0.485496).  Saving model ...
Epoch: 5 cost time: 0.549598217010498
Epoch: 5, Steps: 9 | Train Loss: 1.008 Vali Loss: 1.110 Vali Acc: 0.507 Test Loss: 1.110 Test Acc: 0.507
Validation loss decreased (-0.485496 --> -0.507235).  Saving model ...
Epoch: 6 cost time: 0.6465389728546143
Epoch: 6, Steps: 9 | Train Loss: 0.920 Vali Loss: 1.060 Vali Acc: 0.514 Test Loss: 1.060 Test Acc: 0.514
Validation loss decreased (-0.507235 --> -0.514482).  Saving model ...
Epoch: 7 cost time: 0.5501227378845215
Epoch: 7, Steps: 9 | Train Loss: 0.827 Vali Loss: 0.995 Vali Acc: 0.529 Test Loss: 0.995 Test Acc: 0.529
Validation loss decreased (-0.514482 --> -0.528976).  Saving model ...
Epoch: 8 cost time: 0.605539083480835
Epoch: 8, Steps: 9 | Train Loss: 0.743 Vali Loss: 0.904 Vali Acc: 0.601 Test Loss: 0.904 Test Acc: 0.601
Validation loss decreased (-0.528976 --> -0.601440).  Saving model ...
Epoch: 9 cost time: 0.587174654006958
Epoch: 9, Steps: 9 | Train Loss: 0.601 Vali Loss: 0.755 Vali Acc: 0.761 Test Loss: 0.755 Test Acc: 0.761
Validation loss decreased (-0.601440 --> -0.760862).  Saving model ...
Epoch: 10 cost time: 0.5133662223815918
Epoch: 10, Steps: 9 | Train Loss: 0.436 Vali Loss: 0.567 Vali Acc: 0.826 Test Loss: 0.567 Test Acc: 0.826
Validation loss decreased (-0.760862 --> -0.826081).  Saving model ...
Epoch: 11 cost time: 0.6707594394683838
Epoch: 11, Steps: 9 | Train Loss: 0.267 Vali Loss: 0.417 Vali Acc: 0.848 Test Loss: 0.417 Test Acc: 0.848
Validation loss decreased (-0.826081 --> -0.847822).  Saving model ...
Epoch: 12 cost time: 0.5334267616271973
Epoch: 12, Steps: 9 | Train Loss: 0.162 Vali Loss: 0.304 Vali Acc: 0.899 Test Loss: 0.304 Test Acc: 0.899
Validation loss decreased (-0.847822 --> -0.898548).  Saving model ...
Epoch: 13 cost time: 0.6106841564178467
Epoch: 13, Steps: 9 | Train Loss: 0.104 Vali Loss: 0.301 Vali Acc: 0.891 Test Loss: 0.301 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5692572593688965
Epoch: 14, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.245 Vali Acc: 0.913 Test Loss: 0.245 Test Acc: 0.913
Validation loss decreased (-0.898548 --> -0.913041).  Saving model ...
Epoch: 15 cost time: 0.5563151836395264
Epoch: 15, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.244 Vali Acc: 0.920 Test Loss: 0.244 Test Acc: 0.920
Validation loss decreased (-0.913041 --> -0.920287).  Saving model ...
Epoch: 16 cost time: 0.450803279876709
Epoch: 16, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.256 Vali Acc: 0.913 Test Loss: 0.256 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.47841930389404297
Epoch: 17, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.229 Vali Acc: 0.920 Test Loss: 0.229 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920288).  Saving model ...
Epoch: 18 cost time: 0.553077220916748
Epoch: 18, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.239 Vali Acc: 0.928 Test Loss: 0.239 Test Acc: 0.928
Validation loss decreased (-0.920288 --> -0.927534).  Saving model ...
Epoch: 19 cost time: 0.44860386848449707
Epoch: 19, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.238 Vali Acc: 0.928 Test Loss: 0.238 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 20 cost time: 0.4760913848876953
Epoch: 20, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.231 Vali Acc: 0.928 Test Loss: 0.231 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 21 cost time: 0.5353794097900391
Epoch: 21, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.217 Vali Acc: 0.920 Test Loss: 0.217 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5368640422821045
Epoch: 22, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.230 Vali Acc: 0.928 Test Loss: 0.230 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 23 cost time: 0.5552942752838135
Epoch: 23, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.213 Vali Acc: 0.920 Test Loss: 0.213 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.550147294998169
Epoch: 24, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.273 Vali Acc: 0.920 Test Loss: 0.273 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5727102756500244
Epoch: 25, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.202 Vali Acc: 0.928 Test Loss: 0.202 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 26 cost time: 0.4803283214569092
Epoch: 26, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.223 Vali Acc: 0.928 Test Loss: 0.223 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5121474266052246
Epoch: 27, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.234 Vali Acc: 0.920 Test Loss: 0.234 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.541379451751709
Epoch: 28, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.232 Vali Acc: 0.913 Test Loss: 0.232 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.5596132278442383
Epoch: 29, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.225 Vali Acc: 0.920 Test Loss: 0.225 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.5327630043029785
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.928 Test Loss: 0.225 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.5964338779449463
Epoch: 31, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.928 Test Loss: 0.224 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.5209565162658691
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.928 Test Loss: 0.221 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.545180082321167
Epoch: 33, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.928 Test Loss: 0.223 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.5254964828491211
Epoch: 34, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.928 Test Loss: 0.226 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.5788419246673584
Epoch: 35, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.920 Test Loss: 0.219 Test Acc: 0.920
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm512_cs16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.927536231884058
model parameter : 162620
model size : 0.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm512_cs15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.756964921951294
Epoch: 1, Steps: 9 | Train Loss: 1.430 Vali Loss: 1.366 Vali Acc: 0.333 Test Loss: 1.366 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 0.5992143154144287
Epoch: 2, Steps: 9 | Train Loss: 1.350 Vali Loss: 1.281 Vali Acc: 0.377 Test Loss: 1.281 Test Acc: 0.377
Validation loss decreased (-0.333320 --> -0.376799).  Saving model ...
Epoch: 3 cost time: 0.5667552947998047
Epoch: 3, Steps: 9 | Train Loss: 1.237 Vali Loss: 1.190 Vali Acc: 0.406 Test Loss: 1.190 Test Acc: 0.406
Validation loss decreased (-0.376799 --> -0.405785).  Saving model ...
Epoch: 4 cost time: 0.5454401969909668
Epoch: 4, Steps: 9 | Train Loss: 1.125 Vali Loss: 1.105 Vali Acc: 0.428 Test Loss: 1.105 Test Acc: 0.428
Validation loss decreased (-0.405785 --> -0.427525).  Saving model ...
Epoch: 5 cost time: 0.5718250274658203
Epoch: 5, Steps: 9 | Train Loss: 1.013 Vali Loss: 1.030 Vali Acc: 0.464 Test Loss: 1.030 Test Acc: 0.464
Validation loss decreased (-0.427525 --> -0.463758).  Saving model ...
Epoch: 6 cost time: 0.5074572563171387
Epoch: 6, Steps: 9 | Train Loss: 0.915 Vali Loss: 0.958 Vali Acc: 0.507 Test Loss: 0.958 Test Acc: 0.507
Validation loss decreased (-0.463758 --> -0.507237).  Saving model ...
Epoch: 7 cost time: 0.5411717891693115
Epoch: 7, Steps: 9 | Train Loss: 0.789 Vali Loss: 0.849 Vali Acc: 0.609 Test Loss: 0.849 Test Acc: 0.609
Validation loss decreased (-0.507237 --> -0.608687).  Saving model ...
Epoch: 8 cost time: 0.5289249420166016
Epoch: 8, Steps: 9 | Train Loss: 0.654 Vali Loss: 0.700 Vali Acc: 0.754 Test Loss: 0.700 Test Acc: 0.754
Validation loss decreased (-0.608687 --> -0.753616).  Saving model ...
Epoch: 9 cost time: 0.5500164031982422
Epoch: 9, Steps: 9 | Train Loss: 0.468 Vali Loss: 0.542 Vali Acc: 0.841 Test Loss: 0.542 Test Acc: 0.841
Validation loss decreased (-0.753616 --> -0.840574).  Saving model ...
Epoch: 10 cost time: 0.5264718532562256
Epoch: 10, Steps: 9 | Train Loss: 0.305 Vali Loss: 0.409 Vali Acc: 0.870 Test Loss: 0.409 Test Acc: 0.870
Validation loss decreased (-0.840574 --> -0.869561).  Saving model ...
Epoch: 11 cost time: 0.6635193824768066
Epoch: 11, Steps: 9 | Train Loss: 0.192 Vali Loss: 0.358 Vali Acc: 0.877 Test Loss: 0.358 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876808).  Saving model ...
Epoch: 12 cost time: 0.6398446559906006
Epoch: 12, Steps: 9 | Train Loss: 0.141 Vali Loss: 0.347 Vali Acc: 0.884 Test Loss: 0.347 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884055).  Saving model ...
Epoch: 13 cost time: 0.5623574256896973
Epoch: 13, Steps: 9 | Train Loss: 0.117 Vali Loss: 0.294 Vali Acc: 0.906 Test Loss: 0.294 Test Acc: 0.906
Validation loss decreased (-0.884055 --> -0.905794).  Saving model ...
Epoch: 14 cost time: 0.5725882053375244
Epoch: 14, Steps: 9 | Train Loss: 0.102 Vali Loss: 0.261 Vali Acc: 0.920 Test Loss: 0.261 Test Acc: 0.920
Validation loss decreased (-0.905794 --> -0.920287).  Saving model ...
Epoch: 15 cost time: 0.6302425861358643
Epoch: 15, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.302 Vali Acc: 0.899 Test Loss: 0.302 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5186293125152588
Epoch: 16, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.247 Vali Acc: 0.920 Test Loss: 0.247 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 17 cost time: 0.6596987247467041
Epoch: 17, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.242 Vali Acc: 0.920 Test Loss: 0.242 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 18 cost time: 0.6239726543426514
Epoch: 18, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.244 Vali Acc: 0.949 Test Loss: 0.244 Test Acc: 0.949
Validation loss decreased (-0.920287 --> -0.949273).  Saving model ...
Epoch: 19 cost time: 0.5033996105194092
Epoch: 19, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.255 Vali Acc: 0.949 Test Loss: 0.255 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5949125289916992
Epoch: 20, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.226 Vali Acc: 0.964 Test Loss: 0.226 Test Acc: 0.964
Validation loss decreased (-0.949273 --> -0.963766).  Saving model ...
Epoch: 21 cost time: 0.5706028938293457
Epoch: 21, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.229 Vali Acc: 0.964 Test Loss: 0.229 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6250693798065186
Epoch: 22, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.225 Vali Acc: 0.964 Test Loss: 0.225 Test Acc: 0.964
Validation loss decreased (-0.963766 --> -0.963766).  Saving model ...
Epoch: 23 cost time: 0.5911405086517334
Epoch: 23, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.232 Vali Acc: 0.964 Test Loss: 0.232 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5615139007568359
Epoch: 24, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.232 Vali Acc: 0.964 Test Loss: 0.232 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.561427116394043
Epoch: 25, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.228 Vali Acc: 0.964 Test Loss: 0.228 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.6187129020690918
Epoch: 26, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.235 Vali Acc: 0.964 Test Loss: 0.235 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.6028611660003662
Epoch: 27, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.236 Vali Acc: 0.971 Test Loss: 0.236 Test Acc: 0.971
Validation loss decreased (-0.963766 --> -0.971012).  Saving model ...
Epoch: 28 cost time: 0.6265723705291748
Epoch: 28, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.233 Vali Acc: 0.971 Test Loss: 0.233 Test Acc: 0.971
Validation loss decreased (-0.971012 --> -0.971012).  Saving model ...
Epoch: 29 cost time: 0.487809419631958
Epoch: 29, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.228 Vali Acc: 0.971 Test Loss: 0.228 Test Acc: 0.971
Validation loss decreased (-0.971012 --> -0.971012).  Saving model ...
Epoch: 30 cost time: 0.5367710590362549
Epoch: 30, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.234 Vali Acc: 0.971 Test Loss: 0.234 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6289644241333008
Epoch: 31, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.238 Vali Acc: 0.971 Test Loss: 0.238 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.6612043380737305
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.244 Vali Acc: 0.971 Test Loss: 0.244 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.5929281711578369
Epoch: 33, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.244 Vali Acc: 0.971 Test Loss: 0.244 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.5979809761047363
Epoch: 34, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.242 Vali Acc: 0.964 Test Loss: 0.242 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.621999979019165
Epoch: 35, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.964 Test Loss: 0.241 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.6016347408294678
Epoch: 36, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.971 Test Loss: 0.241 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.637739896774292
Epoch: 37, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.244 Vali Acc: 0.964 Test Loss: 0.244 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.6158726215362549
Epoch: 38, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.244 Vali Acc: 0.964 Test Loss: 0.244 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.5950124263763428
Epoch: 39, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.247 Vali Acc: 0.971 Test Loss: 0.247 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm512_cs15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9710144927536232
model parameter : 162834
model size : 0.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm512_cs14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.8938052654266357
Epoch: 1, Steps: 9 | Train Loss: 1.538 Vali Loss: 1.389 Vali Acc: 0.413 Test Loss: 1.389 Test Acc: 0.413
Validation loss decreased (inf --> -0.413030).  Saving model ...
Epoch: 2 cost time: 0.5583200454711914
Epoch: 2, Steps: 9 | Train Loss: 1.462 Vali Loss: 1.298 Vali Acc: 0.507 Test Loss: 1.298 Test Acc: 0.507
Validation loss decreased (-0.413030 --> -0.507233).  Saving model ...
Epoch: 3 cost time: 0.5627901554107666
Epoch: 3, Steps: 9 | Train Loss: 1.308 Vali Loss: 1.204 Vali Acc: 0.522 Test Loss: 1.204 Test Acc: 0.522
Validation loss decreased (-0.507233 --> -0.521727).  Saving model ...
Epoch: 4 cost time: 0.5166068077087402
Epoch: 4, Steps: 9 | Train Loss: 1.186 Vali Loss: 1.124 Vali Acc: 0.493 Test Loss: 1.124 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6495239734649658
Epoch: 5, Steps: 9 | Train Loss: 1.069 Vali Loss: 1.074 Vali Acc: 0.493 Test Loss: 1.074 Test Acc: 0.493
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5634331703186035
Epoch: 6, Steps: 9 | Train Loss: 0.972 Vali Loss: 1.021 Vali Acc: 0.522 Test Loss: 1.021 Test Acc: 0.522
Validation loss decreased (-0.521727 --> -0.521729).  Saving model ...
Epoch: 7 cost time: 0.5722780227661133
Epoch: 7, Steps: 9 | Train Loss: 0.861 Vali Loss: 0.960 Vali Acc: 0.543 Test Loss: 0.960 Test Acc: 0.543
Validation loss decreased (-0.521729 --> -0.543469).  Saving model ...
Epoch: 8 cost time: 0.5489001274108887
Epoch: 8, Steps: 9 | Train Loss: 0.758 Vali Loss: 0.872 Vali Acc: 0.645 Test Loss: 0.872 Test Acc: 0.645
Validation loss decreased (-0.543469 --> -0.644919).  Saving model ...
Epoch: 9 cost time: 0.5709760189056396
Epoch: 9, Steps: 9 | Train Loss: 0.606 Vali Loss: 0.722 Vali Acc: 0.732 Test Loss: 0.722 Test Acc: 0.732
Validation loss decreased (-0.644919 --> -0.731877).  Saving model ...
Epoch: 10 cost time: 0.5516431331634521
Epoch: 10, Steps: 9 | Train Loss: 0.432 Vali Loss: 0.542 Vali Acc: 0.826 Test Loss: 0.542 Test Acc: 0.826
Validation loss decreased (-0.731877 --> -0.826082).  Saving model ...
Epoch: 11 cost time: 0.5249648094177246
Epoch: 11, Steps: 9 | Train Loss: 0.240 Vali Loss: 0.397 Vali Acc: 0.870 Test Loss: 0.397 Test Acc: 0.870
Validation loss decreased (-0.826082 --> -0.869561).  Saving model ...
Epoch: 12 cost time: 0.5156714916229248
Epoch: 12, Steps: 9 | Train Loss: 0.136 Vali Loss: 0.309 Vali Acc: 0.906 Test Loss: 0.309 Test Acc: 0.906
Validation loss decreased (-0.869561 --> -0.905794).  Saving model ...
Epoch: 13 cost time: 0.8061661720275879
Epoch: 13, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.310 Vali Acc: 0.913 Test Loss: 0.310 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913040).  Saving model ...
Epoch: 14 cost time: 0.6404953002929688
Epoch: 14, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.307 Vali Acc: 0.913 Test Loss: 0.307 Test Acc: 0.913
Validation loss decreased (-0.913040 --> -0.913040).  Saving model ...
Epoch: 15 cost time: 0.5518743991851807
Epoch: 15, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.280 Vali Acc: 0.928 Test Loss: 0.280 Test Acc: 0.928
Validation loss decreased (-0.913040 --> -0.927533).  Saving model ...
Epoch: 16 cost time: 0.571789026260376
Epoch: 16, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.290 Vali Acc: 0.928 Test Loss: 0.290 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6399288177490234
Epoch: 17, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.302 Vali Acc: 0.928 Test Loss: 0.302 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.5744211673736572
Epoch: 18, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.295 Vali Acc: 0.935 Test Loss: 0.295 Test Acc: 0.935
Validation loss decreased (-0.927533 --> -0.934780).  Saving model ...
Epoch: 19 cost time: 0.6419830322265625
Epoch: 19, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.317 Vali Acc: 0.920 Test Loss: 0.317 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7587149143218994
Epoch: 20, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.341 Vali Acc: 0.920 Test Loss: 0.341 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.545325756072998
Epoch: 21, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.323 Vali Acc: 0.935 Test Loss: 0.323 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.7030220031738281
Epoch: 22, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.334 Vali Acc: 0.928 Test Loss: 0.334 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.5887575149536133
Epoch: 23, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.357 Vali Acc: 0.920 Test Loss: 0.357 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.5961258411407471
Epoch: 24, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.356 Vali Acc: 0.928 Test Loss: 0.356 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.6430089473724365
Epoch: 25, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.359 Vali Acc: 0.920 Test Loss: 0.359 Test Acc: 0.920
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.6495711803436279
Epoch: 26, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.359 Vali Acc: 0.935 Test Loss: 0.359 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.5580782890319824
Epoch: 27, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.361 Vali Acc: 0.935 Test Loss: 0.361 Test Acc: 0.935
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.6384966373443604
Epoch: 28, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.376 Vali Acc: 0.928 Test Loss: 0.376 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm512_cs14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9347826086956522
model parameter : 162640
model size : 0.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm512_cs13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.7160844802856445
Epoch: 1, Steps: 9 | Train Loss: 1.388 Vali Loss: 1.290 Vali Acc: 0.362 Test Loss: 1.290 Test Acc: 0.362
Validation loss decreased (inf --> -0.362306).  Saving model ...
Epoch: 2 cost time: 0.5630285739898682
Epoch: 2, Steps: 9 | Train Loss: 1.313 Vali Loss: 1.224 Vali Acc: 0.413 Test Loss: 1.224 Test Acc: 0.413
Validation loss decreased (-0.362306 --> -0.413031).  Saving model ...
Epoch: 3 cost time: 0.5882306098937988
Epoch: 3, Steps: 9 | Train Loss: 1.216 Vali Loss: 1.154 Vali Acc: 0.464 Test Loss: 1.154 Test Acc: 0.464
Validation loss decreased (-0.413031 --> -0.463757).  Saving model ...
Epoch: 4 cost time: 0.4691004753112793
Epoch: 4, Steps: 9 | Train Loss: 1.116 Vali Loss: 1.103 Vali Acc: 0.471 Test Loss: 1.103 Test Acc: 0.471
Validation loss decreased (-0.463757 --> -0.471003).  Saving model ...
Epoch: 5 cost time: 0.5744507312774658
Epoch: 5, Steps: 9 | Train Loss: 1.040 Vali Loss: 1.066 Vali Acc: 0.449 Test Loss: 1.066 Test Acc: 0.449
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6180388927459717
Epoch: 6, Steps: 9 | Train Loss: 0.952 Vali Loss: 1.037 Vali Acc: 0.464 Test Loss: 1.037 Test Acc: 0.464
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.507321834564209
Epoch: 7, Steps: 9 | Train Loss: 0.872 Vali Loss: 1.012 Vali Acc: 0.471 Test Loss: 1.012 Test Acc: 0.471
Validation loss decreased (-0.471003 --> -0.471004).  Saving model ...
Epoch: 8 cost time: 0.6890254020690918
Epoch: 8, Steps: 9 | Train Loss: 0.806 Vali Loss: 0.972 Vali Acc: 0.522 Test Loss: 0.972 Test Acc: 0.522
Validation loss decreased (-0.471004 --> -0.521729).  Saving model ...
Epoch: 9 cost time: 0.5903129577636719
Epoch: 9, Steps: 9 | Train Loss: 0.747 Vali Loss: 0.930 Vali Acc: 0.594 Test Loss: 0.930 Test Acc: 0.594
Validation loss decreased (-0.521729 --> -0.594194).  Saving model ...
Epoch: 10 cost time: 0.7061069011688232
Epoch: 10, Steps: 9 | Train Loss: 0.650 Vali Loss: 0.877 Vali Acc: 0.609 Test Loss: 0.877 Test Acc: 0.609
Validation loss decreased (-0.594194 --> -0.608687).  Saving model ...
Epoch: 11 cost time: 0.6416542530059814
Epoch: 11, Steps: 9 | Train Loss: 0.565 Vali Loss: 0.791 Vali Acc: 0.652 Test Loss: 0.791 Test Acc: 0.652
Validation loss decreased (-0.608687 --> -0.652166).  Saving model ...
Epoch: 12 cost time: 0.6877295970916748
Epoch: 12, Steps: 9 | Train Loss: 0.435 Vali Loss: 0.662 Vali Acc: 0.746 Test Loss: 0.662 Test Acc: 0.746
Validation loss decreased (-0.652166 --> -0.746370).  Saving model ...
Epoch: 13 cost time: 0.5499067306518555
Epoch: 13, Steps: 9 | Train Loss: 0.298 Vali Loss: 0.485 Vali Acc: 0.819 Test Loss: 0.485 Test Acc: 0.819
Validation loss decreased (-0.746370 --> -0.818836).  Saving model ...
Epoch: 14 cost time: 0.45118284225463867
Epoch: 14, Steps: 9 | Train Loss: 0.177 Vali Loss: 0.420 Vali Acc: 0.848 Test Loss: 0.420 Test Acc: 0.848
Validation loss decreased (-0.818836 --> -0.847822).  Saving model ...
Epoch: 15 cost time: 0.5544941425323486
Epoch: 15, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.354 Vali Acc: 0.877 Test Loss: 0.354 Test Acc: 0.877
Validation loss decreased (-0.847822 --> -0.876808).  Saving model ...
Epoch: 16 cost time: 0.6232073307037354
Epoch: 16, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.316 Vali Acc: 0.906 Test Loss: 0.316 Test Acc: 0.906
Validation loss decreased (-0.876808 --> -0.905794).  Saving model ...
Epoch: 17 cost time: 0.580498218536377
Epoch: 17, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.316 Vali Acc: 0.870 Test Loss: 0.316 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5548596382141113
Epoch: 18, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.312 Vali Acc: 0.884 Test Loss: 0.312 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.5798320770263672
Epoch: 19, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.305 Vali Acc: 0.906 Test Loss: 0.305 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 20 cost time: 0.5440053939819336
Epoch: 20, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.327 Vali Acc: 0.913 Test Loss: 0.327 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913040).  Saving model ...
Epoch: 21 cost time: 0.5920078754425049
Epoch: 21, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.366 Vali Acc: 0.891 Test Loss: 0.366 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5061886310577393
Epoch: 22, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.378 Vali Acc: 0.884 Test Loss: 0.378 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5619285106658936
Epoch: 23, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.366 Vali Acc: 0.891 Test Loss: 0.366 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.5995488166809082
Epoch: 24, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.398 Vali Acc: 0.891 Test Loss: 0.398 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.557868242263794
Epoch: 25, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.404 Vali Acc: 0.891 Test Loss: 0.404 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.47929930686950684
Epoch: 26, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.413 Vali Acc: 0.913 Test Loss: 0.413 Test Acc: 0.913
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.5833215713500977
Epoch: 27, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.420 Vali Acc: 0.899 Test Loss: 0.420 Test Acc: 0.899
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.6371068954467773
Epoch: 28, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.431 Vali Acc: 0.891 Test Loss: 0.431 Test Acc: 0.891
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.6048853397369385
Epoch: 29, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.419 Vali Acc: 0.899 Test Loss: 0.419 Test Acc: 0.899
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.600344181060791
Epoch: 30, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.418 Vali Acc: 0.913 Test Loss: 0.418 Test Acc: 0.913
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm512_cs13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 162038
model size : 0.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm512_cs12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.8901455402374268
Epoch: 1, Steps: 9 | Train Loss: 1.370 Vali Loss: 1.373 Vali Acc: 0.319 Test Loss: 1.373 Test Acc: 0.319
Validation loss decreased (inf --> -0.318827).  Saving model ...
Epoch: 2 cost time: 0.553591251373291
Epoch: 2, Steps: 9 | Train Loss: 1.303 Vali Loss: 1.296 Vali Acc: 0.370 Test Loss: 1.296 Test Acc: 0.370
Validation loss decreased (-0.318827 --> -0.369552).  Saving model ...
Epoch: 3 cost time: 0.7642643451690674
Epoch: 3, Steps: 9 | Train Loss: 1.202 Vali Loss: 1.216 Vali Acc: 0.442 Test Loss: 1.216 Test Acc: 0.442
Validation loss decreased (-0.369552 --> -0.442017).  Saving model ...
Epoch: 4 cost time: 0.5526614189147949
Epoch: 4, Steps: 9 | Train Loss: 1.100 Vali Loss: 1.152 Vali Acc: 0.507 Test Loss: 1.152 Test Acc: 0.507
Validation loss decreased (-0.442017 --> -0.507235).  Saving model ...
Epoch: 5 cost time: 0.5451037883758545
Epoch: 5, Steps: 9 | Train Loss: 1.016 Vali Loss: 1.109 Vali Acc: 0.493 Test Loss: 1.109 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.532757043838501
Epoch: 6, Steps: 9 | Train Loss: 0.934 Vali Loss: 1.068 Vali Acc: 0.522 Test Loss: 1.068 Test Acc: 0.522
Validation loss decreased (-0.507235 --> -0.521728).  Saving model ...
Epoch: 7 cost time: 0.5770037174224854
Epoch: 7, Steps: 9 | Train Loss: 0.866 Vali Loss: 1.040 Vali Acc: 0.565 Test Loss: 1.040 Test Acc: 0.565
Validation loss decreased (-0.521728 --> -0.565207).  Saving model ...
Epoch: 8 cost time: 0.526113748550415
Epoch: 8, Steps: 9 | Train Loss: 0.803 Vali Loss: 1.005 Vali Acc: 0.558 Test Loss: 1.005 Test Acc: 0.558
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6737790107727051
Epoch: 9, Steps: 9 | Train Loss: 0.742 Vali Loss: 0.967 Vali Acc: 0.601 Test Loss: 0.967 Test Acc: 0.601
Validation loss decreased (-0.565207 --> -0.601440).  Saving model ...
Epoch: 10 cost time: 0.5591340065002441
Epoch: 10, Steps: 9 | Train Loss: 0.644 Vali Loss: 0.878 Vali Acc: 0.630 Test Loss: 0.878 Test Acc: 0.630
Validation loss decreased (-0.601440 --> -0.630426).  Saving model ...
Epoch: 11 cost time: 0.5671448707580566
Epoch: 11, Steps: 9 | Train Loss: 0.533 Vali Loss: 0.736 Vali Acc: 0.732 Test Loss: 0.736 Test Acc: 0.732
Validation loss decreased (-0.630426 --> -0.731877).  Saving model ...
Epoch: 12 cost time: 0.6146037578582764
Epoch: 12, Steps: 9 | Train Loss: 0.388 Vali Loss: 0.555 Vali Acc: 0.804 Test Loss: 0.555 Test Acc: 0.804
Validation loss decreased (-0.731877 --> -0.804342).  Saving model ...
Epoch: 13 cost time: 0.518902063369751
Epoch: 13, Steps: 9 | Train Loss: 0.233 Vali Loss: 0.391 Vali Acc: 0.841 Test Loss: 0.391 Test Acc: 0.841
Validation loss decreased (-0.804342 --> -0.840576).  Saving model ...
Epoch: 14 cost time: 0.6954729557037354
Epoch: 14, Steps: 9 | Train Loss: 0.131 Vali Loss: 0.319 Vali Acc: 0.870 Test Loss: 0.319 Test Acc: 0.870
Validation loss decreased (-0.840576 --> -0.869562).  Saving model ...
Epoch: 15 cost time: 0.5769140720367432
Epoch: 15, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.294 Vali Acc: 0.891 Test Loss: 0.294 Test Acc: 0.891
Validation loss decreased (-0.869562 --> -0.891301).  Saving model ...
Epoch: 16 cost time: 0.6247286796569824
Epoch: 16, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.316 Vali Acc: 0.891 Test Loss: 0.316 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6408123970031738
Epoch: 17, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.291 Vali Acc: 0.891 Test Loss: 0.291 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 18 cost time: 0.5839669704437256
Epoch: 18, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.270 Vali Acc: 0.891 Test Loss: 0.270 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891302).  Saving model ...
Epoch: 19 cost time: 0.6808195114135742
Epoch: 19, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.367 Vali Acc: 0.877 Test Loss: 0.367 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6714119911193848
Epoch: 20, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.263 Vali Acc: 0.899 Test Loss: 0.263 Test Acc: 0.899
Validation loss decreased (-0.891302 --> -0.898548).  Saving model ...
Epoch: 21 cost time: 0.6683156490325928
Epoch: 21, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.290 Vali Acc: 0.891 Test Loss: 0.290 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6845393180847168
Epoch: 22, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.296 Vali Acc: 0.891 Test Loss: 0.296 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.654158353805542
Epoch: 23, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.319 Vali Acc: 0.891 Test Loss: 0.319 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.5821874141693115
Epoch: 24, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.303 Vali Acc: 0.906 Test Loss: 0.303 Test Acc: 0.906
Validation loss decreased (-0.898548 --> -0.905794).  Saving model ...
Epoch: 25 cost time: 0.5392038822174072
Epoch: 25, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.309 Vali Acc: 0.913 Test Loss: 0.309 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913040).  Saving model ...
Epoch: 26 cost time: 0.6250977516174316
Epoch: 26, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.289 Vali Acc: 0.913 Test Loss: 0.289 Test Acc: 0.913
Validation loss decreased (-0.913040 --> -0.913041).  Saving model ...
Epoch: 27 cost time: 0.4634058475494385
Epoch: 27, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.323 Vali Acc: 0.906 Test Loss: 0.323 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5671131610870361
Epoch: 28, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.331 Vali Acc: 0.906 Test Loss: 0.331 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6501972675323486
Epoch: 29, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.322 Vali Acc: 0.906 Test Loss: 0.322 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.5957856178283691
Epoch: 30, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.351 Vali Acc: 0.899 Test Loss: 0.351 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.5565545558929443
Epoch: 31, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.340 Vali Acc: 0.906 Test Loss: 0.340 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.5785262584686279
Epoch: 32, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.337 Vali Acc: 0.906 Test Loss: 0.337 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.6531016826629639
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.352 Vali Acc: 0.906 Test Loss: 0.352 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.6529724597930908
Epoch: 34, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.339 Vali Acc: 0.906 Test Loss: 0.339 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.5997617244720459
Epoch: 35, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.345 Vali Acc: 0.906 Test Loss: 0.345 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.5625207424163818
Epoch: 36, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.393 Vali Acc: 0.899 Test Loss: 0.393 Test Acc: 0.899
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm512_cs12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 163574
model size : 0.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm512_cs11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.147125005722046
Epoch: 1, Steps: 9 | Train Loss: 1.359 Vali Loss: 1.361 Vali Acc: 0.399 Test Loss: 1.361 Test Acc: 0.399
Validation loss decreased (inf --> -0.398537).  Saving model ...
Epoch: 2 cost time: 0.47066545486450195
Epoch: 2, Steps: 9 | Train Loss: 1.278 Vali Loss: 1.277 Vali Acc: 0.457 Test Loss: 1.277 Test Acc: 0.457
Validation loss decreased (-0.398537 --> -0.456509).  Saving model ...
Epoch: 3 cost time: 0.5052824020385742
Epoch: 3, Steps: 9 | Train Loss: 1.161 Vali Loss: 1.177 Vali Acc: 0.543 Test Loss: 1.177 Test Acc: 0.543
Validation loss decreased (-0.456509 --> -0.543466).  Saving model ...
Epoch: 4 cost time: 0.5130362510681152
Epoch: 4, Steps: 9 | Train Loss: 1.047 Vali Loss: 1.091 Vali Acc: 0.565 Test Loss: 1.091 Test Acc: 0.565
Validation loss decreased (-0.543466 --> -0.565206).  Saving model ...
Epoch: 5 cost time: 0.6020987033843994
Epoch: 5, Steps: 9 | Train Loss: 0.929 Vali Loss: 1.011 Vali Acc: 0.609 Test Loss: 1.011 Test Acc: 0.609
Validation loss decreased (-0.565206 --> -0.608686).  Saving model ...
Epoch: 6 cost time: 0.5124483108520508
Epoch: 6, Steps: 9 | Train Loss: 0.812 Vali Loss: 0.943 Vali Acc: 0.623 Test Loss: 0.943 Test Acc: 0.623
Validation loss decreased (-0.608686 --> -0.623179).  Saving model ...
Epoch: 7 cost time: 0.6434566974639893
Epoch: 7, Steps: 9 | Train Loss: 0.685 Vali Loss: 0.820 Vali Acc: 0.703 Test Loss: 0.820 Test Acc: 0.703
Validation loss decreased (-0.623179 --> -0.702890).  Saving model ...
Epoch: 8 cost time: 0.5420346260070801
Epoch: 8, Steps: 9 | Train Loss: 0.541 Vali Loss: 0.657 Vali Acc: 0.790 Test Loss: 0.657 Test Acc: 0.790
Validation loss decreased (-0.702890 --> -0.789849).  Saving model ...
Epoch: 9 cost time: 0.5794820785522461
Epoch: 9, Steps: 9 | Train Loss: 0.378 Vali Loss: 0.477 Vali Acc: 0.855 Test Loss: 0.477 Test Acc: 0.855
Validation loss decreased (-0.789849 --> -0.855068).  Saving model ...
Epoch: 10 cost time: 0.5371448993682861
Epoch: 10, Steps: 9 | Train Loss: 0.242 Vali Loss: 0.353 Vali Acc: 0.877 Test Loss: 0.353 Test Acc: 0.877
Validation loss decreased (-0.855068 --> -0.876808).  Saving model ...
Epoch: 11 cost time: 0.5910334587097168
Epoch: 11, Steps: 9 | Train Loss: 0.149 Vali Loss: 0.294 Vali Acc: 0.913 Test Loss: 0.294 Test Acc: 0.913
Validation loss decreased (-0.876808 --> -0.913041).  Saving model ...
Epoch: 12 cost time: 0.6455800533294678
Epoch: 12, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.251 Vali Acc: 0.920 Test Loss: 0.251 Test Acc: 0.920
Validation loss decreased (-0.913041 --> -0.920287).  Saving model ...
Epoch: 13 cost time: 0.5215492248535156
Epoch: 13, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.233 Vali Acc: 0.913 Test Loss: 0.233 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6956706047058105
Epoch: 14, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.230 Vali Acc: 0.913 Test Loss: 0.230 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6510627269744873
Epoch: 15, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.214 Vali Acc: 0.928 Test Loss: 0.214 Test Acc: 0.928
Validation loss decreased (-0.920287 --> -0.927534).  Saving model ...
Epoch: 16 cost time: 0.5121984481811523
Epoch: 16, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.227 Vali Acc: 0.928 Test Loss: 0.227 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5444638729095459
Epoch: 17, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.218 Vali Acc: 0.935 Test Loss: 0.218 Test Acc: 0.935
Validation loss decreased (-0.927534 --> -0.934780).  Saving model ...
Epoch: 18 cost time: 0.6743149757385254
Epoch: 18, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.194 Vali Acc: 0.942 Test Loss: 0.194 Test Acc: 0.942
Validation loss decreased (-0.934780 --> -0.942027).  Saving model ...
Epoch: 19 cost time: 0.5054571628570557
Epoch: 19, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.196 Vali Acc: 0.935 Test Loss: 0.196 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5355393886566162
Epoch: 20, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.209 Vali Acc: 0.935 Test Loss: 0.209 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5509068965911865
Epoch: 21, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.208 Vali Acc: 0.942 Test Loss: 0.208 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.5425260066986084
Epoch: 22, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.199 Vali Acc: 0.928 Test Loss: 0.199 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.5828347206115723
Epoch: 23, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.202 Vali Acc: 0.942 Test Loss: 0.202 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.6143448352813721
Epoch: 24, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.211 Vali Acc: 0.942 Test Loss: 0.211 Test Acc: 0.942
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.5377621650695801
Epoch: 25, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.209 Vali Acc: 0.942 Test Loss: 0.209 Test Acc: 0.942
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.5954611301422119
Epoch: 26, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.221 Vali Acc: 0.942 Test Loss: 0.221 Test Acc: 0.942
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.5221214294433594
Epoch: 27, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.215 Vali Acc: 0.942 Test Loss: 0.215 Test Acc: 0.942
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.5494565963745117
Epoch: 28, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.211 Vali Acc: 0.942 Test Loss: 0.211 Test Acc: 0.942
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm512_cs11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9420289855072463
model parameter : 161954
model size : 0.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm512_cs10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.8396234512329102
Epoch: 1, Steps: 9 | Train Loss: 1.410 Vali Loss: 1.323 Vali Acc: 0.413 Test Loss: 1.323 Test Acc: 0.413
Validation loss decreased (inf --> -0.413030).  Saving model ...
Epoch: 2 cost time: 0.5282261371612549
Epoch: 2, Steps: 9 | Train Loss: 1.330 Vali Loss: 1.249 Vali Acc: 0.442 Test Loss: 1.249 Test Acc: 0.442
Validation loss decreased (-0.413030 --> -0.442016).  Saving model ...
Epoch: 3 cost time: 0.5982451438903809
Epoch: 3, Steps: 9 | Train Loss: 1.226 Vali Loss: 1.170 Vali Acc: 0.449 Test Loss: 1.170 Test Acc: 0.449
Validation loss decreased (-0.442016 --> -0.449264).  Saving model ...
Epoch: 4 cost time: 0.5494976043701172
Epoch: 4, Steps: 9 | Train Loss: 1.118 Vali Loss: 1.103 Vali Acc: 0.507 Test Loss: 1.103 Test Acc: 0.507
Validation loss decreased (-0.449264 --> -0.507235).  Saving model ...
Epoch: 5 cost time: 0.6333506107330322
Epoch: 5, Steps: 9 | Train Loss: 1.012 Vali Loss: 1.052 Vali Acc: 0.558 Test Loss: 1.052 Test Acc: 0.558
Validation loss decreased (-0.507235 --> -0.557960).  Saving model ...
Epoch: 6 cost time: 0.634880781173706
Epoch: 6, Steps: 9 | Train Loss: 0.927 Vali Loss: 0.992 Vali Acc: 0.601 Test Loss: 0.992 Test Acc: 0.601
Validation loss decreased (-0.557960 --> -0.601439).  Saving model ...
Epoch: 7 cost time: 0.5849025249481201
Epoch: 7, Steps: 9 | Train Loss: 0.823 Vali Loss: 0.927 Vali Acc: 0.623 Test Loss: 0.927 Test Acc: 0.623
Validation loss decreased (-0.601439 --> -0.623179).  Saving model ...
Epoch: 8 cost time: 0.5978155136108398
Epoch: 8, Steps: 9 | Train Loss: 0.696 Vali Loss: 0.816 Vali Acc: 0.659 Test Loss: 0.816 Test Acc: 0.659
Validation loss decreased (-0.623179 --> -0.659412).  Saving model ...
Epoch: 9 cost time: 0.535860538482666
Epoch: 9, Steps: 9 | Train Loss: 0.537 Vali Loss: 0.617 Vali Acc: 0.804 Test Loss: 0.617 Test Acc: 0.804
Validation loss decreased (-0.659412 --> -0.804342).  Saving model ...
Epoch: 10 cost time: 0.6706809997558594
Epoch: 10, Steps: 9 | Train Loss: 0.347 Vali Loss: 0.466 Vali Acc: 0.819 Test Loss: 0.466 Test Acc: 0.819
Validation loss decreased (-0.804342 --> -0.818836).  Saving model ...
Epoch: 11 cost time: 0.6370446681976318
Epoch: 11, Steps: 9 | Train Loss: 0.222 Vali Loss: 0.368 Vali Acc: 0.862 Test Loss: 0.368 Test Acc: 0.862
Validation loss decreased (-0.818836 --> -0.862315).  Saving model ...
Epoch: 12 cost time: 0.5786716938018799
Epoch: 12, Steps: 9 | Train Loss: 0.145 Vali Loss: 0.355 Vali Acc: 0.884 Test Loss: 0.355 Test Acc: 0.884
Validation loss decreased (-0.862315 --> -0.884054).  Saving model ...
Epoch: 13 cost time: 0.6394481658935547
Epoch: 13, Steps: 9 | Train Loss: 0.089 Vali Loss: 0.292 Vali Acc: 0.899 Test Loss: 0.292 Test Acc: 0.899
Validation loss decreased (-0.884054 --> -0.898548).  Saving model ...
Epoch: 14 cost time: 0.6902182102203369
Epoch: 14, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.299 Vali Acc: 0.906 Test Loss: 0.299 Test Acc: 0.906
Validation loss decreased (-0.898548 --> -0.905794).  Saving model ...
Epoch: 15 cost time: 0.6098847389221191
Epoch: 15, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.226 Vali Acc: 0.920 Test Loss: 0.226 Test Acc: 0.920
Validation loss decreased (-0.905794 --> -0.920288).  Saving model ...
Epoch: 16 cost time: 0.6230301856994629
Epoch: 16, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.214 Vali Acc: 0.935 Test Loss: 0.214 Test Acc: 0.935
Validation loss decreased (-0.920288 --> -0.934780).  Saving model ...
Epoch: 17 cost time: 0.6851177215576172
Epoch: 17, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.213 Vali Acc: 0.935 Test Loss: 0.213 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 18 cost time: 0.486680269241333
Epoch: 18, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.215 Vali Acc: 0.935 Test Loss: 0.215 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5809142589569092
Epoch: 19, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.218 Vali Acc: 0.928 Test Loss: 0.218 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6551272869110107
Epoch: 20, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.201 Vali Acc: 0.935 Test Loss: 0.201 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934781).  Saving model ...
Epoch: 21 cost time: 0.571631908416748
Epoch: 21, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.206 Vali Acc: 0.935 Test Loss: 0.206 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6652097702026367
Epoch: 22, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.228 Vali Acc: 0.928 Test Loss: 0.228 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5588726997375488
Epoch: 23, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.214 Vali Acc: 0.928 Test Loss: 0.214 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.565011739730835
Epoch: 24, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.216 Vali Acc: 0.935 Test Loss: 0.216 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.5416426658630371
Epoch: 25, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.218 Vali Acc: 0.928 Test Loss: 0.218 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.6466224193572998
Epoch: 26, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.220 Vali Acc: 0.928 Test Loss: 0.220 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.5315322875976562
Epoch: 27, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.224 Vali Acc: 0.928 Test Loss: 0.224 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.5460963249206543
Epoch: 28, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.229 Vali Acc: 0.935 Test Loss: 0.229 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.6732344627380371
Epoch: 29, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.225 Vali Acc: 0.928 Test Loss: 0.225 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.6089909076690674
Epoch: 30, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.227 Vali Acc: 0.928 Test Loss: 0.227 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm512_cs10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9347826086956522
model parameter : 162072
model size : 0.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm256_cs103_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.903301477432251
Epoch: 1, Steps: 9 | Train Loss: 1.410 Vali Loss: 1.351 Vali Acc: 0.341 Test Loss: 1.351 Test Acc: 0.341
Validation loss decreased (inf --> -0.340566).  Saving model ...
Epoch: 2 cost time: 0.5959274768829346
Epoch: 2, Steps: 9 | Train Loss: 1.343 Vali Loss: 1.278 Vali Acc: 0.362 Test Loss: 1.278 Test Acc: 0.362
Validation loss decreased (-0.340566 --> -0.362306).  Saving model ...
Epoch: 3 cost time: 0.5851783752441406
Epoch: 3, Steps: 9 | Train Loss: 1.231 Vali Loss: 1.198 Vali Acc: 0.478 Test Loss: 1.198 Test Acc: 0.478
Validation loss decreased (-0.362306 --> -0.478249).  Saving model ...
Epoch: 4 cost time: 0.48725175857543945
Epoch: 4, Steps: 9 | Train Loss: 1.123 Vali Loss: 1.137 Vali Acc: 0.507 Test Loss: 1.137 Test Acc: 0.507
Validation loss decreased (-0.478249 --> -0.507235).  Saving model ...
Epoch: 5 cost time: 0.6340429782867432
Epoch: 5, Steps: 9 | Train Loss: 1.023 Vali Loss: 1.088 Vali Acc: 0.529 Test Loss: 1.088 Test Acc: 0.529
Validation loss decreased (-0.507235 --> -0.528975).  Saving model ...
Epoch: 6 cost time: 0.5732297897338867
Epoch: 6, Steps: 9 | Train Loss: 0.965 Vali Loss: 1.048 Vali Acc: 0.522 Test Loss: 1.048 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6021316051483154
Epoch: 7, Steps: 9 | Train Loss: 0.889 Vali Loss: 1.011 Vali Acc: 0.529 Test Loss: 1.011 Test Acc: 0.529
Validation loss decreased (-0.528975 --> -0.528975).  Saving model ...
Epoch: 8 cost time: 0.5048775672912598
Epoch: 8, Steps: 9 | Train Loss: 0.800 Vali Loss: 0.971 Vali Acc: 0.551 Test Loss: 0.971 Test Acc: 0.551
Validation loss decreased (-0.528975 --> -0.550715).  Saving model ...
Epoch: 9 cost time: 0.6089415550231934
Epoch: 9, Steps: 9 | Train Loss: 0.723 Vali Loss: 0.896 Vali Acc: 0.630 Test Loss: 0.896 Test Acc: 0.630
Validation loss decreased (-0.550715 --> -0.630426).  Saving model ...
Epoch: 10 cost time: 0.6242070198059082
Epoch: 10, Steps: 9 | Train Loss: 0.630 Vali Loss: 0.834 Vali Acc: 0.681 Test Loss: 0.834 Test Acc: 0.681
Validation loss decreased (-0.630426 --> -0.681151).  Saving model ...
Epoch: 11 cost time: 0.5505015850067139
Epoch: 11, Steps: 9 | Train Loss: 0.507 Vali Loss: 0.738 Vali Acc: 0.717 Test Loss: 0.738 Test Acc: 0.717
Validation loss decreased (-0.681151 --> -0.717384).  Saving model ...
Epoch: 12 cost time: 0.6240561008453369
Epoch: 12, Steps: 9 | Train Loss: 0.407 Vali Loss: 0.646 Vali Acc: 0.739 Test Loss: 0.646 Test Acc: 0.739
Validation loss decreased (-0.717384 --> -0.739124).  Saving model ...
Epoch: 13 cost time: 0.5259404182434082
Epoch: 13, Steps: 9 | Train Loss: 0.302 Vali Loss: 0.573 Vali Acc: 0.797 Test Loss: 0.573 Test Acc: 0.797
Validation loss decreased (-0.739124 --> -0.797096).  Saving model ...
Epoch: 14 cost time: 0.5168437957763672
Epoch: 14, Steps: 9 | Train Loss: 0.228 Vali Loss: 0.558 Vali Acc: 0.804 Test Loss: 0.558 Test Acc: 0.804
Validation loss decreased (-0.797096 --> -0.804342).  Saving model ...
Epoch: 15 cost time: 0.6281089782714844
Epoch: 15, Steps: 9 | Train Loss: 0.163 Vali Loss: 0.507 Vali Acc: 0.819 Test Loss: 0.507 Test Acc: 0.819
Validation loss decreased (-0.804342 --> -0.818836).  Saving model ...
Epoch: 16 cost time: 0.5455307960510254
Epoch: 16, Steps: 9 | Train Loss: 0.121 Vali Loss: 0.472 Vali Acc: 0.804 Test Loss: 0.472 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5954158306121826
Epoch: 17, Steps: 9 | Train Loss: 0.096 Vali Loss: 0.466 Vali Acc: 0.819 Test Loss: 0.466 Test Acc: 0.819
Validation loss decreased (-0.818836 --> -0.818836).  Saving model ...
Epoch: 18 cost time: 0.7061119079589844
Epoch: 18, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.453 Vali Acc: 0.826 Test Loss: 0.453 Test Acc: 0.826
Validation loss decreased (-0.818836 --> -0.826082).  Saving model ...
Epoch: 19 cost time: 0.5255618095397949
Epoch: 19, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.451 Vali Acc: 0.826 Test Loss: 0.451 Test Acc: 0.826
Validation loss decreased (-0.826082 --> -0.826082).  Saving model ...
Epoch: 20 cost time: 0.5106420516967773
Epoch: 20, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.425 Vali Acc: 0.848 Test Loss: 0.425 Test Acc: 0.848
Validation loss decreased (-0.826082 --> -0.847822).  Saving model ...
Epoch: 21 cost time: 0.542487382888794
Epoch: 21, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.420 Vali Acc: 0.870 Test Loss: 0.420 Test Acc: 0.870
Validation loss decreased (-0.847822 --> -0.869561).  Saving model ...
Epoch: 22 cost time: 0.6388437747955322
Epoch: 22, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.421 Vali Acc: 0.870 Test Loss: 0.421 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6232209205627441
Epoch: 23, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.410 Vali Acc: 0.870 Test Loss: 0.410 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 24 cost time: 0.7032749652862549
Epoch: 24, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.423 Vali Acc: 0.877 Test Loss: 0.423 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876807).  Saving model ...
Epoch: 25 cost time: 0.554276704788208
Epoch: 25, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.441 Vali Acc: 0.877 Test Loss: 0.441 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5093119144439697
Epoch: 26, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.420 Vali Acc: 0.877 Test Loss: 0.420 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876807).  Saving model ...
Epoch: 27 cost time: 0.4959285259246826
Epoch: 27, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.423 Vali Acc: 0.877 Test Loss: 0.423 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.59346604347229
Epoch: 28, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.443 Vali Acc: 0.877 Test Loss: 0.443 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6059167385101318
Epoch: 29, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.452 Vali Acc: 0.877 Test Loss: 0.452 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.6505000591278076
Epoch: 30, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.449 Vali Acc: 0.877 Test Loss: 0.449 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.4853532314300537
Epoch: 31, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.465 Vali Acc: 0.877 Test Loss: 0.465 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.5472278594970703
Epoch: 32, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.450 Vali Acc: 0.877 Test Loss: 0.450 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.5543055534362793
Epoch: 33, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.446 Vali Acc: 0.877 Test Loss: 0.446 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.6028220653533936
Epoch: 34, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.472 Vali Acc: 0.884 Test Loss: 0.472 Test Acc: 0.884
Validation loss decreased (-0.876807 --> -0.884053).  Saving model ...
Epoch: 35 cost time: 0.5508759021759033
Epoch: 35, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.491 Vali Acc: 0.877 Test Loss: 0.491 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.5232226848602295
Epoch: 36, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.484 Vali Acc: 0.884 Test Loss: 0.484 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.5607166290283203
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.458 Vali Acc: 0.891 Test Loss: 0.458 Test Acc: 0.891
Validation loss decreased (-0.884053 --> -0.891300).  Saving model ...
Epoch: 38 cost time: 0.5223283767700195
Epoch: 38, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.491 Vali Acc: 0.891 Test Loss: 0.491 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.7666592597961426
Epoch: 39, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.501 Vali Acc: 0.891 Test Loss: 0.501 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.5297360420227051
Epoch: 40, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.499 Vali Acc: 0.891 Test Loss: 0.499 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.6448209285736084
Epoch: 41, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.503 Vali Acc: 0.891 Test Loss: 0.503 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.5674209594726562
Epoch: 42, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.517 Vali Acc: 0.899 Test Loss: 0.517 Test Acc: 0.899
Validation loss decreased (-0.891300 --> -0.898546).  Saving model ...
Epoch: 43 cost time: 0.48743748664855957
Epoch: 43, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.520 Vali Acc: 0.891 Test Loss: 0.520 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.5421292781829834
Epoch: 44, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.517 Vali Acc: 0.899 Test Loss: 0.517 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.5511305332183838
Epoch: 45, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.522 Vali Acc: 0.899 Test Loss: 0.522 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.52366042137146
Epoch: 46, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.520 Vali Acc: 0.899 Test Loss: 0.520 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.49009037017822266
Epoch: 47, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.523 Vali Acc: 0.899 Test Loss: 0.523 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.4472939968109131
Epoch: 48, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.533 Vali Acc: 0.899 Test Loss: 0.533 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.5409128665924072
Epoch: 49, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.537 Vali Acc: 0.899 Test Loss: 0.537 Test Acc: 0.899
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.5334064960479736
Epoch: 50, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.545 Vali Acc: 0.906 Test Loss: 0.545 Test Acc: 0.906
Validation loss decreased (-0.898546 --> -0.905792).  Saving model ...
Epoch: 51 cost time: 0.5387237071990967
Epoch: 51, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.545 Vali Acc: 0.906 Test Loss: 0.545 Test Acc: 0.906
Validation loss decreased (-0.905792 --> -0.905792).  Saving model ...
Epoch: 52 cost time: 0.544959545135498
Epoch: 52, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.550 Vali Acc: 0.906 Test Loss: 0.550 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.5274467468261719
Epoch: 53, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.563 Vali Acc: 0.906 Test Loss: 0.563 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.628741979598999
Epoch: 54, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.554 Vali Acc: 0.906 Test Loss: 0.554 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.5783162117004395
Epoch: 55, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.548 Vali Acc: 0.906 Test Loss: 0.548 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 0.5207500457763672
Epoch: 56, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.570 Vali Acc: 0.906 Test Loss: 0.570 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 0.635676383972168
Epoch: 57, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.579 Vali Acc: 0.906 Test Loss: 0.579 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 0.6247246265411377
Epoch: 58, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.578 Vali Acc: 0.906 Test Loss: 0.578 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 0.5298938751220703
Epoch: 59, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.582 Vali Acc: 0.906 Test Loss: 0.582 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 0.5109283924102783
Epoch: 60, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.585 Vali Acc: 0.906 Test Loss: 0.585 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 0.6028423309326172
Epoch: 61, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.588 Vali Acc: 0.906 Test Loss: 0.588 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm256_cs103_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 90154
model size : 0.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm256_cs69_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.7540178298950195
Epoch: 1, Steps: 9 | Train Loss: 1.399 Vali Loss: 1.304 Vali Acc: 0.370 Test Loss: 1.304 Test Acc: 0.370
Validation loss decreased (inf --> -0.369552).  Saving model ...
Epoch: 2 cost time: 0.7167606353759766
Epoch: 2, Steps: 9 | Train Loss: 1.328 Vali Loss: 1.228 Vali Acc: 0.471 Test Loss: 1.228 Test Acc: 0.471
Validation loss decreased (-0.369552 --> -0.471002).  Saving model ...
Epoch: 3 cost time: 0.5703451633453369
Epoch: 3, Steps: 9 | Train Loss: 1.232 Vali Loss: 1.155 Vali Acc: 0.442 Test Loss: 1.155 Test Acc: 0.442
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6162781715393066
Epoch: 4, Steps: 9 | Train Loss: 1.128 Vali Loss: 1.097 Vali Acc: 0.478 Test Loss: 1.097 Test Acc: 0.478
Validation loss decreased (-0.471002 --> -0.478250).  Saving model ...
Epoch: 5 cost time: 0.5843861103057861
Epoch: 5, Steps: 9 | Train Loss: 1.028 Vali Loss: 1.052 Vali Acc: 0.478 Test Loss: 1.052 Test Acc: 0.478
Validation loss decreased (-0.478250 --> -0.478250).  Saving model ...
Epoch: 6 cost time: 0.5900423526763916
Epoch: 6, Steps: 9 | Train Loss: 0.968 Vali Loss: 1.021 Vali Acc: 0.478 Test Loss: 1.021 Test Acc: 0.478
Validation loss decreased (-0.478250 --> -0.478251).  Saving model ...
Epoch: 7 cost time: 0.5849130153656006
Epoch: 7, Steps: 9 | Train Loss: 0.882 Vali Loss: 0.995 Vali Acc: 0.543 Test Loss: 0.995 Test Acc: 0.543
Validation loss decreased (-0.478251 --> -0.543468).  Saving model ...
Epoch: 8 cost time: 0.6373810768127441
Epoch: 8, Steps: 9 | Train Loss: 0.809 Vali Loss: 0.965 Vali Acc: 0.558 Test Loss: 0.965 Test Acc: 0.558
Validation loss decreased (-0.543468 --> -0.557961).  Saving model ...
Epoch: 9 cost time: 0.6185410022735596
Epoch: 9, Steps: 9 | Train Loss: 0.741 Vali Loss: 0.929 Vali Acc: 0.558 Test Loss: 0.929 Test Acc: 0.558
Validation loss decreased (-0.557961 --> -0.557962).  Saving model ...
Epoch: 10 cost time: 0.5074872970581055
Epoch: 10, Steps: 9 | Train Loss: 0.688 Vali Loss: 0.868 Vali Acc: 0.623 Test Loss: 0.868 Test Acc: 0.623
Validation loss decreased (-0.557962 --> -0.623180).  Saving model ...
Epoch: 11 cost time: 0.5008668899536133
Epoch: 11, Steps: 9 | Train Loss: 0.577 Vali Loss: 0.780 Vali Acc: 0.674 Test Loss: 0.780 Test Acc: 0.674
Validation loss decreased (-0.623180 --> -0.673905).  Saving model ...
Epoch: 12 cost time: 0.5236246585845947
Epoch: 12, Steps: 9 | Train Loss: 0.482 Vali Loss: 0.676 Vali Acc: 0.725 Test Loss: 0.676 Test Acc: 0.725
Validation loss decreased (-0.673905 --> -0.724631).  Saving model ...
Epoch: 13 cost time: 0.5124237537384033
Epoch: 13, Steps: 9 | Train Loss: 0.360 Vali Loss: 0.570 Vali Acc: 0.775 Test Loss: 0.570 Test Acc: 0.775
Validation loss decreased (-0.724631 --> -0.775357).  Saving model ...
Epoch: 14 cost time: 0.49083995819091797
Epoch: 14, Steps: 9 | Train Loss: 0.263 Vali Loss: 0.478 Vali Acc: 0.848 Test Loss: 0.478 Test Acc: 0.848
Validation loss decreased (-0.775357 --> -0.847821).  Saving model ...
Epoch: 15 cost time: 0.6085076332092285
Epoch: 15, Steps: 9 | Train Loss: 0.189 Vali Loss: 0.425 Vali Acc: 0.862 Test Loss: 0.425 Test Acc: 0.862
Validation loss decreased (-0.847821 --> -0.862315).  Saving model ...
Epoch: 16 cost time: 0.5086328983306885
Epoch: 16, Steps: 9 | Train Loss: 0.138 Vali Loss: 0.354 Vali Acc: 0.870 Test Loss: 0.354 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869562).  Saving model ...
Epoch: 17 cost time: 0.5541536808013916
Epoch: 17, Steps: 9 | Train Loss: 0.098 Vali Loss: 0.351 Vali Acc: 0.877 Test Loss: 0.351 Test Acc: 0.877
Validation loss decreased (-0.869562 --> -0.876808).  Saving model ...
Epoch: 18 cost time: 0.6052522659301758
Epoch: 18, Steps: 9 | Train Loss: 0.080 Vali Loss: 0.328 Vali Acc: 0.870 Test Loss: 0.328 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5637803077697754
Epoch: 19, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.307 Vali Acc: 0.891 Test Loss: 0.307 Test Acc: 0.891
Validation loss decreased (-0.876808 --> -0.891301).  Saving model ...
Epoch: 20 cost time: 0.5280478000640869
Epoch: 20, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.332 Vali Acc: 0.877 Test Loss: 0.332 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6218528747558594
Epoch: 21, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.296 Vali Acc: 0.891 Test Loss: 0.296 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 22 cost time: 0.5793182849884033
Epoch: 22, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.324 Vali Acc: 0.899 Test Loss: 0.324 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898547).  Saving model ...
Epoch: 23 cost time: 0.6126885414123535
Epoch: 23, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.331 Vali Acc: 0.899 Test Loss: 0.331 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6503129005432129
Epoch: 24, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.310 Vali Acc: 0.899 Test Loss: 0.310 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898548).  Saving model ...
Epoch: 25 cost time: 0.5751919746398926
Epoch: 25, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.312 Vali Acc: 0.899 Test Loss: 0.312 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.561722993850708
Epoch: 26, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.311 Vali Acc: 0.899 Test Loss: 0.311 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5773458480834961
Epoch: 27, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.335 Vali Acc: 0.899 Test Loss: 0.335 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6550397872924805
Epoch: 28, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.330 Vali Acc: 0.899 Test Loss: 0.330 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.5655882358551025
Epoch: 29, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.319 Vali Acc: 0.906 Test Loss: 0.319 Test Acc: 0.906
Validation loss decreased (-0.898548 --> -0.905794).  Saving model ...
Epoch: 30 cost time: 0.6783609390258789
Epoch: 30, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.342 Vali Acc: 0.906 Test Loss: 0.342 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6122376918792725
Epoch: 31, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.344 Vali Acc: 0.906 Test Loss: 0.344 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.5970792770385742
Epoch: 32, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.327 Vali Acc: 0.913 Test Loss: 0.327 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913040).  Saving model ...
Epoch: 33 cost time: 0.6035232543945312
Epoch: 33, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.331 Vali Acc: 0.920 Test Loss: 0.331 Test Acc: 0.920
Validation loss decreased (-0.913040 --> -0.920287).  Saving model ...
Epoch: 34 cost time: 0.6266078948974609
Epoch: 34, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.342 Vali Acc: 0.913 Test Loss: 0.342 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.6690154075622559
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.338 Vali Acc: 0.920 Test Loss: 0.338 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.5204975605010986
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.342 Vali Acc: 0.920 Test Loss: 0.342 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.5659096240997314
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.344 Vali Acc: 0.928 Test Loss: 0.344 Test Acc: 0.928
Validation loss decreased (-0.920287 --> -0.927533).  Saving model ...
Epoch: 38 cost time: 0.551724910736084
Epoch: 38, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.350 Vali Acc: 0.928 Test Loss: 0.350 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.6553201675415039
Epoch: 39, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.351 Vali Acc: 0.928 Test Loss: 0.351 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.6111693382263184
Epoch: 40, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.354 Vali Acc: 0.928 Test Loss: 0.354 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.6366240978240967
Epoch: 41, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.352 Vali Acc: 0.928 Test Loss: 0.352 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.6162748336791992
Epoch: 42, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.360 Vali Acc: 0.928 Test Loss: 0.360 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.6634175777435303
Epoch: 43, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.362 Vali Acc: 0.928 Test Loss: 0.362 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.6670491695404053
Epoch: 44, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.371 Vali Acc: 0.928 Test Loss: 0.371 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.601125955581665
Epoch: 45, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.367 Vali Acc: 0.928 Test Loss: 0.367 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.5776095390319824
Epoch: 46, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.367 Vali Acc: 0.928 Test Loss: 0.367 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.6246845722198486
Epoch: 47, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.367 Vali Acc: 0.928 Test Loss: 0.367 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm256_cs69_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.927536231884058
model parameter : 86022
model size : 0.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm256_cs52_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.8630938529968262
Epoch: 1, Steps: 9 | Train Loss: 1.455 Vali Loss: 1.355 Vali Acc: 0.377 Test Loss: 1.355 Test Acc: 0.377
Validation loss decreased (inf --> -0.376798).  Saving model ...
Epoch: 2 cost time: 0.5464770793914795
Epoch: 2, Steps: 9 | Train Loss: 1.382 Vali Loss: 1.276 Vali Acc: 0.420 Test Loss: 1.276 Test Acc: 0.420
Validation loss decreased (-0.376798 --> -0.420277).  Saving model ...
Epoch: 3 cost time: 0.6234743595123291
Epoch: 3, Steps: 9 | Train Loss: 1.282 Vali Loss: 1.196 Vali Acc: 0.471 Test Loss: 1.196 Test Acc: 0.471
Validation loss decreased (-0.420277 --> -0.471003).  Saving model ...
Epoch: 4 cost time: 0.668893575668335
Epoch: 4, Steps: 9 | Train Loss: 1.169 Vali Loss: 1.130 Vali Acc: 0.500 Test Loss: 1.130 Test Acc: 0.500
Validation loss decreased (-0.471003 --> -0.499989).  Saving model ...
Epoch: 5 cost time: 0.5792417526245117
Epoch: 5, Steps: 9 | Train Loss: 1.087 Vali Loss: 1.086 Vali Acc: 0.543 Test Loss: 1.086 Test Acc: 0.543
Validation loss decreased (-0.499989 --> -0.543467).  Saving model ...
Epoch: 6 cost time: 0.599412202835083
Epoch: 6, Steps: 9 | Train Loss: 1.003 Vali Loss: 1.059 Vali Acc: 0.536 Test Loss: 1.059 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5572414398193359
Epoch: 7, Steps: 9 | Train Loss: 0.926 Vali Loss: 1.031 Vali Acc: 0.551 Test Loss: 1.031 Test Acc: 0.551
Validation loss decreased (-0.543467 --> -0.550714).  Saving model ...
Epoch: 8 cost time: 0.5600018501281738
Epoch: 8, Steps: 9 | Train Loss: 0.883 Vali Loss: 1.005 Vali Acc: 0.551 Test Loss: 1.005 Test Acc: 0.551
Validation loss decreased (-0.550714 --> -0.550715).  Saving model ...
Epoch: 9 cost time: 0.5223920345306396
Epoch: 9, Steps: 9 | Train Loss: 0.826 Vali Loss: 0.996 Vali Acc: 0.543 Test Loss: 0.996 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7138237953186035
Epoch: 10, Steps: 9 | Train Loss: 0.783 Vali Loss: 0.983 Vali Acc: 0.558 Test Loss: 0.983 Test Acc: 0.558
Validation loss decreased (-0.550715 --> -0.557961).  Saving model ...
Epoch: 11 cost time: 0.5666000843048096
Epoch: 11, Steps: 9 | Train Loss: 0.739 Vali Loss: 0.971 Vali Acc: 0.558 Test Loss: 0.971 Test Acc: 0.558
Validation loss decreased (-0.557961 --> -0.557961).  Saving model ...
Epoch: 12 cost time: 0.5942165851593018
Epoch: 12, Steps: 9 | Train Loss: 0.685 Vali Loss: 0.957 Vali Acc: 0.587 Test Loss: 0.957 Test Acc: 0.587
Validation loss decreased (-0.557961 --> -0.586947).  Saving model ...
Epoch: 13 cost time: 0.573094367980957
Epoch: 13, Steps: 9 | Train Loss: 0.639 Vali Loss: 0.947 Vali Acc: 0.594 Test Loss: 0.947 Test Acc: 0.594
Validation loss decreased (-0.586947 --> -0.594193).  Saving model ...
Epoch: 14 cost time: 0.5895702838897705
Epoch: 14, Steps: 9 | Train Loss: 0.602 Vali Loss: 0.953 Vali Acc: 0.609 Test Loss: 0.953 Test Acc: 0.609
Validation loss decreased (-0.594193 --> -0.608686).  Saving model ...
Epoch: 15 cost time: 0.6483726501464844
Epoch: 15, Steps: 9 | Train Loss: 0.556 Vali Loss: 0.940 Vali Acc: 0.616 Test Loss: 0.940 Test Acc: 0.616
Validation loss decreased (-0.608686 --> -0.615933).  Saving model ...
Epoch: 16 cost time: 0.5587029457092285
Epoch: 16, Steps: 9 | Train Loss: 0.495 Vali Loss: 0.901 Vali Acc: 0.652 Test Loss: 0.901 Test Acc: 0.652
Validation loss decreased (-0.615933 --> -0.652165).  Saving model ...
Epoch: 17 cost time: 0.5917086601257324
Epoch: 17, Steps: 9 | Train Loss: 0.458 Vali Loss: 0.828 Vali Acc: 0.645 Test Loss: 0.828 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6730728149414062
Epoch: 18, Steps: 9 | Train Loss: 0.363 Vali Loss: 0.745 Vali Acc: 0.717 Test Loss: 0.745 Test Acc: 0.717
Validation loss decreased (-0.652165 --> -0.717384).  Saving model ...
Epoch: 19 cost time: 0.5751223564147949
Epoch: 19, Steps: 9 | Train Loss: 0.266 Vali Loss: 0.642 Vali Acc: 0.746 Test Loss: 0.642 Test Acc: 0.746
Validation loss decreased (-0.717384 --> -0.746370).  Saving model ...
Epoch: 20 cost time: 0.7495644092559814
Epoch: 20, Steps: 9 | Train Loss: 0.178 Vali Loss: 0.500 Vali Acc: 0.812 Test Loss: 0.500 Test Acc: 0.812
Validation loss decreased (-0.746370 --> -0.811589).  Saving model ...
Epoch: 21 cost time: 0.7850747108459473
Epoch: 21, Steps: 9 | Train Loss: 0.120 Vali Loss: 0.447 Vali Acc: 0.841 Test Loss: 0.447 Test Acc: 0.841
Validation loss decreased (-0.811589 --> -0.840575).  Saving model ...
Epoch: 22 cost time: 0.511146068572998
Epoch: 22, Steps: 9 | Train Loss: 0.094 Vali Loss: 0.441 Vali Acc: 0.855 Test Loss: 0.441 Test Acc: 0.855
Validation loss decreased (-0.840575 --> -0.855068).  Saving model ...
Epoch: 23 cost time: 0.6107776165008545
Epoch: 23, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.427 Vali Acc: 0.855 Test Loss: 0.427 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 24 cost time: 0.5819180011749268
Epoch: 24, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.452 Vali Acc: 0.848 Test Loss: 0.452 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.575218915939331
Epoch: 25, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.489 Vali Acc: 0.855 Test Loss: 0.489 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.5002529621124268
Epoch: 26, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.439 Vali Acc: 0.877 Test Loss: 0.439 Test Acc: 0.877
Validation loss decreased (-0.855068 --> -0.876807).  Saving model ...
Epoch: 27 cost time: 0.4894595146179199
Epoch: 27, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.448 Vali Acc: 0.870 Test Loss: 0.448 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6526346206665039
Epoch: 28, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.494 Vali Acc: 0.870 Test Loss: 0.494 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6441864967346191
Epoch: 29, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.498 Vali Acc: 0.870 Test Loss: 0.498 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.6198179721832275
Epoch: 30, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.514 Vali Acc: 0.862 Test Loss: 0.514 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.6603829860687256
Epoch: 31, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.515 Vali Acc: 0.862 Test Loss: 0.515 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.6472508907318115
Epoch: 32, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.536 Vali Acc: 0.862 Test Loss: 0.536 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.5656967163085938
Epoch: 33, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.547 Vali Acc: 0.862 Test Loss: 0.547 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.5943419933319092
Epoch: 34, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.564 Vali Acc: 0.855 Test Loss: 0.564 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.5348324775695801
Epoch: 35, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.557 Vali Acc: 0.855 Test Loss: 0.557 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.505892276763916
Epoch: 36, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.580 Vali Acc: 0.848 Test Loss: 0.580 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm256_cs52_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 84070
model size : 0.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm256_cs42_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.6247155666351318
Epoch: 1, Steps: 9 | Train Loss: 1.402 Vali Loss: 1.413 Vali Acc: 0.326 Test Loss: 1.413 Test Acc: 0.326
Validation loss decreased (inf --> -0.326073).  Saving model ...
Epoch: 2 cost time: 0.5913784503936768
Epoch: 2, Steps: 9 | Train Loss: 1.328 Vali Loss: 1.333 Vali Acc: 0.370 Test Loss: 1.333 Test Acc: 0.370
Validation loss decreased (-0.326073 --> -0.369552).  Saving model ...
Epoch: 3 cost time: 0.5273895263671875
Epoch: 3, Steps: 9 | Train Loss: 1.227 Vali Loss: 1.243 Vali Acc: 0.406 Test Loss: 1.243 Test Acc: 0.406
Validation loss decreased (-0.369552 --> -0.405785).  Saving model ...
Epoch: 4 cost time: 0.5497500896453857
Epoch: 4, Steps: 9 | Train Loss: 1.130 Vali Loss: 1.173 Vali Acc: 0.478 Test Loss: 1.173 Test Acc: 0.478
Validation loss decreased (-0.405785 --> -0.478249).  Saving model ...
Epoch: 5 cost time: 0.7384293079376221
Epoch: 5, Steps: 9 | Train Loss: 1.047 Vali Loss: 1.112 Vali Acc: 0.471 Test Loss: 1.112 Test Acc: 0.471
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6294076442718506
Epoch: 6, Steps: 9 | Train Loss: 0.962 Vali Loss: 1.079 Vali Acc: 0.493 Test Loss: 1.079 Test Acc: 0.493
Validation loss decreased (-0.478249 --> -0.492743).  Saving model ...
Epoch: 7 cost time: 0.6302125453948975
Epoch: 7, Steps: 9 | Train Loss: 0.895 Vali Loss: 1.059 Vali Acc: 0.507 Test Loss: 1.059 Test Acc: 0.507
Validation loss decreased (-0.492743 --> -0.507236).  Saving model ...
Epoch: 8 cost time: 0.6435182094573975
Epoch: 8, Steps: 9 | Train Loss: 0.835 Vali Loss: 1.027 Vali Acc: 0.536 Test Loss: 1.027 Test Acc: 0.536
Validation loss decreased (-0.507236 --> -0.536222).  Saving model ...
Epoch: 9 cost time: 0.581392765045166
Epoch: 9, Steps: 9 | Train Loss: 0.767 Vali Loss: 1.003 Vali Acc: 0.580 Test Loss: 1.003 Test Acc: 0.580
Validation loss decreased (-0.536222 --> -0.579700).  Saving model ...
Epoch: 10 cost time: 0.5864410400390625
Epoch: 10, Steps: 9 | Train Loss: 0.719 Vali Loss: 0.975 Vali Acc: 0.587 Test Loss: 0.975 Test Acc: 0.587
Validation loss decreased (-0.579700 --> -0.586947).  Saving model ...
Epoch: 11 cost time: 0.6670713424682617
Epoch: 11, Steps: 9 | Train Loss: 0.686 Vali Loss: 0.949 Vali Acc: 0.623 Test Loss: 0.949 Test Acc: 0.623
Validation loss decreased (-0.586947 --> -0.623179).  Saving model ...
Epoch: 12 cost time: 0.6129231452941895
Epoch: 12, Steps: 9 | Train Loss: 0.621 Vali Loss: 0.914 Vali Acc: 0.645 Test Loss: 0.914 Test Acc: 0.645
Validation loss decreased (-0.623179 --> -0.644918).  Saving model ...
Epoch: 13 cost time: 0.6509065628051758
Epoch: 13, Steps: 9 | Train Loss: 0.542 Vali Loss: 0.854 Vali Acc: 0.659 Test Loss: 0.854 Test Acc: 0.659
Validation loss decreased (-0.644918 --> -0.659412).  Saving model ...
Epoch: 14 cost time: 0.6194474697113037
Epoch: 14, Steps: 9 | Train Loss: 0.457 Vali Loss: 0.764 Vali Acc: 0.717 Test Loss: 0.764 Test Acc: 0.717
Validation loss decreased (-0.659412 --> -0.717384).  Saving model ...
Epoch: 15 cost time: 0.5309555530548096
Epoch: 15, Steps: 9 | Train Loss: 0.355 Vali Loss: 0.650 Vali Acc: 0.754 Test Loss: 0.650 Test Acc: 0.754
Validation loss decreased (-0.717384 --> -0.753617).  Saving model ...
Epoch: 16 cost time: 0.6885526180267334
Epoch: 16, Steps: 9 | Train Loss: 0.263 Vali Loss: 0.525 Vali Acc: 0.804 Test Loss: 0.525 Test Acc: 0.804
Validation loss decreased (-0.753617 --> -0.804343).  Saving model ...
Epoch: 17 cost time: 0.6304619312286377
Epoch: 17, Steps: 9 | Train Loss: 0.185 Vali Loss: 0.473 Vali Acc: 0.819 Test Loss: 0.473 Test Acc: 0.819
Validation loss decreased (-0.804343 --> -0.818836).  Saving model ...
Epoch: 18 cost time: 0.5335879325866699
Epoch: 18, Steps: 9 | Train Loss: 0.133 Vali Loss: 0.420 Vali Acc: 0.841 Test Loss: 0.420 Test Acc: 0.841
Validation loss decreased (-0.818836 --> -0.840576).  Saving model ...
Epoch: 19 cost time: 0.6405179500579834
Epoch: 19, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.377 Vali Acc: 0.841 Test Loss: 0.377 Test Acc: 0.841
Validation loss decreased (-0.840576 --> -0.840576).  Saving model ...
Epoch: 20 cost time: 0.6657342910766602
Epoch: 20, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.370 Vali Acc: 0.848 Test Loss: 0.370 Test Acc: 0.848
Validation loss decreased (-0.840576 --> -0.847822).  Saving model ...
Epoch: 21 cost time: 0.6236517429351807
Epoch: 21, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.347 Vali Acc: 0.855 Test Loss: 0.347 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855069).  Saving model ...
Epoch: 22 cost time: 0.6157341003417969
Epoch: 22, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.330 Vali Acc: 0.855 Test Loss: 0.330 Test Acc: 0.855
Validation loss decreased (-0.855069 --> -0.855069).  Saving model ...
Epoch: 23 cost time: 0.5598161220550537
Epoch: 23, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.330 Vali Acc: 0.862 Test Loss: 0.330 Test Acc: 0.862
Validation loss decreased (-0.855069 --> -0.862316).  Saving model ...
Epoch: 24 cost time: 0.6693387031555176
Epoch: 24, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.314 Vali Acc: 0.870 Test Loss: 0.314 Test Acc: 0.870
Validation loss decreased (-0.862316 --> -0.869562).  Saving model ...
Epoch: 25 cost time: 0.5603494644165039
Epoch: 25, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.338 Vali Acc: 0.862 Test Loss: 0.338 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5497708320617676
Epoch: 26, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.328 Vali Acc: 0.870 Test Loss: 0.328 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6617789268493652
Epoch: 27, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.324 Vali Acc: 0.877 Test Loss: 0.324 Test Acc: 0.877
Validation loss decreased (-0.869562 --> -0.876808).  Saving model ...
Epoch: 28 cost time: 0.519019603729248
Epoch: 28, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.334 Vali Acc: 0.884 Test Loss: 0.334 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884055).  Saving model ...
Epoch: 29 cost time: 0.597412109375
Epoch: 29, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.350 Vali Acc: 0.884 Test Loss: 0.350 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6336476802825928
Epoch: 30, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.363 Vali Acc: 0.884 Test Loss: 0.363 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.6268746852874756
Epoch: 31, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.351 Vali Acc: 0.884 Test Loss: 0.351 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.6859064102172852
Epoch: 32, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.353 Vali Acc: 0.884 Test Loss: 0.353 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.5948195457458496
Epoch: 33, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.349 Vali Acc: 0.884 Test Loss: 0.349 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.5630912780761719
Epoch: 34, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.350 Vali Acc: 0.884 Test Loss: 0.350 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.5665664672851562
Epoch: 35, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.368 Vali Acc: 0.891 Test Loss: 0.368 Test Acc: 0.891
Validation loss decreased (-0.884055 --> -0.891301).  Saving model ...
Epoch: 36 cost time: 0.576484203338623
Epoch: 36, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.377 Vali Acc: 0.891 Test Loss: 0.377 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.6982629299163818
Epoch: 37, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.381 Vali Acc: 0.884 Test Loss: 0.381 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.8331799507141113
Epoch: 38, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.381 Vali Acc: 0.884 Test Loss: 0.381 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.5598795413970947
Epoch: 39, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.387 Vali Acc: 0.884 Test Loss: 0.387 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.7526752948760986
Epoch: 40, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.386 Vali Acc: 0.884 Test Loss: 0.386 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.655390739440918
Epoch: 41, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.393 Vali Acc: 0.884 Test Loss: 0.393 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.6047036647796631
Epoch: 42, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.391 Vali Acc: 0.884 Test Loss: 0.391 Test Acc: 0.884
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.570202112197876
Epoch: 43, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.395 Vali Acc: 0.884 Test Loss: 0.395 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.6899592876434326
Epoch: 44, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.400 Vali Acc: 0.884 Test Loss: 0.400 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.6633856296539307
Epoch: 45, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.405 Vali Acc: 0.884 Test Loss: 0.405 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm256_cs42_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 83224
model size : 0.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm256_cs35_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.707197904586792
Epoch: 1, Steps: 9 | Train Loss: 1.405 Vali Loss: 1.354 Vali Acc: 0.413 Test Loss: 1.354 Test Acc: 0.413
Validation loss decreased (inf --> -0.413030).  Saving model ...
Epoch: 2 cost time: 0.6397738456726074
Epoch: 2, Steps: 9 | Train Loss: 1.336 Vali Loss: 1.279 Vali Acc: 0.493 Test Loss: 1.279 Test Acc: 0.493
Validation loss decreased (-0.413030 --> -0.492741).  Saving model ...
Epoch: 3 cost time: 0.6355571746826172
Epoch: 3, Steps: 9 | Train Loss: 1.222 Vali Loss: 1.199 Vali Acc: 0.514 Test Loss: 1.199 Test Acc: 0.514
Validation loss decreased (-0.492741 --> -0.514481).  Saving model ...
Epoch: 4 cost time: 0.6269204616546631
Epoch: 4, Steps: 9 | Train Loss: 1.128 Vali Loss: 1.135 Vali Acc: 0.536 Test Loss: 1.135 Test Acc: 0.536
Validation loss decreased (-0.514481 --> -0.536221).  Saving model ...
Epoch: 5 cost time: 0.6162221431732178
Epoch: 5, Steps: 9 | Train Loss: 1.034 Vali Loss: 1.095 Vali Acc: 0.514 Test Loss: 1.095 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7270522117614746
Epoch: 6, Steps: 9 | Train Loss: 0.960 Vali Loss: 1.069 Vali Acc: 0.500 Test Loss: 1.069 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.4792764186859131
Epoch: 7, Steps: 9 | Train Loss: 0.902 Vali Loss: 1.046 Vali Acc: 0.471 Test Loss: 1.046 Test Acc: 0.471
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.5978586673736572
Epoch: 8, Steps: 9 | Train Loss: 0.848 Vali Loss: 1.026 Vali Acc: 0.507 Test Loss: 1.026 Test Acc: 0.507
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.5409486293792725
Epoch: 9, Steps: 9 | Train Loss: 0.802 Vali Loss: 0.995 Vali Acc: 0.536 Test Loss: 0.995 Test Acc: 0.536
Validation loss decreased (-0.536221 --> -0.536222).  Saving model ...
Epoch: 10 cost time: 0.5282313823699951
Epoch: 10, Steps: 9 | Train Loss: 0.755 Vali Loss: 0.967 Vali Acc: 0.551 Test Loss: 0.967 Test Acc: 0.551
Validation loss decreased (-0.536222 --> -0.550715).  Saving model ...
Epoch: 11 cost time: 0.5727603435516357
Epoch: 11, Steps: 9 | Train Loss: 0.686 Vali Loss: 0.941 Vali Acc: 0.587 Test Loss: 0.941 Test Acc: 0.587
Validation loss decreased (-0.550715 --> -0.586947).  Saving model ...
Epoch: 12 cost time: 0.5913679599761963
Epoch: 12, Steps: 9 | Train Loss: 0.617 Vali Loss: 0.902 Vali Acc: 0.609 Test Loss: 0.902 Test Acc: 0.609
Validation loss decreased (-0.586947 --> -0.608687).  Saving model ...
Epoch: 13 cost time: 0.6495065689086914
Epoch: 13, Steps: 9 | Train Loss: 0.551 Vali Loss: 0.837 Vali Acc: 0.652 Test Loss: 0.837 Test Acc: 0.652
Validation loss decreased (-0.608687 --> -0.652166).  Saving model ...
Epoch: 14 cost time: 0.48200488090515137
Epoch: 14, Steps: 9 | Train Loss: 0.459 Vali Loss: 0.723 Vali Acc: 0.710 Test Loss: 0.723 Test Acc: 0.710
Validation loss decreased (-0.652166 --> -0.710138).  Saving model ...
Epoch: 15 cost time: 0.47563886642456055
Epoch: 15, Steps: 9 | Train Loss: 0.352 Vali Loss: 0.597 Vali Acc: 0.775 Test Loss: 0.597 Test Acc: 0.775
Validation loss decreased (-0.710138 --> -0.775356).  Saving model ...
Epoch: 16 cost time: 0.510941743850708
Epoch: 16, Steps: 9 | Train Loss: 0.244 Vali Loss: 0.491 Vali Acc: 0.826 Test Loss: 0.491 Test Acc: 0.826
Validation loss decreased (-0.775356 --> -0.826082).  Saving model ...
Epoch: 17 cost time: 0.6303656101226807
Epoch: 17, Steps: 9 | Train Loss: 0.168 Vali Loss: 0.406 Vali Acc: 0.848 Test Loss: 0.406 Test Acc: 0.848
Validation loss decreased (-0.826082 --> -0.847822).  Saving model ...
Epoch: 18 cost time: 0.4977905750274658
Epoch: 18, Steps: 9 | Train Loss: 0.119 Vali Loss: 0.375 Vali Acc: 0.862 Test Loss: 0.375 Test Acc: 0.862
Validation loss decreased (-0.847822 --> -0.862315).  Saving model ...
Epoch: 19 cost time: 0.6029634475708008
Epoch: 19, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.329 Vali Acc: 0.877 Test Loss: 0.329 Test Acc: 0.877
Validation loss decreased (-0.862315 --> -0.876808).  Saving model ...
Epoch: 20 cost time: 0.6476593017578125
Epoch: 20, Steps: 9 | Train Loss: 0.083 Vali Loss: 0.324 Vali Acc: 0.891 Test Loss: 0.324 Test Acc: 0.891
Validation loss decreased (-0.876808 --> -0.891301).  Saving model ...
Epoch: 21 cost time: 0.6379609107971191
Epoch: 21, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.329 Vali Acc: 0.899 Test Loss: 0.329 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898547).  Saving model ...
Epoch: 22 cost time: 0.6186978816986084
Epoch: 22, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.323 Vali Acc: 0.906 Test Loss: 0.323 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905794).  Saving model ...
Epoch: 23 cost time: 0.5433082580566406
Epoch: 23, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.315 Vali Acc: 0.906 Test Loss: 0.315 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 24 cost time: 0.5044476985931396
Epoch: 24, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.302 Vali Acc: 0.913 Test Loss: 0.302 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913040).  Saving model ...
Epoch: 25 cost time: 0.7324671745300293
Epoch: 25, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.320 Vali Acc: 0.913 Test Loss: 0.320 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6739704608917236
Epoch: 26, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.346 Vali Acc: 0.899 Test Loss: 0.346 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5539143085479736
Epoch: 27, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.325 Vali Acc: 0.899 Test Loss: 0.325 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.5641903877258301
Epoch: 28, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.321 Vali Acc: 0.906 Test Loss: 0.321 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.6690189838409424
Epoch: 29, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.325 Vali Acc: 0.906 Test Loss: 0.325 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.5564799308776855
Epoch: 30, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.327 Vali Acc: 0.906 Test Loss: 0.327 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.5761313438415527
Epoch: 31, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.340 Vali Acc: 0.906 Test Loss: 0.340 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.633366584777832
Epoch: 32, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.339 Vali Acc: 0.906 Test Loss: 0.339 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.629833459854126
Epoch: 33, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.331 Vali Acc: 0.913 Test Loss: 0.331 Test Acc: 0.913
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.5686554908752441
Epoch: 34, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.332 Vali Acc: 0.913 Test Loss: 0.332 Test Acc: 0.913
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm256_cs35_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 82354
model size : 0.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm256_cs30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.8292534351348877
Epoch: 1, Steps: 9 | Train Loss: 1.422 Vali Loss: 1.402 Vali Acc: 0.225 Test Loss: 1.402 Test Acc: 0.225
Validation loss decreased (inf --> -0.224624).  Saving model ...
Epoch: 2 cost time: 0.5934810638427734
Epoch: 2, Steps: 9 | Train Loss: 1.346 Vali Loss: 1.325 Vali Acc: 0.341 Test Loss: 1.325 Test Acc: 0.341
Validation loss decreased (-0.224624 --> -0.340566).  Saving model ...
Epoch: 3 cost time: 0.5665228366851807
Epoch: 3, Steps: 9 | Train Loss: 1.244 Vali Loss: 1.237 Vali Acc: 0.413 Test Loss: 1.237 Test Acc: 0.413
Validation loss decreased (-0.340566 --> -0.413031).  Saving model ...
Epoch: 4 cost time: 0.552527666091919
Epoch: 4, Steps: 9 | Train Loss: 1.131 Vali Loss: 1.169 Vali Acc: 0.449 Test Loss: 1.169 Test Acc: 0.449
Validation loss decreased (-0.413031 --> -0.449264).  Saving model ...
Epoch: 5 cost time: 0.6164336204528809
Epoch: 5, Steps: 9 | Train Loss: 1.047 Vali Loss: 1.125 Vali Acc: 0.471 Test Loss: 1.125 Test Acc: 0.471
Validation loss decreased (-0.449264 --> -0.471003).  Saving model ...
Epoch: 6 cost time: 0.5570638179779053
Epoch: 6, Steps: 9 | Train Loss: 0.987 Vali Loss: 1.098 Vali Acc: 0.478 Test Loss: 1.098 Test Acc: 0.478
Validation loss decreased (-0.471003 --> -0.478250).  Saving model ...
Epoch: 7 cost time: 0.5935268402099609
Epoch: 7, Steps: 9 | Train Loss: 0.915 Vali Loss: 1.077 Vali Acc: 0.514 Test Loss: 1.077 Test Acc: 0.514
Validation loss decreased (-0.478250 --> -0.514482).  Saving model ...
Epoch: 8 cost time: 0.7817811965942383
Epoch: 8, Steps: 9 | Train Loss: 0.868 Vali Loss: 1.051 Vali Acc: 0.522 Test Loss: 1.051 Test Acc: 0.522
Validation loss decreased (-0.514482 --> -0.521729).  Saving model ...
Epoch: 9 cost time: 0.5375864505767822
Epoch: 9, Steps: 9 | Train Loss: 0.800 Vali Loss: 1.034 Vali Acc: 0.522 Test Loss: 1.034 Test Acc: 0.522
Validation loss decreased (-0.521729 --> -0.521729).  Saving model ...
Epoch: 10 cost time: 0.6422710418701172
Epoch: 10, Steps: 9 | Train Loss: 0.765 Vali Loss: 1.032 Vali Acc: 0.507 Test Loss: 1.032 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5617837905883789
Epoch: 11, Steps: 9 | Train Loss: 0.716 Vali Loss: 1.005 Vali Acc: 0.529 Test Loss: 1.005 Test Acc: 0.529
Validation loss decreased (-0.521729 --> -0.528975).  Saving model ...
Epoch: 12 cost time: 0.5364511013031006
Epoch: 12, Steps: 9 | Train Loss: 0.683 Vali Loss: 0.998 Vali Acc: 0.529 Test Loss: 0.998 Test Acc: 0.529
Validation loss decreased (-0.528975 --> -0.528976).  Saving model ...
Epoch: 13 cost time: 0.7164952754974365
Epoch: 13, Steps: 9 | Train Loss: 0.638 Vali Loss: 0.998 Vali Acc: 0.558 Test Loss: 0.998 Test Acc: 0.558
Validation loss decreased (-0.528976 --> -0.557961).  Saving model ...
Epoch: 14 cost time: 0.7244155406951904
Epoch: 14, Steps: 9 | Train Loss: 0.587 Vali Loss: 0.991 Vali Acc: 0.565 Test Loss: 0.991 Test Acc: 0.565
Validation loss decreased (-0.557961 --> -0.565207).  Saving model ...
Epoch: 15 cost time: 0.5500285625457764
Epoch: 15, Steps: 9 | Train Loss: 0.553 Vali Loss: 0.991 Vali Acc: 0.572 Test Loss: 0.991 Test Acc: 0.572
Validation loss decreased (-0.565207 --> -0.572454).  Saving model ...
Epoch: 16 cost time: 0.5433349609375
Epoch: 16, Steps: 9 | Train Loss: 0.510 Vali Loss: 0.976 Vali Acc: 0.587 Test Loss: 0.976 Test Acc: 0.587
Validation loss decreased (-0.572454 --> -0.586947).  Saving model ...
Epoch: 17 cost time: 0.6804399490356445
Epoch: 17, Steps: 9 | Train Loss: 0.476 Vali Loss: 0.974 Vali Acc: 0.580 Test Loss: 0.974 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.561147928237915
Epoch: 18, Steps: 9 | Train Loss: 0.422 Vali Loss: 0.972 Vali Acc: 0.645 Test Loss: 0.972 Test Acc: 0.645
Validation loss decreased (-0.586947 --> -0.644918).  Saving model ...
Epoch: 19 cost time: 0.6395893096923828
Epoch: 19, Steps: 9 | Train Loss: 0.374 Vali Loss: 0.952 Vali Acc: 0.645 Test Loss: 0.952 Test Acc: 0.645
Validation loss decreased (-0.644918 --> -0.644918).  Saving model ...
Epoch: 20 cost time: 0.5738489627838135
Epoch: 20, Steps: 9 | Train Loss: 0.333 Vali Loss: 0.935 Vali Acc: 0.652 Test Loss: 0.935 Test Acc: 0.652
Validation loss decreased (-0.644918 --> -0.652165).  Saving model ...
Epoch: 21 cost time: 0.5637993812561035
Epoch: 21, Steps: 9 | Train Loss: 0.269 Vali Loss: 0.899 Vali Acc: 0.652 Test Loss: 0.899 Test Acc: 0.652
Validation loss decreased (-0.652165 --> -0.652165).  Saving model ...
Epoch: 22 cost time: 0.7119336128234863
Epoch: 22, Steps: 9 | Train Loss: 0.222 Vali Loss: 0.865 Vali Acc: 0.674 Test Loss: 0.865 Test Acc: 0.674
Validation loss decreased (-0.652165 --> -0.673904).  Saving model ...
Epoch: 23 cost time: 0.542546272277832
Epoch: 23, Steps: 9 | Train Loss: 0.170 Vali Loss: 0.842 Vali Acc: 0.696 Test Loss: 0.842 Test Acc: 0.696
Validation loss decreased (-0.673904 --> -0.695644).  Saving model ...
Epoch: 24 cost time: 0.6178925037384033
Epoch: 24, Steps: 9 | Train Loss: 0.135 Vali Loss: 0.821 Vali Acc: 0.717 Test Loss: 0.821 Test Acc: 0.717
Validation loss decreased (-0.695644 --> -0.717383).  Saving model ...
Epoch: 25 cost time: 0.6885740756988525
Epoch: 25, Steps: 9 | Train Loss: 0.097 Vali Loss: 0.818 Vali Acc: 0.725 Test Loss: 0.818 Test Acc: 0.725
Validation loss decreased (-0.717383 --> -0.724630).  Saving model ...
Epoch: 26 cost time: 0.6004281044006348
Epoch: 26, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.795 Vali Acc: 0.732 Test Loss: 0.795 Test Acc: 0.732
Validation loss decreased (-0.724630 --> -0.731876).  Saving model ...
Epoch: 27 cost time: 0.5766351222991943
Epoch: 27, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.779 Vali Acc: 0.754 Test Loss: 0.779 Test Acc: 0.754
Validation loss decreased (-0.731876 --> -0.753615).  Saving model ...
Epoch: 28 cost time: 0.5796084403991699
Epoch: 28, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.780 Vali Acc: 0.768 Test Loss: 0.780 Test Acc: 0.768
Validation loss decreased (-0.753615 --> -0.768108).  Saving model ...
Epoch: 29 cost time: 0.46421384811401367
Epoch: 29, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.781 Vali Acc: 0.768 Test Loss: 0.781 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5267677307128906
Epoch: 30, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.830 Vali Acc: 0.768 Test Loss: 0.830 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.7312390804290771
Epoch: 31, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.786 Vali Acc: 0.768 Test Loss: 0.786 Test Acc: 0.768
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.5381746292114258
Epoch: 32, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.777 Vali Acc: 0.783 Test Loss: 0.777 Test Acc: 0.783
Validation loss decreased (-0.768108 --> -0.782601).  Saving model ...
Epoch: 33 cost time: 0.49075841903686523
Epoch: 33, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.778 Vali Acc: 0.790 Test Loss: 0.778 Test Acc: 0.790
Validation loss decreased (-0.782601 --> -0.789847).  Saving model ...
Epoch: 34 cost time: 0.5301434993743896
Epoch: 34, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.775 Vali Acc: 0.790 Test Loss: 0.775 Test Acc: 0.790
Validation loss decreased (-0.789847 --> -0.789847).  Saving model ...
Epoch: 35 cost time: 0.5668060779571533
Epoch: 35, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.776 Vali Acc: 0.797 Test Loss: 0.776 Test Acc: 0.797
Validation loss decreased (-0.789847 --> -0.797094).  Saving model ...
Epoch: 36 cost time: 0.5969281196594238
Epoch: 36, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.778 Vali Acc: 0.797 Test Loss: 0.778 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7209811210632324
Epoch: 37, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.782 Vali Acc: 0.797 Test Loss: 0.782 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.7771646976470947
Epoch: 38, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.777 Vali Acc: 0.797 Test Loss: 0.777 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.6118228435516357
Epoch: 39, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.786 Vali Acc: 0.804 Test Loss: 0.786 Test Acc: 0.804
Validation loss decreased (-0.797094 --> -0.804340).  Saving model ...
Epoch: 40 cost time: 0.6982221603393555
Epoch: 40, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.786 Vali Acc: 0.804 Test Loss: 0.786 Test Acc: 0.804
Validation loss decreased (-0.804340 --> -0.804340).  Saving model ...
Epoch: 41 cost time: 0.5679411888122559
Epoch: 41, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.777 Vali Acc: 0.804 Test Loss: 0.777 Test Acc: 0.804
Validation loss decreased (-0.804340 --> -0.804340).  Saving model ...
Epoch: 42 cost time: 0.6135873794555664
Epoch: 42, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.773 Vali Acc: 0.804 Test Loss: 0.773 Test Acc: 0.804
Validation loss decreased (-0.804340 --> -0.804340).  Saving model ...
Epoch: 43 cost time: 0.5900540351867676
Epoch: 43, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.777 Vali Acc: 0.804 Test Loss: 0.777 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.7302062511444092
Epoch: 44, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.784 Vali Acc: 0.804 Test Loss: 0.784 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.5897510051727295
Epoch: 45, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.783 Vali Acc: 0.804 Test Loss: 0.783 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.6135439872741699
Epoch: 46, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.777 Vali Acc: 0.804 Test Loss: 0.777 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.5445706844329834
Epoch: 47, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.785 Vali Acc: 0.804 Test Loss: 0.785 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.5139312744140625
Epoch: 48, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.781 Vali Acc: 0.812 Test Loss: 0.781 Test Acc: 0.812
Validation loss decreased (-0.804340 --> -0.811586).  Saving model ...
Epoch: 49 cost time: 0.6163866519927979
Epoch: 49, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.780 Vali Acc: 0.819 Test Loss: 0.780 Test Acc: 0.819
Validation loss decreased (-0.811586 --> -0.818833).  Saving model ...
Epoch: 50 cost time: 0.5997018814086914
Epoch: 50, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.779 Vali Acc: 0.812 Test Loss: 0.779 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.618964672088623
Epoch: 51, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.781 Vali Acc: 0.812 Test Loss: 0.781 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.6513321399688721
Epoch: 52, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.780 Vali Acc: 0.819 Test Loss: 0.780 Test Acc: 0.819
Validation loss decreased (-0.818833 --> -0.818833).  Saving model ...
Epoch: 53 cost time: 0.5665175914764404
Epoch: 53, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.781 Vali Acc: 0.819 Test Loss: 0.781 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.6557228565216064
Epoch: 54, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.781 Vali Acc: 0.819 Test Loss: 0.781 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.6705706119537354
Epoch: 55, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.779 Vali Acc: 0.819 Test Loss: 0.779 Test Acc: 0.819
Validation loss decreased (-0.818833 --> -0.818833).  Saving model ...
Epoch: 56 cost time: 0.5908777713775635
Epoch: 56, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.779 Vali Acc: 0.819 Test Loss: 0.779 Test Acc: 0.819
Validation loss decreased (-0.818833 --> -0.818833).  Saving model ...
Epoch: 57 cost time: 0.48461294174194336
Epoch: 57, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.777 Vali Acc: 0.819 Test Loss: 0.777 Test Acc: 0.819
Validation loss decreased (-0.818833 --> -0.818833).  Saving model ...
Epoch: 58 cost time: 0.6581547260284424
Epoch: 58, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.773 Vali Acc: 0.819 Test Loss: 0.773 Test Acc: 0.819
Validation loss decreased (-0.818833 --> -0.818833).  Saving model ...
Epoch: 59 cost time: 0.5461721420288086
Epoch: 59, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.774 Vali Acc: 0.819 Test Loss: 0.774 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.5512726306915283
Epoch: 60, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.773 Vali Acc: 0.819 Test Loss: 0.773 Test Acc: 0.819
Validation loss decreased (-0.818833 --> -0.818833).  Saving model ...
Epoch: 61 cost time: 0.7538790702819824
Epoch: 61, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.772 Vali Acc: 0.826 Test Loss: 0.772 Test Acc: 0.826
Validation loss decreased (-0.818833 --> -0.826079).  Saving model ...
Epoch: 62 cost time: 0.5438110828399658
Epoch: 62, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.775 Vali Acc: 0.826 Test Loss: 0.775 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.5587785243988037
Epoch: 63, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.771 Vali Acc: 0.826 Test Loss: 0.771 Test Acc: 0.826
Validation loss decreased (-0.826079 --> -0.826079).  Saving model ...
Epoch: 64 cost time: 0.6016268730163574
Epoch: 64, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.772 Vali Acc: 0.826 Test Loss: 0.772 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.7150619029998779
Epoch: 65, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.772 Vali Acc: 0.826 Test Loss: 0.772 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 0.5444810390472412
Epoch: 66, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.772 Vali Acc: 0.826 Test Loss: 0.772 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 0.582481861114502
Epoch: 67, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.771 Vali Acc: 0.826 Test Loss: 0.771 Test Acc: 0.826
Validation loss decreased (-0.826079 --> -0.826079).  Saving model ...
Epoch: 68 cost time: 0.5590934753417969
Epoch: 68, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.772 Vali Acc: 0.826 Test Loss: 0.772 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.5928084850311279
Epoch: 69, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.773 Vali Acc: 0.826 Test Loss: 0.773 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 0.7497575283050537
Epoch: 70, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.771 Vali Acc: 0.833 Test Loss: 0.771 Test Acc: 0.833
Validation loss decreased (-0.826079 --> -0.833326).  Saving model ...
Epoch: 71 cost time: 0.6045691967010498
Epoch: 71, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.772 Vali Acc: 0.833 Test Loss: 0.772 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 0.5811614990234375
Epoch: 72, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.772 Vali Acc: 0.833 Test Loss: 0.772 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 0.6745531558990479
Epoch: 73, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.770 Vali Acc: 0.833 Test Loss: 0.770 Test Acc: 0.833
Validation loss decreased (-0.833326 --> -0.833326).  Saving model ...
Epoch: 74 cost time: 0.6855409145355225
Epoch: 74, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.771 Vali Acc: 0.833 Test Loss: 0.771 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 0.5427486896514893
Epoch: 75, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.771 Vali Acc: 0.833 Test Loss: 0.771 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 0.6188888549804688
Epoch: 76, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.772 Vali Acc: 0.833 Test Loss: 0.772 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 0.5311667919158936
Epoch: 77, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.773 Vali Acc: 0.833 Test Loss: 0.773 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 0.6021709442138672
Epoch: 78, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.776 Vali Acc: 0.833 Test Loss: 0.776 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 0.6788086891174316
Epoch: 79, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.777 Vali Acc: 0.833 Test Loss: 0.777 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 80 cost time: 0.5746152400970459
Epoch: 80, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.779 Vali Acc: 0.833 Test Loss: 0.779 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 81 cost time: 0.5448367595672607
Epoch: 81, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.779 Vali Acc: 0.833 Test Loss: 0.779 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 82 cost time: 0.6512296199798584
Epoch: 82, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.780 Vali Acc: 0.833 Test Loss: 0.780 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 83 cost time: 0.5685832500457764
Epoch: 83, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.781 Vali Acc: 0.833 Test Loss: 0.781 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm256_cs30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8333333333333334
model parameter : 81744
model size : 0.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm256_cs26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.767573356628418
Epoch: 1, Steps: 9 | Train Loss: 1.354 Vali Loss: 1.340 Vali Acc: 0.348 Test Loss: 1.340 Test Acc: 0.348
Validation loss decreased (inf --> -0.347813).  Saving model ...
Epoch: 2 cost time: 0.5624535083770752
Epoch: 2, Steps: 9 | Train Loss: 1.287 Vali Loss: 1.271 Vali Acc: 0.399 Test Loss: 1.271 Test Acc: 0.399
Validation loss decreased (-0.347813 --> -0.398538).  Saving model ...
Epoch: 3 cost time: 0.6098885536193848
Epoch: 3, Steps: 9 | Train Loss: 1.207 Vali Loss: 1.202 Vali Acc: 0.449 Test Loss: 1.202 Test Acc: 0.449
Validation loss decreased (-0.398538 --> -0.449263).  Saving model ...
Epoch: 4 cost time: 0.5042667388916016
Epoch: 4, Steps: 9 | Train Loss: 1.118 Vali Loss: 1.150 Vali Acc: 0.449 Test Loss: 1.150 Test Acc: 0.449
Validation loss decreased (-0.449263 --> -0.449264).  Saving model ...
Epoch: 5 cost time: 0.5587716102600098
Epoch: 5, Steps: 9 | Train Loss: 1.027 Vali Loss: 1.108 Vali Acc: 0.435 Test Loss: 1.108 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5500736236572266
Epoch: 6, Steps: 9 | Train Loss: 0.956 Vali Loss: 1.079 Vali Acc: 0.428 Test Loss: 1.079 Test Acc: 0.428
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5107357501983643
Epoch: 7, Steps: 9 | Train Loss: 0.919 Vali Loss: 1.048 Vali Acc: 0.486 Test Loss: 1.048 Test Acc: 0.486
Validation loss decreased (-0.449264 --> -0.485497).  Saving model ...
Epoch: 8 cost time: 0.5826847553253174
Epoch: 8, Steps: 9 | Train Loss: 0.844 Vali Loss: 1.032 Vali Acc: 0.471 Test Loss: 1.032 Test Acc: 0.471
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6268095970153809
Epoch: 9, Steps: 9 | Train Loss: 0.790 Vali Loss: 1.006 Vali Acc: 0.529 Test Loss: 1.006 Test Acc: 0.529
Validation loss decreased (-0.485497 --> -0.528975).  Saving model ...
Epoch: 10 cost time: 0.5373184680938721
Epoch: 10, Steps: 9 | Train Loss: 0.734 Vali Loss: 0.971 Vali Acc: 0.580 Test Loss: 0.971 Test Acc: 0.580
Validation loss decreased (-0.528975 --> -0.579700).  Saving model ...
Epoch: 11 cost time: 0.5686054229736328
Epoch: 11, Steps: 9 | Train Loss: 0.692 Vali Loss: 0.935 Vali Acc: 0.587 Test Loss: 0.935 Test Acc: 0.587
Validation loss decreased (-0.579700 --> -0.586947).  Saving model ...
Epoch: 12 cost time: 0.5030965805053711
Epoch: 12, Steps: 9 | Train Loss: 0.610 Vali Loss: 0.887 Vali Acc: 0.645 Test Loss: 0.887 Test Acc: 0.645
Validation loss decreased (-0.586947 --> -0.644919).  Saving model ...
Epoch: 13 cost time: 0.5292017459869385
Epoch: 13, Steps: 9 | Train Loss: 0.515 Vali Loss: 0.780 Vali Acc: 0.703 Test Loss: 0.780 Test Acc: 0.703
Validation loss decreased (-0.644919 --> -0.702891).  Saving model ...
Epoch: 14 cost time: 0.6420090198516846
Epoch: 14, Steps: 9 | Train Loss: 0.399 Vali Loss: 0.642 Vali Acc: 0.783 Test Loss: 0.642 Test Acc: 0.783
Validation loss decreased (-0.702891 --> -0.782602).  Saving model ...
Epoch: 15 cost time: 0.5836472511291504
Epoch: 15, Steps: 9 | Train Loss: 0.275 Vali Loss: 0.491 Vali Acc: 0.833 Test Loss: 0.491 Test Acc: 0.833
Validation loss decreased (-0.782602 --> -0.833328).  Saving model ...
Epoch: 16 cost time: 0.5004847049713135
Epoch: 16, Steps: 9 | Train Loss: 0.189 Vali Loss: 0.349 Vali Acc: 0.884 Test Loss: 0.349 Test Acc: 0.884
Validation loss decreased (-0.833328 --> -0.884054).  Saving model ...
Epoch: 17 cost time: 0.5578603744506836
Epoch: 17, Steps: 9 | Train Loss: 0.116 Vali Loss: 0.309 Vali Acc: 0.891 Test Loss: 0.309 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891301).  Saving model ...
Epoch: 18 cost time: 0.6322946548461914
Epoch: 18, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.271 Vali Acc: 0.899 Test Loss: 0.271 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898548).  Saving model ...
Epoch: 19 cost time: 0.6592633724212646
Epoch: 19, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.238 Vali Acc: 0.899 Test Loss: 0.238 Test Acc: 0.899
Validation loss decreased (-0.898548 --> -0.898548).  Saving model ...
Epoch: 20 cost time: 0.6658868789672852
Epoch: 20, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.222 Vali Acc: 0.906 Test Loss: 0.222 Test Acc: 0.906
Validation loss decreased (-0.898548 --> -0.905795).  Saving model ...
Epoch: 21 cost time: 0.6588361263275146
Epoch: 21, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.217 Vali Acc: 0.913 Test Loss: 0.217 Test Acc: 0.913
Validation loss decreased (-0.905795 --> -0.913041).  Saving model ...
Epoch: 22 cost time: 0.5955095291137695
Epoch: 22, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.211 Vali Acc: 0.942 Test Loss: 0.211 Test Acc: 0.942
Validation loss decreased (-0.913041 --> -0.942027).  Saving model ...
Epoch: 23 cost time: 0.6283471584320068
Epoch: 23, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.201 Vali Acc: 0.928 Test Loss: 0.201 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6864306926727295
Epoch: 24, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.204 Vali Acc: 0.928 Test Loss: 0.204 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5476169586181641
Epoch: 25, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.211 Vali Acc: 0.942 Test Loss: 0.211 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 26 cost time: 0.7779796123504639
Epoch: 26, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.199 Vali Acc: 0.928 Test Loss: 0.199 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6226568222045898
Epoch: 27, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.206 Vali Acc: 0.935 Test Loss: 0.206 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6092677116394043
Epoch: 28, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.192 Vali Acc: 0.928 Test Loss: 0.192 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.6808426380157471
Epoch: 29, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.190 Vali Acc: 0.935 Test Loss: 0.190 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.6354999542236328
Epoch: 30, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.199 Vali Acc: 0.942 Test Loss: 0.199 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 31 cost time: 0.57322096824646
Epoch: 31, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.199 Vali Acc: 0.935 Test Loss: 0.199 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5590736865997314
Epoch: 32, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.192 Vali Acc: 0.942 Test Loss: 0.192 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 33 cost time: 0.6422827243804932
Epoch: 33, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.195 Vali Acc: 0.942 Test Loss: 0.195 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.579582929611206
Epoch: 34, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.192 Vali Acc: 0.942 Test Loss: 0.192 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 35 cost time: 0.6697726249694824
Epoch: 35, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.194 Vali Acc: 0.942 Test Loss: 0.194 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.5436022281646729
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.197 Vali Acc: 0.949 Test Loss: 0.197 Test Acc: 0.949
Validation loss decreased (-0.942027 --> -0.949273).  Saving model ...
Epoch: 37 cost time: 0.5555562973022461
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.195 Vali Acc: 0.942 Test Loss: 0.195 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.502922773361206
Epoch: 38, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.195 Vali Acc: 0.949 Test Loss: 0.195 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949273).  Saving model ...
Epoch: 39 cost time: 0.5788304805755615
Epoch: 39, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.191 Vali Acc: 0.949 Test Loss: 0.191 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949273).  Saving model ...
Epoch: 40 cost time: 0.6040074825286865
Epoch: 40, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.193 Vali Acc: 0.949 Test Loss: 0.193 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.7427845001220703
Epoch: 41, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.957 Test Loss: 0.199 Test Acc: 0.957
Validation loss decreased (-0.949273 --> -0.956520).  Saving model ...
Epoch: 42 cost time: 0.7124948501586914
Epoch: 42, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.949 Test Loss: 0.193 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.6186091899871826
Epoch: 43, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.957 Test Loss: 0.193 Test Acc: 0.957
Validation loss decreased (-0.956520 --> -0.956520).  Saving model ...
Epoch: 44 cost time: 0.5496702194213867
Epoch: 44, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.957 Test Loss: 0.194 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.6551766395568848
Epoch: 45, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.949 Test Loss: 0.193 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.7290143966674805
Epoch: 46, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.957 Test Loss: 0.193 Test Acc: 0.957
Validation loss decreased (-0.956520 --> -0.956520).  Saving model ...
Epoch: 47 cost time: 0.5726873874664307
Epoch: 47, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.957 Test Loss: 0.194 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.5452659130096436
Epoch: 48, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.949 Test Loss: 0.197 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.7280848026275635
Epoch: 49, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.957 Test Loss: 0.195 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.5783934593200684
Epoch: 50, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.957 Test Loss: 0.195 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.7030317783355713
Epoch: 51, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.957 Test Loss: 0.194 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.6519041061401367
Epoch: 52, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.957 Test Loss: 0.194 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.733546257019043
Epoch: 53, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.949 Test Loss: 0.197 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 0.5808053016662598
Epoch: 54, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.949 Test Loss: 0.199 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 0.6148133277893066
Epoch: 55, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.949 Test Loss: 0.197 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 0.5808086395263672
Epoch: 56, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.949 Test Loss: 0.196 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm256_cs26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9565217391304348
model parameter : 80854
model size : 0.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm256_cs23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.0437793731689453
Epoch: 1, Steps: 9 | Train Loss: 1.407 Vali Loss: 1.360 Vali Acc: 0.312 Test Loss: 1.360 Test Acc: 0.312
Validation loss decreased (inf --> -0.311581).  Saving model ...
Epoch: 2 cost time: 0.6128995418548584
Epoch: 2, Steps: 9 | Train Loss: 1.331 Vali Loss: 1.286 Vali Acc: 0.355 Test Loss: 1.286 Test Acc: 0.355
Validation loss decreased (-0.311581 --> -0.355060).  Saving model ...
Epoch: 3 cost time: 0.6099507808685303
Epoch: 3, Steps: 9 | Train Loss: 1.228 Vali Loss: 1.221 Vali Acc: 0.370 Test Loss: 1.221 Test Acc: 0.370
Validation loss decreased (-0.355060 --> -0.369553).  Saving model ...
Epoch: 4 cost time: 0.5907437801361084
Epoch: 4, Steps: 9 | Train Loss: 1.120 Vali Loss: 1.164 Vali Acc: 0.399 Test Loss: 1.164 Test Acc: 0.399
Validation loss decreased (-0.369553 --> -0.398539).  Saving model ...
Epoch: 5 cost time: 0.7174985408782959
Epoch: 5, Steps: 9 | Train Loss: 1.029 Vali Loss: 1.121 Vali Acc: 0.435 Test Loss: 1.121 Test Acc: 0.435
Validation loss decreased (-0.398539 --> -0.434771).  Saving model ...
Epoch: 6 cost time: 0.6420876979827881
Epoch: 6, Steps: 9 | Train Loss: 0.960 Vali Loss: 1.095 Vali Acc: 0.442 Test Loss: 1.095 Test Acc: 0.442
Validation loss decreased (-0.434771 --> -0.442018).  Saving model ...
Epoch: 7 cost time: 0.5840067863464355
Epoch: 7, Steps: 9 | Train Loss: 0.897 Vali Loss: 1.067 Vali Acc: 0.478 Test Loss: 1.067 Test Acc: 0.478
Validation loss decreased (-0.442018 --> -0.478250).  Saving model ...
Epoch: 8 cost time: 0.4805765151977539
Epoch: 8, Steps: 9 | Train Loss: 0.835 Vali Loss: 1.034 Vali Acc: 0.514 Test Loss: 1.034 Test Acc: 0.514
Validation loss decreased (-0.478250 --> -0.514482).  Saving model ...
Epoch: 9 cost time: 0.557647705078125
Epoch: 9, Steps: 9 | Train Loss: 0.772 Vali Loss: 1.016 Vali Acc: 0.536 Test Loss: 1.016 Test Acc: 0.536
Validation loss decreased (-0.514482 --> -0.536222).  Saving model ...
Epoch: 10 cost time: 0.563941240310669
Epoch: 10, Steps: 9 | Train Loss: 0.714 Vali Loss: 0.979 Vali Acc: 0.536 Test Loss: 0.979 Test Acc: 0.536
Validation loss decreased (-0.536222 --> -0.536222).  Saving model ...
Epoch: 11 cost time: 0.5471301078796387
Epoch: 11, Steps: 9 | Train Loss: 0.659 Vali Loss: 0.941 Vali Acc: 0.580 Test Loss: 0.941 Test Acc: 0.580
Validation loss decreased (-0.536222 --> -0.579701).  Saving model ...
Epoch: 12 cost time: 0.7101912498474121
Epoch: 12, Steps: 9 | Train Loss: 0.581 Vali Loss: 0.907 Vali Acc: 0.616 Test Loss: 0.907 Test Acc: 0.616
Validation loss decreased (-0.579701 --> -0.615933).  Saving model ...
Epoch: 13 cost time: 0.5732083320617676
Epoch: 13, Steps: 9 | Train Loss: 0.512 Vali Loss: 0.823 Vali Acc: 0.667 Test Loss: 0.823 Test Acc: 0.667
Validation loss decreased (-0.615933 --> -0.666658).  Saving model ...
Epoch: 14 cost time: 0.5330936908721924
Epoch: 14, Steps: 9 | Train Loss: 0.415 Vali Loss: 0.738 Vali Acc: 0.710 Test Loss: 0.738 Test Acc: 0.710
Validation loss decreased (-0.666658 --> -0.710138).  Saving model ...
Epoch: 15 cost time: 0.5797650814056396
Epoch: 15, Steps: 9 | Train Loss: 0.318 Vali Loss: 0.604 Vali Acc: 0.783 Test Loss: 0.604 Test Acc: 0.783
Validation loss decreased (-0.710138 --> -0.782603).  Saving model ...
Epoch: 16 cost time: 0.5442595481872559
Epoch: 16, Steps: 9 | Train Loss: 0.228 Vali Loss: 0.508 Vali Acc: 0.819 Test Loss: 0.508 Test Acc: 0.819
Validation loss decreased (-0.782603 --> -0.818835).  Saving model ...
Epoch: 17 cost time: 0.5957739353179932
Epoch: 17, Steps: 9 | Train Loss: 0.174 Vali Loss: 0.475 Vali Acc: 0.833 Test Loss: 0.475 Test Acc: 0.833
Validation loss decreased (-0.818835 --> -0.833329).  Saving model ...
Epoch: 18 cost time: 0.7270383834838867
Epoch: 18, Steps: 9 | Train Loss: 0.114 Vali Loss: 0.448 Vali Acc: 0.841 Test Loss: 0.448 Test Acc: 0.841
Validation loss decreased (-0.833329 --> -0.840575).  Saving model ...
Epoch: 19 cost time: 0.5724325180053711
Epoch: 19, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.439 Vali Acc: 0.848 Test Loss: 0.439 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847822).  Saving model ...
Epoch: 20 cost time: 0.6737523078918457
Epoch: 20, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.403 Vali Acc: 0.862 Test Loss: 0.403 Test Acc: 0.862
Validation loss decreased (-0.847822 --> -0.862315).  Saving model ...
Epoch: 21 cost time: 0.5628693103790283
Epoch: 21, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.416 Vali Acc: 0.862 Test Loss: 0.416 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6085472106933594
Epoch: 22, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.401 Vali Acc: 0.870 Test Loss: 0.401 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869561).  Saving model ...
Epoch: 23 cost time: 0.6443822383880615
Epoch: 23, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.388 Vali Acc: 0.884 Test Loss: 0.388 Test Acc: 0.884
Validation loss decreased (-0.869561 --> -0.884054).  Saving model ...
Epoch: 24 cost time: 0.508946418762207
Epoch: 24, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.466 Vali Acc: 0.862 Test Loss: 0.466 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5442590713500977
Epoch: 25, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.419 Vali Acc: 0.870 Test Loss: 0.419 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6368045806884766
Epoch: 26, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.400 Vali Acc: 0.884 Test Loss: 0.400 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.5893619060516357
Epoch: 27, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.402 Vali Acc: 0.891 Test Loss: 0.402 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891300).  Saving model ...
Epoch: 28 cost time: 0.7121834754943848
Epoch: 28, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.430 Vali Acc: 0.884 Test Loss: 0.430 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5751583576202393
Epoch: 29, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.475 Vali Acc: 0.877 Test Loss: 0.475 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.5926048755645752
Epoch: 30, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.442 Vali Acc: 0.884 Test Loss: 0.442 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.5110456943511963
Epoch: 31, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.431 Vali Acc: 0.899 Test Loss: 0.431 Test Acc: 0.899
Validation loss decreased (-0.891300 --> -0.898546).  Saving model ...
Epoch: 32 cost time: 0.6078910827636719
Epoch: 32, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.439 Vali Acc: 0.899 Test Loss: 0.439 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.6052846908569336
Epoch: 33, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.475 Vali Acc: 0.884 Test Loss: 0.475 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.6452140808105469
Epoch: 34, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.446 Vali Acc: 0.899 Test Loss: 0.446 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.5796270370483398
Epoch: 35, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.483 Vali Acc: 0.891 Test Loss: 0.483 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.5386006832122803
Epoch: 36, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.463 Vali Acc: 0.899 Test Loss: 0.463 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.7901515960693359
Epoch: 37, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.459 Vali Acc: 0.899 Test Loss: 0.459 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.5545971393585205
Epoch: 38, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.472 Vali Acc: 0.899 Test Loss: 0.472 Test Acc: 0.899
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.55149245262146
Epoch: 39, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.458 Vali Acc: 0.906 Test Loss: 0.458 Test Acc: 0.906
Validation loss decreased (-0.898546 --> -0.905793).  Saving model ...
Epoch: 40 cost time: 0.5554289817810059
Epoch: 40, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.471 Vali Acc: 0.906 Test Loss: 0.471 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.4796736240386963
Epoch: 41, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.483 Vali Acc: 0.906 Test Loss: 0.483 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.5529947280883789
Epoch: 42, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.482 Vali Acc: 0.906 Test Loss: 0.482 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.6382558345794678
Epoch: 43, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.480 Vali Acc: 0.906 Test Loss: 0.480 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.5294561386108398
Epoch: 44, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.493 Vali Acc: 0.906 Test Loss: 0.493 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.5429174900054932
Epoch: 45, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.491 Vali Acc: 0.906 Test Loss: 0.491 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.5775184631347656
Epoch: 46, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.506 Vali Acc: 0.906 Test Loss: 0.506 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.5472335815429688
Epoch: 47, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.502 Vali Acc: 0.906 Test Loss: 0.502 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.5417566299438477
Epoch: 48, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.493 Vali Acc: 0.906 Test Loss: 0.493 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.595623254776001
Epoch: 49, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.499 Vali Acc: 0.906 Test Loss: 0.499 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm256_cs23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 80302
model size : 0.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm256_cs21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.8228809833526611
Epoch: 1, Steps: 9 | Train Loss: 1.374 Vali Loss: 1.359 Vali Acc: 0.275 Test Loss: 1.359 Test Acc: 0.275
Validation loss decreased (inf --> -0.275349).  Saving model ...
Epoch: 2 cost time: 0.47881007194519043
Epoch: 2, Steps: 9 | Train Loss: 1.303 Vali Loss: 1.290 Vali Acc: 0.341 Test Loss: 1.290 Test Acc: 0.341
Validation loss decreased (-0.275349 --> -0.340567).  Saving model ...
Epoch: 3 cost time: 0.5300605297088623
Epoch: 3, Steps: 9 | Train Loss: 1.231 Vali Loss: 1.213 Vali Acc: 0.399 Test Loss: 1.213 Test Acc: 0.399
Validation loss decreased (-0.340567 --> -0.398539).  Saving model ...
Epoch: 4 cost time: 0.6164071559906006
Epoch: 4, Steps: 9 | Train Loss: 1.137 Vali Loss: 1.140 Vali Acc: 0.435 Test Loss: 1.140 Test Acc: 0.435
Validation loss decreased (-0.398539 --> -0.434771).  Saving model ...
Epoch: 5 cost time: 0.5920724868774414
Epoch: 5, Steps: 9 | Train Loss: 1.036 Vali Loss: 1.087 Vali Acc: 0.478 Test Loss: 1.087 Test Acc: 0.478
Validation loss decreased (-0.434771 --> -0.478250).  Saving model ...
Epoch: 6 cost time: 0.5413436889648438
Epoch: 6, Steps: 9 | Train Loss: 0.966 Vali Loss: 1.046 Vali Acc: 0.493 Test Loss: 1.046 Test Acc: 0.493
Validation loss decreased (-0.478250 --> -0.492743).  Saving model ...
Epoch: 7 cost time: 0.6283488273620605
Epoch: 7, Steps: 9 | Train Loss: 0.882 Vali Loss: 1.015 Vali Acc: 0.522 Test Loss: 1.015 Test Acc: 0.522
Validation loss decreased (-0.492743 --> -0.521729).  Saving model ...
Epoch: 8 cost time: 0.6059715747833252
Epoch: 8, Steps: 9 | Train Loss: 0.813 Vali Loss: 0.972 Vali Acc: 0.558 Test Loss: 0.972 Test Acc: 0.558
Validation loss decreased (-0.521729 --> -0.557961).  Saving model ...
Epoch: 9 cost time: 0.5603914260864258
Epoch: 9, Steps: 9 | Train Loss: 0.749 Vali Loss: 0.931 Vali Acc: 0.601 Test Loss: 0.931 Test Acc: 0.601
Validation loss decreased (-0.557961 --> -0.601440).  Saving model ...
Epoch: 10 cost time: 0.6933765411376953
Epoch: 10, Steps: 9 | Train Loss: 0.653 Vali Loss: 0.868 Vali Acc: 0.645 Test Loss: 0.868 Test Acc: 0.645
Validation loss decreased (-0.601440 --> -0.644919).  Saving model ...
Epoch: 11 cost time: 0.693061351776123
Epoch: 11, Steps: 9 | Train Loss: 0.562 Vali Loss: 0.784 Vali Acc: 0.710 Test Loss: 0.784 Test Acc: 0.710
Validation loss decreased (-0.644919 --> -0.710137).  Saving model ...
Epoch: 12 cost time: 0.7940354347229004
Epoch: 12, Steps: 9 | Train Loss: 0.457 Vali Loss: 0.665 Vali Acc: 0.746 Test Loss: 0.665 Test Acc: 0.746
Validation loss decreased (-0.710137 --> -0.746370).  Saving model ...
Epoch: 13 cost time: 0.5684638023376465
Epoch: 13, Steps: 9 | Train Loss: 0.308 Vali Loss: 0.546 Vali Acc: 0.804 Test Loss: 0.546 Test Acc: 0.804
Validation loss decreased (-0.746370 --> -0.804342).  Saving model ...
Epoch: 14 cost time: 0.6340415477752686
Epoch: 14, Steps: 9 | Train Loss: 0.208 Vali Loss: 0.440 Vali Acc: 0.862 Test Loss: 0.440 Test Acc: 0.862
Validation loss decreased (-0.804342 --> -0.862314).  Saving model ...
Epoch: 15 cost time: 0.5825729370117188
Epoch: 15, Steps: 9 | Train Loss: 0.140 Vali Loss: 0.376 Vali Acc: 0.877 Test Loss: 0.376 Test Acc: 0.877
Validation loss decreased (-0.862314 --> -0.876808).  Saving model ...
Epoch: 16 cost time: 0.5735983848571777
Epoch: 16, Steps: 9 | Train Loss: 0.097 Vali Loss: 0.330 Vali Acc: 0.891 Test Loss: 0.330 Test Acc: 0.891
Validation loss decreased (-0.876808 --> -0.891301).  Saving model ...
Epoch: 17 cost time: 0.5960533618927002
Epoch: 17, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.286 Vali Acc: 0.884 Test Loss: 0.286 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6433303356170654
Epoch: 18, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.271 Vali Acc: 0.899 Test Loss: 0.271 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898548).  Saving model ...
Epoch: 19 cost time: 0.6751885414123535
Epoch: 19, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.246 Vali Acc: 0.906 Test Loss: 0.246 Test Acc: 0.906
Validation loss decreased (-0.898548 --> -0.905795).  Saving model ...
Epoch: 20 cost time: 0.5695075988769531
Epoch: 20, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.241 Vali Acc: 0.920 Test Loss: 0.241 Test Acc: 0.920
Validation loss decreased (-0.905795 --> -0.920287).  Saving model ...
Epoch: 21 cost time: 0.5013234615325928
Epoch: 21, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.262 Vali Acc: 0.891 Test Loss: 0.262 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6282098293304443
Epoch: 22, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.219 Vali Acc: 0.920 Test Loss: 0.219 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920288).  Saving model ...
Epoch: 23 cost time: 0.7174644470214844
Epoch: 23, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.205 Vali Acc: 0.928 Test Loss: 0.205 Test Acc: 0.928
Validation loss decreased (-0.920288 --> -0.927534).  Saving model ...
Epoch: 24 cost time: 0.6690433025360107
Epoch: 24, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.215 Vali Acc: 0.920 Test Loss: 0.215 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5633199214935303
Epoch: 25, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.217 Vali Acc: 0.928 Test Loss: 0.217 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6931402683258057
Epoch: 26, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.214 Vali Acc: 0.928 Test Loss: 0.214 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.5872719287872314
Epoch: 27, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.218 Vali Acc: 0.928 Test Loss: 0.218 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.7477426528930664
Epoch: 28, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.228 Vali Acc: 0.920 Test Loss: 0.228 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.6401798725128174
Epoch: 29, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.216 Vali Acc: 0.928 Test Loss: 0.216 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.5260992050170898
Epoch: 30, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.224 Vali Acc: 0.928 Test Loss: 0.224 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.6118509769439697
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.231 Vali Acc: 0.928 Test Loss: 0.231 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.5618250370025635
Epoch: 32, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.238 Vali Acc: 0.928 Test Loss: 0.238 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.6503541469573975
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.238 Vali Acc: 0.928 Test Loss: 0.238 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm256_cs21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.927536231884058
model parameter : 80706
model size : 0.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm256_cs19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.051664113998413
Epoch: 1, Steps: 9 | Train Loss: 1.395 Vali Loss: 1.326 Vali Acc: 0.457 Test Loss: 1.326 Test Acc: 0.457
Validation loss decreased (inf --> -0.456508).  Saving model ...
Epoch: 2 cost time: 0.666947603225708
Epoch: 2, Steps: 9 | Train Loss: 1.315 Vali Loss: 1.254 Vali Acc: 0.507 Test Loss: 1.254 Test Acc: 0.507
Validation loss decreased (-0.456508 --> -0.507234).  Saving model ...
Epoch: 3 cost time: 0.5722174644470215
Epoch: 3, Steps: 9 | Train Loss: 1.207 Vali Loss: 1.180 Vali Acc: 0.449 Test Loss: 1.180 Test Acc: 0.449
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.569828987121582
Epoch: 4, Steps: 9 | Train Loss: 1.114 Vali Loss: 1.131 Vali Acc: 0.442 Test Loss: 1.131 Test Acc: 0.442
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5647239685058594
Epoch: 5, Steps: 9 | Train Loss: 1.011 Vali Loss: 1.098 Vali Acc: 0.449 Test Loss: 1.098 Test Acc: 0.449
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5733914375305176
Epoch: 6, Steps: 9 | Train Loss: 0.938 Vali Loss: 1.065 Vali Acc: 0.471 Test Loss: 1.065 Test Acc: 0.471
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.591120719909668
Epoch: 7, Steps: 9 | Train Loss: 0.885 Vali Loss: 1.047 Vali Acc: 0.486 Test Loss: 1.047 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5014886856079102
Epoch: 8, Steps: 9 | Train Loss: 0.825 Vali Loss: 1.030 Vali Acc: 0.486 Test Loss: 1.030 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.5943150520324707
Epoch: 9, Steps: 9 | Train Loss: 0.782 Vali Loss: 1.006 Vali Acc: 0.514 Test Loss: 1.006 Test Acc: 0.514
Validation loss decreased (-0.507234 --> -0.514483).  Saving model ...
Epoch: 10 cost time: 0.5775296688079834
Epoch: 10, Steps: 9 | Train Loss: 0.718 Vali Loss: 0.971 Vali Acc: 0.558 Test Loss: 0.971 Test Acc: 0.558
Validation loss decreased (-0.514483 --> -0.557961).  Saving model ...
Epoch: 11 cost time: 0.6330773830413818
Epoch: 11, Steps: 9 | Train Loss: 0.646 Vali Loss: 0.927 Vali Acc: 0.601 Test Loss: 0.927 Test Acc: 0.601
Validation loss decreased (-0.557961 --> -0.601440).  Saving model ...
Epoch: 12 cost time: 0.6466646194458008
Epoch: 12, Steps: 9 | Train Loss: 0.580 Vali Loss: 0.857 Vali Acc: 0.638 Test Loss: 0.857 Test Acc: 0.638
Validation loss decreased (-0.601440 --> -0.637673).  Saving model ...
Epoch: 13 cost time: 0.5232677459716797
Epoch: 13, Steps: 9 | Train Loss: 0.487 Vali Loss: 0.760 Vali Acc: 0.703 Test Loss: 0.760 Test Acc: 0.703
Validation loss decreased (-0.637673 --> -0.702891).  Saving model ...
Epoch: 14 cost time: 0.5644228458404541
Epoch: 14, Steps: 9 | Train Loss: 0.371 Vali Loss: 0.609 Vali Acc: 0.790 Test Loss: 0.609 Test Acc: 0.790
Validation loss decreased (-0.702891 --> -0.789849).  Saving model ...
Epoch: 15 cost time: 0.6145029067993164
Epoch: 15, Steps: 9 | Train Loss: 0.254 Vali Loss: 0.483 Vali Acc: 0.841 Test Loss: 0.483 Test Acc: 0.841
Validation loss decreased (-0.789849 --> -0.840575).  Saving model ...
Epoch: 16 cost time: 0.555595874786377
Epoch: 16, Steps: 9 | Train Loss: 0.164 Vali Loss: 0.376 Vali Acc: 0.877 Test Loss: 0.376 Test Acc: 0.877
Validation loss decreased (-0.840575 --> -0.876808).  Saving model ...
Epoch: 17 cost time: 0.5375566482543945
Epoch: 17, Steps: 9 | Train Loss: 0.107 Vali Loss: 0.337 Vali Acc: 0.877 Test Loss: 0.337 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 18 cost time: 0.6068062782287598
Epoch: 18, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.326 Vali Acc: 0.884 Test Loss: 0.326 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884055).  Saving model ...
Epoch: 19 cost time: 0.5136654376983643
Epoch: 19, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.293 Vali Acc: 0.899 Test Loss: 0.293 Test Acc: 0.899
Validation loss decreased (-0.884055 --> -0.898548).  Saving model ...
Epoch: 20 cost time: 0.6769311428070068
Epoch: 20, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.292 Vali Acc: 0.899 Test Loss: 0.292 Test Acc: 0.899
Validation loss decreased (-0.898548 --> -0.898548).  Saving model ...
Epoch: 21 cost time: 0.634166955947876
Epoch: 21, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.296 Vali Acc: 0.891 Test Loss: 0.296 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.607903003692627
Epoch: 22, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.271 Vali Acc: 0.906 Test Loss: 0.271 Test Acc: 0.906
Validation loss decreased (-0.898548 --> -0.905794).  Saving model ...
Epoch: 23 cost time: 0.690640926361084
Epoch: 23, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.254 Vali Acc: 0.906 Test Loss: 0.254 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905795).  Saving model ...
Epoch: 24 cost time: 0.6034471988677979
Epoch: 24, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.253 Vali Acc: 0.906 Test Loss: 0.253 Test Acc: 0.906
Validation loss decreased (-0.905795 --> -0.905795).  Saving model ...
Epoch: 25 cost time: 0.626185417175293
Epoch: 25, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.264 Vali Acc: 0.920 Test Loss: 0.264 Test Acc: 0.920
Validation loss decreased (-0.905795 --> -0.920287).  Saving model ...
Epoch: 26 cost time: 0.7299666404724121
Epoch: 26, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.253 Vali Acc: 0.920 Test Loss: 0.253 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 27 cost time: 0.703890323638916
Epoch: 27, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.238 Vali Acc: 0.928 Test Loss: 0.238 Test Acc: 0.928
Validation loss decreased (-0.920287 --> -0.927534).  Saving model ...
Epoch: 28 cost time: 0.5284023284912109
Epoch: 28, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.238 Vali Acc: 0.928 Test Loss: 0.238 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 29 cost time: 0.5717310905456543
Epoch: 29, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.254 Vali Acc: 0.928 Test Loss: 0.254 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5377154350280762
Epoch: 30, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.254 Vali Acc: 0.935 Test Loss: 0.254 Test Acc: 0.935
Validation loss decreased (-0.927534 --> -0.934780).  Saving model ...
Epoch: 31 cost time: 0.5410904884338379
Epoch: 31, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.247 Vali Acc: 0.935 Test Loss: 0.247 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 32 cost time: 0.7229814529418945
Epoch: 32, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.236 Vali Acc: 0.942 Test Loss: 0.236 Test Acc: 0.942
Validation loss decreased (-0.934780 --> -0.942027).  Saving model ...
Epoch: 33 cost time: 0.5202617645263672
Epoch: 33, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.236 Vali Acc: 0.942 Test Loss: 0.236 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5632116794586182
Epoch: 34, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.241 Vali Acc: 0.935 Test Loss: 0.241 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.5163509845733643
Epoch: 35, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.246 Vali Acc: 0.935 Test Loss: 0.246 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.48491930961608887
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.248 Vali Acc: 0.935 Test Loss: 0.248 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.6053545475006104
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.242 Vali Acc: 0.942 Test Loss: 0.242 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.6098911762237549
Epoch: 38, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.242 Vali Acc: 0.942 Test Loss: 0.242 Test Acc: 0.942
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.555377721786499
Epoch: 39, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.246 Vali Acc: 0.942 Test Loss: 0.246 Test Acc: 0.942
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.5285053253173828
Epoch: 40, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.240 Vali Acc: 0.942 Test Loss: 0.240 Test Acc: 0.942
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.604952335357666
Epoch: 41, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.243 Vali Acc: 0.942 Test Loss: 0.243 Test Acc: 0.942
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.6755013465881348
Epoch: 42, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.247 Vali Acc: 0.942 Test Loss: 0.247 Test Acc: 0.942
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm256_cs19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9420289855072463
model parameter : 80290
model size : 0.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm256_cs18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.878537893295288
Epoch: 1, Steps: 9 | Train Loss: 1.453 Vali Loss: 1.362 Vali Acc: 0.391 Test Loss: 1.362 Test Acc: 0.391
Validation loss decreased (inf --> -0.391291).  Saving model ...
Epoch: 2 cost time: 0.6507689952850342
Epoch: 2, Steps: 9 | Train Loss: 1.365 Vali Loss: 1.282 Vali Acc: 0.457 Test Loss: 1.282 Test Acc: 0.457
Validation loss decreased (-0.391291 --> -0.456509).  Saving model ...
Epoch: 3 cost time: 0.5153744220733643
Epoch: 3, Steps: 9 | Train Loss: 1.244 Vali Loss: 1.203 Vali Acc: 0.500 Test Loss: 1.203 Test Acc: 0.500
Validation loss decreased (-0.456509 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 0.6645967960357666
Epoch: 4, Steps: 9 | Train Loss: 1.142 Vali Loss: 1.139 Vali Acc: 0.514 Test Loss: 1.139 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.514481).  Saving model ...
Epoch: 5 cost time: 0.6391479969024658
Epoch: 5, Steps: 9 | Train Loss: 1.042 Vali Loss: 1.102 Vali Acc: 0.449 Test Loss: 1.102 Test Acc: 0.449
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6537671089172363
Epoch: 6, Steps: 9 | Train Loss: 0.945 Vali Loss: 1.071 Vali Acc: 0.464 Test Loss: 1.071 Test Acc: 0.464
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5492379665374756
Epoch: 7, Steps: 9 | Train Loss: 0.900 Vali Loss: 1.049 Vali Acc: 0.493 Test Loss: 1.049 Test Acc: 0.493
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.6462888717651367
Epoch: 8, Steps: 9 | Train Loss: 0.850 Vali Loss: 1.020 Vali Acc: 0.514 Test Loss: 1.020 Test Acc: 0.514
Validation loss decreased (-0.514481 --> -0.514483).  Saving model ...
Epoch: 9 cost time: 0.6884596347808838
Epoch: 9, Steps: 9 | Train Loss: 0.793 Vali Loss: 0.990 Vali Acc: 0.558 Test Loss: 0.990 Test Acc: 0.558
Validation loss decreased (-0.514483 --> -0.557961).  Saving model ...
Epoch: 10 cost time: 0.6571905612945557
Epoch: 10, Steps: 9 | Train Loss: 0.740 Vali Loss: 0.972 Vali Acc: 0.565 Test Loss: 0.972 Test Acc: 0.565
Validation loss decreased (-0.557961 --> -0.565208).  Saving model ...
Epoch: 11 cost time: 0.7020127773284912
Epoch: 11, Steps: 9 | Train Loss: 0.691 Vali Loss: 0.935 Vali Acc: 0.580 Test Loss: 0.935 Test Acc: 0.580
Validation loss decreased (-0.565208 --> -0.579701).  Saving model ...
Epoch: 12 cost time: 0.5996718406677246
Epoch: 12, Steps: 9 | Train Loss: 0.610 Vali Loss: 0.901 Vali Acc: 0.623 Test Loss: 0.901 Test Acc: 0.623
Validation loss decreased (-0.579701 --> -0.623179).  Saving model ...
Epoch: 13 cost time: 0.5920016765594482
Epoch: 13, Steps: 9 | Train Loss: 0.525 Vali Loss: 0.803 Vali Acc: 0.659 Test Loss: 0.803 Test Acc: 0.659
Validation loss decreased (-0.623179 --> -0.659412).  Saving model ...
Epoch: 14 cost time: 0.6492049694061279
Epoch: 14, Steps: 9 | Train Loss: 0.440 Vali Loss: 0.665 Vali Acc: 0.754 Test Loss: 0.665 Test Acc: 0.754
Validation loss decreased (-0.659412 --> -0.753617).  Saving model ...
Epoch: 15 cost time: 0.6823225021362305
Epoch: 15, Steps: 9 | Train Loss: 0.317 Vali Loss: 0.536 Vali Acc: 0.812 Test Loss: 0.536 Test Acc: 0.812
Validation loss decreased (-0.753617 --> -0.811589).  Saving model ...
Epoch: 16 cost time: 0.6879894733428955
Epoch: 16, Steps: 9 | Train Loss: 0.206 Vali Loss: 0.416 Vali Acc: 0.870 Test Loss: 0.416 Test Acc: 0.870
Validation loss decreased (-0.811589 --> -0.869561).  Saving model ...
Epoch: 17 cost time: 0.6662559509277344
Epoch: 17, Steps: 9 | Train Loss: 0.128 Vali Loss: 0.353 Vali Acc: 0.891 Test Loss: 0.353 Test Acc: 0.891
Validation loss decreased (-0.869561 --> -0.891301).  Saving model ...
Epoch: 18 cost time: 0.6052761077880859
Epoch: 18, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.287 Vali Acc: 0.906 Test Loss: 0.287 Test Acc: 0.906
Validation loss decreased (-0.891301 --> -0.905794).  Saving model ...
Epoch: 19 cost time: 0.6408703327178955
Epoch: 19, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.293 Vali Acc: 0.913 Test Loss: 0.293 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913041).  Saving model ...
Epoch: 20 cost time: 0.7108933925628662
Epoch: 20, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.275 Vali Acc: 0.906 Test Loss: 0.275 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6144673824310303
Epoch: 21, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.298 Vali Acc: 0.891 Test Loss: 0.298 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5911612510681152
Epoch: 22, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.283 Vali Acc: 0.899 Test Loss: 0.283 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.652296781539917
Epoch: 23, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.276 Vali Acc: 0.906 Test Loss: 0.276 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.633615255355835
Epoch: 24, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.287 Vali Acc: 0.906 Test Loss: 0.287 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7337756156921387
Epoch: 25, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.285 Vali Acc: 0.906 Test Loss: 0.285 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.6454927921295166
Epoch: 26, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.286 Vali Acc: 0.928 Test Loss: 0.286 Test Acc: 0.928
Validation loss decreased (-0.913041 --> -0.927533).  Saving model ...
Epoch: 27 cost time: 0.5731401443481445
Epoch: 27, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.318 Vali Acc: 0.899 Test Loss: 0.318 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5741896629333496
Epoch: 28, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.293 Vali Acc: 0.928 Test Loss: 0.293 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6487734317779541
Epoch: 29, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.292 Vali Acc: 0.913 Test Loss: 0.292 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.7036633491516113
Epoch: 30, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.292 Vali Acc: 0.906 Test Loss: 0.292 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.6038610935211182
Epoch: 31, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.296 Vali Acc: 0.913 Test Loss: 0.296 Test Acc: 0.913
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.702549934387207
Epoch: 32, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.299 Vali Acc: 0.920 Test Loss: 0.299 Test Acc: 0.920
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.5566661357879639
Epoch: 33, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.304 Vali Acc: 0.920 Test Loss: 0.304 Test Acc: 0.920
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.6267006397247314
Epoch: 34, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.309 Vali Acc: 0.920 Test Loss: 0.309 Test Acc: 0.920
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.6461634635925293
Epoch: 35, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.311 Vali Acc: 0.928 Test Loss: 0.311 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.5602266788482666
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.314 Vali Acc: 0.920 Test Loss: 0.314 Test Acc: 0.920
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm256_cs18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.927536231884058
model parameter : 81654
model size : 0.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm256_cs16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.012084722518921
Epoch: 1, Steps: 9 | Train Loss: 1.431 Vali Loss: 1.402 Vali Acc: 0.341 Test Loss: 1.402 Test Acc: 0.341
Validation loss decreased (inf --> -0.340566).  Saving model ...
Epoch: 2 cost time: 0.5601370334625244
Epoch: 2, Steps: 9 | Train Loss: 1.363 Vali Loss: 1.318 Vali Acc: 0.420 Test Loss: 1.318 Test Acc: 0.420
Validation loss decreased (-0.340566 --> -0.420277).  Saving model ...
Epoch: 3 cost time: 0.5805611610412598
Epoch: 3, Steps: 9 | Train Loss: 1.254 Vali Loss: 1.227 Vali Acc: 0.514 Test Loss: 1.227 Test Acc: 0.514
Validation loss decreased (-0.420277 --> -0.514480).  Saving model ...
Epoch: 4 cost time: 0.7291333675384521
Epoch: 4, Steps: 9 | Train Loss: 1.140 Vali Loss: 1.160 Vali Acc: 0.522 Test Loss: 1.160 Test Acc: 0.522
Validation loss decreased (-0.514480 --> -0.521728).  Saving model ...
Epoch: 5 cost time: 0.6996495723724365
Epoch: 5, Steps: 9 | Train Loss: 1.051 Vali Loss: 1.117 Vali Acc: 0.522 Test Loss: 1.117 Test Acc: 0.522
Validation loss decreased (-0.521728 --> -0.521728).  Saving model ...
Epoch: 6 cost time: 0.6836395263671875
Epoch: 6, Steps: 9 | Train Loss: 1.007 Vali Loss: 1.087 Vali Acc: 0.558 Test Loss: 1.087 Test Acc: 0.558
Validation loss decreased (-0.521728 --> -0.557960).  Saving model ...
Epoch: 7 cost time: 0.7321522235870361
Epoch: 7, Steps: 9 | Train Loss: 0.921 Vali Loss: 1.055 Vali Acc: 0.536 Test Loss: 1.055 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6484472751617432
Epoch: 8, Steps: 9 | Train Loss: 0.854 Vali Loss: 1.030 Vali Acc: 0.558 Test Loss: 1.030 Test Acc: 0.558
Validation loss decreased (-0.557960 --> -0.557961).  Saving model ...
Epoch: 9 cost time: 0.6294059753417969
Epoch: 9, Steps: 9 | Train Loss: 0.809 Vali Loss: 1.009 Vali Acc: 0.572 Test Loss: 1.009 Test Acc: 0.572
Validation loss decreased (-0.557961 --> -0.572454).  Saving model ...
Epoch: 10 cost time: 0.5858025550842285
Epoch: 10, Steps: 9 | Train Loss: 0.746 Vali Loss: 0.984 Vali Acc: 0.580 Test Loss: 0.984 Test Acc: 0.580
Validation loss decreased (-0.572454 --> -0.579700).  Saving model ...
Epoch: 11 cost time: 0.5690596103668213
Epoch: 11, Steps: 9 | Train Loss: 0.692 Vali Loss: 0.938 Vali Acc: 0.601 Test Loss: 0.938 Test Acc: 0.601
Validation loss decreased (-0.579700 --> -0.601440).  Saving model ...
Epoch: 12 cost time: 0.525122880935669
Epoch: 12, Steps: 9 | Train Loss: 0.623 Vali Loss: 0.901 Vali Acc: 0.638 Test Loss: 0.901 Test Acc: 0.638
Validation loss decreased (-0.601440 --> -0.637672).  Saving model ...
Epoch: 13 cost time: 0.5304133892059326
Epoch: 13, Steps: 9 | Train Loss: 0.544 Vali Loss: 0.841 Vali Acc: 0.710 Test Loss: 0.841 Test Acc: 0.710
Validation loss decreased (-0.637672 --> -0.710137).  Saving model ...
Epoch: 14 cost time: 0.6836745738983154
Epoch: 14, Steps: 9 | Train Loss: 0.447 Vali Loss: 0.739 Vali Acc: 0.754 Test Loss: 0.739 Test Acc: 0.754
Validation loss decreased (-0.710137 --> -0.753616).  Saving model ...
Epoch: 15 cost time: 0.6524631977081299
Epoch: 15, Steps: 9 | Train Loss: 0.343 Vali Loss: 0.599 Vali Acc: 0.797 Test Loss: 0.599 Test Acc: 0.797
Validation loss decreased (-0.753616 --> -0.797095).  Saving model ...
Epoch: 16 cost time: 0.6689083576202393
Epoch: 16, Steps: 9 | Train Loss: 0.266 Vali Loss: 0.485 Vali Acc: 0.841 Test Loss: 0.485 Test Acc: 0.841
Validation loss decreased (-0.797095 --> -0.840575).  Saving model ...
Epoch: 17 cost time: 0.6382598876953125
Epoch: 17, Steps: 9 | Train Loss: 0.188 Vali Loss: 0.423 Vali Acc: 0.848 Test Loss: 0.423 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847822).  Saving model ...
Epoch: 18 cost time: 0.6883387565612793
Epoch: 18, Steps: 9 | Train Loss: 0.121 Vali Loss: 0.357 Vali Acc: 0.884 Test Loss: 0.357 Test Acc: 0.884
Validation loss decreased (-0.847822 --> -0.884054).  Saving model ...
Epoch: 19 cost time: 0.7243819236755371
Epoch: 19, Steps: 9 | Train Loss: 0.089 Vali Loss: 0.332 Vali Acc: 0.899 Test Loss: 0.332 Test Acc: 0.899
Validation loss decreased (-0.884054 --> -0.898547).  Saving model ...
Epoch: 20 cost time: 0.6750333309173584
Epoch: 20, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.322 Vali Acc: 0.891 Test Loss: 0.322 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7442426681518555
Epoch: 21, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.311 Vali Acc: 0.899 Test Loss: 0.311 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898548).  Saving model ...
Epoch: 22 cost time: 0.4923214912414551
Epoch: 22, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.273 Vali Acc: 0.906 Test Loss: 0.273 Test Acc: 0.906
Validation loss decreased (-0.898548 --> -0.905794).  Saving model ...
Epoch: 23 cost time: 0.6735210418701172
Epoch: 23, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.271 Vali Acc: 0.913 Test Loss: 0.271 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913041).  Saving model ...
Epoch: 24 cost time: 0.6845579147338867
Epoch: 24, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.277 Vali Acc: 0.920 Test Loss: 0.277 Test Acc: 0.920
Validation loss decreased (-0.913041 --> -0.920287).  Saving model ...
Epoch: 25 cost time: 0.5415832996368408
Epoch: 25, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.277 Vali Acc: 0.920 Test Loss: 0.277 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6682846546173096
Epoch: 26, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.260 Vali Acc: 0.920 Test Loss: 0.260 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 27 cost time: 0.569221019744873
Epoch: 27, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.269 Vali Acc: 0.928 Test Loss: 0.269 Test Acc: 0.928
Validation loss decreased (-0.920287 --> -0.927534).  Saving model ...
Epoch: 28 cost time: 0.6193783283233643
Epoch: 28, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.281 Vali Acc: 0.935 Test Loss: 0.281 Test Acc: 0.935
Validation loss decreased (-0.927534 --> -0.934780).  Saving model ...
Epoch: 29 cost time: 0.6077215671539307
Epoch: 29, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.278 Vali Acc: 0.928 Test Loss: 0.278 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6021995544433594
Epoch: 30, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.269 Vali Acc: 0.935 Test Loss: 0.269 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 31 cost time: 0.6235132217407227
Epoch: 31, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.263 Vali Acc: 0.928 Test Loss: 0.263 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6614458560943604
Epoch: 32, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.269 Vali Acc: 0.942 Test Loss: 0.269 Test Acc: 0.942
Validation loss decreased (-0.934780 --> -0.942026).  Saving model ...
Epoch: 33 cost time: 0.5871286392211914
Epoch: 33, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.279 Vali Acc: 0.942 Test Loss: 0.279 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5819973945617676
Epoch: 34, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.278 Vali Acc: 0.942 Test Loss: 0.278 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.5433385372161865
Epoch: 35, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.275 Vali Acc: 0.942 Test Loss: 0.275 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.5289218425750732
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.278 Vali Acc: 0.942 Test Loss: 0.278 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.5393505096435547
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.279 Vali Acc: 0.942 Test Loss: 0.279 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.5730345249176025
Epoch: 38, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.281 Vali Acc: 0.942 Test Loss: 0.281 Test Acc: 0.942
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.534564733505249
Epoch: 39, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.275 Vali Acc: 0.935 Test Loss: 0.275 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.5300049781799316
Epoch: 40, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.282 Vali Acc: 0.942 Test Loss: 0.282 Test Acc: 0.942
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.5705230236053467
Epoch: 41, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.287 Vali Acc: 0.942 Test Loss: 0.287 Test Acc: 0.942
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.63047194480896
Epoch: 42, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.291 Vali Acc: 0.942 Test Loss: 0.291 Test Acc: 0.942
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm256_cs16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9420289855072463
model parameter : 79804
model size : 0.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm256_cs15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.9111745357513428
Epoch: 1, Steps: 9 | Train Loss: 1.416 Vali Loss: 1.393 Vali Acc: 0.297 Test Loss: 1.393 Test Acc: 0.297
Validation loss decreased (inf --> -0.297088).  Saving model ...
Epoch: 2 cost time: 0.5511200428009033
Epoch: 2, Steps: 9 | Train Loss: 1.337 Vali Loss: 1.299 Vali Acc: 0.384 Test Loss: 1.299 Test Acc: 0.384
Validation loss decreased (-0.297088 --> -0.384045).  Saving model ...
Epoch: 3 cost time: 0.5335161685943604
Epoch: 3, Steps: 9 | Train Loss: 1.222 Vali Loss: 1.201 Vali Acc: 0.464 Test Loss: 1.201 Test Acc: 0.464
Validation loss decreased (-0.384045 --> -0.463756).  Saving model ...
Epoch: 4 cost time: 0.598344087600708
Epoch: 4, Steps: 9 | Train Loss: 1.117 Vali Loss: 1.117 Vali Acc: 0.500 Test Loss: 1.117 Test Acc: 0.500
Validation loss decreased (-0.463756 --> -0.499989).  Saving model ...
Epoch: 5 cost time: 0.5453014373779297
Epoch: 5, Steps: 9 | Train Loss: 1.011 Vali Loss: 1.060 Vali Acc: 0.507 Test Loss: 1.060 Test Acc: 0.507
Validation loss decreased (-0.499989 --> -0.507236).  Saving model ...
Epoch: 6 cost time: 0.529144287109375
Epoch: 6, Steps: 9 | Train Loss: 0.924 Vali Loss: 1.023 Vali Acc: 0.486 Test Loss: 1.023 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5785930156707764
Epoch: 7, Steps: 9 | Train Loss: 0.854 Vali Loss: 0.985 Vali Acc: 0.493 Test Loss: 0.985 Test Acc: 0.493
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5798089504241943
Epoch: 8, Steps: 9 | Train Loss: 0.778 Vali Loss: 0.914 Vali Acc: 0.572 Test Loss: 0.914 Test Acc: 0.572
Validation loss decreased (-0.507236 --> -0.572455).  Saving model ...
Epoch: 9 cost time: 0.6250896453857422
Epoch: 9, Steps: 9 | Train Loss: 0.697 Vali Loss: 0.822 Vali Acc: 0.652 Test Loss: 0.822 Test Acc: 0.652
Validation loss decreased (-0.572455 --> -0.652166).  Saving model ...
Epoch: 10 cost time: 0.47159862518310547
Epoch: 10, Steps: 9 | Train Loss: 0.568 Vali Loss: 0.709 Vali Acc: 0.739 Test Loss: 0.709 Test Acc: 0.739
Validation loss decreased (-0.652166 --> -0.739123).  Saving model ...
Epoch: 11 cost time: 0.6216225624084473
Epoch: 11, Steps: 9 | Train Loss: 0.433 Vali Loss: 0.575 Vali Acc: 0.812 Test Loss: 0.575 Test Acc: 0.812
Validation loss decreased (-0.739123 --> -0.811588).  Saving model ...
Epoch: 12 cost time: 0.4975762367248535
Epoch: 12, Steps: 9 | Train Loss: 0.304 Vali Loss: 0.445 Vali Acc: 0.848 Test Loss: 0.445 Test Acc: 0.848
Validation loss decreased (-0.811588 --> -0.847822).  Saving model ...
Epoch: 13 cost time: 0.583667516708374
Epoch: 13, Steps: 9 | Train Loss: 0.219 Vali Loss: 0.374 Vali Acc: 0.870 Test Loss: 0.374 Test Acc: 0.870
Validation loss decreased (-0.847822 --> -0.869561).  Saving model ...
Epoch: 14 cost time: 0.5028336048126221
Epoch: 14, Steps: 9 | Train Loss: 0.144 Vali Loss: 0.320 Vali Acc: 0.891 Test Loss: 0.320 Test Acc: 0.891
Validation loss decreased (-0.869561 --> -0.891301).  Saving model ...
Epoch: 15 cost time: 0.5177721977233887
Epoch: 15, Steps: 9 | Train Loss: 0.106 Vali Loss: 0.310 Vali Acc: 0.899 Test Loss: 0.310 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898548).  Saving model ...
Epoch: 16 cost time: 0.48350048065185547
Epoch: 16, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.279 Vali Acc: 0.899 Test Loss: 0.279 Test Acc: 0.899
Validation loss decreased (-0.898548 --> -0.898548).  Saving model ...
Epoch: 17 cost time: 0.6071600914001465
Epoch: 17, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.256 Vali Acc: 0.906 Test Loss: 0.256 Test Acc: 0.906
Validation loss decreased (-0.898548 --> -0.905795).  Saving model ...
Epoch: 18 cost time: 0.4928431510925293
Epoch: 18, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.252 Vali Acc: 0.928 Test Loss: 0.252 Test Acc: 0.928
Validation loss decreased (-0.905795 --> -0.927534).  Saving model ...
Epoch: 19 cost time: 0.514559268951416
Epoch: 19, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.267 Vali Acc: 0.928 Test Loss: 0.267 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.48070359230041504
Epoch: 20, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.264 Vali Acc: 0.935 Test Loss: 0.264 Test Acc: 0.935
Validation loss decreased (-0.927534 --> -0.934780).  Saving model ...
Epoch: 21 cost time: 0.5532679557800293
Epoch: 21, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.239 Vali Acc: 0.942 Test Loss: 0.239 Test Acc: 0.942
Validation loss decreased (-0.934780 --> -0.942027).  Saving model ...
Epoch: 22 cost time: 0.6008491516113281
Epoch: 22, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.220 Vali Acc: 0.949 Test Loss: 0.220 Test Acc: 0.949
Validation loss decreased (-0.942027 --> -0.949273).  Saving model ...
Epoch: 23 cost time: 0.5768554210662842
Epoch: 23, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.223 Vali Acc: 0.949 Test Loss: 0.223 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.571380615234375
Epoch: 24, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.211 Vali Acc: 0.949 Test Loss: 0.211 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949273).  Saving model ...
Epoch: 25 cost time: 0.4877970218658447
Epoch: 25, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.194 Vali Acc: 0.964 Test Loss: 0.194 Test Acc: 0.964
Validation loss decreased (-0.949273 --> -0.963766).  Saving model ...
Epoch: 26 cost time: 0.57220458984375
Epoch: 26, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.213 Vali Acc: 0.949 Test Loss: 0.213 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6957416534423828
Epoch: 27, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.177 Vali Acc: 0.964 Test Loss: 0.177 Test Acc: 0.964
Validation loss decreased (-0.963766 --> -0.963766).  Saving model ...
Epoch: 28 cost time: 0.563737154006958
Epoch: 28, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.181 Vali Acc: 0.964 Test Loss: 0.181 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6012415885925293
Epoch: 29, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.193 Vali Acc: 0.957 Test Loss: 0.193 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.5709037780761719
Epoch: 30, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.185 Vali Acc: 0.964 Test Loss: 0.185 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.5384416580200195
Epoch: 31, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.178 Vali Acc: 0.964 Test Loss: 0.178 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.5215702056884766
Epoch: 32, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.191 Vali Acc: 0.964 Test Loss: 0.191 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.5457537174224854
Epoch: 33, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.175 Vali Acc: 0.964 Test Loss: 0.175 Test Acc: 0.964
Validation loss decreased (-0.963766 --> -0.963766).  Saving model ...
Epoch: 34 cost time: 0.578479528427124
Epoch: 34, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.166 Vali Acc: 0.964 Test Loss: 0.166 Test Acc: 0.964
Validation loss decreased (-0.963766 --> -0.963766).  Saving model ...
Epoch: 35 cost time: 0.6792190074920654
Epoch: 35, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.174 Vali Acc: 0.964 Test Loss: 0.174 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.5369629859924316
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.181 Vali Acc: 0.964 Test Loss: 0.181 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.5526454448699951
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.177 Vali Acc: 0.964 Test Loss: 0.177 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.5500383377075195
Epoch: 38, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.176 Vali Acc: 0.964 Test Loss: 0.176 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.5678815841674805
Epoch: 39, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.174 Vali Acc: 0.964 Test Loss: 0.174 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.6604752540588379
Epoch: 40, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.964 Test Loss: 0.175 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.5805919170379639
Epoch: 41, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.964 Test Loss: 0.176 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.6356422901153564
Epoch: 42, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.964 Test Loss: 0.176 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.5122058391571045
Epoch: 43, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.964 Test Loss: 0.172 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.6088664531707764
Epoch: 44, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.964 Test Loss: 0.175 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm256_cs15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9637681159420289
model parameter : 80146
model size : 0.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm256_cs14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.7540500164031982
Epoch: 1, Steps: 9 | Train Loss: 1.356 Vali Loss: 1.354 Vali Acc: 0.355 Test Loss: 1.354 Test Acc: 0.355
Validation loss decreased (inf --> -0.355059).  Saving model ...
Epoch: 2 cost time: 0.6961138248443604
Epoch: 2, Steps: 9 | Train Loss: 1.294 Vali Loss: 1.277 Vali Acc: 0.442 Test Loss: 1.277 Test Acc: 0.442
Validation loss decreased (-0.355059 --> -0.442016).  Saving model ...
Epoch: 3 cost time: 0.5717923641204834
Epoch: 3, Steps: 9 | Train Loss: 1.201 Vali Loss: 1.195 Vali Acc: 0.514 Test Loss: 1.195 Test Acc: 0.514
Validation loss decreased (-0.442016 --> -0.514481).  Saving model ...
Epoch: 4 cost time: 0.5193679332733154
Epoch: 4, Steps: 9 | Train Loss: 1.106 Vali Loss: 1.139 Vali Acc: 0.507 Test Loss: 1.139 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5660581588745117
Epoch: 5, Steps: 9 | Train Loss: 1.032 Vali Loss: 1.096 Vali Acc: 0.529 Test Loss: 1.096 Test Acc: 0.529
Validation loss decreased (-0.514481 --> -0.528975).  Saving model ...
Epoch: 6 cost time: 0.5390069484710693
Epoch: 6, Steps: 9 | Train Loss: 0.974 Vali Loss: 1.072 Vali Acc: 0.514 Test Loss: 1.072 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5864880084991455
Epoch: 7, Steps: 9 | Train Loss: 0.912 Vali Loss: 1.051 Vali Acc: 0.500 Test Loss: 1.051 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6603612899780273
Epoch: 8, Steps: 9 | Train Loss: 0.841 Vali Loss: 1.023 Vali Acc: 0.536 Test Loss: 1.023 Test Acc: 0.536
Validation loss decreased (-0.528975 --> -0.536222).  Saving model ...
Epoch: 9 cost time: 0.5207531452178955
Epoch: 9, Steps: 9 | Train Loss: 0.805 Vali Loss: 0.995 Vali Acc: 0.551 Test Loss: 0.995 Test Acc: 0.551
Validation loss decreased (-0.536222 --> -0.550715).  Saving model ...
Epoch: 10 cost time: 0.6147887706756592
Epoch: 10, Steps: 9 | Train Loss: 0.758 Vali Loss: 0.986 Vali Acc: 0.565 Test Loss: 0.986 Test Acc: 0.565
Validation loss decreased (-0.550715 --> -0.565208).  Saving model ...
Epoch: 11 cost time: 0.5350325107574463
Epoch: 11, Steps: 9 | Train Loss: 0.698 Vali Loss: 0.960 Vali Acc: 0.594 Test Loss: 0.960 Test Acc: 0.594
Validation loss decreased (-0.565208 --> -0.594193).  Saving model ...
Epoch: 12 cost time: 0.49231839179992676
Epoch: 12, Steps: 9 | Train Loss: 0.624 Vali Loss: 0.906 Vali Acc: 0.652 Test Loss: 0.906 Test Acc: 0.652
Validation loss decreased (-0.594193 --> -0.652165).  Saving model ...
Epoch: 13 cost time: 0.5218832492828369
Epoch: 13, Steps: 9 | Train Loss: 0.545 Vali Loss: 0.815 Vali Acc: 0.674 Test Loss: 0.815 Test Acc: 0.674
Validation loss decreased (-0.652165 --> -0.673905).  Saving model ...
Epoch: 14 cost time: 0.6324255466461182
Epoch: 14, Steps: 9 | Train Loss: 0.423 Vali Loss: 0.666 Vali Acc: 0.754 Test Loss: 0.666 Test Acc: 0.754
Validation loss decreased (-0.673905 --> -0.753617).  Saving model ...
Epoch: 15 cost time: 0.5650863647460938
Epoch: 15, Steps: 9 | Train Loss: 0.290 Vali Loss: 0.527 Vali Acc: 0.819 Test Loss: 0.527 Test Acc: 0.819
Validation loss decreased (-0.753617 --> -0.818835).  Saving model ...
Epoch: 16 cost time: 0.5179164409637451
Epoch: 16, Steps: 9 | Train Loss: 0.191 Vali Loss: 0.457 Vali Acc: 0.841 Test Loss: 0.457 Test Acc: 0.841
Validation loss decreased (-0.818835 --> -0.840575).  Saving model ...
Epoch: 17 cost time: 0.5867941379547119
Epoch: 17, Steps: 9 | Train Loss: 0.131 Vali Loss: 0.415 Vali Acc: 0.870 Test Loss: 0.415 Test Acc: 0.870
Validation loss decreased (-0.840575 --> -0.869561).  Saving model ...
Epoch: 18 cost time: 0.5900177955627441
Epoch: 18, Steps: 9 | Train Loss: 0.100 Vali Loss: 0.397 Vali Acc: 0.884 Test Loss: 0.397 Test Acc: 0.884
Validation loss decreased (-0.869561 --> -0.884054).  Saving model ...
Epoch: 19 cost time: 0.5139167308807373
Epoch: 19, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.378 Vali Acc: 0.891 Test Loss: 0.378 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891301).  Saving model ...
Epoch: 20 cost time: 0.5711345672607422
Epoch: 20, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.364 Vali Acc: 0.891 Test Loss: 0.364 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 21 cost time: 0.6166071891784668
Epoch: 21, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.358 Vali Acc: 0.891 Test Loss: 0.358 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 22 cost time: 0.6005055904388428
Epoch: 22, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.347 Vali Acc: 0.913 Test Loss: 0.347 Test Acc: 0.913
Validation loss decreased (-0.891301 --> -0.913040).  Saving model ...
Epoch: 23 cost time: 0.5477001667022705
Epoch: 23, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.348 Vali Acc: 0.913 Test Loss: 0.348 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5622067451477051
Epoch: 24, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.379 Vali Acc: 0.899 Test Loss: 0.379 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.6285550594329834
Epoch: 25, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.353 Vali Acc: 0.913 Test Loss: 0.353 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.5951354503631592
Epoch: 26, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.351 Vali Acc: 0.920 Test Loss: 0.351 Test Acc: 0.920
Validation loss decreased (-0.913040 --> -0.920286).  Saving model ...
Epoch: 27 cost time: 0.662104606628418
Epoch: 27, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.382 Vali Acc: 0.906 Test Loss: 0.382 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5682263374328613
Epoch: 28, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.365 Vali Acc: 0.920 Test Loss: 0.365 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.5588340759277344
Epoch: 29, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.359 Vali Acc: 0.928 Test Loss: 0.359 Test Acc: 0.928
Validation loss decreased (-0.920286 --> -0.927533).  Saving model ...
Epoch: 30 cost time: 0.5764422416687012
Epoch: 30, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.388 Vali Acc: 0.920 Test Loss: 0.388 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5457284450531006
Epoch: 31, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.394 Vali Acc: 0.920 Test Loss: 0.394 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.7326517105102539
Epoch: 32, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.415 Vali Acc: 0.913 Test Loss: 0.415 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.5571706295013428
Epoch: 33, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.426 Vali Acc: 0.913 Test Loss: 0.426 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.5943140983581543
Epoch: 34, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.398 Vali Acc: 0.928 Test Loss: 0.398 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.5666322708129883
Epoch: 35, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.405 Vali Acc: 0.920 Test Loss: 0.405 Test Acc: 0.920
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.521399736404419
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.427 Vali Acc: 0.920 Test Loss: 0.427 Test Acc: 0.920
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.7275600433349609
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.433 Vali Acc: 0.920 Test Loss: 0.433 Test Acc: 0.920
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.5759625434875488
Epoch: 38, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.428 Vali Acc: 0.920 Test Loss: 0.428 Test Acc: 0.920
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.5658619403839111
Epoch: 39, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.432 Vali Acc: 0.920 Test Loss: 0.432 Test Acc: 0.920
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm256_cs14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.927536231884058
model parameter : 80080
model size : 0.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm256_cs13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.9153850078582764
Epoch: 1, Steps: 9 | Train Loss: 1.359 Vali Loss: 1.318 Vali Acc: 0.348 Test Loss: 1.318 Test Acc: 0.348
Validation loss decreased (inf --> -0.347813).  Saving model ...
Epoch: 2 cost time: 0.601966142654419
Epoch: 2, Steps: 9 | Train Loss: 1.293 Vali Loss: 1.251 Vali Acc: 0.420 Test Loss: 1.251 Test Acc: 0.420
Validation loss decreased (-0.347813 --> -0.420277).  Saving model ...
Epoch: 3 cost time: 0.7352340221405029
Epoch: 3, Steps: 9 | Train Loss: 1.189 Vali Loss: 1.183 Vali Acc: 0.428 Test Loss: 1.183 Test Acc: 0.428
Validation loss decreased (-0.420277 --> -0.427524).  Saving model ...
Epoch: 4 cost time: 0.5424919128417969
Epoch: 4, Steps: 9 | Train Loss: 1.093 Vali Loss: 1.130 Vali Acc: 0.435 Test Loss: 1.130 Test Acc: 0.435
Validation loss decreased (-0.427524 --> -0.434771).  Saving model ...
Epoch: 5 cost time: 0.5798885822296143
Epoch: 5, Steps: 9 | Train Loss: 1.016 Vali Loss: 1.083 Vali Acc: 0.442 Test Loss: 1.083 Test Acc: 0.442
Validation loss decreased (-0.434771 --> -0.442018).  Saving model ...
Epoch: 6 cost time: 0.5586285591125488
Epoch: 6, Steps: 9 | Train Loss: 0.948 Vali Loss: 1.052 Vali Acc: 0.493 Test Loss: 1.052 Test Acc: 0.493
Validation loss decreased (-0.442018 --> -0.492743).  Saving model ...
Epoch: 7 cost time: 0.5961670875549316
Epoch: 7, Steps: 9 | Train Loss: 0.892 Vali Loss: 1.024 Vali Acc: 0.522 Test Loss: 1.024 Test Acc: 0.522
Validation loss decreased (-0.492743 --> -0.521729).  Saving model ...
Epoch: 8 cost time: 0.6566307544708252
Epoch: 8, Steps: 9 | Train Loss: 0.839 Vali Loss: 1.010 Vali Acc: 0.514 Test Loss: 1.010 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6000015735626221
Epoch: 9, Steps: 9 | Train Loss: 0.772 Vali Loss: 0.983 Vali Acc: 0.565 Test Loss: 0.983 Test Acc: 0.565
Validation loss decreased (-0.521729 --> -0.565208).  Saving model ...
Epoch: 10 cost time: 0.6048123836517334
Epoch: 10, Steps: 9 | Train Loss: 0.720 Vali Loss: 0.952 Vali Acc: 0.594 Test Loss: 0.952 Test Acc: 0.594
Validation loss decreased (-0.565208 --> -0.594193).  Saving model ...
Epoch: 11 cost time: 0.6235172748565674
Epoch: 11, Steps: 9 | Train Loss: 0.654 Vali Loss: 0.912 Vali Acc: 0.594 Test Loss: 0.912 Test Acc: 0.594
Validation loss decreased (-0.594193 --> -0.594194).  Saving model ...
Epoch: 12 cost time: 0.6391913890838623
Epoch: 12, Steps: 9 | Train Loss: 0.594 Vali Loss: 0.848 Vali Acc: 0.652 Test Loss: 0.848 Test Acc: 0.652
Validation loss decreased (-0.594194 --> -0.652165).  Saving model ...
Epoch: 13 cost time: 0.5676102638244629
Epoch: 13, Steps: 9 | Train Loss: 0.487 Vali Loss: 0.756 Vali Acc: 0.703 Test Loss: 0.756 Test Acc: 0.703
Validation loss decreased (-0.652165 --> -0.702891).  Saving model ...
Epoch: 14 cost time: 0.5567057132720947
Epoch: 14, Steps: 9 | Train Loss: 0.370 Vali Loss: 0.624 Vali Acc: 0.754 Test Loss: 0.624 Test Acc: 0.754
Validation loss decreased (-0.702891 --> -0.753617).  Saving model ...
Epoch: 15 cost time: 0.5764865875244141
Epoch: 15, Steps: 9 | Train Loss: 0.255 Vali Loss: 0.515 Vali Acc: 0.768 Test Loss: 0.515 Test Acc: 0.768
Validation loss decreased (-0.753617 --> -0.768111).  Saving model ...
Epoch: 16 cost time: 0.6755752563476562
Epoch: 16, Steps: 9 | Train Loss: 0.165 Vali Loss: 0.415 Vali Acc: 0.841 Test Loss: 0.415 Test Acc: 0.841
Validation loss decreased (-0.768111 --> -0.840576).  Saving model ...
Epoch: 17 cost time: 0.6263120174407959
Epoch: 17, Steps: 9 | Train Loss: 0.111 Vali Loss: 0.386 Vali Acc: 0.877 Test Loss: 0.386 Test Acc: 0.877
Validation loss decreased (-0.840576 --> -0.876808).  Saving model ...
Epoch: 18 cost time: 0.5902824401855469
Epoch: 18, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.352 Vali Acc: 0.891 Test Loss: 0.352 Test Acc: 0.891
Validation loss decreased (-0.876808 --> -0.891301).  Saving model ...
Epoch: 19 cost time: 0.5867290496826172
Epoch: 19, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.332 Vali Acc: 0.891 Test Loss: 0.332 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 20 cost time: 0.7085585594177246
Epoch: 20, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.311 Vali Acc: 0.899 Test Loss: 0.311 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898548).  Saving model ...
Epoch: 21 cost time: 0.6224737167358398
Epoch: 21, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.278 Vali Acc: 0.899 Test Loss: 0.278 Test Acc: 0.899
Validation loss decreased (-0.898548 --> -0.898548).  Saving model ...
Epoch: 22 cost time: 0.6329567432403564
Epoch: 22, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.277 Vali Acc: 0.920 Test Loss: 0.277 Test Acc: 0.920
Validation loss decreased (-0.898548 --> -0.920287).  Saving model ...
Epoch: 23 cost time: 0.6471500396728516
Epoch: 23, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.273 Vali Acc: 0.906 Test Loss: 0.273 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6395578384399414
Epoch: 24, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.241 Vali Acc: 0.913 Test Loss: 0.241 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.620142936706543
Epoch: 25, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.238 Vali Acc: 0.928 Test Loss: 0.238 Test Acc: 0.928
Validation loss decreased (-0.920287 --> -0.927534).  Saving model ...
Epoch: 26 cost time: 0.6892759799957275
Epoch: 26, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.237 Vali Acc: 0.935 Test Loss: 0.237 Test Acc: 0.935
Validation loss decreased (-0.927534 --> -0.934780).  Saving model ...
Epoch: 27 cost time: 0.7430388927459717
Epoch: 27, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.234 Vali Acc: 0.928 Test Loss: 0.234 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6726889610290527
Epoch: 28, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.238 Vali Acc: 0.935 Test Loss: 0.238 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6577746868133545
Epoch: 29, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.227 Vali Acc: 0.942 Test Loss: 0.227 Test Acc: 0.942
Validation loss decreased (-0.934780 --> -0.942027).  Saving model ...
Epoch: 30 cost time: 0.5608792304992676
Epoch: 30, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.231 Vali Acc: 0.942 Test Loss: 0.231 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6861495971679688
Epoch: 31, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.232 Vali Acc: 0.942 Test Loss: 0.232 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.5788092613220215
Epoch: 32, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.222 Vali Acc: 0.935 Test Loss: 0.222 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.6259567737579346
Epoch: 33, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.220 Vali Acc: 0.949 Test Loss: 0.220 Test Acc: 0.949
Validation loss decreased (-0.942027 --> -0.949273).  Saving model ...
Epoch: 34 cost time: 0.6025433540344238
Epoch: 34, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.224 Vali Acc: 0.949 Test Loss: 0.224 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.704376220703125
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.949 Test Loss: 0.226 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.6750540733337402
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.223 Vali Acc: 0.949 Test Loss: 0.223 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.5196607112884521
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.220 Vali Acc: 0.949 Test Loss: 0.220 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.6293280124664307
Epoch: 38, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.222 Vali Acc: 0.949 Test Loss: 0.222 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.5428454875946045
Epoch: 39, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.223 Vali Acc: 0.949 Test Loss: 0.223 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.6948473453521729
Epoch: 40, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.949 Test Loss: 0.225 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.7960734367370605
Epoch: 41, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.949 Test Loss: 0.219 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949273).  Saving model ...
Epoch: 42 cost time: 0.6158037185668945
Epoch: 42, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.949 Test Loss: 0.216 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949273).  Saving model ...
Epoch: 43 cost time: 0.5814979076385498
Epoch: 43, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.949 Test Loss: 0.222 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.6008996963500977
Epoch: 44, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.949 Test Loss: 0.222 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.619694709777832
Epoch: 45, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.949 Test Loss: 0.221 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.6330747604370117
Epoch: 46, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.949 Test Loss: 0.221 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.6405158042907715
Epoch: 47, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.949 Test Loss: 0.223 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.7374341487884521
Epoch: 48, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.949 Test Loss: 0.221 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.6605815887451172
Epoch: 49, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.949 Test Loss: 0.222 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.6020846366882324
Epoch: 50, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.949 Test Loss: 0.223 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 0.6227576732635498
Epoch: 51, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.949 Test Loss: 0.224 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 0.6836740970611572
Epoch: 52, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.949 Test Loss: 0.226 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm256_cs13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9492753623188406
model parameter : 79606
model size : 0.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm256_cs12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.8471534252166748
Epoch: 1, Steps: 9 | Train Loss: 1.454 Vali Loss: 1.407 Vali Acc: 0.261 Test Loss: 1.407 Test Acc: 0.261
Validation loss decreased (inf --> -0.260855).  Saving model ...
Epoch: 2 cost time: 0.6603679656982422
Epoch: 2, Steps: 9 | Train Loss: 1.383 Vali Loss: 1.321 Vali Acc: 0.326 Test Loss: 1.321 Test Acc: 0.326
Validation loss decreased (-0.260855 --> -0.326074).  Saving model ...
Epoch: 3 cost time: 0.6128067970275879
Epoch: 3, Steps: 9 | Train Loss: 1.277 Vali Loss: 1.235 Vali Acc: 0.391 Test Loss: 1.235 Test Acc: 0.391
Validation loss decreased (-0.326074 --> -0.391292).  Saving model ...
Epoch: 4 cost time: 0.6688778400421143
Epoch: 4, Steps: 9 | Train Loss: 1.160 Vali Loss: 1.162 Vali Acc: 0.464 Test Loss: 1.162 Test Acc: 0.464
Validation loss decreased (-0.391292 --> -0.463756).  Saving model ...
Epoch: 5 cost time: 0.6420564651489258
Epoch: 5, Steps: 9 | Train Loss: 1.065 Vali Loss: 1.121 Vali Acc: 0.493 Test Loss: 1.121 Test Acc: 0.493
Validation loss decreased (-0.463756 --> -0.492742).  Saving model ...
Epoch: 6 cost time: 0.7301464080810547
Epoch: 6, Steps: 9 | Train Loss: 1.001 Vali Loss: 1.089 Vali Acc: 0.471 Test Loss: 1.089 Test Acc: 0.471
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6083533763885498
Epoch: 7, Steps: 9 | Train Loss: 0.920 Vali Loss: 1.061 Vali Acc: 0.493 Test Loss: 1.061 Test Acc: 0.493
Validation loss decreased (-0.492742 --> -0.492743).  Saving model ...
Epoch: 8 cost time: 0.5598959922790527
Epoch: 8, Steps: 9 | Train Loss: 0.873 Vali Loss: 1.038 Vali Acc: 0.514 Test Loss: 1.038 Test Acc: 0.514
Validation loss decreased (-0.492743 --> -0.514482).  Saving model ...
Epoch: 9 cost time: 0.7035012245178223
Epoch: 9, Steps: 9 | Train Loss: 0.816 Vali Loss: 1.017 Vali Acc: 0.522 Test Loss: 1.017 Test Acc: 0.522
Validation loss decreased (-0.514482 --> -0.521729).  Saving model ...
Epoch: 10 cost time: 0.6203386783599854
Epoch: 10, Steps: 9 | Train Loss: 0.761 Vali Loss: 0.995 Vali Acc: 0.529 Test Loss: 0.995 Test Acc: 0.529
Validation loss decreased (-0.521729 --> -0.528976).  Saving model ...
Epoch: 11 cost time: 0.8283255100250244
Epoch: 11, Steps: 9 | Train Loss: 0.696 Vali Loss: 0.977 Vali Acc: 0.543 Test Loss: 0.977 Test Acc: 0.543
Validation loss decreased (-0.528976 --> -0.543468).  Saving model ...
Epoch: 12 cost time: 0.5307700634002686
Epoch: 12, Steps: 9 | Train Loss: 0.641 Vali Loss: 0.948 Vali Acc: 0.565 Test Loss: 0.948 Test Acc: 0.565
Validation loss decreased (-0.543468 --> -0.565208).  Saving model ...
Epoch: 13 cost time: 0.6087503433227539
Epoch: 13, Steps: 9 | Train Loss: 0.572 Vali Loss: 0.897 Vali Acc: 0.601 Test Loss: 0.897 Test Acc: 0.601
Validation loss decreased (-0.565208 --> -0.601440).  Saving model ...
Epoch: 14 cost time: 0.6415457725524902
Epoch: 14, Steps: 9 | Train Loss: 0.477 Vali Loss: 0.811 Vali Acc: 0.659 Test Loss: 0.811 Test Acc: 0.659
Validation loss decreased (-0.601440 --> -0.659412).  Saving model ...
Epoch: 15 cost time: 0.6015615463256836
Epoch: 15, Steps: 9 | Train Loss: 0.385 Vali Loss: 0.682 Vali Acc: 0.739 Test Loss: 0.682 Test Acc: 0.739
Validation loss decreased (-0.659412 --> -0.739124).  Saving model ...
Epoch: 16 cost time: 0.688561201095581
Epoch: 16, Steps: 9 | Train Loss: 0.277 Vali Loss: 0.562 Vali Acc: 0.768 Test Loss: 0.562 Test Acc: 0.768
Validation loss decreased (-0.739124 --> -0.768110).  Saving model ...
Epoch: 17 cost time: 0.6789710521697998
Epoch: 17, Steps: 9 | Train Loss: 0.179 Vali Loss: 0.458 Vali Acc: 0.804 Test Loss: 0.458 Test Acc: 0.804
Validation loss decreased (-0.768110 --> -0.804343).  Saving model ...
Epoch: 18 cost time: 0.6832969188690186
Epoch: 18, Steps: 9 | Train Loss: 0.126 Vali Loss: 0.424 Vali Acc: 0.833 Test Loss: 0.424 Test Acc: 0.833
Validation loss decreased (-0.804343 --> -0.833329).  Saving model ...
Epoch: 19 cost time: 0.648902177810669
Epoch: 19, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.362 Vali Acc: 0.848 Test Loss: 0.362 Test Acc: 0.848
Validation loss decreased (-0.833329 --> -0.847822).  Saving model ...
Epoch: 20 cost time: 0.5606381893157959
Epoch: 20, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.347 Vali Acc: 0.862 Test Loss: 0.347 Test Acc: 0.862
Validation loss decreased (-0.847822 --> -0.862315).  Saving model ...
Epoch: 21 cost time: 0.608396053314209
Epoch: 21, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.313 Vali Acc: 0.913 Test Loss: 0.313 Test Acc: 0.913
Validation loss decreased (-0.862315 --> -0.913040).  Saving model ...
Epoch: 22 cost time: 0.6287875175476074
Epoch: 22, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.316 Vali Acc: 0.884 Test Loss: 0.316 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5609362125396729
Epoch: 23, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.298 Vali Acc: 0.891 Test Loss: 0.298 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6391854286193848
Epoch: 24, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.309 Vali Acc: 0.913 Test Loss: 0.309 Test Acc: 0.913
Validation loss decreased (-0.913040 --> -0.913040).  Saving model ...
Epoch: 25 cost time: 0.5819652080535889
Epoch: 25, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.270 Vali Acc: 0.913 Test Loss: 0.270 Test Acc: 0.913
Validation loss decreased (-0.913040 --> -0.913041).  Saving model ...
Epoch: 26 cost time: 0.6618566513061523
Epoch: 26, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.266 Vali Acc: 0.920 Test Loss: 0.266 Test Acc: 0.920
Validation loss decreased (-0.913041 --> -0.920287).  Saving model ...
Epoch: 27 cost time: 0.6502289772033691
Epoch: 27, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.269 Vali Acc: 0.928 Test Loss: 0.269 Test Acc: 0.928
Validation loss decreased (-0.920287 --> -0.927534).  Saving model ...
Epoch: 28 cost time: 0.6117701530456543
Epoch: 28, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.253 Vali Acc: 0.935 Test Loss: 0.253 Test Acc: 0.935
Validation loss decreased (-0.927534 --> -0.934780).  Saving model ...
Epoch: 29 cost time: 0.7051541805267334
Epoch: 29, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.263 Vali Acc: 0.935 Test Loss: 0.263 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7656521797180176
Epoch: 30, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.265 Vali Acc: 0.935 Test Loss: 0.265 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.6664607524871826
Epoch: 31, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.260 Vali Acc: 0.935 Test Loss: 0.260 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.6550083160400391
Epoch: 32, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.261 Vali Acc: 0.935 Test Loss: 0.261 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.6087758541107178
Epoch: 33, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.261 Vali Acc: 0.935 Test Loss: 0.261 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.49085211753845215
Epoch: 34, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.262 Vali Acc: 0.942 Test Loss: 0.262 Test Acc: 0.942
Validation loss decreased (-0.934780 --> -0.942026).  Saving model ...
Epoch: 35 cost time: 0.5568642616271973
Epoch: 35, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.271 Vali Acc: 0.935 Test Loss: 0.271 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.5802123546600342
Epoch: 36, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.251 Vali Acc: 0.942 Test Loss: 0.251 Test Acc: 0.942
Validation loss decreased (-0.942026 --> -0.942026).  Saving model ...
Epoch: 37 cost time: 0.6441340446472168
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.254 Vali Acc: 0.949 Test Loss: 0.254 Test Acc: 0.949
Validation loss decreased (-0.942026 --> -0.949273).  Saving model ...
Epoch: 38 cost time: 0.6063919067382812
Epoch: 38, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.258 Vali Acc: 0.942 Test Loss: 0.258 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.575484037399292
Epoch: 39, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.260 Vali Acc: 0.942 Test Loss: 0.260 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.6887404918670654
Epoch: 40, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.260 Vali Acc: 0.949 Test Loss: 0.260 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.6764552593231201
Epoch: 41, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.263 Vali Acc: 0.942 Test Loss: 0.263 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.6990611553192139
Epoch: 42, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.267 Vali Acc: 0.942 Test Loss: 0.267 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.6012833118438721
Epoch: 43, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.272 Vali Acc: 0.942 Test Loss: 0.272 Test Acc: 0.942
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.5783557891845703
Epoch: 44, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.949 Test Loss: 0.268 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.6637656688690186
Epoch: 45, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.267 Vali Acc: 0.949 Test Loss: 0.267 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.5151450634002686
Epoch: 46, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.269 Vali Acc: 0.949 Test Loss: 0.269 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.5329899787902832
Epoch: 47, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.949 Test Loss: 0.274 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm256_cs12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9492753623188406
model parameter : 81270
model size : 0.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm256_cs11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.1947362422943115
Epoch: 1, Steps: 9 | Train Loss: 1.361 Vali Loss: 1.324 Vali Acc: 0.420 Test Loss: 1.324 Test Acc: 0.420
Validation loss decreased (inf --> -0.420277).  Saving model ...
Epoch: 2 cost time: 0.6220555305480957
Epoch: 2, Steps: 9 | Train Loss: 1.298 Vali Loss: 1.247 Vali Acc: 0.442 Test Loss: 1.247 Test Acc: 0.442
Validation loss decreased (-0.420277 --> -0.442017).  Saving model ...
Epoch: 3 cost time: 0.5047345161437988
Epoch: 3, Steps: 9 | Train Loss: 1.189 Vali Loss: 1.176 Vali Acc: 0.457 Test Loss: 1.176 Test Acc: 0.457
Validation loss decreased (-0.442017 --> -0.456510).  Saving model ...
Epoch: 4 cost time: 0.5649969577789307
Epoch: 4, Steps: 9 | Train Loss: 1.069 Vali Loss: 1.124 Vali Acc: 0.478 Test Loss: 1.124 Test Acc: 0.478
Validation loss decreased (-0.456510 --> -0.478250).  Saving model ...
Epoch: 5 cost time: 0.5172569751739502
Epoch: 5, Steps: 9 | Train Loss: 1.002 Vali Loss: 1.091 Vali Acc: 0.435 Test Loss: 1.091 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5968317985534668
Epoch: 6, Steps: 9 | Train Loss: 0.921 Vali Loss: 1.050 Vali Acc: 0.500 Test Loss: 1.050 Test Acc: 0.500
Validation loss decreased (-0.478250 --> -0.499990).  Saving model ...
Epoch: 7 cost time: 0.5884647369384766
Epoch: 7, Steps: 9 | Train Loss: 0.859 Vali Loss: 1.020 Vali Acc: 0.522 Test Loss: 1.020 Test Acc: 0.522
Validation loss decreased (-0.499990 --> -0.521729).  Saving model ...
Epoch: 8 cost time: 0.5065224170684814
Epoch: 8, Steps: 9 | Train Loss: 0.795 Vali Loss: 0.977 Vali Acc: 0.543 Test Loss: 0.977 Test Acc: 0.543
Validation loss decreased (-0.521729 --> -0.543468).  Saving model ...
Epoch: 9 cost time: 0.5965063571929932
Epoch: 9, Steps: 9 | Train Loss: 0.730 Vali Loss: 0.935 Vali Acc: 0.609 Test Loss: 0.935 Test Acc: 0.609
Validation loss decreased (-0.543468 --> -0.608686).  Saving model ...
Epoch: 10 cost time: 0.5594816207885742
Epoch: 10, Steps: 9 | Train Loss: 0.643 Vali Loss: 0.876 Vali Acc: 0.645 Test Loss: 0.876 Test Acc: 0.645
Validation loss decreased (-0.608686 --> -0.644919).  Saving model ...
Epoch: 11 cost time: 0.57234787940979
Epoch: 11, Steps: 9 | Train Loss: 0.548 Vali Loss: 0.801 Vali Acc: 0.674 Test Loss: 0.801 Test Acc: 0.674
Validation loss decreased (-0.644919 --> -0.673905).  Saving model ...
Epoch: 12 cost time: 0.5674302577972412
Epoch: 12, Steps: 9 | Train Loss: 0.454 Vali Loss: 0.702 Vali Acc: 0.710 Test Loss: 0.702 Test Acc: 0.710
Validation loss decreased (-0.673905 --> -0.710138).  Saving model ...
Epoch: 13 cost time: 0.6318767070770264
Epoch: 13, Steps: 9 | Train Loss: 0.353 Vali Loss: 0.578 Vali Acc: 0.761 Test Loss: 0.578 Test Acc: 0.761
Validation loss decreased (-0.710138 --> -0.760864).  Saving model ...
Epoch: 14 cost time: 0.5262336730957031
Epoch: 14, Steps: 9 | Train Loss: 0.267 Vali Loss: 0.509 Vali Acc: 0.775 Test Loss: 0.509 Test Acc: 0.775
Validation loss decreased (-0.760864 --> -0.775357).  Saving model ...
Epoch: 15 cost time: 0.5691196918487549
Epoch: 15, Steps: 9 | Train Loss: 0.193 Vali Loss: 0.434 Vali Acc: 0.812 Test Loss: 0.434 Test Acc: 0.812
Validation loss decreased (-0.775357 --> -0.811590).  Saving model ...
Epoch: 16 cost time: 0.5974750518798828
Epoch: 16, Steps: 9 | Train Loss: 0.142 Vali Loss: 0.391 Vali Acc: 0.862 Test Loss: 0.391 Test Acc: 0.862
Validation loss decreased (-0.811590 --> -0.862315).  Saving model ...
Epoch: 17 cost time: 0.6090736389160156
Epoch: 17, Steps: 9 | Train Loss: 0.129 Vali Loss: 0.354 Vali Acc: 0.884 Test Loss: 0.354 Test Acc: 0.884
Validation loss decreased (-0.862315 --> -0.884054).  Saving model ...
Epoch: 18 cost time: 0.5150034427642822
Epoch: 18, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.344 Vali Acc: 0.884 Test Loss: 0.344 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884055).  Saving model ...
Epoch: 19 cost time: 0.49593663215637207
Epoch: 19, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.321 Vali Acc: 0.877 Test Loss: 0.321 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5562629699707031
Epoch: 20, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.316 Vali Acc: 0.891 Test Loss: 0.316 Test Acc: 0.891
Validation loss decreased (-0.884055 --> -0.891301).  Saving model ...
Epoch: 21 cost time: 0.5897934436798096
Epoch: 21, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.284 Vali Acc: 0.920 Test Loss: 0.284 Test Acc: 0.920
Validation loss decreased (-0.891301 --> -0.920287).  Saving model ...
Epoch: 22 cost time: 0.6642951965332031
Epoch: 22, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.277 Vali Acc: 0.920 Test Loss: 0.277 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 23 cost time: 0.634495735168457
Epoch: 23, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.281 Vali Acc: 0.928 Test Loss: 0.281 Test Acc: 0.928
Validation loss decreased (-0.920287 --> -0.927533).  Saving model ...
Epoch: 24 cost time: 0.5989127159118652
Epoch: 24, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.301 Vali Acc: 0.913 Test Loss: 0.301 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.663280725479126
Epoch: 25, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.298 Vali Acc: 0.920 Test Loss: 0.298 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6054294109344482
Epoch: 26, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.282 Vali Acc: 0.942 Test Loss: 0.282 Test Acc: 0.942
Validation loss decreased (-0.927533 --> -0.942026).  Saving model ...
Epoch: 27 cost time: 0.682847261428833
Epoch: 27, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.268 Vali Acc: 0.942 Test Loss: 0.268 Test Acc: 0.942
Validation loss decreased (-0.942026 --> -0.942026).  Saving model ...
Epoch: 28 cost time: 0.6192915439605713
Epoch: 28, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.285 Vali Acc: 0.942 Test Loss: 0.285 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5757265090942383
Epoch: 29, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.309 Vali Acc: 0.935 Test Loss: 0.309 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6510472297668457
Epoch: 30, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.316 Vali Acc: 0.935 Test Loss: 0.316 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.5254349708557129
Epoch: 31, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.308 Vali Acc: 0.942 Test Loss: 0.308 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.573765754699707
Epoch: 32, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.309 Vali Acc: 0.942 Test Loss: 0.309 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.5864963531494141
Epoch: 33, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.323 Vali Acc: 0.942 Test Loss: 0.323 Test Acc: 0.942
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.5786619186401367
Epoch: 34, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.327 Vali Acc: 0.942 Test Loss: 0.327 Test Acc: 0.942
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.5521941184997559
Epoch: 35, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.321 Vali Acc: 0.942 Test Loss: 0.321 Test Acc: 0.942
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.5630302429199219
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.320 Vali Acc: 0.942 Test Loss: 0.320 Test Acc: 0.942
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.5608017444610596
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.323 Vali Acc: 0.949 Test Loss: 0.323 Test Acc: 0.949
Validation loss decreased (-0.942026 --> -0.949272).  Saving model ...
Epoch: 38 cost time: 0.5546817779541016
Epoch: 38, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.329 Vali Acc: 0.942 Test Loss: 0.329 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.5543677806854248
Epoch: 39, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.332 Vali Acc: 0.942 Test Loss: 0.332 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.5391523838043213
Epoch: 40, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.335 Vali Acc: 0.942 Test Loss: 0.335 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.47901010513305664
Epoch: 41, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.338 Vali Acc: 0.949 Test Loss: 0.338 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.476456880569458
Epoch: 42, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.340 Vali Acc: 0.949 Test Loss: 0.340 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.5222008228302002
Epoch: 43, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.344 Vali Acc: 0.949 Test Loss: 0.344 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.5762419700622559
Epoch: 44, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.350 Vali Acc: 0.949 Test Loss: 0.350 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.5139186382293701
Epoch: 45, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.352 Vali Acc: 0.949 Test Loss: 0.352 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.5609362125396729
Epoch: 46, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.352 Vali Acc: 0.949 Test Loss: 0.352 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.5410022735595703
Epoch: 47, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.351 Vali Acc: 0.949 Test Loss: 0.351 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm256_cs11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9492753623188406
model parameter : 79778
model size : 0.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm256_cs10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.739922046661377
Epoch: 1, Steps: 9 | Train Loss: 1.326 Vali Loss: 1.309 Vali Acc: 0.304 Test Loss: 1.309 Test Acc: 0.304
Validation loss decreased (inf --> -0.304335).  Saving model ...
Epoch: 2 cost time: 0.5350856781005859
Epoch: 2, Steps: 9 | Train Loss: 1.263 Vali Loss: 1.246 Vali Acc: 0.384 Test Loss: 1.246 Test Acc: 0.384
Validation loss decreased (-0.304335 --> -0.384046).  Saving model ...
Epoch: 3 cost time: 0.488292932510376
Epoch: 3, Steps: 9 | Train Loss: 1.172 Vali Loss: 1.180 Vali Acc: 0.428 Test Loss: 1.180 Test Acc: 0.428
Validation loss decreased (-0.384046 --> -0.427524).  Saving model ...
Epoch: 4 cost time: 0.5656087398529053
Epoch: 4, Steps: 9 | Train Loss: 1.101 Vali Loss: 1.129 Vali Acc: 0.442 Test Loss: 1.129 Test Acc: 0.442
Validation loss decreased (-0.427524 --> -0.442018).  Saving model ...
Epoch: 5 cost time: 0.5329535007476807
Epoch: 5, Steps: 9 | Train Loss: 1.027 Vali Loss: 1.094 Vali Acc: 0.449 Test Loss: 1.094 Test Acc: 0.449
Validation loss decreased (-0.442018 --> -0.449264).  Saving model ...
Epoch: 6 cost time: 0.47220396995544434
Epoch: 6, Steps: 9 | Train Loss: 0.969 Vali Loss: 1.058 Vali Acc: 0.514 Test Loss: 1.058 Test Acc: 0.514
Validation loss decreased (-0.449264 --> -0.514482).  Saving model ...
Epoch: 7 cost time: 0.4953031539916992
Epoch: 7, Steps: 9 | Train Loss: 0.904 Vali Loss: 1.042 Vali Acc: 0.507 Test Loss: 1.042 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5214138031005859
Epoch: 8, Steps: 9 | Train Loss: 0.846 Vali Loss: 1.029 Vali Acc: 0.471 Test Loss: 1.029 Test Acc: 0.471
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5192551612854004
Epoch: 9, Steps: 9 | Train Loss: 0.792 Vali Loss: 1.005 Vali Acc: 0.514 Test Loss: 1.005 Test Acc: 0.514
Validation loss decreased (-0.514482 --> -0.514483).  Saving model ...
Epoch: 10 cost time: 0.5394854545593262
Epoch: 10, Steps: 9 | Train Loss: 0.739 Vali Loss: 0.982 Vali Acc: 0.580 Test Loss: 0.982 Test Acc: 0.580
Validation loss decreased (-0.514483 --> -0.579700).  Saving model ...
Epoch: 11 cost time: 0.6990664005279541
Epoch: 11, Steps: 9 | Train Loss: 0.691 Vali Loss: 0.973 Vali Acc: 0.522 Test Loss: 0.973 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5490365028381348
Epoch: 12, Steps: 9 | Train Loss: 0.634 Vali Loss: 0.939 Vali Acc: 0.623 Test Loss: 0.939 Test Acc: 0.623
Validation loss decreased (-0.579700 --> -0.623179).  Saving model ...
Epoch: 13 cost time: 0.6250019073486328
Epoch: 13, Steps: 9 | Train Loss: 0.576 Vali Loss: 0.882 Vali Acc: 0.652 Test Loss: 0.882 Test Acc: 0.652
Validation loss decreased (-0.623179 --> -0.652165).  Saving model ...
Epoch: 14 cost time: 0.5751612186431885
Epoch: 14, Steps: 9 | Train Loss: 0.478 Vali Loss: 0.765 Vali Acc: 0.710 Test Loss: 0.765 Test Acc: 0.710
Validation loss decreased (-0.652165 --> -0.710137).  Saving model ...
Epoch: 15 cost time: 0.5666065216064453
Epoch: 15, Steps: 9 | Train Loss: 0.355 Vali Loss: 0.593 Vali Acc: 0.812 Test Loss: 0.593 Test Acc: 0.812
Validation loss decreased (-0.710137 --> -0.811588).  Saving model ...
Epoch: 16 cost time: 0.5934500694274902
Epoch: 16, Steps: 9 | Train Loss: 0.223 Vali Loss: 0.453 Vali Acc: 0.841 Test Loss: 0.453 Test Acc: 0.841
Validation loss decreased (-0.811588 --> -0.840575).  Saving model ...
Epoch: 17 cost time: 0.5334813594818115
Epoch: 17, Steps: 9 | Train Loss: 0.142 Vali Loss: 0.322 Vali Acc: 0.899 Test Loss: 0.322 Test Acc: 0.899
Validation loss decreased (-0.840575 --> -0.898548).  Saving model ...
Epoch: 18 cost time: 0.5165679454803467
Epoch: 18, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.359 Vali Acc: 0.862 Test Loss: 0.359 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5633010864257812
Epoch: 19, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.278 Vali Acc: 0.928 Test Loss: 0.278 Test Acc: 0.928
Validation loss decreased (-0.898548 --> -0.927533).  Saving model ...
Epoch: 20 cost time: 0.5792770385742188
Epoch: 20, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.273 Vali Acc: 0.928 Test Loss: 0.273 Test Acc: 0.928
Validation loss decreased (-0.927533 --> -0.927534).  Saving model ...
Epoch: 21 cost time: 0.5937020778656006
Epoch: 21, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.270 Vali Acc: 0.928 Test Loss: 0.270 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 22 cost time: 0.5879793167114258
Epoch: 22, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.259 Vali Acc: 0.928 Test Loss: 0.259 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 23 cost time: 0.4935417175292969
Epoch: 23, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.262 Vali Acc: 0.935 Test Loss: 0.262 Test Acc: 0.935
Validation loss decreased (-0.927534 --> -0.934780).  Saving model ...
Epoch: 24 cost time: 0.5881738662719727
Epoch: 24, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.280 Vali Acc: 0.928 Test Loss: 0.280 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5306355953216553
Epoch: 25, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.275 Vali Acc: 0.935 Test Loss: 0.275 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.4631774425506592
Epoch: 26, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.269 Vali Acc: 0.949 Test Loss: 0.269 Test Acc: 0.949
Validation loss decreased (-0.934780 --> -0.949273).  Saving model ...
Epoch: 27 cost time: 0.6125102043151855
Epoch: 27, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.288 Vali Acc: 0.935 Test Loss: 0.288 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6145071983337402
Epoch: 28, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.268 Vali Acc: 0.949 Test Loss: 0.268 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949273).  Saving model ...
Epoch: 29 cost time: 0.6091501712799072
Epoch: 29, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.279 Vali Acc: 0.949 Test Loss: 0.279 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5946228504180908
Epoch: 30, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.282 Vali Acc: 0.949 Test Loss: 0.282 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.5640172958374023
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.290 Vali Acc: 0.949 Test Loss: 0.290 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.5230882167816162
Epoch: 32, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.295 Vali Acc: 0.949 Test Loss: 0.295 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.6338274478912354
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.283 Vali Acc: 0.949 Test Loss: 0.283 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.48761916160583496
Epoch: 34, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.297 Vali Acc: 0.949 Test Loss: 0.297 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.5679459571838379
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.292 Vali Acc: 0.949 Test Loss: 0.292 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.6571085453033447
Epoch: 36, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.282 Vali Acc: 0.949 Test Loss: 0.282 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.5808804035186768
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.297 Vali Acc: 0.949 Test Loss: 0.297 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.5886638164520264
Epoch: 38, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.293 Vali Acc: 0.949 Test Loss: 0.293 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm256_cs10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9492753623188406
model parameter : 80024
model size : 0.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm128_cs103_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.9503169059753418
Epoch: 1, Steps: 9 | Train Loss: 1.477 Vali Loss: 1.461 Vali Acc: 0.225 Test Loss: 1.461 Test Acc: 0.225
Validation loss decreased (inf --> -0.224623).  Saving model ...
Epoch: 2 cost time: 0.5603396892547607
Epoch: 2, Steps: 9 | Train Loss: 1.401 Vali Loss: 1.359 Vali Acc: 0.326 Test Loss: 1.359 Test Acc: 0.326
Validation loss decreased (-0.224623 --> -0.326073).  Saving model ...
Epoch: 3 cost time: 0.6004641056060791
Epoch: 3, Steps: 9 | Train Loss: 1.276 Vali Loss: 1.246 Vali Acc: 0.420 Test Loss: 1.246 Test Acc: 0.420
Validation loss decreased (-0.326073 --> -0.420277).  Saving model ...
Epoch: 4 cost time: 0.5251336097717285
Epoch: 4, Steps: 9 | Train Loss: 1.151 Vali Loss: 1.159 Vali Acc: 0.464 Test Loss: 1.159 Test Acc: 0.464
Validation loss decreased (-0.420277 --> -0.463757).  Saving model ...
Epoch: 5 cost time: 0.6338598728179932
Epoch: 5, Steps: 9 | Train Loss: 1.055 Vali Loss: 1.099 Vali Acc: 0.471 Test Loss: 1.099 Test Acc: 0.471
Validation loss decreased (-0.463757 --> -0.471004).  Saving model ...
Epoch: 6 cost time: 0.580329179763794
Epoch: 6, Steps: 9 | Train Loss: 0.967 Vali Loss: 1.067 Vali Acc: 0.478 Test Loss: 1.067 Test Acc: 0.478
Validation loss decreased (-0.471004 --> -0.478250).  Saving model ...
Epoch: 7 cost time: 0.6751489639282227
Epoch: 7, Steps: 9 | Train Loss: 0.904 Vali Loss: 1.032 Vali Acc: 0.500 Test Loss: 1.032 Test Acc: 0.500
Validation loss decreased (-0.478250 --> -0.499990).  Saving model ...
Epoch: 8 cost time: 0.63515305519104
Epoch: 8, Steps: 9 | Train Loss: 0.862 Vali Loss: 1.008 Vali Acc: 0.500 Test Loss: 1.008 Test Acc: 0.500
Validation loss decreased (-0.499990 --> -0.499990).  Saving model ...
Epoch: 9 cost time: 0.5962791442871094
Epoch: 9, Steps: 9 | Train Loss: 0.798 Vali Loss: 0.977 Vali Acc: 0.565 Test Loss: 0.977 Test Acc: 0.565
Validation loss decreased (-0.499990 --> -0.565208).  Saving model ...
Epoch: 10 cost time: 0.7234108448028564
Epoch: 10, Steps: 9 | Train Loss: 0.727 Vali Loss: 0.933 Vali Acc: 0.594 Test Loss: 0.933 Test Acc: 0.594
Validation loss decreased (-0.565208 --> -0.594194).  Saving model ...
Epoch: 11 cost time: 0.6374518871307373
Epoch: 11, Steps: 9 | Train Loss: 0.659 Vali Loss: 0.897 Vali Acc: 0.616 Test Loss: 0.897 Test Acc: 0.616
Validation loss decreased (-0.594194 --> -0.615933).  Saving model ...
Epoch: 12 cost time: 0.6356897354125977
Epoch: 12, Steps: 9 | Train Loss: 0.582 Vali Loss: 0.855 Vali Acc: 0.652 Test Loss: 0.855 Test Acc: 0.652
Validation loss decreased (-0.615933 --> -0.652165).  Saving model ...
Epoch: 13 cost time: 0.5820915699005127
Epoch: 13, Steps: 9 | Train Loss: 0.498 Vali Loss: 0.788 Vali Acc: 0.703 Test Loss: 0.788 Test Acc: 0.703
Validation loss decreased (-0.652165 --> -0.702891).  Saving model ...
Epoch: 14 cost time: 0.5821218490600586
Epoch: 14, Steps: 9 | Train Loss: 0.414 Vali Loss: 0.708 Vali Acc: 0.725 Test Loss: 0.708 Test Acc: 0.725
Validation loss decreased (-0.702891 --> -0.724631).  Saving model ...
Epoch: 15 cost time: 0.6041152477264404
Epoch: 15, Steps: 9 | Train Loss: 0.327 Vali Loss: 0.652 Vali Acc: 0.732 Test Loss: 0.652 Test Acc: 0.732
Validation loss decreased (-0.724631 --> -0.731878).  Saving model ...
Epoch: 16 cost time: 0.5305874347686768
Epoch: 16, Steps: 9 | Train Loss: 0.262 Vali Loss: 0.587 Vali Acc: 0.746 Test Loss: 0.587 Test Acc: 0.746
Validation loss decreased (-0.731878 --> -0.746371).  Saving model ...
Epoch: 17 cost time: 0.5270333290100098
Epoch: 17, Steps: 9 | Train Loss: 0.207 Vali Loss: 0.551 Vali Acc: 0.768 Test Loss: 0.551 Test Acc: 0.768
Validation loss decreased (-0.746371 --> -0.768110).  Saving model ...
Epoch: 18 cost time: 0.6098225116729736
Epoch: 18, Steps: 9 | Train Loss: 0.160 Vali Loss: 0.519 Vali Acc: 0.790 Test Loss: 0.519 Test Acc: 0.790
Validation loss decreased (-0.768110 --> -0.789850).  Saving model ...
Epoch: 19 cost time: 0.6164453029632568
Epoch: 19, Steps: 9 | Train Loss: 0.130 Vali Loss: 0.490 Vali Acc: 0.797 Test Loss: 0.490 Test Acc: 0.797
Validation loss decreased (-0.789850 --> -0.797097).  Saving model ...
Epoch: 20 cost time: 0.5688862800598145
Epoch: 20, Steps: 9 | Train Loss: 0.106 Vali Loss: 0.498 Vali Acc: 0.812 Test Loss: 0.498 Test Acc: 0.812
Validation loss decreased (-0.797097 --> -0.811589).  Saving model ...
Epoch: 21 cost time: 0.5804121494293213
Epoch: 21, Steps: 9 | Train Loss: 0.087 Vali Loss: 0.482 Vali Acc: 0.819 Test Loss: 0.482 Test Acc: 0.819
Validation loss decreased (-0.811589 --> -0.818836).  Saving model ...
Epoch: 22 cost time: 0.6065061092376709
Epoch: 22, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.477 Vali Acc: 0.826 Test Loss: 0.477 Test Acc: 0.826
Validation loss decreased (-0.818836 --> -0.826082).  Saving model ...
Epoch: 23 cost time: 0.5247995853424072
Epoch: 23, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.504 Vali Acc: 0.833 Test Loss: 0.504 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833328).  Saving model ...
Epoch: 24 cost time: 0.5686445236206055
Epoch: 24, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.491 Vali Acc: 0.826 Test Loss: 0.491 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6049447059631348
Epoch: 25, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.500 Vali Acc: 0.833 Test Loss: 0.500 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 26 cost time: 0.685964822769165
Epoch: 26, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.529 Vali Acc: 0.833 Test Loss: 0.529 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5740938186645508
Epoch: 27, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.541 Vali Acc: 0.833 Test Loss: 0.541 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.552994966506958
Epoch: 28, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.546 Vali Acc: 0.833 Test Loss: 0.546 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.7748832702636719
Epoch: 29, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.556 Vali Acc: 0.833 Test Loss: 0.556 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.6649165153503418
Epoch: 30, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.581 Vali Acc: 0.841 Test Loss: 0.581 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840574).  Saving model ...
Epoch: 31 cost time: 0.6781535148620605
Epoch: 31, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.594 Vali Acc: 0.833 Test Loss: 0.594 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7619829177856445
Epoch: 32, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.591 Vali Acc: 0.848 Test Loss: 0.591 Test Acc: 0.848
Validation loss decreased (-0.840574 --> -0.847820).  Saving model ...
Epoch: 33 cost time: 0.6287407875061035
Epoch: 33, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.619 Vali Acc: 0.841 Test Loss: 0.619 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6230192184448242
Epoch: 34, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.613 Vali Acc: 0.841 Test Loss: 0.613 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.760237455368042
Epoch: 35, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.639 Vali Acc: 0.848 Test Loss: 0.639 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.6633419990539551
Epoch: 36, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.656 Vali Acc: 0.848 Test Loss: 0.656 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.7919752597808838
Epoch: 37, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.642 Vali Acc: 0.841 Test Loss: 0.642 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.68916916847229
Epoch: 38, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.680 Vali Acc: 0.848 Test Loss: 0.680 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.665212869644165
Epoch: 39, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.668 Vali Acc: 0.855 Test Loss: 0.668 Test Acc: 0.855
Validation loss decreased (-0.847820 --> -0.855066).  Saving model ...
Epoch: 40 cost time: 0.7723801136016846
Epoch: 40, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.684 Vali Acc: 0.855 Test Loss: 0.684 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.7141289710998535
Epoch: 41, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.688 Vali Acc: 0.848 Test Loss: 0.688 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.7848923206329346
Epoch: 42, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.703 Vali Acc: 0.855 Test Loss: 0.703 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.7592184543609619
Epoch: 43, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.716 Vali Acc: 0.848 Test Loss: 0.716 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.7511277198791504
Epoch: 44, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.703 Vali Acc: 0.855 Test Loss: 0.703 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.7271387577056885
Epoch: 45, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.728 Vali Acc: 0.855 Test Loss: 0.728 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.7621171474456787
Epoch: 46, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.749 Vali Acc: 0.855 Test Loss: 0.749 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.7049887180328369
Epoch: 47, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.725 Vali Acc: 0.862 Test Loss: 0.725 Test Acc: 0.862
Validation loss decreased (-0.855066 --> -0.862312).  Saving model ...
Epoch: 48 cost time: 0.6960585117340088
Epoch: 48, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.728 Vali Acc: 0.877 Test Loss: 0.728 Test Acc: 0.877
Validation loss decreased (-0.862312 --> -0.876804).  Saving model ...
Epoch: 49 cost time: 0.7100355625152588
Epoch: 49, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.750 Vali Acc: 0.862 Test Loss: 0.750 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.7097511291503906
Epoch: 50, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.760 Vali Acc: 0.870 Test Loss: 0.760 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.8294496536254883
Epoch: 51, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.773 Vali Acc: 0.862 Test Loss: 0.773 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.7124018669128418
Epoch: 52, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.767 Vali Acc: 0.870 Test Loss: 0.767 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 0.7397830486297607
Epoch: 53, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.784 Vali Acc: 0.870 Test Loss: 0.784 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 0.8521130084991455
Epoch: 54, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.791 Vali Acc: 0.870 Test Loss: 0.791 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 0.5710070133209229
Epoch: 55, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.796 Vali Acc: 0.862 Test Loss: 0.796 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 0.7067046165466309
Epoch: 56, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.807 Vali Acc: 0.862 Test Loss: 0.807 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 0.6963250637054443
Epoch: 57, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.804 Vali Acc: 0.870 Test Loss: 0.804 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 0.7784018516540527
Epoch: 58, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.803 Vali Acc: 0.877 Test Loss: 0.803 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm128_cs103_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 61610
model size : 0.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm128_cs69_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.018603801727295
Epoch: 1, Steps: 9 | Train Loss: 1.312 Vali Loss: 1.322 Vali Acc: 0.312 Test Loss: 1.322 Test Acc: 0.312
Validation loss decreased (inf --> -0.311581).  Saving model ...
Epoch: 2 cost time: 0.5607094764709473
Epoch: 2, Steps: 9 | Train Loss: 1.255 Vali Loss: 1.259 Vali Acc: 0.391 Test Loss: 1.259 Test Acc: 0.391
Validation loss decreased (-0.311581 --> -0.391292).  Saving model ...
Epoch: 3 cost time: 0.5922892093658447
Epoch: 3, Steps: 9 | Train Loss: 1.188 Vali Loss: 1.186 Vali Acc: 0.442 Test Loss: 1.186 Test Acc: 0.442
Validation loss decreased (-0.391292 --> -0.442017).  Saving model ...
Epoch: 4 cost time: 0.6533374786376953
Epoch: 4, Steps: 9 | Train Loss: 1.090 Vali Loss: 1.138 Vali Acc: 0.449 Test Loss: 1.138 Test Acc: 0.449
Validation loss decreased (-0.442017 --> -0.449264).  Saving model ...
Epoch: 5 cost time: 0.5397224426269531
Epoch: 5, Steps: 9 | Train Loss: 1.028 Vali Loss: 1.100 Vali Acc: 0.457 Test Loss: 1.100 Test Acc: 0.457
Validation loss decreased (-0.449264 --> -0.456511).  Saving model ...
Epoch: 6 cost time: 0.5595993995666504
Epoch: 6, Steps: 9 | Train Loss: 0.970 Vali Loss: 1.066 Vali Acc: 0.471 Test Loss: 1.066 Test Acc: 0.471
Validation loss decreased (-0.456511 --> -0.471004).  Saving model ...
Epoch: 7 cost time: 0.7079169750213623
Epoch: 7, Steps: 9 | Train Loss: 0.911 Vali Loss: 1.045 Vali Acc: 0.471 Test Loss: 1.045 Test Acc: 0.471
Validation loss decreased (-0.471004 --> -0.471004).  Saving model ...
Epoch: 8 cost time: 0.5212252140045166
Epoch: 8, Steps: 9 | Train Loss: 0.837 Vali Loss: 1.013 Vali Acc: 0.486 Test Loss: 1.013 Test Acc: 0.486
Validation loss decreased (-0.471004 --> -0.485497).  Saving model ...
Epoch: 9 cost time: 0.6155822277069092
Epoch: 9, Steps: 9 | Train Loss: 0.792 Vali Loss: 0.989 Vali Acc: 0.522 Test Loss: 0.989 Test Acc: 0.522
Validation loss decreased (-0.485497 --> -0.521729).  Saving model ...
Epoch: 10 cost time: 0.6329493522644043
Epoch: 10, Steps: 9 | Train Loss: 0.759 Vali Loss: 0.978 Vali Acc: 0.551 Test Loss: 0.978 Test Acc: 0.551
Validation loss decreased (-0.521729 --> -0.550715).  Saving model ...
Epoch: 11 cost time: 0.5784049034118652
Epoch: 11, Steps: 9 | Train Loss: 0.687 Vali Loss: 0.963 Vali Acc: 0.572 Test Loss: 0.963 Test Acc: 0.572
Validation loss decreased (-0.550715 --> -0.572454).  Saving model ...
Epoch: 12 cost time: 0.7109014987945557
Epoch: 12, Steps: 9 | Train Loss: 0.651 Vali Loss: 0.948 Vali Acc: 0.572 Test Loss: 0.948 Test Acc: 0.572
Validation loss decreased (-0.572454 --> -0.572454).  Saving model ...
Epoch: 13 cost time: 0.6068947315216064
Epoch: 13, Steps: 9 | Train Loss: 0.581 Vali Loss: 0.932 Vali Acc: 0.587 Test Loss: 0.932 Test Acc: 0.587
Validation loss decreased (-0.572454 --> -0.586947).  Saving model ...
Epoch: 14 cost time: 0.597308874130249
Epoch: 14, Steps: 9 | Train Loss: 0.530 Vali Loss: 0.885 Vali Acc: 0.638 Test Loss: 0.885 Test Acc: 0.638
Validation loss decreased (-0.586947 --> -0.637672).  Saving model ...
Epoch: 15 cost time: 0.6161675453186035
Epoch: 15, Steps: 9 | Train Loss: 0.453 Vali Loss: 0.832 Vali Acc: 0.659 Test Loss: 0.832 Test Acc: 0.659
Validation loss decreased (-0.637672 --> -0.659412).  Saving model ...
Epoch: 16 cost time: 0.5305700302124023
Epoch: 16, Steps: 9 | Train Loss: 0.388 Vali Loss: 0.773 Vali Acc: 0.688 Test Loss: 0.773 Test Acc: 0.688
Validation loss decreased (-0.659412 --> -0.688398).  Saving model ...
Epoch: 17 cost time: 0.6711180210113525
Epoch: 17, Steps: 9 | Train Loss: 0.311 Vali Loss: 0.731 Vali Acc: 0.717 Test Loss: 0.731 Test Acc: 0.717
Validation loss decreased (-0.688398 --> -0.717384).  Saving model ...
Epoch: 18 cost time: 0.5301845073699951
Epoch: 18, Steps: 9 | Train Loss: 0.268 Vali Loss: 0.687 Vali Acc: 0.725 Test Loss: 0.687 Test Acc: 0.725
Validation loss decreased (-0.717384 --> -0.724631).  Saving model ...
Epoch: 19 cost time: 0.5163674354553223
Epoch: 19, Steps: 9 | Train Loss: 0.195 Vali Loss: 0.653 Vali Acc: 0.739 Test Loss: 0.653 Test Acc: 0.739
Validation loss decreased (-0.724631 --> -0.739124).  Saving model ...
Epoch: 20 cost time: 0.5306849479675293
Epoch: 20, Steps: 9 | Train Loss: 0.167 Vali Loss: 0.635 Vali Acc: 0.761 Test Loss: 0.635 Test Acc: 0.761
Validation loss decreased (-0.739124 --> -0.760863).  Saving model ...
Epoch: 21 cost time: 0.5694825649261475
Epoch: 21, Steps: 9 | Train Loss: 0.137 Vali Loss: 0.611 Vali Acc: 0.754 Test Loss: 0.611 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5949649810791016
Epoch: 22, Steps: 9 | Train Loss: 0.114 Vali Loss: 0.594 Vali Acc: 0.768 Test Loss: 0.594 Test Acc: 0.768
Validation loss decreased (-0.760863 --> -0.768110).  Saving model ...
Epoch: 23 cost time: 0.5631656646728516
Epoch: 23, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.580 Vali Acc: 0.775 Test Loss: 0.580 Test Acc: 0.775
Validation loss decreased (-0.768110 --> -0.775357).  Saving model ...
Epoch: 24 cost time: 0.5646522045135498
Epoch: 24, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.569 Vali Acc: 0.783 Test Loss: 0.569 Test Acc: 0.783
Validation loss decreased (-0.775357 --> -0.782603).  Saving model ...
Epoch: 25 cost time: 0.5794670581817627
Epoch: 25, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.591 Vali Acc: 0.790 Test Loss: 0.591 Test Acc: 0.790
Validation loss decreased (-0.782603 --> -0.789849).  Saving model ...
Epoch: 26 cost time: 0.4675626754760742
Epoch: 26, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.562 Vali Acc: 0.797 Test Loss: 0.562 Test Acc: 0.797
Validation loss decreased (-0.789849 --> -0.797096).  Saving model ...
Epoch: 27 cost time: 0.646543025970459
Epoch: 27, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.549 Vali Acc: 0.797 Test Loss: 0.549 Test Acc: 0.797
Validation loss decreased (-0.797096 --> -0.797096).  Saving model ...
Epoch: 28 cost time: 0.7295269966125488
Epoch: 28, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.580 Vali Acc: 0.797 Test Loss: 0.580 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.617140531539917
Epoch: 29, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.564 Vali Acc: 0.804 Test Loss: 0.564 Test Acc: 0.804
Validation loss decreased (-0.797096 --> -0.804342).  Saving model ...
Epoch: 30 cost time: 0.6926019191741943
Epoch: 30, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.591 Vali Acc: 0.804 Test Loss: 0.591 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6544876098632812
Epoch: 31, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.585 Vali Acc: 0.812 Test Loss: 0.585 Test Acc: 0.812
Validation loss decreased (-0.804342 --> -0.811588).  Saving model ...
Epoch: 32 cost time: 0.6563189029693604
Epoch: 32, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.561 Vali Acc: 0.833 Test Loss: 0.561 Test Acc: 0.833
Validation loss decreased (-0.811588 --> -0.833328).  Saving model ...
Epoch: 33 cost time: 0.7123980522155762
Epoch: 33, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.559 Vali Acc: 0.826 Test Loss: 0.559 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6236362457275391
Epoch: 34, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.560 Vali Acc: 0.826 Test Loss: 0.560 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.5991625785827637
Epoch: 35, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.579 Vali Acc: 0.826 Test Loss: 0.579 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.5073385238647461
Epoch: 36, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.570 Vali Acc: 0.833 Test Loss: 0.570 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.5134575366973877
Epoch: 37, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.565 Vali Acc: 0.841 Test Loss: 0.565 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840574).  Saving model ...
Epoch: 38 cost time: 0.47257256507873535
Epoch: 38, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.577 Vali Acc: 0.833 Test Loss: 0.577 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.6139442920684814
Epoch: 39, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.575 Vali Acc: 0.826 Test Loss: 0.575 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.6213328838348389
Epoch: 40, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.580 Vali Acc: 0.833 Test Loss: 0.580 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.7200448513031006
Epoch: 41, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.582 Vali Acc: 0.833 Test Loss: 0.582 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.7445335388183594
Epoch: 42, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.581 Vali Acc: 0.833 Test Loss: 0.581 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.5729892253875732
Epoch: 43, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.588 Vali Acc: 0.826 Test Loss: 0.588 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.5741300582885742
Epoch: 44, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.595 Vali Acc: 0.826 Test Loss: 0.595 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.6745316982269287
Epoch: 45, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.592 Vali Acc: 0.826 Test Loss: 0.592 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.6198396682739258
Epoch: 46, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.595 Vali Acc: 0.833 Test Loss: 0.595 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.595172643661499
Epoch: 47, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.596 Vali Acc: 0.826 Test Loss: 0.596 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm128_cs69_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8405797101449275
model parameter : 59654
model size : 0.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm128_cs52_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.9337983131408691
Epoch: 1, Steps: 9 | Train Loss: 1.436 Vali Loss: 1.408 Vali Acc: 0.304 Test Loss: 1.408 Test Acc: 0.304
Validation loss decreased (inf --> -0.304334).  Saving model ...
Epoch: 2 cost time: 0.5263264179229736
Epoch: 2, Steps: 9 | Train Loss: 1.349 Vali Loss: 1.327 Vali Acc: 0.413 Test Loss: 1.327 Test Acc: 0.413
Validation loss decreased (-0.304334 --> -0.413030).  Saving model ...
Epoch: 3 cost time: 0.6306653022766113
Epoch: 3, Steps: 9 | Train Loss: 1.245 Vali Loss: 1.241 Vali Acc: 0.457 Test Loss: 1.241 Test Acc: 0.457
Validation loss decreased (-0.413030 --> -0.456509).  Saving model ...
Epoch: 4 cost time: 0.6146245002746582
Epoch: 4, Steps: 9 | Train Loss: 1.143 Vali Loss: 1.171 Vali Acc: 0.442 Test Loss: 1.171 Test Acc: 0.442
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7034914493560791
Epoch: 5, Steps: 9 | Train Loss: 1.061 Vali Loss: 1.124 Vali Acc: 0.471 Test Loss: 1.124 Test Acc: 0.471
Validation loss decreased (-0.456509 --> -0.471003).  Saving model ...
Epoch: 6 cost time: 0.594041109085083
Epoch: 6, Steps: 9 | Train Loss: 0.993 Vali Loss: 1.104 Vali Acc: 0.457 Test Loss: 1.104 Test Acc: 0.457
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5724174976348877
Epoch: 7, Steps: 9 | Train Loss: 0.917 Vali Loss: 1.073 Vali Acc: 0.471 Test Loss: 1.073 Test Acc: 0.471
Validation loss decreased (-0.471003 --> -0.471004).  Saving model ...
Epoch: 8 cost time: 0.5306603908538818
Epoch: 8, Steps: 9 | Train Loss: 0.852 Vali Loss: 1.050 Vali Acc: 0.493 Test Loss: 1.050 Test Acc: 0.493
Validation loss decreased (-0.471004 --> -0.492743).  Saving model ...
Epoch: 9 cost time: 0.6029922962188721
Epoch: 9, Steps: 9 | Train Loss: 0.802 Vali Loss: 1.040 Vali Acc: 0.536 Test Loss: 1.040 Test Acc: 0.536
Validation loss decreased (-0.492743 --> -0.536221).  Saving model ...
Epoch: 10 cost time: 0.762129545211792
Epoch: 10, Steps: 9 | Train Loss: 0.749 Vali Loss: 1.021 Vali Acc: 0.536 Test Loss: 1.021 Test Acc: 0.536
Validation loss decreased (-0.536221 --> -0.536222).  Saving model ...
Epoch: 11 cost time: 0.5802199840545654
Epoch: 11, Steps: 9 | Train Loss: 0.711 Vali Loss: 0.996 Vali Acc: 0.565 Test Loss: 0.996 Test Acc: 0.565
Validation loss decreased (-0.536222 --> -0.565207).  Saving model ...
Epoch: 12 cost time: 0.5985424518585205
Epoch: 12, Steps: 9 | Train Loss: 0.660 Vali Loss: 0.982 Vali Acc: 0.601 Test Loss: 0.982 Test Acc: 0.601
Validation loss decreased (-0.565207 --> -0.601439).  Saving model ...
Epoch: 13 cost time: 0.7059609889984131
Epoch: 13, Steps: 9 | Train Loss: 0.605 Vali Loss: 0.970 Vali Acc: 0.580 Test Loss: 0.970 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5872628688812256
Epoch: 14, Steps: 9 | Train Loss: 0.565 Vali Loss: 0.943 Vali Acc: 0.652 Test Loss: 0.943 Test Acc: 0.652
Validation loss decreased (-0.601439 --> -0.652164).  Saving model ...
Epoch: 15 cost time: 0.6900835037231445
Epoch: 15, Steps: 9 | Train Loss: 0.487 Vali Loss: 0.907 Vali Acc: 0.667 Test Loss: 0.907 Test Acc: 0.667
Validation loss decreased (-0.652164 --> -0.666658).  Saving model ...
Epoch: 16 cost time: 0.6358969211578369
Epoch: 16, Steps: 9 | Train Loss: 0.432 Vali Loss: 0.855 Vali Acc: 0.681 Test Loss: 0.855 Test Acc: 0.681
Validation loss decreased (-0.666658 --> -0.681151).  Saving model ...
Epoch: 17 cost time: 0.7006874084472656
Epoch: 17, Steps: 9 | Train Loss: 0.361 Vali Loss: 0.825 Vali Acc: 0.688 Test Loss: 0.825 Test Acc: 0.688
Validation loss decreased (-0.681151 --> -0.688398).  Saving model ...
Epoch: 18 cost time: 0.659616231918335
Epoch: 18, Steps: 9 | Train Loss: 0.298 Vali Loss: 0.752 Vali Acc: 0.710 Test Loss: 0.752 Test Acc: 0.710
Validation loss decreased (-0.688398 --> -0.710137).  Saving model ...
Epoch: 19 cost time: 0.554072380065918
Epoch: 19, Steps: 9 | Train Loss: 0.230 Vali Loss: 0.726 Vali Acc: 0.710 Test Loss: 0.726 Test Acc: 0.710
Validation loss decreased (-0.710137 --> -0.710138).  Saving model ...
Epoch: 20 cost time: 0.5551795959472656
Epoch: 20, Steps: 9 | Train Loss: 0.191 Vali Loss: 0.683 Vali Acc: 0.717 Test Loss: 0.683 Test Acc: 0.717
Validation loss decreased (-0.710138 --> -0.717384).  Saving model ...
Epoch: 21 cost time: 0.7418889999389648
Epoch: 21, Steps: 9 | Train Loss: 0.160 Vali Loss: 0.631 Vali Acc: 0.746 Test Loss: 0.631 Test Acc: 0.746
Validation loss decreased (-0.717384 --> -0.746371).  Saving model ...
Epoch: 22 cost time: 0.5149173736572266
Epoch: 22, Steps: 9 | Train Loss: 0.119 Vali Loss: 0.634 Vali Acc: 0.754 Test Loss: 0.634 Test Acc: 0.754
Validation loss decreased (-0.746371 --> -0.753617).  Saving model ...
Epoch: 23 cost time: 0.8038740158081055
Epoch: 23, Steps: 9 | Train Loss: 0.096 Vali Loss: 0.613 Vali Acc: 0.768 Test Loss: 0.613 Test Acc: 0.768
Validation loss decreased (-0.753617 --> -0.768110).  Saving model ...
Epoch: 24 cost time: 0.5956897735595703
Epoch: 24, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.591 Vali Acc: 0.797 Test Loss: 0.591 Test Acc: 0.797
Validation loss decreased (-0.768110 --> -0.797096).  Saving model ...
Epoch: 25 cost time: 0.6475832462310791
Epoch: 25, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.572 Vali Acc: 0.797 Test Loss: 0.572 Test Acc: 0.797
Validation loss decreased (-0.797096 --> -0.797096).  Saving model ...
Epoch: 26 cost time: 0.5569241046905518
Epoch: 26, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.561 Vali Acc: 0.819 Test Loss: 0.561 Test Acc: 0.819
Validation loss decreased (-0.797096 --> -0.818835).  Saving model ...
Epoch: 27 cost time: 0.5562927722930908
Epoch: 27, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.565 Vali Acc: 0.819 Test Loss: 0.565 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6811168193817139
Epoch: 28, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.566 Vali Acc: 0.826 Test Loss: 0.566 Test Acc: 0.826
Validation loss decreased (-0.818835 --> -0.826081).  Saving model ...
Epoch: 29 cost time: 0.6196262836456299
Epoch: 29, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.565 Vali Acc: 0.826 Test Loss: 0.565 Test Acc: 0.826
Validation loss decreased (-0.826081 --> -0.826081).  Saving model ...
Epoch: 30 cost time: 0.6498305797576904
Epoch: 30, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.585 Vali Acc: 0.841 Test Loss: 0.585 Test Acc: 0.841
Validation loss decreased (-0.826081 --> -0.840574).  Saving model ...
Epoch: 31 cost time: 0.7840611934661865
Epoch: 31, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.572 Vali Acc: 0.833 Test Loss: 0.572 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7066648006439209
Epoch: 32, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.575 Vali Acc: 0.833 Test Loss: 0.575 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.5882186889648438
Epoch: 33, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.583 Vali Acc: 0.841 Test Loss: 0.583 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840574).  Saving model ...
Epoch: 34 cost time: 0.6187183856964111
Epoch: 34, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.588 Vali Acc: 0.848 Test Loss: 0.588 Test Acc: 0.848
Validation loss decreased (-0.840574 --> -0.847820).  Saving model ...
Epoch: 35 cost time: 0.665773868560791
Epoch: 35, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.596 Vali Acc: 0.848 Test Loss: 0.596 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7246696949005127
Epoch: 36, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.604 Vali Acc: 0.848 Test Loss: 0.604 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6076655387878418
Epoch: 37, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.592 Vali Acc: 0.848 Test Loss: 0.592 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.5995643138885498
Epoch: 38, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.601 Vali Acc: 0.848 Test Loss: 0.601 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.5396058559417725
Epoch: 39, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.609 Vali Acc: 0.848 Test Loss: 0.609 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.721238374710083
Epoch: 40, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.621 Vali Acc: 0.848 Test Loss: 0.621 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.7008073329925537
Epoch: 41, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.619 Vali Acc: 0.848 Test Loss: 0.619 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.8351473808288574
Epoch: 42, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.629 Vali Acc: 0.848 Test Loss: 0.629 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.5856168270111084
Epoch: 43, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.658 Vali Acc: 0.848 Test Loss: 0.658 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.4974961280822754
Epoch: 44, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.636 Vali Acc: 0.855 Test Loss: 0.636 Test Acc: 0.855
Validation loss decreased (-0.847820 --> -0.855066).  Saving model ...
Epoch: 45 cost time: 0.5394973754882812
Epoch: 45, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.635 Vali Acc: 0.855 Test Loss: 0.635 Test Acc: 0.855
Validation loss decreased (-0.855066 --> -0.855066).  Saving model ...
Epoch: 46 cost time: 0.6834003925323486
Epoch: 46, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.629 Vali Acc: 0.855 Test Loss: 0.629 Test Acc: 0.855
Validation loss decreased (-0.855066 --> -0.855066).  Saving model ...
Epoch: 47 cost time: 0.5411875247955322
Epoch: 47, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.667 Vali Acc: 0.855 Test Loss: 0.667 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.709204912185669
Epoch: 48, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.667 Vali Acc: 0.855 Test Loss: 0.667 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.6518230438232422
Epoch: 49, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.643 Vali Acc: 0.855 Test Loss: 0.643 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.662830114364624
Epoch: 50, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.644 Vali Acc: 0.855 Test Loss: 0.644 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.6689431667327881
Epoch: 51, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.651 Vali Acc: 0.855 Test Loss: 0.651 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.7248833179473877
Epoch: 52, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.675 Vali Acc: 0.855 Test Loss: 0.675 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.5805814266204834
Epoch: 53, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.679 Vali Acc: 0.855 Test Loss: 0.679 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 0.6046817302703857
Epoch: 54, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.678 Vali Acc: 0.855 Test Loss: 0.678 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 0.717904806137085
Epoch: 55, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.668 Vali Acc: 0.855 Test Loss: 0.668 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 0.6799383163452148
Epoch: 56, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.677 Vali Acc: 0.855 Test Loss: 0.677 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm128_cs52_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 58790
model size : 0.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm128_cs42_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.7756054401397705
Epoch: 1, Steps: 9 | Train Loss: 1.388 Vali Loss: 1.441 Vali Acc: 0.210 Test Loss: 1.441 Test Acc: 0.210
Validation loss decreased (inf --> -0.210131).  Saving model ...
Epoch: 2 cost time: 0.4548020362854004
Epoch: 2, Steps: 9 | Train Loss: 1.311 Vali Loss: 1.355 Vali Acc: 0.355 Test Loss: 1.355 Test Acc: 0.355
Validation loss decreased (-0.210131 --> -0.355059).  Saving model ...
Epoch: 3 cost time: 0.6154732704162598
Epoch: 3, Steps: 9 | Train Loss: 1.219 Vali Loss: 1.256 Vali Acc: 0.449 Test Loss: 1.256 Test Acc: 0.449
Validation loss decreased (-0.355059 --> -0.449263).  Saving model ...
Epoch: 4 cost time: 0.6199705600738525
Epoch: 4, Steps: 9 | Train Loss: 1.121 Vali Loss: 1.184 Vali Acc: 0.464 Test Loss: 1.184 Test Acc: 0.464
Validation loss decreased (-0.449263 --> -0.463756).  Saving model ...
Epoch: 5 cost time: 0.5989716053009033
Epoch: 5, Steps: 9 | Train Loss: 1.024 Vali Loss: 1.130 Vali Acc: 0.449 Test Loss: 1.130 Test Acc: 0.449
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8534259796142578
Epoch: 6, Steps: 9 | Train Loss: 0.960 Vali Loss: 1.086 Vali Acc: 0.478 Test Loss: 1.086 Test Acc: 0.478
Validation loss decreased (-0.463756 --> -0.478250).  Saving model ...
Epoch: 7 cost time: 0.6946163177490234
Epoch: 7, Steps: 9 | Train Loss: 0.891 Vali Loss: 1.066 Vali Acc: 0.486 Test Loss: 1.066 Test Acc: 0.486
Validation loss decreased (-0.478250 --> -0.485497).  Saving model ...
Epoch: 8 cost time: 0.5487446784973145
Epoch: 8, Steps: 9 | Train Loss: 0.843 Vali Loss: 1.055 Vali Acc: 0.486 Test Loss: 1.055 Test Acc: 0.486
Validation loss decreased (-0.485497 --> -0.485497).  Saving model ...
Epoch: 9 cost time: 0.6323113441467285
Epoch: 9, Steps: 9 | Train Loss: 0.790 Vali Loss: 1.035 Vali Acc: 0.486 Test Loss: 1.035 Test Acc: 0.486
Validation loss decreased (-0.485497 --> -0.485497).  Saving model ...
Epoch: 10 cost time: 0.7022309303283691
Epoch: 10, Steps: 9 | Train Loss: 0.738 Vali Loss: 1.029 Vali Acc: 0.529 Test Loss: 1.029 Test Acc: 0.529
Validation loss decreased (-0.485497 --> -0.528975).  Saving model ...
Epoch: 11 cost time: 0.6112518310546875
Epoch: 11, Steps: 9 | Train Loss: 0.700 Vali Loss: 1.010 Vali Acc: 0.587 Test Loss: 1.010 Test Acc: 0.587
Validation loss decreased (-0.528975 --> -0.586946).  Saving model ...
Epoch: 12 cost time: 0.5471012592315674
Epoch: 12, Steps: 9 | Train Loss: 0.662 Vali Loss: 1.007 Vali Acc: 0.551 Test Loss: 1.007 Test Acc: 0.551
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5440042018890381
Epoch: 13, Steps: 9 | Train Loss: 0.623 Vali Loss: 1.000 Vali Acc: 0.587 Test Loss: 1.000 Test Acc: 0.587
Validation loss decreased (-0.586946 --> -0.586947).  Saving model ...
Epoch: 14 cost time: 0.4744846820831299
Epoch: 14, Steps: 9 | Train Loss: 0.575 Vali Loss: 1.005 Vali Acc: 0.543 Test Loss: 1.005 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5922071933746338
Epoch: 15, Steps: 9 | Train Loss: 0.553 Vali Loss: 1.029 Vali Acc: 0.529 Test Loss: 1.029 Test Acc: 0.529
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6599643230438232
Epoch: 16, Steps: 9 | Train Loss: 0.524 Vali Loss: 1.002 Vali Acc: 0.630 Test Loss: 1.002 Test Acc: 0.630
Validation loss decreased (-0.586947 --> -0.630425).  Saving model ...
Epoch: 17 cost time: 0.5155878067016602
Epoch: 17, Steps: 9 | Train Loss: 0.488 Vali Loss: 1.024 Vali Acc: 0.616 Test Loss: 1.024 Test Acc: 0.616
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5302586555480957
Epoch: 18, Steps: 9 | Train Loss: 0.437 Vali Loss: 0.986 Vali Acc: 0.630 Test Loss: 0.986 Test Acc: 0.630
Validation loss decreased (-0.630425 --> -0.630425).  Saving model ...
Epoch: 19 cost time: 0.5626857280731201
Epoch: 19, Steps: 9 | Train Loss: 0.403 Vali Loss: 0.978 Vali Acc: 0.630 Test Loss: 0.978 Test Acc: 0.630
Validation loss decreased (-0.630425 --> -0.630425).  Saving model ...
Epoch: 20 cost time: 0.6235082149505615
Epoch: 20, Steps: 9 | Train Loss: 0.358 Vali Loss: 0.954 Vali Acc: 0.667 Test Loss: 0.954 Test Acc: 0.667
Validation loss decreased (-0.630425 --> -0.666657).  Saving model ...
Epoch: 21 cost time: 0.5594155788421631
Epoch: 21, Steps: 9 | Train Loss: 0.318 Vali Loss: 0.918 Vali Acc: 0.681 Test Loss: 0.918 Test Acc: 0.681
Validation loss decreased (-0.666657 --> -0.681150).  Saving model ...
Epoch: 22 cost time: 0.643416166305542
Epoch: 22, Steps: 9 | Train Loss: 0.271 Vali Loss: 0.887 Vali Acc: 0.688 Test Loss: 0.887 Test Acc: 0.688
Validation loss decreased (-0.681150 --> -0.688397).  Saving model ...
Epoch: 23 cost time: 0.6216747760772705
Epoch: 23, Steps: 9 | Train Loss: 0.217 Vali Loss: 0.809 Vali Acc: 0.703 Test Loss: 0.809 Test Acc: 0.703
Validation loss decreased (-0.688397 --> -0.702890).  Saving model ...
Epoch: 24 cost time: 0.7124488353729248
Epoch: 24, Steps: 9 | Train Loss: 0.170 Vali Loss: 0.726 Vali Acc: 0.710 Test Loss: 0.726 Test Acc: 0.710
Validation loss decreased (-0.702890 --> -0.710138).  Saving model ...
Epoch: 25 cost time: 0.4770216941833496
Epoch: 25, Steps: 9 | Train Loss: 0.133 Vali Loss: 0.692 Vali Acc: 0.725 Test Loss: 0.692 Test Acc: 0.725
Validation loss decreased (-0.710138 --> -0.724631).  Saving model ...
Epoch: 26 cost time: 0.6701984405517578
Epoch: 26, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.641 Vali Acc: 0.754 Test Loss: 0.641 Test Acc: 0.754
Validation loss decreased (-0.724631 --> -0.753617).  Saving model ...
Epoch: 27 cost time: 0.677349328994751
Epoch: 27, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.608 Vali Acc: 0.746 Test Loss: 0.608 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5620214939117432
Epoch: 28, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.562 Vali Acc: 0.775 Test Loss: 0.562 Test Acc: 0.775
Validation loss decreased (-0.753617 --> -0.775357).  Saving model ...
Epoch: 29 cost time: 0.6763019561767578
Epoch: 29, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.574 Vali Acc: 0.797 Test Loss: 0.574 Test Acc: 0.797
Validation loss decreased (-0.775357 --> -0.797096).  Saving model ...
Epoch: 30 cost time: 0.6176390647888184
Epoch: 30, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.569 Vali Acc: 0.804 Test Loss: 0.569 Test Acc: 0.804
Validation loss decreased (-0.797096 --> -0.804342).  Saving model ...
Epoch: 31 cost time: 0.5775532722473145
Epoch: 31, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.576 Vali Acc: 0.812 Test Loss: 0.576 Test Acc: 0.812
Validation loss decreased (-0.804342 --> -0.811588).  Saving model ...
Epoch: 32 cost time: 0.6490390300750732
Epoch: 32, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.554 Vali Acc: 0.790 Test Loss: 0.554 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8230102062225342
Epoch: 33, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.549 Vali Acc: 0.804 Test Loss: 0.549 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.6020493507385254
Epoch: 34, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.561 Vali Acc: 0.804 Test Loss: 0.561 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.6765756607055664
Epoch: 35, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.560 Vali Acc: 0.812 Test Loss: 0.560 Test Acc: 0.812
Validation loss decreased (-0.811588 --> -0.811589).  Saving model ...
Epoch: 36 cost time: 0.6817877292633057
Epoch: 36, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.550 Vali Acc: 0.812 Test Loss: 0.550 Test Acc: 0.812
Validation loss decreased (-0.811589 --> -0.811589).  Saving model ...
Epoch: 37 cost time: 0.6657791137695312
Epoch: 37, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.541 Vali Acc: 0.812 Test Loss: 0.541 Test Acc: 0.812
Validation loss decreased (-0.811589 --> -0.811589).  Saving model ...
Epoch: 38 cost time: 0.7665226459503174
Epoch: 38, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.569 Vali Acc: 0.812 Test Loss: 0.569 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.6663172245025635
Epoch: 39, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.542 Vali Acc: 0.819 Test Loss: 0.542 Test Acc: 0.819
Validation loss decreased (-0.811589 --> -0.818835).  Saving model ...
Epoch: 40 cost time: 0.6155693531036377
Epoch: 40, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.559 Vali Acc: 0.804 Test Loss: 0.559 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.6653075218200684
Epoch: 41, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.553 Vali Acc: 0.819 Test Loss: 0.553 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.629889726638794
Epoch: 42, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.555 Vali Acc: 0.819 Test Loss: 0.555 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.6114161014556885
Epoch: 43, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.554 Vali Acc: 0.826 Test Loss: 0.554 Test Acc: 0.826
Validation loss decreased (-0.818835 --> -0.826081).  Saving model ...
Epoch: 44 cost time: 0.7204246520996094
Epoch: 44, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.558 Vali Acc: 0.826 Test Loss: 0.558 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.709693193435669
Epoch: 45, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.554 Vali Acc: 0.833 Test Loss: 0.554 Test Acc: 0.833
Validation loss decreased (-0.826081 --> -0.833328).  Saving model ...
Epoch: 46 cost time: 0.8487460613250732
Epoch: 46, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.557 Vali Acc: 0.826 Test Loss: 0.557 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.6841990947723389
Epoch: 47, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.558 Vali Acc: 0.826 Test Loss: 0.558 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.7009353637695312
Epoch: 48, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.559 Vali Acc: 0.826 Test Loss: 0.559 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.7137150764465332
Epoch: 49, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.549 Vali Acc: 0.833 Test Loss: 0.549 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 50 cost time: 0.6478397846221924
Epoch: 50, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.551 Vali Acc: 0.841 Test Loss: 0.551 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840574).  Saving model ...
Epoch: 51 cost time: 0.6585917472839355
Epoch: 51, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.560 Vali Acc: 0.833 Test Loss: 0.560 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.6638460159301758
Epoch: 52, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.559 Vali Acc: 0.833 Test Loss: 0.559 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.6995987892150879
Epoch: 53, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.562 Vali Acc: 0.833 Test Loss: 0.562 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.7048790454864502
Epoch: 54, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.561 Vali Acc: 0.841 Test Loss: 0.561 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 0.5854287147521973
Epoch: 55, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.560 Vali Acc: 0.833 Test Loss: 0.560 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 0.7339394092559814
Epoch: 56, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.558 Vali Acc: 0.833 Test Loss: 0.558 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 0.6652116775512695
Epoch: 57, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.554 Vali Acc: 0.833 Test Loss: 0.554 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 0.6164422035217285
Epoch: 58, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.559 Vali Acc: 0.833 Test Loss: 0.559 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 0.6349163055419922
Epoch: 59, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.559 Vali Acc: 0.833 Test Loss: 0.559 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 0.6406059265136719
Epoch: 60, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.554 Vali Acc: 0.833 Test Loss: 0.554 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm128_cs42_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8405797101449275
model parameter : 58584
model size : 0.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm128_cs35_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.8600099086761475
Epoch: 1, Steps: 9 | Train Loss: 1.415 Vali Loss: 1.419 Vali Acc: 0.225 Test Loss: 1.419 Test Acc: 0.225
Validation loss decreased (inf --> -0.224623).  Saving model ...
Epoch: 2 cost time: 0.6642067432403564
Epoch: 2, Steps: 9 | Train Loss: 1.346 Vali Loss: 1.330 Vali Acc: 0.304 Test Loss: 1.330 Test Acc: 0.304
Validation loss decreased (-0.224623 --> -0.304335).  Saving model ...
Epoch: 3 cost time: 0.6750609874725342
Epoch: 3, Steps: 9 | Train Loss: 1.246 Vali Loss: 1.244 Vali Acc: 0.406 Test Loss: 1.244 Test Acc: 0.406
Validation loss decreased (-0.304335 --> -0.405785).  Saving model ...
Epoch: 4 cost time: 0.5276501178741455
Epoch: 4, Steps: 9 | Train Loss: 1.131 Vali Loss: 1.173 Vali Acc: 0.486 Test Loss: 1.173 Test Acc: 0.486
Validation loss decreased (-0.405785 --> -0.485496).  Saving model ...
Epoch: 5 cost time: 0.519331693649292
Epoch: 5, Steps: 9 | Train Loss: 1.060 Vali Loss: 1.124 Vali Acc: 0.464 Test Loss: 1.124 Test Acc: 0.464
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5648198127746582
Epoch: 6, Steps: 9 | Train Loss: 0.985 Vali Loss: 1.093 Vali Acc: 0.471 Test Loss: 1.093 Test Acc: 0.471
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5727622509002686
Epoch: 7, Steps: 9 | Train Loss: 0.915 Vali Loss: 1.065 Vali Acc: 0.493 Test Loss: 1.065 Test Acc: 0.493
Validation loss decreased (-0.485496 --> -0.492743).  Saving model ...
Epoch: 8 cost time: 0.5544662475585938
Epoch: 8, Steps: 9 | Train Loss: 0.847 Vali Loss: 1.042 Vali Acc: 0.493 Test Loss: 1.042 Test Acc: 0.493
Validation loss decreased (-0.492743 --> -0.492743).  Saving model ...
Epoch: 9 cost time: 0.6417357921600342
Epoch: 9, Steps: 9 | Train Loss: 0.814 Vali Loss: 1.022 Vali Acc: 0.486 Test Loss: 1.022 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5244507789611816
Epoch: 10, Steps: 9 | Train Loss: 0.766 Vali Loss: 0.980 Vali Acc: 0.551 Test Loss: 0.980 Test Acc: 0.551
Validation loss decreased (-0.492743 --> -0.550715).  Saving model ...
Epoch: 11 cost time: 0.5606961250305176
Epoch: 11, Steps: 9 | Train Loss: 0.703 Vali Loss: 0.968 Vali Acc: 0.551 Test Loss: 0.968 Test Acc: 0.551
Validation loss decreased (-0.550715 --> -0.550715).  Saving model ...
Epoch: 12 cost time: 0.7022316455841064
Epoch: 12, Steps: 9 | Train Loss: 0.659 Vali Loss: 0.957 Vali Acc: 0.587 Test Loss: 0.957 Test Acc: 0.587
Validation loss decreased (-0.550715 --> -0.586947).  Saving model ...
Epoch: 13 cost time: 0.6669375896453857
Epoch: 13, Steps: 9 | Train Loss: 0.592 Vali Loss: 0.921 Vali Acc: 0.638 Test Loss: 0.921 Test Acc: 0.638
Validation loss decreased (-0.586947 --> -0.637672).  Saving model ...
Epoch: 14 cost time: 0.6077446937561035
Epoch: 14, Steps: 9 | Train Loss: 0.519 Vali Loss: 0.865 Vali Acc: 0.659 Test Loss: 0.865 Test Acc: 0.659
Validation loss decreased (-0.637672 --> -0.659412).  Saving model ...
Epoch: 15 cost time: 0.6531641483306885
Epoch: 15, Steps: 9 | Train Loss: 0.438 Vali Loss: 0.798 Vali Acc: 0.688 Test Loss: 0.798 Test Acc: 0.688
Validation loss decreased (-0.659412 --> -0.688398).  Saving model ...
Epoch: 16 cost time: 0.54062819480896
Epoch: 16, Steps: 9 | Train Loss: 0.354 Vali Loss: 0.743 Vali Acc: 0.681 Test Loss: 0.743 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5507919788360596
Epoch: 17, Steps: 9 | Train Loss: 0.303 Vali Loss: 0.704 Vali Acc: 0.696 Test Loss: 0.704 Test Acc: 0.696
Validation loss decreased (-0.688398 --> -0.695645).  Saving model ...
Epoch: 18 cost time: 0.5777661800384521
Epoch: 18, Steps: 9 | Train Loss: 0.233 Vali Loss: 0.676 Vali Acc: 0.725 Test Loss: 0.676 Test Acc: 0.725
Validation loss decreased (-0.695645 --> -0.724631).  Saving model ...
Epoch: 19 cost time: 0.6234645843505859
Epoch: 19, Steps: 9 | Train Loss: 0.199 Vali Loss: 0.671 Vali Acc: 0.717 Test Loss: 0.671 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6333930492401123
Epoch: 20, Steps: 9 | Train Loss: 0.173 Vali Loss: 0.661 Vali Acc: 0.732 Test Loss: 0.661 Test Acc: 0.732
Validation loss decreased (-0.724631 --> -0.731877).  Saving model ...
Epoch: 21 cost time: 0.6117253303527832
Epoch: 21, Steps: 9 | Train Loss: 0.156 Vali Loss: 0.654 Vali Acc: 0.739 Test Loss: 0.654 Test Acc: 0.739
Validation loss decreased (-0.731877 --> -0.739124).  Saving model ...
Epoch: 22 cost time: 0.5574135780334473
Epoch: 22, Steps: 9 | Train Loss: 0.127 Vali Loss: 0.702 Vali Acc: 0.739 Test Loss: 0.702 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.44258975982666016
Epoch: 23, Steps: 9 | Train Loss: 0.109 Vali Loss: 0.633 Vali Acc: 0.739 Test Loss: 0.633 Test Acc: 0.739
Validation loss decreased (-0.739124 --> -0.739124).  Saving model ...
Epoch: 24 cost time: 0.4295995235443115
Epoch: 24, Steps: 9 | Train Loss: 0.089 Vali Loss: 0.621 Vali Acc: 0.754 Test Loss: 0.621 Test Acc: 0.754
Validation loss decreased (-0.739124 --> -0.753617).  Saving model ...
Epoch: 25 cost time: 0.5480551719665527
Epoch: 25, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.637 Vali Acc: 0.754 Test Loss: 0.637 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6761181354522705
Epoch: 26, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.662 Vali Acc: 0.761 Test Loss: 0.662 Test Acc: 0.761
Validation loss decreased (-0.753617 --> -0.760863).  Saving model ...
Epoch: 27 cost time: 0.5712947845458984
Epoch: 27, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.657 Vali Acc: 0.754 Test Loss: 0.657 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5696830749511719
Epoch: 28, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.639 Vali Acc: 0.783 Test Loss: 0.639 Test Acc: 0.783
Validation loss decreased (-0.760863 --> -0.782602).  Saving model ...
Epoch: 29 cost time: 0.5847976207733154
Epoch: 29, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.658 Vali Acc: 0.775 Test Loss: 0.658 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5611283779144287
Epoch: 30, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.658 Vali Acc: 0.783 Test Loss: 0.658 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.5633895397186279
Epoch: 31, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.645 Vali Acc: 0.790 Test Loss: 0.645 Test Acc: 0.790
Validation loss decreased (-0.782602 --> -0.789849).  Saving model ...
Epoch: 32 cost time: 0.631798505783081
Epoch: 32, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.649 Vali Acc: 0.797 Test Loss: 0.649 Test Acc: 0.797
Validation loss decreased (-0.789849 --> -0.797095).  Saving model ...
Epoch: 33 cost time: 0.5623254776000977
Epoch: 33, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.656 Vali Acc: 0.790 Test Loss: 0.656 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.543682336807251
Epoch: 34, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.667 Vali Acc: 0.797 Test Loss: 0.667 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.651207685470581
Epoch: 35, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.643 Vali Acc: 0.804 Test Loss: 0.643 Test Acc: 0.804
Validation loss decreased (-0.797095 --> -0.804341).  Saving model ...
Epoch: 36 cost time: 0.5408248901367188
Epoch: 36, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.658 Vali Acc: 0.812 Test Loss: 0.658 Test Acc: 0.812
Validation loss decreased (-0.804341 --> -0.811588).  Saving model ...
Epoch: 37 cost time: 0.5941390991210938
Epoch: 37, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.652 Vali Acc: 0.833 Test Loss: 0.652 Test Acc: 0.833
Validation loss decreased (-0.811588 --> -0.833327).  Saving model ...
Epoch: 38 cost time: 0.5949084758758545
Epoch: 38, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.637 Vali Acc: 0.819 Test Loss: 0.637 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.5409862995147705
Epoch: 39, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.659 Vali Acc: 0.833 Test Loss: 0.659 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.5295662879943848
Epoch: 40, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.662 Vali Acc: 0.833 Test Loss: 0.662 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.5266282558441162
Epoch: 41, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.660 Vali Acc: 0.826 Test Loss: 0.660 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.5408504009246826
Epoch: 42, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.653 Vali Acc: 0.833 Test Loss: 0.653 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.6044485569000244
Epoch: 43, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.655 Vali Acc: 0.841 Test Loss: 0.655 Test Acc: 0.841
Validation loss decreased (-0.833327 --> -0.840573).  Saving model ...
Epoch: 44 cost time: 0.6127328872680664
Epoch: 44, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.674 Vali Acc: 0.841 Test Loss: 0.674 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.5556118488311768
Epoch: 45, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.665 Vali Acc: 0.833 Test Loss: 0.665 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.5220882892608643
Epoch: 46, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.687 Vali Acc: 0.833 Test Loss: 0.687 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.5139679908752441
Epoch: 47, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.684 Vali Acc: 0.848 Test Loss: 0.684 Test Acc: 0.848
Validation loss decreased (-0.840573 --> -0.847819).  Saving model ...
Epoch: 48 cost time: 0.5864498615264893
Epoch: 48, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.681 Vali Acc: 0.841 Test Loss: 0.681 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.5181913375854492
Epoch: 49, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.676 Vali Acc: 0.841 Test Loss: 0.676 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.5564372539520264
Epoch: 50, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.669 Vali Acc: 0.841 Test Loss: 0.669 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.5474445819854736
Epoch: 51, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.698 Vali Acc: 0.848 Test Loss: 0.698 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.5422542095184326
Epoch: 52, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.703 Vali Acc: 0.848 Test Loss: 0.703 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 0.6570603847503662
Epoch: 53, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.705 Vali Acc: 0.848 Test Loss: 0.705 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 0.6848001480102539
Epoch: 54, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.705 Vali Acc: 0.848 Test Loss: 0.705 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 0.5975117683410645
Epoch: 55, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.702 Vali Acc: 0.848 Test Loss: 0.702 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 0.6115086078643799
Epoch: 56, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.709 Vali Acc: 0.848 Test Loss: 0.709 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 0.640380859375
Epoch: 57, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.727 Vali Acc: 0.848 Test Loss: 0.727 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm128_cs35_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 58162
model size : 0.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm128_cs30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.790653944015503
Epoch: 1, Steps: 9 | Train Loss: 1.469 Vali Loss: 1.415 Vali Acc: 0.275 Test Loss: 1.415 Test Acc: 0.275
Validation loss decreased (inf --> -0.275348).  Saving model ...
Epoch: 2 cost time: 0.5730757713317871
Epoch: 2, Steps: 9 | Train Loss: 1.374 Vali Loss: 1.319 Vali Acc: 0.333 Test Loss: 1.319 Test Acc: 0.333
Validation loss decreased (-0.275348 --> -0.333320).  Saving model ...
Epoch: 3 cost time: 0.5740358829498291
Epoch: 3, Steps: 9 | Train Loss: 1.243 Vali Loss: 1.219 Vali Acc: 0.442 Test Loss: 1.219 Test Acc: 0.442
Validation loss decreased (-0.333320 --> -0.442017).  Saving model ...
Epoch: 4 cost time: 0.6526563167572021
Epoch: 4, Steps: 9 | Train Loss: 1.137 Vali Loss: 1.140 Vali Acc: 0.507 Test Loss: 1.140 Test Acc: 0.507
Validation loss decreased (-0.442017 --> -0.507235).  Saving model ...
Epoch: 5 cost time: 0.507636547088623
Epoch: 5, Steps: 9 | Train Loss: 1.049 Vali Loss: 1.093 Vali Acc: 0.522 Test Loss: 1.093 Test Acc: 0.522
Validation loss decreased (-0.507235 --> -0.521728).  Saving model ...
Epoch: 6 cost time: 0.6050136089324951
Epoch: 6, Steps: 9 | Train Loss: 0.961 Vali Loss: 1.059 Vali Acc: 0.507 Test Loss: 1.059 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6664693355560303
Epoch: 7, Steps: 9 | Train Loss: 0.885 Vali Loss: 1.021 Vali Acc: 0.543 Test Loss: 1.021 Test Acc: 0.543
Validation loss decreased (-0.521728 --> -0.543468).  Saving model ...
Epoch: 8 cost time: 0.5648748874664307
Epoch: 8, Steps: 9 | Train Loss: 0.814 Vali Loss: 0.990 Vali Acc: 0.558 Test Loss: 0.990 Test Acc: 0.558
Validation loss decreased (-0.543468 --> -0.557961).  Saving model ...
Epoch: 9 cost time: 0.6220147609710693
Epoch: 9, Steps: 9 | Train Loss: 0.754 Vali Loss: 0.958 Vali Acc: 0.565 Test Loss: 0.958 Test Acc: 0.565
Validation loss decreased (-0.557961 --> -0.565208).  Saving model ...
Epoch: 10 cost time: 0.5867066383361816
Epoch: 10, Steps: 9 | Train Loss: 0.691 Vali Loss: 0.935 Vali Acc: 0.594 Test Loss: 0.935 Test Acc: 0.594
Validation loss decreased (-0.565208 --> -0.594194).  Saving model ...
Epoch: 11 cost time: 0.5044972896575928
Epoch: 11, Steps: 9 | Train Loss: 0.614 Vali Loss: 0.890 Vali Acc: 0.616 Test Loss: 0.890 Test Acc: 0.616
Validation loss decreased (-0.594194 --> -0.615933).  Saving model ...
Epoch: 12 cost time: 0.6256656646728516
Epoch: 12, Steps: 9 | Train Loss: 0.550 Vali Loss: 0.836 Vali Acc: 0.652 Test Loss: 0.836 Test Acc: 0.652
Validation loss decreased (-0.615933 --> -0.652166).  Saving model ...
Epoch: 13 cost time: 0.6770923137664795
Epoch: 13, Steps: 9 | Train Loss: 0.466 Vali Loss: 0.772 Vali Acc: 0.688 Test Loss: 0.772 Test Acc: 0.688
Validation loss decreased (-0.652166 --> -0.688398).  Saving model ...
Epoch: 14 cost time: 0.5985867977142334
Epoch: 14, Steps: 9 | Train Loss: 0.386 Vali Loss: 0.731 Vali Acc: 0.725 Test Loss: 0.731 Test Acc: 0.725
Validation loss decreased (-0.688398 --> -0.724630).  Saving model ...
Epoch: 15 cost time: 0.6229081153869629
Epoch: 15, Steps: 9 | Train Loss: 0.327 Vali Loss: 0.714 Vali Acc: 0.739 Test Loss: 0.714 Test Acc: 0.739
Validation loss decreased (-0.724630 --> -0.739123).  Saving model ...
Epoch: 16 cost time: 0.5610876083374023
Epoch: 16, Steps: 9 | Train Loss: 0.276 Vali Loss: 0.677 Vali Acc: 0.746 Test Loss: 0.677 Test Acc: 0.746
Validation loss decreased (-0.739123 --> -0.746370).  Saving model ...
Epoch: 17 cost time: 0.5333070755004883
Epoch: 17, Steps: 9 | Train Loss: 0.220 Vali Loss: 0.683 Vali Acc: 0.754 Test Loss: 0.683 Test Acc: 0.754
Validation loss decreased (-0.746370 --> -0.753616).  Saving model ...
Epoch: 18 cost time: 0.5794484615325928
Epoch: 18, Steps: 9 | Train Loss: 0.208 Vali Loss: 0.709 Vali Acc: 0.746 Test Loss: 0.709 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5033674240112305
Epoch: 19, Steps: 9 | Train Loss: 0.160 Vali Loss: 0.726 Vali Acc: 0.739 Test Loss: 0.726 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6530599594116211
Epoch: 20, Steps: 9 | Train Loss: 0.137 Vali Loss: 0.735 Vali Acc: 0.754 Test Loss: 0.735 Test Acc: 0.754
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6965627670288086
Epoch: 21, Steps: 9 | Train Loss: 0.123 Vali Loss: 0.716 Vali Acc: 0.761 Test Loss: 0.716 Test Acc: 0.761
Validation loss decreased (-0.753616 --> -0.760862).  Saving model ...
Epoch: 22 cost time: 0.5296790599822998
Epoch: 22, Steps: 9 | Train Loss: 0.106 Vali Loss: 0.681 Vali Acc: 0.768 Test Loss: 0.681 Test Acc: 0.768
Validation loss decreased (-0.760862 --> -0.768109).  Saving model ...
Epoch: 23 cost time: 0.6406688690185547
Epoch: 23, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.720 Vali Acc: 0.754 Test Loss: 0.720 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6848022937774658
Epoch: 24, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.725 Vali Acc: 0.761 Test Loss: 0.725 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.49712228775024414
Epoch: 25, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.725 Vali Acc: 0.775 Test Loss: 0.725 Test Acc: 0.775
Validation loss decreased (-0.768109 --> -0.775355).  Saving model ...
Epoch: 26 cost time: 0.5695044994354248
Epoch: 26, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.710 Vali Acc: 0.775 Test Loss: 0.710 Test Acc: 0.775
Validation loss decreased (-0.775355 --> -0.775355).  Saving model ...
Epoch: 27 cost time: 0.5589158535003662
Epoch: 27, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.707 Vali Acc: 0.797 Test Loss: 0.707 Test Acc: 0.797
Validation loss decreased (-0.775355 --> -0.797094).  Saving model ...
Epoch: 28 cost time: 0.6401627063751221
Epoch: 28, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.721 Vali Acc: 0.797 Test Loss: 0.721 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6757266521453857
Epoch: 29, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.701 Vali Acc: 0.804 Test Loss: 0.701 Test Acc: 0.804
Validation loss decreased (-0.797094 --> -0.804341).  Saving model ...
Epoch: 30 cost time: 0.7194705009460449
Epoch: 30, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.706 Vali Acc: 0.797 Test Loss: 0.706 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5551245212554932
Epoch: 31, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.724 Vali Acc: 0.804 Test Loss: 0.724 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.5783088207244873
Epoch: 32, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.727 Vali Acc: 0.812 Test Loss: 0.727 Test Acc: 0.812
Validation loss decreased (-0.804341 --> -0.811587).  Saving model ...
Epoch: 33 cost time: 0.6637792587280273
Epoch: 33, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.740 Vali Acc: 0.812 Test Loss: 0.740 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.721088171005249
Epoch: 34, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.743 Vali Acc: 0.819 Test Loss: 0.743 Test Acc: 0.819
Validation loss decreased (-0.811587 --> -0.818833).  Saving model ...
Epoch: 35 cost time: 0.692359209060669
Epoch: 35, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.729 Vali Acc: 0.819 Test Loss: 0.729 Test Acc: 0.819
Validation loss decreased (-0.818833 --> -0.818833).  Saving model ...
Epoch: 36 cost time: 0.6917200088500977
Epoch: 36, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.735 Vali Acc: 0.819 Test Loss: 0.735 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.689335823059082
Epoch: 37, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.744 Vali Acc: 0.826 Test Loss: 0.744 Test Acc: 0.826
Validation loss decreased (-0.818833 --> -0.826080).  Saving model ...
Epoch: 38 cost time: 0.5884251594543457
Epoch: 38, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.789 Vali Acc: 0.812 Test Loss: 0.789 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.5272223949432373
Epoch: 39, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.782 Vali Acc: 0.826 Test Loss: 0.782 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.6039514541625977
Epoch: 40, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.758 Vali Acc: 0.848 Test Loss: 0.758 Test Acc: 0.848
Validation loss decreased (-0.826080 --> -0.847819).  Saving model ...
Epoch: 41 cost time: 0.6052279472351074
Epoch: 41, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.748 Vali Acc: 0.841 Test Loss: 0.748 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.6199531555175781
Epoch: 42, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.759 Vali Acc: 0.841 Test Loss: 0.759 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.6837301254272461
Epoch: 43, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.763 Vali Acc: 0.855 Test Loss: 0.763 Test Acc: 0.855
Validation loss decreased (-0.847819 --> -0.855065).  Saving model ...
Epoch: 44 cost time: 0.6841998100280762
Epoch: 44, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.762 Vali Acc: 0.862 Test Loss: 0.762 Test Acc: 0.862
Validation loss decreased (-0.855065 --> -0.862311).  Saving model ...
Epoch: 45 cost time: 0.6004581451416016
Epoch: 45, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.777 Vali Acc: 0.862 Test Loss: 0.777 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.7387757301330566
Epoch: 46, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.778 Vali Acc: 0.855 Test Loss: 0.778 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.5978503227233887
Epoch: 47, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.779 Vali Acc: 0.870 Test Loss: 0.779 Test Acc: 0.870
Validation loss decreased (-0.862311 --> -0.869557).  Saving model ...
Epoch: 48 cost time: 0.5286037921905518
Epoch: 48, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.802 Vali Acc: 0.862 Test Loss: 0.802 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.4968698024749756
Epoch: 49, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.796 Vali Acc: 0.877 Test Loss: 0.796 Test Acc: 0.877
Validation loss decreased (-0.869557 --> -0.876804).  Saving model ...
Epoch: 50 cost time: 0.5439634323120117
Epoch: 50, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.789 Vali Acc: 0.877 Test Loss: 0.789 Test Acc: 0.877
Validation loss decreased (-0.876804 --> -0.876804).  Saving model ...
Epoch: 51 cost time: 0.729794979095459
Epoch: 51, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.795 Vali Acc: 0.877 Test Loss: 0.795 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.6182446479797363
Epoch: 52, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.808 Vali Acc: 0.870 Test Loss: 0.808 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.5089387893676758
Epoch: 53, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.820 Vali Acc: 0.877 Test Loss: 0.820 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.6943151950836182
Epoch: 54, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.811 Vali Acc: 0.877 Test Loss: 0.811 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 0.8259422779083252
Epoch: 55, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.816 Vali Acc: 0.877 Test Loss: 0.816 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 0.6258087158203125
Epoch: 56, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.829 Vali Acc: 0.877 Test Loss: 0.829 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 0.5951154232025146
Epoch: 57, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.835 Vali Acc: 0.877 Test Loss: 0.835 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 0.49611473083496094
Epoch: 58, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.843 Vali Acc: 0.877 Test Loss: 0.843 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 0.593163013458252
Epoch: 59, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.854 Vali Acc: 0.884 Test Loss: 0.854 Test Acc: 0.884
Validation loss decreased (-0.876804 --> -0.884049).  Saving model ...
Epoch: 60 cost time: 0.6297013759613037
Epoch: 60, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.842 Vali Acc: 0.877 Test Loss: 0.842 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.5277111530303955
Epoch: 61, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.843 Vali Acc: 0.877 Test Loss: 0.843 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 0.7180345058441162
Epoch: 62, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.853 Vali Acc: 0.884 Test Loss: 0.853 Test Acc: 0.884
Validation loss decreased (-0.884049 --> -0.884049).  Saving model ...
Epoch: 63 cost time: 0.6064357757568359
Epoch: 63, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.866 Vali Acc: 0.877 Test Loss: 0.866 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.5977497100830078
Epoch: 64, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.871 Vali Acc: 0.877 Test Loss: 0.871 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.7033777236938477
Epoch: 65, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.878 Vali Acc: 0.877 Test Loss: 0.878 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 0.7171874046325684
Epoch: 66, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.879 Vali Acc: 0.877 Test Loss: 0.879 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 0.6674621105194092
Epoch: 67, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.878 Vali Acc: 0.877 Test Loss: 0.878 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 0.6949954032897949
Epoch: 68, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.883 Vali Acc: 0.870 Test Loss: 0.883 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 0.6768298149108887
Epoch: 69, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.894 Vali Acc: 0.870 Test Loss: 0.894 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 0.6203479766845703
Epoch: 70, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.894 Vali Acc: 0.870 Test Loss: 0.894 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 0.6318049430847168
Epoch: 71, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.897 Vali Acc: 0.870 Test Loss: 0.897 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 72 cost time: 0.7137763500213623
Epoch: 72, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.900 Vali Acc: 0.870 Test Loss: 0.900 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm128_cs30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 57872
model size : 0.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm128_cs26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.8939862251281738
Epoch: 1, Steps: 9 | Train Loss: 1.464 Vali Loss: 1.428 Vali Acc: 0.203 Test Loss: 1.428 Test Acc: 0.203
Validation loss decreased (inf --> -0.202884).  Saving model ...
Epoch: 2 cost time: 0.6724996566772461
Epoch: 2, Steps: 9 | Train Loss: 1.384 Vali Loss: 1.334 Vali Acc: 0.283 Test Loss: 1.334 Test Acc: 0.283
Validation loss decreased (-0.202884 --> -0.282595).  Saving model ...
Epoch: 3 cost time: 0.534597635269165
Epoch: 3, Steps: 9 | Train Loss: 1.264 Vali Loss: 1.234 Vali Acc: 0.435 Test Loss: 1.234 Test Acc: 0.435
Validation loss decreased (-0.282595 --> -0.434770).  Saving model ...
Epoch: 4 cost time: 0.5995595455169678
Epoch: 4, Steps: 9 | Train Loss: 1.156 Vali Loss: 1.154 Vali Acc: 0.464 Test Loss: 1.154 Test Acc: 0.464
Validation loss decreased (-0.434770 --> -0.463757).  Saving model ...
Epoch: 5 cost time: 0.5319716930389404
Epoch: 5, Steps: 9 | Train Loss: 1.068 Vali Loss: 1.105 Vali Acc: 0.449 Test Loss: 1.105 Test Acc: 0.449
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5564725399017334
Epoch: 6, Steps: 9 | Train Loss: 0.985 Vali Loss: 1.068 Vali Acc: 0.493 Test Loss: 1.068 Test Acc: 0.493
Validation loss decreased (-0.463757 --> -0.492743).  Saving model ...
Epoch: 7 cost time: 0.5162131786346436
Epoch: 7, Steps: 9 | Train Loss: 0.922 Vali Loss: 1.047 Vali Acc: 0.500 Test Loss: 1.047 Test Acc: 0.500
Validation loss decreased (-0.492743 --> -0.499990).  Saving model ...
Epoch: 8 cost time: 0.4741857051849365
Epoch: 8, Steps: 9 | Train Loss: 0.853 Vali Loss: 1.023 Vali Acc: 0.536 Test Loss: 1.023 Test Acc: 0.536
Validation loss decreased (-0.499990 --> -0.536222).  Saving model ...
Epoch: 9 cost time: 0.5278747081756592
Epoch: 9, Steps: 9 | Train Loss: 0.810 Vali Loss: 1.011 Vali Acc: 0.551 Test Loss: 1.011 Test Acc: 0.551
Validation loss decreased (-0.536222 --> -0.550715).  Saving model ...
Epoch: 10 cost time: 0.5697567462921143
Epoch: 10, Steps: 9 | Train Loss: 0.782 Vali Loss: 0.995 Vali Acc: 0.565 Test Loss: 0.995 Test Acc: 0.565
Validation loss decreased (-0.550715 --> -0.565207).  Saving model ...
Epoch: 11 cost time: 0.4532582759857178
Epoch: 11, Steps: 9 | Train Loss: 0.723 Vali Loss: 0.990 Vali Acc: 0.580 Test Loss: 0.990 Test Acc: 0.580
Validation loss decreased (-0.565207 --> -0.579700).  Saving model ...
Epoch: 12 cost time: 0.5137567520141602
Epoch: 12, Steps: 9 | Train Loss: 0.680 Vali Loss: 0.993 Vali Acc: 0.572 Test Loss: 0.993 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6277852058410645
Epoch: 13, Steps: 9 | Train Loss: 0.644 Vali Loss: 0.973 Vali Acc: 0.580 Test Loss: 0.973 Test Acc: 0.580
Validation loss decreased (-0.579700 --> -0.579700).  Saving model ...
Epoch: 14 cost time: 0.6199359893798828
Epoch: 14, Steps: 9 | Train Loss: 0.606 Vali Loss: 0.972 Vali Acc: 0.594 Test Loss: 0.972 Test Acc: 0.594
Validation loss decreased (-0.579700 --> -0.594193).  Saving model ...
Epoch: 15 cost time: 0.5815286636352539
Epoch: 15, Steps: 9 | Train Loss: 0.553 Vali Loss: 0.955 Vali Acc: 0.609 Test Loss: 0.955 Test Acc: 0.609
Validation loss decreased (-0.594193 --> -0.608686).  Saving model ...
Epoch: 16 cost time: 0.5252208709716797
Epoch: 16, Steps: 9 | Train Loss: 0.519 Vali Loss: 0.954 Vali Acc: 0.601 Test Loss: 0.954 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5969924926757812
Epoch: 17, Steps: 9 | Train Loss: 0.477 Vali Loss: 0.945 Vali Acc: 0.630 Test Loss: 0.945 Test Acc: 0.630
Validation loss decreased (-0.608686 --> -0.630425).  Saving model ...
Epoch: 18 cost time: 0.5255367755889893
Epoch: 18, Steps: 9 | Train Loss: 0.433 Vali Loss: 0.911 Vali Acc: 0.645 Test Loss: 0.911 Test Acc: 0.645
Validation loss decreased (-0.630425 --> -0.644918).  Saving model ...
Epoch: 19 cost time: 0.5484139919281006
Epoch: 19, Steps: 9 | Train Loss: 0.378 Vali Loss: 0.818 Vali Acc: 0.681 Test Loss: 0.818 Test Acc: 0.681
Validation loss decreased (-0.644918 --> -0.681151).  Saving model ...
Epoch: 20 cost time: 0.6284904479980469
Epoch: 20, Steps: 9 | Train Loss: 0.308 Vali Loss: 0.739 Vali Acc: 0.717 Test Loss: 0.739 Test Acc: 0.717
Validation loss decreased (-0.681151 --> -0.717384).  Saving model ...
Epoch: 21 cost time: 0.6202058792114258
Epoch: 21, Steps: 9 | Train Loss: 0.246 Vali Loss: 0.644 Vali Acc: 0.775 Test Loss: 0.644 Test Acc: 0.775
Validation loss decreased (-0.717384 --> -0.775356).  Saving model ...
Epoch: 22 cost time: 0.5353283882141113
Epoch: 22, Steps: 9 | Train Loss: 0.175 Vali Loss: 0.531 Vali Acc: 0.804 Test Loss: 0.531 Test Acc: 0.804
Validation loss decreased (-0.775356 --> -0.804343).  Saving model ...
Epoch: 23 cost time: 0.5670628547668457
Epoch: 23, Steps: 9 | Train Loss: 0.120 Vali Loss: 0.454 Vali Acc: 0.855 Test Loss: 0.454 Test Acc: 0.855
Validation loss decreased (-0.804343 --> -0.855068).  Saving model ...
Epoch: 24 cost time: 0.6527316570281982
Epoch: 24, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.387 Vali Acc: 0.870 Test Loss: 0.387 Test Acc: 0.870
Validation loss decreased (-0.855068 --> -0.869561).  Saving model ...
Epoch: 25 cost time: 0.5892038345336914
Epoch: 25, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.365 Vali Acc: 0.877 Test Loss: 0.365 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876808).  Saving model ...
Epoch: 26 cost time: 0.6312532424926758
Epoch: 26, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.323 Vali Acc: 0.891 Test Loss: 0.323 Test Acc: 0.891
Validation loss decreased (-0.876808 --> -0.891301).  Saving model ...
Epoch: 27 cost time: 0.5974867343902588
Epoch: 27, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.309 Vali Acc: 0.906 Test Loss: 0.309 Test Acc: 0.906
Validation loss decreased (-0.891301 --> -0.905794).  Saving model ...
Epoch: 28 cost time: 0.523695707321167
Epoch: 28, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.322 Vali Acc: 0.899 Test Loss: 0.322 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6016371250152588
Epoch: 29, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.315 Vali Acc: 0.906 Test Loss: 0.315 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.5932843685150146
Epoch: 30, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.270 Vali Acc: 0.906 Test Loss: 0.270 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 31 cost time: 0.5762386322021484
Epoch: 31, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.261 Vali Acc: 0.913 Test Loss: 0.261 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913041).  Saving model ...
Epoch: 32 cost time: 0.5311408042907715
Epoch: 32, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.293 Vali Acc: 0.906 Test Loss: 0.293 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.49895286560058594
Epoch: 33, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.283 Vali Acc: 0.906 Test Loss: 0.283 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.49007296562194824
Epoch: 34, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.263 Vali Acc: 0.906 Test Loss: 0.263 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.5041458606719971
Epoch: 35, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.276 Vali Acc: 0.906 Test Loss: 0.276 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.5477426052093506
Epoch: 36, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.283 Vali Acc: 0.913 Test Loss: 0.283 Test Acc: 0.913
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.6548643112182617
Epoch: 37, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.279 Vali Acc: 0.913 Test Loss: 0.279 Test Acc: 0.913
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.5514061450958252
Epoch: 38, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.264 Vali Acc: 0.913 Test Loss: 0.264 Test Acc: 0.913
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.6778333187103271
Epoch: 39, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.283 Vali Acc: 0.913 Test Loss: 0.283 Test Acc: 0.913
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.6616387367248535
Epoch: 40, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.269 Vali Acc: 0.913 Test Loss: 0.269 Test Acc: 0.913
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.6686992645263672
Epoch: 41, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.268 Vali Acc: 0.913 Test Loss: 0.268 Test Acc: 0.913
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm128_cs26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 57238
model size : 0.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm128_cs23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.8090894222259521
Epoch: 1, Steps: 9 | Train Loss: 1.405 Vali Loss: 1.400 Vali Acc: 0.326 Test Loss: 1.400 Test Acc: 0.326
Validation loss decreased (inf --> -0.326073).  Saving model ...
Epoch: 2 cost time: 0.6145844459533691
Epoch: 2, Steps: 9 | Train Loss: 1.342 Vali Loss: 1.312 Vali Acc: 0.355 Test Loss: 1.312 Test Acc: 0.355
Validation loss decreased (-0.326073 --> -0.355059).  Saving model ...
Epoch: 3 cost time: 0.5157289505004883
Epoch: 3, Steps: 9 | Train Loss: 1.232 Vali Loss: 1.219 Vali Acc: 0.406 Test Loss: 1.219 Test Acc: 0.406
Validation loss decreased (-0.355059 --> -0.405785).  Saving model ...
Epoch: 4 cost time: 0.5576813220977783
Epoch: 4, Steps: 9 | Train Loss: 1.135 Vali Loss: 1.142 Vali Acc: 0.413 Test Loss: 1.142 Test Acc: 0.413
Validation loss decreased (-0.405785 --> -0.413032).  Saving model ...
Epoch: 5 cost time: 0.5816216468811035
Epoch: 5, Steps: 9 | Train Loss: 1.049 Vali Loss: 1.095 Vali Acc: 0.435 Test Loss: 1.095 Test Acc: 0.435
Validation loss decreased (-0.413032 --> -0.434772).  Saving model ...
Epoch: 6 cost time: 0.6425185203552246
Epoch: 6, Steps: 9 | Train Loss: 0.986 Vali Loss: 1.075 Vali Acc: 0.471 Test Loss: 1.075 Test Acc: 0.471
Validation loss decreased (-0.434772 --> -0.471004).  Saving model ...
Epoch: 7 cost time: 0.6391046047210693
Epoch: 7, Steps: 9 | Train Loss: 0.930 Vali Loss: 1.050 Vali Acc: 0.478 Test Loss: 1.050 Test Acc: 0.478
Validation loss decreased (-0.471004 --> -0.478250).  Saving model ...
Epoch: 8 cost time: 0.5548467636108398
Epoch: 8, Steps: 9 | Train Loss: 0.873 Vali Loss: 1.031 Vali Acc: 0.500 Test Loss: 1.031 Test Acc: 0.500
Validation loss decreased (-0.478250 --> -0.499990).  Saving model ...
Epoch: 9 cost time: 0.5234649181365967
Epoch: 9, Steps: 9 | Train Loss: 0.819 Vali Loss: 1.018 Vali Acc: 0.500 Test Loss: 1.018 Test Acc: 0.500
Validation loss decreased (-0.499990 --> -0.499990).  Saving model ...
Epoch: 10 cost time: 0.6198663711547852
Epoch: 10, Steps: 9 | Train Loss: 0.785 Vali Loss: 1.007 Vali Acc: 0.507 Test Loss: 1.007 Test Acc: 0.507
Validation loss decreased (-0.499990 --> -0.507236).  Saving model ...
Epoch: 11 cost time: 0.6308836936950684
Epoch: 11, Steps: 9 | Train Loss: 0.722 Vali Loss: 1.006 Vali Acc: 0.478 Test Loss: 1.006 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6401236057281494
Epoch: 12, Steps: 9 | Train Loss: 0.688 Vali Loss: 1.007 Vali Acc: 0.493 Test Loss: 1.007 Test Acc: 0.493
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.559321403503418
Epoch: 13, Steps: 9 | Train Loss: 0.655 Vali Loss: 0.995 Vali Acc: 0.522 Test Loss: 0.995 Test Acc: 0.522
Validation loss decreased (-0.507236 --> -0.521729).  Saving model ...
Epoch: 14 cost time: 0.5488131046295166
Epoch: 14, Steps: 9 | Train Loss: 0.624 Vali Loss: 0.988 Vali Acc: 0.536 Test Loss: 0.988 Test Acc: 0.536
Validation loss decreased (-0.521729 --> -0.536222).  Saving model ...
Epoch: 15 cost time: 0.5875823497772217
Epoch: 15, Steps: 9 | Train Loss: 0.582 Vali Loss: 0.999 Vali Acc: 0.522 Test Loss: 0.999 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6271073818206787
Epoch: 16, Steps: 9 | Train Loss: 0.538 Vali Loss: 1.004 Vali Acc: 0.536 Test Loss: 1.004 Test Acc: 0.536
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6595213413238525
Epoch: 17, Steps: 9 | Train Loss: 0.494 Vali Loss: 1.002 Vali Acc: 0.587 Test Loss: 1.002 Test Acc: 0.587
Validation loss decreased (-0.536222 --> -0.586946).  Saving model ...
Epoch: 18 cost time: 0.545081377029419
Epoch: 18, Steps: 9 | Train Loss: 0.481 Vali Loss: 1.004 Vali Acc: 0.594 Test Loss: 1.004 Test Acc: 0.594
Validation loss decreased (-0.586946 --> -0.594193).  Saving model ...
Epoch: 19 cost time: 0.5504932403564453
Epoch: 19, Steps: 9 | Train Loss: 0.433 Vali Loss: 1.000 Vali Acc: 0.580 Test Loss: 1.000 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5468368530273438
Epoch: 20, Steps: 9 | Train Loss: 0.411 Vali Loss: 1.032 Vali Acc: 0.551 Test Loss: 1.032 Test Acc: 0.551
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6274828910827637
Epoch: 21, Steps: 9 | Train Loss: 0.364 Vali Loss: 1.010 Vali Acc: 0.587 Test Loss: 1.010 Test Acc: 0.587
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.49823570251464844
Epoch: 22, Steps: 9 | Train Loss: 0.332 Vali Loss: 1.006 Vali Acc: 0.616 Test Loss: 1.006 Test Acc: 0.616
Validation loss decreased (-0.594193 --> -0.615932).  Saving model ...
Epoch: 23 cost time: 0.5357346534729004
Epoch: 23, Steps: 9 | Train Loss: 0.314 Vali Loss: 1.002 Vali Acc: 0.616 Test Loss: 1.002 Test Acc: 0.616
Validation loss decreased (-0.615932 --> -0.615932).  Saving model ...
Epoch: 24 cost time: 0.5833537578582764
Epoch: 24, Steps: 9 | Train Loss: 0.264 Vali Loss: 1.036 Vali Acc: 0.623 Test Loss: 1.036 Test Acc: 0.623
Validation loss decreased (-0.615932 --> -0.623178).  Saving model ...
Epoch: 25 cost time: 0.5390512943267822
Epoch: 25, Steps: 9 | Train Loss: 0.234 Vali Loss: 1.023 Vali Acc: 0.630 Test Loss: 1.023 Test Acc: 0.630
Validation loss decreased (-0.623178 --> -0.630425).  Saving model ...
Epoch: 26 cost time: 0.5032498836517334
Epoch: 26, Steps: 9 | Train Loss: 0.201 Vali Loss: 0.980 Vali Acc: 0.667 Test Loss: 0.980 Test Acc: 0.667
Validation loss decreased (-0.630425 --> -0.666657).  Saving model ...
Epoch: 27 cost time: 0.507990837097168
Epoch: 27, Steps: 9 | Train Loss: 0.171 Vali Loss: 0.985 Vali Acc: 0.681 Test Loss: 0.985 Test Acc: 0.681
Validation loss decreased (-0.666657 --> -0.681150).  Saving model ...
Epoch: 28 cost time: 0.5489680767059326
Epoch: 28, Steps: 9 | Train Loss: 0.138 Vali Loss: 0.955 Vali Acc: 0.710 Test Loss: 0.955 Test Acc: 0.710
Validation loss decreased (-0.681150 --> -0.710135).  Saving model ...
Epoch: 29 cost time: 0.652991533279419
Epoch: 29, Steps: 9 | Train Loss: 0.119 Vali Loss: 0.926 Vali Acc: 0.717 Test Loss: 0.926 Test Acc: 0.717
Validation loss decreased (-0.710135 --> -0.717382).  Saving model ...
Epoch: 30 cost time: 0.6408884525299072
Epoch: 30, Steps: 9 | Train Loss: 0.097 Vali Loss: 0.909 Vali Acc: 0.710 Test Loss: 0.909 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.48416686058044434
Epoch: 31, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.868 Vali Acc: 0.725 Test Loss: 0.868 Test Acc: 0.725
Validation loss decreased (-0.717382 --> -0.724629).  Saving model ...
Epoch: 32 cost time: 0.6597294807434082
Epoch: 32, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.855 Vali Acc: 0.710 Test Loss: 0.855 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.6056113243103027
Epoch: 33, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.838 Vali Acc: 0.717 Test Loss: 0.838 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.5393719673156738
Epoch: 34, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.832 Vali Acc: 0.710 Test Loss: 0.832 Test Acc: 0.710
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.5982034206390381
Epoch: 35, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.806 Vali Acc: 0.725 Test Loss: 0.806 Test Acc: 0.725
Validation loss decreased (-0.724629 --> -0.724630).  Saving model ...
Epoch: 36 cost time: 0.5557003021240234
Epoch: 36, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.795 Vali Acc: 0.725 Test Loss: 0.795 Test Acc: 0.725
Validation loss decreased (-0.724630 --> -0.724630).  Saving model ...
Epoch: 37 cost time: 0.5629997253417969
Epoch: 37, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.786 Vali Acc: 0.725 Test Loss: 0.786 Test Acc: 0.725
Validation loss decreased (-0.724630 --> -0.724630).  Saving model ...
Epoch: 38 cost time: 0.5097854137420654
Epoch: 38, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.765 Vali Acc: 0.746 Test Loss: 0.765 Test Acc: 0.746
Validation loss decreased (-0.724630 --> -0.746369).  Saving model ...
Epoch: 39 cost time: 0.6206004619598389
Epoch: 39, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.775 Vali Acc: 0.739 Test Loss: 0.775 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.5865309238433838
Epoch: 40, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.773 Vali Acc: 0.746 Test Loss: 0.773 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.6999003887176514
Epoch: 41, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.765 Vali Acc: 0.746 Test Loss: 0.765 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.6394639015197754
Epoch: 42, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.751 Vali Acc: 0.746 Test Loss: 0.751 Test Acc: 0.746
Validation loss decreased (-0.746369 --> -0.746369).  Saving model ...
Epoch: 43 cost time: 0.5170536041259766
Epoch: 43, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.756 Vali Acc: 0.754 Test Loss: 0.756 Test Acc: 0.754
Validation loss decreased (-0.746369 --> -0.753616).  Saving model ...
Epoch: 44 cost time: 0.6036148071289062
Epoch: 44, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.744 Vali Acc: 0.754 Test Loss: 0.744 Test Acc: 0.754
Validation loss decreased (-0.753616 --> -0.753616).  Saving model ...
Epoch: 45 cost time: 0.6275384426116943
Epoch: 45, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.745 Vali Acc: 0.754 Test Loss: 0.745 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.6535131931304932
Epoch: 46, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.742 Vali Acc: 0.761 Test Loss: 0.742 Test Acc: 0.761
Validation loss decreased (-0.753616 --> -0.760862).  Saving model ...
Epoch: 47 cost time: 0.6141529083251953
Epoch: 47, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.742 Vali Acc: 0.761 Test Loss: 0.742 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.6316330432891846
Epoch: 48, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.743 Vali Acc: 0.761 Test Loss: 0.743 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.6911861896514893
Epoch: 49, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.735 Vali Acc: 0.761 Test Loss: 0.735 Test Acc: 0.761
Validation loss decreased (-0.760862 --> -0.760862).  Saving model ...
Epoch: 50 cost time: 0.6418824195861816
Epoch: 50, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.749 Vali Acc: 0.754 Test Loss: 0.749 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.7077853679656982
Epoch: 51, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.736 Vali Acc: 0.775 Test Loss: 0.736 Test Acc: 0.775
Validation loss decreased (-0.760862 --> -0.775355).  Saving model ...
Epoch: 52 cost time: 0.6484899520874023
Epoch: 52, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.725 Vali Acc: 0.783 Test Loss: 0.725 Test Acc: 0.783
Validation loss decreased (-0.775355 --> -0.782601).  Saving model ...
Epoch: 53 cost time: 0.6024353504180908
Epoch: 53, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.730 Vali Acc: 0.775 Test Loss: 0.730 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.6984386444091797
Epoch: 54, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.731 Vali Acc: 0.783 Test Loss: 0.731 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.787156343460083
Epoch: 55, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.724 Vali Acc: 0.783 Test Loss: 0.724 Test Acc: 0.783
Validation loss decreased (-0.782601 --> -0.782601).  Saving model ...
Epoch: 56 cost time: 0.704143762588501
Epoch: 56, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.733 Vali Acc: 0.775 Test Loss: 0.733 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.6315674781799316
Epoch: 57, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.730 Vali Acc: 0.783 Test Loss: 0.730 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.6029026508331299
Epoch: 58, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.724 Vali Acc: 0.790 Test Loss: 0.724 Test Acc: 0.790
Validation loss decreased (-0.782601 --> -0.789848).  Saving model ...
Epoch: 59 cost time: 0.6481859683990479
Epoch: 59, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.720 Vali Acc: 0.783 Test Loss: 0.720 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.5888934135437012
Epoch: 60, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.717 Vali Acc: 0.790 Test Loss: 0.717 Test Acc: 0.790
Validation loss decreased (-0.789848 --> -0.789848).  Saving model ...
Epoch: 61 cost time: 0.598109245300293
Epoch: 61, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.722 Vali Acc: 0.790 Test Loss: 0.722 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.6046953201293945
Epoch: 62, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.726 Vali Acc: 0.797 Test Loss: 0.726 Test Acc: 0.797
Validation loss decreased (-0.789848 --> -0.797094).  Saving model ...
Epoch: 63 cost time: 0.7152760028839111
Epoch: 63, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.719 Vali Acc: 0.804 Test Loss: 0.719 Test Acc: 0.804
Validation loss decreased (-0.797094 --> -0.804341).  Saving model ...
Epoch: 64 cost time: 0.6105401515960693
Epoch: 64, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.719 Vali Acc: 0.804 Test Loss: 0.719 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.5853583812713623
Epoch: 65, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.723 Vali Acc: 0.812 Test Loss: 0.723 Test Acc: 0.812
Validation loss decreased (-0.804341 --> -0.811587).  Saving model ...
Epoch: 66 cost time: 0.5539681911468506
Epoch: 66, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.723 Vali Acc: 0.812 Test Loss: 0.723 Test Acc: 0.812
Validation loss decreased (-0.811587 --> -0.811587).  Saving model ...
Epoch: 67 cost time: 0.6374263763427734
Epoch: 67, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.726 Vali Acc: 0.812 Test Loss: 0.726 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.5379672050476074
Epoch: 68, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.725 Vali Acc: 0.812 Test Loss: 0.725 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.6022641658782959
Epoch: 69, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.728 Vali Acc: 0.812 Test Loss: 0.728 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 0.5985546112060547
Epoch: 70, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.723 Vali Acc: 0.804 Test Loss: 0.723 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 0.5766470432281494
Epoch: 71, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.726 Vali Acc: 0.804 Test Loss: 0.726 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 0.6292965412139893
Epoch: 72, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.729 Vali Acc: 0.804 Test Loss: 0.729 Test Acc: 0.804
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 0.5934348106384277
Epoch: 73, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.730 Vali Acc: 0.812 Test Loss: 0.730 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 0.5318961143493652
Epoch: 74, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.722 Vali Acc: 0.804 Test Loss: 0.722 Test Acc: 0.804
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 0.5393807888031006
Epoch: 75, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.720 Vali Acc: 0.804 Test Loss: 0.720 Test Acc: 0.804
EarlyStopping counter: 9 out of 10
Epoch: 76 cost time: 0.6155703067779541
Epoch: 76, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.723 Vali Acc: 0.804 Test Loss: 0.723 Test Acc: 0.804
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm128_cs23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8115942028985508
model parameter : 56878
model size : 0.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm128_cs21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.7300097942352295
Epoch: 1, Steps: 9 | Train Loss: 1.377 Vali Loss: 1.384 Vali Acc: 0.261 Test Loss: 1.384 Test Acc: 0.261
Validation loss decreased (inf --> -0.260856).  Saving model ...
Epoch: 2 cost time: 0.6476747989654541
Epoch: 2, Steps: 9 | Train Loss: 1.306 Vali Loss: 1.307 Vali Acc: 0.326 Test Loss: 1.307 Test Acc: 0.326
Validation loss decreased (-0.260856 --> -0.326074).  Saving model ...
Epoch: 3 cost time: 0.5647172927856445
Epoch: 3, Steps: 9 | Train Loss: 1.213 Vali Loss: 1.224 Vali Acc: 0.420 Test Loss: 1.224 Test Acc: 0.420
Validation loss decreased (-0.326074 --> -0.420278).  Saving model ...
Epoch: 4 cost time: 0.5389821529388428
Epoch: 4, Steps: 9 | Train Loss: 1.119 Vali Loss: 1.158 Vali Acc: 0.442 Test Loss: 1.158 Test Acc: 0.442
Validation loss decreased (-0.420278 --> -0.442017).  Saving model ...
Epoch: 5 cost time: 0.6208171844482422
Epoch: 5, Steps: 9 | Train Loss: 1.034 Vali Loss: 1.113 Vali Acc: 0.464 Test Loss: 1.113 Test Acc: 0.464
Validation loss decreased (-0.442017 --> -0.463757).  Saving model ...
Epoch: 6 cost time: 0.49532651901245117
Epoch: 6, Steps: 9 | Train Loss: 0.977 Vali Loss: 1.095 Vali Acc: 0.464 Test Loss: 1.095 Test Acc: 0.464
Validation loss decreased (-0.463757 --> -0.463757).  Saving model ...
Epoch: 7 cost time: 0.5000262260437012
Epoch: 7, Steps: 9 | Train Loss: 0.906 Vali Loss: 1.074 Vali Acc: 0.471 Test Loss: 1.074 Test Acc: 0.471
Validation loss decreased (-0.463757 --> -0.471004).  Saving model ...
Epoch: 8 cost time: 0.5702638626098633
Epoch: 8, Steps: 9 | Train Loss: 0.868 Vali Loss: 1.059 Vali Acc: 0.464 Test Loss: 1.059 Test Acc: 0.464
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5515849590301514
Epoch: 9, Steps: 9 | Train Loss: 0.804 Vali Loss: 1.036 Vali Acc: 0.500 Test Loss: 1.036 Test Acc: 0.500
Validation loss decreased (-0.471004 --> -0.499990).  Saving model ...
Epoch: 10 cost time: 0.5363185405731201
Epoch: 10, Steps: 9 | Train Loss: 0.770 Vali Loss: 1.019 Vali Acc: 0.514 Test Loss: 1.019 Test Acc: 0.514
Validation loss decreased (-0.499990 --> -0.514483).  Saving model ...
Epoch: 11 cost time: 0.5564777851104736
Epoch: 11, Steps: 9 | Train Loss: 0.730 Vali Loss: 1.009 Vali Acc: 0.522 Test Loss: 1.009 Test Acc: 0.522
Validation loss decreased (-0.514483 --> -0.521729).  Saving model ...
Epoch: 12 cost time: 0.6452326774597168
Epoch: 12, Steps: 9 | Train Loss: 0.673 Vali Loss: 0.997 Vali Acc: 0.543 Test Loss: 0.997 Test Acc: 0.543
Validation loss decreased (-0.521729 --> -0.543468).  Saving model ...
Epoch: 13 cost time: 0.5553734302520752
Epoch: 13, Steps: 9 | Train Loss: 0.645 Vali Loss: 0.998 Vali Acc: 0.565 Test Loss: 0.998 Test Acc: 0.565
Validation loss decreased (-0.543468 --> -0.565207).  Saving model ...
Epoch: 14 cost time: 0.6861650943756104
Epoch: 14, Steps: 9 | Train Loss: 0.581 Vali Loss: 0.977 Vali Acc: 0.536 Test Loss: 0.977 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7165403366088867
Epoch: 15, Steps: 9 | Train Loss: 0.537 Vali Loss: 0.966 Vali Acc: 0.565 Test Loss: 0.966 Test Acc: 0.565
Validation loss decreased (-0.565207 --> -0.565208).  Saving model ...
Epoch: 16 cost time: 0.5565285682678223
Epoch: 16, Steps: 9 | Train Loss: 0.498 Vali Loss: 0.951 Vali Acc: 0.616 Test Loss: 0.951 Test Acc: 0.616
Validation loss decreased (-0.565208 --> -0.615933).  Saving model ...
Epoch: 17 cost time: 0.7087199687957764
Epoch: 17, Steps: 9 | Train Loss: 0.451 Vali Loss: 0.912 Vali Acc: 0.623 Test Loss: 0.912 Test Acc: 0.623
Validation loss decreased (-0.615933 --> -0.623179).  Saving model ...
Epoch: 18 cost time: 0.6269881725311279
Epoch: 18, Steps: 9 | Train Loss: 0.398 Vali Loss: 0.838 Vali Acc: 0.667 Test Loss: 0.838 Test Acc: 0.667
Validation loss decreased (-0.623179 --> -0.666658).  Saving model ...
Epoch: 19 cost time: 0.5680198669433594
Epoch: 19, Steps: 9 | Train Loss: 0.307 Vali Loss: 0.729 Vali Acc: 0.717 Test Loss: 0.729 Test Acc: 0.717
Validation loss decreased (-0.666658 --> -0.717384).  Saving model ...
Epoch: 20 cost time: 0.7951207160949707
Epoch: 20, Steps: 9 | Train Loss: 0.227 Vali Loss: 0.610 Vali Acc: 0.783 Test Loss: 0.610 Test Acc: 0.783
Validation loss decreased (-0.717384 --> -0.782603).  Saving model ...
Epoch: 21 cost time: 0.6211013793945312
Epoch: 21, Steps: 9 | Train Loss: 0.164 Vali Loss: 0.488 Vali Acc: 0.819 Test Loss: 0.488 Test Acc: 0.819
Validation loss decreased (-0.782603 --> -0.818836).  Saving model ...
Epoch: 22 cost time: 0.6358397006988525
Epoch: 22, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.402 Vali Acc: 0.848 Test Loss: 0.402 Test Acc: 0.848
Validation loss decreased (-0.818836 --> -0.847822).  Saving model ...
Epoch: 23 cost time: 0.6475117206573486
Epoch: 23, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.380 Vali Acc: 0.841 Test Loss: 0.380 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6035003662109375
Epoch: 24, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.331 Vali Acc: 0.870 Test Loss: 0.331 Test Acc: 0.870
Validation loss decreased (-0.847822 --> -0.869562).  Saving model ...
Epoch: 25 cost time: 0.6494097709655762
Epoch: 25, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.308 Vali Acc: 0.862 Test Loss: 0.308 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5688564777374268
Epoch: 26, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.323 Vali Acc: 0.862 Test Loss: 0.323 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6457726955413818
Epoch: 27, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.299 Vali Acc: 0.877 Test Loss: 0.299 Test Acc: 0.877
Validation loss decreased (-0.869562 --> -0.876809).  Saving model ...
Epoch: 28 cost time: 0.47867655754089355
Epoch: 28, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.253 Vali Acc: 0.884 Test Loss: 0.253 Test Acc: 0.884
Validation loss decreased (-0.876809 --> -0.884055).  Saving model ...
Epoch: 29 cost time: 0.5819830894470215
Epoch: 29, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.259 Vali Acc: 0.891 Test Loss: 0.259 Test Acc: 0.891
Validation loss decreased (-0.884055 --> -0.891302).  Saving model ...
Epoch: 30 cost time: 0.6632661819458008
Epoch: 30, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.253 Vali Acc: 0.891 Test Loss: 0.253 Test Acc: 0.891
Validation loss decreased (-0.891302 --> -0.891302).  Saving model ...
Epoch: 31 cost time: 0.5541377067565918
Epoch: 31, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.247 Vali Acc: 0.891 Test Loss: 0.247 Test Acc: 0.891
Validation loss decreased (-0.891302 --> -0.891302).  Saving model ...
Epoch: 32 cost time: 0.6568789482116699
Epoch: 32, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.209 Vali Acc: 0.942 Test Loss: 0.209 Test Acc: 0.942
Validation loss decreased (-0.891302 --> -0.942027).  Saving model ...
Epoch: 33 cost time: 0.6496822834014893
Epoch: 33, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.263 Vali Acc: 0.891 Test Loss: 0.263 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5495355129241943
Epoch: 34, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.224 Vali Acc: 0.928 Test Loss: 0.224 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.5948641300201416
Epoch: 35, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.187 Vali Acc: 0.949 Test Loss: 0.187 Test Acc: 0.949
Validation loss decreased (-0.942027 --> -0.949273).  Saving model ...
Epoch: 36 cost time: 0.5961360931396484
Epoch: 36, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.193 Vali Acc: 0.949 Test Loss: 0.193 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.6011383533477783
Epoch: 37, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.216 Vali Acc: 0.928 Test Loss: 0.216 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.5428566932678223
Epoch: 38, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.206 Vali Acc: 0.928 Test Loss: 0.206 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.7032341957092285
Epoch: 39, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.188 Vali Acc: 0.957 Test Loss: 0.188 Test Acc: 0.957
Validation loss decreased (-0.949273 --> -0.956520).  Saving model ...
Epoch: 40 cost time: 0.6034250259399414
Epoch: 40, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.184 Vali Acc: 0.957 Test Loss: 0.184 Test Acc: 0.957
Validation loss decreased (-0.956520 --> -0.956520).  Saving model ...
Epoch: 41 cost time: 0.5360188484191895
Epoch: 41, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.179 Vali Acc: 0.964 Test Loss: 0.179 Test Acc: 0.964
Validation loss decreased (-0.956520 --> -0.963766).  Saving model ...
Epoch: 42 cost time: 0.5929982662200928
Epoch: 42, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.181 Vali Acc: 0.957 Test Loss: 0.181 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.734316349029541
Epoch: 43, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.189 Vali Acc: 0.949 Test Loss: 0.189 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.5514490604400635
Epoch: 44, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.188 Vali Acc: 0.949 Test Loss: 0.188 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.62158203125
Epoch: 45, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.176 Vali Acc: 0.964 Test Loss: 0.176 Test Acc: 0.964
Validation loss decreased (-0.963766 --> -0.963766).  Saving model ...
Epoch: 46 cost time: 0.6559534072875977
Epoch: 46, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.173 Vali Acc: 0.964 Test Loss: 0.173 Test Acc: 0.964
Validation loss decreased (-0.963766 --> -0.963766).  Saving model ...
Epoch: 47 cost time: 0.5866494178771973
Epoch: 47, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.189 Vali Acc: 0.949 Test Loss: 0.189 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.7545318603515625
Epoch: 48, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.178 Vali Acc: 0.964 Test Loss: 0.178 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.633934497833252
Epoch: 49, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.172 Vali Acc: 0.964 Test Loss: 0.172 Test Acc: 0.964
Validation loss decreased (-0.963766 --> -0.963766).  Saving model ...
Epoch: 50 cost time: 0.5612852573394775
Epoch: 50, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.165 Vali Acc: 0.971 Test Loss: 0.165 Test Acc: 0.971
Validation loss decreased (-0.963766 --> -0.971013).  Saving model ...
Epoch: 51 cost time: 0.5567750930786133
Epoch: 51, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.176 Vali Acc: 0.964 Test Loss: 0.176 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.6487185955047607
Epoch: 52, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.182 Vali Acc: 0.964 Test Loss: 0.182 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.662804126739502
Epoch: 53, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.171 Vali Acc: 0.964 Test Loss: 0.171 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.5283739566802979
Epoch: 54, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.964 Test Loss: 0.173 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 0.5687065124511719
Epoch: 55, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.163 Vali Acc: 0.964 Test Loss: 0.163 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 0.5720531940460205
Epoch: 56, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.964 Test Loss: 0.179 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 0.621363639831543
Epoch: 57, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.964 Test Loss: 0.178 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 0.663588285446167
Epoch: 58, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.964 Test Loss: 0.175 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 0.6308784484863281
Epoch: 59, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.964 Test Loss: 0.168 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 0.6030690670013428
Epoch: 60, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.964 Test Loss: 0.173 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm128_cs21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9710144927536232
model parameter : 57410
model size : 0.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm128_cs19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.7598953247070312
Epoch: 1, Steps: 9 | Train Loss: 1.379 Vali Loss: 1.361 Vali Acc: 0.254 Test Loss: 1.361 Test Acc: 0.254
Validation loss decreased (inf --> -0.253610).  Saving model ...
Epoch: 2 cost time: 0.5945441722869873
Epoch: 2, Steps: 9 | Train Loss: 1.310 Vali Loss: 1.281 Vali Acc: 0.384 Test Loss: 1.281 Test Acc: 0.384
Validation loss decreased (-0.253610 --> -0.384045).  Saving model ...
Epoch: 3 cost time: 0.5732085704803467
Epoch: 3, Steps: 9 | Train Loss: 1.215 Vali Loss: 1.198 Vali Acc: 0.428 Test Loss: 1.198 Test Acc: 0.428
Validation loss decreased (-0.384045 --> -0.427524).  Saving model ...
Epoch: 4 cost time: 0.5655884742736816
Epoch: 4, Steps: 9 | Train Loss: 1.118 Vali Loss: 1.133 Vali Acc: 0.457 Test Loss: 1.133 Test Acc: 0.457
Validation loss decreased (-0.427524 --> -0.456510).  Saving model ...
Epoch: 5 cost time: 0.5587587356567383
Epoch: 5, Steps: 9 | Train Loss: 1.028 Vali Loss: 1.094 Vali Acc: 0.464 Test Loss: 1.094 Test Acc: 0.464
Validation loss decreased (-0.456510 --> -0.463757).  Saving model ...
Epoch: 6 cost time: 0.5869359970092773
Epoch: 6, Steps: 9 | Train Loss: 0.957 Vali Loss: 1.061 Vali Acc: 0.471 Test Loss: 1.061 Test Acc: 0.471
Validation loss decreased (-0.463757 --> -0.471004).  Saving model ...
Epoch: 7 cost time: 0.5191068649291992
Epoch: 7, Steps: 9 | Train Loss: 0.897 Vali Loss: 1.038 Vali Acc: 0.486 Test Loss: 1.038 Test Acc: 0.486
Validation loss decreased (-0.471004 --> -0.485497).  Saving model ...
Epoch: 8 cost time: 0.5698494911193848
Epoch: 8, Steps: 9 | Train Loss: 0.829 Vali Loss: 1.016 Vali Acc: 0.493 Test Loss: 1.016 Test Acc: 0.493
Validation loss decreased (-0.485497 --> -0.492743).  Saving model ...
Epoch: 9 cost time: 0.5610651969909668
Epoch: 9, Steps: 9 | Train Loss: 0.777 Vali Loss: 0.991 Vali Acc: 0.536 Test Loss: 0.991 Test Acc: 0.536
Validation loss decreased (-0.492743 --> -0.536222).  Saving model ...
Epoch: 10 cost time: 0.647789716720581
Epoch: 10, Steps: 9 | Train Loss: 0.718 Vali Loss: 0.972 Vali Acc: 0.543 Test Loss: 0.972 Test Acc: 0.543
Validation loss decreased (-0.536222 --> -0.543469).  Saving model ...
Epoch: 11 cost time: 0.6586337089538574
Epoch: 11, Steps: 9 | Train Loss: 0.680 Vali Loss: 0.956 Vali Acc: 0.580 Test Loss: 0.956 Test Acc: 0.580
Validation loss decreased (-0.543469 --> -0.579701).  Saving model ...
Epoch: 12 cost time: 0.5812408924102783
Epoch: 12, Steps: 9 | Train Loss: 0.633 Vali Loss: 0.934 Vali Acc: 0.601 Test Loss: 0.934 Test Acc: 0.601
Validation loss decreased (-0.579701 --> -0.601440).  Saving model ...
Epoch: 13 cost time: 0.5814623832702637
Epoch: 13, Steps: 9 | Train Loss: 0.565 Vali Loss: 0.887 Vali Acc: 0.623 Test Loss: 0.887 Test Acc: 0.623
Validation loss decreased (-0.601440 --> -0.623180).  Saving model ...
Epoch: 14 cost time: 0.6301488876342773
Epoch: 14, Steps: 9 | Train Loss: 0.485 Vali Loss: 0.824 Vali Acc: 0.659 Test Loss: 0.824 Test Acc: 0.659
Validation loss decreased (-0.623180 --> -0.659412).  Saving model ...
Epoch: 15 cost time: 0.5012671947479248
Epoch: 15, Steps: 9 | Train Loss: 0.393 Vali Loss: 0.744 Vali Acc: 0.746 Test Loss: 0.744 Test Acc: 0.746
Validation loss decreased (-0.659412 --> -0.746369).  Saving model ...
Epoch: 16 cost time: 0.7332944869995117
Epoch: 16, Steps: 9 | Train Loss: 0.317 Vali Loss: 0.646 Vali Acc: 0.768 Test Loss: 0.646 Test Acc: 0.768
Validation loss decreased (-0.746369 --> -0.768109).  Saving model ...
Epoch: 17 cost time: 0.539975643157959
Epoch: 17, Steps: 9 | Train Loss: 0.245 Vali Loss: 0.568 Vali Acc: 0.768 Test Loss: 0.568 Test Acc: 0.768
Validation loss decreased (-0.768109 --> -0.768110).  Saving model ...
Epoch: 18 cost time: 0.5598490238189697
Epoch: 18, Steps: 9 | Train Loss: 0.193 Vali Loss: 0.512 Vali Acc: 0.804 Test Loss: 0.512 Test Acc: 0.804
Validation loss decreased (-0.768110 --> -0.804343).  Saving model ...
Epoch: 19 cost time: 0.5978798866271973
Epoch: 19, Steps: 9 | Train Loss: 0.145 Vali Loss: 0.462 Vali Acc: 0.797 Test Loss: 0.462 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6591284275054932
Epoch: 20, Steps: 9 | Train Loss: 0.125 Vali Loss: 0.442 Vali Acc: 0.819 Test Loss: 0.442 Test Acc: 0.819
Validation loss decreased (-0.804343 --> -0.818836).  Saving model ...
Epoch: 21 cost time: 0.5204546451568604
Epoch: 21, Steps: 9 | Train Loss: 0.089 Vali Loss: 0.447 Vali Acc: 0.841 Test Loss: 0.447 Test Acc: 0.841
Validation loss decreased (-0.818836 --> -0.840575).  Saving model ...
Epoch: 22 cost time: 0.6186697483062744
Epoch: 22, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.426 Vali Acc: 0.848 Test Loss: 0.426 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847822).  Saving model ...
Epoch: 23 cost time: 0.5097920894622803
Epoch: 23, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.385 Vali Acc: 0.848 Test Loss: 0.385 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 24 cost time: 0.4922323226928711
Epoch: 24, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.364 Vali Acc: 0.862 Test Loss: 0.364 Test Acc: 0.862
Validation loss decreased (-0.847822 --> -0.862315).  Saving model ...
Epoch: 25 cost time: 0.5361194610595703
Epoch: 25, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.362 Vali Acc: 0.877 Test Loss: 0.362 Test Acc: 0.877
Validation loss decreased (-0.862315 --> -0.876808).  Saving model ...
Epoch: 26 cost time: 0.5021350383758545
Epoch: 26, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.365 Vali Acc: 0.870 Test Loss: 0.365 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.4976835250854492
Epoch: 27, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.360 Vali Acc: 0.870 Test Loss: 0.360 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.4979984760284424
Epoch: 28, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.342 Vali Acc: 0.877 Test Loss: 0.342 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 29 cost time: 0.5701448917388916
Epoch: 29, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.325 Vali Acc: 0.899 Test Loss: 0.325 Test Acc: 0.899
Validation loss decreased (-0.876808 --> -0.898547).  Saving model ...
Epoch: 30 cost time: 0.5434889793395996
Epoch: 30, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.331 Vali Acc: 0.891 Test Loss: 0.331 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5810000896453857
Epoch: 31, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.345 Vali Acc: 0.877 Test Loss: 0.345 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8833520412445068
Epoch: 32, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.350 Vali Acc: 0.877 Test Loss: 0.350 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.5893669128417969
Epoch: 33, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.336 Vali Acc: 0.906 Test Loss: 0.336 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905794).  Saving model ...
Epoch: 34 cost time: 0.6620957851409912
Epoch: 34, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.328 Vali Acc: 0.899 Test Loss: 0.328 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.6834864616394043
Epoch: 35, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.329 Vali Acc: 0.891 Test Loss: 0.329 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.5701584815979004
Epoch: 36, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.327 Vali Acc: 0.899 Test Loss: 0.327 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.678962230682373
Epoch: 37, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.320 Vali Acc: 0.906 Test Loss: 0.320 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 38 cost time: 0.6344890594482422
Epoch: 38, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.322 Vali Acc: 0.906 Test Loss: 0.322 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.560819149017334
Epoch: 39, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.327 Vali Acc: 0.906 Test Loss: 0.327 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.6975624561309814
Epoch: 40, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.328 Vali Acc: 0.906 Test Loss: 0.328 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.6966006755828857
Epoch: 41, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.329 Vali Acc: 0.906 Test Loss: 0.329 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.6684718132019043
Epoch: 42, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.320 Vali Acc: 0.906 Test Loss: 0.320 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 43 cost time: 0.6057741641998291
Epoch: 43, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.314 Vali Acc: 0.906 Test Loss: 0.314 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 44 cost time: 0.6048452854156494
Epoch: 44, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.318 Vali Acc: 0.906 Test Loss: 0.318 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.7182443141937256
Epoch: 45, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.317 Vali Acc: 0.906 Test Loss: 0.317 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.6211776733398438
Epoch: 46, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.321 Vali Acc: 0.906 Test Loss: 0.321 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.6330270767211914
Epoch: 47, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.313 Vali Acc: 0.920 Test Loss: 0.313 Test Acc: 0.920
Validation loss decreased (-0.905794 --> -0.920287).  Saving model ...
Epoch: 48 cost time: 0.5923469066619873
Epoch: 48, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.314 Vali Acc: 0.920 Test Loss: 0.314 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.6286709308624268
Epoch: 49, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.312 Vali Acc: 0.928 Test Loss: 0.312 Test Acc: 0.928
Validation loss decreased (-0.920287 --> -0.927533).  Saving model ...
Epoch: 50 cost time: 0.6305716037750244
Epoch: 50, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.311 Vali Acc: 0.928 Test Loss: 0.311 Test Acc: 0.928
Validation loss decreased (-0.927533 --> -0.927533).  Saving model ...
Epoch: 51 cost time: 0.5376789569854736
Epoch: 51, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.312 Vali Acc: 0.935 Test Loss: 0.312 Test Acc: 0.935
Validation loss decreased (-0.927533 --> -0.934779).  Saving model ...
Epoch: 52 cost time: 0.5925576686859131
Epoch: 52, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.311 Vali Acc: 0.935 Test Loss: 0.311 Test Acc: 0.935
Validation loss decreased (-0.934779 --> -0.934779).  Saving model ...
Epoch: 53 cost time: 0.7400424480438232
Epoch: 53, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.313 Vali Acc: 0.935 Test Loss: 0.313 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.5087978839874268
Epoch: 54, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.308 Vali Acc: 0.935 Test Loss: 0.308 Test Acc: 0.935
Validation loss decreased (-0.934779 --> -0.934780).  Saving model ...
Epoch: 55 cost time: 0.6527540683746338
Epoch: 55, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.303 Vali Acc: 0.935 Test Loss: 0.303 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 56 cost time: 0.6363544464111328
Epoch: 56, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.303 Vali Acc: 0.935 Test Loss: 0.303 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.44480037689208984
Epoch: 57, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.304 Vali Acc: 0.935 Test Loss: 0.304 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.6942458152770996
Epoch: 58, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.305 Vali Acc: 0.935 Test Loss: 0.305 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 0.8681430816650391
Epoch: 59, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.306 Vali Acc: 0.935 Test Loss: 0.306 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 0.7537455558776855
Epoch: 60, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.307 Vali Acc: 0.935 Test Loss: 0.307 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 0.7432186603546143
Epoch: 61, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.307 Vali Acc: 0.935 Test Loss: 0.307 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 0.8110613822937012
Epoch: 62, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.310 Vali Acc: 0.935 Test Loss: 0.310 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 0.5661993026733398
Epoch: 63, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.311 Vali Acc: 0.942 Test Loss: 0.311 Test Acc: 0.942
Validation loss decreased (-0.934780 --> -0.942026).  Saving model ...
Epoch: 64 cost time: 0.612330436706543
Epoch: 64, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.313 Vali Acc: 0.942 Test Loss: 0.313 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.711113452911377
Epoch: 65, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.314 Vali Acc: 0.942 Test Loss: 0.314 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 0.6012899875640869
Epoch: 66, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.312 Vali Acc: 0.942 Test Loss: 0.312 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 0.6340789794921875
Epoch: 67, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.313 Vali Acc: 0.942 Test Loss: 0.313 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 0.6467876434326172
Epoch: 68, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.306 Vali Acc: 0.942 Test Loss: 0.306 Test Acc: 0.942
Validation loss decreased (-0.942026 --> -0.942026).  Saving model ...
Epoch: 69 cost time: 0.5968368053436279
Epoch: 69, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.305 Vali Acc: 0.942 Test Loss: 0.305 Test Acc: 0.942
Validation loss decreased (-0.942026 --> -0.942026).  Saving model ...
Epoch: 70 cost time: 0.5970439910888672
Epoch: 70, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.307 Vali Acc: 0.942 Test Loss: 0.307 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.5514030456542969
Epoch: 71, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.309 Vali Acc: 0.942 Test Loss: 0.309 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 0.5772500038146973
Epoch: 72, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.309 Vali Acc: 0.942 Test Loss: 0.309 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 0.6737525463104248
Epoch: 73, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.307 Vali Acc: 0.942 Test Loss: 0.307 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 0.6657238006591797
Epoch: 74, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.308 Vali Acc: 0.942 Test Loss: 0.308 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
Epoch: 75 cost time: 0.6200716495513916
Epoch: 75, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.311 Vali Acc: 0.942 Test Loss: 0.311 Test Acc: 0.942
EarlyStopping counter: 6 out of 10
Epoch: 76 cost time: 0.6178488731384277
Epoch: 76, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.311 Vali Acc: 0.942 Test Loss: 0.311 Test Acc: 0.942
EarlyStopping counter: 7 out of 10
Epoch: 77 cost time: 0.5403196811676025
Epoch: 77, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.310 Vali Acc: 0.942 Test Loss: 0.310 Test Acc: 0.942
EarlyStopping counter: 8 out of 10
Epoch: 78 cost time: 0.5395708084106445
Epoch: 78, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.310 Vali Acc: 0.942 Test Loss: 0.310 Test Acc: 0.942
EarlyStopping counter: 9 out of 10
Epoch: 79 cost time: 0.6075122356414795
Epoch: 79, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.310 Vali Acc: 0.942 Test Loss: 0.310 Test Acc: 0.942
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm128_cs19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9420289855072463
model parameter : 57122
model size : 0.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm128_cs18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.867706537246704
Epoch: 1, Steps: 9 | Train Loss: 1.378 Vali Loss: 1.364 Vali Acc: 0.348 Test Loss: 1.364 Test Acc: 0.348
Validation loss decreased (inf --> -0.347812).  Saving model ...
Epoch: 2 cost time: 0.6358697414398193
Epoch: 2, Steps: 9 | Train Loss: 1.305 Vali Loss: 1.291 Vali Acc: 0.420 Test Loss: 1.291 Test Acc: 0.420
Validation loss decreased (-0.347812 --> -0.420277).  Saving model ...
Epoch: 3 cost time: 0.5515186786651611
Epoch: 3, Steps: 9 | Train Loss: 1.214 Vali Loss: 1.215 Vali Acc: 0.435 Test Loss: 1.215 Test Acc: 0.435
Validation loss decreased (-0.420277 --> -0.434770).  Saving model ...
Epoch: 4 cost time: 0.585810661315918
Epoch: 4, Steps: 9 | Train Loss: 1.125 Vali Loss: 1.150 Vali Acc: 0.457 Test Loss: 1.150 Test Acc: 0.457
Validation loss decreased (-0.434770 --> -0.456510).  Saving model ...
Epoch: 5 cost time: 0.606795072555542
Epoch: 5, Steps: 9 | Train Loss: 1.040 Vali Loss: 1.109 Vali Acc: 0.442 Test Loss: 1.109 Test Acc: 0.442
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5386090278625488
Epoch: 6, Steps: 9 | Train Loss: 0.980 Vali Loss: 1.075 Vali Acc: 0.486 Test Loss: 1.075 Test Acc: 0.486
Validation loss decreased (-0.456510 --> -0.485496).  Saving model ...
Epoch: 7 cost time: 0.5289294719696045
Epoch: 7, Steps: 9 | Train Loss: 0.896 Vali Loss: 1.043 Vali Acc: 0.514 Test Loss: 1.043 Test Acc: 0.514
Validation loss decreased (-0.485496 --> -0.514482).  Saving model ...
Epoch: 8 cost time: 0.5330462455749512
Epoch: 8, Steps: 9 | Train Loss: 0.849 Vali Loss: 1.026 Vali Acc: 0.529 Test Loss: 1.026 Test Acc: 0.529
Validation loss decreased (-0.514482 --> -0.528975).  Saving model ...
Epoch: 9 cost time: 0.5928318500518799
Epoch: 9, Steps: 9 | Train Loss: 0.799 Vali Loss: 1.012 Vali Acc: 0.543 Test Loss: 1.012 Test Acc: 0.543
Validation loss decreased (-0.528975 --> -0.543468).  Saving model ...
Epoch: 10 cost time: 0.6335041522979736
Epoch: 10, Steps: 9 | Train Loss: 0.756 Vali Loss: 1.010 Vali Acc: 0.536 Test Loss: 1.010 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6111660003662109
Epoch: 11, Steps: 9 | Train Loss: 0.721 Vali Loss: 0.995 Vali Acc: 0.565 Test Loss: 0.995 Test Acc: 0.565
Validation loss decreased (-0.543468 --> -0.565207).  Saving model ...
Epoch: 12 cost time: 0.6064453125
Epoch: 12, Steps: 9 | Train Loss: 0.665 Vali Loss: 0.968 Vali Acc: 0.594 Test Loss: 0.968 Test Acc: 0.594
Validation loss decreased (-0.565207 --> -0.594193).  Saving model ...
Epoch: 13 cost time: 0.557992696762085
Epoch: 13, Steps: 9 | Train Loss: 0.628 Vali Loss: 0.966 Vali Acc: 0.587 Test Loss: 0.966 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5952739715576172
Epoch: 14, Steps: 9 | Train Loss: 0.583 Vali Loss: 0.952 Vali Acc: 0.594 Test Loss: 0.952 Test Acc: 0.594
Validation loss decreased (-0.594193 --> -0.594193).  Saving model ...
Epoch: 15 cost time: 0.6039700508117676
Epoch: 15, Steps: 9 | Train Loss: 0.539 Vali Loss: 0.946 Vali Acc: 0.594 Test Loss: 0.946 Test Acc: 0.594
Validation loss decreased (-0.594193 --> -0.594193).  Saving model ...
Epoch: 16 cost time: 0.592414379119873
Epoch: 16, Steps: 9 | Train Loss: 0.488 Vali Loss: 0.918 Vali Acc: 0.645 Test Loss: 0.918 Test Acc: 0.645
Validation loss decreased (-0.594193 --> -0.644918).  Saving model ...
Epoch: 17 cost time: 0.5411450862884521
Epoch: 17, Steps: 9 | Train Loss: 0.424 Vali Loss: 0.875 Vali Acc: 0.674 Test Loss: 0.875 Test Acc: 0.674
Validation loss decreased (-0.644918 --> -0.673904).  Saving model ...
Epoch: 18 cost time: 0.5509133338928223
Epoch: 18, Steps: 9 | Train Loss: 0.351 Vali Loss: 0.773 Vali Acc: 0.688 Test Loss: 0.773 Test Acc: 0.688
Validation loss decreased (-0.673904 --> -0.688398).  Saving model ...
Epoch: 19 cost time: 0.5885295867919922
Epoch: 19, Steps: 9 | Train Loss: 0.269 Vali Loss: 0.665 Vali Acc: 0.768 Test Loss: 0.665 Test Acc: 0.768
Validation loss decreased (-0.688398 --> -0.768109).  Saving model ...
Epoch: 20 cost time: 0.5998141765594482
Epoch: 20, Steps: 9 | Train Loss: 0.187 Vali Loss: 0.583 Vali Acc: 0.790 Test Loss: 0.583 Test Acc: 0.790
Validation loss decreased (-0.768109 --> -0.789849).  Saving model ...
Epoch: 21 cost time: 0.606604814529419
Epoch: 21, Steps: 9 | Train Loss: 0.132 Vali Loss: 0.535 Vali Acc: 0.826 Test Loss: 0.535 Test Acc: 0.826
Validation loss decreased (-0.789849 --> -0.826082).  Saving model ...
Epoch: 22 cost time: 0.536419153213501
Epoch: 22, Steps: 9 | Train Loss: 0.099 Vali Loss: 0.506 Vali Acc: 0.833 Test Loss: 0.506 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833328).  Saving model ...
Epoch: 23 cost time: 0.5517246723175049
Epoch: 23, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.476 Vali Acc: 0.848 Test Loss: 0.476 Test Acc: 0.848
Validation loss decreased (-0.833328 --> -0.847821).  Saving model ...
Epoch: 24 cost time: 0.5108678340911865
Epoch: 24, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.519 Vali Acc: 0.833 Test Loss: 0.519 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5001187324523926
Epoch: 25, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.489 Vali Acc: 0.855 Test Loss: 0.489 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855068).  Saving model ...
Epoch: 26 cost time: 0.517585039138794
Epoch: 26, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.520 Vali Acc: 0.855 Test Loss: 0.520 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6082537174224854
Epoch: 27, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.549 Vali Acc: 0.848 Test Loss: 0.549 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6625397205352783
Epoch: 28, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.502 Vali Acc: 0.855 Test Loss: 0.502 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.5421445369720459
Epoch: 29, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.530 Vali Acc: 0.855 Test Loss: 0.530 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.5856516361236572
Epoch: 30, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.553 Vali Acc: 0.855 Test Loss: 0.553 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.5271050930023193
Epoch: 31, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.544 Vali Acc: 0.855 Test Loss: 0.544 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.48586082458496094
Epoch: 32, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.544 Vali Acc: 0.855 Test Loss: 0.544 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.6171514987945557
Epoch: 33, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.566 Vali Acc: 0.855 Test Loss: 0.566 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.5227203369140625
Epoch: 34, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.557 Vali Acc: 0.855 Test Loss: 0.557 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.5767037868499756
Epoch: 35, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.574 Vali Acc: 0.855 Test Loss: 0.574 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm128_cs18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 58550
model size : 0.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm128_cs16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.8801772594451904
Epoch: 1, Steps: 9 | Train Loss: 1.386 Vali Loss: 1.381 Vali Acc: 0.333 Test Loss: 1.381 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 0.582486629486084
Epoch: 2, Steps: 9 | Train Loss: 1.324 Vali Loss: 1.302 Vali Acc: 0.326 Test Loss: 1.302 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5528087615966797
Epoch: 3, Steps: 9 | Train Loss: 1.213 Vali Loss: 1.224 Vali Acc: 0.362 Test Loss: 1.224 Test Acc: 0.362
Validation loss decreased (-0.333320 --> -0.362307).  Saving model ...
Epoch: 4 cost time: 0.6956441402435303
Epoch: 4, Steps: 9 | Train Loss: 1.109 Vali Loss: 1.157 Vali Acc: 0.406 Test Loss: 1.157 Test Acc: 0.406
Validation loss decreased (-0.362307 --> -0.405786).  Saving model ...
Epoch: 5 cost time: 0.5985443592071533
Epoch: 5, Steps: 9 | Train Loss: 1.016 Vali Loss: 1.108 Vali Acc: 0.420 Test Loss: 1.108 Test Acc: 0.420
Validation loss decreased (-0.405786 --> -0.420279).  Saving model ...
Epoch: 6 cost time: 0.511446475982666
Epoch: 6, Steps: 9 | Train Loss: 0.955 Vali Loss: 1.085 Vali Acc: 0.449 Test Loss: 1.085 Test Acc: 0.449
Validation loss decreased (-0.420279 --> -0.449265).  Saving model ...
Epoch: 7 cost time: 0.5670793056488037
Epoch: 7, Steps: 9 | Train Loss: 0.893 Vali Loss: 1.066 Vali Acc: 0.464 Test Loss: 1.066 Test Acc: 0.464
Validation loss decreased (-0.449265 --> -0.463757).  Saving model ...
Epoch: 8 cost time: 0.5386006832122803
Epoch: 8, Steps: 9 | Train Loss: 0.851 Vali Loss: 1.053 Vali Acc: 0.493 Test Loss: 1.053 Test Acc: 0.493
Validation loss decreased (-0.463757 --> -0.492743).  Saving model ...
Epoch: 9 cost time: 0.5039622783660889
Epoch: 9, Steps: 9 | Train Loss: 0.788 Vali Loss: 1.037 Vali Acc: 0.514 Test Loss: 1.037 Test Acc: 0.514
Validation loss decreased (-0.492743 --> -0.514482).  Saving model ...
Epoch: 10 cost time: 0.5200107097625732
Epoch: 10, Steps: 9 | Train Loss: 0.757 Vali Loss: 1.032 Vali Acc: 0.536 Test Loss: 1.032 Test Acc: 0.536
Validation loss decreased (-0.514482 --> -0.536222).  Saving model ...
Epoch: 11 cost time: 0.6371135711669922
Epoch: 11, Steps: 9 | Train Loss: 0.698 Vali Loss: 1.034 Vali Acc: 0.522 Test Loss: 1.034 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5169229507446289
Epoch: 12, Steps: 9 | Train Loss: 0.658 Vali Loss: 1.022 Vali Acc: 0.536 Test Loss: 1.022 Test Acc: 0.536
Validation loss decreased (-0.536222 --> -0.536222).  Saving model ...
Epoch: 13 cost time: 0.6985554695129395
Epoch: 13, Steps: 9 | Train Loss: 0.615 Vali Loss: 1.004 Vali Acc: 0.580 Test Loss: 1.004 Test Acc: 0.580
Validation loss decreased (-0.536222 --> -0.579700).  Saving model ...
Epoch: 14 cost time: 0.7726254463195801
Epoch: 14, Steps: 9 | Train Loss: 0.586 Vali Loss: 0.992 Vali Acc: 0.587 Test Loss: 0.992 Test Acc: 0.587
Validation loss decreased (-0.579700 --> -0.586947).  Saving model ...
Epoch: 15 cost time: 0.5335314273834229
Epoch: 15, Steps: 9 | Train Loss: 0.539 Vali Loss: 0.991 Vali Acc: 0.609 Test Loss: 0.991 Test Acc: 0.609
Validation loss decreased (-0.586947 --> -0.608686).  Saving model ...
Epoch: 16 cost time: 0.6459648609161377
Epoch: 16, Steps: 9 | Train Loss: 0.491 Vali Loss: 0.953 Vali Acc: 0.623 Test Loss: 0.953 Test Acc: 0.623
Validation loss decreased (-0.608686 --> -0.623179).  Saving model ...
Epoch: 17 cost time: 0.5818443298339844
Epoch: 17, Steps: 9 | Train Loss: 0.440 Vali Loss: 0.908 Vali Acc: 0.696 Test Loss: 0.908 Test Acc: 0.696
Validation loss decreased (-0.623179 --> -0.695643).  Saving model ...
Epoch: 18 cost time: 0.5815742015838623
Epoch: 18, Steps: 9 | Train Loss: 0.368 Vali Loss: 0.806 Vali Acc: 0.717 Test Loss: 0.806 Test Acc: 0.717
Validation loss decreased (-0.695643 --> -0.717383).  Saving model ...
Epoch: 19 cost time: 0.6692099571228027
Epoch: 19, Steps: 9 | Train Loss: 0.293 Vali Loss: 0.700 Vali Acc: 0.754 Test Loss: 0.700 Test Acc: 0.754
Validation loss decreased (-0.717383 --> -0.753616).  Saving model ...
Epoch: 20 cost time: 0.5000221729278564
Epoch: 20, Steps: 9 | Train Loss: 0.211 Vali Loss: 0.548 Vali Acc: 0.812 Test Loss: 0.548 Test Acc: 0.812
Validation loss decreased (-0.753616 --> -0.811589).  Saving model ...
Epoch: 21 cost time: 0.4506194591522217
Epoch: 21, Steps: 9 | Train Loss: 0.150 Vali Loss: 0.458 Vali Acc: 0.841 Test Loss: 0.458 Test Acc: 0.841
Validation loss decreased (-0.811589 --> -0.840575).  Saving model ...
Epoch: 22 cost time: 0.5850613117218018
Epoch: 22, Steps: 9 | Train Loss: 0.112 Vali Loss: 0.398 Vali Acc: 0.855 Test Loss: 0.398 Test Acc: 0.855
Validation loss decreased (-0.840575 --> -0.855068).  Saving model ...
Epoch: 23 cost time: 0.5346872806549072
Epoch: 23, Steps: 9 | Train Loss: 0.087 Vali Loss: 0.374 Vali Acc: 0.870 Test Loss: 0.374 Test Acc: 0.870
Validation loss decreased (-0.855068 --> -0.869561).  Saving model ...
Epoch: 24 cost time: 0.5397453308105469
Epoch: 24, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.350 Vali Acc: 0.877 Test Loss: 0.350 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876808).  Saving model ...
Epoch: 25 cost time: 0.46360325813293457
Epoch: 25, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.328 Vali Acc: 0.891 Test Loss: 0.328 Test Acc: 0.891
Validation loss decreased (-0.876808 --> -0.891301).  Saving model ...
Epoch: 26 cost time: 0.5245664119720459
Epoch: 26, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.318 Vali Acc: 0.884 Test Loss: 0.318 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.62264084815979
Epoch: 27, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.317 Vali Acc: 0.891 Test Loss: 0.317 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 28 cost time: 0.6149325370788574
Epoch: 28, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.311 Vali Acc: 0.891 Test Loss: 0.311 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 29 cost time: 0.6354186534881592
Epoch: 29, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.306 Vali Acc: 0.899 Test Loss: 0.306 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898548).  Saving model ...
Epoch: 30 cost time: 0.6411638259887695
Epoch: 30, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.291 Vali Acc: 0.899 Test Loss: 0.291 Test Acc: 0.899
Validation loss decreased (-0.898548 --> -0.898548).  Saving model ...
Epoch: 31 cost time: 0.6486964225769043
Epoch: 31, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.279 Vali Acc: 0.906 Test Loss: 0.279 Test Acc: 0.906
Validation loss decreased (-0.898548 --> -0.905794).  Saving model ...
Epoch: 32 cost time: 0.5911850929260254
Epoch: 32, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.273 Vali Acc: 0.913 Test Loss: 0.273 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913041).  Saving model ...
Epoch: 33 cost time: 0.595940351486206
Epoch: 33, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.299 Vali Acc: 0.906 Test Loss: 0.299 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5685772895812988
Epoch: 34, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.284 Vali Acc: 0.906 Test Loss: 0.284 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.5952489376068115
Epoch: 35, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.253 Vali Acc: 0.906 Test Loss: 0.253 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.5798757076263428
Epoch: 36, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.263 Vali Acc: 0.913 Test Loss: 0.263 Test Acc: 0.913
Validation loss decreased (-0.913041 --> -0.913041).  Saving model ...
Epoch: 37 cost time: 0.7251558303833008
Epoch: 37, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.271 Vali Acc: 0.913 Test Loss: 0.271 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.5410261154174805
Epoch: 38, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.255 Vali Acc: 0.913 Test Loss: 0.255 Test Acc: 0.913
Validation loss decreased (-0.913041 --> -0.913041).  Saving model ...
Epoch: 39 cost time: 0.5736808776855469
Epoch: 39, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.258 Vali Acc: 0.920 Test Loss: 0.258 Test Acc: 0.920
Validation loss decreased (-0.913041 --> -0.920287).  Saving model ...
Epoch: 40 cost time: 0.5731523036956787
Epoch: 40, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.248 Vali Acc: 0.920 Test Loss: 0.248 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 41 cost time: 0.6192655563354492
Epoch: 41, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.238 Vali Acc: 0.928 Test Loss: 0.238 Test Acc: 0.928
Validation loss decreased (-0.920287 --> -0.927534).  Saving model ...
Epoch: 42 cost time: 0.5778384208679199
Epoch: 42, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.243 Vali Acc: 0.928 Test Loss: 0.243 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.7117433547973633
Epoch: 43, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.243 Vali Acc: 0.928 Test Loss: 0.243 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.4509396553039551
Epoch: 44, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.236 Vali Acc: 0.928 Test Loss: 0.236 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 45 cost time: 0.5954279899597168
Epoch: 45, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.236 Vali Acc: 0.928 Test Loss: 0.236 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.5727109909057617
Epoch: 46, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.230 Vali Acc: 0.928 Test Loss: 0.230 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 47 cost time: 0.49056553840637207
Epoch: 47, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.233 Vali Acc: 0.928 Test Loss: 0.233 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.656019926071167
Epoch: 48, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.214 Vali Acc: 0.935 Test Loss: 0.214 Test Acc: 0.935
Validation loss decreased (-0.927534 --> -0.934780).  Saving model ...
Epoch: 49 cost time: 0.5529654026031494
Epoch: 49, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.226 Vali Acc: 0.928 Test Loss: 0.226 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.4574711322784424
Epoch: 50, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.232 Vali Acc: 0.928 Test Loss: 0.232 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.5982136726379395
Epoch: 51, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.928 Test Loss: 0.226 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.5885171890258789
Epoch: 52, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.221 Vali Acc: 0.928 Test Loss: 0.221 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 0.6303048133850098
Epoch: 53, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.203 Vali Acc: 0.935 Test Loss: 0.203 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934781).  Saving model ...
Epoch: 54 cost time: 0.7136309146881104
Epoch: 54, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.209 Vali Acc: 0.935 Test Loss: 0.209 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.530052900314331
Epoch: 55, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.205 Vali Acc: 0.935 Test Loss: 0.205 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.5531842708587646
Epoch: 56, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.204 Vali Acc: 0.935 Test Loss: 0.204 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.6110796928405762
Epoch: 57, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.935 Test Loss: 0.204 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 0.5891952514648438
Epoch: 58, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.935 Test Loss: 0.211 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 0.5212335586547852
Epoch: 59, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.935 Test Loss: 0.210 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 0.5183093547821045
Epoch: 60, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.935 Test Loss: 0.194 Test Acc: 0.935
Validation loss decreased (-0.934781 --> -0.934781).  Saving model ...
Epoch: 61 cost time: 0.535663366317749
Epoch: 61, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.935 Test Loss: 0.194 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.6226272583007812
Epoch: 62, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.935 Test Loss: 0.202 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.5953371524810791
Epoch: 63, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.935 Test Loss: 0.200 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 0.768765926361084
Epoch: 64, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.935 Test Loss: 0.197 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 0.6605541706085205
Epoch: 65, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.949 Test Loss: 0.188 Test Acc: 0.949
Validation loss decreased (-0.934781 --> -0.949273).  Saving model ...
Epoch: 66 cost time: 0.5378975868225098
Epoch: 66, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.949 Test Loss: 0.192 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.624823808670044
Epoch: 67, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.949 Test Loss: 0.198 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.5578923225402832
Epoch: 68, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.957 Test Loss: 0.193 Test Acc: 0.957
Validation loss decreased (-0.949273 --> -0.956520).  Saving model ...
Epoch: 69 cost time: 0.5648918151855469
Epoch: 69, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.957 Test Loss: 0.187 Test Acc: 0.957
Validation loss decreased (-0.956520 --> -0.956520).  Saving model ...
Epoch: 70 cost time: 0.6151261329650879
Epoch: 70, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.957 Test Loss: 0.191 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.559138298034668
Epoch: 71, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.957 Test Loss: 0.190 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 0.5398423671722412
Epoch: 72, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.957 Test Loss: 0.194 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 0.6807153224945068
Epoch: 73, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.957 Test Loss: 0.193 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 0.5167124271392822
Epoch: 74, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.957 Test Loss: 0.186 Test Acc: 0.957
Validation loss decreased (-0.956520 --> -0.956520).  Saving model ...
Epoch: 75 cost time: 0.580927848815918
Epoch: 75, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.964 Test Loss: 0.179 Test Acc: 0.964
Validation loss decreased (-0.956520 --> -0.963766).  Saving model ...
Epoch: 76 cost time: 0.6482546329498291
Epoch: 76, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.964 Test Loss: 0.181 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 0.5781335830688477
Epoch: 77, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.964 Test Loss: 0.184 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 0.6235945224761963
Epoch: 78, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.964 Test Loss: 0.187 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 0.7835659980773926
Epoch: 79, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.964 Test Loss: 0.186 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 0.5780622959136963
Epoch: 80, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.964 Test Loss: 0.184 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 81 cost time: 0.5282893180847168
Epoch: 81, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.964 Test Loss: 0.179 Test Acc: 0.964
Validation loss decreased (-0.963766 --> -0.963766).  Saving model ...
Epoch: 82 cost time: 0.5020194053649902
Epoch: 82, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.964 Test Loss: 0.183 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 0.5784785747528076
Epoch: 83, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.964 Test Loss: 0.184 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 0.5743980407714844
Epoch: 84, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.964 Test Loss: 0.182 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 85 cost time: 0.5029416084289551
Epoch: 85, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.964 Test Loss: 0.180 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 86 cost time: 0.4939875602722168
Epoch: 86, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.964 Test Loss: 0.183 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 87 cost time: 0.5369381904602051
Epoch: 87, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.964 Test Loss: 0.182 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 88 cost time: 0.5875873565673828
Epoch: 88, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.964 Test Loss: 0.180 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 89 cost time: 0.5670769214630127
Epoch: 89, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.964 Test Loss: 0.178 Test Acc: 0.964
Validation loss decreased (-0.963766 --> -0.963766).  Saving model ...
Epoch: 90 cost time: 0.6059310436248779
Epoch: 90, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.964 Test Loss: 0.173 Test Acc: 0.964
Validation loss decreased (-0.963766 --> -0.963766).  Saving model ...
Epoch: 91 cost time: 0.4979081153869629
Epoch: 91, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.964 Test Loss: 0.178 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 0.5801279544830322
Epoch: 92, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.964 Test Loss: 0.179 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 93 cost time: 0.5453174114227295
Epoch: 93, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.964 Test Loss: 0.177 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 94 cost time: 0.5657713413238525
Epoch: 94, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.964 Test Loss: 0.179 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 95 cost time: 0.48993468284606934
Epoch: 95, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.964 Test Loss: 0.176 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 96 cost time: 0.43766117095947266
Epoch: 96, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.964 Test Loss: 0.175 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 97 cost time: 0.593055009841919
Epoch: 97, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.964 Test Loss: 0.175 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 98 cost time: 0.550623893737793
Epoch: 98, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.964 Test Loss: 0.176 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
Epoch: 99 cost time: 0.5569391250610352
Epoch: 99, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.964 Test Loss: 0.177 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
Epoch: 100 cost time: 0.5444276332855225
Epoch: 100, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.964 Test Loss: 0.176 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm128_cs16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9637681159420289
model parameter : 56828
model size : 0.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm128_cs15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.8301935195922852
Epoch: 1, Steps: 9 | Train Loss: 1.451 Vali Loss: 1.346 Vali Acc: 0.377 Test Loss: 1.346 Test Acc: 0.377
Validation loss decreased (inf --> -0.376798).  Saving model ...
Epoch: 2 cost time: 0.6137323379516602
Epoch: 2, Steps: 9 | Train Loss: 1.372 Vali Loss: 1.264 Vali Acc: 0.449 Test Loss: 1.264 Test Acc: 0.449
Validation loss decreased (-0.376798 --> -0.449263).  Saving model ...
Epoch: 3 cost time: 0.5502209663391113
Epoch: 3, Steps: 9 | Train Loss: 1.263 Vali Loss: 1.178 Vali Acc: 0.514 Test Loss: 1.178 Test Acc: 0.514
Validation loss decreased (-0.449263 --> -0.514481).  Saving model ...
Epoch: 4 cost time: 0.5620412826538086
Epoch: 4, Steps: 9 | Train Loss: 1.164 Vali Loss: 1.120 Vali Acc: 0.522 Test Loss: 1.120 Test Acc: 0.522
Validation loss decreased (-0.514481 --> -0.521728).  Saving model ...
Epoch: 5 cost time: 0.5848307609558105
Epoch: 5, Steps: 9 | Train Loss: 1.067 Vali Loss: 1.081 Vali Acc: 0.529 Test Loss: 1.081 Test Acc: 0.529
Validation loss decreased (-0.521728 --> -0.528975).  Saving model ...
Epoch: 6 cost time: 0.7089278697967529
Epoch: 6, Steps: 9 | Train Loss: 1.000 Vali Loss: 1.060 Vali Acc: 0.529 Test Loss: 1.060 Test Acc: 0.529
Validation loss decreased (-0.528975 --> -0.528975).  Saving model ...
Epoch: 7 cost time: 0.6404569149017334
Epoch: 7, Steps: 9 | Train Loss: 0.928 Vali Loss: 1.039 Vali Acc: 0.529 Test Loss: 1.039 Test Acc: 0.529
Validation loss decreased (-0.528975 --> -0.528975).  Saving model ...
Epoch: 8 cost time: 0.6021585464477539
Epoch: 8, Steps: 9 | Train Loss: 0.891 Vali Loss: 1.030 Vali Acc: 0.522 Test Loss: 1.030 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7608919143676758
Epoch: 9, Steps: 9 | Train Loss: 0.830 Vali Loss: 1.018 Vali Acc: 0.500 Test Loss: 1.018 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5615255832672119
Epoch: 10, Steps: 9 | Train Loss: 0.796 Vali Loss: 1.010 Vali Acc: 0.500 Test Loss: 1.010 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.6325340270996094
Epoch: 11, Steps: 9 | Train Loss: 0.743 Vali Loss: 0.997 Vali Acc: 0.543 Test Loss: 0.997 Test Acc: 0.543
Validation loss decreased (-0.528975 --> -0.543468).  Saving model ...
Epoch: 12 cost time: 0.5452396869659424
Epoch: 12, Steps: 9 | Train Loss: 0.696 Vali Loss: 0.991 Vali Acc: 0.551 Test Loss: 0.991 Test Acc: 0.551
Validation loss decreased (-0.543468 --> -0.550715).  Saving model ...
Epoch: 13 cost time: 0.6865091323852539
Epoch: 13, Steps: 9 | Train Loss: 0.665 Vali Loss: 0.975 Vali Acc: 0.565 Test Loss: 0.975 Test Acc: 0.565
Validation loss decreased (-0.550715 --> -0.565208).  Saving model ...
Epoch: 14 cost time: 0.5639777183532715
Epoch: 14, Steps: 9 | Train Loss: 0.616 Vali Loss: 0.966 Vali Acc: 0.572 Test Loss: 0.966 Test Acc: 0.572
Validation loss decreased (-0.565208 --> -0.572454).  Saving model ...
Epoch: 15 cost time: 0.5516505241394043
Epoch: 15, Steps: 9 | Train Loss: 0.580 Vali Loss: 0.974 Vali Acc: 0.594 Test Loss: 0.974 Test Acc: 0.594
Validation loss decreased (-0.572454 --> -0.594193).  Saving model ...
Epoch: 16 cost time: 0.6329596042633057
Epoch: 16, Steps: 9 | Train Loss: 0.535 Vali Loss: 0.946 Vali Acc: 0.630 Test Loss: 0.946 Test Acc: 0.630
Validation loss decreased (-0.594193 --> -0.630425).  Saving model ...
Epoch: 17 cost time: 0.5139384269714355
Epoch: 17, Steps: 9 | Train Loss: 0.488 Vali Loss: 0.917 Vali Acc: 0.623 Test Loss: 0.917 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5664942264556885
Epoch: 18, Steps: 9 | Train Loss: 0.440 Vali Loss: 0.869 Vali Acc: 0.659 Test Loss: 0.869 Test Acc: 0.659
Validation loss decreased (-0.630425 --> -0.659412).  Saving model ...
Epoch: 19 cost time: 0.5787994861602783
Epoch: 19, Steps: 9 | Train Loss: 0.370 Vali Loss: 0.805 Vali Acc: 0.703 Test Loss: 0.805 Test Acc: 0.703
Validation loss decreased (-0.659412 --> -0.702890).  Saving model ...
Epoch: 20 cost time: 0.605494499206543
Epoch: 20, Steps: 9 | Train Loss: 0.296 Vali Loss: 0.698 Vali Acc: 0.746 Test Loss: 0.698 Test Acc: 0.746
Validation loss decreased (-0.702890 --> -0.746370).  Saving model ...
Epoch: 21 cost time: 0.6466138362884521
Epoch: 21, Steps: 9 | Train Loss: 0.228 Vali Loss: 0.580 Vali Acc: 0.775 Test Loss: 0.580 Test Acc: 0.775
Validation loss decreased (-0.746370 --> -0.775357).  Saving model ...
Epoch: 22 cost time: 0.6154263019561768
Epoch: 22, Steps: 9 | Train Loss: 0.175 Vali Loss: 0.477 Vali Acc: 0.833 Test Loss: 0.477 Test Acc: 0.833
Validation loss decreased (-0.775357 --> -0.833329).  Saving model ...
Epoch: 23 cost time: 0.6236119270324707
Epoch: 23, Steps: 9 | Train Loss: 0.118 Vali Loss: 0.399 Vali Acc: 0.870 Test Loss: 0.399 Test Acc: 0.870
Validation loss decreased (-0.833329 --> -0.869561).  Saving model ...
Epoch: 24 cost time: 0.5982327461242676
Epoch: 24, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.341 Vali Acc: 0.877 Test Loss: 0.341 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876808).  Saving model ...
Epoch: 25 cost time: 0.6759376525878906
Epoch: 25, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.292 Vali Acc: 0.877 Test Loss: 0.292 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876809).  Saving model ...
Epoch: 26 cost time: 0.6345791816711426
Epoch: 26, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.280 Vali Acc: 0.877 Test Loss: 0.280 Test Acc: 0.877
Validation loss decreased (-0.876809 --> -0.876809).  Saving model ...
Epoch: 27 cost time: 0.6004271507263184
Epoch: 27, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.270 Vali Acc: 0.870 Test Loss: 0.270 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.48413944244384766
Epoch: 28, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.256 Vali Acc: 0.884 Test Loss: 0.256 Test Acc: 0.884
Validation loss decreased (-0.876809 --> -0.884055).  Saving model ...
Epoch: 29 cost time: 0.6014022827148438
Epoch: 29, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.238 Vali Acc: 0.906 Test Loss: 0.238 Test Acc: 0.906
Validation loss decreased (-0.884055 --> -0.905795).  Saving model ...
Epoch: 30 cost time: 0.5805783271789551
Epoch: 30, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.238 Vali Acc: 0.906 Test Loss: 0.238 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6231763362884521
Epoch: 31, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.230 Vali Acc: 0.906 Test Loss: 0.230 Test Acc: 0.906
Validation loss decreased (-0.905795 --> -0.905795).  Saving model ...
Epoch: 32 cost time: 0.8068978786468506
Epoch: 32, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.228 Vali Acc: 0.906 Test Loss: 0.228 Test Acc: 0.906
Validation loss decreased (-0.905795 --> -0.905795).  Saving model ...
Epoch: 33 cost time: 0.5643312931060791
Epoch: 33, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.213 Vali Acc: 0.920 Test Loss: 0.213 Test Acc: 0.920
Validation loss decreased (-0.905795 --> -0.920288).  Saving model ...
Epoch: 34 cost time: 0.5579612255096436
Epoch: 34, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.223 Vali Acc: 0.920 Test Loss: 0.223 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.698744535446167
Epoch: 35, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.220 Vali Acc: 0.928 Test Loss: 0.220 Test Acc: 0.928
Validation loss decreased (-0.920288 --> -0.927534).  Saving model ...
Epoch: 36 cost time: 0.5887196063995361
Epoch: 36, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.206 Vali Acc: 0.935 Test Loss: 0.206 Test Acc: 0.935
Validation loss decreased (-0.927534 --> -0.934781).  Saving model ...
Epoch: 37 cost time: 0.7041900157928467
Epoch: 37, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.206 Vali Acc: 0.935 Test Loss: 0.206 Test Acc: 0.935
Validation loss decreased (-0.934781 --> -0.934781).  Saving model ...
Epoch: 38 cost time: 0.5647380352020264
Epoch: 38, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.212 Vali Acc: 0.942 Test Loss: 0.212 Test Acc: 0.942
Validation loss decreased (-0.934781 --> -0.942027).  Saving model ...
Epoch: 39 cost time: 0.5215518474578857
Epoch: 39, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.208 Vali Acc: 0.942 Test Loss: 0.208 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 40 cost time: 0.5315911769866943
Epoch: 40, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.199 Vali Acc: 0.942 Test Loss: 0.199 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 41 cost time: 0.6132855415344238
Epoch: 41, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.200 Vali Acc: 0.942 Test Loss: 0.200 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.5488810539245605
Epoch: 42, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.202 Vali Acc: 0.942 Test Loss: 0.202 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.588322639465332
Epoch: 43, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.196 Vali Acc: 0.942 Test Loss: 0.196 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 44 cost time: 0.5604147911071777
Epoch: 44, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.195 Vali Acc: 0.942 Test Loss: 0.195 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 45 cost time: 0.690192461013794
Epoch: 45, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.193 Vali Acc: 0.942 Test Loss: 0.193 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 46 cost time: 0.6690406799316406
Epoch: 46, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.192 Vali Acc: 0.942 Test Loss: 0.192 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 47 cost time: 0.8292393684387207
Epoch: 47, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.195 Vali Acc: 0.942 Test Loss: 0.195 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.6421818733215332
Epoch: 48, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.201 Vali Acc: 0.942 Test Loss: 0.201 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.6522421836853027
Epoch: 49, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.199 Vali Acc: 0.942 Test Loss: 0.199 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.6483356952667236
Epoch: 50, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.942 Test Loss: 0.196 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.6224091053009033
Epoch: 51, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.193 Vali Acc: 0.942 Test Loss: 0.193 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.6821281909942627
Epoch: 52, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.190 Vali Acc: 0.942 Test Loss: 0.190 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 53 cost time: 0.6681628227233887
Epoch: 53, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.194 Vali Acc: 0.942 Test Loss: 0.194 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.5825090408325195
Epoch: 54, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.942 Test Loss: 0.192 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.5778143405914307
Epoch: 55, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.942 Test Loss: 0.191 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.7824599742889404
Epoch: 56, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.942 Test Loss: 0.191 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.5726535320281982
Epoch: 57, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.949 Test Loss: 0.192 Test Acc: 0.949
Validation loss decreased (-0.942027 --> -0.949273).  Saving model ...
Epoch: 58 cost time: 0.6170179843902588
Epoch: 58, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.949 Test Loss: 0.193 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.7840075492858887
Epoch: 59, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.949 Test Loss: 0.193 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.6541337966918945
Epoch: 60, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.949 Test Loss: 0.194 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 0.6538975238800049
Epoch: 61, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.949 Test Loss: 0.193 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 0.6139657497406006
Epoch: 62, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.949 Test Loss: 0.193 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 0.5908946990966797
Epoch: 63, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.949 Test Loss: 0.193 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 0.6145808696746826
Epoch: 64, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.949 Test Loss: 0.194 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 0.6708517074584961
Epoch: 65, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.949 Test Loss: 0.195 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 0.5622856616973877
Epoch: 66, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.949 Test Loss: 0.197 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 0.6025514602661133
Epoch: 67, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.949 Test Loss: 0.196 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm128_cs15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9492753623188406
model parameter : 57234
model size : 0.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm128_cs14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.817965030670166
Epoch: 1, Steps: 9 | Train Loss: 1.371 Vali Loss: 1.361 Vali Acc: 0.275 Test Loss: 1.361 Test Acc: 0.275
Validation loss decreased (inf --> -0.275349).  Saving model ...
Epoch: 2 cost time: 0.5558326244354248
Epoch: 2, Steps: 9 | Train Loss: 1.295 Vali Loss: 1.274 Vali Acc: 0.355 Test Loss: 1.274 Test Acc: 0.355
Validation loss decreased (-0.275349 --> -0.355060).  Saving model ...
Epoch: 3 cost time: 0.7789585590362549
Epoch: 3, Steps: 9 | Train Loss: 1.195 Vali Loss: 1.187 Vali Acc: 0.442 Test Loss: 1.187 Test Acc: 0.442
Validation loss decreased (-0.355060 --> -0.442017).  Saving model ...
Epoch: 4 cost time: 0.660729169845581
Epoch: 4, Steps: 9 | Train Loss: 1.087 Vali Loss: 1.120 Vali Acc: 0.507 Test Loss: 1.120 Test Acc: 0.507
Validation loss decreased (-0.442017 --> -0.507235).  Saving model ...
Epoch: 5 cost time: 0.6233410835266113
Epoch: 5, Steps: 9 | Train Loss: 1.005 Vali Loss: 1.073 Vali Acc: 0.500 Test Loss: 1.073 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5546259880065918
Epoch: 6, Steps: 9 | Train Loss: 0.947 Vali Loss: 1.046 Vali Acc: 0.493 Test Loss: 1.046 Test Acc: 0.493
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5146195888519287
Epoch: 7, Steps: 9 | Train Loss: 0.878 Vali Loss: 1.026 Vali Acc: 0.500 Test Loss: 1.026 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.5157113075256348
Epoch: 8, Steps: 9 | Train Loss: 0.820 Vali Loss: 1.002 Vali Acc: 0.507 Test Loss: 1.002 Test Acc: 0.507
Validation loss decreased (-0.507235 --> -0.507236).  Saving model ...
Epoch: 9 cost time: 0.5948853492736816
Epoch: 9, Steps: 9 | Train Loss: 0.778 Vali Loss: 0.995 Vali Acc: 0.558 Test Loss: 0.995 Test Acc: 0.558
Validation loss decreased (-0.507236 --> -0.557961).  Saving model ...
Epoch: 10 cost time: 0.573131799697876
Epoch: 10, Steps: 9 | Train Loss: 0.724 Vali Loss: 0.971 Vali Acc: 0.623 Test Loss: 0.971 Test Acc: 0.623
Validation loss decreased (-0.557961 --> -0.623179).  Saving model ...
Epoch: 11 cost time: 0.5058410167694092
Epoch: 11, Steps: 9 | Train Loss: 0.685 Vali Loss: 0.942 Vali Acc: 0.616 Test Loss: 0.942 Test Acc: 0.616
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6014752388000488
Epoch: 12, Steps: 9 | Train Loss: 0.635 Vali Loss: 0.910 Vali Acc: 0.638 Test Loss: 0.910 Test Acc: 0.638
Validation loss decreased (-0.623179 --> -0.637672).  Saving model ...
Epoch: 13 cost time: 0.6304171085357666
Epoch: 13, Steps: 9 | Train Loss: 0.575 Vali Loss: 0.880 Vali Acc: 0.659 Test Loss: 0.880 Test Acc: 0.659
Validation loss decreased (-0.637672 --> -0.659411).  Saving model ...
Epoch: 14 cost time: 0.5416414737701416
Epoch: 14, Steps: 9 | Train Loss: 0.509 Vali Loss: 0.829 Vali Acc: 0.696 Test Loss: 0.829 Test Acc: 0.696
Validation loss decreased (-0.659411 --> -0.695644).  Saving model ...
Epoch: 15 cost time: 0.5352137088775635
Epoch: 15, Steps: 9 | Train Loss: 0.433 Vali Loss: 0.744 Vali Acc: 0.725 Test Loss: 0.744 Test Acc: 0.725
Validation loss decreased (-0.695644 --> -0.724630).  Saving model ...
Epoch: 16 cost time: 0.6267178058624268
Epoch: 16, Steps: 9 | Train Loss: 0.347 Vali Loss: 0.633 Vali Acc: 0.761 Test Loss: 0.633 Test Acc: 0.761
Validation loss decreased (-0.724630 --> -0.760863).  Saving model ...
Epoch: 17 cost time: 0.5482771396636963
Epoch: 17, Steps: 9 | Train Loss: 0.262 Vali Loss: 0.514 Vali Acc: 0.797 Test Loss: 0.514 Test Acc: 0.797
Validation loss decreased (-0.760863 --> -0.797096).  Saving model ...
Epoch: 18 cost time: 0.5867681503295898
Epoch: 18, Steps: 9 | Train Loss: 0.199 Vali Loss: 0.406 Vali Acc: 0.855 Test Loss: 0.406 Test Acc: 0.855
Validation loss decreased (-0.797096 --> -0.855068).  Saving model ...
Epoch: 19 cost time: 0.5587010383605957
Epoch: 19, Steps: 9 | Train Loss: 0.128 Vali Loss: 0.340 Vali Acc: 0.899 Test Loss: 0.340 Test Acc: 0.899
Validation loss decreased (-0.855068 --> -0.898547).  Saving model ...
Epoch: 20 cost time: 0.5999088287353516
Epoch: 20, Steps: 9 | Train Loss: 0.095 Vali Loss: 0.299 Vali Acc: 0.906 Test Loss: 0.299 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905794).  Saving model ...
Epoch: 21 cost time: 0.6434407234191895
Epoch: 21, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.259 Vali Acc: 0.913 Test Loss: 0.259 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913041).  Saving model ...
Epoch: 22 cost time: 0.6335060596466064
Epoch: 22, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.234 Vali Acc: 0.920 Test Loss: 0.234 Test Acc: 0.920
Validation loss decreased (-0.913041 --> -0.920288).  Saving model ...
Epoch: 23 cost time: 0.5844564437866211
Epoch: 23, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.234 Vali Acc: 0.920 Test Loss: 0.234 Test Acc: 0.920
Validation loss decreased (-0.920288 --> -0.920288).  Saving model ...
Epoch: 24 cost time: 0.6081550121307373
Epoch: 24, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.234 Vali Acc: 0.920 Test Loss: 0.234 Test Acc: 0.920
Validation loss decreased (-0.920288 --> -0.920288).  Saving model ...
Epoch: 25 cost time: 0.6269135475158691
Epoch: 25, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.222 Vali Acc: 0.928 Test Loss: 0.222 Test Acc: 0.928
Validation loss decreased (-0.920288 --> -0.927534).  Saving model ...
Epoch: 26 cost time: 0.5931673049926758
Epoch: 26, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.212 Vali Acc: 0.935 Test Loss: 0.212 Test Acc: 0.935
Validation loss decreased (-0.927534 --> -0.934780).  Saving model ...
Epoch: 27 cost time: 0.583777666091919
Epoch: 27, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.211 Vali Acc: 0.935 Test Loss: 0.211 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 28 cost time: 0.5602753162384033
Epoch: 28, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.193 Vali Acc: 0.935 Test Loss: 0.193 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934781).  Saving model ...
Epoch: 29 cost time: 0.6856732368469238
Epoch: 29, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.202 Vali Acc: 0.942 Test Loss: 0.202 Test Acc: 0.942
Validation loss decreased (-0.934781 --> -0.942027).  Saving model ...
Epoch: 30 cost time: 0.5983221530914307
Epoch: 30, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.221 Vali Acc: 0.928 Test Loss: 0.221 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5480825901031494
Epoch: 31, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.185 Vali Acc: 0.949 Test Loss: 0.185 Test Acc: 0.949
Validation loss decreased (-0.942027 --> -0.949274).  Saving model ...
Epoch: 32 cost time: 0.6552844047546387
Epoch: 32, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.179 Vali Acc: 0.964 Test Loss: 0.179 Test Acc: 0.964
Validation loss decreased (-0.949274 --> -0.963766).  Saving model ...
Epoch: 33 cost time: 0.5331356525421143
Epoch: 33, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.206 Vali Acc: 0.942 Test Loss: 0.206 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6730821132659912
Epoch: 34, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.185 Vali Acc: 0.957 Test Loss: 0.185 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.5928101539611816
Epoch: 35, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.175 Vali Acc: 0.957 Test Loss: 0.175 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.5439057350158691
Epoch: 36, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.192 Vali Acc: 0.949 Test Loss: 0.192 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.5476334095001221
Epoch: 37, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.177 Vali Acc: 0.964 Test Loss: 0.177 Test Acc: 0.964
Validation loss decreased (-0.963766 --> -0.963766).  Saving model ...
Epoch: 38 cost time: 0.5761082172393799
Epoch: 38, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.166 Vali Acc: 0.964 Test Loss: 0.166 Test Acc: 0.964
Validation loss decreased (-0.963766 --> -0.963766).  Saving model ...
Epoch: 39 cost time: 0.6497540473937988
Epoch: 39, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.174 Vali Acc: 0.964 Test Loss: 0.174 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.6227047443389893
Epoch: 40, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.198 Vali Acc: 0.949 Test Loss: 0.198 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.7257258892059326
Epoch: 41, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.157 Vali Acc: 0.964 Test Loss: 0.157 Test Acc: 0.964
Validation loss decreased (-0.963766 --> -0.963767).  Saving model ...
Epoch: 42 cost time: 0.6501333713531494
Epoch: 42, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.165 Vali Acc: 0.964 Test Loss: 0.165 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.5983340740203857
Epoch: 43, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.197 Vali Acc: 0.957 Test Loss: 0.197 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.7743513584136963
Epoch: 44, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.170 Vali Acc: 0.964 Test Loss: 0.170 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.6763808727264404
Epoch: 45, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.172 Vali Acc: 0.964 Test Loss: 0.172 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.662670373916626
Epoch: 46, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.172 Vali Acc: 0.964 Test Loss: 0.172 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.5684480667114258
Epoch: 47, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.179 Vali Acc: 0.964 Test Loss: 0.179 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.643268346786499
Epoch: 48, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.170 Vali Acc: 0.964 Test Loss: 0.170 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.685225248336792
Epoch: 49, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.171 Vali Acc: 0.964 Test Loss: 0.171 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.6333725452423096
Epoch: 50, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.170 Vali Acc: 0.964 Test Loss: 0.170 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 0.6227490901947021
Epoch: 51, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.174 Vali Acc: 0.964 Test Loss: 0.174 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm128_cs14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9637681159420289
model parameter : 57232
model size : 0.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm128_cs13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.928011178970337
Epoch: 1, Steps: 9 | Train Loss: 1.385 Vali Loss: 1.380 Vali Acc: 0.239 Test Loss: 1.380 Test Acc: 0.239
Validation loss decreased (inf --> -0.239117).  Saving model ...
Epoch: 2 cost time: 0.6157963275909424
Epoch: 2, Steps: 9 | Train Loss: 1.318 Vali Loss: 1.300 Vali Acc: 0.355 Test Loss: 1.300 Test Acc: 0.355
Validation loss decreased (-0.239117 --> -0.355059).  Saving model ...
Epoch: 3 cost time: 0.6250355243682861
Epoch: 3, Steps: 9 | Train Loss: 1.204 Vali Loss: 1.222 Vali Acc: 0.399 Test Loss: 1.222 Test Acc: 0.399
Validation loss decreased (-0.355059 --> -0.398539).  Saving model ...
Epoch: 4 cost time: 0.4617574214935303
Epoch: 4, Steps: 9 | Train Loss: 1.110 Vali Loss: 1.153 Vali Acc: 0.486 Test Loss: 1.153 Test Acc: 0.486
Validation loss decreased (-0.398539 --> -0.485496).  Saving model ...
Epoch: 5 cost time: 0.5056827068328857
Epoch: 5, Steps: 9 | Train Loss: 1.048 Vali Loss: 1.115 Vali Acc: 0.471 Test Loss: 1.115 Test Acc: 0.471
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5527586936950684
Epoch: 6, Steps: 9 | Train Loss: 0.973 Vali Loss: 1.079 Vali Acc: 0.486 Test Loss: 1.079 Test Acc: 0.486
Validation loss decreased (-0.485496 --> -0.485496).  Saving model ...
Epoch: 7 cost time: 0.5546672344207764
Epoch: 7, Steps: 9 | Train Loss: 0.930 Vali Loss: 1.060 Vali Acc: 0.514 Test Loss: 1.060 Test Acc: 0.514
Validation loss decreased (-0.485496 --> -0.514482).  Saving model ...
Epoch: 8 cost time: 0.5941095352172852
Epoch: 8, Steps: 9 | Train Loss: 0.863 Vali Loss: 1.049 Vali Acc: 0.514 Test Loss: 1.049 Test Acc: 0.514
Validation loss decreased (-0.514482 --> -0.514482).  Saving model ...
Epoch: 9 cost time: 0.6411726474761963
Epoch: 9, Steps: 9 | Train Loss: 0.819 Vali Loss: 1.038 Vali Acc: 0.529 Test Loss: 1.038 Test Acc: 0.529
Validation loss decreased (-0.514482 --> -0.528975).  Saving model ...
Epoch: 10 cost time: 0.5057821273803711
Epoch: 10, Steps: 9 | Train Loss: 0.756 Vali Loss: 1.020 Vali Acc: 0.543 Test Loss: 1.020 Test Acc: 0.543
Validation loss decreased (-0.528975 --> -0.543468).  Saving model ...
Epoch: 11 cost time: 0.5954809188842773
Epoch: 11, Steps: 9 | Train Loss: 0.725 Vali Loss: 1.001 Vali Acc: 0.543 Test Loss: 1.001 Test Acc: 0.543
Validation loss decreased (-0.543468 --> -0.543468).  Saving model ...
Epoch: 12 cost time: 0.5989775657653809
Epoch: 12, Steps: 9 | Train Loss: 0.686 Vali Loss: 0.996 Vali Acc: 0.565 Test Loss: 0.996 Test Acc: 0.565
Validation loss decreased (-0.543468 --> -0.565207).  Saving model ...
Epoch: 13 cost time: 0.6083564758300781
Epoch: 13, Steps: 9 | Train Loss: 0.651 Vali Loss: 1.007 Vali Acc: 0.565 Test Loss: 1.007 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7078778743743896
Epoch: 14, Steps: 9 | Train Loss: 0.602 Vali Loss: 0.984 Vali Acc: 0.601 Test Loss: 0.984 Test Acc: 0.601
Validation loss decreased (-0.565207 --> -0.601439).  Saving model ...
Epoch: 15 cost time: 0.6400001049041748
Epoch: 15, Steps: 9 | Train Loss: 0.553 Vali Loss: 0.942 Vali Acc: 0.601 Test Loss: 0.942 Test Acc: 0.601
Validation loss decreased (-0.601439 --> -0.601440).  Saving model ...
Epoch: 16 cost time: 0.638676643371582
Epoch: 16, Steps: 9 | Train Loss: 0.497 Vali Loss: 0.896 Vali Acc: 0.645 Test Loss: 0.896 Test Acc: 0.645
Validation loss decreased (-0.601440 --> -0.644919).  Saving model ...
Epoch: 17 cost time: 0.5729525089263916
Epoch: 17, Steps: 9 | Train Loss: 0.425 Vali Loss: 0.822 Vali Acc: 0.681 Test Loss: 0.822 Test Acc: 0.681
Validation loss decreased (-0.644919 --> -0.681151).  Saving model ...
Epoch: 18 cost time: 0.5804657936096191
Epoch: 18, Steps: 9 | Train Loss: 0.331 Vali Loss: 0.699 Vali Acc: 0.725 Test Loss: 0.699 Test Acc: 0.725
Validation loss decreased (-0.681151 --> -0.724631).  Saving model ...
Epoch: 19 cost time: 0.5182318687438965
Epoch: 19, Steps: 9 | Train Loss: 0.242 Vali Loss: 0.563 Vali Acc: 0.797 Test Loss: 0.563 Test Acc: 0.797
Validation loss decreased (-0.724631 --> -0.797096).  Saving model ...
Epoch: 20 cost time: 0.6178374290466309
Epoch: 20, Steps: 9 | Train Loss: 0.173 Vali Loss: 0.438 Vali Acc: 0.848 Test Loss: 0.438 Test Acc: 0.848
Validation loss decreased (-0.797096 --> -0.847822).  Saving model ...
Epoch: 21 cost time: 0.5919942855834961
Epoch: 21, Steps: 9 | Train Loss: 0.115 Vali Loss: 0.391 Vali Acc: 0.855 Test Loss: 0.391 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855069).  Saving model ...
Epoch: 22 cost time: 0.5465645790100098
Epoch: 22, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.360 Vali Acc: 0.855 Test Loss: 0.360 Test Acc: 0.855
Validation loss decreased (-0.855069 --> -0.855069).  Saving model ...
Epoch: 23 cost time: 0.5177264213562012
Epoch: 23, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.328 Vali Acc: 0.877 Test Loss: 0.328 Test Acc: 0.877
Validation loss decreased (-0.855069 --> -0.876808).  Saving model ...
Epoch: 24 cost time: 0.5149328708648682
Epoch: 24, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.307 Vali Acc: 0.884 Test Loss: 0.307 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884055).  Saving model ...
Epoch: 25 cost time: 0.5953948497772217
Epoch: 25, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.335 Vali Acc: 0.877 Test Loss: 0.335 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6701433658599854
Epoch: 26, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.354 Vali Acc: 0.877 Test Loss: 0.354 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.46971893310546875
Epoch: 27, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.324 Vali Acc: 0.884 Test Loss: 0.324 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.602571964263916
Epoch: 28, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.298 Vali Acc: 0.899 Test Loss: 0.298 Test Acc: 0.899
Validation loss decreased (-0.884055 --> -0.898548).  Saving model ...
Epoch: 29 cost time: 0.4478108882904053
Epoch: 29, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.312 Vali Acc: 0.884 Test Loss: 0.312 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.538088321685791
Epoch: 30, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.306 Vali Acc: 0.899 Test Loss: 0.306 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.6481232643127441
Epoch: 31, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.313 Vali Acc: 0.899 Test Loss: 0.313 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.6148996353149414
Epoch: 32, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.322 Vali Acc: 0.899 Test Loss: 0.322 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.6879720687866211
Epoch: 33, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.318 Vali Acc: 0.899 Test Loss: 0.318 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.6422648429870605
Epoch: 34, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.311 Vali Acc: 0.899 Test Loss: 0.311 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.714827299118042
Epoch: 35, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.282 Vali Acc: 0.913 Test Loss: 0.282 Test Acc: 0.913
Validation loss decreased (-0.898548 --> -0.913041).  Saving model ...
Epoch: 36 cost time: 0.6717178821563721
Epoch: 36, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.300 Vali Acc: 0.913 Test Loss: 0.300 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.6916263103485107
Epoch: 37, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.298 Vali Acc: 0.913 Test Loss: 0.298 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.6282496452331543
Epoch: 38, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.286 Vali Acc: 0.913 Test Loss: 0.286 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.5002796649932861
Epoch: 39, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.289 Vali Acc: 0.913 Test Loss: 0.289 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.6101551055908203
Epoch: 40, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.286 Vali Acc: 0.913 Test Loss: 0.286 Test Acc: 0.913
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.5813875198364258
Epoch: 41, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.277 Vali Acc: 0.913 Test Loss: 0.277 Test Acc: 0.913
Validation loss decreased (-0.913041 --> -0.913041).  Saving model ...
Epoch: 42 cost time: 0.5907201766967773
Epoch: 42, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.279 Vali Acc: 0.920 Test Loss: 0.279 Test Acc: 0.920
Validation loss decreased (-0.913041 --> -0.920287).  Saving model ...
Epoch: 43 cost time: 0.579077959060669
Epoch: 43, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.271 Vali Acc: 0.928 Test Loss: 0.271 Test Acc: 0.928
Validation loss decreased (-0.920287 --> -0.927534).  Saving model ...
Epoch: 44 cost time: 0.4714500904083252
Epoch: 44, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.271 Vali Acc: 0.935 Test Loss: 0.271 Test Acc: 0.935
Validation loss decreased (-0.927534 --> -0.934780).  Saving model ...
Epoch: 45 cost time: 0.822547197341919
Epoch: 45, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.281 Vali Acc: 0.928 Test Loss: 0.281 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.5710339546203613
Epoch: 46, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.278 Vali Acc: 0.928 Test Loss: 0.278 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.5603721141815186
Epoch: 47, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.271 Vali Acc: 0.942 Test Loss: 0.271 Test Acc: 0.942
Validation loss decreased (-0.934780 --> -0.942026).  Saving model ...
Epoch: 48 cost time: 0.5477561950683594
Epoch: 48, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.262 Vali Acc: 0.949 Test Loss: 0.262 Test Acc: 0.949
Validation loss decreased (-0.942026 --> -0.949273).  Saving model ...
Epoch: 49 cost time: 0.6515977382659912
Epoch: 49, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.268 Vali Acc: 0.949 Test Loss: 0.268 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.6031417846679688
Epoch: 50, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.276 Vali Acc: 0.942 Test Loss: 0.276 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.6614818572998047
Epoch: 51, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.275 Vali Acc: 0.949 Test Loss: 0.275 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.6521334648132324
Epoch: 52, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.258 Vali Acc: 0.949 Test Loss: 0.258 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949273).  Saving model ...
Epoch: 53 cost time: 0.5205457210540771
Epoch: 53, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.262 Vali Acc: 0.949 Test Loss: 0.262 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.6878745555877686
Epoch: 54, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.266 Vali Acc: 0.949 Test Loss: 0.266 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.6517510414123535
Epoch: 55, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.258 Vali Acc: 0.949 Test Loss: 0.258 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.559816837310791
Epoch: 56, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.268 Vali Acc: 0.949 Test Loss: 0.268 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.6455249786376953
Epoch: 57, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.259 Vali Acc: 0.949 Test Loss: 0.259 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 0.6005778312683105
Epoch: 58, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.259 Vali Acc: 0.949 Test Loss: 0.259 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 0.567188024520874
Epoch: 59, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.269 Vali Acc: 0.949 Test Loss: 0.269 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 0.6590569019317627
Epoch: 60, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.265 Vali Acc: 0.949 Test Loss: 0.265 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 0.5939373970031738
Epoch: 61, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.262 Vali Acc: 0.949 Test Loss: 0.262 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 0.4972865581512451
Epoch: 62, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.258 Vali Acc: 0.949 Test Loss: 0.258 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm128_cs13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9492753623188406
model parameter : 56822
model size : 0.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm128_cs12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.7311477661132812
Epoch: 1, Steps: 9 | Train Loss: 1.376 Vali Loss: 1.363 Vali Acc: 0.341 Test Loss: 1.363 Test Acc: 0.341
Validation loss decreased (inf --> -0.340566).  Saving model ...
Epoch: 2 cost time: 0.5384407043457031
Epoch: 2, Steps: 9 | Train Loss: 1.301 Vali Loss: 1.289 Vali Acc: 0.406 Test Loss: 1.289 Test Acc: 0.406
Validation loss decreased (-0.340566 --> -0.405784).  Saving model ...
Epoch: 3 cost time: 0.5231673717498779
Epoch: 3, Steps: 9 | Train Loss: 1.209 Vali Loss: 1.211 Vali Acc: 0.442 Test Loss: 1.211 Test Acc: 0.442
Validation loss decreased (-0.405784 --> -0.442017).  Saving model ...
Epoch: 4 cost time: 0.5541560649871826
Epoch: 4, Steps: 9 | Train Loss: 1.118 Vali Loss: 1.144 Vali Acc: 0.457 Test Loss: 1.144 Test Acc: 0.457
Validation loss decreased (-0.442017 --> -0.456510).  Saving model ...
Epoch: 5 cost time: 0.5806529521942139
Epoch: 5, Steps: 9 | Train Loss: 1.031 Vali Loss: 1.100 Vali Acc: 0.449 Test Loss: 1.100 Test Acc: 0.449
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.4954259395599365
Epoch: 6, Steps: 9 | Train Loss: 0.968 Vali Loss: 1.062 Vali Acc: 0.493 Test Loss: 1.062 Test Acc: 0.493
Validation loss decreased (-0.456510 --> -0.492743).  Saving model ...
Epoch: 7 cost time: 0.5155651569366455
Epoch: 7, Steps: 9 | Train Loss: 0.881 Vali Loss: 1.026 Vali Acc: 0.536 Test Loss: 1.026 Test Acc: 0.536
Validation loss decreased (-0.492743 --> -0.536222).  Saving model ...
Epoch: 8 cost time: 0.5223121643066406
Epoch: 8, Steps: 9 | Train Loss: 0.828 Vali Loss: 1.003 Vali Acc: 0.572 Test Loss: 1.003 Test Acc: 0.572
Validation loss decreased (-0.536222 --> -0.572454).  Saving model ...
Epoch: 9 cost time: 0.5408108234405518
Epoch: 9, Steps: 9 | Train Loss: 0.770 Vali Loss: 0.979 Vali Acc: 0.580 Test Loss: 0.979 Test Acc: 0.580
Validation loss decreased (-0.572454 --> -0.579700).  Saving model ...
Epoch: 10 cost time: 0.5760982036590576
Epoch: 10, Steps: 9 | Train Loss: 0.715 Vali Loss: 0.960 Vali Acc: 0.572 Test Loss: 0.960 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7015559673309326
Epoch: 11, Steps: 9 | Train Loss: 0.664 Vali Loss: 0.920 Vali Acc: 0.630 Test Loss: 0.920 Test Acc: 0.630
Validation loss decreased (-0.579700 --> -0.630426).  Saving model ...
Epoch: 12 cost time: 0.5294466018676758
Epoch: 12, Steps: 9 | Train Loss: 0.586 Vali Loss: 0.852 Vali Acc: 0.688 Test Loss: 0.852 Test Acc: 0.688
Validation loss decreased (-0.630426 --> -0.688397).  Saving model ...
Epoch: 13 cost time: 0.5774493217468262
Epoch: 13, Steps: 9 | Train Loss: 0.512 Vali Loss: 0.795 Vali Acc: 0.717 Test Loss: 0.795 Test Acc: 0.717
Validation loss decreased (-0.688397 --> -0.717383).  Saving model ...
Epoch: 14 cost time: 0.5417962074279785
Epoch: 14, Steps: 9 | Train Loss: 0.426 Vali Loss: 0.704 Vali Acc: 0.754 Test Loss: 0.704 Test Acc: 0.754
Validation loss decreased (-0.717383 --> -0.753616).  Saving model ...
Epoch: 15 cost time: 0.5627157688140869
Epoch: 15, Steps: 9 | Train Loss: 0.322 Vali Loss: 0.616 Vali Acc: 0.775 Test Loss: 0.616 Test Acc: 0.775
Validation loss decreased (-0.753616 --> -0.775356).  Saving model ...
Epoch: 16 cost time: 0.5274550914764404
Epoch: 16, Steps: 9 | Train Loss: 0.237 Vali Loss: 0.526 Vali Acc: 0.804 Test Loss: 0.526 Test Acc: 0.804
Validation loss decreased (-0.775356 --> -0.804343).  Saving model ...
Epoch: 17 cost time: 0.6506733894348145
Epoch: 17, Steps: 9 | Train Loss: 0.169 Vali Loss: 0.445 Vali Acc: 0.812 Test Loss: 0.445 Test Acc: 0.812
Validation loss decreased (-0.804343 --> -0.811590).  Saving model ...
Epoch: 18 cost time: 0.5184671878814697
Epoch: 18, Steps: 9 | Train Loss: 0.128 Vali Loss: 0.403 Vali Acc: 0.855 Test Loss: 0.403 Test Acc: 0.855
Validation loss decreased (-0.811590 --> -0.855068).  Saving model ...
Epoch: 19 cost time: 0.5377483367919922
Epoch: 19, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.390 Vali Acc: 0.870 Test Loss: 0.390 Test Acc: 0.870
Validation loss decreased (-0.855068 --> -0.869561).  Saving model ...
Epoch: 20 cost time: 0.5728676319122314
Epoch: 20, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.376 Vali Acc: 0.877 Test Loss: 0.376 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876808).  Saving model ...
Epoch: 21 cost time: 0.46447038650512695
Epoch: 21, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.362 Vali Acc: 0.884 Test Loss: 0.362 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884054).  Saving model ...
Epoch: 22 cost time: 0.5514705181121826
Epoch: 22, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.355 Vali Acc: 0.884 Test Loss: 0.355 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 23 cost time: 0.5614790916442871
Epoch: 23, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.319 Vali Acc: 0.891 Test Loss: 0.319 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891301).  Saving model ...
Epoch: 24 cost time: 0.5393140316009521
Epoch: 24, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.347 Vali Acc: 0.877 Test Loss: 0.347 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.502932071685791
Epoch: 25, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.340 Vali Acc: 0.884 Test Loss: 0.340 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.5842220783233643
Epoch: 26, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.347 Vali Acc: 0.884 Test Loss: 0.347 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.583514928817749
Epoch: 27, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.375 Vali Acc: 0.884 Test Loss: 0.375 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.8149290084838867
Epoch: 28, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.332 Vali Acc: 0.891 Test Loss: 0.332 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.6746401786804199
Epoch: 29, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.342 Vali Acc: 0.884 Test Loss: 0.342 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.5616858005523682
Epoch: 30, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.370 Vali Acc: 0.877 Test Loss: 0.370 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.6847474575042725
Epoch: 31, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.342 Vali Acc: 0.884 Test Loss: 0.342 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.5269818305969238
Epoch: 32, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.338 Vali Acc: 0.884 Test Loss: 0.338 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.6347091197967529
Epoch: 33, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.361 Vali Acc: 0.877 Test Loss: 0.361 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm128_cs12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 58550
model size : 0.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm128_cs11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.8678982257843018
Epoch: 1, Steps: 9 | Train Loss: 1.379 Vali Loss: 1.362 Vali Acc: 0.239 Test Loss: 1.362 Test Acc: 0.239
Validation loss decreased (inf --> -0.239117).  Saving model ...
Epoch: 2 cost time: 0.5339024066925049
Epoch: 2, Steps: 9 | Train Loss: 1.310 Vali Loss: 1.282 Vali Acc: 0.384 Test Loss: 1.282 Test Acc: 0.384
Validation loss decreased (-0.239117 --> -0.384045).  Saving model ...
Epoch: 3 cost time: 0.6313717365264893
Epoch: 3, Steps: 9 | Train Loss: 1.214 Vali Loss: 1.197 Vali Acc: 0.442 Test Loss: 1.197 Test Acc: 0.442
Validation loss decreased (-0.384045 --> -0.442017).  Saving model ...
Epoch: 4 cost time: 0.6869950294494629
Epoch: 4, Steps: 9 | Train Loss: 1.117 Vali Loss: 1.131 Vali Acc: 0.442 Test Loss: 1.131 Test Acc: 0.442
Validation loss decreased (-0.442017 --> -0.442018).  Saving model ...
Epoch: 5 cost time: 0.5020699501037598
Epoch: 5, Steps: 9 | Train Loss: 1.025 Vali Loss: 1.090 Vali Acc: 0.449 Test Loss: 1.090 Test Acc: 0.449
Validation loss decreased (-0.442018 --> -0.449264).  Saving model ...
Epoch: 6 cost time: 0.6163332462310791
Epoch: 6, Steps: 9 | Train Loss: 0.953 Vali Loss: 1.056 Vali Acc: 0.464 Test Loss: 1.056 Test Acc: 0.464
Validation loss decreased (-0.449264 --> -0.463758).  Saving model ...
Epoch: 7 cost time: 0.7469239234924316
Epoch: 7, Steps: 9 | Train Loss: 0.890 Vali Loss: 1.030 Vali Acc: 0.478 Test Loss: 1.030 Test Acc: 0.478
Validation loss decreased (-0.463758 --> -0.478251).  Saving model ...
Epoch: 8 cost time: 0.5853586196899414
Epoch: 8, Steps: 9 | Train Loss: 0.817 Vali Loss: 1.003 Vali Acc: 0.493 Test Loss: 1.003 Test Acc: 0.493
Validation loss decreased (-0.478251 --> -0.492744).  Saving model ...
Epoch: 9 cost time: 0.5812971591949463
Epoch: 9, Steps: 9 | Train Loss: 0.757 Vali Loss: 0.968 Vali Acc: 0.558 Test Loss: 0.968 Test Acc: 0.558
Validation loss decreased (-0.492744 --> -0.557961).  Saving model ...
Epoch: 10 cost time: 0.5833225250244141
Epoch: 10, Steps: 9 | Train Loss: 0.687 Vali Loss: 0.931 Vali Acc: 0.594 Test Loss: 0.931 Test Acc: 0.594
Validation loss decreased (-0.557961 --> -0.594194).  Saving model ...
Epoch: 11 cost time: 0.5076084136962891
Epoch: 11, Steps: 9 | Train Loss: 0.626 Vali Loss: 0.885 Vali Acc: 0.616 Test Loss: 0.885 Test Acc: 0.616
Validation loss decreased (-0.594194 --> -0.615933).  Saving model ...
Epoch: 12 cost time: 0.5818276405334473
Epoch: 12, Steps: 9 | Train Loss: 0.551 Vali Loss: 0.813 Vali Acc: 0.681 Test Loss: 0.813 Test Acc: 0.681
Validation loss decreased (-0.615933 --> -0.681151).  Saving model ...
Epoch: 13 cost time: 0.6028728485107422
Epoch: 13, Steps: 9 | Train Loss: 0.445 Vali Loss: 0.710 Vali Acc: 0.732 Test Loss: 0.710 Test Acc: 0.732
Validation loss decreased (-0.681151 --> -0.731877).  Saving model ...
Epoch: 14 cost time: 0.6281342506408691
Epoch: 14, Steps: 9 | Train Loss: 0.338 Vali Loss: 0.605 Vali Acc: 0.804 Test Loss: 0.605 Test Acc: 0.804
Validation loss decreased (-0.731877 --> -0.804342).  Saving model ...
Epoch: 15 cost time: 0.519359827041626
Epoch: 15, Steps: 9 | Train Loss: 0.247 Vali Loss: 0.532 Vali Acc: 0.804 Test Loss: 0.532 Test Acc: 0.804
Validation loss decreased (-0.804342 --> -0.804343).  Saving model ...
Epoch: 16 cost time: 0.5233869552612305
Epoch: 16, Steps: 9 | Train Loss: 0.193 Vali Loss: 0.491 Vali Acc: 0.812 Test Loss: 0.491 Test Acc: 0.812
Validation loss decreased (-0.804343 --> -0.811589).  Saving model ...
Epoch: 17 cost time: 0.6770570278167725
Epoch: 17, Steps: 9 | Train Loss: 0.153 Vali Loss: 0.469 Vali Acc: 0.812 Test Loss: 0.469 Test Acc: 0.812
Validation loss decreased (-0.811589 --> -0.811590).  Saving model ...
Epoch: 18 cost time: 0.5879690647125244
Epoch: 18, Steps: 9 | Train Loss: 0.123 Vali Loss: 0.437 Vali Acc: 0.833 Test Loss: 0.437 Test Acc: 0.833
Validation loss decreased (-0.811590 --> -0.833329).  Saving model ...
Epoch: 19 cost time: 0.5281193256378174
Epoch: 19, Steps: 9 | Train Loss: 0.095 Vali Loss: 0.396 Vali Acc: 0.855 Test Loss: 0.396 Test Acc: 0.855
Validation loss decreased (-0.833329 --> -0.855069).  Saving model ...
Epoch: 20 cost time: 0.569464921951294
Epoch: 20, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.390 Vali Acc: 0.862 Test Loss: 0.390 Test Acc: 0.862
Validation loss decreased (-0.855069 --> -0.862315).  Saving model ...
Epoch: 21 cost time: 0.676835298538208
Epoch: 21, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.390 Vali Acc: 0.862 Test Loss: 0.390 Test Acc: 0.862
Validation loss decreased (-0.862315 --> -0.862315).  Saving model ...
Epoch: 22 cost time: 0.6722533702850342
Epoch: 22, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.381 Vali Acc: 0.862 Test Loss: 0.381 Test Acc: 0.862
Validation loss decreased (-0.862315 --> -0.862315).  Saving model ...
Epoch: 23 cost time: 0.6848409175872803
Epoch: 23, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.366 Vali Acc: 0.877 Test Loss: 0.366 Test Acc: 0.877
Validation loss decreased (-0.862315 --> -0.876808).  Saving model ...
Epoch: 24 cost time: 0.5099163055419922
Epoch: 24, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.354 Vali Acc: 0.877 Test Loss: 0.354 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 25 cost time: 0.5955619812011719
Epoch: 25, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.341 Vali Acc: 0.891 Test Loss: 0.341 Test Acc: 0.891
Validation loss decreased (-0.876808 --> -0.891301).  Saving model ...
Epoch: 26 cost time: 0.6485962867736816
Epoch: 26, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.350 Vali Acc: 0.891 Test Loss: 0.350 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6186931133270264
Epoch: 27, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.354 Vali Acc: 0.877 Test Loss: 0.354 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6165261268615723
Epoch: 28, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.330 Vali Acc: 0.920 Test Loss: 0.330 Test Acc: 0.920
Validation loss decreased (-0.891301 --> -0.920287).  Saving model ...
Epoch: 29 cost time: 0.6854090690612793
Epoch: 29, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.325 Vali Acc: 0.928 Test Loss: 0.325 Test Acc: 0.928
Validation loss decreased (-0.920287 --> -0.927533).  Saving model ...
Epoch: 30 cost time: 0.477703332901001
Epoch: 30, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.342 Vali Acc: 0.913 Test Loss: 0.342 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7056789398193359
Epoch: 31, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.336 Vali Acc: 0.920 Test Loss: 0.336 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.5667376518249512
Epoch: 32, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.326 Vali Acc: 0.935 Test Loss: 0.326 Test Acc: 0.935
Validation loss decreased (-0.927533 --> -0.934779).  Saving model ...
Epoch: 33 cost time: 0.5528512001037598
Epoch: 33, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.334 Vali Acc: 0.935 Test Loss: 0.334 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6248626708984375
Epoch: 34, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.358 Vali Acc: 0.920 Test Loss: 0.358 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.7572805881500244
Epoch: 35, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.356 Vali Acc: 0.928 Test Loss: 0.356 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.66790771484375
Epoch: 36, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.341 Vali Acc: 0.942 Test Loss: 0.341 Test Acc: 0.942
Validation loss decreased (-0.934779 --> -0.942026).  Saving model ...
Epoch: 37 cost time: 0.5774641036987305
Epoch: 37, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.343 Vali Acc: 0.942 Test Loss: 0.343 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.5263626575469971
Epoch: 38, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.350 Vali Acc: 0.942 Test Loss: 0.350 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.6429431438446045
Epoch: 39, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.358 Vali Acc: 0.942 Test Loss: 0.358 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.5029876232147217
Epoch: 40, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.360 Vali Acc: 0.942 Test Loss: 0.360 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.6305618286132812
Epoch: 41, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.354 Vali Acc: 0.942 Test Loss: 0.354 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.46912693977355957
Epoch: 42, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.355 Vali Acc: 0.942 Test Loss: 0.355 Test Acc: 0.942
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.5338642597198486
Epoch: 43, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.356 Vali Acc: 0.942 Test Loss: 0.356 Test Acc: 0.942
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.5947065353393555
Epoch: 44, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.366 Vali Acc: 0.942 Test Loss: 0.366 Test Acc: 0.942
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.5075669288635254
Epoch: 45, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.370 Vali Acc: 0.942 Test Loss: 0.370 Test Acc: 0.942
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.6285054683685303
Epoch: 46, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.376 Vali Acc: 0.942 Test Loss: 0.376 Test Acc: 0.942
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm128_cs11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9420289855072463
model parameter : 57122
model size : 0.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm128_cs10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.0204055309295654
Epoch: 1, Steps: 9 | Train Loss: 1.314 Vali Loss: 1.342 Vali Acc: 0.406 Test Loss: 1.342 Test Acc: 0.406
Validation loss decreased (inf --> -0.405784).  Saving model ...
Epoch: 2 cost time: 0.5600001811981201
Epoch: 2, Steps: 9 | Train Loss: 1.258 Vali Loss: 1.272 Vali Acc: 0.507 Test Loss: 1.272 Test Acc: 0.507
Validation loss decreased (-0.405784 --> -0.507234).  Saving model ...
Epoch: 3 cost time: 0.5372660160064697
Epoch: 3, Steps: 9 | Train Loss: 1.172 Vali Loss: 1.201 Vali Acc: 0.529 Test Loss: 1.201 Test Acc: 0.529
Validation loss decreased (-0.507234 --> -0.528973).  Saving model ...
Epoch: 4 cost time: 0.48917508125305176
Epoch: 4, Steps: 9 | Train Loss: 1.085 Vali Loss: 1.145 Vali Acc: 0.507 Test Loss: 1.145 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.48459672927856445
Epoch: 5, Steps: 9 | Train Loss: 1.008 Vali Loss: 1.099 Vali Acc: 0.522 Test Loss: 1.099 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.48898816108703613
Epoch: 6, Steps: 9 | Train Loss: 0.950 Vali Loss: 1.073 Vali Acc: 0.507 Test Loss: 1.073 Test Acc: 0.507
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5895464420318604
Epoch: 7, Steps: 9 | Train Loss: 0.876 Vali Loss: 1.048 Vali Acc: 0.500 Test Loss: 1.048 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5082228183746338
Epoch: 8, Steps: 9 | Train Loss: 0.830 Vali Loss: 1.028 Vali Acc: 0.514 Test Loss: 1.028 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.5634217262268066
Epoch: 9, Steps: 9 | Train Loss: 0.764 Vali Loss: 0.984 Vali Acc: 0.558 Test Loss: 0.984 Test Acc: 0.558
Validation loss decreased (-0.528973 --> -0.557961).  Saving model ...
Epoch: 10 cost time: 0.5759909152984619
Epoch: 10, Steps: 9 | Train Loss: 0.700 Vali Loss: 0.944 Vali Acc: 0.587 Test Loss: 0.944 Test Acc: 0.587
Validation loss decreased (-0.557961 --> -0.586947).  Saving model ...
Epoch: 11 cost time: 0.5260822772979736
Epoch: 11, Steps: 9 | Train Loss: 0.645 Vali Loss: 0.884 Vali Acc: 0.623 Test Loss: 0.884 Test Acc: 0.623
Validation loss decreased (-0.586947 --> -0.623180).  Saving model ...
Epoch: 12 cost time: 0.6776723861694336
Epoch: 12, Steps: 9 | Train Loss: 0.544 Vali Loss: 0.793 Vali Acc: 0.674 Test Loss: 0.793 Test Acc: 0.674
Validation loss decreased (-0.623180 --> -0.673905).  Saving model ...
Epoch: 13 cost time: 0.5806045532226562
Epoch: 13, Steps: 9 | Train Loss: 0.446 Vali Loss: 0.666 Vali Acc: 0.761 Test Loss: 0.666 Test Acc: 0.761
Validation loss decreased (-0.673905 --> -0.760863).  Saving model ...
Epoch: 14 cost time: 0.6069891452789307
Epoch: 14, Steps: 9 | Train Loss: 0.323 Vali Loss: 0.517 Vali Acc: 0.855 Test Loss: 0.517 Test Acc: 0.855
Validation loss decreased (-0.760863 --> -0.855067).  Saving model ...
Epoch: 15 cost time: 0.5693075656890869
Epoch: 15, Steps: 9 | Train Loss: 0.235 Vali Loss: 0.378 Vali Acc: 0.877 Test Loss: 0.378 Test Acc: 0.877
Validation loss decreased (-0.855067 --> -0.876808).  Saving model ...
Epoch: 16 cost time: 0.5826385021209717
Epoch: 16, Steps: 9 | Train Loss: 0.138 Vali Loss: 0.288 Vali Acc: 0.920 Test Loss: 0.288 Test Acc: 0.920
Validation loss decreased (-0.876808 --> -0.920287).  Saving model ...
Epoch: 17 cost time: 0.6212894916534424
Epoch: 17, Steps: 9 | Train Loss: 0.094 Vali Loss: 0.233 Vali Acc: 0.913 Test Loss: 0.233 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6320211887359619
Epoch: 18, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.199 Vali Acc: 0.935 Test Loss: 0.199 Test Acc: 0.935
Validation loss decreased (-0.920287 --> -0.934781).  Saving model ...
Epoch: 19 cost time: 0.5322275161743164
Epoch: 19, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.182 Vali Acc: 0.949 Test Loss: 0.182 Test Acc: 0.949
Validation loss decreased (-0.934781 --> -0.949274).  Saving model ...
Epoch: 20 cost time: 0.6186680793762207
Epoch: 20, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.174 Vali Acc: 0.942 Test Loss: 0.174 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6405067443847656
Epoch: 21, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.162 Vali Acc: 0.949 Test Loss: 0.162 Test Acc: 0.949
Validation loss decreased (-0.949274 --> -0.949274).  Saving model ...
Epoch: 22 cost time: 0.5621204376220703
Epoch: 22, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.158 Vali Acc: 0.949 Test Loss: 0.158 Test Acc: 0.949
Validation loss decreased (-0.949274 --> -0.949274).  Saving model ...
Epoch: 23 cost time: 0.6256351470947266
Epoch: 23, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.149 Vali Acc: 0.949 Test Loss: 0.149 Test Acc: 0.949
Validation loss decreased (-0.949274 --> -0.949274).  Saving model ...
Epoch: 24 cost time: 0.629072904586792
Epoch: 24, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.145 Vali Acc: 0.949 Test Loss: 0.145 Test Acc: 0.949
Validation loss decreased (-0.949274 --> -0.949274).  Saving model ...
Epoch: 25 cost time: 0.5813934803009033
Epoch: 25, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.155 Vali Acc: 0.942 Test Loss: 0.155 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7254564762115479
Epoch: 26, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.147 Vali Acc: 0.957 Test Loss: 0.147 Test Acc: 0.957
Validation loss decreased (-0.949274 --> -0.956520).  Saving model ...
Epoch: 27 cost time: 0.6790816783905029
Epoch: 27, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.141 Vali Acc: 0.964 Test Loss: 0.141 Test Acc: 0.964
Validation loss decreased (-0.956520 --> -0.963767).  Saving model ...
Epoch: 28 cost time: 0.5809547901153564
Epoch: 28, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.142 Vali Acc: 0.964 Test Loss: 0.142 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6673040390014648
Epoch: 29, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.138 Vali Acc: 0.964 Test Loss: 0.138 Test Acc: 0.964
Validation loss decreased (-0.963767 --> -0.963767).  Saving model ...
Epoch: 30 cost time: 0.5261507034301758
Epoch: 30, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.149 Vali Acc: 0.957 Test Loss: 0.149 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.589343786239624
Epoch: 31, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.137 Vali Acc: 0.964 Test Loss: 0.137 Test Acc: 0.964
Validation loss decreased (-0.963767 --> -0.963767).  Saving model ...
Epoch: 32 cost time: 0.5135776996612549
Epoch: 32, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.137 Vali Acc: 0.964 Test Loss: 0.137 Test Acc: 0.964
Validation loss decreased (-0.963767 --> -0.963767).  Saving model ...
Epoch: 33 cost time: 0.5900070667266846
Epoch: 33, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.145 Vali Acc: 0.957 Test Loss: 0.145 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5710604190826416
Epoch: 34, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.141 Vali Acc: 0.964 Test Loss: 0.141 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.6012392044067383
Epoch: 35, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.140 Vali Acc: 0.971 Test Loss: 0.140 Test Acc: 0.971
Validation loss decreased (-0.963767 --> -0.971013).  Saving model ...
Epoch: 36 cost time: 0.658768892288208
Epoch: 36, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.137 Vali Acc: 0.971 Test Loss: 0.137 Test Acc: 0.971
Validation loss decreased (-0.971013 --> -0.971013).  Saving model ...
Epoch: 37 cost time: 0.7748100757598877
Epoch: 37, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.138 Vali Acc: 0.971 Test Loss: 0.138 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6331520080566406
Epoch: 38, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.140 Vali Acc: 0.964 Test Loss: 0.140 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.5446693897247314
Epoch: 39, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.137 Vali Acc: 0.971 Test Loss: 0.137 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.6781516075134277
Epoch: 40, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.137 Vali Acc: 0.971 Test Loss: 0.137 Test Acc: 0.971
Validation loss decreased (-0.971013 --> -0.971013).  Saving model ...
Epoch: 41 cost time: 0.5583536624908447
Epoch: 41, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.141 Vali Acc: 0.964 Test Loss: 0.141 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.580392599105835
Epoch: 42, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.141 Vali Acc: 0.964 Test Loss: 0.141 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.47800469398498535
Epoch: 43, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.141 Vali Acc: 0.971 Test Loss: 0.141 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.525707483291626
Epoch: 44, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.141 Vali Acc: 0.971 Test Loss: 0.141 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.5824253559112549
Epoch: 45, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.142 Vali Acc: 0.971 Test Loss: 0.142 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.48888063430786133
Epoch: 46, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.143 Vali Acc: 0.964 Test Loss: 0.143 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.5336668491363525
Epoch: 47, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.143 Vali Acc: 0.964 Test Loss: 0.143 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.6980435848236084
Epoch: 48, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.141 Vali Acc: 0.971 Test Loss: 0.141 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.6125237941741943
Epoch: 49, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.144 Vali Acc: 0.964 Test Loss: 0.144 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.5885117053985596
Epoch: 50, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.142 Vali Acc: 0.971 Test Loss: 0.142 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm128_cs10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9710144927536232
model parameter : 57432
model size : 0.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm64_cs103_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.66544771194458
Epoch: 1, Steps: 9 | Train Loss: 1.385 Vali Loss: 1.401 Vali Acc: 0.268 Test Loss: 1.401 Test Acc: 0.268
Validation loss decreased (inf --> -0.268102).  Saving model ...
Epoch: 2 cost time: 0.7078044414520264
Epoch: 2, Steps: 9 | Train Loss: 1.323 Vali Loss: 1.331 Vali Acc: 0.304 Test Loss: 1.331 Test Acc: 0.304
Validation loss decreased (-0.268102 --> -0.304335).  Saving model ...
Epoch: 3 cost time: 0.56719970703125
Epoch: 3, Steps: 9 | Train Loss: 1.233 Vali Loss: 1.249 Vali Acc: 0.391 Test Loss: 1.249 Test Acc: 0.391
Validation loss decreased (-0.304335 --> -0.391292).  Saving model ...
Epoch: 4 cost time: 0.533118486404419
Epoch: 4, Steps: 9 | Train Loss: 1.140 Vali Loss: 1.185 Vali Acc: 0.413 Test Loss: 1.185 Test Acc: 0.413
Validation loss decreased (-0.391292 --> -0.413032).  Saving model ...
Epoch: 5 cost time: 0.4905517101287842
Epoch: 5, Steps: 9 | Train Loss: 1.041 Vali Loss: 1.146 Vali Acc: 0.413 Test Loss: 1.146 Test Acc: 0.413
Validation loss decreased (-0.413032 --> -0.413032).  Saving model ...
Epoch: 6 cost time: 0.5603704452514648
Epoch: 6, Steps: 9 | Train Loss: 0.981 Vali Loss: 1.113 Vali Acc: 0.435 Test Loss: 1.113 Test Acc: 0.435
Validation loss decreased (-0.413032 --> -0.434771).  Saving model ...
Epoch: 7 cost time: 0.6162872314453125
Epoch: 7, Steps: 9 | Train Loss: 0.919 Vali Loss: 1.086 Vali Acc: 0.464 Test Loss: 1.086 Test Acc: 0.464
Validation loss decreased (-0.434771 --> -0.463757).  Saving model ...
Epoch: 8 cost time: 0.542865514755249
Epoch: 8, Steps: 9 | Train Loss: 0.846 Vali Loss: 1.065 Vali Acc: 0.486 Test Loss: 1.065 Test Acc: 0.486
Validation loss decreased (-0.463757 --> -0.485497).  Saving model ...
Epoch: 9 cost time: 0.507526159286499
Epoch: 9, Steps: 9 | Train Loss: 0.813 Vali Loss: 1.044 Vali Acc: 0.529 Test Loss: 1.044 Test Acc: 0.529
Validation loss decreased (-0.485497 --> -0.528975).  Saving model ...
Epoch: 10 cost time: 0.6175491809844971
Epoch: 10, Steps: 9 | Train Loss: 0.754 Vali Loss: 1.037 Vali Acc: 0.507 Test Loss: 1.037 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6323661804199219
Epoch: 11, Steps: 9 | Train Loss: 0.706 Vali Loss: 1.013 Vali Acc: 0.565 Test Loss: 1.013 Test Acc: 0.565
Validation loss decreased (-0.528975 --> -0.565207).  Saving model ...
Epoch: 12 cost time: 0.793377161026001
Epoch: 12, Steps: 9 | Train Loss: 0.655 Vali Loss: 1.027 Vali Acc: 0.580 Test Loss: 1.027 Test Acc: 0.580
Validation loss decreased (-0.565207 --> -0.579700).  Saving model ...
Epoch: 13 cost time: 0.5807008743286133
Epoch: 13, Steps: 9 | Train Loss: 0.613 Vali Loss: 1.014 Vali Acc: 0.551 Test Loss: 1.014 Test Acc: 0.551
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.571298360824585
Epoch: 14, Steps: 9 | Train Loss: 0.565 Vali Loss: 1.001 Vali Acc: 0.601 Test Loss: 1.001 Test Acc: 0.601
Validation loss decreased (-0.579700 --> -0.601439).  Saving model ...
Epoch: 15 cost time: 0.9117493629455566
Epoch: 15, Steps: 9 | Train Loss: 0.526 Vali Loss: 0.983 Vali Acc: 0.623 Test Loss: 0.983 Test Acc: 0.623
Validation loss decreased (-0.601439 --> -0.623179).  Saving model ...
Epoch: 16 cost time: 0.6279072761535645
Epoch: 16, Steps: 9 | Train Loss: 0.483 Vali Loss: 0.963 Vali Acc: 0.616 Test Loss: 0.963 Test Acc: 0.616
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5273523330688477
Epoch: 17, Steps: 9 | Train Loss: 0.438 Vali Loss: 0.916 Vali Acc: 0.645 Test Loss: 0.916 Test Acc: 0.645
Validation loss decreased (-0.623179 --> -0.644918).  Saving model ...
Epoch: 18 cost time: 0.5630612373352051
Epoch: 18, Steps: 9 | Train Loss: 0.371 Vali Loss: 0.884 Vali Acc: 0.667 Test Loss: 0.884 Test Acc: 0.667
Validation loss decreased (-0.644918 --> -0.666658).  Saving model ...
Epoch: 19 cost time: 0.569993257522583
Epoch: 19, Steps: 9 | Train Loss: 0.314 Vali Loss: 0.863 Vali Acc: 0.674 Test Loss: 0.863 Test Acc: 0.674
Validation loss decreased (-0.666658 --> -0.673904).  Saving model ...
Epoch: 20 cost time: 0.5518853664398193
Epoch: 20, Steps: 9 | Train Loss: 0.283 Vali Loss: 0.819 Vali Acc: 0.681 Test Loss: 0.819 Test Acc: 0.681
Validation loss decreased (-0.673904 --> -0.681151).  Saving model ...
Epoch: 21 cost time: 0.5621137619018555
Epoch: 21, Steps: 9 | Train Loss: 0.218 Vali Loss: 0.783 Vali Acc: 0.681 Test Loss: 0.783 Test Acc: 0.681
Validation loss decreased (-0.681151 --> -0.681152).  Saving model ...
Epoch: 22 cost time: 0.6325139999389648
Epoch: 22, Steps: 9 | Train Loss: 0.181 Vali Loss: 0.760 Vali Acc: 0.688 Test Loss: 0.760 Test Acc: 0.688
Validation loss decreased (-0.681152 --> -0.688398).  Saving model ...
Epoch: 23 cost time: 0.5832672119140625
Epoch: 23, Steps: 9 | Train Loss: 0.156 Vali Loss: 0.757 Vali Acc: 0.710 Test Loss: 0.757 Test Acc: 0.710
Validation loss decreased (-0.688398 --> -0.710137).  Saving model ...
Epoch: 24 cost time: 0.5732705593109131
Epoch: 24, Steps: 9 | Train Loss: 0.158 Vali Loss: 0.736 Vali Acc: 0.717 Test Loss: 0.736 Test Acc: 0.717
Validation loss decreased (-0.710137 --> -0.717384).  Saving model ...
Epoch: 25 cost time: 0.6994531154632568
Epoch: 25, Steps: 9 | Train Loss: 0.132 Vali Loss: 0.751 Vali Acc: 0.710 Test Loss: 0.751 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6037101745605469
Epoch: 26, Steps: 9 | Train Loss: 0.106 Vali Loss: 0.741 Vali Acc: 0.717 Test Loss: 0.741 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7058060169219971
Epoch: 27, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.750 Vali Acc: 0.703 Test Loss: 0.750 Test Acc: 0.703
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.5780937671661377
Epoch: 28, Steps: 9 | Train Loss: 0.080 Vali Loss: 0.759 Vali Acc: 0.710 Test Loss: 0.759 Test Acc: 0.710
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.5137810707092285
Epoch: 29, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.765 Vali Acc: 0.717 Test Loss: 0.765 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.621100902557373
Epoch: 30, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.788 Vali Acc: 0.703 Test Loss: 0.788 Test Acc: 0.703
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.6071255207061768
Epoch: 31, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.788 Vali Acc: 0.710 Test Loss: 0.788 Test Acc: 0.710
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.550267219543457
Epoch: 32, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.794 Vali Acc: 0.710 Test Loss: 0.794 Test Acc: 0.710
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.6132533550262451
Epoch: 33, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.788 Vali Acc: 0.710 Test Loss: 0.788 Test Acc: 0.710
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.5246274471282959
Epoch: 34, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.805 Vali Acc: 0.703 Test Loss: 0.805 Test Acc: 0.703
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm64_cs103_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.717391304347826
model parameter : 51946
model size : 0.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm64_cs69_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.9206194877624512
Epoch: 1, Steps: 9 | Train Loss: 1.368 Vali Loss: 1.343 Vali Acc: 0.449 Test Loss: 1.343 Test Acc: 0.449
Validation loss decreased (inf --> -0.449262).  Saving model ...
Epoch: 2 cost time: 0.6166965961456299
Epoch: 2, Steps: 9 | Train Loss: 1.295 Vali Loss: 1.277 Vali Acc: 0.471 Test Loss: 1.277 Test Acc: 0.471
Validation loss decreased (-0.449262 --> -0.471002).  Saving model ...
Epoch: 3 cost time: 0.6303162574768066
Epoch: 3, Steps: 9 | Train Loss: 1.213 Vali Loss: 1.207 Vali Acc: 0.486 Test Loss: 1.207 Test Acc: 0.486
Validation loss decreased (-0.471002 --> -0.485495).  Saving model ...
Epoch: 4 cost time: 0.7450487613677979
Epoch: 4, Steps: 9 | Train Loss: 1.115 Vali Loss: 1.146 Vali Acc: 0.449 Test Loss: 1.146 Test Acc: 0.449
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5950117111206055
Epoch: 5, Steps: 9 | Train Loss: 1.026 Vali Loss: 1.099 Vali Acc: 0.478 Test Loss: 1.099 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.68473219871521
Epoch: 6, Steps: 9 | Train Loss: 0.972 Vali Loss: 1.080 Vali Acc: 0.471 Test Loss: 1.080 Test Acc: 0.471
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6204104423522949
Epoch: 7, Steps: 9 | Train Loss: 0.904 Vali Loss: 1.050 Vali Acc: 0.471 Test Loss: 1.050 Test Acc: 0.471
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.6727085113525391
Epoch: 8, Steps: 9 | Train Loss: 0.841 Vali Loss: 1.033 Vali Acc: 0.471 Test Loss: 1.033 Test Acc: 0.471
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.6229262351989746
Epoch: 9, Steps: 9 | Train Loss: 0.786 Vali Loss: 1.008 Vali Acc: 0.529 Test Loss: 1.008 Test Acc: 0.529
Validation loss decreased (-0.485495 --> -0.528975).  Saving model ...
Epoch: 10 cost time: 0.6187329292297363
Epoch: 10, Steps: 9 | Train Loss: 0.745 Vali Loss: 1.010 Vali Acc: 0.536 Test Loss: 1.010 Test Acc: 0.536
Validation loss decreased (-0.528975 --> -0.536222).  Saving model ...
Epoch: 11 cost time: 0.707690954208374
Epoch: 11, Steps: 9 | Train Loss: 0.712 Vali Loss: 1.007 Vali Acc: 0.551 Test Loss: 1.007 Test Acc: 0.551
Validation loss decreased (-0.536222 --> -0.550715).  Saving model ...
Epoch: 12 cost time: 0.6994140148162842
Epoch: 12, Steps: 9 | Train Loss: 0.649 Vali Loss: 1.004 Vali Acc: 0.536 Test Loss: 1.004 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.537240743637085
Epoch: 13, Steps: 9 | Train Loss: 0.623 Vali Loss: 0.990 Vali Acc: 0.580 Test Loss: 0.990 Test Acc: 0.580
Validation loss decreased (-0.550715 --> -0.579700).  Saving model ...
Epoch: 14 cost time: 0.6804797649383545
Epoch: 14, Steps: 9 | Train Loss: 0.582 Vali Loss: 1.003 Vali Acc: 0.565 Test Loss: 1.003 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6215736865997314
Epoch: 15, Steps: 9 | Train Loss: 0.555 Vali Loss: 0.996 Vali Acc: 0.609 Test Loss: 0.996 Test Acc: 0.609
Validation loss decreased (-0.579700 --> -0.608686).  Saving model ...
Epoch: 16 cost time: 0.5690295696258545
Epoch: 16, Steps: 9 | Train Loss: 0.516 Vali Loss: 0.994 Vali Acc: 0.601 Test Loss: 0.994 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5915317535400391
Epoch: 17, Steps: 9 | Train Loss: 0.472 Vali Loss: 0.989 Vali Acc: 0.594 Test Loss: 0.989 Test Acc: 0.594
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6432199478149414
Epoch: 18, Steps: 9 | Train Loss: 0.434 Vali Loss: 1.000 Vali Acc: 0.601 Test Loss: 1.000 Test Acc: 0.601
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.6547207832336426
Epoch: 19, Steps: 9 | Train Loss: 0.396 Vali Loss: 0.955 Vali Acc: 0.616 Test Loss: 0.955 Test Acc: 0.616
Validation loss decreased (-0.608686 --> -0.615932).  Saving model ...
Epoch: 20 cost time: 0.6064629554748535
Epoch: 20, Steps: 9 | Train Loss: 0.351 Vali Loss: 0.944 Vali Acc: 0.630 Test Loss: 0.944 Test Acc: 0.630
Validation loss decreased (-0.615932 --> -0.630425).  Saving model ...
Epoch: 21 cost time: 0.5032260417938232
Epoch: 21, Steps: 9 | Train Loss: 0.315 Vali Loss: 0.935 Vali Acc: 0.623 Test Loss: 0.935 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6252775192260742
Epoch: 22, Steps: 9 | Train Loss: 0.263 Vali Loss: 0.919 Vali Acc: 0.630 Test Loss: 0.919 Test Acc: 0.630
Validation loss decreased (-0.630425 --> -0.630426).  Saving model ...
Epoch: 23 cost time: 0.5772771835327148
Epoch: 23, Steps: 9 | Train Loss: 0.232 Vali Loss: 0.849 Vali Acc: 0.652 Test Loss: 0.849 Test Acc: 0.652
Validation loss decreased (-0.630426 --> -0.652165).  Saving model ...
Epoch: 24 cost time: 0.5923240184783936
Epoch: 24, Steps: 9 | Train Loss: 0.192 Vali Loss: 0.830 Vali Acc: 0.659 Test Loss: 0.830 Test Acc: 0.659
Validation loss decreased (-0.652165 --> -0.659412).  Saving model ...
Epoch: 25 cost time: 0.5848462581634521
Epoch: 25, Steps: 9 | Train Loss: 0.153 Vali Loss: 0.871 Vali Acc: 0.652 Test Loss: 0.871 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6232059001922607
Epoch: 26, Steps: 9 | Train Loss: 0.133 Vali Loss: 0.882 Vali Acc: 0.659 Test Loss: 0.882 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5499558448791504
Epoch: 27, Steps: 9 | Train Loss: 0.116 Vali Loss: 0.831 Vali Acc: 0.681 Test Loss: 0.831 Test Acc: 0.681
Validation loss decreased (-0.659412 --> -0.681151).  Saving model ...
Epoch: 28 cost time: 0.6906118392944336
Epoch: 28, Steps: 9 | Train Loss: 0.103 Vali Loss: 0.858 Vali Acc: 0.667 Test Loss: 0.858 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5710084438323975
Epoch: 29, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.904 Vali Acc: 0.652 Test Loss: 0.904 Test Acc: 0.652
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.7313523292541504
Epoch: 30, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.901 Vali Acc: 0.659 Test Loss: 0.901 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.6017940044403076
Epoch: 31, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.877 Vali Acc: 0.659 Test Loss: 0.877 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.5786795616149902
Epoch: 32, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.955 Vali Acc: 0.652 Test Loss: 0.955 Test Acc: 0.652
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.6694009304046631
Epoch: 33, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.968 Vali Acc: 0.667 Test Loss: 0.968 Test Acc: 0.667
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.5644512176513672
Epoch: 34, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.990 Vali Acc: 0.667 Test Loss: 0.990 Test Acc: 0.667
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.5998785495758057
Epoch: 35, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.983 Vali Acc: 0.659 Test Loss: 0.983 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.6304178237915039
Epoch: 36, Steps: 9 | Train Loss: 0.038 Vali Loss: 1.012 Vali Acc: 0.667 Test Loss: 1.012 Test Acc: 0.667
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.5835874080657959
Epoch: 37, Steps: 9 | Train Loss: 0.034 Vali Loss: 1.040 Vali Acc: 0.667 Test Loss: 1.040 Test Acc: 0.667
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm64_cs69_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.6811594202898551
model parameter : 51078
model size : 0.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm64_cs52_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.900545358657837
Epoch: 1, Steps: 9 | Train Loss: 1.445 Vali Loss: 1.348 Vali Acc: 0.362 Test Loss: 1.348 Test Acc: 0.362
Validation loss decreased (inf --> -0.362305).  Saving model ...
Epoch: 2 cost time: 0.5907862186431885
Epoch: 2, Steps: 9 | Train Loss: 1.369 Vali Loss: 1.268 Vali Acc: 0.449 Test Loss: 1.268 Test Acc: 0.449
Validation loss decreased (-0.362305 --> -0.449263).  Saving model ...
Epoch: 3 cost time: 0.5164544582366943
Epoch: 3, Steps: 9 | Train Loss: 1.255 Vali Loss: 1.186 Vali Acc: 0.464 Test Loss: 1.186 Test Acc: 0.464
Validation loss decreased (-0.449263 --> -0.463756).  Saving model ...
Epoch: 4 cost time: 0.6468615531921387
Epoch: 4, Steps: 9 | Train Loss: 1.151 Vali Loss: 1.115 Vali Acc: 0.507 Test Loss: 1.115 Test Acc: 0.507
Validation loss decreased (-0.463756 --> -0.507235).  Saving model ...
Epoch: 5 cost time: 0.6037545204162598
Epoch: 5, Steps: 9 | Train Loss: 1.043 Vali Loss: 1.066 Vali Acc: 0.500 Test Loss: 1.066 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6202929019927979
Epoch: 6, Steps: 9 | Train Loss: 0.972 Vali Loss: 1.037 Vali Acc: 0.514 Test Loss: 1.037 Test Acc: 0.514
Validation loss decreased (-0.507235 --> -0.514482).  Saving model ...
Epoch: 7 cost time: 0.5965867042541504
Epoch: 7, Steps: 9 | Train Loss: 0.914 Vali Loss: 1.013 Vali Acc: 0.522 Test Loss: 1.013 Test Acc: 0.522
Validation loss decreased (-0.514482 --> -0.521729).  Saving model ...
Epoch: 8 cost time: 0.5895953178405762
Epoch: 8, Steps: 9 | Train Loss: 0.879 Vali Loss: 1.004 Vali Acc: 0.522 Test Loss: 1.004 Test Acc: 0.522
Validation loss decreased (-0.521729 --> -0.521729).  Saving model ...
Epoch: 9 cost time: 0.6005966663360596
Epoch: 9, Steps: 9 | Train Loss: 0.809 Vali Loss: 0.985 Vali Acc: 0.529 Test Loss: 0.985 Test Acc: 0.529
Validation loss decreased (-0.521729 --> -0.528976).  Saving model ...
Epoch: 10 cost time: 0.6602303981781006
Epoch: 10, Steps: 9 | Train Loss: 0.784 Vali Loss: 0.974 Vali Acc: 0.551 Test Loss: 0.974 Test Acc: 0.551
Validation loss decreased (-0.528976 --> -0.550715).  Saving model ...
Epoch: 11 cost time: 0.7752630710601807
Epoch: 11, Steps: 9 | Train Loss: 0.719 Vali Loss: 0.962 Vali Acc: 0.551 Test Loss: 0.962 Test Acc: 0.551
Validation loss decreased (-0.550715 --> -0.550715).  Saving model ...
Epoch: 12 cost time: 0.5488059520721436
Epoch: 12, Steps: 9 | Train Loss: 0.682 Vali Loss: 0.957 Vali Acc: 0.536 Test Loss: 0.957 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6702134609222412
Epoch: 13, Steps: 9 | Train Loss: 0.637 Vali Loss: 0.946 Vali Acc: 0.558 Test Loss: 0.946 Test Acc: 0.558
Validation loss decreased (-0.550715 --> -0.557962).  Saving model ...
Epoch: 14 cost time: 0.5389165878295898
Epoch: 14, Steps: 9 | Train Loss: 0.606 Vali Loss: 0.942 Vali Acc: 0.565 Test Loss: 0.942 Test Acc: 0.565
Validation loss decreased (-0.557962 --> -0.565208).  Saving model ...
Epoch: 15 cost time: 0.6632390022277832
Epoch: 15, Steps: 9 | Train Loss: 0.564 Vali Loss: 0.958 Vali Acc: 0.594 Test Loss: 0.958 Test Acc: 0.594
Validation loss decreased (-0.565208 --> -0.594193).  Saving model ...
Epoch: 16 cost time: 0.7593636512756348
Epoch: 16, Steps: 9 | Train Loss: 0.527 Vali Loss: 0.960 Vali Acc: 0.601 Test Loss: 0.960 Test Acc: 0.601
Validation loss decreased (-0.594193 --> -0.601440).  Saving model ...
Epoch: 17 cost time: 0.6900315284729004
Epoch: 17, Steps: 9 | Train Loss: 0.499 Vali Loss: 0.949 Vali Acc: 0.609 Test Loss: 0.949 Test Acc: 0.609
Validation loss decreased (-0.601440 --> -0.608686).  Saving model ...
Epoch: 18 cost time: 0.6705946922302246
Epoch: 18, Steps: 9 | Train Loss: 0.462 Vali Loss: 0.958 Vali Acc: 0.616 Test Loss: 0.958 Test Acc: 0.616
Validation loss decreased (-0.608686 --> -0.615932).  Saving model ...
Epoch: 19 cost time: 0.6388285160064697
Epoch: 19, Steps: 9 | Train Loss: 0.425 Vali Loss: 0.951 Vali Acc: 0.638 Test Loss: 0.951 Test Acc: 0.638
Validation loss decreased (-0.615932 --> -0.637672).  Saving model ...
Epoch: 20 cost time: 0.6269125938415527
Epoch: 20, Steps: 9 | Train Loss: 0.389 Vali Loss: 0.947 Vali Acc: 0.638 Test Loss: 0.947 Test Acc: 0.638
Validation loss decreased (-0.637672 --> -0.637672).  Saving model ...
Epoch: 21 cost time: 0.5394494533538818
Epoch: 21, Steps: 9 | Train Loss: 0.361 Vali Loss: 0.924 Vali Acc: 0.674 Test Loss: 0.924 Test Acc: 0.674
Validation loss decreased (-0.637672 --> -0.673904).  Saving model ...
Epoch: 22 cost time: 0.6968851089477539
Epoch: 22, Steps: 9 | Train Loss: 0.320 Vali Loss: 0.923 Vali Acc: 0.674 Test Loss: 0.923 Test Acc: 0.674
Validation loss decreased (-0.673904 --> -0.673904).  Saving model ...
Epoch: 23 cost time: 0.5498273372650146
Epoch: 23, Steps: 9 | Train Loss: 0.286 Vali Loss: 0.906 Vali Acc: 0.659 Test Loss: 0.906 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6739108562469482
Epoch: 24, Steps: 9 | Train Loss: 0.242 Vali Loss: 0.836 Vali Acc: 0.703 Test Loss: 0.836 Test Acc: 0.703
Validation loss decreased (-0.673904 --> -0.702890).  Saving model ...
Epoch: 25 cost time: 0.6473774909973145
Epoch: 25, Steps: 9 | Train Loss: 0.208 Vali Loss: 0.788 Vali Acc: 0.710 Test Loss: 0.788 Test Acc: 0.710
Validation loss decreased (-0.702890 --> -0.710137).  Saving model ...
Epoch: 26 cost time: 0.7705042362213135
Epoch: 26, Steps: 9 | Train Loss: 0.171 Vali Loss: 0.728 Vali Acc: 0.725 Test Loss: 0.728 Test Acc: 0.725
Validation loss decreased (-0.710137 --> -0.724630).  Saving model ...
Epoch: 27 cost time: 0.6516339778900146
Epoch: 27, Steps: 9 | Train Loss: 0.139 Vali Loss: 0.703 Vali Acc: 0.710 Test Loss: 0.703 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6675300598144531
Epoch: 28, Steps: 9 | Train Loss: 0.111 Vali Loss: 0.665 Vali Acc: 0.732 Test Loss: 0.665 Test Acc: 0.732
Validation loss decreased (-0.724630 --> -0.731877).  Saving model ...
Epoch: 29 cost time: 0.5703966617584229
Epoch: 29, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.632 Vali Acc: 0.746 Test Loss: 0.632 Test Acc: 0.746
Validation loss decreased (-0.731877 --> -0.746370).  Saving model ...
Epoch: 30 cost time: 0.6702430248260498
Epoch: 30, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.608 Vali Acc: 0.761 Test Loss: 0.608 Test Acc: 0.761
Validation loss decreased (-0.746370 --> -0.760863).  Saving model ...
Epoch: 31 cost time: 0.5863296985626221
Epoch: 31, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.580 Vali Acc: 0.783 Test Loss: 0.580 Test Acc: 0.783
Validation loss decreased (-0.760863 --> -0.782603).  Saving model ...
Epoch: 32 cost time: 0.5645833015441895
Epoch: 32, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.564 Vali Acc: 0.797 Test Loss: 0.564 Test Acc: 0.797
Validation loss decreased (-0.782603 --> -0.797096).  Saving model ...
Epoch: 33 cost time: 0.47214484214782715
Epoch: 33, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.567 Vali Acc: 0.804 Test Loss: 0.567 Test Acc: 0.804
Validation loss decreased (-0.797096 --> -0.804342).  Saving model ...
Epoch: 34 cost time: 0.5013763904571533
Epoch: 34, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.551 Vali Acc: 0.812 Test Loss: 0.551 Test Acc: 0.812
Validation loss decreased (-0.804342 --> -0.811589).  Saving model ...
Epoch: 35 cost time: 0.5231161117553711
Epoch: 35, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.550 Vali Acc: 0.812 Test Loss: 0.550 Test Acc: 0.812
Validation loss decreased (-0.811589 --> -0.811589).  Saving model ...
Epoch: 36 cost time: 0.7631139755249023
Epoch: 36, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.542 Vali Acc: 0.819 Test Loss: 0.542 Test Acc: 0.819
Validation loss decreased (-0.811589 --> -0.818835).  Saving model ...
Epoch: 37 cost time: 0.6411726474761963
Epoch: 37, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.554 Vali Acc: 0.819 Test Loss: 0.554 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.5103161334991455
Epoch: 38, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.542 Vali Acc: 0.833 Test Loss: 0.542 Test Acc: 0.833
Validation loss decreased (-0.818835 --> -0.833328).  Saving model ...
Epoch: 39 cost time: 0.6417970657348633
Epoch: 39, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.539 Vali Acc: 0.833 Test Loss: 0.539 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 40 cost time: 0.5548892021179199
Epoch: 40, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.546 Vali Acc: 0.841 Test Loss: 0.546 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840574).  Saving model ...
Epoch: 41 cost time: 0.6525499820709229
Epoch: 41, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.534 Vali Acc: 0.841 Test Loss: 0.534 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840574).  Saving model ...
Epoch: 42 cost time: 0.5237929821014404
Epoch: 42, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.545 Vali Acc: 0.841 Test Loss: 0.545 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.5646083354949951
Epoch: 43, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.548 Vali Acc: 0.841 Test Loss: 0.548 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.8240625858306885
Epoch: 44, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.546 Vali Acc: 0.841 Test Loss: 0.546 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.7807400226593018
Epoch: 45, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.558 Vali Acc: 0.841 Test Loss: 0.558 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.6310954093933105
Epoch: 46, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.547 Vali Acc: 0.841 Test Loss: 0.547 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.5780580043792725
Epoch: 47, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.551 Vali Acc: 0.841 Test Loss: 0.551 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.6367521286010742
Epoch: 48, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.566 Vali Acc: 0.848 Test Loss: 0.566 Test Acc: 0.848
Validation loss decreased (-0.840574 --> -0.847820).  Saving model ...
Epoch: 49 cost time: 0.607891321182251
Epoch: 49, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.563 Vali Acc: 0.848 Test Loss: 0.563 Test Acc: 0.848
Validation loss decreased (-0.847820 --> -0.847820).  Saving model ...
Epoch: 50 cost time: 0.5891954898834229
Epoch: 50, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.559 Vali Acc: 0.841 Test Loss: 0.559 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.7517545223236084
Epoch: 51, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.555 Vali Acc: 0.848 Test Loss: 0.555 Test Acc: 0.848
Validation loss decreased (-0.847820 --> -0.847821).  Saving model ...
Epoch: 52 cost time: 0.523679256439209
Epoch: 52, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.572 Vali Acc: 0.848 Test Loss: 0.572 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.516554594039917
Epoch: 53, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.558 Vali Acc: 0.855 Test Loss: 0.558 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855067).  Saving model ...
Epoch: 54 cost time: 0.5611834526062012
Epoch: 54, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.572 Vali Acc: 0.855 Test Loss: 0.572 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.6170337200164795
Epoch: 55, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.566 Vali Acc: 0.848 Test Loss: 0.566 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.5938189029693604
Epoch: 56, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.571 Vali Acc: 0.848 Test Loss: 0.571 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.5743238925933838
Epoch: 57, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.586 Vali Acc: 0.841 Test Loss: 0.586 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 0.6248095035552979
Epoch: 58, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.576 Vali Acc: 0.841 Test Loss: 0.576 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 0.49556612968444824
Epoch: 59, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.575 Vali Acc: 0.841 Test Loss: 0.575 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 0.5970110893249512
Epoch: 60, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.581 Vali Acc: 0.841 Test Loss: 0.581 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 0.43501710891723633
Epoch: 61, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.586 Vali Acc: 0.841 Test Loss: 0.586 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 0.5671474933624268
Epoch: 62, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.589 Vali Acc: 0.841 Test Loss: 0.589 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 0.5488355159759521
Epoch: 63, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.583 Vali Acc: 0.841 Test Loss: 0.583 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm64_cs52_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 50758
model size : 0.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm64_cs42_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 1.6193833351135254
Epoch: 1, Steps: 9 | Train Loss: 1.445 Vali Loss: 1.395 Vali Acc: 0.275 Test Loss: 1.395 Test Acc: 0.275
Validation loss decreased (inf --> -0.275348).  Saving model ...
Epoch: 2 cost time: 0.6541495323181152
Epoch: 2, Steps: 9 | Train Loss: 1.366 Vali Loss: 1.321 Vali Acc: 0.348 Test Loss: 1.321 Test Acc: 0.348
Validation loss decreased (-0.275348 --> -0.347813).  Saving model ...
Epoch: 3 cost time: 0.5581784248352051
Epoch: 3, Steps: 9 | Train Loss: 1.264 Vali Loss: 1.237 Vali Acc: 0.413 Test Loss: 1.237 Test Acc: 0.413
Validation loss decreased (-0.347813 --> -0.413031).  Saving model ...
Epoch: 4 cost time: 0.5551226139068604
Epoch: 4, Steps: 9 | Train Loss: 1.185 Vali Loss: 1.175 Vali Acc: 0.428 Test Loss: 1.175 Test Acc: 0.428
Validation loss decreased (-0.413031 --> -0.427524).  Saving model ...
Epoch: 5 cost time: 0.690692663192749
Epoch: 5, Steps: 9 | Train Loss: 1.086 Vali Loss: 1.127 Vali Acc: 0.442 Test Loss: 1.127 Test Acc: 0.442
Validation loss decreased (-0.427524 --> -0.442018).  Saving model ...
Epoch: 6 cost time: 0.7271316051483154
Epoch: 6, Steps: 9 | Train Loss: 0.994 Vali Loss: 1.099 Vali Acc: 0.435 Test Loss: 1.099 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6346571445465088
Epoch: 7, Steps: 9 | Train Loss: 0.937 Vali Loss: 1.072 Vali Acc: 0.486 Test Loss: 1.072 Test Acc: 0.486
Validation loss decreased (-0.442018 --> -0.485497).  Saving model ...
Epoch: 8 cost time: 0.592562198638916
Epoch: 8, Steps: 9 | Train Loss: 0.885 Vali Loss: 1.050 Vali Acc: 0.471 Test Loss: 1.050 Test Acc: 0.471
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6247892379760742
Epoch: 9, Steps: 9 | Train Loss: 0.814 Vali Loss: 1.038 Vali Acc: 0.493 Test Loss: 1.038 Test Acc: 0.493
Validation loss decreased (-0.485497 --> -0.492743).  Saving model ...
Epoch: 10 cost time: 0.580958366394043
Epoch: 10, Steps: 9 | Train Loss: 0.763 Vali Loss: 1.030 Vali Acc: 0.486 Test Loss: 1.030 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5425255298614502
Epoch: 11, Steps: 9 | Train Loss: 0.733 Vali Loss: 1.017 Vali Acc: 0.522 Test Loss: 1.017 Test Acc: 0.522
Validation loss decreased (-0.492743 --> -0.521729).  Saving model ...
Epoch: 12 cost time: 0.5835399627685547
Epoch: 12, Steps: 9 | Train Loss: 0.681 Vali Loss: 1.005 Vali Acc: 0.580 Test Loss: 1.005 Test Acc: 0.580
Validation loss decreased (-0.521729 --> -0.579700).  Saving model ...
Epoch: 13 cost time: 0.5582823753356934
Epoch: 13, Steps: 9 | Train Loss: 0.631 Vali Loss: 0.997 Vali Acc: 0.587 Test Loss: 0.997 Test Acc: 0.587
Validation loss decreased (-0.579700 --> -0.586947).  Saving model ...
Epoch: 14 cost time: 0.5010266304016113
Epoch: 14, Steps: 9 | Train Loss: 0.603 Vali Loss: 0.989 Vali Acc: 0.594 Test Loss: 0.989 Test Acc: 0.594
Validation loss decreased (-0.586947 --> -0.594193).  Saving model ...
Epoch: 15 cost time: 0.6130640506744385
Epoch: 15, Steps: 9 | Train Loss: 0.550 Vali Loss: 0.987 Vali Acc: 0.594 Test Loss: 0.987 Test Acc: 0.594
Validation loss decreased (-0.594193 --> -0.594193).  Saving model ...
Epoch: 16 cost time: 0.6330323219299316
Epoch: 16, Steps: 9 | Train Loss: 0.512 Vali Loss: 0.986 Vali Acc: 0.601 Test Loss: 0.986 Test Acc: 0.601
Validation loss decreased (-0.594193 --> -0.601439).  Saving model ...
Epoch: 17 cost time: 0.5632238388061523
Epoch: 17, Steps: 9 | Train Loss: 0.472 Vali Loss: 0.994 Vali Acc: 0.609 Test Loss: 0.994 Test Acc: 0.609
Validation loss decreased (-0.601439 --> -0.608686).  Saving model ...
Epoch: 18 cost time: 0.5590512752532959
Epoch: 18, Steps: 9 | Train Loss: 0.423 Vali Loss: 1.003 Vali Acc: 0.616 Test Loss: 1.003 Test Acc: 0.616
Validation loss decreased (-0.608686 --> -0.615932).  Saving model ...
Epoch: 19 cost time: 0.5724937915802002
Epoch: 19, Steps: 9 | Train Loss: 0.381 Vali Loss: 0.993 Vali Acc: 0.609 Test Loss: 0.993 Test Acc: 0.609
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.548842191696167
Epoch: 20, Steps: 9 | Train Loss: 0.348 Vali Loss: 0.967 Vali Acc: 0.616 Test Loss: 0.967 Test Acc: 0.616
Validation loss decreased (-0.615932 --> -0.615932).  Saving model ...
Epoch: 21 cost time: 0.6172282695770264
Epoch: 21, Steps: 9 | Train Loss: 0.322 Vali Loss: 0.978 Vali Acc: 0.630 Test Loss: 0.978 Test Acc: 0.630
Validation loss decreased (-0.615932 --> -0.630425).  Saving model ...
Epoch: 22 cost time: 0.5739829540252686
Epoch: 22, Steps: 9 | Train Loss: 0.278 Vali Loss: 0.986 Vali Acc: 0.638 Test Loss: 0.986 Test Acc: 0.638
Validation loss decreased (-0.630425 --> -0.637671).  Saving model ...
Epoch: 23 cost time: 0.505687952041626
Epoch: 23, Steps: 9 | Train Loss: 0.244 Vali Loss: 0.960 Vali Acc: 0.638 Test Loss: 0.960 Test Acc: 0.638
Validation loss decreased (-0.637671 --> -0.637672).  Saving model ...
Epoch: 24 cost time: 0.4702911376953125
Epoch: 24, Steps: 9 | Train Loss: 0.221 Vali Loss: 0.964 Vali Acc: 0.638 Test Loss: 0.964 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5926034450531006
Epoch: 25, Steps: 9 | Train Loss: 0.204 Vali Loss: 0.959 Vali Acc: 0.645 Test Loss: 0.959 Test Acc: 0.645
Validation loss decreased (-0.637672 --> -0.644918).  Saving model ...
Epoch: 26 cost time: 0.5150139331817627
Epoch: 26, Steps: 9 | Train Loss: 0.168 Vali Loss: 0.947 Vali Acc: 0.667 Test Loss: 0.947 Test Acc: 0.667
Validation loss decreased (-0.644918 --> -0.666657).  Saving model ...
Epoch: 27 cost time: 0.5255448818206787
Epoch: 27, Steps: 9 | Train Loss: 0.153 Vali Loss: 0.942 Vali Acc: 0.659 Test Loss: 0.942 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5943007469177246
Epoch: 28, Steps: 9 | Train Loss: 0.137 Vali Loss: 0.946 Vali Acc: 0.659 Test Loss: 0.946 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.5332658290863037
Epoch: 29, Steps: 9 | Train Loss: 0.120 Vali Loss: 0.952 Vali Acc: 0.652 Test Loss: 0.952 Test Acc: 0.652
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.5404572486877441
Epoch: 30, Steps: 9 | Train Loss: 0.112 Vali Loss: 0.967 Vali Acc: 0.652 Test Loss: 0.967 Test Acc: 0.652
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.5309226512908936
Epoch: 31, Steps: 9 | Train Loss: 0.103 Vali Loss: 0.958 Vali Acc: 0.652 Test Loss: 0.958 Test Acc: 0.652
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.5348203182220459
Epoch: 32, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.974 Vali Acc: 0.652 Test Loss: 0.974 Test Acc: 0.652
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.5548191070556641
Epoch: 33, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.988 Vali Acc: 0.659 Test Loss: 0.988 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.5509223937988281
Epoch: 34, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.995 Vali Acc: 0.674 Test Loss: 0.995 Test Acc: 0.674
Validation loss decreased (-0.666657 --> -0.673903).  Saving model ...
Epoch: 35 cost time: 0.4865148067474365
Epoch: 35, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.993 Vali Acc: 0.667 Test Loss: 0.993 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6377263069152832
Epoch: 36, Steps: 9 | Train Loss: 0.058 Vali Loss: 1.015 Vali Acc: 0.667 Test Loss: 1.015 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.5919373035430908
Epoch: 37, Steps: 9 | Train Loss: 0.054 Vali Loss: 1.022 Vali Acc: 0.667 Test Loss: 1.022 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.5588362216949463
Epoch: 38, Steps: 9 | Train Loss: 0.044 Vali Loss: 1.043 Vali Acc: 0.667 Test Loss: 1.043 Test Acc: 0.667
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.5258347988128662
Epoch: 39, Steps: 9 | Train Loss: 0.039 Vali Loss: 1.046 Vali Acc: 0.667 Test Loss: 1.046 Test Acc: 0.667
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.5780274868011475
Epoch: 40, Steps: 9 | Train Loss: 0.035 Vali Loss: 1.054 Vali Acc: 0.674 Test Loss: 1.054 Test Acc: 0.674
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.5826475620269775
Epoch: 41, Steps: 9 | Train Loss: 0.033 Vali Loss: 1.050 Vali Acc: 0.674 Test Loss: 1.050 Test Acc: 0.674
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.4655752182006836
Epoch: 42, Steps: 9 | Train Loss: 0.028 Vali Loss: 1.048 Vali Acc: 0.681 Test Loss: 1.048 Test Acc: 0.681
Validation loss decreased (-0.673903 --> -0.681149).  Saving model ...
Epoch: 43 cost time: 0.6653709411621094
Epoch: 43, Steps: 9 | Train Loss: 0.025 Vali Loss: 1.053 Vali Acc: 0.696 Test Loss: 1.053 Test Acc: 0.696
Validation loss decreased (-0.681149 --> -0.695642).  Saving model ...
Epoch: 44 cost time: 0.5213472843170166
Epoch: 44, Steps: 9 | Train Loss: 0.023 Vali Loss: 1.057 Vali Acc: 0.688 Test Loss: 1.057 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.5559313297271729
Epoch: 45, Steps: 9 | Train Loss: 0.021 Vali Loss: 1.072 Vali Acc: 0.688 Test Loss: 1.072 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.654289722442627
Epoch: 46, Steps: 9 | Train Loss: 0.018 Vali Loss: 1.091 Vali Acc: 0.688 Test Loss: 1.091 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.6113917827606201
Epoch: 47, Steps: 9 | Train Loss: 0.018 Vali Loss: 1.104 Vali Acc: 0.688 Test Loss: 1.104 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.5459494590759277
Epoch: 48, Steps: 9 | Train Loss: 0.016 Vali Loss: 1.096 Vali Acc: 0.688 Test Loss: 1.096 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.5813584327697754
Epoch: 49, Steps: 9 | Train Loss: 0.013 Vali Loss: 1.109 Vali Acc: 0.688 Test Loss: 1.109 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.6371276378631592
Epoch: 50, Steps: 9 | Train Loss: 0.012 Vali Loss: 1.111 Vali Acc: 0.688 Test Loss: 1.111 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 0.5292165279388428
Epoch: 51, Steps: 9 | Train Loss: 0.012 Vali Loss: 1.111 Vali Acc: 0.688 Test Loss: 1.111 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 0.7280588150024414
Epoch: 52, Steps: 9 | Train Loss: 0.010 Vali Loss: 1.116 Vali Acc: 0.696 Test Loss: 1.116 Test Acc: 0.696
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 0.5822019577026367
Epoch: 53, Steps: 9 | Train Loss: 0.009 Vali Loss: 1.122 Vali Acc: 0.696 Test Loss: 1.122 Test Acc: 0.696
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm64_cs42_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.6956521739130435
model parameter : 50872
model size : 0.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm64_cs35_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.0987730026245117
Epoch: 1, Steps: 9 | Train Loss: 1.411 Vali Loss: 1.437 Vali Acc: 0.261 Test Loss: 1.437 Test Acc: 0.261
Validation loss decreased (inf --> -0.260855).  Saving model ...
Epoch: 2 cost time: 0.5994513034820557
Epoch: 2, Steps: 9 | Train Loss: 1.344 Vali Loss: 1.360 Vali Acc: 0.377 Test Loss: 1.360 Test Acc: 0.377
Validation loss decreased (-0.260855 --> -0.376798).  Saving model ...
Epoch: 3 cost time: 0.7442796230316162
Epoch: 3, Steps: 9 | Train Loss: 1.243 Vali Loss: 1.270 Vali Acc: 0.435 Test Loss: 1.270 Test Acc: 0.435
Validation loss decreased (-0.376798 --> -0.434770).  Saving model ...
Epoch: 4 cost time: 0.9187304973602295
Epoch: 4, Steps: 9 | Train Loss: 1.143 Vali Loss: 1.193 Vali Acc: 0.420 Test Loss: 1.193 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6174120903015137
Epoch: 5, Steps: 9 | Train Loss: 1.075 Vali Loss: 1.146 Vali Acc: 0.420 Test Loss: 1.146 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7543563842773438
Epoch: 6, Steps: 9 | Train Loss: 0.971 Vali Loss: 1.115 Vali Acc: 0.428 Test Loss: 1.115 Test Acc: 0.428
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.66949462890625
Epoch: 7, Steps: 9 | Train Loss: 0.908 Vali Loss: 1.079 Vali Acc: 0.457 Test Loss: 1.079 Test Acc: 0.457
Validation loss decreased (-0.434770 --> -0.456511).  Saving model ...
Epoch: 8 cost time: 0.5131306648254395
Epoch: 8, Steps: 9 | Train Loss: 0.870 Vali Loss: 1.058 Vali Acc: 0.471 Test Loss: 1.058 Test Acc: 0.471
Validation loss decreased (-0.456511 --> -0.471004).  Saving model ...
Epoch: 9 cost time: 0.5592994689941406
Epoch: 9, Steps: 9 | Train Loss: 0.812 Vali Loss: 1.045 Vali Acc: 0.471 Test Loss: 1.045 Test Acc: 0.471
Validation loss decreased (-0.471004 --> -0.471004).  Saving model ...
Epoch: 10 cost time: 0.6411478519439697
Epoch: 10, Steps: 9 | Train Loss: 0.751 Vali Loss: 1.022 Vali Acc: 0.536 Test Loss: 1.022 Test Acc: 0.536
Validation loss decreased (-0.471004 --> -0.536222).  Saving model ...
Epoch: 11 cost time: 0.49331116676330566
Epoch: 11, Steps: 9 | Train Loss: 0.708 Vali Loss: 0.998 Vali Acc: 0.536 Test Loss: 0.998 Test Acc: 0.536
Validation loss decreased (-0.536222 --> -0.536222).  Saving model ...
Epoch: 12 cost time: 0.5817434787750244
Epoch: 12, Steps: 9 | Train Loss: 0.670 Vali Loss: 0.999 Vali Acc: 0.558 Test Loss: 0.999 Test Acc: 0.558
Validation loss decreased (-0.536222 --> -0.557961).  Saving model ...
Epoch: 13 cost time: 0.5608572959899902
Epoch: 13, Steps: 9 | Train Loss: 0.608 Vali Loss: 0.978 Vali Acc: 0.565 Test Loss: 0.978 Test Acc: 0.565
Validation loss decreased (-0.557961 --> -0.565208).  Saving model ...
Epoch: 14 cost time: 0.5577373504638672
Epoch: 14, Steps: 9 | Train Loss: 0.557 Vali Loss: 0.950 Vali Acc: 0.587 Test Loss: 0.950 Test Acc: 0.587
Validation loss decreased (-0.565208 --> -0.586947).  Saving model ...
Epoch: 15 cost time: 0.5419490337371826
Epoch: 15, Steps: 9 | Train Loss: 0.498 Vali Loss: 0.926 Vali Acc: 0.630 Test Loss: 0.926 Test Acc: 0.630
Validation loss decreased (-0.586947 --> -0.630426).  Saving model ...
Epoch: 16 cost time: 0.8366894721984863
Epoch: 16, Steps: 9 | Train Loss: 0.449 Vali Loss: 0.902 Vali Acc: 0.630 Test Loss: 0.902 Test Acc: 0.630
Validation loss decreased (-0.630426 --> -0.630426).  Saving model ...
Epoch: 17 cost time: 0.5435993671417236
Epoch: 17, Steps: 9 | Train Loss: 0.395 Vali Loss: 0.864 Vali Acc: 0.652 Test Loss: 0.864 Test Acc: 0.652
Validation loss decreased (-0.630426 --> -0.652165).  Saving model ...
Epoch: 18 cost time: 0.5809640884399414
Epoch: 18, Steps: 9 | Train Loss: 0.347 Vali Loss: 0.818 Vali Acc: 0.667 Test Loss: 0.818 Test Acc: 0.667
Validation loss decreased (-0.652165 --> -0.666658).  Saving model ...
Epoch: 19 cost time: 0.5951888561248779
Epoch: 19, Steps: 9 | Train Loss: 0.293 Vali Loss: 0.780 Vali Acc: 0.688 Test Loss: 0.780 Test Acc: 0.688
Validation loss decreased (-0.666658 --> -0.688398).  Saving model ...
Epoch: 20 cost time: 0.664975643157959
Epoch: 20, Steps: 9 | Train Loss: 0.260 Vali Loss: 0.748 Vali Acc: 0.674 Test Loss: 0.748 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6630995273590088
Epoch: 21, Steps: 9 | Train Loss: 0.228 Vali Loss: 0.739 Vali Acc: 0.688 Test Loss: 0.739 Test Acc: 0.688
Validation loss decreased (-0.688398 --> -0.688398).  Saving model ...
Epoch: 22 cost time: 0.553879976272583
Epoch: 22, Steps: 9 | Train Loss: 0.201 Vali Loss: 0.748 Vali Acc: 0.674 Test Loss: 0.748 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5998589992523193
Epoch: 23, Steps: 9 | Train Loss: 0.181 Vali Loss: 0.733 Vali Acc: 0.688 Test Loss: 0.733 Test Acc: 0.688
Validation loss decreased (-0.688398 --> -0.688398).  Saving model ...
Epoch: 24 cost time: 0.49251222610473633
Epoch: 24, Steps: 9 | Train Loss: 0.158 Vali Loss: 0.722 Vali Acc: 0.681 Test Loss: 0.722 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5503575801849365
Epoch: 25, Steps: 9 | Train Loss: 0.154 Vali Loss: 0.730 Vali Acc: 0.688 Test Loss: 0.730 Test Acc: 0.688
Validation loss decreased (-0.688398 --> -0.688399).  Saving model ...
Epoch: 26 cost time: 0.7220265865325928
Epoch: 26, Steps: 9 | Train Loss: 0.126 Vali Loss: 0.738 Vali Acc: 0.681 Test Loss: 0.738 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6546337604522705
Epoch: 27, Steps: 9 | Train Loss: 0.122 Vali Loss: 0.753 Vali Acc: 0.681 Test Loss: 0.753 Test Acc: 0.681
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.5558722019195557
Epoch: 28, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.764 Vali Acc: 0.688 Test Loss: 0.764 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.7260665893554688
Epoch: 29, Steps: 9 | Train Loss: 0.100 Vali Loss: 0.769 Vali Acc: 0.696 Test Loss: 0.769 Test Acc: 0.696
Validation loss decreased (-0.688399 --> -0.695644).  Saving model ...
Epoch: 30 cost time: 0.49832653999328613
Epoch: 30, Steps: 9 | Train Loss: 0.083 Vali Loss: 0.767 Vali Acc: 0.703 Test Loss: 0.767 Test Acc: 0.703
Validation loss decreased (-0.695644 --> -0.702891).  Saving model ...
Epoch: 31 cost time: 0.6623513698577881
Epoch: 31, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.768 Vali Acc: 0.717 Test Loss: 0.768 Test Acc: 0.717
Validation loss decreased (-0.702891 --> -0.717384).  Saving model ...
Epoch: 32 cost time: 0.5731227397918701
Epoch: 32, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.766 Vali Acc: 0.703 Test Loss: 0.766 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5320606231689453
Epoch: 33, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.788 Vali Acc: 0.703 Test Loss: 0.788 Test Acc: 0.703
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.46814632415771484
Epoch: 34, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.769 Vali Acc: 0.710 Test Loss: 0.769 Test Acc: 0.710
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.4967672824859619
Epoch: 35, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.771 Vali Acc: 0.717 Test Loss: 0.771 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.585782527923584
Epoch: 36, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.783 Vali Acc: 0.732 Test Loss: 0.783 Test Acc: 0.732
Validation loss decreased (-0.717384 --> -0.731876).  Saving model ...
Epoch: 37 cost time: 0.6514244079589844
Epoch: 37, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.790 Vali Acc: 0.717 Test Loss: 0.790 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6096413135528564
Epoch: 38, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.794 Vali Acc: 0.717 Test Loss: 0.794 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.7875914573669434
Epoch: 39, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.802 Vali Acc: 0.732 Test Loss: 0.802 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.8000161647796631
Epoch: 40, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.789 Vali Acc: 0.725 Test Loss: 0.789 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.58349609375
Epoch: 41, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.800 Vali Acc: 0.717 Test Loss: 0.800 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.6579201221466064
Epoch: 42, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.810 Vali Acc: 0.739 Test Loss: 0.810 Test Acc: 0.739
Validation loss decreased (-0.731876 --> -0.739122).  Saving model ...
Epoch: 43 cost time: 0.6152286529541016
Epoch: 43, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.811 Vali Acc: 0.732 Test Loss: 0.811 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.5596983432769775
Epoch: 44, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.812 Vali Acc: 0.732 Test Loss: 0.812 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.613426923751831
Epoch: 45, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.825 Vali Acc: 0.739 Test Loss: 0.825 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.5644352436065674
Epoch: 46, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.819 Vali Acc: 0.739 Test Loss: 0.819 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.6973423957824707
Epoch: 47, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.810 Vali Acc: 0.739 Test Loss: 0.810 Test Acc: 0.739
Validation loss decreased (-0.739122 --> -0.739122).  Saving model ...
Epoch: 48 cost time: 0.7700352668762207
Epoch: 48, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.827 Vali Acc: 0.732 Test Loss: 0.827 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.5713164806365967
Epoch: 49, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.834 Vali Acc: 0.732 Test Loss: 0.834 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.6104199886322021
Epoch: 50, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.834 Vali Acc: 0.732 Test Loss: 0.834 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.7748608589172363
Epoch: 51, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.836 Vali Acc: 0.739 Test Loss: 0.836 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.6173379421234131
Epoch: 52, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.844 Vali Acc: 0.739 Test Loss: 0.844 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 0.5873169898986816
Epoch: 53, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.841 Vali Acc: 0.746 Test Loss: 0.841 Test Acc: 0.746
Validation loss decreased (-0.739122 --> -0.746368).  Saving model ...
Epoch: 54 cost time: 0.6488399505615234
Epoch: 54, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.838 Vali Acc: 0.746 Test Loss: 0.838 Test Acc: 0.746
Validation loss decreased (-0.746368 --> -0.746368).  Saving model ...
Epoch: 55 cost time: 0.666780948638916
Epoch: 55, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.845 Vali Acc: 0.746 Test Loss: 0.845 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.7209482192993164
Epoch: 56, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.851 Vali Acc: 0.746 Test Loss: 0.851 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.6024725437164307
Epoch: 57, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.856 Vali Acc: 0.754 Test Loss: 0.856 Test Acc: 0.754
Validation loss decreased (-0.746368 --> -0.753615).  Saving model ...
Epoch: 58 cost time: 0.601496696472168
Epoch: 58, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.853 Vali Acc: 0.761 Test Loss: 0.853 Test Acc: 0.761
Validation loss decreased (-0.753615 --> -0.760861).  Saving model ...
Epoch: 59 cost time: 0.5870816707611084
Epoch: 59, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.853 Vali Acc: 0.761 Test Loss: 0.853 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.6332912445068359
Epoch: 60, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.867 Vali Acc: 0.761 Test Loss: 0.867 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.6758551597595215
Epoch: 61, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.860 Vali Acc: 0.768 Test Loss: 0.860 Test Acc: 0.768
Validation loss decreased (-0.760861 --> -0.768107).  Saving model ...
Epoch: 62 cost time: 0.6100943088531494
Epoch: 62, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.870 Vali Acc: 0.775 Test Loss: 0.870 Test Acc: 0.775
Validation loss decreased (-0.768107 --> -0.775354).  Saving model ...
Epoch: 63 cost time: 0.6473240852355957
Epoch: 63, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.876 Vali Acc: 0.783 Test Loss: 0.876 Test Acc: 0.783
Validation loss decreased (-0.775354 --> -0.782600).  Saving model ...
Epoch: 64 cost time: 0.5534341335296631
Epoch: 64, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.874 Vali Acc: 0.783 Test Loss: 0.874 Test Acc: 0.783
Validation loss decreased (-0.782600 --> -0.782600).  Saving model ...
Epoch: 65 cost time: 0.8117396831512451
Epoch: 65, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.869 Vali Acc: 0.783 Test Loss: 0.869 Test Acc: 0.783
Validation loss decreased (-0.782600 --> -0.782600).  Saving model ...
Epoch: 66 cost time: 0.6583683490753174
Epoch: 66, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.873 Vali Acc: 0.783 Test Loss: 0.873 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.7020025253295898
Epoch: 67, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.877 Vali Acc: 0.783 Test Loss: 0.877 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.6663239002227783
Epoch: 68, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.873 Vali Acc: 0.783 Test Loss: 0.873 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 0.555051326751709
Epoch: 69, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.873 Vali Acc: 0.790 Test Loss: 0.873 Test Acc: 0.790
Validation loss decreased (-0.782600 --> -0.789846).  Saving model ...
Epoch: 70 cost time: 0.6640822887420654
Epoch: 70, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.890 Vali Acc: 0.790 Test Loss: 0.890 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.7291674613952637
Epoch: 71, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.890 Vali Acc: 0.790 Test Loss: 0.890 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 0.5793569087982178
Epoch: 72, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.889 Vali Acc: 0.790 Test Loss: 0.889 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 0.6584334373474121
Epoch: 73, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.902 Vali Acc: 0.790 Test Loss: 0.902 Test Acc: 0.790
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 0.5560884475708008
Epoch: 74, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.891 Vali Acc: 0.790 Test Loss: 0.891 Test Acc: 0.790
EarlyStopping counter: 5 out of 10
Epoch: 75 cost time: 0.6192722320556641
Epoch: 75, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.893 Vali Acc: 0.790 Test Loss: 0.893 Test Acc: 0.790
EarlyStopping counter: 6 out of 10
Epoch: 76 cost time: 0.636143684387207
Epoch: 76, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.900 Vali Acc: 0.790 Test Loss: 0.900 Test Acc: 0.790
EarlyStopping counter: 7 out of 10
Epoch: 77 cost time: 0.7476167678833008
Epoch: 77, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.912 Vali Acc: 0.790 Test Loss: 0.912 Test Acc: 0.790
EarlyStopping counter: 8 out of 10
Epoch: 78 cost time: 0.7301185131072998
Epoch: 78, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.909 Vali Acc: 0.790 Test Loss: 0.909 Test Acc: 0.790
EarlyStopping counter: 9 out of 10
Epoch: 79 cost time: 0.76841139793396
Epoch: 79, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.912 Vali Acc: 0.790 Test Loss: 0.912 Test Acc: 0.790
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm64_cs35_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.7898550724637681
model parameter : 50674
model size : 0.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm64_cs30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.0779449939727783
Epoch: 1, Steps: 9 | Train Loss: 1.392 Vali Loss: 1.411 Vali Acc: 0.290 Test Loss: 1.411 Test Acc: 0.290
Validation loss decreased (inf --> -0.289841).  Saving model ...
Epoch: 2 cost time: 0.8007946014404297
Epoch: 2, Steps: 9 | Train Loss: 1.325 Vali Loss: 1.335 Vali Acc: 0.319 Test Loss: 1.335 Test Acc: 0.319
Validation loss decreased (-0.289841 --> -0.318827).  Saving model ...
Epoch: 3 cost time: 0.8049547672271729
Epoch: 3, Steps: 9 | Train Loss: 1.220 Vali Loss: 1.253 Vali Acc: 0.391 Test Loss: 1.253 Test Acc: 0.391
Validation loss decreased (-0.318827 --> -0.391292).  Saving model ...
Epoch: 4 cost time: 0.695213794708252
Epoch: 4, Steps: 9 | Train Loss: 1.128 Vali Loss: 1.189 Vali Acc: 0.435 Test Loss: 1.189 Test Acc: 0.435
Validation loss decreased (-0.391292 --> -0.434771).  Saving model ...
Epoch: 5 cost time: 0.7711117267608643
Epoch: 5, Steps: 9 | Train Loss: 1.031 Vali Loss: 1.133 Vali Acc: 0.471 Test Loss: 1.133 Test Acc: 0.471
Validation loss decreased (-0.434771 --> -0.471003).  Saving model ...
Epoch: 6 cost time: 0.9547414779663086
Epoch: 6, Steps: 9 | Train Loss: 0.962 Vali Loss: 1.103 Vali Acc: 0.493 Test Loss: 1.103 Test Acc: 0.493
Validation loss decreased (-0.471003 --> -0.492743).  Saving model ...
Epoch: 7 cost time: 0.670006275177002
Epoch: 7, Steps: 9 | Train Loss: 0.896 Vali Loss: 1.074 Vali Acc: 0.493 Test Loss: 1.074 Test Acc: 0.493
Validation loss decreased (-0.492743 --> -0.492743).  Saving model ...
Epoch: 8 cost time: 0.7651636600494385
Epoch: 8, Steps: 9 | Train Loss: 0.842 Vali Loss: 1.059 Vali Acc: 0.486 Test Loss: 1.059 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6686246395111084
Epoch: 9, Steps: 9 | Train Loss: 0.797 Vali Loss: 1.049 Vali Acc: 0.493 Test Loss: 1.049 Test Acc: 0.493
Validation loss decreased (-0.492743 --> -0.492743).  Saving model ...
Epoch: 10 cost time: 0.7206497192382812
Epoch: 10, Steps: 9 | Train Loss: 0.751 Vali Loss: 1.042 Vali Acc: 0.493 Test Loss: 1.042 Test Acc: 0.493
Validation loss decreased (-0.492743 --> -0.492743).  Saving model ...
Epoch: 11 cost time: 0.7190449237823486
Epoch: 11, Steps: 9 | Train Loss: 0.719 Vali Loss: 1.023 Vali Acc: 0.507 Test Loss: 1.023 Test Acc: 0.507
Validation loss decreased (-0.492743 --> -0.507236).  Saving model ...
Epoch: 12 cost time: 0.7808208465576172
Epoch: 12, Steps: 9 | Train Loss: 0.688 Vali Loss: 1.023 Vali Acc: 0.543 Test Loss: 1.023 Test Acc: 0.543
Validation loss decreased (-0.507236 --> -0.543468).  Saving model ...
Epoch: 13 cost time: 0.6189901828765869
Epoch: 13, Steps: 9 | Train Loss: 0.639 Vali Loss: 1.021 Vali Acc: 0.565 Test Loss: 1.021 Test Acc: 0.565
Validation loss decreased (-0.543468 --> -0.565207).  Saving model ...
Epoch: 14 cost time: 0.7929232120513916
Epoch: 14, Steps: 9 | Train Loss: 0.594 Vali Loss: 1.025 Vali Acc: 0.558 Test Loss: 1.025 Test Acc: 0.558
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7045660018920898
Epoch: 15, Steps: 9 | Train Loss: 0.573 Vali Loss: 1.021 Vali Acc: 0.558 Test Loss: 1.021 Test Acc: 0.558
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8626646995544434
Epoch: 16, Steps: 9 | Train Loss: 0.525 Vali Loss: 1.021 Vali Acc: 0.580 Test Loss: 1.021 Test Acc: 0.580
Validation loss decreased (-0.565207 --> -0.579700).  Saving model ...
Epoch: 17 cost time: 0.8524270057678223
Epoch: 17, Steps: 9 | Train Loss: 0.498 Vali Loss: 1.027 Vali Acc: 0.580 Test Loss: 1.027 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8501200675964355
Epoch: 18, Steps: 9 | Train Loss: 0.473 Vali Loss: 1.032 Vali Acc: 0.580 Test Loss: 1.032 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6684491634368896
Epoch: 19, Steps: 9 | Train Loss: 0.438 Vali Loss: 1.023 Vali Acc: 0.587 Test Loss: 1.023 Test Acc: 0.587
Validation loss decreased (-0.579700 --> -0.586946).  Saving model ...
Epoch: 20 cost time: 0.6645529270172119
Epoch: 20, Steps: 9 | Train Loss: 0.396 Vali Loss: 1.016 Vali Acc: 0.630 Test Loss: 1.016 Test Acc: 0.630
Validation loss decreased (-0.586946 --> -0.630425).  Saving model ...
Epoch: 21 cost time: 0.797466516494751
Epoch: 21, Steps: 9 | Train Loss: 0.371 Vali Loss: 1.003 Vali Acc: 0.623 Test Loss: 1.003 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6437914371490479
Epoch: 22, Steps: 9 | Train Loss: 0.311 Vali Loss: 0.951 Vali Acc: 0.645 Test Loss: 0.951 Test Acc: 0.645
Validation loss decreased (-0.630425 --> -0.644918).  Saving model ...
Epoch: 23 cost time: 0.6713340282440186
Epoch: 23, Steps: 9 | Train Loss: 0.253 Vali Loss: 0.908 Vali Acc: 0.638 Test Loss: 0.908 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7383022308349609
Epoch: 24, Steps: 9 | Train Loss: 0.212 Vali Loss: 0.858 Vali Acc: 0.652 Test Loss: 0.858 Test Acc: 0.652
Validation loss decreased (-0.644918 --> -0.652165).  Saving model ...
Epoch: 25 cost time: 0.619356632232666
Epoch: 25, Steps: 9 | Train Loss: 0.176 Vali Loss: 0.781 Vali Acc: 0.659 Test Loss: 0.781 Test Acc: 0.659
Validation loss decreased (-0.652165 --> -0.659412).  Saving model ...
Epoch: 26 cost time: 0.6105918884277344
Epoch: 26, Steps: 9 | Train Loss: 0.148 Vali Loss: 0.791 Vali Acc: 0.681 Test Loss: 0.791 Test Acc: 0.681
Validation loss decreased (-0.659412 --> -0.681152).  Saving model ...
Epoch: 27 cost time: 0.8552463054656982
Epoch: 27, Steps: 9 | Train Loss: 0.124 Vali Loss: 0.792 Vali Acc: 0.688 Test Loss: 0.792 Test Acc: 0.688
Validation loss decreased (-0.681152 --> -0.688398).  Saving model ...
Epoch: 28 cost time: 0.7289023399353027
Epoch: 28, Steps: 9 | Train Loss: 0.110 Vali Loss: 0.806 Vali Acc: 0.674 Test Loss: 0.806 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7185540199279785
Epoch: 29, Steps: 9 | Train Loss: 0.096 Vali Loss: 0.757 Vali Acc: 0.725 Test Loss: 0.757 Test Acc: 0.725
Validation loss decreased (-0.688398 --> -0.724630).  Saving model ...
Epoch: 30 cost time: 0.7866339683532715
Epoch: 30, Steps: 9 | Train Loss: 0.080 Vali Loss: 0.768 Vali Acc: 0.725 Test Loss: 0.768 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7301909923553467
Epoch: 31, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.781 Vali Acc: 0.739 Test Loss: 0.781 Test Acc: 0.739
Validation loss decreased (-0.724630 --> -0.739123).  Saving model ...
Epoch: 32 cost time: 0.735844612121582
Epoch: 32, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.772 Vali Acc: 0.732 Test Loss: 0.772 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8233098983764648
Epoch: 33, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.781 Vali Acc: 0.754 Test Loss: 0.781 Test Acc: 0.754
Validation loss decreased (-0.739123 --> -0.753615).  Saving model ...
Epoch: 34 cost time: 0.7552778720855713
Epoch: 34, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.777 Vali Acc: 0.746 Test Loss: 0.777 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9947206974029541
Epoch: 35, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.776 Vali Acc: 0.739 Test Loss: 0.776 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.7963435649871826
Epoch: 36, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.755 Vali Acc: 0.768 Test Loss: 0.755 Test Acc: 0.768
Validation loss decreased (-0.753615 --> -0.768108).  Saving model ...
Epoch: 37 cost time: 0.7582566738128662
Epoch: 37, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.749 Vali Acc: 0.775 Test Loss: 0.749 Test Acc: 0.775
Validation loss decreased (-0.768108 --> -0.775355).  Saving model ...
Epoch: 38 cost time: 0.7411482334136963
Epoch: 38, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.744 Vali Acc: 0.790 Test Loss: 0.744 Test Acc: 0.790
Validation loss decreased (-0.775355 --> -0.789848).  Saving model ...
Epoch: 39 cost time: 0.768007755279541
Epoch: 39, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.744 Vali Acc: 0.790 Test Loss: 0.744 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.7780501842498779
Epoch: 40, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.770 Vali Acc: 0.797 Test Loss: 0.770 Test Acc: 0.797
Validation loss decreased (-0.789848 --> -0.797094).  Saving model ...
Epoch: 41 cost time: 0.8376345634460449
Epoch: 41, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.771 Vali Acc: 0.797 Test Loss: 0.771 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.7435610294342041
Epoch: 42, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.754 Vali Acc: 0.804 Test Loss: 0.754 Test Acc: 0.804
Validation loss decreased (-0.797094 --> -0.804340).  Saving model ...
Epoch: 43 cost time: 0.6616225242614746
Epoch: 43, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.748 Vali Acc: 0.804 Test Loss: 0.748 Test Acc: 0.804
Validation loss decreased (-0.804340 --> -0.804340).  Saving model ...
Epoch: 44 cost time: 0.8245294094085693
Epoch: 44, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.759 Vali Acc: 0.819 Test Loss: 0.759 Test Acc: 0.819
Validation loss decreased (-0.804340 --> -0.818833).  Saving model ...
Epoch: 45 cost time: 0.787200927734375
Epoch: 45, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.757 Vali Acc: 0.819 Test Loss: 0.757 Test Acc: 0.819
Validation loss decreased (-0.818833 --> -0.818833).  Saving model ...
Epoch: 46 cost time: 0.6130986213684082
Epoch: 46, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.755 Vali Acc: 0.826 Test Loss: 0.755 Test Acc: 0.826
Validation loss decreased (-0.818833 --> -0.826079).  Saving model ...
Epoch: 47 cost time: 0.8295159339904785
Epoch: 47, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.764 Vali Acc: 0.826 Test Loss: 0.764 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.7423620223999023
Epoch: 48, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.778 Vali Acc: 0.819 Test Loss: 0.778 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.8264989852905273
Epoch: 49, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.782 Vali Acc: 0.819 Test Loss: 0.782 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.9140939712524414
Epoch: 50, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.769 Vali Acc: 0.804 Test Loss: 0.769 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.6955022811889648
Epoch: 51, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.771 Vali Acc: 0.826 Test Loss: 0.771 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.857043981552124
Epoch: 52, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.789 Vali Acc: 0.812 Test Loss: 0.789 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.9028646945953369
Epoch: 53, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.789 Vali Acc: 0.804 Test Loss: 0.789 Test Acc: 0.804
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 0.8069875240325928
Epoch: 54, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.799 Vali Acc: 0.812 Test Loss: 0.799 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 0.7905905246734619
Epoch: 55, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.805 Vali Acc: 0.812 Test Loss: 0.805 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 0.9028294086456299
Epoch: 56, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.802 Vali Acc: 0.812 Test Loss: 0.802 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm64_cs30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8260869565217391
model parameter : 50544
model size : 0.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm64_cs26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.389141321182251
Epoch: 1, Steps: 9 | Train Loss: 1.476 Vali Loss: 1.432 Vali Acc: 0.232 Test Loss: 1.432 Test Acc: 0.232
Validation loss decreased (inf --> -0.231870).  Saving model ...
Epoch: 2 cost time: 0.7636127471923828
Epoch: 2, Steps: 9 | Train Loss: 1.404 Vali Loss: 1.343 Vali Acc: 0.377 Test Loss: 1.343 Test Acc: 0.377
Validation loss decreased (-0.231870 --> -0.376798).  Saving model ...
Epoch: 3 cost time: 0.7602107524871826
Epoch: 3, Steps: 9 | Train Loss: 1.285 Vali Loss: 1.254 Vali Acc: 0.457 Test Loss: 1.254 Test Acc: 0.457
Validation loss decreased (-0.376798 --> -0.456509).  Saving model ...
Epoch: 4 cost time: 0.8177132606506348
Epoch: 4, Steps: 9 | Train Loss: 1.171 Vali Loss: 1.172 Vali Acc: 0.500 Test Loss: 1.172 Test Acc: 0.500
Validation loss decreased (-0.456509 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 0.9423336982727051
Epoch: 5, Steps: 9 | Train Loss: 1.059 Vali Loss: 1.118 Vali Acc: 0.507 Test Loss: 1.118 Test Acc: 0.507
Validation loss decreased (-0.499988 --> -0.507235).  Saving model ...
Epoch: 6 cost time: 0.8064298629760742
Epoch: 6, Steps: 9 | Train Loss: 0.986 Vali Loss: 1.084 Vali Acc: 0.514 Test Loss: 1.084 Test Acc: 0.514
Validation loss decreased (-0.507235 --> -0.514482).  Saving model ...
Epoch: 7 cost time: 0.9174950122833252
Epoch: 7, Steps: 9 | Train Loss: 0.918 Vali Loss: 1.058 Vali Acc: 0.500 Test Loss: 1.058 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7163088321685791
Epoch: 8, Steps: 9 | Train Loss: 0.875 Vali Loss: 1.040 Vali Acc: 0.507 Test Loss: 1.040 Test Acc: 0.507
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.642542839050293
Epoch: 9, Steps: 9 | Train Loss: 0.811 Vali Loss: 1.015 Vali Acc: 0.529 Test Loss: 1.015 Test Acc: 0.529
Validation loss decreased (-0.514482 --> -0.528975).  Saving model ...
Epoch: 10 cost time: 0.6462793350219727
Epoch: 10, Steps: 9 | Train Loss: 0.751 Vali Loss: 0.990 Vali Acc: 0.543 Test Loss: 0.990 Test Acc: 0.543
Validation loss decreased (-0.528975 --> -0.543468).  Saving model ...
Epoch: 11 cost time: 0.773878812789917
Epoch: 11, Steps: 9 | Train Loss: 0.705 Vali Loss: 0.981 Vali Acc: 0.543 Test Loss: 0.981 Test Acc: 0.543
Validation loss decreased (-0.543468 --> -0.543468).  Saving model ...
Epoch: 12 cost time: 0.7262063026428223
Epoch: 12, Steps: 9 | Train Loss: 0.668 Vali Loss: 0.969 Vali Acc: 0.565 Test Loss: 0.969 Test Acc: 0.565
Validation loss decreased (-0.543468 --> -0.565208).  Saving model ...
Epoch: 13 cost time: 0.7542555332183838
Epoch: 13, Steps: 9 | Train Loss: 0.627 Vali Loss: 0.964 Vali Acc: 0.565 Test Loss: 0.964 Test Acc: 0.565
Validation loss decreased (-0.565208 --> -0.565208).  Saving model ...
Epoch: 14 cost time: 0.8029723167419434
Epoch: 14, Steps: 9 | Train Loss: 0.585 Vali Loss: 0.952 Vali Acc: 0.572 Test Loss: 0.952 Test Acc: 0.572
Validation loss decreased (-0.565208 --> -0.572454).  Saving model ...
Epoch: 15 cost time: 0.7942178249359131
Epoch: 15, Steps: 9 | Train Loss: 0.543 Vali Loss: 0.945 Vali Acc: 0.601 Test Loss: 0.945 Test Acc: 0.601
Validation loss decreased (-0.572454 --> -0.601440).  Saving model ...
Epoch: 16 cost time: 0.9513013362884521
Epoch: 16, Steps: 9 | Train Loss: 0.512 Vali Loss: 0.930 Vali Acc: 0.630 Test Loss: 0.930 Test Acc: 0.630
Validation loss decreased (-0.601440 --> -0.630425).  Saving model ...
Epoch: 17 cost time: 0.7414062023162842
Epoch: 17, Steps: 9 | Train Loss: 0.462 Vali Loss: 0.924 Vali Acc: 0.609 Test Loss: 0.924 Test Acc: 0.609
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7289350032806396
Epoch: 18, Steps: 9 | Train Loss: 0.423 Vali Loss: 0.934 Vali Acc: 0.630 Test Loss: 0.934 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0265932083129883
Epoch: 19, Steps: 9 | Train Loss: 0.383 Vali Loss: 0.899 Vali Acc: 0.659 Test Loss: 0.899 Test Acc: 0.659
Validation loss decreased (-0.630425 --> -0.659411).  Saving model ...
Epoch: 20 cost time: 0.8375763893127441
Epoch: 20, Steps: 9 | Train Loss: 0.354 Vali Loss: 0.870 Vali Acc: 0.667 Test Loss: 0.870 Test Acc: 0.667
Validation loss decreased (-0.659411 --> -0.666658).  Saving model ...
Epoch: 21 cost time: 1.0095725059509277
Epoch: 21, Steps: 9 | Train Loss: 0.319 Vali Loss: 0.861 Vali Acc: 0.674 Test Loss: 0.861 Test Acc: 0.674
Validation loss decreased (-0.666658 --> -0.673904).  Saving model ...
Epoch: 22 cost time: 0.9083025455474854
Epoch: 22, Steps: 9 | Train Loss: 0.279 Vali Loss: 0.847 Vali Acc: 0.688 Test Loss: 0.847 Test Acc: 0.688
Validation loss decreased (-0.673904 --> -0.688397).  Saving model ...
Epoch: 23 cost time: 0.6778454780578613
Epoch: 23, Steps: 9 | Train Loss: 0.237 Vali Loss: 0.790 Vali Acc: 0.696 Test Loss: 0.790 Test Acc: 0.696
Validation loss decreased (-0.688397 --> -0.695644).  Saving model ...
Epoch: 24 cost time: 0.8839921951293945
Epoch: 24, Steps: 9 | Train Loss: 0.209 Vali Loss: 0.770 Vali Acc: 0.696 Test Loss: 0.770 Test Acc: 0.696
Validation loss decreased (-0.695644 --> -0.695644).  Saving model ...
Epoch: 25 cost time: 1.009711503982544
Epoch: 25, Steps: 9 | Train Loss: 0.170 Vali Loss: 0.723 Vali Acc: 0.739 Test Loss: 0.723 Test Acc: 0.739
Validation loss decreased (-0.695644 --> -0.739123).  Saving model ...
Epoch: 26 cost time: 1.1862003803253174
Epoch: 26, Steps: 9 | Train Loss: 0.138 Vali Loss: 0.681 Vali Acc: 0.739 Test Loss: 0.681 Test Acc: 0.739
Validation loss decreased (-0.739123 --> -0.739124).  Saving model ...
Epoch: 27 cost time: 0.89035964012146
Epoch: 27, Steps: 9 | Train Loss: 0.114 Vali Loss: 0.663 Vali Acc: 0.754 Test Loss: 0.663 Test Acc: 0.754
Validation loss decreased (-0.739124 --> -0.753617).  Saving model ...
Epoch: 28 cost time: 1.09552001953125
Epoch: 28, Steps: 9 | Train Loss: 0.096 Vali Loss: 0.653 Vali Acc: 0.761 Test Loss: 0.653 Test Acc: 0.761
Validation loss decreased (-0.753617 --> -0.760863).  Saving model ...
Epoch: 29 cost time: 0.9253964424133301
Epoch: 29, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.615 Vali Acc: 0.775 Test Loss: 0.615 Test Acc: 0.775
Validation loss decreased (-0.760863 --> -0.775356).  Saving model ...
Epoch: 30 cost time: 0.9675765037536621
Epoch: 30, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.599 Vali Acc: 0.761 Test Loss: 0.599 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.166994571685791
Epoch: 31, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.576 Vali Acc: 0.783 Test Loss: 0.576 Test Acc: 0.783
Validation loss decreased (-0.775356 --> -0.782603).  Saving model ...
Epoch: 32 cost time: 0.8124942779541016
Epoch: 32, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.566 Vali Acc: 0.797 Test Loss: 0.566 Test Acc: 0.797
Validation loss decreased (-0.782603 --> -0.797096).  Saving model ...
Epoch: 33 cost time: 0.9505846500396729
Epoch: 33, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.547 Vali Acc: 0.819 Test Loss: 0.547 Test Acc: 0.819
Validation loss decreased (-0.797096 --> -0.818835).  Saving model ...
Epoch: 34 cost time: 1.1047472953796387
Epoch: 34, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.531 Vali Acc: 0.819 Test Loss: 0.531 Test Acc: 0.819
Validation loss decreased (-0.818835 --> -0.818835).  Saving model ...
Epoch: 35 cost time: 0.9093499183654785
Epoch: 35, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.545 Vali Acc: 0.804 Test Loss: 0.545 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.0132968425750732
Epoch: 36, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.512 Vali Acc: 0.826 Test Loss: 0.512 Test Acc: 0.826
Validation loss decreased (-0.818835 --> -0.826082).  Saving model ...
Epoch: 37 cost time: 1.1641085147857666
Epoch: 37, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.504 Vali Acc: 0.833 Test Loss: 0.504 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833328).  Saving model ...
Epoch: 38 cost time: 1.0187861919403076
Epoch: 38, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.510 Vali Acc: 0.826 Test Loss: 0.510 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.05914306640625
Epoch: 39, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.499 Vali Acc: 0.826 Test Loss: 0.499 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.1157028675079346
Epoch: 40, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.481 Vali Acc: 0.833 Test Loss: 0.481 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833329).  Saving model ...
Epoch: 41 cost time: 1.0437798500061035
Epoch: 41, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.481 Vali Acc: 0.826 Test Loss: 0.481 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.0016465187072754
Epoch: 42, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.490 Vali Acc: 0.826 Test Loss: 0.490 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.0195236206054688
Epoch: 43, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.481 Vali Acc: 0.833 Test Loss: 0.481 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.9349868297576904
Epoch: 44, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.474 Vali Acc: 0.841 Test Loss: 0.474 Test Acc: 0.841
Validation loss decreased (-0.833329 --> -0.840575).  Saving model ...
Epoch: 45 cost time: 1.053117275238037
Epoch: 45, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.483 Vali Acc: 0.833 Test Loss: 0.483 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.996636152267456
Epoch: 46, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.482 Vali Acc: 0.833 Test Loss: 0.482 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.9971306324005127
Epoch: 47, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.478 Vali Acc: 0.841 Test Loss: 0.478 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.0245099067687988
Epoch: 48, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.470 Vali Acc: 0.841 Test Loss: 0.470 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 49 cost time: 0.8180093765258789
Epoch: 49, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.466 Vali Acc: 0.848 Test Loss: 0.466 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847821).  Saving model ...
Epoch: 50 cost time: 1.0960512161254883
Epoch: 50, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.470 Vali Acc: 0.848 Test Loss: 0.470 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.9276769161224365
Epoch: 51, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.467 Vali Acc: 0.848 Test Loss: 0.467 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.0971946716308594
Epoch: 52, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.465 Vali Acc: 0.855 Test Loss: 0.465 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855068).  Saving model ...
Epoch: 53 cost time: 0.8591797351837158
Epoch: 53, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.460 Vali Acc: 0.848 Test Loss: 0.460 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.1545145511627197
Epoch: 54, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.461 Vali Acc: 0.848 Test Loss: 0.461 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.2153184413909912
Epoch: 55, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.457 Vali Acc: 0.848 Test Loss: 0.457 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.0663433074951172
Epoch: 56, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.457 Vali Acc: 0.848 Test Loss: 0.457 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 1.1348981857299805
Epoch: 57, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.454 Vali Acc: 0.848 Test Loss: 0.454 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 0.9742155075073242
Epoch: 58, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.458 Vali Acc: 0.862 Test Loss: 0.458 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862314).  Saving model ...
Epoch: 59 cost time: 0.9346559047698975
Epoch: 59, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.459 Vali Acc: 0.862 Test Loss: 0.459 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.142223834991455
Epoch: 60, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.455 Vali Acc: 0.855 Test Loss: 0.455 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 1.000518798828125
Epoch: 61, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.451 Vali Acc: 0.855 Test Loss: 0.451 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 1.1537842750549316
Epoch: 62, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.459 Vali Acc: 0.855 Test Loss: 0.459 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 1.0247623920440674
Epoch: 63, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.462 Vali Acc: 0.855 Test Loss: 0.462 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 1.0143609046936035
Epoch: 64, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.461 Vali Acc: 0.862 Test Loss: 0.461 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 1.1279668807983398
Epoch: 65, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.461 Vali Acc: 0.855 Test Loss: 0.461 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 0.9492392539978027
Epoch: 66, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.460 Vali Acc: 0.855 Test Loss: 0.460 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 67 cost time: 0.9088716506958008
Epoch: 67, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.459 Vali Acc: 0.862 Test Loss: 0.459 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 68 cost time: 0.8847885131835938
Epoch: 68, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.460 Vali Acc: 0.862 Test Loss: 0.460 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm64_cs26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 50038
model size : 0.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm64_cs23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.2560763359069824
Epoch: 1, Steps: 9 | Train Loss: 1.506 Vali Loss: 1.447 Vali Acc: 0.203 Test Loss: 1.447 Test Acc: 0.203
Validation loss decreased (inf --> -0.202884).  Saving model ...
Epoch: 2 cost time: 0.8929686546325684
Epoch: 2, Steps: 9 | Train Loss: 1.419 Vali Loss: 1.360 Vali Acc: 0.326 Test Loss: 1.360 Test Acc: 0.326
Validation loss decreased (-0.202884 --> -0.326073).  Saving model ...
Epoch: 3 cost time: 1.0697541236877441
Epoch: 3, Steps: 9 | Train Loss: 1.320 Vali Loss: 1.260 Vali Acc: 0.428 Test Loss: 1.260 Test Acc: 0.428
Validation loss decreased (-0.326073 --> -0.427524).  Saving model ...
Epoch: 4 cost time: 1.0079095363616943
Epoch: 4, Steps: 9 | Train Loss: 1.185 Vali Loss: 1.179 Vali Acc: 0.471 Test Loss: 1.179 Test Acc: 0.471
Validation loss decreased (-0.427524 --> -0.471003).  Saving model ...
Epoch: 5 cost time: 0.9292333126068115
Epoch: 5, Steps: 9 | Train Loss: 1.081 Vali Loss: 1.130 Vali Acc: 0.478 Test Loss: 1.130 Test Acc: 0.478
Validation loss decreased (-0.471003 --> -0.478250).  Saving model ...
Epoch: 6 cost time: 1.0730140209197998
Epoch: 6, Steps: 9 | Train Loss: 1.004 Vali Loss: 1.098 Vali Acc: 0.478 Test Loss: 1.098 Test Acc: 0.478
Validation loss decreased (-0.478250 --> -0.478250).  Saving model ...
Epoch: 7 cost time: 0.9652514457702637
Epoch: 7, Steps: 9 | Train Loss: 0.951 Vali Loss: 1.067 Vali Acc: 0.486 Test Loss: 1.067 Test Acc: 0.486
Validation loss decreased (-0.478250 --> -0.485497).  Saving model ...
Epoch: 8 cost time: 0.7968401908874512
Epoch: 8, Steps: 9 | Train Loss: 0.877 Vali Loss: 1.037 Vali Acc: 0.493 Test Loss: 1.037 Test Acc: 0.493
Validation loss decreased (-0.485497 --> -0.492743).  Saving model ...
Epoch: 9 cost time: 0.8173258304595947
Epoch: 9, Steps: 9 | Train Loss: 0.833 Vali Loss: 1.018 Vali Acc: 0.500 Test Loss: 1.018 Test Acc: 0.500
Validation loss decreased (-0.492743 --> -0.499990).  Saving model ...
Epoch: 10 cost time: 0.7034158706665039
Epoch: 10, Steps: 9 | Train Loss: 0.791 Vali Loss: 1.004 Vali Acc: 0.507 Test Loss: 1.004 Test Acc: 0.507
Validation loss decreased (-0.499990 --> -0.507236).  Saving model ...
Epoch: 11 cost time: 0.6755800247192383
Epoch: 11, Steps: 9 | Train Loss: 0.733 Vali Loss: 1.001 Vali Acc: 0.514 Test Loss: 1.001 Test Acc: 0.514
Validation loss decreased (-0.507236 --> -0.514483).  Saving model ...
Epoch: 12 cost time: 0.708787202835083
Epoch: 12, Steps: 9 | Train Loss: 0.707 Vali Loss: 0.999 Vali Acc: 0.514 Test Loss: 0.999 Test Acc: 0.514
Validation loss decreased (-0.514483 --> -0.514483).  Saving model ...
Epoch: 13 cost time: 0.851762056350708
Epoch: 13, Steps: 9 | Train Loss: 0.656 Vali Loss: 0.989 Vali Acc: 0.536 Test Loss: 0.989 Test Acc: 0.536
Validation loss decreased (-0.514483 --> -0.536222).  Saving model ...
Epoch: 14 cost time: 0.7468037605285645
Epoch: 14, Steps: 9 | Train Loss: 0.631 Vali Loss: 0.988 Vali Acc: 0.580 Test Loss: 0.988 Test Acc: 0.580
Validation loss decreased (-0.536222 --> -0.579700).  Saving model ...
Epoch: 15 cost time: 0.8396694660186768
Epoch: 15, Steps: 9 | Train Loss: 0.585 Vali Loss: 0.978 Vali Acc: 0.551 Test Loss: 0.978 Test Acc: 0.551
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8179833889007568
Epoch: 16, Steps: 9 | Train Loss: 0.554 Vali Loss: 0.985 Vali Acc: 0.565 Test Loss: 0.985 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6867637634277344
Epoch: 17, Steps: 9 | Train Loss: 0.517 Vali Loss: 0.999 Vali Acc: 0.580 Test Loss: 0.999 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7353646755218506
Epoch: 18, Steps: 9 | Train Loss: 0.485 Vali Loss: 0.995 Vali Acc: 0.587 Test Loss: 0.995 Test Acc: 0.587
Validation loss decreased (-0.579700 --> -0.586947).  Saving model ...
Epoch: 19 cost time: 1.1096935272216797
Epoch: 19, Steps: 9 | Train Loss: 0.457 Vali Loss: 1.000 Vali Acc: 0.601 Test Loss: 1.000 Test Acc: 0.601
Validation loss decreased (-0.586947 --> -0.601439).  Saving model ...
Epoch: 20 cost time: 0.9818298816680908
Epoch: 20, Steps: 9 | Train Loss: 0.426 Vali Loss: 1.024 Vali Acc: 0.587 Test Loss: 1.024 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9083325862884521
Epoch: 21, Steps: 9 | Train Loss: 0.396 Vali Loss: 0.993 Vali Acc: 0.601 Test Loss: 0.993 Test Acc: 0.601
Validation loss decreased (-0.601439 --> -0.601439).  Saving model ...
Epoch: 22 cost time: 0.9504871368408203
Epoch: 22, Steps: 9 | Train Loss: 0.364 Vali Loss: 0.968 Vali Acc: 0.616 Test Loss: 0.968 Test Acc: 0.616
Validation loss decreased (-0.601439 --> -0.615932).  Saving model ...
Epoch: 23 cost time: 0.9107847213745117
Epoch: 23, Steps: 9 | Train Loss: 0.311 Vali Loss: 0.973 Vali Acc: 0.638 Test Loss: 0.973 Test Acc: 0.638
Validation loss decreased (-0.615932 --> -0.637671).  Saving model ...
Epoch: 24 cost time: 0.6869380474090576
Epoch: 24, Steps: 9 | Train Loss: 0.277 Vali Loss: 0.935 Vali Acc: 0.652 Test Loss: 0.935 Test Acc: 0.652
Validation loss decreased (-0.637671 --> -0.652165).  Saving model ...
Epoch: 25 cost time: 0.7856240272521973
Epoch: 25, Steps: 9 | Train Loss: 0.247 Vali Loss: 0.872 Vali Acc: 0.681 Test Loss: 0.872 Test Acc: 0.681
Validation loss decreased (-0.652165 --> -0.681151).  Saving model ...
Epoch: 26 cost time: 0.8833639621734619
Epoch: 26, Steps: 9 | Train Loss: 0.199 Vali Loss: 0.855 Vali Acc: 0.703 Test Loss: 0.855 Test Acc: 0.703
Validation loss decreased (-0.681151 --> -0.702890).  Saving model ...
Epoch: 27 cost time: 1.049452304840088
Epoch: 27, Steps: 9 | Train Loss: 0.159 Vali Loss: 0.750 Vali Acc: 0.732 Test Loss: 0.750 Test Acc: 0.732
Validation loss decreased (-0.702890 --> -0.731877).  Saving model ...
Epoch: 28 cost time: 0.7827644348144531
Epoch: 28, Steps: 9 | Train Loss: 0.125 Vali Loss: 0.674 Vali Acc: 0.746 Test Loss: 0.674 Test Acc: 0.746
Validation loss decreased (-0.731877 --> -0.746370).  Saving model ...
Epoch: 29 cost time: 0.8283145427703857
Epoch: 29, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.625 Vali Acc: 0.761 Test Loss: 0.625 Test Acc: 0.761
Validation loss decreased (-0.746370 --> -0.760863).  Saving model ...
Epoch: 30 cost time: 0.7431647777557373
Epoch: 30, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.588 Vali Acc: 0.768 Test Loss: 0.588 Test Acc: 0.768
Validation loss decreased (-0.760863 --> -0.768110).  Saving model ...
Epoch: 31 cost time: 0.9627013206481934
Epoch: 31, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.531 Vali Acc: 0.804 Test Loss: 0.531 Test Acc: 0.804
Validation loss decreased (-0.768110 --> -0.804343).  Saving model ...
Epoch: 32 cost time: 0.8462564945220947
Epoch: 32, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.485 Vali Acc: 0.833 Test Loss: 0.485 Test Acc: 0.833
Validation loss decreased (-0.804343 --> -0.833328).  Saving model ...
Epoch: 33 cost time: 0.8856191635131836
Epoch: 33, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.472 Vali Acc: 0.833 Test Loss: 0.472 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833329).  Saving model ...
Epoch: 34 cost time: 1.0460739135742188
Epoch: 34, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.440 Vali Acc: 0.841 Test Loss: 0.440 Test Acc: 0.841
Validation loss decreased (-0.833329 --> -0.840575).  Saving model ...
Epoch: 35 cost time: 0.903876543045044
Epoch: 35, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.414 Vali Acc: 0.848 Test Loss: 0.414 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847822).  Saving model ...
Epoch: 36 cost time: 0.8671972751617432
Epoch: 36, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.417 Vali Acc: 0.855 Test Loss: 0.417 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855068).  Saving model ...
Epoch: 37 cost time: 0.8351175785064697
Epoch: 37, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.402 Vali Acc: 0.862 Test Loss: 0.402 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862315).  Saving model ...
Epoch: 38 cost time: 1.0566411018371582
Epoch: 38, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.399 Vali Acc: 0.884 Test Loss: 0.399 Test Acc: 0.884
Validation loss decreased (-0.862315 --> -0.884054).  Saving model ...
Epoch: 39 cost time: 1.0956931114196777
Epoch: 39, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.392 Vali Acc: 0.884 Test Loss: 0.392 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 40 cost time: 0.8926479816436768
Epoch: 40, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.392 Vali Acc: 0.891 Test Loss: 0.392 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891300).  Saving model ...
Epoch: 41 cost time: 0.9815433025360107
Epoch: 41, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.382 Vali Acc: 0.899 Test Loss: 0.382 Test Acc: 0.899
Validation loss decreased (-0.891300 --> -0.898547).  Saving model ...
Epoch: 42 cost time: 0.775048017501831
Epoch: 42, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.380 Vali Acc: 0.899 Test Loss: 0.380 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 43 cost time: 0.99322509765625
Epoch: 43, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.376 Vali Acc: 0.899 Test Loss: 0.376 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 44 cost time: 0.7603514194488525
Epoch: 44, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.373 Vali Acc: 0.891 Test Loss: 0.373 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.9049935340881348
Epoch: 45, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.376 Vali Acc: 0.899 Test Loss: 0.376 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 46 cost time: 0.8233065605163574
Epoch: 46, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.377 Vali Acc: 0.906 Test Loss: 0.377 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905793).  Saving model ...
Epoch: 47 cost time: 1.009871006011963
Epoch: 47, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.363 Vali Acc: 0.899 Test Loss: 0.363 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.874692440032959
Epoch: 48, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.362 Vali Acc: 0.906 Test Loss: 0.362 Test Acc: 0.906
Validation loss decreased (-0.905793 --> -0.905793).  Saving model ...
Epoch: 49 cost time: 0.7549581527709961
Epoch: 49, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.362 Vali Acc: 0.906 Test Loss: 0.362 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.7965548038482666
Epoch: 50, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.362 Vali Acc: 0.906 Test Loss: 0.362 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.9697842597961426
Epoch: 51, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.364 Vali Acc: 0.913 Test Loss: 0.364 Test Acc: 0.913
Validation loss decreased (-0.905793 --> -0.913040).  Saving model ...
Epoch: 52 cost time: 0.7875957489013672
Epoch: 52, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.365 Vali Acc: 0.913 Test Loss: 0.365 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.9854447841644287
Epoch: 53, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.362 Vali Acc: 0.913 Test Loss: 0.362 Test Acc: 0.913
Validation loss decreased (-0.913040 --> -0.913040).  Saving model ...
Epoch: 54 cost time: 0.7633254528045654
Epoch: 54, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.363 Vali Acc: 0.913 Test Loss: 0.363 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.8099184036254883
Epoch: 55, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.359 Vali Acc: 0.906 Test Loss: 0.359 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.970780611038208
Epoch: 56, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.358 Vali Acc: 0.906 Test Loss: 0.358 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.8402795791625977
Epoch: 57, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.361 Vali Acc: 0.906 Test Loss: 0.361 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 1.0114233493804932
Epoch: 58, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.360 Vali Acc: 0.906 Test Loss: 0.360 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 0.9925434589385986
Epoch: 59, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.360 Vali Acc: 0.906 Test Loss: 0.360 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 0.9567306041717529
Epoch: 60, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.360 Vali Acc: 0.906 Test Loss: 0.360 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 0.93072509765625
Epoch: 61, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.364 Vali Acc: 0.906 Test Loss: 0.364 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 0.8215608596801758
Epoch: 62, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.367 Vali Acc: 0.906 Test Loss: 0.367 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 0.972496747970581
Epoch: 63, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.364 Vali Acc: 0.913 Test Loss: 0.364 Test Acc: 0.913
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm64_cs23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 49774
model size : 0.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm64_cs21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.4110262393951416
Epoch: 1, Steps: 9 | Train Loss: 1.398 Vali Loss: 1.395 Vali Acc: 0.246 Test Loss: 1.395 Test Acc: 0.246
Validation loss decreased (inf --> -0.246363).  Saving model ...
Epoch: 2 cost time: 0.8907523155212402
Epoch: 2, Steps: 9 | Train Loss: 1.336 Vali Loss: 1.317 Vali Acc: 0.297 Test Loss: 1.317 Test Acc: 0.297
Validation loss decreased (-0.246363 --> -0.297088).  Saving model ...
Epoch: 3 cost time: 0.7248973846435547
Epoch: 3, Steps: 9 | Train Loss: 1.254 Vali Loss: 1.231 Vali Acc: 0.449 Test Loss: 1.231 Test Acc: 0.449
Validation loss decreased (-0.297088 --> -0.449263).  Saving model ...
Epoch: 4 cost time: 0.6617431640625
Epoch: 4, Steps: 9 | Train Loss: 1.140 Vali Loss: 1.156 Vali Acc: 0.478 Test Loss: 1.156 Test Acc: 0.478
Validation loss decreased (-0.449263 --> -0.478249).  Saving model ...
Epoch: 5 cost time: 0.6639680862426758
Epoch: 5, Steps: 9 | Train Loss: 1.052 Vali Loss: 1.111 Vali Acc: 0.457 Test Loss: 1.111 Test Acc: 0.457
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7347972393035889
Epoch: 6, Steps: 9 | Train Loss: 0.967 Vali Loss: 1.078 Vali Acc: 0.442 Test Loss: 1.078 Test Acc: 0.442
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7446169853210449
Epoch: 7, Steps: 9 | Train Loss: 0.904 Vali Loss: 1.050 Vali Acc: 0.493 Test Loss: 1.050 Test Acc: 0.493
Validation loss decreased (-0.478249 --> -0.492743).  Saving model ...
Epoch: 8 cost time: 0.8059849739074707
Epoch: 8, Steps: 9 | Train Loss: 0.846 Vali Loss: 1.042 Vali Acc: 0.493 Test Loss: 1.042 Test Acc: 0.493
Validation loss decreased (-0.492743 --> -0.492743).  Saving model ...
Epoch: 9 cost time: 0.8189477920532227
Epoch: 9, Steps: 9 | Train Loss: 0.819 Vali Loss: 1.027 Vali Acc: 0.493 Test Loss: 1.027 Test Acc: 0.493
Validation loss decreased (-0.492743 --> -0.492743).  Saving model ...
Epoch: 10 cost time: 0.7370481491088867
Epoch: 10, Steps: 9 | Train Loss: 0.775 Vali Loss: 1.014 Vali Acc: 0.529 Test Loss: 1.014 Test Acc: 0.529
Validation loss decreased (-0.492743 --> -0.528975).  Saving model ...
Epoch: 11 cost time: 0.8521237373352051
Epoch: 11, Steps: 9 | Train Loss: 0.719 Vali Loss: 0.988 Vali Acc: 0.536 Test Loss: 0.988 Test Acc: 0.536
Validation loss decreased (-0.528975 --> -0.536222).  Saving model ...
Epoch: 12 cost time: 0.8610072135925293
Epoch: 12, Steps: 9 | Train Loss: 0.676 Vali Loss: 0.984 Vali Acc: 0.558 Test Loss: 0.984 Test Acc: 0.558
Validation loss decreased (-0.536222 --> -0.557961).  Saving model ...
Epoch: 13 cost time: 0.7544715404510498
Epoch: 13, Steps: 9 | Train Loss: 0.634 Vali Loss: 0.991 Vali Acc: 0.543 Test Loss: 0.991 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9277424812316895
Epoch: 14, Steps: 9 | Train Loss: 0.619 Vali Loss: 0.986 Vali Acc: 0.536 Test Loss: 0.986 Test Acc: 0.536
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7793166637420654
Epoch: 15, Steps: 9 | Train Loss: 0.567 Vali Loss: 0.982 Vali Acc: 0.565 Test Loss: 0.982 Test Acc: 0.565
Validation loss decreased (-0.557961 --> -0.565208).  Saving model ...
Epoch: 16 cost time: 0.9119489192962646
Epoch: 16, Steps: 9 | Train Loss: 0.531 Vali Loss: 0.967 Vali Acc: 0.587 Test Loss: 0.967 Test Acc: 0.587
Validation loss decreased (-0.565208 --> -0.586947).  Saving model ...
Epoch: 17 cost time: 1.0099923610687256
Epoch: 17, Steps: 9 | Train Loss: 0.495 Vali Loss: 0.960 Vali Acc: 0.587 Test Loss: 0.960 Test Acc: 0.587
Validation loss decreased (-0.586947 --> -0.586947).  Saving model ...
Epoch: 18 cost time: 0.7252407073974609
Epoch: 18, Steps: 9 | Train Loss: 0.441 Vali Loss: 0.936 Vali Acc: 0.630 Test Loss: 0.936 Test Acc: 0.630
Validation loss decreased (-0.586947 --> -0.630425).  Saving model ...
Epoch: 19 cost time: 0.7676253318786621
Epoch: 19, Steps: 9 | Train Loss: 0.405 Vali Loss: 0.926 Vali Acc: 0.645 Test Loss: 0.926 Test Acc: 0.645
Validation loss decreased (-0.630425 --> -0.644918).  Saving model ...
Epoch: 20 cost time: 0.7667732238769531
Epoch: 20, Steps: 9 | Train Loss: 0.360 Vali Loss: 0.872 Vali Acc: 0.667 Test Loss: 0.872 Test Acc: 0.667
Validation loss decreased (-0.644918 --> -0.666658).  Saving model ...
Epoch: 21 cost time: 0.8223810195922852
Epoch: 21, Steps: 9 | Train Loss: 0.301 Vali Loss: 0.823 Vali Acc: 0.681 Test Loss: 0.823 Test Acc: 0.681
Validation loss decreased (-0.666658 --> -0.681151).  Saving model ...
Epoch: 22 cost time: 0.6874833106994629
Epoch: 22, Steps: 9 | Train Loss: 0.245 Vali Loss: 0.755 Vali Acc: 0.710 Test Loss: 0.755 Test Acc: 0.710
Validation loss decreased (-0.681151 --> -0.710137).  Saving model ...
Epoch: 23 cost time: 0.6942977905273438
Epoch: 23, Steps: 9 | Train Loss: 0.193 Vali Loss: 0.650 Vali Acc: 0.775 Test Loss: 0.650 Test Acc: 0.775
Validation loss decreased (-0.710137 --> -0.775356).  Saving model ...
Epoch: 24 cost time: 0.6799740791320801
Epoch: 24, Steps: 9 | Train Loss: 0.149 Vali Loss: 0.589 Vali Acc: 0.790 Test Loss: 0.589 Test Acc: 0.790
Validation loss decreased (-0.775356 --> -0.789849).  Saving model ...
Epoch: 25 cost time: 0.6631762981414795
Epoch: 25, Steps: 9 | Train Loss: 0.119 Vali Loss: 0.551 Vali Acc: 0.797 Test Loss: 0.551 Test Acc: 0.797
Validation loss decreased (-0.789849 --> -0.797096).  Saving model ...
Epoch: 26 cost time: 0.8195064067840576
Epoch: 26, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.527 Vali Acc: 0.819 Test Loss: 0.527 Test Acc: 0.819
Validation loss decreased (-0.797096 --> -0.818835).  Saving model ...
Epoch: 27 cost time: 0.75596022605896
Epoch: 27, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.497 Vali Acc: 0.819 Test Loss: 0.497 Test Acc: 0.819
Validation loss decreased (-0.818835 --> -0.818836).  Saving model ...
Epoch: 28 cost time: 0.7356352806091309
Epoch: 28, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.482 Vali Acc: 0.826 Test Loss: 0.482 Test Acc: 0.826
Validation loss decreased (-0.818836 --> -0.826082).  Saving model ...
Epoch: 29 cost time: 0.7524950504302979
Epoch: 29, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.480 Vali Acc: 0.848 Test Loss: 0.480 Test Acc: 0.848
Validation loss decreased (-0.826082 --> -0.847821).  Saving model ...
Epoch: 30 cost time: 0.7088181972503662
Epoch: 30, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.491 Vali Acc: 0.848 Test Loss: 0.491 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7100386619567871
Epoch: 31, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.476 Vali Acc: 0.855 Test Loss: 0.476 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855068).  Saving model ...
Epoch: 32 cost time: 0.6733889579772949
Epoch: 32, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.474 Vali Acc: 0.855 Test Loss: 0.474 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 33 cost time: 0.845245361328125
Epoch: 33, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.473 Vali Acc: 0.855 Test Loss: 0.473 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 34 cost time: 0.8052809238433838
Epoch: 34, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.453 Vali Acc: 0.862 Test Loss: 0.453 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862314).  Saving model ...
Epoch: 35 cost time: 1.095395803451538
Epoch: 35, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.465 Vali Acc: 0.870 Test Loss: 0.465 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869561).  Saving model ...
Epoch: 36 cost time: 0.9842097759246826
Epoch: 36, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.433 Vali Acc: 0.870 Test Loss: 0.433 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 37 cost time: 0.8454232215881348
Epoch: 37, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.443 Vali Acc: 0.870 Test Loss: 0.443 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.0214886665344238
Epoch: 38, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.456 Vali Acc: 0.877 Test Loss: 0.456 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876807).  Saving model ...
Epoch: 39 cost time: 0.8494405746459961
Epoch: 39, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.434 Vali Acc: 0.862 Test Loss: 0.434 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.9910690784454346
Epoch: 40, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.449 Vali Acc: 0.862 Test Loss: 0.449 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.010277271270752
Epoch: 41, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.460 Vali Acc: 0.877 Test Loss: 0.460 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.9158508777618408
Epoch: 42, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.438 Vali Acc: 0.884 Test Loss: 0.438 Test Acc: 0.884
Validation loss decreased (-0.876807 --> -0.884054).  Saving model ...
Epoch: 43 cost time: 0.98872971534729
Epoch: 43, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.422 Vali Acc: 0.884 Test Loss: 0.422 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 44 cost time: 0.884152889251709
Epoch: 44, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.413 Vali Acc: 0.891 Test Loss: 0.413 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891300).  Saving model ...
Epoch: 45 cost time: 0.7696762084960938
Epoch: 45, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.407 Vali Acc: 0.899 Test Loss: 0.407 Test Acc: 0.899
Validation loss decreased (-0.891300 --> -0.898547).  Saving model ...
Epoch: 46 cost time: 0.9050464630126953
Epoch: 46, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.415 Vali Acc: 0.891 Test Loss: 0.415 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.8576722145080566
Epoch: 47, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.415 Vali Acc: 0.891 Test Loss: 0.415 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.0096969604492188
Epoch: 48, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.413 Vali Acc: 0.899 Test Loss: 0.413 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.18959379196167
Epoch: 49, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.400 Vali Acc: 0.899 Test Loss: 0.400 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 50 cost time: 1.1191067695617676
Epoch: 50, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.392 Vali Acc: 0.899 Test Loss: 0.392 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 51 cost time: 0.9396650791168213
Epoch: 51, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.383 Vali Acc: 0.899 Test Loss: 0.383 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 52 cost time: 0.9143626689910889
Epoch: 52, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.389 Vali Acc: 0.899 Test Loss: 0.389 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.8237991333007812
Epoch: 53, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.398 Vali Acc: 0.899 Test Loss: 0.398 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.0004429817199707
Epoch: 54, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.394 Vali Acc: 0.899 Test Loss: 0.394 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.8229432106018066
Epoch: 55, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.389 Vali Acc: 0.899 Test Loss: 0.389 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 0.8437895774841309
Epoch: 56, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.397 Vali Acc: 0.899 Test Loss: 0.397 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 1.0707790851593018
Epoch: 57, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.395 Vali Acc: 0.899 Test Loss: 0.395 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 0.7835812568664551
Epoch: 58, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.388 Vali Acc: 0.899 Test Loss: 0.388 Test Acc: 0.899
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 1.1592352390289307
Epoch: 59, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.391 Vali Acc: 0.899 Test Loss: 0.391 Test Acc: 0.899
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 0.8084259033203125
Epoch: 60, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.379 Vali Acc: 0.899 Test Loss: 0.379 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 61 cost time: 0.7971978187561035
Epoch: 61, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.383 Vali Acc: 0.899 Test Loss: 0.383 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.8249180316925049
Epoch: 62, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.369 Vali Acc: 0.899 Test Loss: 0.369 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 63 cost time: 0.8466789722442627
Epoch: 63, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.365 Vali Acc: 0.899 Test Loss: 0.365 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 64 cost time: 1.3083674907684326
Epoch: 64, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.358 Vali Acc: 0.906 Test Loss: 0.358 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905794).  Saving model ...
Epoch: 65 cost time: 0.9607200622558594
Epoch: 65, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.351 Vali Acc: 0.906 Test Loss: 0.351 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 66 cost time: 0.8533365726470947
Epoch: 66, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.363 Vali Acc: 0.906 Test Loss: 0.363 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.0063159465789795
Epoch: 67, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.375 Vali Acc: 0.899 Test Loss: 0.375 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 1.0076439380645752
Epoch: 68, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.355 Vali Acc: 0.906 Test Loss: 0.355 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 1.1716430187225342
Epoch: 69, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.347 Vali Acc: 0.906 Test Loss: 0.347 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 70 cost time: 1.0781221389770508
Epoch: 70, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.345 Vali Acc: 0.913 Test Loss: 0.345 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913040).  Saving model ...
Epoch: 71 cost time: 0.977454662322998
Epoch: 71, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.353 Vali Acc: 0.906 Test Loss: 0.353 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 1.0757336616516113
Epoch: 72, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.343 Vali Acc: 0.913 Test Loss: 0.343 Test Acc: 0.913
Validation loss decreased (-0.913040 --> -0.913040).  Saving model ...
Epoch: 73 cost time: 1.0599539279937744
Epoch: 73, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.348 Vali Acc: 0.913 Test Loss: 0.348 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 1.172858476638794
Epoch: 74, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.332 Vali Acc: 0.913 Test Loss: 0.332 Test Acc: 0.913
Validation loss decreased (-0.913040 --> -0.913040).  Saving model ...
Epoch: 75 cost time: 0.9819300174713135
Epoch: 75, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.338 Vali Acc: 0.913 Test Loss: 0.338 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 1.0474112033843994
Epoch: 76, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.344 Vali Acc: 0.913 Test Loss: 0.344 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 1.1381471157073975
Epoch: 77, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.340 Vali Acc: 0.913 Test Loss: 0.340 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 1.1762332916259766
Epoch: 78, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.338 Vali Acc: 0.913 Test Loss: 0.338 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 1.1269876956939697
Epoch: 79, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.331 Vali Acc: 0.913 Test Loss: 0.331 Test Acc: 0.913
Validation loss decreased (-0.913040 --> -0.913040).  Saving model ...
Epoch: 80 cost time: 1.0549445152282715
Epoch: 80, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.332 Vali Acc: 0.913 Test Loss: 0.332 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 1.0417344570159912
Epoch: 81, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.338 Vali Acc: 0.920 Test Loss: 0.338 Test Acc: 0.920
Validation loss decreased (-0.913040 --> -0.920286).  Saving model ...
Epoch: 82 cost time: 1.0470986366271973
Epoch: 82, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.324 Vali Acc: 0.920 Test Loss: 0.324 Test Acc: 0.920
Validation loss decreased (-0.920286 --> -0.920287).  Saving model ...
Epoch: 83 cost time: 1.0138967037200928
Epoch: 83, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.318 Vali Acc: 0.920 Test Loss: 0.318 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 84 cost time: 1.042689323425293
Epoch: 84, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.329 Vali Acc: 0.920 Test Loss: 0.329 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 1.0528373718261719
Epoch: 85, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.328 Vali Acc: 0.920 Test Loss: 0.328 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 1.1933133602142334
Epoch: 86, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.324 Vali Acc: 0.920 Test Loss: 0.324 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 87 cost time: 0.9396064281463623
Epoch: 87, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.318 Vali Acc: 0.920 Test Loss: 0.318 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 88 cost time: 0.7867734432220459
Epoch: 88, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.320 Vali Acc: 0.920 Test Loss: 0.320 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 0.9332847595214844
Epoch: 89, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.319 Vali Acc: 0.920 Test Loss: 0.319 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 90 cost time: 0.8662431240081787
Epoch: 90, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.314 Vali Acc: 0.920 Test Loss: 0.314 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 91 cost time: 1.203270435333252
Epoch: 91, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.316 Vali Acc: 0.920 Test Loss: 0.316 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 1.073071002960205
Epoch: 92, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.313 Vali Acc: 0.920 Test Loss: 0.313 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 93 cost time: 1.0595979690551758
Epoch: 93, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.311 Vali Acc: 0.920 Test Loss: 0.311 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 94 cost time: 0.9207286834716797
Epoch: 94, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.312 Vali Acc: 0.928 Test Loss: 0.312 Test Acc: 0.928
Validation loss decreased (-0.920287 --> -0.927533).  Saving model ...
Epoch: 95 cost time: 1.3170528411865234
Epoch: 95, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.311 Vali Acc: 0.928 Test Loss: 0.311 Test Acc: 0.928
Validation loss decreased (-0.927533 --> -0.927533).  Saving model ...
Epoch: 96 cost time: 0.8269238471984863
Epoch: 96, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.307 Vali Acc: 0.935 Test Loss: 0.307 Test Acc: 0.935
Validation loss decreased (-0.927533 --> -0.934780).  Saving model ...
Epoch: 97 cost time: 0.9776158332824707
Epoch: 97, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.316 Vali Acc: 0.935 Test Loss: 0.316 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 1.0682201385498047
Epoch: 98, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.307 Vali Acc: 0.935 Test Loss: 0.307 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 99 cost time: 0.937936544418335
Epoch: 99, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.301 Vali Acc: 0.935 Test Loss: 0.301 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 100 cost time: 1.0858123302459717
Epoch: 100, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.296 Vali Acc: 0.935 Test Loss: 0.296 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm64_cs21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9347826086956522
model parameter : 50370
model size : 0.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm64_cs19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.287081241607666
Epoch: 1, Steps: 9 | Train Loss: 1.416 Vali Loss: 1.441 Vali Acc: 0.225 Test Loss: 1.441 Test Acc: 0.225
Validation loss decreased (inf --> -0.224623).  Saving model ...
Epoch: 2 cost time: 0.7204935550689697
Epoch: 2, Steps: 9 | Train Loss: 1.339 Vali Loss: 1.349 Vali Acc: 0.304 Test Loss: 1.349 Test Acc: 0.304
Validation loss decreased (-0.224623 --> -0.304334).  Saving model ...
Epoch: 3 cost time: 0.9839680194854736
Epoch: 3, Steps: 9 | Train Loss: 1.244 Vali Loss: 1.254 Vali Acc: 0.399 Test Loss: 1.254 Test Acc: 0.399
Validation loss decreased (-0.304334 --> -0.398538).  Saving model ...
Epoch: 4 cost time: 0.8588354587554932
Epoch: 4, Steps: 9 | Train Loss: 1.143 Vali Loss: 1.175 Vali Acc: 0.471 Test Loss: 1.175 Test Acc: 0.471
Validation loss decreased (-0.398538 --> -0.471003).  Saving model ...
Epoch: 5 cost time: 0.8698861598968506
Epoch: 5, Steps: 9 | Train Loss: 1.053 Vali Loss: 1.119 Vali Acc: 0.442 Test Loss: 1.119 Test Acc: 0.442
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6829938888549805
Epoch: 6, Steps: 9 | Train Loss: 0.975 Vali Loss: 1.086 Vali Acc: 0.435 Test Loss: 1.086 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6631748676300049
Epoch: 7, Steps: 9 | Train Loss: 0.912 Vali Loss: 1.065 Vali Acc: 0.464 Test Loss: 1.065 Test Acc: 0.464
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.814504861831665
Epoch: 8, Steps: 9 | Train Loss: 0.858 Vali Loss: 1.055 Vali Acc: 0.471 Test Loss: 1.055 Test Acc: 0.471
Validation loss decreased (-0.471003 --> -0.471004).  Saving model ...
Epoch: 9 cost time: 1.0010106563568115
Epoch: 9, Steps: 9 | Train Loss: 0.802 Vali Loss: 1.046 Vali Acc: 0.486 Test Loss: 1.046 Test Acc: 0.486
Validation loss decreased (-0.471004 --> -0.485497).  Saving model ...
Epoch: 10 cost time: 0.7379953861236572
Epoch: 10, Steps: 9 | Train Loss: 0.774 Vali Loss: 1.040 Vali Acc: 0.493 Test Loss: 1.040 Test Acc: 0.493
Validation loss decreased (-0.485497 --> -0.492743).  Saving model ...
Epoch: 11 cost time: 0.8973491191864014
Epoch: 11, Steps: 9 | Train Loss: 0.734 Vali Loss: 1.015 Vali Acc: 0.514 Test Loss: 1.015 Test Acc: 0.514
Validation loss decreased (-0.492743 --> -0.514483).  Saving model ...
Epoch: 12 cost time: 0.7952356338500977
Epoch: 12, Steps: 9 | Train Loss: 0.688 Vali Loss: 1.005 Vali Acc: 0.536 Test Loss: 1.005 Test Acc: 0.536
Validation loss decreased (-0.514483 --> -0.536222).  Saving model ...
Epoch: 13 cost time: 0.8179531097412109
Epoch: 13, Steps: 9 | Train Loss: 0.635 Vali Loss: 1.013 Vali Acc: 0.522 Test Loss: 1.013 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9035623073577881
Epoch: 14, Steps: 9 | Train Loss: 0.617 Vali Loss: 1.014 Vali Acc: 0.529 Test Loss: 1.014 Test Acc: 0.529
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8356707096099854
Epoch: 15, Steps: 9 | Train Loss: 0.571 Vali Loss: 1.009 Vali Acc: 0.522 Test Loss: 1.009 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8315103054046631
Epoch: 16, Steps: 9 | Train Loss: 0.534 Vali Loss: 1.022 Vali Acc: 0.551 Test Loss: 1.022 Test Acc: 0.551
Validation loss decreased (-0.536222 --> -0.550714).  Saving model ...
Epoch: 17 cost time: 0.897883415222168
Epoch: 17, Steps: 9 | Train Loss: 0.497 Vali Loss: 0.998 Vali Acc: 0.558 Test Loss: 0.998 Test Acc: 0.558
Validation loss decreased (-0.550714 --> -0.557961).  Saving model ...
Epoch: 18 cost time: 0.6570391654968262
Epoch: 18, Steps: 9 | Train Loss: 0.455 Vali Loss: 0.980 Vali Acc: 0.594 Test Loss: 0.980 Test Acc: 0.594
Validation loss decreased (-0.557961 --> -0.594193).  Saving model ...
Epoch: 19 cost time: 0.5780410766601562
Epoch: 19, Steps: 9 | Train Loss: 0.431 Vali Loss: 0.958 Vali Acc: 0.638 Test Loss: 0.958 Test Acc: 0.638
Validation loss decreased (-0.594193 --> -0.637672).  Saving model ...
Epoch: 20 cost time: 0.8485612869262695
Epoch: 20, Steps: 9 | Train Loss: 0.371 Vali Loss: 0.919 Vali Acc: 0.616 Test Loss: 0.919 Test Acc: 0.616
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.910874605178833
Epoch: 21, Steps: 9 | Train Loss: 0.329 Vali Loss: 0.875 Vali Acc: 0.667 Test Loss: 0.875 Test Acc: 0.667
Validation loss decreased (-0.637672 --> -0.666658).  Saving model ...
Epoch: 22 cost time: 0.8888201713562012
Epoch: 22, Steps: 9 | Train Loss: 0.265 Vali Loss: 0.781 Vali Acc: 0.696 Test Loss: 0.781 Test Acc: 0.696
Validation loss decreased (-0.666658 --> -0.695644).  Saving model ...
Epoch: 23 cost time: 0.9551928043365479
Epoch: 23, Steps: 9 | Train Loss: 0.214 Vali Loss: 0.704 Vali Acc: 0.725 Test Loss: 0.704 Test Acc: 0.725
Validation loss decreased (-0.695644 --> -0.724631).  Saving model ...
Epoch: 24 cost time: 0.6173861026763916
Epoch: 24, Steps: 9 | Train Loss: 0.167 Vali Loss: 0.629 Vali Acc: 0.754 Test Loss: 0.629 Test Acc: 0.754
Validation loss decreased (-0.724631 --> -0.753617).  Saving model ...
Epoch: 25 cost time: 0.7751965522766113
Epoch: 25, Steps: 9 | Train Loss: 0.139 Vali Loss: 0.584 Vali Acc: 0.812 Test Loss: 0.584 Test Acc: 0.812
Validation loss decreased (-0.753617 --> -0.811588).  Saving model ...
Epoch: 26 cost time: 0.7956936359405518
Epoch: 26, Steps: 9 | Train Loss: 0.111 Vali Loss: 0.564 Vali Acc: 0.804 Test Loss: 0.564 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8784565925598145
Epoch: 27, Steps: 9 | Train Loss: 0.113 Vali Loss: 0.524 Vali Acc: 0.819 Test Loss: 0.524 Test Acc: 0.819
Validation loss decreased (-0.811588 --> -0.818835).  Saving model ...
Epoch: 28 cost time: 0.9313797950744629
Epoch: 28, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.519 Vali Acc: 0.833 Test Loss: 0.519 Test Acc: 0.833
Validation loss decreased (-0.818835 --> -0.833328).  Saving model ...
Epoch: 29 cost time: 0.7444489002227783
Epoch: 29, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.519 Vali Acc: 0.841 Test Loss: 0.519 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840575).  Saving model ...
Epoch: 30 cost time: 0.8274097442626953
Epoch: 30, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.515 Vali Acc: 0.848 Test Loss: 0.515 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847821).  Saving model ...
Epoch: 31 cost time: 0.7432661056518555
Epoch: 31, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.496 Vali Acc: 0.848 Test Loss: 0.496 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 32 cost time: 0.8641304969787598
Epoch: 32, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.496 Vali Acc: 0.855 Test Loss: 0.496 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855068).  Saving model ...
Epoch: 33 cost time: 0.7590019702911377
Epoch: 33, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.497 Vali Acc: 0.855 Test Loss: 0.497 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9248323440551758
Epoch: 34, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.491 Vali Acc: 0.855 Test Loss: 0.491 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 35 cost time: 0.9677631855010986
Epoch: 35, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.499 Vali Acc: 0.855 Test Loss: 0.499 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.9140775203704834
Epoch: 36, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.499 Vali Acc: 0.848 Test Loss: 0.499 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6691060066223145
Epoch: 37, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.493 Vali Acc: 0.855 Test Loss: 0.493 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.720416784286499
Epoch: 38, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.501 Vali Acc: 0.841 Test Loss: 0.501 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.6968021392822266
Epoch: 39, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.496 Vali Acc: 0.841 Test Loss: 0.496 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.7580978870391846
Epoch: 40, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.486 Vali Acc: 0.841 Test Loss: 0.486 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.6417129039764404
Epoch: 41, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.518 Vali Acc: 0.833 Test Loss: 0.518 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.8237226009368896
Epoch: 42, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.516 Vali Acc: 0.841 Test Loss: 0.516 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.8070871829986572
Epoch: 43, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.475 Vali Acc: 0.855 Test Loss: 0.475 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 44 cost time: 0.6534361839294434
Epoch: 44, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.510 Vali Acc: 0.841 Test Loss: 0.510 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.8329777717590332
Epoch: 45, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.527 Vali Acc: 0.833 Test Loss: 0.527 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.9302887916564941
Epoch: 46, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.494 Vali Acc: 0.870 Test Loss: 0.494 Test Acc: 0.870
Validation loss decreased (-0.855068 --> -0.869560).  Saving model ...
Epoch: 47 cost time: 0.846468448638916
Epoch: 47, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.483 Vali Acc: 0.870 Test Loss: 0.483 Test Acc: 0.870
Validation loss decreased (-0.869560 --> -0.869560).  Saving model ...
Epoch: 48 cost time: 0.7805113792419434
Epoch: 48, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.485 Vali Acc: 0.870 Test Loss: 0.485 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.9124412536621094
Epoch: 49, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.506 Vali Acc: 0.862 Test Loss: 0.506 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.8285377025604248
Epoch: 50, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.520 Vali Acc: 0.862 Test Loss: 0.520 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.9951183795928955
Epoch: 51, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.489 Vali Acc: 0.870 Test Loss: 0.489 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.9453878402709961
Epoch: 52, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.509 Vali Acc: 0.870 Test Loss: 0.509 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 0.7155342102050781
Epoch: 53, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.504 Vali Acc: 0.870 Test Loss: 0.504 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 0.9996294975280762
Epoch: 54, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.504 Vali Acc: 0.870 Test Loss: 0.504 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 0.702704668045044
Epoch: 55, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.501 Vali Acc: 0.870 Test Loss: 0.501 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 0.8978071212768555
Epoch: 56, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.482 Vali Acc: 0.870 Test Loss: 0.482 Test Acc: 0.870
Validation loss decreased (-0.869560 --> -0.869560).  Saving model ...
Epoch: 57 cost time: 0.7385835647583008
Epoch: 57, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.485 Vali Acc: 0.870 Test Loss: 0.485 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.7778449058532715
Epoch: 58, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.500 Vali Acc: 0.870 Test Loss: 0.500 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.0319130420684814
Epoch: 59, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.492 Vali Acc: 0.870 Test Loss: 0.492 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.8918461799621582
Epoch: 60, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.496 Vali Acc: 0.870 Test Loss: 0.496 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 0.9842875003814697
Epoch: 61, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.493 Vali Acc: 0.870 Test Loss: 0.493 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 1.217698574066162
Epoch: 62, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.485 Vali Acc: 0.877 Test Loss: 0.485 Test Acc: 0.877
Validation loss decreased (-0.869560 --> -0.876807).  Saving model ...
Epoch: 63 cost time: 0.9157199859619141
Epoch: 63, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.491 Vali Acc: 0.877 Test Loss: 0.491 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.0309267044067383
Epoch: 64, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.464 Vali Acc: 0.884 Test Loss: 0.464 Test Acc: 0.884
Validation loss decreased (-0.876807 --> -0.884053).  Saving model ...
Epoch: 65 cost time: 0.7245359420776367
Epoch: 65, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.479 Vali Acc: 0.877 Test Loss: 0.479 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.6712336540222168
Epoch: 66, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.495 Vali Acc: 0.877 Test Loss: 0.495 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 0.7442057132720947
Epoch: 67, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.458 Vali Acc: 0.891 Test Loss: 0.458 Test Acc: 0.891
Validation loss decreased (-0.884053 --> -0.891300).  Saving model ...
Epoch: 68 cost time: 1.0123629570007324
Epoch: 68, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.473 Vali Acc: 0.891 Test Loss: 0.473 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.722923755645752
Epoch: 69, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.498 Vali Acc: 0.877 Test Loss: 0.498 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 0.9363603591918945
Epoch: 70, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.493 Vali Acc: 0.877 Test Loss: 0.493 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 1.17891263961792
Epoch: 71, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.481 Vali Acc: 0.891 Test Loss: 0.481 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 1.038883924484253
Epoch: 72, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.471 Vali Acc: 0.891 Test Loss: 0.471 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 0.8465273380279541
Epoch: 73, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.467 Vali Acc: 0.891 Test Loss: 0.467 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 0.800236701965332
Epoch: 74, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.482 Vali Acc: 0.891 Test Loss: 0.482 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 0.8299915790557861
Epoch: 75, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.483 Vali Acc: 0.891 Test Loss: 0.483 Test Acc: 0.891
EarlyStopping counter: 8 out of 10
Epoch: 76 cost time: 0.721949577331543
Epoch: 76, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.480 Vali Acc: 0.891 Test Loss: 0.480 Test Acc: 0.891
EarlyStopping counter: 9 out of 10
Epoch: 77 cost time: 0.7992863655090332
Epoch: 77, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.475 Vali Acc: 0.891 Test Loss: 0.475 Test Acc: 0.891
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm64_cs19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 50146
model size : 0.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm64_cs18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.968912124633789
Epoch: 1, Steps: 9 | Train Loss: 1.392 Vali Loss: 1.415 Vali Acc: 0.297 Test Loss: 1.415 Test Acc: 0.297
Validation loss decreased (inf --> -0.297087).  Saving model ...
Epoch: 2 cost time: 0.7874100208282471
Epoch: 2, Steps: 9 | Train Loss: 1.323 Vali Loss: 1.339 Vali Acc: 0.370 Test Loss: 1.339 Test Acc: 0.370
Validation loss decreased (-0.297087 --> -0.369552).  Saving model ...
Epoch: 3 cost time: 0.8077025413513184
Epoch: 3, Steps: 9 | Train Loss: 1.236 Vali Loss: 1.252 Vali Acc: 0.413 Test Loss: 1.252 Test Acc: 0.413
Validation loss decreased (-0.369552 --> -0.413031).  Saving model ...
Epoch: 4 cost time: 0.803779125213623
Epoch: 4, Steps: 9 | Train Loss: 1.118 Vali Loss: 1.181 Vali Acc: 0.428 Test Loss: 1.181 Test Acc: 0.428
Validation loss decreased (-0.413031 --> -0.427524).  Saving model ...
Epoch: 5 cost time: 0.6604702472686768
Epoch: 5, Steps: 9 | Train Loss: 1.050 Vali Loss: 1.128 Vali Acc: 0.457 Test Loss: 1.128 Test Acc: 0.457
Validation loss decreased (-0.427524 --> -0.456510).  Saving model ...
Epoch: 6 cost time: 1.0301530361175537
Epoch: 6, Steps: 9 | Train Loss: 0.966 Vali Loss: 1.100 Vali Acc: 0.471 Test Loss: 1.100 Test Acc: 0.471
Validation loss decreased (-0.456510 --> -0.471003).  Saving model ...
Epoch: 7 cost time: 0.8436417579650879
Epoch: 7, Steps: 9 | Train Loss: 0.913 Vali Loss: 1.077 Vali Acc: 0.471 Test Loss: 1.077 Test Acc: 0.471
Validation loss decreased (-0.471003 --> -0.471004).  Saving model ...
Epoch: 8 cost time: 0.9741702079772949
Epoch: 8, Steps: 9 | Train Loss: 0.869 Vali Loss: 1.056 Vali Acc: 0.507 Test Loss: 1.056 Test Acc: 0.507
Validation loss decreased (-0.471004 --> -0.507236).  Saving model ...
Epoch: 9 cost time: 0.8007245063781738
Epoch: 9, Steps: 9 | Train Loss: 0.813 Vali Loss: 1.039 Vali Acc: 0.522 Test Loss: 1.039 Test Acc: 0.522
Validation loss decreased (-0.507236 --> -0.521729).  Saving model ...
Epoch: 10 cost time: 0.9460842609405518
Epoch: 10, Steps: 9 | Train Loss: 0.762 Vali Loss: 1.023 Vali Acc: 0.543 Test Loss: 1.023 Test Acc: 0.543
Validation loss decreased (-0.521729 --> -0.543468).  Saving model ...
Epoch: 11 cost time: 0.6343443393707275
Epoch: 11, Steps: 9 | Train Loss: 0.721 Vali Loss: 1.006 Vali Acc: 0.565 Test Loss: 1.006 Test Acc: 0.565
Validation loss decreased (-0.543468 --> -0.565207).  Saving model ...
Epoch: 12 cost time: 0.8107154369354248
Epoch: 12, Steps: 9 | Train Loss: 0.671 Vali Loss: 1.007 Vali Acc: 0.551 Test Loss: 1.007 Test Acc: 0.551
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8417155742645264
Epoch: 13, Steps: 9 | Train Loss: 0.636 Vali Loss: 0.998 Vali Acc: 0.580 Test Loss: 0.998 Test Acc: 0.580
Validation loss decreased (-0.565207 --> -0.579700).  Saving model ...
Epoch: 14 cost time: 0.9680869579315186
Epoch: 14, Steps: 9 | Train Loss: 0.582 Vali Loss: 0.979 Vali Acc: 0.587 Test Loss: 0.979 Test Acc: 0.587
Validation loss decreased (-0.579700 --> -0.586947).  Saving model ...
Epoch: 15 cost time: 0.9469678401947021
Epoch: 15, Steps: 9 | Train Loss: 0.542 Vali Loss: 0.940 Vali Acc: 0.638 Test Loss: 0.940 Test Acc: 0.638
Validation loss decreased (-0.586947 --> -0.637672).  Saving model ...
Epoch: 16 cost time: 0.9995870590209961
Epoch: 16, Steps: 9 | Train Loss: 0.494 Vali Loss: 0.895 Vali Acc: 0.638 Test Loss: 0.895 Test Acc: 0.638
Validation loss decreased (-0.637672 --> -0.637672).  Saving model ...
Epoch: 17 cost time: 0.8798635005950928
Epoch: 17, Steps: 9 | Train Loss: 0.431 Vali Loss: 0.854 Vali Acc: 0.674 Test Loss: 0.854 Test Acc: 0.674
Validation loss decreased (-0.637672 --> -0.673905).  Saving model ...
Epoch: 18 cost time: 0.8315994739532471
Epoch: 18, Steps: 9 | Train Loss: 0.356 Vali Loss: 0.781 Vali Acc: 0.703 Test Loss: 0.781 Test Acc: 0.703
Validation loss decreased (-0.673905 --> -0.702891).  Saving model ...
Epoch: 19 cost time: 0.8700683116912842
Epoch: 19, Steps: 9 | Train Loss: 0.273 Vali Loss: 0.651 Vali Acc: 0.761 Test Loss: 0.651 Test Acc: 0.761
Validation loss decreased (-0.702891 --> -0.760863).  Saving model ...
Epoch: 20 cost time: 0.8842387199401855
Epoch: 20, Steps: 9 | Train Loss: 0.204 Vali Loss: 0.551 Vali Acc: 0.797 Test Loss: 0.551 Test Acc: 0.797
Validation loss decreased (-0.760863 --> -0.797096).  Saving model ...
Epoch: 21 cost time: 0.8788454532623291
Epoch: 21, Steps: 9 | Train Loss: 0.144 Vali Loss: 0.480 Vali Acc: 0.833 Test Loss: 0.480 Test Acc: 0.833
Validation loss decreased (-0.797096 --> -0.833329).  Saving model ...
Epoch: 22 cost time: 0.7446560859680176
Epoch: 22, Steps: 9 | Train Loss: 0.108 Vali Loss: 0.449 Vali Acc: 0.855 Test Loss: 0.449 Test Acc: 0.855
Validation loss decreased (-0.833329 --> -0.855068).  Saving model ...
Epoch: 23 cost time: 0.6797928810119629
Epoch: 23, Steps: 9 | Train Loss: 0.083 Vali Loss: 0.412 Vali Acc: 0.848 Test Loss: 0.412 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7179121971130371
Epoch: 24, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.386 Vali Acc: 0.848 Test Loss: 0.386 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7299022674560547
Epoch: 25, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.386 Vali Acc: 0.848 Test Loss: 0.386 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.6773273944854736
Epoch: 26, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.387 Vali Acc: 0.855 Test Loss: 0.387 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855069).  Saving model ...
Epoch: 27 cost time: 0.7293169498443604
Epoch: 27, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.377 Vali Acc: 0.855 Test Loss: 0.377 Test Acc: 0.855
Validation loss decreased (-0.855069 --> -0.855069).  Saving model ...
Epoch: 28 cost time: 0.7161543369293213
Epoch: 28, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.359 Vali Acc: 0.862 Test Loss: 0.359 Test Acc: 0.862
Validation loss decreased (-0.855069 --> -0.862315).  Saving model ...
Epoch: 29 cost time: 0.6936323642730713
Epoch: 29, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.348 Vali Acc: 0.870 Test Loss: 0.348 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869562).  Saving model ...
Epoch: 30 cost time: 0.7332949638366699
Epoch: 30, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.336 Vali Acc: 0.870 Test Loss: 0.336 Test Acc: 0.870
Validation loss decreased (-0.869562 --> -0.869562).  Saving model ...
Epoch: 31 cost time: 0.6263246536254883
Epoch: 31, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.348 Vali Acc: 0.855 Test Loss: 0.348 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8439269065856934
Epoch: 32, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.355 Vali Acc: 0.862 Test Loss: 0.355 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.8437328338623047
Epoch: 33, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.338 Vali Acc: 0.877 Test Loss: 0.338 Test Acc: 0.877
Validation loss decreased (-0.869562 --> -0.876808).  Saving model ...
Epoch: 34 cost time: 0.7451956272125244
Epoch: 34, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.330 Vali Acc: 0.877 Test Loss: 0.330 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 35 cost time: 0.9008738994598389
Epoch: 35, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.317 Vali Acc: 0.877 Test Loss: 0.317 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 36 cost time: 1.0837774276733398
Epoch: 36, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.310 Vali Acc: 0.899 Test Loss: 0.310 Test Acc: 0.899
Validation loss decreased (-0.876808 --> -0.898548).  Saving model ...
Epoch: 37 cost time: 0.8382360935211182
Epoch: 37, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.323 Vali Acc: 0.884 Test Loss: 0.323 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.8904104232788086
Epoch: 38, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.328 Vali Acc: 0.884 Test Loss: 0.328 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.8863093852996826
Epoch: 39, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.318 Vali Acc: 0.906 Test Loss: 0.318 Test Acc: 0.906
Validation loss decreased (-0.898548 --> -0.905794).  Saving model ...
Epoch: 40 cost time: 0.8039920330047607
Epoch: 40, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.317 Vali Acc: 0.906 Test Loss: 0.317 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 41 cost time: 0.9529397487640381
Epoch: 41, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.308 Vali Acc: 0.906 Test Loss: 0.308 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 42 cost time: 1.0567576885223389
Epoch: 42, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.307 Vali Acc: 0.906 Test Loss: 0.307 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 43 cost time: 1.0672316551208496
Epoch: 43, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.317 Vali Acc: 0.906 Test Loss: 0.317 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.9452881813049316
Epoch: 44, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.311 Vali Acc: 0.906 Test Loss: 0.311 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.8756961822509766
Epoch: 45, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.313 Vali Acc: 0.906 Test Loss: 0.313 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.028559684753418
Epoch: 46, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.308 Vali Acc: 0.906 Test Loss: 0.308 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.7497503757476807
Epoch: 47, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.300 Vali Acc: 0.906 Test Loss: 0.300 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 48 cost time: 0.9569916725158691
Epoch: 48, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.303 Vali Acc: 0.906 Test Loss: 0.303 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.9811978340148926
Epoch: 49, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.304 Vali Acc: 0.906 Test Loss: 0.304 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.90268874168396
Epoch: 50, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.301 Vali Acc: 0.906 Test Loss: 0.301 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.1113054752349854
Epoch: 51, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.303 Vali Acc: 0.906 Test Loss: 0.303 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.7548685073852539
Epoch: 52, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.296 Vali Acc: 0.906 Test Loss: 0.296 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 53 cost time: 0.8348836898803711
Epoch: 53, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.301 Vali Acc: 0.906 Test Loss: 0.301 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.7971863746643066
Epoch: 54, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.311 Vali Acc: 0.913 Test Loss: 0.311 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913040).  Saving model ...
Epoch: 55 cost time: 0.9408788681030273
Epoch: 55, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.308 Vali Acc: 0.913 Test Loss: 0.308 Test Acc: 0.913
Validation loss decreased (-0.913040 --> -0.913040).  Saving model ...
Epoch: 56 cost time: 0.8996782302856445
Epoch: 56, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.295 Vali Acc: 0.913 Test Loss: 0.295 Test Acc: 0.913
Validation loss decreased (-0.913040 --> -0.913041).  Saving model ...
Epoch: 57 cost time: 1.037809133529663
Epoch: 57, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.292 Vali Acc: 0.913 Test Loss: 0.292 Test Acc: 0.913
Validation loss decreased (-0.913041 --> -0.913041).  Saving model ...
Epoch: 58 cost time: 0.9095554351806641
Epoch: 58, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.300 Vali Acc: 0.913 Test Loss: 0.300 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.785200834274292
Epoch: 59, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.303 Vali Acc: 0.913 Test Loss: 0.303 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.7447412014007568
Epoch: 60, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.289 Vali Acc: 0.928 Test Loss: 0.289 Test Acc: 0.928
Validation loss decreased (-0.913041 --> -0.927533).  Saving model ...
Epoch: 61 cost time: 0.8402714729309082
Epoch: 61, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.299 Vali Acc: 0.928 Test Loss: 0.299 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 1.0647192001342773
Epoch: 62, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.301 Vali Acc: 0.928 Test Loss: 0.301 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.6898703575134277
Epoch: 63, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.305 Vali Acc: 0.928 Test Loss: 0.305 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 0.8042576313018799
Epoch: 64, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.304 Vali Acc: 0.928 Test Loss: 0.304 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 0.6559326648712158
Epoch: 65, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.303 Vali Acc: 0.928 Test Loss: 0.303 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 0.8779385089874268
Epoch: 66, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.285 Vali Acc: 0.928 Test Loss: 0.285 Test Acc: 0.928
Validation loss decreased (-0.927533 --> -0.927533).  Saving model ...
Epoch: 67 cost time: 0.8540241718292236
Epoch: 67, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.298 Vali Acc: 0.928 Test Loss: 0.298 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 1.0081026554107666
Epoch: 68, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.311 Vali Acc: 0.928 Test Loss: 0.311 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.920788049697876
Epoch: 69, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.312 Vali Acc: 0.928 Test Loss: 0.312 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 0.8304719924926758
Epoch: 70, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.295 Vali Acc: 0.928 Test Loss: 0.295 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 0.9259250164031982
Epoch: 71, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.285 Vali Acc: 0.928 Test Loss: 0.285 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 0.6983439922332764
Epoch: 72, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.294 Vali Acc: 0.928 Test Loss: 0.294 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 0.8029403686523438
Epoch: 73, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.301 Vali Acc: 0.928 Test Loss: 0.301 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 0.9258930683135986
Epoch: 74, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.308 Vali Acc: 0.928 Test Loss: 0.308 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 1.0469374656677246
Epoch: 75, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.305 Vali Acc: 0.928 Test Loss: 0.305 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 76 cost time: 0.9676234722137451
Epoch: 76, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.305 Vali Acc: 0.928 Test Loss: 0.305 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm64_cs18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.927536231884058
model parameter : 51606
model size : 0.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm64_cs16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.4025259017944336
Epoch: 1, Steps: 9 | Train Loss: 1.460 Vali Loss: 1.419 Vali Acc: 0.232 Test Loss: 1.419 Test Acc: 0.232
Validation loss decreased (inf --> -0.231870).  Saving model ...
Epoch: 2 cost time: 0.870234489440918
Epoch: 2, Steps: 9 | Train Loss: 1.375 Vali Loss: 1.329 Vali Acc: 0.319 Test Loss: 1.329 Test Acc: 0.319
Validation loss decreased (-0.231870 --> -0.318827).  Saving model ...
Epoch: 3 cost time: 0.985804557800293
Epoch: 3, Steps: 9 | Train Loss: 1.267 Vali Loss: 1.231 Vali Acc: 0.355 Test Loss: 1.231 Test Acc: 0.355
Validation loss decreased (-0.318827 --> -0.355060).  Saving model ...
Epoch: 4 cost time: 1.020195484161377
Epoch: 4, Steps: 9 | Train Loss: 1.156 Vali Loss: 1.150 Vali Acc: 0.413 Test Loss: 1.150 Test Acc: 0.413
Validation loss decreased (-0.355060 --> -0.413032).  Saving model ...
Epoch: 5 cost time: 0.9316868782043457
Epoch: 5, Steps: 9 | Train Loss: 1.059 Vali Loss: 1.101 Vali Acc: 0.420 Test Loss: 1.101 Test Acc: 0.420
Validation loss decreased (-0.413032 --> -0.420279).  Saving model ...
Epoch: 6 cost time: 0.9617376327514648
Epoch: 6, Steps: 9 | Train Loss: 0.984 Vali Loss: 1.070 Vali Acc: 0.428 Test Loss: 1.070 Test Acc: 0.428
Validation loss decreased (-0.420279 --> -0.427526).  Saving model ...
Epoch: 7 cost time: 0.8240699768066406
Epoch: 7, Steps: 9 | Train Loss: 0.920 Vali Loss: 1.054 Vali Acc: 0.420 Test Loss: 1.054 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9193792343139648
Epoch: 8, Steps: 9 | Train Loss: 0.868 Vali Loss: 1.028 Vali Acc: 0.457 Test Loss: 1.028 Test Acc: 0.457
Validation loss decreased (-0.427526 --> -0.456511).  Saving model ...
Epoch: 9 cost time: 0.8117804527282715
Epoch: 9, Steps: 9 | Train Loss: 0.811 Vali Loss: 1.015 Vali Acc: 0.478 Test Loss: 1.015 Test Acc: 0.478
Validation loss decreased (-0.456511 --> -0.478251).  Saving model ...
Epoch: 10 cost time: 0.8103599548339844
Epoch: 10, Steps: 9 | Train Loss: 0.761 Vali Loss: 1.004 Vali Acc: 0.493 Test Loss: 1.004 Test Acc: 0.493
Validation loss decreased (-0.478251 --> -0.492744).  Saving model ...
Epoch: 11 cost time: 0.8817377090454102
Epoch: 11, Steps: 9 | Train Loss: 0.730 Vali Loss: 0.997 Vali Acc: 0.514 Test Loss: 0.997 Test Acc: 0.514
Validation loss decreased (-0.492744 --> -0.514483).  Saving model ...
Epoch: 12 cost time: 0.6456542015075684
Epoch: 12, Steps: 9 | Train Loss: 0.687 Vali Loss: 0.992 Vali Acc: 0.486 Test Loss: 0.992 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0056631565093994
Epoch: 13, Steps: 9 | Train Loss: 0.667 Vali Loss: 0.978 Vali Acc: 0.529 Test Loss: 0.978 Test Acc: 0.529
Validation loss decreased (-0.514483 --> -0.528976).  Saving model ...
Epoch: 14 cost time: 0.7358243465423584
Epoch: 14, Steps: 9 | Train Loss: 0.626 Vali Loss: 0.979 Vali Acc: 0.543 Test Loss: 0.979 Test Acc: 0.543
Validation loss decreased (-0.528976 --> -0.543468).  Saving model ...
Epoch: 15 cost time: 0.8566873073577881
Epoch: 15, Steps: 9 | Train Loss: 0.597 Vali Loss: 1.010 Vali Acc: 0.507 Test Loss: 1.010 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7805807590484619
Epoch: 16, Steps: 9 | Train Loss: 0.553 Vali Loss: 0.990 Vali Acc: 0.522 Test Loss: 0.990 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9508845806121826
Epoch: 17, Steps: 9 | Train Loss: 0.523 Vali Loss: 0.985 Vali Acc: 0.543 Test Loss: 0.985 Test Acc: 0.543
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9723415374755859
Epoch: 18, Steps: 9 | Train Loss: 0.495 Vali Loss: 0.977 Vali Acc: 0.587 Test Loss: 0.977 Test Acc: 0.587
Validation loss decreased (-0.543468 --> -0.586947).  Saving model ...
Epoch: 19 cost time: 0.9205424785614014
Epoch: 19, Steps: 9 | Train Loss: 0.450 Vali Loss: 0.982 Vali Acc: 0.580 Test Loss: 0.982 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9987616539001465
Epoch: 20, Steps: 9 | Train Loss: 0.428 Vali Loss: 0.979 Vali Acc: 0.580 Test Loss: 0.979 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8477466106414795
Epoch: 21, Steps: 9 | Train Loss: 0.380 Vali Loss: 0.953 Vali Acc: 0.645 Test Loss: 0.953 Test Acc: 0.645
Validation loss decreased (-0.586947 --> -0.644918).  Saving model ...
Epoch: 22 cost time: 0.737022876739502
Epoch: 22, Steps: 9 | Train Loss: 0.368 Vali Loss: 0.918 Vali Acc: 0.645 Test Loss: 0.918 Test Acc: 0.645
Validation loss decreased (-0.644918 --> -0.644918).  Saving model ...
Epoch: 23 cost time: 0.8337562084197998
Epoch: 23, Steps: 9 | Train Loss: 0.308 Vali Loss: 0.886 Vali Acc: 0.667 Test Loss: 0.886 Test Acc: 0.667
Validation loss decreased (-0.644918 --> -0.666658).  Saving model ...
Epoch: 24 cost time: 0.7075173854827881
Epoch: 24, Steps: 9 | Train Loss: 0.269 Vali Loss: 0.867 Vali Acc: 0.674 Test Loss: 0.867 Test Acc: 0.674
Validation loss decreased (-0.666658 --> -0.673904).  Saving model ...
Epoch: 25 cost time: 0.9302337169647217
Epoch: 25, Steps: 9 | Train Loss: 0.229 Vali Loss: 0.782 Vali Acc: 0.681 Test Loss: 0.782 Test Acc: 0.681
Validation loss decreased (-0.673904 --> -0.681152).  Saving model ...
Epoch: 26 cost time: 1.0688331127166748
Epoch: 26, Steps: 9 | Train Loss: 0.180 Vali Loss: 0.704 Vali Acc: 0.710 Test Loss: 0.704 Test Acc: 0.710
Validation loss decreased (-0.681152 --> -0.710138).  Saving model ...
Epoch: 27 cost time: 1.111274003982544
Epoch: 27, Steps: 9 | Train Loss: 0.137 Vali Loss: 0.621 Vali Acc: 0.746 Test Loss: 0.621 Test Acc: 0.746
Validation loss decreased (-0.710138 --> -0.746371).  Saving model ...
Epoch: 28 cost time: 0.9394581317901611
Epoch: 28, Steps: 9 | Train Loss: 0.096 Vali Loss: 0.536 Vali Acc: 0.797 Test Loss: 0.536 Test Acc: 0.797
Validation loss decreased (-0.746371 --> -0.797096).  Saving model ...
Epoch: 29 cost time: 0.7845005989074707
Epoch: 29, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.468 Vali Acc: 0.819 Test Loss: 0.468 Test Acc: 0.819
Validation loss decreased (-0.797096 --> -0.818836).  Saving model ...
Epoch: 30 cost time: 1.06097412109375
Epoch: 30, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.425 Vali Acc: 0.833 Test Loss: 0.425 Test Acc: 0.833
Validation loss decreased (-0.818836 --> -0.833329).  Saving model ...
Epoch: 31 cost time: 0.8220415115356445
Epoch: 31, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.381 Vali Acc: 0.855 Test Loss: 0.381 Test Acc: 0.855
Validation loss decreased (-0.833329 --> -0.855069).  Saving model ...
Epoch: 32 cost time: 0.9385185241699219
Epoch: 32, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.354 Vali Acc: 0.884 Test Loss: 0.354 Test Acc: 0.884
Validation loss decreased (-0.855069 --> -0.884054).  Saving model ...
Epoch: 33 cost time: 0.9505150318145752
Epoch: 33, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.342 Vali Acc: 0.891 Test Loss: 0.342 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891301).  Saving model ...
Epoch: 34 cost time: 1.0560715198516846
Epoch: 34, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.331 Vali Acc: 0.899 Test Loss: 0.331 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898547).  Saving model ...
Epoch: 35 cost time: 0.8249454498291016
Epoch: 35, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.311 Vali Acc: 0.913 Test Loss: 0.311 Test Acc: 0.913
Validation loss decreased (-0.898547 --> -0.913040).  Saving model ...
Epoch: 36 cost time: 1.0291152000427246
Epoch: 36, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.315 Vali Acc: 0.899 Test Loss: 0.315 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.1440021991729736
Epoch: 37, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.303 Vali Acc: 0.906 Test Loss: 0.303 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.0304183959960938
Epoch: 38, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.308 Vali Acc: 0.906 Test Loss: 0.308 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.0961010456085205
Epoch: 39, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.309 Vali Acc: 0.906 Test Loss: 0.309 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.8932375907897949
Epoch: 40, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.297 Vali Acc: 0.906 Test Loss: 0.297 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.7701709270477295
Epoch: 41, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.292 Vali Acc: 0.913 Test Loss: 0.292 Test Acc: 0.913
Validation loss decreased (-0.913040 --> -0.913041).  Saving model ...
Epoch: 42 cost time: 0.7421109676361084
Epoch: 42, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.298 Vali Acc: 0.913 Test Loss: 0.298 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.0266129970550537
Epoch: 43, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.299 Vali Acc: 0.913 Test Loss: 0.299 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.9010350704193115
Epoch: 44, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.295 Vali Acc: 0.913 Test Loss: 0.295 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.9497561454772949
Epoch: 45, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.297 Vali Acc: 0.913 Test Loss: 0.297 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.1892750263214111
Epoch: 46, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.296 Vali Acc: 0.913 Test Loss: 0.296 Test Acc: 0.913
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.0229148864746094
Epoch: 47, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.297 Vali Acc: 0.913 Test Loss: 0.297 Test Acc: 0.913
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.0229616165161133
Epoch: 48, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.292 Vali Acc: 0.913 Test Loss: 0.292 Test Acc: 0.913
Validation loss decreased (-0.913041 --> -0.913041).  Saving model ...
Epoch: 49 cost time: 0.8605756759643555
Epoch: 49, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.292 Vali Acc: 0.913 Test Loss: 0.292 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.8729672431945801
Epoch: 50, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.302 Vali Acc: 0.913 Test Loss: 0.302 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.8046083450317383
Epoch: 51, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.294 Vali Acc: 0.913 Test Loss: 0.294 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.8489136695861816
Epoch: 52, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.295 Vali Acc: 0.913 Test Loss: 0.295 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 0.7818806171417236
Epoch: 53, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.301 Vali Acc: 0.913 Test Loss: 0.301 Test Acc: 0.913
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 0.9587454795837402
Epoch: 54, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.298 Vali Acc: 0.913 Test Loss: 0.298 Test Acc: 0.913
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 0.8681795597076416
Epoch: 55, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.303 Vali Acc: 0.913 Test Loss: 0.303 Test Acc: 0.913
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 0.8851652145385742
Epoch: 56, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.300 Vali Acc: 0.913 Test Loss: 0.300 Test Acc: 0.913
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 1.2302570343017578
Epoch: 57, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.304 Vali Acc: 0.913 Test Loss: 0.304 Test Acc: 0.913
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 0.9062244892120361
Epoch: 58, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.290 Vali Acc: 0.913 Test Loss: 0.290 Test Acc: 0.913
Validation loss decreased (-0.913041 --> -0.913041).  Saving model ...
Epoch: 59 cost time: 0.9824967384338379
Epoch: 59, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.297 Vali Acc: 0.913 Test Loss: 0.297 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.2931091785430908
Epoch: 60, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.303 Vali Acc: 0.913 Test Loss: 0.303 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.9826674461364746
Epoch: 61, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.307 Vali Acc: 0.913 Test Loss: 0.307 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 1.1167011260986328
Epoch: 62, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.307 Vali Acc: 0.913 Test Loss: 0.307 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 1.0539307594299316
Epoch: 63, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.300 Vali Acc: 0.913 Test Loss: 0.300 Test Acc: 0.913
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 1.2572910785675049
Epoch: 64, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.299 Vali Acc: 0.913 Test Loss: 0.299 Test Acc: 0.913
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 1.214017629623413
Epoch: 65, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.307 Vali Acc: 0.913 Test Loss: 0.307 Test Acc: 0.913
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 1.0611815452575684
Epoch: 66, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.306 Vali Acc: 0.913 Test Loss: 0.306 Test Acc: 0.913
EarlyStopping counter: 8 out of 10
Epoch: 67 cost time: 1.1404764652252197
Epoch: 67, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.303 Vali Acc: 0.913 Test Loss: 0.303 Test Acc: 0.913
EarlyStopping counter: 9 out of 10
Epoch: 68 cost time: 0.834439754486084
Epoch: 68, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.302 Vali Acc: 0.913 Test Loss: 0.302 Test Acc: 0.913
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm64_cs16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 49948
model size : 0.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm64_cs15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.1526153087615967
Epoch: 1, Steps: 9 | Train Loss: 1.449 Vali Loss: 1.416 Vali Acc: 0.312 Test Loss: 1.416 Test Acc: 0.312
Validation loss decreased (inf --> -0.311580).  Saving model ...
Epoch: 2 cost time: 0.9250633716583252
Epoch: 2, Steps: 9 | Train Loss: 1.370 Vali Loss: 1.335 Vali Acc: 0.377 Test Loss: 1.335 Test Acc: 0.377
Validation loss decreased (-0.311580 --> -0.376798).  Saving model ...
Epoch: 3 cost time: 0.8627228736877441
Epoch: 3, Steps: 9 | Train Loss: 1.263 Vali Loss: 1.248 Vali Acc: 0.449 Test Loss: 1.248 Test Acc: 0.449
Validation loss decreased (-0.376798 --> -0.449263).  Saving model ...
Epoch: 4 cost time: 0.9129362106323242
Epoch: 4, Steps: 9 | Train Loss: 1.157 Vali Loss: 1.180 Vali Acc: 0.449 Test Loss: 1.180 Test Acc: 0.449
Validation loss decreased (-0.449263 --> -0.449264).  Saving model ...
Epoch: 5 cost time: 0.8642923831939697
Epoch: 5, Steps: 9 | Train Loss: 1.061 Vali Loss: 1.120 Vali Acc: 0.464 Test Loss: 1.120 Test Acc: 0.464
Validation loss decreased (-0.449264 --> -0.463757).  Saving model ...
Epoch: 6 cost time: 0.8028914928436279
Epoch: 6, Steps: 9 | Train Loss: 0.980 Vali Loss: 1.092 Vali Acc: 0.471 Test Loss: 1.092 Test Acc: 0.471
Validation loss decreased (-0.463757 --> -0.471004).  Saving model ...
Epoch: 7 cost time: 1.038679599761963
Epoch: 7, Steps: 9 | Train Loss: 0.935 Vali Loss: 1.064 Vali Acc: 0.464 Test Loss: 1.064 Test Acc: 0.464
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0090103149414062
Epoch: 8, Steps: 9 | Train Loss: 0.887 Vali Loss: 1.047 Vali Acc: 0.478 Test Loss: 1.047 Test Acc: 0.478
Validation loss decreased (-0.471004 --> -0.478250).  Saving model ...
Epoch: 9 cost time: 0.9724011421203613
Epoch: 9, Steps: 9 | Train Loss: 0.821 Vali Loss: 1.023 Vali Acc: 0.522 Test Loss: 1.023 Test Acc: 0.522
Validation loss decreased (-0.478250 --> -0.521729).  Saving model ...
Epoch: 10 cost time: 1.010209083557129
Epoch: 10, Steps: 9 | Train Loss: 0.771 Vali Loss: 1.014 Vali Acc: 0.565 Test Loss: 1.014 Test Acc: 0.565
Validation loss decreased (-0.521729 --> -0.565207).  Saving model ...
Epoch: 11 cost time: 0.9587948322296143
Epoch: 11, Steps: 9 | Train Loss: 0.724 Vali Loss: 1.015 Vali Acc: 0.507 Test Loss: 1.015 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9772861003875732
Epoch: 12, Steps: 9 | Train Loss: 0.709 Vali Loss: 1.007 Vali Acc: 0.500 Test Loss: 1.007 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7855010032653809
Epoch: 13, Steps: 9 | Train Loss: 0.655 Vali Loss: 1.006 Vali Acc: 0.522 Test Loss: 1.006 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8439314365386963
Epoch: 14, Steps: 9 | Train Loss: 0.618 Vali Loss: 1.004 Vali Acc: 0.543 Test Loss: 1.004 Test Acc: 0.543
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0003373622894287
Epoch: 15, Steps: 9 | Train Loss: 0.588 Vali Loss: 1.005 Vali Acc: 0.565 Test Loss: 1.005 Test Acc: 0.565
Validation loss decreased (-0.565207 --> -0.565207).  Saving model ...
Epoch: 16 cost time: 1.0477349758148193
Epoch: 16, Steps: 9 | Train Loss: 0.542 Vali Loss: 1.002 Vali Acc: 0.572 Test Loss: 1.002 Test Acc: 0.572
Validation loss decreased (-0.565207 --> -0.572454).  Saving model ...
Epoch: 17 cost time: 0.9216952323913574
Epoch: 17, Steps: 9 | Train Loss: 0.522 Vali Loss: 1.027 Vali Acc: 0.558 Test Loss: 1.027 Test Acc: 0.558
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9990472793579102
Epoch: 18, Steps: 9 | Train Loss: 0.499 Vali Loss: 1.028 Vali Acc: 0.572 Test Loss: 1.028 Test Acc: 0.572
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8324785232543945
Epoch: 19, Steps: 9 | Train Loss: 0.471 Vali Loss: 1.045 Vali Acc: 0.587 Test Loss: 1.045 Test Acc: 0.587
Validation loss decreased (-0.572454 --> -0.586946).  Saving model ...
Epoch: 20 cost time: 0.8195924758911133
Epoch: 20, Steps: 9 | Train Loss: 0.442 Vali Loss: 1.060 Vali Acc: 0.580 Test Loss: 1.060 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9553930759429932
Epoch: 21, Steps: 9 | Train Loss: 0.412 Vali Loss: 1.035 Vali Acc: 0.587 Test Loss: 1.035 Test Acc: 0.587
Validation loss decreased (-0.586946 --> -0.586946).  Saving model ...
Epoch: 22 cost time: 1.0654230117797852
Epoch: 22, Steps: 9 | Train Loss: 0.387 Vali Loss: 1.068 Vali Acc: 0.594 Test Loss: 1.068 Test Acc: 0.594
Validation loss decreased (-0.586946 --> -0.594192).  Saving model ...
Epoch: 23 cost time: 0.8926141262054443
Epoch: 23, Steps: 9 | Train Loss: 0.368 Vali Loss: 1.090 Vali Acc: 0.601 Test Loss: 1.090 Test Acc: 0.601
Validation loss decreased (-0.594192 --> -0.601438).  Saving model ...
Epoch: 24 cost time: 0.8186366558074951
Epoch: 24, Steps: 9 | Train Loss: 0.341 Vali Loss: 1.108 Vali Acc: 0.594 Test Loss: 1.108 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8474736213684082
Epoch: 25, Steps: 9 | Train Loss: 0.318 Vali Loss: 1.107 Vali Acc: 0.601 Test Loss: 1.107 Test Acc: 0.601
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0683841705322266
Epoch: 26, Steps: 9 | Train Loss: 0.306 Vali Loss: 1.126 Vali Acc: 0.601 Test Loss: 1.126 Test Acc: 0.601
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9617629051208496
Epoch: 27, Steps: 9 | Train Loss: 0.276 Vali Loss: 1.128 Vali Acc: 0.601 Test Loss: 1.128 Test Acc: 0.601
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.9372694492340088
Epoch: 28, Steps: 9 | Train Loss: 0.262 Vali Loss: 1.161 Vali Acc: 0.601 Test Loss: 1.161 Test Acc: 0.601
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.1090271472930908
Epoch: 29, Steps: 9 | Train Loss: 0.246 Vali Loss: 1.176 Vali Acc: 0.616 Test Loss: 1.176 Test Acc: 0.616
Validation loss decreased (-0.601438 --> -0.615930).  Saving model ...
Epoch: 30 cost time: 1.0402438640594482
Epoch: 30, Steps: 9 | Train Loss: 0.231 Vali Loss: 1.172 Vali Acc: 0.609 Test Loss: 1.172 Test Acc: 0.609
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8581318855285645
Epoch: 31, Steps: 9 | Train Loss: 0.213 Vali Loss: 1.206 Vali Acc: 0.601 Test Loss: 1.206 Test Acc: 0.601
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.1273126602172852
Epoch: 32, Steps: 9 | Train Loss: 0.199 Vali Loss: 1.199 Vali Acc: 0.609 Test Loss: 1.199 Test Acc: 0.609
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.7939465045928955
Epoch: 33, Steps: 9 | Train Loss: 0.184 Vali Loss: 1.220 Vali Acc: 0.609 Test Loss: 1.220 Test Acc: 0.609
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.1148333549499512
Epoch: 34, Steps: 9 | Train Loss: 0.170 Vali Loss: 1.235 Vali Acc: 0.616 Test Loss: 1.235 Test Acc: 0.616
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.9472723007202148
Epoch: 35, Steps: 9 | Train Loss: 0.155 Vali Loss: 1.254 Vali Acc: 0.616 Test Loss: 1.254 Test Acc: 0.616
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.9483039379119873
Epoch: 36, Steps: 9 | Train Loss: 0.147 Vali Loss: 1.282 Vali Acc: 0.623 Test Loss: 1.282 Test Acc: 0.623
Validation loss decreased (-0.615930 --> -0.623176).  Saving model ...
Epoch: 37 cost time: 0.9638006687164307
Epoch: 37, Steps: 9 | Train Loss: 0.129 Vali Loss: 1.306 Vali Acc: 0.616 Test Loss: 1.306 Test Acc: 0.616
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.8564624786376953
Epoch: 38, Steps: 9 | Train Loss: 0.117 Vali Loss: 1.295 Vali Acc: 0.623 Test Loss: 1.295 Test Acc: 0.623
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.7132725715637207
Epoch: 39, Steps: 9 | Train Loss: 0.108 Vali Loss: 1.325 Vali Acc: 0.609 Test Loss: 1.325 Test Acc: 0.609
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.7026669979095459
Epoch: 40, Steps: 9 | Train Loss: 0.098 Vali Loss: 1.333 Vali Acc: 0.638 Test Loss: 1.333 Test Acc: 0.638
Validation loss decreased (-0.623176 --> -0.637668).  Saving model ...
Epoch: 41 cost time: 0.8841087818145752
Epoch: 41, Steps: 9 | Train Loss: 0.092 Vali Loss: 1.360 Vali Acc: 0.630 Test Loss: 1.360 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.0640356540679932
Epoch: 42, Steps: 9 | Train Loss: 0.077 Vali Loss: 1.343 Vali Acc: 0.638 Test Loss: 1.343 Test Acc: 0.638
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.9126880168914795
Epoch: 43, Steps: 9 | Train Loss: 0.070 Vali Loss: 1.339 Vali Acc: 0.659 Test Loss: 1.339 Test Acc: 0.659
Validation loss decreased (-0.637668 --> -0.659407).  Saving model ...
Epoch: 44 cost time: 0.9909629821777344
Epoch: 44, Steps: 9 | Train Loss: 0.062 Vali Loss: 1.374 Vali Acc: 0.659 Test Loss: 1.374 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.9059948921203613
Epoch: 45, Steps: 9 | Train Loss: 0.057 Vali Loss: 1.404 Vali Acc: 0.659 Test Loss: 1.404 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.0477252006530762
Epoch: 46, Steps: 9 | Train Loss: 0.048 Vali Loss: 1.391 Vali Acc: 0.674 Test Loss: 1.391 Test Acc: 0.674
Validation loss decreased (-0.659407 --> -0.673899).  Saving model ...
Epoch: 47 cost time: 0.8513901233673096
Epoch: 47, Steps: 9 | Train Loss: 0.044 Vali Loss: 1.374 Vali Acc: 0.674 Test Loss: 1.374 Test Acc: 0.674
Validation loss decreased (-0.673899 --> -0.673899).  Saving model ...
Epoch: 48 cost time: 0.9631175994873047
Epoch: 48, Steps: 9 | Train Loss: 0.039 Vali Loss: 1.414 Vali Acc: 0.674 Test Loss: 1.414 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.8803083896636963
Epoch: 49, Steps: 9 | Train Loss: 0.035 Vali Loss: 1.427 Vali Acc: 0.667 Test Loss: 1.427 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.8070206642150879
Epoch: 50, Steps: 9 | Train Loss: 0.030 Vali Loss: 1.400 Vali Acc: 0.674 Test Loss: 1.400 Test Acc: 0.674
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.171868085861206
Epoch: 51, Steps: 9 | Train Loss: 0.027 Vali Loss: 1.396 Vali Acc: 0.674 Test Loss: 1.396 Test Acc: 0.674
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.7834501266479492
Epoch: 52, Steps: 9 | Train Loss: 0.024 Vali Loss: 1.412 Vali Acc: 0.674 Test Loss: 1.412 Test Acc: 0.674
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 0.9313216209411621
Epoch: 53, Steps: 9 | Train Loss: 0.022 Vali Loss: 1.426 Vali Acc: 0.667 Test Loss: 1.426 Test Acc: 0.667
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 0.9338898658752441
Epoch: 54, Steps: 9 | Train Loss: 0.019 Vali Loss: 1.420 Vali Acc: 0.667 Test Loss: 1.420 Test Acc: 0.667
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 0.8557569980621338
Epoch: 55, Steps: 9 | Train Loss: 0.017 Vali Loss: 1.407 Vali Acc: 0.674 Test Loss: 1.407 Test Acc: 0.674
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 0.7778756618499756
Epoch: 56, Steps: 9 | Train Loss: 0.015 Vali Loss: 1.403 Vali Acc: 0.674 Test Loss: 1.403 Test Acc: 0.674
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 0.8077161312103271
Epoch: 57, Steps: 9 | Train Loss: 0.014 Vali Loss: 1.411 Vali Acc: 0.681 Test Loss: 1.411 Test Acc: 0.681
Validation loss decreased (-0.673899 --> -0.681145).  Saving model ...
Epoch: 58 cost time: 0.6725196838378906
Epoch: 58, Steps: 9 | Train Loss: 0.012 Vali Loss: 1.412 Vali Acc: 0.681 Test Loss: 1.412 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.9128241539001465
Epoch: 59, Steps: 9 | Train Loss: 0.011 Vali Loss: 1.413 Vali Acc: 0.674 Test Loss: 1.413 Test Acc: 0.674
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.7614424228668213
Epoch: 60, Steps: 9 | Train Loss: 0.010 Vali Loss: 1.396 Vali Acc: 0.674 Test Loss: 1.396 Test Acc: 0.674
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 1.0484094619750977
Epoch: 61, Steps: 9 | Train Loss: 0.009 Vali Loss: 1.388 Vali Acc: 0.674 Test Loss: 1.388 Test Acc: 0.674
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 0.6682569980621338
Epoch: 62, Steps: 9 | Train Loss: 0.008 Vali Loss: 1.390 Vali Acc: 0.674 Test Loss: 1.390 Test Acc: 0.674
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 0.7527720928192139
Epoch: 63, Steps: 9 | Train Loss: 0.008 Vali Loss: 1.416 Vali Acc: 0.667 Test Loss: 1.416 Test Acc: 0.667
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 0.8799839019775391
Epoch: 64, Steps: 9 | Train Loss: 0.007 Vali Loss: 1.419 Vali Acc: 0.667 Test Loss: 1.419 Test Acc: 0.667
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 0.6821022033691406
Epoch: 65, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.403 Vali Acc: 0.667 Test Loss: 1.403 Test Acc: 0.667
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 0.6800196170806885
Epoch: 66, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.396 Vali Acc: 0.667 Test Loss: 1.396 Test Acc: 0.667
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 0.7118692398071289
Epoch: 67, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.385 Vali Acc: 0.681 Test Loss: 1.385 Test Acc: 0.681
Validation loss decreased (-0.681145 --> -0.681146).  Saving model ...
Epoch: 68 cost time: 0.7642757892608643
Epoch: 68, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.379 Vali Acc: 0.688 Test Loss: 1.379 Test Acc: 0.688
Validation loss decreased (-0.681146 --> -0.688392).  Saving model ...
Epoch: 69 cost time: 0.6962318420410156
Epoch: 69, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.385 Vali Acc: 0.688 Test Loss: 1.385 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.9981555938720703
Epoch: 70, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.390 Vali Acc: 0.681 Test Loss: 1.390 Test Acc: 0.681
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 0.8034012317657471
Epoch: 71, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.390 Vali Acc: 0.681 Test Loss: 1.390 Test Acc: 0.681
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 0.723107099533081
Epoch: 72, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.375 Vali Acc: 0.681 Test Loss: 1.375 Test Acc: 0.681
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 0.6572597026824951
Epoch: 73, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.379 Vali Acc: 0.681 Test Loss: 1.379 Test Acc: 0.681
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 0.7454133033752441
Epoch: 74, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.380 Vali Acc: 0.681 Test Loss: 1.380 Test Acc: 0.681
EarlyStopping counter: 6 out of 10
Epoch: 75 cost time: 0.7445003986358643
Epoch: 75, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.380 Vali Acc: 0.688 Test Loss: 1.380 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 76 cost time: 0.9078500270843506
Epoch: 76, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.385 Vali Acc: 0.674 Test Loss: 1.385 Test Acc: 0.674
EarlyStopping counter: 8 out of 10
Epoch: 77 cost time: 0.9601061344146729
Epoch: 77, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.389 Vali Acc: 0.674 Test Loss: 1.389 Test Acc: 0.674
EarlyStopping counter: 9 out of 10
Epoch: 78 cost time: 0.7599012851715088
Epoch: 78, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.373 Vali Acc: 0.681 Test Loss: 1.373 Test Acc: 0.681
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm64_cs15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.6884057971014492
model parameter : 50386
model size : 0.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm64_cs14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.5382320880889893
Epoch: 1, Steps: 9 | Train Loss: 1.454 Vali Loss: 1.381 Vali Acc: 0.391 Test Loss: 1.381 Test Acc: 0.391
Validation loss decreased (inf --> -0.391291).  Saving model ...
Epoch: 2 cost time: 0.8087780475616455
Epoch: 2, Steps: 9 | Train Loss: 1.378 Vali Loss: 1.305 Vali Acc: 0.384 Test Loss: 1.305 Test Acc: 0.384
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6989197731018066
Epoch: 3, Steps: 9 | Train Loss: 1.282 Vali Loss: 1.229 Vali Acc: 0.449 Test Loss: 1.229 Test Acc: 0.449
Validation loss decreased (-0.391291 --> -0.449263).  Saving model ...
Epoch: 4 cost time: 0.7044665813446045
Epoch: 4, Steps: 9 | Train Loss: 1.168 Vali Loss: 1.160 Vali Acc: 0.442 Test Loss: 1.160 Test Acc: 0.442
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7010409832000732
Epoch: 5, Steps: 9 | Train Loss: 1.082 Vali Loss: 1.105 Vali Acc: 0.442 Test Loss: 1.105 Test Acc: 0.442
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7087359428405762
Epoch: 6, Steps: 9 | Train Loss: 1.015 Vali Loss: 1.070 Vali Acc: 0.457 Test Loss: 1.070 Test Acc: 0.457
Validation loss decreased (-0.449263 --> -0.456511).  Saving model ...
Epoch: 7 cost time: 0.8649144172668457
Epoch: 7, Steps: 9 | Train Loss: 0.928 Vali Loss: 1.039 Vali Acc: 0.471 Test Loss: 1.039 Test Acc: 0.471
Validation loss decreased (-0.456511 --> -0.471004).  Saving model ...
Epoch: 8 cost time: 0.9140729904174805
Epoch: 8, Steps: 9 | Train Loss: 0.875 Vali Loss: 1.019 Vali Acc: 0.493 Test Loss: 1.019 Test Acc: 0.493
Validation loss decreased (-0.471004 --> -0.492743).  Saving model ...
Epoch: 9 cost time: 1.0120303630828857
Epoch: 9, Steps: 9 | Train Loss: 0.822 Vali Loss: 0.998 Vali Acc: 0.514 Test Loss: 0.998 Test Acc: 0.514
Validation loss decreased (-0.492743 --> -0.514483).  Saving model ...
Epoch: 10 cost time: 0.7002513408660889
Epoch: 10, Steps: 9 | Train Loss: 0.776 Vali Loss: 0.998 Vali Acc: 0.500 Test Loss: 0.998 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.950930118560791
Epoch: 11, Steps: 9 | Train Loss: 0.739 Vali Loss: 1.002 Vali Acc: 0.514 Test Loss: 1.002 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7668161392211914
Epoch: 12, Steps: 9 | Train Loss: 0.681 Vali Loss: 0.986 Vali Acc: 0.536 Test Loss: 0.986 Test Acc: 0.536
Validation loss decreased (-0.514483 --> -0.536222).  Saving model ...
Epoch: 13 cost time: 0.7437376976013184
Epoch: 13, Steps: 9 | Train Loss: 0.660 Vali Loss: 0.985 Vali Acc: 0.551 Test Loss: 0.985 Test Acc: 0.551
Validation loss decreased (-0.536222 --> -0.550715).  Saving model ...
Epoch: 14 cost time: 0.7667596340179443
Epoch: 14, Steps: 9 | Train Loss: 0.627 Vali Loss: 0.984 Vali Acc: 0.565 Test Loss: 0.984 Test Acc: 0.565
Validation loss decreased (-0.550715 --> -0.565208).  Saving model ...
Epoch: 15 cost time: 0.8616297245025635
Epoch: 15, Steps: 9 | Train Loss: 0.590 Vali Loss: 0.986 Vali Acc: 0.551 Test Loss: 0.986 Test Acc: 0.551
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8076479434967041
Epoch: 16, Steps: 9 | Train Loss: 0.550 Vali Loss: 0.985 Vali Acc: 0.587 Test Loss: 0.985 Test Acc: 0.587
Validation loss decreased (-0.565208 --> -0.586947).  Saving model ...
Epoch: 17 cost time: 0.9249012470245361
Epoch: 17, Steps: 9 | Train Loss: 0.533 Vali Loss: 0.988 Vali Acc: 0.601 Test Loss: 0.988 Test Acc: 0.601
Validation loss decreased (-0.586947 --> -0.601439).  Saving model ...
Epoch: 18 cost time: 0.9058706760406494
Epoch: 18, Steps: 9 | Train Loss: 0.509 Vali Loss: 0.992 Vali Acc: 0.580 Test Loss: 0.992 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1326730251312256
Epoch: 19, Steps: 9 | Train Loss: 0.461 Vali Loss: 1.001 Vali Acc: 0.594 Test Loss: 1.001 Test Acc: 0.594
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9025733470916748
Epoch: 20, Steps: 9 | Train Loss: 0.436 Vali Loss: 1.006 Vali Acc: 0.601 Test Loss: 1.006 Test Acc: 0.601
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7069356441497803
Epoch: 21, Steps: 9 | Train Loss: 0.405 Vali Loss: 0.998 Vali Acc: 0.609 Test Loss: 0.998 Test Acc: 0.609
Validation loss decreased (-0.601439 --> -0.608686).  Saving model ...
Epoch: 22 cost time: 0.6607306003570557
Epoch: 22, Steps: 9 | Train Loss: 0.371 Vali Loss: 1.011 Vali Acc: 0.609 Test Loss: 1.011 Test Acc: 0.609
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.980877161026001
Epoch: 23, Steps: 9 | Train Loss: 0.337 Vali Loss: 1.003 Vali Acc: 0.616 Test Loss: 1.003 Test Acc: 0.616
Validation loss decreased (-0.608686 --> -0.615932).  Saving model ...
Epoch: 24 cost time: 1.002882480621338
Epoch: 24, Steps: 9 | Train Loss: 0.307 Vali Loss: 0.972 Vali Acc: 0.630 Test Loss: 0.972 Test Acc: 0.630
Validation loss decreased (-0.615932 --> -0.630425).  Saving model ...
Epoch: 25 cost time: 0.8852405548095703
Epoch: 25, Steps: 9 | Train Loss: 0.276 Vali Loss: 0.942 Vali Acc: 0.674 Test Loss: 0.942 Test Acc: 0.674
Validation loss decreased (-0.630425 --> -0.673904).  Saving model ...
Epoch: 26 cost time: 1.103130578994751
Epoch: 26, Steps: 9 | Train Loss: 0.229 Vali Loss: 0.884 Vali Acc: 0.681 Test Loss: 0.884 Test Acc: 0.681
Validation loss decreased (-0.673904 --> -0.681151).  Saving model ...
Epoch: 27 cost time: 0.9436335563659668
Epoch: 27, Steps: 9 | Train Loss: 0.184 Vali Loss: 0.799 Vali Acc: 0.710 Test Loss: 0.799 Test Acc: 0.710
Validation loss decreased (-0.681151 --> -0.710137).  Saving model ...
Epoch: 28 cost time: 0.7525384426116943
Epoch: 28, Steps: 9 | Train Loss: 0.152 Vali Loss: 0.702 Vali Acc: 0.754 Test Loss: 0.702 Test Acc: 0.754
Validation loss decreased (-0.710137 --> -0.753616).  Saving model ...
Epoch: 29 cost time: 0.8985953330993652
Epoch: 29, Steps: 9 | Train Loss: 0.109 Vali Loss: 0.624 Vali Acc: 0.775 Test Loss: 0.624 Test Acc: 0.775
Validation loss decreased (-0.753616 --> -0.775356).  Saving model ...
Epoch: 30 cost time: 0.8805019855499268
Epoch: 30, Steps: 9 | Train Loss: 0.086 Vali Loss: 0.571 Vali Acc: 0.783 Test Loss: 0.571 Test Acc: 0.783
Validation loss decreased (-0.775356 --> -0.782603).  Saving model ...
Epoch: 31 cost time: 0.7119596004486084
Epoch: 31, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.534 Vali Acc: 0.812 Test Loss: 0.534 Test Acc: 0.812
Validation loss decreased (-0.782603 --> -0.811589).  Saving model ...
Epoch: 32 cost time: 0.8809101581573486
Epoch: 32, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.499 Vali Acc: 0.819 Test Loss: 0.499 Test Acc: 0.819
Validation loss decreased (-0.811589 --> -0.818836).  Saving model ...
Epoch: 33 cost time: 0.96372389793396
Epoch: 33, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.477 Vali Acc: 0.826 Test Loss: 0.477 Test Acc: 0.826
Validation loss decreased (-0.818836 --> -0.826082).  Saving model ...
Epoch: 34 cost time: 0.9449481964111328
Epoch: 34, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.449 Vali Acc: 0.833 Test Loss: 0.449 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833329).  Saving model ...
Epoch: 35 cost time: 1.063248872756958
Epoch: 35, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.430 Vali Acc: 0.855 Test Loss: 0.430 Test Acc: 0.855
Validation loss decreased (-0.833329 --> -0.855068).  Saving model ...
Epoch: 36 cost time: 0.7801535129547119
Epoch: 36, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.435 Vali Acc: 0.870 Test Loss: 0.435 Test Acc: 0.870
Validation loss decreased (-0.855068 --> -0.869561).  Saving model ...
Epoch: 37 cost time: 0.7246665954589844
Epoch: 37, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.422 Vali Acc: 0.870 Test Loss: 0.422 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 38 cost time: 0.9034154415130615
Epoch: 38, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.388 Vali Acc: 0.884 Test Loss: 0.388 Test Acc: 0.884
Validation loss decreased (-0.869561 --> -0.884054).  Saving model ...
Epoch: 39 cost time: 0.8888144493103027
Epoch: 39, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.399 Vali Acc: 0.884 Test Loss: 0.399 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.7320802211761475
Epoch: 40, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.407 Vali Acc: 0.884 Test Loss: 0.407 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.0066068172454834
Epoch: 41, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.371 Vali Acc: 0.884 Test Loss: 0.371 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 42 cost time: 0.9233696460723877
Epoch: 42, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.374 Vali Acc: 0.891 Test Loss: 0.374 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891301).  Saving model ...
Epoch: 43 cost time: 0.8040111064910889
Epoch: 43, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.375 Vali Acc: 0.891 Test Loss: 0.375 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.7981448173522949
Epoch: 44, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.368 Vali Acc: 0.899 Test Loss: 0.368 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898547).  Saving model ...
Epoch: 45 cost time: 0.8111028671264648
Epoch: 45, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.346 Vali Acc: 0.899 Test Loss: 0.346 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 46 cost time: 0.6867196559906006
Epoch: 46, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.340 Vali Acc: 0.906 Test Loss: 0.340 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905794).  Saving model ...
Epoch: 47 cost time: 0.9016177654266357
Epoch: 47, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.338 Vali Acc: 0.906 Test Loss: 0.338 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 48 cost time: 0.6885831356048584
Epoch: 48, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.340 Vali Acc: 0.899 Test Loss: 0.340 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.8365166187286377
Epoch: 49, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.344 Vali Acc: 0.899 Test Loss: 0.344 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.7079992294311523
Epoch: 50, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.319 Vali Acc: 0.906 Test Loss: 0.319 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 51 cost time: 0.6547501087188721
Epoch: 51, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.324 Vali Acc: 0.906 Test Loss: 0.324 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.8684391975402832
Epoch: 52, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.329 Vali Acc: 0.906 Test Loss: 0.329 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.6816117763519287
Epoch: 53, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.324 Vali Acc: 0.906 Test Loss: 0.324 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.7848703861236572
Epoch: 54, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.311 Vali Acc: 0.906 Test Loss: 0.311 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 55 cost time: 0.7712662220001221
Epoch: 55, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.312 Vali Acc: 0.906 Test Loss: 0.312 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.9735300540924072
Epoch: 56, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.297 Vali Acc: 0.906 Test Loss: 0.297 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 57 cost time: 0.6990249156951904
Epoch: 57, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.308 Vali Acc: 0.906 Test Loss: 0.308 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.7297968864440918
Epoch: 58, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.307 Vali Acc: 0.906 Test Loss: 0.307 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.9390318393707275
Epoch: 59, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.297 Vali Acc: 0.906 Test Loss: 0.297 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 60 cost time: 0.9467198848724365
Epoch: 60, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.302 Vali Acc: 0.906 Test Loss: 0.302 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.7733354568481445
Epoch: 61, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.295 Vali Acc: 0.913 Test Loss: 0.295 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913041).  Saving model ...
Epoch: 62 cost time: 0.7695596218109131
Epoch: 62, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.294 Vali Acc: 0.913 Test Loss: 0.294 Test Acc: 0.913
Validation loss decreased (-0.913041 --> -0.913041).  Saving model ...
Epoch: 63 cost time: 0.7420406341552734
Epoch: 63, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.283 Vali Acc: 0.920 Test Loss: 0.283 Test Acc: 0.920
Validation loss decreased (-0.913041 --> -0.920287).  Saving model ...
Epoch: 64 cost time: 0.7541203498840332
Epoch: 64, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.292 Vali Acc: 0.913 Test Loss: 0.292 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.8457732200622559
Epoch: 65, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.298 Vali Acc: 0.906 Test Loss: 0.298 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 0.9722704887390137
Epoch: 66, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.288 Vali Acc: 0.920 Test Loss: 0.288 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 0.6630308628082275
Epoch: 67, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.281 Vali Acc: 0.920 Test Loss: 0.281 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 68 cost time: 0.8787989616394043
Epoch: 68, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.286 Vali Acc: 0.913 Test Loss: 0.286 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.9633936882019043
Epoch: 69, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.283 Vali Acc: 0.920 Test Loss: 0.283 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 0.691126823425293
Epoch: 70, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.285 Vali Acc: 0.920 Test Loss: 0.285 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 0.8495481014251709
Epoch: 71, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.286 Vali Acc: 0.920 Test Loss: 0.286 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 0.8485608100891113
Epoch: 72, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.286 Vali Acc: 0.920 Test Loss: 0.286 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 0.7240908145904541
Epoch: 73, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.271 Vali Acc: 0.928 Test Loss: 0.271 Test Acc: 0.928
Validation loss decreased (-0.920287 --> -0.927534).  Saving model ...
Epoch: 74 cost time: 0.6439685821533203
Epoch: 74, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.267 Vali Acc: 0.942 Test Loss: 0.267 Test Acc: 0.942
Validation loss decreased (-0.927534 --> -0.942026).  Saving model ...
Epoch: 75 cost time: 0.7178075313568115
Epoch: 75, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.935 Test Loss: 0.274 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.7567174434661865
Epoch: 76, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.277 Vali Acc: 0.935 Test Loss: 0.277 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 1.0487496852874756
Epoch: 77, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.935 Test Loss: 0.274 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 0.947239875793457
Epoch: 78, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.942 Test Loss: 0.270 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 0.732515811920166
Epoch: 79, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.265 Vali Acc: 0.942 Test Loss: 0.265 Test Acc: 0.942
Validation loss decreased (-0.942026 --> -0.942026).  Saving model ...
Epoch: 80 cost time: 0.7363908290863037
Epoch: 80, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.942 Test Loss: 0.268 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 0.8353636264801025
Epoch: 81, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.264 Vali Acc: 0.942 Test Loss: 0.264 Test Acc: 0.942
Validation loss decreased (-0.942026 --> -0.942026).  Saving model ...
Epoch: 82 cost time: 0.7638118267059326
Epoch: 82, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.266 Vali Acc: 0.942 Test Loss: 0.266 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 0.7270500659942627
Epoch: 83, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.942 Test Loss: 0.268 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 0.9898531436920166
Epoch: 84, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.942 Test Loss: 0.268 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 85 cost time: 0.7980239391326904
Epoch: 85, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.265 Vali Acc: 0.942 Test Loss: 0.265 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 86 cost time: 0.97707200050354
Epoch: 86, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.260 Vali Acc: 0.942 Test Loss: 0.260 Test Acc: 0.942
Validation loss decreased (-0.942026 --> -0.942026).  Saving model ...
Epoch: 87 cost time: 0.7692916393280029
Epoch: 87, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.259 Vali Acc: 0.942 Test Loss: 0.259 Test Acc: 0.942
Validation loss decreased (-0.942026 --> -0.942026).  Saving model ...
Epoch: 88 cost time: 0.8263771533966064
Epoch: 88, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.257 Vali Acc: 0.949 Test Loss: 0.257 Test Acc: 0.949
Validation loss decreased (-0.942026 --> -0.949273).  Saving model ...
Epoch: 89 cost time: 0.8514096736907959
Epoch: 89, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.258 Vali Acc: 0.949 Test Loss: 0.258 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 0.7922861576080322
Epoch: 90, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.258 Vali Acc: 0.949 Test Loss: 0.258 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 91 cost time: 0.7707624435424805
Epoch: 91, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.262 Vali Acc: 0.949 Test Loss: 0.262 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 92 cost time: 0.8877627849578857
Epoch: 92, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.263 Vali Acc: 0.949 Test Loss: 0.263 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 93 cost time: 0.9598753452301025
Epoch: 93, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.949 Test Loss: 0.249 Test Acc: 0.949
Validation loss decreased (-0.949273 --> -0.949273).  Saving model ...
Epoch: 94 cost time: 0.7192256450653076
Epoch: 94, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.949 Test Loss: 0.253 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 1.05413818359375
Epoch: 95, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.949 Test Loss: 0.259 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 96 cost time: 0.9292712211608887
Epoch: 96, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.949 Test Loss: 0.261 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 97 cost time: 0.9479916095733643
Epoch: 97, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.949 Test Loss: 0.265 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 98 cost time: 0.9779982566833496
Epoch: 98, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.949 Test Loss: 0.261 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 99 cost time: 0.7777528762817383
Epoch: 99, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.949 Test Loss: 0.259 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 100 cost time: 0.7454166412353516
Epoch: 100, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.949 Test Loss: 0.259 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm64_cs14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9492753623188406
model parameter : 50416
model size : 0.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm64_cs13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.712066173553467
Epoch: 1, Steps: 9 | Train Loss: 1.470 Vali Loss: 1.428 Vali Acc: 0.232 Test Loss: 1.428 Test Acc: 0.232
Validation loss decreased (inf --> -0.231870).  Saving model ...
Epoch: 2 cost time: 0.9034304618835449
Epoch: 2, Steps: 9 | Train Loss: 1.401 Vali Loss: 1.342 Vali Acc: 0.377 Test Loss: 1.342 Test Acc: 0.377
Validation loss decreased (-0.231870 --> -0.376798).  Saving model ...
Epoch: 3 cost time: 0.7725474834442139
Epoch: 3, Steps: 9 | Train Loss: 1.282 Vali Loss: 1.255 Vali Acc: 0.435 Test Loss: 1.255 Test Acc: 0.435
Validation loss decreased (-0.376798 --> -0.434770).  Saving model ...
Epoch: 4 cost time: 0.7500514984130859
Epoch: 4, Steps: 9 | Train Loss: 1.171 Vali Loss: 1.174 Vali Acc: 0.500 Test Loss: 1.174 Test Acc: 0.500
Validation loss decreased (-0.434770 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 0.6896839141845703
Epoch: 5, Steps: 9 | Train Loss: 1.059 Vali Loss: 1.120 Vali Acc: 0.514 Test Loss: 1.120 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.514482).  Saving model ...
Epoch: 6 cost time: 0.7141153812408447
Epoch: 6, Steps: 9 | Train Loss: 0.987 Vali Loss: 1.086 Vali Acc: 0.500 Test Loss: 1.086 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6502373218536377
Epoch: 7, Steps: 9 | Train Loss: 0.919 Vali Loss: 1.058 Vali Acc: 0.493 Test Loss: 1.058 Test Acc: 0.493
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9264514446258545
Epoch: 8, Steps: 9 | Train Loss: 0.876 Vali Loss: 1.038 Vali Acc: 0.522 Test Loss: 1.038 Test Acc: 0.522
Validation loss decreased (-0.514482 --> -0.521729).  Saving model ...
Epoch: 9 cost time: 1.0069067478179932
Epoch: 9, Steps: 9 | Train Loss: 0.811 Vali Loss: 1.011 Vali Acc: 0.536 Test Loss: 1.011 Test Acc: 0.536
Validation loss decreased (-0.521729 --> -0.536222).  Saving model ...
Epoch: 10 cost time: 0.9676032066345215
Epoch: 10, Steps: 9 | Train Loss: 0.750 Vali Loss: 0.983 Vali Acc: 0.551 Test Loss: 0.983 Test Acc: 0.551
Validation loss decreased (-0.536222 --> -0.550715).  Saving model ...
Epoch: 11 cost time: 0.9639158248901367
Epoch: 11, Steps: 9 | Train Loss: 0.702 Vali Loss: 0.969 Vali Acc: 0.558 Test Loss: 0.969 Test Acc: 0.558
Validation loss decreased (-0.550715 --> -0.557961).  Saving model ...
Epoch: 12 cost time: 0.9415302276611328
Epoch: 12, Steps: 9 | Train Loss: 0.664 Vali Loss: 0.951 Vali Acc: 0.572 Test Loss: 0.951 Test Acc: 0.572
Validation loss decreased (-0.557961 --> -0.572454).  Saving model ...
Epoch: 13 cost time: 0.7617478370666504
Epoch: 13, Steps: 9 | Train Loss: 0.620 Vali Loss: 0.938 Vali Acc: 0.558 Test Loss: 0.938 Test Acc: 0.558
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9543020725250244
Epoch: 14, Steps: 9 | Train Loss: 0.572 Vali Loss: 0.916 Vali Acc: 0.587 Test Loss: 0.916 Test Acc: 0.587
Validation loss decreased (-0.572454 --> -0.586947).  Saving model ...
Epoch: 15 cost time: 0.942969799041748
Epoch: 15, Steps: 9 | Train Loss: 0.525 Vali Loss: 0.894 Vali Acc: 0.623 Test Loss: 0.894 Test Acc: 0.623
Validation loss decreased (-0.586947 --> -0.623179).  Saving model ...
Epoch: 16 cost time: 0.8235342502593994
Epoch: 16, Steps: 9 | Train Loss: 0.484 Vali Loss: 0.862 Vali Acc: 0.630 Test Loss: 0.862 Test Acc: 0.630
Validation loss decreased (-0.623179 --> -0.630426).  Saving model ...
Epoch: 17 cost time: 0.7714731693267822
Epoch: 17, Steps: 9 | Train Loss: 0.428 Vali Loss: 0.831 Vali Acc: 0.652 Test Loss: 0.831 Test Acc: 0.652
Validation loss decreased (-0.630426 --> -0.652166).  Saving model ...
Epoch: 18 cost time: 0.9642047882080078
Epoch: 18, Steps: 9 | Train Loss: 0.379 Vali Loss: 0.816 Vali Acc: 0.674 Test Loss: 0.816 Test Acc: 0.674
Validation loss decreased (-0.652166 --> -0.673905).  Saving model ...
Epoch: 19 cost time: 0.6314303874969482
Epoch: 19, Steps: 9 | Train Loss: 0.326 Vali Loss: 0.751 Vali Acc: 0.732 Test Loss: 0.751 Test Acc: 0.732
Validation loss decreased (-0.673905 --> -0.731877).  Saving model ...
Epoch: 20 cost time: 0.9295730590820312
Epoch: 20, Steps: 9 | Train Loss: 0.278 Vali Loss: 0.687 Vali Acc: 0.746 Test Loss: 0.687 Test Acc: 0.746
Validation loss decreased (-0.731877 --> -0.746370).  Saving model ...
Epoch: 21 cost time: 0.7808516025543213
Epoch: 21, Steps: 9 | Train Loss: 0.241 Vali Loss: 0.641 Vali Acc: 0.761 Test Loss: 0.641 Test Acc: 0.761
Validation loss decreased (-0.746370 --> -0.760863).  Saving model ...
Epoch: 22 cost time: 0.6687939167022705
Epoch: 22, Steps: 9 | Train Loss: 0.188 Vali Loss: 0.585 Vali Acc: 0.797 Test Loss: 0.585 Test Acc: 0.797
Validation loss decreased (-0.760863 --> -0.797096).  Saving model ...
Epoch: 23 cost time: 0.8277080059051514
Epoch: 23, Steps: 9 | Train Loss: 0.145 Vali Loss: 0.539 Vali Acc: 0.826 Test Loss: 0.539 Test Acc: 0.826
Validation loss decreased (-0.797096 --> -0.826082).  Saving model ...
Epoch: 24 cost time: 0.8966476917266846
Epoch: 24, Steps: 9 | Train Loss: 0.121 Vali Loss: 0.491 Vali Acc: 0.833 Test Loss: 0.491 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833328).  Saving model ...
Epoch: 25 cost time: 0.8316061496734619
Epoch: 25, Steps: 9 | Train Loss: 0.094 Vali Loss: 0.440 Vali Acc: 0.841 Test Loss: 0.440 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840575).  Saving model ...
Epoch: 26 cost time: 0.6533169746398926
Epoch: 26, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.419 Vali Acc: 0.855 Test Loss: 0.419 Test Acc: 0.855
Validation loss decreased (-0.840575 --> -0.855068).  Saving model ...
Epoch: 27 cost time: 0.7225184440612793
Epoch: 27, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.393 Vali Acc: 0.862 Test Loss: 0.393 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862315).  Saving model ...
Epoch: 28 cost time: 0.6722819805145264
Epoch: 28, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.377 Vali Acc: 0.870 Test Loss: 0.377 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869561).  Saving model ...
Epoch: 29 cost time: 0.7614820003509521
Epoch: 29, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.357 Vali Acc: 0.891 Test Loss: 0.357 Test Acc: 0.891
Validation loss decreased (-0.869561 --> -0.891301).  Saving model ...
Epoch: 30 cost time: 0.8018097877502441
Epoch: 30, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.332 Vali Acc: 0.877 Test Loss: 0.332 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8238427639007568
Epoch: 31, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.307 Vali Acc: 0.884 Test Loss: 0.307 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.6629602909088135
Epoch: 32, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.301 Vali Acc: 0.891 Test Loss: 0.301 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 33 cost time: 0.8177881240844727
Epoch: 33, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.303 Vali Acc: 0.891 Test Loss: 0.303 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8646423816680908
Epoch: 34, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.286 Vali Acc: 0.899 Test Loss: 0.286 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898548).  Saving model ...
Epoch: 35 cost time: 0.6975038051605225
Epoch: 35, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.272 Vali Acc: 0.906 Test Loss: 0.272 Test Acc: 0.906
Validation loss decreased (-0.898548 --> -0.905794).  Saving model ...
Epoch: 36 cost time: 0.6806495189666748
Epoch: 36, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.286 Vali Acc: 0.906 Test Loss: 0.286 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7500288486480713
Epoch: 37, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.280 Vali Acc: 0.906 Test Loss: 0.280 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.7208402156829834
Epoch: 38, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.259 Vali Acc: 0.913 Test Loss: 0.259 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913041).  Saving model ...
Epoch: 39 cost time: 0.7260444164276123
Epoch: 39, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.245 Vali Acc: 0.913 Test Loss: 0.245 Test Acc: 0.913
Validation loss decreased (-0.913041 --> -0.913041).  Saving model ...
Epoch: 40 cost time: 0.6542055606842041
Epoch: 40, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.245 Vali Acc: 0.913 Test Loss: 0.245 Test Acc: 0.913
Validation loss decreased (-0.913041 --> -0.913041).  Saving model ...
Epoch: 41 cost time: 0.7475752830505371
Epoch: 41, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.242 Vali Acc: 0.920 Test Loss: 0.242 Test Acc: 0.920
Validation loss decreased (-0.913041 --> -0.920287).  Saving model ...
Epoch: 42 cost time: 0.7775123119354248
Epoch: 42, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.239 Vali Acc: 0.920 Test Loss: 0.239 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 43 cost time: 0.8308544158935547
Epoch: 43, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.240 Vali Acc: 0.920 Test Loss: 0.240 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.8657710552215576
Epoch: 44, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.245 Vali Acc: 0.920 Test Loss: 0.245 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.8409755229949951
Epoch: 45, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.240 Vali Acc: 0.920 Test Loss: 0.240 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.797269344329834
Epoch: 46, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.237 Vali Acc: 0.920 Test Loss: 0.237 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 47 cost time: 0.8073632717132568
Epoch: 47, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.239 Vali Acc: 0.928 Test Loss: 0.239 Test Acc: 0.928
Validation loss decreased (-0.920287 --> -0.927534).  Saving model ...
Epoch: 48 cost time: 0.7627058029174805
Epoch: 48, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.237 Vali Acc: 0.928 Test Loss: 0.237 Test Acc: 0.928
Validation loss decreased (-0.927534 --> -0.927534).  Saving model ...
Epoch: 49 cost time: 0.7032949924468994
Epoch: 49, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.233 Vali Acc: 0.935 Test Loss: 0.233 Test Acc: 0.935
Validation loss decreased (-0.927534 --> -0.934780).  Saving model ...
Epoch: 50 cost time: 0.7915947437286377
Epoch: 50, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.235 Vali Acc: 0.935 Test Loss: 0.235 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.0445117950439453
Epoch: 51, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.234 Vali Acc: 0.935 Test Loss: 0.234 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.6964733600616455
Epoch: 52, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.241 Vali Acc: 0.928 Test Loss: 0.241 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.8223471641540527
Epoch: 53, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.237 Vali Acc: 0.935 Test Loss: 0.237 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 1.0803978443145752
Epoch: 54, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.236 Vali Acc: 0.935 Test Loss: 0.236 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 0.8380842208862305
Epoch: 55, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.234 Vali Acc: 0.935 Test Loss: 0.234 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 0.7930107116699219
Epoch: 56, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.232 Vali Acc: 0.935 Test Loss: 0.232 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 57 cost time: 0.8937129974365234
Epoch: 57, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.235 Vali Acc: 0.935 Test Loss: 0.235 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.7322869300842285
Epoch: 58, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.240 Vali Acc: 0.935 Test Loss: 0.240 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.7997863292694092
Epoch: 59, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.238 Vali Acc: 0.935 Test Loss: 0.238 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.8075180053710938
Epoch: 60, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.233 Vali Acc: 0.942 Test Loss: 0.233 Test Acc: 0.942
Validation loss decreased (-0.934780 --> -0.942027).  Saving model ...
Epoch: 61 cost time: 1.0095608234405518
Epoch: 61, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.234 Vali Acc: 0.942 Test Loss: 0.234 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 1.0658273696899414
Epoch: 62, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.235 Vali Acc: 0.942 Test Loss: 0.235 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.8554892539978027
Epoch: 63, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.942 Test Loss: 0.241 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 0.8867712020874023
Epoch: 64, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.240 Vali Acc: 0.942 Test Loss: 0.240 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 0.9051082134246826
Epoch: 65, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.942 Test Loss: 0.238 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 0.7607319355010986
Epoch: 66, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.236 Vali Acc: 0.942 Test Loss: 0.236 Test Acc: 0.942
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 0.6912205219268799
Epoch: 67, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.942 Test Loss: 0.241 Test Acc: 0.942
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 0.8628213405609131
Epoch: 68, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.242 Vali Acc: 0.942 Test Loss: 0.242 Test Acc: 0.942
EarlyStopping counter: 8 out of 10
Epoch: 69 cost time: 0.8094120025634766
Epoch: 69, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.242 Vali Acc: 0.942 Test Loss: 0.242 Test Acc: 0.942
EarlyStopping counter: 9 out of 10
Epoch: 70 cost time: 0.9177892208099365
Epoch: 70, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.244 Vali Acc: 0.942 Test Loss: 0.244 Test Acc: 0.942
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm64_cs13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9420289855072463
model parameter : 50038
model size : 0.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm64_cs12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.1932566165924072
Epoch: 1, Steps: 9 | Train Loss: 1.408 Vali Loss: 1.335 Vali Acc: 0.355 Test Loss: 1.335 Test Acc: 0.355
Validation loss decreased (inf --> -0.355059).  Saving model ...
Epoch: 2 cost time: 0.6703197956085205
Epoch: 2, Steps: 9 | Train Loss: 1.336 Vali Loss: 1.272 Vali Acc: 0.413 Test Loss: 1.272 Test Acc: 0.413
Validation loss decreased (-0.355059 --> -0.413031).  Saving model ...
Epoch: 3 cost time: 0.7425763607025146
Epoch: 3, Steps: 9 | Train Loss: 1.250 Vali Loss: 1.205 Vali Acc: 0.435 Test Loss: 1.205 Test Acc: 0.435
Validation loss decreased (-0.413031 --> -0.434771).  Saving model ...
Epoch: 4 cost time: 0.8550574779510498
Epoch: 4, Steps: 9 | Train Loss: 1.153 Vali Loss: 1.146 Vali Acc: 0.457 Test Loss: 1.146 Test Acc: 0.457
Validation loss decreased (-0.434771 --> -0.456510).  Saving model ...
Epoch: 5 cost time: 0.7761008739471436
Epoch: 5, Steps: 9 | Train Loss: 1.072 Vali Loss: 1.104 Vali Acc: 0.478 Test Loss: 1.104 Test Acc: 0.478
Validation loss decreased (-0.456510 --> -0.478250).  Saving model ...
Epoch: 6 cost time: 0.7067744731903076
Epoch: 6, Steps: 9 | Train Loss: 0.991 Vali Loss: 1.080 Vali Acc: 0.486 Test Loss: 1.080 Test Acc: 0.486
Validation loss decreased (-0.478250 --> -0.485496).  Saving model ...
Epoch: 7 cost time: 0.678765058517456
Epoch: 7, Steps: 9 | Train Loss: 0.949 Vali Loss: 1.066 Vali Acc: 0.471 Test Loss: 1.066 Test Acc: 0.471
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.665787935256958
Epoch: 8, Steps: 9 | Train Loss: 0.879 Vali Loss: 1.047 Vali Acc: 0.478 Test Loss: 1.047 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8618674278259277
Epoch: 9, Steps: 9 | Train Loss: 0.828 Vali Loss: 1.033 Vali Acc: 0.514 Test Loss: 1.033 Test Acc: 0.514
Validation loss decreased (-0.485496 --> -0.514482).  Saving model ...
Epoch: 10 cost time: 0.8516461849212646
Epoch: 10, Steps: 9 | Train Loss: 0.779 Vali Loss: 1.009 Vali Acc: 0.543 Test Loss: 1.009 Test Acc: 0.543
Validation loss decreased (-0.514482 --> -0.543468).  Saving model ...
Epoch: 11 cost time: 0.6640334129333496
Epoch: 11, Steps: 9 | Train Loss: 0.740 Vali Loss: 1.018 Vali Acc: 0.529 Test Loss: 1.018 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7159953117370605
Epoch: 12, Steps: 9 | Train Loss: 0.698 Vali Loss: 1.000 Vali Acc: 0.580 Test Loss: 1.000 Test Acc: 0.580
Validation loss decreased (-0.543468 --> -0.579700).  Saving model ...
Epoch: 13 cost time: 0.730475902557373
Epoch: 13, Steps: 9 | Train Loss: 0.667 Vali Loss: 0.996 Vali Acc: 0.580 Test Loss: 0.996 Test Acc: 0.580
Validation loss decreased (-0.579700 --> -0.579700).  Saving model ...
Epoch: 14 cost time: 0.8161282539367676
Epoch: 14, Steps: 9 | Train Loss: 0.604 Vali Loss: 0.974 Vali Acc: 0.580 Test Loss: 0.974 Test Acc: 0.580
Validation loss decreased (-0.579700 --> -0.579700).  Saving model ...
Epoch: 15 cost time: 0.6431045532226562
Epoch: 15, Steps: 9 | Train Loss: 0.564 Vali Loss: 0.972 Vali Acc: 0.580 Test Loss: 0.972 Test Acc: 0.580
Validation loss decreased (-0.579700 --> -0.579700).  Saving model ...
Epoch: 16 cost time: 0.7872791290283203
Epoch: 16, Steps: 9 | Train Loss: 0.506 Vali Loss: 0.963 Vali Acc: 0.638 Test Loss: 0.963 Test Acc: 0.638
Validation loss decreased (-0.579700 --> -0.637672).  Saving model ...
Epoch: 17 cost time: 0.6946747303009033
Epoch: 17, Steps: 9 | Train Loss: 0.471 Vali Loss: 0.960 Vali Acc: 0.616 Test Loss: 0.960 Test Acc: 0.616
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.780587911605835
Epoch: 18, Steps: 9 | Train Loss: 0.428 Vali Loss: 0.918 Vali Acc: 0.623 Test Loss: 0.918 Test Acc: 0.623
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8788306713104248
Epoch: 19, Steps: 9 | Train Loss: 0.359 Vali Loss: 0.898 Vali Acc: 0.623 Test Loss: 0.898 Test Acc: 0.623
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.034174919128418
Epoch: 20, Steps: 9 | Train Loss: 0.306 Vali Loss: 0.858 Vali Acc: 0.638 Test Loss: 0.858 Test Acc: 0.638
Validation loss decreased (-0.637672 --> -0.637673).  Saving model ...
Epoch: 21 cost time: 0.6111171245574951
Epoch: 21, Steps: 9 | Train Loss: 0.272 Vali Loss: 0.824 Vali Acc: 0.667 Test Loss: 0.824 Test Acc: 0.667
Validation loss decreased (-0.637673 --> -0.666658).  Saving model ...
Epoch: 22 cost time: 0.7870299816131592
Epoch: 22, Steps: 9 | Train Loss: 0.233 Vali Loss: 0.769 Vali Acc: 0.659 Test Loss: 0.769 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7227520942687988
Epoch: 23, Steps: 9 | Train Loss: 0.194 Vali Loss: 0.769 Vali Acc: 0.659 Test Loss: 0.769 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6143970489501953
Epoch: 24, Steps: 9 | Train Loss: 0.175 Vali Loss: 0.804 Vali Acc: 0.652 Test Loss: 0.804 Test Acc: 0.652
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7062036991119385
Epoch: 25, Steps: 9 | Train Loss: 0.153 Vali Loss: 0.795 Vali Acc: 0.667 Test Loss: 0.795 Test Acc: 0.667
Validation loss decreased (-0.666658 --> -0.666659).  Saving model ...
Epoch: 26 cost time: 0.6516735553741455
Epoch: 26, Steps: 9 | Train Loss: 0.127 Vali Loss: 0.785 Vali Acc: 0.667 Test Loss: 0.785 Test Acc: 0.667
Validation loss decreased (-0.666659 --> -0.666659).  Saving model ...
Epoch: 27 cost time: 0.7998044490814209
Epoch: 27, Steps: 9 | Train Loss: 0.113 Vali Loss: 0.780 Vali Acc: 0.667 Test Loss: 0.780 Test Acc: 0.667
Validation loss decreased (-0.666659 --> -0.666659).  Saving model ...
Epoch: 28 cost time: 0.7279355525970459
Epoch: 28, Steps: 9 | Train Loss: 0.097 Vali Loss: 0.787 Vali Acc: 0.688 Test Loss: 0.787 Test Acc: 0.688
Validation loss decreased (-0.666659 --> -0.688398).  Saving model ...
Epoch: 29 cost time: 0.9856967926025391
Epoch: 29, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.789 Vali Acc: 0.681 Test Loss: 0.789 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8104710578918457
Epoch: 30, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.787 Vali Acc: 0.674 Test Loss: 0.787 Test Acc: 0.674
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.7328903675079346
Epoch: 31, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.772 Vali Acc: 0.696 Test Loss: 0.772 Test Acc: 0.696
Validation loss decreased (-0.688398 --> -0.695644).  Saving model ...
Epoch: 32 cost time: 1.0259957313537598
Epoch: 32, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.802 Vali Acc: 0.703 Test Loss: 0.802 Test Acc: 0.703
Validation loss decreased (-0.695644 --> -0.702891).  Saving model ...
Epoch: 33 cost time: 0.7142620086669922
Epoch: 33, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.841 Vali Acc: 0.703 Test Loss: 0.841 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9201827049255371
Epoch: 34, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.752 Vali Acc: 0.746 Test Loss: 0.752 Test Acc: 0.746
Validation loss decreased (-0.702891 --> -0.746369).  Saving model ...
Epoch: 35 cost time: 0.9312703609466553
Epoch: 35, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.790 Vali Acc: 0.710 Test Loss: 0.790 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8881857395172119
Epoch: 36, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.787 Vali Acc: 0.725 Test Loss: 0.787 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.9527308940887451
Epoch: 37, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.791 Vali Acc: 0.739 Test Loss: 0.791 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.6986010074615479
Epoch: 38, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.779 Vali Acc: 0.768 Test Loss: 0.779 Test Acc: 0.768
Validation loss decreased (-0.746369 --> -0.768108).  Saving model ...
Epoch: 39 cost time: 0.7400975227355957
Epoch: 39, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.782 Vali Acc: 0.761 Test Loss: 0.782 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.9339330196380615
Epoch: 40, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.781 Vali Acc: 0.761 Test Loss: 0.781 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.7069864273071289
Epoch: 41, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.788 Vali Acc: 0.768 Test Loss: 0.788 Test Acc: 0.768
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.8536968231201172
Epoch: 42, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.789 Vali Acc: 0.768 Test Loss: 0.789 Test Acc: 0.768
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.7062339782714844
Epoch: 43, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.818 Vali Acc: 0.775 Test Loss: 0.818 Test Acc: 0.775
Validation loss decreased (-0.768108 --> -0.775354).  Saving model ...
Epoch: 44 cost time: 0.6425080299377441
Epoch: 44, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.757 Vali Acc: 0.768 Test Loss: 0.757 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.6766376495361328
Epoch: 45, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.799 Vali Acc: 0.783 Test Loss: 0.799 Test Acc: 0.783
Validation loss decreased (-0.775354 --> -0.782601).  Saving model ...
Epoch: 46 cost time: 0.6728360652923584
Epoch: 46, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.805 Vali Acc: 0.783 Test Loss: 0.805 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.5745818614959717
Epoch: 47, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.802 Vali Acc: 0.783 Test Loss: 0.802 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.592606782913208
Epoch: 48, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.810 Vali Acc: 0.775 Test Loss: 0.810 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.7575428485870361
Epoch: 49, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.806 Vali Acc: 0.783 Test Loss: 0.806 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.7300505638122559
Epoch: 50, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.801 Vali Acc: 0.783 Test Loss: 0.801 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.8351728916168213
Epoch: 51, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.801 Vali Acc: 0.783 Test Loss: 0.801 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 0.7036745548248291
Epoch: 52, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.824 Vali Acc: 0.783 Test Loss: 0.824 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 0.8042232990264893
Epoch: 53, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.813 Vali Acc: 0.783 Test Loss: 0.813 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 1.1840283870697021
Epoch: 54, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.828 Vali Acc: 0.783 Test Loss: 0.828 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 0.8601515293121338
Epoch: 55, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.829 Vali Acc: 0.783 Test Loss: 0.829 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm64_cs12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.782608695652174
model parameter : 51798
model size : 0.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm64_cs11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.874044418334961
Epoch: 1, Steps: 9 | Train Loss: 1.339 Vali Loss: 1.318 Vali Acc: 0.348 Test Loss: 1.318 Test Acc: 0.348
Validation loss decreased (inf --> -0.347813).  Saving model ...
Epoch: 2 cost time: 0.7737531661987305
Epoch: 2, Steps: 9 | Train Loss: 1.259 Vali Loss: 1.251 Vali Acc: 0.399 Test Loss: 1.251 Test Acc: 0.399
Validation loss decreased (-0.347813 --> -0.398538).  Saving model ...
Epoch: 3 cost time: 0.8737390041351318
Epoch: 3, Steps: 9 | Train Loss: 1.171 Vali Loss: 1.177 Vali Acc: 0.449 Test Loss: 1.177 Test Acc: 0.449
Validation loss decreased (-0.398538 --> -0.449264).  Saving model ...
Epoch: 4 cost time: 0.7856080532073975
Epoch: 4, Steps: 9 | Train Loss: 1.080 Vali Loss: 1.128 Vali Acc: 0.471 Test Loss: 1.128 Test Acc: 0.471
Validation loss decreased (-0.449264 --> -0.471003).  Saving model ...
Epoch: 5 cost time: 0.9236373901367188
Epoch: 5, Steps: 9 | Train Loss: 1.022 Vali Loss: 1.090 Vali Acc: 0.478 Test Loss: 1.090 Test Acc: 0.478
Validation loss decreased (-0.471003 --> -0.478250).  Saving model ...
Epoch: 6 cost time: 0.721275806427002
Epoch: 6, Steps: 9 | Train Loss: 0.962 Vali Loss: 1.064 Vali Acc: 0.486 Test Loss: 1.064 Test Acc: 0.486
Validation loss decreased (-0.478250 --> -0.485497).  Saving model ...
Epoch: 7 cost time: 0.849571943283081
Epoch: 7, Steps: 9 | Train Loss: 0.892 Vali Loss: 1.033 Vali Acc: 0.507 Test Loss: 1.033 Test Acc: 0.507
Validation loss decreased (-0.485497 --> -0.507236).  Saving model ...
Epoch: 8 cost time: 1.0117418766021729
Epoch: 8, Steps: 9 | Train Loss: 0.841 Vali Loss: 1.015 Vali Acc: 0.543 Test Loss: 1.015 Test Acc: 0.543
Validation loss decreased (-0.507236 --> -0.543468).  Saving model ...
Epoch: 9 cost time: 0.883044958114624
Epoch: 9, Steps: 9 | Train Loss: 0.789 Vali Loss: 1.009 Vali Acc: 0.529 Test Loss: 1.009 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9115991592407227
Epoch: 10, Steps: 9 | Train Loss: 0.760 Vali Loss: 0.996 Vali Acc: 0.543 Test Loss: 0.996 Test Acc: 0.543
Validation loss decreased (-0.543468 --> -0.543468).  Saving model ...
Epoch: 11 cost time: 0.8768057823181152
Epoch: 11, Steps: 9 | Train Loss: 0.713 Vali Loss: 0.991 Vali Acc: 0.551 Test Loss: 0.991 Test Acc: 0.551
Validation loss decreased (-0.543468 --> -0.550715).  Saving model ...
Epoch: 12 cost time: 0.7298157215118408
Epoch: 12, Steps: 9 | Train Loss: 0.671 Vali Loss: 0.984 Vali Acc: 0.565 Test Loss: 0.984 Test Acc: 0.565
Validation loss decreased (-0.550715 --> -0.565208).  Saving model ...
Epoch: 13 cost time: 0.790534257888794
Epoch: 13, Steps: 9 | Train Loss: 0.638 Vali Loss: 0.979 Vali Acc: 0.572 Test Loss: 0.979 Test Acc: 0.572
Validation loss decreased (-0.565208 --> -0.572454).  Saving model ...
Epoch: 14 cost time: 0.7526626586914062
Epoch: 14, Steps: 9 | Train Loss: 0.590 Vali Loss: 0.971 Vali Acc: 0.565 Test Loss: 0.971 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9347422122955322
Epoch: 15, Steps: 9 | Train Loss: 0.563 Vali Loss: 0.989 Vali Acc: 0.587 Test Loss: 0.989 Test Acc: 0.587
Validation loss decreased (-0.572454 --> -0.586947).  Saving model ...
Epoch: 16 cost time: 0.9511146545410156
Epoch: 16, Steps: 9 | Train Loss: 0.536 Vali Loss: 0.984 Vali Acc: 0.580 Test Loss: 0.984 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0712535381317139
Epoch: 17, Steps: 9 | Train Loss: 0.501 Vali Loss: 0.990 Vali Acc: 0.623 Test Loss: 0.990 Test Acc: 0.623
Validation loss decreased (-0.586947 --> -0.623179).  Saving model ...
Epoch: 18 cost time: 0.7438104152679443
Epoch: 18, Steps: 9 | Train Loss: 0.465 Vali Loss: 0.985 Vali Acc: 0.594 Test Loss: 0.985 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.92435622215271
Epoch: 19, Steps: 9 | Train Loss: 0.425 Vali Loss: 0.946 Vali Acc: 0.630 Test Loss: 0.946 Test Acc: 0.630
Validation loss decreased (-0.623179 --> -0.630425).  Saving model ...
Epoch: 20 cost time: 0.6400353908538818
Epoch: 20, Steps: 9 | Train Loss: 0.384 Vali Loss: 0.945 Vali Acc: 0.623 Test Loss: 0.945 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.750342845916748
Epoch: 21, Steps: 9 | Train Loss: 0.345 Vali Loss: 0.929 Vali Acc: 0.630 Test Loss: 0.929 Test Acc: 0.630
Validation loss decreased (-0.630425 --> -0.630425).  Saving model ...
Epoch: 22 cost time: 0.686302661895752
Epoch: 22, Steps: 9 | Train Loss: 0.295 Vali Loss: 0.889 Vali Acc: 0.638 Test Loss: 0.889 Test Acc: 0.638
Validation loss decreased (-0.630425 --> -0.637672).  Saving model ...
Epoch: 23 cost time: 0.9110629558563232
Epoch: 23, Steps: 9 | Train Loss: 0.248 Vali Loss: 0.828 Vali Acc: 0.688 Test Loss: 0.828 Test Acc: 0.688
Validation loss decreased (-0.637672 --> -0.688398).  Saving model ...
Epoch: 24 cost time: 0.6106784343719482
Epoch: 24, Steps: 9 | Train Loss: 0.207 Vali Loss: 0.783 Vali Acc: 0.688 Test Loss: 0.783 Test Acc: 0.688
Validation loss decreased (-0.688398 --> -0.688398).  Saving model ...
Epoch: 25 cost time: 0.5889139175415039
Epoch: 25, Steps: 9 | Train Loss: 0.169 Vali Loss: 0.747 Vali Acc: 0.688 Test Loss: 0.747 Test Acc: 0.688
Validation loss decreased (-0.688398 --> -0.688398).  Saving model ...
Epoch: 26 cost time: 0.604088544845581
Epoch: 26, Steps: 9 | Train Loss: 0.146 Vali Loss: 0.742 Vali Acc: 0.703 Test Loss: 0.742 Test Acc: 0.703
Validation loss decreased (-0.688398 --> -0.702891).  Saving model ...
Epoch: 27 cost time: 0.7635929584503174
Epoch: 27, Steps: 9 | Train Loss: 0.130 Vali Loss: 0.713 Vali Acc: 0.717 Test Loss: 0.713 Test Acc: 0.717
Validation loss decreased (-0.702891 --> -0.717384).  Saving model ...
Epoch: 28 cost time: 0.7348995208740234
Epoch: 28, Steps: 9 | Train Loss: 0.106 Vali Loss: 0.722 Vali Acc: 0.746 Test Loss: 0.722 Test Acc: 0.746
Validation loss decreased (-0.717384 --> -0.746370).  Saving model ...
Epoch: 29 cost time: 0.9197580814361572
Epoch: 29, Steps: 9 | Train Loss: 0.097 Vali Loss: 0.727 Vali Acc: 0.746 Test Loss: 0.727 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8314304351806641
Epoch: 30, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.694 Vali Acc: 0.768 Test Loss: 0.694 Test Acc: 0.768
Validation loss decreased (-0.746370 --> -0.768109).  Saving model ...
Epoch: 31 cost time: 0.854581356048584
Epoch: 31, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.726 Vali Acc: 0.761 Test Loss: 0.726 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7969491481781006
Epoch: 32, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.722 Vali Acc: 0.754 Test Loss: 0.722 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.8278148174285889
Epoch: 33, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.717 Vali Acc: 0.761 Test Loss: 0.717 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.8435261249542236
Epoch: 34, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.720 Vali Acc: 0.761 Test Loss: 0.720 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.7862715721130371
Epoch: 35, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.732 Vali Acc: 0.761 Test Loss: 0.732 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.6537222862243652
Epoch: 36, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.746 Vali Acc: 0.761 Test Loss: 0.746 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.7094848155975342
Epoch: 37, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.758 Vali Acc: 0.761 Test Loss: 0.758 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.6258573532104492
Epoch: 38, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.711 Vali Acc: 0.775 Test Loss: 0.711 Test Acc: 0.775
Validation loss decreased (-0.768109 --> -0.775355).  Saving model ...
Epoch: 39 cost time: 0.6825611591339111
Epoch: 39, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.721 Vali Acc: 0.768 Test Loss: 0.721 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.7312221527099609
Epoch: 40, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.738 Vali Acc: 0.768 Test Loss: 0.738 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.6648542881011963
Epoch: 41, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.727 Vali Acc: 0.761 Test Loss: 0.727 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.689157247543335
Epoch: 42, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.736 Vali Acc: 0.761 Test Loss: 0.736 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.7999651432037354
Epoch: 43, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.727 Vali Acc: 0.761 Test Loss: 0.727 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.6663234233856201
Epoch: 44, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.737 Vali Acc: 0.761 Test Loss: 0.737 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.820326566696167
Epoch: 45, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.715 Vali Acc: 0.775 Test Loss: 0.715 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.6686935424804688
Epoch: 46, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.730 Vali Acc: 0.768 Test Loss: 0.730 Test Acc: 0.768
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.6401658058166504
Epoch: 47, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.728 Vali Acc: 0.775 Test Loss: 0.728 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.7302103042602539
Epoch: 48, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.736 Vali Acc: 0.783 Test Loss: 0.736 Test Acc: 0.783
Validation loss decreased (-0.775355 --> -0.782601).  Saving model ...
Epoch: 49 cost time: 0.6414320468902588
Epoch: 49, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.744 Vali Acc: 0.783 Test Loss: 0.744 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.8209292888641357
Epoch: 50, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.741 Vali Acc: 0.790 Test Loss: 0.741 Test Acc: 0.790
Validation loss decreased (-0.782601 --> -0.789848).  Saving model ...
Epoch: 51 cost time: 0.8293724060058594
Epoch: 51, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.735 Vali Acc: 0.790 Test Loss: 0.735 Test Acc: 0.790
Validation loss decreased (-0.789848 --> -0.789848).  Saving model ...
Epoch: 52 cost time: 0.8325395584106445
Epoch: 52, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.754 Vali Acc: 0.790 Test Loss: 0.754 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.9019079208374023
Epoch: 53, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.739 Vali Acc: 0.797 Test Loss: 0.739 Test Acc: 0.797
Validation loss decreased (-0.789848 --> -0.797094).  Saving model ...
Epoch: 54 cost time: 0.7856411933898926
Epoch: 54, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.746 Vali Acc: 0.797 Test Loss: 0.746 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.8979747295379639
Epoch: 55, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.761 Vali Acc: 0.797 Test Loss: 0.761 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.8653838634490967
Epoch: 56, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.762 Vali Acc: 0.812 Test Loss: 0.762 Test Acc: 0.812
Validation loss decreased (-0.797094 --> -0.811587).  Saving model ...
Epoch: 57 cost time: 0.6199002265930176
Epoch: 57, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.757 Vali Acc: 0.812 Test Loss: 0.757 Test Acc: 0.812
Validation loss decreased (-0.811587 --> -0.811587).  Saving model ...
Epoch: 58 cost time: 0.710669994354248
Epoch: 58, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.756 Vali Acc: 0.819 Test Loss: 0.756 Test Acc: 0.819
Validation loss decreased (-0.811587 --> -0.818833).  Saving model ...
Epoch: 59 cost time: 0.7679500579833984
Epoch: 59, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.753 Vali Acc: 0.819 Test Loss: 0.753 Test Acc: 0.819
Validation loss decreased (-0.818833 --> -0.818833).  Saving model ...
Epoch: 60 cost time: 0.6501238346099854
Epoch: 60, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.758 Vali Acc: 0.826 Test Loss: 0.758 Test Acc: 0.826
Validation loss decreased (-0.818833 --> -0.826079).  Saving model ...
Epoch: 61 cost time: 0.7695877552032471
Epoch: 61, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.765 Vali Acc: 0.826 Test Loss: 0.765 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.7542450428009033
Epoch: 62, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.767 Vali Acc: 0.826 Test Loss: 0.767 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.6678781509399414
Epoch: 63, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.781 Vali Acc: 0.826 Test Loss: 0.781 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 0.7163500785827637
Epoch: 64, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.779 Vali Acc: 0.826 Test Loss: 0.779 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 0.8084862232208252
Epoch: 65, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.782 Vali Acc: 0.833 Test Loss: 0.782 Test Acc: 0.833
Validation loss decreased (-0.826079 --> -0.833326).  Saving model ...
Epoch: 66 cost time: 0.7109715938568115
Epoch: 66, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.779 Vali Acc: 0.833 Test Loss: 0.779 Test Acc: 0.833
Validation loss decreased (-0.833326 --> -0.833326).  Saving model ...
Epoch: 67 cost time: 0.7158362865447998
Epoch: 67, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.790 Vali Acc: 0.833 Test Loss: 0.790 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.6285803318023682
Epoch: 68, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.790 Vali Acc: 0.833 Test Loss: 0.790 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.6184918880462646
Epoch: 69, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.789 Vali Acc: 0.833 Test Loss: 0.789 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 0.8399865627288818
Epoch: 70, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.790 Vali Acc: 0.833 Test Loss: 0.790 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 0.8116226196289062
Epoch: 71, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.790 Vali Acc: 0.833 Test Loss: 0.790 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 0.8079802989959717
Epoch: 72, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.795 Vali Acc: 0.833 Test Loss: 0.795 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 0.8770122528076172
Epoch: 73, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.809 Vali Acc: 0.833 Test Loss: 0.809 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 0.5841357707977295
Epoch: 74, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.811 Vali Acc: 0.833 Test Loss: 0.811 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 0.5841920375823975
Epoch: 75, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.803 Vali Acc: 0.833 Test Loss: 0.803 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 76 cost time: 0.6731836795806885
Epoch: 76, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.806 Vali Acc: 0.833 Test Loss: 0.806 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm64_cs11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8333333333333334
model parameter : 50402
model size : 0.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm64_cs10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.9319169521331787
Epoch: 1, Steps: 9 | Train Loss: 1.485 Vali Loss: 1.512 Vali Acc: 0.203 Test Loss: 1.512 Test Acc: 0.203
Validation loss decreased (inf --> -0.202883).  Saving model ...
Epoch: 2 cost time: 1.537686824798584
Epoch: 2, Steps: 9 | Train Loss: 1.407 Vali Loss: 1.422 Vali Acc: 0.246 Test Loss: 1.422 Test Acc: 0.246
Validation loss decreased (-0.202883 --> -0.246363).  Saving model ...
Epoch: 3 cost time: 1.0158047676086426
Epoch: 3, Steps: 9 | Train Loss: 1.298 Vali Loss: 1.315 Vali Acc: 0.391 Test Loss: 1.315 Test Acc: 0.391
Validation loss decreased (-0.246363 --> -0.391291).  Saving model ...
Epoch: 4 cost time: 0.8868248462677002
Epoch: 4, Steps: 9 | Train Loss: 1.190 Vali Loss: 1.232 Vali Acc: 0.428 Test Loss: 1.232 Test Acc: 0.428
Validation loss decreased (-0.391291 --> -0.427524).  Saving model ...
Epoch: 5 cost time: 0.9045665264129639
Epoch: 5, Steps: 9 | Train Loss: 1.082 Vali Loss: 1.173 Vali Acc: 0.435 Test Loss: 1.173 Test Acc: 0.435
Validation loss decreased (-0.427524 --> -0.434771).  Saving model ...
Epoch: 6 cost time: 0.9896118640899658
Epoch: 6, Steps: 9 | Train Loss: 1.010 Vali Loss: 1.139 Vali Acc: 0.420 Test Loss: 1.139 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0128765106201172
Epoch: 7, Steps: 9 | Train Loss: 0.939 Vali Loss: 1.103 Vali Acc: 0.457 Test Loss: 1.103 Test Acc: 0.457
Validation loss decreased (-0.434771 --> -0.456511).  Saving model ...
Epoch: 8 cost time: 0.8047494888305664
Epoch: 8, Steps: 9 | Train Loss: 0.894 Vali Loss: 1.079 Vali Acc: 0.449 Test Loss: 1.079 Test Acc: 0.449
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8961982727050781
Epoch: 9, Steps: 9 | Train Loss: 0.829 Vali Loss: 1.063 Vali Acc: 0.478 Test Loss: 1.063 Test Acc: 0.478
Validation loss decreased (-0.456511 --> -0.478250).  Saving model ...
Epoch: 10 cost time: 0.8472325801849365
Epoch: 10, Steps: 9 | Train Loss: 0.775 Vali Loss: 1.056 Vali Acc: 0.493 Test Loss: 1.056 Test Acc: 0.493
Validation loss decreased (-0.478250 --> -0.492743).  Saving model ...
Epoch: 11 cost time: 0.9969744682312012
Epoch: 11, Steps: 9 | Train Loss: 0.733 Vali Loss: 1.038 Vali Acc: 0.493 Test Loss: 1.038 Test Acc: 0.493
Validation loss decreased (-0.492743 --> -0.492743).  Saving model ...
Epoch: 12 cost time: 1.0739026069641113
Epoch: 12, Steps: 9 | Train Loss: 0.685 Vali Loss: 1.028 Vali Acc: 0.529 Test Loss: 1.028 Test Acc: 0.529
Validation loss decreased (-0.492743 --> -0.528975).  Saving model ...
Epoch: 13 cost time: 1.0586833953857422
Epoch: 13, Steps: 9 | Train Loss: 0.653 Vali Loss: 1.024 Vali Acc: 0.529 Test Loss: 1.024 Test Acc: 0.529
Validation loss decreased (-0.528975 --> -0.528975).  Saving model ...
Epoch: 14 cost time: 0.8423645496368408
Epoch: 14, Steps: 9 | Train Loss: 0.622 Vali Loss: 1.016 Vali Acc: 0.543 Test Loss: 1.016 Test Acc: 0.543
Validation loss decreased (-0.528975 --> -0.543468).  Saving model ...
Epoch: 15 cost time: 0.9431858062744141
Epoch: 15, Steps: 9 | Train Loss: 0.570 Vali Loss: 1.023 Vali Acc: 0.543 Test Loss: 1.023 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.066854476928711
Epoch: 16, Steps: 9 | Train Loss: 0.544 Vali Loss: 1.034 Vali Acc: 0.572 Test Loss: 1.034 Test Acc: 0.572
Validation loss decreased (-0.543468 --> -0.572453).  Saving model ...
Epoch: 17 cost time: 1.3603451251983643
Epoch: 17, Steps: 9 | Train Loss: 0.503 Vali Loss: 1.020 Vali Acc: 0.594 Test Loss: 1.020 Test Acc: 0.594
Validation loss decreased (-0.572453 --> -0.594193).  Saving model ...
Epoch: 18 cost time: 1.2124302387237549
Epoch: 18, Steps: 9 | Train Loss: 0.461 Vali Loss: 1.006 Vali Acc: 0.616 Test Loss: 1.006 Test Acc: 0.616
Validation loss decreased (-0.594193 --> -0.615932).  Saving model ...
Epoch: 19 cost time: 1.2344539165496826
Epoch: 19, Steps: 9 | Train Loss: 0.417 Vali Loss: 0.983 Vali Acc: 0.609 Test Loss: 0.983 Test Acc: 0.609
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.097663402557373
Epoch: 20, Steps: 9 | Train Loss: 0.369 Vali Loss: 0.984 Vali Acc: 0.609 Test Loss: 0.984 Test Acc: 0.609
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9267046451568604
Epoch: 21, Steps: 9 | Train Loss: 0.338 Vali Loss: 0.907 Vali Acc: 0.638 Test Loss: 0.907 Test Acc: 0.638
Validation loss decreased (-0.615932 --> -0.637672).  Saving model ...
Epoch: 22 cost time: 0.7225098609924316
Epoch: 22, Steps: 9 | Train Loss: 0.270 Vali Loss: 0.878 Vali Acc: 0.652 Test Loss: 0.878 Test Acc: 0.652
Validation loss decreased (-0.637672 --> -0.652165).  Saving model ...
Epoch: 23 cost time: 0.7111575603485107
Epoch: 23, Steps: 9 | Train Loss: 0.226 Vali Loss: 0.858 Vali Acc: 0.667 Test Loss: 0.858 Test Acc: 0.667
Validation loss decreased (-0.652165 --> -0.666658).  Saving model ...
Epoch: 24 cost time: 0.7711124420166016
Epoch: 24, Steps: 9 | Train Loss: 0.195 Vali Loss: 0.805 Vali Acc: 0.696 Test Loss: 0.805 Test Acc: 0.696
Validation loss decreased (-0.666658 --> -0.695644).  Saving model ...
Epoch: 25 cost time: 0.8036549091339111
Epoch: 25, Steps: 9 | Train Loss: 0.163 Vali Loss: 0.761 Vali Acc: 0.696 Test Loss: 0.761 Test Acc: 0.696
Validation loss decreased (-0.695644 --> -0.695645).  Saving model ...
Epoch: 26 cost time: 1.0875020027160645
Epoch: 26, Steps: 9 | Train Loss: 0.152 Vali Loss: 0.740 Vali Acc: 0.710 Test Loss: 0.740 Test Acc: 0.710
Validation loss decreased (-0.695645 --> -0.710138).  Saving model ...
Epoch: 27 cost time: 1.1564419269561768
Epoch: 27, Steps: 9 | Train Loss: 0.134 Vali Loss: 0.750 Vali Acc: 0.703 Test Loss: 0.750 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9510672092437744
Epoch: 28, Steps: 9 | Train Loss: 0.115 Vali Loss: 0.755 Vali Acc: 0.703 Test Loss: 0.755 Test Acc: 0.703
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.0307245254516602
Epoch: 29, Steps: 9 | Train Loss: 0.095 Vali Loss: 0.715 Vali Acc: 0.717 Test Loss: 0.715 Test Acc: 0.717
Validation loss decreased (-0.710138 --> -0.717384).  Saving model ...
Epoch: 30 cost time: 0.7469232082366943
Epoch: 30, Steps: 9 | Train Loss: 0.086 Vali Loss: 0.693 Vali Acc: 0.732 Test Loss: 0.693 Test Acc: 0.732
Validation loss decreased (-0.717384 --> -0.731877).  Saving model ...
Epoch: 31 cost time: 1.0133605003356934
Epoch: 31, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.646 Vali Acc: 0.761 Test Loss: 0.646 Test Acc: 0.761
Validation loss decreased (-0.731877 --> -0.760863).  Saving model ...
Epoch: 32 cost time: 1.0945954322814941
Epoch: 32, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.687 Vali Acc: 0.739 Test Loss: 0.687 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8359982967376709
Epoch: 33, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.710 Vali Acc: 0.754 Test Loss: 0.710 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.831106424331665
Epoch: 34, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.660 Vali Acc: 0.761 Test Loss: 0.660 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.8370621204376221
Epoch: 35, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.642 Vali Acc: 0.775 Test Loss: 0.642 Test Acc: 0.775
Validation loss decreased (-0.760863 --> -0.775356).  Saving model ...
Epoch: 36 cost time: 0.8753905296325684
Epoch: 36, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.616 Vali Acc: 0.783 Test Loss: 0.616 Test Acc: 0.783
Validation loss decreased (-0.775356 --> -0.782603).  Saving model ...
Epoch: 37 cost time: 1.1202623844146729
Epoch: 37, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.604 Vali Acc: 0.797 Test Loss: 0.604 Test Acc: 0.797
Validation loss decreased (-0.782603 --> -0.797095).  Saving model ...
Epoch: 38 cost time: 0.8471734523773193
Epoch: 38, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.610 Vali Acc: 0.804 Test Loss: 0.610 Test Acc: 0.804
Validation loss decreased (-0.797095 --> -0.804342).  Saving model ...
Epoch: 39 cost time: 1.1036396026611328
Epoch: 39, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.589 Vali Acc: 0.804 Test Loss: 0.589 Test Acc: 0.804
Validation loss decreased (-0.804342 --> -0.804342).  Saving model ...
Epoch: 40 cost time: 0.9838104248046875
Epoch: 40, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.592 Vali Acc: 0.804 Test Loss: 0.592 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.0232517719268799
Epoch: 41, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.587 Vali Acc: 0.812 Test Loss: 0.587 Test Acc: 0.812
Validation loss decreased (-0.804342 --> -0.811588).  Saving model ...
Epoch: 42 cost time: 1.3100435733795166
Epoch: 42, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.550 Vali Acc: 0.826 Test Loss: 0.550 Test Acc: 0.826
Validation loss decreased (-0.811588 --> -0.826081).  Saving model ...
Epoch: 43 cost time: 0.9551784992218018
Epoch: 43, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.542 Vali Acc: 0.841 Test Loss: 0.542 Test Acc: 0.841
Validation loss decreased (-0.826081 --> -0.840574).  Saving model ...
Epoch: 44 cost time: 0.8612346649169922
Epoch: 44, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.546 Vali Acc: 0.841 Test Loss: 0.546 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.979762077331543
Epoch: 45, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.543 Vali Acc: 0.841 Test Loss: 0.543 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.9379777908325195
Epoch: 46, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.559 Vali Acc: 0.833 Test Loss: 0.559 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.0737431049346924
Epoch: 47, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.533 Vali Acc: 0.841 Test Loss: 0.533 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840574).  Saving model ...
Epoch: 48 cost time: 0.9324138164520264
Epoch: 48, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.530 Vali Acc: 0.848 Test Loss: 0.530 Test Acc: 0.848
Validation loss decreased (-0.840574 --> -0.847821).  Saving model ...
Epoch: 49 cost time: 0.8841040134429932
Epoch: 49, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.528 Vali Acc: 0.848 Test Loss: 0.528 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 50 cost time: 1.136460304260254
Epoch: 50, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.519 Vali Acc: 0.848 Test Loss: 0.519 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 51 cost time: 0.9365410804748535
Epoch: 51, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.512 Vali Acc: 0.855 Test Loss: 0.512 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855067).  Saving model ...
Epoch: 52 cost time: 1.2907700538635254
Epoch: 52, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.507 Vali Acc: 0.841 Test Loss: 0.507 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.0512700080871582
Epoch: 53, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.513 Vali Acc: 0.855 Test Loss: 0.513 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.0297267436981201
Epoch: 54, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.519 Vali Acc: 0.855 Test Loss: 0.519 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 1.1023378372192383
Epoch: 55, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.513 Vali Acc: 0.855 Test Loss: 0.513 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 0.9149665832519531
Epoch: 56, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.516 Vali Acc: 0.855 Test Loss: 0.516 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 0.7819337844848633
Epoch: 57, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.505 Vali Acc: 0.862 Test Loss: 0.505 Test Acc: 0.862
Validation loss decreased (-0.855067 --> -0.862314).  Saving model ...
Epoch: 58 cost time: 1.0691945552825928
Epoch: 58, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.500 Vali Acc: 0.870 Test Loss: 0.500 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869560).  Saving model ...
Epoch: 59 cost time: 0.8434181213378906
Epoch: 59, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.488 Vali Acc: 0.870 Test Loss: 0.488 Test Acc: 0.870
Validation loss decreased (-0.869560 --> -0.869560).  Saving model ...
Epoch: 60 cost time: 1.1268196105957031
Epoch: 60, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.485 Vali Acc: 0.870 Test Loss: 0.485 Test Acc: 0.870
Validation loss decreased (-0.869560 --> -0.869560).  Saving model ...
Epoch: 61 cost time: 0.7924091815948486
Epoch: 61, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.499 Vali Acc: 0.870 Test Loss: 0.499 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 1.0402610301971436
Epoch: 62, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.498 Vali Acc: 0.870 Test Loss: 0.498 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.833620548248291
Epoch: 63, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.503 Vali Acc: 0.870 Test Loss: 0.503 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 1.224998950958252
Epoch: 64, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.491 Vali Acc: 0.870 Test Loss: 0.491 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 1.3902997970581055
Epoch: 65, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.498 Vali Acc: 0.870 Test Loss: 0.498 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 1.1452314853668213
Epoch: 66, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.489 Vali Acc: 0.877 Test Loss: 0.489 Test Acc: 0.877
Validation loss decreased (-0.869560 --> -0.876807).  Saving model ...
Epoch: 67 cost time: 0.9293985366821289
Epoch: 67, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.497 Vali Acc: 0.870 Test Loss: 0.497 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.9675931930541992
Epoch: 68, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.499 Vali Acc: 0.870 Test Loss: 0.499 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.9343132972717285
Epoch: 69, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.495 Vali Acc: 0.877 Test Loss: 0.495 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 1.0919933319091797
Epoch: 70, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.488 Vali Acc: 0.877 Test Loss: 0.488 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876807).  Saving model ...
Epoch: 71 cost time: 0.9207892417907715
Epoch: 71, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.490 Vali Acc: 0.877 Test Loss: 0.490 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 1.2105326652526855
Epoch: 72, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.493 Vali Acc: 0.877 Test Loss: 0.493 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 0.9314956665039062
Epoch: 73, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.488 Vali Acc: 0.877 Test Loss: 0.488 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876807).  Saving model ...
Epoch: 74 cost time: 0.8745784759521484
Epoch: 74, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.483 Vali Acc: 0.884 Test Loss: 0.483 Test Acc: 0.884
Validation loss decreased (-0.876807 --> -0.884053).  Saving model ...
Epoch: 75 cost time: 0.8242819309234619
Epoch: 75, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.487 Vali Acc: 0.884 Test Loss: 0.487 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.7592124938964844
Epoch: 76, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.494 Vali Acc: 0.884 Test Loss: 0.494 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 0.6511704921722412
Epoch: 77, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.484 Vali Acc: 0.884 Test Loss: 0.484 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 0.771794319152832
Epoch: 78, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.480 Vali Acc: 0.884 Test Loss: 0.480 Test Acc: 0.884
Validation loss decreased (-0.884053 --> -0.884053).  Saving model ...
Epoch: 79 cost time: 0.6991915702819824
Epoch: 79, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.482 Vali Acc: 0.884 Test Loss: 0.482 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 0.9413619041442871
Epoch: 80, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.484 Vali Acc: 0.884 Test Loss: 0.484 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 1.12040376663208
Epoch: 81, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.485 Vali Acc: 0.884 Test Loss: 0.485 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 82 cost time: 0.8260836601257324
Epoch: 82, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.488 Vali Acc: 0.884 Test Loss: 0.488 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 83 cost time: 0.8334932327270508
Epoch: 83, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.482 Vali Acc: 0.884 Test Loss: 0.482 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 84 cost time: 0.8447153568267822
Epoch: 84, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.483 Vali Acc: 0.884 Test Loss: 0.483 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 85 cost time: 0.9164779186248779
Epoch: 85, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.483 Vali Acc: 0.884 Test Loss: 0.483 Test Acc: 0.884
EarlyStopping counter: 7 out of 10
Epoch: 86 cost time: 1.1112163066864014
Epoch: 86, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.482 Vali Acc: 0.884 Test Loss: 0.482 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 87 cost time: 0.9628267288208008
Epoch: 87, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.482 Vali Acc: 0.884 Test Loss: 0.482 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 88 cost time: 0.99778151512146
Epoch: 88, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.481 Vali Acc: 0.884 Test Loss: 0.481 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm64_cs10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 50744
model size : 0.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm32_cs103_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.9812819957733154
Epoch: 1, Steps: 9 | Train Loss: 1.391 Vali Loss: 1.355 Vali Acc: 0.304 Test Loss: 1.355 Test Acc: 0.304
Validation loss decreased (inf --> -0.304334).  Saving model ...
Epoch: 2 cost time: 0.9345259666442871
Epoch: 2, Steps: 9 | Train Loss: 1.317 Vali Loss: 1.281 Vali Acc: 0.420 Test Loss: 1.281 Test Acc: 0.420
Validation loss decreased (-0.304334 --> -0.420277).  Saving model ...
Epoch: 3 cost time: 0.8025093078613281
Epoch: 3, Steps: 9 | Train Loss: 1.221 Vali Loss: 1.199 Vali Acc: 0.500 Test Loss: 1.199 Test Acc: 0.500
Validation loss decreased (-0.420277 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 0.9004569053649902
Epoch: 4, Steps: 9 | Train Loss: 1.118 Vali Loss: 1.143 Vali Acc: 0.478 Test Loss: 1.143 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7884597778320312
Epoch: 5, Steps: 9 | Train Loss: 1.023 Vali Loss: 1.093 Vali Acc: 0.471 Test Loss: 1.093 Test Acc: 0.471
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.065459966659546
Epoch: 6, Steps: 9 | Train Loss: 0.961 Vali Loss: 1.065 Vali Acc: 0.478 Test Loss: 1.065 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0266501903533936
Epoch: 7, Steps: 9 | Train Loss: 0.906 Vali Loss: 1.033 Vali Acc: 0.493 Test Loss: 1.033 Test Acc: 0.493
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7932841777801514
Epoch: 8, Steps: 9 | Train Loss: 0.831 Vali Loss: 1.024 Vali Acc: 0.493 Test Loss: 1.024 Test Acc: 0.493
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8350586891174316
Epoch: 9, Steps: 9 | Train Loss: 0.797 Vali Loss: 1.006 Vali Acc: 0.514 Test Loss: 1.006 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.514483).  Saving model ...
Epoch: 10 cost time: 0.9732635021209717
Epoch: 10, Steps: 9 | Train Loss: 0.749 Vali Loss: 1.009 Vali Acc: 0.551 Test Loss: 1.009 Test Acc: 0.551
Validation loss decreased (-0.514483 --> -0.550715).  Saving model ...
Epoch: 11 cost time: 0.805819034576416
Epoch: 11, Steps: 9 | Train Loss: 0.701 Vali Loss: 0.990 Vali Acc: 0.609 Test Loss: 0.990 Test Acc: 0.609
Validation loss decreased (-0.550715 --> -0.608686).  Saving model ...
Epoch: 12 cost time: 0.7877418994903564
Epoch: 12, Steps: 9 | Train Loss: 0.653 Vali Loss: 0.978 Vali Acc: 0.572 Test Loss: 0.978 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9657981395721436
Epoch: 13, Steps: 9 | Train Loss: 0.623 Vali Loss: 0.977 Vali Acc: 0.565 Test Loss: 0.977 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7894656658172607
Epoch: 14, Steps: 9 | Train Loss: 0.575 Vali Loss: 0.975 Vali Acc: 0.601 Test Loss: 0.975 Test Acc: 0.601
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.913750410079956
Epoch: 15, Steps: 9 | Train Loss: 0.533 Vali Loss: 0.971 Vali Acc: 0.601 Test Loss: 0.971 Test Acc: 0.601
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.0225450992584229
Epoch: 16, Steps: 9 | Train Loss: 0.503 Vali Loss: 0.954 Vali Acc: 0.609 Test Loss: 0.954 Test Acc: 0.609
Validation loss decreased (-0.608686 --> -0.608686).  Saving model ...
Epoch: 17 cost time: 0.8630456924438477
Epoch: 17, Steps: 9 | Train Loss: 0.469 Vali Loss: 0.948 Vali Acc: 0.623 Test Loss: 0.948 Test Acc: 0.623
Validation loss decreased (-0.608686 --> -0.623179).  Saving model ...
Epoch: 18 cost time: 1.0423402786254883
Epoch: 18, Steps: 9 | Train Loss: 0.417 Vali Loss: 0.943 Vali Acc: 0.645 Test Loss: 0.943 Test Acc: 0.645
Validation loss decreased (-0.623179 --> -0.644918).  Saving model ...
Epoch: 19 cost time: 0.6914746761322021
Epoch: 19, Steps: 9 | Train Loss: 0.385 Vali Loss: 0.924 Vali Acc: 0.630 Test Loss: 0.924 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9194183349609375
Epoch: 20, Steps: 9 | Train Loss: 0.320 Vali Loss: 0.907 Vali Acc: 0.630 Test Loss: 0.907 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7225916385650635
Epoch: 21, Steps: 9 | Train Loss: 0.274 Vali Loss: 0.893 Vali Acc: 0.630 Test Loss: 0.893 Test Acc: 0.630
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8221690654754639
Epoch: 22, Steps: 9 | Train Loss: 0.226 Vali Loss: 0.876 Vali Acc: 0.616 Test Loss: 0.876 Test Acc: 0.616
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.1418423652648926
Epoch: 23, Steps: 9 | Train Loss: 0.196 Vali Loss: 0.870 Vali Acc: 0.645 Test Loss: 0.870 Test Acc: 0.645
Validation loss decreased (-0.644918 --> -0.644919).  Saving model ...
Epoch: 24 cost time: 1.0021193027496338
Epoch: 24, Steps: 9 | Train Loss: 0.182 Vali Loss: 0.853 Vali Acc: 0.638 Test Loss: 0.853 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0825707912445068
Epoch: 25, Steps: 9 | Train Loss: 0.156 Vali Loss: 0.847 Vali Acc: 0.667 Test Loss: 0.847 Test Acc: 0.667
Validation loss decreased (-0.644919 --> -0.666658).  Saving model ...
Epoch: 26 cost time: 0.8511636257171631
Epoch: 26, Steps: 9 | Train Loss: 0.132 Vali Loss: 0.876 Vali Acc: 0.659 Test Loss: 0.876 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2470054626464844
Epoch: 27, Steps: 9 | Train Loss: 0.119 Vali Loss: 0.871 Vali Acc: 0.667 Test Loss: 0.871 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0584673881530762
Epoch: 28, Steps: 9 | Train Loss: 0.105 Vali Loss: 0.892 Vali Acc: 0.652 Test Loss: 0.892 Test Acc: 0.652
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.1500849723815918
Epoch: 29, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.916 Vali Acc: 0.659 Test Loss: 0.916 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.3645646572113037
Epoch: 30, Steps: 9 | Train Loss: 0.087 Vali Loss: 0.938 Vali Acc: 0.645 Test Loss: 0.938 Test Acc: 0.645
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.316368579864502
Epoch: 31, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.932 Vali Acc: 0.674 Test Loss: 0.932 Test Acc: 0.674
Validation loss decreased (-0.666658 --> -0.673904).  Saving model ...
Epoch: 32 cost time: 1.202556848526001
Epoch: 32, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.942 Vali Acc: 0.652 Test Loss: 0.942 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.0360896587371826
Epoch: 33, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.962 Vali Acc: 0.645 Test Loss: 0.962 Test Acc: 0.645
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.8807039260864258
Epoch: 34, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.979 Vali Acc: 0.659 Test Loss: 0.979 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.0586762428283691
Epoch: 35, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.988 Vali Acc: 0.659 Test Loss: 0.988 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.0061640739440918
Epoch: 36, Steps: 9 | Train Loss: 0.048 Vali Loss: 1.014 Vali Acc: 0.652 Test Loss: 1.014 Test Acc: 0.652
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.2296533584594727
Epoch: 37, Steps: 9 | Train Loss: 0.043 Vali Loss: 1.032 Vali Acc: 0.659 Test Loss: 1.032 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.7508177757263184
Epoch: 38, Steps: 9 | Train Loss: 0.038 Vali Loss: 1.052 Vali Acc: 0.652 Test Loss: 1.052 Test Acc: 0.652
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.1427011489868164
Epoch: 39, Steps: 9 | Train Loss: 0.035 Vali Loss: 1.075 Vali Acc: 0.652 Test Loss: 1.075 Test Acc: 0.652
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.9472095966339111
Epoch: 40, Steps: 9 | Train Loss: 0.032 Vali Loss: 1.093 Vali Acc: 0.652 Test Loss: 1.093 Test Acc: 0.652
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.8693196773529053
Epoch: 41, Steps: 9 | Train Loss: 0.031 Vali Loss: 1.099 Vali Acc: 0.652 Test Loss: 1.099 Test Acc: 0.652
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm32_cs103_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.6739130434782609
model parameter : 48266
model size : 0.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm32_cs69_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.2214977741241455
Epoch: 1, Steps: 9 | Train Loss: 1.416 Vali Loss: 1.423 Vali Acc: 0.333 Test Loss: 1.423 Test Acc: 0.333
Validation loss decreased (inf --> -0.333319).  Saving model ...
Epoch: 2 cost time: 1.0400176048278809
Epoch: 2, Steps: 9 | Train Loss: 1.332 Vali Loss: 1.336 Vali Acc: 0.406 Test Loss: 1.336 Test Acc: 0.406
Validation loss decreased (-0.333319 --> -0.405784).  Saving model ...
Epoch: 3 cost time: 0.7978317737579346
Epoch: 3, Steps: 9 | Train Loss: 1.242 Vali Loss: 1.236 Vali Acc: 0.507 Test Loss: 1.236 Test Acc: 0.507
Validation loss decreased (-0.405784 --> -0.507234).  Saving model ...
Epoch: 4 cost time: 0.8315327167510986
Epoch: 4, Steps: 9 | Train Loss: 1.115 Vali Loss: 1.153 Vali Acc: 0.529 Test Loss: 1.153 Test Acc: 0.529
Validation loss decreased (-0.507234 --> -0.528974).  Saving model ...
Epoch: 5 cost time: 0.779109001159668
Epoch: 5, Steps: 9 | Train Loss: 1.028 Vali Loss: 1.110 Vali Acc: 0.471 Test Loss: 1.110 Test Acc: 0.471
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0096139907836914
Epoch: 6, Steps: 9 | Train Loss: 0.972 Vali Loss: 1.070 Vali Acc: 0.464 Test Loss: 1.070 Test Acc: 0.464
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8906736373901367
Epoch: 7, Steps: 9 | Train Loss: 0.898 Vali Loss: 1.050 Vali Acc: 0.486 Test Loss: 1.050 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9995887279510498
Epoch: 8, Steps: 9 | Train Loss: 0.849 Vali Loss: 1.034 Vali Acc: 0.514 Test Loss: 1.034 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8584036827087402
Epoch: 9, Steps: 9 | Train Loss: 0.799 Vali Loss: 1.020 Vali Acc: 0.500 Test Loss: 1.020 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9005191326141357
Epoch: 10, Steps: 9 | Train Loss: 0.757 Vali Loss: 1.019 Vali Acc: 0.522 Test Loss: 1.019 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.844515323638916
Epoch: 11, Steps: 9 | Train Loss: 0.716 Vali Loss: 1.015 Vali Acc: 0.551 Test Loss: 1.015 Test Acc: 0.551
Validation loss decreased (-0.528974 --> -0.550714).  Saving model ...
Epoch: 12 cost time: 0.8328070640563965
Epoch: 12, Steps: 9 | Train Loss: 0.672 Vali Loss: 1.010 Vali Acc: 0.536 Test Loss: 1.010 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1079962253570557
Epoch: 13, Steps: 9 | Train Loss: 0.639 Vali Loss: 1.005 Vali Acc: 0.543 Test Loss: 1.005 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8936138153076172
Epoch: 14, Steps: 9 | Train Loss: 0.604 Vali Loss: 1.000 Vali Acc: 0.601 Test Loss: 1.000 Test Acc: 0.601
Validation loss decreased (-0.550714 --> -0.601439).  Saving model ...
Epoch: 15 cost time: 0.9896023273468018
Epoch: 15, Steps: 9 | Train Loss: 0.572 Vali Loss: 1.010 Vali Acc: 0.601 Test Loss: 1.010 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8210089206695557
Epoch: 16, Steps: 9 | Train Loss: 0.540 Vali Loss: 1.029 Vali Acc: 0.601 Test Loss: 1.029 Test Acc: 0.601
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8978533744812012
Epoch: 17, Steps: 9 | Train Loss: 0.505 Vali Loss: 1.033 Vali Acc: 0.601 Test Loss: 1.033 Test Acc: 0.601
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8710691928863525
Epoch: 18, Steps: 9 | Train Loss: 0.490 Vali Loss: 1.051 Vali Acc: 0.616 Test Loss: 1.051 Test Acc: 0.616
Validation loss decreased (-0.601439 --> -0.615932).  Saving model ...
Epoch: 19 cost time: 1.0818309783935547
Epoch: 19, Steps: 9 | Train Loss: 0.453 Vali Loss: 1.041 Vali Acc: 0.616 Test Loss: 1.041 Test Acc: 0.616
Validation loss decreased (-0.615932 --> -0.615932).  Saving model ...
Epoch: 20 cost time: 0.9644489288330078
Epoch: 20, Steps: 9 | Train Loss: 0.434 Vali Loss: 1.036 Vali Acc: 0.587 Test Loss: 1.036 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9351656436920166
Epoch: 21, Steps: 9 | Train Loss: 0.406 Vali Loss: 1.061 Vali Acc: 0.623 Test Loss: 1.061 Test Acc: 0.623
Validation loss decreased (-0.615932 --> -0.623178).  Saving model ...
Epoch: 22 cost time: 1.0242030620574951
Epoch: 22, Steps: 9 | Train Loss: 0.386 Vali Loss: 1.088 Vali Acc: 0.616 Test Loss: 1.088 Test Acc: 0.616
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7484149932861328
Epoch: 23, Steps: 9 | Train Loss: 0.383 Vali Loss: 1.084 Vali Acc: 0.630 Test Loss: 1.084 Test Acc: 0.630
Validation loss decreased (-0.623178 --> -0.630424).  Saving model ...
Epoch: 24 cost time: 0.7004528045654297
Epoch: 24, Steps: 9 | Train Loss: 0.340 Vali Loss: 1.090 Vali Acc: 0.616 Test Loss: 1.090 Test Acc: 0.616
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9154398441314697
Epoch: 25, Steps: 9 | Train Loss: 0.314 Vali Loss: 1.103 Vali Acc: 0.616 Test Loss: 1.103 Test Acc: 0.616
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0941455364227295
Epoch: 26, Steps: 9 | Train Loss: 0.308 Vali Loss: 1.123 Vali Acc: 0.638 Test Loss: 1.123 Test Acc: 0.638
Validation loss decreased (-0.630424 --> -0.637670).  Saving model ...
Epoch: 27 cost time: 1.3165087699890137
Epoch: 27, Steps: 9 | Train Loss: 0.283 Vali Loss: 1.135 Vali Acc: 0.616 Test Loss: 1.135 Test Acc: 0.616
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0299816131591797
Epoch: 28, Steps: 9 | Train Loss: 0.250 Vali Loss: 1.147 Vali Acc: 0.630 Test Loss: 1.147 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9894709587097168
Epoch: 29, Steps: 9 | Train Loss: 0.236 Vali Loss: 1.144 Vali Acc: 0.638 Test Loss: 1.144 Test Acc: 0.638
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.0965907573699951
Epoch: 30, Steps: 9 | Train Loss: 0.217 Vali Loss: 1.158 Vali Acc: 0.645 Test Loss: 1.158 Test Acc: 0.645
Validation loss decreased (-0.637670 --> -0.644916).  Saving model ...
Epoch: 31 cost time: 0.9087071418762207
Epoch: 31, Steps: 9 | Train Loss: 0.200 Vali Loss: 1.195 Vali Acc: 0.645 Test Loss: 1.195 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9414176940917969
Epoch: 32, Steps: 9 | Train Loss: 0.193 Vali Loss: 1.189 Vali Acc: 0.652 Test Loss: 1.189 Test Acc: 0.652
Validation loss decreased (-0.644916 --> -0.652162).  Saving model ...
Epoch: 33 cost time: 0.7958934307098389
Epoch: 33, Steps: 9 | Train Loss: 0.171 Vali Loss: 1.212 Vali Acc: 0.645 Test Loss: 1.212 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8837888240814209
Epoch: 34, Steps: 9 | Train Loss: 0.149 Vali Loss: 1.185 Vali Acc: 0.652 Test Loss: 1.185 Test Acc: 0.652
Validation loss decreased (-0.652162 --> -0.652162).  Saving model ...
Epoch: 35 cost time: 0.8874251842498779
Epoch: 35, Steps: 9 | Train Loss: 0.134 Vali Loss: 1.178 Vali Acc: 0.645 Test Loss: 1.178 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.0790071487426758
Epoch: 36, Steps: 9 | Train Loss: 0.114 Vali Loss: 1.186 Vali Acc: 0.645 Test Loss: 1.186 Test Acc: 0.645
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.7574772834777832
Epoch: 37, Steps: 9 | Train Loss: 0.105 Vali Loss: 1.220 Vali Acc: 0.645 Test Loss: 1.220 Test Acc: 0.645
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.7698588371276855
Epoch: 38, Steps: 9 | Train Loss: 0.089 Vali Loss: 1.214 Vali Acc: 0.645 Test Loss: 1.214 Test Acc: 0.645
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.037992000579834
Epoch: 39, Steps: 9 | Train Loss: 0.076 Vali Loss: 1.209 Vali Acc: 0.667 Test Loss: 1.209 Test Acc: 0.667
Validation loss decreased (-0.652162 --> -0.666655).  Saving model ...
Epoch: 40 cost time: 1.05759596824646
Epoch: 40, Steps: 9 | Train Loss: 0.066 Vali Loss: 1.211 Vali Acc: 0.674 Test Loss: 1.211 Test Acc: 0.674
Validation loss decreased (-0.666655 --> -0.673901).  Saving model ...
Epoch: 41 cost time: 1.051530122756958
Epoch: 41, Steps: 9 | Train Loss: 0.055 Vali Loss: 1.206 Vali Acc: 0.674 Test Loss: 1.206 Test Acc: 0.674
Validation loss decreased (-0.673901 --> -0.673901).  Saving model ...
Epoch: 42 cost time: 0.9096040725708008
Epoch: 42, Steps: 9 | Train Loss: 0.047 Vali Loss: 1.201 Vali Acc: 0.681 Test Loss: 1.201 Test Acc: 0.681
Validation loss decreased (-0.673901 --> -0.681147).  Saving model ...
Epoch: 43 cost time: 0.8930890560150146
Epoch: 43, Steps: 9 | Train Loss: 0.040 Vali Loss: 1.201 Vali Acc: 0.681 Test Loss: 1.201 Test Acc: 0.681
Validation loss decreased (-0.681147 --> -0.681147).  Saving model ...
Epoch: 44 cost time: 0.961414098739624
Epoch: 44, Steps: 9 | Train Loss: 0.035 Vali Loss: 1.202 Vali Acc: 0.681 Test Loss: 1.202 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.1913626194000244
Epoch: 45, Steps: 9 | Train Loss: 0.030 Vali Loss: 1.199 Vali Acc: 0.688 Test Loss: 1.199 Test Acc: 0.688
Validation loss decreased (-0.681147 --> -0.688394).  Saving model ...
Epoch: 46 cost time: 1.0043344497680664
Epoch: 46, Steps: 9 | Train Loss: 0.026 Vali Loss: 1.205 Vali Acc: 0.696 Test Loss: 1.205 Test Acc: 0.696
Validation loss decreased (-0.688394 --> -0.695640).  Saving model ...
Epoch: 47 cost time: 0.787384033203125
Epoch: 47, Steps: 9 | Train Loss: 0.023 Vali Loss: 1.201 Vali Acc: 0.703 Test Loss: 1.201 Test Acc: 0.703
Validation loss decreased (-0.695640 --> -0.702887).  Saving model ...
Epoch: 48 cost time: 0.9955155849456787
Epoch: 48, Steps: 9 | Train Loss: 0.020 Vali Loss: 1.201 Vali Acc: 0.703 Test Loss: 1.201 Test Acc: 0.703
Validation loss decreased (-0.702887 --> -0.702887).  Saving model ...
Epoch: 49 cost time: 0.7661006450653076
Epoch: 49, Steps: 9 | Train Loss: 0.018 Vali Loss: 1.189 Vali Acc: 0.710 Test Loss: 1.189 Test Acc: 0.710
Validation loss decreased (-0.702887 --> -0.710133).  Saving model ...
Epoch: 50 cost time: 1.0924129486083984
Epoch: 50, Steps: 9 | Train Loss: 0.016 Vali Loss: 1.191 Vali Acc: 0.710 Test Loss: 1.191 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.7245423793792725
Epoch: 51, Steps: 9 | Train Loss: 0.014 Vali Loss: 1.190 Vali Acc: 0.710 Test Loss: 1.190 Test Acc: 0.710
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.845266580581665
Epoch: 52, Steps: 9 | Train Loss: 0.013 Vali Loss: 1.192 Vali Acc: 0.710 Test Loss: 1.192 Test Acc: 0.710
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.8378546237945557
Epoch: 53, Steps: 9 | Train Loss: 0.011 Vali Loss: 1.188 Vali Acc: 0.710 Test Loss: 1.188 Test Acc: 0.710
Validation loss decreased (-0.710133 --> -0.710133).  Saving model ...
Epoch: 54 cost time: 0.959007740020752
Epoch: 54, Steps: 9 | Train Loss: 0.010 Vali Loss: 1.182 Vali Acc: 0.717 Test Loss: 1.182 Test Acc: 0.717
Validation loss decreased (-0.710133 --> -0.717379).  Saving model ...
Epoch: 55 cost time: 0.7317533493041992
Epoch: 55, Steps: 9 | Train Loss: 0.009 Vali Loss: 1.178 Vali Acc: 0.717 Test Loss: 1.178 Test Acc: 0.717
Validation loss decreased (-0.717379 --> -0.717380).  Saving model ...
Epoch: 56 cost time: 0.8103139400482178
Epoch: 56, Steps: 9 | Train Loss: 0.008 Vali Loss: 1.174 Vali Acc: 0.717 Test Loss: 1.174 Test Acc: 0.717
Validation loss decreased (-0.717380 --> -0.717380).  Saving model ...
Epoch: 57 cost time: 0.8973233699798584
Epoch: 57, Steps: 9 | Train Loss: 0.008 Vali Loss: 1.174 Vali Acc: 0.717 Test Loss: 1.174 Test Acc: 0.717
Validation loss decreased (-0.717380 --> -0.717380).  Saving model ...
Epoch: 58 cost time: 0.8836157321929932
Epoch: 58, Steps: 9 | Train Loss: 0.007 Vali Loss: 1.170 Vali Acc: 0.717 Test Loss: 1.170 Test Acc: 0.717
Validation loss decreased (-0.717380 --> -0.717380).  Saving model ...
Epoch: 59 cost time: 0.949134111404419
Epoch: 59, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.171 Vali Acc: 0.725 Test Loss: 1.171 Test Acc: 0.725
Validation loss decreased (-0.717380 --> -0.724626).  Saving model ...
Epoch: 60 cost time: 1.0675971508026123
Epoch: 60, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.170 Vali Acc: 0.725 Test Loss: 1.170 Test Acc: 0.725
Validation loss decreased (-0.724626 --> -0.724626).  Saving model ...
Epoch: 61 cost time: 0.8753557205200195
Epoch: 61, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.168 Vali Acc: 0.725 Test Loss: 1.168 Test Acc: 0.725
Validation loss decreased (-0.724626 --> -0.724626).  Saving model ...
Epoch: 62 cost time: 0.8544905185699463
Epoch: 62, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.164 Vali Acc: 0.725 Test Loss: 1.164 Test Acc: 0.725
Validation loss decreased (-0.724626 --> -0.724626).  Saving model ...
Epoch: 63 cost time: 0.683098316192627
Epoch: 63, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.165 Vali Acc: 0.725 Test Loss: 1.165 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.7801632881164551
Epoch: 64, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.165 Vali Acc: 0.732 Test Loss: 1.165 Test Acc: 0.732
Validation loss decreased (-0.724626 --> -0.731872).  Saving model ...
Epoch: 65 cost time: 0.9070384502410889
Epoch: 65, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.159 Vali Acc: 0.732 Test Loss: 1.159 Test Acc: 0.732
Validation loss decreased (-0.731872 --> -0.731872).  Saving model ...
Epoch: 66 cost time: 0.851630687713623
Epoch: 66, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.160 Vali Acc: 0.732 Test Loss: 1.160 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.6723055839538574
Epoch: 67, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.157 Vali Acc: 0.732 Test Loss: 1.157 Test Acc: 0.732
Validation loss decreased (-0.731872 --> -0.731872).  Saving model ...
Epoch: 68 cost time: 0.7795071601867676
Epoch: 68, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.157 Vali Acc: 0.725 Test Loss: 1.157 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.747929573059082
Epoch: 69, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.154 Vali Acc: 0.725 Test Loss: 1.154 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 0.8114423751831055
Epoch: 70, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.153 Vali Acc: 0.725 Test Loss: 1.153 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 0.7621774673461914
Epoch: 71, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.151 Vali Acc: 0.725 Test Loss: 1.151 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 0.8271183967590332
Epoch: 72, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.152 Vali Acc: 0.725 Test Loss: 1.152 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 0.7767369747161865
Epoch: 73, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.149 Vali Acc: 0.725 Test Loss: 1.149 Test Acc: 0.725
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 0.883976936340332
Epoch: 74, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.147 Vali Acc: 0.725 Test Loss: 1.147 Test Acc: 0.725
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 0.7131080627441406
Epoch: 75, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.145 Vali Acc: 0.725 Test Loss: 1.145 Test Acc: 0.725
EarlyStopping counter: 8 out of 10
Epoch: 76 cost time: 0.8254413604736328
Epoch: 76, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.145 Vali Acc: 0.725 Test Loss: 1.145 Test Acc: 0.725
EarlyStopping counter: 9 out of 10
Epoch: 77 cost time: 1.0618364810943604
Epoch: 77, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.143 Vali Acc: 0.725 Test Loss: 1.143 Test Acc: 0.725
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm32_cs69_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.7318840579710145
model parameter : 47942
model size : 0.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm32_cs52_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.2021987438201904
Epoch: 1, Steps: 9 | Train Loss: 1.485 Vali Loss: 1.360 Vali Acc: 0.319 Test Loss: 1.360 Test Acc: 0.319
Validation loss decreased (inf --> -0.318827).  Saving model ...
Epoch: 2 cost time: 0.7872419357299805
Epoch: 2, Steps: 9 | Train Loss: 1.394 Vali Loss: 1.278 Vali Acc: 0.420 Test Loss: 1.278 Test Acc: 0.420
Validation loss decreased (-0.318827 --> -0.420277).  Saving model ...
Epoch: 3 cost time: 1.2862043380737305
Epoch: 3, Steps: 9 | Train Loss: 1.279 Vali Loss: 1.196 Vali Acc: 0.464 Test Loss: 1.196 Test Acc: 0.464
Validation loss decreased (-0.420277 --> -0.463756).  Saving model ...
Epoch: 4 cost time: 0.7915501594543457
Epoch: 4, Steps: 9 | Train Loss: 1.163 Vali Loss: 1.132 Vali Acc: 0.486 Test Loss: 1.132 Test Acc: 0.486
Validation loss decreased (-0.463756 --> -0.485496).  Saving model ...
Epoch: 5 cost time: 1.0890111923217773
Epoch: 5, Steps: 9 | Train Loss: 1.068 Vali Loss: 1.091 Vali Acc: 0.493 Test Loss: 1.091 Test Acc: 0.493
Validation loss decreased (-0.485496 --> -0.492743).  Saving model ...
Epoch: 6 cost time: 0.8931686878204346
Epoch: 6, Steps: 9 | Train Loss: 1.010 Vali Loss: 1.068 Vali Acc: 0.457 Test Loss: 1.068 Test Acc: 0.457
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0212125778198242
Epoch: 7, Steps: 9 | Train Loss: 0.929 Vali Loss: 1.045 Vali Acc: 0.471 Test Loss: 1.045 Test Acc: 0.471
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8606939315795898
Epoch: 8, Steps: 9 | Train Loss: 0.873 Vali Loss: 1.030 Vali Acc: 0.500 Test Loss: 1.030 Test Acc: 0.500
Validation loss decreased (-0.492743 --> -0.499990).  Saving model ...
Epoch: 9 cost time: 0.7331621646881104
Epoch: 9, Steps: 9 | Train Loss: 0.820 Vali Loss: 1.017 Vali Acc: 0.500 Test Loss: 1.017 Test Acc: 0.500
Validation loss decreased (-0.499990 --> -0.499990).  Saving model ...
Epoch: 10 cost time: 0.680384635925293
Epoch: 10, Steps: 9 | Train Loss: 0.761 Vali Loss: 1.000 Vali Acc: 0.529 Test Loss: 1.000 Test Acc: 0.529
Validation loss decreased (-0.499990 --> -0.528976).  Saving model ...
Epoch: 11 cost time: 0.7508656978607178
Epoch: 11, Steps: 9 | Train Loss: 0.724 Vali Loss: 1.002 Vali Acc: 0.536 Test Loss: 1.002 Test Acc: 0.536
Validation loss decreased (-0.528976 --> -0.536222).  Saving model ...
Epoch: 12 cost time: 0.7058136463165283
Epoch: 12, Steps: 9 | Train Loss: 0.686 Vali Loss: 0.984 Vali Acc: 0.558 Test Loss: 0.984 Test Acc: 0.558
Validation loss decreased (-0.536222 --> -0.557961).  Saving model ...
Epoch: 13 cost time: 0.8654303550720215
Epoch: 13, Steps: 9 | Train Loss: 0.633 Vali Loss: 0.991 Vali Acc: 0.558 Test Loss: 0.991 Test Acc: 0.558
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7421054840087891
Epoch: 14, Steps: 9 | Train Loss: 0.596 Vali Loss: 0.986 Vali Acc: 0.580 Test Loss: 0.986 Test Acc: 0.580
Validation loss decreased (-0.557961 --> -0.579700).  Saving model ...
Epoch: 15 cost time: 0.7982442378997803
Epoch: 15, Steps: 9 | Train Loss: 0.560 Vali Loss: 0.964 Vali Acc: 0.565 Test Loss: 0.964 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.568934440612793
Epoch: 16, Steps: 9 | Train Loss: 0.512 Vali Loss: 0.965 Vali Acc: 0.572 Test Loss: 0.965 Test Acc: 0.572
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8782103061676025
Epoch: 17, Steps: 9 | Train Loss: 0.458 Vali Loss: 0.952 Vali Acc: 0.601 Test Loss: 0.952 Test Acc: 0.601
Validation loss decreased (-0.579700 --> -0.601440).  Saving model ...
Epoch: 18 cost time: 0.8249883651733398
Epoch: 18, Steps: 9 | Train Loss: 0.413 Vali Loss: 0.928 Vali Acc: 0.601 Test Loss: 0.928 Test Acc: 0.601
Validation loss decreased (-0.601440 --> -0.601440).  Saving model ...
Epoch: 19 cost time: 0.7771754264831543
Epoch: 19, Steps: 9 | Train Loss: 0.370 Vali Loss: 0.909 Vali Acc: 0.609 Test Loss: 0.909 Test Acc: 0.609
Validation loss decreased (-0.601440 --> -0.608687).  Saving model ...
Epoch: 20 cost time: 0.9066412448883057
Epoch: 20, Steps: 9 | Train Loss: 0.328 Vali Loss: 0.886 Vali Acc: 0.638 Test Loss: 0.886 Test Acc: 0.638
Validation loss decreased (-0.608687 --> -0.637672).  Saving model ...
Epoch: 21 cost time: 0.9426450729370117
Epoch: 21, Steps: 9 | Train Loss: 0.287 Vali Loss: 0.888 Vali Acc: 0.645 Test Loss: 0.888 Test Acc: 0.645
Validation loss decreased (-0.637672 --> -0.644919).  Saving model ...
Epoch: 22 cost time: 0.9456193447113037
Epoch: 22, Steps: 9 | Train Loss: 0.253 Vali Loss: 0.896 Vali Acc: 0.659 Test Loss: 0.896 Test Acc: 0.659
Validation loss decreased (-0.644919 --> -0.659411).  Saving model ...
Epoch: 23 cost time: 0.6268882751464844
Epoch: 23, Steps: 9 | Train Loss: 0.224 Vali Loss: 0.865 Vali Acc: 0.659 Test Loss: 0.865 Test Acc: 0.659
Validation loss decreased (-0.659411 --> -0.659412).  Saving model ...
Epoch: 24 cost time: 0.8555059432983398
Epoch: 24, Steps: 9 | Train Loss: 0.203 Vali Loss: 0.878 Vali Acc: 0.652 Test Loss: 0.878 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7017335891723633
Epoch: 25, Steps: 9 | Train Loss: 0.184 Vali Loss: 0.889 Vali Acc: 0.652 Test Loss: 0.889 Test Acc: 0.652
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8361294269561768
Epoch: 26, Steps: 9 | Train Loss: 0.175 Vali Loss: 0.857 Vali Acc: 0.645 Test Loss: 0.857 Test Acc: 0.645
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9762780666351318
Epoch: 27, Steps: 9 | Train Loss: 0.152 Vali Loss: 0.900 Vali Acc: 0.674 Test Loss: 0.900 Test Acc: 0.674
Validation loss decreased (-0.659412 --> -0.673904).  Saving model ...
Epoch: 28 cost time: 0.9077386856079102
Epoch: 28, Steps: 9 | Train Loss: 0.140 Vali Loss: 0.897 Vali Acc: 0.659 Test Loss: 0.897 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8559253215789795
Epoch: 29, Steps: 9 | Train Loss: 0.140 Vali Loss: 0.875 Vali Acc: 0.667 Test Loss: 0.875 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8698165416717529
Epoch: 30, Steps: 9 | Train Loss: 0.115 Vali Loss: 0.919 Vali Acc: 0.674 Test Loss: 0.919 Test Acc: 0.674
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.6267387866973877
Epoch: 31, Steps: 9 | Train Loss: 0.113 Vali Loss: 0.943 Vali Acc: 0.645 Test Loss: 0.943 Test Acc: 0.645
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.7789268493652344
Epoch: 32, Steps: 9 | Train Loss: 0.106 Vali Loss: 0.918 Vali Acc: 0.681 Test Loss: 0.918 Test Acc: 0.681
Validation loss decreased (-0.673904 --> -0.681150).  Saving model ...
Epoch: 33 cost time: 0.7319049835205078
Epoch: 33, Steps: 9 | Train Loss: 0.094 Vali Loss: 0.976 Vali Acc: 0.681 Test Loss: 0.976 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8506300449371338
Epoch: 34, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.961 Vali Acc: 0.674 Test Loss: 0.961 Test Acc: 0.674
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.7774868011474609
Epoch: 35, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.963 Vali Acc: 0.674 Test Loss: 0.963 Test Acc: 0.674
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.6824991703033447
Epoch: 36, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.995 Vali Acc: 0.681 Test Loss: 0.995 Test Acc: 0.681
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.7338922023773193
Epoch: 37, Steps: 9 | Train Loss: 0.061 Vali Loss: 1.035 Vali Acc: 0.667 Test Loss: 1.035 Test Acc: 0.667
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.0452067852020264
Epoch: 38, Steps: 9 | Train Loss: 0.060 Vali Loss: 1.030 Vali Acc: 0.659 Test Loss: 1.030 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.9183061122894287
Epoch: 39, Steps: 9 | Train Loss: 0.051 Vali Loss: 1.087 Vali Acc: 0.667 Test Loss: 1.087 Test Acc: 0.667
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.0163524150848389
Epoch: 40, Steps: 9 | Train Loss: 0.046 Vali Loss: 1.052 Vali Acc: 0.681 Test Loss: 1.052 Test Acc: 0.681
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.039238691329956
Epoch: 41, Steps: 9 | Train Loss: 0.041 Vali Loss: 1.062 Vali Acc: 0.688 Test Loss: 1.062 Test Acc: 0.688
Validation loss decreased (-0.681150 --> -0.688395).  Saving model ...
Epoch: 42 cost time: 0.7105891704559326
Epoch: 42, Steps: 9 | Train Loss: 0.038 Vali Loss: 1.085 Vali Acc: 0.703 Test Loss: 1.085 Test Acc: 0.703
Validation loss decreased (-0.688395 --> -0.702888).  Saving model ...
Epoch: 43 cost time: 0.9067347049713135
Epoch: 43, Steps: 9 | Train Loss: 0.035 Vali Loss: 1.136 Vali Acc: 0.681 Test Loss: 1.136 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.9716019630432129
Epoch: 44, Steps: 9 | Train Loss: 0.032 Vali Loss: 1.141 Vali Acc: 0.696 Test Loss: 1.141 Test Acc: 0.696
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.7040700912475586
Epoch: 45, Steps: 9 | Train Loss: 0.029 Vali Loss: 1.136 Vali Acc: 0.703 Test Loss: 1.136 Test Acc: 0.703
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.9676287174224854
Epoch: 46, Steps: 9 | Train Loss: 0.027 Vali Loss: 1.160 Vali Acc: 0.710 Test Loss: 1.160 Test Acc: 0.710
Validation loss decreased (-0.702888 --> -0.710133).  Saving model ...
Epoch: 47 cost time: 0.8402843475341797
Epoch: 47, Steps: 9 | Train Loss: 0.025 Vali Loss: 1.186 Vali Acc: 0.725 Test Loss: 1.186 Test Acc: 0.725
Validation loss decreased (-0.710133 --> -0.724626).  Saving model ...
Epoch: 48 cost time: 0.7773041725158691
Epoch: 48, Steps: 9 | Train Loss: 0.022 Vali Loss: 1.191 Vali Acc: 0.717 Test Loss: 1.191 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.7241685390472412
Epoch: 49, Steps: 9 | Train Loss: 0.021 Vali Loss: 1.204 Vali Acc: 0.710 Test Loss: 1.204 Test Acc: 0.710
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.7468392848968506
Epoch: 50, Steps: 9 | Train Loss: 0.020 Vali Loss: 1.223 Vali Acc: 0.717 Test Loss: 1.223 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.7790453433990479
Epoch: 51, Steps: 9 | Train Loss: 0.019 Vali Loss: 1.233 Vali Acc: 0.710 Test Loss: 1.233 Test Acc: 0.710
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.7351202964782715
Epoch: 52, Steps: 9 | Train Loss: 0.017 Vali Loss: 1.256 Vali Acc: 0.710 Test Loss: 1.256 Test Acc: 0.710
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 0.8450822830200195
Epoch: 53, Steps: 9 | Train Loss: 0.017 Vali Loss: 1.271 Vali Acc: 0.710 Test Loss: 1.271 Test Acc: 0.710
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 1.0495150089263916
Epoch: 54, Steps: 9 | Train Loss: 0.015 Vali Loss: 1.273 Vali Acc: 0.710 Test Loss: 1.273 Test Acc: 0.710
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 0.813349723815918
Epoch: 55, Steps: 9 | Train Loss: 0.014 Vali Loss: 1.282 Vali Acc: 0.717 Test Loss: 1.282 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 0.8615434169769287
Epoch: 56, Steps: 9 | Train Loss: 0.013 Vali Loss: 1.322 Vali Acc: 0.717 Test Loss: 1.322 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 0.7175388336181641
Epoch: 57, Steps: 9 | Train Loss: 0.012 Vali Loss: 1.329 Vali Acc: 0.710 Test Loss: 1.329 Test Acc: 0.710
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm32_cs52_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.7246376811594203
model parameter : 47894
model size : 0.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm32_cs42_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.4490950107574463
Epoch: 1, Steps: 9 | Train Loss: 1.432 Vali Loss: 1.433 Vali Acc: 0.217 Test Loss: 1.433 Test Acc: 0.217
Validation loss decreased (inf --> -0.217377).  Saving model ...
Epoch: 2 cost time: 0.950150728225708
Epoch: 2, Steps: 9 | Train Loss: 1.353 Vali Loss: 1.348 Vali Acc: 0.261 Test Loss: 1.348 Test Acc: 0.261
Validation loss decreased (-0.217377 --> -0.260856).  Saving model ...
Epoch: 3 cost time: 0.8263106346130371
Epoch: 3, Steps: 9 | Train Loss: 1.247 Vali Loss: 1.257 Vali Acc: 0.304 Test Loss: 1.257 Test Acc: 0.304
Validation loss decreased (-0.260856 --> -0.304335).  Saving model ...
Epoch: 4 cost time: 0.939720630645752
Epoch: 4, Steps: 9 | Train Loss: 1.141 Vali Loss: 1.183 Vali Acc: 0.413 Test Loss: 1.183 Test Acc: 0.413
Validation loss decreased (-0.304335 --> -0.413032).  Saving model ...
Epoch: 5 cost time: 0.7148106098175049
Epoch: 5, Steps: 9 | Train Loss: 1.055 Vali Loss: 1.128 Vali Acc: 0.471 Test Loss: 1.128 Test Acc: 0.471
Validation loss decreased (-0.413032 --> -0.471003).  Saving model ...
Epoch: 6 cost time: 0.7972276210784912
Epoch: 6, Steps: 9 | Train Loss: 0.985 Vali Loss: 1.089 Vali Acc: 0.500 Test Loss: 1.089 Test Acc: 0.500
Validation loss decreased (-0.471003 --> -0.499989).  Saving model ...
Epoch: 7 cost time: 0.9337501525878906
Epoch: 7, Steps: 9 | Train Loss: 0.922 Vali Loss: 1.079 Vali Acc: 0.464 Test Loss: 1.079 Test Acc: 0.464
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.012584924697876
Epoch: 8, Steps: 9 | Train Loss: 0.876 Vali Loss: 1.070 Vali Acc: 0.500 Test Loss: 1.070 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 9 cost time: 1.1690199375152588
Epoch: 9, Steps: 9 | Train Loss: 0.818 Vali Loss: 1.044 Vali Acc: 0.507 Test Loss: 1.044 Test Acc: 0.507
Validation loss decreased (-0.499989 --> -0.507236).  Saving model ...
Epoch: 10 cost time: 1.0744330883026123
Epoch: 10, Steps: 9 | Train Loss: 0.781 Vali Loss: 1.013 Vali Acc: 0.507 Test Loss: 1.013 Test Acc: 0.507
Validation loss decreased (-0.507236 --> -0.507236).  Saving model ...
Epoch: 11 cost time: 0.910991907119751
Epoch: 11, Steps: 9 | Train Loss: 0.723 Vali Loss: 1.013 Vali Acc: 0.507 Test Loss: 1.013 Test Acc: 0.507
Validation loss decreased (-0.507236 --> -0.507236).  Saving model ...
Epoch: 12 cost time: 1.2396385669708252
Epoch: 12, Steps: 9 | Train Loss: 0.680 Vali Loss: 1.018 Vali Acc: 0.522 Test Loss: 1.018 Test Acc: 0.522
Validation loss decreased (-0.507236 --> -0.521729).  Saving model ...
Epoch: 13 cost time: 0.9146380424499512
Epoch: 13, Steps: 9 | Train Loss: 0.644 Vali Loss: 1.017 Vali Acc: 0.551 Test Loss: 1.017 Test Acc: 0.551
Validation loss decreased (-0.521729 --> -0.550714).  Saving model ...
Epoch: 14 cost time: 0.9796583652496338
Epoch: 14, Steps: 9 | Train Loss: 0.617 Vali Loss: 1.013 Vali Acc: 0.580 Test Loss: 1.013 Test Acc: 0.580
Validation loss decreased (-0.550714 --> -0.579700).  Saving model ...
Epoch: 15 cost time: 0.836939811706543
Epoch: 15, Steps: 9 | Train Loss: 0.589 Vali Loss: 1.011 Vali Acc: 0.551 Test Loss: 1.011 Test Acc: 0.551
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9678139686584473
Epoch: 16, Steps: 9 | Train Loss: 0.552 Vali Loss: 1.005 Vali Acc: 0.572 Test Loss: 1.005 Test Acc: 0.572
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2783665657043457
Epoch: 17, Steps: 9 | Train Loss: 0.509 Vali Loss: 1.023 Vali Acc: 0.594 Test Loss: 1.023 Test Acc: 0.594
Validation loss decreased (-0.579700 --> -0.594193).  Saving model ...
Epoch: 18 cost time: 1.118664026260376
Epoch: 18, Steps: 9 | Train Loss: 0.482 Vali Loss: 1.019 Vali Acc: 0.594 Test Loss: 1.019 Test Acc: 0.594
Validation loss decreased (-0.594193 --> -0.594193).  Saving model ...
Epoch: 19 cost time: 1.1253468990325928
Epoch: 19, Steps: 9 | Train Loss: 0.457 Vali Loss: 1.018 Vali Acc: 0.609 Test Loss: 1.018 Test Acc: 0.609
Validation loss decreased (-0.594193 --> -0.608685).  Saving model ...
Epoch: 20 cost time: 1.267848253250122
Epoch: 20, Steps: 9 | Train Loss: 0.434 Vali Loss: 1.039 Vali Acc: 0.601 Test Loss: 1.039 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.07676362991333
Epoch: 21, Steps: 9 | Train Loss: 0.401 Vali Loss: 1.039 Vali Acc: 0.601 Test Loss: 1.039 Test Acc: 0.601
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1216397285461426
Epoch: 22, Steps: 9 | Train Loss: 0.368 Vali Loss: 1.036 Vali Acc: 0.623 Test Loss: 1.036 Test Acc: 0.623
Validation loss decreased (-0.608685 --> -0.623178).  Saving model ...
Epoch: 23 cost time: 1.3290657997131348
Epoch: 23, Steps: 9 | Train Loss: 0.351 Vali Loss: 1.032 Vali Acc: 0.616 Test Loss: 1.032 Test Acc: 0.616
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.349632978439331
Epoch: 24, Steps: 9 | Train Loss: 0.319 Vali Loss: 1.040 Vali Acc: 0.616 Test Loss: 1.040 Test Acc: 0.616
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.3820154666900635
Epoch: 25, Steps: 9 | Train Loss: 0.290 Vali Loss: 1.019 Vali Acc: 0.623 Test Loss: 1.019 Test Acc: 0.623
Validation loss decreased (-0.623178 --> -0.623178).  Saving model ...
Epoch: 26 cost time: 1.0496859550476074
Epoch: 26, Steps: 9 | Train Loss: 0.254 Vali Loss: 1.003 Vali Acc: 0.638 Test Loss: 1.003 Test Acc: 0.638
Validation loss decreased (-0.623178 --> -0.637671).  Saving model ...
Epoch: 27 cost time: 1.385739803314209
Epoch: 27, Steps: 9 | Train Loss: 0.218 Vali Loss: 0.981 Vali Acc: 0.645 Test Loss: 0.981 Test Acc: 0.645
Validation loss decreased (-0.637671 --> -0.644918).  Saving model ...
Epoch: 28 cost time: 1.2919180393218994
Epoch: 28, Steps: 9 | Train Loss: 0.186 Vali Loss: 0.977 Vali Acc: 0.667 Test Loss: 0.977 Test Acc: 0.667
Validation loss decreased (-0.644918 --> -0.666657).  Saving model ...
Epoch: 29 cost time: 1.1722354888916016
Epoch: 29, Steps: 9 | Train Loss: 0.149 Vali Loss: 0.923 Vali Acc: 0.696 Test Loss: 0.923 Test Acc: 0.696
Validation loss decreased (-0.666657 --> -0.695643).  Saving model ...
Epoch: 30 cost time: 1.2119545936584473
Epoch: 30, Steps: 9 | Train Loss: 0.125 Vali Loss: 0.887 Vali Acc: 0.696 Test Loss: 0.887 Test Acc: 0.696
Validation loss decreased (-0.695643 --> -0.695643).  Saving model ...
Epoch: 31 cost time: 0.9819223880767822
Epoch: 31, Steps: 9 | Train Loss: 0.103 Vali Loss: 0.835 Vali Acc: 0.710 Test Loss: 0.835 Test Acc: 0.710
Validation loss decreased (-0.695643 --> -0.710137).  Saving model ...
Epoch: 32 cost time: 1.067931890487671
Epoch: 32, Steps: 9 | Train Loss: 0.089 Vali Loss: 0.818 Vali Acc: 0.710 Test Loss: 0.818 Test Acc: 0.710
Validation loss decreased (-0.710137 --> -0.710137).  Saving model ...
Epoch: 33 cost time: 0.9128737449645996
Epoch: 33, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.820 Vali Acc: 0.725 Test Loss: 0.820 Test Acc: 0.725
Validation loss decreased (-0.710137 --> -0.724629).  Saving model ...
Epoch: 34 cost time: 1.0786988735198975
Epoch: 34, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.823 Vali Acc: 0.717 Test Loss: 0.823 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.375558853149414
Epoch: 35, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.808 Vali Acc: 0.717 Test Loss: 0.808 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.2026455402374268
Epoch: 36, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.802 Vali Acc: 0.725 Test Loss: 0.802 Test Acc: 0.725
Validation loss decreased (-0.724629 --> -0.724630).  Saving model ...
Epoch: 37 cost time: 1.177828073501587
Epoch: 37, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.793 Vali Acc: 0.739 Test Loss: 0.793 Test Acc: 0.739
Validation loss decreased (-0.724630 --> -0.739123).  Saving model ...
Epoch: 38 cost time: 1.380375862121582
Epoch: 38, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.796 Vali Acc: 0.732 Test Loss: 0.796 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.8604729175567627
Epoch: 39, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.800 Vali Acc: 0.739 Test Loss: 0.800 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.0946524143218994
Epoch: 40, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.790 Vali Acc: 0.739 Test Loss: 0.790 Test Acc: 0.739
Validation loss decreased (-0.739123 --> -0.739123).  Saving model ...
Epoch: 41 cost time: 0.9949212074279785
Epoch: 41, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.794 Vali Acc: 0.746 Test Loss: 0.794 Test Acc: 0.746
Validation loss decreased (-0.739123 --> -0.746369).  Saving model ...
Epoch: 42 cost time: 0.9367885589599609
Epoch: 42, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.807 Vali Acc: 0.746 Test Loss: 0.807 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.9678046703338623
Epoch: 43, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.808 Vali Acc: 0.768 Test Loss: 0.808 Test Acc: 0.768
Validation loss decreased (-0.746369 --> -0.768108).  Saving model ...
Epoch: 44 cost time: 1.088474988937378
Epoch: 44, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.809 Vali Acc: 0.768 Test Loss: 0.809 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.2958173751831055
Epoch: 45, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.819 Vali Acc: 0.775 Test Loss: 0.819 Test Acc: 0.775
Validation loss decreased (-0.768108 --> -0.775354).  Saving model ...
Epoch: 46 cost time: 0.8932254314422607
Epoch: 46, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.826 Vali Acc: 0.775 Test Loss: 0.826 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.250678539276123
Epoch: 47, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.821 Vali Acc: 0.775 Test Loss: 0.821 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.9643146991729736
Epoch: 48, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.827 Vali Acc: 0.783 Test Loss: 0.827 Test Acc: 0.783
Validation loss decreased (-0.775354 --> -0.782600).  Saving model ...
Epoch: 49 cost time: 1.0282237529754639
Epoch: 49, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.843 Vali Acc: 0.790 Test Loss: 0.843 Test Acc: 0.790
Validation loss decreased (-0.782600 --> -0.789847).  Saving model ...
Epoch: 50 cost time: 1.0597949028015137
Epoch: 50, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.858 Vali Acc: 0.790 Test Loss: 0.858 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.8565988540649414
Epoch: 51, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.840 Vali Acc: 0.797 Test Loss: 0.840 Test Acc: 0.797
Validation loss decreased (-0.789847 --> -0.797093).  Saving model ...
Epoch: 52 cost time: 0.8924746513366699
Epoch: 52, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.855 Vali Acc: 0.790 Test Loss: 0.855 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.256746768951416
Epoch: 53, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.865 Vali Acc: 0.790 Test Loss: 0.865 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.9682571887969971
Epoch: 54, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.866 Vali Acc: 0.797 Test Loss: 0.866 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 1.003462314605713
Epoch: 55, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.880 Vali Acc: 0.790 Test Loss: 0.880 Test Acc: 0.790
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 1.132964849472046
Epoch: 56, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.895 Vali Acc: 0.790 Test Loss: 0.895 Test Acc: 0.790
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 0.7207427024841309
Epoch: 57, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.883 Vali Acc: 0.790 Test Loss: 0.883 Test Acc: 0.790
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 0.8486297130584717
Epoch: 58, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.893 Vali Acc: 0.797 Test Loss: 0.893 Test Acc: 0.797
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 0.8630921840667725
Epoch: 59, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.895 Vali Acc: 0.804 Test Loss: 0.895 Test Acc: 0.804
Validation loss decreased (-0.797093 --> -0.804339).  Saving model ...
Epoch: 60 cost time: 1.1023447513580322
Epoch: 60, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.913 Vali Acc: 0.797 Test Loss: 0.913 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.7607598304748535
Epoch: 61, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.935 Vali Acc: 0.790 Test Loss: 0.935 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.1951384544372559
Epoch: 62, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.924 Vali Acc: 0.804 Test Loss: 0.924 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 1.126380205154419
Epoch: 63, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.928 Vali Acc: 0.804 Test Loss: 0.928 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 1.0616166591644287
Epoch: 64, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.934 Vali Acc: 0.804 Test Loss: 0.934 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 1.098517894744873
Epoch: 65, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.950 Vali Acc: 0.797 Test Loss: 0.950 Test Acc: 0.797
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 1.0842223167419434
Epoch: 66, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.965 Vali Acc: 0.804 Test Loss: 0.965 Test Acc: 0.804
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 0.9101860523223877
Epoch: 67, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.968 Vali Acc: 0.797 Test Loss: 0.968 Test Acc: 0.797
EarlyStopping counter: 8 out of 10
Epoch: 68 cost time: 0.8927037715911865
Epoch: 68, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.980 Vali Acc: 0.797 Test Loss: 0.980 Test Acc: 0.797
EarlyStopping counter: 9 out of 10
Epoch: 69 cost time: 1.246957778930664
Epoch: 69, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.982 Vali Acc: 0.804 Test Loss: 0.982 Test Acc: 0.804
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm32_cs42_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8043478260869565
model parameter : 48168
model size : 0.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm32_cs35_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.7889671325683594
Epoch: 1, Steps: 9 | Train Loss: 1.432 Vali Loss: 1.385 Vali Acc: 0.297 Test Loss: 1.385 Test Acc: 0.297
Validation loss decreased (inf --> -0.297088).  Saving model ...
Epoch: 2 cost time: 0.9587223529815674
Epoch: 2, Steps: 9 | Train Loss: 1.353 Vali Loss: 1.306 Vali Acc: 0.391 Test Loss: 1.306 Test Acc: 0.391
Validation loss decreased (-0.297088 --> -0.391291).  Saving model ...
Epoch: 3 cost time: 1.0352184772491455
Epoch: 3, Steps: 9 | Train Loss: 1.249 Vali Loss: 1.213 Vali Acc: 0.471 Test Loss: 1.213 Test Acc: 0.471
Validation loss decreased (-0.391291 --> -0.471002).  Saving model ...
Epoch: 4 cost time: 0.8198060989379883
Epoch: 4, Steps: 9 | Train Loss: 1.155 Vali Loss: 1.139 Vali Acc: 0.457 Test Loss: 1.139 Test Acc: 0.457
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1050806045532227
Epoch: 5, Steps: 9 | Train Loss: 1.072 Vali Loss: 1.098 Vali Acc: 0.478 Test Loss: 1.098 Test Acc: 0.478
Validation loss decreased (-0.471002 --> -0.478250).  Saving model ...
Epoch: 6 cost time: 1.136091947555542
Epoch: 6, Steps: 9 | Train Loss: 0.989 Vali Loss: 1.066 Vali Acc: 0.478 Test Loss: 1.066 Test Acc: 0.478
Validation loss decreased (-0.478250 --> -0.478250).  Saving model ...
Epoch: 7 cost time: 0.8233959674835205
Epoch: 7, Steps: 9 | Train Loss: 0.934 Vali Loss: 1.039 Vali Acc: 0.486 Test Loss: 1.039 Test Acc: 0.486
Validation loss decreased (-0.478250 --> -0.485497).  Saving model ...
Epoch: 8 cost time: 1.5101659297943115
Epoch: 8, Steps: 9 | Train Loss: 0.876 Vali Loss: 1.036 Vali Acc: 0.478 Test Loss: 1.036 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9763753414154053
Epoch: 9, Steps: 9 | Train Loss: 0.831 Vali Loss: 1.027 Vali Acc: 0.529 Test Loss: 1.027 Test Acc: 0.529
Validation loss decreased (-0.485497 --> -0.528975).  Saving model ...
Epoch: 10 cost time: 0.8243372440338135
Epoch: 10, Steps: 9 | Train Loss: 0.792 Vali Loss: 1.002 Vali Acc: 0.543 Test Loss: 1.002 Test Acc: 0.543
Validation loss decreased (-0.528975 --> -0.543468).  Saving model ...
Epoch: 11 cost time: 0.9850020408630371
Epoch: 11, Steps: 9 | Train Loss: 0.741 Vali Loss: 1.007 Vali Acc: 0.529 Test Loss: 1.007 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0149474143981934
Epoch: 12, Steps: 9 | Train Loss: 0.697 Vali Loss: 0.994 Vali Acc: 0.543 Test Loss: 0.994 Test Acc: 0.543
Validation loss decreased (-0.543468 --> -0.543468).  Saving model ...
Epoch: 13 cost time: 0.8610117435455322
Epoch: 13, Steps: 9 | Train Loss: 0.660 Vali Loss: 0.987 Vali Acc: 0.565 Test Loss: 0.987 Test Acc: 0.565
Validation loss decreased (-0.543468 --> -0.565208).  Saving model ...
Epoch: 14 cost time: 1.0244383811950684
Epoch: 14, Steps: 9 | Train Loss: 0.604 Vali Loss: 0.976 Vali Acc: 0.587 Test Loss: 0.976 Test Acc: 0.587
Validation loss decreased (-0.565208 --> -0.586947).  Saving model ...
Epoch: 15 cost time: 1.000380516052246
Epoch: 15, Steps: 9 | Train Loss: 0.588 Vali Loss: 0.983 Vali Acc: 0.558 Test Loss: 0.983 Test Acc: 0.558
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8641383647918701
Epoch: 16, Steps: 9 | Train Loss: 0.539 Vali Loss: 0.980 Vali Acc: 0.594 Test Loss: 0.980 Test Acc: 0.594
Validation loss decreased (-0.586947 --> -0.594193).  Saving model ...
Epoch: 17 cost time: 1.0060434341430664
Epoch: 17, Steps: 9 | Train Loss: 0.511 Vali Loss: 0.974 Vali Acc: 0.630 Test Loss: 0.974 Test Acc: 0.630
Validation loss decreased (-0.594193 --> -0.630425).  Saving model ...
Epoch: 18 cost time: 1.3425698280334473
Epoch: 18, Steps: 9 | Train Loss: 0.472 Vali Loss: 0.948 Vali Acc: 0.645 Test Loss: 0.948 Test Acc: 0.645
Validation loss decreased (-0.630425 --> -0.644918).  Saving model ...
Epoch: 19 cost time: 0.9490938186645508
Epoch: 19, Steps: 9 | Train Loss: 0.410 Vali Loss: 0.942 Vali Acc: 0.630 Test Loss: 0.942 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3691840171813965
Epoch: 20, Steps: 9 | Train Loss: 0.371 Vali Loss: 0.939 Vali Acc: 0.638 Test Loss: 0.939 Test Acc: 0.638
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2792692184448242
Epoch: 21, Steps: 9 | Train Loss: 0.331 Vali Loss: 0.885 Vali Acc: 0.659 Test Loss: 0.885 Test Acc: 0.659
Validation loss decreased (-0.644918 --> -0.659411).  Saving model ...
Epoch: 22 cost time: 1.09505295753479
Epoch: 22, Steps: 9 | Train Loss: 0.274 Vali Loss: 0.866 Vali Acc: 0.645 Test Loss: 0.866 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1764039993286133
Epoch: 23, Steps: 9 | Train Loss: 0.244 Vali Loss: 0.825 Vali Acc: 0.667 Test Loss: 0.825 Test Acc: 0.667
Validation loss decreased (-0.659411 --> -0.666658).  Saving model ...
Epoch: 24 cost time: 1.2080039978027344
Epoch: 24, Steps: 9 | Train Loss: 0.210 Vali Loss: 0.808 Vali Acc: 0.667 Test Loss: 0.808 Test Acc: 0.667
Validation loss decreased (-0.666658 --> -0.666659).  Saving model ...
Epoch: 25 cost time: 0.9893412590026855
Epoch: 25, Steps: 9 | Train Loss: 0.189 Vali Loss: 0.778 Vali Acc: 0.659 Test Loss: 0.778 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0862853527069092
Epoch: 26, Steps: 9 | Train Loss: 0.168 Vali Loss: 0.797 Vali Acc: 0.659 Test Loss: 0.797 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.24163818359375
Epoch: 27, Steps: 9 | Train Loss: 0.150 Vali Loss: 0.805 Vali Acc: 0.652 Test Loss: 0.805 Test Acc: 0.652
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.0773258209228516
Epoch: 28, Steps: 9 | Train Loss: 0.133 Vali Loss: 0.814 Vali Acc: 0.659 Test Loss: 0.814 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.0146484375
Epoch: 29, Steps: 9 | Train Loss: 0.124 Vali Loss: 0.795 Vali Acc: 0.667 Test Loss: 0.795 Test Acc: 0.667
Validation loss decreased (-0.666659 --> -0.666659).  Saving model ...
Epoch: 30 cost time: 1.1110119819641113
Epoch: 30, Steps: 9 | Train Loss: 0.111 Vali Loss: 0.796 Vali Acc: 0.674 Test Loss: 0.796 Test Acc: 0.674
Validation loss decreased (-0.666659 --> -0.673905).  Saving model ...
Epoch: 31 cost time: 1.2149980068206787
Epoch: 31, Steps: 9 | Train Loss: 0.095 Vali Loss: 0.792 Vali Acc: 0.674 Test Loss: 0.792 Test Acc: 0.674
Validation loss decreased (-0.673905 --> -0.673905).  Saving model ...
Epoch: 32 cost time: 0.9870233535766602
Epoch: 32, Steps: 9 | Train Loss: 0.086 Vali Loss: 0.813 Vali Acc: 0.681 Test Loss: 0.813 Test Acc: 0.681
Validation loss decreased (-0.673905 --> -0.681151).  Saving model ...
Epoch: 33 cost time: 0.9545180797576904
Epoch: 33, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.831 Vali Acc: 0.674 Test Loss: 0.831 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.372147560119629
Epoch: 34, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.819 Vali Acc: 0.674 Test Loss: 0.819 Test Acc: 0.674
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.006659984588623
Epoch: 35, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.822 Vali Acc: 0.688 Test Loss: 0.822 Test Acc: 0.688
Validation loss decreased (-0.681151 --> -0.688398).  Saving model ...
Epoch: 36 cost time: 0.9195983409881592
Epoch: 36, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.840 Vali Acc: 0.681 Test Loss: 0.840 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.3499858379364014
Epoch: 37, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.840 Vali Acc: 0.688 Test Loss: 0.840 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.2608559131622314
Epoch: 38, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.844 Vali Acc: 0.681 Test Loss: 0.844 Test Acc: 0.681
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.1543736457824707
Epoch: 39, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.841 Vali Acc: 0.688 Test Loss: 0.841 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.9846460819244385
Epoch: 40, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.865 Vali Acc: 0.681 Test Loss: 0.865 Test Acc: 0.681
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.1882448196411133
Epoch: 41, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.892 Vali Acc: 0.696 Test Loss: 0.892 Test Acc: 0.696
Validation loss decreased (-0.688398 --> -0.695643).  Saving model ...
Epoch: 42 cost time: 1.3041226863861084
Epoch: 42, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.880 Vali Acc: 0.703 Test Loss: 0.880 Test Acc: 0.703
Validation loss decreased (-0.695643 --> -0.702890).  Saving model ...
Epoch: 43 cost time: 1.127800703048706
Epoch: 43, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.877 Vali Acc: 0.703 Test Loss: 0.877 Test Acc: 0.703
Validation loss decreased (-0.702890 --> -0.702890).  Saving model ...
Epoch: 44 cost time: 1.1227953433990479
Epoch: 44, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.868 Vali Acc: 0.710 Test Loss: 0.868 Test Acc: 0.710
Validation loss decreased (-0.702890 --> -0.710136).  Saving model ...
Epoch: 45 cost time: 0.8222579956054688
Epoch: 45, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.879 Vali Acc: 0.710 Test Loss: 0.879 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.394531488418579
Epoch: 46, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.900 Vali Acc: 0.717 Test Loss: 0.900 Test Acc: 0.717
Validation loss decreased (-0.710136 --> -0.717382).  Saving model ...
Epoch: 47 cost time: 1.4072134494781494
Epoch: 47, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.896 Vali Acc: 0.717 Test Loss: 0.896 Test Acc: 0.717
Validation loss decreased (-0.717382 --> -0.717382).  Saving model ...
Epoch: 48 cost time: 1.1728184223175049
Epoch: 48, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.894 Vali Acc: 0.710 Test Loss: 0.894 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.3268938064575195
Epoch: 49, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.922 Vali Acc: 0.717 Test Loss: 0.922 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.074955701828003
Epoch: 50, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.909 Vali Acc: 0.710 Test Loss: 0.909 Test Acc: 0.710
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.9887685775756836
Epoch: 51, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.911 Vali Acc: 0.717 Test Loss: 0.911 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.9878392219543457
Epoch: 52, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.930 Vali Acc: 0.732 Test Loss: 0.930 Test Acc: 0.732
Validation loss decreased (-0.717382 --> -0.731875).  Saving model ...
Epoch: 53 cost time: 1.157775640487671
Epoch: 53, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.941 Vali Acc: 0.725 Test Loss: 0.941 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.819263219833374
Epoch: 54, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.930 Vali Acc: 0.732 Test Loss: 0.930 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.1955318450927734
Epoch: 55, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.928 Vali Acc: 0.717 Test Loss: 0.928 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.2971129417419434
Epoch: 56, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.935 Vali Acc: 0.732 Test Loss: 0.935 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 1.1632804870605469
Epoch: 57, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.934 Vali Acc: 0.732 Test Loss: 0.934 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 1.485666275024414
Epoch: 58, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.941 Vali Acc: 0.717 Test Loss: 0.941 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 1.0724937915802002
Epoch: 59, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.945 Vali Acc: 0.725 Test Loss: 0.945 Test Acc: 0.725
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 1.1197361946105957
Epoch: 60, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.948 Vali Acc: 0.732 Test Loss: 0.948 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 1.1383404731750488
Epoch: 61, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.952 Vali Acc: 0.725 Test Loss: 0.952 Test Acc: 0.725
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 1.0888807773590088
Epoch: 62, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.957 Vali Acc: 0.746 Test Loss: 0.957 Test Acc: 0.746
Validation loss decreased (-0.731875 --> -0.746367).  Saving model ...
Epoch: 63 cost time: 1.0521206855773926
Epoch: 63, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.967 Vali Acc: 0.746 Test Loss: 0.967 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.010362148284912
Epoch: 64, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.971 Vali Acc: 0.746 Test Loss: 0.971 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 1.1571524143218994
Epoch: 65, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.967 Vali Acc: 0.746 Test Loss: 0.967 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 1.4434683322906494
Epoch: 66, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.970 Vali Acc: 0.746 Test Loss: 0.970 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 1.5544965267181396
Epoch: 67, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.972 Vali Acc: 0.746 Test Loss: 0.972 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 1.325169324874878
Epoch: 68, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.970 Vali Acc: 0.761 Test Loss: 0.970 Test Acc: 0.761
Validation loss decreased (-0.746367 --> -0.760860).  Saving model ...
Epoch: 69 cost time: 0.9490821361541748
Epoch: 69, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.981 Vali Acc: 0.746 Test Loss: 0.981 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.8268945217132568
Epoch: 70, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.971 Vali Acc: 0.761 Test Loss: 0.971 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 0.9936463832855225
Epoch: 71, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.976 Vali Acc: 0.761 Test Loss: 0.976 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 1.27229905128479
Epoch: 72, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.979 Vali Acc: 0.754 Test Loss: 0.979 Test Acc: 0.754
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 1.0441663265228271
Epoch: 73, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.990 Vali Acc: 0.761 Test Loss: 0.990 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 0.9627914428710938
Epoch: 74, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.998 Vali Acc: 0.754 Test Loss: 0.998 Test Acc: 0.754
EarlyStopping counter: 6 out of 10
Epoch: 75 cost time: 1.295100450515747
Epoch: 75, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.999 Vali Acc: 0.761 Test Loss: 0.999 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 76 cost time: 1.147895097732544
Epoch: 76, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.990 Vali Acc: 0.754 Test Loss: 0.990 Test Acc: 0.754
EarlyStopping counter: 8 out of 10
Epoch: 77 cost time: 0.9480080604553223
Epoch: 77, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.998 Vali Acc: 0.754 Test Loss: 0.998 Test Acc: 0.754
EarlyStopping counter: 9 out of 10
Epoch: 78 cost time: 1.3080682754516602
Epoch: 78, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.005 Vali Acc: 0.761 Test Loss: 1.005 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm32_cs35_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.7608695652173914
model parameter : 48082
model size : 0.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm32_cs30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.719987154006958
Epoch: 1, Steps: 9 | Train Loss: 1.399 Vali Loss: 1.423 Vali Acc: 0.210 Test Loss: 1.423 Test Acc: 0.210
Validation loss decreased (inf --> -0.210131).  Saving model ...
Epoch: 2 cost time: 0.9020867347717285
Epoch: 2, Steps: 9 | Train Loss: 1.328 Vali Loss: 1.337 Vali Acc: 0.326 Test Loss: 1.337 Test Acc: 0.326
Validation loss decreased (-0.210131 --> -0.326074).  Saving model ...
Epoch: 3 cost time: 0.9405176639556885
Epoch: 3, Steps: 9 | Train Loss: 1.220 Vali Loss: 1.240 Vali Acc: 0.420 Test Loss: 1.240 Test Acc: 0.420
Validation loss decreased (-0.326074 --> -0.420277).  Saving model ...
Epoch: 4 cost time: 1.1181800365447998
Epoch: 4, Steps: 9 | Train Loss: 1.121 Vali Loss: 1.162 Vali Acc: 0.449 Test Loss: 1.162 Test Acc: 0.449
Validation loss decreased (-0.420277 --> -0.449264).  Saving model ...
Epoch: 5 cost time: 1.140704870223999
Epoch: 5, Steps: 9 | Train Loss: 1.036 Vali Loss: 1.107 Vali Acc: 0.457 Test Loss: 1.107 Test Acc: 0.457
Validation loss decreased (-0.449264 --> -0.456511).  Saving model ...
Epoch: 6 cost time: 0.9990100860595703
Epoch: 6, Steps: 9 | Train Loss: 0.958 Vali Loss: 1.078 Vali Acc: 0.478 Test Loss: 1.078 Test Acc: 0.478
Validation loss decreased (-0.456511 --> -0.478250).  Saving model ...
Epoch: 7 cost time: 1.0788040161132812
Epoch: 7, Steps: 9 | Train Loss: 0.905 Vali Loss: 1.052 Vali Acc: 0.500 Test Loss: 1.052 Test Acc: 0.500
Validation loss decreased (-0.478250 --> -0.499989).  Saving model ...
Epoch: 8 cost time: 0.910876989364624
Epoch: 8, Steps: 9 | Train Loss: 0.840 Vali Loss: 1.044 Vali Acc: 0.493 Test Loss: 1.044 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0120630264282227
Epoch: 9, Steps: 9 | Train Loss: 0.806 Vali Loss: 1.026 Vali Acc: 0.486 Test Loss: 1.026 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.770988941192627
Epoch: 10, Steps: 9 | Train Loss: 0.750 Vali Loss: 1.018 Vali Acc: 0.514 Test Loss: 1.018 Test Acc: 0.514
Validation loss decreased (-0.499989 --> -0.514483).  Saving model ...
Epoch: 11 cost time: 0.7669639587402344
Epoch: 11, Steps: 9 | Train Loss: 0.708 Vali Loss: 0.996 Vali Acc: 0.551 Test Loss: 0.996 Test Acc: 0.551
Validation loss decreased (-0.514483 --> -0.550715).  Saving model ...
Epoch: 12 cost time: 0.8834266662597656
Epoch: 12, Steps: 9 | Train Loss: 0.666 Vali Loss: 1.008 Vali Acc: 0.551 Test Loss: 1.008 Test Acc: 0.551
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0759782791137695
Epoch: 13, Steps: 9 | Train Loss: 0.630 Vali Loss: 1.012 Vali Acc: 0.543 Test Loss: 1.012 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5018000602722168
Epoch: 14, Steps: 9 | Train Loss: 0.604 Vali Loss: 1.023 Vali Acc: 0.543 Test Loss: 1.023 Test Acc: 0.543
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3313207626342773
Epoch: 15, Steps: 9 | Train Loss: 0.565 Vali Loss: 1.006 Vali Acc: 0.565 Test Loss: 1.006 Test Acc: 0.565
Validation loss decreased (-0.550715 --> -0.565207).  Saving model ...
Epoch: 16 cost time: 1.0365450382232666
Epoch: 16, Steps: 9 | Train Loss: 0.525 Vali Loss: 1.030 Vali Acc: 0.572 Test Loss: 1.030 Test Acc: 0.572
Validation loss decreased (-0.565207 --> -0.572453).  Saving model ...
Epoch: 17 cost time: 1.362551212310791
Epoch: 17, Steps: 9 | Train Loss: 0.504 Vali Loss: 1.029 Vali Acc: 0.601 Test Loss: 1.029 Test Acc: 0.601
Validation loss decreased (-0.572453 --> -0.601439).  Saving model ...
Epoch: 18 cost time: 1.0068190097808838
Epoch: 18, Steps: 9 | Train Loss: 0.473 Vali Loss: 1.054 Vali Acc: 0.587 Test Loss: 1.054 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8062276840209961
Epoch: 19, Steps: 9 | Train Loss: 0.450 Vali Loss: 1.051 Vali Acc: 0.601 Test Loss: 1.051 Test Acc: 0.601
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0108051300048828
Epoch: 20, Steps: 9 | Train Loss: 0.416 Vali Loss: 1.066 Vali Acc: 0.594 Test Loss: 1.066 Test Acc: 0.594
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.06648850440979
Epoch: 21, Steps: 9 | Train Loss: 0.397 Vali Loss: 1.071 Vali Acc: 0.601 Test Loss: 1.071 Test Acc: 0.601
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.0170304775238037
Epoch: 22, Steps: 9 | Train Loss: 0.372 Vali Loss: 1.093 Vali Acc: 0.601 Test Loss: 1.093 Test Acc: 0.601
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.9216945171356201
Epoch: 23, Steps: 9 | Train Loss: 0.352 Vali Loss: 1.098 Vali Acc: 0.594 Test Loss: 1.098 Test Acc: 0.594
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.1206932067871094
Epoch: 24, Steps: 9 | Train Loss: 0.335 Vali Loss: 1.149 Vali Acc: 0.587 Test Loss: 1.149 Test Acc: 0.587
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.0372700691223145
Epoch: 25, Steps: 9 | Train Loss: 0.311 Vali Loss: 1.135 Vali Acc: 0.587 Test Loss: 1.135 Test Acc: 0.587
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.8366758823394775
Epoch: 26, Steps: 9 | Train Loss: 0.287 Vali Loss: 1.124 Vali Acc: 0.616 Test Loss: 1.124 Test Acc: 0.616
Validation loss decreased (-0.601439 --> -0.615931).  Saving model ...
Epoch: 27 cost time: 0.7668323516845703
Epoch: 27, Steps: 9 | Train Loss: 0.271 Vali Loss: 1.137 Vali Acc: 0.616 Test Loss: 1.137 Test Acc: 0.616
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8834967613220215
Epoch: 28, Steps: 9 | Train Loss: 0.243 Vali Loss: 1.174 Vali Acc: 0.580 Test Loss: 1.174 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8300838470458984
Epoch: 29, Steps: 9 | Train Loss: 0.225 Vali Loss: 1.188 Vali Acc: 0.594 Test Loss: 1.188 Test Acc: 0.594
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.0655014514923096
Epoch: 30, Steps: 9 | Train Loss: 0.207 Vali Loss: 1.195 Vali Acc: 0.623 Test Loss: 1.195 Test Acc: 0.623
Validation loss decreased (-0.615931 --> -0.623176).  Saving model ...
Epoch: 31 cost time: 0.8672196865081787
Epoch: 31, Steps: 9 | Train Loss: 0.195 Vali Loss: 1.210 Vali Acc: 0.616 Test Loss: 1.210 Test Acc: 0.616
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0330431461334229
Epoch: 32, Steps: 9 | Train Loss: 0.179 Vali Loss: 1.209 Vali Acc: 0.601 Test Loss: 1.209 Test Acc: 0.601
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.2223186492919922
Epoch: 33, Steps: 9 | Train Loss: 0.159 Vali Loss: 1.218 Vali Acc: 0.630 Test Loss: 1.218 Test Acc: 0.630
Validation loss decreased (-0.623176 --> -0.630423).  Saving model ...
Epoch: 34 cost time: 0.9756317138671875
Epoch: 34, Steps: 9 | Train Loss: 0.139 Vali Loss: 1.246 Vali Acc: 0.638 Test Loss: 1.246 Test Acc: 0.638
Validation loss decreased (-0.630423 --> -0.637669).  Saving model ...
Epoch: 35 cost time: 0.9337904453277588
Epoch: 35, Steps: 9 | Train Loss: 0.122 Vali Loss: 1.227 Vali Acc: 0.630 Test Loss: 1.227 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.9354569911956787
Epoch: 36, Steps: 9 | Train Loss: 0.108 Vali Loss: 1.226 Vali Acc: 0.638 Test Loss: 1.226 Test Acc: 0.638
Validation loss decreased (-0.637669 --> -0.637669).  Saving model ...
Epoch: 37 cost time: 0.9194128513336182
Epoch: 37, Steps: 9 | Train Loss: 0.096 Vali Loss: 1.227 Vali Acc: 0.638 Test Loss: 1.227 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.9229409694671631
Epoch: 38, Steps: 9 | Train Loss: 0.081 Vali Loss: 1.231 Vali Acc: 0.645 Test Loss: 1.231 Test Acc: 0.645
Validation loss decreased (-0.637669 --> -0.644915).  Saving model ...
Epoch: 39 cost time: 1.184753656387329
Epoch: 39, Steps: 9 | Train Loss: 0.069 Vali Loss: 1.214 Vali Acc: 0.659 Test Loss: 1.214 Test Acc: 0.659
Validation loss decreased (-0.644915 --> -0.659408).  Saving model ...
Epoch: 40 cost time: 0.9277026653289795
Epoch: 40, Steps: 9 | Train Loss: 0.063 Vali Loss: 1.201 Vali Acc: 0.659 Test Loss: 1.201 Test Acc: 0.659
Validation loss decreased (-0.659408 --> -0.659408).  Saving model ...
Epoch: 41 cost time: 1.0726799964904785
Epoch: 41, Steps: 9 | Train Loss: 0.051 Vali Loss: 1.189 Vali Acc: 0.659 Test Loss: 1.189 Test Acc: 0.659
Validation loss decreased (-0.659408 --> -0.659408).  Saving model ...
Epoch: 42 cost time: 1.1478145122528076
Epoch: 42, Steps: 9 | Train Loss: 0.047 Vali Loss: 1.163 Vali Acc: 0.659 Test Loss: 1.163 Test Acc: 0.659
Validation loss decreased (-0.659408 --> -0.659409).  Saving model ...
Epoch: 43 cost time: 1.053816795349121
Epoch: 43, Steps: 9 | Train Loss: 0.037 Vali Loss: 1.166 Vali Acc: 0.667 Test Loss: 1.166 Test Acc: 0.667
Validation loss decreased (-0.659409 --> -0.666655).  Saving model ...
Epoch: 44 cost time: 1.1490473747253418
Epoch: 44, Steps: 9 | Train Loss: 0.033 Vali Loss: 1.155 Vali Acc: 0.659 Test Loss: 1.155 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.319596767425537
Epoch: 45, Steps: 9 | Train Loss: 0.029 Vali Loss: 1.157 Vali Acc: 0.659 Test Loss: 1.157 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.9107863903045654
Epoch: 46, Steps: 9 | Train Loss: 0.024 Vali Loss: 1.142 Vali Acc: 0.667 Test Loss: 1.142 Test Acc: 0.667
Validation loss decreased (-0.666655 --> -0.666655).  Saving model ...
Epoch: 47 cost time: 0.8826231956481934
Epoch: 47, Steps: 9 | Train Loss: 0.022 Vali Loss: 1.141 Vali Acc: 0.667 Test Loss: 1.141 Test Acc: 0.667
Validation loss decreased (-0.666655 --> -0.666655).  Saving model ...
Epoch: 48 cost time: 0.9495162963867188
Epoch: 48, Steps: 9 | Train Loss: 0.019 Vali Loss: 1.114 Vali Acc: 0.681 Test Loss: 1.114 Test Acc: 0.681
Validation loss decreased (-0.666655 --> -0.681148).  Saving model ...
Epoch: 49 cost time: 0.956946611404419
Epoch: 49, Steps: 9 | Train Loss: 0.018 Vali Loss: 1.112 Vali Acc: 0.681 Test Loss: 1.112 Test Acc: 0.681
Validation loss decreased (-0.681148 --> -0.681148).  Saving model ...
Epoch: 50 cost time: 1.2032439708709717
Epoch: 50, Steps: 9 | Train Loss: 0.016 Vali Loss: 1.106 Vali Acc: 0.681 Test Loss: 1.106 Test Acc: 0.681
Validation loss decreased (-0.681148 --> -0.681148).  Saving model ...
Epoch: 51 cost time: 0.881157636642456
Epoch: 51, Steps: 9 | Train Loss: 0.013 Vali Loss: 1.100 Vali Acc: 0.688 Test Loss: 1.100 Test Acc: 0.688
Validation loss decreased (-0.681148 --> -0.688395).  Saving model ...
Epoch: 52 cost time: 1.165581226348877
Epoch: 52, Steps: 9 | Train Loss: 0.012 Vali Loss: 1.091 Vali Acc: 0.688 Test Loss: 1.091 Test Acc: 0.688
Validation loss decreased (-0.688395 --> -0.688395).  Saving model ...
Epoch: 53 cost time: 1.094874382019043
Epoch: 53, Steps: 9 | Train Loss: 0.011 Vali Loss: 1.086 Vali Acc: 0.688 Test Loss: 1.086 Test Acc: 0.688
Validation loss decreased (-0.688395 --> -0.688395).  Saving model ...
Epoch: 54 cost time: 1.115126132965088
Epoch: 54, Steps: 9 | Train Loss: 0.010 Vali Loss: 1.076 Vali Acc: 0.688 Test Loss: 1.076 Test Acc: 0.688
Validation loss decreased (-0.688395 --> -0.688395).  Saving model ...
Epoch: 55 cost time: 1.5011086463928223
Epoch: 55, Steps: 9 | Train Loss: 0.009 Vali Loss: 1.079 Vali Acc: 0.688 Test Loss: 1.079 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.0732016563415527
Epoch: 56, Steps: 9 | Train Loss: 0.008 Vali Loss: 1.076 Vali Acc: 0.688 Test Loss: 1.076 Test Acc: 0.688
Validation loss decreased (-0.688395 --> -0.688395).  Saving model ...
Epoch: 57 cost time: 1.0694072246551514
Epoch: 57, Steps: 9 | Train Loss: 0.008 Vali Loss: 1.072 Vali Acc: 0.688 Test Loss: 1.072 Test Acc: 0.688
Validation loss decreased (-0.688395 --> -0.688395).  Saving model ...
Epoch: 58 cost time: 1.4479520320892334
Epoch: 58, Steps: 9 | Train Loss: 0.007 Vali Loss: 1.065 Vali Acc: 0.710 Test Loss: 1.065 Test Acc: 0.710
Validation loss decreased (-0.688395 --> -0.710134).  Saving model ...
Epoch: 59 cost time: 1.174393653869629
Epoch: 59, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.060 Vali Acc: 0.703 Test Loss: 1.060 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.9457600116729736
Epoch: 60, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.053 Vali Acc: 0.710 Test Loss: 1.053 Test Acc: 0.710
Validation loss decreased (-0.710134 --> -0.710134).  Saving model ...
Epoch: 61 cost time: 0.7825772762298584
Epoch: 61, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.050 Vali Acc: 0.717 Test Loss: 1.050 Test Acc: 0.717
Validation loss decreased (-0.710134 --> -0.717381).  Saving model ...
Epoch: 62 cost time: 1.2326140403747559
Epoch: 62, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.047 Vali Acc: 0.717 Test Loss: 1.047 Test Acc: 0.717
Validation loss decreased (-0.717381 --> -0.717381).  Saving model ...
Epoch: 63 cost time: 1.003248691558838
Epoch: 63, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.038 Vali Acc: 0.725 Test Loss: 1.038 Test Acc: 0.725
Validation loss decreased (-0.717381 --> -0.724627).  Saving model ...
Epoch: 64 cost time: 1.4574847221374512
Epoch: 64, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.032 Vali Acc: 0.725 Test Loss: 1.032 Test Acc: 0.725
Validation loss decreased (-0.724627 --> -0.724627).  Saving model ...
Epoch: 65 cost time: 1.019409418106079
Epoch: 65, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.033 Vali Acc: 0.725 Test Loss: 1.033 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 1.4265153408050537
Epoch: 66, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.032 Vali Acc: 0.725 Test Loss: 1.032 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 1.2558178901672363
Epoch: 67, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.029 Vali Acc: 0.725 Test Loss: 1.029 Test Acc: 0.725
Validation loss decreased (-0.724627 --> -0.724627).  Saving model ...
Epoch: 68 cost time: 1.2417080402374268
Epoch: 68, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.017 Vali Acc: 0.732 Test Loss: 1.017 Test Acc: 0.732
Validation loss decreased (-0.724627 --> -0.731874).  Saving model ...
Epoch: 69 cost time: 0.9821124076843262
Epoch: 69, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.013 Vali Acc: 0.739 Test Loss: 1.013 Test Acc: 0.739
Validation loss decreased (-0.731874 --> -0.739120).  Saving model ...
Epoch: 70 cost time: 1.3534111976623535
Epoch: 70, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.012 Vali Acc: 0.739 Test Loss: 1.012 Test Acc: 0.739
Validation loss decreased (-0.739120 --> -0.739120).  Saving model ...
Epoch: 71 cost time: 0.9149956703186035
Epoch: 71, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.012 Vali Acc: 0.746 Test Loss: 1.012 Test Acc: 0.746
Validation loss decreased (-0.739120 --> -0.746367).  Saving model ...
Epoch: 72 cost time: 1.1226952075958252
Epoch: 72, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.011 Vali Acc: 0.746 Test Loss: 1.011 Test Acc: 0.746
Validation loss decreased (-0.746367 --> -0.746367).  Saving model ...
Epoch: 73 cost time: 1.363306999206543
Epoch: 73, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.013 Vali Acc: 0.746 Test Loss: 1.013 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 1.1931202411651611
Epoch: 74, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.006 Vali Acc: 0.746 Test Loss: 1.006 Test Acc: 0.746
Validation loss decreased (-0.746367 --> -0.746367).  Saving model ...
Epoch: 75 cost time: 1.017773151397705
Epoch: 75, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.005 Vali Acc: 0.746 Test Loss: 1.005 Test Acc: 0.746
Validation loss decreased (-0.746367 --> -0.746367).  Saving model ...
Epoch: 76 cost time: 1.039280652999878
Epoch: 76, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.004 Vali Acc: 0.754 Test Loss: 1.004 Test Acc: 0.754
Validation loss decreased (-0.746367 --> -0.753613).  Saving model ...
Epoch: 77 cost time: 0.8093442916870117
Epoch: 77, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.001 Vali Acc: 0.754 Test Loss: 1.001 Test Acc: 0.754
Validation loss decreased (-0.753613 --> -0.753613).  Saving model ...
Epoch: 78 cost time: 1.1518032550811768
Epoch: 78, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.000 Vali Acc: 0.754 Test Loss: 1.000 Test Acc: 0.754
Validation loss decreased (-0.753613 --> -0.753613).  Saving model ...
Epoch: 79 cost time: 0.9785623550415039
Epoch: 79, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.994 Vali Acc: 0.754 Test Loss: 0.994 Test Acc: 0.754
Validation loss decreased (-0.753613 --> -0.753613).  Saving model ...
Epoch: 80 cost time: 1.0602385997772217
Epoch: 80, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.991 Vali Acc: 0.754 Test Loss: 0.991 Test Acc: 0.754
Validation loss decreased (-0.753613 --> -0.753613).  Saving model ...
Epoch: 81 cost time: 1.152688980102539
Epoch: 81, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.992 Vali Acc: 0.761 Test Loss: 0.992 Test Acc: 0.761
Validation loss decreased (-0.753613 --> -0.760860).  Saving model ...
Epoch: 82 cost time: 1.128248691558838
Epoch: 82, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.992 Vali Acc: 0.761 Test Loss: 0.992 Test Acc: 0.761
Validation loss decreased (-0.760860 --> -0.760860).  Saving model ...
Epoch: 83 cost time: 1.506531000137329
Epoch: 83, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.990 Vali Acc: 0.761 Test Loss: 0.990 Test Acc: 0.761
Validation loss decreased (-0.760860 --> -0.760860).  Saving model ...
Epoch: 84 cost time: 1.0511300563812256
Epoch: 84, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.986 Vali Acc: 0.761 Test Loss: 0.986 Test Acc: 0.761
Validation loss decreased (-0.760860 --> -0.760860).  Saving model ...
Epoch: 85 cost time: 1.1043922901153564
Epoch: 85, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.984 Vali Acc: 0.761 Test Loss: 0.984 Test Acc: 0.761
Validation loss decreased (-0.760860 --> -0.760860).  Saving model ...
Epoch: 86 cost time: 1.0389461517333984
Epoch: 86, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.987 Vali Acc: 0.761 Test Loss: 0.987 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 1.162539005279541
Epoch: 87, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.983 Vali Acc: 0.768 Test Loss: 0.983 Test Acc: 0.768
Validation loss decreased (-0.760860 --> -0.768106).  Saving model ...
Epoch: 88 cost time: 1.018172025680542
Epoch: 88, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.980 Vali Acc: 0.768 Test Loss: 0.980 Test Acc: 0.768
Validation loss decreased (-0.768106 --> -0.768106).  Saving model ...
Epoch: 89 cost time: 1.1894636154174805
Epoch: 89, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.980 Vali Acc: 0.775 Test Loss: 0.980 Test Acc: 0.775
Validation loss decreased (-0.768106 --> -0.775353).  Saving model ...
Epoch: 90 cost time: 1.038001298904419
Epoch: 90, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.979 Vali Acc: 0.775 Test Loss: 0.979 Test Acc: 0.775
Validation loss decreased (-0.775353 --> -0.775353).  Saving model ...
Epoch: 91 cost time: 1.1161038875579834
Epoch: 91, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.978 Vali Acc: 0.775 Test Loss: 0.978 Test Acc: 0.775
Validation loss decreased (-0.775353 --> -0.775353).  Saving model ...
Epoch: 92 cost time: 0.9985756874084473
Epoch: 92, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.976 Vali Acc: 0.775 Test Loss: 0.976 Test Acc: 0.775
Validation loss decreased (-0.775353 --> -0.775353).  Saving model ...
Epoch: 93 cost time: 0.9606814384460449
Epoch: 93, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.976 Vali Acc: 0.775 Test Loss: 0.976 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 1.1051733493804932
Epoch: 94, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.979 Vali Acc: 0.783 Test Loss: 0.979 Test Acc: 0.783
Validation loss decreased (-0.775353 --> -0.782599).  Saving model ...
Epoch: 95 cost time: 1.4198484420776367
Epoch: 95, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.977 Vali Acc: 0.783 Test Loss: 0.977 Test Acc: 0.783
Validation loss decreased (-0.782599 --> -0.782599).  Saving model ...
Epoch: 96 cost time: 1.1428701877593994
Epoch: 96, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.979 Vali Acc: 0.783 Test Loss: 0.979 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 1.363938808441162
Epoch: 97, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.977 Vali Acc: 0.783 Test Loss: 0.977 Test Acc: 0.783
Validation loss decreased (-0.782599 --> -0.782599).  Saving model ...
Epoch: 98 cost time: 1.373091220855713
Epoch: 98, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.976 Vali Acc: 0.790 Test Loss: 0.976 Test Acc: 0.790
Validation loss decreased (-0.782599 --> -0.789845).  Saving model ...
Epoch: 99 cost time: 1.2839596271514893
Epoch: 99, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.977 Vali Acc: 0.790 Test Loss: 0.977 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 100 cost time: 1.643988847732544
Epoch: 100, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.975 Vali Acc: 0.797 Test Loss: 0.975 Test Acc: 0.797
Validation loss decreased (-0.789845 --> -0.797092).  Saving model ...
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm32_cs30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.7971014492753623
model parameter : 48032
model size : 0.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm32_cs26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.7101550102233887
Epoch: 1, Steps: 9 | Train Loss: 1.397 Vali Loss: 1.409 Vali Acc: 0.196 Test Loss: 1.409 Test Acc: 0.196
Validation loss decreased (inf --> -0.195638).  Saving model ...
Epoch: 2 cost time: 1.0635826587677002
Epoch: 2, Steps: 9 | Train Loss: 1.328 Vali Loss: 1.338 Vali Acc: 0.290 Test Loss: 1.338 Test Acc: 0.290
Validation loss decreased (-0.195638 --> -0.289842).  Saving model ...
Epoch: 3 cost time: 1.2204127311706543
Epoch: 3, Steps: 9 | Train Loss: 1.239 Vali Loss: 1.251 Vali Acc: 0.362 Test Loss: 1.251 Test Acc: 0.362
Validation loss decreased (-0.289842 --> -0.362306).  Saving model ...
Epoch: 4 cost time: 0.7865231037139893
Epoch: 4, Steps: 9 | Train Loss: 1.137 Vali Loss: 1.183 Vali Acc: 0.406 Test Loss: 1.183 Test Acc: 0.406
Validation loss decreased (-0.362306 --> -0.405785).  Saving model ...
Epoch: 5 cost time: 0.8658430576324463
Epoch: 5, Steps: 9 | Train Loss: 1.050 Vali Loss: 1.128 Vali Acc: 0.500 Test Loss: 1.128 Test Acc: 0.500
Validation loss decreased (-0.405785 --> -0.499989).  Saving model ...
Epoch: 6 cost time: 1.009171485900879
Epoch: 6, Steps: 9 | Train Loss: 0.976 Vali Loss: 1.098 Vali Acc: 0.464 Test Loss: 1.098 Test Acc: 0.464
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.998462438583374
Epoch: 7, Steps: 9 | Train Loss: 0.926 Vali Loss: 1.070 Vali Acc: 0.478 Test Loss: 1.070 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.959092378616333
Epoch: 8, Steps: 9 | Train Loss: 0.853 Vali Loss: 1.063 Vali Acc: 0.493 Test Loss: 1.063 Test Acc: 0.493
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1992268562316895
Epoch: 9, Steps: 9 | Train Loss: 0.812 Vali Loss: 1.040 Vali Acc: 0.493 Test Loss: 1.040 Test Acc: 0.493
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.8428404331207275
Epoch: 10, Steps: 9 | Train Loss: 0.765 Vali Loss: 1.026 Vali Acc: 0.471 Test Loss: 1.026 Test Acc: 0.471
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0912857055664062
Epoch: 11, Steps: 9 | Train Loss: 0.724 Vali Loss: 1.021 Vali Acc: 0.514 Test Loss: 1.021 Test Acc: 0.514
Validation loss decreased (-0.499989 --> -0.514483).  Saving model ...
Epoch: 12 cost time: 0.7877509593963623
Epoch: 12, Steps: 9 | Train Loss: 0.695 Vali Loss: 1.021 Vali Acc: 0.558 Test Loss: 1.021 Test Acc: 0.558
Validation loss decreased (-0.514483 --> -0.557961).  Saving model ...
Epoch: 13 cost time: 0.8466956615447998
Epoch: 13, Steps: 9 | Train Loss: 0.661 Vali Loss: 1.017 Vali Acc: 0.551 Test Loss: 1.017 Test Acc: 0.551
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.933931827545166
Epoch: 14, Steps: 9 | Train Loss: 0.619 Vali Loss: 0.998 Vali Acc: 0.536 Test Loss: 0.998 Test Acc: 0.536
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9902539253234863
Epoch: 15, Steps: 9 | Train Loss: 0.596 Vali Loss: 1.011 Vali Acc: 0.543 Test Loss: 1.011 Test Acc: 0.543
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0670928955078125
Epoch: 16, Steps: 9 | Train Loss: 0.544 Vali Loss: 1.016 Vali Acc: 0.572 Test Loss: 1.016 Test Acc: 0.572
Validation loss decreased (-0.557961 --> -0.572454).  Saving model ...
Epoch: 17 cost time: 0.9760425090789795
Epoch: 17, Steps: 9 | Train Loss: 0.507 Vali Loss: 1.020 Vali Acc: 0.572 Test Loss: 1.020 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.210336446762085
Epoch: 18, Steps: 9 | Train Loss: 0.477 Vali Loss: 1.013 Vali Acc: 0.623 Test Loss: 1.013 Test Acc: 0.623
Validation loss decreased (-0.572454 --> -0.623178).  Saving model ...
Epoch: 19 cost time: 1.1467318534851074
Epoch: 19, Steps: 9 | Train Loss: 0.441 Vali Loss: 1.019 Vali Acc: 0.594 Test Loss: 1.019 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0515501499176025
Epoch: 20, Steps: 9 | Train Loss: 0.410 Vali Loss: 1.020 Vali Acc: 0.609 Test Loss: 1.020 Test Acc: 0.609
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3769304752349854
Epoch: 21, Steps: 9 | Train Loss: 0.385 Vali Loss: 1.011 Vali Acc: 0.630 Test Loss: 1.011 Test Acc: 0.630
Validation loss decreased (-0.623178 --> -0.630425).  Saving model ...
Epoch: 22 cost time: 0.9616599082946777
Epoch: 22, Steps: 9 | Train Loss: 0.354 Vali Loss: 0.989 Vali Acc: 0.616 Test Loss: 0.989 Test Acc: 0.616
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8547015190124512
Epoch: 23, Steps: 9 | Train Loss: 0.310 Vali Loss: 0.994 Vali Acc: 0.630 Test Loss: 0.994 Test Acc: 0.630
Validation loss decreased (-0.630425 --> -0.630425).  Saving model ...
Epoch: 24 cost time: 0.8506386280059814
Epoch: 24, Steps: 9 | Train Loss: 0.281 Vali Loss: 0.940 Vali Acc: 0.659 Test Loss: 0.940 Test Acc: 0.659
Validation loss decreased (-0.630425 --> -0.659411).  Saving model ...
Epoch: 25 cost time: 0.9456276893615723
Epoch: 25, Steps: 9 | Train Loss: 0.231 Vali Loss: 0.921 Vali Acc: 0.652 Test Loss: 0.921 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.988271951675415
Epoch: 26, Steps: 9 | Train Loss: 0.196 Vali Loss: 0.889 Vali Acc: 0.645 Test Loss: 0.889 Test Acc: 0.645
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.292173147201538
Epoch: 27, Steps: 9 | Train Loss: 0.175 Vali Loss: 0.859 Vali Acc: 0.652 Test Loss: 0.859 Test Acc: 0.652
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9817373752593994
Epoch: 28, Steps: 9 | Train Loss: 0.151 Vali Loss: 0.848 Vali Acc: 0.667 Test Loss: 0.848 Test Acc: 0.667
Validation loss decreased (-0.659411 --> -0.666658).  Saving model ...
Epoch: 29 cost time: 0.8419201374053955
Epoch: 29, Steps: 9 | Train Loss: 0.131 Vali Loss: 0.846 Vali Acc: 0.681 Test Loss: 0.846 Test Acc: 0.681
Validation loss decreased (-0.666658 --> -0.681151).  Saving model ...
Epoch: 30 cost time: 1.0017850399017334
Epoch: 30, Steps: 9 | Train Loss: 0.116 Vali Loss: 0.832 Vali Acc: 0.696 Test Loss: 0.832 Test Acc: 0.696
Validation loss decreased (-0.681151 --> -0.695644).  Saving model ...
Epoch: 31 cost time: 1.027634859085083
Epoch: 31, Steps: 9 | Train Loss: 0.107 Vali Loss: 0.833 Vali Acc: 0.703 Test Loss: 0.833 Test Acc: 0.703
Validation loss decreased (-0.695644 --> -0.702890).  Saving model ...
Epoch: 32 cost time: 1.0569932460784912
Epoch: 32, Steps: 9 | Train Loss: 0.095 Vali Loss: 0.843 Vali Acc: 0.696 Test Loss: 0.843 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9225211143493652
Epoch: 33, Steps: 9 | Train Loss: 0.087 Vali Loss: 0.836 Vali Acc: 0.703 Test Loss: 0.836 Test Acc: 0.703
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.0976567268371582
Epoch: 34, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.836 Vali Acc: 0.696 Test Loss: 0.836 Test Acc: 0.696
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.1091604232788086
Epoch: 35, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.832 Vali Acc: 0.710 Test Loss: 0.832 Test Acc: 0.710
Validation loss decreased (-0.702890 --> -0.710137).  Saving model ...
Epoch: 36 cost time: 0.7767343521118164
Epoch: 36, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.838 Vali Acc: 0.717 Test Loss: 0.838 Test Acc: 0.717
Validation loss decreased (-0.710137 --> -0.717383).  Saving model ...
Epoch: 37 cost time: 0.8340775966644287
Epoch: 37, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.846 Vali Acc: 0.717 Test Loss: 0.846 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.8417370319366455
Epoch: 38, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.850 Vali Acc: 0.717 Test Loss: 0.850 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.9586460590362549
Epoch: 39, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.862 Vali Acc: 0.717 Test Loss: 0.862 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.0050995349884033
Epoch: 40, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.859 Vali Acc: 0.717 Test Loss: 0.859 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.8956117630004883
Epoch: 41, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.857 Vali Acc: 0.717 Test Loss: 0.857 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.1343345642089844
Epoch: 42, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.876 Vali Acc: 0.717 Test Loss: 0.876 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.8637580871582031
Epoch: 43, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.885 Vali Acc: 0.717 Test Loss: 0.885 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.8020274639129639
Epoch: 44, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.877 Vali Acc: 0.725 Test Loss: 0.877 Test Acc: 0.725
Validation loss decreased (-0.717383 --> -0.724629).  Saving model ...
Epoch: 45 cost time: 0.8989853858947754
Epoch: 45, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.878 Vali Acc: 0.725 Test Loss: 0.878 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.9590573310852051
Epoch: 46, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.890 Vali Acc: 0.725 Test Loss: 0.890 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.9307770729064941
Epoch: 47, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.902 Vali Acc: 0.725 Test Loss: 0.902 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.104219913482666
Epoch: 48, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.907 Vali Acc: 0.725 Test Loss: 0.907 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.9606959819793701
Epoch: 49, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.911 Vali Acc: 0.725 Test Loss: 0.911 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.1068780422210693
Epoch: 50, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.916 Vali Acc: 0.725 Test Loss: 0.916 Test Acc: 0.725
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.0080270767211914
Epoch: 51, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.921 Vali Acc: 0.725 Test Loss: 0.921 Test Acc: 0.725
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 0.9671008586883545
Epoch: 52, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.922 Vali Acc: 0.725 Test Loss: 0.922 Test Acc: 0.725
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 1.0744421482086182
Epoch: 53, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.918 Vali Acc: 0.732 Test Loss: 0.918 Test Acc: 0.732
Validation loss decreased (-0.724629 --> -0.731875).  Saving model ...
Epoch: 54 cost time: 1.457876205444336
Epoch: 54, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.931 Vali Acc: 0.732 Test Loss: 0.931 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.059128999710083
Epoch: 55, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.942 Vali Acc: 0.725 Test Loss: 0.942 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.2185053825378418
Epoch: 56, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.939 Vali Acc: 0.739 Test Loss: 0.939 Test Acc: 0.739
Validation loss decreased (-0.731875 --> -0.739121).  Saving model ...
Epoch: 57 cost time: 0.964425802230835
Epoch: 57, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.944 Vali Acc: 0.732 Test Loss: 0.944 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.087754249572754
Epoch: 58, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.950 Vali Acc: 0.732 Test Loss: 0.950 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.3516037464141846
Epoch: 59, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.964 Vali Acc: 0.732 Test Loss: 0.964 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 1.1160342693328857
Epoch: 60, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.965 Vali Acc: 0.732 Test Loss: 0.965 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 0.8814501762390137
Epoch: 61, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.967 Vali Acc: 0.732 Test Loss: 0.967 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 1.3254077434539795
Epoch: 62, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.969 Vali Acc: 0.739 Test Loss: 0.969 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 0.8445723056793213
Epoch: 63, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.975 Vali Acc: 0.739 Test Loss: 0.975 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 0.9581866264343262
Epoch: 64, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.979 Vali Acc: 0.739 Test Loss: 0.979 Test Acc: 0.739
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 1.1712167263031006
Epoch: 65, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.994 Vali Acc: 0.732 Test Loss: 0.994 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 1.1880953311920166
Epoch: 66, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.990 Vali Acc: 0.739 Test Loss: 0.990 Test Acc: 0.739
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm32_cs26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.7391304347826086
model parameter : 47590
model size : 0.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm32_cs23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.411064624786377
Epoch: 1, Steps: 9 | Train Loss: 1.412 Vali Loss: 1.345 Vali Acc: 0.333 Test Loss: 1.345 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 1.0138828754425049
Epoch: 2, Steps: 9 | Train Loss: 1.348 Vali Loss: 1.281 Vali Acc: 0.384 Test Loss: 1.281 Test Acc: 0.384
Validation loss decreased (-0.333320 --> -0.384045).  Saving model ...
Epoch: 3 cost time: 0.7737722396850586
Epoch: 3, Steps: 9 | Train Loss: 1.255 Vali Loss: 1.221 Vali Acc: 0.377 Test Loss: 1.221 Test Acc: 0.377
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.180814504623413
Epoch: 4, Steps: 9 | Train Loss: 1.158 Vali Loss: 1.164 Vali Acc: 0.442 Test Loss: 1.164 Test Acc: 0.442
Validation loss decreased (-0.384045 --> -0.442017).  Saving model ...
Epoch: 5 cost time: 1.181063175201416
Epoch: 5, Steps: 9 | Train Loss: 1.085 Vali Loss: 1.126 Vali Acc: 0.442 Test Loss: 1.126 Test Acc: 0.442
Validation loss decreased (-0.442017 --> -0.442018).  Saving model ...
Epoch: 6 cost time: 0.9788393974304199
Epoch: 6, Steps: 9 | Train Loss: 0.984 Vali Loss: 1.095 Vali Acc: 0.457 Test Loss: 1.095 Test Acc: 0.457
Validation loss decreased (-0.442018 --> -0.456511).  Saving model ...
Epoch: 7 cost time: 1.1017560958862305
Epoch: 7, Steps: 9 | Train Loss: 0.911 Vali Loss: 1.064 Vali Acc: 0.464 Test Loss: 1.064 Test Acc: 0.464
Validation loss decreased (-0.456511 --> -0.463757).  Saving model ...
Epoch: 8 cost time: 1.055915355682373
Epoch: 8, Steps: 9 | Train Loss: 0.854 Vali Loss: 1.046 Vali Acc: 0.471 Test Loss: 1.046 Test Acc: 0.471
Validation loss decreased (-0.463757 --> -0.471004).  Saving model ...
Epoch: 9 cost time: 0.885955810546875
Epoch: 9, Steps: 9 | Train Loss: 0.818 Vali Loss: 1.023 Vali Acc: 0.500 Test Loss: 1.023 Test Acc: 0.500
Validation loss decreased (-0.471004 --> -0.499990).  Saving model ...
Epoch: 10 cost time: 1.2067084312438965
Epoch: 10, Steps: 9 | Train Loss: 0.761 Vali Loss: 1.023 Vali Acc: 0.514 Test Loss: 1.023 Test Acc: 0.514
Validation loss decreased (-0.499990 --> -0.514483).  Saving model ...
Epoch: 11 cost time: 0.8862018585205078
Epoch: 11, Steps: 9 | Train Loss: 0.710 Vali Loss: 1.008 Vali Acc: 0.543 Test Loss: 1.008 Test Acc: 0.543
Validation loss decreased (-0.514483 --> -0.543468).  Saving model ...
Epoch: 12 cost time: 1.1789629459381104
Epoch: 12, Steps: 9 | Train Loss: 0.678 Vali Loss: 1.006 Vali Acc: 0.558 Test Loss: 1.006 Test Acc: 0.558
Validation loss decreased (-0.543468 --> -0.557961).  Saving model ...
Epoch: 13 cost time: 1.1768584251403809
Epoch: 13, Steps: 9 | Train Loss: 0.643 Vali Loss: 0.984 Vali Acc: 0.587 Test Loss: 0.984 Test Acc: 0.587
Validation loss decreased (-0.557961 --> -0.586947).  Saving model ...
Epoch: 14 cost time: 0.9334757328033447
Epoch: 14, Steps: 9 | Train Loss: 0.600 Vali Loss: 0.986 Vali Acc: 0.594 Test Loss: 0.986 Test Acc: 0.594
Validation loss decreased (-0.586947 --> -0.594193).  Saving model ...
Epoch: 15 cost time: 1.0269856452941895
Epoch: 15, Steps: 9 | Train Loss: 0.560 Vali Loss: 0.992 Vali Acc: 0.543 Test Loss: 0.992 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9695954322814941
Epoch: 16, Steps: 9 | Train Loss: 0.531 Vali Loss: 0.988 Vali Acc: 0.543 Test Loss: 0.988 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9243655204772949
Epoch: 17, Steps: 9 | Train Loss: 0.463 Vali Loss: 0.951 Vali Acc: 0.623 Test Loss: 0.951 Test Acc: 0.623
Validation loss decreased (-0.594193 --> -0.623179).  Saving model ...
Epoch: 18 cost time: 1.0365355014801025
Epoch: 18, Steps: 9 | Train Loss: 0.436 Vali Loss: 0.935 Vali Acc: 0.616 Test Loss: 0.935 Test Acc: 0.616
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0936527252197266
Epoch: 19, Steps: 9 | Train Loss: 0.390 Vali Loss: 0.925 Vali Acc: 0.623 Test Loss: 0.925 Test Acc: 0.623
Validation loss decreased (-0.623179 --> -0.623179).  Saving model ...
Epoch: 20 cost time: 1.0468859672546387
Epoch: 20, Steps: 9 | Train Loss: 0.347 Vali Loss: 0.900 Vali Acc: 0.638 Test Loss: 0.900 Test Acc: 0.638
Validation loss decreased (-0.623179 --> -0.637672).  Saving model ...
Epoch: 21 cost time: 1.0875725746154785
Epoch: 21, Steps: 9 | Train Loss: 0.307 Vali Loss: 0.874 Vali Acc: 0.659 Test Loss: 0.874 Test Acc: 0.659
Validation loss decreased (-0.637672 --> -0.659412).  Saving model ...
Epoch: 22 cost time: 1.1209211349487305
Epoch: 22, Steps: 9 | Train Loss: 0.263 Vali Loss: 0.839 Vali Acc: 0.667 Test Loss: 0.839 Test Acc: 0.667
Validation loss decreased (-0.659412 --> -0.666658).  Saving model ...
Epoch: 23 cost time: 0.987468957901001
Epoch: 23, Steps: 9 | Train Loss: 0.231 Vali Loss: 0.804 Vali Acc: 0.681 Test Loss: 0.804 Test Acc: 0.681
Validation loss decreased (-0.666658 --> -0.681151).  Saving model ...
Epoch: 24 cost time: 0.780653715133667
Epoch: 24, Steps: 9 | Train Loss: 0.193 Vali Loss: 0.780 Vali Acc: 0.696 Test Loss: 0.780 Test Acc: 0.696
Validation loss decreased (-0.681151 --> -0.695644).  Saving model ...
Epoch: 25 cost time: 0.8660500049591064
Epoch: 25, Steps: 9 | Train Loss: 0.167 Vali Loss: 0.759 Vali Acc: 0.703 Test Loss: 0.759 Test Acc: 0.703
Validation loss decreased (-0.695644 --> -0.702891).  Saving model ...
Epoch: 26 cost time: 0.8063478469848633
Epoch: 26, Steps: 9 | Train Loss: 0.152 Vali Loss: 0.751 Vali Acc: 0.717 Test Loss: 0.751 Test Acc: 0.717
Validation loss decreased (-0.702891 --> -0.717384).  Saving model ...
Epoch: 27 cost time: 0.8251140117645264
Epoch: 27, Steps: 9 | Train Loss: 0.130 Vali Loss: 0.737 Vali Acc: 0.725 Test Loss: 0.737 Test Acc: 0.725
Validation loss decreased (-0.717384 --> -0.724630).  Saving model ...
Epoch: 28 cost time: 1.1446919441223145
Epoch: 28, Steps: 9 | Train Loss: 0.111 Vali Loss: 0.731 Vali Acc: 0.732 Test Loss: 0.731 Test Acc: 0.732
Validation loss decreased (-0.724630 --> -0.731877).  Saving model ...
Epoch: 29 cost time: 1.1929221153259277
Epoch: 29, Steps: 9 | Train Loss: 0.100 Vali Loss: 0.731 Vali Acc: 0.732 Test Loss: 0.731 Test Acc: 0.732
Validation loss decreased (-0.731877 --> -0.731877).  Saving model ...
Epoch: 30 cost time: 0.9394083023071289
Epoch: 30, Steps: 9 | Train Loss: 0.089 Vali Loss: 0.733 Vali Acc: 0.732 Test Loss: 0.733 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.2710566520690918
Epoch: 31, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.736 Vali Acc: 0.739 Test Loss: 0.736 Test Acc: 0.739
Validation loss decreased (-0.731877 --> -0.739123).  Saving model ...
Epoch: 32 cost time: 0.9361670017242432
Epoch: 32, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.733 Vali Acc: 0.732 Test Loss: 0.733 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9679238796234131
Epoch: 33, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.736 Vali Acc: 0.732 Test Loss: 0.736 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.2508771419525146
Epoch: 34, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.746 Vali Acc: 0.725 Test Loss: 0.746 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.9101502895355225
Epoch: 35, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.748 Vali Acc: 0.725 Test Loss: 0.748 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.7597410678863525
Epoch: 36, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.749 Vali Acc: 0.725 Test Loss: 0.749 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.0942039489746094
Epoch: 37, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.751 Vali Acc: 0.732 Test Loss: 0.751 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.077472448348999
Epoch: 38, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.760 Vali Acc: 0.732 Test Loss: 0.760 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.9370083808898926
Epoch: 39, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.756 Vali Acc: 0.746 Test Loss: 0.756 Test Acc: 0.746
Validation loss decreased (-0.739123 --> -0.746369).  Saving model ...
Epoch: 40 cost time: 0.8771986961364746
Epoch: 40, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.762 Vali Acc: 0.746 Test Loss: 0.762 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.8640546798706055
Epoch: 41, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.756 Vali Acc: 0.754 Test Loss: 0.756 Test Acc: 0.754
Validation loss decreased (-0.746369 --> -0.753616).  Saving model ...
Epoch: 42 cost time: 0.942192554473877
Epoch: 42, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.768 Vali Acc: 0.754 Test Loss: 0.768 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.9860360622406006
Epoch: 43, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.773 Vali Acc: 0.754 Test Loss: 0.773 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.1390695571899414
Epoch: 44, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.779 Vali Acc: 0.754 Test Loss: 0.779 Test Acc: 0.754
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.9356341361999512
Epoch: 45, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.776 Vali Acc: 0.761 Test Loss: 0.776 Test Acc: 0.761
Validation loss decreased (-0.753616 --> -0.760862).  Saving model ...
Epoch: 46 cost time: 1.0358452796936035
Epoch: 46, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.775 Vali Acc: 0.761 Test Loss: 0.775 Test Acc: 0.761
Validation loss decreased (-0.760862 --> -0.760862).  Saving model ...
Epoch: 47 cost time: 1.1827948093414307
Epoch: 47, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.785 Vali Acc: 0.761 Test Loss: 0.785 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.1828854084014893
Epoch: 48, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.789 Vali Acc: 0.761 Test Loss: 0.789 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.0768251419067383
Epoch: 49, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.788 Vali Acc: 0.761 Test Loss: 0.788 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.0430059432983398
Epoch: 50, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.792 Vali Acc: 0.761 Test Loss: 0.792 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.4114618301391602
Epoch: 51, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.802 Vali Acc: 0.768 Test Loss: 0.802 Test Acc: 0.768
Validation loss decreased (-0.760862 --> -0.768108).  Saving model ...
Epoch: 52 cost time: 1.2039892673492432
Epoch: 52, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.805 Vali Acc: 0.768 Test Loss: 0.805 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.1821370124816895
Epoch: 53, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.804 Vali Acc: 0.768 Test Loss: 0.804 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.0606067180633545
Epoch: 54, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.798 Vali Acc: 0.768 Test Loss: 0.798 Test Acc: 0.768
Validation loss decreased (-0.768108 --> -0.768108).  Saving model ...
Epoch: 55 cost time: 0.876737117767334
Epoch: 55, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.803 Vali Acc: 0.775 Test Loss: 0.803 Test Acc: 0.775
Validation loss decreased (-0.768108 --> -0.775354).  Saving model ...
Epoch: 56 cost time: 1.3378942012786865
Epoch: 56, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.808 Vali Acc: 0.775 Test Loss: 0.808 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.3988006114959717
Epoch: 57, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.811 Vali Acc: 0.783 Test Loss: 0.811 Test Acc: 0.783
Validation loss decreased (-0.775354 --> -0.782601).  Saving model ...
Epoch: 58 cost time: 1.3067855834960938
Epoch: 58, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.814 Vali Acc: 0.783 Test Loss: 0.814 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.8529250621795654
Epoch: 59, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.822 Vali Acc: 0.783 Test Loss: 0.822 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.9208493232727051
Epoch: 60, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.825 Vali Acc: 0.783 Test Loss: 0.825 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 0.9124352931976318
Epoch: 61, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.829 Vali Acc: 0.783 Test Loss: 0.829 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 0.9058833122253418
Epoch: 62, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.827 Vali Acc: 0.783 Test Loss: 0.827 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 1.5635662078857422
Epoch: 63, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.826 Vali Acc: 0.783 Test Loss: 0.826 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 0.8027417659759521
Epoch: 64, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.838 Vali Acc: 0.783 Test Loss: 0.838 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 1.0056254863739014
Epoch: 65, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.838 Vali Acc: 0.783 Test Loss: 0.838 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 1.1532933712005615
Epoch: 66, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.840 Vali Acc: 0.783 Test Loss: 0.840 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 0.7881767749786377
Epoch: 67, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.845 Vali Acc: 0.783 Test Loss: 0.845 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm32_cs23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.782608695652174
model parameter : 47374
model size : 0.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm32_cs21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.5573980808258057
Epoch: 1, Steps: 9 | Train Loss: 1.404 Vali Loss: 1.398 Vali Acc: 0.232 Test Loss: 1.398 Test Acc: 0.232
Validation loss decreased (inf --> -0.231870).  Saving model ...
Epoch: 2 cost time: 0.9176294803619385
Epoch: 2, Steps: 9 | Train Loss: 1.335 Vali Loss: 1.317 Vali Acc: 0.362 Test Loss: 1.317 Test Acc: 0.362
Validation loss decreased (-0.231870 --> -0.362306).  Saving model ...
Epoch: 3 cost time: 0.9339144229888916
Epoch: 3, Steps: 9 | Train Loss: 1.247 Vali Loss: 1.220 Vali Acc: 0.384 Test Loss: 1.220 Test Acc: 0.384
Validation loss decreased (-0.362306 --> -0.384046).  Saving model ...
Epoch: 4 cost time: 0.9504327774047852
Epoch: 4, Steps: 9 | Train Loss: 1.137 Vali Loss: 1.153 Vali Acc: 0.406 Test Loss: 1.153 Test Acc: 0.406
Validation loss decreased (-0.384046 --> -0.405786).  Saving model ...
Epoch: 5 cost time: 1.080742359161377
Epoch: 5, Steps: 9 | Train Loss: 1.059 Vali Loss: 1.112 Vali Acc: 0.420 Test Loss: 1.112 Test Acc: 0.420
Validation loss decreased (-0.405786 --> -0.420279).  Saving model ...
Epoch: 6 cost time: 1.2686257362365723
Epoch: 6, Steps: 9 | Train Loss: 1.012 Vali Loss: 1.082 Vali Acc: 0.449 Test Loss: 1.082 Test Acc: 0.449
Validation loss decreased (-0.420279 --> -0.449265).  Saving model ...
Epoch: 7 cost time: 0.952343225479126
Epoch: 7, Steps: 9 | Train Loss: 0.935 Vali Loss: 1.056 Vali Acc: 0.493 Test Loss: 1.056 Test Acc: 0.493
Validation loss decreased (-0.449265 --> -0.492743).  Saving model ...
Epoch: 8 cost time: 1.026871919631958
Epoch: 8, Steps: 9 | Train Loss: 0.888 Vali Loss: 1.045 Vali Acc: 0.507 Test Loss: 1.045 Test Acc: 0.507
Validation loss decreased (-0.492743 --> -0.507236).  Saving model ...
Epoch: 9 cost time: 1.0887939929962158
Epoch: 9, Steps: 9 | Train Loss: 0.813 Vali Loss: 1.023 Vali Acc: 0.536 Test Loss: 1.023 Test Acc: 0.536
Validation loss decreased (-0.507236 --> -0.536222).  Saving model ...
Epoch: 10 cost time: 0.9740610122680664
Epoch: 10, Steps: 9 | Train Loss: 0.780 Vali Loss: 1.016 Vali Acc: 0.536 Test Loss: 1.016 Test Acc: 0.536
Validation loss decreased (-0.536222 --> -0.536222).  Saving model ...
Epoch: 11 cost time: 0.9549846649169922
Epoch: 11, Steps: 9 | Train Loss: 0.741 Vali Loss: 1.013 Vali Acc: 0.551 Test Loss: 1.013 Test Acc: 0.551
Validation loss decreased (-0.536222 --> -0.550715).  Saving model ...
Epoch: 12 cost time: 1.04915452003479
Epoch: 12, Steps: 9 | Train Loss: 0.700 Vali Loss: 1.017 Vali Acc: 0.551 Test Loss: 1.017 Test Acc: 0.551
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8814899921417236
Epoch: 13, Steps: 9 | Train Loss: 0.668 Vali Loss: 0.998 Vali Acc: 0.551 Test Loss: 0.998 Test Acc: 0.551
Validation loss decreased (-0.550715 --> -0.550715).  Saving model ...
Epoch: 14 cost time: 0.7598819732666016
Epoch: 14, Steps: 9 | Train Loss: 0.622 Vali Loss: 1.001 Vali Acc: 0.551 Test Loss: 1.001 Test Acc: 0.551
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7667372226715088
Epoch: 15, Steps: 9 | Train Loss: 0.589 Vali Loss: 1.012 Vali Acc: 0.587 Test Loss: 1.012 Test Acc: 0.587
Validation loss decreased (-0.550715 --> -0.586946).  Saving model ...
Epoch: 16 cost time: 0.9532573223114014
Epoch: 16, Steps: 9 | Train Loss: 0.558 Vali Loss: 1.001 Vali Acc: 0.587 Test Loss: 1.001 Test Acc: 0.587
Validation loss decreased (-0.586946 --> -0.586947).  Saving model ...
Epoch: 17 cost time: 1.0463662147521973
Epoch: 17, Steps: 9 | Train Loss: 0.530 Vali Loss: 1.000 Vali Acc: 0.601 Test Loss: 1.000 Test Acc: 0.601
Validation loss decreased (-0.586947 --> -0.601439).  Saving model ...
Epoch: 18 cost time: 1.032557487487793
Epoch: 18, Steps: 9 | Train Loss: 0.486 Vali Loss: 1.029 Vali Acc: 0.609 Test Loss: 1.029 Test Acc: 0.609
Validation loss decreased (-0.601439 --> -0.608685).  Saving model ...
Epoch: 19 cost time: 0.9856681823730469
Epoch: 19, Steps: 9 | Train Loss: 0.465 Vali Loss: 1.029 Vali Acc: 0.594 Test Loss: 1.029 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8898742198944092
Epoch: 20, Steps: 9 | Train Loss: 0.440 Vali Loss: 1.000 Vali Acc: 0.616 Test Loss: 1.000 Test Acc: 0.616
Validation loss decreased (-0.608685 --> -0.615932).  Saving model ...
Epoch: 21 cost time: 0.8656892776489258
Epoch: 21, Steps: 9 | Train Loss: 0.406 Vali Loss: 1.025 Vali Acc: 0.601 Test Loss: 1.025 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9485063552856445
Epoch: 22, Steps: 9 | Train Loss: 0.368 Vali Loss: 1.009 Vali Acc: 0.616 Test Loss: 1.009 Test Acc: 0.616
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0070676803588867
Epoch: 23, Steps: 9 | Train Loss: 0.334 Vali Loss: 0.999 Vali Acc: 0.630 Test Loss: 0.999 Test Acc: 0.630
Validation loss decreased (-0.615932 --> -0.630425).  Saving model ...
Epoch: 24 cost time: 0.944359540939331
Epoch: 24, Steps: 9 | Train Loss: 0.292 Vali Loss: 0.969 Vali Acc: 0.667 Test Loss: 0.969 Test Acc: 0.667
Validation loss decreased (-0.630425 --> -0.666657).  Saving model ...
Epoch: 25 cost time: 1.0143682956695557
Epoch: 25, Steps: 9 | Train Loss: 0.267 Vali Loss: 0.963 Vali Acc: 0.659 Test Loss: 0.963 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.128871202468872
Epoch: 26, Steps: 9 | Train Loss: 0.226 Vali Loss: 0.933 Vali Acc: 0.681 Test Loss: 0.933 Test Acc: 0.681
Validation loss decreased (-0.666657 --> -0.681150).  Saving model ...
Epoch: 27 cost time: 0.9384737014770508
Epoch: 27, Steps: 9 | Train Loss: 0.198 Vali Loss: 0.884 Vali Acc: 0.703 Test Loss: 0.884 Test Acc: 0.703
Validation loss decreased (-0.681150 --> -0.702890).  Saving model ...
Epoch: 28 cost time: 1.277085781097412
Epoch: 28, Steps: 9 | Train Loss: 0.163 Vali Loss: 0.819 Vali Acc: 0.710 Test Loss: 0.819 Test Acc: 0.710
Validation loss decreased (-0.702890 --> -0.710137).  Saving model ...
Epoch: 29 cost time: 1.2508118152618408
Epoch: 29, Steps: 9 | Train Loss: 0.128 Vali Loss: 0.759 Vali Acc: 0.725 Test Loss: 0.759 Test Acc: 0.725
Validation loss decreased (-0.710137 --> -0.724630).  Saving model ...
Epoch: 30 cost time: 1.0715737342834473
Epoch: 30, Steps: 9 | Train Loss: 0.103 Vali Loss: 0.709 Vali Acc: 0.732 Test Loss: 0.709 Test Acc: 0.732
Validation loss decreased (-0.724630 --> -0.731877).  Saving model ...
Epoch: 31 cost time: 0.8924760818481445
Epoch: 31, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.656 Vali Acc: 0.768 Test Loss: 0.656 Test Acc: 0.768
Validation loss decreased (-0.731877 --> -0.768109).  Saving model ...
Epoch: 32 cost time: 0.7049119472503662
Epoch: 32, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.624 Vali Acc: 0.790 Test Loss: 0.624 Test Acc: 0.790
Validation loss decreased (-0.768109 --> -0.789849).  Saving model ...
Epoch: 33 cost time: 0.745833158493042
Epoch: 33, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.600 Vali Acc: 0.812 Test Loss: 0.600 Test Acc: 0.812
Validation loss decreased (-0.789849 --> -0.811588).  Saving model ...
Epoch: 34 cost time: 0.9460630416870117
Epoch: 34, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.582 Vali Acc: 0.826 Test Loss: 0.582 Test Acc: 0.826
Validation loss decreased (-0.811588 --> -0.826081).  Saving model ...
Epoch: 35 cost time: 0.8939685821533203
Epoch: 35, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.557 Vali Acc: 0.826 Test Loss: 0.557 Test Acc: 0.826
Validation loss decreased (-0.826081 --> -0.826081).  Saving model ...
Epoch: 36 cost time: 0.8973381519317627
Epoch: 36, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.565 Vali Acc: 0.848 Test Loss: 0.565 Test Acc: 0.848
Validation loss decreased (-0.826081 --> -0.847820).  Saving model ...
Epoch: 37 cost time: 1.0483763217926025
Epoch: 37, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.560 Vali Acc: 0.848 Test Loss: 0.560 Test Acc: 0.848
Validation loss decreased (-0.847820 --> -0.847820).  Saving model ...
Epoch: 38 cost time: 1.1658117771148682
Epoch: 38, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.563 Vali Acc: 0.855 Test Loss: 0.563 Test Acc: 0.855
Validation loss decreased (-0.847820 --> -0.855067).  Saving model ...
Epoch: 39 cost time: 0.7636842727661133
Epoch: 39, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.561 Vali Acc: 0.855 Test Loss: 0.561 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855067).  Saving model ...
Epoch: 40 cost time: 0.6906297206878662
Epoch: 40, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.542 Vali Acc: 0.862 Test Loss: 0.542 Test Acc: 0.862
Validation loss decreased (-0.855067 --> -0.862313).  Saving model ...
Epoch: 41 cost time: 0.9537332057952881
Epoch: 41, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.547 Vali Acc: 0.862 Test Loss: 0.547 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.9841353893280029
Epoch: 42, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.564 Vali Acc: 0.862 Test Loss: 0.564 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.1805014610290527
Epoch: 43, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.576 Vali Acc: 0.862 Test Loss: 0.576 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.9841954708099365
Epoch: 44, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.556 Vali Acc: 0.862 Test Loss: 0.556 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.9364767074584961
Epoch: 45, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.561 Vali Acc: 0.862 Test Loss: 0.561 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.9617569446563721
Epoch: 46, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.571 Vali Acc: 0.862 Test Loss: 0.571 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.2516305446624756
Epoch: 47, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.578 Vali Acc: 0.870 Test Loss: 0.578 Test Acc: 0.870
Validation loss decreased (-0.862313 --> -0.869559).  Saving model ...
Epoch: 48 cost time: 1.028296947479248
Epoch: 48, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.560 Vali Acc: 0.870 Test Loss: 0.560 Test Acc: 0.870
Validation loss decreased (-0.869559 --> -0.869560).  Saving model ...
Epoch: 49 cost time: 1.075817346572876
Epoch: 49, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.571 Vali Acc: 0.862 Test Loss: 0.571 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.944549560546875
Epoch: 50, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.573 Vali Acc: 0.862 Test Loss: 0.573 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.2297444343566895
Epoch: 51, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.590 Vali Acc: 0.862 Test Loss: 0.590 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.8617947101593018
Epoch: 52, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.593 Vali Acc: 0.862 Test Loss: 0.593 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.145702838897705
Epoch: 53, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.585 Vali Acc: 0.862 Test Loss: 0.585 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.1249594688415527
Epoch: 54, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.593 Vali Acc: 0.862 Test Loss: 0.593 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 1.3126022815704346
Epoch: 55, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.594 Vali Acc: 0.862 Test Loss: 0.594 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 1.154609203338623
Epoch: 56, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.597 Vali Acc: 0.862 Test Loss: 0.597 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 0.9751639366149902
Epoch: 57, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.603 Vali Acc: 0.862 Test Loss: 0.603 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 1.0859894752502441
Epoch: 58, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.598 Vali Acc: 0.862 Test Loss: 0.598 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm32_cs21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 48002
model size : 0.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm32_cs19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.3817803859710693
Epoch: 1, Steps: 9 | Train Loss: 1.381 Vali Loss: 1.405 Vali Acc: 0.268 Test Loss: 1.405 Test Acc: 0.268
Validation loss decreased (inf --> -0.268102).  Saving model ...
Epoch: 2 cost time: 1.0318853855133057
Epoch: 2, Steps: 9 | Train Loss: 1.306 Vali Loss: 1.325 Vali Acc: 0.333 Test Loss: 1.325 Test Acc: 0.333
Validation loss decreased (-0.268102 --> -0.333320).  Saving model ...
Epoch: 3 cost time: 0.7867064476013184
Epoch: 3, Steps: 9 | Train Loss: 1.223 Vali Loss: 1.241 Vali Acc: 0.391 Test Loss: 1.241 Test Acc: 0.391
Validation loss decreased (-0.333320 --> -0.391292).  Saving model ...
Epoch: 4 cost time: 0.9869403839111328
Epoch: 4, Steps: 9 | Train Loss: 1.131 Vali Loss: 1.171 Vali Acc: 0.413 Test Loss: 1.171 Test Acc: 0.413
Validation loss decreased (-0.391292 --> -0.413032).  Saving model ...
Epoch: 5 cost time: 0.8600497245788574
Epoch: 5, Steps: 9 | Train Loss: 1.033 Vali Loss: 1.121 Vali Acc: 0.449 Test Loss: 1.121 Test Acc: 0.449
Validation loss decreased (-0.413032 --> -0.449264).  Saving model ...
Epoch: 6 cost time: 1.3296480178833008
Epoch: 6, Steps: 9 | Train Loss: 0.958 Vali Loss: 1.084 Vali Acc: 0.435 Test Loss: 1.084 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8329582214355469
Epoch: 7, Steps: 9 | Train Loss: 0.910 Vali Loss: 1.056 Vali Acc: 0.486 Test Loss: 1.056 Test Acc: 0.486
Validation loss decreased (-0.449264 --> -0.485497).  Saving model ...
Epoch: 8 cost time: 1.1225662231445312
Epoch: 8, Steps: 9 | Train Loss: 0.851 Vali Loss: 1.045 Vali Acc: 0.457 Test Loss: 1.045 Test Acc: 0.457
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5233936309814453
Epoch: 9, Steps: 9 | Train Loss: 0.807 Vali Loss: 1.035 Vali Acc: 0.478 Test Loss: 1.035 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9914603233337402
Epoch: 10, Steps: 9 | Train Loss: 0.751 Vali Loss: 1.029 Vali Acc: 0.493 Test Loss: 1.029 Test Acc: 0.493
Validation loss decreased (-0.485497 --> -0.492743).  Saving model ...
Epoch: 11 cost time: 1.330815076828003
Epoch: 11, Steps: 9 | Train Loss: 0.713 Vali Loss: 1.008 Vali Acc: 0.522 Test Loss: 1.008 Test Acc: 0.522
Validation loss decreased (-0.492743 --> -0.521729).  Saving model ...
Epoch: 12 cost time: 0.8361475467681885
Epoch: 12, Steps: 9 | Train Loss: 0.687 Vali Loss: 1.016 Vali Acc: 0.507 Test Loss: 1.016 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.268733263015747
Epoch: 13, Steps: 9 | Train Loss: 0.646 Vali Loss: 1.008 Vali Acc: 0.543 Test Loss: 1.008 Test Acc: 0.543
Validation loss decreased (-0.521729 --> -0.543468).  Saving model ...
Epoch: 14 cost time: 1.0318520069122314
Epoch: 14, Steps: 9 | Train Loss: 0.610 Vali Loss: 1.009 Vali Acc: 0.543 Test Loss: 1.009 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8812747001647949
Epoch: 15, Steps: 9 | Train Loss: 0.580 Vali Loss: 0.998 Vali Acc: 0.580 Test Loss: 0.998 Test Acc: 0.580
Validation loss decreased (-0.543468 --> -0.579700).  Saving model ...
Epoch: 16 cost time: 1.1834731101989746
Epoch: 16, Steps: 9 | Train Loss: 0.541 Vali Loss: 1.021 Vali Acc: 0.558 Test Loss: 1.021 Test Acc: 0.558
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0251665115356445
Epoch: 17, Steps: 9 | Train Loss: 0.503 Vali Loss: 1.015 Vali Acc: 0.587 Test Loss: 1.015 Test Acc: 0.587
Validation loss decreased (-0.579700 --> -0.586946).  Saving model ...
Epoch: 18 cost time: 0.9657876491546631
Epoch: 18, Steps: 9 | Train Loss: 0.473 Vali Loss: 1.016 Vali Acc: 0.601 Test Loss: 1.016 Test Acc: 0.601
Validation loss decreased (-0.586946 --> -0.601439).  Saving model ...
Epoch: 19 cost time: 1.1169655323028564
Epoch: 19, Steps: 9 | Train Loss: 0.452 Vali Loss: 1.019 Vali Acc: 0.580 Test Loss: 1.019 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0052094459533691
Epoch: 20, Steps: 9 | Train Loss: 0.424 Vali Loss: 1.000 Vali Acc: 0.601 Test Loss: 1.000 Test Acc: 0.601
Validation loss decreased (-0.601439 --> -0.601439).  Saving model ...
Epoch: 21 cost time: 1.2520389556884766
Epoch: 21, Steps: 9 | Train Loss: 0.383 Vali Loss: 1.009 Vali Acc: 0.616 Test Loss: 1.009 Test Acc: 0.616
Validation loss decreased (-0.601439 --> -0.615932).  Saving model ...
Epoch: 22 cost time: 1.2227270603179932
Epoch: 22, Steps: 9 | Train Loss: 0.367 Vali Loss: 1.020 Vali Acc: 0.616 Test Loss: 1.020 Test Acc: 0.616
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8344330787658691
Epoch: 23, Steps: 9 | Train Loss: 0.327 Vali Loss: 0.976 Vali Acc: 0.652 Test Loss: 0.976 Test Acc: 0.652
Validation loss decreased (-0.615932 --> -0.652164).  Saving model ...
Epoch: 24 cost time: 0.8592164516448975
Epoch: 24, Steps: 9 | Train Loss: 0.288 Vali Loss: 0.924 Vali Acc: 0.667 Test Loss: 0.924 Test Acc: 0.667
Validation loss decreased (-0.652164 --> -0.666657).  Saving model ...
Epoch: 25 cost time: 1.0411443710327148
Epoch: 25, Steps: 9 | Train Loss: 0.237 Vali Loss: 0.865 Vali Acc: 0.688 Test Loss: 0.865 Test Acc: 0.688
Validation loss decreased (-0.666657 --> -0.688397).  Saving model ...
Epoch: 26 cost time: 1.131387710571289
Epoch: 26, Steps: 9 | Train Loss: 0.190 Vali Loss: 0.785 Vali Acc: 0.696 Test Loss: 0.785 Test Acc: 0.696
Validation loss decreased (-0.688397 --> -0.695644).  Saving model ...
Epoch: 27 cost time: 1.0792317390441895
Epoch: 27, Steps: 9 | Train Loss: 0.157 Vali Loss: 0.732 Vali Acc: 0.754 Test Loss: 0.732 Test Acc: 0.754
Validation loss decreased (-0.695644 --> -0.753616).  Saving model ...
Epoch: 28 cost time: 0.8951518535614014
Epoch: 28, Steps: 9 | Train Loss: 0.122 Vali Loss: 0.674 Vali Acc: 0.775 Test Loss: 0.674 Test Acc: 0.775
Validation loss decreased (-0.753616 --> -0.775356).  Saving model ...
Epoch: 29 cost time: 1.0854203701019287
Epoch: 29, Steps: 9 | Train Loss: 0.098 Vali Loss: 0.644 Vali Acc: 0.761 Test Loss: 0.644 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.4263074398040771
Epoch: 30, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.635 Vali Acc: 0.768 Test Loss: 0.635 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.2543694972991943
Epoch: 31, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.613 Vali Acc: 0.790 Test Loss: 0.613 Test Acc: 0.790
Validation loss decreased (-0.775356 --> -0.789849).  Saving model ...
Epoch: 32 cost time: 1.1613290309906006
Epoch: 32, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.593 Vali Acc: 0.790 Test Loss: 0.593 Test Acc: 0.790
Validation loss decreased (-0.789849 --> -0.789849).  Saving model ...
Epoch: 33 cost time: 1.1115729808807373
Epoch: 33, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.576 Vali Acc: 0.812 Test Loss: 0.576 Test Acc: 0.812
Validation loss decreased (-0.789849 --> -0.811588).  Saving model ...
Epoch: 34 cost time: 1.1926748752593994
Epoch: 34, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.564 Vali Acc: 0.819 Test Loss: 0.564 Test Acc: 0.819
Validation loss decreased (-0.811588 --> -0.818835).  Saving model ...
Epoch: 35 cost time: 0.8281838893890381
Epoch: 35, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.548 Vali Acc: 0.833 Test Loss: 0.548 Test Acc: 0.833
Validation loss decreased (-0.818835 --> -0.833328).  Saving model ...
Epoch: 36 cost time: 1.1487135887145996
Epoch: 36, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.540 Vali Acc: 0.833 Test Loss: 0.540 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 37 cost time: 1.1515412330627441
Epoch: 37, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.537 Vali Acc: 0.841 Test Loss: 0.537 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840574).  Saving model ...
Epoch: 38 cost time: 1.218888282775879
Epoch: 38, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.529 Vali Acc: 0.841 Test Loss: 0.529 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840574).  Saving model ...
Epoch: 39 cost time: 1.2765061855316162
Epoch: 39, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.525 Vali Acc: 0.841 Test Loss: 0.525 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840574).  Saving model ...
Epoch: 40 cost time: 1.3612806797027588
Epoch: 40, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.518 Vali Acc: 0.841 Test Loss: 0.518 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840575).  Saving model ...
Epoch: 41 cost time: 1.1091647148132324
Epoch: 41, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.511 Vali Acc: 0.841 Test Loss: 0.511 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 42 cost time: 1.104501485824585
Epoch: 42, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.501 Vali Acc: 0.841 Test Loss: 0.501 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 43 cost time: 1.1855261325836182
Epoch: 43, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.496 Vali Acc: 0.848 Test Loss: 0.496 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847821).  Saving model ...
Epoch: 44 cost time: 1.0155630111694336
Epoch: 44, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.499 Vali Acc: 0.841 Test Loss: 0.499 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.8938941955566406
Epoch: 45, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.514 Vali Acc: 0.841 Test Loss: 0.514 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.0670690536499023
Epoch: 46, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.501 Vali Acc: 0.841 Test Loss: 0.501 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.2792370319366455
Epoch: 47, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.490 Vali Acc: 0.848 Test Loss: 0.490 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 48 cost time: 1.1483416557312012
Epoch: 48, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.490 Vali Acc: 0.848 Test Loss: 0.490 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 49 cost time: 1.196234941482544
Epoch: 49, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.492 Vali Acc: 0.848 Test Loss: 0.492 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.0646355152130127
Epoch: 50, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.485 Vali Acc: 0.848 Test Loss: 0.485 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 51 cost time: 0.8986985683441162
Epoch: 51, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.485 Vali Acc: 0.848 Test Loss: 0.485 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.7687492370605469
Epoch: 52, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.486 Vali Acc: 0.848 Test Loss: 0.486 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.9891541004180908
Epoch: 53, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.480 Vali Acc: 0.855 Test Loss: 0.480 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855068).  Saving model ...
Epoch: 54 cost time: 0.9438729286193848
Epoch: 54, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.481 Vali Acc: 0.862 Test Loss: 0.481 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862314).  Saving model ...
Epoch: 55 cost time: 1.2850255966186523
Epoch: 55, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.472 Vali Acc: 0.870 Test Loss: 0.472 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869561).  Saving model ...
Epoch: 56 cost time: 1.2024176120758057
Epoch: 56, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.475 Vali Acc: 0.870 Test Loss: 0.475 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.1414365768432617
Epoch: 57, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.481 Vali Acc: 0.870 Test Loss: 0.481 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.0302002429962158
Epoch: 58, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.483 Vali Acc: 0.870 Test Loss: 0.483 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 1.2140460014343262
Epoch: 59, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.470 Vali Acc: 0.870 Test Loss: 0.470 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 60 cost time: 1.1067380905151367
Epoch: 60, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.476 Vali Acc: 0.870 Test Loss: 0.476 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.8988065719604492
Epoch: 61, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.469 Vali Acc: 0.870 Test Loss: 0.469 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 62 cost time: 1.237849235534668
Epoch: 62, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.476 Vali Acc: 0.877 Test Loss: 0.476 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876807).  Saving model ...
Epoch: 63 cost time: 0.9441869258880615
Epoch: 63, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.474 Vali Acc: 0.877 Test Loss: 0.474 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876807).  Saving model ...
Epoch: 64 cost time: 1.1152076721191406
Epoch: 64, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.447 Vali Acc: 0.877 Test Loss: 0.447 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876807).  Saving model ...
Epoch: 65 cost time: 0.9701824188232422
Epoch: 65, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.447 Vali Acc: 0.884 Test Loss: 0.447 Test Acc: 0.884
Validation loss decreased (-0.876807 --> -0.884053).  Saving model ...
Epoch: 66 cost time: 1.0602037906646729
Epoch: 66, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.465 Vali Acc: 0.877 Test Loss: 0.465 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.9431822299957275
Epoch: 67, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.469 Vali Acc: 0.884 Test Loss: 0.469 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 1.1291089057922363
Epoch: 68, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.461 Vali Acc: 0.884 Test Loss: 0.461 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 0.8606259822845459
Epoch: 69, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.462 Vali Acc: 0.884 Test Loss: 0.462 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 0.7510297298431396
Epoch: 70, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.464 Vali Acc: 0.884 Test Loss: 0.464 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 0.6536498069763184
Epoch: 71, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.463 Vali Acc: 0.891 Test Loss: 0.463 Test Acc: 0.891
Validation loss decreased (-0.884053 --> -0.891300).  Saving model ...
Epoch: 72 cost time: 1.1403779983520508
Epoch: 72, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.437 Vali Acc: 0.891 Test Loss: 0.437 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891300).  Saving model ...
Epoch: 73 cost time: 1.0524075031280518
Epoch: 73, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.445 Vali Acc: 0.891 Test Loss: 0.445 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 1.2269277572631836
Epoch: 74, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.445 Vali Acc: 0.891 Test Loss: 0.445 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 1.1085155010223389
Epoch: 75, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.444 Vali Acc: 0.891 Test Loss: 0.444 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 0.991152286529541
Epoch: 76, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.451 Vali Acc: 0.891 Test Loss: 0.451 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 77 cost time: 1.1008789539337158
Epoch: 77, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.444 Vali Acc: 0.891 Test Loss: 0.444 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 78 cost time: 0.8803966045379639
Epoch: 78, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.448 Vali Acc: 0.891 Test Loss: 0.448 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 79 cost time: 1.092271327972412
Epoch: 79, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.450 Vali Acc: 0.891 Test Loss: 0.450 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
Epoch: 80 cost time: 0.9633705615997314
Epoch: 80, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.452 Vali Acc: 0.899 Test Loss: 0.452 Test Acc: 0.899
Validation loss decreased (-0.891300 --> -0.898546).  Saving model ...
Epoch: 81 cost time: 0.9516124725341797
Epoch: 81, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.447 Vali Acc: 0.899 Test Loss: 0.447 Test Acc: 0.899
Validation loss decreased (-0.898546 --> -0.898546).  Saving model ...
Epoch: 82 cost time: 1.1196231842041016
Epoch: 82, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.450 Vali Acc: 0.899 Test Loss: 0.450 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 0.8720457553863525
Epoch: 83, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.442 Vali Acc: 0.899 Test Loss: 0.442 Test Acc: 0.899
Validation loss decreased (-0.898546 --> -0.898546).  Saving model ...
Epoch: 84 cost time: 0.9374990463256836
Epoch: 84, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.436 Vali Acc: 0.899 Test Loss: 0.436 Test Acc: 0.899
Validation loss decreased (-0.898546 --> -0.898546).  Saving model ...
Epoch: 85 cost time: 1.0911955833435059
Epoch: 85, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.439 Vali Acc: 0.899 Test Loss: 0.439 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 0.7395567893981934
Epoch: 86, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.443 Vali Acc: 0.899 Test Loss: 0.443 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 0.8207955360412598
Epoch: 87, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.439 Vali Acc: 0.899 Test Loss: 0.439 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 88 cost time: 0.9277281761169434
Epoch: 88, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.441 Vali Acc: 0.899 Test Loss: 0.441 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 89 cost time: 0.8770689964294434
Epoch: 89, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.427 Vali Acc: 0.899 Test Loss: 0.427 Test Acc: 0.899
Validation loss decreased (-0.898546 --> -0.898546).  Saving model ...
Epoch: 90 cost time: 0.8909523487091064
Epoch: 90, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.428 Vali Acc: 0.899 Test Loss: 0.428 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 0.9560534954071045
Epoch: 91, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.428 Vali Acc: 0.899 Test Loss: 0.428 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 92 cost time: 1.0805370807647705
Epoch: 92, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.433 Vali Acc: 0.899 Test Loss: 0.433 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 93 cost time: 1.076183795928955
Epoch: 93, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.430 Vali Acc: 0.899 Test Loss: 0.430 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 94 cost time: 0.9736969470977783
Epoch: 94, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.431 Vali Acc: 0.899 Test Loss: 0.431 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 95 cost time: 1.1866729259490967
Epoch: 95, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.437 Vali Acc: 0.899 Test Loss: 0.437 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 96 cost time: 0.8689653873443604
Epoch: 96, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.423 Vali Acc: 0.899 Test Loss: 0.423 Test Acc: 0.899
Validation loss decreased (-0.898546 --> -0.898546).  Saving model ...
Epoch: 97 cost time: 1.0144553184509277
Epoch: 97, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.418 Vali Acc: 0.899 Test Loss: 0.418 Test Acc: 0.899
Validation loss decreased (-0.898546 --> -0.898547).  Saving model ...
Epoch: 98 cost time: 0.7408492565155029
Epoch: 98, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.424 Vali Acc: 0.899 Test Loss: 0.424 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 0.8787689208984375
Epoch: 99, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.430 Vali Acc: 0.899 Test Loss: 0.430 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 100 cost time: 1.0361227989196777
Epoch: 100, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.428 Vali Acc: 0.899 Test Loss: 0.428 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm32_cs19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 47810
model size : 0.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm32_cs18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.0163938999176025
Epoch: 1, Steps: 9 | Train Loss: 1.407 Vali Loss: 1.379 Vali Acc: 0.341 Test Loss: 1.379 Test Acc: 0.341
Validation loss decreased (inf --> -0.340566).  Saving model ...
Epoch: 2 cost time: 0.8877971172332764
Epoch: 2, Steps: 9 | Train Loss: 1.326 Vali Loss: 1.301 Vali Acc: 0.406 Test Loss: 1.301 Test Acc: 0.406
Validation loss decreased (-0.340566 --> -0.405784).  Saving model ...
Epoch: 3 cost time: 0.894249677658081
Epoch: 3, Steps: 9 | Train Loss: 1.224 Vali Loss: 1.225 Vali Acc: 0.442 Test Loss: 1.225 Test Acc: 0.442
Validation loss decreased (-0.405784 --> -0.442017).  Saving model ...
Epoch: 4 cost time: 0.7194578647613525
Epoch: 4, Steps: 9 | Train Loss: 1.129 Vali Loss: 1.168 Vali Acc: 0.464 Test Loss: 1.168 Test Acc: 0.464
Validation loss decreased (-0.442017 --> -0.463756).  Saving model ...
Epoch: 5 cost time: 0.9275274276733398
Epoch: 5, Steps: 9 | Train Loss: 1.039 Vali Loss: 1.124 Vali Acc: 0.457 Test Loss: 1.124 Test Acc: 0.457
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0460858345031738
Epoch: 6, Steps: 9 | Train Loss: 0.960 Vali Loss: 1.098 Vali Acc: 0.464 Test Loss: 1.098 Test Acc: 0.464
Validation loss decreased (-0.463756 --> -0.463757).  Saving model ...
Epoch: 7 cost time: 1.219864845275879
Epoch: 7, Steps: 9 | Train Loss: 0.899 Vali Loss: 1.071 Vali Acc: 0.428 Test Loss: 1.071 Test Acc: 0.428
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0768859386444092
Epoch: 8, Steps: 9 | Train Loss: 0.837 Vali Loss: 1.041 Vali Acc: 0.471 Test Loss: 1.041 Test Acc: 0.471
Validation loss decreased (-0.463757 --> -0.471004).  Saving model ...
Epoch: 9 cost time: 0.8281948566436768
Epoch: 9, Steps: 9 | Train Loss: 0.792 Vali Loss: 1.032 Vali Acc: 0.478 Test Loss: 1.032 Test Acc: 0.478
Validation loss decreased (-0.471004 --> -0.478251).  Saving model ...
Epoch: 10 cost time: 0.7491400241851807
Epoch: 10, Steps: 9 | Train Loss: 0.744 Vali Loss: 1.029 Vali Acc: 0.507 Test Loss: 1.029 Test Acc: 0.507
Validation loss decreased (-0.478251 --> -0.507236).  Saving model ...
Epoch: 11 cost time: 0.7476449012756348
Epoch: 11, Steps: 9 | Train Loss: 0.699 Vali Loss: 1.019 Vali Acc: 0.507 Test Loss: 1.019 Test Acc: 0.507
Validation loss decreased (-0.507236 --> -0.507236).  Saving model ...
Epoch: 12 cost time: 0.7293927669525146
Epoch: 12, Steps: 9 | Train Loss: 0.663 Vali Loss: 1.018 Vali Acc: 0.522 Test Loss: 1.018 Test Acc: 0.522
Validation loss decreased (-0.507236 --> -0.521729).  Saving model ...
Epoch: 13 cost time: 1.1916463375091553
Epoch: 13, Steps: 9 | Train Loss: 0.620 Vali Loss: 1.001 Vali Acc: 0.529 Test Loss: 1.001 Test Acc: 0.529
Validation loss decreased (-0.521729 --> -0.528975).  Saving model ...
Epoch: 14 cost time: 1.03261399269104
Epoch: 14, Steps: 9 | Train Loss: 0.587 Vali Loss: 1.012 Vali Acc: 0.551 Test Loss: 1.012 Test Acc: 0.551
Validation loss decreased (-0.528975 --> -0.550715).  Saving model ...
Epoch: 15 cost time: 0.7817718982696533
Epoch: 15, Steps: 9 | Train Loss: 0.542 Vali Loss: 0.991 Vali Acc: 0.587 Test Loss: 0.991 Test Acc: 0.587
Validation loss decreased (-0.550715 --> -0.586947).  Saving model ...
Epoch: 16 cost time: 0.7652740478515625
Epoch: 16, Steps: 9 | Train Loss: 0.502 Vali Loss: 0.970 Vali Acc: 0.580 Test Loss: 0.970 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8530104160308838
Epoch: 17, Steps: 9 | Train Loss: 0.452 Vali Loss: 0.971 Vali Acc: 0.543 Test Loss: 0.971 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7408103942871094
Epoch: 18, Steps: 9 | Train Loss: 0.432 Vali Loss: 0.962 Vali Acc: 0.601 Test Loss: 0.962 Test Acc: 0.601
Validation loss decreased (-0.586947 --> -0.601440).  Saving model ...
Epoch: 19 cost time: 0.8591995239257812
Epoch: 19, Steps: 9 | Train Loss: 0.372 Vali Loss: 0.932 Vali Acc: 0.601 Test Loss: 0.932 Test Acc: 0.601
Validation loss decreased (-0.601440 --> -0.601440).  Saving model ...
Epoch: 20 cost time: 0.9410216808319092
Epoch: 20, Steps: 9 | Train Loss: 0.347 Vali Loss: 0.900 Vali Acc: 0.630 Test Loss: 0.900 Test Acc: 0.630
Validation loss decreased (-0.601440 --> -0.630426).  Saving model ...
Epoch: 21 cost time: 0.823373556137085
Epoch: 21, Steps: 9 | Train Loss: 0.293 Vali Loss: 0.840 Vali Acc: 0.659 Test Loss: 0.840 Test Acc: 0.659
Validation loss decreased (-0.630426 --> -0.659412).  Saving model ...
Epoch: 22 cost time: 0.8614706993103027
Epoch: 22, Steps: 9 | Train Loss: 0.238 Vali Loss: 0.813 Vali Acc: 0.674 Test Loss: 0.813 Test Acc: 0.674
Validation loss decreased (-0.659412 --> -0.673905).  Saving model ...
Epoch: 23 cost time: 0.9831376075744629
Epoch: 23, Steps: 9 | Train Loss: 0.206 Vali Loss: 0.756 Vali Acc: 0.725 Test Loss: 0.756 Test Acc: 0.725
Validation loss decreased (-0.673905 --> -0.724630).  Saving model ...
Epoch: 24 cost time: 1.167259693145752
Epoch: 24, Steps: 9 | Train Loss: 0.160 Vali Loss: 0.680 Vali Acc: 0.732 Test Loss: 0.680 Test Acc: 0.732
Validation loss decreased (-0.724630 --> -0.731877).  Saving model ...
Epoch: 25 cost time: 0.9086909294128418
Epoch: 25, Steps: 9 | Train Loss: 0.124 Vali Loss: 0.615 Vali Acc: 0.797 Test Loss: 0.615 Test Acc: 0.797
Validation loss decreased (-0.731877 --> -0.797095).  Saving model ...
Epoch: 26 cost time: 0.9039192199707031
Epoch: 26, Steps: 9 | Train Loss: 0.107 Vali Loss: 0.547 Vali Acc: 0.797 Test Loss: 0.547 Test Acc: 0.797
Validation loss decreased (-0.797095 --> -0.797096).  Saving model ...
Epoch: 27 cost time: 0.8218214511871338
Epoch: 27, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.496 Vali Acc: 0.812 Test Loss: 0.496 Test Acc: 0.812
Validation loss decreased (-0.797096 --> -0.811589).  Saving model ...
Epoch: 28 cost time: 0.8699018955230713
Epoch: 28, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.460 Vali Acc: 0.841 Test Loss: 0.460 Test Acc: 0.841
Validation loss decreased (-0.811589 --> -0.840575).  Saving model ...
Epoch: 29 cost time: 0.7941884994506836
Epoch: 29, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.441 Vali Acc: 0.855 Test Loss: 0.441 Test Acc: 0.855
Validation loss decreased (-0.840575 --> -0.855068).  Saving model ...
Epoch: 30 cost time: 0.7368168830871582
Epoch: 30, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.416 Vali Acc: 0.870 Test Loss: 0.416 Test Acc: 0.870
Validation loss decreased (-0.855068 --> -0.869561).  Saving model ...
Epoch: 31 cost time: 0.9308645725250244
Epoch: 31, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.401 Vali Acc: 0.877 Test Loss: 0.401 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876808).  Saving model ...
Epoch: 32 cost time: 1.2152457237243652
Epoch: 32, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.379 Vali Acc: 0.877 Test Loss: 0.379 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 33 cost time: 1.1934926509857178
Epoch: 33, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.384 Vali Acc: 0.884 Test Loss: 0.384 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884054).  Saving model ...
Epoch: 34 cost time: 0.9265313148498535
Epoch: 34, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.377 Vali Acc: 0.884 Test Loss: 0.377 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 35 cost time: 1.1651217937469482
Epoch: 35, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.364 Vali Acc: 0.884 Test Loss: 0.364 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 36 cost time: 0.9372835159301758
Epoch: 36, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.350 Vali Acc: 0.884 Test Loss: 0.350 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 37 cost time: 0.7950236797332764
Epoch: 37, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.347 Vali Acc: 0.877 Test Loss: 0.347 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.8534433841705322
Epoch: 38, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.337 Vali Acc: 0.877 Test Loss: 0.337 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.062103509902954
Epoch: 39, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.336 Vali Acc: 0.877 Test Loss: 0.336 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.288297176361084
Epoch: 40, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.336 Vali Acc: 0.877 Test Loss: 0.336 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.4240837097167969
Epoch: 41, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.343 Vali Acc: 0.877 Test Loss: 0.343 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.8522701263427734
Epoch: 42, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.340 Vali Acc: 0.877 Test Loss: 0.340 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.8873658180236816
Epoch: 43, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.335 Vali Acc: 0.884 Test Loss: 0.335 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884055).  Saving model ...
Epoch: 44 cost time: 1.0844082832336426
Epoch: 44, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.325 Vali Acc: 0.891 Test Loss: 0.325 Test Acc: 0.891
Validation loss decreased (-0.884055 --> -0.891301).  Saving model ...
Epoch: 45 cost time: 1.0029046535491943
Epoch: 45, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.325 Vali Acc: 0.899 Test Loss: 0.325 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898547).  Saving model ...
Epoch: 46 cost time: 1.026052713394165
Epoch: 46, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.333 Vali Acc: 0.891 Test Loss: 0.333 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.5110480785369873
Epoch: 47, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.335 Vali Acc: 0.891 Test Loss: 0.335 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.3373022079467773
Epoch: 48, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.325 Vali Acc: 0.899 Test Loss: 0.325 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 49 cost time: 0.92087721824646
Epoch: 49, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.319 Vali Acc: 0.906 Test Loss: 0.319 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905794).  Saving model ...
Epoch: 50 cost time: 1.2082164287567139
Epoch: 50, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.320 Vali Acc: 0.906 Test Loss: 0.320 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.9235436916351318
Epoch: 51, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.321 Vali Acc: 0.906 Test Loss: 0.321 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.2202916145324707
Epoch: 52, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.323 Vali Acc: 0.906 Test Loss: 0.323 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.156067132949829
Epoch: 53, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.328 Vali Acc: 0.899 Test Loss: 0.328 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 0.8539128303527832
Epoch: 54, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.326 Vali Acc: 0.906 Test Loss: 0.326 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 1.1527326107025146
Epoch: 55, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.321 Vali Acc: 0.906 Test Loss: 0.321 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 1.1558401584625244
Epoch: 56, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.314 Vali Acc: 0.906 Test Loss: 0.314 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 57 cost time: 1.1019625663757324
Epoch: 57, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.324 Vali Acc: 0.906 Test Loss: 0.324 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.0445098876953125
Epoch: 58, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.321 Vali Acc: 0.906 Test Loss: 0.321 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.0687255859375
Epoch: 59, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.317 Vali Acc: 0.906 Test Loss: 0.317 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 1.170644998550415
Epoch: 60, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.317 Vali Acc: 0.906 Test Loss: 0.317 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 1.0436484813690186
Epoch: 61, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.323 Vali Acc: 0.906 Test Loss: 0.323 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 0.9415762424468994
Epoch: 62, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.322 Vali Acc: 0.906 Test Loss: 0.322 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 1.1979880332946777
Epoch: 63, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.318 Vali Acc: 0.906 Test Loss: 0.318 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 1.4657514095306396
Epoch: 64, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.322 Vali Acc: 0.906 Test Loss: 0.322 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 1.085214614868164
Epoch: 65, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.322 Vali Acc: 0.920 Test Loss: 0.322 Test Acc: 0.920
Validation loss decreased (-0.905794 --> -0.920287).  Saving model ...
Epoch: 66 cost time: 1.012908697128296
Epoch: 66, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.321 Vali Acc: 0.920 Test Loss: 0.321 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 67 cost time: 1.3886337280273438
Epoch: 67, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.324 Vali Acc: 0.920 Test Loss: 0.324 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 1.1118462085723877
Epoch: 68, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.323 Vali Acc: 0.920 Test Loss: 0.323 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 1.0259711742401123
Epoch: 69, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.321 Vali Acc: 0.920 Test Loss: 0.321 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 70 cost time: 1.0394163131713867
Epoch: 70, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.320 Vali Acc: 0.920 Test Loss: 0.320 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 71 cost time: 1.0491094589233398
Epoch: 71, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.314 Vali Acc: 0.920 Test Loss: 0.314 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 72 cost time: 1.351956844329834
Epoch: 72, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.313 Vali Acc: 0.920 Test Loss: 0.313 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 73 cost time: 1.204246997833252
Epoch: 73, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.320 Vali Acc: 0.920 Test Loss: 0.320 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 1.0993785858154297
Epoch: 74, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.316 Vali Acc: 0.920 Test Loss: 0.316 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 1.0167515277862549
Epoch: 75, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.313 Vali Acc: 0.920 Test Loss: 0.313 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 76 cost time: 1.245823621749878
Epoch: 76, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.313 Vali Acc: 0.920 Test Loss: 0.313 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 1.2031381130218506
Epoch: 77, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.313 Vali Acc: 0.920 Test Loss: 0.313 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 1.148832082748413
Epoch: 78, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.318 Vali Acc: 0.920 Test Loss: 0.318 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 1.17872953414917
Epoch: 79, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.322 Vali Acc: 0.920 Test Loss: 0.322 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 1.2190072536468506
Epoch: 80, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.320 Vali Acc: 0.920 Test Loss: 0.320 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 81 cost time: 1.3694977760314941
Epoch: 81, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.315 Vali Acc: 0.920 Test Loss: 0.315 Test Acc: 0.920
EarlyStopping counter: 6 out of 10
Epoch: 82 cost time: 1.183678150177002
Epoch: 82, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.317 Vali Acc: 0.920 Test Loss: 0.317 Test Acc: 0.920
EarlyStopping counter: 7 out of 10
Epoch: 83 cost time: 1.0533225536346436
Epoch: 83, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.320 Vali Acc: 0.920 Test Loss: 0.320 Test Acc: 0.920
EarlyStopping counter: 8 out of 10
Epoch: 84 cost time: 1.0305876731872559
Epoch: 84, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.321 Vali Acc: 0.920 Test Loss: 0.321 Test Acc: 0.920
EarlyStopping counter: 9 out of 10
Epoch: 85 cost time: 1.0213947296142578
Epoch: 85, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.321 Vali Acc: 0.920 Test Loss: 0.321 Test Acc: 0.920
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm32_cs18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 49286
model size : 0.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm32_cs16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.7975306510925293
Epoch: 1, Steps: 9 | Train Loss: 1.460 Vali Loss: 1.400 Vali Acc: 0.188 Test Loss: 1.400 Test Acc: 0.188
Validation loss decreased (inf --> -0.188392).  Saving model ...
Epoch: 2 cost time: 0.9487435817718506
Epoch: 2, Steps: 9 | Train Loss: 1.387 Vali Loss: 1.320 Vali Acc: 0.319 Test Loss: 1.320 Test Acc: 0.319
Validation loss decreased (-0.188392 --> -0.318827).  Saving model ...
Epoch: 3 cost time: 0.9916322231292725
Epoch: 3, Steps: 9 | Train Loss: 1.278 Vali Loss: 1.231 Vali Acc: 0.471 Test Loss: 1.231 Test Acc: 0.471
Validation loss decreased (-0.318827 --> -0.471002).  Saving model ...
Epoch: 4 cost time: 1.228750228881836
Epoch: 4, Steps: 9 | Train Loss: 1.175 Vali Loss: 1.163 Vali Acc: 0.442 Test Loss: 1.163 Test Acc: 0.442
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1646835803985596
Epoch: 5, Steps: 9 | Train Loss: 1.083 Vali Loss: 1.109 Vali Acc: 0.442 Test Loss: 1.109 Test Acc: 0.442
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9769999980926514
Epoch: 6, Steps: 9 | Train Loss: 1.016 Vali Loss: 1.078 Vali Acc: 0.449 Test Loss: 1.078 Test Acc: 0.449
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.061004400253296
Epoch: 7, Steps: 9 | Train Loss: 0.936 Vali Loss: 1.052 Vali Acc: 0.457 Test Loss: 1.052 Test Acc: 0.457
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1782243251800537
Epoch: 8, Steps: 9 | Train Loss: 0.881 Vali Loss: 1.035 Vali Acc: 0.478 Test Loss: 1.035 Test Acc: 0.478
Validation loss decreased (-0.471002 --> -0.478251).  Saving model ...
Epoch: 9 cost time: 1.2058782577514648
Epoch: 9, Steps: 9 | Train Loss: 0.830 Vali Loss: 1.027 Vali Acc: 0.471 Test Loss: 1.027 Test Acc: 0.471
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8942642211914062
Epoch: 10, Steps: 9 | Train Loss: 0.781 Vali Loss: 1.017 Vali Acc: 0.478 Test Loss: 1.017 Test Acc: 0.478
Validation loss decreased (-0.478251 --> -0.478251).  Saving model ...
Epoch: 11 cost time: 0.815788984298706
Epoch: 11, Steps: 9 | Train Loss: 0.735 Vali Loss: 1.016 Vali Acc: 0.514 Test Loss: 1.016 Test Acc: 0.514
Validation loss decreased (-0.478251 --> -0.514483).  Saving model ...
Epoch: 12 cost time: 0.9510765075683594
Epoch: 12, Steps: 9 | Train Loss: 0.698 Vali Loss: 1.015 Vali Acc: 0.500 Test Loss: 1.015 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1513879299163818
Epoch: 13, Steps: 9 | Train Loss: 0.661 Vali Loss: 1.007 Vali Acc: 0.536 Test Loss: 1.007 Test Acc: 0.536
Validation loss decreased (-0.514483 --> -0.536222).  Saving model ...
Epoch: 14 cost time: 1.1266140937805176
Epoch: 14, Steps: 9 | Train Loss: 0.622 Vali Loss: 1.012 Vali Acc: 0.543 Test Loss: 1.012 Test Acc: 0.543
Validation loss decreased (-0.536222 --> -0.543468).  Saving model ...
Epoch: 15 cost time: 0.9381229877471924
Epoch: 15, Steps: 9 | Train Loss: 0.579 Vali Loss: 1.008 Vali Acc: 0.587 Test Loss: 1.008 Test Acc: 0.587
Validation loss decreased (-0.543468 --> -0.586946).  Saving model ...
Epoch: 16 cost time: 0.9610996246337891
Epoch: 16, Steps: 9 | Train Loss: 0.568 Vali Loss: 1.021 Vali Acc: 0.572 Test Loss: 1.021 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1496410369873047
Epoch: 17, Steps: 9 | Train Loss: 0.523 Vali Loss: 1.021 Vali Acc: 0.580 Test Loss: 1.021 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1652071475982666
Epoch: 18, Steps: 9 | Train Loss: 0.510 Vali Loss: 1.030 Vali Acc: 0.601 Test Loss: 1.030 Test Acc: 0.601
Validation loss decreased (-0.586946 --> -0.601439).  Saving model ...
Epoch: 19 cost time: 1.116349220275879
Epoch: 19, Steps: 9 | Train Loss: 0.474 Vali Loss: 1.035 Vali Acc: 0.609 Test Loss: 1.035 Test Acc: 0.609
Validation loss decreased (-0.601439 --> -0.608685).  Saving model ...
Epoch: 20 cost time: 0.9055402278900146
Epoch: 20, Steps: 9 | Train Loss: 0.442 Vali Loss: 1.042 Vali Acc: 0.587 Test Loss: 1.042 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0266799926757812
Epoch: 21, Steps: 9 | Train Loss: 0.418 Vali Loss: 1.068 Vali Acc: 0.594 Test Loss: 1.068 Test Acc: 0.594
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.194570541381836
Epoch: 22, Steps: 9 | Train Loss: 0.385 Vali Loss: 1.042 Vali Acc: 0.616 Test Loss: 1.042 Test Acc: 0.616
Validation loss decreased (-0.608685 --> -0.615932).  Saving model ...
Epoch: 23 cost time: 1.0370466709136963
Epoch: 23, Steps: 9 | Train Loss: 0.353 Vali Loss: 1.054 Vali Acc: 0.630 Test Loss: 1.054 Test Acc: 0.630
Validation loss decreased (-0.615932 --> -0.630424).  Saving model ...
Epoch: 24 cost time: 1.0888450145721436
Epoch: 24, Steps: 9 | Train Loss: 0.310 Vali Loss: 1.068 Vali Acc: 0.623 Test Loss: 1.068 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9428544044494629
Epoch: 25, Steps: 9 | Train Loss: 0.288 Vali Loss: 1.065 Vali Acc: 0.638 Test Loss: 1.065 Test Acc: 0.638
Validation loss decreased (-0.630424 --> -0.637671).  Saving model ...
Epoch: 26 cost time: 0.8757750988006592
Epoch: 26, Steps: 9 | Train Loss: 0.241 Vali Loss: 1.051 Vali Acc: 0.623 Test Loss: 1.051 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0340356826782227
Epoch: 27, Steps: 9 | Train Loss: 0.204 Vali Loss: 1.033 Vali Acc: 0.623 Test Loss: 1.033 Test Acc: 0.623
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0431129932403564
Epoch: 28, Steps: 9 | Train Loss: 0.167 Vali Loss: 1.006 Vali Acc: 0.659 Test Loss: 1.006 Test Acc: 0.659
Validation loss decreased (-0.637671 --> -0.659410).  Saving model ...
Epoch: 29 cost time: 1.015939474105835
Epoch: 29, Steps: 9 | Train Loss: 0.140 Vali Loss: 0.982 Vali Acc: 0.667 Test Loss: 0.982 Test Acc: 0.667
Validation loss decreased (-0.659410 --> -0.666657).  Saving model ...
Epoch: 30 cost time: 1.1620032787322998
Epoch: 30, Steps: 9 | Train Loss: 0.122 Vali Loss: 0.963 Vali Acc: 0.659 Test Loss: 0.963 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0353648662567139
Epoch: 31, Steps: 9 | Train Loss: 0.096 Vali Loss: 0.983 Vali Acc: 0.667 Test Loss: 0.983 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9487886428833008
Epoch: 32, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.948 Vali Acc: 0.667 Test Loss: 0.948 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 33 cost time: 1.1374931335449219
Epoch: 33, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.940 Vali Acc: 0.674 Test Loss: 0.940 Test Acc: 0.674
Validation loss decreased (-0.666657 --> -0.673904).  Saving model ...
Epoch: 34 cost time: 0.9509494304656982
Epoch: 34, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.920 Vali Acc: 0.688 Test Loss: 0.920 Test Acc: 0.688
Validation loss decreased (-0.673904 --> -0.688397).  Saving model ...
Epoch: 35 cost time: 0.9696614742279053
Epoch: 35, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.902 Vali Acc: 0.703 Test Loss: 0.902 Test Acc: 0.703
Validation loss decreased (-0.688397 --> -0.702890).  Saving model ...
Epoch: 36 cost time: 1.2943572998046875
Epoch: 36, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.927 Vali Acc: 0.688 Test Loss: 0.927 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.0129530429840088
Epoch: 37, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.921 Vali Acc: 0.688 Test Loss: 0.921 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.9187541007995605
Epoch: 38, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.912 Vali Acc: 0.696 Test Loss: 0.912 Test Acc: 0.696
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.8875823020935059
Epoch: 39, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.914 Vali Acc: 0.696 Test Loss: 0.914 Test Acc: 0.696
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.8023242950439453
Epoch: 40, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.917 Vali Acc: 0.703 Test Loss: 0.917 Test Acc: 0.703
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.7490026950836182
Epoch: 41, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.926 Vali Acc: 0.710 Test Loss: 0.926 Test Acc: 0.710
Validation loss decreased (-0.702890 --> -0.710136).  Saving model ...
Epoch: 42 cost time: 0.7847259044647217
Epoch: 42, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.965 Vali Acc: 0.725 Test Loss: 0.965 Test Acc: 0.725
Validation loss decreased (-0.710136 --> -0.724628).  Saving model ...
Epoch: 43 cost time: 0.8850140571594238
Epoch: 43, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.952 Vali Acc: 0.717 Test Loss: 0.952 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.7668938636779785
Epoch: 44, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.950 Vali Acc: 0.717 Test Loss: 0.950 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.7919425964355469
Epoch: 45, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.939 Vali Acc: 0.725 Test Loss: 0.939 Test Acc: 0.725
Validation loss decreased (-0.724628 --> -0.724628).  Saving model ...
Epoch: 46 cost time: 0.8607690334320068
Epoch: 46, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.956 Vali Acc: 0.725 Test Loss: 0.956 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.8339035511016846
Epoch: 47, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.980 Vali Acc: 0.725 Test Loss: 0.980 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.0055155754089355
Epoch: 48, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.969 Vali Acc: 0.732 Test Loss: 0.969 Test Acc: 0.732
Validation loss decreased (-0.724628 --> -0.731874).  Saving model ...
Epoch: 49 cost time: 0.8112070560455322
Epoch: 49, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.982 Vali Acc: 0.732 Test Loss: 0.982 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.7812197208404541
Epoch: 50, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.987 Vali Acc: 0.732 Test Loss: 0.987 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.0684821605682373
Epoch: 51, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.987 Vali Acc: 0.739 Test Loss: 0.987 Test Acc: 0.739
Validation loss decreased (-0.731874 --> -0.739121).  Saving model ...
Epoch: 52 cost time: 1.0828626155853271
Epoch: 52, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.987 Vali Acc: 0.739 Test Loss: 0.987 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.7181546688079834
Epoch: 53, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.996 Vali Acc: 0.739 Test Loss: 0.996 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.1100833415985107
Epoch: 54, Steps: 9 | Train Loss: 0.008 Vali Loss: 1.017 Vali Acc: 0.754 Test Loss: 1.017 Test Acc: 0.754
Validation loss decreased (-0.739121 --> -0.753613).  Saving model ...
Epoch: 55 cost time: 0.906033992767334
Epoch: 55, Steps: 9 | Train Loss: 0.008 Vali Loss: 1.014 Vali Acc: 0.746 Test Loss: 1.014 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.0685858726501465
Epoch: 56, Steps: 9 | Train Loss: 0.007 Vali Loss: 1.023 Vali Acc: 0.754 Test Loss: 1.023 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.9969606399536133
Epoch: 57, Steps: 9 | Train Loss: 0.007 Vali Loss: 1.027 Vali Acc: 0.754 Test Loss: 1.027 Test Acc: 0.754
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.0541021823883057
Epoch: 58, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.030 Vali Acc: 0.761 Test Loss: 1.030 Test Acc: 0.761
Validation loss decreased (-0.753613 --> -0.760859).  Saving model ...
Epoch: 59 cost time: 1.0664517879486084
Epoch: 59, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.040 Vali Acc: 0.754 Test Loss: 1.040 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.8899695873260498
Epoch: 60, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.044 Vali Acc: 0.754 Test Loss: 1.044 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.7242341041564941
Epoch: 61, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.046 Vali Acc: 0.761 Test Loss: 1.046 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 0.898061990737915
Epoch: 62, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.064 Vali Acc: 0.761 Test Loss: 1.064 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 1.0517725944519043
Epoch: 63, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.069 Vali Acc: 0.761 Test Loss: 1.069 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 0.9627020359039307
Epoch: 64, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.077 Vali Acc: 0.754 Test Loss: 1.077 Test Acc: 0.754
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 1.1130449771881104
Epoch: 65, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.083 Vali Acc: 0.768 Test Loss: 1.083 Test Acc: 0.768
Validation loss decreased (-0.760859 --> -0.768105).  Saving model ...
Epoch: 66 cost time: 0.7986030578613281
Epoch: 66, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.086 Vali Acc: 0.768 Test Loss: 1.086 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.9206037521362305
Epoch: 67, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.096 Vali Acc: 0.761 Test Loss: 1.096 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.8469138145446777
Epoch: 68, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.093 Vali Acc: 0.761 Test Loss: 1.093 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 0.9942145347595215
Epoch: 69, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.104 Vali Acc: 0.761 Test Loss: 1.104 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 0.9896667003631592
Epoch: 70, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.102 Vali Acc: 0.761 Test Loss: 1.102 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 0.8580451011657715
Epoch: 71, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.111 Vali Acc: 0.761 Test Loss: 1.111 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 0.7894580364227295
Epoch: 72, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.106 Vali Acc: 0.768 Test Loss: 1.106 Test Acc: 0.768
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 0.9620587825775146
Epoch: 73, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.114 Vali Acc: 0.768 Test Loss: 1.114 Test Acc: 0.768
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 0.7506821155548096
Epoch: 74, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.144 Vali Acc: 0.768 Test Loss: 1.144 Test Acc: 0.768
EarlyStopping counter: 9 out of 10
Epoch: 75 cost time: 0.9488699436187744
Epoch: 75, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.145 Vali Acc: 0.768 Test Loss: 1.145 Test Acc: 0.768
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm32_cs16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.7681159420289855
model parameter : 47660
model size : 0.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm32_cs15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.8065366744995117
Epoch: 1, Steps: 9 | Train Loss: 1.429 Vali Loss: 1.431 Vali Acc: 0.254 Test Loss: 1.431 Test Acc: 0.254
Validation loss decreased (inf --> -0.253609).  Saving model ...
Epoch: 2 cost time: 0.8674545288085938
Epoch: 2, Steps: 9 | Train Loss: 1.359 Vali Loss: 1.343 Vali Acc: 0.275 Test Loss: 1.343 Test Acc: 0.275
Validation loss decreased (-0.253609 --> -0.275349).  Saving model ...
Epoch: 3 cost time: 1.4505016803741455
Epoch: 3, Steps: 9 | Train Loss: 1.249 Vali Loss: 1.244 Vali Acc: 0.435 Test Loss: 1.244 Test Acc: 0.435
Validation loss decreased (-0.275349 --> -0.434770).  Saving model ...
Epoch: 4 cost time: 1.137115478515625
Epoch: 4, Steps: 9 | Train Loss: 1.140 Vali Loss: 1.171 Vali Acc: 0.493 Test Loss: 1.171 Test Acc: 0.493
Validation loss decreased (-0.434770 --> -0.492742).  Saving model ...
Epoch: 5 cost time: 1.1510231494903564
Epoch: 5, Steps: 9 | Train Loss: 1.054 Vali Loss: 1.122 Vali Acc: 0.471 Test Loss: 1.122 Test Acc: 0.471
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.236739158630371
Epoch: 6, Steps: 9 | Train Loss: 0.980 Vali Loss: 1.087 Vali Acc: 0.486 Test Loss: 1.087 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1131486892700195
Epoch: 7, Steps: 9 | Train Loss: 0.920 Vali Loss: 1.080 Vali Acc: 0.471 Test Loss: 1.080 Test Acc: 0.471
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.157062292098999
Epoch: 8, Steps: 9 | Train Loss: 0.864 Vali Loss: 1.059 Vali Acc: 0.500 Test Loss: 1.059 Test Acc: 0.500
Validation loss decreased (-0.492742 --> -0.499989).  Saving model ...
Epoch: 9 cost time: 0.9459786415100098
Epoch: 9, Steps: 9 | Train Loss: 0.819 Vali Loss: 1.041 Vali Acc: 0.507 Test Loss: 1.041 Test Acc: 0.507
Validation loss decreased (-0.499989 --> -0.507236).  Saving model ...
Epoch: 10 cost time: 0.8572182655334473
Epoch: 10, Steps: 9 | Train Loss: 0.754 Vali Loss: 1.025 Vali Acc: 0.514 Test Loss: 1.025 Test Acc: 0.514
Validation loss decreased (-0.507236 --> -0.514483).  Saving model ...
Epoch: 11 cost time: 0.9327094554901123
Epoch: 11, Steps: 9 | Train Loss: 0.727 Vali Loss: 1.022 Vali Acc: 0.514 Test Loss: 1.022 Test Acc: 0.514
Validation loss decreased (-0.514483 --> -0.514483).  Saving model ...
Epoch: 12 cost time: 1.0273606777191162
Epoch: 12, Steps: 9 | Train Loss: 0.681 Vali Loss: 1.021 Vali Acc: 0.529 Test Loss: 1.021 Test Acc: 0.529
Validation loss decreased (-0.514483 --> -0.528975).  Saving model ...
Epoch: 13 cost time: 0.9230735301971436
Epoch: 13, Steps: 9 | Train Loss: 0.650 Vali Loss: 1.019 Vali Acc: 0.543 Test Loss: 1.019 Test Acc: 0.543
Validation loss decreased (-0.528975 --> -0.543468).  Saving model ...
Epoch: 14 cost time: 0.9720048904418945
Epoch: 14, Steps: 9 | Train Loss: 0.630 Vali Loss: 1.012 Vali Acc: 0.551 Test Loss: 1.012 Test Acc: 0.551
Validation loss decreased (-0.543468 --> -0.550715).  Saving model ...
Epoch: 15 cost time: 1.0774595737457275
Epoch: 15, Steps: 9 | Train Loss: 0.569 Vali Loss: 1.023 Vali Acc: 0.558 Test Loss: 1.023 Test Acc: 0.558
Validation loss decreased (-0.550715 --> -0.557961).  Saving model ...
Epoch: 16 cost time: 0.8223707675933838
Epoch: 16, Steps: 9 | Train Loss: 0.546 Vali Loss: 1.049 Vali Acc: 0.543 Test Loss: 1.049 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8186984062194824
Epoch: 17, Steps: 9 | Train Loss: 0.517 Vali Loss: 1.034 Vali Acc: 0.587 Test Loss: 1.034 Test Acc: 0.587
Validation loss decreased (-0.557961 --> -0.586946).  Saving model ...
Epoch: 18 cost time: 1.2052075862884521
Epoch: 18, Steps: 9 | Train Loss: 0.488 Vali Loss: 1.048 Vali Acc: 0.587 Test Loss: 1.048 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9478039741516113
Epoch: 19, Steps: 9 | Train Loss: 0.469 Vali Loss: 1.038 Vali Acc: 0.594 Test Loss: 1.038 Test Acc: 0.594
Validation loss decreased (-0.586946 --> -0.594193).  Saving model ...
Epoch: 20 cost time: 0.723198652267456
Epoch: 20, Steps: 9 | Train Loss: 0.439 Vali Loss: 1.074 Vali Acc: 0.594 Test Loss: 1.074 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9219927787780762
Epoch: 21, Steps: 9 | Train Loss: 0.422 Vali Loss: 1.075 Vali Acc: 0.580 Test Loss: 1.075 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8662934303283691
Epoch: 22, Steps: 9 | Train Loss: 0.385 Vali Loss: 1.083 Vali Acc: 0.594 Test Loss: 1.083 Test Acc: 0.594
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8222298622131348
Epoch: 23, Steps: 9 | Train Loss: 0.370 Vali Loss: 1.101 Vali Acc: 0.572 Test Loss: 1.101 Test Acc: 0.572
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.1839654445648193
Epoch: 24, Steps: 9 | Train Loss: 0.344 Vali Loss: 1.078 Vali Acc: 0.623 Test Loss: 1.078 Test Acc: 0.623
Validation loss decreased (-0.594193 --> -0.623178).  Saving model ...
Epoch: 25 cost time: 0.8326644897460938
Epoch: 25, Steps: 9 | Train Loss: 0.319 Vali Loss: 1.108 Vali Acc: 0.601 Test Loss: 1.108 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3104617595672607
Epoch: 26, Steps: 9 | Train Loss: 0.301 Vali Loss: 1.119 Vali Acc: 0.616 Test Loss: 1.119 Test Acc: 0.616
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9375927448272705
Epoch: 27, Steps: 9 | Train Loss: 0.272 Vali Loss: 1.145 Vali Acc: 0.601 Test Loss: 1.145 Test Acc: 0.601
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9956622123718262
Epoch: 28, Steps: 9 | Train Loss: 0.265 Vali Loss: 1.136 Vali Acc: 0.630 Test Loss: 1.136 Test Acc: 0.630
Validation loss decreased (-0.623178 --> -0.630423).  Saving model ...
Epoch: 29 cost time: 1.1785478591918945
Epoch: 29, Steps: 9 | Train Loss: 0.241 Vali Loss: 1.158 Vali Acc: 0.609 Test Loss: 1.158 Test Acc: 0.609
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9277341365814209
Epoch: 30, Steps: 9 | Train Loss: 0.220 Vali Loss: 1.136 Vali Acc: 0.645 Test Loss: 1.136 Test Acc: 0.645
Validation loss decreased (-0.630423 --> -0.644916).  Saving model ...
Epoch: 31 cost time: 0.7956433296203613
Epoch: 31, Steps: 9 | Train Loss: 0.198 Vali Loss: 1.141 Vali Acc: 0.630 Test Loss: 1.141 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.052708387374878
Epoch: 32, Steps: 9 | Train Loss: 0.184 Vali Loss: 1.160 Vali Acc: 0.638 Test Loss: 1.160 Test Acc: 0.638
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.9925022125244141
Epoch: 33, Steps: 9 | Train Loss: 0.167 Vali Loss: 1.135 Vali Acc: 0.652 Test Loss: 1.135 Test Acc: 0.652
Validation loss decreased (-0.644916 --> -0.652163).  Saving model ...
Epoch: 34 cost time: 0.940805196762085
Epoch: 34, Steps: 9 | Train Loss: 0.148 Vali Loss: 1.111 Vali Acc: 0.645 Test Loss: 1.111 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.7800979614257812
Epoch: 35, Steps: 9 | Train Loss: 0.134 Vali Loss: 1.081 Vali Acc: 0.659 Test Loss: 1.081 Test Acc: 0.659
Validation loss decreased (-0.652163 --> -0.659409).  Saving model ...
Epoch: 36 cost time: 1.1237022876739502
Epoch: 36, Steps: 9 | Train Loss: 0.121 Vali Loss: 1.081 Vali Acc: 0.674 Test Loss: 1.081 Test Acc: 0.674
Validation loss decreased (-0.659409 --> -0.673902).  Saving model ...
Epoch: 37 cost time: 0.9931478500366211
Epoch: 37, Steps: 9 | Train Loss: 0.104 Vali Loss: 1.051 Vali Acc: 0.667 Test Loss: 1.051 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.8503713607788086
Epoch: 38, Steps: 9 | Train Loss: 0.097 Vali Loss: 1.001 Vali Acc: 0.681 Test Loss: 1.001 Test Acc: 0.681
Validation loss decreased (-0.673902 --> -0.681149).  Saving model ...
Epoch: 39 cost time: 1.0774354934692383
Epoch: 39, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.995 Vali Acc: 0.688 Test Loss: 0.995 Test Acc: 0.688
Validation loss decreased (-0.681149 --> -0.688396).  Saving model ...
Epoch: 40 cost time: 0.8400211334228516
Epoch: 40, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.964 Vali Acc: 0.674 Test Loss: 0.964 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.1299874782562256
Epoch: 41, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.951 Vali Acc: 0.688 Test Loss: 0.951 Test Acc: 0.688
Validation loss decreased (-0.688396 --> -0.688396).  Saving model ...
Epoch: 42 cost time: 0.8569900989532471
Epoch: 42, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.957 Vali Acc: 0.696 Test Loss: 0.957 Test Acc: 0.696
Validation loss decreased (-0.688396 --> -0.695643).  Saving model ...
Epoch: 43 cost time: 0.7758488655090332
Epoch: 43, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.938 Vali Acc: 0.710 Test Loss: 0.938 Test Acc: 0.710
Validation loss decreased (-0.695643 --> -0.710136).  Saving model ...
Epoch: 44 cost time: 0.9402105808258057
Epoch: 44, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.911 Vali Acc: 0.710 Test Loss: 0.911 Test Acc: 0.710
Validation loss decreased (-0.710136 --> -0.710136).  Saving model ...
Epoch: 45 cost time: 1.0377545356750488
Epoch: 45, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.923 Vali Acc: 0.717 Test Loss: 0.923 Test Acc: 0.717
Validation loss decreased (-0.710136 --> -0.717382).  Saving model ...
Epoch: 46 cost time: 0.9562900066375732
Epoch: 46, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.915 Vali Acc: 0.717 Test Loss: 0.915 Test Acc: 0.717
Validation loss decreased (-0.717382 --> -0.717382).  Saving model ...
Epoch: 47 cost time: 1.090852975845337
Epoch: 47, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.913 Vali Acc: 0.725 Test Loss: 0.913 Test Acc: 0.725
Validation loss decreased (-0.717382 --> -0.724629).  Saving model ...
Epoch: 48 cost time: 0.8379073143005371
Epoch: 48, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.918 Vali Acc: 0.717 Test Loss: 0.918 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.8736882209777832
Epoch: 49, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.924 Vali Acc: 0.732 Test Loss: 0.924 Test Acc: 0.732
Validation loss decreased (-0.724629 --> -0.731875).  Saving model ...
Epoch: 50 cost time: 0.9437339305877686
Epoch: 50, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.918 Vali Acc: 0.739 Test Loss: 0.918 Test Acc: 0.739
Validation loss decreased (-0.731875 --> -0.739121).  Saving model ...
Epoch: 51 cost time: 0.8456594944000244
Epoch: 51, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.905 Vali Acc: 0.732 Test Loss: 0.905 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.9580807685852051
Epoch: 52, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.907 Vali Acc: 0.739 Test Loss: 0.907 Test Acc: 0.739
Validation loss decreased (-0.739121 --> -0.739121).  Saving model ...
Epoch: 53 cost time: 0.8197791576385498
Epoch: 53, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.910 Vali Acc: 0.739 Test Loss: 0.910 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.7870702743530273
Epoch: 54, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.911 Vali Acc: 0.739 Test Loss: 0.911 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.7486231327056885
Epoch: 55, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.914 Vali Acc: 0.746 Test Loss: 0.914 Test Acc: 0.746
Validation loss decreased (-0.739121 --> -0.746368).  Saving model ...
Epoch: 56 cost time: 0.9665374755859375
Epoch: 56, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.916 Vali Acc: 0.746 Test Loss: 0.916 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.8750894069671631
Epoch: 57, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.922 Vali Acc: 0.746 Test Loss: 0.922 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.7763671875
Epoch: 58, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.916 Vali Acc: 0.754 Test Loss: 0.916 Test Acc: 0.754
Validation loss decreased (-0.746368 --> -0.753614).  Saving model ...
Epoch: 59 cost time: 0.7523000240325928
Epoch: 59, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.920 Vali Acc: 0.754 Test Loss: 0.920 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.9545636177062988
Epoch: 60, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.924 Vali Acc: 0.761 Test Loss: 0.924 Test Acc: 0.761
Validation loss decreased (-0.753614 --> -0.760860).  Saving model ...
Epoch: 61 cost time: 0.6711709499359131
Epoch: 61, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.929 Vali Acc: 0.754 Test Loss: 0.929 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.9717910289764404
Epoch: 62, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.927 Vali Acc: 0.768 Test Loss: 0.927 Test Acc: 0.768
Validation loss decreased (-0.760860 --> -0.768107).  Saving model ...
Epoch: 63 cost time: 0.8495957851409912
Epoch: 63, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.929 Vali Acc: 0.768 Test Loss: 0.929 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.8076908588409424
Epoch: 64, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.927 Vali Acc: 0.768 Test Loss: 0.927 Test Acc: 0.768
Validation loss decreased (-0.768107 --> -0.768107).  Saving model ...
Epoch: 65 cost time: 0.8803238868713379
Epoch: 65, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.934 Vali Acc: 0.768 Test Loss: 0.934 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.7025258541107178
Epoch: 66, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.929 Vali Acc: 0.768 Test Loss: 0.929 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 1.1282856464385986
Epoch: 67, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.937 Vali Acc: 0.768 Test Loss: 0.937 Test Acc: 0.768
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 0.915585994720459
Epoch: 68, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.944 Vali Acc: 0.768 Test Loss: 0.944 Test Acc: 0.768
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 1.2106471061706543
Epoch: 69, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.951 Vali Acc: 0.768 Test Loss: 0.951 Test Acc: 0.768
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 0.9291276931762695
Epoch: 70, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.956 Vali Acc: 0.768 Test Loss: 0.956 Test Acc: 0.768
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 0.948218822479248
Epoch: 71, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.963 Vali Acc: 0.768 Test Loss: 0.963 Test Acc: 0.768
EarlyStopping counter: 7 out of 10
Epoch: 72 cost time: 0.9051108360290527
Epoch: 72, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.960 Vali Acc: 0.768 Test Loss: 0.960 Test Acc: 0.768
EarlyStopping counter: 8 out of 10
Epoch: 73 cost time: 0.7551577091217041
Epoch: 73, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.962 Vali Acc: 0.768 Test Loss: 0.962 Test Acc: 0.768
EarlyStopping counter: 9 out of 10
Epoch: 74 cost time: 0.6608033180236816
Epoch: 74, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.976 Vali Acc: 0.768 Test Loss: 0.976 Test Acc: 0.768
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm32_cs15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.7681159420289855
model parameter : 48114
model size : 0.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm32_cs14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.7553141117095947
Epoch: 1, Steps: 9 | Train Loss: 1.501 Vali Loss: 1.434 Vali Acc: 0.196 Test Loss: 1.434 Test Acc: 0.196
Validation loss decreased (inf --> -0.195638).  Saving model ...
Epoch: 2 cost time: 0.9575507640838623
Epoch: 2, Steps: 9 | Train Loss: 1.429 Vali Loss: 1.349 Vali Acc: 0.304 Test Loss: 1.349 Test Acc: 0.304
Validation loss decreased (-0.195638 --> -0.304334).  Saving model ...
Epoch: 3 cost time: 1.1345021724700928
Epoch: 3, Steps: 9 | Train Loss: 1.307 Vali Loss: 1.254 Vali Acc: 0.377 Test Loss: 1.254 Test Acc: 0.377
Validation loss decreased (-0.304334 --> -0.376799).  Saving model ...
Epoch: 4 cost time: 0.6591556072235107
Epoch: 4, Steps: 9 | Train Loss: 1.181 Vali Loss: 1.181 Vali Acc: 0.442 Test Loss: 1.181 Test Acc: 0.442
Validation loss decreased (-0.376799 --> -0.442017).  Saving model ...
Epoch: 5 cost time: 0.7902259826660156
Epoch: 5, Steps: 9 | Train Loss: 1.084 Vali Loss: 1.133 Vali Acc: 0.471 Test Loss: 1.133 Test Acc: 0.471
Validation loss decreased (-0.442017 --> -0.471003).  Saving model ...
Epoch: 6 cost time: 1.0473566055297852
Epoch: 6, Steps: 9 | Train Loss: 1.005 Vali Loss: 1.098 Vali Acc: 0.493 Test Loss: 1.098 Test Acc: 0.493
Validation loss decreased (-0.471003 --> -0.492743).  Saving model ...
Epoch: 7 cost time: 0.9303996562957764
Epoch: 7, Steps: 9 | Train Loss: 0.947 Vali Loss: 1.069 Vali Acc: 0.486 Test Loss: 1.069 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9537951946258545
Epoch: 8, Steps: 9 | Train Loss: 0.893 Vali Loss: 1.066 Vali Acc: 0.464 Test Loss: 1.066 Test Acc: 0.464
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9471509456634521
Epoch: 9, Steps: 9 | Train Loss: 0.839 Vali Loss: 1.059 Vali Acc: 0.493 Test Loss: 1.059 Test Acc: 0.493
Validation loss decreased (-0.492743 --> -0.492743).  Saving model ...
Epoch: 10 cost time: 0.824439287185669
Epoch: 10, Steps: 9 | Train Loss: 0.785 Vali Loss: 1.033 Vali Acc: 0.507 Test Loss: 1.033 Test Acc: 0.507
Validation loss decreased (-0.492743 --> -0.507236).  Saving model ...
Epoch: 11 cost time: 0.829176664352417
Epoch: 11, Steps: 9 | Train Loss: 0.749 Vali Loss: 1.004 Vali Acc: 0.565 Test Loss: 1.004 Test Acc: 0.565
Validation loss decreased (-0.507236 --> -0.565207).  Saving model ...
Epoch: 12 cost time: 0.8104290962219238
Epoch: 12, Steps: 9 | Train Loss: 0.690 Vali Loss: 1.009 Vali Acc: 0.551 Test Loss: 1.009 Test Acc: 0.551
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.92221999168396
Epoch: 13, Steps: 9 | Train Loss: 0.647 Vali Loss: 1.019 Vali Acc: 0.543 Test Loss: 1.019 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9567527770996094
Epoch: 14, Steps: 9 | Train Loss: 0.608 Vali Loss: 1.019 Vali Acc: 0.572 Test Loss: 1.019 Test Acc: 0.572
Validation loss decreased (-0.565207 --> -0.572454).  Saving model ...
Epoch: 15 cost time: 1.2107751369476318
Epoch: 15, Steps: 9 | Train Loss: 0.582 Vali Loss: 1.017 Vali Acc: 0.572 Test Loss: 1.017 Test Acc: 0.572
Validation loss decreased (-0.572454 --> -0.572454).  Saving model ...
Epoch: 16 cost time: 0.9533195495605469
Epoch: 16, Steps: 9 | Train Loss: 0.554 Vali Loss: 1.014 Vali Acc: 0.587 Test Loss: 1.014 Test Acc: 0.587
Validation loss decreased (-0.572454 --> -0.586946).  Saving model ...
Epoch: 17 cost time: 1.1726250648498535
Epoch: 17, Steps: 9 | Train Loss: 0.518 Vali Loss: 1.012 Vali Acc: 0.580 Test Loss: 1.012 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8673436641693115
Epoch: 18, Steps: 9 | Train Loss: 0.474 Vali Loss: 1.030 Vali Acc: 0.594 Test Loss: 1.030 Test Acc: 0.594
Validation loss decreased (-0.586946 --> -0.594193).  Saving model ...
Epoch: 19 cost time: 1.1422433853149414
Epoch: 19, Steps: 9 | Train Loss: 0.444 Vali Loss: 1.023 Vali Acc: 0.601 Test Loss: 1.023 Test Acc: 0.601
Validation loss decreased (-0.594193 --> -0.601439).  Saving model ...
Epoch: 20 cost time: 0.9788000583648682
Epoch: 20, Steps: 9 | Train Loss: 0.415 Vali Loss: 1.020 Vali Acc: 0.630 Test Loss: 1.020 Test Acc: 0.630
Validation loss decreased (-0.601439 --> -0.630425).  Saving model ...
Epoch: 21 cost time: 0.774163007736206
Epoch: 21, Steps: 9 | Train Loss: 0.388 Vali Loss: 1.032 Vali Acc: 0.609 Test Loss: 1.032 Test Acc: 0.609
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9798593521118164
Epoch: 22, Steps: 9 | Train Loss: 0.352 Vali Loss: 1.021 Vali Acc: 0.623 Test Loss: 1.021 Test Acc: 0.623
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9980669021606445
Epoch: 23, Steps: 9 | Train Loss: 0.314 Vali Loss: 1.012 Vali Acc: 0.638 Test Loss: 1.012 Test Acc: 0.638
Validation loss decreased (-0.630425 --> -0.637671).  Saving model ...
Epoch: 24 cost time: 1.0301403999328613
Epoch: 24, Steps: 9 | Train Loss: 0.288 Vali Loss: 0.987 Vali Acc: 0.638 Test Loss: 0.987 Test Acc: 0.638
Validation loss decreased (-0.637671 --> -0.637671).  Saving model ...
Epoch: 25 cost time: 0.8212387561798096
Epoch: 25, Steps: 9 | Train Loss: 0.250 Vali Loss: 0.970 Vali Acc: 0.623 Test Loss: 0.970 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0075063705444336
Epoch: 26, Steps: 9 | Train Loss: 0.219 Vali Loss: 0.925 Vali Acc: 0.616 Test Loss: 0.925 Test Acc: 0.616
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.702627420425415
Epoch: 27, Steps: 9 | Train Loss: 0.180 Vali Loss: 0.899 Vali Acc: 0.645 Test Loss: 0.899 Test Acc: 0.645
Validation loss decreased (-0.637671 --> -0.644919).  Saving model ...
Epoch: 28 cost time: 0.9162065982818604
Epoch: 28, Steps: 9 | Train Loss: 0.151 Vali Loss: 0.884 Vali Acc: 0.674 Test Loss: 0.884 Test Acc: 0.674
Validation loss decreased (-0.644919 --> -0.673904).  Saving model ...
Epoch: 29 cost time: 1.0165414810180664
Epoch: 29, Steps: 9 | Train Loss: 0.133 Vali Loss: 0.889 Vali Acc: 0.681 Test Loss: 0.889 Test Acc: 0.681
Validation loss decreased (-0.673904 --> -0.681151).  Saving model ...
Epoch: 30 cost time: 0.9537475109100342
Epoch: 30, Steps: 9 | Train Loss: 0.110 Vali Loss: 0.846 Vali Acc: 0.674 Test Loss: 0.846 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.10404372215271
Epoch: 31, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.853 Vali Acc: 0.681 Test Loss: 0.853 Test Acc: 0.681
Validation loss decreased (-0.681151 --> -0.681151).  Saving model ...
Epoch: 32 cost time: 0.8575494289398193
Epoch: 32, Steps: 9 | Train Loss: 0.087 Vali Loss: 0.825 Vali Acc: 0.703 Test Loss: 0.825 Test Acc: 0.703
Validation loss decreased (-0.681151 --> -0.702890).  Saving model ...
Epoch: 33 cost time: 1.315972089767456
Epoch: 33, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.831 Vali Acc: 0.681 Test Loss: 0.831 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9700405597686768
Epoch: 34, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.843 Vali Acc: 0.696 Test Loss: 0.843 Test Acc: 0.696
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.0561068058013916
Epoch: 35, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.854 Vali Acc: 0.703 Test Loss: 0.854 Test Acc: 0.703
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.8437783718109131
Epoch: 36, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.829 Vali Acc: 0.725 Test Loss: 0.829 Test Acc: 0.725
Validation loss decreased (-0.702890 --> -0.724629).  Saving model ...
Epoch: 37 cost time: 0.7875025272369385
Epoch: 37, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.836 Vali Acc: 0.725 Test Loss: 0.836 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7213907241821289
Epoch: 38, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.829 Vali Acc: 0.739 Test Loss: 0.829 Test Acc: 0.739
Validation loss decreased (-0.724629 --> -0.739122).  Saving model ...
Epoch: 39 cost time: 0.899423360824585
Epoch: 39, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.853 Vali Acc: 0.732 Test Loss: 0.853 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.9495542049407959
Epoch: 40, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.859 Vali Acc: 0.754 Test Loss: 0.859 Test Acc: 0.754
Validation loss decreased (-0.739122 --> -0.753615).  Saving model ...
Epoch: 41 cost time: 0.7968015670776367
Epoch: 41, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.837 Vali Acc: 0.746 Test Loss: 0.837 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.8783454895019531
Epoch: 42, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.849 Vali Acc: 0.739 Test Loss: 0.849 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.9919600486755371
Epoch: 43, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.856 Vali Acc: 0.754 Test Loss: 0.856 Test Acc: 0.754
Validation loss decreased (-0.753615 --> -0.753615).  Saving model ...
Epoch: 44 cost time: 1.0780436992645264
Epoch: 44, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.845 Vali Acc: 0.754 Test Loss: 0.845 Test Acc: 0.754
Validation loss decreased (-0.753615 --> -0.753615).  Saving model ...
Epoch: 45 cost time: 0.8286340236663818
Epoch: 45, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.848 Vali Acc: 0.746 Test Loss: 0.848 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.7336196899414062
Epoch: 46, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.871 Vali Acc: 0.754 Test Loss: 0.871 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.8138267993927002
Epoch: 47, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.861 Vali Acc: 0.754 Test Loss: 0.861 Test Acc: 0.754
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.9825899600982666
Epoch: 48, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.853 Vali Acc: 0.754 Test Loss: 0.853 Test Acc: 0.754
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.9989221096038818
Epoch: 49, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.876 Vali Acc: 0.754 Test Loss: 0.876 Test Acc: 0.754
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.9685328006744385
Epoch: 50, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.880 Vali Acc: 0.754 Test Loss: 0.880 Test Acc: 0.754
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.1061408519744873
Epoch: 51, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.868 Vali Acc: 0.746 Test Loss: 0.868 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 0.8374340534210205
Epoch: 52, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.854 Vali Acc: 0.761 Test Loss: 0.854 Test Acc: 0.761
Validation loss decreased (-0.753615 --> -0.760861).  Saving model ...
Epoch: 53 cost time: 1.0079395771026611
Epoch: 53, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.872 Vali Acc: 0.746 Test Loss: 0.872 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.1392712593078613
Epoch: 54, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.876 Vali Acc: 0.754 Test Loss: 0.876 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.7795841693878174
Epoch: 55, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.874 Vali Acc: 0.768 Test Loss: 0.874 Test Acc: 0.768
Validation loss decreased (-0.760861 --> -0.768107).  Saving model ...
Epoch: 56 cost time: 0.955866813659668
Epoch: 56, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.890 Vali Acc: 0.761 Test Loss: 0.890 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.696295976638794
Epoch: 57, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.893 Vali Acc: 0.761 Test Loss: 0.893 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.1237268447875977
Epoch: 58, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.873 Vali Acc: 0.768 Test Loss: 0.873 Test Acc: 0.768
Validation loss decreased (-0.768107 --> -0.768107).  Saving model ...
Epoch: 59 cost time: 1.1483891010284424
Epoch: 59, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.886 Vali Acc: 0.754 Test Loss: 0.886 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.8232457637786865
Epoch: 60, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.884 Vali Acc: 0.761 Test Loss: 0.884 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 1.1823034286499023
Epoch: 61, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.892 Vali Acc: 0.761 Test Loss: 0.892 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 0.8687417507171631
Epoch: 62, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.898 Vali Acc: 0.761 Test Loss: 0.898 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 0.916468620300293
Epoch: 63, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.891 Vali Acc: 0.768 Test Loss: 0.891 Test Acc: 0.768
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 0.9820711612701416
Epoch: 64, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.897 Vali Acc: 0.761 Test Loss: 0.897 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 0.8952739238739014
Epoch: 65, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.909 Vali Acc: 0.761 Test Loss: 0.909 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 0.914431095123291
Epoch: 66, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.912 Vali Acc: 0.761 Test Loss: 0.912 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 67 cost time: 0.8221621513366699
Epoch: 67, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.910 Vali Acc: 0.761 Test Loss: 0.910 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 68 cost time: 1.0215682983398438
Epoch: 68, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.904 Vali Acc: 0.768 Test Loss: 0.904 Test Acc: 0.768
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm32_cs14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.7681159420289855
model parameter : 48160
model size : 0.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm32_cs13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.171652317047119
Epoch: 1, Steps: 9 | Train Loss: 1.513 Vali Loss: 1.411 Vali Acc: 0.283 Test Loss: 1.411 Test Acc: 0.283
Validation loss decreased (inf --> -0.282595).  Saving model ...
Epoch: 2 cost time: 1.026273250579834
Epoch: 2, Steps: 9 | Train Loss: 1.416 Vali Loss: 1.313 Vali Acc: 0.333 Test Loss: 1.313 Test Acc: 0.333
Validation loss decreased (-0.282595 --> -0.333320).  Saving model ...
Epoch: 3 cost time: 0.7364227771759033
Epoch: 3, Steps: 9 | Train Loss: 1.280 Vali Loss: 1.220 Vali Acc: 0.384 Test Loss: 1.220 Test Acc: 0.384
Validation loss decreased (-0.333320 --> -0.384046).  Saving model ...
Epoch: 4 cost time: 1.131779432296753
Epoch: 4, Steps: 9 | Train Loss: 1.174 Vali Loss: 1.144 Vali Acc: 0.457 Test Loss: 1.144 Test Acc: 0.457
Validation loss decreased (-0.384046 --> -0.456510).  Saving model ...
Epoch: 5 cost time: 0.9129533767700195
Epoch: 5, Steps: 9 | Train Loss: 1.064 Vali Loss: 1.096 Vali Acc: 0.486 Test Loss: 1.096 Test Acc: 0.486
Validation loss decreased (-0.456510 --> -0.485496).  Saving model ...
Epoch: 6 cost time: 0.7210192680358887
Epoch: 6, Steps: 9 | Train Loss: 0.996 Vali Loss: 1.068 Vali Acc: 0.514 Test Loss: 1.068 Test Acc: 0.514
Validation loss decreased (-0.485496 --> -0.514482).  Saving model ...
Epoch: 7 cost time: 0.875542402267456
Epoch: 7, Steps: 9 | Train Loss: 0.936 Vali Loss: 1.048 Vali Acc: 0.514 Test Loss: 1.048 Test Acc: 0.514
Validation loss decreased (-0.514482 --> -0.514482).  Saving model ...
Epoch: 8 cost time: 0.7251777648925781
Epoch: 8, Steps: 9 | Train Loss: 0.879 Vali Loss: 1.032 Vali Acc: 0.551 Test Loss: 1.032 Test Acc: 0.551
Validation loss decreased (-0.514482 --> -0.550714).  Saving model ...
Epoch: 9 cost time: 0.9447031021118164
Epoch: 9, Steps: 9 | Train Loss: 0.838 Vali Loss: 1.011 Vali Acc: 0.536 Test Loss: 1.011 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1357691287994385
Epoch: 10, Steps: 9 | Train Loss: 0.777 Vali Loss: 1.003 Vali Acc: 0.558 Test Loss: 1.003 Test Acc: 0.558
Validation loss decreased (-0.550714 --> -0.557961).  Saving model ...
Epoch: 11 cost time: 1.1821396350860596
Epoch: 11, Steps: 9 | Train Loss: 0.739 Vali Loss: 1.003 Vali Acc: 0.558 Test Loss: 1.003 Test Acc: 0.558
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1624326705932617
Epoch: 12, Steps: 9 | Train Loss: 0.698 Vali Loss: 0.999 Vali Acc: 0.565 Test Loss: 0.999 Test Acc: 0.565
Validation loss decreased (-0.557961 --> -0.565207).  Saving model ...
Epoch: 13 cost time: 0.9424169063568115
Epoch: 13, Steps: 9 | Train Loss: 0.656 Vali Loss: 0.997 Vali Acc: 0.558 Test Loss: 0.997 Test Acc: 0.558
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0960171222686768
Epoch: 14, Steps: 9 | Train Loss: 0.626 Vali Loss: 0.995 Vali Acc: 0.580 Test Loss: 0.995 Test Acc: 0.580
Validation loss decreased (-0.565207 --> -0.579700).  Saving model ...
Epoch: 15 cost time: 0.7891783714294434
Epoch: 15, Steps: 9 | Train Loss: 0.589 Vali Loss: 0.998 Vali Acc: 0.565 Test Loss: 0.998 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6567661762237549
Epoch: 16, Steps: 9 | Train Loss: 0.541 Vali Loss: 1.020 Vali Acc: 0.587 Test Loss: 1.020 Test Acc: 0.587
Validation loss decreased (-0.579700 --> -0.586946).  Saving model ...
Epoch: 17 cost time: 1.0359463691711426
Epoch: 17, Steps: 9 | Train Loss: 0.524 Vali Loss: 1.039 Vali Acc: 0.594 Test Loss: 1.039 Test Acc: 0.594
Validation loss decreased (-0.586946 --> -0.594193).  Saving model ...
Epoch: 18 cost time: 0.9281339645385742
Epoch: 18, Steps: 9 | Train Loss: 0.492 Vali Loss: 1.029 Vali Acc: 0.594 Test Loss: 1.029 Test Acc: 0.594
Validation loss decreased (-0.594193 --> -0.594193).  Saving model ...
Epoch: 19 cost time: 0.7875039577484131
Epoch: 19, Steps: 9 | Train Loss: 0.468 Vali Loss: 1.028 Vali Acc: 0.616 Test Loss: 1.028 Test Acc: 0.616
Validation loss decreased (-0.594193 --> -0.615932).  Saving model ...
Epoch: 20 cost time: 0.9695672988891602
Epoch: 20, Steps: 9 | Train Loss: 0.437 Vali Loss: 1.055 Vali Acc: 0.580 Test Loss: 1.055 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1306061744689941
Epoch: 21, Steps: 9 | Train Loss: 0.408 Vali Loss: 1.071 Vali Acc: 0.594 Test Loss: 1.071 Test Acc: 0.594
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9258241653442383
Epoch: 22, Steps: 9 | Train Loss: 0.377 Vali Loss: 1.069 Vali Acc: 0.638 Test Loss: 1.069 Test Acc: 0.638
Validation loss decreased (-0.615932 --> -0.637670).  Saving model ...
Epoch: 23 cost time: 0.9259567260742188
Epoch: 23, Steps: 9 | Train Loss: 0.361 Vali Loss: 1.099 Vali Acc: 0.609 Test Loss: 1.099 Test Acc: 0.609
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.889333963394165
Epoch: 24, Steps: 9 | Train Loss: 0.338 Vali Loss: 1.099 Vali Acc: 0.630 Test Loss: 1.099 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8157558441162109
Epoch: 25, Steps: 9 | Train Loss: 0.314 Vali Loss: 1.124 Vali Acc: 0.630 Test Loss: 1.124 Test Acc: 0.630
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.9190232753753662
Epoch: 26, Steps: 9 | Train Loss: 0.292 Vali Loss: 1.130 Vali Acc: 0.645 Test Loss: 1.130 Test Acc: 0.645
Validation loss decreased (-0.637670 --> -0.644916).  Saving model ...
Epoch: 27 cost time: 0.8136656284332275
Epoch: 27, Steps: 9 | Train Loss: 0.277 Vali Loss: 1.134 Vali Acc: 0.623 Test Loss: 1.134 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0552241802215576
Epoch: 28, Steps: 9 | Train Loss: 0.262 Vali Loss: 1.170 Vali Acc: 0.623 Test Loss: 1.170 Test Acc: 0.623
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8284413814544678
Epoch: 29, Steps: 9 | Train Loss: 0.239 Vali Loss: 1.179 Vali Acc: 0.645 Test Loss: 1.179 Test Acc: 0.645
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.0354218482971191
Epoch: 30, Steps: 9 | Train Loss: 0.218 Vali Loss: 1.173 Vali Acc: 0.652 Test Loss: 1.173 Test Acc: 0.652
Validation loss decreased (-0.644916 --> -0.652162).  Saving model ...
Epoch: 31 cost time: 1.237241506576538
Epoch: 31, Steps: 9 | Train Loss: 0.203 Vali Loss: 1.187 Vali Acc: 0.652 Test Loss: 1.187 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.15189790725708
Epoch: 32, Steps: 9 | Train Loss: 0.185 Vali Loss: 1.200 Vali Acc: 0.667 Test Loss: 1.200 Test Acc: 0.667
Validation loss decreased (-0.652162 --> -0.666655).  Saving model ...
Epoch: 33 cost time: 0.9129068851470947
Epoch: 33, Steps: 9 | Train Loss: 0.169 Vali Loss: 1.220 Vali Acc: 0.674 Test Loss: 1.220 Test Acc: 0.674
Validation loss decreased (-0.666655 --> -0.673901).  Saving model ...
Epoch: 34 cost time: 0.8082482814788818
Epoch: 34, Steps: 9 | Train Loss: 0.152 Vali Loss: 1.225 Vali Acc: 0.674 Test Loss: 1.225 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8001670837402344
Epoch: 35, Steps: 9 | Train Loss: 0.137 Vali Loss: 1.212 Vali Acc: 0.681 Test Loss: 1.212 Test Acc: 0.681
Validation loss decreased (-0.673901 --> -0.681147).  Saving model ...
Epoch: 36 cost time: 0.6505720615386963
Epoch: 36, Steps: 9 | Train Loss: 0.125 Vali Loss: 1.217 Vali Acc: 0.696 Test Loss: 1.217 Test Acc: 0.696
Validation loss decreased (-0.681147 --> -0.695640).  Saving model ...
Epoch: 37 cost time: 0.8615431785583496
Epoch: 37, Steps: 9 | Train Loss: 0.108 Vali Loss: 1.189 Vali Acc: 0.696 Test Loss: 1.189 Test Acc: 0.696
Validation loss decreased (-0.695640 --> -0.695640).  Saving model ...
Epoch: 38 cost time: 1.0062179565429688
Epoch: 38, Steps: 9 | Train Loss: 0.099 Vali Loss: 1.152 Vali Acc: 0.696 Test Loss: 1.152 Test Acc: 0.696
Validation loss decreased (-0.695640 --> -0.695641).  Saving model ...
Epoch: 39 cost time: 0.9471883773803711
Epoch: 39, Steps: 9 | Train Loss: 0.086 Vali Loss: 1.169 Vali Acc: 0.681 Test Loss: 1.169 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.1039783954620361
Epoch: 40, Steps: 9 | Train Loss: 0.074 Vali Loss: 1.149 Vali Acc: 0.681 Test Loss: 1.149 Test Acc: 0.681
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.1143882274627686
Epoch: 41, Steps: 9 | Train Loss: 0.070 Vali Loss: 1.103 Vali Acc: 0.696 Test Loss: 1.103 Test Acc: 0.696
Validation loss decreased (-0.695641 --> -0.695641).  Saving model ...
Epoch: 42 cost time: 0.698249340057373
Epoch: 42, Steps: 9 | Train Loss: 0.058 Vali Loss: 1.091 Vali Acc: 0.696 Test Loss: 1.091 Test Acc: 0.696
Validation loss decreased (-0.695641 --> -0.695641).  Saving model ...
Epoch: 43 cost time: 0.707815408706665
Epoch: 43, Steps: 9 | Train Loss: 0.051 Vali Loss: 1.073 Vali Acc: 0.710 Test Loss: 1.073 Test Acc: 0.710
Validation loss decreased (-0.695641 --> -0.710134).  Saving model ...
Epoch: 44 cost time: 1.0726027488708496
Epoch: 44, Steps: 9 | Train Loss: 0.046 Vali Loss: 1.020 Vali Acc: 0.732 Test Loss: 1.020 Test Acc: 0.732
Validation loss decreased (-0.710134 --> -0.731874).  Saving model ...
Epoch: 45 cost time: 0.7695021629333496
Epoch: 45, Steps: 9 | Train Loss: 0.040 Vali Loss: 1.015 Vali Acc: 0.732 Test Loss: 1.015 Test Acc: 0.732
Validation loss decreased (-0.731874 --> -0.731874).  Saving model ...
Epoch: 46 cost time: 1.0049118995666504
Epoch: 46, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.966 Vali Acc: 0.732 Test Loss: 0.966 Test Acc: 0.732
Validation loss decreased (-0.731874 --> -0.731874).  Saving model ...
Epoch: 47 cost time: 1.0016422271728516
Epoch: 47, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.952 Vali Acc: 0.732 Test Loss: 0.952 Test Acc: 0.732
Validation loss decreased (-0.731874 --> -0.731875).  Saving model ...
Epoch: 48 cost time: 1.2188878059387207
Epoch: 48, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.945 Vali Acc: 0.732 Test Loss: 0.945 Test Acc: 0.732
Validation loss decreased (-0.731875 --> -0.731875).  Saving model ...
Epoch: 49 cost time: 0.8745176792144775
Epoch: 49, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.951 Vali Acc: 0.739 Test Loss: 0.951 Test Acc: 0.739
Validation loss decreased (-0.731875 --> -0.739121).  Saving model ...
Epoch: 50 cost time: 0.8694872856140137
Epoch: 50, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.913 Vali Acc: 0.746 Test Loss: 0.913 Test Acc: 0.746
Validation loss decreased (-0.739121 --> -0.746368).  Saving model ...
Epoch: 51 cost time: 0.880624532699585
Epoch: 51, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.913 Vali Acc: 0.746 Test Loss: 0.913 Test Acc: 0.746
Validation loss decreased (-0.746368 --> -0.746368).  Saving model ...
Epoch: 52 cost time: 0.965843677520752
Epoch: 52, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.873 Vali Acc: 0.768 Test Loss: 0.873 Test Acc: 0.768
Validation loss decreased (-0.746368 --> -0.768107).  Saving model ...
Epoch: 53 cost time: 0.9651291370391846
Epoch: 53, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.843 Vali Acc: 0.768 Test Loss: 0.843 Test Acc: 0.768
Validation loss decreased (-0.768107 --> -0.768108).  Saving model ...
Epoch: 54 cost time: 0.9025731086730957
Epoch: 54, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.842 Vali Acc: 0.768 Test Loss: 0.842 Test Acc: 0.768
Validation loss decreased (-0.768108 --> -0.768108).  Saving model ...
Epoch: 55 cost time: 1.0417098999023438
Epoch: 55, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.832 Vali Acc: 0.768 Test Loss: 0.832 Test Acc: 0.768
Validation loss decreased (-0.768108 --> -0.768108).  Saving model ...
Epoch: 56 cost time: 1.194671630859375
Epoch: 56, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.819 Vali Acc: 0.768 Test Loss: 0.819 Test Acc: 0.768
Validation loss decreased (-0.768108 --> -0.768108).  Saving model ...
Epoch: 57 cost time: 1.1509242057800293
Epoch: 57, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.815 Vali Acc: 0.768 Test Loss: 0.815 Test Acc: 0.768
Validation loss decreased (-0.768108 --> -0.768108).  Saving model ...
Epoch: 58 cost time: 1.019888162612915
Epoch: 58, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.803 Vali Acc: 0.783 Test Loss: 0.803 Test Acc: 0.783
Validation loss decreased (-0.768108 --> -0.782601).  Saving model ...
Epoch: 59 cost time: 1.0327999591827393
Epoch: 59, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.789 Vali Acc: 0.790 Test Loss: 0.789 Test Acc: 0.790
Validation loss decreased (-0.782601 --> -0.789847).  Saving model ...
Epoch: 60 cost time: 0.9058480262756348
Epoch: 60, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.776 Vali Acc: 0.790 Test Loss: 0.776 Test Acc: 0.790
Validation loss decreased (-0.789847 --> -0.789847).  Saving model ...
Epoch: 61 cost time: 0.9307169914245605
Epoch: 61, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.782 Vali Acc: 0.783 Test Loss: 0.782 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.6754214763641357
Epoch: 62, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.773 Vali Acc: 0.797 Test Loss: 0.773 Test Acc: 0.797
Validation loss decreased (-0.789847 --> -0.797094).  Saving model ...
Epoch: 63 cost time: 0.7613525390625
Epoch: 63, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.753 Vali Acc: 0.797 Test Loss: 0.753 Test Acc: 0.797
Validation loss decreased (-0.797094 --> -0.797094).  Saving model ...
Epoch: 64 cost time: 1.132957935333252
Epoch: 64, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.737 Vali Acc: 0.797 Test Loss: 0.737 Test Acc: 0.797
Validation loss decreased (-0.797094 --> -0.797094).  Saving model ...
Epoch: 65 cost time: 0.82979416847229
Epoch: 65, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.738 Vali Acc: 0.804 Test Loss: 0.738 Test Acc: 0.804
Validation loss decreased (-0.797094 --> -0.804340).  Saving model ...
Epoch: 66 cost time: 1.0315790176391602
Epoch: 66, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.742 Vali Acc: 0.790 Test Loss: 0.742 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.9975028038024902
Epoch: 67, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.731 Vali Acc: 0.790 Test Loss: 0.731 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.7982842922210693
Epoch: 68, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.726 Vali Acc: 0.790 Test Loss: 0.726 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 0.738440752029419
Epoch: 69, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.730 Vali Acc: 0.790 Test Loss: 0.730 Test Acc: 0.790
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 1.0041351318359375
Epoch: 70, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.725 Vali Acc: 0.790 Test Loss: 0.725 Test Acc: 0.790
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 0.9669172763824463
Epoch: 71, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.719 Vali Acc: 0.790 Test Loss: 0.719 Test Acc: 0.790
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 0.8491508960723877
Epoch: 72, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.716 Vali Acc: 0.797 Test Loss: 0.716 Test Acc: 0.797
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 0.970130205154419
Epoch: 73, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.707 Vali Acc: 0.804 Test Loss: 0.707 Test Acc: 0.804
Validation loss decreased (-0.804340 --> -0.804341).  Saving model ...
Epoch: 74 cost time: 0.9563493728637695
Epoch: 74, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.697 Vali Acc: 0.812 Test Loss: 0.697 Test Acc: 0.812
Validation loss decreased (-0.804341 --> -0.811587).  Saving model ...
Epoch: 75 cost time: 0.8739700317382812
Epoch: 75, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.699 Vali Acc: 0.812 Test Loss: 0.699 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 1.0883457660675049
Epoch: 76, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.694 Vali Acc: 0.819 Test Loss: 0.694 Test Acc: 0.819
Validation loss decreased (-0.811587 --> -0.818834).  Saving model ...
Epoch: 77 cost time: 0.7375447750091553
Epoch: 77, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.691 Vali Acc: 0.819 Test Loss: 0.691 Test Acc: 0.819
Validation loss decreased (-0.818834 --> -0.818834).  Saving model ...
Epoch: 78 cost time: 0.7807860374450684
Epoch: 78, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.685 Vali Acc: 0.819 Test Loss: 0.685 Test Acc: 0.819
Validation loss decreased (-0.818834 --> -0.818834).  Saving model ...
Epoch: 79 cost time: 1.0660789012908936
Epoch: 79, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.677 Vali Acc: 0.826 Test Loss: 0.677 Test Acc: 0.826
Validation loss decreased (-0.818834 --> -0.826080).  Saving model ...
Epoch: 80 cost time: 0.8877601623535156
Epoch: 80, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.672 Vali Acc: 0.819 Test Loss: 0.672 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 0.9614839553833008
Epoch: 81, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.672 Vali Acc: 0.826 Test Loss: 0.672 Test Acc: 0.826
Validation loss decreased (-0.826080 --> -0.826080).  Saving model ...
Epoch: 82 cost time: 0.7919824123382568
Epoch: 82, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.670 Vali Acc: 0.826 Test Loss: 0.670 Test Acc: 0.826
Validation loss decreased (-0.826080 --> -0.826080).  Saving model ...
Epoch: 83 cost time: 0.7920141220092773
Epoch: 83, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.667 Vali Acc: 0.833 Test Loss: 0.667 Test Acc: 0.833
Validation loss decreased (-0.826080 --> -0.833327).  Saving model ...
Epoch: 84 cost time: 0.6863481998443604
Epoch: 84, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.668 Vali Acc: 0.833 Test Loss: 0.668 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 0.9413790702819824
Epoch: 85, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.662 Vali Acc: 0.833 Test Loss: 0.662 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 86 cost time: 0.7645409107208252
Epoch: 86, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.657 Vali Acc: 0.833 Test Loss: 0.657 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 87 cost time: 0.9578464031219482
Epoch: 87, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.653 Vali Acc: 0.826 Test Loss: 0.653 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 0.8459534645080566
Epoch: 88, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.653 Vali Acc: 0.826 Test Loss: 0.653 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 89 cost time: 0.6720194816589355
Epoch: 89, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.650 Vali Acc: 0.826 Test Loss: 0.650 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 90 cost time: 0.705315113067627
Epoch: 90, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.646 Vali Acc: 0.826 Test Loss: 0.646 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 91 cost time: 0.984933614730835
Epoch: 91, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.642 Vali Acc: 0.826 Test Loss: 0.642 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 92 cost time: 1.074841022491455
Epoch: 92, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.643 Vali Acc: 0.833 Test Loss: 0.643 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 93 cost time: 0.974776029586792
Epoch: 93, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.641 Vali Acc: 0.833 Test Loss: 0.641 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 94 cost time: 0.715811014175415
Epoch: 94, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.637 Vali Acc: 0.833 Test Loss: 0.637 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 95 cost time: 0.9202396869659424
Epoch: 95, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.634 Vali Acc: 0.833 Test Loss: 0.634 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 96 cost time: 0.8786239624023438
Epoch: 96, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.637 Vali Acc: 0.833 Test Loss: 0.637 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 0.7782154083251953
Epoch: 97, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.637 Vali Acc: 0.833 Test Loss: 0.637 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 98 cost time: 0.8459713459014893
Epoch: 98, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.635 Vali Acc: 0.833 Test Loss: 0.635 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 99 cost time: 0.6587123870849609
Epoch: 99, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.631 Vali Acc: 0.833 Test Loss: 0.631 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 100 cost time: 1.044978141784668
Epoch: 100, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.632 Vali Acc: 0.833 Test Loss: 0.632 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm32_cs13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8333333333333334
model parameter : 47798
model size : 0.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm32_cs12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.4866654872894287
Epoch: 1, Steps: 9 | Train Loss: 1.417 Vali Loss: 1.369 Vali Acc: 0.283 Test Loss: 1.369 Test Acc: 0.283
Validation loss decreased (inf --> -0.282595).  Saving model ...
Epoch: 2 cost time: 1.0155351161956787
Epoch: 2, Steps: 9 | Train Loss: 1.338 Vali Loss: 1.285 Vali Acc: 0.399 Test Loss: 1.285 Test Acc: 0.399
Validation loss decreased (-0.282595 --> -0.398538).  Saving model ...
Epoch: 3 cost time: 0.8375890254974365
Epoch: 3, Steps: 9 | Train Loss: 1.234 Vali Loss: 1.209 Vali Acc: 0.413 Test Loss: 1.209 Test Acc: 0.413
Validation loss decreased (-0.398538 --> -0.413031).  Saving model ...
Epoch: 4 cost time: 1.002647876739502
Epoch: 4, Steps: 9 | Train Loss: 1.127 Vali Loss: 1.140 Vali Acc: 0.449 Test Loss: 1.140 Test Acc: 0.449
Validation loss decreased (-0.413031 --> -0.449264).  Saving model ...
Epoch: 5 cost time: 0.7294738292694092
Epoch: 5, Steps: 9 | Train Loss: 1.037 Vali Loss: 1.097 Vali Acc: 0.471 Test Loss: 1.097 Test Acc: 0.471
Validation loss decreased (-0.449264 --> -0.471004).  Saving model ...
Epoch: 6 cost time: 0.7447235584259033
Epoch: 6, Steps: 9 | Train Loss: 0.957 Vali Loss: 1.069 Vali Acc: 0.457 Test Loss: 1.069 Test Acc: 0.457
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.92547607421875
Epoch: 7, Steps: 9 | Train Loss: 0.933 Vali Loss: 1.050 Vali Acc: 0.464 Test Loss: 1.050 Test Acc: 0.464
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7679572105407715
Epoch: 8, Steps: 9 | Train Loss: 0.860 Vali Loss: 1.035 Vali Acc: 0.507 Test Loss: 1.035 Test Acc: 0.507
Validation loss decreased (-0.471004 --> -0.507236).  Saving model ...
Epoch: 9 cost time: 0.8876354694366455
Epoch: 9, Steps: 9 | Train Loss: 0.805 Vali Loss: 1.025 Vali Acc: 0.514 Test Loss: 1.025 Test Acc: 0.514
Validation loss decreased (-0.507236 --> -0.514483).  Saving model ...
Epoch: 10 cost time: 0.813361406326294
Epoch: 10, Steps: 9 | Train Loss: 0.764 Vali Loss: 1.024 Vali Acc: 0.536 Test Loss: 1.024 Test Acc: 0.536
Validation loss decreased (-0.514483 --> -0.536222).  Saving model ...
Epoch: 11 cost time: 0.9582850933074951
Epoch: 11, Steps: 9 | Train Loss: 0.727 Vali Loss: 1.026 Vali Acc: 0.514 Test Loss: 1.026 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7735834121704102
Epoch: 12, Steps: 9 | Train Loss: 0.693 Vali Loss: 1.003 Vali Acc: 0.558 Test Loss: 1.003 Test Acc: 0.558
Validation loss decreased (-0.536222 --> -0.557961).  Saving model ...
Epoch: 13 cost time: 0.7377817630767822
Epoch: 13, Steps: 9 | Train Loss: 0.646 Vali Loss: 1.011 Vali Acc: 0.572 Test Loss: 1.011 Test Acc: 0.572
Validation loss decreased (-0.557961 --> -0.572454).  Saving model ...
Epoch: 14 cost time: 0.9060103893280029
Epoch: 14, Steps: 9 | Train Loss: 0.620 Vali Loss: 1.013 Vali Acc: 0.580 Test Loss: 1.013 Test Acc: 0.580
Validation loss decreased (-0.572454 --> -0.579700).  Saving model ...
Epoch: 15 cost time: 0.7913038730621338
Epoch: 15, Steps: 9 | Train Loss: 0.580 Vali Loss: 1.015 Vali Acc: 0.565 Test Loss: 1.015 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8192973136901855
Epoch: 16, Steps: 9 | Train Loss: 0.544 Vali Loss: 1.038 Vali Acc: 0.558 Test Loss: 1.038 Test Acc: 0.558
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.872596025466919
Epoch: 17, Steps: 9 | Train Loss: 0.522 Vali Loss: 1.044 Vali Acc: 0.572 Test Loss: 1.044 Test Acc: 0.572
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9149949550628662
Epoch: 18, Steps: 9 | Train Loss: 0.500 Vali Loss: 1.043 Vali Acc: 0.572 Test Loss: 1.043 Test Acc: 0.572
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0245659351348877
Epoch: 19, Steps: 9 | Train Loss: 0.465 Vali Loss: 1.050 Vali Acc: 0.572 Test Loss: 1.050 Test Acc: 0.572
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.9219508171081543
Epoch: 20, Steps: 9 | Train Loss: 0.440 Vali Loss: 1.070 Vali Acc: 0.572 Test Loss: 1.070 Test Acc: 0.572
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.9725751876831055
Epoch: 21, Steps: 9 | Train Loss: 0.424 Vali Loss: 1.083 Vali Acc: 0.587 Test Loss: 1.083 Test Acc: 0.587
Validation loss decreased (-0.579700 --> -0.586946).  Saving model ...
Epoch: 22 cost time: 0.7318375110626221
Epoch: 22, Steps: 9 | Train Loss: 0.390 Vali Loss: 1.092 Vali Acc: 0.601 Test Loss: 1.092 Test Acc: 0.601
Validation loss decreased (-0.586946 --> -0.601438).  Saving model ...
Epoch: 23 cost time: 0.8723416328430176
Epoch: 23, Steps: 9 | Train Loss: 0.365 Vali Loss: 1.095 Vali Acc: 0.594 Test Loss: 1.095 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8208420276641846
Epoch: 24, Steps: 9 | Train Loss: 0.345 Vali Loss: 1.114 Vali Acc: 0.587 Test Loss: 1.114 Test Acc: 0.587
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7660491466522217
Epoch: 25, Steps: 9 | Train Loss: 0.325 Vali Loss: 1.125 Vali Acc: 0.601 Test Loss: 1.125 Test Acc: 0.601
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8211228847503662
Epoch: 26, Steps: 9 | Train Loss: 0.312 Vali Loss: 1.156 Vali Acc: 0.601 Test Loss: 1.156 Test Acc: 0.601
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.8050136566162109
Epoch: 27, Steps: 9 | Train Loss: 0.285 Vali Loss: 1.162 Vali Acc: 0.601 Test Loss: 1.162 Test Acc: 0.601
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.8574151992797852
Epoch: 28, Steps: 9 | Train Loss: 0.276 Vali Loss: 1.184 Vali Acc: 0.609 Test Loss: 1.184 Test Acc: 0.609
Validation loss decreased (-0.601438 --> -0.608684).  Saving model ...
Epoch: 29 cost time: 0.8370819091796875
Epoch: 29, Steps: 9 | Train Loss: 0.254 Vali Loss: 1.189 Vali Acc: 0.623 Test Loss: 1.189 Test Acc: 0.623
Validation loss decreased (-0.608684 --> -0.623177).  Saving model ...
Epoch: 30 cost time: 0.8016693592071533
Epoch: 30, Steps: 9 | Train Loss: 0.229 Vali Loss: 1.210 Vali Acc: 0.616 Test Loss: 1.210 Test Acc: 0.616
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9326431751251221
Epoch: 31, Steps: 9 | Train Loss: 0.210 Vali Loss: 1.230 Vali Acc: 0.616 Test Loss: 1.230 Test Acc: 0.616
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8724334239959717
Epoch: 32, Steps: 9 | Train Loss: 0.191 Vali Loss: 1.216 Vali Acc: 0.645 Test Loss: 1.216 Test Acc: 0.645
Validation loss decreased (-0.623177 --> -0.644915).  Saving model ...
Epoch: 33 cost time: 0.7340664863586426
Epoch: 33, Steps: 9 | Train Loss: 0.172 Vali Loss: 1.215 Vali Acc: 0.659 Test Loss: 1.215 Test Acc: 0.659
Validation loss decreased (-0.644915 --> -0.659408).  Saving model ...
Epoch: 34 cost time: 0.9833550453186035
Epoch: 34, Steps: 9 | Train Loss: 0.158 Vali Loss: 1.220 Vali Acc: 0.652 Test Loss: 1.220 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8947916030883789
Epoch: 35, Steps: 9 | Train Loss: 0.134 Vali Loss: 1.202 Vali Acc: 0.652 Test Loss: 1.202 Test Acc: 0.652
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.7162752151489258
Epoch: 36, Steps: 9 | Train Loss: 0.118 Vali Loss: 1.183 Vali Acc: 0.652 Test Loss: 1.183 Test Acc: 0.652
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.8076906204223633
Epoch: 37, Steps: 9 | Train Loss: 0.103 Vali Loss: 1.173 Vali Acc: 0.659 Test Loss: 1.173 Test Acc: 0.659
Validation loss decreased (-0.659408 --> -0.659409).  Saving model ...
Epoch: 38 cost time: 0.7778279781341553
Epoch: 38, Steps: 9 | Train Loss: 0.083 Vali Loss: 1.133 Vali Acc: 0.659 Test Loss: 1.133 Test Acc: 0.659
Validation loss decreased (-0.659409 --> -0.659409).  Saving model ...
Epoch: 39 cost time: 0.8294293880462646
Epoch: 39, Steps: 9 | Train Loss: 0.070 Vali Loss: 1.101 Vali Acc: 0.667 Test Loss: 1.101 Test Acc: 0.667
Validation loss decreased (-0.659409 --> -0.666656).  Saving model ...
Epoch: 40 cost time: 0.8171594142913818
Epoch: 40, Steps: 9 | Train Loss: 0.058 Vali Loss: 1.053 Vali Acc: 0.659 Test Loss: 1.053 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.042255163192749
Epoch: 41, Steps: 9 | Train Loss: 0.058 Vali Loss: 1.080 Vali Acc: 0.688 Test Loss: 1.080 Test Acc: 0.688
Validation loss decreased (-0.666656 --> -0.688395).  Saving model ...
Epoch: 42 cost time: 0.885901689529419
Epoch: 42, Steps: 9 | Train Loss: 0.044 Vali Loss: 1.019 Vali Acc: 0.696 Test Loss: 1.019 Test Acc: 0.696
Validation loss decreased (-0.688395 --> -0.695642).  Saving model ...
Epoch: 43 cost time: 1.0068299770355225
Epoch: 43, Steps: 9 | Train Loss: 0.040 Vali Loss: 1.037 Vali Acc: 0.696 Test Loss: 1.037 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.9395937919616699
Epoch: 44, Steps: 9 | Train Loss: 0.032 Vali Loss: 1.048 Vali Acc: 0.688 Test Loss: 1.048 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.8847465515136719
Epoch: 45, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.989 Vali Acc: 0.710 Test Loss: 0.989 Test Acc: 0.710
Validation loss decreased (-0.695642 --> -0.710135).  Saving model ...
Epoch: 46 cost time: 0.8175592422485352
Epoch: 46, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.973 Vali Acc: 0.696 Test Loss: 0.973 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.932145357131958
Epoch: 47, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.983 Vali Acc: 0.703 Test Loss: 0.983 Test Acc: 0.703
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.927154541015625
Epoch: 48, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.985 Vali Acc: 0.703 Test Loss: 0.985 Test Acc: 0.703
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.8385708332061768
Epoch: 49, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.954 Vali Acc: 0.703 Test Loss: 0.954 Test Acc: 0.703
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.9241347312927246
Epoch: 50, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.940 Vali Acc: 0.688 Test Loss: 0.940 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.8625547885894775
Epoch: 51, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.949 Vali Acc: 0.717 Test Loss: 0.949 Test Acc: 0.717
Validation loss decreased (-0.710135 --> -0.717382).  Saving model ...
Epoch: 52 cost time: 0.8383564949035645
Epoch: 52, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.933 Vali Acc: 0.717 Test Loss: 0.933 Test Acc: 0.717
Validation loss decreased (-0.717382 --> -0.717382).  Saving model ...
Epoch: 53 cost time: 1.341080665588379
Epoch: 53, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.921 Vali Acc: 0.717 Test Loss: 0.921 Test Acc: 0.717
Validation loss decreased (-0.717382 --> -0.717382).  Saving model ...
Epoch: 54 cost time: 1.1522982120513916
Epoch: 54, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.925 Vali Acc: 0.725 Test Loss: 0.925 Test Acc: 0.725
Validation loss decreased (-0.717382 --> -0.724628).  Saving model ...
Epoch: 55 cost time: 0.8306386470794678
Epoch: 55, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.914 Vali Acc: 0.710 Test Loss: 0.914 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.0859863758087158
Epoch: 56, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.903 Vali Acc: 0.725 Test Loss: 0.903 Test Acc: 0.725
Validation loss decreased (-0.724628 --> -0.724629).  Saving model ...
Epoch: 57 cost time: 1.0208230018615723
Epoch: 57, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.883 Vali Acc: 0.717 Test Loss: 0.883 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.0680251121520996
Epoch: 58, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.880 Vali Acc: 0.717 Test Loss: 0.880 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.8895292282104492
Epoch: 59, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.881 Vali Acc: 0.717 Test Loss: 0.881 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.9627690315246582
Epoch: 60, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.859 Vali Acc: 0.717 Test Loss: 0.859 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 0.953411340713501
Epoch: 61, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.860 Vali Acc: 0.725 Test Loss: 0.860 Test Acc: 0.725
Validation loss decreased (-0.724629 --> -0.724629).  Saving model ...
Epoch: 62 cost time: 1.1635141372680664
Epoch: 62, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.846 Vali Acc: 0.725 Test Loss: 0.846 Test Acc: 0.725
Validation loss decreased (-0.724629 --> -0.724629).  Saving model ...
Epoch: 63 cost time: 1.1108832359313965
Epoch: 63, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.851 Vali Acc: 0.732 Test Loss: 0.851 Test Acc: 0.732
Validation loss decreased (-0.724629 --> -0.731876).  Saving model ...
Epoch: 64 cost time: 0.9362671375274658
Epoch: 64, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.842 Vali Acc: 0.725 Test Loss: 0.842 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.9821720123291016
Epoch: 65, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.825 Vali Acc: 0.732 Test Loss: 0.825 Test Acc: 0.732
Validation loss decreased (-0.731876 --> -0.731876).  Saving model ...
Epoch: 66 cost time: 1.109250783920288
Epoch: 66, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.821 Vali Acc: 0.732 Test Loss: 0.821 Test Acc: 0.732
Validation loss decreased (-0.731876 --> -0.731876).  Saving model ...
Epoch: 67 cost time: 0.8813836574554443
Epoch: 67, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.824 Vali Acc: 0.739 Test Loss: 0.824 Test Acc: 0.739
Validation loss decreased (-0.731876 --> -0.739122).  Saving model ...
Epoch: 68 cost time: 0.8756699562072754
Epoch: 68, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.815 Vali Acc: 0.746 Test Loss: 0.815 Test Acc: 0.746
Validation loss decreased (-0.739122 --> -0.746369).  Saving model ...
Epoch: 69 cost time: 0.9568097591400146
Epoch: 69, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.798 Vali Acc: 0.732 Test Loss: 0.798 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 1.1312034130096436
Epoch: 70, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.799 Vali Acc: 0.739 Test Loss: 0.799 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 1.1365125179290771
Epoch: 71, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.791 Vali Acc: 0.746 Test Loss: 0.791 Test Acc: 0.746
Validation loss decreased (-0.746369 --> -0.746369).  Saving model ...
Epoch: 72 cost time: 1.2769525051116943
Epoch: 72, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.781 Vali Acc: 0.739 Test Loss: 0.781 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 0.9951624870300293
Epoch: 73, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.773 Vali Acc: 0.739 Test Loss: 0.773 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 0.7828154563903809
Epoch: 74, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.766 Vali Acc: 0.739 Test Loss: 0.766 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 0.8330173492431641
Epoch: 75, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.757 Vali Acc: 0.746 Test Loss: 0.757 Test Acc: 0.746
Validation loss decreased (-0.746369 --> -0.746369).  Saving model ...
Epoch: 76 cost time: 0.8855032920837402
Epoch: 76, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.750 Vali Acc: 0.746 Test Loss: 0.750 Test Acc: 0.746
Validation loss decreased (-0.746369 --> -0.746369).  Saving model ...
Epoch: 77 cost time: 0.8845129013061523
Epoch: 77, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.745 Vali Acc: 0.746 Test Loss: 0.745 Test Acc: 0.746
Validation loss decreased (-0.746369 --> -0.746369).  Saving model ...
Epoch: 78 cost time: 1.0365900993347168
Epoch: 78, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.741 Vali Acc: 0.746 Test Loss: 0.741 Test Acc: 0.746
Validation loss decreased (-0.746369 --> -0.746369).  Saving model ...
Epoch: 79 cost time: 0.9587223529815674
Epoch: 79, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.743 Vali Acc: 0.746 Test Loss: 0.743 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 1.1415746212005615
Epoch: 80, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.727 Vali Acc: 0.754 Test Loss: 0.727 Test Acc: 0.754
Validation loss decreased (-0.746369 --> -0.753616).  Saving model ...
Epoch: 81 cost time: 0.9714512825012207
Epoch: 81, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.717 Vali Acc: 0.754 Test Loss: 0.717 Test Acc: 0.754
Validation loss decreased (-0.753616 --> -0.753616).  Saving model ...
Epoch: 82 cost time: 0.9662914276123047
Epoch: 82, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.711 Vali Acc: 0.754 Test Loss: 0.711 Test Acc: 0.754
Validation loss decreased (-0.753616 --> -0.753616).  Saving model ...
Epoch: 83 cost time: 0.8049893379211426
Epoch: 83, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.709 Vali Acc: 0.754 Test Loss: 0.709 Test Acc: 0.754
Validation loss decreased (-0.753616 --> -0.753616).  Saving model ...
Epoch: 84 cost time: 0.9430553913116455
Epoch: 84, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.703 Vali Acc: 0.754 Test Loss: 0.703 Test Acc: 0.754
Validation loss decreased (-0.753616 --> -0.753616).  Saving model ...
Epoch: 85 cost time: 0.9804344177246094
Epoch: 85, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.700 Vali Acc: 0.754 Test Loss: 0.700 Test Acc: 0.754
Validation loss decreased (-0.753616 --> -0.753616).  Saving model ...
Epoch: 86 cost time: 1.1000261306762695
Epoch: 86, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.701 Vali Acc: 0.754 Test Loss: 0.701 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 1.185777187347412
Epoch: 87, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.694 Vali Acc: 0.754 Test Loss: 0.694 Test Acc: 0.754
Validation loss decreased (-0.753616 --> -0.753616).  Saving model ...
Epoch: 88 cost time: 0.9008500576019287
Epoch: 88, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.683 Vali Acc: 0.754 Test Loss: 0.683 Test Acc: 0.754
Validation loss decreased (-0.753616 --> -0.753616).  Saving model ...
Epoch: 89 cost time: 1.0180790424346924
Epoch: 89, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.672 Vali Acc: 0.754 Test Loss: 0.672 Test Acc: 0.754
Validation loss decreased (-0.753616 --> -0.753616).  Saving model ...
Epoch: 90 cost time: 1.2412323951721191
Epoch: 90, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.669 Vali Acc: 0.761 Test Loss: 0.669 Test Acc: 0.761
Validation loss decreased (-0.753616 --> -0.760863).  Saving model ...
Epoch: 91 cost time: 0.9685080051422119
Epoch: 91, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.666 Vali Acc: 0.761 Test Loss: 0.666 Test Acc: 0.761
Validation loss decreased (-0.760863 --> -0.760863).  Saving model ...
Epoch: 92 cost time: 0.9746782779693604
Epoch: 92, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.666 Vali Acc: 0.761 Test Loss: 0.666 Test Acc: 0.761
Validation loss decreased (-0.760863 --> -0.760863).  Saving model ...
Epoch: 93 cost time: 0.8600199222564697
Epoch: 93, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.660 Vali Acc: 0.761 Test Loss: 0.660 Test Acc: 0.761
Validation loss decreased (-0.760863 --> -0.760863).  Saving model ...
Epoch: 94 cost time: 1.0914721488952637
Epoch: 94, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.655 Vali Acc: 0.761 Test Loss: 0.655 Test Acc: 0.761
Validation loss decreased (-0.760863 --> -0.760863).  Saving model ...
Epoch: 95 cost time: 1.1603784561157227
Epoch: 95, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.651 Vali Acc: 0.761 Test Loss: 0.651 Test Acc: 0.761
Validation loss decreased (-0.760863 --> -0.760863).  Saving model ...
Epoch: 96 cost time: 0.9738004207611084
Epoch: 96, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.649 Vali Acc: 0.761 Test Loss: 0.649 Test Acc: 0.761
Validation loss decreased (-0.760863 --> -0.760863).  Saving model ...
Epoch: 97 cost time: 0.8710658550262451
Epoch: 97, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.644 Vali Acc: 0.761 Test Loss: 0.644 Test Acc: 0.761
Validation loss decreased (-0.760863 --> -0.760863).  Saving model ...
Epoch: 98 cost time: 1.0340962409973145
Epoch: 98, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.635 Vali Acc: 0.761 Test Loss: 0.635 Test Acc: 0.761
Validation loss decreased (-0.760863 --> -0.760863).  Saving model ...
Epoch: 99 cost time: 1.0558466911315918
Epoch: 99, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.631 Vali Acc: 0.761 Test Loss: 0.631 Test Acc: 0.761
Validation loss decreased (-0.760863 --> -0.760863).  Saving model ...
Epoch: 100 cost time: 1.370835781097412
Epoch: 100, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.633 Vali Acc: 0.761 Test Loss: 0.633 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm32_cs12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.7608695652173914
model parameter : 49574
model size : 0.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm32_cs11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.532806158065796
Epoch: 1, Steps: 9 | Train Loss: 1.470 Vali Loss: 1.396 Vali Acc: 0.275 Test Loss: 1.396 Test Acc: 0.275
Validation loss decreased (inf --> -0.275348).  Saving model ...
Epoch: 2 cost time: 0.9110209941864014
Epoch: 2, Steps: 9 | Train Loss: 1.389 Vali Loss: 1.316 Vali Acc: 0.355 Test Loss: 1.316 Test Acc: 0.355
Validation loss decreased (-0.275348 --> -0.355059).  Saving model ...
Epoch: 3 cost time: 0.8992457389831543
Epoch: 3, Steps: 9 | Train Loss: 1.294 Vali Loss: 1.235 Vali Acc: 0.391 Test Loss: 1.235 Test Acc: 0.391
Validation loss decreased (-0.355059 --> -0.391292).  Saving model ...
Epoch: 4 cost time: 1.0207271575927734
Epoch: 4, Steps: 9 | Train Loss: 1.186 Vali Loss: 1.166 Vali Acc: 0.384 Test Loss: 1.166 Test Acc: 0.384
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0528295040130615
Epoch: 5, Steps: 9 | Train Loss: 1.080 Vali Loss: 1.117 Vali Acc: 0.406 Test Loss: 1.117 Test Acc: 0.406
Validation loss decreased (-0.391292 --> -0.405786).  Saving model ...
Epoch: 6 cost time: 0.9628243446350098
Epoch: 6, Steps: 9 | Train Loss: 1.002 Vali Loss: 1.100 Vali Acc: 0.464 Test Loss: 1.100 Test Acc: 0.464
Validation loss decreased (-0.405786 --> -0.463757).  Saving model ...
Epoch: 7 cost time: 1.076317548751831
Epoch: 7, Steps: 9 | Train Loss: 0.937 Vali Loss: 1.071 Vali Acc: 0.457 Test Loss: 1.071 Test Acc: 0.457
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8055360317230225
Epoch: 8, Steps: 9 | Train Loss: 0.879 Vali Loss: 1.063 Vali Acc: 0.493 Test Loss: 1.063 Test Acc: 0.493
Validation loss decreased (-0.463757 --> -0.492743).  Saving model ...
Epoch: 9 cost time: 0.8408093452453613
Epoch: 9, Steps: 9 | Train Loss: 0.837 Vali Loss: 1.030 Vali Acc: 0.514 Test Loss: 1.030 Test Acc: 0.514
Validation loss decreased (-0.492743 --> -0.514482).  Saving model ...
Epoch: 10 cost time: 1.0845086574554443
Epoch: 10, Steps: 9 | Train Loss: 0.781 Vali Loss: 1.027 Vali Acc: 0.507 Test Loss: 1.027 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9320733547210693
Epoch: 11, Steps: 9 | Train Loss: 0.753 Vali Loss: 1.022 Vali Acc: 0.507 Test Loss: 1.022 Test Acc: 0.507
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1810142993927002
Epoch: 12, Steps: 9 | Train Loss: 0.710 Vali Loss: 1.021 Vali Acc: 0.493 Test Loss: 1.021 Test Acc: 0.493
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1134834289550781
Epoch: 13, Steps: 9 | Train Loss: 0.670 Vali Loss: 1.032 Vali Acc: 0.507 Test Loss: 1.032 Test Acc: 0.507
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9319095611572266
Epoch: 14, Steps: 9 | Train Loss: 0.629 Vali Loss: 1.009 Vali Acc: 0.536 Test Loss: 1.009 Test Acc: 0.536
Validation loss decreased (-0.514482 --> -0.536222).  Saving model ...
Epoch: 15 cost time: 0.8639712333679199
Epoch: 15, Steps: 9 | Train Loss: 0.598 Vali Loss: 1.019 Vali Acc: 0.543 Test Loss: 1.019 Test Acc: 0.543
Validation loss decreased (-0.536222 --> -0.543468).  Saving model ...
Epoch: 16 cost time: 0.7545230388641357
Epoch: 16, Steps: 9 | Train Loss: 0.568 Vali Loss: 1.016 Vali Acc: 0.551 Test Loss: 1.016 Test Acc: 0.551
Validation loss decreased (-0.543468 --> -0.550714).  Saving model ...
Epoch: 17 cost time: 0.9698963165283203
Epoch: 17, Steps: 9 | Train Loss: 0.520 Vali Loss: 1.045 Vali Acc: 0.558 Test Loss: 1.045 Test Acc: 0.558
Validation loss decreased (-0.550714 --> -0.557961).  Saving model ...
Epoch: 18 cost time: 0.9154729843139648
Epoch: 18, Steps: 9 | Train Loss: 0.510 Vali Loss: 1.042 Vali Acc: 0.572 Test Loss: 1.042 Test Acc: 0.572
Validation loss decreased (-0.557961 --> -0.572453).  Saving model ...
Epoch: 19 cost time: 0.7394702434539795
Epoch: 19, Steps: 9 | Train Loss: 0.477 Vali Loss: 1.073 Vali Acc: 0.565 Test Loss: 1.073 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.12021803855896
Epoch: 20, Steps: 9 | Train Loss: 0.445 Vali Loss: 1.052 Vali Acc: 0.594 Test Loss: 1.052 Test Acc: 0.594
Validation loss decreased (-0.572453 --> -0.594192).  Saving model ...
Epoch: 21 cost time: 0.7912824153900146
Epoch: 21, Steps: 9 | Train Loss: 0.414 Vali Loss: 1.061 Vali Acc: 0.587 Test Loss: 1.061 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9976508617401123
Epoch: 22, Steps: 9 | Train Loss: 0.398 Vali Loss: 1.091 Vali Acc: 0.587 Test Loss: 1.091 Test Acc: 0.587
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6723670959472656
Epoch: 23, Steps: 9 | Train Loss: 0.373 Vali Loss: 1.100 Vali Acc: 0.594 Test Loss: 1.100 Test Acc: 0.594
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8352701663970947
Epoch: 24, Steps: 9 | Train Loss: 0.351 Vali Loss: 1.105 Vali Acc: 0.594 Test Loss: 1.105 Test Acc: 0.594
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.6469473838806152
Epoch: 25, Steps: 9 | Train Loss: 0.338 Vali Loss: 1.106 Vali Acc: 0.609 Test Loss: 1.106 Test Acc: 0.609
Validation loss decreased (-0.594192 --> -0.608685).  Saving model ...
Epoch: 26 cost time: 0.8403973579406738
Epoch: 26, Steps: 9 | Train Loss: 0.322 Vali Loss: 1.142 Vali Acc: 0.601 Test Loss: 1.142 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7950372695922852
Epoch: 27, Steps: 9 | Train Loss: 0.299 Vali Loss: 1.156 Vali Acc: 0.609 Test Loss: 1.156 Test Acc: 0.609
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.7263829708099365
Epoch: 28, Steps: 9 | Train Loss: 0.296 Vali Loss: 1.157 Vali Acc: 0.630 Test Loss: 1.157 Test Acc: 0.630
Validation loss decreased (-0.608685 --> -0.630423).  Saving model ...
Epoch: 29 cost time: 0.9274990558624268
Epoch: 29, Steps: 9 | Train Loss: 0.258 Vali Loss: 1.187 Vali Acc: 0.594 Test Loss: 1.187 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6523725986480713
Epoch: 30, Steps: 9 | Train Loss: 0.244 Vali Loss: 1.201 Vali Acc: 0.601 Test Loss: 1.201 Test Acc: 0.601
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9108970165252686
Epoch: 31, Steps: 9 | Train Loss: 0.221 Vali Loss: 1.221 Vali Acc: 0.601 Test Loss: 1.221 Test Acc: 0.601
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.8409314155578613
Epoch: 32, Steps: 9 | Train Loss: 0.209 Vali Loss: 1.250 Vali Acc: 0.638 Test Loss: 1.250 Test Acc: 0.638
Validation loss decreased (-0.630423 --> -0.637669).  Saving model ...
Epoch: 33 cost time: 0.9329779148101807
Epoch: 33, Steps: 9 | Train Loss: 0.211 Vali Loss: 1.264 Vali Acc: 0.630 Test Loss: 1.264 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8259081840515137
Epoch: 34, Steps: 9 | Train Loss: 0.186 Vali Loss: 1.261 Vali Acc: 0.601 Test Loss: 1.261 Test Acc: 0.601
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.8630948066711426
Epoch: 35, Steps: 9 | Train Loss: 0.174 Vali Loss: 1.273 Vali Acc: 0.594 Test Loss: 1.273 Test Acc: 0.594
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.781674861907959
Epoch: 36, Steps: 9 | Train Loss: 0.160 Vali Loss: 1.298 Vali Acc: 0.609 Test Loss: 1.298 Test Acc: 0.609
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.8470032215118408
Epoch: 37, Steps: 9 | Train Loss: 0.150 Vali Loss: 1.311 Vali Acc: 0.638 Test Loss: 1.311 Test Acc: 0.638
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.8865275382995605
Epoch: 38, Steps: 9 | Train Loss: 0.138 Vali Loss: 1.348 Vali Acc: 0.609 Test Loss: 1.348 Test Acc: 0.609
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.9775736331939697
Epoch: 39, Steps: 9 | Train Loss: 0.129 Vali Loss: 1.361 Vali Acc: 0.623 Test Loss: 1.361 Test Acc: 0.623
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.0051507949829102
Epoch: 40, Steps: 9 | Train Loss: 0.122 Vali Loss: 1.367 Vali Acc: 0.645 Test Loss: 1.367 Test Acc: 0.645
Validation loss decreased (-0.637669 --> -0.644914).  Saving model ...
Epoch: 41 cost time: 0.8880198001861572
Epoch: 41, Steps: 9 | Train Loss: 0.116 Vali Loss: 1.399 Vali Acc: 0.630 Test Loss: 1.399 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.8697869777679443
Epoch: 42, Steps: 9 | Train Loss: 0.102 Vali Loss: 1.389 Vali Acc: 0.616 Test Loss: 1.389 Test Acc: 0.616
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.8667268753051758
Epoch: 43, Steps: 9 | Train Loss: 0.095 Vali Loss: 1.395 Vali Acc: 0.645 Test Loss: 1.395 Test Acc: 0.645
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.0053634643554688
Epoch: 44, Steps: 9 | Train Loss: 0.090 Vali Loss: 1.405 Vali Acc: 0.645 Test Loss: 1.405 Test Acc: 0.645
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.8899641036987305
Epoch: 45, Steps: 9 | Train Loss: 0.085 Vali Loss: 1.444 Vali Acc: 0.630 Test Loss: 1.444 Test Acc: 0.630
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.9370753765106201
Epoch: 46, Steps: 9 | Train Loss: 0.077 Vali Loss: 1.454 Vali Acc: 0.630 Test Loss: 1.454 Test Acc: 0.630
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.963463544845581
Epoch: 47, Steps: 9 | Train Loss: 0.072 Vali Loss: 1.423 Vali Acc: 0.652 Test Loss: 1.423 Test Acc: 0.652
Validation loss decreased (-0.644914 --> -0.652160).  Saving model ...
Epoch: 48 cost time: 0.6716146469116211
Epoch: 48, Steps: 9 | Train Loss: 0.065 Vali Loss: 1.428 Vali Acc: 0.667 Test Loss: 1.428 Test Acc: 0.667
Validation loss decreased (-0.652160 --> -0.666652).  Saving model ...
Epoch: 49 cost time: 0.9231383800506592
Epoch: 49, Steps: 9 | Train Loss: 0.057 Vali Loss: 1.454 Vali Acc: 0.667 Test Loss: 1.454 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.191603183746338
Epoch: 50, Steps: 9 | Train Loss: 0.053 Vali Loss: 1.450 Vali Acc: 0.667 Test Loss: 1.450 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.0633344650268555
Epoch: 51, Steps: 9 | Train Loss: 0.047 Vali Loss: 1.449 Vali Acc: 0.667 Test Loss: 1.449 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.9704103469848633
Epoch: 52, Steps: 9 | Train Loss: 0.043 Vali Loss: 1.437 Vali Acc: 0.667 Test Loss: 1.437 Test Acc: 0.667
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 0.8583235740661621
Epoch: 53, Steps: 9 | Train Loss: 0.039 Vali Loss: 1.419 Vali Acc: 0.674 Test Loss: 1.419 Test Acc: 0.674
Validation loss decreased (-0.666652 --> -0.673899).  Saving model ...
Epoch: 54 cost time: 0.7404804229736328
Epoch: 54, Steps: 9 | Train Loss: 0.035 Vali Loss: 1.411 Vali Acc: 0.674 Test Loss: 1.411 Test Acc: 0.674
Validation loss decreased (-0.673899 --> -0.673899).  Saving model ...
Epoch: 55 cost time: 0.734067440032959
Epoch: 55, Steps: 9 | Train Loss: 0.032 Vali Loss: 1.410 Vali Acc: 0.674 Test Loss: 1.410 Test Acc: 0.674
Validation loss decreased (-0.673899 --> -0.673899).  Saving model ...
Epoch: 56 cost time: 0.7165403366088867
Epoch: 56, Steps: 9 | Train Loss: 0.028 Vali Loss: 1.379 Vali Acc: 0.681 Test Loss: 1.379 Test Acc: 0.681
Validation loss decreased (-0.673899 --> -0.681146).  Saving model ...
Epoch: 57 cost time: 0.8434748649597168
Epoch: 57, Steps: 9 | Train Loss: 0.026 Vali Loss: 1.361 Vali Acc: 0.688 Test Loss: 1.361 Test Acc: 0.688
Validation loss decreased (-0.681146 --> -0.688392).  Saving model ...
Epoch: 58 cost time: 0.9154810905456543
Epoch: 58, Steps: 9 | Train Loss: 0.023 Vali Loss: 1.330 Vali Acc: 0.688 Test Loss: 1.330 Test Acc: 0.688
Validation loss decreased (-0.688392 --> -0.688393).  Saving model ...
Epoch: 59 cost time: 0.7774431705474854
Epoch: 59, Steps: 9 | Train Loss: 0.020 Vali Loss: 1.333 Vali Acc: 0.703 Test Loss: 1.333 Test Acc: 0.703
Validation loss decreased (-0.688393 --> -0.702885).  Saving model ...
Epoch: 60 cost time: 0.9589102268218994
Epoch: 60, Steps: 9 | Train Loss: 0.017 Vali Loss: 1.293 Vali Acc: 0.710 Test Loss: 1.293 Test Acc: 0.710
Validation loss decreased (-0.702885 --> -0.710132).  Saving model ...
Epoch: 61 cost time: 0.6633710861206055
Epoch: 61, Steps: 9 | Train Loss: 0.016 Vali Loss: 1.268 Vali Acc: 0.717 Test Loss: 1.268 Test Acc: 0.717
Validation loss decreased (-0.710132 --> -0.717379).  Saving model ...
Epoch: 62 cost time: 0.6915154457092285
Epoch: 62, Steps: 9 | Train Loss: 0.014 Vali Loss: 1.244 Vali Acc: 0.717 Test Loss: 1.244 Test Acc: 0.717
Validation loss decreased (-0.717379 --> -0.717379).  Saving model ...
Epoch: 63 cost time: 0.7198929786682129
Epoch: 63, Steps: 9 | Train Loss: 0.012 Vali Loss: 1.229 Vali Acc: 0.725 Test Loss: 1.229 Test Acc: 0.725
Validation loss decreased (-0.717379 --> -0.724625).  Saving model ...
Epoch: 64 cost time: 0.8908443450927734
Epoch: 64, Steps: 9 | Train Loss: 0.011 Vali Loss: 1.201 Vali Acc: 0.725 Test Loss: 1.201 Test Acc: 0.725
Validation loss decreased (-0.724625 --> -0.724626).  Saving model ...
Epoch: 65 cost time: 0.8378610610961914
Epoch: 65, Steps: 9 | Train Loss: 0.010 Vali Loss: 1.181 Vali Acc: 0.725 Test Loss: 1.181 Test Acc: 0.725
Validation loss decreased (-0.724626 --> -0.724626).  Saving model ...
Epoch: 66 cost time: 0.610912561416626
Epoch: 66, Steps: 9 | Train Loss: 0.009 Vali Loss: 1.158 Vali Acc: 0.732 Test Loss: 1.158 Test Acc: 0.732
Validation loss decreased (-0.724626 --> -0.731872).  Saving model ...
Epoch: 67 cost time: 0.9027292728424072
Epoch: 67, Steps: 9 | Train Loss: 0.008 Vali Loss: 1.135 Vali Acc: 0.732 Test Loss: 1.135 Test Acc: 0.732
Validation loss decreased (-0.731872 --> -0.731873).  Saving model ...
Epoch: 68 cost time: 0.7963254451751709
Epoch: 68, Steps: 9 | Train Loss: 0.008 Vali Loss: 1.112 Vali Acc: 0.732 Test Loss: 1.112 Test Acc: 0.732
Validation loss decreased (-0.731873 --> -0.731873).  Saving model ...
Epoch: 69 cost time: 1.192756175994873
Epoch: 69, Steps: 9 | Train Loss: 0.007 Vali Loss: 1.097 Vali Acc: 0.732 Test Loss: 1.097 Test Acc: 0.732
Validation loss decreased (-0.731873 --> -0.731873).  Saving model ...
Epoch: 70 cost time: 0.8209228515625
Epoch: 70, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.081 Vali Acc: 0.746 Test Loss: 1.081 Test Acc: 0.746
Validation loss decreased (-0.731873 --> -0.746366).  Saving model ...
Epoch: 71 cost time: 0.7766094207763672
Epoch: 71, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.062 Vali Acc: 0.746 Test Loss: 1.062 Test Acc: 0.746
Validation loss decreased (-0.746366 --> -0.746366).  Saving model ...
Epoch: 72 cost time: 0.7370223999023438
Epoch: 72, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.046 Vali Acc: 0.754 Test Loss: 1.046 Test Acc: 0.754
Validation loss decreased (-0.746366 --> -0.753613).  Saving model ...
Epoch: 73 cost time: 0.9564814567565918
Epoch: 73, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.032 Vali Acc: 0.768 Test Loss: 1.032 Test Acc: 0.768
Validation loss decreased (-0.753613 --> -0.768106).  Saving model ...
Epoch: 74 cost time: 0.9297614097595215
Epoch: 74, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.017 Vali Acc: 0.768 Test Loss: 1.017 Test Acc: 0.768
Validation loss decreased (-0.768106 --> -0.768106).  Saving model ...
Epoch: 75 cost time: 0.7651774883270264
Epoch: 75, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.002 Vali Acc: 0.768 Test Loss: 1.002 Test Acc: 0.768
Validation loss decreased (-0.768106 --> -0.768106).  Saving model ...
Epoch: 76 cost time: 1.1462020874023438
Epoch: 76, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.983 Vali Acc: 0.768 Test Loss: 0.983 Test Acc: 0.768
Validation loss decreased (-0.768106 --> -0.768106).  Saving model ...
Epoch: 77 cost time: 1.375028371810913
Epoch: 77, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.972 Vali Acc: 0.768 Test Loss: 0.972 Test Acc: 0.768
Validation loss decreased (-0.768106 --> -0.768106).  Saving model ...
Epoch: 78 cost time: 1.2579431533813477
Epoch: 78, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.962 Vali Acc: 0.775 Test Loss: 0.962 Test Acc: 0.775
Validation loss decreased (-0.768106 --> -0.775353).  Saving model ...
Epoch: 79 cost time: 0.8924052715301514
Epoch: 79, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.950 Vali Acc: 0.775 Test Loss: 0.950 Test Acc: 0.775
Validation loss decreased (-0.775353 --> -0.775353).  Saving model ...
Epoch: 80 cost time: 0.8807451725006104
Epoch: 80, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.947 Vali Acc: 0.790 Test Loss: 0.947 Test Acc: 0.790
Validation loss decreased (-0.775353 --> -0.789846).  Saving model ...
Epoch: 81 cost time: 0.8646774291992188
Epoch: 81, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.936 Vali Acc: 0.790 Test Loss: 0.936 Test Acc: 0.790
Validation loss decreased (-0.789846 --> -0.789846).  Saving model ...
Epoch: 82 cost time: 0.7825119495391846
Epoch: 82, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.925 Vali Acc: 0.790 Test Loss: 0.925 Test Acc: 0.790
Validation loss decreased (-0.789846 --> -0.789846).  Saving model ...
Epoch: 83 cost time: 0.8307235240936279
Epoch: 83, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.919 Vali Acc: 0.790 Test Loss: 0.919 Test Acc: 0.790
Validation loss decreased (-0.789846 --> -0.789846).  Saving model ...
Epoch: 84 cost time: 0.6794524192810059
Epoch: 84, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.907 Vali Acc: 0.790 Test Loss: 0.907 Test Acc: 0.790
Validation loss decreased (-0.789846 --> -0.789846).  Saving model ...
Epoch: 85 cost time: 0.7962996959686279
Epoch: 85, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.902 Vali Acc: 0.790 Test Loss: 0.902 Test Acc: 0.790
Validation loss decreased (-0.789846 --> -0.789846).  Saving model ...
Epoch: 86 cost time: 1.066476821899414
Epoch: 86, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.900 Vali Acc: 0.790 Test Loss: 0.900 Test Acc: 0.790
Validation loss decreased (-0.789846 --> -0.789846).  Saving model ...
Epoch: 87 cost time: 1.0825271606445312
Epoch: 87, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.892 Vali Acc: 0.790 Test Loss: 0.892 Test Acc: 0.790
Validation loss decreased (-0.789846 --> -0.789846).  Saving model ...
Epoch: 88 cost time: 0.9437069892883301
Epoch: 88, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.881 Vali Acc: 0.790 Test Loss: 0.881 Test Acc: 0.790
Validation loss decreased (-0.789846 --> -0.789846).  Saving model ...
Epoch: 89 cost time: 0.7901575565338135
Epoch: 89, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.874 Vali Acc: 0.797 Test Loss: 0.874 Test Acc: 0.797
Validation loss decreased (-0.789846 --> -0.797093).  Saving model ...
Epoch: 90 cost time: 0.7679891586303711
Epoch: 90, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.857 Vali Acc: 0.797 Test Loss: 0.857 Test Acc: 0.797
Validation loss decreased (-0.797093 --> -0.797093).  Saving model ...
Epoch: 91 cost time: 0.7711575031280518
Epoch: 91, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.864 Vali Acc: 0.804 Test Loss: 0.864 Test Acc: 0.804
Validation loss decreased (-0.797093 --> -0.804339).  Saving model ...
Epoch: 92 cost time: 0.6981544494628906
Epoch: 92, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.859 Vali Acc: 0.812 Test Loss: 0.859 Test Acc: 0.812
Validation loss decreased (-0.804339 --> -0.811586).  Saving model ...
Epoch: 93 cost time: 0.8965907096862793
Epoch: 93, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.846 Vali Acc: 0.804 Test Loss: 0.846 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 0.6637477874755859
Epoch: 94, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.840 Vali Acc: 0.804 Test Loss: 0.840 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 95 cost time: 0.7906122207641602
Epoch: 95, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.834 Vali Acc: 0.812 Test Loss: 0.834 Test Acc: 0.812
Validation loss decreased (-0.811586 --> -0.811586).  Saving model ...
Epoch: 96 cost time: 0.980668306350708
Epoch: 96, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.828 Vali Acc: 0.812 Test Loss: 0.828 Test Acc: 0.812
Validation loss decreased (-0.811586 --> -0.811586).  Saving model ...
Epoch: 97 cost time: 0.7747571468353271
Epoch: 97, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.822 Vali Acc: 0.819 Test Loss: 0.822 Test Acc: 0.819
Validation loss decreased (-0.811586 --> -0.818832).  Saving model ...
Epoch: 98 cost time: 0.8592603206634521
Epoch: 98, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.812 Vali Acc: 0.812 Test Loss: 0.812 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 0.7886476516723633
Epoch: 99, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.807 Vali Acc: 0.819 Test Loss: 0.807 Test Acc: 0.819
Validation loss decreased (-0.818832 --> -0.818833).  Saving model ...
Epoch: 100 cost time: 0.6857364177703857
Epoch: 100, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.812 Vali Acc: 0.826 Test Loss: 0.812 Test Acc: 0.826
Validation loss decreased (-0.818833 --> -0.826079).  Saving model ...
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm32_cs11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8260869565217391
model parameter : 48194
model size : 0.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm32_cs10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.3331074714660645
Epoch: 1, Steps: 9 | Train Loss: 1.434 Vali Loss: 1.360 Vali Acc: 0.312 Test Loss: 1.360 Test Acc: 0.312
Validation loss decreased (inf --> -0.311581).  Saving model ...
Epoch: 2 cost time: 0.6250789165496826
Epoch: 2, Steps: 9 | Train Loss: 1.367 Vali Loss: 1.280 Vali Acc: 0.384 Test Loss: 1.280 Test Acc: 0.384
Validation loss decreased (-0.311581 --> -0.384045).  Saving model ...
Epoch: 3 cost time: 0.7070581912994385
Epoch: 3, Steps: 9 | Train Loss: 1.250 Vali Loss: 1.197 Vali Acc: 0.486 Test Loss: 1.197 Test Acc: 0.486
Validation loss decreased (-0.384045 --> -0.485495).  Saving model ...
Epoch: 4 cost time: 0.7902641296386719
Epoch: 4, Steps: 9 | Train Loss: 1.139 Vali Loss: 1.131 Vali Acc: 0.551 Test Loss: 1.131 Test Acc: 0.551
Validation loss decreased (-0.485495 --> -0.550713).  Saving model ...
Epoch: 5 cost time: 0.8526079654693604
Epoch: 5, Steps: 9 | Train Loss: 1.049 Vali Loss: 1.081 Vali Acc: 0.543 Test Loss: 1.081 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9115555286407471
Epoch: 6, Steps: 9 | Train Loss: 0.963 Vali Loss: 1.062 Vali Acc: 0.529 Test Loss: 1.062 Test Acc: 0.529
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8640124797821045
Epoch: 7, Steps: 9 | Train Loss: 0.906 Vali Loss: 1.038 Vali Acc: 0.522 Test Loss: 1.038 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.7405264377593994
Epoch: 8, Steps: 9 | Train Loss: 0.867 Vali Loss: 1.028 Vali Acc: 0.514 Test Loss: 1.028 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9448521137237549
Epoch: 9, Steps: 9 | Train Loss: 0.803 Vali Loss: 1.023 Vali Acc: 0.536 Test Loss: 1.023 Test Acc: 0.536
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.7385673522949219
Epoch: 10, Steps: 9 | Train Loss: 0.764 Vali Loss: 1.015 Vali Acc: 0.514 Test Loss: 1.015 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.7999730110168457
Epoch: 11, Steps: 9 | Train Loss: 0.721 Vali Loss: 1.003 Vali Acc: 0.529 Test Loss: 1.003 Test Acc: 0.529
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.8913493156433105
Epoch: 12, Steps: 9 | Train Loss: 0.682 Vali Loss: 1.006 Vali Acc: 0.522 Test Loss: 1.006 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.3603076934814453
Epoch: 13, Steps: 9 | Train Loss: 0.669 Vali Loss: 1.014 Vali Acc: 0.514 Test Loss: 1.014 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.8052802085876465
Epoch: 14, Steps: 9 | Train Loss: 0.618 Vali Loss: 1.017 Vali Acc: 0.529 Test Loss: 1.017 Test Acc: 0.529
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_LightTS_UEA_ftM_sl206_ll0_pl0_dm32_cs10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.5507246376811594
model parameter : 48552
model size : 0.20MB
