Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm512_cs50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.4832873344421387
Epoch: 1, Steps: 3 | Train Loss: 1.448 Vali Loss: 1.468 Vali Acc: 0.275 Test Loss: 1.468 Test Acc: 0.275
Validation loss decreased (inf --> -0.274985).  Saving model ...
Epoch: 2 cost time: 0.323040246963501
Epoch: 2, Steps: 3 | Train Loss: 1.407 Vali Loss: 1.460 Vali Acc: 0.300 Test Loss: 1.460 Test Acc: 0.300
Validation loss decreased (-0.274985 --> -0.299985).  Saving model ...
Epoch: 3 cost time: 0.341350793838501
Epoch: 3, Steps: 3 | Train Loss: 1.403 Vali Loss: 1.452 Vali Acc: 0.300 Test Loss: 1.452 Test Acc: 0.300
Validation loss decreased (-0.299985 --> -0.299985).  Saving model ...
Epoch: 4 cost time: 0.38283419609069824
Epoch: 4, Steps: 3 | Train Loss: 1.372 Vali Loss: 1.440 Vali Acc: 0.300 Test Loss: 1.440 Test Acc: 0.300
Validation loss decreased (-0.299985 --> -0.299986).  Saving model ...
Epoch: 5 cost time: 0.37581348419189453
Epoch: 5, Steps: 3 | Train Loss: 1.362 Vali Loss: 1.427 Vali Acc: 0.225 Test Loss: 1.427 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.3468921184539795
Epoch: 6, Steps: 3 | Train Loss: 1.359 Vali Loss: 1.411 Vali Acc: 0.325 Test Loss: 1.411 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324986).  Saving model ...
Epoch: 7 cost time: 0.37148165702819824
Epoch: 7, Steps: 3 | Train Loss: 1.294 Vali Loss: 1.395 Vali Acc: 0.325 Test Loss: 1.395 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324986).  Saving model ...
Epoch: 8 cost time: 0.40532732009887695
Epoch: 8, Steps: 3 | Train Loss: 1.259 Vali Loss: 1.381 Vali Acc: 0.375 Test Loss: 1.381 Test Acc: 0.375
Validation loss decreased (-0.324986 --> -0.374986).  Saving model ...
Epoch: 9 cost time: 0.3368217945098877
Epoch: 9, Steps: 3 | Train Loss: 1.233 Vali Loss: 1.366 Vali Acc: 0.400 Test Loss: 1.366 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399986).  Saving model ...
Epoch: 10 cost time: 0.33876967430114746
Epoch: 10, Steps: 3 | Train Loss: 1.191 Vali Loss: 1.353 Vali Acc: 0.400 Test Loss: 1.353 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399986).  Saving model ...
Epoch: 11 cost time: 0.31537699699401855
Epoch: 11, Steps: 3 | Train Loss: 1.212 Vali Loss: 1.339 Vali Acc: 0.400 Test Loss: 1.339 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399987).  Saving model ...
Epoch: 12 cost time: 0.3903634548187256
Epoch: 12, Steps: 3 | Train Loss: 1.159 Vali Loss: 1.323 Vali Acc: 0.425 Test Loss: 1.323 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424987).  Saving model ...
Epoch: 13 cost time: 0.35364866256713867
Epoch: 13, Steps: 3 | Train Loss: 1.159 Vali Loss: 1.305 Vali Acc: 0.425 Test Loss: 1.305 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 14 cost time: 0.3545043468475342
Epoch: 14, Steps: 3 | Train Loss: 1.089 Vali Loss: 1.290 Vali Acc: 0.425 Test Loss: 1.290 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 15 cost time: 0.31885623931884766
Epoch: 15, Steps: 3 | Train Loss: 1.055 Vali Loss: 1.273 Vali Acc: 0.450 Test Loss: 1.273 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449987).  Saving model ...
Epoch: 16 cost time: 0.3989393711090088
Epoch: 16, Steps: 3 | Train Loss: 1.003 Vali Loss: 1.261 Vali Acc: 0.475 Test Loss: 1.261 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474987).  Saving model ...
Epoch: 17 cost time: 0.3464479446411133
Epoch: 17, Steps: 3 | Train Loss: 0.969 Vali Loss: 1.247 Vali Acc: 0.475 Test Loss: 1.247 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474988).  Saving model ...
Epoch: 18 cost time: 0.37592101097106934
Epoch: 18, Steps: 3 | Train Loss: 0.945 Vali Loss: 1.232 Vali Acc: 0.525 Test Loss: 1.232 Test Acc: 0.525
Validation loss decreased (-0.474988 --> -0.524988).  Saving model ...
Epoch: 19 cost time: 0.38100314140319824
Epoch: 19, Steps: 3 | Train Loss: 0.952 Vali Loss: 1.215 Vali Acc: 0.475 Test Loss: 1.215 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.3731369972229004
Epoch: 20, Steps: 3 | Train Loss: 0.901 Vali Loss: 1.199 Vali Acc: 0.525 Test Loss: 1.199 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 21 cost time: 0.399169921875
Epoch: 21, Steps: 3 | Train Loss: 0.884 Vali Loss: 1.184 Vali Acc: 0.575 Test Loss: 1.184 Test Acc: 0.575
Validation loss decreased (-0.524988 --> -0.574988).  Saving model ...
Epoch: 22 cost time: 0.374190092086792
Epoch: 22, Steps: 3 | Train Loss: 0.853 Vali Loss: 1.171 Vali Acc: 0.600 Test Loss: 1.171 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599988).  Saving model ...
Epoch: 23 cost time: 0.44247984886169434
Epoch: 23, Steps: 3 | Train Loss: 0.792 Vali Loss: 1.153 Vali Acc: 0.550 Test Loss: 1.153 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.40456604957580566
Epoch: 24, Steps: 3 | Train Loss: 0.773 Vali Loss: 1.135 Vali Acc: 0.550 Test Loss: 1.135 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.34653449058532715
Epoch: 25, Steps: 3 | Train Loss: 0.749 Vali Loss: 1.118 Vali Acc: 0.600 Test Loss: 1.118 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599989).  Saving model ...
Epoch: 26 cost time: 0.3508000373840332
Epoch: 26, Steps: 3 | Train Loss: 0.691 Vali Loss: 1.099 Vali Acc: 0.625 Test Loss: 1.099 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 27 cost time: 0.3438737392425537
Epoch: 27, Steps: 3 | Train Loss: 0.678 Vali Loss: 1.085 Vali Acc: 0.650 Test Loss: 1.085 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 28 cost time: 0.4248208999633789
Epoch: 28, Steps: 3 | Train Loss: 0.694 Vali Loss: 1.068 Vali Acc: 0.650 Test Loss: 1.068 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 29 cost time: 0.3764328956604004
Epoch: 29, Steps: 3 | Train Loss: 0.653 Vali Loss: 1.056 Vali Acc: 0.600 Test Loss: 1.056 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.29534912109375
Epoch: 30, Steps: 3 | Train Loss: 0.606 Vali Loss: 1.043 Vali Acc: 0.625 Test Loss: 1.043 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.30452466011047363
Epoch: 31, Steps: 3 | Train Loss: 0.613 Vali Loss: 1.026 Vali Acc: 0.625 Test Loss: 1.026 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.41321253776550293
Epoch: 32, Steps: 3 | Train Loss: 0.577 Vali Loss: 1.017 Vali Acc: 0.650 Test Loss: 1.017 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649990).  Saving model ...
Epoch: 33 cost time: 0.29726552963256836
Epoch: 33, Steps: 3 | Train Loss: 0.538 Vali Loss: 1.001 Vali Acc: 0.650 Test Loss: 1.001 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 34 cost time: 0.34828805923461914
Epoch: 34, Steps: 3 | Train Loss: 0.526 Vali Loss: 0.991 Vali Acc: 0.650 Test Loss: 0.991 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 35 cost time: 0.39739465713500977
Epoch: 35, Steps: 3 | Train Loss: 0.511 Vali Loss: 0.986 Vali Acc: 0.650 Test Loss: 0.986 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 36 cost time: 0.326183557510376
Epoch: 36, Steps: 3 | Train Loss: 0.455 Vali Loss: 0.983 Vali Acc: 0.600 Test Loss: 0.983 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.3211936950683594
Epoch: 37, Steps: 3 | Train Loss: 0.421 Vali Loss: 0.978 Vali Acc: 0.625 Test Loss: 0.978 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.4352385997772217
Epoch: 38, Steps: 3 | Train Loss: 0.438 Vali Loss: 0.963 Vali Acc: 0.600 Test Loss: 0.963 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.3282785415649414
Epoch: 39, Steps: 3 | Train Loss: 0.409 Vali Loss: 0.954 Vali Acc: 0.625 Test Loss: 0.954 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.3033480644226074
Epoch: 40, Steps: 3 | Train Loss: 0.395 Vali Loss: 0.938 Vali Acc: 0.675 Test Loss: 0.938 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674991).  Saving model ...
Epoch: 41 cost time: 0.3604929447174072
Epoch: 41, Steps: 3 | Train Loss: 0.421 Vali Loss: 0.934 Vali Acc: 0.700 Test Loss: 0.934 Test Acc: 0.700
Validation loss decreased (-0.674991 --> -0.699991).  Saving model ...
Epoch: 42 cost time: 0.3256571292877197
Epoch: 42, Steps: 3 | Train Loss: 0.366 Vali Loss: 0.930 Vali Acc: 0.700 Test Loss: 0.930 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 43 cost time: 0.3849680423736572
Epoch: 43, Steps: 3 | Train Loss: 0.351 Vali Loss: 0.910 Vali Acc: 0.675 Test Loss: 0.910 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.36866164207458496
Epoch: 44, Steps: 3 | Train Loss: 0.333 Vali Loss: 0.904 Vali Acc: 0.650 Test Loss: 0.904 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.3966360092163086
Epoch: 45, Steps: 3 | Train Loss: 0.295 Vali Loss: 0.898 Vali Acc: 0.650 Test Loss: 0.898 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.39534473419189453
Epoch: 46, Steps: 3 | Train Loss: 0.305 Vali Loss: 0.879 Vali Acc: 0.675 Test Loss: 0.879 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.36057114601135254
Epoch: 47, Steps: 3 | Train Loss: 0.312 Vali Loss: 0.868 Vali Acc: 0.700 Test Loss: 0.868 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 48 cost time: 0.37100791931152344
Epoch: 48, Steps: 3 | Train Loss: 0.267 Vali Loss: 0.845 Vali Acc: 0.725 Test Loss: 0.845 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724992).  Saving model ...
Epoch: 49 cost time: 0.3656167984008789
Epoch: 49, Steps: 3 | Train Loss: 0.264 Vali Loss: 0.845 Vali Acc: 0.725 Test Loss: 0.845 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.4109821319580078
Epoch: 50, Steps: 3 | Train Loss: 0.257 Vali Loss: 0.827 Vali Acc: 0.750 Test Loss: 0.827 Test Acc: 0.750
Validation loss decreased (-0.724992 --> -0.749992).  Saving model ...
Epoch: 51 cost time: 0.3986666202545166
Epoch: 51, Steps: 3 | Train Loss: 0.254 Vali Loss: 0.814 Vali Acc: 0.750 Test Loss: 0.814 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 52 cost time: 0.46863889694213867
Epoch: 52, Steps: 3 | Train Loss: 0.222 Vali Loss: 0.841 Vali Acc: 0.700 Test Loss: 0.841 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.42255496978759766
Epoch: 53, Steps: 3 | Train Loss: 0.203 Vali Loss: 0.853 Vali Acc: 0.675 Test Loss: 0.853 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.43146371841430664
Epoch: 54, Steps: 3 | Train Loss: 0.181 Vali Loss: 0.821 Vali Acc: 0.700 Test Loss: 0.821 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.3589439392089844
Epoch: 55, Steps: 3 | Train Loss: 0.198 Vali Loss: 0.759 Vali Acc: 0.775 Test Loss: 0.759 Test Acc: 0.775
Validation loss decreased (-0.749992 --> -0.774992).  Saving model ...
Epoch: 56 cost time: 0.38658976554870605
Epoch: 56, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.699 Vali Acc: 0.775 Test Loss: 0.699 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774993).  Saving model ...
Epoch: 57 cost time: 0.37658071517944336
Epoch: 57, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.678 Vali Acc: 0.800 Test Loss: 0.678 Test Acc: 0.800
Validation loss decreased (-0.774993 --> -0.799993).  Saving model ...
Epoch: 58 cost time: 0.3758859634399414
Epoch: 58, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.684 Vali Acc: 0.800 Test Loss: 0.684 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.45444321632385254
Epoch: 59, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.694 Vali Acc: 0.800 Test Loss: 0.694 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.32831788063049316
Epoch: 60, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.700 Vali Acc: 0.800 Test Loss: 0.700 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 0.3642561435699463
Epoch: 61, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.686 Vali Acc: 0.825 Test Loss: 0.686 Test Acc: 0.825
Validation loss decreased (-0.799993 --> -0.824993).  Saving model ...
Epoch: 62 cost time: 0.3090083599090576
Epoch: 62, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.705 Vali Acc: 0.825 Test Loss: 0.705 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.4548835754394531
Epoch: 63, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.702 Vali Acc: 0.800 Test Loss: 0.702 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 0.4186129570007324
Epoch: 64, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.713 Vali Acc: 0.800 Test Loss: 0.713 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 0.37317562103271484
Epoch: 65, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.752 Vali Acc: 0.800 Test Loss: 0.752 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 0.4487779140472412
Epoch: 66, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.779 Vali Acc: 0.775 Test Loss: 0.779 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 0.5763063430786133
Epoch: 67, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.800 Vali Acc: 0.775 Test Loss: 0.800 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 0.3882176876068115
Epoch: 68, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.814 Vali Acc: 0.775 Test Loss: 0.814 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 69 cost time: 0.42961859703063965
Epoch: 69, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.828 Vali Acc: 0.775 Test Loss: 0.828 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 70 cost time: 0.4665665626525879
Epoch: 70, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.840 Vali Acc: 0.775 Test Loss: 0.840 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 71 cost time: 0.4149899482727051
Epoch: 71, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.853 Vali Acc: 0.775 Test Loss: 0.853 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm512_cs50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.825
model parameter : 131064
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm512_cs34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.003708839416504
Epoch: 1, Steps: 3 | Train Loss: 1.415 Vali Loss: 1.396 Vali Acc: 0.375 Test Loss: 1.396 Test Acc: 0.375
Validation loss decreased (inf --> -0.374986).  Saving model ...
Epoch: 2 cost time: 0.5439269542694092
Epoch: 2, Steps: 3 | Train Loss: 1.376 Vali Loss: 1.389 Vali Acc: 0.375 Test Loss: 1.389 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 3 cost time: 0.48515844345092773
Epoch: 3, Steps: 3 | Train Loss: 1.391 Vali Loss: 1.381 Vali Acc: 0.375 Test Loss: 1.381 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 4 cost time: 0.4254167079925537
Epoch: 4, Steps: 3 | Train Loss: 1.318 Vali Loss: 1.371 Vali Acc: 0.375 Test Loss: 1.371 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 5 cost time: 0.5081093311309814
Epoch: 5, Steps: 3 | Train Loss: 1.333 Vali Loss: 1.358 Vali Acc: 0.375 Test Loss: 1.358 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 6 cost time: 0.47426342964172363
Epoch: 6, Steps: 3 | Train Loss: 1.310 Vali Loss: 1.344 Vali Acc: 0.375 Test Loss: 1.344 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374987).  Saving model ...
Epoch: 7 cost time: 0.4584808349609375
Epoch: 7, Steps: 3 | Train Loss: 1.268 Vali Loss: 1.329 Vali Acc: 0.375 Test Loss: 1.329 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 8 cost time: 0.427992582321167
Epoch: 8, Steps: 3 | Train Loss: 1.260 Vali Loss: 1.312 Vali Acc: 0.400 Test Loss: 1.312 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399987).  Saving model ...
Epoch: 9 cost time: 0.4196302890777588
Epoch: 9, Steps: 3 | Train Loss: 1.180 Vali Loss: 1.295 Vali Acc: 0.400 Test Loss: 1.295 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 10 cost time: 0.42288851737976074
Epoch: 10, Steps: 3 | Train Loss: 1.192 Vali Loss: 1.278 Vali Acc: 0.400 Test Loss: 1.278 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 11 cost time: 0.46497583389282227
Epoch: 11, Steps: 3 | Train Loss: 1.140 Vali Loss: 1.262 Vali Acc: 0.450 Test Loss: 1.262 Test Acc: 0.450
Validation loss decreased (-0.399987 --> -0.449987).  Saving model ...
Epoch: 12 cost time: 0.3742964267730713
Epoch: 12, Steps: 3 | Train Loss: 1.105 Vali Loss: 1.244 Vali Acc: 0.550 Test Loss: 1.244 Test Acc: 0.550
Validation loss decreased (-0.449987 --> -0.549988).  Saving model ...
Epoch: 13 cost time: 0.46129465103149414
Epoch: 13, Steps: 3 | Train Loss: 1.058 Vali Loss: 1.225 Vali Acc: 0.575 Test Loss: 1.225 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 14 cost time: 0.43428778648376465
Epoch: 14, Steps: 3 | Train Loss: 1.058 Vali Loss: 1.206 Vali Acc: 0.625 Test Loss: 1.206 Test Acc: 0.625
Validation loss decreased (-0.574988 --> -0.624988).  Saving model ...
Epoch: 15 cost time: 0.43243837356567383
Epoch: 15, Steps: 3 | Train Loss: 1.001 Vali Loss: 1.186 Vali Acc: 0.675 Test Loss: 1.186 Test Acc: 0.675
Validation loss decreased (-0.624988 --> -0.674988).  Saving model ...
Epoch: 16 cost time: 0.5072863101959229
Epoch: 16, Steps: 3 | Train Loss: 0.967 Vali Loss: 1.164 Vali Acc: 0.725 Test Loss: 1.164 Test Acc: 0.725
Validation loss decreased (-0.674988 --> -0.724988).  Saving model ...
Epoch: 17 cost time: 0.4024016857147217
Epoch: 17, Steps: 3 | Train Loss: 0.940 Vali Loss: 1.144 Vali Acc: 0.725 Test Loss: 1.144 Test Acc: 0.725
Validation loss decreased (-0.724988 --> -0.724989).  Saving model ...
Epoch: 18 cost time: 0.5144228935241699
Epoch: 18, Steps: 3 | Train Loss: 0.888 Vali Loss: 1.122 Vali Acc: 0.725 Test Loss: 1.122 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 19 cost time: 0.5903787612915039
Epoch: 19, Steps: 3 | Train Loss: 0.824 Vali Loss: 1.098 Vali Acc: 0.750 Test Loss: 1.098 Test Acc: 0.750
Validation loss decreased (-0.724989 --> -0.749989).  Saving model ...
Epoch: 20 cost time: 0.45821189880371094
Epoch: 20, Steps: 3 | Train Loss: 0.842 Vali Loss: 1.073 Vali Acc: 0.750 Test Loss: 1.073 Test Acc: 0.750
Validation loss decreased (-0.749989 --> -0.749989).  Saving model ...
Epoch: 21 cost time: 0.517719030380249
Epoch: 21, Steps: 3 | Train Loss: 0.818 Vali Loss: 1.046 Vali Acc: 0.825 Test Loss: 1.046 Test Acc: 0.825
Validation loss decreased (-0.749989 --> -0.824990).  Saving model ...
Epoch: 22 cost time: 0.46266627311706543
Epoch: 22, Steps: 3 | Train Loss: 0.771 Vali Loss: 1.016 Vali Acc: 0.825 Test Loss: 1.016 Test Acc: 0.825
Validation loss decreased (-0.824990 --> -0.824990).  Saving model ...
Epoch: 23 cost time: 0.46076440811157227
Epoch: 23, Steps: 3 | Train Loss: 0.724 Vali Loss: 0.986 Vali Acc: 0.825 Test Loss: 0.986 Test Acc: 0.825
Validation loss decreased (-0.824990 --> -0.824990).  Saving model ...
Epoch: 24 cost time: 0.47522759437561035
Epoch: 24, Steps: 3 | Train Loss: 0.686 Vali Loss: 0.949 Vali Acc: 0.825 Test Loss: 0.949 Test Acc: 0.825
Validation loss decreased (-0.824990 --> -0.824991).  Saving model ...
Epoch: 25 cost time: 0.4427330493927002
Epoch: 25, Steps: 3 | Train Loss: 0.654 Vali Loss: 0.908 Vali Acc: 0.825 Test Loss: 0.908 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824991).  Saving model ...
Epoch: 26 cost time: 0.5104141235351562
Epoch: 26, Steps: 3 | Train Loss: 0.550 Vali Loss: 0.872 Vali Acc: 0.850 Test Loss: 0.872 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849991).  Saving model ...
Epoch: 27 cost time: 0.40192484855651855
Epoch: 27, Steps: 3 | Train Loss: 0.525 Vali Loss: 0.835 Vali Acc: 0.850 Test Loss: 0.835 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849992).  Saving model ...
Epoch: 28 cost time: 0.4023020267486572
Epoch: 28, Steps: 3 | Train Loss: 0.516 Vali Loss: 0.794 Vali Acc: 0.875 Test Loss: 0.794 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874992).  Saving model ...
Epoch: 29 cost time: 0.4633355140686035
Epoch: 29, Steps: 3 | Train Loss: 0.478 Vali Loss: 0.756 Vali Acc: 0.850 Test Loss: 0.756 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.3946874141693115
Epoch: 30, Steps: 3 | Train Loss: 0.448 Vali Loss: 0.716 Vali Acc: 0.875 Test Loss: 0.716 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874993).  Saving model ...
Epoch: 31 cost time: 0.4798855781555176
Epoch: 31, Steps: 3 | Train Loss: 0.376 Vali Loss: 0.680 Vali Acc: 0.875 Test Loss: 0.680 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 32 cost time: 0.48996877670288086
Epoch: 32, Steps: 3 | Train Loss: 0.383 Vali Loss: 0.636 Vali Acc: 0.875 Test Loss: 0.636 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 33 cost time: 0.5315568447113037
Epoch: 33, Steps: 3 | Train Loss: 0.328 Vali Loss: 0.599 Vali Acc: 0.925 Test Loss: 0.599 Test Acc: 0.925
Validation loss decreased (-0.874994 --> -0.924994).  Saving model ...
Epoch: 34 cost time: 0.49672865867614746
Epoch: 34, Steps: 3 | Train Loss: 0.293 Vali Loss: 0.559 Vali Acc: 0.925 Test Loss: 0.559 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 35 cost time: 0.4881460666656494
Epoch: 35, Steps: 3 | Train Loss: 0.250 Vali Loss: 0.518 Vali Acc: 0.900 Test Loss: 0.518 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.4794189929962158
Epoch: 36, Steps: 3 | Train Loss: 0.259 Vali Loss: 0.474 Vali Acc: 0.900 Test Loss: 0.474 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.38460803031921387
Epoch: 37, Steps: 3 | Train Loss: 0.222 Vali Loss: 0.425 Vali Acc: 0.900 Test Loss: 0.425 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.39640331268310547
Epoch: 38, Steps: 3 | Train Loss: 0.197 Vali Loss: 0.377 Vali Acc: 0.925 Test Loss: 0.377 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924996).  Saving model ...
Epoch: 39 cost time: 0.4321765899658203
Epoch: 39, Steps: 3 | Train Loss: 0.201 Vali Loss: 0.331 Vali Acc: 0.950 Test Loss: 0.331 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949997).  Saving model ...
Epoch: 40 cost time: 0.4853699207305908
Epoch: 40, Steps: 3 | Train Loss: 0.150 Vali Loss: 0.286 Vali Acc: 0.950 Test Loss: 0.286 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 41 cost time: 0.46133852005004883
Epoch: 41, Steps: 3 | Train Loss: 0.119 Vali Loss: 0.244 Vali Acc: 0.950 Test Loss: 0.244 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 42 cost time: 0.47888755798339844
Epoch: 42, Steps: 3 | Train Loss: 0.121 Vali Loss: 0.210 Vali Acc: 0.950 Test Loss: 0.210 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 43 cost time: 0.4143228530883789
Epoch: 43, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.177 Vali Acc: 0.925 Test Loss: 0.177 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.6126129627227783
Epoch: 44, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.152 Vali Acc: 0.975 Test Loss: 0.152 Test Acc: 0.975
Validation loss decreased (-0.949998 --> -0.974998).  Saving model ...
Epoch: 45 cost time: 0.4288175106048584
Epoch: 45, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.129 Vali Acc: 0.975 Test Loss: 0.129 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 46 cost time: 0.45702528953552246
Epoch: 46, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.111 Vali Acc: 0.975 Test Loss: 0.111 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 47 cost time: 0.514080286026001
Epoch: 47, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.099 Vali Acc: 0.975 Test Loss: 0.099 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 48 cost time: 0.46066808700561523
Epoch: 48, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.089 Vali Acc: 0.975 Test Loss: 0.089 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 49 cost time: 0.6542003154754639
Epoch: 49, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.081 Vali Acc: 0.975 Test Loss: 0.081 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 50 cost time: 0.48946547508239746
Epoch: 50, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.073 Vali Acc: 0.975 Test Loss: 0.073 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 51 cost time: 0.44011688232421875
Epoch: 51, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.066 Vali Acc: 1.000 Test Loss: 0.066 Test Acc: 1.000
Validation loss decreased (-0.974999 --> -0.999999).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm512_cs34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 127182
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm512_cs25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.5999093055725098
Epoch: 1, Steps: 3 | Train Loss: 1.440 Vali Loss: 1.484 Vali Acc: 0.175 Test Loss: 1.484 Test Acc: 0.175
Validation loss decreased (inf --> -0.174985).  Saving model ...
Epoch: 2 cost time: 0.47833728790283203
Epoch: 2, Steps: 3 | Train Loss: 1.428 Vali Loss: 1.475 Vali Acc: 0.175 Test Loss: 1.475 Test Acc: 0.175
Validation loss decreased (-0.174985 --> -0.174985).  Saving model ...
Epoch: 3 cost time: 0.4584832191467285
Epoch: 3, Steps: 3 | Train Loss: 1.413 Vali Loss: 1.463 Vali Acc: 0.175 Test Loss: 1.463 Test Acc: 0.175
Validation loss decreased (-0.174985 --> -0.174985).  Saving model ...
Epoch: 4 cost time: 0.5145957469940186
Epoch: 4, Steps: 3 | Train Loss: 1.370 Vali Loss: 1.447 Vali Acc: 0.200 Test Loss: 1.447 Test Acc: 0.200
Validation loss decreased (-0.174985 --> -0.199986).  Saving model ...
Epoch: 5 cost time: 0.52547287940979
Epoch: 5, Steps: 3 | Train Loss: 1.353 Vali Loss: 1.428 Vali Acc: 0.200 Test Loss: 1.428 Test Acc: 0.200
Validation loss decreased (-0.199986 --> -0.199986).  Saving model ...
Epoch: 6 cost time: 0.47054123878479004
Epoch: 6, Steps: 3 | Train Loss: 1.323 Vali Loss: 1.406 Vali Acc: 0.225 Test Loss: 1.406 Test Acc: 0.225
Validation loss decreased (-0.199986 --> -0.224986).  Saving model ...
Epoch: 7 cost time: 0.6667068004608154
Epoch: 7, Steps: 3 | Train Loss: 1.272 Vali Loss: 1.382 Vali Acc: 0.325 Test Loss: 1.382 Test Acc: 0.325
Validation loss decreased (-0.224986 --> -0.324986).  Saving model ...
Epoch: 8 cost time: 0.5447354316711426
Epoch: 8, Steps: 3 | Train Loss: 1.228 Vali Loss: 1.357 Vali Acc: 0.325 Test Loss: 1.357 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324986).  Saving model ...
Epoch: 9 cost time: 0.47505712509155273
Epoch: 9, Steps: 3 | Train Loss: 1.215 Vali Loss: 1.329 Vali Acc: 0.425 Test Loss: 1.329 Test Acc: 0.425
Validation loss decreased (-0.324986 --> -0.424987).  Saving model ...
Epoch: 10 cost time: 0.5933544635772705
Epoch: 10, Steps: 3 | Train Loss: 1.154 Vali Loss: 1.301 Vali Acc: 0.525 Test Loss: 1.301 Test Acc: 0.525
Validation loss decreased (-0.424987 --> -0.524987).  Saving model ...
Epoch: 11 cost time: 0.6646749973297119
Epoch: 11, Steps: 3 | Train Loss: 1.100 Vali Loss: 1.271 Vali Acc: 0.600 Test Loss: 1.271 Test Acc: 0.600
Validation loss decreased (-0.524987 --> -0.599987).  Saving model ...
Epoch: 12 cost time: 0.48787999153137207
Epoch: 12, Steps: 3 | Train Loss: 1.058 Vali Loss: 1.237 Vali Acc: 0.600 Test Loss: 1.237 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599988).  Saving model ...
Epoch: 13 cost time: 0.4926772117614746
Epoch: 13, Steps: 3 | Train Loss: 1.028 Vali Loss: 1.200 Vali Acc: 0.650 Test Loss: 1.200 Test Acc: 0.650
Validation loss decreased (-0.599988 --> -0.649988).  Saving model ...
Epoch: 14 cost time: 0.5470244884490967
Epoch: 14, Steps: 3 | Train Loss: 0.957 Vali Loss: 1.157 Vali Acc: 0.625 Test Loss: 1.157 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.4818854331970215
Epoch: 15, Steps: 3 | Train Loss: 0.920 Vali Loss: 1.108 Vali Acc: 0.700 Test Loss: 1.108 Test Acc: 0.700
Validation loss decreased (-0.649988 --> -0.699989).  Saving model ...
Epoch: 16 cost time: 0.5160164833068848
Epoch: 16, Steps: 3 | Train Loss: 0.853 Vali Loss: 1.053 Vali Acc: 0.725 Test Loss: 1.053 Test Acc: 0.725
Validation loss decreased (-0.699989 --> -0.724989).  Saving model ...
Epoch: 17 cost time: 0.5247278213500977
Epoch: 17, Steps: 3 | Train Loss: 0.815 Vali Loss: 0.991 Vali Acc: 0.725 Test Loss: 0.991 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724990).  Saving model ...
Epoch: 18 cost time: 0.4587888717651367
Epoch: 18, Steps: 3 | Train Loss: 0.760 Vali Loss: 0.925 Vali Acc: 0.725 Test Loss: 0.925 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724991).  Saving model ...
Epoch: 19 cost time: 0.5494632720947266
Epoch: 19, Steps: 3 | Train Loss: 0.674 Vali Loss: 0.854 Vali Acc: 0.725 Test Loss: 0.854 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 20 cost time: 0.5372042655944824
Epoch: 20, Steps: 3 | Train Loss: 0.620 Vali Loss: 0.780 Vali Acc: 0.750 Test Loss: 0.780 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749992).  Saving model ...
Epoch: 21 cost time: 0.45959019660949707
Epoch: 21, Steps: 3 | Train Loss: 0.558 Vali Loss: 0.701 Vali Acc: 0.775 Test Loss: 0.701 Test Acc: 0.775
Validation loss decreased (-0.749992 --> -0.774993).  Saving model ...
Epoch: 22 cost time: 0.6291677951812744
Epoch: 22, Steps: 3 | Train Loss: 0.488 Vali Loss: 0.617 Vali Acc: 0.825 Test Loss: 0.617 Test Acc: 0.825
Validation loss decreased (-0.774993 --> -0.824994).  Saving model ...
Epoch: 23 cost time: 0.39342737197875977
Epoch: 23, Steps: 3 | Train Loss: 0.420 Vali Loss: 0.535 Vali Acc: 0.850 Test Loss: 0.535 Test Acc: 0.850
Validation loss decreased (-0.824994 --> -0.849995).  Saving model ...
Epoch: 24 cost time: 0.47407960891723633
Epoch: 24, Steps: 3 | Train Loss: 0.379 Vali Loss: 0.461 Vali Acc: 0.875 Test Loss: 0.461 Test Acc: 0.875
Validation loss decreased (-0.849995 --> -0.874995).  Saving model ...
Epoch: 25 cost time: 0.5316145420074463
Epoch: 25, Steps: 3 | Train Loss: 0.332 Vali Loss: 0.401 Vali Acc: 0.925 Test Loss: 0.401 Test Acc: 0.925
Validation loss decreased (-0.874995 --> -0.924996).  Saving model ...
Epoch: 26 cost time: 0.5270919799804688
Epoch: 26, Steps: 3 | Train Loss: 0.290 Vali Loss: 0.350 Vali Acc: 0.925 Test Loss: 0.350 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 27 cost time: 0.5467772483825684
Epoch: 27, Steps: 3 | Train Loss: 0.234 Vali Loss: 0.306 Vali Acc: 0.925 Test Loss: 0.306 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 28 cost time: 0.5102989673614502
Epoch: 28, Steps: 3 | Train Loss: 0.210 Vali Loss: 0.271 Vali Acc: 0.925 Test Loss: 0.271 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 29 cost time: 0.5471854209899902
Epoch: 29, Steps: 3 | Train Loss: 0.180 Vali Loss: 0.237 Vali Acc: 0.925 Test Loss: 0.237 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924998).  Saving model ...
Epoch: 30 cost time: 0.696946382522583
Epoch: 30, Steps: 3 | Train Loss: 0.169 Vali Loss: 0.206 Vali Acc: 0.925 Test Loss: 0.206 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 31 cost time: 0.47357678413391113
Epoch: 31, Steps: 3 | Train Loss: 0.127 Vali Loss: 0.174 Vali Acc: 0.975 Test Loss: 0.174 Test Acc: 0.975
Validation loss decreased (-0.924998 --> -0.974998).  Saving model ...
Epoch: 32 cost time: 0.5898351669311523
Epoch: 32, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.149 Vali Acc: 0.975 Test Loss: 0.149 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 33 cost time: 0.47152090072631836
Epoch: 33, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.124 Vali Acc: 0.975 Test Loss: 0.124 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 34 cost time: 0.48040342330932617
Epoch: 34, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.104 Vali Acc: 0.975 Test Loss: 0.104 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 35 cost time: 0.5083892345428467
Epoch: 35, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.089 Vali Acc: 0.975 Test Loss: 0.089 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 36 cost time: 0.4664773941040039
Epoch: 36, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.080 Vali Acc: 0.950 Test Loss: 0.080 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5604820251464844
Epoch: 37, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.073 Vali Acc: 0.950 Test Loss: 0.073 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.48839640617370605
Epoch: 38, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.067 Vali Acc: 0.950 Test Loss: 0.067 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.6202335357666016
Epoch: 39, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.060 Vali Acc: 0.975 Test Loss: 0.060 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 40 cost time: 0.4715087413787842
Epoch: 40, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.054 Vali Acc: 0.975 Test Loss: 0.054 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 41 cost time: 0.5098373889923096
Epoch: 41, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.050 Vali Acc: 0.975 Test Loss: 0.050 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.975000).  Saving model ...
Epoch: 42 cost time: 0.46161961555480957
Epoch: 42, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.047 Vali Acc: 0.975 Test Loss: 0.047 Test Acc: 0.975
Validation loss decreased (-0.975000 --> -0.975000).  Saving model ...
Epoch: 43 cost time: 0.4628181457519531
Epoch: 43, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.045 Vali Acc: 0.975 Test Loss: 0.045 Test Acc: 0.975
Validation loss decreased (-0.975000 --> -0.975000).  Saving model ...
Epoch: 44 cost time: 0.4731910228729248
Epoch: 44, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.044 Vali Acc: 0.975 Test Loss: 0.044 Test Acc: 0.975
Validation loss decreased (-0.975000 --> -0.975000).  Saving model ...
Epoch: 45 cost time: 0.5278866291046143
Epoch: 45, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.044 Vali Acc: 0.975 Test Loss: 0.044 Test Acc: 0.975
Validation loss decreased (-0.975000 --> -0.975000).  Saving model ...
Epoch: 46 cost time: 0.5825181007385254
Epoch: 46, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.043 Vali Acc: 0.975 Test Loss: 0.043 Test Acc: 0.975
Validation loss decreased (-0.975000 --> -0.975000).  Saving model ...
Epoch: 47 cost time: 0.4876222610473633
Epoch: 47, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.043 Vali Acc: 0.975 Test Loss: 0.043 Test Acc: 0.975
Validation loss decreased (-0.975000 --> -0.975000).  Saving model ...
Epoch: 48 cost time: 0.544219970703125
Epoch: 48, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.041 Vali Acc: 0.975 Test Loss: 0.041 Test Acc: 0.975
Validation loss decreased (-0.975000 --> -0.975000).  Saving model ...
Epoch: 49 cost time: 0.5477912425994873
Epoch: 49, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.040 Vali Acc: 0.975 Test Loss: 0.040 Test Acc: 0.975
Validation loss decreased (-0.975000 --> -0.975000).  Saving model ...
Epoch: 50 cost time: 0.5571649074554443
Epoch: 50, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.038 Vali Acc: 0.975 Test Loss: 0.038 Test Acc: 0.975
Validation loss decreased (-0.975000 --> -0.975000).  Saving model ...
Epoch: 51 cost time: 0.4854888916015625
Epoch: 51, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.036 Vali Acc: 0.975 Test Loss: 0.036 Test Acc: 0.975
Validation loss decreased (-0.975000 --> -0.975000).  Saving model ...
Epoch: 52 cost time: 0.48399853706359863
Epoch: 52, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.035 Vali Acc: 0.975 Test Loss: 0.035 Test Acc: 0.975
Validation loss decreased (-0.975000 --> -0.975000).  Saving model ...
Epoch: 53 cost time: 0.47380709648132324
Epoch: 53, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.033 Vali Acc: 0.975 Test Loss: 0.033 Test Acc: 0.975
Validation loss decreased (-0.975000 --> -0.975000).  Saving model ...
Epoch: 54 cost time: 0.5924391746520996
Epoch: 54, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.032 Vali Acc: 0.975 Test Loss: 0.032 Test Acc: 0.975
Validation loss decreased (-0.975000 --> -0.975000).  Saving model ...
Epoch: 55 cost time: 0.5243573188781738
Epoch: 55, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.032 Vali Acc: 0.975 Test Loss: 0.032 Test Acc: 0.975
Validation loss decreased (-0.975000 --> -0.975000).  Saving model ...
Epoch: 56 cost time: 0.5261602401733398
Epoch: 56, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.031 Vali Acc: 0.975 Test Loss: 0.031 Test Acc: 0.975
Validation loss decreased (-0.975000 --> -0.975000).  Saving model ...
Epoch: 57 cost time: 0.5715701580047607
Epoch: 57, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.031 Vali Acc: 0.975 Test Loss: 0.031 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.6471953392028809
Epoch: 58, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.031 Vali Acc: 0.975 Test Loss: 0.031 Test Acc: 0.975
Validation loss decreased (-0.975000 --> -0.975000).  Saving model ...
Epoch: 59 cost time: 0.5667421817779541
Epoch: 59, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.031 Vali Acc: 0.975 Test Loss: 0.031 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.6085405349731445
Epoch: 60, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.031 Vali Acc: 0.975 Test Loss: 0.031 Test Acc: 0.975
Validation loss decreased (-0.975000 --> -0.975000).  Saving model ...
Epoch: 61 cost time: 0.7093570232391357
Epoch: 61, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.031 Vali Acc: 0.975 Test Loss: 0.031 Test Acc: 0.975
Validation loss decreased (-0.975000 --> -0.975000).  Saving model ...
Epoch: 62 cost time: 0.5401759147644043
Epoch: 62, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.030 Vali Acc: 0.975 Test Loss: 0.030 Test Acc: 0.975
Validation loss decreased (-0.975000 --> -0.975000).  Saving model ...
Epoch: 63 cost time: 0.5214800834655762
Epoch: 63, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.030 Vali Acc: 0.975 Test Loss: 0.030 Test Acc: 0.975
Validation loss decreased (-0.975000 --> -0.975000).  Saving model ...
Epoch: 64 cost time: 0.5075571537017822
Epoch: 64, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.030 Vali Acc: 0.975 Test Loss: 0.030 Test Acc: 0.975
Validation loss decreased (-0.975000 --> -0.975000).  Saving model ...
Epoch: 65 cost time: 0.5274655818939209
Epoch: 65, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.029 Vali Acc: 0.975 Test Loss: 0.029 Test Acc: 0.975
Validation loss decreased (-0.975000 --> -0.975000).  Saving model ...
Epoch: 66 cost time: 0.42908573150634766
Epoch: 66, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.029 Vali Acc: 0.975 Test Loss: 0.029 Test Acc: 0.975
Validation loss decreased (-0.975000 --> -0.975000).  Saving model ...
Epoch: 67 cost time: 0.44653749465942383
Epoch: 67, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.029 Vali Acc: 0.975 Test Loss: 0.029 Test Acc: 0.975
Validation loss decreased (-0.975000 --> -0.975000).  Saving model ...
Epoch: 68 cost time: 0.46622753143310547
Epoch: 68, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.029 Vali Acc: 0.975 Test Loss: 0.029 Test Acc: 0.975
Validation loss decreased (-0.975000 --> -0.975000).  Saving model ...
Epoch: 69 cost time: 0.4591507911682129
Epoch: 69, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.028 Vali Acc: 0.975 Test Loss: 0.028 Test Acc: 0.975
Validation loss decreased (-0.975000 --> -0.975000).  Saving model ...
Epoch: 70 cost time: 0.4115910530090332
Epoch: 70, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.028 Vali Acc: 0.975 Test Loss: 0.028 Test Acc: 0.975
Validation loss decreased (-0.975000 --> -0.975000).  Saving model ...
Epoch: 71 cost time: 0.569953441619873
Epoch: 71, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.027 Vali Acc: 0.975 Test Loss: 0.027 Test Acc: 0.975
Validation loss decreased (-0.975000 --> -0.975000).  Saving model ...
Epoch: 72 cost time: 0.44754695892333984
Epoch: 72, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.027 Vali Acc: 0.975 Test Loss: 0.027 Test Acc: 0.975
Validation loss decreased (-0.975000 --> -0.975000).  Saving model ...
Epoch: 73 cost time: 0.4667477607727051
Epoch: 73, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.027 Vali Acc: 0.975 Test Loss: 0.027 Test Acc: 0.975
Validation loss decreased (-0.975000 --> -0.975000).  Saving model ...
Epoch: 74 cost time: 0.44631195068359375
Epoch: 74, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.027 Vali Acc: 0.975 Test Loss: 0.027 Test Acc: 0.975
Validation loss decreased (-0.975000 --> -0.975000).  Saving model ...
Epoch: 75 cost time: 0.470597505569458
Epoch: 75, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.026 Vali Acc: 0.975 Test Loss: 0.026 Test Acc: 0.975
Validation loss decreased (-0.975000 --> -0.975000).  Saving model ...
Epoch: 76 cost time: 0.45391058921813965
Epoch: 76, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.026 Vali Acc: 0.975 Test Loss: 0.026 Test Acc: 0.975
Validation loss decreased (-0.975000 --> -0.975000).  Saving model ...
Epoch: 77 cost time: 0.5209293365478516
Epoch: 77, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.026 Vali Acc: 1.000 Test Loss: 0.026 Test Acc: 1.000
Validation loss decreased (-0.975000 --> -1.000000).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm512_cs25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 124696
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm512_cs20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.5716934204101562
Epoch: 1, Steps: 3 | Train Loss: 1.374 Vali Loss: 1.355 Vali Acc: 0.375 Test Loss: 1.355 Test Acc: 0.375
Validation loss decreased (inf --> -0.374986).  Saving model ...
Epoch: 2 cost time: 0.4971437454223633
Epoch: 2, Steps: 3 | Train Loss: 1.342 Vali Loss: 1.348 Vali Acc: 0.375 Test Loss: 1.348 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 0.5358004570007324
Epoch: 3, Steps: 3 | Train Loss: 1.367 Vali Loss: 1.342 Vali Acc: 0.375 Test Loss: 1.342 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 4 cost time: 0.3679039478302002
Epoch: 4, Steps: 3 | Train Loss: 1.319 Vali Loss: 1.335 Vali Acc: 0.375 Test Loss: 1.335 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 0.46747899055480957
Epoch: 5, Steps: 3 | Train Loss: 1.292 Vali Loss: 1.325 Vali Acc: 0.375 Test Loss: 1.325 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 6 cost time: 0.4801814556121826
Epoch: 6, Steps: 3 | Train Loss: 1.268 Vali Loss: 1.314 Vali Acc: 0.400 Test Loss: 1.314 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399987).  Saving model ...
Epoch: 7 cost time: 0.5415387153625488
Epoch: 7, Steps: 3 | Train Loss: 1.218 Vali Loss: 1.302 Vali Acc: 0.475 Test Loss: 1.302 Test Acc: 0.475
Validation loss decreased (-0.399987 --> -0.474987).  Saving model ...
Epoch: 8 cost time: 0.5322587490081787
Epoch: 8, Steps: 3 | Train Loss: 1.217 Vali Loss: 1.289 Vali Acc: 0.475 Test Loss: 1.289 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 9 cost time: 0.5511765480041504
Epoch: 9, Steps: 3 | Train Loss: 1.174 Vali Loss: 1.276 Vali Acc: 0.475 Test Loss: 1.276 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 10 cost time: 0.5344464778900146
Epoch: 10, Steps: 3 | Train Loss: 1.131 Vali Loss: 1.262 Vali Acc: 0.450 Test Loss: 1.262 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5212352275848389
Epoch: 11, Steps: 3 | Train Loss: 1.100 Vali Loss: 1.247 Vali Acc: 0.450 Test Loss: 1.247 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.5379908084869385
Epoch: 12, Steps: 3 | Train Loss: 1.090 Vali Loss: 1.231 Vali Acc: 0.450 Test Loss: 1.231 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.5572192668914795
Epoch: 13, Steps: 3 | Train Loss: 1.034 Vali Loss: 1.214 Vali Acc: 0.450 Test Loss: 1.214 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.4840540885925293
Epoch: 14, Steps: 3 | Train Loss: 1.000 Vali Loss: 1.197 Vali Acc: 0.475 Test Loss: 1.197 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474988).  Saving model ...
Epoch: 15 cost time: 0.6053428649902344
Epoch: 15, Steps: 3 | Train Loss: 0.964 Vali Loss: 1.180 Vali Acc: 0.525 Test Loss: 1.180 Test Acc: 0.525
Validation loss decreased (-0.474988 --> -0.524988).  Saving model ...
Epoch: 16 cost time: 0.4820518493652344
Epoch: 16, Steps: 3 | Train Loss: 0.927 Vali Loss: 1.162 Vali Acc: 0.550 Test Loss: 1.162 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 17 cost time: 0.44095897674560547
Epoch: 17, Steps: 3 | Train Loss: 0.915 Vali Loss: 1.143 Vali Acc: 0.575 Test Loss: 1.143 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574989).  Saving model ...
Epoch: 18 cost time: 0.5361413955688477
Epoch: 18, Steps: 3 | Train Loss: 0.882 Vali Loss: 1.125 Vali Acc: 0.625 Test Loss: 1.125 Test Acc: 0.625
Validation loss decreased (-0.574989 --> -0.624989).  Saving model ...
Epoch: 19 cost time: 0.606442928314209
Epoch: 19, Steps: 3 | Train Loss: 0.846 Vali Loss: 1.107 Vali Acc: 0.625 Test Loss: 1.107 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 20 cost time: 0.5518636703491211
Epoch: 20, Steps: 3 | Train Loss: 0.808 Vali Loss: 1.088 Vali Acc: 0.725 Test Loss: 1.088 Test Acc: 0.725
Validation loss decreased (-0.624989 --> -0.724989).  Saving model ...
Epoch: 21 cost time: 0.4967465400695801
Epoch: 21, Steps: 3 | Train Loss: 0.777 Vali Loss: 1.070 Vali Acc: 0.750 Test Loss: 1.070 Test Acc: 0.750
Validation loss decreased (-0.724989 --> -0.749989).  Saving model ...
Epoch: 22 cost time: 0.5298926830291748
Epoch: 22, Steps: 3 | Train Loss: 0.769 Vali Loss: 1.053 Vali Acc: 0.750 Test Loss: 1.053 Test Acc: 0.750
Validation loss decreased (-0.749989 --> -0.749989).  Saving model ...
Epoch: 23 cost time: 0.5729365348815918
Epoch: 23, Steps: 3 | Train Loss: 0.729 Vali Loss: 1.035 Vali Acc: 0.775 Test Loss: 1.035 Test Acc: 0.775
Validation loss decreased (-0.749989 --> -0.774990).  Saving model ...
Epoch: 24 cost time: 0.4747748374938965
Epoch: 24, Steps: 3 | Train Loss: 0.674 Vali Loss: 1.016 Vali Acc: 0.825 Test Loss: 1.016 Test Acc: 0.825
Validation loss decreased (-0.774990 --> -0.824990).  Saving model ...
Epoch: 25 cost time: 0.511768102645874
Epoch: 25, Steps: 3 | Train Loss: 0.653 Vali Loss: 0.998 Vali Acc: 0.825 Test Loss: 0.998 Test Acc: 0.825
Validation loss decreased (-0.824990 --> -0.824990).  Saving model ...
Epoch: 26 cost time: 0.4635498523712158
Epoch: 26, Steps: 3 | Train Loss: 0.630 Vali Loss: 0.979 Vali Acc: 0.825 Test Loss: 0.979 Test Acc: 0.825
Validation loss decreased (-0.824990 --> -0.824990).  Saving model ...
Epoch: 27 cost time: 0.5443313121795654
Epoch: 27, Steps: 3 | Train Loss: 0.580 Vali Loss: 0.962 Vali Acc: 0.825 Test Loss: 0.962 Test Acc: 0.825
Validation loss decreased (-0.824990 --> -0.824990).  Saving model ...
Epoch: 28 cost time: 0.47566866874694824
Epoch: 28, Steps: 3 | Train Loss: 0.567 Vali Loss: 0.946 Vali Acc: 0.825 Test Loss: 0.946 Test Acc: 0.825
Validation loss decreased (-0.824990 --> -0.824991).  Saving model ...
Epoch: 29 cost time: 0.5002024173736572
Epoch: 29, Steps: 3 | Train Loss: 0.583 Vali Loss: 0.928 Vali Acc: 0.825 Test Loss: 0.928 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824991).  Saving model ...
Epoch: 30 cost time: 0.45883750915527344
Epoch: 30, Steps: 3 | Train Loss: 0.522 Vali Loss: 0.911 Vali Acc: 0.825 Test Loss: 0.911 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824991).  Saving model ...
Epoch: 31 cost time: 0.5141010284423828
Epoch: 31, Steps: 3 | Train Loss: 0.481 Vali Loss: 0.898 Vali Acc: 0.825 Test Loss: 0.898 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824991).  Saving model ...
Epoch: 32 cost time: 0.4761202335357666
Epoch: 32, Steps: 3 | Train Loss: 0.507 Vali Loss: 0.881 Vali Acc: 0.825 Test Loss: 0.881 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824991).  Saving model ...
Epoch: 33 cost time: 0.4993135929107666
Epoch: 33, Steps: 3 | Train Loss: 0.452 Vali Loss: 0.865 Vali Acc: 0.850 Test Loss: 0.865 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849991).  Saving model ...
Epoch: 34 cost time: 0.5862879753112793
Epoch: 34, Steps: 3 | Train Loss: 0.433 Vali Loss: 0.846 Vali Acc: 0.800 Test Loss: 0.846 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.5589618682861328
Epoch: 35, Steps: 3 | Train Loss: 0.392 Vali Loss: 0.829 Vali Acc: 0.825 Test Loss: 0.829 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.6792902946472168
Epoch: 36, Steps: 3 | Train Loss: 0.406 Vali Loss: 0.808 Vali Acc: 0.825 Test Loss: 0.808 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.6422505378723145
Epoch: 37, Steps: 3 | Train Loss: 0.368 Vali Loss: 0.788 Vali Acc: 0.850 Test Loss: 0.788 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849992).  Saving model ...
Epoch: 38 cost time: 0.5572490692138672
Epoch: 38, Steps: 3 | Train Loss: 0.340 Vali Loss: 0.773 Vali Acc: 0.850 Test Loss: 0.773 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 39 cost time: 0.6206040382385254
Epoch: 39, Steps: 3 | Train Loss: 0.327 Vali Loss: 0.757 Vali Acc: 0.825 Test Loss: 0.757 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.5172874927520752
Epoch: 40, Steps: 3 | Train Loss: 0.315 Vali Loss: 0.744 Vali Acc: 0.800 Test Loss: 0.744 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.5241379737854004
Epoch: 41, Steps: 3 | Train Loss: 0.265 Vali Loss: 0.731 Vali Acc: 0.800 Test Loss: 0.731 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.5759408473968506
Epoch: 42, Steps: 3 | Train Loss: 0.252 Vali Loss: 0.708 Vali Acc: 0.800 Test Loss: 0.708 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.5882139205932617
Epoch: 43, Steps: 3 | Train Loss: 0.273 Vali Loss: 0.682 Vali Acc: 0.800 Test Loss: 0.682 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.4427213668823242
Epoch: 44, Steps: 3 | Train Loss: 0.227 Vali Loss: 0.656 Vali Acc: 0.825 Test Loss: 0.656 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.4941997528076172
Epoch: 45, Steps: 3 | Train Loss: 0.218 Vali Loss: 0.632 Vali Acc: 0.825 Test Loss: 0.632 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.6111805438995361
Epoch: 46, Steps: 3 | Train Loss: 0.226 Vali Loss: 0.615 Vali Acc: 0.800 Test Loss: 0.615 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.5188655853271484
Epoch: 47, Steps: 3 | Train Loss: 0.177 Vali Loss: 0.588 Vali Acc: 0.825 Test Loss: 0.588 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.5234060287475586
Epoch: 48, Steps: 3 | Train Loss: 0.181 Vali Loss: 0.560 Vali Acc: 0.775 Test Loss: 0.560 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm512_cs20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.85
model parameter : 123438
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm512_cs17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6585469245910645
Epoch: 1, Steps: 3 | Train Loss: 1.437 Vali Loss: 1.463 Vali Acc: 0.175 Test Loss: 1.463 Test Acc: 0.175
Validation loss decreased (inf --> -0.174985).  Saving model ...
Epoch: 2 cost time: 0.4879188537597656
Epoch: 2, Steps: 3 | Train Loss: 1.447 Vali Loss: 1.454 Vali Acc: 0.175 Test Loss: 1.454 Test Acc: 0.175
Validation loss decreased (-0.174985 --> -0.174985).  Saving model ...
Epoch: 3 cost time: 0.4890785217285156
Epoch: 3, Steps: 3 | Train Loss: 1.441 Vali Loss: 1.443 Vali Acc: 0.200 Test Loss: 1.443 Test Acc: 0.200
Validation loss decreased (-0.174985 --> -0.199986).  Saving model ...
Epoch: 4 cost time: 0.5996105670928955
Epoch: 4, Steps: 3 | Train Loss: 1.388 Vali Loss: 1.428 Vali Acc: 0.225 Test Loss: 1.428 Test Acc: 0.225
Validation loss decreased (-0.199986 --> -0.224986).  Saving model ...
Epoch: 5 cost time: 0.5303366184234619
Epoch: 5, Steps: 3 | Train Loss: 1.364 Vali Loss: 1.411 Vali Acc: 0.200 Test Loss: 1.411 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5954952239990234
Epoch: 6, Steps: 3 | Train Loss: 1.333 Vali Loss: 1.392 Vali Acc: 0.250 Test Loss: 1.392 Test Acc: 0.250
Validation loss decreased (-0.224986 --> -0.249986).  Saving model ...
Epoch: 7 cost time: 0.46621036529541016
Epoch: 7, Steps: 3 | Train Loss: 1.284 Vali Loss: 1.370 Vali Acc: 0.325 Test Loss: 1.370 Test Acc: 0.325
Validation loss decreased (-0.249986 --> -0.324986).  Saving model ...
Epoch: 8 cost time: 0.48448657989501953
Epoch: 8, Steps: 3 | Train Loss: 1.254 Vali Loss: 1.349 Vali Acc: 0.425 Test Loss: 1.349 Test Acc: 0.425
Validation loss decreased (-0.324986 --> -0.424987).  Saving model ...
Epoch: 9 cost time: 0.551438570022583
Epoch: 9, Steps: 3 | Train Loss: 1.230 Vali Loss: 1.326 Vali Acc: 0.475 Test Loss: 1.326 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474987).  Saving model ...
Epoch: 10 cost time: 0.4487485885620117
Epoch: 10, Steps: 3 | Train Loss: 1.157 Vali Loss: 1.304 Vali Acc: 0.475 Test Loss: 1.304 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 11 cost time: 0.5021905899047852
Epoch: 11, Steps: 3 | Train Loss: 1.159 Vali Loss: 1.280 Vali Acc: 0.475 Test Loss: 1.280 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 12 cost time: 0.5279898643493652
Epoch: 12, Steps: 3 | Train Loss: 1.096 Vali Loss: 1.252 Vali Acc: 0.500 Test Loss: 1.252 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499987).  Saving model ...
Epoch: 13 cost time: 0.5449304580688477
Epoch: 13, Steps: 3 | Train Loss: 1.057 Vali Loss: 1.225 Vali Acc: 0.500 Test Loss: 1.225 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499988).  Saving model ...
Epoch: 14 cost time: 0.456587553024292
Epoch: 14, Steps: 3 | Train Loss: 0.991 Vali Loss: 1.197 Vali Acc: 0.500 Test Loss: 1.197 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 15 cost time: 0.4886140823364258
Epoch: 15, Steps: 3 | Train Loss: 0.976 Vali Loss: 1.165 Vali Acc: 0.525 Test Loss: 1.165 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 16 cost time: 0.5060389041900635
Epoch: 16, Steps: 3 | Train Loss: 0.931 Vali Loss: 1.130 Vali Acc: 0.550 Test Loss: 1.130 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549989).  Saving model ...
Epoch: 17 cost time: 0.5368108749389648
Epoch: 17, Steps: 3 | Train Loss: 0.876 Vali Loss: 1.090 Vali Acc: 0.625 Test Loss: 1.090 Test Acc: 0.625
Validation loss decreased (-0.549989 --> -0.624989).  Saving model ...
Epoch: 18 cost time: 0.5034029483795166
Epoch: 18, Steps: 3 | Train Loss: 0.848 Vali Loss: 1.045 Vali Acc: 0.675 Test Loss: 1.045 Test Acc: 0.675
Validation loss decreased (-0.624989 --> -0.674990).  Saving model ...
Epoch: 19 cost time: 0.5108981132507324
Epoch: 19, Steps: 3 | Train Loss: 0.800 Vali Loss: 1.000 Vali Acc: 0.700 Test Loss: 1.000 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 20 cost time: 0.5638892650604248
Epoch: 20, Steps: 3 | Train Loss: 0.748 Vali Loss: 0.955 Vali Acc: 0.725 Test Loss: 0.955 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724990).  Saving model ...
Epoch: 21 cost time: 0.5079922676086426
Epoch: 21, Steps: 3 | Train Loss: 0.697 Vali Loss: 0.902 Vali Acc: 0.775 Test Loss: 0.902 Test Acc: 0.775
Validation loss decreased (-0.724990 --> -0.774991).  Saving model ...
Epoch: 22 cost time: 0.5320761203765869
Epoch: 22, Steps: 3 | Train Loss: 0.620 Vali Loss: 0.847 Vali Acc: 0.825 Test Loss: 0.847 Test Acc: 0.825
Validation loss decreased (-0.774991 --> -0.824992).  Saving model ...
Epoch: 23 cost time: 0.5053014755249023
Epoch: 23, Steps: 3 | Train Loss: 0.602 Vali Loss: 0.787 Vali Acc: 0.825 Test Loss: 0.787 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 24 cost time: 0.5681934356689453
Epoch: 24, Steps: 3 | Train Loss: 0.515 Vali Loss: 0.720 Vali Acc: 0.850 Test Loss: 0.720 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849993).  Saving model ...
Epoch: 25 cost time: 0.49271082878112793
Epoch: 25, Steps: 3 | Train Loss: 0.470 Vali Loss: 0.649 Vali Acc: 0.875 Test Loss: 0.649 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874994).  Saving model ...
Epoch: 26 cost time: 0.5306189060211182
Epoch: 26, Steps: 3 | Train Loss: 0.404 Vali Loss: 0.576 Vali Acc: 0.900 Test Loss: 0.576 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899994).  Saving model ...
Epoch: 27 cost time: 0.5391881465911865
Epoch: 27, Steps: 3 | Train Loss: 0.388 Vali Loss: 0.505 Vali Acc: 0.925 Test Loss: 0.505 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924995).  Saving model ...
Epoch: 28 cost time: 0.5422098636627197
Epoch: 28, Steps: 3 | Train Loss: 0.349 Vali Loss: 0.441 Vali Acc: 0.950 Test Loss: 0.441 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949996).  Saving model ...
Epoch: 29 cost time: 0.544130802154541
Epoch: 29, Steps: 3 | Train Loss: 0.281 Vali Loss: 0.386 Vali Acc: 0.950 Test Loss: 0.386 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 30 cost time: 0.48211240768432617
Epoch: 30, Steps: 3 | Train Loss: 0.264 Vali Loss: 0.336 Vali Acc: 0.950 Test Loss: 0.336 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 31 cost time: 0.577246904373169
Epoch: 31, Steps: 3 | Train Loss: 0.237 Vali Loss: 0.290 Vali Acc: 0.975 Test Loss: 0.290 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974997).  Saving model ...
Epoch: 32 cost time: 0.5373709201812744
Epoch: 32, Steps: 3 | Train Loss: 0.195 Vali Loss: 0.249 Vali Acc: 0.975 Test Loss: 0.249 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 33 cost time: 0.5751290321350098
Epoch: 33, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.213 Vali Acc: 0.975 Test Loss: 0.213 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 34 cost time: 0.5315697193145752
Epoch: 34, Steps: 3 | Train Loss: 0.154 Vali Loss: 0.182 Vali Acc: 0.975 Test Loss: 0.182 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 35 cost time: 0.5048909187316895
Epoch: 35, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.155 Vali Acc: 0.975 Test Loss: 0.155 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 36 cost time: 0.5748341083526611
Epoch: 36, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.131 Vali Acc: 0.950 Test Loss: 0.131 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.6167082786560059
Epoch: 37, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.113 Vali Acc: 0.975 Test Loss: 0.113 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 38 cost time: 0.4727451801300049
Epoch: 38, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.103 Vali Acc: 0.975 Test Loss: 0.103 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 39 cost time: 0.5149884223937988
Epoch: 39, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.094 Vali Acc: 0.975 Test Loss: 0.094 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 40 cost time: 0.5585329532623291
Epoch: 40, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.079 Vali Acc: 0.975 Test Loss: 0.079 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 41 cost time: 0.5349032878875732
Epoch: 41, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.067 Vali Acc: 0.975 Test Loss: 0.067 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 42 cost time: 0.46709418296813965
Epoch: 42, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.062 Vali Acc: 0.975 Test Loss: 0.062 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 43 cost time: 0.46676015853881836
Epoch: 43, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.059 Vali Acc: 0.975 Test Loss: 0.059 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 44 cost time: 0.5521008968353271
Epoch: 44, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.059 Vali Acc: 0.975 Test Loss: 0.059 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.3716554641723633
Epoch: 45, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.060 Vali Acc: 0.975 Test Loss: 0.060 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.5399730205535889
Epoch: 46, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.062 Vali Acc: 0.975 Test Loss: 0.062 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.5081453323364258
Epoch: 47, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.064 Vali Acc: 0.975 Test Loss: 0.064 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.4501032829284668
Epoch: 48, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.064 Vali Acc: 0.975 Test Loss: 0.064 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.5595269203186035
Epoch: 49, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.062 Vali Acc: 0.975 Test Loss: 0.062 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.49704742431640625
Epoch: 50, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.061 Vali Acc: 0.975 Test Loss: 0.061 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 0.5445904731750488
Epoch: 51, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.059 Vali Acc: 0.975 Test Loss: 0.059 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 52 cost time: 0.3617830276489258
Epoch: 52, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.057 Vali Acc: 0.975 Test Loss: 0.057 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 53 cost time: 0.3618636131286621
Epoch: 53, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.054 Vali Acc: 0.975 Test Loss: 0.054 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 54 cost time: 0.3824424743652344
Epoch: 54, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.051 Vali Acc: 0.975 Test Loss: 0.051 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 55 cost time: 0.5075862407684326
Epoch: 55, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.050 Vali Acc: 0.975 Test Loss: 0.050 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 56 cost time: 0.43850088119506836
Epoch: 56, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.049 Vali Acc: 0.975 Test Loss: 0.049 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.975000).  Saving model ...
Epoch: 57 cost time: 0.43729424476623535
Epoch: 57, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.049 Vali Acc: 0.975 Test Loss: 0.049 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.48804378509521484
Epoch: 58, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.050 Vali Acc: 0.975 Test Loss: 0.050 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.4377713203430176
Epoch: 59, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.050 Vali Acc: 0.975 Test Loss: 0.050 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.5658800601959229
Epoch: 60, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.051 Vali Acc: 0.975 Test Loss: 0.051 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 0.57918381690979
Epoch: 61, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.051 Vali Acc: 0.975 Test Loss: 0.051 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 0.45206689834594727
Epoch: 62, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.051 Vali Acc: 0.975 Test Loss: 0.051 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 0.52105712890625
Epoch: 63, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.052 Vali Acc: 0.975 Test Loss: 0.052 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 0.5512292385101318
Epoch: 64, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.052 Vali Acc: 0.975 Test Loss: 0.052 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 0.4555168151855469
Epoch: 65, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.052 Vali Acc: 0.975 Test Loss: 0.052 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 0.40160155296325684
Epoch: 66, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.052 Vali Acc: 0.975 Test Loss: 0.052 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm512_cs17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 122896
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm512_cs15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6711783409118652
Epoch: 1, Steps: 3 | Train Loss: 1.527 Vali Loss: 1.613 Vali Acc: 0.175 Test Loss: 1.613 Test Acc: 0.175
Validation loss decreased (inf --> -0.174984).  Saving model ...
Epoch: 2 cost time: 0.62965989112854
Epoch: 2, Steps: 3 | Train Loss: 1.478 Vali Loss: 1.603 Vali Acc: 0.175 Test Loss: 1.603 Test Acc: 0.175
Validation loss decreased (-0.174984 --> -0.174984).  Saving model ...
Epoch: 3 cost time: 0.4514000415802002
Epoch: 3, Steps: 3 | Train Loss: 1.462 Vali Loss: 1.594 Vali Acc: 0.175 Test Loss: 1.594 Test Acc: 0.175
Validation loss decreased (-0.174984 --> -0.174984).  Saving model ...
Epoch: 4 cost time: 0.5481119155883789
Epoch: 4, Steps: 3 | Train Loss: 1.456 Vali Loss: 1.582 Vali Acc: 0.150 Test Loss: 1.582 Test Acc: 0.150
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5228402614593506
Epoch: 5, Steps: 3 | Train Loss: 1.447 Vali Loss: 1.567 Vali Acc: 0.125 Test Loss: 1.567 Test Acc: 0.125
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.49961328506469727
Epoch: 6, Steps: 3 | Train Loss: 1.408 Vali Loss: 1.550 Vali Acc: 0.250 Test Loss: 1.550 Test Acc: 0.250
Validation loss decreased (-0.174984 --> -0.249984).  Saving model ...
Epoch: 7 cost time: 0.4418351650238037
Epoch: 7, Steps: 3 | Train Loss: 1.367 Vali Loss: 1.533 Vali Acc: 0.250 Test Loss: 1.533 Test Acc: 0.250
Validation loss decreased (-0.249984 --> -0.249985).  Saving model ...
Epoch: 8 cost time: 0.5180211067199707
Epoch: 8, Steps: 3 | Train Loss: 1.333 Vali Loss: 1.514 Vali Acc: 0.300 Test Loss: 1.514 Test Acc: 0.300
Validation loss decreased (-0.249985 --> -0.299985).  Saving model ...
Epoch: 9 cost time: 0.579390287399292
Epoch: 9, Steps: 3 | Train Loss: 1.296 Vali Loss: 1.496 Vali Acc: 0.300 Test Loss: 1.496 Test Acc: 0.300
Validation loss decreased (-0.299985 --> -0.299985).  Saving model ...
Epoch: 10 cost time: 0.46439337730407715
Epoch: 10, Steps: 3 | Train Loss: 1.259 Vali Loss: 1.475 Vali Acc: 0.325 Test Loss: 1.475 Test Acc: 0.325
Validation loss decreased (-0.299985 --> -0.324985).  Saving model ...
Epoch: 11 cost time: 0.5129384994506836
Epoch: 11, Steps: 3 | Train Loss: 1.217 Vali Loss: 1.452 Vali Acc: 0.325 Test Loss: 1.452 Test Acc: 0.325
Validation loss decreased (-0.324985 --> -0.324985).  Saving model ...
Epoch: 12 cost time: 0.5905952453613281
Epoch: 12, Steps: 3 | Train Loss: 1.168 Vali Loss: 1.429 Vali Acc: 0.350 Test Loss: 1.429 Test Acc: 0.350
Validation loss decreased (-0.324985 --> -0.349986).  Saving model ...
Epoch: 13 cost time: 0.60849928855896
Epoch: 13, Steps: 3 | Train Loss: 1.134 Vali Loss: 1.406 Vali Acc: 0.375 Test Loss: 1.406 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374986).  Saving model ...
Epoch: 14 cost time: 0.5822229385375977
Epoch: 14, Steps: 3 | Train Loss: 1.085 Vali Loss: 1.381 Vali Acc: 0.400 Test Loss: 1.381 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399986).  Saving model ...
Epoch: 15 cost time: 0.555471658706665
Epoch: 15, Steps: 3 | Train Loss: 1.026 Vali Loss: 1.355 Vali Acc: 0.350 Test Loss: 1.355 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5894348621368408
Epoch: 16, Steps: 3 | Train Loss: 1.001 Vali Loss: 1.324 Vali Acc: 0.375 Test Loss: 1.324 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5268082618713379
Epoch: 17, Steps: 3 | Train Loss: 0.954 Vali Loss: 1.294 Vali Acc: 0.375 Test Loss: 1.294 Test Acc: 0.375
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5392024517059326
Epoch: 18, Steps: 3 | Train Loss: 0.917 Vali Loss: 1.258 Vali Acc: 0.425 Test Loss: 1.258 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424987).  Saving model ...
Epoch: 19 cost time: 0.5253040790557861
Epoch: 19, Steps: 3 | Train Loss: 0.842 Vali Loss: 1.218 Vali Acc: 0.425 Test Loss: 1.218 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424988).  Saving model ...
Epoch: 20 cost time: 0.5427560806274414
Epoch: 20, Steps: 3 | Train Loss: 0.819 Vali Loss: 1.170 Vali Acc: 0.425 Test Loss: 1.170 Test Acc: 0.425
Validation loss decreased (-0.424988 --> -0.424988).  Saving model ...
Epoch: 21 cost time: 0.542304515838623
Epoch: 21, Steps: 3 | Train Loss: 0.774 Vali Loss: 1.119 Vali Acc: 0.575 Test Loss: 1.119 Test Acc: 0.575
Validation loss decreased (-0.424988 --> -0.574989).  Saving model ...
Epoch: 22 cost time: 0.4752957820892334
Epoch: 22, Steps: 3 | Train Loss: 0.691 Vali Loss: 1.067 Vali Acc: 0.600 Test Loss: 1.067 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599989).  Saving model ...
Epoch: 23 cost time: 0.6576724052429199
Epoch: 23, Steps: 3 | Train Loss: 0.653 Vali Loss: 1.005 Vali Acc: 0.650 Test Loss: 1.005 Test Acc: 0.650
Validation loss decreased (-0.599989 --> -0.649990).  Saving model ...
Epoch: 24 cost time: 0.4913644790649414
Epoch: 24, Steps: 3 | Train Loss: 0.620 Vali Loss: 0.935 Vali Acc: 0.725 Test Loss: 0.935 Test Acc: 0.725
Validation loss decreased (-0.649990 --> -0.724991).  Saving model ...
Epoch: 25 cost time: 0.45476412773132324
Epoch: 25, Steps: 3 | Train Loss: 0.568 Vali Loss: 0.865 Vali Acc: 0.750 Test Loss: 0.865 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749991).  Saving model ...
Epoch: 26 cost time: 0.5219228267669678
Epoch: 26, Steps: 3 | Train Loss: 0.519 Vali Loss: 0.791 Vali Acc: 0.750 Test Loss: 0.791 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 27 cost time: 0.6243143081665039
Epoch: 27, Steps: 3 | Train Loss: 0.480 Vali Loss: 0.725 Vali Acc: 0.750 Test Loss: 0.725 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749993).  Saving model ...
Epoch: 28 cost time: 0.5886049270629883
Epoch: 28, Steps: 3 | Train Loss: 0.402 Vali Loss: 0.666 Vali Acc: 0.750 Test Loss: 0.666 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 29 cost time: 0.4621715545654297
Epoch: 29, Steps: 3 | Train Loss: 0.347 Vali Loss: 0.604 Vali Acc: 0.725 Test Loss: 0.604 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5990760326385498
Epoch: 30, Steps: 3 | Train Loss: 0.340 Vali Loss: 0.545 Vali Acc: 0.750 Test Loss: 0.545 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749995).  Saving model ...
Epoch: 31 cost time: 0.5271589756011963
Epoch: 31, Steps: 3 | Train Loss: 0.314 Vali Loss: 0.490 Vali Acc: 0.825 Test Loss: 0.490 Test Acc: 0.825
Validation loss decreased (-0.749995 --> -0.824995).  Saving model ...
Epoch: 32 cost time: 0.5636990070343018
Epoch: 32, Steps: 3 | Train Loss: 0.283 Vali Loss: 0.442 Vali Acc: 0.850 Test Loss: 0.442 Test Acc: 0.850
Validation loss decreased (-0.824995 --> -0.849996).  Saving model ...
Epoch: 33 cost time: 0.5909028053283691
Epoch: 33, Steps: 3 | Train Loss: 0.266 Vali Loss: 0.395 Vali Acc: 0.850 Test Loss: 0.395 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 34 cost time: 0.5055885314941406
Epoch: 34, Steps: 3 | Train Loss: 0.235 Vali Loss: 0.351 Vali Acc: 0.850 Test Loss: 0.351 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 35 cost time: 0.5356671810150146
Epoch: 35, Steps: 3 | Train Loss: 0.205 Vali Loss: 0.309 Vali Acc: 0.875 Test Loss: 0.309 Test Acc: 0.875
Validation loss decreased (-0.849996 --> -0.874997).  Saving model ...
Epoch: 36 cost time: 0.41228532791137695
Epoch: 36, Steps: 3 | Train Loss: 0.178 Vali Loss: 0.273 Vali Acc: 0.875 Test Loss: 0.273 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 37 cost time: 0.5329911708831787
Epoch: 37, Steps: 3 | Train Loss: 0.163 Vali Loss: 0.240 Vali Acc: 0.900 Test Loss: 0.240 Test Acc: 0.900
Validation loss decreased (-0.874997 --> -0.899998).  Saving model ...
Epoch: 38 cost time: 0.5587589740753174
Epoch: 38, Steps: 3 | Train Loss: 0.132 Vali Loss: 0.210 Vali Acc: 0.925 Test Loss: 0.210 Test Acc: 0.925
Validation loss decreased (-0.899998 --> -0.924998).  Saving model ...
Epoch: 39 cost time: 0.45084571838378906
Epoch: 39, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.185 Vali Acc: 0.950 Test Loss: 0.185 Test Acc: 0.950
Validation loss decreased (-0.924998 --> -0.949998).  Saving model ...
Epoch: 40 cost time: 0.5260653495788574
Epoch: 40, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.168 Vali Acc: 0.950 Test Loss: 0.168 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 41 cost time: 0.5301775932312012
Epoch: 41, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.151 Vali Acc: 0.950 Test Loss: 0.151 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 42 cost time: 0.4984171390533447
Epoch: 42, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.135 Vali Acc: 0.950 Test Loss: 0.135 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949999).  Saving model ...
Epoch: 43 cost time: 0.5067784786224365
Epoch: 43, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.123 Vali Acc: 0.950 Test Loss: 0.123 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 44 cost time: 0.5191545486450195
Epoch: 44, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.116 Vali Acc: 0.950 Test Loss: 0.116 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 45 cost time: 0.5091571807861328
Epoch: 45, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.119 Vali Acc: 0.950 Test Loss: 0.119 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.484527587890625
Epoch: 46, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.120 Vali Acc: 0.975 Test Loss: 0.120 Test Acc: 0.975
Validation loss decreased (-0.949999 --> -0.974999).  Saving model ...
Epoch: 47 cost time: 0.5197525024414062
Epoch: 47, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.115 Vali Acc: 0.975 Test Loss: 0.115 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 48 cost time: 0.522160530090332
Epoch: 48, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.106 Vali Acc: 0.975 Test Loss: 0.106 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 49 cost time: 0.5321049690246582
Epoch: 49, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.098 Vali Acc: 0.975 Test Loss: 0.098 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 50 cost time: 0.4966390132904053
Epoch: 50, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.975 Test Loss: 0.093 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 51 cost time: 0.6427526473999023
Epoch: 51, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.975 Test Loss: 0.090 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 52 cost time: 0.4733436107635498
Epoch: 52, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.975 Test Loss: 0.090 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 53 cost time: 0.5314266681671143
Epoch: 53, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.975 Test Loss: 0.090 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.5107629299163818
Epoch: 54, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.975 Test Loss: 0.091 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.5261325836181641
Epoch: 55, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.975 Test Loss: 0.092 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.6940157413482666
Epoch: 56, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.975 Test Loss: 0.093 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.5126030445098877
Epoch: 57, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.975 Test Loss: 0.095 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 0.4824545383453369
Epoch: 58, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.975 Test Loss: 0.096 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 0.5094678401947021
Epoch: 59, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.975 Test Loss: 0.097 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 0.45792317390441895
Epoch: 60, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.975 Test Loss: 0.097 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 0.547584056854248
Epoch: 61, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.975 Test Loss: 0.097 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 0.5724973678588867
Epoch: 62, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.975 Test Loss: 0.097 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm512_cs15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 122714
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm512_cs13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7767188549041748
Epoch: 1, Steps: 3 | Train Loss: 1.459 Vali Loss: 1.374 Vali Acc: 0.400 Test Loss: 1.374 Test Acc: 0.400
Validation loss decreased (inf --> -0.399986).  Saving model ...
Epoch: 2 cost time: 0.5388510227203369
Epoch: 2, Steps: 3 | Train Loss: 1.431 Vali Loss: 1.366 Vali Acc: 0.400 Test Loss: 1.366 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399986).  Saving model ...
Epoch: 3 cost time: 0.4970083236694336
Epoch: 3, Steps: 3 | Train Loss: 1.421 Vali Loss: 1.359 Vali Acc: 0.400 Test Loss: 1.359 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399986).  Saving model ...
Epoch: 4 cost time: 0.565631628036499
Epoch: 4, Steps: 3 | Train Loss: 1.435 Vali Loss: 1.348 Vali Acc: 0.450 Test Loss: 1.348 Test Acc: 0.450
Validation loss decreased (-0.399986 --> -0.449987).  Saving model ...
Epoch: 5 cost time: 0.4530043601989746
Epoch: 5, Steps: 3 | Train Loss: 1.364 Vali Loss: 1.336 Vali Acc: 0.550 Test Loss: 1.336 Test Acc: 0.550
Validation loss decreased (-0.449987 --> -0.549987).  Saving model ...
Epoch: 6 cost time: 0.4400973320007324
Epoch: 6, Steps: 3 | Train Loss: 1.360 Vali Loss: 1.322 Vali Acc: 0.575 Test Loss: 1.322 Test Acc: 0.575
Validation loss decreased (-0.549987 --> -0.574987).  Saving model ...
Epoch: 7 cost time: 0.564511775970459
Epoch: 7, Steps: 3 | Train Loss: 1.313 Vali Loss: 1.306 Vali Acc: 0.575 Test Loss: 1.306 Test Acc: 0.575
Validation loss decreased (-0.574987 --> -0.574987).  Saving model ...
Epoch: 8 cost time: 0.5950870513916016
Epoch: 8, Steps: 3 | Train Loss: 1.298 Vali Loss: 1.290 Vali Acc: 0.525 Test Loss: 1.290 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5539472103118896
Epoch: 9, Steps: 3 | Train Loss: 1.266 Vali Loss: 1.272 Vali Acc: 0.500 Test Loss: 1.272 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.506817102432251
Epoch: 10, Steps: 3 | Train Loss: 1.195 Vali Loss: 1.254 Vali Acc: 0.550 Test Loss: 1.254 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.451141357421875
Epoch: 11, Steps: 3 | Train Loss: 1.160 Vali Loss: 1.235 Vali Acc: 0.550 Test Loss: 1.235 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.5965433120727539
Epoch: 12, Steps: 3 | Train Loss: 1.131 Vali Loss: 1.216 Vali Acc: 0.600 Test Loss: 1.216 Test Acc: 0.600
Validation loss decreased (-0.574987 --> -0.599988).  Saving model ...
Epoch: 13 cost time: 0.47772836685180664
Epoch: 13, Steps: 3 | Train Loss: 1.064 Vali Loss: 1.196 Vali Acc: 0.600 Test Loss: 1.196 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 14 cost time: 0.5789744853973389
Epoch: 14, Steps: 3 | Train Loss: 1.038 Vali Loss: 1.176 Vali Acc: 0.600 Test Loss: 1.176 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 15 cost time: 0.6263604164123535
Epoch: 15, Steps: 3 | Train Loss: 0.973 Vali Loss: 1.156 Vali Acc: 0.600 Test Loss: 1.156 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 16 cost time: 0.47595763206481934
Epoch: 16, Steps: 3 | Train Loss: 0.992 Vali Loss: 1.136 Vali Acc: 0.625 Test Loss: 1.136 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624989).  Saving model ...
Epoch: 17 cost time: 0.47355008125305176
Epoch: 17, Steps: 3 | Train Loss: 0.912 Vali Loss: 1.114 Vali Acc: 0.625 Test Loss: 1.114 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 18 cost time: 0.4237406253814697
Epoch: 18, Steps: 3 | Train Loss: 0.884 Vali Loss: 1.092 Vali Acc: 0.625 Test Loss: 1.092 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 19 cost time: 0.5764431953430176
Epoch: 19, Steps: 3 | Train Loss: 0.869 Vali Loss: 1.069 Vali Acc: 0.650 Test Loss: 1.069 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 20 cost time: 0.5462169647216797
Epoch: 20, Steps: 3 | Train Loss: 0.819 Vali Loss: 1.046 Vali Acc: 0.675 Test Loss: 1.046 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674990).  Saving model ...
Epoch: 21 cost time: 0.6232249736785889
Epoch: 21, Steps: 3 | Train Loss: 0.755 Vali Loss: 1.021 Vali Acc: 0.675 Test Loss: 1.021 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 22 cost time: 0.3606724739074707
Epoch: 22, Steps: 3 | Train Loss: 0.742 Vali Loss: 0.996 Vali Acc: 0.700 Test Loss: 0.996 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 23 cost time: 0.5657334327697754
Epoch: 23, Steps: 3 | Train Loss: 0.724 Vali Loss: 0.971 Vali Acc: 0.725 Test Loss: 0.971 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724990).  Saving model ...
Epoch: 24 cost time: 0.4643411636352539
Epoch: 24, Steps: 3 | Train Loss: 0.663 Vali Loss: 0.945 Vali Acc: 0.775 Test Loss: 0.945 Test Acc: 0.775
Validation loss decreased (-0.724990 --> -0.774991).  Saving model ...
Epoch: 25 cost time: 0.48851442337036133
Epoch: 25, Steps: 3 | Train Loss: 0.659 Vali Loss: 0.920 Vali Acc: 0.775 Test Loss: 0.920 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 26 cost time: 0.46835851669311523
Epoch: 26, Steps: 3 | Train Loss: 0.598 Vali Loss: 0.899 Vali Acc: 0.775 Test Loss: 0.899 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 27 cost time: 0.47301530838012695
Epoch: 27, Steps: 3 | Train Loss: 0.578 Vali Loss: 0.878 Vali Acc: 0.775 Test Loss: 0.878 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 28 cost time: 0.5542271137237549
Epoch: 28, Steps: 3 | Train Loss: 0.519 Vali Loss: 0.859 Vali Acc: 0.775 Test Loss: 0.859 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 29 cost time: 0.5482096672058105
Epoch: 29, Steps: 3 | Train Loss: 0.497 Vali Loss: 0.837 Vali Acc: 0.775 Test Loss: 0.837 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774992).  Saving model ...
Epoch: 30 cost time: 0.4952504634857178
Epoch: 30, Steps: 3 | Train Loss: 0.465 Vali Loss: 0.812 Vali Acc: 0.775 Test Loss: 0.812 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 31 cost time: 0.4857778549194336
Epoch: 31, Steps: 3 | Train Loss: 0.409 Vali Loss: 0.782 Vali Acc: 0.775 Test Loss: 0.782 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 32 cost time: 0.540257453918457
Epoch: 32, Steps: 3 | Train Loss: 0.418 Vali Loss: 0.750 Vali Acc: 0.800 Test Loss: 0.750 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799992).  Saving model ...
Epoch: 33 cost time: 0.4505653381347656
Epoch: 33, Steps: 3 | Train Loss: 0.356 Vali Loss: 0.720 Vali Acc: 0.850 Test Loss: 0.720 Test Acc: 0.850
Validation loss decreased (-0.799992 --> -0.849993).  Saving model ...
Epoch: 34 cost time: 0.5789072513580322
Epoch: 34, Steps: 3 | Train Loss: 0.342 Vali Loss: 0.691 Vali Acc: 0.850 Test Loss: 0.691 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 35 cost time: 0.4795103073120117
Epoch: 35, Steps: 3 | Train Loss: 0.322 Vali Loss: 0.664 Vali Acc: 0.875 Test Loss: 0.664 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874993).  Saving model ...
Epoch: 36 cost time: 0.47687721252441406
Epoch: 36, Steps: 3 | Train Loss: 0.279 Vali Loss: 0.638 Vali Acc: 0.850 Test Loss: 0.638 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.45256686210632324
Epoch: 37, Steps: 3 | Train Loss: 0.290 Vali Loss: 0.616 Vali Acc: 0.850 Test Loss: 0.616 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.4745457172393799
Epoch: 38, Steps: 3 | Train Loss: 0.236 Vali Loss: 0.590 Vali Acc: 0.850 Test Loss: 0.590 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.4627525806427002
Epoch: 39, Steps: 3 | Train Loss: 0.232 Vali Loss: 0.562 Vali Acc: 0.850 Test Loss: 0.562 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.49828028678894043
Epoch: 40, Steps: 3 | Train Loss: 0.236 Vali Loss: 0.533 Vali Acc: 0.875 Test Loss: 0.533 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874995).  Saving model ...
Epoch: 41 cost time: 0.4506034851074219
Epoch: 41, Steps: 3 | Train Loss: 0.212 Vali Loss: 0.495 Vali Acc: 0.900 Test Loss: 0.495 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899995).  Saving model ...
Epoch: 42 cost time: 0.6114552021026611
Epoch: 42, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.458 Vali Acc: 0.900 Test Loss: 0.458 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 43 cost time: 0.46604323387145996
Epoch: 43, Steps: 3 | Train Loss: 0.178 Vali Loss: 0.427 Vali Acc: 0.875 Test Loss: 0.427 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.451521635055542
Epoch: 44, Steps: 3 | Train Loss: 0.139 Vali Loss: 0.410 Vali Acc: 0.875 Test Loss: 0.410 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.35001134872436523
Epoch: 45, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.396 Vali Acc: 0.875 Test Loss: 0.396 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.5181629657745361
Epoch: 46, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.382 Vali Acc: 0.875 Test Loss: 0.382 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.47319746017456055
Epoch: 47, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.355 Vali Acc: 0.875 Test Loss: 0.355 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.456798791885376
Epoch: 48, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.330 Vali Acc: 0.875 Test Loss: 0.330 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.42447757720947266
Epoch: 49, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.312 Vali Acc: 0.875 Test Loss: 0.312 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.5276472568511963
Epoch: 50, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.290 Vali Acc: 0.875 Test Loss: 0.290 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 0.5536370277404785
Epoch: 51, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.276 Vali Acc: 0.875 Test Loss: 0.276 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 0.48018813133239746
Epoch: 52, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.264 Vali Acc: 0.925 Test Loss: 0.264 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924997).  Saving model ...
Epoch: 53 cost time: 0.44489598274230957
Epoch: 53, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.252 Vali Acc: 0.925 Test Loss: 0.252 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 54 cost time: 0.5018494129180908
Epoch: 54, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.247 Vali Acc: 0.925 Test Loss: 0.247 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924998).  Saving model ...
Epoch: 55 cost time: 0.502483606338501
Epoch: 55, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.239 Vali Acc: 0.925 Test Loss: 0.239 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 56 cost time: 0.4445478916168213
Epoch: 56, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.237 Vali Acc: 0.925 Test Loss: 0.237 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 57 cost time: 0.5270469188690186
Epoch: 57, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.238 Vali Acc: 0.925 Test Loss: 0.238 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.5185961723327637
Epoch: 58, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.240 Vali Acc: 0.925 Test Loss: 0.240 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.4534637928009033
Epoch: 59, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.244 Vali Acc: 0.925 Test Loss: 0.244 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.5106105804443359
Epoch: 60, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.249 Vali Acc: 0.925 Test Loss: 0.249 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 0.49803829193115234
Epoch: 61, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.252 Vali Acc: 0.925 Test Loss: 0.252 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 0.6076643466949463
Epoch: 62, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.253 Vali Acc: 0.925 Test Loss: 0.253 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 0.5788509845733643
Epoch: 63, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.253 Vali Acc: 0.925 Test Loss: 0.253 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 0.43322300910949707
Epoch: 64, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.252 Vali Acc: 0.925 Test Loss: 0.252 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 0.4674503803253174
Epoch: 65, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.250 Vali Acc: 0.925 Test Loss: 0.250 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 0.49151039123535156
Epoch: 66, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.249 Vali Acc: 0.925 Test Loss: 0.249 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm512_cs13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 122136
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm512_cs12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7472827434539795
Epoch: 1, Steps: 3 | Train Loss: 1.450 Vali Loss: 1.324 Vali Acc: 0.225 Test Loss: 1.324 Test Acc: 0.225
Validation loss decreased (inf --> -0.224987).  Saving model ...
Epoch: 2 cost time: 0.6311554908752441
Epoch: 2, Steps: 3 | Train Loss: 1.368 Vali Loss: 1.318 Vali Acc: 0.225 Test Loss: 1.318 Test Acc: 0.225
Validation loss decreased (-0.224987 --> -0.224987).  Saving model ...
Epoch: 3 cost time: 0.5181686878204346
Epoch: 3, Steps: 3 | Train Loss: 1.346 Vali Loss: 1.311 Vali Acc: 0.250 Test Loss: 1.311 Test Acc: 0.250
Validation loss decreased (-0.224987 --> -0.249987).  Saving model ...
Epoch: 4 cost time: 0.4722883701324463
Epoch: 4, Steps: 3 | Train Loss: 1.366 Vali Loss: 1.302 Vali Acc: 0.325 Test Loss: 1.302 Test Acc: 0.325
Validation loss decreased (-0.249987 --> -0.324987).  Saving model ...
Epoch: 5 cost time: 0.5347039699554443
Epoch: 5, Steps: 3 | Train Loss: 1.311 Vali Loss: 1.292 Vali Acc: 0.425 Test Loss: 1.292 Test Acc: 0.425
Validation loss decreased (-0.324987 --> -0.424987).  Saving model ...
Epoch: 6 cost time: 0.44516849517822266
Epoch: 6, Steps: 3 | Train Loss: 1.308 Vali Loss: 1.280 Vali Acc: 0.500 Test Loss: 1.280 Test Acc: 0.500
Validation loss decreased (-0.424987 --> -0.499987).  Saving model ...
Epoch: 7 cost time: 0.42669057846069336
Epoch: 7, Steps: 3 | Train Loss: 1.270 Vali Loss: 1.266 Vali Acc: 0.475 Test Loss: 1.266 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5554490089416504
Epoch: 8, Steps: 3 | Train Loss: 1.226 Vali Loss: 1.251 Vali Acc: 0.475 Test Loss: 1.251 Test Acc: 0.475
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5157911777496338
Epoch: 9, Steps: 3 | Train Loss: 1.205 Vali Loss: 1.236 Vali Acc: 0.525 Test Loss: 1.236 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524988).  Saving model ...
Epoch: 10 cost time: 0.45572376251220703
Epoch: 10, Steps: 3 | Train Loss: 1.159 Vali Loss: 1.221 Vali Acc: 0.550 Test Loss: 1.221 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 11 cost time: 0.5083777904510498
Epoch: 11, Steps: 3 | Train Loss: 1.120 Vali Loss: 1.206 Vali Acc: 0.575 Test Loss: 1.206 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 12 cost time: 0.573779821395874
Epoch: 12, Steps: 3 | Train Loss: 1.094 Vali Loss: 1.187 Vali Acc: 0.600 Test Loss: 1.187 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599988).  Saving model ...
Epoch: 13 cost time: 0.4580063819885254
Epoch: 13, Steps: 3 | Train Loss: 1.063 Vali Loss: 1.169 Vali Acc: 0.650 Test Loss: 1.169 Test Acc: 0.650
Validation loss decreased (-0.599988 --> -0.649988).  Saving model ...
Epoch: 14 cost time: 0.5144021511077881
Epoch: 14, Steps: 3 | Train Loss: 0.983 Vali Loss: 1.149 Vali Acc: 0.675 Test Loss: 1.149 Test Acc: 0.675
Validation loss decreased (-0.649988 --> -0.674989).  Saving model ...
Epoch: 15 cost time: 0.4503190517425537
Epoch: 15, Steps: 3 | Train Loss: 0.962 Vali Loss: 1.126 Vali Acc: 0.675 Test Loss: 1.126 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 16 cost time: 0.4359724521636963
Epoch: 16, Steps: 3 | Train Loss: 0.921 Vali Loss: 1.101 Vali Acc: 0.700 Test Loss: 1.101 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699989).  Saving model ...
Epoch: 17 cost time: 0.5318355560302734
Epoch: 17, Steps: 3 | Train Loss: 0.884 Vali Loss: 1.072 Vali Acc: 0.725 Test Loss: 1.072 Test Acc: 0.725
Validation loss decreased (-0.699989 --> -0.724989).  Saving model ...
Epoch: 18 cost time: 0.4691801071166992
Epoch: 18, Steps: 3 | Train Loss: 0.820 Vali Loss: 1.039 Vali Acc: 0.725 Test Loss: 1.039 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724990).  Saving model ...
Epoch: 19 cost time: 0.5795385837554932
Epoch: 19, Steps: 3 | Train Loss: 0.787 Vali Loss: 1.002 Vali Acc: 0.825 Test Loss: 1.002 Test Acc: 0.825
Validation loss decreased (-0.724990 --> -0.824990).  Saving model ...
Epoch: 20 cost time: 0.5570106506347656
Epoch: 20, Steps: 3 | Train Loss: 0.736 Vali Loss: 0.964 Vali Acc: 0.825 Test Loss: 0.964 Test Acc: 0.825
Validation loss decreased (-0.824990 --> -0.824990).  Saving model ...
Epoch: 21 cost time: 0.5240187644958496
Epoch: 21, Steps: 3 | Train Loss: 0.686 Vali Loss: 0.923 Vali Acc: 0.800 Test Loss: 0.923 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5838181972503662
Epoch: 22, Steps: 3 | Train Loss: 0.641 Vali Loss: 0.878 Vali Acc: 0.800 Test Loss: 0.878 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5214986801147461
Epoch: 23, Steps: 3 | Train Loss: 0.600 Vali Loss: 0.826 Vali Acc: 0.825 Test Loss: 0.826 Test Acc: 0.825
Validation loss decreased (-0.824990 --> -0.824992).  Saving model ...
Epoch: 24 cost time: 0.5214409828186035
Epoch: 24, Steps: 3 | Train Loss: 0.576 Vali Loss: 0.775 Vali Acc: 0.850 Test Loss: 0.775 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849992).  Saving model ...
Epoch: 25 cost time: 0.5268020629882812
Epoch: 25, Steps: 3 | Train Loss: 0.516 Vali Loss: 0.721 Vali Acc: 0.825 Test Loss: 0.721 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.43157434463500977
Epoch: 26, Steps: 3 | Train Loss: 0.475 Vali Loss: 0.664 Vali Acc: 0.850 Test Loss: 0.664 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849993).  Saving model ...
Epoch: 27 cost time: 0.5324954986572266
Epoch: 27, Steps: 3 | Train Loss: 0.408 Vali Loss: 0.613 Vali Acc: 0.825 Test Loss: 0.613 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.416400671005249
Epoch: 28, Steps: 3 | Train Loss: 0.370 Vali Loss: 0.563 Vali Acc: 0.800 Test Loss: 0.563 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.46026134490966797
Epoch: 29, Steps: 3 | Train Loss: 0.335 Vali Loss: 0.516 Vali Acc: 0.800 Test Loss: 0.516 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.4948618412017822
Epoch: 30, Steps: 3 | Train Loss: 0.342 Vali Loss: 0.469 Vali Acc: 0.800 Test Loss: 0.469 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.44420862197875977
Epoch: 31, Steps: 3 | Train Loss: 0.267 Vali Loss: 0.428 Vali Acc: 0.850 Test Loss: 0.428 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849996).  Saving model ...
Epoch: 32 cost time: 0.4076375961303711
Epoch: 32, Steps: 3 | Train Loss: 0.229 Vali Loss: 0.392 Vali Acc: 0.850 Test Loss: 0.392 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 33 cost time: 0.44069504737854004
Epoch: 33, Steps: 3 | Train Loss: 0.216 Vali Loss: 0.359 Vali Acc: 0.900 Test Loss: 0.359 Test Acc: 0.900
Validation loss decreased (-0.849996 --> -0.899996).  Saving model ...
Epoch: 34 cost time: 0.5166077613830566
Epoch: 34, Steps: 3 | Train Loss: 0.198 Vali Loss: 0.331 Vali Acc: 0.925 Test Loss: 0.331 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924997).  Saving model ...
Epoch: 35 cost time: 0.47959351539611816
Epoch: 35, Steps: 3 | Train Loss: 0.162 Vali Loss: 0.306 Vali Acc: 0.925 Test Loss: 0.306 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 36 cost time: 0.48421573638916016
Epoch: 36, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.285 Vali Acc: 0.925 Test Loss: 0.285 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 37 cost time: 0.49118542671203613
Epoch: 37, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.266 Vali Acc: 0.925 Test Loss: 0.266 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 38 cost time: 0.5075967311859131
Epoch: 38, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.252 Vali Acc: 0.925 Test Loss: 0.252 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 39 cost time: 0.5046637058258057
Epoch: 39, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.241 Vali Acc: 0.900 Test Loss: 0.241 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.4854135513305664
Epoch: 40, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.232 Vali Acc: 0.875 Test Loss: 0.232 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.4520440101623535
Epoch: 41, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.222 Vali Acc: 0.875 Test Loss: 0.222 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.42565155029296875
Epoch: 42, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.211 Vali Acc: 0.875 Test Loss: 0.211 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.5292277336120605
Epoch: 43, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.199 Vali Acc: 0.875 Test Loss: 0.199 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.5165627002716064
Epoch: 44, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.189 Vali Acc: 0.875 Test Loss: 0.189 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.48193931579589844
Epoch: 45, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.179 Vali Acc: 0.875 Test Loss: 0.179 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.46262645721435547
Epoch: 46, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.170 Vali Acc: 0.875 Test Loss: 0.170 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.3689301013946533
Epoch: 47, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.161 Vali Acc: 0.875 Test Loss: 0.161 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.4780232906341553
Epoch: 48, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.154 Vali Acc: 0.875 Test Loss: 0.154 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm512_cs12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 122318
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm512_cs10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6384663581848145
Epoch: 1, Steps: 3 | Train Loss: 1.521 Vali Loss: 1.396 Vali Acc: 0.200 Test Loss: 1.396 Test Acc: 0.200
Validation loss decreased (inf --> -0.199986).  Saving model ...
Epoch: 2 cost time: 0.465313196182251
Epoch: 2, Steps: 3 | Train Loss: 1.486 Vali Loss: 1.388 Vali Acc: 0.200 Test Loss: 1.388 Test Acc: 0.200
Validation loss decreased (-0.199986 --> -0.199986).  Saving model ...
Epoch: 3 cost time: 0.5032479763031006
Epoch: 3, Steps: 3 | Train Loss: 1.507 Vali Loss: 1.380 Vali Acc: 0.225 Test Loss: 1.380 Test Acc: 0.225
Validation loss decreased (-0.199986 --> -0.224986).  Saving model ...
Epoch: 4 cost time: 0.4629216194152832
Epoch: 4, Steps: 3 | Train Loss: 1.455 Vali Loss: 1.369 Vali Acc: 0.225 Test Loss: 1.369 Test Acc: 0.225
Validation loss decreased (-0.224986 --> -0.224986).  Saving model ...
Epoch: 5 cost time: 0.42717695236206055
Epoch: 5, Steps: 3 | Train Loss: 1.449 Vali Loss: 1.355 Vali Acc: 0.250 Test Loss: 1.355 Test Acc: 0.250
Validation loss decreased (-0.224986 --> -0.249986).  Saving model ...
Epoch: 6 cost time: 0.5371212959289551
Epoch: 6, Steps: 3 | Train Loss: 1.409 Vali Loss: 1.341 Vali Acc: 0.325 Test Loss: 1.341 Test Acc: 0.325
Validation loss decreased (-0.249986 --> -0.324987).  Saving model ...
Epoch: 7 cost time: 0.5246069431304932
Epoch: 7, Steps: 3 | Train Loss: 1.370 Vali Loss: 1.324 Vali Acc: 0.375 Test Loss: 1.324 Test Acc: 0.375
Validation loss decreased (-0.324987 --> -0.374987).  Saving model ...
Epoch: 8 cost time: 0.4851663112640381
Epoch: 8, Steps: 3 | Train Loss: 1.336 Vali Loss: 1.306 Vali Acc: 0.400 Test Loss: 1.306 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399987).  Saving model ...
Epoch: 9 cost time: 0.5505354404449463
Epoch: 9, Steps: 3 | Train Loss: 1.312 Vali Loss: 1.287 Vali Acc: 0.450 Test Loss: 1.287 Test Acc: 0.450
Validation loss decreased (-0.399987 --> -0.449987).  Saving model ...
Epoch: 10 cost time: 0.6011233329772949
Epoch: 10, Steps: 3 | Train Loss: 1.281 Vali Loss: 1.267 Vali Acc: 0.550 Test Loss: 1.267 Test Acc: 0.550
Validation loss decreased (-0.449987 --> -0.549987).  Saving model ...
Epoch: 11 cost time: 0.44263482093811035
Epoch: 11, Steps: 3 | Train Loss: 1.209 Vali Loss: 1.245 Vali Acc: 0.625 Test Loss: 1.245 Test Acc: 0.625
Validation loss decreased (-0.549987 --> -0.624988).  Saving model ...
Epoch: 12 cost time: 0.558753490447998
Epoch: 12, Steps: 3 | Train Loss: 1.197 Vali Loss: 1.221 Vali Acc: 0.675 Test Loss: 1.221 Test Acc: 0.675
Validation loss decreased (-0.624988 --> -0.674988).  Saving model ...
Epoch: 13 cost time: 0.5049002170562744
Epoch: 13, Steps: 3 | Train Loss: 1.150 Vali Loss: 1.196 Vali Acc: 0.725 Test Loss: 1.196 Test Acc: 0.725
Validation loss decreased (-0.674988 --> -0.724988).  Saving model ...
Epoch: 14 cost time: 0.607872724533081
Epoch: 14, Steps: 3 | Train Loss: 1.094 Vali Loss: 1.171 Vali Acc: 0.700 Test Loss: 1.171 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5229570865631104
Epoch: 15, Steps: 3 | Train Loss: 1.037 Vali Loss: 1.144 Vali Acc: 0.700 Test Loss: 1.144 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.5054175853729248
Epoch: 16, Steps: 3 | Train Loss: 1.010 Vali Loss: 1.116 Vali Acc: 0.750 Test Loss: 1.116 Test Acc: 0.750
Validation loss decreased (-0.724988 --> -0.749989).  Saving model ...
Epoch: 17 cost time: 0.594874382019043
Epoch: 17, Steps: 3 | Train Loss: 0.938 Vali Loss: 1.085 Vali Acc: 0.775 Test Loss: 1.085 Test Acc: 0.775
Validation loss decreased (-0.749989 --> -0.774989).  Saving model ...
Epoch: 18 cost time: 0.43344593048095703
Epoch: 18, Steps: 3 | Train Loss: 0.901 Vali Loss: 1.050 Vali Acc: 0.775 Test Loss: 1.050 Test Acc: 0.775
Validation loss decreased (-0.774989 --> -0.774990).  Saving model ...
Epoch: 19 cost time: 0.5102875232696533
Epoch: 19, Steps: 3 | Train Loss: 0.900 Vali Loss: 1.012 Vali Acc: 0.775 Test Loss: 1.012 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774990).  Saving model ...
Epoch: 20 cost time: 0.5767531394958496
Epoch: 20, Steps: 3 | Train Loss: 0.840 Vali Loss: 0.970 Vali Acc: 0.800 Test Loss: 0.970 Test Acc: 0.800
Validation loss decreased (-0.774990 --> -0.799990).  Saving model ...
Epoch: 21 cost time: 0.5435824394226074
Epoch: 21, Steps: 3 | Train Loss: 0.795 Vali Loss: 0.928 Vali Acc: 0.825 Test Loss: 0.928 Test Acc: 0.825
Validation loss decreased (-0.799990 --> -0.824991).  Saving model ...
Epoch: 22 cost time: 0.5674171447753906
Epoch: 22, Steps: 3 | Train Loss: 0.736 Vali Loss: 0.879 Vali Acc: 0.850 Test Loss: 0.879 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849991).  Saving model ...
Epoch: 23 cost time: 0.5215268135070801
Epoch: 23, Steps: 3 | Train Loss: 0.677 Vali Loss: 0.828 Vali Acc: 0.850 Test Loss: 0.828 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849992).  Saving model ...
Epoch: 24 cost time: 0.46907711029052734
Epoch: 24, Steps: 3 | Train Loss: 0.667 Vali Loss: 0.775 Vali Acc: 0.850 Test Loss: 0.775 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 25 cost time: 0.46526646614074707
Epoch: 25, Steps: 3 | Train Loss: 0.626 Vali Loss: 0.720 Vali Acc: 0.875 Test Loss: 0.720 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874993).  Saving model ...
Epoch: 26 cost time: 0.5328514575958252
Epoch: 26, Steps: 3 | Train Loss: 0.530 Vali Loss: 0.661 Vali Acc: 0.875 Test Loss: 0.661 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 27 cost time: 0.43328428268432617
Epoch: 27, Steps: 3 | Train Loss: 0.496 Vali Loss: 0.595 Vali Acc: 0.875 Test Loss: 0.595 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 28 cost time: 0.42954373359680176
Epoch: 28, Steps: 3 | Train Loss: 0.445 Vali Loss: 0.530 Vali Acc: 0.875 Test Loss: 0.530 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 29 cost time: 0.5059103965759277
Epoch: 29, Steps: 3 | Train Loss: 0.436 Vali Loss: 0.474 Vali Acc: 0.900 Test Loss: 0.474 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899995).  Saving model ...
Epoch: 30 cost time: 0.4907212257385254
Epoch: 30, Steps: 3 | Train Loss: 0.358 Vali Loss: 0.425 Vali Acc: 0.925 Test Loss: 0.425 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924996).  Saving model ...
Epoch: 31 cost time: 0.43184995651245117
Epoch: 31, Steps: 3 | Train Loss: 0.306 Vali Loss: 0.377 Vali Acc: 0.950 Test Loss: 0.377 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 32 cost time: 0.48438334465026855
Epoch: 32, Steps: 3 | Train Loss: 0.305 Vali Loss: 0.333 Vali Acc: 0.925 Test Loss: 0.333 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.544994592666626
Epoch: 33, Steps: 3 | Train Loss: 0.262 Vali Loss: 0.292 Vali Acc: 0.925 Test Loss: 0.292 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.4848339557647705
Epoch: 34, Steps: 3 | Train Loss: 0.236 Vali Loss: 0.254 Vali Acc: 0.950 Test Loss: 0.254 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 35 cost time: 0.44988512992858887
Epoch: 35, Steps: 3 | Train Loss: 0.205 Vali Loss: 0.220 Vali Acc: 0.950 Test Loss: 0.220 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 36 cost time: 0.4630889892578125
Epoch: 36, Steps: 3 | Train Loss: 0.170 Vali Loss: 0.188 Vali Acc: 0.950 Test Loss: 0.188 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 37 cost time: 0.41280603408813477
Epoch: 37, Steps: 3 | Train Loss: 0.153 Vali Loss: 0.159 Vali Acc: 0.950 Test Loss: 0.159 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 38 cost time: 0.5071561336517334
Epoch: 38, Steps: 3 | Train Loss: 0.119 Vali Loss: 0.132 Vali Acc: 0.950 Test Loss: 0.132 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949999).  Saving model ...
Epoch: 39 cost time: 0.5403647422790527
Epoch: 39, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.108 Vali Acc: 0.950 Test Loss: 0.108 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 40 cost time: 0.5768642425537109
Epoch: 40, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.087 Vali Acc: 0.975 Test Loss: 0.087 Test Acc: 0.975
Validation loss decreased (-0.949999 --> -0.974999).  Saving model ...
Epoch: 41 cost time: 0.532651424407959
Epoch: 41, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.070 Vali Acc: 0.975 Test Loss: 0.070 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 42 cost time: 0.5397589206695557
Epoch: 42, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.057 Vali Acc: 1.000 Test Loss: 0.057 Test Acc: 1.000
Validation loss decreased (-0.974999 --> -0.999999).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm512_cs10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 121048
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm512_cs9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.904125690460205
Epoch: 1, Steps: 3 | Train Loss: 1.417 Vali Loss: 1.403 Vali Acc: 0.325 Test Loss: 1.403 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 0.5043735504150391
Epoch: 2, Steps: 3 | Train Loss: 1.406 Vali Loss: 1.396 Vali Acc: 0.400 Test Loss: 1.396 Test Acc: 0.400
Validation loss decreased (-0.324986 --> -0.399986).  Saving model ...
Epoch: 3 cost time: 0.5260574817657471
Epoch: 3, Steps: 3 | Train Loss: 1.390 Vali Loss: 1.389 Vali Acc: 0.400 Test Loss: 1.389 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399986).  Saving model ...
Epoch: 4 cost time: 0.5166568756103516
Epoch: 4, Steps: 3 | Train Loss: 1.382 Vali Loss: 1.378 Vali Acc: 0.400 Test Loss: 1.378 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399986).  Saving model ...
Epoch: 5 cost time: 0.4901132583618164
Epoch: 5, Steps: 3 | Train Loss: 1.356 Vali Loss: 1.366 Vali Acc: 0.425 Test Loss: 1.366 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424986).  Saving model ...
Epoch: 6 cost time: 0.46035218238830566
Epoch: 6, Steps: 3 | Train Loss: 1.309 Vali Loss: 1.351 Vali Acc: 0.450 Test Loss: 1.351 Test Acc: 0.450
Validation loss decreased (-0.424986 --> -0.449986).  Saving model ...
Epoch: 7 cost time: 0.4674265384674072
Epoch: 7, Steps: 3 | Train Loss: 1.299 Vali Loss: 1.336 Vali Acc: 0.475 Test Loss: 1.336 Test Acc: 0.475
Validation loss decreased (-0.449986 --> -0.474987).  Saving model ...
Epoch: 8 cost time: 0.5015676021575928
Epoch: 8, Steps: 3 | Train Loss: 1.253 Vali Loss: 1.318 Vali Acc: 0.475 Test Loss: 1.318 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 9 cost time: 0.47339868545532227
Epoch: 9, Steps: 3 | Train Loss: 1.230 Vali Loss: 1.299 Vali Acc: 0.475 Test Loss: 1.299 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 10 cost time: 0.5176193714141846
Epoch: 10, Steps: 3 | Train Loss: 1.215 Vali Loss: 1.279 Vali Acc: 0.475 Test Loss: 1.279 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 11 cost time: 0.523385763168335
Epoch: 11, Steps: 3 | Train Loss: 1.152 Vali Loss: 1.257 Vali Acc: 0.475 Test Loss: 1.257 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 12 cost time: 0.44594860076904297
Epoch: 12, Steps: 3 | Train Loss: 1.151 Vali Loss: 1.235 Vali Acc: 0.475 Test Loss: 1.235 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474988).  Saving model ...
Epoch: 13 cost time: 0.5431129932403564
Epoch: 13, Steps: 3 | Train Loss: 1.061 Vali Loss: 1.211 Vali Acc: 0.525 Test Loss: 1.211 Test Acc: 0.525
Validation loss decreased (-0.474988 --> -0.524988).  Saving model ...
Epoch: 14 cost time: 0.5273833274841309
Epoch: 14, Steps: 3 | Train Loss: 1.067 Vali Loss: 1.186 Vali Acc: 0.525 Test Loss: 1.186 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 15 cost time: 0.5810763835906982
Epoch: 15, Steps: 3 | Train Loss: 1.007 Vali Loss: 1.161 Vali Acc: 0.550 Test Loss: 1.161 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 16 cost time: 0.46175503730773926
Epoch: 16, Steps: 3 | Train Loss: 0.937 Vali Loss: 1.134 Vali Acc: 0.550 Test Loss: 1.134 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549989).  Saving model ...
Epoch: 17 cost time: 0.48139047622680664
Epoch: 17, Steps: 3 | Train Loss: 0.963 Vali Loss: 1.103 Vali Acc: 0.625 Test Loss: 1.103 Test Acc: 0.625
Validation loss decreased (-0.549989 --> -0.624989).  Saving model ...
Epoch: 18 cost time: 0.6034989356994629
Epoch: 18, Steps: 3 | Train Loss: 0.916 Vali Loss: 1.067 Vali Acc: 0.625 Test Loss: 1.067 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 19 cost time: 0.42290163040161133
Epoch: 19, Steps: 3 | Train Loss: 0.815 Vali Loss: 1.028 Vali Acc: 0.650 Test Loss: 1.028 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649990).  Saving model ...
Epoch: 20 cost time: 0.4914126396179199
Epoch: 20, Steps: 3 | Train Loss: 0.796 Vali Loss: 0.986 Vali Acc: 0.675 Test Loss: 0.986 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674990).  Saving model ...
Epoch: 21 cost time: 0.6005637645721436
Epoch: 21, Steps: 3 | Train Loss: 0.732 Vali Loss: 0.938 Vali Acc: 0.725 Test Loss: 0.938 Test Acc: 0.725
Validation loss decreased (-0.674990 --> -0.724991).  Saving model ...
Epoch: 22 cost time: 0.5335512161254883
Epoch: 22, Steps: 3 | Train Loss: 0.718 Vali Loss: 0.883 Vali Acc: 0.750 Test Loss: 0.883 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749991).  Saving model ...
Epoch: 23 cost time: 0.53900146484375
Epoch: 23, Steps: 3 | Train Loss: 0.665 Vali Loss: 0.826 Vali Acc: 0.825 Test Loss: 0.826 Test Acc: 0.825
Validation loss decreased (-0.749991 --> -0.824992).  Saving model ...
Epoch: 24 cost time: 0.5339303016662598
Epoch: 24, Steps: 3 | Train Loss: 0.628 Vali Loss: 0.766 Vali Acc: 0.875 Test Loss: 0.766 Test Acc: 0.875
Validation loss decreased (-0.824992 --> -0.874992).  Saving model ...
Epoch: 25 cost time: 0.5110716819763184
Epoch: 25, Steps: 3 | Train Loss: 0.608 Vali Loss: 0.697 Vali Acc: 0.875 Test Loss: 0.697 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874993).  Saving model ...
Epoch: 26 cost time: 0.555694580078125
Epoch: 26, Steps: 3 | Train Loss: 0.527 Vali Loss: 0.629 Vali Acc: 0.875 Test Loss: 0.629 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 27 cost time: 0.5020771026611328
Epoch: 27, Steps: 3 | Train Loss: 0.449 Vali Loss: 0.563 Vali Acc: 0.900 Test Loss: 0.563 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899994).  Saving model ...
Epoch: 28 cost time: 0.484271764755249
Epoch: 28, Steps: 3 | Train Loss: 0.432 Vali Loss: 0.499 Vali Acc: 0.900 Test Loss: 0.499 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 29 cost time: 0.5105938911437988
Epoch: 29, Steps: 3 | Train Loss: 0.386 Vali Loss: 0.439 Vali Acc: 0.900 Test Loss: 0.439 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 30 cost time: 0.5453481674194336
Epoch: 30, Steps: 3 | Train Loss: 0.334 Vali Loss: 0.383 Vali Acc: 0.900 Test Loss: 0.383 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 31 cost time: 0.5469458103179932
Epoch: 31, Steps: 3 | Train Loss: 0.323 Vali Loss: 0.333 Vali Acc: 0.900 Test Loss: 0.333 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 32 cost time: 0.5440254211425781
Epoch: 32, Steps: 3 | Train Loss: 0.292 Vali Loss: 0.287 Vali Acc: 0.950 Test Loss: 0.287 Test Acc: 0.950
Validation loss decreased (-0.899997 --> -0.949997).  Saving model ...
Epoch: 33 cost time: 0.5048048496246338
Epoch: 33, Steps: 3 | Train Loss: 0.240 Vali Loss: 0.247 Vali Acc: 0.950 Test Loss: 0.247 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 34 cost time: 0.5043768882751465
Epoch: 34, Steps: 3 | Train Loss: 0.210 Vali Loss: 0.211 Vali Acc: 0.975 Test Loss: 0.211 Test Acc: 0.975
Validation loss decreased (-0.949998 --> -0.974998).  Saving model ...
Epoch: 35 cost time: 0.5033316612243652
Epoch: 35, Steps: 3 | Train Loss: 0.176 Vali Loss: 0.178 Vali Acc: 0.975 Test Loss: 0.178 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 36 cost time: 0.5082001686096191
Epoch: 36, Steps: 3 | Train Loss: 0.142 Vali Loss: 0.150 Vali Acc: 0.975 Test Loss: 0.150 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 37 cost time: 0.5935952663421631
Epoch: 37, Steps: 3 | Train Loss: 0.106 Vali Loss: 0.125 Vali Acc: 0.975 Test Loss: 0.125 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 38 cost time: 0.5660614967346191
Epoch: 38, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.104 Vali Acc: 0.975 Test Loss: 0.104 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 39 cost time: 0.6363346576690674
Epoch: 39, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.087 Vali Acc: 0.975 Test Loss: 0.087 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 40 cost time: 0.5942788124084473
Epoch: 40, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.073 Vali Acc: 0.975 Test Loss: 0.073 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 41 cost time: 0.5275506973266602
Epoch: 41, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.060 Vali Acc: 0.975 Test Loss: 0.060 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 42 cost time: 0.5168068408966064
Epoch: 42, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.053 Vali Acc: 0.975 Test Loss: 0.053 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 43 cost time: 0.540534496307373
Epoch: 43, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.043 Vali Acc: 1.000 Test Loss: 0.043 Test Acc: 1.000
Validation loss decreased (-0.974999 --> -1.000000).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm512_cs9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 121688
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm512_cs8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.5506112575531006
Epoch: 1, Steps: 3 | Train Loss: 1.536 Vali Loss: 1.456 Vali Acc: 0.150 Test Loss: 1.456 Test Acc: 0.150
Validation loss decreased (inf --> -0.149985).  Saving model ...
Epoch: 2 cost time: 0.5559787750244141
Epoch: 2, Steps: 3 | Train Loss: 1.469 Vali Loss: 1.447 Vali Acc: 0.150 Test Loss: 1.447 Test Acc: 0.150
Validation loss decreased (-0.149985 --> -0.149986).  Saving model ...
Epoch: 3 cost time: 0.5299088954925537
Epoch: 3, Steps: 3 | Train Loss: 1.466 Vali Loss: 1.435 Vali Acc: 0.175 Test Loss: 1.435 Test Acc: 0.175
Validation loss decreased (-0.149986 --> -0.174986).  Saving model ...
Epoch: 4 cost time: 0.4933278560638428
Epoch: 4, Steps: 3 | Train Loss: 1.437 Vali Loss: 1.418 Vali Acc: 0.175 Test Loss: 1.418 Test Acc: 0.175
Validation loss decreased (-0.174986 --> -0.174986).  Saving model ...
Epoch: 5 cost time: 0.5059890747070312
Epoch: 5, Steps: 3 | Train Loss: 1.416 Vali Loss: 1.398 Vali Acc: 0.175 Test Loss: 1.398 Test Acc: 0.175
Validation loss decreased (-0.174986 --> -0.174986).  Saving model ...
Epoch: 6 cost time: 0.5894303321838379
Epoch: 6, Steps: 3 | Train Loss: 1.368 Vali Loss: 1.377 Vali Acc: 0.200 Test Loss: 1.377 Test Acc: 0.200
Validation loss decreased (-0.174986 --> -0.199986).  Saving model ...
Epoch: 7 cost time: 0.50942063331604
Epoch: 7, Steps: 3 | Train Loss: 1.302 Vali Loss: 1.354 Vali Acc: 0.225 Test Loss: 1.354 Test Acc: 0.225
Validation loss decreased (-0.199986 --> -0.224986).  Saving model ...
Epoch: 8 cost time: 0.47820401191711426
Epoch: 8, Steps: 3 | Train Loss: 1.305 Vali Loss: 1.328 Vali Acc: 0.250 Test Loss: 1.328 Test Acc: 0.250
Validation loss decreased (-0.224986 --> -0.249987).  Saving model ...
Epoch: 9 cost time: 0.6566579341888428
Epoch: 9, Steps: 3 | Train Loss: 1.281 Vali Loss: 1.301 Vali Acc: 0.350 Test Loss: 1.301 Test Acc: 0.350
Validation loss decreased (-0.249987 --> -0.349987).  Saving model ...
Epoch: 10 cost time: 0.4511139392852783
Epoch: 10, Steps: 3 | Train Loss: 1.189 Vali Loss: 1.272 Vali Acc: 0.425 Test Loss: 1.272 Test Acc: 0.425
Validation loss decreased (-0.349987 --> -0.424987).  Saving model ...
Epoch: 11 cost time: 0.5461416244506836
Epoch: 11, Steps: 3 | Train Loss: 1.163 Vali Loss: 1.240 Vali Acc: 0.425 Test Loss: 1.240 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424988).  Saving model ...
Epoch: 12 cost time: 0.41684651374816895
Epoch: 12, Steps: 3 | Train Loss: 1.123 Vali Loss: 1.204 Vali Acc: 0.450 Test Loss: 1.204 Test Acc: 0.450
Validation loss decreased (-0.424988 --> -0.449988).  Saving model ...
Epoch: 13 cost time: 0.48212695121765137
Epoch: 13, Steps: 3 | Train Loss: 1.074 Vali Loss: 1.162 Vali Acc: 0.475 Test Loss: 1.162 Test Acc: 0.475
Validation loss decreased (-0.449988 --> -0.474988).  Saving model ...
Epoch: 14 cost time: 0.49591755867004395
Epoch: 14, Steps: 3 | Train Loss: 1.007 Vali Loss: 1.117 Vali Acc: 0.475 Test Loss: 1.117 Test Acc: 0.475
Validation loss decreased (-0.474988 --> -0.474989).  Saving model ...
Epoch: 15 cost time: 0.484635591506958
Epoch: 15, Steps: 3 | Train Loss: 0.931 Vali Loss: 1.068 Vali Acc: 0.550 Test Loss: 1.068 Test Acc: 0.550
Validation loss decreased (-0.474989 --> -0.549989).  Saving model ...
Epoch: 16 cost time: 0.5070719718933105
Epoch: 16, Steps: 3 | Train Loss: 0.885 Vali Loss: 1.013 Vali Acc: 0.600 Test Loss: 1.013 Test Acc: 0.600
Validation loss decreased (-0.549989 --> -0.599990).  Saving model ...
Epoch: 17 cost time: 0.4814140796661377
Epoch: 17, Steps: 3 | Train Loss: 0.825 Vali Loss: 0.950 Vali Acc: 0.750 Test Loss: 0.950 Test Acc: 0.750
Validation loss decreased (-0.599990 --> -0.749990).  Saving model ...
Epoch: 18 cost time: 0.4840693473815918
Epoch: 18, Steps: 3 | Train Loss: 0.760 Vali Loss: 0.879 Vali Acc: 0.775 Test Loss: 0.879 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774991).  Saving model ...
Epoch: 19 cost time: 0.42379117012023926
Epoch: 19, Steps: 3 | Train Loss: 0.701 Vali Loss: 0.804 Vali Acc: 0.850 Test Loss: 0.804 Test Acc: 0.850
Validation loss decreased (-0.774991 --> -0.849992).  Saving model ...
Epoch: 20 cost time: 0.5070383548736572
Epoch: 20, Steps: 3 | Train Loss: 0.590 Vali Loss: 0.727 Vali Acc: 0.875 Test Loss: 0.727 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874993).  Saving model ...
Epoch: 21 cost time: 0.5216491222381592
Epoch: 21, Steps: 3 | Train Loss: 0.567 Vali Loss: 0.650 Vali Acc: 0.900 Test Loss: 0.650 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899993).  Saving model ...
Epoch: 22 cost time: 0.45325446128845215
Epoch: 22, Steps: 3 | Train Loss: 0.484 Vali Loss: 0.578 Vali Acc: 0.900 Test Loss: 0.578 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 23 cost time: 0.4748983383178711
Epoch: 23, Steps: 3 | Train Loss: 0.446 Vali Loss: 0.511 Vali Acc: 0.900 Test Loss: 0.511 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 24 cost time: 0.4536919593811035
Epoch: 24, Steps: 3 | Train Loss: 0.379 Vali Loss: 0.453 Vali Acc: 0.925 Test Loss: 0.453 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924995).  Saving model ...
Epoch: 25 cost time: 0.5543069839477539
Epoch: 25, Steps: 3 | Train Loss: 0.367 Vali Loss: 0.400 Vali Acc: 0.950 Test Loss: 0.400 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949996).  Saving model ...
Epoch: 26 cost time: 0.4749643802642822
Epoch: 26, Steps: 3 | Train Loss: 0.315 Vali Loss: 0.353 Vali Acc: 0.975 Test Loss: 0.353 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974996).  Saving model ...
Epoch: 27 cost time: 0.5665237903594971
Epoch: 27, Steps: 3 | Train Loss: 0.264 Vali Loss: 0.311 Vali Acc: 0.975 Test Loss: 0.311 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 28 cost time: 0.45054101943969727
Epoch: 28, Steps: 3 | Train Loss: 0.247 Vali Loss: 0.275 Vali Acc: 0.975 Test Loss: 0.275 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 29 cost time: 0.4577901363372803
Epoch: 29, Steps: 3 | Train Loss: 0.238 Vali Loss: 0.242 Vali Acc: 0.975 Test Loss: 0.242 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 30 cost time: 0.5488874912261963
Epoch: 30, Steps: 3 | Train Loss: 0.210 Vali Loss: 0.210 Vali Acc: 1.000 Test Loss: 0.210 Test Acc: 1.000
Validation loss decreased (-0.974998 --> -0.999998).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm512_cs8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 121086
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm512_cs7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.758185625076294
Epoch: 1, Steps: 3 | Train Loss: 1.477 Vali Loss: 1.468 Vali Acc: 0.275 Test Loss: 1.468 Test Acc: 0.275
Validation loss decreased (inf --> -0.274985).  Saving model ...
Epoch: 2 cost time: 0.529456377029419
Epoch: 2, Steps: 3 | Train Loss: 1.439 Vali Loss: 1.461 Vali Acc: 0.300 Test Loss: 1.461 Test Acc: 0.300
Validation loss decreased (-0.274985 --> -0.299985).  Saving model ...
Epoch: 3 cost time: 0.4894254207611084
Epoch: 3, Steps: 3 | Train Loss: 1.426 Vali Loss: 1.453 Vali Acc: 0.300 Test Loss: 1.453 Test Acc: 0.300
Validation loss decreased (-0.299985 --> -0.299985).  Saving model ...
Epoch: 4 cost time: 0.45065879821777344
Epoch: 4, Steps: 3 | Train Loss: 1.411 Vali Loss: 1.443 Vali Acc: 0.300 Test Loss: 1.443 Test Acc: 0.300
Validation loss decreased (-0.299985 --> -0.299986).  Saving model ...
Epoch: 5 cost time: 0.6348588466644287
Epoch: 5, Steps: 3 | Train Loss: 1.411 Vali Loss: 1.430 Vali Acc: 0.300 Test Loss: 1.430 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 6 cost time: 0.5043234825134277
Epoch: 6, Steps: 3 | Train Loss: 1.371 Vali Loss: 1.416 Vali Acc: 0.325 Test Loss: 1.416 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324986).  Saving model ...
Epoch: 7 cost time: 0.5038843154907227
Epoch: 7, Steps: 3 | Train Loss: 1.343 Vali Loss: 1.400 Vali Acc: 0.325 Test Loss: 1.400 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324986).  Saving model ...
Epoch: 8 cost time: 0.5152955055236816
Epoch: 8, Steps: 3 | Train Loss: 1.291 Vali Loss: 1.383 Vali Acc: 0.375 Test Loss: 1.383 Test Acc: 0.375
Validation loss decreased (-0.324986 --> -0.374986).  Saving model ...
Epoch: 9 cost time: 0.4426448345184326
Epoch: 9, Steps: 3 | Train Loss: 1.243 Vali Loss: 1.365 Vali Acc: 0.375 Test Loss: 1.365 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 10 cost time: 0.4268326759338379
Epoch: 10, Steps: 3 | Train Loss: 1.246 Vali Loss: 1.347 Vali Acc: 0.475 Test Loss: 1.347 Test Acc: 0.475
Validation loss decreased (-0.374986 --> -0.474987).  Saving model ...
Epoch: 11 cost time: 0.39824843406677246
Epoch: 11, Steps: 3 | Train Loss: 1.217 Vali Loss: 1.328 Vali Acc: 0.450 Test Loss: 1.328 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.49306750297546387
Epoch: 12, Steps: 3 | Train Loss: 1.156 Vali Loss: 1.309 Vali Acc: 0.475 Test Loss: 1.309 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 13 cost time: 0.43195629119873047
Epoch: 13, Steps: 3 | Train Loss: 1.104 Vali Loss: 1.288 Vali Acc: 0.500 Test Loss: 1.288 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499987).  Saving model ...
Epoch: 14 cost time: 0.5485942363739014
Epoch: 14, Steps: 3 | Train Loss: 1.055 Vali Loss: 1.267 Vali Acc: 0.550 Test Loss: 1.267 Test Acc: 0.550
Validation loss decreased (-0.499987 --> -0.549987).  Saving model ...
Epoch: 15 cost time: 0.4689750671386719
Epoch: 15, Steps: 3 | Train Loss: 1.056 Vali Loss: 1.245 Vali Acc: 0.575 Test Loss: 1.245 Test Acc: 0.575
Validation loss decreased (-0.549987 --> -0.574988).  Saving model ...
Epoch: 16 cost time: 0.3839139938354492
Epoch: 16, Steps: 3 | Train Loss: 1.016 Vali Loss: 1.223 Vali Acc: 0.575 Test Loss: 1.223 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 17 cost time: 0.45256996154785156
Epoch: 17, Steps: 3 | Train Loss: 0.976 Vali Loss: 1.201 Vali Acc: 0.650 Test Loss: 1.201 Test Acc: 0.650
Validation loss decreased (-0.574988 --> -0.649988).  Saving model ...
Epoch: 18 cost time: 0.43285059928894043
Epoch: 18, Steps: 3 | Train Loss: 0.923 Vali Loss: 1.179 Vali Acc: 0.675 Test Loss: 1.179 Test Acc: 0.675
Validation loss decreased (-0.649988 --> -0.674988).  Saving model ...
Epoch: 19 cost time: 0.5038466453552246
Epoch: 19, Steps: 3 | Train Loss: 0.874 Vali Loss: 1.154 Vali Acc: 0.675 Test Loss: 1.154 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674988).  Saving model ...
Epoch: 20 cost time: 0.5058114528656006
Epoch: 20, Steps: 3 | Train Loss: 0.856 Vali Loss: 1.129 Vali Acc: 0.675 Test Loss: 1.129 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674989).  Saving model ...
Epoch: 21 cost time: 0.37273478507995605
Epoch: 21, Steps: 3 | Train Loss: 0.826 Vali Loss: 1.105 Vali Acc: 0.725 Test Loss: 1.105 Test Acc: 0.725
Validation loss decreased (-0.674989 --> -0.724989).  Saving model ...
Epoch: 22 cost time: 0.36687397956848145
Epoch: 22, Steps: 3 | Train Loss: 0.800 Vali Loss: 1.080 Vali Acc: 0.725 Test Loss: 1.080 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 23 cost time: 0.5632977485656738
Epoch: 23, Steps: 3 | Train Loss: 0.755 Vali Loss: 1.055 Vali Acc: 0.725 Test Loss: 1.055 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 24 cost time: 0.4159736633300781
Epoch: 24, Steps: 3 | Train Loss: 0.748 Vali Loss: 1.030 Vali Acc: 0.750 Test Loss: 1.030 Test Acc: 0.750
Validation loss decreased (-0.724989 --> -0.749990).  Saving model ...
Epoch: 25 cost time: 0.45439696311950684
Epoch: 25, Steps: 3 | Train Loss: 0.675 Vali Loss: 1.004 Vali Acc: 0.750 Test Loss: 1.004 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 26 cost time: 0.5146446228027344
Epoch: 26, Steps: 3 | Train Loss: 0.643 Vali Loss: 0.976 Vali Acc: 0.775 Test Loss: 0.976 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774990).  Saving model ...
Epoch: 27 cost time: 0.40644359588623047
Epoch: 27, Steps: 3 | Train Loss: 0.588 Vali Loss: 0.948 Vali Acc: 0.775 Test Loss: 0.948 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774991).  Saving model ...
Epoch: 28 cost time: 0.48024940490722656
Epoch: 28, Steps: 3 | Train Loss: 0.572 Vali Loss: 0.919 Vali Acc: 0.750 Test Loss: 0.919 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.4730226993560791
Epoch: 29, Steps: 3 | Train Loss: 0.539 Vali Loss: 0.891 Vali Acc: 0.750 Test Loss: 0.891 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.49985384941101074
Epoch: 30, Steps: 3 | Train Loss: 0.490 Vali Loss: 0.861 Vali Acc: 0.800 Test Loss: 0.861 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799991).  Saving model ...
Epoch: 31 cost time: 0.49090576171875
Epoch: 31, Steps: 3 | Train Loss: 0.484 Vali Loss: 0.828 Vali Acc: 0.800 Test Loss: 0.828 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799992).  Saving model ...
Epoch: 32 cost time: 0.4874100685119629
Epoch: 32, Steps: 3 | Train Loss: 0.428 Vali Loss: 0.797 Vali Acc: 0.800 Test Loss: 0.797 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 33 cost time: 0.5165596008300781
Epoch: 33, Steps: 3 | Train Loss: 0.414 Vali Loss: 0.768 Vali Acc: 0.825 Test Loss: 0.768 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824992).  Saving model ...
Epoch: 34 cost time: 0.539426326751709
Epoch: 34, Steps: 3 | Train Loss: 0.388 Vali Loss: 0.737 Vali Acc: 0.825 Test Loss: 0.737 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824993).  Saving model ...
Epoch: 35 cost time: 0.49185943603515625
Epoch: 35, Steps: 3 | Train Loss: 0.352 Vali Loss: 0.709 Vali Acc: 0.850 Test Loss: 0.709 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849993).  Saving model ...
Epoch: 36 cost time: 0.5085489749908447
Epoch: 36, Steps: 3 | Train Loss: 0.359 Vali Loss: 0.679 Vali Acc: 0.850 Test Loss: 0.679 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 37 cost time: 0.4850296974182129
Epoch: 37, Steps: 3 | Train Loss: 0.287 Vali Loss: 0.651 Vali Acc: 0.850 Test Loss: 0.651 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 38 cost time: 0.5394484996795654
Epoch: 38, Steps: 3 | Train Loss: 0.276 Vali Loss: 0.618 Vali Acc: 0.850 Test Loss: 0.618 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 39 cost time: 0.5797708034515381
Epoch: 39, Steps: 3 | Train Loss: 0.247 Vali Loss: 0.584 Vali Acc: 0.875 Test Loss: 0.584 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874994).  Saving model ...
Epoch: 40 cost time: 0.5256710052490234
Epoch: 40, Steps: 3 | Train Loss: 0.233 Vali Loss: 0.551 Vali Acc: 0.850 Test Loss: 0.551 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.4113342761993408
Epoch: 41, Steps: 3 | Train Loss: 0.213 Vali Loss: 0.522 Vali Acc: 0.850 Test Loss: 0.522 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.47777652740478516
Epoch: 42, Steps: 3 | Train Loss: 0.182 Vali Loss: 0.497 Vali Acc: 0.900 Test Loss: 0.497 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899995).  Saving model ...
Epoch: 43 cost time: 0.44670581817626953
Epoch: 43, Steps: 3 | Train Loss: 0.182 Vali Loss: 0.471 Vali Acc: 0.900 Test Loss: 0.471 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 44 cost time: 0.4956324100494385
Epoch: 44, Steps: 3 | Train Loss: 0.153 Vali Loss: 0.448 Vali Acc: 0.900 Test Loss: 0.448 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 45 cost time: 0.4822525978088379
Epoch: 45, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.432 Vali Acc: 0.925 Test Loss: 0.432 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 46 cost time: 0.5178031921386719
Epoch: 46, Steps: 3 | Train Loss: 0.130 Vali Loss: 0.420 Vali Acc: 0.925 Test Loss: 0.420 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 47 cost time: 0.5207681655883789
Epoch: 47, Steps: 3 | Train Loss: 0.106 Vali Loss: 0.410 Vali Acc: 0.925 Test Loss: 0.410 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 48 cost time: 0.38900136947631836
Epoch: 48, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.403 Vali Acc: 0.900 Test Loss: 0.403 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.621746301651001
Epoch: 49, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.400 Vali Acc: 0.900 Test Loss: 0.400 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.5529146194458008
Epoch: 50, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.401 Vali Acc: 0.900 Test Loss: 0.401 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.41669178009033203
Epoch: 51, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.409 Vali Acc: 0.900 Test Loss: 0.409 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.5445382595062256
Epoch: 52, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.427 Vali Acc: 0.900 Test Loss: 0.427 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 0.4204080104827881
Epoch: 53, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.442 Vali Acc: 0.925 Test Loss: 0.442 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 0.6197915077209473
Epoch: 54, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.458 Vali Acc: 0.925 Test Loss: 0.458 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 0.47330689430236816
Epoch: 55, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.471 Vali Acc: 0.925 Test Loss: 0.471 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 0.5665132999420166
Epoch: 56, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.480 Vali Acc: 0.925 Test Loss: 0.480 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 0.5922179222106934
Epoch: 57, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.495 Vali Acc: 0.925 Test Loss: 0.495 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm512_cs7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 121050
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm512_cs6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.8264594078063965
Epoch: 1, Steps: 3 | Train Loss: 1.429 Vali Loss: 1.414 Vali Acc: 0.300 Test Loss: 1.414 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.5781197547912598
Epoch: 2, Steps: 3 | Train Loss: 1.418 Vali Loss: 1.407 Vali Acc: 0.300 Test Loss: 1.407 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 0.5272085666656494
Epoch: 3, Steps: 3 | Train Loss: 1.409 Vali Loss: 1.399 Vali Acc: 0.300 Test Loss: 1.399 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 4 cost time: 0.5237596035003662
Epoch: 4, Steps: 3 | Train Loss: 1.375 Vali Loss: 1.388 Vali Acc: 0.300 Test Loss: 1.388 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 5 cost time: 0.4727003574371338
Epoch: 5, Steps: 3 | Train Loss: 1.388 Vali Loss: 1.376 Vali Acc: 0.350 Test Loss: 1.376 Test Acc: 0.350
Validation loss decreased (-0.299986 --> -0.349986).  Saving model ...
Epoch: 6 cost time: 0.43444037437438965
Epoch: 6, Steps: 3 | Train Loss: 1.360 Vali Loss: 1.360 Vali Acc: 0.375 Test Loss: 1.360 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374986).  Saving model ...
Epoch: 7 cost time: 0.5326619148254395
Epoch: 7, Steps: 3 | Train Loss: 1.332 Vali Loss: 1.343 Vali Acc: 0.350 Test Loss: 1.343 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5650649070739746
Epoch: 8, Steps: 3 | Train Loss: 1.267 Vali Loss: 1.325 Vali Acc: 0.400 Test Loss: 1.325 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399987).  Saving model ...
Epoch: 9 cost time: 0.45218467712402344
Epoch: 9, Steps: 3 | Train Loss: 1.214 Vali Loss: 1.305 Vali Acc: 0.450 Test Loss: 1.305 Test Acc: 0.450
Validation loss decreased (-0.399987 --> -0.449987).  Saving model ...
Epoch: 10 cost time: 0.5602493286132812
Epoch: 10, Steps: 3 | Train Loss: 1.193 Vali Loss: 1.286 Vali Acc: 0.475 Test Loss: 1.286 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474987).  Saving model ...
Epoch: 11 cost time: 0.47941040992736816
Epoch: 11, Steps: 3 | Train Loss: 1.163 Vali Loss: 1.265 Vali Acc: 0.550 Test Loss: 1.265 Test Acc: 0.550
Validation loss decreased (-0.474987 --> -0.549987).  Saving model ...
Epoch: 12 cost time: 0.5895206928253174
Epoch: 12, Steps: 3 | Train Loss: 1.119 Vali Loss: 1.245 Vali Acc: 0.550 Test Loss: 1.245 Test Acc: 0.550
Validation loss decreased (-0.549987 --> -0.549988).  Saving model ...
Epoch: 13 cost time: 0.47728681564331055
Epoch: 13, Steps: 3 | Train Loss: 1.093 Vali Loss: 1.222 Vali Acc: 0.600 Test Loss: 1.222 Test Acc: 0.600
Validation loss decreased (-0.549988 --> -0.599988).  Saving model ...
Epoch: 14 cost time: 0.46439552307128906
Epoch: 14, Steps: 3 | Train Loss: 1.035 Vali Loss: 1.197 Vali Acc: 0.575 Test Loss: 1.197 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6104469299316406
Epoch: 15, Steps: 3 | Train Loss: 0.997 Vali Loss: 1.171 Vali Acc: 0.575 Test Loss: 1.171 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.5275475978851318
Epoch: 16, Steps: 3 | Train Loss: 0.985 Vali Loss: 1.144 Vali Acc: 0.675 Test Loss: 1.144 Test Acc: 0.675
Validation loss decreased (-0.599988 --> -0.674989).  Saving model ...
Epoch: 17 cost time: 0.4489023685455322
Epoch: 17, Steps: 3 | Train Loss: 0.898 Vali Loss: 1.114 Vali Acc: 0.725 Test Loss: 1.114 Test Acc: 0.725
Validation loss decreased (-0.674989 --> -0.724989).  Saving model ...
Epoch: 18 cost time: 0.5138387680053711
Epoch: 18, Steps: 3 | Train Loss: 0.874 Vali Loss: 1.082 Vali Acc: 0.750 Test Loss: 1.082 Test Acc: 0.750
Validation loss decreased (-0.724989 --> -0.749989).  Saving model ...
Epoch: 19 cost time: 0.604212760925293
Epoch: 19, Steps: 3 | Train Loss: 0.838 Vali Loss: 1.048 Vali Acc: 0.775 Test Loss: 1.048 Test Acc: 0.775
Validation loss decreased (-0.749989 --> -0.774990).  Saving model ...
Epoch: 20 cost time: 0.4192485809326172
Epoch: 20, Steps: 3 | Train Loss: 0.832 Vali Loss: 1.012 Vali Acc: 0.800 Test Loss: 1.012 Test Acc: 0.800
Validation loss decreased (-0.774990 --> -0.799990).  Saving model ...
Epoch: 21 cost time: 0.4525439739227295
Epoch: 21, Steps: 3 | Train Loss: 0.754 Vali Loss: 0.973 Vali Acc: 0.800 Test Loss: 0.973 Test Acc: 0.800
Validation loss decreased (-0.799990 --> -0.799990).  Saving model ...
Epoch: 22 cost time: 0.48125243186950684
Epoch: 22, Steps: 3 | Train Loss: 0.719 Vali Loss: 0.934 Vali Acc: 0.800 Test Loss: 0.934 Test Acc: 0.800
Validation loss decreased (-0.799990 --> -0.799991).  Saving model ...
Epoch: 23 cost time: 0.5113129615783691
Epoch: 23, Steps: 3 | Train Loss: 0.675 Vali Loss: 0.891 Vali Acc: 0.825 Test Loss: 0.891 Test Acc: 0.825
Validation loss decreased (-0.799991 --> -0.824991).  Saving model ...
Epoch: 24 cost time: 0.47931480407714844
Epoch: 24, Steps: 3 | Train Loss: 0.632 Vali Loss: 0.845 Vali Acc: 0.850 Test Loss: 0.845 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849992).  Saving model ...
Epoch: 25 cost time: 0.48464012145996094
Epoch: 25, Steps: 3 | Train Loss: 0.555 Vali Loss: 0.797 Vali Acc: 0.850 Test Loss: 0.797 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 26 cost time: 0.5511996746063232
Epoch: 26, Steps: 3 | Train Loss: 0.518 Vali Loss: 0.741 Vali Acc: 0.850 Test Loss: 0.741 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849993).  Saving model ...
Epoch: 27 cost time: 0.4250771999359131
Epoch: 27, Steps: 3 | Train Loss: 0.495 Vali Loss: 0.684 Vali Acc: 0.825 Test Loss: 0.684 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.4794800281524658
Epoch: 28, Steps: 3 | Train Loss: 0.435 Vali Loss: 0.620 Vali Acc: 0.850 Test Loss: 0.620 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 29 cost time: 0.6695184707641602
Epoch: 29, Steps: 3 | Train Loss: 0.393 Vali Loss: 0.562 Vali Acc: 0.850 Test Loss: 0.562 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 30 cost time: 0.6190052032470703
Epoch: 30, Steps: 3 | Train Loss: 0.372 Vali Loss: 0.497 Vali Acc: 0.850 Test Loss: 0.497 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 31 cost time: 0.4809877872467041
Epoch: 31, Steps: 3 | Train Loss: 0.354 Vali Loss: 0.443 Vali Acc: 0.875 Test Loss: 0.443 Test Acc: 0.875
Validation loss decreased (-0.849995 --> -0.874996).  Saving model ...
Epoch: 32 cost time: 0.501389741897583
Epoch: 32, Steps: 3 | Train Loss: 0.331 Vali Loss: 0.403 Vali Acc: 0.875 Test Loss: 0.403 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 33 cost time: 0.5249035358428955
Epoch: 33, Steps: 3 | Train Loss: 0.312 Vali Loss: 0.373 Vali Acc: 0.875 Test Loss: 0.373 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 34 cost time: 0.48935556411743164
Epoch: 34, Steps: 3 | Train Loss: 0.272 Vali Loss: 0.349 Vali Acc: 0.925 Test Loss: 0.349 Test Acc: 0.925
Validation loss decreased (-0.874996 --> -0.924997).  Saving model ...
Epoch: 35 cost time: 0.46946263313293457
Epoch: 35, Steps: 3 | Train Loss: 0.249 Vali Loss: 0.327 Vali Acc: 0.925 Test Loss: 0.327 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 36 cost time: 0.5041584968566895
Epoch: 36, Steps: 3 | Train Loss: 0.219 Vali Loss: 0.305 Vali Acc: 0.925 Test Loss: 0.305 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 37 cost time: 0.5292768478393555
Epoch: 37, Steps: 3 | Train Loss: 0.222 Vali Loss: 0.282 Vali Acc: 0.925 Test Loss: 0.282 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 38 cost time: 0.5866742134094238
Epoch: 38, Steps: 3 | Train Loss: 0.182 Vali Loss: 0.258 Vali Acc: 0.925 Test Loss: 0.258 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 39 cost time: 0.6003422737121582
Epoch: 39, Steps: 3 | Train Loss: 0.206 Vali Loss: 0.238 Vali Acc: 0.925 Test Loss: 0.238 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924998).  Saving model ...
Epoch: 40 cost time: 0.4736204147338867
Epoch: 40, Steps: 3 | Train Loss: 0.192 Vali Loss: 0.217 Vali Acc: 0.925 Test Loss: 0.217 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 41 cost time: 0.47948527336120605
Epoch: 41, Steps: 3 | Train Loss: 0.144 Vali Loss: 0.198 Vali Acc: 0.925 Test Loss: 0.198 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 42 cost time: 0.4572184085845947
Epoch: 42, Steps: 3 | Train Loss: 0.132 Vali Loss: 0.179 Vali Acc: 0.925 Test Loss: 0.179 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 43 cost time: 0.4359252452850342
Epoch: 43, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.169 Vali Acc: 0.950 Test Loss: 0.169 Test Acc: 0.950
Validation loss decreased (-0.924998 --> -0.949998).  Saving model ...
Epoch: 44 cost time: 0.44341516494750977
Epoch: 44, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.152 Vali Acc: 0.925 Test Loss: 0.152 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.5690014362335205
Epoch: 45, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.131 Vali Acc: 0.950 Test Loss: 0.131 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949999).  Saving model ...
Epoch: 46 cost time: 0.5642766952514648
Epoch: 46, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.109 Vali Acc: 0.975 Test Loss: 0.109 Test Acc: 0.975
Validation loss decreased (-0.949999 --> -0.974999).  Saving model ...
Epoch: 47 cost time: 0.4726135730743408
Epoch: 47, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.098 Vali Acc: 0.975 Test Loss: 0.098 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 48 cost time: 0.4389965534210205
Epoch: 48, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.089 Vali Acc: 0.975 Test Loss: 0.089 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 49 cost time: 0.4268784523010254
Epoch: 49, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.091 Vali Acc: 0.975 Test Loss: 0.091 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.5176305770874023
Epoch: 50, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.090 Vali Acc: 0.950 Test Loss: 0.090 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.5505728721618652
Epoch: 51, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.073 Vali Acc: 0.975 Test Loss: 0.073 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 52 cost time: 0.49638867378234863
Epoch: 52, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.060 Vali Acc: 1.000 Test Loss: 0.060 Test Acc: 1.000
Validation loss decreased (-0.974999 --> -0.999999).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm512_cs6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 120630
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm512_cs5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.5710618495941162
Epoch: 1, Steps: 3 | Train Loss: 1.550 Vali Loss: 1.408 Vali Acc: 0.350 Test Loss: 1.408 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 0.5617341995239258
Epoch: 2, Steps: 3 | Train Loss: 1.543 Vali Loss: 1.399 Vali Acc: 0.350 Test Loss: 1.399 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 3 cost time: 0.43952441215515137
Epoch: 3, Steps: 3 | Train Loss: 1.530 Vali Loss: 1.390 Vali Acc: 0.350 Test Loss: 1.390 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 4 cost time: 0.5396938323974609
Epoch: 4, Steps: 3 | Train Loss: 1.506 Vali Loss: 1.377 Vali Acc: 0.350 Test Loss: 1.377 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 5 cost time: 0.5473456382751465
Epoch: 5, Steps: 3 | Train Loss: 1.426 Vali Loss: 1.363 Vali Acc: 0.350 Test Loss: 1.363 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 6 cost time: 0.5107846260070801
Epoch: 6, Steps: 3 | Train Loss: 1.425 Vali Loss: 1.347 Vali Acc: 0.375 Test Loss: 1.347 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374987).  Saving model ...
Epoch: 7 cost time: 0.6375854015350342
Epoch: 7, Steps: 3 | Train Loss: 1.425 Vali Loss: 1.332 Vali Acc: 0.400 Test Loss: 1.332 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399987).  Saving model ...
Epoch: 8 cost time: 0.5481712818145752
Epoch: 8, Steps: 3 | Train Loss: 1.369 Vali Loss: 1.315 Vali Acc: 0.450 Test Loss: 1.315 Test Acc: 0.450
Validation loss decreased (-0.399987 --> -0.449987).  Saving model ...
Epoch: 9 cost time: 0.5248754024505615
Epoch: 9, Steps: 3 | Train Loss: 1.374 Vali Loss: 1.297 Vali Acc: 0.475 Test Loss: 1.297 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474987).  Saving model ...
Epoch: 10 cost time: 0.5780384540557861
Epoch: 10, Steps: 3 | Train Loss: 1.299 Vali Loss: 1.278 Vali Acc: 0.525 Test Loss: 1.278 Test Acc: 0.525
Validation loss decreased (-0.474987 --> -0.524987).  Saving model ...
Epoch: 11 cost time: 0.5306499004364014
Epoch: 11, Steps: 3 | Train Loss: 1.256 Vali Loss: 1.259 Vali Acc: 0.525 Test Loss: 1.259 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524987).  Saving model ...
Epoch: 12 cost time: 0.5276789665222168
Epoch: 12, Steps: 3 | Train Loss: 1.216 Vali Loss: 1.239 Vali Acc: 0.525 Test Loss: 1.239 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524988).  Saving model ...
Epoch: 13 cost time: 0.6516087055206299
Epoch: 13, Steps: 3 | Train Loss: 1.169 Vali Loss: 1.218 Vali Acc: 0.525 Test Loss: 1.218 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 14 cost time: 0.5517792701721191
Epoch: 14, Steps: 3 | Train Loss: 1.152 Vali Loss: 1.198 Vali Acc: 0.550 Test Loss: 1.198 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 15 cost time: 0.4764399528503418
Epoch: 15, Steps: 3 | Train Loss: 1.146 Vali Loss: 1.179 Vali Acc: 0.575 Test Loss: 1.179 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 16 cost time: 0.5554170608520508
Epoch: 16, Steps: 3 | Train Loss: 1.059 Vali Loss: 1.159 Vali Acc: 0.650 Test Loss: 1.159 Test Acc: 0.650
Validation loss decreased (-0.574988 --> -0.649988).  Saving model ...
Epoch: 17 cost time: 0.5427870750427246
Epoch: 17, Steps: 3 | Train Loss: 1.004 Vali Loss: 1.140 Vali Acc: 0.675 Test Loss: 1.140 Test Acc: 0.675
Validation loss decreased (-0.649988 --> -0.674989).  Saving model ...
Epoch: 18 cost time: 0.46219539642333984
Epoch: 18, Steps: 3 | Train Loss: 0.993 Vali Loss: 1.117 Vali Acc: 0.700 Test Loss: 1.117 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699989).  Saving model ...
Epoch: 19 cost time: 0.5201132297515869
Epoch: 19, Steps: 3 | Train Loss: 0.932 Vali Loss: 1.095 Vali Acc: 0.750 Test Loss: 1.095 Test Acc: 0.750
Validation loss decreased (-0.699989 --> -0.749989).  Saving model ...
Epoch: 20 cost time: 0.5605485439300537
Epoch: 20, Steps: 3 | Train Loss: 0.906 Vali Loss: 1.071 Vali Acc: 0.775 Test Loss: 1.071 Test Acc: 0.775
Validation loss decreased (-0.749989 --> -0.774989).  Saving model ...
Epoch: 21 cost time: 0.4794611930847168
Epoch: 21, Steps: 3 | Train Loss: 0.830 Vali Loss: 1.045 Vali Acc: 0.775 Test Loss: 1.045 Test Acc: 0.775
Validation loss decreased (-0.774989 --> -0.774990).  Saving model ...
Epoch: 22 cost time: 0.5086700916290283
Epoch: 22, Steps: 3 | Train Loss: 0.843 Vali Loss: 1.018 Vali Acc: 0.775 Test Loss: 1.018 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774990).  Saving model ...
Epoch: 23 cost time: 0.5192708969116211
Epoch: 23, Steps: 3 | Train Loss: 0.736 Vali Loss: 0.991 Vali Acc: 0.775 Test Loss: 0.991 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774990).  Saving model ...
Epoch: 24 cost time: 0.466754674911499
Epoch: 24, Steps: 3 | Train Loss: 0.721 Vali Loss: 0.964 Vali Acc: 0.775 Test Loss: 0.964 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774990).  Saving model ...
Epoch: 25 cost time: 0.708057165145874
Epoch: 25, Steps: 3 | Train Loss: 0.666 Vali Loss: 0.936 Vali Acc: 0.800 Test Loss: 0.936 Test Acc: 0.800
Validation loss decreased (-0.774990 --> -0.799991).  Saving model ...
Epoch: 26 cost time: 0.508878231048584
Epoch: 26, Steps: 3 | Train Loss: 0.672 Vali Loss: 0.909 Vali Acc: 0.800 Test Loss: 0.909 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 27 cost time: 0.5309946537017822
Epoch: 27, Steps: 3 | Train Loss: 0.630 Vali Loss: 0.883 Vali Acc: 0.775 Test Loss: 0.883 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5250909328460693
Epoch: 28, Steps: 3 | Train Loss: 0.568 Vali Loss: 0.855 Vali Acc: 0.750 Test Loss: 0.855 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.5441758632659912
Epoch: 29, Steps: 3 | Train Loss: 0.524 Vali Loss: 0.828 Vali Acc: 0.750 Test Loss: 0.828 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.4891788959503174
Epoch: 30, Steps: 3 | Train Loss: 0.497 Vali Loss: 0.802 Vali Acc: 0.750 Test Loss: 0.802 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.6635391712188721
Epoch: 31, Steps: 3 | Train Loss: 0.472 Vali Loss: 0.770 Vali Acc: 0.750 Test Loss: 0.770 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.6974589824676514
Epoch: 32, Steps: 3 | Train Loss: 0.395 Vali Loss: 0.745 Vali Acc: 0.750 Test Loss: 0.745 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.5785472393035889
Epoch: 33, Steps: 3 | Train Loss: 0.366 Vali Loss: 0.718 Vali Acc: 0.750 Test Loss: 0.718 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.6660172939300537
Epoch: 34, Steps: 3 | Train Loss: 0.375 Vali Loss: 0.701 Vali Acc: 0.750 Test Loss: 0.701 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.6919107437133789
Epoch: 35, Steps: 3 | Train Loss: 0.371 Vali Loss: 0.682 Vali Acc: 0.750 Test Loss: 0.682 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.5045115947723389
Epoch: 36, Steps: 3 | Train Loss: 0.273 Vali Loss: 0.662 Vali Acc: 0.775 Test Loss: 0.662 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm512_cs5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.8
model parameter : 120408
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm256_cs50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.583409070968628
Epoch: 1, Steps: 3 | Train Loss: 1.399 Vali Loss: 1.392 Vali Acc: 0.375 Test Loss: 1.392 Test Acc: 0.375
Validation loss decreased (inf --> -0.374986).  Saving model ...
Epoch: 2 cost time: 0.5369021892547607
Epoch: 2, Steps: 3 | Train Loss: 1.379 Vali Loss: 1.384 Vali Acc: 0.375 Test Loss: 1.384 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 3 cost time: 0.4372751712799072
Epoch: 3, Steps: 3 | Train Loss: 1.354 Vali Loss: 1.375 Vali Acc: 0.375 Test Loss: 1.375 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 4 cost time: 0.48521876335144043
Epoch: 4, Steps: 3 | Train Loss: 1.325 Vali Loss: 1.362 Vali Acc: 0.375 Test Loss: 1.362 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 5 cost time: 0.5636386871337891
Epoch: 5, Steps: 3 | Train Loss: 1.373 Vali Loss: 1.347 Vali Acc: 0.400 Test Loss: 1.347 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399987).  Saving model ...
Epoch: 6 cost time: 0.6037030220031738
Epoch: 6, Steps: 3 | Train Loss: 1.287 Vali Loss: 1.329 Vali Acc: 0.400 Test Loss: 1.329 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 7 cost time: 0.47960948944091797
Epoch: 7, Steps: 3 | Train Loss: 1.235 Vali Loss: 1.308 Vali Acc: 0.425 Test Loss: 1.308 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424987).  Saving model ...
Epoch: 8 cost time: 0.4955871105194092
Epoch: 8, Steps: 3 | Train Loss: 1.226 Vali Loss: 1.287 Vali Acc: 0.450 Test Loss: 1.287 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449987).  Saving model ...
Epoch: 9 cost time: 0.47899842262268066
Epoch: 9, Steps: 3 | Train Loss: 1.182 Vali Loss: 1.264 Vali Acc: 0.450 Test Loss: 1.264 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 10 cost time: 0.5847468376159668
Epoch: 10, Steps: 3 | Train Loss: 1.147 Vali Loss: 1.238 Vali Acc: 0.475 Test Loss: 1.238 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474988).  Saving model ...
Epoch: 11 cost time: 0.7165689468383789
Epoch: 11, Steps: 3 | Train Loss: 1.115 Vali Loss: 1.211 Vali Acc: 0.525 Test Loss: 1.211 Test Acc: 0.525
Validation loss decreased (-0.474988 --> -0.524988).  Saving model ...
Epoch: 12 cost time: 0.5153317451477051
Epoch: 12, Steps: 3 | Train Loss: 1.073 Vali Loss: 1.183 Vali Acc: 0.550 Test Loss: 1.183 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 13 cost time: 0.5518717765808105
Epoch: 13, Steps: 3 | Train Loss: 1.045 Vali Loss: 1.154 Vali Acc: 0.550 Test Loss: 1.154 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 14 cost time: 0.6621947288513184
Epoch: 14, Steps: 3 | Train Loss: 0.997 Vali Loss: 1.124 Vali Acc: 0.575 Test Loss: 1.124 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574989).  Saving model ...
Epoch: 15 cost time: 0.538862943649292
Epoch: 15, Steps: 3 | Train Loss: 0.954 Vali Loss: 1.090 Vali Acc: 0.575 Test Loss: 1.090 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 16 cost time: 0.5738990306854248
Epoch: 16, Steps: 3 | Train Loss: 0.916 Vali Loss: 1.056 Vali Acc: 0.600 Test Loss: 1.056 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599989).  Saving model ...
Epoch: 17 cost time: 0.5502665042877197
Epoch: 17, Steps: 3 | Train Loss: 0.863 Vali Loss: 1.020 Vali Acc: 0.650 Test Loss: 1.020 Test Acc: 0.650
Validation loss decreased (-0.599989 --> -0.649990).  Saving model ...
Epoch: 18 cost time: 0.5985956192016602
Epoch: 18, Steps: 3 | Train Loss: 0.842 Vali Loss: 0.980 Vali Acc: 0.725 Test Loss: 0.980 Test Acc: 0.725
Validation loss decreased (-0.649990 --> -0.724990).  Saving model ...
Epoch: 19 cost time: 0.6626946926116943
Epoch: 19, Steps: 3 | Train Loss: 0.764 Vali Loss: 0.938 Vali Acc: 0.775 Test Loss: 0.938 Test Acc: 0.775
Validation loss decreased (-0.724990 --> -0.774991).  Saving model ...
Epoch: 20 cost time: 0.519460916519165
Epoch: 20, Steps: 3 | Train Loss: 0.723 Vali Loss: 0.894 Vali Acc: 0.775 Test Loss: 0.894 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 21 cost time: 0.5979862213134766
Epoch: 21, Steps: 3 | Train Loss: 0.696 Vali Loss: 0.845 Vali Acc: 0.850 Test Loss: 0.845 Test Acc: 0.850
Validation loss decreased (-0.774991 --> -0.849992).  Saving model ...
Epoch: 22 cost time: 0.6771833896636963
Epoch: 22, Steps: 3 | Train Loss: 0.652 Vali Loss: 0.792 Vali Acc: 0.875 Test Loss: 0.792 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874992).  Saving model ...
Epoch: 23 cost time: 0.586719274520874
Epoch: 23, Steps: 3 | Train Loss: 0.616 Vali Loss: 0.737 Vali Acc: 0.875 Test Loss: 0.737 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874993).  Saving model ...
Epoch: 24 cost time: 0.5785152912139893
Epoch: 24, Steps: 3 | Train Loss: 0.571 Vali Loss: 0.685 Vali Acc: 0.875 Test Loss: 0.685 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 25 cost time: 0.6568822860717773
Epoch: 25, Steps: 3 | Train Loss: 0.550 Vali Loss: 0.629 Vali Acc: 0.875 Test Loss: 0.629 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 26 cost time: 0.7666912078857422
Epoch: 26, Steps: 3 | Train Loss: 0.483 Vali Loss: 0.576 Vali Acc: 0.875 Test Loss: 0.576 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 27 cost time: 0.5901484489440918
Epoch: 27, Steps: 3 | Train Loss: 0.443 Vali Loss: 0.526 Vali Acc: 0.875 Test Loss: 0.526 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 28 cost time: 0.6168727874755859
Epoch: 28, Steps: 3 | Train Loss: 0.404 Vali Loss: 0.478 Vali Acc: 0.875 Test Loss: 0.478 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 29 cost time: 0.5580041408538818
Epoch: 29, Steps: 3 | Train Loss: 0.400 Vali Loss: 0.435 Vali Acc: 0.900 Test Loss: 0.435 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899996).  Saving model ...
Epoch: 30 cost time: 0.6561784744262695
Epoch: 30, Steps: 3 | Train Loss: 0.352 Vali Loss: 0.395 Vali Acc: 0.925 Test Loss: 0.395 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 31 cost time: 0.6692733764648438
Epoch: 31, Steps: 3 | Train Loss: 0.304 Vali Loss: 0.358 Vali Acc: 0.925 Test Loss: 0.358 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 32 cost time: 0.6219964027404785
Epoch: 32, Steps: 3 | Train Loss: 0.292 Vali Loss: 0.325 Vali Acc: 0.925 Test Loss: 0.325 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 33 cost time: 0.708636999130249
Epoch: 33, Steps: 3 | Train Loss: 0.271 Vali Loss: 0.294 Vali Acc: 0.925 Test Loss: 0.294 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 34 cost time: 0.5098185539245605
Epoch: 34, Steps: 3 | Train Loss: 0.226 Vali Loss: 0.263 Vali Acc: 0.925 Test Loss: 0.263 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 35 cost time: 0.6061685085296631
Epoch: 35, Steps: 3 | Train Loss: 0.214 Vali Loss: 0.234 Vali Acc: 0.950 Test Loss: 0.234 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949998).  Saving model ...
Epoch: 36 cost time: 0.7257013320922852
Epoch: 36, Steps: 3 | Train Loss: 0.169 Vali Loss: 0.205 Vali Acc: 0.950 Test Loss: 0.205 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 37 cost time: 0.6860980987548828
Epoch: 37, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.178 Vali Acc: 0.975 Test Loss: 0.178 Test Acc: 0.975
Validation loss decreased (-0.949998 --> -0.974998).  Saving model ...
Epoch: 38 cost time: 0.6382312774658203
Epoch: 38, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.153 Vali Acc: 0.975 Test Loss: 0.153 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 39 cost time: 0.5963530540466309
Epoch: 39, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.128 Vali Acc: 0.975 Test Loss: 0.128 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 40 cost time: 0.5392482280731201
Epoch: 40, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.107 Vali Acc: 1.000 Test Loss: 0.107 Test Acc: 1.000
Validation loss decreased (-0.974999 --> -0.999999).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm256_cs50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 47288
model size : 0.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm256_cs34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6706385612487793
Epoch: 1, Steps: 3 | Train Loss: 1.443 Vali Loss: 1.540 Vali Acc: 0.325 Test Loss: 1.540 Test Acc: 0.325
Validation loss decreased (inf --> -0.324985).  Saving model ...
Epoch: 2 cost time: 0.5607178211212158
Epoch: 2, Steps: 3 | Train Loss: 1.433 Vali Loss: 1.531 Vali Acc: 0.325 Test Loss: 1.531 Test Acc: 0.325
Validation loss decreased (-0.324985 --> -0.324985).  Saving model ...
Epoch: 3 cost time: 0.5240659713745117
Epoch: 3, Steps: 3 | Train Loss: 1.368 Vali Loss: 1.524 Vali Acc: 0.350 Test Loss: 1.524 Test Acc: 0.350
Validation loss decreased (-0.324985 --> -0.349985).  Saving model ...
Epoch: 4 cost time: 0.6266965866088867
Epoch: 4, Steps: 3 | Train Loss: 1.374 Vali Loss: 1.514 Vali Acc: 0.350 Test Loss: 1.514 Test Acc: 0.350
Validation loss decreased (-0.349985 --> -0.349985).  Saving model ...
Epoch: 5 cost time: 0.5176186561584473
Epoch: 5, Steps: 3 | Train Loss: 1.370 Vali Loss: 1.501 Vali Acc: 0.375 Test Loss: 1.501 Test Acc: 0.375
Validation loss decreased (-0.349985 --> -0.374985).  Saving model ...
Epoch: 6 cost time: 0.38950252532958984
Epoch: 6, Steps: 3 | Train Loss: 1.339 Vali Loss: 1.487 Vali Acc: 0.375 Test Loss: 1.487 Test Acc: 0.375
Validation loss decreased (-0.374985 --> -0.374985).  Saving model ...
Epoch: 7 cost time: 0.511436939239502
Epoch: 7, Steps: 3 | Train Loss: 1.292 Vali Loss: 1.472 Vali Acc: 0.375 Test Loss: 1.472 Test Acc: 0.375
Validation loss decreased (-0.374985 --> -0.374985).  Saving model ...
Epoch: 8 cost time: 0.5644114017486572
Epoch: 8, Steps: 3 | Train Loss: 1.288 Vali Loss: 1.455 Vali Acc: 0.375 Test Loss: 1.455 Test Acc: 0.375
Validation loss decreased (-0.374985 --> -0.374985).  Saving model ...
Epoch: 9 cost time: 0.5191266536712646
Epoch: 9, Steps: 3 | Train Loss: 1.269 Vali Loss: 1.438 Vali Acc: 0.400 Test Loss: 1.438 Test Acc: 0.400
Validation loss decreased (-0.374985 --> -0.399986).  Saving model ...
Epoch: 10 cost time: 0.501579999923706
Epoch: 10, Steps: 3 | Train Loss: 1.222 Vali Loss: 1.420 Vali Acc: 0.425 Test Loss: 1.420 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424986).  Saving model ...
Epoch: 11 cost time: 0.45694446563720703
Epoch: 11, Steps: 3 | Train Loss: 1.198 Vali Loss: 1.401 Vali Acc: 0.450 Test Loss: 1.401 Test Acc: 0.450
Validation loss decreased (-0.424986 --> -0.449986).  Saving model ...
Epoch: 12 cost time: 0.5170848369598389
Epoch: 12, Steps: 3 | Train Loss: 1.140 Vali Loss: 1.381 Vali Acc: 0.500 Test Loss: 1.381 Test Acc: 0.500
Validation loss decreased (-0.449986 --> -0.499986).  Saving model ...
Epoch: 13 cost time: 0.4730525016784668
Epoch: 13, Steps: 3 | Train Loss: 1.126 Vali Loss: 1.361 Vali Acc: 0.500 Test Loss: 1.361 Test Acc: 0.500
Validation loss decreased (-0.499986 --> -0.499986).  Saving model ...
Epoch: 14 cost time: 0.4300844669342041
Epoch: 14, Steps: 3 | Train Loss: 1.076 Vali Loss: 1.340 Vali Acc: 0.500 Test Loss: 1.340 Test Acc: 0.500
Validation loss decreased (-0.499986 --> -0.499987).  Saving model ...
Epoch: 15 cost time: 0.5961687564849854
Epoch: 15, Steps: 3 | Train Loss: 1.066 Vali Loss: 1.320 Vali Acc: 0.500 Test Loss: 1.320 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 16 cost time: 0.5287997722625732
Epoch: 16, Steps: 3 | Train Loss: 1.022 Vali Loss: 1.300 Vali Acc: 0.500 Test Loss: 1.300 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 17 cost time: 0.57008957862854
Epoch: 17, Steps: 3 | Train Loss: 1.005 Vali Loss: 1.279 Vali Acc: 0.525 Test Loss: 1.279 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524987).  Saving model ...
Epoch: 18 cost time: 0.5197973251342773
Epoch: 18, Steps: 3 | Train Loss: 0.985 Vali Loss: 1.258 Vali Acc: 0.550 Test Loss: 1.258 Test Acc: 0.550
Validation loss decreased (-0.524987 --> -0.549987).  Saving model ...
Epoch: 19 cost time: 0.46584033966064453
Epoch: 19, Steps: 3 | Train Loss: 0.962 Vali Loss: 1.236 Vali Acc: 0.550 Test Loss: 1.236 Test Acc: 0.550
Validation loss decreased (-0.549987 --> -0.549988).  Saving model ...
Epoch: 20 cost time: 0.513843297958374
Epoch: 20, Steps: 3 | Train Loss: 0.864 Vali Loss: 1.215 Vali Acc: 0.575 Test Loss: 1.215 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 21 cost time: 0.4687786102294922
Epoch: 21, Steps: 3 | Train Loss: 0.880 Vali Loss: 1.195 Vali Acc: 0.625 Test Loss: 1.195 Test Acc: 0.625
Validation loss decreased (-0.574988 --> -0.624988).  Saving model ...
Epoch: 22 cost time: 0.5519027709960938
Epoch: 22, Steps: 3 | Train Loss: 0.815 Vali Loss: 1.175 Vali Acc: 0.625 Test Loss: 1.175 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 23 cost time: 0.5423717498779297
Epoch: 23, Steps: 3 | Train Loss: 0.834 Vali Loss: 1.154 Vali Acc: 0.675 Test Loss: 1.154 Test Acc: 0.675
Validation loss decreased (-0.624988 --> -0.674988).  Saving model ...
Epoch: 24 cost time: 0.521040678024292
Epoch: 24, Steps: 3 | Train Loss: 0.762 Vali Loss: 1.132 Vali Acc: 0.675 Test Loss: 1.132 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674989).  Saving model ...
Epoch: 25 cost time: 0.5988011360168457
Epoch: 25, Steps: 3 | Train Loss: 0.767 Vali Loss: 1.109 Vali Acc: 0.700 Test Loss: 1.109 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699989).  Saving model ...
Epoch: 26 cost time: 0.489243745803833
Epoch: 26, Steps: 3 | Train Loss: 0.700 Vali Loss: 1.086 Vali Acc: 0.700 Test Loss: 1.086 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 27 cost time: 0.41837072372436523
Epoch: 27, Steps: 3 | Train Loss: 0.694 Vali Loss: 1.061 Vali Acc: 0.700 Test Loss: 1.061 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 28 cost time: 0.35324954986572266
Epoch: 28, Steps: 3 | Train Loss: 0.665 Vali Loss: 1.036 Vali Acc: 0.700 Test Loss: 1.036 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699990).  Saving model ...
Epoch: 29 cost time: 0.521212100982666
Epoch: 29, Steps: 3 | Train Loss: 0.653 Vali Loss: 1.005 Vali Acc: 0.650 Test Loss: 1.005 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.470034122467041
Epoch: 30, Steps: 3 | Train Loss: 0.591 Vali Loss: 0.978 Vali Acc: 0.675 Test Loss: 0.978 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.4998030662536621
Epoch: 31, Steps: 3 | Train Loss: 0.578 Vali Loss: 0.953 Vali Acc: 0.700 Test Loss: 0.953 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 32 cost time: 0.5442469120025635
Epoch: 32, Steps: 3 | Train Loss: 0.549 Vali Loss: 0.922 Vali Acc: 0.725 Test Loss: 0.922 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724991).  Saving model ...
Epoch: 33 cost time: 0.5018734931945801
Epoch: 33, Steps: 3 | Train Loss: 0.523 Vali Loss: 0.891 Vali Acc: 0.775 Test Loss: 0.891 Test Acc: 0.775
Validation loss decreased (-0.724991 --> -0.774991).  Saving model ...
Epoch: 34 cost time: 0.5083920955657959
Epoch: 34, Steps: 3 | Train Loss: 0.491 Vali Loss: 0.860 Vali Acc: 0.800 Test Loss: 0.860 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799991).  Saving model ...
Epoch: 35 cost time: 0.4008011817932129
Epoch: 35, Steps: 3 | Train Loss: 0.482 Vali Loss: 0.827 Vali Acc: 0.825 Test Loss: 0.827 Test Acc: 0.825
Validation loss decreased (-0.799991 --> -0.824992).  Saving model ...
Epoch: 36 cost time: 0.42850494384765625
Epoch: 36, Steps: 3 | Train Loss: 0.446 Vali Loss: 0.793 Vali Acc: 0.825 Test Loss: 0.793 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 37 cost time: 0.4826216697692871
Epoch: 37, Steps: 3 | Train Loss: 0.447 Vali Loss: 0.750 Vali Acc: 0.825 Test Loss: 0.750 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 38 cost time: 0.45258092880249023
Epoch: 38, Steps: 3 | Train Loss: 0.404 Vali Loss: 0.713 Vali Acc: 0.825 Test Loss: 0.713 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824993).  Saving model ...
Epoch: 39 cost time: 0.5151679515838623
Epoch: 39, Steps: 3 | Train Loss: 0.369 Vali Loss: 0.680 Vali Acc: 0.825 Test Loss: 0.680 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 40 cost time: 0.47379207611083984
Epoch: 40, Steps: 3 | Train Loss: 0.351 Vali Loss: 0.646 Vali Acc: 0.850 Test Loss: 0.646 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849994).  Saving model ...
Epoch: 41 cost time: 0.5621449947357178
Epoch: 41, Steps: 3 | Train Loss: 0.335 Vali Loss: 0.611 Vali Acc: 0.850 Test Loss: 0.611 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 42 cost time: 0.4731152057647705
Epoch: 42, Steps: 3 | Train Loss: 0.343 Vali Loss: 0.579 Vali Acc: 0.850 Test Loss: 0.579 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 43 cost time: 0.5098323822021484
Epoch: 43, Steps: 3 | Train Loss: 0.306 Vali Loss: 0.548 Vali Acc: 0.875 Test Loss: 0.548 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874995).  Saving model ...
Epoch: 44 cost time: 0.5719645023345947
Epoch: 44, Steps: 3 | Train Loss: 0.296 Vali Loss: 0.507 Vali Acc: 0.875 Test Loss: 0.507 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 45 cost time: 0.5339310169219971
Epoch: 45, Steps: 3 | Train Loss: 0.271 Vali Loss: 0.471 Vali Acc: 0.900 Test Loss: 0.471 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899995).  Saving model ...
Epoch: 46 cost time: 0.4372086524963379
Epoch: 46, Steps: 3 | Train Loss: 0.257 Vali Loss: 0.439 Vali Acc: 0.875 Test Loss: 0.439 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.5385494232177734
Epoch: 47, Steps: 3 | Train Loss: 0.255 Vali Loss: 0.403 Vali Acc: 0.900 Test Loss: 0.403 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 48 cost time: 0.5343749523162842
Epoch: 48, Steps: 3 | Train Loss: 0.241 Vali Loss: 0.362 Vali Acc: 0.925 Test Loss: 0.362 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 49 cost time: 0.44324707984924316
Epoch: 49, Steps: 3 | Train Loss: 0.210 Vali Loss: 0.328 Vali Acc: 0.925 Test Loss: 0.328 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 50 cost time: 0.4498295783996582
Epoch: 50, Steps: 3 | Train Loss: 0.194 Vali Loss: 0.299 Vali Acc: 0.900 Test Loss: 0.299 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.40932369232177734
Epoch: 51, Steps: 3 | Train Loss: 0.164 Vali Loss: 0.262 Vali Acc: 0.925 Test Loss: 0.262 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 52 cost time: 0.41657114028930664
Epoch: 52, Steps: 3 | Train Loss: 0.154 Vali Loss: 0.225 Vali Acc: 0.950 Test Loss: 0.225 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949998).  Saving model ...
Epoch: 53 cost time: 0.4507570266723633
Epoch: 53, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.187 Vali Acc: 0.975 Test Loss: 0.187 Test Acc: 0.975
Validation loss decreased (-0.949998 --> -0.974998).  Saving model ...
Epoch: 54 cost time: 0.45368003845214844
Epoch: 54, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.154 Vali Acc: 1.000 Test Loss: 0.154 Test Acc: 1.000
Validation loss decreased (-0.974998 --> -0.999998).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm256_cs34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 45454
model size : 0.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm256_cs25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7076685428619385
Epoch: 1, Steps: 3 | Train Loss: 1.451 Vali Loss: 1.423 Vali Acc: 0.475 Test Loss: 1.423 Test Acc: 0.475
Validation loss decreased (inf --> -0.474986).  Saving model ...
Epoch: 2 cost time: 0.5374226570129395
Epoch: 2, Steps: 3 | Train Loss: 1.423 Vali Loss: 1.415 Vali Acc: 0.475 Test Loss: 1.415 Test Acc: 0.475
Validation loss decreased (-0.474986 --> -0.474986).  Saving model ...
Epoch: 3 cost time: 0.4860877990722656
Epoch: 3, Steps: 3 | Train Loss: 1.407 Vali Loss: 1.409 Vali Acc: 0.475 Test Loss: 1.409 Test Acc: 0.475
Validation loss decreased (-0.474986 --> -0.474986).  Saving model ...
Epoch: 4 cost time: 0.4821641445159912
Epoch: 4, Steps: 3 | Train Loss: 1.391 Vali Loss: 1.400 Vali Acc: 0.475 Test Loss: 1.400 Test Acc: 0.475
Validation loss decreased (-0.474986 --> -0.474986).  Saving model ...
Epoch: 5 cost time: 0.4648401737213135
Epoch: 5, Steps: 3 | Train Loss: 1.398 Vali Loss: 1.391 Vali Acc: 0.475 Test Loss: 1.391 Test Acc: 0.475
Validation loss decreased (-0.474986 --> -0.474986).  Saving model ...
Epoch: 6 cost time: 0.45538997650146484
Epoch: 6, Steps: 3 | Train Loss: 1.375 Vali Loss: 1.380 Vali Acc: 0.475 Test Loss: 1.380 Test Acc: 0.475
Validation loss decreased (-0.474986 --> -0.474986).  Saving model ...
Epoch: 7 cost time: 0.4435882568359375
Epoch: 7, Steps: 3 | Train Loss: 1.344 Vali Loss: 1.368 Vali Acc: 0.475 Test Loss: 1.368 Test Acc: 0.475
Validation loss decreased (-0.474986 --> -0.474986).  Saving model ...
Epoch: 8 cost time: 0.5146894454956055
Epoch: 8, Steps: 3 | Train Loss: 1.310 Vali Loss: 1.357 Vali Acc: 0.475 Test Loss: 1.357 Test Acc: 0.475
Validation loss decreased (-0.474986 --> -0.474986).  Saving model ...
Epoch: 9 cost time: 0.41446924209594727
Epoch: 9, Steps: 3 | Train Loss: 1.263 Vali Loss: 1.343 Vali Acc: 0.550 Test Loss: 1.343 Test Acc: 0.550
Validation loss decreased (-0.474986 --> -0.549987).  Saving model ...
Epoch: 10 cost time: 0.3988456726074219
Epoch: 10, Steps: 3 | Train Loss: 1.241 Vali Loss: 1.329 Vali Acc: 0.550 Test Loss: 1.329 Test Acc: 0.550
Validation loss decreased (-0.549987 --> -0.549987).  Saving model ...
Epoch: 11 cost time: 0.5536530017852783
Epoch: 11, Steps: 3 | Train Loss: 1.201 Vali Loss: 1.314 Vali Acc: 0.625 Test Loss: 1.314 Test Acc: 0.625
Validation loss decreased (-0.549987 --> -0.624987).  Saving model ...
Epoch: 12 cost time: 0.4503140449523926
Epoch: 12, Steps: 3 | Train Loss: 1.159 Vali Loss: 1.299 Vali Acc: 0.575 Test Loss: 1.299 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5239408016204834
Epoch: 13, Steps: 3 | Train Loss: 1.140 Vali Loss: 1.284 Vali Acc: 0.575 Test Loss: 1.284 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.4945638179779053
Epoch: 14, Steps: 3 | Train Loss: 1.106 Vali Loss: 1.268 Vali Acc: 0.575 Test Loss: 1.268 Test Acc: 0.575
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.46843791007995605
Epoch: 15, Steps: 3 | Train Loss: 1.082 Vali Loss: 1.252 Vali Acc: 0.575 Test Loss: 1.252 Test Acc: 0.575
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.526531457901001
Epoch: 16, Steps: 3 | Train Loss: 1.032 Vali Loss: 1.237 Vali Acc: 0.575 Test Loss: 1.237 Test Acc: 0.575
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.46810483932495117
Epoch: 17, Steps: 3 | Train Loss: 1.014 Vali Loss: 1.220 Vali Acc: 0.625 Test Loss: 1.220 Test Acc: 0.625
Validation loss decreased (-0.624987 --> -0.624988).  Saving model ...
Epoch: 18 cost time: 0.4245007038116455
Epoch: 18, Steps: 3 | Train Loss: 0.987 Vali Loss: 1.205 Vali Acc: 0.650 Test Loss: 1.205 Test Acc: 0.650
Validation loss decreased (-0.624988 --> -0.649988).  Saving model ...
Epoch: 19 cost time: 0.48865199089050293
Epoch: 19, Steps: 3 | Train Loss: 0.919 Vali Loss: 1.188 Vali Acc: 0.650 Test Loss: 1.188 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649988).  Saving model ...
Epoch: 20 cost time: 0.4884474277496338
Epoch: 20, Steps: 3 | Train Loss: 0.918 Vali Loss: 1.172 Vali Acc: 0.625 Test Loss: 1.172 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.46167898178100586
Epoch: 21, Steps: 3 | Train Loss: 0.857 Vali Loss: 1.157 Vali Acc: 0.650 Test Loss: 1.157 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649988).  Saving model ...
Epoch: 22 cost time: 0.5498504638671875
Epoch: 22, Steps: 3 | Train Loss: 0.845 Vali Loss: 1.139 Vali Acc: 0.675 Test Loss: 1.139 Test Acc: 0.675
Validation loss decreased (-0.649988 --> -0.674989).  Saving model ...
Epoch: 23 cost time: 0.5062408447265625
Epoch: 23, Steps: 3 | Train Loss: 0.829 Vali Loss: 1.123 Vali Acc: 0.700 Test Loss: 1.123 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699989).  Saving model ...
Epoch: 24 cost time: 0.6142740249633789
Epoch: 24, Steps: 3 | Train Loss: 0.753 Vali Loss: 1.107 Vali Acc: 0.700 Test Loss: 1.107 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 25 cost time: 0.5619122982025146
Epoch: 25, Steps: 3 | Train Loss: 0.766 Vali Loss: 1.090 Vali Acc: 0.700 Test Loss: 1.090 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 26 cost time: 0.5700488090515137
Epoch: 26, Steps: 3 | Train Loss: 0.728 Vali Loss: 1.073 Vali Acc: 0.675 Test Loss: 1.073 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.4446985721588135
Epoch: 27, Steps: 3 | Train Loss: 0.708 Vali Loss: 1.059 Vali Acc: 0.675 Test Loss: 1.059 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.5248053073883057
Epoch: 28, Steps: 3 | Train Loss: 0.664 Vali Loss: 1.041 Vali Acc: 0.675 Test Loss: 1.041 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.44969916343688965
Epoch: 29, Steps: 3 | Train Loss: 0.654 Vali Loss: 1.026 Vali Acc: 0.675 Test Loss: 1.026 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.4153141975402832
Epoch: 30, Steps: 3 | Train Loss: 0.616 Vali Loss: 1.012 Vali Acc: 0.675 Test Loss: 1.012 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.4750633239746094
Epoch: 31, Steps: 3 | Train Loss: 0.573 Vali Loss: 0.997 Vali Acc: 0.675 Test Loss: 0.997 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.517376184463501
Epoch: 32, Steps: 3 | Train Loss: 0.570 Vali Loss: 0.979 Vali Acc: 0.725 Test Loss: 0.979 Test Acc: 0.725
Validation loss decreased (-0.699989 --> -0.724990).  Saving model ...
Epoch: 33 cost time: 0.5729458332061768
Epoch: 33, Steps: 3 | Train Loss: 0.506 Vali Loss: 0.959 Vali Acc: 0.750 Test Loss: 0.959 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749990).  Saving model ...
Epoch: 34 cost time: 0.46975040435791016
Epoch: 34, Steps: 3 | Train Loss: 0.500 Vali Loss: 0.937 Vali Acc: 0.750 Test Loss: 0.937 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749991).  Saving model ...
Epoch: 35 cost time: 0.46770167350769043
Epoch: 35, Steps: 3 | Train Loss: 0.481 Vali Loss: 0.914 Vali Acc: 0.750 Test Loss: 0.914 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 36 cost time: 0.5127129554748535
Epoch: 36, Steps: 3 | Train Loss: 0.452 Vali Loss: 0.892 Vali Acc: 0.750 Test Loss: 0.892 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 37 cost time: 0.4648103713989258
Epoch: 37, Steps: 3 | Train Loss: 0.447 Vali Loss: 0.868 Vali Acc: 0.750 Test Loss: 0.868 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 38 cost time: 0.39171695709228516
Epoch: 38, Steps: 3 | Train Loss: 0.415 Vali Loss: 0.841 Vali Acc: 0.800 Test Loss: 0.841 Test Acc: 0.800
Validation loss decreased (-0.749991 --> -0.799992).  Saving model ...
Epoch: 39 cost time: 0.5785391330718994
Epoch: 39, Steps: 3 | Train Loss: 0.397 Vali Loss: 0.815 Vali Acc: 0.800 Test Loss: 0.815 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 40 cost time: 0.5743608474731445
Epoch: 40, Steps: 3 | Train Loss: 0.395 Vali Loss: 0.791 Vali Acc: 0.800 Test Loss: 0.791 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 41 cost time: 0.48056530952453613
Epoch: 41, Steps: 3 | Train Loss: 0.355 Vali Loss: 0.765 Vali Acc: 0.800 Test Loss: 0.765 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 42 cost time: 0.5679464340209961
Epoch: 42, Steps: 3 | Train Loss: 0.318 Vali Loss: 0.732 Vali Acc: 0.800 Test Loss: 0.732 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799993).  Saving model ...
Epoch: 43 cost time: 0.4892458915710449
Epoch: 43, Steps: 3 | Train Loss: 0.350 Vali Loss: 0.695 Vali Acc: 0.825 Test Loss: 0.695 Test Acc: 0.825
Validation loss decreased (-0.799993 --> -0.824993).  Saving model ...
Epoch: 44 cost time: 0.41475558280944824
Epoch: 44, Steps: 3 | Train Loss: 0.288 Vali Loss: 0.659 Vali Acc: 0.875 Test Loss: 0.659 Test Acc: 0.875
Validation loss decreased (-0.824993 --> -0.874993).  Saving model ...
Epoch: 45 cost time: 0.48915982246398926
Epoch: 45, Steps: 3 | Train Loss: 0.276 Vali Loss: 0.620 Vali Acc: 0.850 Test Loss: 0.620 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.5541627407073975
Epoch: 46, Steps: 3 | Train Loss: 0.248 Vali Loss: 0.584 Vali Acc: 0.875 Test Loss: 0.584 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 47 cost time: 0.4131591320037842
Epoch: 47, Steps: 3 | Train Loss: 0.267 Vali Loss: 0.547 Vali Acc: 0.875 Test Loss: 0.547 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 48 cost time: 0.4011354446411133
Epoch: 48, Steps: 3 | Train Loss: 0.223 Vali Loss: 0.507 Vali Acc: 0.900 Test Loss: 0.507 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899995).  Saving model ...
Epoch: 49 cost time: 0.42725133895874023
Epoch: 49, Steps: 3 | Train Loss: 0.230 Vali Loss: 0.468 Vali Acc: 0.900 Test Loss: 0.468 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 50 cost time: 0.48401808738708496
Epoch: 50, Steps: 3 | Train Loss: 0.197 Vali Loss: 0.433 Vali Acc: 0.900 Test Loss: 0.433 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 51 cost time: 0.45555758476257324
Epoch: 51, Steps: 3 | Train Loss: 0.182 Vali Loss: 0.399 Vali Acc: 0.900 Test Loss: 0.399 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 52 cost time: 0.46096348762512207
Epoch: 52, Steps: 3 | Train Loss: 0.153 Vali Loss: 0.366 Vali Acc: 0.900 Test Loss: 0.366 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 53 cost time: 0.42986559867858887
Epoch: 53, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.335 Vali Acc: 0.900 Test Loss: 0.335 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 54 cost time: 0.5099883079528809
Epoch: 54, Steps: 3 | Train Loss: 0.130 Vali Loss: 0.305 Vali Acc: 0.900 Test Loss: 0.305 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 55 cost time: 0.4220399856567383
Epoch: 55, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.281 Vali Acc: 0.900 Test Loss: 0.281 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 56 cost time: 0.3960247039794922
Epoch: 56, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.260 Vali Acc: 0.900 Test Loss: 0.260 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 57 cost time: 0.4439425468444824
Epoch: 57, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.241 Vali Acc: 0.925 Test Loss: 0.241 Test Acc: 0.925
Validation loss decreased (-0.899997 --> -0.924998).  Saving model ...
Epoch: 58 cost time: 0.47211337089538574
Epoch: 58, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.227 Vali Acc: 0.925 Test Loss: 0.227 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 59 cost time: 0.5359795093536377
Epoch: 59, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.218 Vali Acc: 0.925 Test Loss: 0.218 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 60 cost time: 0.4582235813140869
Epoch: 60, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.211 Vali Acc: 0.925 Test Loss: 0.211 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 61 cost time: 0.5111968517303467
Epoch: 61, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.203 Vali Acc: 0.925 Test Loss: 0.203 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 62 cost time: 0.5357668399810791
Epoch: 62, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.196 Vali Acc: 0.925 Test Loss: 0.196 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 63 cost time: 0.4931066036224365
Epoch: 63, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.189 Vali Acc: 0.925 Test Loss: 0.189 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 64 cost time: 0.4006772041320801
Epoch: 64, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.185 Vali Acc: 0.925 Test Loss: 0.185 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 65 cost time: 0.6338119506835938
Epoch: 65, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.183 Vali Acc: 0.925 Test Loss: 0.183 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 66 cost time: 0.504734992980957
Epoch: 66, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.183 Vali Acc: 0.925 Test Loss: 0.183 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 67 cost time: 0.538689374923706
Epoch: 67, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.183 Vali Acc: 0.925 Test Loss: 0.183 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.4135739803314209
Epoch: 68, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.185 Vali Acc: 0.925 Test Loss: 0.185 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.5203404426574707
Epoch: 69, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.188 Vali Acc: 0.925 Test Loss: 0.188 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 0.5176825523376465
Epoch: 70, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.189 Vali Acc: 0.925 Test Loss: 0.189 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 0.4782290458679199
Epoch: 71, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.191 Vali Acc: 0.925 Test Loss: 0.191 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 0.47696423530578613
Epoch: 72, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.192 Vali Acc: 0.900 Test Loss: 0.192 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 0.43520450592041016
Epoch: 73, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.193 Vali Acc: 0.900 Test Loss: 0.193 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 0.4114501476287842
Epoch: 74, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.900 Test Loss: 0.193 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 0.4607422351837158
Epoch: 75, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.900 Test Loss: 0.194 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 76 cost time: 0.5487861633300781
Epoch: 76, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.900 Test Loss: 0.194 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm256_cs25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 44120
model size : 0.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm256_cs20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.5427660942077637
Epoch: 1, Steps: 3 | Train Loss: 1.412 Vali Loss: 1.425 Vali Acc: 0.325 Test Loss: 1.425 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 0.4380147457122803
Epoch: 2, Steps: 3 | Train Loss: 1.425 Vali Loss: 1.417 Vali Acc: 0.375 Test Loss: 1.417 Test Acc: 0.375
Validation loss decreased (-0.324986 --> -0.374986).  Saving model ...
Epoch: 3 cost time: 0.4543800354003906
Epoch: 3, Steps: 3 | Train Loss: 1.397 Vali Loss: 1.409 Vali Acc: 0.375 Test Loss: 1.409 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 4 cost time: 0.6545264720916748
Epoch: 4, Steps: 3 | Train Loss: 1.381 Vali Loss: 1.400 Vali Acc: 0.375 Test Loss: 1.400 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 5 cost time: 0.5028042793273926
Epoch: 5, Steps: 3 | Train Loss: 1.363 Vali Loss: 1.387 Vali Acc: 0.375 Test Loss: 1.387 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 6 cost time: 0.505831241607666
Epoch: 6, Steps: 3 | Train Loss: 1.298 Vali Loss: 1.374 Vali Acc: 0.375 Test Loss: 1.374 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 7 cost time: 0.5704975128173828
Epoch: 7, Steps: 3 | Train Loss: 1.268 Vali Loss: 1.360 Vali Acc: 0.425 Test Loss: 1.360 Test Acc: 0.425
Validation loss decreased (-0.374986 --> -0.424986).  Saving model ...
Epoch: 8 cost time: 0.670435905456543
Epoch: 8, Steps: 3 | Train Loss: 1.242 Vali Loss: 1.344 Vali Acc: 0.525 Test Loss: 1.344 Test Acc: 0.525
Validation loss decreased (-0.424986 --> -0.524987).  Saving model ...
Epoch: 9 cost time: 0.4838569164276123
Epoch: 9, Steps: 3 | Train Loss: 1.206 Vali Loss: 1.326 Vali Acc: 0.550 Test Loss: 1.326 Test Acc: 0.550
Validation loss decreased (-0.524987 --> -0.549987).  Saving model ...
Epoch: 10 cost time: 0.45785021781921387
Epoch: 10, Steps: 3 | Train Loss: 1.182 Vali Loss: 1.309 Vali Acc: 0.575 Test Loss: 1.309 Test Acc: 0.575
Validation loss decreased (-0.549987 --> -0.574987).  Saving model ...
Epoch: 11 cost time: 0.520409345626831
Epoch: 11, Steps: 3 | Train Loss: 1.147 Vali Loss: 1.291 Vali Acc: 0.625 Test Loss: 1.291 Test Acc: 0.625
Validation loss decreased (-0.574987 --> -0.624987).  Saving model ...
Epoch: 12 cost time: 0.432985782623291
Epoch: 12, Steps: 3 | Train Loss: 1.089 Vali Loss: 1.271 Vali Acc: 0.650 Test Loss: 1.271 Test Acc: 0.650
Validation loss decreased (-0.624987 --> -0.649987).  Saving model ...
Epoch: 13 cost time: 0.4289438724517822
Epoch: 13, Steps: 3 | Train Loss: 1.070 Vali Loss: 1.251 Vali Acc: 0.650 Test Loss: 1.251 Test Acc: 0.650
Validation loss decreased (-0.649987 --> -0.649987).  Saving model ...
Epoch: 14 cost time: 0.4972522258758545
Epoch: 14, Steps: 3 | Train Loss: 1.027 Vali Loss: 1.229 Vali Acc: 0.650 Test Loss: 1.229 Test Acc: 0.650
Validation loss decreased (-0.649987 --> -0.649988).  Saving model ...
Epoch: 15 cost time: 0.5194301605224609
Epoch: 15, Steps: 3 | Train Loss: 0.980 Vali Loss: 1.207 Vali Acc: 0.650 Test Loss: 1.207 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649988).  Saving model ...
Epoch: 16 cost time: 0.5841240882873535
Epoch: 16, Steps: 3 | Train Loss: 0.958 Vali Loss: 1.183 Vali Acc: 0.675 Test Loss: 1.183 Test Acc: 0.675
Validation loss decreased (-0.649988 --> -0.674988).  Saving model ...
Epoch: 17 cost time: 0.5315477848052979
Epoch: 17, Steps: 3 | Train Loss: 0.928 Vali Loss: 1.159 Vali Acc: 0.725 Test Loss: 1.159 Test Acc: 0.725
Validation loss decreased (-0.674988 --> -0.724988).  Saving model ...
Epoch: 18 cost time: 0.518563985824585
Epoch: 18, Steps: 3 | Train Loss: 0.889 Vali Loss: 1.134 Vali Acc: 0.725 Test Loss: 1.134 Test Acc: 0.725
Validation loss decreased (-0.724988 --> -0.724989).  Saving model ...
Epoch: 19 cost time: 0.5764374732971191
Epoch: 19, Steps: 3 | Train Loss: 0.888 Vali Loss: 1.108 Vali Acc: 0.700 Test Loss: 1.108 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5577514171600342
Epoch: 20, Steps: 3 | Train Loss: 0.817 Vali Loss: 1.082 Vali Acc: 0.700 Test Loss: 1.082 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6912686824798584
Epoch: 21, Steps: 3 | Train Loss: 0.786 Vali Loss: 1.054 Vali Acc: 0.700 Test Loss: 1.054 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.5362567901611328
Epoch: 22, Steps: 3 | Train Loss: 0.747 Vali Loss: 1.023 Vali Acc: 0.700 Test Loss: 1.023 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.4637899398803711
Epoch: 23, Steps: 3 | Train Loss: 0.695 Vali Loss: 0.991 Vali Acc: 0.725 Test Loss: 0.991 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724990).  Saving model ...
Epoch: 24 cost time: 0.6290600299835205
Epoch: 24, Steps: 3 | Train Loss: 0.668 Vali Loss: 0.958 Vali Acc: 0.750 Test Loss: 0.958 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749990).  Saving model ...
Epoch: 25 cost time: 0.49564361572265625
Epoch: 25, Steps: 3 | Train Loss: 0.619 Vali Loss: 0.923 Vali Acc: 0.750 Test Loss: 0.923 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749991).  Saving model ...
Epoch: 26 cost time: 0.4578685760498047
Epoch: 26, Steps: 3 | Train Loss: 0.614 Vali Loss: 0.885 Vali Acc: 0.750 Test Loss: 0.885 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 27 cost time: 0.5120680332183838
Epoch: 27, Steps: 3 | Train Loss: 0.585 Vali Loss: 0.847 Vali Acc: 0.750 Test Loss: 0.847 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 28 cost time: 0.5407228469848633
Epoch: 28, Steps: 3 | Train Loss: 0.507 Vali Loss: 0.806 Vali Acc: 0.800 Test Loss: 0.806 Test Acc: 0.800
Validation loss decreased (-0.749992 --> -0.799992).  Saving model ...
Epoch: 29 cost time: 0.5048751831054688
Epoch: 29, Steps: 3 | Train Loss: 0.487 Vali Loss: 0.763 Vali Acc: 0.850 Test Loss: 0.763 Test Acc: 0.850
Validation loss decreased (-0.799992 --> -0.849992).  Saving model ...
Epoch: 30 cost time: 0.5850863456726074
Epoch: 30, Steps: 3 | Train Loss: 0.518 Vali Loss: 0.719 Vali Acc: 0.875 Test Loss: 0.719 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874993).  Saving model ...
Epoch: 31 cost time: 0.6090884208679199
Epoch: 31, Steps: 3 | Train Loss: 0.467 Vali Loss: 0.678 Vali Acc: 0.900 Test Loss: 0.678 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899993).  Saving model ...
Epoch: 32 cost time: 0.5401079654693604
Epoch: 32, Steps: 3 | Train Loss: 0.443 Vali Loss: 0.633 Vali Acc: 0.900 Test Loss: 0.633 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 33 cost time: 0.5079531669616699
Epoch: 33, Steps: 3 | Train Loss: 0.396 Vali Loss: 0.588 Vali Acc: 0.900 Test Loss: 0.588 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 34 cost time: 0.5702242851257324
Epoch: 34, Steps: 3 | Train Loss: 0.363 Vali Loss: 0.544 Vali Acc: 0.925 Test Loss: 0.544 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924995).  Saving model ...
Epoch: 35 cost time: 0.5671751499176025
Epoch: 35, Steps: 3 | Train Loss: 0.346 Vali Loss: 0.502 Vali Acc: 0.925 Test Loss: 0.502 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 36 cost time: 0.47647833824157715
Epoch: 36, Steps: 3 | Train Loss: 0.295 Vali Loss: 0.460 Vali Acc: 0.925 Test Loss: 0.460 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 37 cost time: 0.5555229187011719
Epoch: 37, Steps: 3 | Train Loss: 0.292 Vali Loss: 0.421 Vali Acc: 0.925 Test Loss: 0.421 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 38 cost time: 0.6103370189666748
Epoch: 38, Steps: 3 | Train Loss: 0.276 Vali Loss: 0.386 Vali Acc: 0.925 Test Loss: 0.386 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 39 cost time: 0.4861643314361572
Epoch: 39, Steps: 3 | Train Loss: 0.277 Vali Loss: 0.350 Vali Acc: 0.950 Test Loss: 0.350 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 40 cost time: 0.5003292560577393
Epoch: 40, Steps: 3 | Train Loss: 0.265 Vali Loss: 0.317 Vali Acc: 0.950 Test Loss: 0.317 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 41 cost time: 0.5975008010864258
Epoch: 41, Steps: 3 | Train Loss: 0.209 Vali Loss: 0.285 Vali Acc: 0.975 Test Loss: 0.285 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974997).  Saving model ...
Epoch: 42 cost time: 0.49488258361816406
Epoch: 42, Steps: 3 | Train Loss: 0.228 Vali Loss: 0.255 Vali Acc: 0.975 Test Loss: 0.255 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 43 cost time: 0.5496909618377686
Epoch: 43, Steps: 3 | Train Loss: 0.179 Vali Loss: 0.226 Vali Acc: 0.975 Test Loss: 0.226 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 44 cost time: 0.5562078952789307
Epoch: 44, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.202 Vali Acc: 1.000 Test Loss: 0.202 Test Acc: 1.000
Validation loss decreased (-0.974998 --> -0.999998).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm256_cs20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 43502
model size : 0.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm256_cs17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.840484380722046
Epoch: 1, Steps: 3 | Train Loss: 1.389 Vali Loss: 1.372 Vali Acc: 0.300 Test Loss: 1.372 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.5730006694793701
Epoch: 2, Steps: 3 | Train Loss: 1.351 Vali Loss: 1.364 Vali Acc: 0.375 Test Loss: 1.364 Test Acc: 0.375
Validation loss decreased (-0.299986 --> -0.374986).  Saving model ...
Epoch: 3 cost time: 0.4670846462249756
Epoch: 3, Steps: 3 | Train Loss: 1.327 Vali Loss: 1.359 Vali Acc: 0.400 Test Loss: 1.359 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399986).  Saving model ...
Epoch: 4 cost time: 0.5012338161468506
Epoch: 4, Steps: 3 | Train Loss: 1.321 Vali Loss: 1.351 Vali Acc: 0.425 Test Loss: 1.351 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424986).  Saving model ...
Epoch: 5 cost time: 0.4112532138824463
Epoch: 5, Steps: 3 | Train Loss: 1.314 Vali Loss: 1.342 Vali Acc: 0.475 Test Loss: 1.342 Test Acc: 0.475
Validation loss decreased (-0.424986 --> -0.474987).  Saving model ...
Epoch: 6 cost time: 0.43062710762023926
Epoch: 6, Steps: 3 | Train Loss: 1.268 Vali Loss: 1.330 Vali Acc: 0.500 Test Loss: 1.330 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499987).  Saving model ...
Epoch: 7 cost time: 0.5598089694976807
Epoch: 7, Steps: 3 | Train Loss: 1.244 Vali Loss: 1.317 Vali Acc: 0.525 Test Loss: 1.317 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524987).  Saving model ...
Epoch: 8 cost time: 0.5017380714416504
Epoch: 8, Steps: 3 | Train Loss: 1.205 Vali Loss: 1.303 Vali Acc: 0.500 Test Loss: 1.303 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.44258975982666016
Epoch: 9, Steps: 3 | Train Loss: 1.190 Vali Loss: 1.288 Vali Acc: 0.450 Test Loss: 1.288 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5242774486541748
Epoch: 10, Steps: 3 | Train Loss: 1.160 Vali Loss: 1.273 Vali Acc: 0.425 Test Loss: 1.273 Test Acc: 0.425
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.43606066703796387
Epoch: 11, Steps: 3 | Train Loss: 1.125 Vali Loss: 1.258 Vali Acc: 0.425 Test Loss: 1.258 Test Acc: 0.425
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.5161490440368652
Epoch: 12, Steps: 3 | Train Loss: 1.095 Vali Loss: 1.243 Vali Acc: 0.425 Test Loss: 1.243 Test Acc: 0.425
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.4919772148132324
Epoch: 13, Steps: 3 | Train Loss: 1.057 Vali Loss: 1.229 Vali Acc: 0.450 Test Loss: 1.229 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.5052895545959473
Epoch: 14, Steps: 3 | Train Loss: 1.040 Vali Loss: 1.213 Vali Acc: 0.425 Test Loss: 1.213 Test Acc: 0.425
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.5507867336273193
Epoch: 15, Steps: 3 | Train Loss: 0.963 Vali Loss: 1.198 Vali Acc: 0.450 Test Loss: 1.198 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.652860164642334
Epoch: 16, Steps: 3 | Train Loss: 0.972 Vali Loss: 1.183 Vali Acc: 0.500 Test Loss: 1.183 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.49428534507751465
Epoch: 17, Steps: 3 | Train Loss: 0.920 Vali Loss: 1.166 Vali Acc: 0.500 Test Loss: 1.166 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm256_cs17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.525
model parameter : 43344
model size : 0.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm256_cs15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6181702613830566
Epoch: 1, Steps: 3 | Train Loss: 1.395 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.5289475917816162
Epoch: 2, Steps: 3 | Train Loss: 1.382 Vali Loss: 1.379 Vali Acc: 0.325 Test Loss: 1.379 Test Acc: 0.325
Validation loss decreased (-0.249986 --> -0.324986).  Saving model ...
Epoch: 3 cost time: 0.5624260902404785
Epoch: 3, Steps: 3 | Train Loss: 1.370 Vali Loss: 1.372 Vali Acc: 0.400 Test Loss: 1.372 Test Acc: 0.400
Validation loss decreased (-0.324986 --> -0.399986).  Saving model ...
Epoch: 4 cost time: 0.4591200351715088
Epoch: 4, Steps: 3 | Train Loss: 1.358 Vali Loss: 1.363 Vali Acc: 0.400 Test Loss: 1.363 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399986).  Saving model ...
Epoch: 5 cost time: 0.575904130935669
Epoch: 5, Steps: 3 | Train Loss: 1.323 Vali Loss: 1.351 Vali Acc: 0.450 Test Loss: 1.351 Test Acc: 0.450
Validation loss decreased (-0.399986 --> -0.449986).  Saving model ...
Epoch: 6 cost time: 0.4688246250152588
Epoch: 6, Steps: 3 | Train Loss: 1.299 Vali Loss: 1.338 Vali Acc: 0.475 Test Loss: 1.338 Test Acc: 0.475
Validation loss decreased (-0.449986 --> -0.474987).  Saving model ...
Epoch: 7 cost time: 0.46159911155700684
Epoch: 7, Steps: 3 | Train Loss: 1.268 Vali Loss: 1.324 Vali Acc: 0.500 Test Loss: 1.324 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499987).  Saving model ...
Epoch: 8 cost time: 0.5495538711547852
Epoch: 8, Steps: 3 | Train Loss: 1.245 Vali Loss: 1.309 Vali Acc: 0.525 Test Loss: 1.309 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524987).  Saving model ...
Epoch: 9 cost time: 0.4180729389190674
Epoch: 9, Steps: 3 | Train Loss: 1.206 Vali Loss: 1.292 Vali Acc: 0.525 Test Loss: 1.292 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524987).  Saving model ...
Epoch: 10 cost time: 0.5164670944213867
Epoch: 10, Steps: 3 | Train Loss: 1.169 Vali Loss: 1.276 Vali Acc: 0.525 Test Loss: 1.276 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524987).  Saving model ...
Epoch: 11 cost time: 0.522733211517334
Epoch: 11, Steps: 3 | Train Loss: 1.168 Vali Loss: 1.259 Vali Acc: 0.575 Test Loss: 1.259 Test Acc: 0.575
Validation loss decreased (-0.524987 --> -0.574987).  Saving model ...
Epoch: 12 cost time: 0.5987303256988525
Epoch: 12, Steps: 3 | Train Loss: 1.128 Vali Loss: 1.240 Vali Acc: 0.575 Test Loss: 1.240 Test Acc: 0.575
Validation loss decreased (-0.574987 --> -0.574988).  Saving model ...
Epoch: 13 cost time: 0.5515375137329102
Epoch: 13, Steps: 3 | Train Loss: 1.101 Vali Loss: 1.220 Vali Acc: 0.575 Test Loss: 1.220 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 14 cost time: 0.6109256744384766
Epoch: 14, Steps: 3 | Train Loss: 1.036 Vali Loss: 1.200 Vali Acc: 0.600 Test Loss: 1.200 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599988).  Saving model ...
Epoch: 15 cost time: 0.54638671875
Epoch: 15, Steps: 3 | Train Loss: 1.047 Vali Loss: 1.179 Vali Acc: 0.600 Test Loss: 1.179 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 16 cost time: 0.5388278961181641
Epoch: 16, Steps: 3 | Train Loss: 0.951 Vali Loss: 1.157 Vali Acc: 0.625 Test Loss: 1.157 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624988).  Saving model ...
Epoch: 17 cost time: 0.6129169464111328
Epoch: 17, Steps: 3 | Train Loss: 0.935 Vali Loss: 1.134 Vali Acc: 0.625 Test Loss: 1.134 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624989).  Saving model ...
Epoch: 18 cost time: 0.5620498657226562
Epoch: 18, Steps: 3 | Train Loss: 0.946 Vali Loss: 1.112 Vali Acc: 0.600 Test Loss: 1.112 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5051717758178711
Epoch: 19, Steps: 3 | Train Loss: 0.890 Vali Loss: 1.089 Vali Acc: 0.625 Test Loss: 1.089 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 20 cost time: 0.6203370094299316
Epoch: 20, Steps: 3 | Train Loss: 0.851 Vali Loss: 1.066 Vali Acc: 0.675 Test Loss: 1.066 Test Acc: 0.675
Validation loss decreased (-0.624989 --> -0.674989).  Saving model ...
Epoch: 21 cost time: 0.5248870849609375
Epoch: 21, Steps: 3 | Train Loss: 0.802 Vali Loss: 1.042 Vali Acc: 0.700 Test Loss: 1.042 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699990).  Saving model ...
Epoch: 22 cost time: 0.38812875747680664
Epoch: 22, Steps: 3 | Train Loss: 0.786 Vali Loss: 1.017 Vali Acc: 0.700 Test Loss: 1.017 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 23 cost time: 0.47620129585266113
Epoch: 23, Steps: 3 | Train Loss: 0.741 Vali Loss: 0.992 Vali Acc: 0.725 Test Loss: 0.992 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724990).  Saving model ...
Epoch: 24 cost time: 0.591867208480835
Epoch: 24, Steps: 3 | Train Loss: 0.706 Vali Loss: 0.966 Vali Acc: 0.750 Test Loss: 0.966 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749990).  Saving model ...
Epoch: 25 cost time: 0.5907819271087646
Epoch: 25, Steps: 3 | Train Loss: 0.730 Vali Loss: 0.940 Vali Acc: 0.750 Test Loss: 0.940 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749991).  Saving model ...
Epoch: 26 cost time: 0.4832890033721924
Epoch: 26, Steps: 3 | Train Loss: 0.681 Vali Loss: 0.914 Vali Acc: 0.775 Test Loss: 0.914 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774991).  Saving model ...
Epoch: 27 cost time: 0.5436267852783203
Epoch: 27, Steps: 3 | Train Loss: 0.651 Vali Loss: 0.889 Vali Acc: 0.800 Test Loss: 0.889 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799991).  Saving model ...
Epoch: 28 cost time: 0.4839820861816406
Epoch: 28, Steps: 3 | Train Loss: 0.613 Vali Loss: 0.860 Vali Acc: 0.825 Test Loss: 0.860 Test Acc: 0.825
Validation loss decreased (-0.799991 --> -0.824991).  Saving model ...
Epoch: 29 cost time: 0.575908899307251
Epoch: 29, Steps: 3 | Train Loss: 0.573 Vali Loss: 0.833 Vali Acc: 0.900 Test Loss: 0.833 Test Acc: 0.900
Validation loss decreased (-0.824991 --> -0.899992).  Saving model ...
Epoch: 30 cost time: 0.5043129920959473
Epoch: 30, Steps: 3 | Train Loss: 0.548 Vali Loss: 0.802 Vali Acc: 0.875 Test Loss: 0.802 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.620537281036377
Epoch: 31, Steps: 3 | Train Loss: 0.529 Vali Loss: 0.769 Vali Acc: 0.900 Test Loss: 0.769 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899992).  Saving model ...
Epoch: 32 cost time: 0.43471837043762207
Epoch: 32, Steps: 3 | Train Loss: 0.533 Vali Loss: 0.736 Vali Acc: 0.875 Test Loss: 0.736 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5122089385986328
Epoch: 33, Steps: 3 | Train Loss: 0.500 Vali Loss: 0.705 Vali Acc: 0.875 Test Loss: 0.705 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.503962516784668
Epoch: 34, Steps: 3 | Train Loss: 0.465 Vali Loss: 0.672 Vali Acc: 0.900 Test Loss: 0.672 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899993).  Saving model ...
Epoch: 35 cost time: 0.6413352489471436
Epoch: 35, Steps: 3 | Train Loss: 0.421 Vali Loss: 0.640 Vali Acc: 0.900 Test Loss: 0.640 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 36 cost time: 0.5060513019561768
Epoch: 36, Steps: 3 | Train Loss: 0.431 Vali Loss: 0.606 Vali Acc: 0.900 Test Loss: 0.606 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 37 cost time: 0.49495840072631836
Epoch: 37, Steps: 3 | Train Loss: 0.376 Vali Loss: 0.572 Vali Acc: 0.900 Test Loss: 0.572 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 38 cost time: 0.5516858100891113
Epoch: 38, Steps: 3 | Train Loss: 0.353 Vali Loss: 0.536 Vali Acc: 0.900 Test Loss: 0.536 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 39 cost time: 0.5979583263397217
Epoch: 39, Steps: 3 | Train Loss: 0.357 Vali Loss: 0.498 Vali Acc: 0.900 Test Loss: 0.498 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 40 cost time: 0.5390980243682861
Epoch: 40, Steps: 3 | Train Loss: 0.351 Vali Loss: 0.464 Vali Acc: 0.925 Test Loss: 0.464 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924995).  Saving model ...
Epoch: 41 cost time: 0.5587952136993408
Epoch: 41, Steps: 3 | Train Loss: 0.280 Vali Loss: 0.433 Vali Acc: 0.925 Test Loss: 0.433 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 42 cost time: 0.48882436752319336
Epoch: 42, Steps: 3 | Train Loss: 0.275 Vali Loss: 0.402 Vali Acc: 0.925 Test Loss: 0.402 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 43 cost time: 0.48369503021240234
Epoch: 43, Steps: 3 | Train Loss: 0.238 Vali Loss: 0.372 Vali Acc: 0.925 Test Loss: 0.372 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 44 cost time: 0.5057709217071533
Epoch: 44, Steps: 3 | Train Loss: 0.234 Vali Loss: 0.345 Vali Acc: 0.925 Test Loss: 0.345 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 45 cost time: 0.5739989280700684
Epoch: 45, Steps: 3 | Train Loss: 0.221 Vali Loss: 0.317 Vali Acc: 0.925 Test Loss: 0.317 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 46 cost time: 0.5439362525939941
Epoch: 46, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.293 Vali Acc: 0.925 Test Loss: 0.293 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 47 cost time: 0.5148799419403076
Epoch: 47, Steps: 3 | Train Loss: 0.177 Vali Loss: 0.266 Vali Acc: 0.950 Test Loss: 0.266 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 48 cost time: 0.537384033203125
Epoch: 48, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.239 Vali Acc: 0.950 Test Loss: 0.239 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 49 cost time: 0.5851719379425049
Epoch: 49, Steps: 3 | Train Loss: 0.152 Vali Loss: 0.213 Vali Acc: 0.950 Test Loss: 0.213 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 50 cost time: 0.4883084297180176
Epoch: 50, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.188 Vali Acc: 0.950 Test Loss: 0.188 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 51 cost time: 0.520413875579834
Epoch: 51, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.161 Vali Acc: 0.950 Test Loss: 0.161 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 52 cost time: 0.5570998191833496
Epoch: 52, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.137 Vali Acc: 0.950 Test Loss: 0.137 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949999).  Saving model ...
Epoch: 53 cost time: 0.48921704292297363
Epoch: 53, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.115 Vali Acc: 0.975 Test Loss: 0.115 Test Acc: 0.975
Validation loss decreased (-0.949999 --> -0.974999).  Saving model ...
Epoch: 54 cost time: 0.563363790512085
Epoch: 54, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.094 Vali Acc: 1.000 Test Loss: 0.094 Test Acc: 1.000
Validation loss decreased (-0.974999 --> -0.999999).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm256_cs15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 43418
model size : 0.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm256_cs13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.913015365600586
Epoch: 1, Steps: 3 | Train Loss: 1.416 Vali Loss: 1.568 Vali Acc: 0.100 Test Loss: 1.568 Test Acc: 0.100
Validation loss decreased (inf --> -0.099984).  Saving model ...
Epoch: 2 cost time: 0.5861289501190186
Epoch: 2, Steps: 3 | Train Loss: 1.411 Vali Loss: 1.561 Vali Acc: 0.100 Test Loss: 1.561 Test Acc: 0.100
Validation loss decreased (-0.099984 --> -0.099984).  Saving model ...
Epoch: 3 cost time: 0.5946521759033203
Epoch: 3, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.554 Vali Acc: 0.100 Test Loss: 1.554 Test Acc: 0.100
Validation loss decreased (-0.099984 --> -0.099984).  Saving model ...
Epoch: 4 cost time: 0.538177490234375
Epoch: 4, Steps: 3 | Train Loss: 1.374 Vali Loss: 1.546 Vali Acc: 0.125 Test Loss: 1.546 Test Acc: 0.125
Validation loss decreased (-0.099984 --> -0.124985).  Saving model ...
Epoch: 5 cost time: 0.5614824295043945
Epoch: 5, Steps: 3 | Train Loss: 1.345 Vali Loss: 1.536 Vali Acc: 0.150 Test Loss: 1.536 Test Acc: 0.150
Validation loss decreased (-0.124985 --> -0.149985).  Saving model ...
Epoch: 6 cost time: 0.5164873600006104
Epoch: 6, Steps: 3 | Train Loss: 1.325 Vali Loss: 1.524 Vali Acc: 0.150 Test Loss: 1.524 Test Acc: 0.150
Validation loss decreased (-0.149985 --> -0.149985).  Saving model ...
Epoch: 7 cost time: 0.49190735816955566
Epoch: 7, Steps: 3 | Train Loss: 1.295 Vali Loss: 1.511 Vali Acc: 0.175 Test Loss: 1.511 Test Acc: 0.175
Validation loss decreased (-0.149985 --> -0.174985).  Saving model ...
Epoch: 8 cost time: 0.5946352481842041
Epoch: 8, Steps: 3 | Train Loss: 1.268 Vali Loss: 1.497 Vali Acc: 0.200 Test Loss: 1.497 Test Acc: 0.200
Validation loss decreased (-0.174985 --> -0.199985).  Saving model ...
Epoch: 9 cost time: 0.5333297252655029
Epoch: 9, Steps: 3 | Train Loss: 1.245 Vali Loss: 1.484 Vali Acc: 0.225 Test Loss: 1.484 Test Acc: 0.225
Validation loss decreased (-0.199985 --> -0.224985).  Saving model ...
Epoch: 10 cost time: 0.5207602977752686
Epoch: 10, Steps: 3 | Train Loss: 1.209 Vali Loss: 1.467 Vali Acc: 0.275 Test Loss: 1.467 Test Acc: 0.275
Validation loss decreased (-0.224985 --> -0.274985).  Saving model ...
Epoch: 11 cost time: 0.5377283096313477
Epoch: 11, Steps: 3 | Train Loss: 1.147 Vali Loss: 1.451 Vali Acc: 0.300 Test Loss: 1.451 Test Acc: 0.300
Validation loss decreased (-0.274985 --> -0.299985).  Saving model ...
Epoch: 12 cost time: 0.6146020889282227
Epoch: 12, Steps: 3 | Train Loss: 1.163 Vali Loss: 1.433 Vali Acc: 0.300 Test Loss: 1.433 Test Acc: 0.300
Validation loss decreased (-0.299985 --> -0.299986).  Saving model ...
Epoch: 13 cost time: 0.43136167526245117
Epoch: 13, Steps: 3 | Train Loss: 1.116 Vali Loss: 1.417 Vali Acc: 0.325 Test Loss: 1.417 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324986).  Saving model ...
Epoch: 14 cost time: 0.5935204029083252
Epoch: 14, Steps: 3 | Train Loss: 1.087 Vali Loss: 1.398 Vali Acc: 0.325 Test Loss: 1.398 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324986).  Saving model ...
Epoch: 15 cost time: 0.6124303340911865
Epoch: 15, Steps: 3 | Train Loss: 1.012 Vali Loss: 1.380 Vali Acc: 0.350 Test Loss: 1.380 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349986).  Saving model ...
Epoch: 16 cost time: 0.569455623626709
Epoch: 16, Steps: 3 | Train Loss: 1.006 Vali Loss: 1.361 Vali Acc: 0.350 Test Loss: 1.361 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 17 cost time: 0.5267579555511475
Epoch: 17, Steps: 3 | Train Loss: 0.949 Vali Loss: 1.341 Vali Acc: 0.350 Test Loss: 1.341 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349987).  Saving model ...
Epoch: 18 cost time: 0.49070024490356445
Epoch: 18, Steps: 3 | Train Loss: 0.952 Vali Loss: 1.321 Vali Acc: 0.375 Test Loss: 1.321 Test Acc: 0.375
Validation loss decreased (-0.349987 --> -0.374987).  Saving model ...
Epoch: 19 cost time: 0.5294814109802246
Epoch: 19, Steps: 3 | Train Loss: 0.909 Vali Loss: 1.300 Vali Acc: 0.375 Test Loss: 1.300 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 20 cost time: 0.4732961654663086
Epoch: 20, Steps: 3 | Train Loss: 0.838 Vali Loss: 1.278 Vali Acc: 0.375 Test Loss: 1.278 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 21 cost time: 0.546635627746582
Epoch: 21, Steps: 3 | Train Loss: 0.821 Vali Loss: 1.255 Vali Acc: 0.375 Test Loss: 1.255 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 22 cost time: 0.493091344833374
Epoch: 22, Steps: 3 | Train Loss: 0.766 Vali Loss: 1.232 Vali Acc: 0.400 Test Loss: 1.232 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399988).  Saving model ...
Epoch: 23 cost time: 0.5100462436676025
Epoch: 23, Steps: 3 | Train Loss: 0.744 Vali Loss: 1.209 Vali Acc: 0.400 Test Loss: 1.209 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 24 cost time: 0.5578000545501709
Epoch: 24, Steps: 3 | Train Loss: 0.730 Vali Loss: 1.186 Vali Acc: 0.500 Test Loss: 1.186 Test Acc: 0.500
Validation loss decreased (-0.399988 --> -0.499988).  Saving model ...
Epoch: 25 cost time: 0.5559701919555664
Epoch: 25, Steps: 3 | Train Loss: 0.714 Vali Loss: 1.164 Vali Acc: 0.525 Test Loss: 1.164 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 26 cost time: 0.5093531608581543
Epoch: 26, Steps: 3 | Train Loss: 0.693 Vali Loss: 1.141 Vali Acc: 0.525 Test Loss: 1.141 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524989).  Saving model ...
Epoch: 27 cost time: 0.5513327121734619
Epoch: 27, Steps: 3 | Train Loss: 0.642 Vali Loss: 1.117 Vali Acc: 0.550 Test Loss: 1.117 Test Acc: 0.550
Validation loss decreased (-0.524989 --> -0.549989).  Saving model ...
Epoch: 28 cost time: 0.6096336841583252
Epoch: 28, Steps: 3 | Train Loss: 0.599 Vali Loss: 1.094 Vali Acc: 0.550 Test Loss: 1.094 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 29 cost time: 0.5100526809692383
Epoch: 29, Steps: 3 | Train Loss: 0.627 Vali Loss: 1.072 Vali Acc: 0.550 Test Loss: 1.072 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 30 cost time: 0.5536549091339111
Epoch: 30, Steps: 3 | Train Loss: 0.568 Vali Loss: 1.051 Vali Acc: 0.550 Test Loss: 1.051 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 31 cost time: 0.6565885543823242
Epoch: 31, Steps: 3 | Train Loss: 0.521 Vali Loss: 1.029 Vali Acc: 0.575 Test Loss: 1.029 Test Acc: 0.575
Validation loss decreased (-0.549989 --> -0.574990).  Saving model ...
Epoch: 32 cost time: 0.5079882144927979
Epoch: 32, Steps: 3 | Train Loss: 0.523 Vali Loss: 1.004 Vali Acc: 0.650 Test Loss: 1.004 Test Acc: 0.650
Validation loss decreased (-0.574990 --> -0.649990).  Saving model ...
Epoch: 33 cost time: 0.567540168762207
Epoch: 33, Steps: 3 | Train Loss: 0.465 Vali Loss: 0.978 Vali Acc: 0.700 Test Loss: 0.978 Test Acc: 0.700
Validation loss decreased (-0.649990 --> -0.699990).  Saving model ...
Epoch: 34 cost time: 0.4540379047393799
Epoch: 34, Steps: 3 | Train Loss: 0.468 Vali Loss: 0.952 Vali Acc: 0.725 Test Loss: 0.952 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724990).  Saving model ...
Epoch: 35 cost time: 0.49698328971862793
Epoch: 35, Steps: 3 | Train Loss: 0.446 Vali Loss: 0.925 Vali Acc: 0.750 Test Loss: 0.925 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749991).  Saving model ...
Epoch: 36 cost time: 0.5677258968353271
Epoch: 36, Steps: 3 | Train Loss: 0.384 Vali Loss: 0.899 Vali Acc: 0.775 Test Loss: 0.899 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774991).  Saving model ...
Epoch: 37 cost time: 0.5102691650390625
Epoch: 37, Steps: 3 | Train Loss: 0.404 Vali Loss: 0.869 Vali Acc: 0.775 Test Loss: 0.869 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 38 cost time: 0.5524277687072754
Epoch: 38, Steps: 3 | Train Loss: 0.347 Vali Loss: 0.836 Vali Acc: 0.775 Test Loss: 0.836 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774992).  Saving model ...
Epoch: 39 cost time: 0.4861416816711426
Epoch: 39, Steps: 3 | Train Loss: 0.322 Vali Loss: 0.800 Vali Acc: 0.775 Test Loss: 0.800 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 40 cost time: 0.5068886280059814
Epoch: 40, Steps: 3 | Train Loss: 0.345 Vali Loss: 0.762 Vali Acc: 0.775 Test Loss: 0.762 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 41 cost time: 0.4334876537322998
Epoch: 41, Steps: 3 | Train Loss: 0.314 Vali Loss: 0.729 Vali Acc: 0.775 Test Loss: 0.729 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774993).  Saving model ...
Epoch: 42 cost time: 0.7345726490020752
Epoch: 42, Steps: 3 | Train Loss: 0.307 Vali Loss: 0.695 Vali Acc: 0.825 Test Loss: 0.695 Test Acc: 0.825
Validation loss decreased (-0.774993 --> -0.824993).  Saving model ...
Epoch: 43 cost time: 0.5445373058319092
Epoch: 43, Steps: 3 | Train Loss: 0.266 Vali Loss: 0.665 Vali Acc: 0.825 Test Loss: 0.665 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 44 cost time: 0.6115577220916748
Epoch: 44, Steps: 3 | Train Loss: 0.227 Vali Loss: 0.636 Vali Acc: 0.825 Test Loss: 0.636 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824994).  Saving model ...
Epoch: 45 cost time: 0.4947190284729004
Epoch: 45, Steps: 3 | Train Loss: 0.257 Vali Loss: 0.601 Vali Acc: 0.825 Test Loss: 0.601 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 46 cost time: 0.48030567169189453
Epoch: 46, Steps: 3 | Train Loss: 0.201 Vali Loss: 0.566 Vali Acc: 0.850 Test Loss: 0.566 Test Acc: 0.850
Validation loss decreased (-0.824994 --> -0.849994).  Saving model ...
Epoch: 47 cost time: 0.4570329189300537
Epoch: 47, Steps: 3 | Train Loss: 0.239 Vali Loss: 0.525 Vali Acc: 0.850 Test Loss: 0.525 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 48 cost time: 0.45074939727783203
Epoch: 48, Steps: 3 | Train Loss: 0.182 Vali Loss: 0.479 Vali Acc: 0.850 Test Loss: 0.479 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 49 cost time: 0.4813265800476074
Epoch: 49, Steps: 3 | Train Loss: 0.213 Vali Loss: 0.435 Vali Acc: 0.875 Test Loss: 0.435 Test Acc: 0.875
Validation loss decreased (-0.849995 --> -0.874996).  Saving model ...
Epoch: 50 cost time: 0.5251893997192383
Epoch: 50, Steps: 3 | Train Loss: 0.174 Vali Loss: 0.388 Vali Acc: 0.875 Test Loss: 0.388 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 51 cost time: 0.5246455669403076
Epoch: 51, Steps: 3 | Train Loss: 0.133 Vali Loss: 0.345 Vali Acc: 0.950 Test Loss: 0.345 Test Acc: 0.950
Validation loss decreased (-0.874996 --> -0.949997).  Saving model ...
Epoch: 52 cost time: 0.4789566993713379
Epoch: 52, Steps: 3 | Train Loss: 0.163 Vali Loss: 0.306 Vali Acc: 0.950 Test Loss: 0.306 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 53 cost time: 0.5686089992523193
Epoch: 53, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.268 Vali Acc: 0.950 Test Loss: 0.268 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 54 cost time: 0.565744161605835
Epoch: 54, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.235 Vali Acc: 0.950 Test Loss: 0.235 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 55 cost time: 0.5639979839324951
Epoch: 55, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.205 Vali Acc: 0.950 Test Loss: 0.205 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 56 cost time: 0.5659501552581787
Epoch: 56, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.171 Vali Acc: 0.950 Test Loss: 0.171 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 57 cost time: 0.620521068572998
Epoch: 57, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.140 Vali Acc: 0.975 Test Loss: 0.140 Test Acc: 0.975
Validation loss decreased (-0.949998 --> -0.974999).  Saving model ...
Epoch: 58 cost time: 0.5188319683074951
Epoch: 58, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.119 Vali Acc: 0.975 Test Loss: 0.119 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 59 cost time: 0.4957618713378906
Epoch: 59, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.100 Vali Acc: 0.975 Test Loss: 0.100 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 60 cost time: 0.5908684730529785
Epoch: 60, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.085 Vali Acc: 0.975 Test Loss: 0.085 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 61 cost time: 0.4907412528991699
Epoch: 61, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.073 Vali Acc: 0.975 Test Loss: 0.073 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 62 cost time: 0.4812791347503662
Epoch: 62, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.066 Vali Acc: 0.975 Test Loss: 0.066 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 63 cost time: 0.600039005279541
Epoch: 63, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.059 Vali Acc: 0.975 Test Loss: 0.059 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 64 cost time: 0.5308949947357178
Epoch: 64, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.054 Vali Acc: 0.975 Test Loss: 0.054 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 65 cost time: 0.4893324375152588
Epoch: 65, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.048 Vali Acc: 1.000 Test Loss: 0.048 Test Acc: 1.000
Validation loss decreased (-0.974999 --> -1.000000).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm256_cs13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 43096
model size : 0.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm256_cs12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6972439289093018
Epoch: 1, Steps: 3 | Train Loss: 1.444 Vali Loss: 1.481 Vali Acc: 0.175 Test Loss: 1.481 Test Acc: 0.175
Validation loss decreased (inf --> -0.174985).  Saving model ...
Epoch: 2 cost time: 0.46477198600769043
Epoch: 2, Steps: 3 | Train Loss: 1.368 Vali Loss: 1.473 Vali Acc: 0.200 Test Loss: 1.473 Test Acc: 0.200
Validation loss decreased (-0.174985 --> -0.199985).  Saving model ...
Epoch: 3 cost time: 0.752802848815918
Epoch: 3, Steps: 3 | Train Loss: 1.369 Vali Loss: 1.465 Vali Acc: 0.200 Test Loss: 1.465 Test Acc: 0.200
Validation loss decreased (-0.199985 --> -0.199985).  Saving model ...
Epoch: 4 cost time: 0.5504367351531982
Epoch: 4, Steps: 3 | Train Loss: 1.362 Vali Loss: 1.456 Vali Acc: 0.200 Test Loss: 1.456 Test Acc: 0.200
Validation loss decreased (-0.199985 --> -0.199985).  Saving model ...
Epoch: 5 cost time: 0.5464251041412354
Epoch: 5, Steps: 3 | Train Loss: 1.324 Vali Loss: 1.444 Vali Acc: 0.200 Test Loss: 1.444 Test Acc: 0.200
Validation loss decreased (-0.199985 --> -0.199986).  Saving model ...
Epoch: 6 cost time: 0.4657630920410156
Epoch: 6, Steps: 3 | Train Loss: 1.314 Vali Loss: 1.429 Vali Acc: 0.200 Test Loss: 1.429 Test Acc: 0.200
Validation loss decreased (-0.199986 --> -0.199986).  Saving model ...
Epoch: 7 cost time: 0.5711052417755127
Epoch: 7, Steps: 3 | Train Loss: 1.265 Vali Loss: 1.416 Vali Acc: 0.200 Test Loss: 1.416 Test Acc: 0.200
Validation loss decreased (-0.199986 --> -0.199986).  Saving model ...
Epoch: 8 cost time: 0.47083449363708496
Epoch: 8, Steps: 3 | Train Loss: 1.236 Vali Loss: 1.401 Vali Acc: 0.200 Test Loss: 1.401 Test Acc: 0.200
Validation loss decreased (-0.199986 --> -0.199986).  Saving model ...
Epoch: 9 cost time: 0.5044705867767334
Epoch: 9, Steps: 3 | Train Loss: 1.195 Vali Loss: 1.385 Vali Acc: 0.225 Test Loss: 1.385 Test Acc: 0.225
Validation loss decreased (-0.199986 --> -0.224986).  Saving model ...
Epoch: 10 cost time: 0.3772735595703125
Epoch: 10, Steps: 3 | Train Loss: 1.181 Vali Loss: 1.368 Vali Acc: 0.300 Test Loss: 1.368 Test Acc: 0.300
Validation loss decreased (-0.224986 --> -0.299986).  Saving model ...
Epoch: 11 cost time: 0.5072817802429199
Epoch: 11, Steps: 3 | Train Loss: 1.129 Vali Loss: 1.350 Vali Acc: 0.300 Test Loss: 1.350 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299987).  Saving model ...
Epoch: 12 cost time: 0.4893620014190674
Epoch: 12, Steps: 3 | Train Loss: 1.115 Vali Loss: 1.332 Vali Acc: 0.300 Test Loss: 1.332 Test Acc: 0.300
Validation loss decreased (-0.299987 --> -0.299987).  Saving model ...
Epoch: 13 cost time: 0.399583101272583
Epoch: 13, Steps: 3 | Train Loss: 1.081 Vali Loss: 1.312 Vali Acc: 0.325 Test Loss: 1.312 Test Acc: 0.325
Validation loss decreased (-0.299987 --> -0.324987).  Saving model ...
Epoch: 14 cost time: 0.5097315311431885
Epoch: 14, Steps: 3 | Train Loss: 1.033 Vali Loss: 1.292 Vali Acc: 0.350 Test Loss: 1.292 Test Acc: 0.350
Validation loss decreased (-0.324987 --> -0.349987).  Saving model ...
Epoch: 15 cost time: 0.5357544422149658
Epoch: 15, Steps: 3 | Train Loss: 1.028 Vali Loss: 1.273 Vali Acc: 0.400 Test Loss: 1.273 Test Acc: 0.400
Validation loss decreased (-0.349987 --> -0.399987).  Saving model ...
Epoch: 16 cost time: 0.5960073471069336
Epoch: 16, Steps: 3 | Train Loss: 0.984 Vali Loss: 1.254 Vali Acc: 0.400 Test Loss: 1.254 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 17 cost time: 0.5516855716705322
Epoch: 17, Steps: 3 | Train Loss: 0.947 Vali Loss: 1.234 Vali Acc: 0.400 Test Loss: 1.234 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399988).  Saving model ...
Epoch: 18 cost time: 0.49889492988586426
Epoch: 18, Steps: 3 | Train Loss: 0.948 Vali Loss: 1.216 Vali Acc: 0.400 Test Loss: 1.216 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 19 cost time: 0.5997061729431152
Epoch: 19, Steps: 3 | Train Loss: 0.873 Vali Loss: 1.197 Vali Acc: 0.450 Test Loss: 1.197 Test Acc: 0.450
Validation loss decreased (-0.399988 --> -0.449988).  Saving model ...
Epoch: 20 cost time: 0.550440788269043
Epoch: 20, Steps: 3 | Train Loss: 0.806 Vali Loss: 1.176 Vali Acc: 0.450 Test Loss: 1.176 Test Acc: 0.450
Validation loss decreased (-0.449988 --> -0.449988).  Saving model ...
Epoch: 21 cost time: 0.5264341831207275
Epoch: 21, Steps: 3 | Train Loss: 0.829 Vali Loss: 1.155 Vali Acc: 0.475 Test Loss: 1.155 Test Acc: 0.475
Validation loss decreased (-0.449988 --> -0.474988).  Saving model ...
Epoch: 22 cost time: 0.5806732177734375
Epoch: 22, Steps: 3 | Train Loss: 0.820 Vali Loss: 1.135 Vali Acc: 0.500 Test Loss: 1.135 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499989).  Saving model ...
Epoch: 23 cost time: 0.5347471237182617
Epoch: 23, Steps: 3 | Train Loss: 0.787 Vali Loss: 1.115 Vali Acc: 0.500 Test Loss: 1.115 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 24 cost time: 0.5041382312774658
Epoch: 24, Steps: 3 | Train Loss: 0.751 Vali Loss: 1.092 Vali Acc: 0.500 Test Loss: 1.092 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 25 cost time: 0.5286819934844971
Epoch: 25, Steps: 3 | Train Loss: 0.740 Vali Loss: 1.069 Vali Acc: 0.500 Test Loss: 1.069 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 26 cost time: 0.5355372428894043
Epoch: 26, Steps: 3 | Train Loss: 0.681 Vali Loss: 1.042 Vali Acc: 0.550 Test Loss: 1.042 Test Acc: 0.550
Validation loss decreased (-0.499989 --> -0.549990).  Saving model ...
Epoch: 27 cost time: 0.5466718673706055
Epoch: 27, Steps: 3 | Train Loss: 0.671 Vali Loss: 1.015 Vali Acc: 0.650 Test Loss: 1.015 Test Acc: 0.650
Validation loss decreased (-0.549990 --> -0.649990).  Saving model ...
Epoch: 28 cost time: 0.5706357955932617
Epoch: 28, Steps: 3 | Train Loss: 0.642 Vali Loss: 0.988 Vali Acc: 0.750 Test Loss: 0.988 Test Acc: 0.750
Validation loss decreased (-0.649990 --> -0.749990).  Saving model ...
Epoch: 29 cost time: 0.4479539394378662
Epoch: 29, Steps: 3 | Train Loss: 0.625 Vali Loss: 0.960 Vali Acc: 0.800 Test Loss: 0.960 Test Acc: 0.800
Validation loss decreased (-0.749990 --> -0.799990).  Saving model ...
Epoch: 30 cost time: 0.4732532501220703
Epoch: 30, Steps: 3 | Train Loss: 0.587 Vali Loss: 0.931 Vali Acc: 0.800 Test Loss: 0.931 Test Acc: 0.800
Validation loss decreased (-0.799990 --> -0.799991).  Saving model ...
Epoch: 31 cost time: 0.6015300750732422
Epoch: 31, Steps: 3 | Train Loss: 0.598 Vali Loss: 0.901 Vali Acc: 0.800 Test Loss: 0.901 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 32 cost time: 0.5212030410766602
Epoch: 32, Steps: 3 | Train Loss: 0.531 Vali Loss: 0.869 Vali Acc: 0.800 Test Loss: 0.869 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 33 cost time: 0.48895716667175293
Epoch: 33, Steps: 3 | Train Loss: 0.506 Vali Loss: 0.834 Vali Acc: 0.825 Test Loss: 0.834 Test Acc: 0.825
Validation loss decreased (-0.799991 --> -0.824992).  Saving model ...
Epoch: 34 cost time: 0.47904086112976074
Epoch: 34, Steps: 3 | Train Loss: 0.494 Vali Loss: 0.792 Vali Acc: 0.875 Test Loss: 0.792 Test Acc: 0.875
Validation loss decreased (-0.824992 --> -0.874992).  Saving model ...
Epoch: 35 cost time: 0.5149178504943848
Epoch: 35, Steps: 3 | Train Loss: 0.436 Vali Loss: 0.746 Vali Acc: 0.850 Test Loss: 0.746 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.5540239810943604
Epoch: 36, Steps: 3 | Train Loss: 0.424 Vali Loss: 0.702 Vali Acc: 0.850 Test Loss: 0.702 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.44297003746032715
Epoch: 37, Steps: 3 | Train Loss: 0.379 Vali Loss: 0.658 Vali Acc: 0.850 Test Loss: 0.658 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.5515298843383789
Epoch: 38, Steps: 3 | Train Loss: 0.384 Vali Loss: 0.613 Vali Acc: 0.875 Test Loss: 0.613 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874994).  Saving model ...
Epoch: 39 cost time: 0.5242283344268799
Epoch: 39, Steps: 3 | Train Loss: 0.374 Vali Loss: 0.568 Vali Acc: 0.900 Test Loss: 0.568 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899994).  Saving model ...
Epoch: 40 cost time: 0.5332508087158203
Epoch: 40, Steps: 3 | Train Loss: 0.304 Vali Loss: 0.523 Vali Acc: 0.900 Test Loss: 0.523 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 41 cost time: 0.4393198490142822
Epoch: 41, Steps: 3 | Train Loss: 0.296 Vali Loss: 0.480 Vali Acc: 0.900 Test Loss: 0.480 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 42 cost time: 0.5961215496063232
Epoch: 42, Steps: 3 | Train Loss: 0.318 Vali Loss: 0.439 Vali Acc: 0.925 Test Loss: 0.439 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924996).  Saving model ...
Epoch: 43 cost time: 0.5091185569763184
Epoch: 43, Steps: 3 | Train Loss: 0.280 Vali Loss: 0.401 Vali Acc: 0.925 Test Loss: 0.401 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 44 cost time: 0.4629831314086914
Epoch: 44, Steps: 3 | Train Loss: 0.264 Vali Loss: 0.364 Vali Acc: 0.950 Test Loss: 0.364 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 45 cost time: 0.44629740715026855
Epoch: 45, Steps: 3 | Train Loss: 0.213 Vali Loss: 0.326 Vali Acc: 0.950 Test Loss: 0.326 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 46 cost time: 0.4877641201019287
Epoch: 46, Steps: 3 | Train Loss: 0.191 Vali Loss: 0.288 Vali Acc: 0.950 Test Loss: 0.288 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 47 cost time: 0.47164082527160645
Epoch: 47, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.255 Vali Acc: 0.950 Test Loss: 0.255 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 48 cost time: 0.6133022308349609
Epoch: 48, Steps: 3 | Train Loss: 0.128 Vali Loss: 0.218 Vali Acc: 0.950 Test Loss: 0.218 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 49 cost time: 0.5811483860015869
Epoch: 49, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.187 Vali Acc: 0.975 Test Loss: 0.187 Test Acc: 0.975
Validation loss decreased (-0.949998 --> -0.974998).  Saving model ...
Epoch: 50 cost time: 0.5028731822967529
Epoch: 50, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.161 Vali Acc: 0.975 Test Loss: 0.161 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 51 cost time: 0.48084402084350586
Epoch: 51, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.140 Vali Acc: 0.975 Test Loss: 0.140 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 52 cost time: 0.5773687362670898
Epoch: 52, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.121 Vali Acc: 0.975 Test Loss: 0.121 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 53 cost time: 0.7138361930847168
Epoch: 53, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.108 Vali Acc: 0.975 Test Loss: 0.108 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 54 cost time: 0.6001183986663818
Epoch: 54, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.098 Vali Acc: 0.975 Test Loss: 0.098 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 55 cost time: 0.5009369850158691
Epoch: 55, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.086 Vali Acc: 0.975 Test Loss: 0.086 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 56 cost time: 0.5171420574188232
Epoch: 56, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.078 Vali Acc: 0.975 Test Loss: 0.078 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 57 cost time: 0.4748702049255371
Epoch: 57, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.071 Vali Acc: 0.975 Test Loss: 0.071 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 58 cost time: 0.4539008140563965
Epoch: 58, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.066 Vali Acc: 0.975 Test Loss: 0.066 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 59 cost time: 0.5197033882141113
Epoch: 59, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.064 Vali Acc: 0.975 Test Loss: 0.064 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 60 cost time: 0.512700080871582
Epoch: 60, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.063 Vali Acc: 0.975 Test Loss: 0.063 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 61 cost time: 0.5257608890533447
Epoch: 61, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.064 Vali Acc: 0.975 Test Loss: 0.064 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.506340742111206
Epoch: 62, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.065 Vali Acc: 0.975 Test Loss: 0.065 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.5529005527496338
Epoch: 63, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.067 Vali Acc: 0.975 Test Loss: 0.067 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 0.7159478664398193
Epoch: 64, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.068 Vali Acc: 0.975 Test Loss: 0.068 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 0.6343214511871338
Epoch: 65, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.068 Vali Acc: 0.975 Test Loss: 0.068 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 0.5998189449310303
Epoch: 66, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.068 Vali Acc: 0.975 Test Loss: 0.068 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 0.6093430519104004
Epoch: 67, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.067 Vali Acc: 0.975 Test Loss: 0.067 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 0.5841825008392334
Epoch: 68, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.066 Vali Acc: 0.950 Test Loss: 0.066 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 69 cost time: 0.5384707450866699
Epoch: 69, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.065 Vali Acc: 0.950 Test Loss: 0.065 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 70 cost time: 0.6424126625061035
Epoch: 70, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.063 Vali Acc: 0.950 Test Loss: 0.063 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm256_cs12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 43406
model size : 0.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm256_cs10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.8581736087799072
Epoch: 1, Steps: 3 | Train Loss: 1.428 Vali Loss: 1.477 Vali Acc: 0.175 Test Loss: 1.477 Test Acc: 0.175
Validation loss decreased (inf --> -0.174985).  Saving model ...
Epoch: 2 cost time: 0.542583703994751
Epoch: 2, Steps: 3 | Train Loss: 1.415 Vali Loss: 1.469 Vali Acc: 0.175 Test Loss: 1.469 Test Acc: 0.175
Validation loss decreased (-0.174985 --> -0.174985).  Saving model ...
Epoch: 3 cost time: 0.5460739135742188
Epoch: 3, Steps: 3 | Train Loss: 1.393 Vali Loss: 1.461 Vali Acc: 0.175 Test Loss: 1.461 Test Acc: 0.175
Validation loss decreased (-0.174985 --> -0.174985).  Saving model ...
Epoch: 4 cost time: 0.4158051013946533
Epoch: 4, Steps: 3 | Train Loss: 1.377 Vali Loss: 1.451 Vali Acc: 0.225 Test Loss: 1.451 Test Acc: 0.225
Validation loss decreased (-0.174985 --> -0.224985).  Saving model ...
Epoch: 5 cost time: 0.38343334197998047
Epoch: 5, Steps: 3 | Train Loss: 1.334 Vali Loss: 1.438 Vali Acc: 0.250 Test Loss: 1.438 Test Acc: 0.250
Validation loss decreased (-0.224985 --> -0.249986).  Saving model ...
Epoch: 6 cost time: 0.3618454933166504
Epoch: 6, Steps: 3 | Train Loss: 1.336 Vali Loss: 1.424 Vali Acc: 0.275 Test Loss: 1.424 Test Acc: 0.275
Validation loss decreased (-0.249986 --> -0.274986).  Saving model ...
Epoch: 7 cost time: 0.5060441493988037
Epoch: 7, Steps: 3 | Train Loss: 1.298 Vali Loss: 1.409 Vali Acc: 0.325 Test Loss: 1.409 Test Acc: 0.325
Validation loss decreased (-0.274986 --> -0.324986).  Saving model ...
Epoch: 8 cost time: 0.6377754211425781
Epoch: 8, Steps: 3 | Train Loss: 1.248 Vali Loss: 1.392 Vali Acc: 0.400 Test Loss: 1.392 Test Acc: 0.400
Validation loss decreased (-0.324986 --> -0.399986).  Saving model ...
Epoch: 9 cost time: 0.46729040145874023
Epoch: 9, Steps: 3 | Train Loss: 1.241 Vali Loss: 1.374 Vali Acc: 0.450 Test Loss: 1.374 Test Acc: 0.450
Validation loss decreased (-0.399986 --> -0.449986).  Saving model ...
Epoch: 10 cost time: 0.44269847869873047
Epoch: 10, Steps: 3 | Train Loss: 1.218 Vali Loss: 1.354 Vali Acc: 0.475 Test Loss: 1.354 Test Acc: 0.475
Validation loss decreased (-0.449986 --> -0.474986).  Saving model ...
Epoch: 11 cost time: 0.6271047592163086
Epoch: 11, Steps: 3 | Train Loss: 1.199 Vali Loss: 1.333 Vali Acc: 0.500 Test Loss: 1.333 Test Acc: 0.500
Validation loss decreased (-0.474986 --> -0.499987).  Saving model ...
Epoch: 12 cost time: 0.5041189193725586
Epoch: 12, Steps: 3 | Train Loss: 1.127 Vali Loss: 1.311 Vali Acc: 0.525 Test Loss: 1.311 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524987).  Saving model ...
Epoch: 13 cost time: 0.45960068702697754
Epoch: 13, Steps: 3 | Train Loss: 1.098 Vali Loss: 1.289 Vali Acc: 0.500 Test Loss: 1.289 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.45349836349487305
Epoch: 14, Steps: 3 | Train Loss: 1.047 Vali Loss: 1.265 Vali Acc: 0.525 Test Loss: 1.265 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524987).  Saving model ...
Epoch: 15 cost time: 0.4877619743347168
Epoch: 15, Steps: 3 | Train Loss: 1.011 Vali Loss: 1.241 Vali Acc: 0.625 Test Loss: 1.241 Test Acc: 0.625
Validation loss decreased (-0.524987 --> -0.624988).  Saving model ...
Epoch: 16 cost time: 0.48531556129455566
Epoch: 16, Steps: 3 | Train Loss: 0.966 Vali Loss: 1.215 Vali Acc: 0.675 Test Loss: 1.215 Test Acc: 0.675
Validation loss decreased (-0.624988 --> -0.674988).  Saving model ...
Epoch: 17 cost time: 0.4873514175415039
Epoch: 17, Steps: 3 | Train Loss: 0.949 Vali Loss: 1.187 Vali Acc: 0.675 Test Loss: 1.187 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674988).  Saving model ...
Epoch: 18 cost time: 0.48100924491882324
Epoch: 18, Steps: 3 | Train Loss: 0.917 Vali Loss: 1.158 Vali Acc: 0.725 Test Loss: 1.158 Test Acc: 0.725
Validation loss decreased (-0.674988 --> -0.724988).  Saving model ...
Epoch: 19 cost time: 0.48555469512939453
Epoch: 19, Steps: 3 | Train Loss: 0.887 Vali Loss: 1.128 Vali Acc: 0.725 Test Loss: 1.128 Test Acc: 0.725
Validation loss decreased (-0.724988 --> -0.724989).  Saving model ...
Epoch: 20 cost time: 0.5246791839599609
Epoch: 20, Steps: 3 | Train Loss: 0.840 Vali Loss: 1.097 Vali Acc: 0.750 Test Loss: 1.097 Test Acc: 0.750
Validation loss decreased (-0.724989 --> -0.749989).  Saving model ...
Epoch: 21 cost time: 0.5082557201385498
Epoch: 21, Steps: 3 | Train Loss: 0.816 Vali Loss: 1.064 Vali Acc: 0.750 Test Loss: 1.064 Test Acc: 0.750
Validation loss decreased (-0.749989 --> -0.749989).  Saving model ...
Epoch: 22 cost time: 0.49371790885925293
Epoch: 22, Steps: 3 | Train Loss: 0.745 Vali Loss: 1.029 Vali Acc: 0.750 Test Loss: 1.029 Test Acc: 0.750
Validation loss decreased (-0.749989 --> -0.749990).  Saving model ...
Epoch: 23 cost time: 0.5178158283233643
Epoch: 23, Steps: 3 | Train Loss: 0.742 Vali Loss: 0.991 Vali Acc: 0.775 Test Loss: 0.991 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774990).  Saving model ...
Epoch: 24 cost time: 0.5634121894836426
Epoch: 24, Steps: 3 | Train Loss: 0.672 Vali Loss: 0.953 Vali Acc: 0.800 Test Loss: 0.953 Test Acc: 0.800
Validation loss decreased (-0.774990 --> -0.799990).  Saving model ...
Epoch: 25 cost time: 0.4224672317504883
Epoch: 25, Steps: 3 | Train Loss: 0.652 Vali Loss: 0.910 Vali Acc: 0.800 Test Loss: 0.910 Test Acc: 0.800
Validation loss decreased (-0.799990 --> -0.799991).  Saving model ...
Epoch: 26 cost time: 0.44852542877197266
Epoch: 26, Steps: 3 | Train Loss: 0.579 Vali Loss: 0.863 Vali Acc: 0.850 Test Loss: 0.863 Test Acc: 0.850
Validation loss decreased (-0.799991 --> -0.849991).  Saving model ...
Epoch: 27 cost time: 0.43602728843688965
Epoch: 27, Steps: 3 | Train Loss: 0.550 Vali Loss: 0.811 Vali Acc: 0.850 Test Loss: 0.811 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849992).  Saving model ...
Epoch: 28 cost time: 0.4456295967102051
Epoch: 28, Steps: 3 | Train Loss: 0.518 Vali Loss: 0.759 Vali Acc: 0.850 Test Loss: 0.759 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 29 cost time: 0.5104942321777344
Epoch: 29, Steps: 3 | Train Loss: 0.481 Vali Loss: 0.703 Vali Acc: 0.850 Test Loss: 0.703 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849993).  Saving model ...
Epoch: 30 cost time: 0.49469614028930664
Epoch: 30, Steps: 3 | Train Loss: 0.455 Vali Loss: 0.645 Vali Acc: 0.850 Test Loss: 0.645 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 31 cost time: 0.5260725021362305
Epoch: 31, Steps: 3 | Train Loss: 0.427 Vali Loss: 0.586 Vali Acc: 0.875 Test Loss: 0.586 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874994).  Saving model ...
Epoch: 32 cost time: 0.4430563449859619
Epoch: 32, Steps: 3 | Train Loss: 0.383 Vali Loss: 0.527 Vali Acc: 0.925 Test Loss: 0.527 Test Acc: 0.925
Validation loss decreased (-0.874994 --> -0.924995).  Saving model ...
Epoch: 33 cost time: 0.5834548473358154
Epoch: 33, Steps: 3 | Train Loss: 0.371 Vali Loss: 0.469 Vali Acc: 0.925 Test Loss: 0.469 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 34 cost time: 0.5526483058929443
Epoch: 34, Steps: 3 | Train Loss: 0.342 Vali Loss: 0.413 Vali Acc: 0.900 Test Loss: 0.413 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.5180904865264893
Epoch: 35, Steps: 3 | Train Loss: 0.291 Vali Loss: 0.361 Vali Acc: 0.900 Test Loss: 0.361 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.47754454612731934
Epoch: 36, Steps: 3 | Train Loss: 0.279 Vali Loss: 0.312 Vali Acc: 0.925 Test Loss: 0.312 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924997).  Saving model ...
Epoch: 37 cost time: 0.5406455993652344
Epoch: 37, Steps: 3 | Train Loss: 0.260 Vali Loss: 0.268 Vali Acc: 0.975 Test Loss: 0.268 Test Acc: 0.975
Validation loss decreased (-0.924997 --> -0.974997).  Saving model ...
Epoch: 38 cost time: 0.469815731048584
Epoch: 38, Steps: 3 | Train Loss: 0.215 Vali Loss: 0.228 Vali Acc: 0.975 Test Loss: 0.228 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 39 cost time: 0.6713991165161133
Epoch: 39, Steps: 3 | Train Loss: 0.193 Vali Loss: 0.193 Vali Acc: 0.975 Test Loss: 0.193 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 40 cost time: 0.4689140319824219
Epoch: 40, Steps: 3 | Train Loss: 0.149 Vali Loss: 0.161 Vali Acc: 0.975 Test Loss: 0.161 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 41 cost time: 0.507188081741333
Epoch: 41, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.133 Vali Acc: 0.975 Test Loss: 0.133 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 42 cost time: 0.5310428142547607
Epoch: 42, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.109 Vali Acc: 0.975 Test Loss: 0.109 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 43 cost time: 0.45926499366760254
Epoch: 43, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.086 Vali Acc: 1.000 Test Loss: 0.086 Test Acc: 1.000
Validation loss decreased (-0.974999 --> -0.999999).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm256_cs10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 42392
model size : 0.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm256_cs9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.451033353805542
Epoch: 1, Steps: 3 | Train Loss: 1.507 Vali Loss: 1.483 Vali Acc: 0.300 Test Loss: 1.483 Test Acc: 0.300
Validation loss decreased (inf --> -0.299985).  Saving model ...
Epoch: 2 cost time: 0.5036699771881104
Epoch: 2, Steps: 3 | Train Loss: 1.462 Vali Loss: 1.474 Vali Acc: 0.300 Test Loss: 1.474 Test Acc: 0.300
Validation loss decreased (-0.299985 --> -0.299985).  Saving model ...
Epoch: 3 cost time: 0.5983085632324219
Epoch: 3, Steps: 3 | Train Loss: 1.435 Vali Loss: 1.467 Vali Acc: 0.300 Test Loss: 1.467 Test Acc: 0.300
Validation loss decreased (-0.299985 --> -0.299985).  Saving model ...
Epoch: 4 cost time: 0.5763144493103027
Epoch: 4, Steps: 3 | Train Loss: 1.427 Vali Loss: 1.457 Vali Acc: 0.325 Test Loss: 1.457 Test Acc: 0.325
Validation loss decreased (-0.299985 --> -0.324985).  Saving model ...
Epoch: 5 cost time: 0.533820390701294
Epoch: 5, Steps: 3 | Train Loss: 1.402 Vali Loss: 1.447 Vali Acc: 0.325 Test Loss: 1.447 Test Acc: 0.325
Validation loss decreased (-0.324985 --> -0.324986).  Saving model ...
Epoch: 6 cost time: 0.5218720436096191
Epoch: 6, Steps: 3 | Train Loss: 1.390 Vali Loss: 1.434 Vali Acc: 0.350 Test Loss: 1.434 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349986).  Saving model ...
Epoch: 7 cost time: 0.4399118423461914
Epoch: 7, Steps: 3 | Train Loss: 1.371 Vali Loss: 1.421 Vali Acc: 0.350 Test Loss: 1.421 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 8 cost time: 0.5178730487823486
Epoch: 8, Steps: 3 | Train Loss: 1.309 Vali Loss: 1.406 Vali Acc: 0.375 Test Loss: 1.406 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374986).  Saving model ...
Epoch: 9 cost time: 0.4012265205383301
Epoch: 9, Steps: 3 | Train Loss: 1.275 Vali Loss: 1.391 Vali Acc: 0.400 Test Loss: 1.391 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399986).  Saving model ...
Epoch: 10 cost time: 0.4872455596923828
Epoch: 10, Steps: 3 | Train Loss: 1.283 Vali Loss: 1.374 Vali Acc: 0.425 Test Loss: 1.374 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424986).  Saving model ...
Epoch: 11 cost time: 0.4502096176147461
Epoch: 11, Steps: 3 | Train Loss: 1.234 Vali Loss: 1.356 Vali Acc: 0.425 Test Loss: 1.356 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424986).  Saving model ...
Epoch: 12 cost time: 0.3974277973175049
Epoch: 12, Steps: 3 | Train Loss: 1.159 Vali Loss: 1.337 Vali Acc: 0.425 Test Loss: 1.337 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424987).  Saving model ...
Epoch: 13 cost time: 0.48871493339538574
Epoch: 13, Steps: 3 | Train Loss: 1.164 Vali Loss: 1.318 Vali Acc: 0.425 Test Loss: 1.318 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 14 cost time: 0.4890940189361572
Epoch: 14, Steps: 3 | Train Loss: 1.106 Vali Loss: 1.298 Vali Acc: 0.400 Test Loss: 1.298 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.39182591438293457
Epoch: 15, Steps: 3 | Train Loss: 1.067 Vali Loss: 1.278 Vali Acc: 0.400 Test Loss: 1.278 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.4286527633666992
Epoch: 16, Steps: 3 | Train Loss: 1.046 Vali Loss: 1.258 Vali Acc: 0.400 Test Loss: 1.258 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5438575744628906
Epoch: 17, Steps: 3 | Train Loss: 1.030 Vali Loss: 1.238 Vali Acc: 0.450 Test Loss: 1.238 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449988).  Saving model ...
Epoch: 18 cost time: 0.4675137996673584
Epoch: 18, Steps: 3 | Train Loss: 1.016 Vali Loss: 1.217 Vali Acc: 0.450 Test Loss: 1.217 Test Acc: 0.450
Validation loss decreased (-0.449988 --> -0.449988).  Saving model ...
Epoch: 19 cost time: 0.442263126373291
Epoch: 19, Steps: 3 | Train Loss: 0.935 Vali Loss: 1.195 Vali Acc: 0.450 Test Loss: 1.195 Test Acc: 0.450
Validation loss decreased (-0.449988 --> -0.449988).  Saving model ...
Epoch: 20 cost time: 0.4630398750305176
Epoch: 20, Steps: 3 | Train Loss: 0.898 Vali Loss: 1.174 Vali Acc: 0.475 Test Loss: 1.174 Test Acc: 0.475
Validation loss decreased (-0.449988 --> -0.474988).  Saving model ...
Epoch: 21 cost time: 0.46345067024230957
Epoch: 21, Steps: 3 | Train Loss: 0.910 Vali Loss: 1.153 Vali Acc: 0.450 Test Loss: 1.153 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.4830057621002197
Epoch: 22, Steps: 3 | Train Loss: 0.875 Vali Loss: 1.133 Vali Acc: 0.475 Test Loss: 1.133 Test Acc: 0.475
Validation loss decreased (-0.474988 --> -0.474989).  Saving model ...
Epoch: 23 cost time: 0.5456299781799316
Epoch: 23, Steps: 3 | Train Loss: 0.831 Vali Loss: 1.112 Vali Acc: 0.475 Test Loss: 1.112 Test Acc: 0.475
Validation loss decreased (-0.474989 --> -0.474989).  Saving model ...
Epoch: 24 cost time: 0.8593604564666748
Epoch: 24, Steps: 3 | Train Loss: 0.806 Vali Loss: 1.089 Vali Acc: 0.525 Test Loss: 1.089 Test Acc: 0.525
Validation loss decreased (-0.474989 --> -0.524989).  Saving model ...
Epoch: 25 cost time: 0.534188985824585
Epoch: 25, Steps: 3 | Train Loss: 0.753 Vali Loss: 1.067 Vali Acc: 0.500 Test Loss: 1.067 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.798811674118042
Epoch: 26, Steps: 3 | Train Loss: 0.768 Vali Loss: 1.045 Vali Acc: 0.550 Test Loss: 1.045 Test Acc: 0.550
Validation loss decreased (-0.524989 --> -0.549990).  Saving model ...
Epoch: 27 cost time: 0.6338438987731934
Epoch: 27, Steps: 3 | Train Loss: 0.727 Vali Loss: 1.023 Vali Acc: 0.675 Test Loss: 1.023 Test Acc: 0.675
Validation loss decreased (-0.549990 --> -0.674990).  Saving model ...
Epoch: 28 cost time: 0.6132767200469971
Epoch: 28, Steps: 3 | Train Loss: 0.666 Vali Loss: 1.002 Vali Acc: 0.750 Test Loss: 1.002 Test Acc: 0.750
Validation loss decreased (-0.674990 --> -0.749990).  Saving model ...
Epoch: 29 cost time: 0.6763546466827393
Epoch: 29, Steps: 3 | Train Loss: 0.703 Vali Loss: 0.980 Vali Acc: 0.775 Test Loss: 0.980 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774990).  Saving model ...
Epoch: 30 cost time: 0.5572574138641357
Epoch: 30, Steps: 3 | Train Loss: 0.628 Vali Loss: 0.957 Vali Acc: 0.800 Test Loss: 0.957 Test Acc: 0.800
Validation loss decreased (-0.774990 --> -0.799990).  Saving model ...
Epoch: 31 cost time: 0.6296319961547852
Epoch: 31, Steps: 3 | Train Loss: 0.582 Vali Loss: 0.933 Vali Acc: 0.825 Test Loss: 0.933 Test Acc: 0.825
Validation loss decreased (-0.799990 --> -0.824991).  Saving model ...
Epoch: 32 cost time: 0.5720386505126953
Epoch: 32, Steps: 3 | Train Loss: 0.609 Vali Loss: 0.907 Vali Acc: 0.825 Test Loss: 0.907 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824991).  Saving model ...
Epoch: 33 cost time: 0.6719222068786621
Epoch: 33, Steps: 3 | Train Loss: 0.600 Vali Loss: 0.884 Vali Acc: 0.825 Test Loss: 0.884 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824991).  Saving model ...
Epoch: 34 cost time: 0.7531881332397461
Epoch: 34, Steps: 3 | Train Loss: 0.556 Vali Loss: 0.860 Vali Acc: 0.825 Test Loss: 0.860 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824991).  Saving model ...
Epoch: 35 cost time: 0.6272120475769043
Epoch: 35, Steps: 3 | Train Loss: 0.521 Vali Loss: 0.838 Vali Acc: 0.825 Test Loss: 0.838 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824992).  Saving model ...
Epoch: 36 cost time: 0.5587766170501709
Epoch: 36, Steps: 3 | Train Loss: 0.462 Vali Loss: 0.816 Vali Acc: 0.800 Test Loss: 0.816 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.6247968673706055
Epoch: 37, Steps: 3 | Train Loss: 0.496 Vali Loss: 0.791 Vali Acc: 0.800 Test Loss: 0.791 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.6245279312133789
Epoch: 38, Steps: 3 | Train Loss: 0.423 Vali Loss: 0.764 Vali Acc: 0.775 Test Loss: 0.764 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.6261796951293945
Epoch: 39, Steps: 3 | Train Loss: 0.457 Vali Loss: 0.736 Vali Acc: 0.800 Test Loss: 0.736 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.5608787536621094
Epoch: 40, Steps: 3 | Train Loss: 0.396 Vali Loss: 0.708 Vali Acc: 0.800 Test Loss: 0.708 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.7520232200622559
Epoch: 41, Steps: 3 | Train Loss: 0.415 Vali Loss: 0.680 Vali Acc: 0.800 Test Loss: 0.680 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.6344494819641113
Epoch: 42, Steps: 3 | Train Loss: 0.375 Vali Loss: 0.653 Vali Acc: 0.800 Test Loss: 0.653 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.7294437885284424
Epoch: 43, Steps: 3 | Train Loss: 0.318 Vali Loss: 0.624 Vali Acc: 0.825 Test Loss: 0.624 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824994).  Saving model ...
Epoch: 44 cost time: 0.609614372253418
Epoch: 44, Steps: 3 | Train Loss: 0.357 Vali Loss: 0.595 Vali Acc: 0.875 Test Loss: 0.595 Test Acc: 0.875
Validation loss decreased (-0.824994 --> -0.874994).  Saving model ...
Epoch: 45 cost time: 0.6179959774017334
Epoch: 45, Steps: 3 | Train Loss: 0.291 Vali Loss: 0.569 Vali Acc: 0.900 Test Loss: 0.569 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899994).  Saving model ...
Epoch: 46 cost time: 0.752485990524292
Epoch: 46, Steps: 3 | Train Loss: 0.275 Vali Loss: 0.541 Vali Acc: 0.900 Test Loss: 0.541 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 47 cost time: 0.5604181289672852
Epoch: 47, Steps: 3 | Train Loss: 0.258 Vali Loss: 0.514 Vali Acc: 0.900 Test Loss: 0.514 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 48 cost time: 0.6331875324249268
Epoch: 48, Steps: 3 | Train Loss: 0.224 Vali Loss: 0.489 Vali Acc: 0.900 Test Loss: 0.489 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 49 cost time: 0.6841118335723877
Epoch: 49, Steps: 3 | Train Loss: 0.216 Vali Loss: 0.465 Vali Acc: 0.925 Test Loss: 0.465 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924995).  Saving model ...
Epoch: 50 cost time: 0.5640537738800049
Epoch: 50, Steps: 3 | Train Loss: 0.237 Vali Loss: 0.444 Vali Acc: 0.900 Test Loss: 0.444 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.48383092880249023
Epoch: 51, Steps: 3 | Train Loss: 0.211 Vali Loss: 0.427 Vali Acc: 0.900 Test Loss: 0.427 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.5292537212371826
Epoch: 52, Steps: 3 | Train Loss: 0.160 Vali Loss: 0.416 Vali Acc: 0.925 Test Loss: 0.416 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 53 cost time: 0.6068556308746338
Epoch: 53, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.408 Vali Acc: 0.875 Test Loss: 0.408 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.6143574714660645
Epoch: 54, Steps: 3 | Train Loss: 0.144 Vali Loss: 0.402 Vali Acc: 0.875 Test Loss: 0.402 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.5527307987213135
Epoch: 55, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.397 Vali Acc: 0.875 Test Loss: 0.397 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.6398727893829346
Epoch: 56, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.389 Vali Acc: 0.875 Test Loss: 0.389 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.6628904342651367
Epoch: 57, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.381 Vali Acc: 0.875 Test Loss: 0.381 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 0.6526947021484375
Epoch: 58, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.380 Vali Acc: 0.875 Test Loss: 0.380 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 0.5468587875366211
Epoch: 59, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.382 Vali Acc: 0.900 Test Loss: 0.382 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 0.6039297580718994
Epoch: 60, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.388 Vali Acc: 0.900 Test Loss: 0.388 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 0.5654914379119873
Epoch: 61, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.387 Vali Acc: 0.900 Test Loss: 0.387 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 0.5805685520172119
Epoch: 62, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.384 Vali Acc: 0.900 Test Loss: 0.384 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm256_cs9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 43160
model size : 0.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm256_cs8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7090697288513184
Epoch: 1, Steps: 3 | Train Loss: 1.460 Vali Loss: 1.421 Vali Acc: 0.125 Test Loss: 1.421 Test Acc: 0.125
Validation loss decreased (inf --> -0.124986).  Saving model ...
Epoch: 2 cost time: 0.4999866485595703
Epoch: 2, Steps: 3 | Train Loss: 1.446 Vali Loss: 1.413 Vali Acc: 0.125 Test Loss: 1.413 Test Acc: 0.125
Validation loss decreased (-0.124986 --> -0.124986).  Saving model ...
Epoch: 3 cost time: 0.5333895683288574
Epoch: 3, Steps: 3 | Train Loss: 1.416 Vali Loss: 1.406 Vali Acc: 0.125 Test Loss: 1.406 Test Acc: 0.125
Validation loss decreased (-0.124986 --> -0.124986).  Saving model ...
Epoch: 4 cost time: 0.5408658981323242
Epoch: 4, Steps: 3 | Train Loss: 1.364 Vali Loss: 1.395 Vali Acc: 0.125 Test Loss: 1.395 Test Acc: 0.125
Validation loss decreased (-0.124986 --> -0.124986).  Saving model ...
Epoch: 5 cost time: 0.42144083976745605
Epoch: 5, Steps: 3 | Train Loss: 1.367 Vali Loss: 1.382 Vali Acc: 0.150 Test Loss: 1.382 Test Acc: 0.150
Validation loss decreased (-0.124986 --> -0.149986).  Saving model ...
Epoch: 6 cost time: 0.5721070766448975
Epoch: 6, Steps: 3 | Train Loss: 1.377 Vali Loss: 1.368 Vali Acc: 0.225 Test Loss: 1.368 Test Acc: 0.225
Validation loss decreased (-0.149986 --> -0.224986).  Saving model ...
Epoch: 7 cost time: 0.45609617233276367
Epoch: 7, Steps: 3 | Train Loss: 1.343 Vali Loss: 1.352 Vali Acc: 0.225 Test Loss: 1.352 Test Acc: 0.225
Validation loss decreased (-0.224986 --> -0.224986).  Saving model ...
Epoch: 8 cost time: 0.5061490535736084
Epoch: 8, Steps: 3 | Train Loss: 1.299 Vali Loss: 1.335 Vali Acc: 0.275 Test Loss: 1.335 Test Acc: 0.275
Validation loss decreased (-0.224986 --> -0.274987).  Saving model ...
Epoch: 9 cost time: 0.5077273845672607
Epoch: 9, Steps: 3 | Train Loss: 1.247 Vali Loss: 1.316 Vali Acc: 0.325 Test Loss: 1.316 Test Acc: 0.325
Validation loss decreased (-0.274987 --> -0.324987).  Saving model ...
Epoch: 10 cost time: 0.4262692928314209
Epoch: 10, Steps: 3 | Train Loss: 1.247 Vali Loss: 1.296 Vali Acc: 0.375 Test Loss: 1.296 Test Acc: 0.375
Validation loss decreased (-0.324987 --> -0.374987).  Saving model ...
Epoch: 11 cost time: 0.5222837924957275
Epoch: 11, Steps: 3 | Train Loss: 1.167 Vali Loss: 1.274 Vali Acc: 0.475 Test Loss: 1.274 Test Acc: 0.475
Validation loss decreased (-0.374987 --> -0.474987).  Saving model ...
Epoch: 12 cost time: 0.582667350769043
Epoch: 12, Steps: 3 | Train Loss: 1.155 Vali Loss: 1.251 Vali Acc: 0.500 Test Loss: 1.251 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499987).  Saving model ...
Epoch: 13 cost time: 0.5680627822875977
Epoch: 13, Steps: 3 | Train Loss: 1.130 Vali Loss: 1.227 Vali Acc: 0.600 Test Loss: 1.227 Test Acc: 0.600
Validation loss decreased (-0.499987 --> -0.599988).  Saving model ...
Epoch: 14 cost time: 0.5615179538726807
Epoch: 14, Steps: 3 | Train Loss: 1.106 Vali Loss: 1.202 Vali Acc: 0.575 Test Loss: 1.202 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5483055114746094
Epoch: 15, Steps: 3 | Train Loss: 1.054 Vali Loss: 1.176 Vali Acc: 0.575 Test Loss: 1.176 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.5428216457366943
Epoch: 16, Steps: 3 | Train Loss: 1.032 Vali Loss: 1.150 Vali Acc: 0.575 Test Loss: 1.150 Test Acc: 0.575
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.4554281234741211
Epoch: 17, Steps: 3 | Train Loss: 0.958 Vali Loss: 1.121 Vali Acc: 0.675 Test Loss: 1.121 Test Acc: 0.675
Validation loss decreased (-0.599988 --> -0.674989).  Saving model ...
Epoch: 18 cost time: 0.48255157470703125
Epoch: 18, Steps: 3 | Train Loss: 0.942 Vali Loss: 1.090 Vali Acc: 0.700 Test Loss: 1.090 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699989).  Saving model ...
Epoch: 19 cost time: 0.47594189643859863
Epoch: 19, Steps: 3 | Train Loss: 0.898 Vali Loss: 1.057 Vali Acc: 0.800 Test Loss: 1.057 Test Acc: 0.800
Validation loss decreased (-0.699989 --> -0.799989).  Saving model ...
Epoch: 20 cost time: 0.5904793739318848
Epoch: 20, Steps: 3 | Train Loss: 0.864 Vali Loss: 1.022 Vali Acc: 0.850 Test Loss: 1.022 Test Acc: 0.850
Validation loss decreased (-0.799989 --> -0.849990).  Saving model ...
Epoch: 21 cost time: 0.4548940658569336
Epoch: 21, Steps: 3 | Train Loss: 0.812 Vali Loss: 0.982 Vali Acc: 0.850 Test Loss: 0.982 Test Acc: 0.850
Validation loss decreased (-0.849990 --> -0.849990).  Saving model ...
Epoch: 22 cost time: 0.41852807998657227
Epoch: 22, Steps: 3 | Train Loss: 0.738 Vali Loss: 0.941 Vali Acc: 0.850 Test Loss: 0.941 Test Acc: 0.850
Validation loss decreased (-0.849990 --> -0.849991).  Saving model ...
Epoch: 23 cost time: 0.5401051044464111
Epoch: 23, Steps: 3 | Train Loss: 0.700 Vali Loss: 0.894 Vali Acc: 0.875 Test Loss: 0.894 Test Acc: 0.875
Validation loss decreased (-0.849991 --> -0.874991).  Saving model ...
Epoch: 24 cost time: 0.44204211235046387
Epoch: 24, Steps: 3 | Train Loss: 0.690 Vali Loss: 0.845 Vali Acc: 0.900 Test Loss: 0.845 Test Acc: 0.900
Validation loss decreased (-0.874991 --> -0.899992).  Saving model ...
Epoch: 25 cost time: 0.4327836036682129
Epoch: 25, Steps: 3 | Train Loss: 0.643 Vali Loss: 0.792 Vali Acc: 0.900 Test Loss: 0.792 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899992).  Saving model ...
Epoch: 26 cost time: 0.4155430793762207
Epoch: 26, Steps: 3 | Train Loss: 0.625 Vali Loss: 0.738 Vali Acc: 0.900 Test Loss: 0.738 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899993).  Saving model ...
Epoch: 27 cost time: 0.5649945735931396
Epoch: 27, Steps: 3 | Train Loss: 0.530 Vali Loss: 0.687 Vali Acc: 0.900 Test Loss: 0.687 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 28 cost time: 0.5537023544311523
Epoch: 28, Steps: 3 | Train Loss: 0.490 Vali Loss: 0.633 Vali Acc: 0.975 Test Loss: 0.633 Test Acc: 0.975
Validation loss decreased (-0.899993 --> -0.974994).  Saving model ...
Epoch: 29 cost time: 0.46835899353027344
Epoch: 29, Steps: 3 | Train Loss: 0.503 Vali Loss: 0.579 Vali Acc: 0.975 Test Loss: 0.579 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974994).  Saving model ...
Epoch: 30 cost time: 0.5757546424865723
Epoch: 30, Steps: 3 | Train Loss: 0.428 Vali Loss: 0.528 Vali Acc: 0.975 Test Loss: 0.528 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974995).  Saving model ...
Epoch: 31 cost time: 0.5336410999298096
Epoch: 31, Steps: 3 | Train Loss: 0.432 Vali Loss: 0.478 Vali Acc: 0.975 Test Loss: 0.478 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 32 cost time: 0.5183305740356445
Epoch: 32, Steps: 3 | Train Loss: 0.376 Vali Loss: 0.433 Vali Acc: 0.975 Test Loss: 0.433 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 33 cost time: 0.43342041969299316
Epoch: 33, Steps: 3 | Train Loss: 0.364 Vali Loss: 0.384 Vali Acc: 0.975 Test Loss: 0.384 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 34 cost time: 0.4869425296783447
Epoch: 34, Steps: 3 | Train Loss: 0.312 Vali Loss: 0.338 Vali Acc: 0.975 Test Loss: 0.338 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 35 cost time: 0.5326707363128662
Epoch: 35, Steps: 3 | Train Loss: 0.265 Vali Loss: 0.298 Vali Acc: 0.975 Test Loss: 0.298 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 36 cost time: 0.41205573081970215
Epoch: 36, Steps: 3 | Train Loss: 0.248 Vali Loss: 0.262 Vali Acc: 0.975 Test Loss: 0.262 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 37 cost time: 0.4652884006500244
Epoch: 37, Steps: 3 | Train Loss: 0.241 Vali Loss: 0.228 Vali Acc: 0.975 Test Loss: 0.228 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 38 cost time: 0.47079014778137207
Epoch: 38, Steps: 3 | Train Loss: 0.194 Vali Loss: 0.198 Vali Acc: 0.975 Test Loss: 0.198 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 39 cost time: 0.49625158309936523
Epoch: 39, Steps: 3 | Train Loss: 0.166 Vali Loss: 0.169 Vali Acc: 0.975 Test Loss: 0.169 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 40 cost time: 0.4651954174041748
Epoch: 40, Steps: 3 | Train Loss: 0.159 Vali Loss: 0.144 Vali Acc: 0.975 Test Loss: 0.144 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 41 cost time: 0.5284156799316406
Epoch: 41, Steps: 3 | Train Loss: 0.129 Vali Loss: 0.121 Vali Acc: 0.975 Test Loss: 0.121 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 42 cost time: 0.5891950130462646
Epoch: 42, Steps: 3 | Train Loss: 0.113 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 43 cost time: 0.49370312690734863
Epoch: 43, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.083 Vali Acc: 0.975 Test Loss: 0.083 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 44 cost time: 0.5735301971435547
Epoch: 44, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.068 Vali Acc: 0.975 Test Loss: 0.068 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 45 cost time: 0.4904360771179199
Epoch: 45, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.056 Vali Acc: 0.975 Test Loss: 0.056 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 46 cost time: 0.5505120754241943
Epoch: 46, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.045 Vali Acc: 1.000 Test Loss: 0.045 Test Acc: 1.000
Validation loss decreased (-0.974999 --> -1.000000).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm256_cs8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 42686
model size : 0.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm256_cs7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6626954078674316
Epoch: 1, Steps: 3 | Train Loss: 1.369 Vali Loss: 1.418 Vali Acc: 0.200 Test Loss: 1.418 Test Acc: 0.200
Validation loss decreased (inf --> -0.199986).  Saving model ...
Epoch: 2 cost time: 0.5442450046539307
Epoch: 2, Steps: 3 | Train Loss: 1.345 Vali Loss: 1.410 Vali Acc: 0.225 Test Loss: 1.410 Test Acc: 0.225
Validation loss decreased (-0.199986 --> -0.224986).  Saving model ...
Epoch: 3 cost time: 0.5208137035369873
Epoch: 3, Steps: 3 | Train Loss: 1.339 Vali Loss: 1.404 Vali Acc: 0.300 Test Loss: 1.404 Test Acc: 0.300
Validation loss decreased (-0.224986 --> -0.299986).  Saving model ...
Epoch: 4 cost time: 0.5273892879486084
Epoch: 4, Steps: 3 | Train Loss: 1.346 Vali Loss: 1.394 Vali Acc: 0.300 Test Loss: 1.394 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 5 cost time: 0.45963048934936523
Epoch: 5, Steps: 3 | Train Loss: 1.331 Vali Loss: 1.382 Vali Acc: 0.325 Test Loss: 1.382 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324986).  Saving model ...
Epoch: 6 cost time: 0.5526440143585205
Epoch: 6, Steps: 3 | Train Loss: 1.301 Vali Loss: 1.369 Vali Acc: 0.350 Test Loss: 1.369 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349986).  Saving model ...
Epoch: 7 cost time: 0.5820307731628418
Epoch: 7, Steps: 3 | Train Loss: 1.254 Vali Loss: 1.355 Vali Acc: 0.375 Test Loss: 1.355 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374986).  Saving model ...
Epoch: 8 cost time: 0.6625969409942627
Epoch: 8, Steps: 3 | Train Loss: 1.234 Vali Loss: 1.340 Vali Acc: 0.400 Test Loss: 1.340 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399987).  Saving model ...
Epoch: 9 cost time: 0.5230281352996826
Epoch: 9, Steps: 3 | Train Loss: 1.214 Vali Loss: 1.324 Vali Acc: 0.425 Test Loss: 1.324 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424987).  Saving model ...
Epoch: 10 cost time: 0.5330877304077148
Epoch: 10, Steps: 3 | Train Loss: 1.195 Vali Loss: 1.308 Vali Acc: 0.450 Test Loss: 1.308 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449987).  Saving model ...
Epoch: 11 cost time: 0.4678955078125
Epoch: 11, Steps: 3 | Train Loss: 1.162 Vali Loss: 1.290 Vali Acc: 0.525 Test Loss: 1.290 Test Acc: 0.525
Validation loss decreased (-0.449987 --> -0.524987).  Saving model ...
Epoch: 12 cost time: 0.5366809368133545
Epoch: 12, Steps: 3 | Train Loss: 1.111 Vali Loss: 1.272 Vali Acc: 0.600 Test Loss: 1.272 Test Acc: 0.600
Validation loss decreased (-0.524987 --> -0.599987).  Saving model ...
Epoch: 13 cost time: 0.4834098815917969
Epoch: 13, Steps: 3 | Train Loss: 1.095 Vali Loss: 1.253 Vali Acc: 0.600 Test Loss: 1.253 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599987).  Saving model ...
Epoch: 14 cost time: 0.4521830081939697
Epoch: 14, Steps: 3 | Train Loss: 1.040 Vali Loss: 1.234 Vali Acc: 0.600 Test Loss: 1.234 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599988).  Saving model ...
Epoch: 15 cost time: 0.5009009838104248
Epoch: 15, Steps: 3 | Train Loss: 1.043 Vali Loss: 1.214 Vali Acc: 0.600 Test Loss: 1.214 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 16 cost time: 0.5742182731628418
Epoch: 16, Steps: 3 | Train Loss: 0.964 Vali Loss: 1.194 Vali Acc: 0.625 Test Loss: 1.194 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624988).  Saving model ...
Epoch: 17 cost time: 0.5174229145050049
Epoch: 17, Steps: 3 | Train Loss: 0.972 Vali Loss: 1.173 Vali Acc: 0.675 Test Loss: 1.173 Test Acc: 0.675
Validation loss decreased (-0.624988 --> -0.674988).  Saving model ...
Epoch: 18 cost time: 0.5189502239227295
Epoch: 18, Steps: 3 | Train Loss: 0.908 Vali Loss: 1.150 Vali Acc: 0.700 Test Loss: 1.150 Test Acc: 0.700
Validation loss decreased (-0.674988 --> -0.699989).  Saving model ...
Epoch: 19 cost time: 0.5113213062286377
Epoch: 19, Steps: 3 | Train Loss: 0.882 Vali Loss: 1.127 Vali Acc: 0.725 Test Loss: 1.127 Test Acc: 0.725
Validation loss decreased (-0.699989 --> -0.724989).  Saving model ...
Epoch: 20 cost time: 0.564000129699707
Epoch: 20, Steps: 3 | Train Loss: 0.865 Vali Loss: 1.099 Vali Acc: 0.750 Test Loss: 1.099 Test Acc: 0.750
Validation loss decreased (-0.724989 --> -0.749989).  Saving model ...
Epoch: 21 cost time: 0.471513032913208
Epoch: 21, Steps: 3 | Train Loss: 0.840 Vali Loss: 1.072 Vali Acc: 0.750 Test Loss: 1.072 Test Acc: 0.750
Validation loss decreased (-0.749989 --> -0.749989).  Saving model ...
Epoch: 22 cost time: 0.5364038944244385
Epoch: 22, Steps: 3 | Train Loss: 0.794 Vali Loss: 1.046 Vali Acc: 0.750 Test Loss: 1.046 Test Acc: 0.750
Validation loss decreased (-0.749989 --> -0.749990).  Saving model ...
Epoch: 23 cost time: 0.5078306198120117
Epoch: 23, Steps: 3 | Train Loss: 0.782 Vali Loss: 1.017 Vali Acc: 0.775 Test Loss: 1.017 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774990).  Saving model ...
Epoch: 24 cost time: 0.5987997055053711
Epoch: 24, Steps: 3 | Train Loss: 0.725 Vali Loss: 0.985 Vali Acc: 0.800 Test Loss: 0.985 Test Acc: 0.800
Validation loss decreased (-0.774990 --> -0.799990).  Saving model ...
Epoch: 25 cost time: 0.5220727920532227
Epoch: 25, Steps: 3 | Train Loss: 0.698 Vali Loss: 0.950 Vali Acc: 0.800 Test Loss: 0.950 Test Acc: 0.800
Validation loss decreased (-0.799990 --> -0.799990).  Saving model ...
Epoch: 26 cost time: 0.49681544303894043
Epoch: 26, Steps: 3 | Train Loss: 0.704 Vali Loss: 0.915 Vali Acc: 0.800 Test Loss: 0.915 Test Acc: 0.800
Validation loss decreased (-0.799990 --> -0.799991).  Saving model ...
Epoch: 27 cost time: 0.48220086097717285
Epoch: 27, Steps: 3 | Train Loss: 0.616 Vali Loss: 0.880 Vali Acc: 0.825 Test Loss: 0.880 Test Acc: 0.825
Validation loss decreased (-0.799991 --> -0.824991).  Saving model ...
Epoch: 28 cost time: 0.5073201656341553
Epoch: 28, Steps: 3 | Train Loss: 0.587 Vali Loss: 0.840 Vali Acc: 0.825 Test Loss: 0.840 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824992).  Saving model ...
Epoch: 29 cost time: 0.5794463157653809
Epoch: 29, Steps: 3 | Train Loss: 0.587 Vali Loss: 0.798 Vali Acc: 0.825 Test Loss: 0.798 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 30 cost time: 0.59555983543396
Epoch: 30, Steps: 3 | Train Loss: 0.499 Vali Loss: 0.749 Vali Acc: 0.850 Test Loss: 0.749 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849993).  Saving model ...
Epoch: 31 cost time: 0.6423683166503906
Epoch: 31, Steps: 3 | Train Loss: 0.495 Vali Loss: 0.697 Vali Acc: 0.850 Test Loss: 0.697 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 32 cost time: 0.4327707290649414
Epoch: 32, Steps: 3 | Train Loss: 0.451 Vali Loss: 0.643 Vali Acc: 0.875 Test Loss: 0.643 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874994).  Saving model ...
Epoch: 33 cost time: 0.533811092376709
Epoch: 33, Steps: 3 | Train Loss: 0.430 Vali Loss: 0.589 Vali Acc: 0.875 Test Loss: 0.589 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 34 cost time: 0.5257749557495117
Epoch: 34, Steps: 3 | Train Loss: 0.399 Vali Loss: 0.539 Vali Acc: 0.875 Test Loss: 0.539 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 35 cost time: 0.4651167392730713
Epoch: 35, Steps: 3 | Train Loss: 0.365 Vali Loss: 0.490 Vali Acc: 0.900 Test Loss: 0.490 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899995).  Saving model ...
Epoch: 36 cost time: 0.4812142848968506
Epoch: 36, Steps: 3 | Train Loss: 0.354 Vali Loss: 0.445 Vali Acc: 0.900 Test Loss: 0.445 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 37 cost time: 0.4660806655883789
Epoch: 37, Steps: 3 | Train Loss: 0.327 Vali Loss: 0.405 Vali Acc: 0.900 Test Loss: 0.405 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 38 cost time: 0.508324384689331
Epoch: 38, Steps: 3 | Train Loss: 0.302 Vali Loss: 0.368 Vali Acc: 0.900 Test Loss: 0.368 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 39 cost time: 0.686021089553833
Epoch: 39, Steps: 3 | Train Loss: 0.287 Vali Loss: 0.333 Vali Acc: 0.925 Test Loss: 0.333 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924997).  Saving model ...
Epoch: 40 cost time: 0.5214266777038574
Epoch: 40, Steps: 3 | Train Loss: 0.237 Vali Loss: 0.301 Vali Acc: 0.950 Test Loss: 0.301 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 41 cost time: 0.564769983291626
Epoch: 41, Steps: 3 | Train Loss: 0.214 Vali Loss: 0.271 Vali Acc: 0.975 Test Loss: 0.271 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974997).  Saving model ...
Epoch: 42 cost time: 0.6231262683868408
Epoch: 42, Steps: 3 | Train Loss: 0.232 Vali Loss: 0.243 Vali Acc: 0.975 Test Loss: 0.243 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 43 cost time: 0.5716509819030762
Epoch: 43, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.215 Vali Acc: 0.975 Test Loss: 0.215 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 44 cost time: 0.5391101837158203
Epoch: 44, Steps: 3 | Train Loss: 0.166 Vali Loss: 0.188 Vali Acc: 0.975 Test Loss: 0.188 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 45 cost time: 0.5562789440155029
Epoch: 45, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.163 Vali Acc: 0.975 Test Loss: 0.163 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 46 cost time: 0.5326259136199951
Epoch: 46, Steps: 3 | Train Loss: 0.127 Vali Loss: 0.142 Vali Acc: 0.975 Test Loss: 0.142 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 47 cost time: 0.5572896003723145
Epoch: 47, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.126 Vali Acc: 1.000 Test Loss: 0.126 Test Acc: 1.000
Validation loss decreased (-0.974999 --> -0.999999).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm256_cs7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 42778
model size : 0.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm256_cs6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6920721530914307
Epoch: 1, Steps: 3 | Train Loss: 1.396 Vali Loss: 1.344 Vali Acc: 0.350 Test Loss: 1.344 Test Acc: 0.350
Validation loss decreased (inf --> -0.349987).  Saving model ...
Epoch: 2 cost time: 0.5741996765136719
Epoch: 2, Steps: 3 | Train Loss: 1.388 Vali Loss: 1.337 Vali Acc: 0.350 Test Loss: 1.337 Test Acc: 0.350
Validation loss decreased (-0.349987 --> -0.349987).  Saving model ...
Epoch: 3 cost time: 0.5382108688354492
Epoch: 3, Steps: 3 | Train Loss: 1.389 Vali Loss: 1.331 Vali Acc: 0.350 Test Loss: 1.331 Test Acc: 0.350
Validation loss decreased (-0.349987 --> -0.349987).  Saving model ...
Epoch: 4 cost time: 0.4992349147796631
Epoch: 4, Steps: 3 | Train Loss: 1.326 Vali Loss: 1.321 Vali Acc: 0.375 Test Loss: 1.321 Test Acc: 0.375
Validation loss decreased (-0.349987 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 0.5808942317962646
Epoch: 5, Steps: 3 | Train Loss: 1.320 Vali Loss: 1.310 Vali Acc: 0.400 Test Loss: 1.310 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399987).  Saving model ...
Epoch: 6 cost time: 0.6847410202026367
Epoch: 6, Steps: 3 | Train Loss: 1.309 Vali Loss: 1.297 Vali Acc: 0.400 Test Loss: 1.297 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 7 cost time: 0.44962525367736816
Epoch: 7, Steps: 3 | Train Loss: 1.269 Vali Loss: 1.281 Vali Acc: 0.450 Test Loss: 1.281 Test Acc: 0.450
Validation loss decreased (-0.399987 --> -0.449987).  Saving model ...
Epoch: 8 cost time: 0.5823979377746582
Epoch: 8, Steps: 3 | Train Loss: 1.240 Vali Loss: 1.265 Vali Acc: 0.500 Test Loss: 1.265 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499987).  Saving model ...
Epoch: 9 cost time: 0.5722460746765137
Epoch: 9, Steps: 3 | Train Loss: 1.193 Vali Loss: 1.247 Vali Acc: 0.525 Test Loss: 1.247 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524988).  Saving model ...
Epoch: 10 cost time: 0.6019115447998047
Epoch: 10, Steps: 3 | Train Loss: 1.178 Vali Loss: 1.229 Vali Acc: 0.550 Test Loss: 1.229 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 11 cost time: 0.5754320621490479
Epoch: 11, Steps: 3 | Train Loss: 1.139 Vali Loss: 1.210 Vali Acc: 0.550 Test Loss: 1.210 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 12 cost time: 0.5887434482574463
Epoch: 12, Steps: 3 | Train Loss: 1.113 Vali Loss: 1.190 Vali Acc: 0.550 Test Loss: 1.190 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 13 cost time: 0.5510952472686768
Epoch: 13, Steps: 3 | Train Loss: 1.053 Vali Loss: 1.170 Vali Acc: 0.625 Test Loss: 1.170 Test Acc: 0.625
Validation loss decreased (-0.549988 --> -0.624988).  Saving model ...
Epoch: 14 cost time: 0.5598549842834473
Epoch: 14, Steps: 3 | Train Loss: 1.022 Vali Loss: 1.148 Vali Acc: 0.675 Test Loss: 1.148 Test Acc: 0.675
Validation loss decreased (-0.624988 --> -0.674989).  Saving model ...
Epoch: 15 cost time: 0.42713189125061035
Epoch: 15, Steps: 3 | Train Loss: 0.999 Vali Loss: 1.127 Vali Acc: 0.675 Test Loss: 1.127 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 16 cost time: 0.6745812892913818
Epoch: 16, Steps: 3 | Train Loss: 0.946 Vali Loss: 1.105 Vali Acc: 0.675 Test Loss: 1.105 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 17 cost time: 0.5529093742370605
Epoch: 17, Steps: 3 | Train Loss: 0.903 Vali Loss: 1.084 Vali Acc: 0.675 Test Loss: 1.084 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 18 cost time: 0.6096899509429932
Epoch: 18, Steps: 3 | Train Loss: 0.915 Vali Loss: 1.061 Vali Acc: 0.700 Test Loss: 1.061 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699989).  Saving model ...
Epoch: 19 cost time: 0.6853022575378418
Epoch: 19, Steps: 3 | Train Loss: 0.864 Vali Loss: 1.038 Vali Acc: 0.725 Test Loss: 1.038 Test Acc: 0.725
Validation loss decreased (-0.699989 --> -0.724990).  Saving model ...
Epoch: 20 cost time: 0.46410202980041504
Epoch: 20, Steps: 3 | Train Loss: 0.835 Vali Loss: 1.014 Vali Acc: 0.750 Test Loss: 1.014 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749990).  Saving model ...
Epoch: 21 cost time: 0.5028321743011475
Epoch: 21, Steps: 3 | Train Loss: 0.796 Vali Loss: 0.986 Vali Acc: 0.800 Test Loss: 0.986 Test Acc: 0.800
Validation loss decreased (-0.749990 --> -0.799990).  Saving model ...
Epoch: 22 cost time: 0.5300357341766357
Epoch: 22, Steps: 3 | Train Loss: 0.773 Vali Loss: 0.958 Vali Acc: 0.825 Test Loss: 0.958 Test Acc: 0.825
Validation loss decreased (-0.799990 --> -0.824990).  Saving model ...
Epoch: 23 cost time: 0.5101244449615479
Epoch: 23, Steps: 3 | Train Loss: 0.709 Vali Loss: 0.929 Vali Acc: 0.850 Test Loss: 0.929 Test Acc: 0.850
Validation loss decreased (-0.824990 --> -0.849991).  Saving model ...
Epoch: 24 cost time: 0.4670836925506592
Epoch: 24, Steps: 3 | Train Loss: 0.723 Vali Loss: 0.901 Vali Acc: 0.875 Test Loss: 0.901 Test Acc: 0.875
Validation loss decreased (-0.849991 --> -0.874991).  Saving model ...
Epoch: 25 cost time: 0.4840867519378662
Epoch: 25, Steps: 3 | Train Loss: 0.678 Vali Loss: 0.870 Vali Acc: 0.900 Test Loss: 0.870 Test Acc: 0.900
Validation loss decreased (-0.874991 --> -0.899991).  Saving model ...
Epoch: 26 cost time: 0.5320847034454346
Epoch: 26, Steps: 3 | Train Loss: 0.634 Vali Loss: 0.838 Vali Acc: 0.900 Test Loss: 0.838 Test Acc: 0.900
Validation loss decreased (-0.899991 --> -0.899992).  Saving model ...
Epoch: 27 cost time: 0.4585402011871338
Epoch: 27, Steps: 3 | Train Loss: 0.578 Vali Loss: 0.805 Vali Acc: 0.925 Test Loss: 0.805 Test Acc: 0.925
Validation loss decreased (-0.899992 --> -0.924992).  Saving model ...
Epoch: 28 cost time: 0.4486663341522217
Epoch: 28, Steps: 3 | Train Loss: 0.537 Vali Loss: 0.767 Vali Acc: 0.950 Test Loss: 0.767 Test Acc: 0.950
Validation loss decreased (-0.924992 --> -0.949992).  Saving model ...
Epoch: 29 cost time: 0.6461453437805176
Epoch: 29, Steps: 3 | Train Loss: 0.523 Vali Loss: 0.729 Vali Acc: 0.950 Test Loss: 0.729 Test Acc: 0.950
Validation loss decreased (-0.949992 --> -0.949993).  Saving model ...
Epoch: 30 cost time: 0.620333194732666
Epoch: 30, Steps: 3 | Train Loss: 0.485 Vali Loss: 0.686 Vali Acc: 0.950 Test Loss: 0.686 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949993).  Saving model ...
Epoch: 31 cost time: 0.5702064037322998
Epoch: 31, Steps: 3 | Train Loss: 0.474 Vali Loss: 0.646 Vali Acc: 0.925 Test Loss: 0.646 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.48441123962402344
Epoch: 32, Steps: 3 | Train Loss: 0.480 Vali Loss: 0.605 Vali Acc: 0.950 Test Loss: 0.605 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949994).  Saving model ...
Epoch: 33 cost time: 0.5990054607391357
Epoch: 33, Steps: 3 | Train Loss: 0.413 Vali Loss: 0.564 Vali Acc: 0.950 Test Loss: 0.564 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 34 cost time: 0.47783350944519043
Epoch: 34, Steps: 3 | Train Loss: 0.374 Vali Loss: 0.520 Vali Acc: 0.950 Test Loss: 0.520 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 35 cost time: 0.6180169582366943
Epoch: 35, Steps: 3 | Train Loss: 0.395 Vali Loss: 0.474 Vali Acc: 0.950 Test Loss: 0.474 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 36 cost time: 0.4525125026702881
Epoch: 36, Steps: 3 | Train Loss: 0.341 Vali Loss: 0.424 Vali Acc: 0.950 Test Loss: 0.424 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 37 cost time: 0.5674071311950684
Epoch: 37, Steps: 3 | Train Loss: 0.337 Vali Loss: 0.377 Vali Acc: 0.950 Test Loss: 0.377 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 38 cost time: 0.5036454200744629
Epoch: 38, Steps: 3 | Train Loss: 0.272 Vali Loss: 0.336 Vali Acc: 0.950 Test Loss: 0.336 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 39 cost time: 0.47007155418395996
Epoch: 39, Steps: 3 | Train Loss: 0.282 Vali Loss: 0.296 Vali Acc: 0.975 Test Loss: 0.296 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974997).  Saving model ...
Epoch: 40 cost time: 0.6409077644348145
Epoch: 40, Steps: 3 | Train Loss: 0.264 Vali Loss: 0.263 Vali Acc: 0.975 Test Loss: 0.263 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 41 cost time: 0.5137507915496826
Epoch: 41, Steps: 3 | Train Loss: 0.228 Vali Loss: 0.233 Vali Acc: 0.975 Test Loss: 0.233 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 42 cost time: 0.6018693447113037
Epoch: 42, Steps: 3 | Train Loss: 0.194 Vali Loss: 0.204 Vali Acc: 0.975 Test Loss: 0.204 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 43 cost time: 0.5618057250976562
Epoch: 43, Steps: 3 | Train Loss: 0.187 Vali Loss: 0.178 Vali Acc: 0.975 Test Loss: 0.178 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 44 cost time: 0.5592684745788574
Epoch: 44, Steps: 3 | Train Loss: 0.156 Vali Loss: 0.153 Vali Acc: 0.975 Test Loss: 0.153 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 45 cost time: 0.6330573558807373
Epoch: 45, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.130 Vali Acc: 0.975 Test Loss: 0.130 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 46 cost time: 0.6541585922241211
Epoch: 46, Steps: 3 | Train Loss: 0.123 Vali Loss: 0.107 Vali Acc: 1.000 Test Loss: 0.107 Test Acc: 1.000
Validation loss decreased (-0.974999 --> -0.999999).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm256_cs6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 42486
model size : 0.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm256_cs5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.679943323135376
Epoch: 1, Steps: 3 | Train Loss: 1.434 Vali Loss: 1.486 Vali Acc: 0.175 Test Loss: 1.486 Test Acc: 0.175
Validation loss decreased (inf --> -0.174985).  Saving model ...
Epoch: 2 cost time: 0.4374542236328125
Epoch: 2, Steps: 3 | Train Loss: 1.418 Vali Loss: 1.478 Vali Acc: 0.175 Test Loss: 1.478 Test Acc: 0.175
Validation loss decreased (-0.174985 --> -0.174985).  Saving model ...
Epoch: 3 cost time: 0.5294284820556641
Epoch: 3, Steps: 3 | Train Loss: 1.401 Vali Loss: 1.471 Vali Acc: 0.175 Test Loss: 1.471 Test Acc: 0.175
Validation loss decreased (-0.174985 --> -0.174985).  Saving model ...
Epoch: 4 cost time: 0.43930697441101074
Epoch: 4, Steps: 3 | Train Loss: 1.382 Vali Loss: 1.461 Vali Acc: 0.200 Test Loss: 1.461 Test Acc: 0.200
Validation loss decreased (-0.174985 --> -0.199985).  Saving model ...
Epoch: 5 cost time: 0.5878596305847168
Epoch: 5, Steps: 3 | Train Loss: 1.337 Vali Loss: 1.450 Vali Acc: 0.225 Test Loss: 1.450 Test Acc: 0.225
Validation loss decreased (-0.199985 --> -0.224985).  Saving model ...
Epoch: 6 cost time: 0.519275426864624
Epoch: 6, Steps: 3 | Train Loss: 1.345 Vali Loss: 1.438 Vali Acc: 0.275 Test Loss: 1.438 Test Acc: 0.275
Validation loss decreased (-0.224985 --> -0.274986).  Saving model ...
Epoch: 7 cost time: 0.46524786949157715
Epoch: 7, Steps: 3 | Train Loss: 1.309 Vali Loss: 1.424 Vali Acc: 0.300 Test Loss: 1.424 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299986).  Saving model ...
Epoch: 8 cost time: 0.5396385192871094
Epoch: 8, Steps: 3 | Train Loss: 1.259 Vali Loss: 1.409 Vali Acc: 0.350 Test Loss: 1.409 Test Acc: 0.350
Validation loss decreased (-0.299986 --> -0.349986).  Saving model ...
Epoch: 9 cost time: 0.43743133544921875
Epoch: 9, Steps: 3 | Train Loss: 1.255 Vali Loss: 1.392 Vali Acc: 0.400 Test Loss: 1.392 Test Acc: 0.400
Validation loss decreased (-0.349986 --> -0.399986).  Saving model ...
Epoch: 10 cost time: 0.45186901092529297
Epoch: 10, Steps: 3 | Train Loss: 1.235 Vali Loss: 1.375 Vali Acc: 0.450 Test Loss: 1.375 Test Acc: 0.450
Validation loss decreased (-0.399986 --> -0.449986).  Saving model ...
Epoch: 11 cost time: 0.504784107208252
Epoch: 11, Steps: 3 | Train Loss: 1.217 Vali Loss: 1.356 Vali Acc: 0.475 Test Loss: 1.356 Test Acc: 0.475
Validation loss decreased (-0.449986 --> -0.474986).  Saving model ...
Epoch: 12 cost time: 0.7526144981384277
Epoch: 12, Steps: 3 | Train Loss: 1.148 Vali Loss: 1.337 Vali Acc: 0.500 Test Loss: 1.337 Test Acc: 0.500
Validation loss decreased (-0.474986 --> -0.499987).  Saving model ...
Epoch: 13 cost time: 0.5480916500091553
Epoch: 13, Steps: 3 | Train Loss: 1.117 Vali Loss: 1.318 Vali Acc: 0.475 Test Loss: 1.318 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5981135368347168
Epoch: 14, Steps: 3 | Train Loss: 1.071 Vali Loss: 1.298 Vali Acc: 0.475 Test Loss: 1.298 Test Acc: 0.475
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5129756927490234
Epoch: 15, Steps: 3 | Train Loss: 1.037 Vali Loss: 1.278 Vali Acc: 0.550 Test Loss: 1.278 Test Acc: 0.550
Validation loss decreased (-0.499987 --> -0.549987).  Saving model ...
Epoch: 16 cost time: 0.4764282703399658
Epoch: 16, Steps: 3 | Train Loss: 0.996 Vali Loss: 1.257 Vali Acc: 0.550 Test Loss: 1.257 Test Acc: 0.550
Validation loss decreased (-0.549987 --> -0.549987).  Saving model ...
Epoch: 17 cost time: 0.527381181716919
Epoch: 17, Steps: 3 | Train Loss: 0.982 Vali Loss: 1.235 Vali Acc: 0.600 Test Loss: 1.235 Test Acc: 0.600
Validation loss decreased (-0.549987 --> -0.599988).  Saving model ...
Epoch: 18 cost time: 0.4919114112854004
Epoch: 18, Steps: 3 | Train Loss: 0.958 Vali Loss: 1.213 Vali Acc: 0.675 Test Loss: 1.213 Test Acc: 0.675
Validation loss decreased (-0.599988 --> -0.674988).  Saving model ...
Epoch: 19 cost time: 0.5120618343353271
Epoch: 19, Steps: 3 | Train Loss: 0.929 Vali Loss: 1.190 Vali Acc: 0.675 Test Loss: 1.190 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674988).  Saving model ...
Epoch: 20 cost time: 0.5451028347015381
Epoch: 20, Steps: 3 | Train Loss: 0.885 Vali Loss: 1.168 Vali Acc: 0.675 Test Loss: 1.168 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674988).  Saving model ...
Epoch: 21 cost time: 0.4864680767059326
Epoch: 21, Steps: 3 | Train Loss: 0.871 Vali Loss: 1.146 Vali Acc: 0.700 Test Loss: 1.146 Test Acc: 0.700
Validation loss decreased (-0.674988 --> -0.699989).  Saving model ...
Epoch: 22 cost time: 0.46024417877197266
Epoch: 22, Steps: 3 | Train Loss: 0.803 Vali Loss: 1.124 Vali Acc: 0.725 Test Loss: 1.124 Test Acc: 0.725
Validation loss decreased (-0.699989 --> -0.724989).  Saving model ...
Epoch: 23 cost time: 0.5086588859558105
Epoch: 23, Steps: 3 | Train Loss: 0.807 Vali Loss: 1.102 Vali Acc: 0.725 Test Loss: 1.102 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 24 cost time: 0.5088074207305908
Epoch: 24, Steps: 3 | Train Loss: 0.742 Vali Loss: 1.083 Vali Acc: 0.725 Test Loss: 1.083 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 25 cost time: 0.5297069549560547
Epoch: 25, Steps: 3 | Train Loss: 0.732 Vali Loss: 1.062 Vali Acc: 0.725 Test Loss: 1.062 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 26 cost time: 0.5356965065002441
Epoch: 26, Steps: 3 | Train Loss: 0.661 Vali Loss: 1.041 Vali Acc: 0.725 Test Loss: 1.041 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724990).  Saving model ...
Epoch: 27 cost time: 0.45940208435058594
Epoch: 27, Steps: 3 | Train Loss: 0.646 Vali Loss: 1.019 Vali Acc: 0.725 Test Loss: 1.019 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 28 cost time: 0.5320644378662109
Epoch: 28, Steps: 3 | Train Loss: 0.620 Vali Loss: 0.999 Vali Acc: 0.750 Test Loss: 0.999 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749990).  Saving model ...
Epoch: 29 cost time: 0.5153818130493164
Epoch: 29, Steps: 3 | Train Loss: 0.589 Vali Loss: 0.977 Vali Acc: 0.750 Test Loss: 0.977 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 30 cost time: 0.49659204483032227
Epoch: 30, Steps: 3 | Train Loss: 0.586 Vali Loss: 0.953 Vali Acc: 0.775 Test Loss: 0.953 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774990).  Saving model ...
Epoch: 31 cost time: 0.47103166580200195
Epoch: 31, Steps: 3 | Train Loss: 0.565 Vali Loss: 0.928 Vali Acc: 0.800 Test Loss: 0.928 Test Acc: 0.800
Validation loss decreased (-0.774990 --> -0.799991).  Saving model ...
Epoch: 32 cost time: 0.5394165515899658
Epoch: 32, Steps: 3 | Train Loss: 0.522 Vali Loss: 0.901 Vali Acc: 0.825 Test Loss: 0.901 Test Acc: 0.825
Validation loss decreased (-0.799991 --> -0.824991).  Saving model ...
Epoch: 33 cost time: 0.4490954875946045
Epoch: 33, Steps: 3 | Train Loss: 0.524 Vali Loss: 0.873 Vali Acc: 0.825 Test Loss: 0.873 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824991).  Saving model ...
Epoch: 34 cost time: 0.47531580924987793
Epoch: 34, Steps: 3 | Train Loss: 0.498 Vali Loss: 0.842 Vali Acc: 0.800 Test Loss: 0.842 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.47452592849731445
Epoch: 35, Steps: 3 | Train Loss: 0.443 Vali Loss: 0.813 Vali Acc: 0.825 Test Loss: 0.813 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824992).  Saving model ...
Epoch: 36 cost time: 0.4618985652923584
Epoch: 36, Steps: 3 | Train Loss: 0.438 Vali Loss: 0.782 Vali Acc: 0.825 Test Loss: 0.782 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 37 cost time: 0.46182703971862793
Epoch: 37, Steps: 3 | Train Loss: 0.437 Vali Loss: 0.755 Vali Acc: 0.825 Test Loss: 0.755 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 38 cost time: 0.5707082748413086
Epoch: 38, Steps: 3 | Train Loss: 0.389 Vali Loss: 0.724 Vali Acc: 0.825 Test Loss: 0.724 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824993).  Saving model ...
Epoch: 39 cost time: 0.45503830909729004
Epoch: 39, Steps: 3 | Train Loss: 0.369 Vali Loss: 0.691 Vali Acc: 0.825 Test Loss: 0.691 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 40 cost time: 0.5129859447479248
Epoch: 40, Steps: 3 | Train Loss: 0.335 Vali Loss: 0.662 Vali Acc: 0.850 Test Loss: 0.662 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849993).  Saving model ...
Epoch: 41 cost time: 0.4696674346923828
Epoch: 41, Steps: 3 | Train Loss: 0.305 Vali Loss: 0.629 Vali Acc: 0.850 Test Loss: 0.629 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 42 cost time: 0.5182468891143799
Epoch: 42, Steps: 3 | Train Loss: 0.305 Vali Loss: 0.593 Vali Acc: 0.850 Test Loss: 0.593 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 43 cost time: 0.5075290203094482
Epoch: 43, Steps: 3 | Train Loss: 0.295 Vali Loss: 0.555 Vali Acc: 0.875 Test Loss: 0.555 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874994).  Saving model ...
Epoch: 44 cost time: 0.49128150939941406
Epoch: 44, Steps: 3 | Train Loss: 0.274 Vali Loss: 0.509 Vali Acc: 0.875 Test Loss: 0.509 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 45 cost time: 0.4893186092376709
Epoch: 45, Steps: 3 | Train Loss: 0.232 Vali Loss: 0.463 Vali Acc: 0.875 Test Loss: 0.463 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 46 cost time: 0.584190845489502
Epoch: 46, Steps: 3 | Train Loss: 0.233 Vali Loss: 0.422 Vali Acc: 0.875 Test Loss: 0.422 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 47 cost time: 0.48427796363830566
Epoch: 47, Steps: 3 | Train Loss: 0.189 Vali Loss: 0.379 Vali Acc: 0.900 Test Loss: 0.379 Test Acc: 0.900
Validation loss decreased (-0.874996 --> -0.899996).  Saving model ...
Epoch: 48 cost time: 0.42451953887939453
Epoch: 48, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.340 Vali Acc: 0.900 Test Loss: 0.340 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 49 cost time: 0.6035406589508057
Epoch: 49, Steps: 3 | Train Loss: 0.154 Vali Loss: 0.304 Vali Acc: 0.900 Test Loss: 0.304 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 50 cost time: 0.5445168018341064
Epoch: 50, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.276 Vali Acc: 0.925 Test Loss: 0.276 Test Acc: 0.925
Validation loss decreased (-0.899997 --> -0.924997).  Saving model ...
Epoch: 51 cost time: 0.4887714385986328
Epoch: 51, Steps: 3 | Train Loss: 0.124 Vali Loss: 0.242 Vali Acc: 0.925 Test Loss: 0.242 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924998).  Saving model ...
Epoch: 52 cost time: 0.5069572925567627
Epoch: 52, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.210 Vali Acc: 0.925 Test Loss: 0.210 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 53 cost time: 0.49549126625061035
Epoch: 53, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.186 Vali Acc: 0.950 Test Loss: 0.186 Test Acc: 0.950
Validation loss decreased (-0.924998 --> -0.949998).  Saving model ...
Epoch: 54 cost time: 0.47036290168762207
Epoch: 54, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.170 Vali Acc: 0.950 Test Loss: 0.170 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 55 cost time: 0.5471663475036621
Epoch: 55, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.158 Vali Acc: 0.950 Test Loss: 0.158 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 56 cost time: 0.5755438804626465
Epoch: 56, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.148 Vali Acc: 0.950 Test Loss: 0.148 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949999).  Saving model ...
Epoch: 57 cost time: 0.5524845123291016
Epoch: 57, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.142 Vali Acc: 0.950 Test Loss: 0.142 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 58 cost time: 0.5249030590057373
Epoch: 58, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.129 Vali Acc: 0.950 Test Loss: 0.129 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 59 cost time: 0.51544189453125
Epoch: 59, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.125 Vali Acc: 0.975 Test Loss: 0.125 Test Acc: 0.975
Validation loss decreased (-0.949999 --> -0.974999).  Saving model ...
Epoch: 60 cost time: 0.44680142402648926
Epoch: 60, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.127 Vali Acc: 0.975 Test Loss: 0.127 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.6798810958862305
Epoch: 61, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.113 Vali Acc: 0.975 Test Loss: 0.113 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 62 cost time: 0.6439266204833984
Epoch: 62, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.106 Vali Acc: 0.975 Test Loss: 0.106 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 63 cost time: 0.5131428241729736
Epoch: 63, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.103 Vali Acc: 0.975 Test Loss: 0.103 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 64 cost time: 0.4918680191040039
Epoch: 64, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.097 Vali Acc: 0.975 Test Loss: 0.097 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 65 cost time: 0.5226938724517822
Epoch: 65, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.091 Vali Acc: 0.975 Test Loss: 0.091 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 66 cost time: 0.576331377029419
Epoch: 66, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.089 Vali Acc: 0.975 Test Loss: 0.089 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 67 cost time: 0.5150201320648193
Epoch: 67, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.092 Vali Acc: 0.975 Test Loss: 0.092 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.7388448715209961
Epoch: 68, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.089 Vali Acc: 0.975 Test Loss: 0.089 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 69 cost time: 0.6218304634094238
Epoch: 69, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.080 Vali Acc: 0.975 Test Loss: 0.080 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 70 cost time: 0.5413286685943604
Epoch: 70, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.074 Vali Acc: 0.975 Test Loss: 0.074 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 71 cost time: 0.5322349071502686
Epoch: 71, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.072 Vali Acc: 0.975 Test Loss: 0.072 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 72 cost time: 0.5844371318817139
Epoch: 72, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.071 Vali Acc: 0.975 Test Loss: 0.071 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 73 cost time: 0.5865106582641602
Epoch: 73, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.071 Vali Acc: 0.975 Test Loss: 0.071 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 0.5671627521514893
Epoch: 74, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.071 Vali Acc: 0.975 Test Loss: 0.071 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 0.5932221412658691
Epoch: 75, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.072 Vali Acc: 0.975 Test Loss: 0.072 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 0.7459158897399902
Epoch: 76, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.975 Test Loss: 0.074 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 77 cost time: 0.49832868576049805
Epoch: 77, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.975 Test Loss: 0.076 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 78 cost time: 0.5873830318450928
Epoch: 78, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.975 Test Loss: 0.077 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 79 cost time: 0.6208741664886475
Epoch: 79, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.975 Test Loss: 0.078 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
Epoch: 80 cost time: 0.5912532806396484
Epoch: 80, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.975 Test Loss: 0.078 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
Epoch: 81 cost time: 0.4511599540710449
Epoch: 81, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.975 Test Loss: 0.079 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
Epoch: 82 cost time: 0.46465539932250977
Epoch: 82, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.975 Test Loss: 0.079 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm256_cs5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 42392
model size : 0.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm128_cs50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6476824283599854
Epoch: 1, Steps: 3 | Train Loss: 1.449 Vali Loss: 1.485 Vali Acc: 0.275 Test Loss: 1.485 Test Acc: 0.275
Validation loss decreased (inf --> -0.274985).  Saving model ...
Epoch: 2 cost time: 0.5642919540405273
Epoch: 2, Steps: 3 | Train Loss: 1.460 Vali Loss: 1.478 Vali Acc: 0.300 Test Loss: 1.478 Test Acc: 0.300
Validation loss decreased (-0.274985 --> -0.299985).  Saving model ...
Epoch: 3 cost time: 0.6481256484985352
Epoch: 3, Steps: 3 | Train Loss: 1.448 Vali Loss: 1.471 Vali Acc: 0.325 Test Loss: 1.471 Test Acc: 0.325
Validation loss decreased (-0.299985 --> -0.324985).  Saving model ...
Epoch: 4 cost time: 0.5770778656005859
Epoch: 4, Steps: 3 | Train Loss: 1.459 Vali Loss: 1.462 Vali Acc: 0.325 Test Loss: 1.462 Test Acc: 0.325
Validation loss decreased (-0.324985 --> -0.324985).  Saving model ...
Epoch: 5 cost time: 0.4655444622039795
Epoch: 5, Steps: 3 | Train Loss: 1.404 Vali Loss: 1.450 Vali Acc: 0.350 Test Loss: 1.450 Test Acc: 0.350
Validation loss decreased (-0.324985 --> -0.349985).  Saving model ...
Epoch: 6 cost time: 0.5114946365356445
Epoch: 6, Steps: 3 | Train Loss: 1.381 Vali Loss: 1.437 Vali Acc: 0.375 Test Loss: 1.437 Test Acc: 0.375
Validation loss decreased (-0.349985 --> -0.374986).  Saving model ...
Epoch: 7 cost time: 0.5585663318634033
Epoch: 7, Steps: 3 | Train Loss: 1.359 Vali Loss: 1.423 Vali Acc: 0.375 Test Loss: 1.423 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 8 cost time: 0.5239090919494629
Epoch: 8, Steps: 3 | Train Loss: 1.340 Vali Loss: 1.409 Vali Acc: 0.375 Test Loss: 1.409 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 9 cost time: 0.45738935470581055
Epoch: 9, Steps: 3 | Train Loss: 1.292 Vali Loss: 1.394 Vali Acc: 0.350 Test Loss: 1.394 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.48645591735839844
Epoch: 10, Steps: 3 | Train Loss: 1.241 Vali Loss: 1.377 Vali Acc: 0.350 Test Loss: 1.377 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5173189640045166
Epoch: 11, Steps: 3 | Train Loss: 1.209 Vali Loss: 1.359 Vali Acc: 0.350 Test Loss: 1.359 Test Acc: 0.350
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.5532875061035156
Epoch: 12, Steps: 3 | Train Loss: 1.169 Vali Loss: 1.342 Vali Acc: 0.350 Test Loss: 1.342 Test Acc: 0.350
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5134632587432861
Epoch: 13, Steps: 3 | Train Loss: 1.124 Vali Loss: 1.323 Vali Acc: 0.375 Test Loss: 1.323 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374987).  Saving model ...
Epoch: 14 cost time: 0.6828560829162598
Epoch: 14, Steps: 3 | Train Loss: 1.128 Vali Loss: 1.304 Vali Acc: 0.400 Test Loss: 1.304 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399987).  Saving model ...
Epoch: 15 cost time: 0.4959535598754883
Epoch: 15, Steps: 3 | Train Loss: 1.073 Vali Loss: 1.283 Vali Acc: 0.400 Test Loss: 1.283 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 16 cost time: 0.5421390533447266
Epoch: 16, Steps: 3 | Train Loss: 1.014 Vali Loss: 1.262 Vali Acc: 0.400 Test Loss: 1.262 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 17 cost time: 0.6057336330413818
Epoch: 17, Steps: 3 | Train Loss: 0.970 Vali Loss: 1.241 Vali Acc: 0.425 Test Loss: 1.241 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424988).  Saving model ...
Epoch: 18 cost time: 0.5642588138580322
Epoch: 18, Steps: 3 | Train Loss: 0.952 Vali Loss: 1.220 Vali Acc: 0.425 Test Loss: 1.220 Test Acc: 0.425
Validation loss decreased (-0.424988 --> -0.424988).  Saving model ...
Epoch: 19 cost time: 0.45087480545043945
Epoch: 19, Steps: 3 | Train Loss: 0.913 Vali Loss: 1.199 Vali Acc: 0.450 Test Loss: 1.199 Test Acc: 0.450
Validation loss decreased (-0.424988 --> -0.449988).  Saving model ...
Epoch: 20 cost time: 0.5264971256256104
Epoch: 20, Steps: 3 | Train Loss: 0.880 Vali Loss: 1.179 Vali Acc: 0.450 Test Loss: 1.179 Test Acc: 0.450
Validation loss decreased (-0.449988 --> -0.449988).  Saving model ...
Epoch: 21 cost time: 0.5755922794342041
Epoch: 21, Steps: 3 | Train Loss: 0.873 Vali Loss: 1.161 Vali Acc: 0.525 Test Loss: 1.161 Test Acc: 0.525
Validation loss decreased (-0.449988 --> -0.524988).  Saving model ...
Epoch: 22 cost time: 0.5086662769317627
Epoch: 22, Steps: 3 | Train Loss: 0.810 Vali Loss: 1.141 Vali Acc: 0.550 Test Loss: 1.141 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549989).  Saving model ...
Epoch: 23 cost time: 0.5114977359771729
Epoch: 23, Steps: 3 | Train Loss: 0.797 Vali Loss: 1.123 Vali Acc: 0.550 Test Loss: 1.123 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 24 cost time: 0.5396835803985596
Epoch: 24, Steps: 3 | Train Loss: 0.778 Vali Loss: 1.104 Vali Acc: 0.550 Test Loss: 1.104 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 25 cost time: 0.5465655326843262
Epoch: 25, Steps: 3 | Train Loss: 0.715 Vali Loss: 1.086 Vali Acc: 0.550 Test Loss: 1.086 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 26 cost time: 0.5385360717773438
Epoch: 26, Steps: 3 | Train Loss: 0.706 Vali Loss: 1.068 Vali Acc: 0.575 Test Loss: 1.068 Test Acc: 0.575
Validation loss decreased (-0.549989 --> -0.574989).  Saving model ...
Epoch: 27 cost time: 0.5651230812072754
Epoch: 27, Steps: 3 | Train Loss: 0.663 Vali Loss: 1.050 Vali Acc: 0.575 Test Loss: 1.050 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574990).  Saving model ...
Epoch: 28 cost time: 0.578251838684082
Epoch: 28, Steps: 3 | Train Loss: 0.622 Vali Loss: 1.033 Vali Acc: 0.575 Test Loss: 1.033 Test Acc: 0.575
Validation loss decreased (-0.574990 --> -0.574990).  Saving model ...
Epoch: 29 cost time: 0.49965429306030273
Epoch: 29, Steps: 3 | Train Loss: 0.607 Vali Loss: 1.017 Vali Acc: 0.575 Test Loss: 1.017 Test Acc: 0.575
Validation loss decreased (-0.574990 --> -0.574990).  Saving model ...
Epoch: 30 cost time: 0.5188248157501221
Epoch: 30, Steps: 3 | Train Loss: 0.612 Vali Loss: 1.001 Vali Acc: 0.600 Test Loss: 1.001 Test Acc: 0.600
Validation loss decreased (-0.574990 --> -0.599990).  Saving model ...
Epoch: 31 cost time: 0.6365728378295898
Epoch: 31, Steps: 3 | Train Loss: 0.564 Vali Loss: 0.985 Vali Acc: 0.625 Test Loss: 0.985 Test Acc: 0.625
Validation loss decreased (-0.599990 --> -0.624990).  Saving model ...
Epoch: 32 cost time: 0.658099889755249
Epoch: 32, Steps: 3 | Train Loss: 0.566 Vali Loss: 0.967 Vali Acc: 0.625 Test Loss: 0.967 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 33 cost time: 0.5244653224945068
Epoch: 33, Steps: 3 | Train Loss: 0.489 Vali Loss: 0.945 Vali Acc: 0.650 Test Loss: 0.945 Test Acc: 0.650
Validation loss decreased (-0.624990 --> -0.649991).  Saving model ...
Epoch: 34 cost time: 0.48180079460144043
Epoch: 34, Steps: 3 | Train Loss: 0.496 Vali Loss: 0.923 Vali Acc: 0.675 Test Loss: 0.923 Test Acc: 0.675
Validation loss decreased (-0.649991 --> -0.674991).  Saving model ...
Epoch: 35 cost time: 0.5670216083526611
Epoch: 35, Steps: 3 | Train Loss: 0.485 Vali Loss: 0.897 Vali Acc: 0.700 Test Loss: 0.897 Test Acc: 0.700
Validation loss decreased (-0.674991 --> -0.699991).  Saving model ...
Epoch: 36 cost time: 0.5735251903533936
Epoch: 36, Steps: 3 | Train Loss: 0.471 Vali Loss: 0.872 Vali Acc: 0.725 Test Loss: 0.872 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724991).  Saving model ...
Epoch: 37 cost time: 0.4437234401702881
Epoch: 37, Steps: 3 | Train Loss: 0.455 Vali Loss: 0.845 Vali Acc: 0.725 Test Loss: 0.845 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724992).  Saving model ...
Epoch: 38 cost time: 0.539527177810669
Epoch: 38, Steps: 3 | Train Loss: 0.429 Vali Loss: 0.821 Vali Acc: 0.725 Test Loss: 0.821 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 39 cost time: 0.607079267501831
Epoch: 39, Steps: 3 | Train Loss: 0.409 Vali Loss: 0.796 Vali Acc: 0.725 Test Loss: 0.796 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 40 cost time: 0.3994410037994385
Epoch: 40, Steps: 3 | Train Loss: 0.373 Vali Loss: 0.771 Vali Acc: 0.750 Test Loss: 0.771 Test Acc: 0.750
Validation loss decreased (-0.724992 --> -0.749992).  Saving model ...
Epoch: 41 cost time: 0.5024361610412598
Epoch: 41, Steps: 3 | Train Loss: 0.374 Vali Loss: 0.744 Vali Acc: 0.775 Test Loss: 0.744 Test Acc: 0.775
Validation loss decreased (-0.749992 --> -0.774993).  Saving model ...
Epoch: 42 cost time: 0.541452169418335
Epoch: 42, Steps: 3 | Train Loss: 0.374 Vali Loss: 0.721 Vali Acc: 0.775 Test Loss: 0.721 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 43 cost time: 0.47526121139526367
Epoch: 43, Steps: 3 | Train Loss: 0.316 Vali Loss: 0.694 Vali Acc: 0.775 Test Loss: 0.694 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 44 cost time: 0.5726864337921143
Epoch: 44, Steps: 3 | Train Loss: 0.330 Vali Loss: 0.668 Vali Acc: 0.775 Test Loss: 0.668 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 45 cost time: 0.5208308696746826
Epoch: 45, Steps: 3 | Train Loss: 0.329 Vali Loss: 0.644 Vali Acc: 0.775 Test Loss: 0.644 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774994).  Saving model ...
Epoch: 46 cost time: 0.5321638584136963
Epoch: 46, Steps: 3 | Train Loss: 0.270 Vali Loss: 0.618 Vali Acc: 0.825 Test Loss: 0.618 Test Acc: 0.825
Validation loss decreased (-0.774994 --> -0.824994).  Saving model ...
Epoch: 47 cost time: 0.48683714866638184
Epoch: 47, Steps: 3 | Train Loss: 0.266 Vali Loss: 0.594 Vali Acc: 0.875 Test Loss: 0.594 Test Acc: 0.875
Validation loss decreased (-0.824994 --> -0.874994).  Saving model ...
Epoch: 48 cost time: 0.7586214542388916
Epoch: 48, Steps: 3 | Train Loss: 0.235 Vali Loss: 0.569 Vali Acc: 0.875 Test Loss: 0.569 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 49 cost time: 0.613074541091919
Epoch: 49, Steps: 3 | Train Loss: 0.264 Vali Loss: 0.546 Vali Acc: 0.850 Test Loss: 0.546 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.49527430534362793
Epoch: 50, Steps: 3 | Train Loss: 0.231 Vali Loss: 0.515 Vali Acc: 0.875 Test Loss: 0.515 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 51 cost time: 0.49517822265625
Epoch: 51, Steps: 3 | Train Loss: 0.198 Vali Loss: 0.481 Vali Acc: 0.900 Test Loss: 0.481 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899995).  Saving model ...
Epoch: 52 cost time: 0.5718271732330322
Epoch: 52, Steps: 3 | Train Loss: 0.191 Vali Loss: 0.448 Vali Acc: 0.900 Test Loss: 0.448 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 53 cost time: 0.56662917137146
Epoch: 53, Steps: 3 | Train Loss: 0.171 Vali Loss: 0.418 Vali Acc: 0.900 Test Loss: 0.418 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 54 cost time: 0.5674691200256348
Epoch: 54, Steps: 3 | Train Loss: 0.158 Vali Loss: 0.391 Vali Acc: 0.925 Test Loss: 0.391 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 55 cost time: 0.576080322265625
Epoch: 55, Steps: 3 | Train Loss: 0.141 Vali Loss: 0.366 Vali Acc: 0.925 Test Loss: 0.366 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 56 cost time: 0.5869028568267822
Epoch: 56, Steps: 3 | Train Loss: 0.141 Vali Loss: 0.340 Vali Acc: 0.925 Test Loss: 0.340 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 57 cost time: 0.48008060455322266
Epoch: 57, Steps: 3 | Train Loss: 0.128 Vali Loss: 0.311 Vali Acc: 0.925 Test Loss: 0.311 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 58 cost time: 0.4873068332672119
Epoch: 58, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.278 Vali Acc: 0.925 Test Loss: 0.278 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 59 cost time: 0.5319168567657471
Epoch: 59, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.249 Vali Acc: 0.975 Test Loss: 0.249 Test Acc: 0.975
Validation loss decreased (-0.924997 --> -0.974998).  Saving model ...
Epoch: 60 cost time: 0.5564391613006592
Epoch: 60, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.225 Vali Acc: 0.975 Test Loss: 0.225 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 61 cost time: 0.5377309322357178
Epoch: 61, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.205 Vali Acc: 0.975 Test Loss: 0.205 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 62 cost time: 0.5784878730773926
Epoch: 62, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.189 Vali Acc: 0.975 Test Loss: 0.189 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 63 cost time: 0.613795280456543
Epoch: 63, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.179 Vali Acc: 0.975 Test Loss: 0.179 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 64 cost time: 0.5866689682006836
Epoch: 64, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.170 Vali Acc: 0.975 Test Loss: 0.170 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 65 cost time: 0.5259044170379639
Epoch: 65, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.162 Vali Acc: 0.975 Test Loss: 0.162 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 66 cost time: 0.4776170253753662
Epoch: 66, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.156 Vali Acc: 0.975 Test Loss: 0.156 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 67 cost time: 0.5894920825958252
Epoch: 67, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.147 Vali Acc: 0.975 Test Loss: 0.147 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 68 cost time: 0.5171842575073242
Epoch: 68, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.140 Vali Acc: 0.950 Test Loss: 0.140 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.4654417037963867
Epoch: 69, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.135 Vali Acc: 0.950 Test Loss: 0.135 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 0.42847466468811035
Epoch: 70, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.132 Vali Acc: 0.950 Test Loss: 0.132 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 0.5723485946655273
Epoch: 71, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.128 Vali Acc: 0.950 Test Loss: 0.128 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 0.515413761138916
Epoch: 72, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.125 Vali Acc: 0.950 Test Loss: 0.125 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 0.5190117359161377
Epoch: 73, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.124 Vali Acc: 0.950 Test Loss: 0.124 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 0.5408966541290283
Epoch: 74, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.123 Vali Acc: 0.950 Test Loss: 0.123 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 0.5916707515716553
Epoch: 75, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.121 Vali Acc: 0.950 Test Loss: 0.121 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 76 cost time: 0.562333345413208
Epoch: 76, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.120 Vali Acc: 0.950 Test Loss: 0.120 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 77 cost time: 0.5365166664123535
Epoch: 77, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.118 Vali Acc: 0.950 Test Loss: 0.118 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm128_cs50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 23832
model size : 0.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm128_cs34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.901158332824707
Epoch: 1, Steps: 3 | Train Loss: 1.406 Vali Loss: 1.470 Vali Acc: 0.175 Test Loss: 1.470 Test Acc: 0.175
Validation loss decreased (inf --> -0.174985).  Saving model ...
Epoch: 2 cost time: 0.4899773597717285
Epoch: 2, Steps: 3 | Train Loss: 1.402 Vali Loss: 1.462 Vali Acc: 0.200 Test Loss: 1.462 Test Acc: 0.200
Validation loss decreased (-0.174985 --> -0.199985).  Saving model ...
Epoch: 3 cost time: 0.6162905693054199
Epoch: 3, Steps: 3 | Train Loss: 1.368 Vali Loss: 1.456 Vali Acc: 0.225 Test Loss: 1.456 Test Acc: 0.225
Validation loss decreased (-0.199985 --> -0.224985).  Saving model ...
Epoch: 4 cost time: 0.5837042331695557
Epoch: 4, Steps: 3 | Train Loss: 1.372 Vali Loss: 1.447 Vali Acc: 0.250 Test Loss: 1.447 Test Acc: 0.250
Validation loss decreased (-0.224985 --> -0.249986).  Saving model ...
Epoch: 5 cost time: 0.5048387050628662
Epoch: 5, Steps: 3 | Train Loss: 1.345 Vali Loss: 1.437 Vali Acc: 0.275 Test Loss: 1.437 Test Acc: 0.275
Validation loss decreased (-0.249986 --> -0.274986).  Saving model ...
Epoch: 6 cost time: 0.5578556060791016
Epoch: 6, Steps: 3 | Train Loss: 1.334 Vali Loss: 1.426 Vali Acc: 0.325 Test Loss: 1.426 Test Acc: 0.325
Validation loss decreased (-0.274986 --> -0.324986).  Saving model ...
Epoch: 7 cost time: 0.48226189613342285
Epoch: 7, Steps: 3 | Train Loss: 1.285 Vali Loss: 1.413 Vali Acc: 0.325 Test Loss: 1.413 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324986).  Saving model ...
Epoch: 8 cost time: 0.4908473491668701
Epoch: 8, Steps: 3 | Train Loss: 1.273 Vali Loss: 1.399 Vali Acc: 0.350 Test Loss: 1.399 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349986).  Saving model ...
Epoch: 9 cost time: 0.5179741382598877
Epoch: 9, Steps: 3 | Train Loss: 1.243 Vali Loss: 1.385 Vali Acc: 0.350 Test Loss: 1.385 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 10 cost time: 0.5402863025665283
Epoch: 10, Steps: 3 | Train Loss: 1.204 Vali Loss: 1.369 Vali Acc: 0.425 Test Loss: 1.369 Test Acc: 0.425
Validation loss decreased (-0.349986 --> -0.424986).  Saving model ...
Epoch: 11 cost time: 0.5241131782531738
Epoch: 11, Steps: 3 | Train Loss: 1.162 Vali Loss: 1.353 Vali Acc: 0.450 Test Loss: 1.353 Test Acc: 0.450
Validation loss decreased (-0.424986 --> -0.449986).  Saving model ...
Epoch: 12 cost time: 0.4664802551269531
Epoch: 12, Steps: 3 | Train Loss: 1.161 Vali Loss: 1.336 Vali Acc: 0.450 Test Loss: 1.336 Test Acc: 0.450
Validation loss decreased (-0.449986 --> -0.449987).  Saving model ...
Epoch: 13 cost time: 0.48357200622558594
Epoch: 13, Steps: 3 | Train Loss: 1.135 Vali Loss: 1.319 Vali Acc: 0.500 Test Loss: 1.319 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499987).  Saving model ...
Epoch: 14 cost time: 0.45027637481689453
Epoch: 14, Steps: 3 | Train Loss: 1.093 Vali Loss: 1.302 Vali Acc: 0.525 Test Loss: 1.302 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524987).  Saving model ...
Epoch: 15 cost time: 0.5656373500823975
Epoch: 15, Steps: 3 | Train Loss: 1.043 Vali Loss: 1.284 Vali Acc: 0.550 Test Loss: 1.284 Test Acc: 0.550
Validation loss decreased (-0.524987 --> -0.549987).  Saving model ...
Epoch: 16 cost time: 0.5322892665863037
Epoch: 16, Steps: 3 | Train Loss: 0.992 Vali Loss: 1.266 Vali Acc: 0.575 Test Loss: 1.266 Test Acc: 0.575
Validation loss decreased (-0.549987 --> -0.574987).  Saving model ...
Epoch: 17 cost time: 0.5343329906463623
Epoch: 17, Steps: 3 | Train Loss: 0.973 Vali Loss: 1.248 Vali Acc: 0.575 Test Loss: 1.248 Test Acc: 0.575
Validation loss decreased (-0.574987 --> -0.574988).  Saving model ...
Epoch: 18 cost time: 0.6030018329620361
Epoch: 18, Steps: 3 | Train Loss: 0.909 Vali Loss: 1.230 Vali Acc: 0.600 Test Loss: 1.230 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599988).  Saving model ...
Epoch: 19 cost time: 0.5596215724945068
Epoch: 19, Steps: 3 | Train Loss: 0.925 Vali Loss: 1.211 Vali Acc: 0.600 Test Loss: 1.211 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 20 cost time: 0.5991277694702148
Epoch: 20, Steps: 3 | Train Loss: 0.877 Vali Loss: 1.191 Vali Acc: 0.600 Test Loss: 1.191 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 21 cost time: 0.5613009929656982
Epoch: 21, Steps: 3 | Train Loss: 0.855 Vali Loss: 1.173 Vali Acc: 0.600 Test Loss: 1.173 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 22 cost time: 0.40936803817749023
Epoch: 22, Steps: 3 | Train Loss: 0.836 Vali Loss: 1.155 Vali Acc: 0.625 Test Loss: 1.155 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624988).  Saving model ...
Epoch: 23 cost time: 0.5640783309936523
Epoch: 23, Steps: 3 | Train Loss: 0.802 Vali Loss: 1.137 Vali Acc: 0.625 Test Loss: 1.137 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624989).  Saving model ...
Epoch: 24 cost time: 0.45622849464416504
Epoch: 24, Steps: 3 | Train Loss: 0.782 Vali Loss: 1.117 Vali Acc: 0.625 Test Loss: 1.117 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 25 cost time: 0.43948864936828613
Epoch: 25, Steps: 3 | Train Loss: 0.716 Vali Loss: 1.098 Vali Acc: 0.675 Test Loss: 1.098 Test Acc: 0.675
Validation loss decreased (-0.624989 --> -0.674989).  Saving model ...
Epoch: 26 cost time: 0.5359442234039307
Epoch: 26, Steps: 3 | Train Loss: 0.739 Vali Loss: 1.080 Vali Acc: 0.675 Test Loss: 1.080 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 27 cost time: 0.5289261341094971
Epoch: 27, Steps: 3 | Train Loss: 0.718 Vali Loss: 1.062 Vali Acc: 0.675 Test Loss: 1.062 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 28 cost time: 0.45397019386291504
Epoch: 28, Steps: 3 | Train Loss: 0.658 Vali Loss: 1.044 Vali Acc: 0.725 Test Loss: 1.044 Test Acc: 0.725
Validation loss decreased (-0.674989 --> -0.724990).  Saving model ...
Epoch: 29 cost time: 0.4839603900909424
Epoch: 29, Steps: 3 | Train Loss: 0.639 Vali Loss: 1.026 Vali Acc: 0.750 Test Loss: 1.026 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749990).  Saving model ...
Epoch: 30 cost time: 0.4355471134185791
Epoch: 30, Steps: 3 | Train Loss: 0.635 Vali Loss: 1.007 Vali Acc: 0.750 Test Loss: 1.007 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 31 cost time: 0.5007185935974121
Epoch: 31, Steps: 3 | Train Loss: 0.630 Vali Loss: 0.987 Vali Acc: 0.775 Test Loss: 0.987 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774990).  Saving model ...
Epoch: 32 cost time: 0.47797250747680664
Epoch: 32, Steps: 3 | Train Loss: 0.633 Vali Loss: 0.969 Vali Acc: 0.775 Test Loss: 0.969 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774990).  Saving model ...
Epoch: 33 cost time: 0.5864119529724121
Epoch: 33, Steps: 3 | Train Loss: 0.550 Vali Loss: 0.952 Vali Acc: 0.775 Test Loss: 0.952 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774990).  Saving model ...
Epoch: 34 cost time: 0.42081451416015625
Epoch: 34, Steps: 3 | Train Loss: 0.545 Vali Loss: 0.935 Vali Acc: 0.775 Test Loss: 0.935 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774991).  Saving model ...
Epoch: 35 cost time: 0.4833712577819824
Epoch: 35, Steps: 3 | Train Loss: 0.482 Vali Loss: 0.918 Vali Acc: 0.800 Test Loss: 0.918 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799991).  Saving model ...
Epoch: 36 cost time: 0.47833871841430664
Epoch: 36, Steps: 3 | Train Loss: 0.526 Vali Loss: 0.903 Vali Acc: 0.800 Test Loss: 0.903 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 37 cost time: 0.5018937587738037
Epoch: 37, Steps: 3 | Train Loss: 0.510 Vali Loss: 0.888 Vali Acc: 0.800 Test Loss: 0.888 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 38 cost time: 0.5289232730865479
Epoch: 38, Steps: 3 | Train Loss: 0.473 Vali Loss: 0.874 Vali Acc: 0.800 Test Loss: 0.874 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 39 cost time: 0.45179176330566406
Epoch: 39, Steps: 3 | Train Loss: 0.464 Vali Loss: 0.860 Vali Acc: 0.800 Test Loss: 0.860 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 40 cost time: 0.3991267681121826
Epoch: 40, Steps: 3 | Train Loss: 0.461 Vali Loss: 0.845 Vali Acc: 0.775 Test Loss: 0.845 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.47254157066345215
Epoch: 41, Steps: 3 | Train Loss: 0.415 Vali Loss: 0.832 Vali Acc: 0.800 Test Loss: 0.832 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799992).  Saving model ...
Epoch: 42 cost time: 0.5022566318511963
Epoch: 42, Steps: 3 | Train Loss: 0.433 Vali Loss: 0.819 Vali Acc: 0.800 Test Loss: 0.819 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 43 cost time: 0.4284665584564209
Epoch: 43, Steps: 3 | Train Loss: 0.404 Vali Loss: 0.805 Vali Acc: 0.800 Test Loss: 0.805 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 44 cost time: 0.45722365379333496
Epoch: 44, Steps: 3 | Train Loss: 0.392 Vali Loss: 0.792 Vali Acc: 0.775 Test Loss: 0.792 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.5279562473297119
Epoch: 45, Steps: 3 | Train Loss: 0.404 Vali Loss: 0.777 Vali Acc: 0.775 Test Loss: 0.777 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.5319995880126953
Epoch: 46, Steps: 3 | Train Loss: 0.365 Vali Loss: 0.763 Vali Acc: 0.775 Test Loss: 0.763 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.5017106533050537
Epoch: 47, Steps: 3 | Train Loss: 0.354 Vali Loss: 0.746 Vali Acc: 0.775 Test Loss: 0.746 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.4718210697174072
Epoch: 48, Steps: 3 | Train Loss: 0.322 Vali Loss: 0.728 Vali Acc: 0.775 Test Loss: 0.728 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.5772726535797119
Epoch: 49, Steps: 3 | Train Loss: 0.323 Vali Loss: 0.711 Vali Acc: 0.775 Test Loss: 0.711 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.5068709850311279
Epoch: 50, Steps: 3 | Train Loss: 0.315 Vali Loss: 0.693 Vali Acc: 0.775 Test Loss: 0.693 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 0.5188553333282471
Epoch: 51, Steps: 3 | Train Loss: 0.289 Vali Loss: 0.674 Vali Acc: 0.775 Test Loss: 0.674 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 0.5249481201171875
Epoch: 52, Steps: 3 | Train Loss: 0.294 Vali Loss: 0.654 Vali Acc: 0.800 Test Loss: 0.654 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799993).  Saving model ...
Epoch: 53 cost time: 0.49231505393981934
Epoch: 53, Steps: 3 | Train Loss: 0.281 Vali Loss: 0.635 Vali Acc: 0.800 Test Loss: 0.635 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799994).  Saving model ...
Epoch: 54 cost time: 0.5713484287261963
Epoch: 54, Steps: 3 | Train Loss: 0.265 Vali Loss: 0.615 Vali Acc: 0.800 Test Loss: 0.615 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 55 cost time: 0.5213057994842529
Epoch: 55, Steps: 3 | Train Loss: 0.267 Vali Loss: 0.595 Vali Acc: 0.825 Test Loss: 0.595 Test Acc: 0.825
Validation loss decreased (-0.799994 --> -0.824994).  Saving model ...
Epoch: 56 cost time: 0.5399813652038574
Epoch: 56, Steps: 3 | Train Loss: 0.244 Vali Loss: 0.574 Vali Acc: 0.825 Test Loss: 0.574 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 57 cost time: 0.4808473587036133
Epoch: 57, Steps: 3 | Train Loss: 0.247 Vali Loss: 0.550 Vali Acc: 0.825 Test Loss: 0.550 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 58 cost time: 0.5883097648620605
Epoch: 58, Steps: 3 | Train Loss: 0.214 Vali Loss: 0.525 Vali Acc: 0.850 Test Loss: 0.525 Test Acc: 0.850
Validation loss decreased (-0.824994 --> -0.849995).  Saving model ...
Epoch: 59 cost time: 0.558821439743042
Epoch: 59, Steps: 3 | Train Loss: 0.240 Vali Loss: 0.502 Vali Acc: 0.850 Test Loss: 0.502 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 60 cost time: 0.555152416229248
Epoch: 60, Steps: 3 | Train Loss: 0.206 Vali Loss: 0.479 Vali Acc: 0.850 Test Loss: 0.479 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 61 cost time: 0.685004711151123
Epoch: 61, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.457 Vali Acc: 0.875 Test Loss: 0.457 Test Acc: 0.875
Validation loss decreased (-0.849995 --> -0.874995).  Saving model ...
Epoch: 62 cost time: 0.6110925674438477
Epoch: 62, Steps: 3 | Train Loss: 0.189 Vali Loss: 0.438 Vali Acc: 0.900 Test Loss: 0.438 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899996).  Saving model ...
Epoch: 63 cost time: 0.6709647178649902
Epoch: 63, Steps: 3 | Train Loss: 0.170 Vali Loss: 0.419 Vali Acc: 0.900 Test Loss: 0.419 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 64 cost time: 0.6354775428771973
Epoch: 64, Steps: 3 | Train Loss: 0.149 Vali Loss: 0.401 Vali Acc: 0.900 Test Loss: 0.401 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 65 cost time: 0.5855193138122559
Epoch: 65, Steps: 3 | Train Loss: 0.152 Vali Loss: 0.386 Vali Acc: 0.900 Test Loss: 0.386 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 66 cost time: 0.607867956161499
Epoch: 66, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.372 Vali Acc: 0.900 Test Loss: 0.372 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 67 cost time: 0.6118040084838867
Epoch: 67, Steps: 3 | Train Loss: 0.109 Vali Loss: 0.362 Vali Acc: 0.900 Test Loss: 0.362 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 68 cost time: 0.7574856281280518
Epoch: 68, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.355 Vali Acc: 0.925 Test Loss: 0.355 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 69 cost time: 0.5717341899871826
Epoch: 69, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.350 Vali Acc: 0.925 Test Loss: 0.350 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 70 cost time: 0.6677184104919434
Epoch: 70, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.347 Vali Acc: 0.925 Test Loss: 0.347 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 71 cost time: 0.634688138961792
Epoch: 71, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.346 Vali Acc: 0.900 Test Loss: 0.346 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 0.5819516181945801
Epoch: 72, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.345 Vali Acc: 0.900 Test Loss: 0.345 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 0.6358747482299805
Epoch: 73, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.344 Vali Acc: 0.850 Test Loss: 0.344 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 0.685438871383667
Epoch: 74, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.346 Vali Acc: 0.850 Test Loss: 0.346 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 0.6930527687072754
Epoch: 75, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.350 Vali Acc: 0.850 Test Loss: 0.350 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 0.6325249671936035
Epoch: 76, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.355 Vali Acc: 0.850 Test Loss: 0.355 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 77 cost time: 0.7219586372375488
Epoch: 77, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.361 Vali Acc: 0.825 Test Loss: 0.361 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 78 cost time: 0.5418453216552734
Epoch: 78, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.365 Vali Acc: 0.825 Test Loss: 0.365 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 79 cost time: 0.6861751079559326
Epoch: 79, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.372 Vali Acc: 0.825 Test Loss: 0.372 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 80 cost time: 0.6444921493530273
Epoch: 80, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.380 Vali Acc: 0.825 Test Loss: 0.380 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm128_cs34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 23022
model size : 0.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm128_cs25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.4254636764526367
Epoch: 1, Steps: 3 | Train Loss: 1.501 Vali Loss: 1.522 Vali Acc: 0.050 Test Loss: 1.522 Test Acc: 0.050
Validation loss decreased (inf --> -0.049985).  Saving model ...
Epoch: 2 cost time: 0.4438936710357666
Epoch: 2, Steps: 3 | Train Loss: 1.472 Vali Loss: 1.515 Vali Acc: 0.050 Test Loss: 1.515 Test Acc: 0.050
Validation loss decreased (-0.049985 --> -0.049985).  Saving model ...
Epoch: 3 cost time: 0.43680405616760254
Epoch: 3, Steps: 3 | Train Loss: 1.452 Vali Loss: 1.509 Vali Acc: 0.050 Test Loss: 1.509 Test Acc: 0.050
Validation loss decreased (-0.049985 --> -0.049985).  Saving model ...
Epoch: 4 cost time: 0.439547061920166
Epoch: 4, Steps: 3 | Train Loss: 1.428 Vali Loss: 1.501 Vali Acc: 0.050 Test Loss: 1.501 Test Acc: 0.050
Validation loss decreased (-0.049985 --> -0.049985).  Saving model ...
Epoch: 5 cost time: 0.43467092514038086
Epoch: 5, Steps: 3 | Train Loss: 1.374 Vali Loss: 1.491 Vali Acc: 0.050 Test Loss: 1.491 Test Acc: 0.050
Validation loss decreased (-0.049985 --> -0.049985).  Saving model ...
Epoch: 6 cost time: 0.4503898620605469
Epoch: 6, Steps: 3 | Train Loss: 1.368 Vali Loss: 1.480 Vali Acc: 0.050 Test Loss: 1.480 Test Acc: 0.050
Validation loss decreased (-0.049985 --> -0.049985).  Saving model ...
Epoch: 7 cost time: 0.4510812759399414
Epoch: 7, Steps: 3 | Train Loss: 1.353 Vali Loss: 1.468 Vali Acc: 0.075 Test Loss: 1.468 Test Acc: 0.075
Validation loss decreased (-0.049985 --> -0.074985).  Saving model ...
Epoch: 8 cost time: 0.4810497760772705
Epoch: 8, Steps: 3 | Train Loss: 1.285 Vali Loss: 1.455 Vali Acc: 0.075 Test Loss: 1.455 Test Acc: 0.075
Validation loss decreased (-0.074985 --> -0.074985).  Saving model ...
Epoch: 9 cost time: 0.43547511100769043
Epoch: 9, Steps: 3 | Train Loss: 1.332 Vali Loss: 1.442 Vali Acc: 0.125 Test Loss: 1.442 Test Acc: 0.125
Validation loss decreased (-0.074985 --> -0.124986).  Saving model ...
Epoch: 10 cost time: 0.3908424377441406
Epoch: 10, Steps: 3 | Train Loss: 1.274 Vali Loss: 1.428 Vali Acc: 0.175 Test Loss: 1.428 Test Acc: 0.175
Validation loss decreased (-0.124986 --> -0.174986).  Saving model ...
Epoch: 11 cost time: 0.4911184310913086
Epoch: 11, Steps: 3 | Train Loss: 1.250 Vali Loss: 1.413 Vali Acc: 0.175 Test Loss: 1.413 Test Acc: 0.175
Validation loss decreased (-0.174986 --> -0.174986).  Saving model ...
Epoch: 12 cost time: 0.459270715713501
Epoch: 12, Steps: 3 | Train Loss: 1.232 Vali Loss: 1.398 Vali Acc: 0.200 Test Loss: 1.398 Test Acc: 0.200
Validation loss decreased (-0.174986 --> -0.199986).  Saving model ...
Epoch: 13 cost time: 0.4532053470611572
Epoch: 13, Steps: 3 | Train Loss: 1.200 Vali Loss: 1.382 Vali Acc: 0.250 Test Loss: 1.382 Test Acc: 0.250
Validation loss decreased (-0.199986 --> -0.249986).  Saving model ...
Epoch: 14 cost time: 0.4577021598815918
Epoch: 14, Steps: 3 | Train Loss: 1.134 Vali Loss: 1.367 Vali Acc: 0.275 Test Loss: 1.367 Test Acc: 0.275
Validation loss decreased (-0.249986 --> -0.274986).  Saving model ...
Epoch: 15 cost time: 0.4190950393676758
Epoch: 15, Steps: 3 | Train Loss: 1.126 Vali Loss: 1.350 Vali Acc: 0.325 Test Loss: 1.350 Test Acc: 0.325
Validation loss decreased (-0.274986 --> -0.324986).  Saving model ...
Epoch: 16 cost time: 0.4724719524383545
Epoch: 16, Steps: 3 | Train Loss: 1.115 Vali Loss: 1.334 Vali Acc: 0.350 Test Loss: 1.334 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349987).  Saving model ...
Epoch: 17 cost time: 0.4599311351776123
Epoch: 17, Steps: 3 | Train Loss: 1.055 Vali Loss: 1.317 Vali Acc: 0.350 Test Loss: 1.317 Test Acc: 0.350
Validation loss decreased (-0.349987 --> -0.349987).  Saving model ...
Epoch: 18 cost time: 0.3750646114349365
Epoch: 18, Steps: 3 | Train Loss: 0.993 Vali Loss: 1.299 Vali Acc: 0.350 Test Loss: 1.299 Test Acc: 0.350
Validation loss decreased (-0.349987 --> -0.349987).  Saving model ...
Epoch: 19 cost time: 0.45626068115234375
Epoch: 19, Steps: 3 | Train Loss: 1.023 Vali Loss: 1.282 Vali Acc: 0.350 Test Loss: 1.282 Test Acc: 0.350
Validation loss decreased (-0.349987 --> -0.349987).  Saving model ...
Epoch: 20 cost time: 0.41907644271850586
Epoch: 20, Steps: 3 | Train Loss: 0.953 Vali Loss: 1.264 Vali Acc: 0.400 Test Loss: 1.264 Test Acc: 0.400
Validation loss decreased (-0.349987 --> -0.399987).  Saving model ...
Epoch: 21 cost time: 0.4279913902282715
Epoch: 21, Steps: 3 | Train Loss: 0.928 Vali Loss: 1.247 Vali Acc: 0.450 Test Loss: 1.247 Test Acc: 0.450
Validation loss decreased (-0.399987 --> -0.449988).  Saving model ...
Epoch: 22 cost time: 0.44464731216430664
Epoch: 22, Steps: 3 | Train Loss: 0.927 Vali Loss: 1.229 Vali Acc: 0.450 Test Loss: 1.229 Test Acc: 0.450
Validation loss decreased (-0.449988 --> -0.449988).  Saving model ...
Epoch: 23 cost time: 0.516742467880249
Epoch: 23, Steps: 3 | Train Loss: 0.888 Vali Loss: 1.210 Vali Acc: 0.475 Test Loss: 1.210 Test Acc: 0.475
Validation loss decreased (-0.449988 --> -0.474988).  Saving model ...
Epoch: 24 cost time: 0.5542593002319336
Epoch: 24, Steps: 3 | Train Loss: 0.850 Vali Loss: 1.192 Vali Acc: 0.475 Test Loss: 1.192 Test Acc: 0.475
Validation loss decreased (-0.474988 --> -0.474988).  Saving model ...
Epoch: 25 cost time: 0.40319108963012695
Epoch: 25, Steps: 3 | Train Loss: 0.816 Vali Loss: 1.174 Vali Acc: 0.500 Test Loss: 1.174 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499988).  Saving model ...
Epoch: 26 cost time: 0.5079982280731201
Epoch: 26, Steps: 3 | Train Loss: 0.805 Vali Loss: 1.157 Vali Acc: 0.500 Test Loss: 1.157 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 27 cost time: 0.4673187732696533
Epoch: 27, Steps: 3 | Train Loss: 0.819 Vali Loss: 1.139 Vali Acc: 0.550 Test Loss: 1.139 Test Acc: 0.550
Validation loss decreased (-0.499988 --> -0.549989).  Saving model ...
Epoch: 28 cost time: 0.4373297691345215
Epoch: 28, Steps: 3 | Train Loss: 0.765 Vali Loss: 1.122 Vali Acc: 0.600 Test Loss: 1.122 Test Acc: 0.600
Validation loss decreased (-0.549989 --> -0.599989).  Saving model ...
Epoch: 29 cost time: 0.4841725826263428
Epoch: 29, Steps: 3 | Train Loss: 0.696 Vali Loss: 1.106 Vali Acc: 0.650 Test Loss: 1.106 Test Acc: 0.650
Validation loss decreased (-0.599989 --> -0.649989).  Saving model ...
Epoch: 30 cost time: 0.45313572883605957
Epoch: 30, Steps: 3 | Train Loss: 0.686 Vali Loss: 1.089 Vali Acc: 0.650 Test Loss: 1.089 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 31 cost time: 0.5472185611724854
Epoch: 31, Steps: 3 | Train Loss: 0.683 Vali Loss: 1.073 Vali Acc: 0.650 Test Loss: 1.073 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 32 cost time: 0.4617486000061035
Epoch: 32, Steps: 3 | Train Loss: 0.651 Vali Loss: 1.058 Vali Acc: 0.700 Test Loss: 1.058 Test Acc: 0.700
Validation loss decreased (-0.649989 --> -0.699989).  Saving model ...
Epoch: 33 cost time: 0.4449756145477295
Epoch: 33, Steps: 3 | Train Loss: 0.640 Vali Loss: 1.043 Vali Acc: 0.700 Test Loss: 1.043 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699990).  Saving model ...
Epoch: 34 cost time: 0.5277855396270752
Epoch: 34, Steps: 3 | Train Loss: 0.608 Vali Loss: 1.028 Vali Acc: 0.675 Test Loss: 1.028 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.5540533065795898
Epoch: 35, Steps: 3 | Train Loss: 0.595 Vali Loss: 1.013 Vali Acc: 0.675 Test Loss: 1.013 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.437222957611084
Epoch: 36, Steps: 3 | Train Loss: 0.580 Vali Loss: 1.000 Vali Acc: 0.675 Test Loss: 1.000 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.4511449337005615
Epoch: 37, Steps: 3 | Train Loss: 0.548 Vali Loss: 0.987 Vali Acc: 0.675 Test Loss: 0.987 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.5835037231445312
Epoch: 38, Steps: 3 | Train Loss: 0.495 Vali Loss: 0.975 Vali Acc: 0.675 Test Loss: 0.975 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.5472137928009033
Epoch: 39, Steps: 3 | Train Loss: 0.535 Vali Loss: 0.964 Vali Acc: 0.650 Test Loss: 0.964 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.4392881393432617
Epoch: 40, Steps: 3 | Train Loss: 0.512 Vali Loss: 0.953 Vali Acc: 0.650 Test Loss: 0.953 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.44780540466308594
Epoch: 41, Steps: 3 | Train Loss: 0.476 Vali Loss: 0.943 Vali Acc: 0.700 Test Loss: 0.943 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699991).  Saving model ...
Epoch: 42 cost time: 0.4672696590423584
Epoch: 42, Steps: 3 | Train Loss: 0.437 Vali Loss: 0.932 Vali Acc: 0.700 Test Loss: 0.932 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 43 cost time: 0.5686941146850586
Epoch: 43, Steps: 3 | Train Loss: 0.450 Vali Loss: 0.922 Vali Acc: 0.700 Test Loss: 0.922 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 44 cost time: 0.5779118537902832
Epoch: 44, Steps: 3 | Train Loss: 0.421 Vali Loss: 0.913 Vali Acc: 0.725 Test Loss: 0.913 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724991).  Saving model ...
Epoch: 45 cost time: 0.5047492980957031
Epoch: 45, Steps: 3 | Train Loss: 0.402 Vali Loss: 0.903 Vali Acc: 0.725 Test Loss: 0.903 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 46 cost time: 0.47948741912841797
Epoch: 46, Steps: 3 | Train Loss: 0.389 Vali Loss: 0.894 Vali Acc: 0.725 Test Loss: 0.894 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 47 cost time: 0.3972744941711426
Epoch: 47, Steps: 3 | Train Loss: 0.391 Vali Loss: 0.886 Vali Acc: 0.725 Test Loss: 0.886 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 48 cost time: 0.3959214687347412
Epoch: 48, Steps: 3 | Train Loss: 0.359 Vali Loss: 0.878 Vali Acc: 0.725 Test Loss: 0.878 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 49 cost time: 0.4204683303833008
Epoch: 49, Steps: 3 | Train Loss: 0.371 Vali Loss: 0.870 Vali Acc: 0.750 Test Loss: 0.870 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749991).  Saving model ...
Epoch: 50 cost time: 0.44958972930908203
Epoch: 50, Steps: 3 | Train Loss: 0.370 Vali Loss: 0.862 Vali Acc: 0.750 Test Loss: 0.862 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 51 cost time: 0.42964673042297363
Epoch: 51, Steps: 3 | Train Loss: 0.319 Vali Loss: 0.855 Vali Acc: 0.750 Test Loss: 0.855 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 52 cost time: 0.45592260360717773
Epoch: 52, Steps: 3 | Train Loss: 0.328 Vali Loss: 0.848 Vali Acc: 0.750 Test Loss: 0.848 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 53 cost time: 0.43336963653564453
Epoch: 53, Steps: 3 | Train Loss: 0.332 Vali Loss: 0.842 Vali Acc: 0.750 Test Loss: 0.842 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 54 cost time: 0.37584400177001953
Epoch: 54, Steps: 3 | Train Loss: 0.315 Vali Loss: 0.837 Vali Acc: 0.750 Test Loss: 0.837 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 55 cost time: 0.5223045349121094
Epoch: 55, Steps: 3 | Train Loss: 0.320 Vali Loss: 0.832 Vali Acc: 0.750 Test Loss: 0.832 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 56 cost time: 0.44255566596984863
Epoch: 56, Steps: 3 | Train Loss: 0.293 Vali Loss: 0.827 Vali Acc: 0.800 Test Loss: 0.827 Test Acc: 0.800
Validation loss decreased (-0.749992 --> -0.799992).  Saving model ...
Epoch: 57 cost time: 0.3881537914276123
Epoch: 57, Steps: 3 | Train Loss: 0.271 Vali Loss: 0.823 Vali Acc: 0.800 Test Loss: 0.823 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 58 cost time: 0.42070436477661133
Epoch: 58, Steps: 3 | Train Loss: 0.268 Vali Loss: 0.819 Vali Acc: 0.800 Test Loss: 0.819 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 59 cost time: 0.46323585510253906
Epoch: 59, Steps: 3 | Train Loss: 0.256 Vali Loss: 0.815 Vali Acc: 0.800 Test Loss: 0.815 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 60 cost time: 0.6144113540649414
Epoch: 60, Steps: 3 | Train Loss: 0.250 Vali Loss: 0.812 Vali Acc: 0.800 Test Loss: 0.812 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 61 cost time: 0.388242244720459
Epoch: 61, Steps: 3 | Train Loss: 0.240 Vali Loss: 0.809 Vali Acc: 0.800 Test Loss: 0.809 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 62 cost time: 0.5200338363647461
Epoch: 62, Steps: 3 | Train Loss: 0.239 Vali Loss: 0.807 Vali Acc: 0.800 Test Loss: 0.807 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 63 cost time: 0.5261709690093994
Epoch: 63, Steps: 3 | Train Loss: 0.226 Vali Loss: 0.804 Vali Acc: 0.800 Test Loss: 0.804 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 64 cost time: 0.4873466491699219
Epoch: 64, Steps: 3 | Train Loss: 0.225 Vali Loss: 0.802 Vali Acc: 0.800 Test Loss: 0.802 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 65 cost time: 0.4445343017578125
Epoch: 65, Steps: 3 | Train Loss: 0.226 Vali Loss: 0.801 Vali Acc: 0.800 Test Loss: 0.801 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 66 cost time: 0.5120804309844971
Epoch: 66, Steps: 3 | Train Loss: 0.208 Vali Loss: 0.798 Vali Acc: 0.800 Test Loss: 0.798 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 67 cost time: 0.4884762763977051
Epoch: 67, Steps: 3 | Train Loss: 0.195 Vali Loss: 0.795 Vali Acc: 0.800 Test Loss: 0.795 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 68 cost time: 0.42223453521728516
Epoch: 68, Steps: 3 | Train Loss: 0.188 Vali Loss: 0.791 Vali Acc: 0.825 Test Loss: 0.791 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824992).  Saving model ...
Epoch: 69 cost time: 0.4962019920349121
Epoch: 69, Steps: 3 | Train Loss: 0.188 Vali Loss: 0.786 Vali Acc: 0.800 Test Loss: 0.786 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.527857780456543
Epoch: 70, Steps: 3 | Train Loss: 0.193 Vali Loss: 0.783 Vali Acc: 0.800 Test Loss: 0.783 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 0.5050544738769531
Epoch: 71, Steps: 3 | Train Loss: 0.165 Vali Loss: 0.780 Vali Acc: 0.825 Test Loss: 0.780 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 72 cost time: 0.45907044410705566
Epoch: 72, Steps: 3 | Train Loss: 0.182 Vali Loss: 0.779 Vali Acc: 0.825 Test Loss: 0.779 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 73 cost time: 0.5803396701812744
Epoch: 73, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.776 Vali Acc: 0.825 Test Loss: 0.776 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 74 cost time: 0.5004568099975586
Epoch: 74, Steps: 3 | Train Loss: 0.177 Vali Loss: 0.773 Vali Acc: 0.825 Test Loss: 0.773 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 75 cost time: 0.44505882263183594
Epoch: 75, Steps: 3 | Train Loss: 0.156 Vali Loss: 0.769 Vali Acc: 0.825 Test Loss: 0.769 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 76 cost time: 0.4219799041748047
Epoch: 76, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.769 Vali Acc: 0.825 Test Loss: 0.769 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 77 cost time: 0.49589991569519043
Epoch: 77, Steps: 3 | Train Loss: 0.138 Vali Loss: 0.767 Vali Acc: 0.825 Test Loss: 0.767 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 78 cost time: 0.44991302490234375
Epoch: 78, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.764 Vali Acc: 0.825 Test Loss: 0.764 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 79 cost time: 0.5884761810302734
Epoch: 79, Steps: 3 | Train Loss: 0.109 Vali Loss: 0.760 Vali Acc: 0.825 Test Loss: 0.760 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 80 cost time: 0.4126908779144287
Epoch: 80, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.755 Vali Acc: 0.825 Test Loss: 0.755 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 81 cost time: 0.41097092628479004
Epoch: 81, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.750 Vali Acc: 0.825 Test Loss: 0.750 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 82 cost time: 0.487947940826416
Epoch: 82, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.748 Vali Acc: 0.825 Test Loss: 0.748 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824993).  Saving model ...
Epoch: 83 cost time: 0.4513881206512451
Epoch: 83, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.749 Vali Acc: 0.825 Test Loss: 0.749 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 0.4890923500061035
Epoch: 84, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.751 Vali Acc: 0.825 Test Loss: 0.751 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 0.5187287330627441
Epoch: 85, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.752 Vali Acc: 0.825 Test Loss: 0.752 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 86 cost time: 0.45118188858032227
Epoch: 86, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.754 Vali Acc: 0.825 Test Loss: 0.754 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 87 cost time: 0.5526845455169678
Epoch: 87, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.754 Vali Acc: 0.825 Test Loss: 0.754 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 88 cost time: 0.5188429355621338
Epoch: 88, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.755 Vali Acc: 0.825 Test Loss: 0.755 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 89 cost time: 0.48380517959594727
Epoch: 89, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.755 Vali Acc: 0.825 Test Loss: 0.755 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 90 cost time: 0.47601962089538574
Epoch: 90, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.755 Vali Acc: 0.825 Test Loss: 0.755 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 91 cost time: 0.5804898738861084
Epoch: 91, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.754 Vali Acc: 0.825 Test Loss: 0.754 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 92 cost time: 0.5471248626708984
Epoch: 92, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.751 Vali Acc: 0.825 Test Loss: 0.751 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm128_cs25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.825
model parameter : 22264
model size : 0.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm128_cs20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.8291151523590088
Epoch: 1, Steps: 3 | Train Loss: 1.417 Vali Loss: 1.384 Vali Acc: 0.375 Test Loss: 1.384 Test Acc: 0.375
Validation loss decreased (inf --> -0.374986).  Saving model ...
Epoch: 2 cost time: 0.40160155296325684
Epoch: 2, Steps: 3 | Train Loss: 1.404 Vali Loss: 1.376 Vali Acc: 0.375 Test Loss: 1.376 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 3 cost time: 0.3982582092285156
Epoch: 3, Steps: 3 | Train Loss: 1.385 Vali Loss: 1.370 Vali Acc: 0.375 Test Loss: 1.370 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 4 cost time: 0.48929619789123535
Epoch: 4, Steps: 3 | Train Loss: 1.376 Vali Loss: 1.361 Vali Acc: 0.375 Test Loss: 1.361 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 5 cost time: 0.491565465927124
Epoch: 5, Steps: 3 | Train Loss: 1.313 Vali Loss: 1.351 Vali Acc: 0.375 Test Loss: 1.351 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 6 cost time: 0.5578536987304688
Epoch: 6, Steps: 3 | Train Loss: 1.322 Vali Loss: 1.339 Vali Acc: 0.400 Test Loss: 1.339 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399987).  Saving model ...
Epoch: 7 cost time: 0.4879786968231201
Epoch: 7, Steps: 3 | Train Loss: 1.310 Vali Loss: 1.327 Vali Acc: 0.400 Test Loss: 1.327 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 8 cost time: 0.4904806613922119
Epoch: 8, Steps: 3 | Train Loss: 1.257 Vali Loss: 1.313 Vali Acc: 0.450 Test Loss: 1.313 Test Acc: 0.450
Validation loss decreased (-0.399987 --> -0.449987).  Saving model ...
Epoch: 9 cost time: 0.58412766456604
Epoch: 9, Steps: 3 | Train Loss: 1.222 Vali Loss: 1.298 Vali Acc: 0.475 Test Loss: 1.298 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474987).  Saving model ...
Epoch: 10 cost time: 0.5832555294036865
Epoch: 10, Steps: 3 | Train Loss: 1.206 Vali Loss: 1.283 Vali Acc: 0.500 Test Loss: 1.283 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499987).  Saving model ...
Epoch: 11 cost time: 0.5292854309082031
Epoch: 11, Steps: 3 | Train Loss: 1.153 Vali Loss: 1.267 Vali Acc: 0.500 Test Loss: 1.267 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 12 cost time: 0.4444301128387451
Epoch: 12, Steps: 3 | Train Loss: 1.145 Vali Loss: 1.250 Vali Acc: 0.500 Test Loss: 1.250 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 13 cost time: 0.45800018310546875
Epoch: 13, Steps: 3 | Train Loss: 1.100 Vali Loss: 1.234 Vali Acc: 0.500 Test Loss: 1.234 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499988).  Saving model ...
Epoch: 14 cost time: 0.46205854415893555
Epoch: 14, Steps: 3 | Train Loss: 1.051 Vali Loss: 1.216 Vali Acc: 0.500 Test Loss: 1.216 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 15 cost time: 0.46823883056640625
Epoch: 15, Steps: 3 | Train Loss: 1.027 Vali Loss: 1.198 Vali Acc: 0.500 Test Loss: 1.198 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 16 cost time: 0.5783834457397461
Epoch: 16, Steps: 3 | Train Loss: 1.029 Vali Loss: 1.181 Vali Acc: 0.525 Test Loss: 1.181 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 17 cost time: 0.4370095729827881
Epoch: 17, Steps: 3 | Train Loss: 0.988 Vali Loss: 1.163 Vali Acc: 0.525 Test Loss: 1.163 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 18 cost time: 0.5059118270874023
Epoch: 18, Steps: 3 | Train Loss: 0.951 Vali Loss: 1.145 Vali Acc: 0.525 Test Loss: 1.145 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524989).  Saving model ...
Epoch: 19 cost time: 0.5035803318023682
Epoch: 19, Steps: 3 | Train Loss: 0.918 Vali Loss: 1.127 Vali Acc: 0.550 Test Loss: 1.127 Test Acc: 0.550
Validation loss decreased (-0.524989 --> -0.549989).  Saving model ...
Epoch: 20 cost time: 0.3563423156738281
Epoch: 20, Steps: 3 | Train Loss: 0.896 Vali Loss: 1.109 Vali Acc: 0.575 Test Loss: 1.109 Test Acc: 0.575
Validation loss decreased (-0.549989 --> -0.574989).  Saving model ...
Epoch: 21 cost time: 0.525360107421875
Epoch: 21, Steps: 3 | Train Loss: 0.813 Vali Loss: 1.091 Vali Acc: 0.575 Test Loss: 1.091 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 22 cost time: 0.4827711582183838
Epoch: 22, Steps: 3 | Train Loss: 0.803 Vali Loss: 1.075 Vali Acc: 0.625 Test Loss: 1.075 Test Acc: 0.625
Validation loss decreased (-0.574989 --> -0.624989).  Saving model ...
Epoch: 23 cost time: 0.40027284622192383
Epoch: 23, Steps: 3 | Train Loss: 0.762 Vali Loss: 1.058 Vali Acc: 0.650 Test Loss: 1.058 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 24 cost time: 0.5014340877532959
Epoch: 24, Steps: 3 | Train Loss: 0.766 Vali Loss: 1.039 Vali Acc: 0.725 Test Loss: 1.039 Test Acc: 0.725
Validation loss decreased (-0.649989 --> -0.724990).  Saving model ...
Epoch: 25 cost time: 0.5084037780761719
Epoch: 25, Steps: 3 | Train Loss: 0.749 Vali Loss: 1.021 Vali Acc: 0.775 Test Loss: 1.021 Test Acc: 0.775
Validation loss decreased (-0.724990 --> -0.774990).  Saving model ...
Epoch: 26 cost time: 0.5508875846862793
Epoch: 26, Steps: 3 | Train Loss: 0.704 Vali Loss: 1.004 Vali Acc: 0.800 Test Loss: 1.004 Test Acc: 0.800
Validation loss decreased (-0.774990 --> -0.799990).  Saving model ...
Epoch: 27 cost time: 0.46054935455322266
Epoch: 27, Steps: 3 | Train Loss: 0.686 Vali Loss: 0.988 Vali Acc: 0.800 Test Loss: 0.988 Test Acc: 0.800
Validation loss decreased (-0.799990 --> -0.799990).  Saving model ...
Epoch: 28 cost time: 0.4312760829925537
Epoch: 28, Steps: 3 | Train Loss: 0.665 Vali Loss: 0.973 Vali Acc: 0.775 Test Loss: 0.973 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6721737384796143
Epoch: 29, Steps: 3 | Train Loss: 0.631 Vali Loss: 0.958 Vali Acc: 0.800 Test Loss: 0.958 Test Acc: 0.800
Validation loss decreased (-0.799990 --> -0.799990).  Saving model ...
Epoch: 30 cost time: 0.5558910369873047
Epoch: 30, Steps: 3 | Train Loss: 0.620 Vali Loss: 0.944 Vali Acc: 0.800 Test Loss: 0.944 Test Acc: 0.800
Validation loss decreased (-0.799990 --> -0.799991).  Saving model ...
Epoch: 31 cost time: 0.5498573780059814
Epoch: 31, Steps: 3 | Train Loss: 0.574 Vali Loss: 0.931 Vali Acc: 0.800 Test Loss: 0.931 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 32 cost time: 0.4681892395019531
Epoch: 32, Steps: 3 | Train Loss: 0.571 Vali Loss: 0.918 Vali Acc: 0.775 Test Loss: 0.918 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.4963347911834717
Epoch: 33, Steps: 3 | Train Loss: 0.559 Vali Loss: 0.905 Vali Acc: 0.775 Test Loss: 0.905 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.48467326164245605
Epoch: 34, Steps: 3 | Train Loss: 0.561 Vali Loss: 0.889 Vali Acc: 0.775 Test Loss: 0.889 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.5540814399719238
Epoch: 35, Steps: 3 | Train Loss: 0.477 Vali Loss: 0.875 Vali Acc: 0.825 Test Loss: 0.875 Test Acc: 0.825
Validation loss decreased (-0.799991 --> -0.824991).  Saving model ...
Epoch: 36 cost time: 0.4822547435760498
Epoch: 36, Steps: 3 | Train Loss: 0.512 Vali Loss: 0.860 Vali Acc: 0.825 Test Loss: 0.860 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824991).  Saving model ...
Epoch: 37 cost time: 0.5194606781005859
Epoch: 37, Steps: 3 | Train Loss: 0.460 Vali Loss: 0.846 Vali Acc: 0.825 Test Loss: 0.846 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824992).  Saving model ...
Epoch: 38 cost time: 0.4652247428894043
Epoch: 38, Steps: 3 | Train Loss: 0.453 Vali Loss: 0.831 Vali Acc: 0.825 Test Loss: 0.831 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 39 cost time: 0.4405336380004883
Epoch: 39, Steps: 3 | Train Loss: 0.440 Vali Loss: 0.815 Vali Acc: 0.825 Test Loss: 0.815 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 40 cost time: 0.4880530834197998
Epoch: 40, Steps: 3 | Train Loss: 0.415 Vali Loss: 0.800 Vali Acc: 0.825 Test Loss: 0.800 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 41 cost time: 0.5435807704925537
Epoch: 41, Steps: 3 | Train Loss: 0.409 Vali Loss: 0.785 Vali Acc: 0.825 Test Loss: 0.785 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 42 cost time: 0.48300862312316895
Epoch: 42, Steps: 3 | Train Loss: 0.371 Vali Loss: 0.769 Vali Acc: 0.850 Test Loss: 0.769 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849992).  Saving model ...
Epoch: 43 cost time: 0.5022177696228027
Epoch: 43, Steps: 3 | Train Loss: 0.374 Vali Loss: 0.753 Vali Acc: 0.825 Test Loss: 0.753 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.48804187774658203
Epoch: 44, Steps: 3 | Train Loss: 0.364 Vali Loss: 0.737 Vali Acc: 0.825 Test Loss: 0.737 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.548654317855835
Epoch: 45, Steps: 3 | Train Loss: 0.362 Vali Loss: 0.717 Vali Acc: 0.825 Test Loss: 0.717 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.4644010066986084
Epoch: 46, Steps: 3 | Train Loss: 0.315 Vali Loss: 0.698 Vali Acc: 0.850 Test Loss: 0.698 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849993).  Saving model ...
Epoch: 47 cost time: 0.42342710494995117
Epoch: 47, Steps: 3 | Train Loss: 0.310 Vali Loss: 0.678 Vali Acc: 0.850 Test Loss: 0.678 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 48 cost time: 0.48239707946777344
Epoch: 48, Steps: 3 | Train Loss: 0.288 Vali Loss: 0.657 Vali Acc: 0.875 Test Loss: 0.657 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874993).  Saving model ...
Epoch: 49 cost time: 0.5483853816986084
Epoch: 49, Steps: 3 | Train Loss: 0.283 Vali Loss: 0.635 Vali Acc: 0.875 Test Loss: 0.635 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 50 cost time: 0.4563405513763428
Epoch: 50, Steps: 3 | Train Loss: 0.265 Vali Loss: 0.612 Vali Acc: 0.900 Test Loss: 0.612 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899994).  Saving model ...
Epoch: 51 cost time: 0.4354736804962158
Epoch: 51, Steps: 3 | Train Loss: 0.261 Vali Loss: 0.588 Vali Acc: 0.900 Test Loss: 0.588 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 52 cost time: 0.495084285736084
Epoch: 52, Steps: 3 | Train Loss: 0.248 Vali Loss: 0.565 Vali Acc: 0.900 Test Loss: 0.565 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 53 cost time: 0.3561515808105469
Epoch: 53, Steps: 3 | Train Loss: 0.223 Vali Loss: 0.538 Vali Acc: 0.875 Test Loss: 0.538 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.444502592086792
Epoch: 54, Steps: 3 | Train Loss: 0.226 Vali Loss: 0.510 Vali Acc: 0.900 Test Loss: 0.510 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 55 cost time: 0.4084513187408447
Epoch: 55, Steps: 3 | Train Loss: 0.226 Vali Loss: 0.479 Vali Acc: 0.900 Test Loss: 0.479 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 56 cost time: 0.489152193069458
Epoch: 56, Steps: 3 | Train Loss: 0.210 Vali Loss: 0.451 Vali Acc: 0.900 Test Loss: 0.451 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 57 cost time: 0.44153404235839844
Epoch: 57, Steps: 3 | Train Loss: 0.195 Vali Loss: 0.423 Vali Acc: 0.900 Test Loss: 0.423 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 58 cost time: 0.4027121067047119
Epoch: 58, Steps: 3 | Train Loss: 0.166 Vali Loss: 0.399 Vali Acc: 0.900 Test Loss: 0.399 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 59 cost time: 0.37116074562072754
Epoch: 59, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.374 Vali Acc: 0.925 Test Loss: 0.374 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 60 cost time: 0.6125133037567139
Epoch: 60, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.350 Vali Acc: 0.925 Test Loss: 0.350 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 61 cost time: 0.42844176292419434
Epoch: 61, Steps: 3 | Train Loss: 0.176 Vali Loss: 0.327 Vali Acc: 0.925 Test Loss: 0.327 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 62 cost time: 0.5466203689575195
Epoch: 62, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.305 Vali Acc: 0.925 Test Loss: 0.305 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 63 cost time: 0.5644292831420898
Epoch: 63, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.283 Vali Acc: 0.925 Test Loss: 0.283 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 64 cost time: 0.4966275691986084
Epoch: 64, Steps: 3 | Train Loss: 0.152 Vali Loss: 0.264 Vali Acc: 0.925 Test Loss: 0.264 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 65 cost time: 0.4996366500854492
Epoch: 65, Steps: 3 | Train Loss: 0.111 Vali Loss: 0.245 Vali Acc: 0.925 Test Loss: 0.245 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924998).  Saving model ...
Epoch: 66 cost time: 0.5371682643890381
Epoch: 66, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.229 Vali Acc: 0.925 Test Loss: 0.229 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 67 cost time: 0.6359267234802246
Epoch: 67, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.213 Vali Acc: 0.925 Test Loss: 0.213 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 68 cost time: 0.448789119720459
Epoch: 68, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.198 Vali Acc: 0.925 Test Loss: 0.198 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 69 cost time: 0.46749234199523926
Epoch: 69, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.183 Vali Acc: 0.925 Test Loss: 0.183 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 70 cost time: 0.5020735263824463
Epoch: 70, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.169 Vali Acc: 0.950 Test Loss: 0.169 Test Acc: 0.950
Validation loss decreased (-0.924998 --> -0.949998).  Saving model ...
Epoch: 71 cost time: 0.4994034767150879
Epoch: 71, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.157 Vali Acc: 0.950 Test Loss: 0.157 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 72 cost time: 0.3970983028411865
Epoch: 72, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.146 Vali Acc: 0.950 Test Loss: 0.146 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949999).  Saving model ...
Epoch: 73 cost time: 0.39997196197509766
Epoch: 73, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.135 Vali Acc: 0.950 Test Loss: 0.135 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 74 cost time: 0.436326265335083
Epoch: 74, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.127 Vali Acc: 0.975 Test Loss: 0.127 Test Acc: 0.975
Validation loss decreased (-0.949999 --> -0.974999).  Saving model ...
Epoch: 75 cost time: 0.5396811962127686
Epoch: 75, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.120 Vali Acc: 0.975 Test Loss: 0.120 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 76 cost time: 0.42847394943237305
Epoch: 76, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.114 Vali Acc: 0.950 Test Loss: 0.114 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 0.4375002384185791
Epoch: 77, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.109 Vali Acc: 0.950 Test Loss: 0.109 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 0.5239770412445068
Epoch: 78, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.104 Vali Acc: 0.950 Test Loss: 0.104 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 0.46613550186157227
Epoch: 79, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.100 Vali Acc: 0.950 Test Loss: 0.100 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 0.47827863693237305
Epoch: 80, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.096 Vali Acc: 0.950 Test Loss: 0.096 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 81 cost time: 0.50946044921875
Epoch: 81, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.093 Vali Acc: 0.950 Test Loss: 0.093 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 82 cost time: 0.4343986511230469
Epoch: 82, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.091 Vali Acc: 0.950 Test Loss: 0.091 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 83 cost time: 0.49291419982910156
Epoch: 83, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.090 Vali Acc: 0.950 Test Loss: 0.090 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 84 cost time: 0.536360502243042
Epoch: 84, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.087 Vali Acc: 0.975 Test Loss: 0.087 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 85 cost time: 0.5090572834014893
Epoch: 85, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.084 Vali Acc: 0.975 Test Loss: 0.084 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 86 cost time: 0.3733251094818115
Epoch: 86, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.082 Vali Acc: 0.975 Test Loss: 0.082 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 87 cost time: 0.5223908424377441
Epoch: 87, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.079 Vali Acc: 0.975 Test Loss: 0.079 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 88 cost time: 0.5999271869659424
Epoch: 88, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.076 Vali Acc: 0.975 Test Loss: 0.076 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 89 cost time: 0.5720725059509277
Epoch: 89, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.074 Vali Acc: 0.975 Test Loss: 0.074 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 90 cost time: 0.5318925380706787
Epoch: 90, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.072 Vali Acc: 0.975 Test Loss: 0.072 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 91 cost time: 0.5241854190826416
Epoch: 91, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.070 Vali Acc: 0.975 Test Loss: 0.070 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 92 cost time: 0.5672042369842529
Epoch: 92, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.069 Vali Acc: 0.975 Test Loss: 0.069 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 93 cost time: 0.5652532577514648
Epoch: 93, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.068 Vali Acc: 0.975 Test Loss: 0.068 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 94 cost time: 0.473419189453125
Epoch: 94, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.066 Vali Acc: 0.975 Test Loss: 0.066 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 95 cost time: 0.549560546875
Epoch: 95, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.065 Vali Acc: 0.975 Test Loss: 0.065 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 96 cost time: 0.5194728374481201
Epoch: 96, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.064 Vali Acc: 0.975 Test Loss: 0.064 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 97 cost time: 0.5041792392730713
Epoch: 97, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.063 Vali Acc: 0.975 Test Loss: 0.063 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 98 cost time: 0.551271915435791
Epoch: 98, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.063 Vali Acc: 0.975 Test Loss: 0.063 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 99 cost time: 0.47922611236572266
Epoch: 99, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.062 Vali Acc: 0.975 Test Loss: 0.062 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 100 cost time: 0.49306654930114746
Epoch: 100, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.061 Vali Acc: 0.975 Test Loss: 0.061 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm128_cs20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 21966
model size : 0.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm128_cs17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.8654837608337402
Epoch: 1, Steps: 3 | Train Loss: 1.420 Vali Loss: 1.509 Vali Acc: 0.275 Test Loss: 1.509 Test Acc: 0.275
Validation loss decreased (inf --> -0.274985).  Saving model ...
Epoch: 2 cost time: 0.523418664932251
Epoch: 2, Steps: 3 | Train Loss: 1.378 Vali Loss: 1.501 Vali Acc: 0.300 Test Loss: 1.501 Test Acc: 0.300
Validation loss decreased (-0.274985 --> -0.299985).  Saving model ...
Epoch: 3 cost time: 0.5252525806427002
Epoch: 3, Steps: 3 | Train Loss: 1.379 Vali Loss: 1.494 Vali Acc: 0.300 Test Loss: 1.494 Test Acc: 0.300
Validation loss decreased (-0.299985 --> -0.299985).  Saving model ...
Epoch: 4 cost time: 0.49744486808776855
Epoch: 4, Steps: 3 | Train Loss: 1.372 Vali Loss: 1.484 Vali Acc: 0.325 Test Loss: 1.484 Test Acc: 0.325
Validation loss decreased (-0.299985 --> -0.324985).  Saving model ...
Epoch: 5 cost time: 0.53155517578125
Epoch: 5, Steps: 3 | Train Loss: 1.324 Vali Loss: 1.473 Vali Acc: 0.325 Test Loss: 1.473 Test Acc: 0.325
Validation loss decreased (-0.324985 --> -0.324985).  Saving model ...
Epoch: 6 cost time: 0.6671037673950195
Epoch: 6, Steps: 3 | Train Loss: 1.342 Vali Loss: 1.460 Vali Acc: 0.325 Test Loss: 1.460 Test Acc: 0.325
Validation loss decreased (-0.324985 --> -0.324985).  Saving model ...
Epoch: 7 cost time: 0.533714771270752
Epoch: 7, Steps: 3 | Train Loss: 1.305 Vali Loss: 1.446 Vali Acc: 0.350 Test Loss: 1.446 Test Acc: 0.350
Validation loss decreased (-0.324985 --> -0.349986).  Saving model ...
Epoch: 8 cost time: 0.6348693370819092
Epoch: 8, Steps: 3 | Train Loss: 1.255 Vali Loss: 1.430 Vali Acc: 0.350 Test Loss: 1.430 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 9 cost time: 0.4976003170013428
Epoch: 9, Steps: 3 | Train Loss: 1.204 Vali Loss: 1.414 Vali Acc: 0.375 Test Loss: 1.414 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374986).  Saving model ...
Epoch: 10 cost time: 0.4642763137817383
Epoch: 10, Steps: 3 | Train Loss: 1.217 Vali Loss: 1.397 Vali Acc: 0.425 Test Loss: 1.397 Test Acc: 0.425
Validation loss decreased (-0.374986 --> -0.424986).  Saving model ...
Epoch: 11 cost time: 0.5254755020141602
Epoch: 11, Steps: 3 | Train Loss: 1.198 Vali Loss: 1.379 Vali Acc: 0.450 Test Loss: 1.379 Test Acc: 0.450
Validation loss decreased (-0.424986 --> -0.449986).  Saving model ...
Epoch: 12 cost time: 0.4559922218322754
Epoch: 12, Steps: 3 | Train Loss: 1.135 Vali Loss: 1.360 Vali Acc: 0.450 Test Loss: 1.360 Test Acc: 0.450
Validation loss decreased (-0.449986 --> -0.449986).  Saving model ...
Epoch: 13 cost time: 0.4075462818145752
Epoch: 13, Steps: 3 | Train Loss: 1.131 Vali Loss: 1.342 Vali Acc: 0.450 Test Loss: 1.342 Test Acc: 0.450
Validation loss decreased (-0.449986 --> -0.449987).  Saving model ...
Epoch: 14 cost time: 0.44243359565734863
Epoch: 14, Steps: 3 | Train Loss: 1.101 Vali Loss: 1.323 Vali Acc: 0.450 Test Loss: 1.323 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 15 cost time: 0.4316868782043457
Epoch: 15, Steps: 3 | Train Loss: 1.046 Vali Loss: 1.304 Vali Acc: 0.475 Test Loss: 1.304 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474987).  Saving model ...
Epoch: 16 cost time: 0.49552416801452637
Epoch: 16, Steps: 3 | Train Loss: 1.050 Vali Loss: 1.285 Vali Acc: 0.475 Test Loss: 1.285 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 17 cost time: 0.582301139831543
Epoch: 17, Steps: 3 | Train Loss: 0.991 Vali Loss: 1.266 Vali Acc: 0.500 Test Loss: 1.266 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499987).  Saving model ...
Epoch: 18 cost time: 0.6369173526763916
Epoch: 18, Steps: 3 | Train Loss: 0.969 Vali Loss: 1.246 Vali Acc: 0.550 Test Loss: 1.246 Test Acc: 0.550
Validation loss decreased (-0.499987 --> -0.549988).  Saving model ...
Epoch: 19 cost time: 0.5279479026794434
Epoch: 19, Steps: 3 | Train Loss: 0.911 Vali Loss: 1.225 Vali Acc: 0.550 Test Loss: 1.225 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 20 cost time: 0.4657454490661621
Epoch: 20, Steps: 3 | Train Loss: 0.923 Vali Loss: 1.204 Vali Acc: 0.575 Test Loss: 1.204 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 21 cost time: 0.5397377014160156
Epoch: 21, Steps: 3 | Train Loss: 0.869 Vali Loss: 1.184 Vali Acc: 0.575 Test Loss: 1.184 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 22 cost time: 0.45729613304138184
Epoch: 22, Steps: 3 | Train Loss: 0.837 Vali Loss: 1.164 Vali Acc: 0.600 Test Loss: 1.164 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599988).  Saving model ...
Epoch: 23 cost time: 0.5430178642272949
Epoch: 23, Steps: 3 | Train Loss: 0.814 Vali Loss: 1.143 Vali Acc: 0.600 Test Loss: 1.143 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599989).  Saving model ...
Epoch: 24 cost time: 0.49507737159729004
Epoch: 24, Steps: 3 | Train Loss: 0.781 Vali Loss: 1.124 Vali Acc: 0.625 Test Loss: 1.124 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 25 cost time: 0.4676940441131592
Epoch: 25, Steps: 3 | Train Loss: 0.766 Vali Loss: 1.105 Vali Acc: 0.650 Test Loss: 1.105 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 26 cost time: 0.5023441314697266
Epoch: 26, Steps: 3 | Train Loss: 0.744 Vali Loss: 1.085 Vali Acc: 0.675 Test Loss: 1.085 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674989).  Saving model ...
Epoch: 27 cost time: 0.4536435604095459
Epoch: 27, Steps: 3 | Train Loss: 0.746 Vali Loss: 1.064 Vali Acc: 0.700 Test Loss: 1.064 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699989).  Saving model ...
Epoch: 28 cost time: 0.4920358657836914
Epoch: 28, Steps: 3 | Train Loss: 0.714 Vali Loss: 1.044 Vali Acc: 0.700 Test Loss: 1.044 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699990).  Saving model ...
Epoch: 29 cost time: 0.43904709815979004
Epoch: 29, Steps: 3 | Train Loss: 0.695 Vali Loss: 1.025 Vali Acc: 0.700 Test Loss: 1.025 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 30 cost time: 0.517697811126709
Epoch: 30, Steps: 3 | Train Loss: 0.668 Vali Loss: 1.006 Vali Acc: 0.725 Test Loss: 1.006 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724990).  Saving model ...
Epoch: 31 cost time: 0.5317986011505127
Epoch: 31, Steps: 3 | Train Loss: 0.636 Vali Loss: 0.988 Vali Acc: 0.775 Test Loss: 0.988 Test Acc: 0.775
Validation loss decreased (-0.724990 --> -0.774990).  Saving model ...
Epoch: 32 cost time: 0.5207533836364746
Epoch: 32, Steps: 3 | Train Loss: 0.635 Vali Loss: 0.969 Vali Acc: 0.775 Test Loss: 0.969 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774990).  Saving model ...
Epoch: 33 cost time: 0.5520150661468506
Epoch: 33, Steps: 3 | Train Loss: 0.608 Vali Loss: 0.950 Vali Acc: 0.775 Test Loss: 0.950 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774991).  Saving model ...
Epoch: 34 cost time: 0.517611026763916
Epoch: 34, Steps: 3 | Train Loss: 0.599 Vali Loss: 0.932 Vali Acc: 0.775 Test Loss: 0.932 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 35 cost time: 0.5380420684814453
Epoch: 35, Steps: 3 | Train Loss: 0.523 Vali Loss: 0.913 Vali Acc: 0.775 Test Loss: 0.913 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 36 cost time: 0.5860576629638672
Epoch: 36, Steps: 3 | Train Loss: 0.545 Vali Loss: 0.894 Vali Acc: 0.775 Test Loss: 0.894 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 37 cost time: 0.5562889575958252
Epoch: 37, Steps: 3 | Train Loss: 0.519 Vali Loss: 0.875 Vali Acc: 0.775 Test Loss: 0.875 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 38 cost time: 0.60746169090271
Epoch: 38, Steps: 3 | Train Loss: 0.471 Vali Loss: 0.856 Vali Acc: 0.775 Test Loss: 0.856 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 39 cost time: 0.5391790866851807
Epoch: 39, Steps: 3 | Train Loss: 0.452 Vali Loss: 0.837 Vali Acc: 0.775 Test Loss: 0.837 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774992).  Saving model ...
Epoch: 40 cost time: 0.6199564933776855
Epoch: 40, Steps: 3 | Train Loss: 0.436 Vali Loss: 0.816 Vali Acc: 0.825 Test Loss: 0.816 Test Acc: 0.825
Validation loss decreased (-0.774992 --> -0.824992).  Saving model ...
Epoch: 41 cost time: 0.43850255012512207
Epoch: 41, Steps: 3 | Train Loss: 0.411 Vali Loss: 0.796 Vali Acc: 0.825 Test Loss: 0.796 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 42 cost time: 0.4449951648712158
Epoch: 42, Steps: 3 | Train Loss: 0.394 Vali Loss: 0.774 Vali Acc: 0.825 Test Loss: 0.774 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 43 cost time: 0.5178227424621582
Epoch: 43, Steps: 3 | Train Loss: 0.371 Vali Loss: 0.751 Vali Acc: 0.825 Test Loss: 0.751 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 44 cost time: 0.4097929000854492
Epoch: 44, Steps: 3 | Train Loss: 0.385 Vali Loss: 0.726 Vali Acc: 0.850 Test Loss: 0.726 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849993).  Saving model ...
Epoch: 45 cost time: 0.4533967971801758
Epoch: 45, Steps: 3 | Train Loss: 0.357 Vali Loss: 0.702 Vali Acc: 0.875 Test Loss: 0.702 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874993).  Saving model ...
Epoch: 46 cost time: 0.5105414390563965
Epoch: 46, Steps: 3 | Train Loss: 0.364 Vali Loss: 0.679 Vali Acc: 0.875 Test Loss: 0.679 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 47 cost time: 0.3546714782714844
Epoch: 47, Steps: 3 | Train Loss: 0.330 Vali Loss: 0.655 Vali Acc: 0.875 Test Loss: 0.655 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 48 cost time: 0.36464405059814453
Epoch: 48, Steps: 3 | Train Loss: 0.324 Vali Loss: 0.627 Vali Acc: 0.875 Test Loss: 0.627 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 49 cost time: 0.4904639720916748
Epoch: 49, Steps: 3 | Train Loss: 0.290 Vali Loss: 0.597 Vali Acc: 0.875 Test Loss: 0.597 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 50 cost time: 0.5807523727416992
Epoch: 50, Steps: 3 | Train Loss: 0.271 Vali Loss: 0.566 Vali Acc: 0.900 Test Loss: 0.566 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899994).  Saving model ...
Epoch: 51 cost time: 0.4160473346710205
Epoch: 51, Steps: 3 | Train Loss: 0.236 Vali Loss: 0.533 Vali Acc: 0.900 Test Loss: 0.533 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 52 cost time: 0.5555956363677979
Epoch: 52, Steps: 3 | Train Loss: 0.243 Vali Loss: 0.501 Vali Acc: 0.900 Test Loss: 0.501 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 53 cost time: 0.6976847648620605
Epoch: 53, Steps: 3 | Train Loss: 0.263 Vali Loss: 0.470 Vali Acc: 0.900 Test Loss: 0.470 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 54 cost time: 0.5340414047241211
Epoch: 54, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.441 Vali Acc: 0.900 Test Loss: 0.441 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 55 cost time: 0.5028889179229736
Epoch: 55, Steps: 3 | Train Loss: 0.236 Vali Loss: 0.414 Vali Acc: 0.900 Test Loss: 0.414 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 56 cost time: 0.5903820991516113
Epoch: 56, Steps: 3 | Train Loss: 0.187 Vali Loss: 0.389 Vali Acc: 0.900 Test Loss: 0.389 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 57 cost time: 0.5443141460418701
Epoch: 57, Steps: 3 | Train Loss: 0.168 Vali Loss: 0.367 Vali Acc: 0.900 Test Loss: 0.367 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 58 cost time: 0.5281357765197754
Epoch: 58, Steps: 3 | Train Loss: 0.142 Vali Loss: 0.344 Vali Acc: 0.925 Test Loss: 0.344 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924997).  Saving model ...
Epoch: 59 cost time: 0.5556809902191162
Epoch: 59, Steps: 3 | Train Loss: 0.133 Vali Loss: 0.319 Vali Acc: 0.925 Test Loss: 0.319 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 60 cost time: 0.5302813053131104
Epoch: 60, Steps: 3 | Train Loss: 0.158 Vali Loss: 0.298 Vali Acc: 0.925 Test Loss: 0.298 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 61 cost time: 0.47524571418762207
Epoch: 61, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.279 Vali Acc: 0.950 Test Loss: 0.279 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 62 cost time: 0.6802878379821777
Epoch: 62, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.261 Vali Acc: 0.950 Test Loss: 0.261 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 63 cost time: 0.5586514472961426
Epoch: 63, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.242 Vali Acc: 0.950 Test Loss: 0.242 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 64 cost time: 0.544553279876709
Epoch: 64, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.226 Vali Acc: 0.950 Test Loss: 0.226 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 65 cost time: 0.6206018924713135
Epoch: 65, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.213 Vali Acc: 0.950 Test Loss: 0.213 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 66 cost time: 0.682081937789917
Epoch: 66, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.203 Vali Acc: 0.950 Test Loss: 0.203 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 67 cost time: 0.7129621505737305
Epoch: 67, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.195 Vali Acc: 0.950 Test Loss: 0.195 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 68 cost time: 0.534738302230835
Epoch: 68, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.186 Vali Acc: 0.950 Test Loss: 0.186 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 69 cost time: 0.6206707954406738
Epoch: 69, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.175 Vali Acc: 0.950 Test Loss: 0.175 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 70 cost time: 0.6045651435852051
Epoch: 70, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.166 Vali Acc: 0.950 Test Loss: 0.166 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 71 cost time: 0.5690932273864746
Epoch: 71, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.156 Vali Acc: 0.950 Test Loss: 0.156 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 72 cost time: 0.6544699668884277
Epoch: 72, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.145 Vali Acc: 0.950 Test Loss: 0.145 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949999).  Saving model ...
Epoch: 73 cost time: 0.7325534820556641
Epoch: 73, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.138 Vali Acc: 0.975 Test Loss: 0.138 Test Acc: 0.975
Validation loss decreased (-0.949999 --> -0.974999).  Saving model ...
Epoch: 74 cost time: 0.4834933280944824
Epoch: 74, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.135 Vali Acc: 0.975 Test Loss: 0.135 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 75 cost time: 0.5935177803039551
Epoch: 75, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.127 Vali Acc: 0.975 Test Loss: 0.127 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 76 cost time: 0.5937049388885498
Epoch: 76, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.111 Vali Acc: 0.975 Test Loss: 0.111 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 77 cost time: 0.5813415050506592
Epoch: 77, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.100 Vali Acc: 0.975 Test Loss: 0.100 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 78 cost time: 0.7038633823394775
Epoch: 78, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.093 Vali Acc: 0.975 Test Loss: 0.093 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 79 cost time: 0.7011435031890869
Epoch: 79, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.089 Vali Acc: 0.975 Test Loss: 0.089 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 80 cost time: 0.5710391998291016
Epoch: 80, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.084 Vali Acc: 0.975 Test Loss: 0.084 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 81 cost time: 0.6821911334991455
Epoch: 81, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.078 Vali Acc: 0.975 Test Loss: 0.078 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 82 cost time: 0.6839075088500977
Epoch: 82, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.074 Vali Acc: 0.975 Test Loss: 0.074 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 83 cost time: 0.4738314151763916
Epoch: 83, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.071 Vali Acc: 0.975 Test Loss: 0.071 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 84 cost time: 0.6127605438232422
Epoch: 84, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.069 Vali Acc: 0.975 Test Loss: 0.069 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 85 cost time: 0.8057036399841309
Epoch: 85, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.068 Vali Acc: 0.975 Test Loss: 0.068 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 86 cost time: 0.4576294422149658
Epoch: 86, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.067 Vali Acc: 0.975 Test Loss: 0.067 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 87 cost time: 0.6005723476409912
Epoch: 87, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.065 Vali Acc: 0.975 Test Loss: 0.065 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 88 cost time: 0.4880547523498535
Epoch: 88, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.063 Vali Acc: 0.975 Test Loss: 0.063 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 89 cost time: 0.6297919750213623
Epoch: 89, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.061 Vali Acc: 0.975 Test Loss: 0.061 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 90 cost time: 0.6321203708648682
Epoch: 90, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.060 Vali Acc: 1.000 Test Loss: 0.060 Test Acc: 1.000
Validation loss decreased (-0.974999 --> -0.999999).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm128_cs17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 22000
model size : 0.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm128_cs15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.655271053314209
Epoch: 1, Steps: 3 | Train Loss: 1.486 Vali Loss: 1.356 Vali Acc: 0.375 Test Loss: 1.356 Test Acc: 0.375
Validation loss decreased (inf --> -0.374986).  Saving model ...
Epoch: 2 cost time: 0.5021219253540039
Epoch: 2, Steps: 3 | Train Loss: 1.483 Vali Loss: 1.349 Vali Acc: 0.400 Test Loss: 1.349 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399987).  Saving model ...
Epoch: 3 cost time: 0.4856109619140625
Epoch: 3, Steps: 3 | Train Loss: 1.509 Vali Loss: 1.344 Vali Acc: 0.400 Test Loss: 1.344 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 4 cost time: 0.5202779769897461
Epoch: 4, Steps: 3 | Train Loss: 1.429 Vali Loss: 1.336 Vali Acc: 0.400 Test Loss: 1.336 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 5 cost time: 0.45557379722595215
Epoch: 5, Steps: 3 | Train Loss: 1.394 Vali Loss: 1.326 Vali Acc: 0.425 Test Loss: 1.326 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424987).  Saving model ...
Epoch: 6 cost time: 0.49982523918151855
Epoch: 6, Steps: 3 | Train Loss: 1.399 Vali Loss: 1.315 Vali Acc: 0.450 Test Loss: 1.315 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449987).  Saving model ...
Epoch: 7 cost time: 0.52459716796875
Epoch: 7, Steps: 3 | Train Loss: 1.367 Vali Loss: 1.304 Vali Acc: 0.475 Test Loss: 1.304 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474987).  Saving model ...
Epoch: 8 cost time: 0.46143460273742676
Epoch: 8, Steps: 3 | Train Loss: 1.317 Vali Loss: 1.292 Vali Acc: 0.500 Test Loss: 1.292 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499987).  Saving model ...
Epoch: 9 cost time: 0.4173004627227783
Epoch: 9, Steps: 3 | Train Loss: 1.307 Vali Loss: 1.280 Vali Acc: 0.500 Test Loss: 1.280 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 10 cost time: 0.4305601119995117
Epoch: 10, Steps: 3 | Train Loss: 1.300 Vali Loss: 1.266 Vali Acc: 0.500 Test Loss: 1.266 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 11 cost time: 0.5335571765899658
Epoch: 11, Steps: 3 | Train Loss: 1.219 Vali Loss: 1.252 Vali Acc: 0.475 Test Loss: 1.252 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.4799494743347168
Epoch: 12, Steps: 3 | Train Loss: 1.213 Vali Loss: 1.237 Vali Acc: 0.525 Test Loss: 1.237 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524988).  Saving model ...
Epoch: 13 cost time: 0.39879488945007324
Epoch: 13, Steps: 3 | Train Loss: 1.207 Vali Loss: 1.222 Vali Acc: 0.525 Test Loss: 1.222 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 14 cost time: 0.45261383056640625
Epoch: 14, Steps: 3 | Train Loss: 1.156 Vali Loss: 1.206 Vali Acc: 0.550 Test Loss: 1.206 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 15 cost time: 0.49915266036987305
Epoch: 15, Steps: 3 | Train Loss: 1.125 Vali Loss: 1.189 Vali Acc: 0.600 Test Loss: 1.189 Test Acc: 0.600
Validation loss decreased (-0.549988 --> -0.599988).  Saving model ...
Epoch: 16 cost time: 0.46903133392333984
Epoch: 16, Steps: 3 | Train Loss: 1.068 Vali Loss: 1.172 Vali Acc: 0.675 Test Loss: 1.172 Test Acc: 0.675
Validation loss decreased (-0.599988 --> -0.674988).  Saving model ...
Epoch: 17 cost time: 0.48769688606262207
Epoch: 17, Steps: 3 | Train Loss: 1.076 Vali Loss: 1.155 Vali Acc: 0.700 Test Loss: 1.155 Test Acc: 0.700
Validation loss decreased (-0.674988 --> -0.699988).  Saving model ...
Epoch: 18 cost time: 0.5479059219360352
Epoch: 18, Steps: 3 | Train Loss: 1.023 Vali Loss: 1.138 Vali Acc: 0.700 Test Loss: 1.138 Test Acc: 0.700
Validation loss decreased (-0.699988 --> -0.699989).  Saving model ...
Epoch: 19 cost time: 0.4897420406341553
Epoch: 19, Steps: 3 | Train Loss: 1.006 Vali Loss: 1.120 Vali Acc: 0.700 Test Loss: 1.120 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 20 cost time: 0.4238739013671875
Epoch: 20, Steps: 3 | Train Loss: 0.970 Vali Loss: 1.102 Vali Acc: 0.725 Test Loss: 1.102 Test Acc: 0.725
Validation loss decreased (-0.699989 --> -0.724989).  Saving model ...
Epoch: 21 cost time: 0.4499855041503906
Epoch: 21, Steps: 3 | Train Loss: 0.906 Vali Loss: 1.083 Vali Acc: 0.725 Test Loss: 1.083 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 22 cost time: 0.4743328094482422
Epoch: 22, Steps: 3 | Train Loss: 0.928 Vali Loss: 1.064 Vali Acc: 0.750 Test Loss: 1.064 Test Acc: 0.750
Validation loss decreased (-0.724989 --> -0.749989).  Saving model ...
Epoch: 23 cost time: 0.38347530364990234
Epoch: 23, Steps: 3 | Train Loss: 0.866 Vali Loss: 1.045 Vali Acc: 0.750 Test Loss: 1.045 Test Acc: 0.750
Validation loss decreased (-0.749989 --> -0.749990).  Saving model ...
Epoch: 24 cost time: 0.4349033832550049
Epoch: 24, Steps: 3 | Train Loss: 0.826 Vali Loss: 1.026 Vali Acc: 0.750 Test Loss: 1.026 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 25 cost time: 0.449460506439209
Epoch: 25, Steps: 3 | Train Loss: 0.799 Vali Loss: 1.007 Vali Acc: 0.750 Test Loss: 1.007 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 26 cost time: 0.5006277561187744
Epoch: 26, Steps: 3 | Train Loss: 0.813 Vali Loss: 0.988 Vali Acc: 0.750 Test Loss: 0.988 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 27 cost time: 0.4059128761291504
Epoch: 27, Steps: 3 | Train Loss: 0.728 Vali Loss: 0.970 Vali Acc: 0.750 Test Loss: 0.970 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 28 cost time: 0.47058796882629395
Epoch: 28, Steps: 3 | Train Loss: 0.747 Vali Loss: 0.951 Vali Acc: 0.750 Test Loss: 0.951 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 29 cost time: 0.4897928237915039
Epoch: 29, Steps: 3 | Train Loss: 0.706 Vali Loss: 0.931 Vali Acc: 0.750 Test Loss: 0.931 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749991).  Saving model ...
Epoch: 30 cost time: 0.5034091472625732
Epoch: 30, Steps: 3 | Train Loss: 0.679 Vali Loss: 0.910 Vali Acc: 0.750 Test Loss: 0.910 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 31 cost time: 0.3900146484375
Epoch: 31, Steps: 3 | Train Loss: 0.643 Vali Loss: 0.890 Vali Acc: 0.750 Test Loss: 0.890 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 32 cost time: 0.4779067039489746
Epoch: 32, Steps: 3 | Train Loss: 0.635 Vali Loss: 0.868 Vali Acc: 0.750 Test Loss: 0.868 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 33 cost time: 0.5332181453704834
Epoch: 33, Steps: 3 | Train Loss: 0.591 Vali Loss: 0.846 Vali Acc: 0.775 Test Loss: 0.846 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774992).  Saving model ...
Epoch: 34 cost time: 0.5289535522460938
Epoch: 34, Steps: 3 | Train Loss: 0.594 Vali Loss: 0.823 Vali Acc: 0.800 Test Loss: 0.823 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799992).  Saving model ...
Epoch: 35 cost time: 0.482377290725708
Epoch: 35, Steps: 3 | Train Loss: 0.530 Vali Loss: 0.800 Vali Acc: 0.800 Test Loss: 0.800 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 36 cost time: 0.4564976692199707
Epoch: 36, Steps: 3 | Train Loss: 0.543 Vali Loss: 0.777 Vali Acc: 0.800 Test Loss: 0.777 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 37 cost time: 0.5092928409576416
Epoch: 37, Steps: 3 | Train Loss: 0.503 Vali Loss: 0.753 Vali Acc: 0.825 Test Loss: 0.753 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824992).  Saving model ...
Epoch: 38 cost time: 0.5101866722106934
Epoch: 38, Steps: 3 | Train Loss: 0.499 Vali Loss: 0.728 Vali Acc: 0.825 Test Loss: 0.728 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824993).  Saving model ...
Epoch: 39 cost time: 0.511061429977417
Epoch: 39, Steps: 3 | Train Loss: 0.488 Vali Loss: 0.702 Vali Acc: 0.825 Test Loss: 0.702 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 40 cost time: 0.6043553352355957
Epoch: 40, Steps: 3 | Train Loss: 0.439 Vali Loss: 0.672 Vali Acc: 0.850 Test Loss: 0.672 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849993).  Saving model ...
Epoch: 41 cost time: 0.5676047801971436
Epoch: 41, Steps: 3 | Train Loss: 0.413 Vali Loss: 0.642 Vali Acc: 0.875 Test Loss: 0.642 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874994).  Saving model ...
Epoch: 42 cost time: 0.5185551643371582
Epoch: 42, Steps: 3 | Train Loss: 0.384 Vali Loss: 0.610 Vali Acc: 0.875 Test Loss: 0.610 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 43 cost time: 0.44982147216796875
Epoch: 43, Steps: 3 | Train Loss: 0.369 Vali Loss: 0.578 Vali Acc: 0.850 Test Loss: 0.578 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.46747255325317383
Epoch: 44, Steps: 3 | Train Loss: 0.353 Vali Loss: 0.546 Vali Acc: 0.900 Test Loss: 0.546 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899995).  Saving model ...
Epoch: 45 cost time: 0.42685365676879883
Epoch: 45, Steps: 3 | Train Loss: 0.330 Vali Loss: 0.515 Vali Acc: 0.900 Test Loss: 0.515 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 46 cost time: 0.5769639015197754
Epoch: 46, Steps: 3 | Train Loss: 0.315 Vali Loss: 0.484 Vali Acc: 0.900 Test Loss: 0.484 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 47 cost time: 0.506798267364502
Epoch: 47, Steps: 3 | Train Loss: 0.312 Vali Loss: 0.456 Vali Acc: 0.900 Test Loss: 0.456 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 48 cost time: 0.6091001033782959
Epoch: 48, Steps: 3 | Train Loss: 0.310 Vali Loss: 0.429 Vali Acc: 0.900 Test Loss: 0.429 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 49 cost time: 0.4230177402496338
Epoch: 49, Steps: 3 | Train Loss: 0.309 Vali Loss: 0.402 Vali Acc: 0.900 Test Loss: 0.402 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 50 cost time: 0.4671139717102051
Epoch: 50, Steps: 3 | Train Loss: 0.289 Vali Loss: 0.377 Vali Acc: 0.900 Test Loss: 0.377 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 51 cost time: 0.5894389152526855
Epoch: 51, Steps: 3 | Train Loss: 0.238 Vali Loss: 0.354 Vali Acc: 0.925 Test Loss: 0.354 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 52 cost time: 0.4870309829711914
Epoch: 52, Steps: 3 | Train Loss: 0.247 Vali Loss: 0.331 Vali Acc: 0.925 Test Loss: 0.331 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 53 cost time: 0.501272439956665
Epoch: 53, Steps: 3 | Train Loss: 0.224 Vali Loss: 0.308 Vali Acc: 0.950 Test Loss: 0.308 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 54 cost time: 0.5329556465148926
Epoch: 54, Steps: 3 | Train Loss: 0.210 Vali Loss: 0.286 Vali Acc: 0.950 Test Loss: 0.286 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 55 cost time: 0.48035573959350586
Epoch: 55, Steps: 3 | Train Loss: 0.198 Vali Loss: 0.263 Vali Acc: 0.950 Test Loss: 0.263 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 56 cost time: 0.5303246974945068
Epoch: 56, Steps: 3 | Train Loss: 0.185 Vali Loss: 0.241 Vali Acc: 0.925 Test Loss: 0.241 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.6317734718322754
Epoch: 57, Steps: 3 | Train Loss: 0.174 Vali Loss: 0.220 Vali Acc: 0.925 Test Loss: 0.220 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.5678048133850098
Epoch: 58, Steps: 3 | Train Loss: 0.163 Vali Loss: 0.200 Vali Acc: 0.925 Test Loss: 0.200 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 0.5301499366760254
Epoch: 59, Steps: 3 | Train Loss: 0.171 Vali Loss: 0.181 Vali Acc: 0.925 Test Loss: 0.181 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 0.6439034938812256
Epoch: 60, Steps: 3 | Train Loss: 0.144 Vali Loss: 0.160 Vali Acc: 0.975 Test Loss: 0.160 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974998).  Saving model ...
Epoch: 61 cost time: 0.6171505451202393
Epoch: 61, Steps: 3 | Train Loss: 0.120 Vali Loss: 0.140 Vali Acc: 0.975 Test Loss: 0.140 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 62 cost time: 0.4584362506866455
Epoch: 62, Steps: 3 | Train Loss: 0.123 Vali Loss: 0.122 Vali Acc: 1.000 Test Loss: 0.122 Test Acc: 1.000
Validation loss decreased (-0.974999 --> -0.999999).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm128_cs15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 22202
model size : 0.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm128_cs13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6173527240753174
Epoch: 1, Steps: 3 | Train Loss: 1.360 Vali Loss: 1.413 Vali Acc: 0.400 Test Loss: 1.413 Test Acc: 0.400
Validation loss decreased (inf --> -0.399986).  Saving model ...
Epoch: 2 cost time: 0.43743228912353516
Epoch: 2, Steps: 3 | Train Loss: 1.380 Vali Loss: 1.406 Vali Acc: 0.400 Test Loss: 1.406 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399986).  Saving model ...
Epoch: 3 cost time: 0.46222853660583496
Epoch: 3, Steps: 3 | Train Loss: 1.380 Vali Loss: 1.399 Vali Acc: 0.425 Test Loss: 1.399 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424986).  Saving model ...
Epoch: 4 cost time: 0.5229387283325195
Epoch: 4, Steps: 3 | Train Loss: 1.325 Vali Loss: 1.391 Vali Acc: 0.425 Test Loss: 1.391 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424986).  Saving model ...
Epoch: 5 cost time: 0.5109710693359375
Epoch: 5, Steps: 3 | Train Loss: 1.352 Vali Loss: 1.380 Vali Acc: 0.425 Test Loss: 1.380 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424986).  Saving model ...
Epoch: 6 cost time: 0.6752958297729492
Epoch: 6, Steps: 3 | Train Loss: 1.327 Vali Loss: 1.369 Vali Acc: 0.450 Test Loss: 1.369 Test Acc: 0.450
Validation loss decreased (-0.424986 --> -0.449986).  Saving model ...
Epoch: 7 cost time: 0.5399596691131592
Epoch: 7, Steps: 3 | Train Loss: 1.279 Vali Loss: 1.356 Vali Acc: 0.450 Test Loss: 1.356 Test Acc: 0.450
Validation loss decreased (-0.449986 --> -0.449986).  Saving model ...
Epoch: 8 cost time: 0.6128790378570557
Epoch: 8, Steps: 3 | Train Loss: 1.255 Vali Loss: 1.341 Vali Acc: 0.450 Test Loss: 1.341 Test Acc: 0.450
Validation loss decreased (-0.449986 --> -0.449987).  Saving model ...
Epoch: 9 cost time: 0.6943700313568115
Epoch: 9, Steps: 3 | Train Loss: 1.227 Vali Loss: 1.326 Vali Acc: 0.450 Test Loss: 1.326 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 10 cost time: 0.5570645332336426
Epoch: 10, Steps: 3 | Train Loss: 1.230 Vali Loss: 1.310 Vali Acc: 0.475 Test Loss: 1.310 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474987).  Saving model ...
Epoch: 11 cost time: 0.5881354808807373
Epoch: 11, Steps: 3 | Train Loss: 1.173 Vali Loss: 1.293 Vali Acc: 0.475 Test Loss: 1.293 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 12 cost time: 0.5060296058654785
Epoch: 12, Steps: 3 | Train Loss: 1.156 Vali Loss: 1.276 Vali Acc: 0.475 Test Loss: 1.276 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 13 cost time: 0.5400040149688721
Epoch: 13, Steps: 3 | Train Loss: 1.105 Vali Loss: 1.258 Vali Acc: 0.475 Test Loss: 1.258 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 14 cost time: 0.537492036819458
Epoch: 14, Steps: 3 | Train Loss: 1.069 Vali Loss: 1.240 Vali Acc: 0.475 Test Loss: 1.240 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474988).  Saving model ...
Epoch: 15 cost time: 0.4691133499145508
Epoch: 15, Steps: 3 | Train Loss: 1.055 Vali Loss: 1.222 Vali Acc: 0.500 Test Loss: 1.222 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499988).  Saving model ...
Epoch: 16 cost time: 0.567194938659668
Epoch: 16, Steps: 3 | Train Loss: 1.026 Vali Loss: 1.204 Vali Acc: 0.525 Test Loss: 1.204 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 17 cost time: 0.5739486217498779
Epoch: 17, Steps: 3 | Train Loss: 0.982 Vali Loss: 1.185 Vali Acc: 0.525 Test Loss: 1.185 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 18 cost time: 0.4591958522796631
Epoch: 18, Steps: 3 | Train Loss: 0.944 Vali Loss: 1.166 Vali Acc: 0.575 Test Loss: 1.166 Test Acc: 0.575
Validation loss decreased (-0.524988 --> -0.574988).  Saving model ...
Epoch: 19 cost time: 0.47388148307800293
Epoch: 19, Steps: 3 | Train Loss: 0.923 Vali Loss: 1.146 Vali Acc: 0.625 Test Loss: 1.146 Test Acc: 0.625
Validation loss decreased (-0.574988 --> -0.624989).  Saving model ...
Epoch: 20 cost time: 0.5180590152740479
Epoch: 20, Steps: 3 | Train Loss: 0.882 Vali Loss: 1.126 Vali Acc: 0.675 Test Loss: 1.126 Test Acc: 0.675
Validation loss decreased (-0.624989 --> -0.674989).  Saving model ...
Epoch: 21 cost time: 0.5789501667022705
Epoch: 21, Steps: 3 | Train Loss: 0.836 Vali Loss: 1.105 Vali Acc: 0.675 Test Loss: 1.105 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 22 cost time: 0.5513126850128174
Epoch: 22, Steps: 3 | Train Loss: 0.825 Vali Loss: 1.084 Vali Acc: 0.700 Test Loss: 1.084 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699989).  Saving model ...
Epoch: 23 cost time: 0.7206683158874512
Epoch: 23, Steps: 3 | Train Loss: 0.786 Vali Loss: 1.065 Vali Acc: 0.700 Test Loss: 1.065 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 24 cost time: 0.6967513561248779
Epoch: 24, Steps: 3 | Train Loss: 0.762 Vali Loss: 1.046 Vali Acc: 0.725 Test Loss: 1.046 Test Acc: 0.725
Validation loss decreased (-0.699989 --> -0.724990).  Saving model ...
Epoch: 25 cost time: 0.6262350082397461
Epoch: 25, Steps: 3 | Train Loss: 0.741 Vali Loss: 1.025 Vali Acc: 0.725 Test Loss: 1.025 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 26 cost time: 0.575188159942627
Epoch: 26, Steps: 3 | Train Loss: 0.738 Vali Loss: 1.004 Vali Acc: 0.750 Test Loss: 1.004 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749990).  Saving model ...
Epoch: 27 cost time: 0.4852004051208496
Epoch: 27, Steps: 3 | Train Loss: 0.699 Vali Loss: 0.983 Vali Acc: 0.750 Test Loss: 0.983 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 28 cost time: 0.5578014850616455
Epoch: 28, Steps: 3 | Train Loss: 0.684 Vali Loss: 0.964 Vali Acc: 0.750 Test Loss: 0.964 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 29 cost time: 0.5285475254058838
Epoch: 29, Steps: 3 | Train Loss: 0.657 Vali Loss: 0.946 Vali Acc: 0.750 Test Loss: 0.946 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749991).  Saving model ...
Epoch: 30 cost time: 0.5309538841247559
Epoch: 30, Steps: 3 | Train Loss: 0.615 Vali Loss: 0.928 Vali Acc: 0.750 Test Loss: 0.928 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 31 cost time: 0.5453362464904785
Epoch: 31, Steps: 3 | Train Loss: 0.622 Vali Loss: 0.910 Vali Acc: 0.750 Test Loss: 0.910 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 32 cost time: 0.45555973052978516
Epoch: 32, Steps: 3 | Train Loss: 0.595 Vali Loss: 0.891 Vali Acc: 0.775 Test Loss: 0.891 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774991).  Saving model ...
Epoch: 33 cost time: 0.450939416885376
Epoch: 33, Steps: 3 | Train Loss: 0.582 Vali Loss: 0.872 Vali Acc: 0.775 Test Loss: 0.872 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 34 cost time: 0.5032496452331543
Epoch: 34, Steps: 3 | Train Loss: 0.513 Vali Loss: 0.853 Vali Acc: 0.775 Test Loss: 0.853 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 35 cost time: 0.40117716789245605
Epoch: 35, Steps: 3 | Train Loss: 0.533 Vali Loss: 0.833 Vali Acc: 0.800 Test Loss: 0.833 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799992).  Saving model ...
Epoch: 36 cost time: 0.48201489448547363
Epoch: 36, Steps: 3 | Train Loss: 0.511 Vali Loss: 0.812 Vali Acc: 0.800 Test Loss: 0.812 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 37 cost time: 0.5025150775909424
Epoch: 37, Steps: 3 | Train Loss: 0.463 Vali Loss: 0.792 Vali Acc: 0.800 Test Loss: 0.792 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 38 cost time: 0.7043411731719971
Epoch: 38, Steps: 3 | Train Loss: 0.445 Vali Loss: 0.771 Vali Acc: 0.800 Test Loss: 0.771 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 39 cost time: 0.45354771614074707
Epoch: 39, Steps: 3 | Train Loss: 0.425 Vali Loss: 0.748 Vali Acc: 0.825 Test Loss: 0.748 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824993).  Saving model ...
Epoch: 40 cost time: 0.5678656101226807
Epoch: 40, Steps: 3 | Train Loss: 0.401 Vali Loss: 0.725 Vali Acc: 0.850 Test Loss: 0.725 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849993).  Saving model ...
Epoch: 41 cost time: 0.5493919849395752
Epoch: 41, Steps: 3 | Train Loss: 0.384 Vali Loss: 0.698 Vali Acc: 0.850 Test Loss: 0.698 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 42 cost time: 0.5673928260803223
Epoch: 42, Steps: 3 | Train Loss: 0.361 Vali Loss: 0.671 Vali Acc: 0.875 Test Loss: 0.671 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874993).  Saving model ...
Epoch: 43 cost time: 0.559464693069458
Epoch: 43, Steps: 3 | Train Loss: 0.377 Vali Loss: 0.642 Vali Acc: 0.875 Test Loss: 0.642 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 44 cost time: 0.45828700065612793
Epoch: 44, Steps: 3 | Train Loss: 0.351 Vali Loss: 0.616 Vali Acc: 0.875 Test Loss: 0.616 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 45 cost time: 0.5256872177124023
Epoch: 45, Steps: 3 | Train Loss: 0.363 Vali Loss: 0.592 Vali Acc: 0.875 Test Loss: 0.592 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 46 cost time: 0.48087477684020996
Epoch: 46, Steps: 3 | Train Loss: 0.326 Vali Loss: 0.571 Vali Acc: 0.875 Test Loss: 0.571 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 47 cost time: 0.6298387050628662
Epoch: 47, Steps: 3 | Train Loss: 0.324 Vali Loss: 0.548 Vali Acc: 0.875 Test Loss: 0.548 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 48 cost time: 0.6331756114959717
Epoch: 48, Steps: 3 | Train Loss: 0.287 Vali Loss: 0.526 Vali Acc: 0.875 Test Loss: 0.526 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 49 cost time: 0.5599486827850342
Epoch: 49, Steps: 3 | Train Loss: 0.278 Vali Loss: 0.504 Vali Acc: 0.875 Test Loss: 0.504 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 50 cost time: 0.542513370513916
Epoch: 50, Steps: 3 | Train Loss: 0.239 Vali Loss: 0.481 Vali Acc: 0.875 Test Loss: 0.481 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 51 cost time: 0.4994475841522217
Epoch: 51, Steps: 3 | Train Loss: 0.247 Vali Loss: 0.459 Vali Acc: 0.875 Test Loss: 0.459 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 52 cost time: 0.5530703067779541
Epoch: 52, Steps: 3 | Train Loss: 0.272 Vali Loss: 0.440 Vali Acc: 0.875 Test Loss: 0.440 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 53 cost time: 0.5023016929626465
Epoch: 53, Steps: 3 | Train Loss: 0.223 Vali Loss: 0.423 Vali Acc: 0.875 Test Loss: 0.423 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 54 cost time: 0.5048141479492188
Epoch: 54, Steps: 3 | Train Loss: 0.250 Vali Loss: 0.408 Vali Acc: 0.900 Test Loss: 0.408 Test Acc: 0.900
Validation loss decreased (-0.874996 --> -0.899996).  Saving model ...
Epoch: 55 cost time: 0.5505576133728027
Epoch: 55, Steps: 3 | Train Loss: 0.211 Vali Loss: 0.395 Vali Acc: 0.900 Test Loss: 0.395 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 56 cost time: 0.5403332710266113
Epoch: 56, Steps: 3 | Train Loss: 0.202 Vali Loss: 0.383 Vali Acc: 0.875 Test Loss: 0.383 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.4761850833892822
Epoch: 57, Steps: 3 | Train Loss: 0.178 Vali Loss: 0.371 Vali Acc: 0.875 Test Loss: 0.371 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.6416833400726318
Epoch: 58, Steps: 3 | Train Loss: 0.163 Vali Loss: 0.356 Vali Acc: 0.875 Test Loss: 0.356 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 0.5577166080474854
Epoch: 59, Steps: 3 | Train Loss: 0.191 Vali Loss: 0.343 Vali Acc: 0.875 Test Loss: 0.343 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 0.5955748558044434
Epoch: 60, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.330 Vali Acc: 0.875 Test Loss: 0.330 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 0.5348896980285645
Epoch: 61, Steps: 3 | Train Loss: 0.120 Vali Loss: 0.320 Vali Acc: 0.875 Test Loss: 0.320 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 0.4859592914581299
Epoch: 62, Steps: 3 | Train Loss: 0.109 Vali Loss: 0.310 Vali Acc: 0.875 Test Loss: 0.310 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 0.4764406681060791
Epoch: 63, Steps: 3 | Train Loss: 0.130 Vali Loss: 0.299 Vali Acc: 0.875 Test Loss: 0.299 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 0.5784814357757568
Epoch: 64, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.285 Vali Acc: 0.925 Test Loss: 0.285 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924997).  Saving model ...
Epoch: 65 cost time: 0.6100876331329346
Epoch: 65, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.274 Vali Acc: 0.925 Test Loss: 0.274 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 66 cost time: 0.4801018238067627
Epoch: 66, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.262 Vali Acc: 0.925 Test Loss: 0.262 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 67 cost time: 0.48308539390563965
Epoch: 67, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.253 Vali Acc: 0.925 Test Loss: 0.253 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 68 cost time: 0.6437146663665771
Epoch: 68, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.244 Vali Acc: 0.925 Test Loss: 0.244 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924998).  Saving model ...
Epoch: 69 cost time: 0.5681507587432861
Epoch: 69, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.234 Vali Acc: 0.925 Test Loss: 0.234 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 70 cost time: 0.5419399738311768
Epoch: 70, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.225 Vali Acc: 0.925 Test Loss: 0.225 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 71 cost time: 0.5495254993438721
Epoch: 71, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.213 Vali Acc: 0.950 Test Loss: 0.213 Test Acc: 0.950
Validation loss decreased (-0.924998 --> -0.949998).  Saving model ...
Epoch: 72 cost time: 0.5517451763153076
Epoch: 72, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.202 Vali Acc: 0.950 Test Loss: 0.202 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 73 cost time: 0.7307522296905518
Epoch: 73, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.197 Vali Acc: 0.950 Test Loss: 0.197 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 74 cost time: 0.49497485160827637
Epoch: 74, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.195 Vali Acc: 0.950 Test Loss: 0.195 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 75 cost time: 0.5693314075469971
Epoch: 75, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.194 Vali Acc: 0.925 Test Loss: 0.194 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.5937638282775879
Epoch: 76, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.194 Vali Acc: 0.925 Test Loss: 0.194 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 0.4542124271392822
Epoch: 77, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.188 Vali Acc: 0.925 Test Loss: 0.188 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 0.4596827030181885
Epoch: 78, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.181 Vali Acc: 0.925 Test Loss: 0.181 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 0.6338090896606445
Epoch: 79, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.171 Vali Acc: 0.925 Test Loss: 0.171 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 80 cost time: 0.5089647769927979
Epoch: 80, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.161 Vali Acc: 0.950 Test Loss: 0.161 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 81 cost time: 0.42325615882873535
Epoch: 81, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.151 Vali Acc: 0.950 Test Loss: 0.151 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 82 cost time: 0.5898785591125488
Epoch: 82, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.142 Vali Acc: 0.950 Test Loss: 0.142 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949999).  Saving model ...
Epoch: 83 cost time: 0.5233268737792969
Epoch: 83, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.134 Vali Acc: 0.950 Test Loss: 0.134 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 84 cost time: 0.44452404975891113
Epoch: 84, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.129 Vali Acc: 0.975 Test Loss: 0.129 Test Acc: 0.975
Validation loss decreased (-0.949999 --> -0.974999).  Saving model ...
Epoch: 85 cost time: 0.7535817623138428
Epoch: 85, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.125 Vali Acc: 0.975 Test Loss: 0.125 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 86 cost time: 0.6122870445251465
Epoch: 86, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.122 Vali Acc: 0.975 Test Loss: 0.122 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 87 cost time: 0.5185914039611816
Epoch: 87, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.121 Vali Acc: 0.975 Test Loss: 0.121 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 88 cost time: 0.5847716331481934
Epoch: 88, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.121 Vali Acc: 0.975 Test Loss: 0.121 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 89 cost time: 0.5678243637084961
Epoch: 89, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.122 Vali Acc: 0.975 Test Loss: 0.122 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 0.41976451873779297
Epoch: 90, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.122 Vali Acc: 0.975 Test Loss: 0.122 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 91 cost time: 0.6195135116577148
Epoch: 91, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.123 Vali Acc: 0.950 Test Loss: 0.123 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 92 cost time: 0.6284346580505371
Epoch: 92, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.124 Vali Acc: 0.950 Test Loss: 0.124 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 93 cost time: 0.525566577911377
Epoch: 93, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.125 Vali Acc: 0.950 Test Loss: 0.125 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 94 cost time: 0.6231482028961182
Epoch: 94, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.123 Vali Acc: 0.950 Test Loss: 0.123 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 95 cost time: 0.5137510299682617
Epoch: 95, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.122 Vali Acc: 0.950 Test Loss: 0.122 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 96 cost time: 0.5604701042175293
Epoch: 96, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.119 Vali Acc: 0.950 Test Loss: 0.119 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 97 cost time: 0.5731546878814697
Epoch: 97, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.118 Vali Acc: 0.950 Test Loss: 0.118 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 98 cost time: 0.4909708499908447
Epoch: 98, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.115 Vali Acc: 0.950 Test Loss: 0.115 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm128_cs13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 22008
model size : 0.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm128_cs12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.62955641746521
Epoch: 1, Steps: 3 | Train Loss: 1.483 Vali Loss: 1.453 Vali Acc: 0.175 Test Loss: 1.453 Test Acc: 0.175
Validation loss decreased (inf --> -0.174985).  Saving model ...
Epoch: 2 cost time: 0.4768679141998291
Epoch: 2, Steps: 3 | Train Loss: 1.431 Vali Loss: 1.447 Vali Acc: 0.175 Test Loss: 1.447 Test Acc: 0.175
Validation loss decreased (-0.174985 --> -0.174986).  Saving model ...
Epoch: 3 cost time: 0.5727500915527344
Epoch: 3, Steps: 3 | Train Loss: 1.416 Vali Loss: 1.441 Vali Acc: 0.175 Test Loss: 1.441 Test Acc: 0.175
Validation loss decreased (-0.174986 --> -0.174986).  Saving model ...
Epoch: 4 cost time: 0.5640983581542969
Epoch: 4, Steps: 3 | Train Loss: 1.388 Vali Loss: 1.434 Vali Acc: 0.175 Test Loss: 1.434 Test Acc: 0.175
Validation loss decreased (-0.174986 --> -0.174986).  Saving model ...
Epoch: 5 cost time: 0.44701266288757324
Epoch: 5, Steps: 3 | Train Loss: 1.406 Vali Loss: 1.426 Vali Acc: 0.175 Test Loss: 1.426 Test Acc: 0.175
Validation loss decreased (-0.174986 --> -0.174986).  Saving model ...
Epoch: 6 cost time: 0.5020642280578613
Epoch: 6, Steps: 3 | Train Loss: 1.356 Vali Loss: 1.416 Vali Acc: 0.200 Test Loss: 1.416 Test Acc: 0.200
Validation loss decreased (-0.174986 --> -0.199986).  Saving model ...
Epoch: 7 cost time: 0.628741979598999
Epoch: 7, Steps: 3 | Train Loss: 1.371 Vali Loss: 1.405 Vali Acc: 0.200 Test Loss: 1.405 Test Acc: 0.200
Validation loss decreased (-0.199986 --> -0.199986).  Saving model ...
Epoch: 8 cost time: 0.5124061107635498
Epoch: 8, Steps: 3 | Train Loss: 1.347 Vali Loss: 1.393 Vali Acc: 0.225 Test Loss: 1.393 Test Acc: 0.225
Validation loss decreased (-0.199986 --> -0.224986).  Saving model ...
Epoch: 9 cost time: 0.6980443000793457
Epoch: 9, Steps: 3 | Train Loss: 1.304 Vali Loss: 1.380 Vali Acc: 0.250 Test Loss: 1.380 Test Acc: 0.250
Validation loss decreased (-0.224986 --> -0.249986).  Saving model ...
Epoch: 10 cost time: 0.6702554225921631
Epoch: 10, Steps: 3 | Train Loss: 1.287 Vali Loss: 1.366 Vali Acc: 0.250 Test Loss: 1.366 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 11 cost time: 0.48248791694641113
Epoch: 11, Steps: 3 | Train Loss: 1.247 Vali Loss: 1.352 Vali Acc: 0.275 Test Loss: 1.352 Test Acc: 0.275
Validation loss decreased (-0.249986 --> -0.274986).  Saving model ...
Epoch: 12 cost time: 0.49962401390075684
Epoch: 12, Steps: 3 | Train Loss: 1.236 Vali Loss: 1.337 Vali Acc: 0.275 Test Loss: 1.337 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274987).  Saving model ...
Epoch: 13 cost time: 0.49179601669311523
Epoch: 13, Steps: 3 | Train Loss: 1.194 Vali Loss: 1.321 Vali Acc: 0.300 Test Loss: 1.321 Test Acc: 0.300
Validation loss decreased (-0.274987 --> -0.299987).  Saving model ...
Epoch: 14 cost time: 0.5278325080871582
Epoch: 14, Steps: 3 | Train Loss: 1.165 Vali Loss: 1.305 Vali Acc: 0.325 Test Loss: 1.305 Test Acc: 0.325
Validation loss decreased (-0.299987 --> -0.324987).  Saving model ...
Epoch: 15 cost time: 0.49089908599853516
Epoch: 15, Steps: 3 | Train Loss: 1.147 Vali Loss: 1.288 Vali Acc: 0.375 Test Loss: 1.288 Test Acc: 0.375
Validation loss decreased (-0.324987 --> -0.374987).  Saving model ...
Epoch: 16 cost time: 0.5677318572998047
Epoch: 16, Steps: 3 | Train Loss: 1.084 Vali Loss: 1.272 Vali Acc: 0.425 Test Loss: 1.272 Test Acc: 0.425
Validation loss decreased (-0.374987 --> -0.424987).  Saving model ...
Epoch: 17 cost time: 0.5352897644042969
Epoch: 17, Steps: 3 | Train Loss: 1.078 Vali Loss: 1.256 Vali Acc: 0.450 Test Loss: 1.256 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449987).  Saving model ...
Epoch: 18 cost time: 0.5201206207275391
Epoch: 18, Steps: 3 | Train Loss: 1.034 Vali Loss: 1.239 Vali Acc: 0.625 Test Loss: 1.239 Test Acc: 0.625
Validation loss decreased (-0.449987 --> -0.624988).  Saving model ...
Epoch: 19 cost time: 0.5578353404998779
Epoch: 19, Steps: 3 | Train Loss: 1.023 Vali Loss: 1.223 Vali Acc: 0.625 Test Loss: 1.223 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 20 cost time: 0.5671443939208984
Epoch: 20, Steps: 3 | Train Loss: 0.986 Vali Loss: 1.206 Vali Acc: 0.675 Test Loss: 1.206 Test Acc: 0.675
Validation loss decreased (-0.624988 --> -0.674988).  Saving model ...
Epoch: 21 cost time: 0.5966751575469971
Epoch: 21, Steps: 3 | Train Loss: 0.954 Vali Loss: 1.190 Vali Acc: 0.675 Test Loss: 1.190 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674988).  Saving model ...
Epoch: 22 cost time: 0.5230808258056641
Epoch: 22, Steps: 3 | Train Loss: 0.878 Vali Loss: 1.174 Vali Acc: 0.675 Test Loss: 1.174 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674988).  Saving model ...
Epoch: 23 cost time: 0.44530200958251953
Epoch: 23, Steps: 3 | Train Loss: 0.882 Vali Loss: 1.158 Vali Acc: 0.700 Test Loss: 1.158 Test Acc: 0.700
Validation loss decreased (-0.674988 --> -0.699988).  Saving model ...
Epoch: 24 cost time: 0.5133357048034668
Epoch: 24, Steps: 3 | Train Loss: 0.864 Vali Loss: 1.141 Vali Acc: 0.700 Test Loss: 1.141 Test Acc: 0.700
Validation loss decreased (-0.699988 --> -0.699989).  Saving model ...
Epoch: 25 cost time: 0.44340968132019043
Epoch: 25, Steps: 3 | Train Loss: 0.823 Vali Loss: 1.126 Vali Acc: 0.700 Test Loss: 1.126 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 26 cost time: 0.4500460624694824
Epoch: 26, Steps: 3 | Train Loss: 0.800 Vali Loss: 1.111 Vali Acc: 0.700 Test Loss: 1.111 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 27 cost time: 0.5581707954406738
Epoch: 27, Steps: 3 | Train Loss: 0.799 Vali Loss: 1.096 Vali Acc: 0.725 Test Loss: 1.096 Test Acc: 0.725
Validation loss decreased (-0.699989 --> -0.724989).  Saving model ...
Epoch: 28 cost time: 0.5511560440063477
Epoch: 28, Steps: 3 | Train Loss: 0.710 Vali Loss: 1.081 Vali Acc: 0.725 Test Loss: 1.081 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 29 cost time: 0.49096059799194336
Epoch: 29, Steps: 3 | Train Loss: 0.695 Vali Loss: 1.065 Vali Acc: 0.725 Test Loss: 1.065 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 30 cost time: 0.42127490043640137
Epoch: 30, Steps: 3 | Train Loss: 0.718 Vali Loss: 1.049 Vali Acc: 0.750 Test Loss: 1.049 Test Acc: 0.750
Validation loss decreased (-0.724989 --> -0.749990).  Saving model ...
Epoch: 31 cost time: 0.4502525329589844
Epoch: 31, Steps: 3 | Train Loss: 0.689 Vali Loss: 1.034 Vali Acc: 0.750 Test Loss: 1.034 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 32 cost time: 0.531510591506958
Epoch: 32, Steps: 3 | Train Loss: 0.655 Vali Loss: 1.020 Vali Acc: 0.750 Test Loss: 1.020 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 33 cost time: 0.6376805305480957
Epoch: 33, Steps: 3 | Train Loss: 0.593 Vali Loss: 1.005 Vali Acc: 0.750 Test Loss: 1.005 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 34 cost time: 0.5018413066864014
Epoch: 34, Steps: 3 | Train Loss: 0.644 Vali Loss: 0.991 Vali Acc: 0.725 Test Loss: 0.991 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.5311009883880615
Epoch: 35, Steps: 3 | Train Loss: 0.567 Vali Loss: 0.977 Vali Acc: 0.725 Test Loss: 0.977 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.5203597545623779
Epoch: 36, Steps: 3 | Train Loss: 0.582 Vali Loss: 0.961 Vali Acc: 0.725 Test Loss: 0.961 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.5525803565979004
Epoch: 37, Steps: 3 | Train Loss: 0.563 Vali Loss: 0.946 Vali Acc: 0.725 Test Loss: 0.946 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.7441895008087158
Epoch: 38, Steps: 3 | Train Loss: 0.516 Vali Loss: 0.932 Vali Acc: 0.725 Test Loss: 0.932 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.4692118167877197
Epoch: 39, Steps: 3 | Train Loss: 0.498 Vali Loss: 0.918 Vali Acc: 0.750 Test Loss: 0.918 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749991).  Saving model ...
Epoch: 40 cost time: 0.6853764057159424
Epoch: 40, Steps: 3 | Train Loss: 0.503 Vali Loss: 0.904 Vali Acc: 0.750 Test Loss: 0.904 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 41 cost time: 0.6381983757019043
Epoch: 41, Steps: 3 | Train Loss: 0.485 Vali Loss: 0.891 Vali Acc: 0.750 Test Loss: 0.891 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 42 cost time: 0.5728750228881836
Epoch: 42, Steps: 3 | Train Loss: 0.454 Vali Loss: 0.879 Vali Acc: 0.750 Test Loss: 0.879 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 43 cost time: 0.8121767044067383
Epoch: 43, Steps: 3 | Train Loss: 0.455 Vali Loss: 0.868 Vali Acc: 0.750 Test Loss: 0.868 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 44 cost time: 0.7308382987976074
Epoch: 44, Steps: 3 | Train Loss: 0.422 Vali Loss: 0.857 Vali Acc: 0.750 Test Loss: 0.857 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 45 cost time: 0.5467643737792969
Epoch: 45, Steps: 3 | Train Loss: 0.411 Vali Loss: 0.846 Vali Acc: 0.750 Test Loss: 0.846 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 46 cost time: 0.7527527809143066
Epoch: 46, Steps: 3 | Train Loss: 0.414 Vali Loss: 0.836 Vali Acc: 0.750 Test Loss: 0.836 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 47 cost time: 0.6193883419036865
Epoch: 47, Steps: 3 | Train Loss: 0.396 Vali Loss: 0.826 Vali Acc: 0.750 Test Loss: 0.826 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 48 cost time: 0.5990245342254639
Epoch: 48, Steps: 3 | Train Loss: 0.364 Vali Loss: 0.813 Vali Acc: 0.750 Test Loss: 0.813 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 49 cost time: 0.7515468597412109
Epoch: 49, Steps: 3 | Train Loss: 0.357 Vali Loss: 0.800 Vali Acc: 0.750 Test Loss: 0.800 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 50 cost time: 0.7239813804626465
Epoch: 50, Steps: 3 | Train Loss: 0.349 Vali Loss: 0.787 Vali Acc: 0.750 Test Loss: 0.787 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 51 cost time: 0.663815975189209
Epoch: 51, Steps: 3 | Train Loss: 0.343 Vali Loss: 0.773 Vali Acc: 0.750 Test Loss: 0.773 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 52 cost time: 0.6932964324951172
Epoch: 52, Steps: 3 | Train Loss: 0.312 Vali Loss: 0.758 Vali Acc: 0.750 Test Loss: 0.758 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 53 cost time: 0.626427173614502
Epoch: 53, Steps: 3 | Train Loss: 0.325 Vali Loss: 0.742 Vali Acc: 0.800 Test Loss: 0.742 Test Acc: 0.800
Validation loss decreased (-0.749992 --> -0.799993).  Saving model ...
Epoch: 54 cost time: 0.6397037506103516
Epoch: 54, Steps: 3 | Train Loss: 0.301 Vali Loss: 0.725 Vali Acc: 0.800 Test Loss: 0.725 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 55 cost time: 0.5384547710418701
Epoch: 55, Steps: 3 | Train Loss: 0.283 Vali Loss: 0.707 Vali Acc: 0.800 Test Loss: 0.707 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 56 cost time: 0.7062883377075195
Epoch: 56, Steps: 3 | Train Loss: 0.272 Vali Loss: 0.687 Vali Acc: 0.800 Test Loss: 0.687 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 57 cost time: 0.600883960723877
Epoch: 57, Steps: 3 | Train Loss: 0.278 Vali Loss: 0.669 Vali Acc: 0.800 Test Loss: 0.669 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 58 cost time: 0.6104574203491211
Epoch: 58, Steps: 3 | Train Loss: 0.252 Vali Loss: 0.650 Vali Acc: 0.825 Test Loss: 0.650 Test Acc: 0.825
Validation loss decreased (-0.799993 --> -0.824993).  Saving model ...
Epoch: 59 cost time: 0.6317474842071533
Epoch: 59, Steps: 3 | Train Loss: 0.227 Vali Loss: 0.631 Vali Acc: 0.825 Test Loss: 0.631 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824994).  Saving model ...
Epoch: 60 cost time: 0.6852917671203613
Epoch: 60, Steps: 3 | Train Loss: 0.222 Vali Loss: 0.611 Vali Acc: 0.825 Test Loss: 0.611 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 61 cost time: 0.5787820816040039
Epoch: 61, Steps: 3 | Train Loss: 0.228 Vali Loss: 0.590 Vali Acc: 0.825 Test Loss: 0.590 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 62 cost time: 0.5705866813659668
Epoch: 62, Steps: 3 | Train Loss: 0.222 Vali Loss: 0.569 Vali Acc: 0.850 Test Loss: 0.569 Test Acc: 0.850
Validation loss decreased (-0.824994 --> -0.849994).  Saving model ...
Epoch: 63 cost time: 0.5858945846557617
Epoch: 63, Steps: 3 | Train Loss: 0.222 Vali Loss: 0.547 Vali Acc: 0.850 Test Loss: 0.547 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 64 cost time: 0.5542511940002441
Epoch: 64, Steps: 3 | Train Loss: 0.193 Vali Loss: 0.524 Vali Acc: 0.850 Test Loss: 0.524 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 65 cost time: 0.6077713966369629
Epoch: 65, Steps: 3 | Train Loss: 0.188 Vali Loss: 0.502 Vali Acc: 0.850 Test Loss: 0.502 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 66 cost time: 0.6618516445159912
Epoch: 66, Steps: 3 | Train Loss: 0.193 Vali Loss: 0.481 Vali Acc: 0.875 Test Loss: 0.481 Test Acc: 0.875
Validation loss decreased (-0.849995 --> -0.874995).  Saving model ...
Epoch: 67 cost time: 0.5665943622589111
Epoch: 67, Steps: 3 | Train Loss: 0.168 Vali Loss: 0.458 Vali Acc: 0.875 Test Loss: 0.458 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 68 cost time: 0.5511484146118164
Epoch: 68, Steps: 3 | Train Loss: 0.178 Vali Loss: 0.434 Vali Acc: 0.875 Test Loss: 0.434 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 69 cost time: 0.5222647190093994
Epoch: 69, Steps: 3 | Train Loss: 0.168 Vali Loss: 0.407 Vali Acc: 0.875 Test Loss: 0.407 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 70 cost time: 0.5007140636444092
Epoch: 70, Steps: 3 | Train Loss: 0.171 Vali Loss: 0.382 Vali Acc: 0.875 Test Loss: 0.382 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 71 cost time: 0.6972424983978271
Epoch: 71, Steps: 3 | Train Loss: 0.145 Vali Loss: 0.360 Vali Acc: 0.900 Test Loss: 0.360 Test Acc: 0.900
Validation loss decreased (-0.874996 --> -0.899996).  Saving model ...
Epoch: 72 cost time: 0.5937542915344238
Epoch: 72, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.340 Vali Acc: 0.925 Test Loss: 0.340 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924997).  Saving model ...
Epoch: 73 cost time: 0.5930800437927246
Epoch: 73, Steps: 3 | Train Loss: 0.123 Vali Loss: 0.324 Vali Acc: 0.925 Test Loss: 0.324 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 74 cost time: 0.5798890590667725
Epoch: 74, Steps: 3 | Train Loss: 0.111 Vali Loss: 0.301 Vali Acc: 0.925 Test Loss: 0.301 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 75 cost time: 0.5828893184661865
Epoch: 75, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.277 Vali Acc: 0.925 Test Loss: 0.277 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 76 cost time: 0.5855228900909424
Epoch: 76, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.252 Vali Acc: 0.925 Test Loss: 0.252 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 77 cost time: 0.5562560558319092
Epoch: 77, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.230 Vali Acc: 0.925 Test Loss: 0.230 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924998).  Saving model ...
Epoch: 78 cost time: 0.7095799446105957
Epoch: 78, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.213 Vali Acc: 0.925 Test Loss: 0.213 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 79 cost time: 0.7244372367858887
Epoch: 79, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.197 Vali Acc: 0.950 Test Loss: 0.197 Test Acc: 0.950
Validation loss decreased (-0.924998 --> -0.949998).  Saving model ...
Epoch: 80 cost time: 0.5334479808807373
Epoch: 80, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.177 Vali Acc: 0.950 Test Loss: 0.177 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 81 cost time: 0.669022798538208
Epoch: 81, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.158 Vali Acc: 0.950 Test Loss: 0.158 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 82 cost time: 0.7689924240112305
Epoch: 82, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.139 Vali Acc: 0.975 Test Loss: 0.139 Test Acc: 0.975
Validation loss decreased (-0.949998 --> -0.974999).  Saving model ...
Epoch: 83 cost time: 0.7527377605438232
Epoch: 83, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.125 Vali Acc: 0.975 Test Loss: 0.125 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 84 cost time: 0.7289884090423584
Epoch: 84, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.114 Vali Acc: 0.975 Test Loss: 0.114 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 85 cost time: 0.7249486446380615
Epoch: 85, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.102 Vali Acc: 0.975 Test Loss: 0.102 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 86 cost time: 0.6990063190460205
Epoch: 86, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.096 Vali Acc: 0.975 Test Loss: 0.096 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 87 cost time: 0.6120655536651611
Epoch: 87, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.084 Vali Acc: 0.975 Test Loss: 0.084 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 88 cost time: 0.6504499912261963
Epoch: 88, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.074 Vali Acc: 0.975 Test Loss: 0.074 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 89 cost time: 0.5581221580505371
Epoch: 89, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.065 Vali Acc: 0.975 Test Loss: 0.065 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 90 cost time: 0.58833909034729
Epoch: 90, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.055 Vali Acc: 1.000 Test Loss: 0.055 Test Acc: 1.000
Validation loss decreased (-0.974999 --> -0.999999).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm128_cs12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 22382
model size : 0.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm128_cs10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6994271278381348
Epoch: 1, Steps: 3 | Train Loss: 1.485 Vali Loss: 1.554 Vali Acc: 0.350 Test Loss: 1.554 Test Acc: 0.350
Validation loss decreased (inf --> -0.349984).  Saving model ...
Epoch: 2 cost time: 0.611194372177124
Epoch: 2, Steps: 3 | Train Loss: 1.445 Vali Loss: 1.548 Vali Acc: 0.350 Test Loss: 1.548 Test Acc: 0.350
Validation loss decreased (-0.349984 --> -0.349985).  Saving model ...
Epoch: 3 cost time: 0.4529256820678711
Epoch: 3, Steps: 3 | Train Loss: 1.419 Vali Loss: 1.543 Vali Acc: 0.350 Test Loss: 1.543 Test Acc: 0.350
Validation loss decreased (-0.349985 --> -0.349985).  Saving model ...
Epoch: 4 cost time: 0.6737625598907471
Epoch: 4, Steps: 3 | Train Loss: 1.396 Vali Loss: 1.536 Vali Acc: 0.350 Test Loss: 1.536 Test Acc: 0.350
Validation loss decreased (-0.349985 --> -0.349985).  Saving model ...
Epoch: 5 cost time: 0.4517688751220703
Epoch: 5, Steps: 3 | Train Loss: 1.372 Vali Loss: 1.527 Vali Acc: 0.350 Test Loss: 1.527 Test Acc: 0.350
Validation loss decreased (-0.349985 --> -0.349985).  Saving model ...
Epoch: 6 cost time: 0.5151557922363281
Epoch: 6, Steps: 3 | Train Loss: 1.346 Vali Loss: 1.518 Vali Acc: 0.375 Test Loss: 1.518 Test Acc: 0.375
Validation loss decreased (-0.349985 --> -0.374985).  Saving model ...
Epoch: 7 cost time: 0.5984995365142822
Epoch: 7, Steps: 3 | Train Loss: 1.326 Vali Loss: 1.507 Vali Acc: 0.375 Test Loss: 1.507 Test Acc: 0.375
Validation loss decreased (-0.374985 --> -0.374985).  Saving model ...
Epoch: 8 cost time: 0.49821925163269043
Epoch: 8, Steps: 3 | Train Loss: 1.294 Vali Loss: 1.496 Vali Acc: 0.375 Test Loss: 1.496 Test Acc: 0.375
Validation loss decreased (-0.374985 --> -0.374985).  Saving model ...
Epoch: 9 cost time: 0.5289151668548584
Epoch: 9, Steps: 3 | Train Loss: 1.268 Vali Loss: 1.484 Vali Acc: 0.375 Test Loss: 1.484 Test Acc: 0.375
Validation loss decreased (-0.374985 --> -0.374985).  Saving model ...
Epoch: 10 cost time: 0.5148334503173828
Epoch: 10, Steps: 3 | Train Loss: 1.237 Vali Loss: 1.472 Vali Acc: 0.400 Test Loss: 1.472 Test Acc: 0.400
Validation loss decreased (-0.374985 --> -0.399985).  Saving model ...
Epoch: 11 cost time: 0.5000913143157959
Epoch: 11, Steps: 3 | Train Loss: 1.206 Vali Loss: 1.458 Vali Acc: 0.400 Test Loss: 1.458 Test Acc: 0.400
Validation loss decreased (-0.399985 --> -0.399985).  Saving model ...
Epoch: 12 cost time: 0.45167112350463867
Epoch: 12, Steps: 3 | Train Loss: 1.163 Vali Loss: 1.445 Vali Acc: 0.425 Test Loss: 1.445 Test Acc: 0.425
Validation loss decreased (-0.399985 --> -0.424986).  Saving model ...
Epoch: 13 cost time: 0.5789916515350342
Epoch: 13, Steps: 3 | Train Loss: 1.156 Vali Loss: 1.431 Vali Acc: 0.425 Test Loss: 1.431 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424986).  Saving model ...
Epoch: 14 cost time: 0.4718465805053711
Epoch: 14, Steps: 3 | Train Loss: 1.085 Vali Loss: 1.416 Vali Acc: 0.425 Test Loss: 1.416 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424986).  Saving model ...
Epoch: 15 cost time: 0.46509695053100586
Epoch: 15, Steps: 3 | Train Loss: 1.084 Vali Loss: 1.402 Vali Acc: 0.425 Test Loss: 1.402 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424986).  Saving model ...
Epoch: 16 cost time: 0.5771744251251221
Epoch: 16, Steps: 3 | Train Loss: 1.071 Vali Loss: 1.388 Vali Acc: 0.450 Test Loss: 1.388 Test Acc: 0.450
Validation loss decreased (-0.424986 --> -0.449986).  Saving model ...
Epoch: 17 cost time: 0.648653507232666
Epoch: 17, Steps: 3 | Train Loss: 1.005 Vali Loss: 1.374 Vali Acc: 0.475 Test Loss: 1.374 Test Acc: 0.475
Validation loss decreased (-0.449986 --> -0.474986).  Saving model ...
Epoch: 18 cost time: 0.46254515647888184
Epoch: 18, Steps: 3 | Train Loss: 0.964 Vali Loss: 1.360 Vali Acc: 0.450 Test Loss: 1.360 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.527043342590332
Epoch: 19, Steps: 3 | Train Loss: 0.927 Vali Loss: 1.345 Vali Acc: 0.475 Test Loss: 1.345 Test Acc: 0.475
Validation loss decreased (-0.474986 --> -0.474987).  Saving model ...
Epoch: 20 cost time: 0.4804861545562744
Epoch: 20, Steps: 3 | Train Loss: 0.916 Vali Loss: 1.329 Vali Acc: 0.475 Test Loss: 1.329 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 21 cost time: 0.5738954544067383
Epoch: 21, Steps: 3 | Train Loss: 0.903 Vali Loss: 1.312 Vali Acc: 0.500 Test Loss: 1.312 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499987).  Saving model ...
Epoch: 22 cost time: 0.47197961807250977
Epoch: 22, Steps: 3 | Train Loss: 0.864 Vali Loss: 1.296 Vali Acc: 0.525 Test Loss: 1.296 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524987).  Saving model ...
Epoch: 23 cost time: 0.5591847896575928
Epoch: 23, Steps: 3 | Train Loss: 0.857 Vali Loss: 1.280 Vali Acc: 0.550 Test Loss: 1.280 Test Acc: 0.550
Validation loss decreased (-0.524987 --> -0.549987).  Saving model ...
Epoch: 24 cost time: 0.5482678413391113
Epoch: 24, Steps: 3 | Train Loss: 0.824 Vali Loss: 1.263 Vali Acc: 0.550 Test Loss: 1.263 Test Acc: 0.550
Validation loss decreased (-0.549987 --> -0.549987).  Saving model ...
Epoch: 25 cost time: 0.4979729652404785
Epoch: 25, Steps: 3 | Train Loss: 0.808 Vali Loss: 1.248 Vali Acc: 0.575 Test Loss: 1.248 Test Acc: 0.575
Validation loss decreased (-0.549987 --> -0.574988).  Saving model ...
Epoch: 26 cost time: 0.5985939502716064
Epoch: 26, Steps: 3 | Train Loss: 0.757 Vali Loss: 1.232 Vali Acc: 0.550 Test Loss: 1.232 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5471189022064209
Epoch: 27, Steps: 3 | Train Loss: 0.726 Vali Loss: 1.216 Vali Acc: 0.550 Test Loss: 1.216 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6209478378295898
Epoch: 28, Steps: 3 | Train Loss: 0.703 Vali Loss: 1.199 Vali Acc: 0.650 Test Loss: 1.199 Test Acc: 0.650
Validation loss decreased (-0.574988 --> -0.649988).  Saving model ...
Epoch: 29 cost time: 0.4913203716278076
Epoch: 29, Steps: 3 | Train Loss: 0.707 Vali Loss: 1.183 Vali Acc: 0.725 Test Loss: 1.183 Test Acc: 0.725
Validation loss decreased (-0.649988 --> -0.724988).  Saving model ...
Epoch: 30 cost time: 0.5256376266479492
Epoch: 30, Steps: 3 | Train Loss: 0.660 Vali Loss: 1.165 Vali Acc: 0.725 Test Loss: 1.165 Test Acc: 0.725
Validation loss decreased (-0.724988 --> -0.724988).  Saving model ...
Epoch: 31 cost time: 0.5013039112091064
Epoch: 31, Steps: 3 | Train Loss: 0.609 Vali Loss: 1.148 Vali Acc: 0.725 Test Loss: 1.148 Test Acc: 0.725
Validation loss decreased (-0.724988 --> -0.724989).  Saving model ...
Epoch: 32 cost time: 0.4547266960144043
Epoch: 32, Steps: 3 | Train Loss: 0.602 Vali Loss: 1.130 Vali Acc: 0.750 Test Loss: 1.130 Test Acc: 0.750
Validation loss decreased (-0.724989 --> -0.749989).  Saving model ...
Epoch: 33 cost time: 0.653348445892334
Epoch: 33, Steps: 3 | Train Loss: 0.586 Vali Loss: 1.112 Vali Acc: 0.750 Test Loss: 1.112 Test Acc: 0.750
Validation loss decreased (-0.749989 --> -0.749989).  Saving model ...
Epoch: 34 cost time: 0.5065031051635742
Epoch: 34, Steps: 3 | Train Loss: 0.557 Vali Loss: 1.093 Vali Acc: 0.750 Test Loss: 1.093 Test Acc: 0.750
Validation loss decreased (-0.749989 --> -0.749989).  Saving model ...
Epoch: 35 cost time: 0.4639012813568115
Epoch: 35, Steps: 3 | Train Loss: 0.553 Vali Loss: 1.074 Vali Acc: 0.750 Test Loss: 1.074 Test Acc: 0.750
Validation loss decreased (-0.749989 --> -0.749989).  Saving model ...
Epoch: 36 cost time: 0.485001802444458
Epoch: 36, Steps: 3 | Train Loss: 0.517 Vali Loss: 1.054 Vali Acc: 0.750 Test Loss: 1.054 Test Acc: 0.750
Validation loss decreased (-0.749989 --> -0.749989).  Saving model ...
Epoch: 37 cost time: 0.4336509704589844
Epoch: 37, Steps: 3 | Train Loss: 0.480 Vali Loss: 1.036 Vali Acc: 0.750 Test Loss: 1.036 Test Acc: 0.750
Validation loss decreased (-0.749989 --> -0.749990).  Saving model ...
Epoch: 38 cost time: 0.46607089042663574
Epoch: 38, Steps: 3 | Train Loss: 0.488 Vali Loss: 1.018 Vali Acc: 0.750 Test Loss: 1.018 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 39 cost time: 0.4113039970397949
Epoch: 39, Steps: 3 | Train Loss: 0.468 Vali Loss: 1.001 Vali Acc: 0.750 Test Loss: 1.001 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 40 cost time: 0.5133910179138184
Epoch: 40, Steps: 3 | Train Loss: 0.452 Vali Loss: 0.981 Vali Acc: 0.750 Test Loss: 0.981 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 41 cost time: 0.6211435794830322
Epoch: 41, Steps: 3 | Train Loss: 0.440 Vali Loss: 0.963 Vali Acc: 0.775 Test Loss: 0.963 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774990).  Saving model ...
Epoch: 42 cost time: 0.5522868633270264
Epoch: 42, Steps: 3 | Train Loss: 0.408 Vali Loss: 0.946 Vali Acc: 0.775 Test Loss: 0.946 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774991).  Saving model ...
Epoch: 43 cost time: 0.4717562198638916
Epoch: 43, Steps: 3 | Train Loss: 0.406 Vali Loss: 0.926 Vali Acc: 0.775 Test Loss: 0.926 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 44 cost time: 0.5314986705780029
Epoch: 44, Steps: 3 | Train Loss: 0.391 Vali Loss: 0.904 Vali Acc: 0.800 Test Loss: 0.904 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799991).  Saving model ...
Epoch: 45 cost time: 0.5958733558654785
Epoch: 45, Steps: 3 | Train Loss: 0.409 Vali Loss: 0.882 Vali Acc: 0.800 Test Loss: 0.882 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 46 cost time: 0.5337810516357422
Epoch: 46, Steps: 3 | Train Loss: 0.376 Vali Loss: 0.860 Vali Acc: 0.800 Test Loss: 0.860 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 47 cost time: 0.46088719367980957
Epoch: 47, Steps: 3 | Train Loss: 0.310 Vali Loss: 0.838 Vali Acc: 0.800 Test Loss: 0.838 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799992).  Saving model ...
Epoch: 48 cost time: 0.5158674716949463
Epoch: 48, Steps: 3 | Train Loss: 0.334 Vali Loss: 0.813 Vali Acc: 0.800 Test Loss: 0.813 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 49 cost time: 0.49449777603149414
Epoch: 49, Steps: 3 | Train Loss: 0.302 Vali Loss: 0.786 Vali Acc: 0.850 Test Loss: 0.786 Test Acc: 0.850
Validation loss decreased (-0.799992 --> -0.849992).  Saving model ...
Epoch: 50 cost time: 0.4736020565032959
Epoch: 50, Steps: 3 | Train Loss: 0.306 Vali Loss: 0.759 Vali Acc: 0.850 Test Loss: 0.759 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 51 cost time: 0.5279340744018555
Epoch: 51, Steps: 3 | Train Loss: 0.296 Vali Loss: 0.730 Vali Acc: 0.850 Test Loss: 0.730 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849993).  Saving model ...
Epoch: 52 cost time: 0.6054821014404297
Epoch: 52, Steps: 3 | Train Loss: 0.253 Vali Loss: 0.701 Vali Acc: 0.850 Test Loss: 0.701 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 53 cost time: 0.5339677333831787
Epoch: 53, Steps: 3 | Train Loss: 0.250 Vali Loss: 0.672 Vali Acc: 0.850 Test Loss: 0.672 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 54 cost time: 0.5764997005462646
Epoch: 54, Steps: 3 | Train Loss: 0.233 Vali Loss: 0.642 Vali Acc: 0.850 Test Loss: 0.642 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 55 cost time: 0.5355684757232666
Epoch: 55, Steps: 3 | Train Loss: 0.243 Vali Loss: 0.611 Vali Acc: 0.850 Test Loss: 0.611 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 56 cost time: 0.5709550380706787
Epoch: 56, Steps: 3 | Train Loss: 0.215 Vali Loss: 0.580 Vali Acc: 0.875 Test Loss: 0.580 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874994).  Saving model ...
Epoch: 57 cost time: 0.4823908805847168
Epoch: 57, Steps: 3 | Train Loss: 0.203 Vali Loss: 0.552 Vali Acc: 0.875 Test Loss: 0.552 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 58 cost time: 0.561626672744751
Epoch: 58, Steps: 3 | Train Loss: 0.218 Vali Loss: 0.525 Vali Acc: 0.875 Test Loss: 0.525 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 59 cost time: 0.6636440753936768
Epoch: 59, Steps: 3 | Train Loss: 0.190 Vali Loss: 0.497 Vali Acc: 0.875 Test Loss: 0.497 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 60 cost time: 0.6513419151306152
Epoch: 60, Steps: 3 | Train Loss: 0.194 Vali Loss: 0.469 Vali Acc: 0.875 Test Loss: 0.469 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 61 cost time: 0.7362039089202881
Epoch: 61, Steps: 3 | Train Loss: 0.163 Vali Loss: 0.440 Vali Acc: 0.875 Test Loss: 0.440 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 62 cost time: 0.7079002857208252
Epoch: 62, Steps: 3 | Train Loss: 0.142 Vali Loss: 0.412 Vali Acc: 0.875 Test Loss: 0.412 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 63 cost time: 0.5004210472106934
Epoch: 63, Steps: 3 | Train Loss: 0.139 Vali Loss: 0.382 Vali Acc: 0.900 Test Loss: 0.382 Test Acc: 0.900
Validation loss decreased (-0.874996 --> -0.899996).  Saving model ...
Epoch: 64 cost time: 0.6558971405029297
Epoch: 64, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.351 Vali Acc: 0.925 Test Loss: 0.351 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 65 cost time: 0.6964540481567383
Epoch: 65, Steps: 3 | Train Loss: 0.112 Vali Loss: 0.320 Vali Acc: 0.950 Test Loss: 0.320 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949997).  Saving model ...
Epoch: 66 cost time: 0.5684301853179932
Epoch: 66, Steps: 3 | Train Loss: 0.109 Vali Loss: 0.292 Vali Acc: 0.950 Test Loss: 0.292 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 67 cost time: 0.7016632556915283
Epoch: 67, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.264 Vali Acc: 0.950 Test Loss: 0.264 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 68 cost time: 0.6226263046264648
Epoch: 68, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.234 Vali Acc: 0.975 Test Loss: 0.234 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974998).  Saving model ...
Epoch: 69 cost time: 0.560035228729248
Epoch: 69, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.208 Vali Acc: 0.975 Test Loss: 0.208 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 70 cost time: 0.694244384765625
Epoch: 70, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.185 Vali Acc: 0.975 Test Loss: 0.185 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 71 cost time: 0.6805005073547363
Epoch: 71, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.167 Vali Acc: 0.975 Test Loss: 0.167 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 72 cost time: 0.5274991989135742
Epoch: 72, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.153 Vali Acc: 0.975 Test Loss: 0.153 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 73 cost time: 0.5764048099517822
Epoch: 73, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.141 Vali Acc: 0.975 Test Loss: 0.141 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 74 cost time: 0.7471227645874023
Epoch: 74, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.133 Vali Acc: 0.975 Test Loss: 0.133 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 75 cost time: 0.6520624160766602
Epoch: 75, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.128 Vali Acc: 0.975 Test Loss: 0.128 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 76 cost time: 0.5929450988769531
Epoch: 76, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.124 Vali Acc: 0.975 Test Loss: 0.124 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 77 cost time: 0.6106500625610352
Epoch: 77, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.120 Vali Acc: 0.975 Test Loss: 0.120 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 78 cost time: 0.5969352722167969
Epoch: 78, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.116 Vali Acc: 0.975 Test Loss: 0.116 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 79 cost time: 0.5598790645599365
Epoch: 79, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.112 Vali Acc: 0.975 Test Loss: 0.112 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 80 cost time: 0.6854910850524902
Epoch: 80, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.107 Vali Acc: 0.975 Test Loss: 0.107 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 81 cost time: 0.6429746150970459
Epoch: 81, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.103 Vali Acc: 0.975 Test Loss: 0.103 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 82 cost time: 0.6664228439331055
Epoch: 82, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.097 Vali Acc: 0.975 Test Loss: 0.097 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 83 cost time: 0.6383371353149414
Epoch: 83, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.092 Vali Acc: 0.975 Test Loss: 0.092 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 84 cost time: 0.631331205368042
Epoch: 84, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.089 Vali Acc: 0.975 Test Loss: 0.089 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 85 cost time: 0.592210054397583
Epoch: 85, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.087 Vali Acc: 0.975 Test Loss: 0.087 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 86 cost time: 0.6487958431243896
Epoch: 86, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.084 Vali Acc: 0.975 Test Loss: 0.084 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 87 cost time: 0.5804316997528076
Epoch: 87, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.975 Test Loss: 0.081 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 88 cost time: 0.6301224231719971
Epoch: 88, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.975 Test Loss: 0.079 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 89 cost time: 0.5651147365570068
Epoch: 89, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.077 Vali Acc: 0.975 Test Loss: 0.077 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 90 cost time: 0.623267412185669
Epoch: 90, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.076 Vali Acc: 0.975 Test Loss: 0.076 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 91 cost time: 0.5608608722686768
Epoch: 91, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.074 Vali Acc: 0.975 Test Loss: 0.074 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 92 cost time: 0.5718622207641602
Epoch: 92, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.073 Vali Acc: 0.975 Test Loss: 0.073 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 93 cost time: 0.5900392532348633
Epoch: 93, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.072 Vali Acc: 0.975 Test Loss: 0.072 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 94 cost time: 0.6256492137908936
Epoch: 94, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.072 Vali Acc: 0.975 Test Loss: 0.072 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 95 cost time: 0.6481387615203857
Epoch: 95, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.071 Vali Acc: 0.975 Test Loss: 0.071 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 96 cost time: 0.5625452995300293
Epoch: 96, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.071 Vali Acc: 0.975 Test Loss: 0.071 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 0.5325136184692383
Epoch: 97, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.073 Vali Acc: 0.975 Test Loss: 0.073 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 98 cost time: 0.5631163120269775
Epoch: 98, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.073 Vali Acc: 0.975 Test Loss: 0.073 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 99 cost time: 0.4678945541381836
Epoch: 99, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.073 Vali Acc: 0.975 Test Loss: 0.073 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 100 cost time: 0.5662498474121094
Epoch: 100, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.975 Test Loss: 0.074 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm128_cs10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 21496
model size : 0.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm128_cs9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7599537372589111
Epoch: 1, Steps: 3 | Train Loss: 1.370 Vali Loss: 1.442 Vali Acc: 0.325 Test Loss: 1.442 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 0.46761417388916016
Epoch: 2, Steps: 3 | Train Loss: 1.376 Vali Loss: 1.436 Vali Acc: 0.325 Test Loss: 1.436 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324986).  Saving model ...
Epoch: 3 cost time: 0.5382778644561768
Epoch: 3, Steps: 3 | Train Loss: 1.365 Vali Loss: 1.430 Vali Acc: 0.325 Test Loss: 1.430 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324986).  Saving model ...
Epoch: 4 cost time: 0.569232702255249
Epoch: 4, Steps: 3 | Train Loss: 1.341 Vali Loss: 1.423 Vali Acc: 0.325 Test Loss: 1.423 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324986).  Saving model ...
Epoch: 5 cost time: 0.4669914245605469
Epoch: 5, Steps: 3 | Train Loss: 1.327 Vali Loss: 1.414 Vali Acc: 0.350 Test Loss: 1.414 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349986).  Saving model ...
Epoch: 6 cost time: 0.4550137519836426
Epoch: 6, Steps: 3 | Train Loss: 1.322 Vali Loss: 1.404 Vali Acc: 0.350 Test Loss: 1.404 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 7 cost time: 0.48827672004699707
Epoch: 7, Steps: 3 | Train Loss: 1.294 Vali Loss: 1.393 Vali Acc: 0.350 Test Loss: 1.393 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 8 cost time: 0.4251549243927002
Epoch: 8, Steps: 3 | Train Loss: 1.270 Vali Loss: 1.381 Vali Acc: 0.375 Test Loss: 1.381 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374986).  Saving model ...
Epoch: 9 cost time: 0.4315211772918701
Epoch: 9, Steps: 3 | Train Loss: 1.246 Vali Loss: 1.368 Vali Acc: 0.400 Test Loss: 1.368 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399986).  Saving model ...
Epoch: 10 cost time: 0.5006918907165527
Epoch: 10, Steps: 3 | Train Loss: 1.208 Vali Loss: 1.354 Vali Acc: 0.425 Test Loss: 1.354 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424986).  Saving model ...
Epoch: 11 cost time: 0.5134902000427246
Epoch: 11, Steps: 3 | Train Loss: 1.193 Vali Loss: 1.340 Vali Acc: 0.475 Test Loss: 1.340 Test Acc: 0.475
Validation loss decreased (-0.424986 --> -0.474987).  Saving model ...
Epoch: 12 cost time: 0.5690665245056152
Epoch: 12, Steps: 3 | Train Loss: 1.162 Vali Loss: 1.325 Vali Acc: 0.475 Test Loss: 1.325 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 13 cost time: 0.5655794143676758
Epoch: 13, Steps: 3 | Train Loss: 1.108 Vali Loss: 1.310 Vali Acc: 0.500 Test Loss: 1.310 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499987).  Saving model ...
Epoch: 14 cost time: 0.5236849784851074
Epoch: 14, Steps: 3 | Train Loss: 1.094 Vali Loss: 1.294 Vali Acc: 0.500 Test Loss: 1.294 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 15 cost time: 0.51763916015625
Epoch: 15, Steps: 3 | Train Loss: 1.074 Vali Loss: 1.278 Vali Acc: 0.550 Test Loss: 1.278 Test Acc: 0.550
Validation loss decreased (-0.499987 --> -0.549987).  Saving model ...
Epoch: 16 cost time: 0.49764037132263184
Epoch: 16, Steps: 3 | Train Loss: 1.042 Vali Loss: 1.261 Vali Acc: 0.550 Test Loss: 1.261 Test Acc: 0.550
Validation loss decreased (-0.549987 --> -0.549987).  Saving model ...
Epoch: 17 cost time: 0.4679884910583496
Epoch: 17, Steps: 3 | Train Loss: 0.992 Vali Loss: 1.244 Vali Acc: 0.550 Test Loss: 1.244 Test Acc: 0.550
Validation loss decreased (-0.549987 --> -0.549988).  Saving model ...
Epoch: 18 cost time: 0.4894256591796875
Epoch: 18, Steps: 3 | Train Loss: 0.976 Vali Loss: 1.226 Vali Acc: 0.550 Test Loss: 1.226 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 19 cost time: 0.52988600730896
Epoch: 19, Steps: 3 | Train Loss: 0.974 Vali Loss: 1.208 Vali Acc: 0.575 Test Loss: 1.208 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 20 cost time: 0.4260368347167969
Epoch: 20, Steps: 3 | Train Loss: 0.959 Vali Loss: 1.192 Vali Acc: 0.575 Test Loss: 1.192 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 21 cost time: 0.5215175151824951
Epoch: 21, Steps: 3 | Train Loss: 0.868 Vali Loss: 1.174 Vali Acc: 0.575 Test Loss: 1.174 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 22 cost time: 0.41526055335998535
Epoch: 22, Steps: 3 | Train Loss: 0.849 Vali Loss: 1.156 Vali Acc: 0.625 Test Loss: 1.156 Test Acc: 0.625
Validation loss decreased (-0.574988 --> -0.624988).  Saving model ...
Epoch: 23 cost time: 0.5040936470031738
Epoch: 23, Steps: 3 | Train Loss: 0.847 Vali Loss: 1.139 Vali Acc: 0.625 Test Loss: 1.139 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624989).  Saving model ...
Epoch: 24 cost time: 0.4780111312866211
Epoch: 24, Steps: 3 | Train Loss: 0.810 Vali Loss: 1.122 Vali Acc: 0.625 Test Loss: 1.122 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 25 cost time: 0.6599681377410889
Epoch: 25, Steps: 3 | Train Loss: 0.786 Vali Loss: 1.105 Vali Acc: 0.625 Test Loss: 1.105 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 26 cost time: 0.5905947685241699
Epoch: 26, Steps: 3 | Train Loss: 0.749 Vali Loss: 1.088 Vali Acc: 0.625 Test Loss: 1.088 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 27 cost time: 0.45451807975769043
Epoch: 27, Steps: 3 | Train Loss: 0.741 Vali Loss: 1.072 Vali Acc: 0.675 Test Loss: 1.072 Test Acc: 0.675
Validation loss decreased (-0.624989 --> -0.674989).  Saving model ...
Epoch: 28 cost time: 0.5481820106506348
Epoch: 28, Steps: 3 | Train Loss: 0.714 Vali Loss: 1.055 Vali Acc: 0.675 Test Loss: 1.055 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 29 cost time: 0.5637750625610352
Epoch: 29, Steps: 3 | Train Loss: 0.676 Vali Loss: 1.040 Vali Acc: 0.675 Test Loss: 1.040 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674990).  Saving model ...
Epoch: 30 cost time: 0.6120493412017822
Epoch: 30, Steps: 3 | Train Loss: 0.625 Vali Loss: 1.025 Vali Acc: 0.675 Test Loss: 1.025 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 31 cost time: 0.6254737377166748
Epoch: 31, Steps: 3 | Train Loss: 0.659 Vali Loss: 1.011 Vali Acc: 0.700 Test Loss: 1.011 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 32 cost time: 0.3948960304260254
Epoch: 32, Steps: 3 | Train Loss: 0.625 Vali Loss: 0.996 Vali Acc: 0.700 Test Loss: 0.996 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 33 cost time: 0.5069863796234131
Epoch: 33, Steps: 3 | Train Loss: 0.590 Vali Loss: 0.982 Vali Acc: 0.725 Test Loss: 0.982 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724990).  Saving model ...
Epoch: 34 cost time: 0.6024787425994873
Epoch: 34, Steps: 3 | Train Loss: 0.553 Vali Loss: 0.969 Vali Acc: 0.750 Test Loss: 0.969 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749990).  Saving model ...
Epoch: 35 cost time: 0.45606279373168945
Epoch: 35, Steps: 3 | Train Loss: 0.561 Vali Loss: 0.955 Vali Acc: 0.750 Test Loss: 0.955 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 36 cost time: 0.520352840423584
Epoch: 36, Steps: 3 | Train Loss: 0.520 Vali Loss: 0.942 Vali Acc: 0.750 Test Loss: 0.942 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749991).  Saving model ...
Epoch: 37 cost time: 0.5321028232574463
Epoch: 37, Steps: 3 | Train Loss: 0.508 Vali Loss: 0.929 Vali Acc: 0.750 Test Loss: 0.929 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 38 cost time: 0.6100692749023438
Epoch: 38, Steps: 3 | Train Loss: 0.485 Vali Loss: 0.917 Vali Acc: 0.775 Test Loss: 0.917 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774991).  Saving model ...
Epoch: 39 cost time: 0.5056674480438232
Epoch: 39, Steps: 3 | Train Loss: 0.490 Vali Loss: 0.905 Vali Acc: 0.775 Test Loss: 0.905 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 40 cost time: 0.5735538005828857
Epoch: 40, Steps: 3 | Train Loss: 0.450 Vali Loss: 0.894 Vali Acc: 0.775 Test Loss: 0.894 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 41 cost time: 0.5820455551147461
Epoch: 41, Steps: 3 | Train Loss: 0.452 Vali Loss: 0.882 Vali Acc: 0.775 Test Loss: 0.882 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 42 cost time: 0.5895392894744873
Epoch: 42, Steps: 3 | Train Loss: 0.459 Vali Loss: 0.871 Vali Acc: 0.800 Test Loss: 0.871 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799991).  Saving model ...
Epoch: 43 cost time: 0.6061992645263672
Epoch: 43, Steps: 3 | Train Loss: 0.400 Vali Loss: 0.861 Vali Acc: 0.800 Test Loss: 0.861 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 44 cost time: 0.5514957904815674
Epoch: 44, Steps: 3 | Train Loss: 0.408 Vali Loss: 0.852 Vali Acc: 0.800 Test Loss: 0.852 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 45 cost time: 0.46686482429504395
Epoch: 45, Steps: 3 | Train Loss: 0.409 Vali Loss: 0.843 Vali Acc: 0.800 Test Loss: 0.843 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799992).  Saving model ...
Epoch: 46 cost time: 0.560638427734375
Epoch: 46, Steps: 3 | Train Loss: 0.391 Vali Loss: 0.834 Vali Acc: 0.800 Test Loss: 0.834 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 47 cost time: 0.5896773338317871
Epoch: 47, Steps: 3 | Train Loss: 0.379 Vali Loss: 0.827 Vali Acc: 0.800 Test Loss: 0.827 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 48 cost time: 0.5699117183685303
Epoch: 48, Steps: 3 | Train Loss: 0.358 Vali Loss: 0.820 Vali Acc: 0.800 Test Loss: 0.820 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 49 cost time: 0.5724070072174072
Epoch: 49, Steps: 3 | Train Loss: 0.331 Vali Loss: 0.814 Vali Acc: 0.800 Test Loss: 0.814 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 50 cost time: 0.6083176136016846
Epoch: 50, Steps: 3 | Train Loss: 0.321 Vali Loss: 0.807 Vali Acc: 0.800 Test Loss: 0.807 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 51 cost time: 0.6199018955230713
Epoch: 51, Steps: 3 | Train Loss: 0.311 Vali Loss: 0.802 Vali Acc: 0.800 Test Loss: 0.802 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 52 cost time: 0.5859036445617676
Epoch: 52, Steps: 3 | Train Loss: 0.303 Vali Loss: 0.797 Vali Acc: 0.800 Test Loss: 0.797 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 53 cost time: 0.6748385429382324
Epoch: 53, Steps: 3 | Train Loss: 0.292 Vali Loss: 0.792 Vali Acc: 0.800 Test Loss: 0.792 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 54 cost time: 0.7042520046234131
Epoch: 54, Steps: 3 | Train Loss: 0.290 Vali Loss: 0.787 Vali Acc: 0.800 Test Loss: 0.787 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 55 cost time: 0.6075623035430908
Epoch: 55, Steps: 3 | Train Loss: 0.274 Vali Loss: 0.783 Vali Acc: 0.800 Test Loss: 0.783 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 56 cost time: 0.6442346572875977
Epoch: 56, Steps: 3 | Train Loss: 0.273 Vali Loss: 0.777 Vali Acc: 0.800 Test Loss: 0.777 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 57 cost time: 0.6293697357177734
Epoch: 57, Steps: 3 | Train Loss: 0.277 Vali Loss: 0.773 Vali Acc: 0.800 Test Loss: 0.773 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 58 cost time: 0.6347763538360596
Epoch: 58, Steps: 3 | Train Loss: 0.251 Vali Loss: 0.768 Vali Acc: 0.800 Test Loss: 0.768 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 59 cost time: 0.6070702075958252
Epoch: 59, Steps: 3 | Train Loss: 0.237 Vali Loss: 0.764 Vali Acc: 0.825 Test Loss: 0.764 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824992).  Saving model ...
Epoch: 60 cost time: 0.5806827545166016
Epoch: 60, Steps: 3 | Train Loss: 0.228 Vali Loss: 0.758 Vali Acc: 0.825 Test Loss: 0.758 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 61 cost time: 0.5243103504180908
Epoch: 61, Steps: 3 | Train Loss: 0.229 Vali Loss: 0.753 Vali Acc: 0.825 Test Loss: 0.753 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 62 cost time: 0.6154742240905762
Epoch: 62, Steps: 3 | Train Loss: 0.235 Vali Loss: 0.748 Vali Acc: 0.825 Test Loss: 0.748 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824993).  Saving model ...
Epoch: 63 cost time: 0.46243834495544434
Epoch: 63, Steps: 3 | Train Loss: 0.203 Vali Loss: 0.744 Vali Acc: 0.825 Test Loss: 0.744 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 64 cost time: 0.6488978862762451
Epoch: 64, Steps: 3 | Train Loss: 0.221 Vali Loss: 0.739 Vali Acc: 0.825 Test Loss: 0.739 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 65 cost time: 0.6416146755218506
Epoch: 65, Steps: 3 | Train Loss: 0.212 Vali Loss: 0.733 Vali Acc: 0.825 Test Loss: 0.733 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 66 cost time: 0.5817978382110596
Epoch: 66, Steps: 3 | Train Loss: 0.214 Vali Loss: 0.728 Vali Acc: 0.825 Test Loss: 0.728 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 67 cost time: 0.722557783126831
Epoch: 67, Steps: 3 | Train Loss: 0.197 Vali Loss: 0.724 Vali Acc: 0.825 Test Loss: 0.724 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 68 cost time: 0.5010857582092285
Epoch: 68, Steps: 3 | Train Loss: 0.180 Vali Loss: 0.718 Vali Acc: 0.825 Test Loss: 0.718 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 69 cost time: 0.5752463340759277
Epoch: 69, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.712 Vali Acc: 0.825 Test Loss: 0.712 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 70 cost time: 0.6081528663635254
Epoch: 70, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.707 Vali Acc: 0.850 Test Loss: 0.707 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849993).  Saving model ...
Epoch: 71 cost time: 0.5466749668121338
Epoch: 71, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.706 Vali Acc: 0.850 Test Loss: 0.706 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 72 cost time: 0.6149966716766357
Epoch: 72, Steps: 3 | Train Loss: 0.128 Vali Loss: 0.707 Vali Acc: 0.850 Test Loss: 0.707 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 0.7529957294464111
Epoch: 73, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.715 Vali Acc: 0.850 Test Loss: 0.715 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 0.7505455017089844
Epoch: 74, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.724 Vali Acc: 0.850 Test Loss: 0.724 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 0.760246992111206
Epoch: 75, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.733 Vali Acc: 0.850 Test Loss: 0.733 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 76 cost time: 0.6054041385650635
Epoch: 76, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.741 Vali Acc: 0.850 Test Loss: 0.741 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 77 cost time: 0.7082743644714355
Epoch: 77, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.750 Vali Acc: 0.850 Test Loss: 0.750 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 78 cost time: 0.5865426063537598
Epoch: 78, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.765 Vali Acc: 0.850 Test Loss: 0.765 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 79 cost time: 0.5417029857635498
Epoch: 79, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.778 Vali Acc: 0.825 Test Loss: 0.778 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 80 cost time: 0.5551767349243164
Epoch: 80, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.791 Vali Acc: 0.825 Test Loss: 0.791 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 81 cost time: 0.687647819519043
Epoch: 81, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.804 Vali Acc: 0.825 Test Loss: 0.804 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm128_cs9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.85
model parameter : 22328
model size : 0.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm128_cs8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.663416862487793
Epoch: 1, Steps: 3 | Train Loss: 1.372 Vali Loss: 1.317 Vali Acc: 0.225 Test Loss: 1.317 Test Acc: 0.225
Validation loss decreased (inf --> -0.224987).  Saving model ...
Epoch: 2 cost time: 0.5262241363525391
Epoch: 2, Steps: 3 | Train Loss: 1.342 Vali Loss: 1.310 Vali Acc: 0.225 Test Loss: 1.310 Test Acc: 0.225
Validation loss decreased (-0.224987 --> -0.224987).  Saving model ...
Epoch: 3 cost time: 0.5530178546905518
Epoch: 3, Steps: 3 | Train Loss: 1.341 Vali Loss: 1.304 Vali Acc: 0.225 Test Loss: 1.304 Test Acc: 0.225
Validation loss decreased (-0.224987 --> -0.224987).  Saving model ...
Epoch: 4 cost time: 0.6025865077972412
Epoch: 4, Steps: 3 | Train Loss: 1.321 Vali Loss: 1.296 Vali Acc: 0.300 Test Loss: 1.296 Test Acc: 0.300
Validation loss decreased (-0.224987 --> -0.299987).  Saving model ...
Epoch: 5 cost time: 0.5131919384002686
Epoch: 5, Steps: 3 | Train Loss: 1.295 Vali Loss: 1.285 Vali Acc: 0.350 Test Loss: 1.285 Test Acc: 0.350
Validation loss decreased (-0.299987 --> -0.349987).  Saving model ...
Epoch: 6 cost time: 0.5255813598632812
Epoch: 6, Steps: 3 | Train Loss: 1.268 Vali Loss: 1.273 Vali Acc: 0.350 Test Loss: 1.273 Test Acc: 0.350
Validation loss decreased (-0.349987 --> -0.349987).  Saving model ...
Epoch: 7 cost time: 0.49167442321777344
Epoch: 7, Steps: 3 | Train Loss: 1.245 Vali Loss: 1.260 Vali Acc: 0.350 Test Loss: 1.260 Test Acc: 0.350
Validation loss decreased (-0.349987 --> -0.349987).  Saving model ...
Epoch: 8 cost time: 0.588620662689209
Epoch: 8, Steps: 3 | Train Loss: 1.205 Vali Loss: 1.246 Vali Acc: 0.375 Test Loss: 1.246 Test Acc: 0.375
Validation loss decreased (-0.349987 --> -0.374988).  Saving model ...
Epoch: 9 cost time: 0.5254547595977783
Epoch: 9, Steps: 3 | Train Loss: 1.185 Vali Loss: 1.231 Vali Acc: 0.375 Test Loss: 1.231 Test Acc: 0.375
Validation loss decreased (-0.374988 --> -0.374988).  Saving model ...
Epoch: 10 cost time: 0.4624366760253906
Epoch: 10, Steps: 3 | Train Loss: 1.181 Vali Loss: 1.216 Vali Acc: 0.450 Test Loss: 1.216 Test Acc: 0.450
Validation loss decreased (-0.374988 --> -0.449988).  Saving model ...
Epoch: 11 cost time: 0.553520917892456
Epoch: 11, Steps: 3 | Train Loss: 1.141 Vali Loss: 1.199 Vali Acc: 0.475 Test Loss: 1.199 Test Acc: 0.475
Validation loss decreased (-0.449988 --> -0.474988).  Saving model ...
Epoch: 12 cost time: 0.5468258857727051
Epoch: 12, Steps: 3 | Train Loss: 1.083 Vali Loss: 1.182 Vali Acc: 0.475 Test Loss: 1.182 Test Acc: 0.475
Validation loss decreased (-0.474988 --> -0.474988).  Saving model ...
Epoch: 13 cost time: 0.48222899436950684
Epoch: 13, Steps: 3 | Train Loss: 1.064 Vali Loss: 1.165 Vali Acc: 0.525 Test Loss: 1.165 Test Acc: 0.525
Validation loss decreased (-0.474988 --> -0.524988).  Saving model ...
Epoch: 14 cost time: 0.5982248783111572
Epoch: 14, Steps: 3 | Train Loss: 1.074 Vali Loss: 1.147 Vali Acc: 0.525 Test Loss: 1.147 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524989).  Saving model ...
Epoch: 15 cost time: 0.525691032409668
Epoch: 15, Steps: 3 | Train Loss: 1.019 Vali Loss: 1.127 Vali Acc: 0.525 Test Loss: 1.127 Test Acc: 0.525
Validation loss decreased (-0.524989 --> -0.524989).  Saving model ...
Epoch: 16 cost time: 0.48619961738586426
Epoch: 16, Steps: 3 | Train Loss: 0.997 Vali Loss: 1.108 Vali Acc: 0.575 Test Loss: 1.108 Test Acc: 0.575
Validation loss decreased (-0.524989 --> -0.574989).  Saving model ...
Epoch: 17 cost time: 0.5085873603820801
Epoch: 17, Steps: 3 | Train Loss: 0.934 Vali Loss: 1.088 Vali Acc: 0.575 Test Loss: 1.088 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 18 cost time: 0.5425570011138916
Epoch: 18, Steps: 3 | Train Loss: 0.928 Vali Loss: 1.068 Vali Acc: 0.550 Test Loss: 1.068 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.524632453918457
Epoch: 19, Steps: 3 | Train Loss: 0.911 Vali Loss: 1.048 Vali Acc: 0.575 Test Loss: 1.048 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574990).  Saving model ...
Epoch: 20 cost time: 0.5161945819854736
Epoch: 20, Steps: 3 | Train Loss: 0.843 Vali Loss: 1.027 Vali Acc: 0.600 Test Loss: 1.027 Test Acc: 0.600
Validation loss decreased (-0.574990 --> -0.599990).  Saving model ...
Epoch: 21 cost time: 0.4588356018066406
Epoch: 21, Steps: 3 | Train Loss: 0.809 Vali Loss: 1.006 Vali Acc: 0.625 Test Loss: 1.006 Test Acc: 0.625
Validation loss decreased (-0.599990 --> -0.624990).  Saving model ...
Epoch: 22 cost time: 0.4577212333679199
Epoch: 22, Steps: 3 | Train Loss: 0.833 Vali Loss: 0.984 Vali Acc: 0.700 Test Loss: 0.984 Test Acc: 0.700
Validation loss decreased (-0.624990 --> -0.699990).  Saving model ...
Epoch: 23 cost time: 0.541982889175415
Epoch: 23, Steps: 3 | Train Loss: 0.792 Vali Loss: 0.962 Vali Acc: 0.700 Test Loss: 0.962 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 24 cost time: 0.5840837955474854
Epoch: 24, Steps: 3 | Train Loss: 0.760 Vali Loss: 0.940 Vali Acc: 0.700 Test Loss: 0.940 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699991).  Saving model ...
Epoch: 25 cost time: 0.5997183322906494
Epoch: 25, Steps: 3 | Train Loss: 0.736 Vali Loss: 0.917 Vali Acc: 0.775 Test Loss: 0.917 Test Acc: 0.775
Validation loss decreased (-0.699991 --> -0.774991).  Saving model ...
Epoch: 26 cost time: 0.47983503341674805
Epoch: 26, Steps: 3 | Train Loss: 0.706 Vali Loss: 0.894 Vali Acc: 0.750 Test Loss: 0.894 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5353753566741943
Epoch: 27, Steps: 3 | Train Loss: 0.625 Vali Loss: 0.870 Vali Acc: 0.775 Test Loss: 0.870 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 28 cost time: 0.5976588726043701
Epoch: 28, Steps: 3 | Train Loss: 0.631 Vali Loss: 0.848 Vali Acc: 0.775 Test Loss: 0.848 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774992).  Saving model ...
Epoch: 29 cost time: 0.5108826160430908
Epoch: 29, Steps: 3 | Train Loss: 0.591 Vali Loss: 0.824 Vali Acc: 0.775 Test Loss: 0.824 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 30 cost time: 0.536447286605835
Epoch: 30, Steps: 3 | Train Loss: 0.604 Vali Loss: 0.798 Vali Acc: 0.800 Test Loss: 0.798 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799992).  Saving model ...
Epoch: 31 cost time: 0.45558905601501465
Epoch: 31, Steps: 3 | Train Loss: 0.581 Vali Loss: 0.773 Vali Acc: 0.800 Test Loss: 0.773 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 32 cost time: 0.4620625972747803
Epoch: 32, Steps: 3 | Train Loss: 0.543 Vali Loss: 0.747 Vali Acc: 0.800 Test Loss: 0.747 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799993).  Saving model ...
Epoch: 33 cost time: 0.576127290725708
Epoch: 33, Steps: 3 | Train Loss: 0.539 Vali Loss: 0.720 Vali Acc: 0.800 Test Loss: 0.720 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 34 cost time: 0.4492521286010742
Epoch: 34, Steps: 3 | Train Loss: 0.516 Vali Loss: 0.694 Vali Acc: 0.825 Test Loss: 0.694 Test Acc: 0.825
Validation loss decreased (-0.799993 --> -0.824993).  Saving model ...
Epoch: 35 cost time: 0.46207308769226074
Epoch: 35, Steps: 3 | Train Loss: 0.472 Vali Loss: 0.667 Vali Acc: 0.850 Test Loss: 0.667 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849993).  Saving model ...
Epoch: 36 cost time: 0.6367170810699463
Epoch: 36, Steps: 3 | Train Loss: 0.479 Vali Loss: 0.639 Vali Acc: 0.875 Test Loss: 0.639 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874994).  Saving model ...
Epoch: 37 cost time: 0.6058187484741211
Epoch: 37, Steps: 3 | Train Loss: 0.423 Vali Loss: 0.613 Vali Acc: 0.875 Test Loss: 0.613 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 38 cost time: 0.44315409660339355
Epoch: 38, Steps: 3 | Train Loss: 0.411 Vali Loss: 0.583 Vali Acc: 0.875 Test Loss: 0.583 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 39 cost time: 0.49846625328063965
Epoch: 39, Steps: 3 | Train Loss: 0.410 Vali Loss: 0.552 Vali Acc: 0.875 Test Loss: 0.552 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 40 cost time: 0.47097110748291016
Epoch: 40, Steps: 3 | Train Loss: 0.428 Vali Loss: 0.518 Vali Acc: 0.900 Test Loss: 0.518 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899995).  Saving model ...
Epoch: 41 cost time: 0.5092301368713379
Epoch: 41, Steps: 3 | Train Loss: 0.335 Vali Loss: 0.483 Vali Acc: 0.925 Test Loss: 0.483 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924995).  Saving model ...
Epoch: 42 cost time: 0.4982473850250244
Epoch: 42, Steps: 3 | Train Loss: 0.367 Vali Loss: 0.450 Vali Acc: 0.950 Test Loss: 0.450 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949996).  Saving model ...
Epoch: 43 cost time: 0.46515798568725586
Epoch: 43, Steps: 3 | Train Loss: 0.318 Vali Loss: 0.418 Vali Acc: 0.950 Test Loss: 0.418 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 44 cost time: 0.5287613868713379
Epoch: 44, Steps: 3 | Train Loss: 0.320 Vali Loss: 0.387 Vali Acc: 0.950 Test Loss: 0.387 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 45 cost time: 0.5671794414520264
Epoch: 45, Steps: 3 | Train Loss: 0.292 Vali Loss: 0.358 Vali Acc: 0.975 Test Loss: 0.358 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974996).  Saving model ...
Epoch: 46 cost time: 0.5745861530303955
Epoch: 46, Steps: 3 | Train Loss: 0.270 Vali Loss: 0.330 Vali Acc: 0.975 Test Loss: 0.330 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 47 cost time: 0.5055971145629883
Epoch: 47, Steps: 3 | Train Loss: 0.271 Vali Loss: 0.302 Vali Acc: 0.975 Test Loss: 0.302 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 48 cost time: 0.45192646980285645
Epoch: 48, Steps: 3 | Train Loss: 0.226 Vali Loss: 0.276 Vali Acc: 0.975 Test Loss: 0.276 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 49 cost time: 0.4573485851287842
Epoch: 49, Steps: 3 | Train Loss: 0.233 Vali Loss: 0.250 Vali Acc: 0.975 Test Loss: 0.250 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 50 cost time: 0.48497986793518066
Epoch: 50, Steps: 3 | Train Loss: 0.202 Vali Loss: 0.224 Vali Acc: 0.975 Test Loss: 0.224 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 51 cost time: 0.5300192832946777
Epoch: 51, Steps: 3 | Train Loss: 0.210 Vali Loss: 0.197 Vali Acc: 0.975 Test Loss: 0.197 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 52 cost time: 0.4703361988067627
Epoch: 52, Steps: 3 | Train Loss: 0.162 Vali Loss: 0.174 Vali Acc: 1.000 Test Loss: 0.174 Test Acc: 1.000
Validation loss decreased (-0.974998 --> -0.999998).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm128_cs8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 21918
model size : 0.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm128_cs7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.771493911743164
Epoch: 1, Steps: 3 | Train Loss: 1.334 Vali Loss: 1.370 Vali Acc: 0.425 Test Loss: 1.370 Test Acc: 0.425
Validation loss decreased (inf --> -0.424986).  Saving model ...
Epoch: 2 cost time: 0.4791402816772461
Epoch: 2, Steps: 3 | Train Loss: 1.318 Vali Loss: 1.366 Vali Acc: 0.425 Test Loss: 1.366 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424986).  Saving model ...
Epoch: 3 cost time: 0.535362958908081
Epoch: 3, Steps: 3 | Train Loss: 1.298 Vali Loss: 1.360 Vali Acc: 0.425 Test Loss: 1.360 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424986).  Saving model ...
Epoch: 4 cost time: 0.4859743118286133
Epoch: 4, Steps: 3 | Train Loss: 1.321 Vali Loss: 1.352 Vali Acc: 0.425 Test Loss: 1.352 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424986).  Saving model ...
Epoch: 5 cost time: 0.5418734550476074
Epoch: 5, Steps: 3 | Train Loss: 1.267 Vali Loss: 1.343 Vali Acc: 0.425 Test Loss: 1.343 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424987).  Saving model ...
Epoch: 6 cost time: 0.43251490592956543
Epoch: 6, Steps: 3 | Train Loss: 1.241 Vali Loss: 1.333 Vali Acc: 0.425 Test Loss: 1.333 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 7 cost time: 0.48667454719543457
Epoch: 7, Steps: 3 | Train Loss: 1.199 Vali Loss: 1.322 Vali Acc: 0.425 Test Loss: 1.322 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 8 cost time: 0.4007606506347656
Epoch: 8, Steps: 3 | Train Loss: 1.194 Vali Loss: 1.309 Vali Acc: 0.450 Test Loss: 1.309 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449987).  Saving model ...
Epoch: 9 cost time: 0.40544795989990234
Epoch: 9, Steps: 3 | Train Loss: 1.179 Vali Loss: 1.296 Vali Acc: 0.500 Test Loss: 1.296 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499987).  Saving model ...
Epoch: 10 cost time: 0.45520544052124023
Epoch: 10, Steps: 3 | Train Loss: 1.156 Vali Loss: 1.283 Vali Acc: 0.500 Test Loss: 1.283 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 11 cost time: 0.443356990814209
Epoch: 11, Steps: 3 | Train Loss: 1.098 Vali Loss: 1.269 Vali Acc: 0.500 Test Loss: 1.269 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 12 cost time: 0.3719027042388916
Epoch: 12, Steps: 3 | Train Loss: 1.086 Vali Loss: 1.254 Vali Acc: 0.500 Test Loss: 1.254 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 13 cost time: 0.5145096778869629
Epoch: 13, Steps: 3 | Train Loss: 1.067 Vali Loss: 1.239 Vali Acc: 0.500 Test Loss: 1.239 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499988).  Saving model ...
Epoch: 14 cost time: 0.4390699863433838
Epoch: 14, Steps: 3 | Train Loss: 1.024 Vali Loss: 1.224 Vali Acc: 0.525 Test Loss: 1.224 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 15 cost time: 0.47818970680236816
Epoch: 15, Steps: 3 | Train Loss: 1.022 Vali Loss: 1.208 Vali Acc: 0.525 Test Loss: 1.208 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 16 cost time: 0.5695633888244629
Epoch: 16, Steps: 3 | Train Loss: 0.971 Vali Loss: 1.192 Vali Acc: 0.525 Test Loss: 1.192 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 17 cost time: 0.50913405418396
Epoch: 17, Steps: 3 | Train Loss: 0.945 Vali Loss: 1.177 Vali Acc: 0.525 Test Loss: 1.177 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 18 cost time: 0.48508143424987793
Epoch: 18, Steps: 3 | Train Loss: 0.904 Vali Loss: 1.159 Vali Acc: 0.525 Test Loss: 1.159 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 19 cost time: 0.3950517177581787
Epoch: 19, Steps: 3 | Train Loss: 0.921 Vali Loss: 1.142 Vali Acc: 0.525 Test Loss: 1.142 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524989).  Saving model ...
Epoch: 20 cost time: 0.5575432777404785
Epoch: 20, Steps: 3 | Train Loss: 0.879 Vali Loss: 1.125 Vali Acc: 0.575 Test Loss: 1.125 Test Acc: 0.575
Validation loss decreased (-0.524989 --> -0.574989).  Saving model ...
Epoch: 21 cost time: 0.5464684963226318
Epoch: 21, Steps: 3 | Train Loss: 0.820 Vali Loss: 1.105 Vali Acc: 0.600 Test Loss: 1.105 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599989).  Saving model ...
Epoch: 22 cost time: 0.4974400997161865
Epoch: 22, Steps: 3 | Train Loss: 0.795 Vali Loss: 1.087 Vali Acc: 0.625 Test Loss: 1.087 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 23 cost time: 0.44811487197875977
Epoch: 23, Steps: 3 | Train Loss: 0.801 Vali Loss: 1.070 Vali Acc: 0.650 Test Loss: 1.070 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 24 cost time: 0.4360158443450928
Epoch: 24, Steps: 3 | Train Loss: 0.726 Vali Loss: 1.053 Vali Acc: 0.650 Test Loss: 1.053 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 25 cost time: 0.502063512802124
Epoch: 25, Steps: 3 | Train Loss: 0.717 Vali Loss: 1.036 Vali Acc: 0.650 Test Loss: 1.036 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649990).  Saving model ...
Epoch: 26 cost time: 0.4718618392944336
Epoch: 26, Steps: 3 | Train Loss: 0.737 Vali Loss: 1.020 Vali Acc: 0.675 Test Loss: 1.020 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674990).  Saving model ...
Epoch: 27 cost time: 0.5869438648223877
Epoch: 27, Steps: 3 | Train Loss: 0.667 Vali Loss: 1.004 Vali Acc: 0.675 Test Loss: 1.004 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 28 cost time: 0.4535095691680908
Epoch: 28, Steps: 3 | Train Loss: 0.627 Vali Loss: 0.986 Vali Acc: 0.675 Test Loss: 0.986 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 29 cost time: 0.45972704887390137
Epoch: 29, Steps: 3 | Train Loss: 0.658 Vali Loss: 0.968 Vali Acc: 0.675 Test Loss: 0.968 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 30 cost time: 0.4962143898010254
Epoch: 30, Steps: 3 | Train Loss: 0.618 Vali Loss: 0.949 Vali Acc: 0.725 Test Loss: 0.949 Test Acc: 0.725
Validation loss decreased (-0.674990 --> -0.724991).  Saving model ...
Epoch: 31 cost time: 0.540245532989502
Epoch: 31, Steps: 3 | Train Loss: 0.587 Vali Loss: 0.932 Vali Acc: 0.725 Test Loss: 0.932 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 32 cost time: 0.46577024459838867
Epoch: 32, Steps: 3 | Train Loss: 0.557 Vali Loss: 0.913 Vali Acc: 0.725 Test Loss: 0.913 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 33 cost time: 0.4759194850921631
Epoch: 33, Steps: 3 | Train Loss: 0.552 Vali Loss: 0.894 Vali Acc: 0.725 Test Loss: 0.894 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 34 cost time: 0.4322032928466797
Epoch: 34, Steps: 3 | Train Loss: 0.515 Vali Loss: 0.876 Vali Acc: 0.750 Test Loss: 0.876 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749991).  Saving model ...
Epoch: 35 cost time: 0.4653465747833252
Epoch: 35, Steps: 3 | Train Loss: 0.526 Vali Loss: 0.857 Vali Acc: 0.750 Test Loss: 0.857 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 36 cost time: 0.5040767192840576
Epoch: 36, Steps: 3 | Train Loss: 0.480 Vali Loss: 0.838 Vali Acc: 0.750 Test Loss: 0.838 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 37 cost time: 0.43207406997680664
Epoch: 37, Steps: 3 | Train Loss: 0.452 Vali Loss: 0.819 Vali Acc: 0.750 Test Loss: 0.819 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 38 cost time: 0.489346981048584
Epoch: 38, Steps: 3 | Train Loss: 0.441 Vali Loss: 0.799 Vali Acc: 0.750 Test Loss: 0.799 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 39 cost time: 0.45554089546203613
Epoch: 39, Steps: 3 | Train Loss: 0.418 Vali Loss: 0.778 Vali Acc: 0.775 Test Loss: 0.778 Test Acc: 0.775
Validation loss decreased (-0.749992 --> -0.774992).  Saving model ...
Epoch: 40 cost time: 0.44179773330688477
Epoch: 40, Steps: 3 | Train Loss: 0.398 Vali Loss: 0.756 Vali Acc: 0.775 Test Loss: 0.756 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 41 cost time: 0.45574235916137695
Epoch: 41, Steps: 3 | Train Loss: 0.387 Vali Loss: 0.732 Vali Acc: 0.775 Test Loss: 0.732 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774993).  Saving model ...
Epoch: 42 cost time: 0.5762877464294434
Epoch: 42, Steps: 3 | Train Loss: 0.414 Vali Loss: 0.708 Vali Acc: 0.775 Test Loss: 0.708 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 43 cost time: 0.49955320358276367
Epoch: 43, Steps: 3 | Train Loss: 0.337 Vali Loss: 0.684 Vali Acc: 0.800 Test Loss: 0.684 Test Acc: 0.800
Validation loss decreased (-0.774993 --> -0.799993).  Saving model ...
Epoch: 44 cost time: 0.5363807678222656
Epoch: 44, Steps: 3 | Train Loss: 0.329 Vali Loss: 0.659 Vali Acc: 0.800 Test Loss: 0.659 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 45 cost time: 0.47495508193969727
Epoch: 45, Steps: 3 | Train Loss: 0.302 Vali Loss: 0.631 Vali Acc: 0.800 Test Loss: 0.631 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799994).  Saving model ...
Epoch: 46 cost time: 0.4421651363372803
Epoch: 46, Steps: 3 | Train Loss: 0.329 Vali Loss: 0.603 Vali Acc: 0.825 Test Loss: 0.603 Test Acc: 0.825
Validation loss decreased (-0.799994 --> -0.824994).  Saving model ...
Epoch: 47 cost time: 0.5003066062927246
Epoch: 47, Steps: 3 | Train Loss: 0.270 Vali Loss: 0.573 Vali Acc: 0.825 Test Loss: 0.573 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 48 cost time: 0.41738295555114746
Epoch: 48, Steps: 3 | Train Loss: 0.271 Vali Loss: 0.544 Vali Acc: 0.850 Test Loss: 0.544 Test Acc: 0.850
Validation loss decreased (-0.824994 --> -0.849995).  Saving model ...
Epoch: 49 cost time: 0.5314512252807617
Epoch: 49, Steps: 3 | Train Loss: 0.267 Vali Loss: 0.516 Vali Acc: 0.850 Test Loss: 0.516 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 50 cost time: 0.4398837089538574
Epoch: 50, Steps: 3 | Train Loss: 0.256 Vali Loss: 0.483 Vali Acc: 0.850 Test Loss: 0.483 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 51 cost time: 0.3732943534851074
Epoch: 51, Steps: 3 | Train Loss: 0.222 Vali Loss: 0.452 Vali Acc: 0.900 Test Loss: 0.452 Test Acc: 0.900
Validation loss decreased (-0.849995 --> -0.899995).  Saving model ...
Epoch: 52 cost time: 0.47712135314941406
Epoch: 52, Steps: 3 | Train Loss: 0.240 Vali Loss: 0.420 Vali Acc: 0.900 Test Loss: 0.420 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 53 cost time: 0.3908677101135254
Epoch: 53, Steps: 3 | Train Loss: 0.213 Vali Loss: 0.389 Vali Acc: 0.925 Test Loss: 0.389 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 54 cost time: 0.45343017578125
Epoch: 54, Steps: 3 | Train Loss: 0.198 Vali Loss: 0.359 Vali Acc: 0.925 Test Loss: 0.359 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 55 cost time: 0.4124774932861328
Epoch: 55, Steps: 3 | Train Loss: 0.195 Vali Loss: 0.331 Vali Acc: 0.950 Test Loss: 0.331 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949997).  Saving model ...
Epoch: 56 cost time: 0.39862847328186035
Epoch: 56, Steps: 3 | Train Loss: 0.162 Vali Loss: 0.299 Vali Acc: 0.950 Test Loss: 0.299 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 57 cost time: 0.35504603385925293
Epoch: 57, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.270 Vali Acc: 0.950 Test Loss: 0.270 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 58 cost time: 0.4043617248535156
Epoch: 58, Steps: 3 | Train Loss: 0.129 Vali Loss: 0.242 Vali Acc: 0.950 Test Loss: 0.242 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 59 cost time: 0.41294074058532715
Epoch: 59, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.218 Vali Acc: 0.950 Test Loss: 0.218 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 60 cost time: 0.4363706111907959
Epoch: 60, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.191 Vali Acc: 0.950 Test Loss: 0.191 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 61 cost time: 0.4296417236328125
Epoch: 61, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.165 Vali Acc: 0.975 Test Loss: 0.165 Test Acc: 0.975
Validation loss decreased (-0.949998 --> -0.974998).  Saving model ...
Epoch: 62 cost time: 0.46782684326171875
Epoch: 62, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.141 Vali Acc: 0.975 Test Loss: 0.141 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 63 cost time: 0.47770118713378906
Epoch: 63, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.122 Vali Acc: 1.000 Test Loss: 0.122 Test Acc: 1.000
Validation loss decreased (-0.974999 --> -0.999999).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm128_cs7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 22074
model size : 0.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm128_cs6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.600907564163208
Epoch: 1, Steps: 3 | Train Loss: 1.509 Vali Loss: 1.491 Vali Acc: 0.325 Test Loss: 1.491 Test Acc: 0.325
Validation loss decreased (inf --> -0.324985).  Saving model ...
Epoch: 2 cost time: 0.4446995258331299
Epoch: 2, Steps: 3 | Train Loss: 1.484 Vali Loss: 1.484 Vali Acc: 0.325 Test Loss: 1.484 Test Acc: 0.325
Validation loss decreased (-0.324985 --> -0.324985).  Saving model ...
Epoch: 3 cost time: 0.4241487979888916
Epoch: 3, Steps: 3 | Train Loss: 1.447 Vali Loss: 1.479 Vali Acc: 0.325 Test Loss: 1.479 Test Acc: 0.325
Validation loss decreased (-0.324985 --> -0.324985).  Saving model ...
Epoch: 4 cost time: 0.4980607032775879
Epoch: 4, Steps: 3 | Train Loss: 1.437 Vali Loss: 1.472 Vali Acc: 0.325 Test Loss: 1.472 Test Acc: 0.325
Validation loss decreased (-0.324985 --> -0.324985).  Saving model ...
Epoch: 5 cost time: 0.43062567710876465
Epoch: 5, Steps: 3 | Train Loss: 1.425 Vali Loss: 1.464 Vali Acc: 0.350 Test Loss: 1.464 Test Acc: 0.350
Validation loss decreased (-0.324985 --> -0.349985).  Saving model ...
Epoch: 6 cost time: 0.528433084487915
Epoch: 6, Steps: 3 | Train Loss: 1.392 Vali Loss: 1.454 Vali Acc: 0.350 Test Loss: 1.454 Test Acc: 0.350
Validation loss decreased (-0.349985 --> -0.349985).  Saving model ...
Epoch: 7 cost time: 0.46018147468566895
Epoch: 7, Steps: 3 | Train Loss: 1.385 Vali Loss: 1.444 Vali Acc: 0.350 Test Loss: 1.444 Test Acc: 0.350
Validation loss decreased (-0.349985 --> -0.349986).  Saving model ...
Epoch: 8 cost time: 0.4568796157836914
Epoch: 8, Steps: 3 | Train Loss: 1.331 Vali Loss: 1.432 Vali Acc: 0.350 Test Loss: 1.432 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 9 cost time: 0.5620038509368896
Epoch: 9, Steps: 3 | Train Loss: 1.328 Vali Loss: 1.419 Vali Acc: 0.425 Test Loss: 1.419 Test Acc: 0.425
Validation loss decreased (-0.349986 --> -0.424986).  Saving model ...
Epoch: 10 cost time: 0.43419647216796875
Epoch: 10, Steps: 3 | Train Loss: 1.298 Vali Loss: 1.406 Vali Acc: 0.425 Test Loss: 1.406 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424986).  Saving model ...
Epoch: 11 cost time: 0.48044776916503906
Epoch: 11, Steps: 3 | Train Loss: 1.247 Vali Loss: 1.392 Vali Acc: 0.400 Test Loss: 1.392 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.40757083892822266
Epoch: 12, Steps: 3 | Train Loss: 1.208 Vali Loss: 1.377 Vali Acc: 0.450 Test Loss: 1.377 Test Acc: 0.450
Validation loss decreased (-0.424986 --> -0.449986).  Saving model ...
Epoch: 13 cost time: 0.4512629508972168
Epoch: 13, Steps: 3 | Train Loss: 1.188 Vali Loss: 1.362 Vali Acc: 0.425 Test Loss: 1.362 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.45543956756591797
Epoch: 14, Steps: 3 | Train Loss: 1.165 Vali Loss: 1.346 Vali Acc: 0.450 Test Loss: 1.346 Test Acc: 0.450
Validation loss decreased (-0.449986 --> -0.449987).  Saving model ...
Epoch: 15 cost time: 0.4345431327819824
Epoch: 15, Steps: 3 | Train Loss: 1.127 Vali Loss: 1.329 Vali Acc: 0.425 Test Loss: 1.329 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.38165283203125
Epoch: 16, Steps: 3 | Train Loss: 1.109 Vali Loss: 1.312 Vali Acc: 0.400 Test Loss: 1.312 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.40732645988464355
Epoch: 17, Steps: 3 | Train Loss: 1.038 Vali Loss: 1.295 Vali Acc: 0.400 Test Loss: 1.295 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.4695460796356201
Epoch: 18, Steps: 3 | Train Loss: 0.996 Vali Loss: 1.278 Vali Acc: 0.375 Test Loss: 1.278 Test Acc: 0.375
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.5210371017456055
Epoch: 19, Steps: 3 | Train Loss: 1.022 Vali Loss: 1.260 Vali Acc: 0.400 Test Loss: 1.260 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.4531264305114746
Epoch: 20, Steps: 3 | Train Loss: 0.959 Vali Loss: 1.243 Vali Acc: 0.425 Test Loss: 1.243 Test Acc: 0.425
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.6163127422332764
Epoch: 21, Steps: 3 | Train Loss: 0.910 Vali Loss: 1.225 Vali Acc: 0.400 Test Loss: 1.225 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.4869222640991211
Epoch: 22, Steps: 3 | Train Loss: 0.874 Vali Loss: 1.207 Vali Acc: 0.450 Test Loss: 1.207 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449988).  Saving model ...
Epoch: 23 cost time: 0.4857027530670166
Epoch: 23, Steps: 3 | Train Loss: 0.894 Vali Loss: 1.187 Vali Acc: 0.450 Test Loss: 1.187 Test Acc: 0.450
Validation loss decreased (-0.449988 --> -0.449988).  Saving model ...
Epoch: 24 cost time: 0.5714693069458008
Epoch: 24, Steps: 3 | Train Loss: 0.848 Vali Loss: 1.167 Vali Acc: 0.450 Test Loss: 1.167 Test Acc: 0.450
Validation loss decreased (-0.449988 --> -0.449988).  Saving model ...
Epoch: 25 cost time: 0.45322751998901367
Epoch: 25, Steps: 3 | Train Loss: 0.798 Vali Loss: 1.149 Vali Acc: 0.475 Test Loss: 1.149 Test Acc: 0.475
Validation loss decreased (-0.449988 --> -0.474989).  Saving model ...
Epoch: 26 cost time: 0.473740816116333
Epoch: 26, Steps: 3 | Train Loss: 0.762 Vali Loss: 1.129 Vali Acc: 0.475 Test Loss: 1.129 Test Acc: 0.475
Validation loss decreased (-0.474989 --> -0.474989).  Saving model ...
Epoch: 27 cost time: 0.5281646251678467
Epoch: 27, Steps: 3 | Train Loss: 0.761 Vali Loss: 1.110 Vali Acc: 0.550 Test Loss: 1.110 Test Acc: 0.550
Validation loss decreased (-0.474989 --> -0.549989).  Saving model ...
Epoch: 28 cost time: 0.5514872074127197
Epoch: 28, Steps: 3 | Train Loss: 0.740 Vali Loss: 1.091 Vali Acc: 0.575 Test Loss: 1.091 Test Acc: 0.575
Validation loss decreased (-0.549989 --> -0.574989).  Saving model ...
Epoch: 29 cost time: 0.44402432441711426
Epoch: 29, Steps: 3 | Train Loss: 0.675 Vali Loss: 1.071 Vali Acc: 0.600 Test Loss: 1.071 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599989).  Saving model ...
Epoch: 30 cost time: 0.388866662979126
Epoch: 30, Steps: 3 | Train Loss: 0.645 Vali Loss: 1.051 Vali Acc: 0.650 Test Loss: 1.051 Test Acc: 0.650
Validation loss decreased (-0.599989 --> -0.649989).  Saving model ...
Epoch: 31 cost time: 0.49051761627197266
Epoch: 31, Steps: 3 | Train Loss: 0.668 Vali Loss: 1.033 Vali Acc: 0.700 Test Loss: 1.033 Test Acc: 0.700
Validation loss decreased (-0.649989 --> -0.699990).  Saving model ...
Epoch: 32 cost time: 0.46335697174072266
Epoch: 32, Steps: 3 | Train Loss: 0.629 Vali Loss: 1.015 Vali Acc: 0.700 Test Loss: 1.015 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 33 cost time: 0.4960179328918457
Epoch: 33, Steps: 3 | Train Loss: 0.602 Vali Loss: 0.997 Vali Acc: 0.700 Test Loss: 0.997 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 34 cost time: 0.4767897129058838
Epoch: 34, Steps: 3 | Train Loss: 0.590 Vali Loss: 0.980 Vali Acc: 0.725 Test Loss: 0.980 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724990).  Saving model ...
Epoch: 35 cost time: 0.53446364402771
Epoch: 35, Steps: 3 | Train Loss: 0.562 Vali Loss: 0.962 Vali Acc: 0.750 Test Loss: 0.962 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749990).  Saving model ...
Epoch: 36 cost time: 0.5047736167907715
Epoch: 36, Steps: 3 | Train Loss: 0.495 Vali Loss: 0.944 Vali Acc: 0.750 Test Loss: 0.944 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749991).  Saving model ...
Epoch: 37 cost time: 0.46084070205688477
Epoch: 37, Steps: 3 | Train Loss: 0.505 Vali Loss: 0.927 Vali Acc: 0.750 Test Loss: 0.927 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 38 cost time: 0.44091081619262695
Epoch: 38, Steps: 3 | Train Loss: 0.462 Vali Loss: 0.907 Vali Acc: 0.750 Test Loss: 0.907 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 39 cost time: 0.5748131275177002
Epoch: 39, Steps: 3 | Train Loss: 0.468 Vali Loss: 0.883 Vali Acc: 0.750 Test Loss: 0.883 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 40 cost time: 0.5338015556335449
Epoch: 40, Steps: 3 | Train Loss: 0.453 Vali Loss: 0.861 Vali Acc: 0.800 Test Loss: 0.861 Test Acc: 0.800
Validation loss decreased (-0.749991 --> -0.799991).  Saving model ...
Epoch: 41 cost time: 0.5860884189605713
Epoch: 41, Steps: 3 | Train Loss: 0.420 Vali Loss: 0.839 Vali Acc: 0.800 Test Loss: 0.839 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799992).  Saving model ...
Epoch: 42 cost time: 0.5538456439971924
Epoch: 42, Steps: 3 | Train Loss: 0.426 Vali Loss: 0.817 Vali Acc: 0.800 Test Loss: 0.817 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 43 cost time: 0.45480871200561523
Epoch: 43, Steps: 3 | Train Loss: 0.402 Vali Loss: 0.794 Vali Acc: 0.800 Test Loss: 0.794 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 44 cost time: 0.3612332344055176
Epoch: 44, Steps: 3 | Train Loss: 0.356 Vali Loss: 0.773 Vali Acc: 0.800 Test Loss: 0.773 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 45 cost time: 0.4618661403656006
Epoch: 45, Steps: 3 | Train Loss: 0.368 Vali Loss: 0.754 Vali Acc: 0.800 Test Loss: 0.754 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 46 cost time: 0.42612648010253906
Epoch: 46, Steps: 3 | Train Loss: 0.323 Vali Loss: 0.739 Vali Acc: 0.800 Test Loss: 0.739 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799993).  Saving model ...
Epoch: 47 cost time: 0.44336485862731934
Epoch: 47, Steps: 3 | Train Loss: 0.313 Vali Loss: 0.721 Vali Acc: 0.800 Test Loss: 0.721 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 48 cost time: 0.44989442825317383
Epoch: 48, Steps: 3 | Train Loss: 0.317 Vali Loss: 0.704 Vali Acc: 0.825 Test Loss: 0.704 Test Acc: 0.825
Validation loss decreased (-0.799993 --> -0.824993).  Saving model ...
Epoch: 49 cost time: 0.4837644100189209
Epoch: 49, Steps: 3 | Train Loss: 0.332 Vali Loss: 0.681 Vali Acc: 0.825 Test Loss: 0.681 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 50 cost time: 0.4100656509399414
Epoch: 50, Steps: 3 | Train Loss: 0.259 Vali Loss: 0.664 Vali Acc: 0.825 Test Loss: 0.664 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 51 cost time: 0.5675039291381836
Epoch: 51, Steps: 3 | Train Loss: 0.287 Vali Loss: 0.645 Vali Acc: 0.850 Test Loss: 0.645 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849994).  Saving model ...
Epoch: 52 cost time: 0.5005042552947998
Epoch: 52, Steps: 3 | Train Loss: 0.257 Vali Loss: 0.631 Vali Acc: 0.850 Test Loss: 0.631 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 53 cost time: 0.5274708271026611
Epoch: 53, Steps: 3 | Train Loss: 0.254 Vali Loss: 0.607 Vali Acc: 0.850 Test Loss: 0.607 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 54 cost time: 0.5040743350982666
Epoch: 54, Steps: 3 | Train Loss: 0.231 Vali Loss: 0.583 Vali Acc: 0.850 Test Loss: 0.583 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 55 cost time: 0.5329341888427734
Epoch: 55, Steps: 3 | Train Loss: 0.217 Vali Loss: 0.564 Vali Acc: 0.850 Test Loss: 0.564 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 56 cost time: 0.5198161602020264
Epoch: 56, Steps: 3 | Train Loss: 0.208 Vali Loss: 0.546 Vali Acc: 0.850 Test Loss: 0.546 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 57 cost time: 0.5317850112915039
Epoch: 57, Steps: 3 | Train Loss: 0.182 Vali Loss: 0.527 Vali Acc: 0.850 Test Loss: 0.527 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 58 cost time: 0.4942591190338135
Epoch: 58, Steps: 3 | Train Loss: 0.183 Vali Loss: 0.510 Vali Acc: 0.825 Test Loss: 0.510 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.5058043003082275
Epoch: 59, Steps: 3 | Train Loss: 0.166 Vali Loss: 0.494 Vali Acc: 0.850 Test Loss: 0.494 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 60 cost time: 0.4082355499267578
Epoch: 60, Steps: 3 | Train Loss: 0.165 Vali Loss: 0.481 Vali Acc: 0.850 Test Loss: 0.481 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 61 cost time: 0.468672513961792
Epoch: 61, Steps: 3 | Train Loss: 0.135 Vali Loss: 0.479 Vali Acc: 0.850 Test Loss: 0.479 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 62 cost time: 0.5169732570648193
Epoch: 62, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.463 Vali Acc: 0.850 Test Loss: 0.463 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 63 cost time: 0.5529580116271973
Epoch: 63, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.440 Vali Acc: 0.850 Test Loss: 0.440 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849996).  Saving model ...
Epoch: 64 cost time: 0.5836191177368164
Epoch: 64, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.427 Vali Acc: 0.825 Test Loss: 0.427 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.6295669078826904
Epoch: 65, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.417 Vali Acc: 0.825 Test Loss: 0.417 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 0.4874396324157715
Epoch: 66, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.414 Vali Acc: 0.875 Test Loss: 0.414 Test Acc: 0.875
Validation loss decreased (-0.849996 --> -0.874996).  Saving model ...
Epoch: 67 cost time: 0.539170503616333
Epoch: 67, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.402 Vali Acc: 0.875 Test Loss: 0.402 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 68 cost time: 0.47046327590942383
Epoch: 68, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.367 Vali Acc: 0.900 Test Loss: 0.367 Test Acc: 0.900
Validation loss decreased (-0.874996 --> -0.899996).  Saving model ...
Epoch: 69 cost time: 0.5555367469787598
Epoch: 69, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.342 Vali Acc: 0.900 Test Loss: 0.342 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 70 cost time: 0.5236308574676514
Epoch: 70, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.301 Vali Acc: 0.900 Test Loss: 0.301 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 71 cost time: 0.5050535202026367
Epoch: 71, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.256 Vali Acc: 0.925 Test Loss: 0.256 Test Acc: 0.925
Validation loss decreased (-0.899997 --> -0.924997).  Saving model ...
Epoch: 72 cost time: 0.5490329265594482
Epoch: 72, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.215 Vali Acc: 0.950 Test Loss: 0.215 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949998).  Saving model ...
Epoch: 73 cost time: 0.5127027034759521
Epoch: 73, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.192 Vali Acc: 0.950 Test Loss: 0.192 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 74 cost time: 0.45611000061035156
Epoch: 74, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.170 Vali Acc: 0.950 Test Loss: 0.170 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 75 cost time: 0.4723224639892578
Epoch: 75, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.154 Vali Acc: 0.950 Test Loss: 0.154 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 76 cost time: 0.483691930770874
Epoch: 76, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.143 Vali Acc: 0.950 Test Loss: 0.143 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949999).  Saving model ...
Epoch: 77 cost time: 0.4587116241455078
Epoch: 77, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.136 Vali Acc: 0.950 Test Loss: 0.136 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 78 cost time: 0.4738185405731201
Epoch: 78, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.126 Vali Acc: 0.950 Test Loss: 0.126 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 79 cost time: 0.5649387836456299
Epoch: 79, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.112 Vali Acc: 0.975 Test Loss: 0.112 Test Acc: 0.975
Validation loss decreased (-0.949999 --> -0.974999).  Saving model ...
Epoch: 80 cost time: 0.5228147506713867
Epoch: 80, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 81 cost time: 0.45207667350769043
Epoch: 81, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.975 Test Loss: 0.091 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 82 cost time: 0.5703713893890381
Epoch: 82, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.975 Test Loss: 0.086 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 83 cost time: 0.4713890552520752
Epoch: 83, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.085 Vali Acc: 0.975 Test Loss: 0.085 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 84 cost time: 0.5444326400756836
Epoch: 84, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.975 Test Loss: 0.083 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 85 cost time: 0.5564277172088623
Epoch: 85, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.975 Test Loss: 0.081 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 86 cost time: 0.5890688896179199
Epoch: 86, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.975 Test Loss: 0.079 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 87 cost time: 0.5389854907989502
Epoch: 87, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.076 Vali Acc: 0.975 Test Loss: 0.076 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 88 cost time: 0.6193161010742188
Epoch: 88, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.072 Vali Acc: 0.975 Test Loss: 0.072 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 89 cost time: 0.7733502388000488
Epoch: 89, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.068 Vali Acc: 0.975 Test Loss: 0.068 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 90 cost time: 0.6106700897216797
Epoch: 90, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.065 Vali Acc: 1.000 Test Loss: 0.065 Test Acc: 1.000
Validation loss decreased (-0.974999 --> -0.999999).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm128_cs6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 21846
model size : 0.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm128_cs5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.663837194442749
Epoch: 1, Steps: 3 | Train Loss: 1.474 Vali Loss: 1.629 Vali Acc: 0.150 Test Loss: 1.629 Test Acc: 0.150
Validation loss decreased (inf --> -0.149984).  Saving model ...
Epoch: 2 cost time: 0.5846207141876221
Epoch: 2, Steps: 3 | Train Loss: 1.451 Vali Loss: 1.622 Vali Acc: 0.150 Test Loss: 1.622 Test Acc: 0.150
Validation loss decreased (-0.149984 --> -0.149984).  Saving model ...
Epoch: 3 cost time: 0.5425117015838623
Epoch: 3, Steps: 3 | Train Loss: 1.440 Vali Loss: 1.616 Vali Acc: 0.150 Test Loss: 1.616 Test Acc: 0.150
Validation loss decreased (-0.149984 --> -0.149984).  Saving model ...
Epoch: 4 cost time: 0.5037615299224854
Epoch: 4, Steps: 3 | Train Loss: 1.416 Vali Loss: 1.606 Vali Acc: 0.175 Test Loss: 1.606 Test Acc: 0.175
Validation loss decreased (-0.149984 --> -0.174984).  Saving model ...
Epoch: 5 cost time: 0.49956297874450684
Epoch: 5, Steps: 3 | Train Loss: 1.398 Vali Loss: 1.595 Vali Acc: 0.175 Test Loss: 1.595 Test Acc: 0.175
Validation loss decreased (-0.174984 --> -0.174984).  Saving model ...
Epoch: 6 cost time: 0.4293253421783447
Epoch: 6, Steps: 3 | Train Loss: 1.363 Vali Loss: 1.583 Vali Acc: 0.250 Test Loss: 1.583 Test Acc: 0.250
Validation loss decreased (-0.174984 --> -0.249984).  Saving model ...
Epoch: 7 cost time: 0.4748876094818115
Epoch: 7, Steps: 3 | Train Loss: 1.353 Vali Loss: 1.569 Vali Acc: 0.250 Test Loss: 1.569 Test Acc: 0.250
Validation loss decreased (-0.249984 --> -0.249984).  Saving model ...
Epoch: 8 cost time: 0.552262544631958
Epoch: 8, Steps: 3 | Train Loss: 1.334 Vali Loss: 1.555 Vali Acc: 0.250 Test Loss: 1.555 Test Acc: 0.250
Validation loss decreased (-0.249984 --> -0.249984).  Saving model ...
Epoch: 9 cost time: 0.4194455146789551
Epoch: 9, Steps: 3 | Train Loss: 1.307 Vali Loss: 1.539 Vali Acc: 0.250 Test Loss: 1.539 Test Acc: 0.250
Validation loss decreased (-0.249984 --> -0.249985).  Saving model ...
Epoch: 10 cost time: 0.46744751930236816
Epoch: 10, Steps: 3 | Train Loss: 1.279 Vali Loss: 1.522 Vali Acc: 0.250 Test Loss: 1.522 Test Acc: 0.250
Validation loss decreased (-0.249985 --> -0.249985).  Saving model ...
Epoch: 11 cost time: 0.5235531330108643
Epoch: 11, Steps: 3 | Train Loss: 1.262 Vali Loss: 1.504 Vali Acc: 0.300 Test Loss: 1.504 Test Acc: 0.300
Validation loss decreased (-0.249985 --> -0.299985).  Saving model ...
Epoch: 12 cost time: 0.5587303638458252
Epoch: 12, Steps: 3 | Train Loss: 1.190 Vali Loss: 1.486 Vali Acc: 0.275 Test Loss: 1.486 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5174953937530518
Epoch: 13, Steps: 3 | Train Loss: 1.200 Vali Loss: 1.467 Vali Acc: 0.300 Test Loss: 1.467 Test Acc: 0.300
Validation loss decreased (-0.299985 --> -0.299985).  Saving model ...
Epoch: 14 cost time: 0.4835965633392334
Epoch: 14, Steps: 3 | Train Loss: 1.125 Vali Loss: 1.446 Vali Acc: 0.300 Test Loss: 1.446 Test Acc: 0.300
Validation loss decreased (-0.299985 --> -0.299986).  Saving model ...
Epoch: 15 cost time: 0.44019508361816406
Epoch: 15, Steps: 3 | Train Loss: 1.098 Vali Loss: 1.426 Vali Acc: 0.300 Test Loss: 1.426 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 16 cost time: 0.5544934272766113
Epoch: 16, Steps: 3 | Train Loss: 1.075 Vali Loss: 1.405 Vali Acc: 0.325 Test Loss: 1.405 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324986).  Saving model ...
Epoch: 17 cost time: 0.4617502689361572
Epoch: 17, Steps: 3 | Train Loss: 1.059 Vali Loss: 1.384 Vali Acc: 0.375 Test Loss: 1.384 Test Acc: 0.375
Validation loss decreased (-0.324986 --> -0.374986).  Saving model ...
Epoch: 18 cost time: 0.584679126739502
Epoch: 18, Steps: 3 | Train Loss: 1.041 Vali Loss: 1.363 Vali Acc: 0.425 Test Loss: 1.363 Test Acc: 0.425
Validation loss decreased (-0.374986 --> -0.424986).  Saving model ...
Epoch: 19 cost time: 0.5150964260101318
Epoch: 19, Steps: 3 | Train Loss: 0.970 Vali Loss: 1.342 Vali Acc: 0.450 Test Loss: 1.342 Test Acc: 0.450
Validation loss decreased (-0.424986 --> -0.449987).  Saving model ...
Epoch: 20 cost time: 0.5790219306945801
Epoch: 20, Steps: 3 | Train Loss: 0.958 Vali Loss: 1.320 Vali Acc: 0.475 Test Loss: 1.320 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474987).  Saving model ...
Epoch: 21 cost time: 0.5477695465087891
Epoch: 21, Steps: 3 | Train Loss: 0.914 Vali Loss: 1.299 Vali Acc: 0.525 Test Loss: 1.299 Test Acc: 0.525
Validation loss decreased (-0.474987 --> -0.524987).  Saving model ...
Epoch: 22 cost time: 0.5654375553131104
Epoch: 22, Steps: 3 | Train Loss: 0.870 Vali Loss: 1.277 Vali Acc: 0.550 Test Loss: 1.277 Test Acc: 0.550
Validation loss decreased (-0.524987 --> -0.549987).  Saving model ...
Epoch: 23 cost time: 0.5709309577941895
Epoch: 23, Steps: 3 | Train Loss: 0.873 Vali Loss: 1.255 Vali Acc: 0.550 Test Loss: 1.255 Test Acc: 0.550
Validation loss decreased (-0.549987 --> -0.549987).  Saving model ...
Epoch: 24 cost time: 0.5791540145874023
Epoch: 24, Steps: 3 | Train Loss: 0.819 Vali Loss: 1.232 Vali Acc: 0.600 Test Loss: 1.232 Test Acc: 0.600
Validation loss decreased (-0.549987 --> -0.599988).  Saving model ...
Epoch: 25 cost time: 0.5959811210632324
Epoch: 25, Steps: 3 | Train Loss: 0.781 Vali Loss: 1.210 Vali Acc: 0.600 Test Loss: 1.210 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 26 cost time: 0.5274660587310791
Epoch: 26, Steps: 3 | Train Loss: 0.760 Vali Loss: 1.189 Vali Acc: 0.600 Test Loss: 1.189 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 27 cost time: 0.65338134765625
Epoch: 27, Steps: 3 | Train Loss: 0.756 Vali Loss: 1.168 Vali Acc: 0.625 Test Loss: 1.168 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624988).  Saving model ...
Epoch: 28 cost time: 0.8354663848876953
Epoch: 28, Steps: 3 | Train Loss: 0.723 Vali Loss: 1.145 Vali Acc: 0.650 Test Loss: 1.145 Test Acc: 0.650
Validation loss decreased (-0.624988 --> -0.649989).  Saving model ...
Epoch: 29 cost time: 0.4553816318511963
Epoch: 29, Steps: 3 | Train Loss: 0.701 Vali Loss: 1.123 Vali Acc: 0.625 Test Loss: 1.123 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6475844383239746
Epoch: 30, Steps: 3 | Train Loss: 0.639 Vali Loss: 1.102 Vali Acc: 0.625 Test Loss: 1.102 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.575005292892456
Epoch: 31, Steps: 3 | Train Loss: 0.628 Vali Loss: 1.079 Vali Acc: 0.625 Test Loss: 1.079 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.5398023128509521
Epoch: 32, Steps: 3 | Train Loss: 0.580 Vali Loss: 1.058 Vali Acc: 0.700 Test Loss: 1.058 Test Acc: 0.700
Validation loss decreased (-0.649989 --> -0.699989).  Saving model ...
Epoch: 33 cost time: 0.4553835391998291
Epoch: 33, Steps: 3 | Train Loss: 0.583 Vali Loss: 1.036 Vali Acc: 0.700 Test Loss: 1.036 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699990).  Saving model ...
Epoch: 34 cost time: 0.5267791748046875
Epoch: 34, Steps: 3 | Train Loss: 0.561 Vali Loss: 1.012 Vali Acc: 0.725 Test Loss: 1.012 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724990).  Saving model ...
Epoch: 35 cost time: 0.4736201763153076
Epoch: 35, Steps: 3 | Train Loss: 0.530 Vali Loss: 0.988 Vali Acc: 0.725 Test Loss: 0.988 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 36 cost time: 0.5680949687957764
Epoch: 36, Steps: 3 | Train Loss: 0.515 Vali Loss: 0.964 Vali Acc: 0.750 Test Loss: 0.964 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749990).  Saving model ...
Epoch: 37 cost time: 0.4835233688354492
Epoch: 37, Steps: 3 | Train Loss: 0.504 Vali Loss: 0.938 Vali Acc: 0.750 Test Loss: 0.938 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749991).  Saving model ...
Epoch: 38 cost time: 0.5424642562866211
Epoch: 38, Steps: 3 | Train Loss: 0.467 Vali Loss: 0.911 Vali Acc: 0.750 Test Loss: 0.911 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 39 cost time: 0.5857753753662109
Epoch: 39, Steps: 3 | Train Loss: 0.458 Vali Loss: 0.884 Vali Acc: 0.725 Test Loss: 0.884 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.6011698246002197
Epoch: 40, Steps: 3 | Train Loss: 0.414 Vali Loss: 0.856 Vali Acc: 0.750 Test Loss: 0.856 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 41 cost time: 0.4727928638458252
Epoch: 41, Steps: 3 | Train Loss: 0.410 Vali Loss: 0.826 Vali Acc: 0.750 Test Loss: 0.826 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 42 cost time: 0.49713706970214844
Epoch: 42, Steps: 3 | Train Loss: 0.367 Vali Loss: 0.793 Vali Acc: 0.750 Test Loss: 0.793 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 43 cost time: 0.5671854019165039
Epoch: 43, Steps: 3 | Train Loss: 0.365 Vali Loss: 0.757 Vali Acc: 0.750 Test Loss: 0.757 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 44 cost time: 0.6505324840545654
Epoch: 44, Steps: 3 | Train Loss: 0.334 Vali Loss: 0.722 Vali Acc: 0.750 Test Loss: 0.722 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749993).  Saving model ...
Epoch: 45 cost time: 0.541447639465332
Epoch: 45, Steps: 3 | Train Loss: 0.322 Vali Loss: 0.686 Vali Acc: 0.775 Test Loss: 0.686 Test Acc: 0.775
Validation loss decreased (-0.749993 --> -0.774993).  Saving model ...
Epoch: 46 cost time: 0.5534625053405762
Epoch: 46, Steps: 3 | Train Loss: 0.313 Vali Loss: 0.645 Vali Acc: 0.825 Test Loss: 0.645 Test Acc: 0.825
Validation loss decreased (-0.774993 --> -0.824994).  Saving model ...
Epoch: 47 cost time: 0.508044958114624
Epoch: 47, Steps: 3 | Train Loss: 0.282 Vali Loss: 0.606 Vali Acc: 0.825 Test Loss: 0.606 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 48 cost time: 0.45604705810546875
Epoch: 48, Steps: 3 | Train Loss: 0.252 Vali Loss: 0.567 Vali Acc: 0.875 Test Loss: 0.567 Test Acc: 0.875
Validation loss decreased (-0.824994 --> -0.874994).  Saving model ...
Epoch: 49 cost time: 0.41503047943115234
Epoch: 49, Steps: 3 | Train Loss: 0.244 Vali Loss: 0.526 Vali Acc: 0.875 Test Loss: 0.526 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 50 cost time: 0.4039018154144287
Epoch: 50, Steps: 3 | Train Loss: 0.247 Vali Loss: 0.483 Vali Acc: 0.900 Test Loss: 0.483 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899995).  Saving model ...
Epoch: 51 cost time: 0.4936497211456299
Epoch: 51, Steps: 3 | Train Loss: 0.235 Vali Loss: 0.440 Vali Acc: 0.900 Test Loss: 0.440 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 52 cost time: 0.5070734024047852
Epoch: 52, Steps: 3 | Train Loss: 0.221 Vali Loss: 0.399 Vali Acc: 0.925 Test Loss: 0.399 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 53 cost time: 0.44861531257629395
Epoch: 53, Steps: 3 | Train Loss: 0.198 Vali Loss: 0.356 Vali Acc: 0.950 Test Loss: 0.356 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 54 cost time: 0.6247842311859131
Epoch: 54, Steps: 3 | Train Loss: 0.171 Vali Loss: 0.316 Vali Acc: 0.950 Test Loss: 0.316 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 55 cost time: 0.4237954616546631
Epoch: 55, Steps: 3 | Train Loss: 0.154 Vali Loss: 0.279 Vali Acc: 0.950 Test Loss: 0.279 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 56 cost time: 0.5635371208190918
Epoch: 56, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.245 Vali Acc: 0.950 Test Loss: 0.245 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 57 cost time: 0.5370512008666992
Epoch: 57, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.218 Vali Acc: 0.950 Test Loss: 0.218 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 58 cost time: 0.44870615005493164
Epoch: 58, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.193 Vali Acc: 0.975 Test Loss: 0.193 Test Acc: 0.975
Validation loss decreased (-0.949998 --> -0.974998).  Saving model ...
Epoch: 59 cost time: 0.46520256996154785
Epoch: 59, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.167 Vali Acc: 0.975 Test Loss: 0.167 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 60 cost time: 0.43070268630981445
Epoch: 60, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.143 Vali Acc: 1.000 Test Loss: 0.143 Test Acc: 1.000
Validation loss decreased (-0.974998 --> -0.999999).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm128_cs5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 21816
model size : 0.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm64_cs50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.9651598930358887
Epoch: 1, Steps: 3 | Train Loss: 1.359 Vali Loss: 1.395 Vali Acc: 0.300 Test Loss: 1.395 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.4777858257293701
Epoch: 2, Steps: 3 | Train Loss: 1.343 Vali Loss: 1.389 Vali Acc: 0.300 Test Loss: 1.389 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 0.40837883949279785
Epoch: 3, Steps: 3 | Train Loss: 1.341 Vali Loss: 1.384 Vali Acc: 0.300 Test Loss: 1.384 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 4 cost time: 0.5603878498077393
Epoch: 4, Steps: 3 | Train Loss: 1.326 Vali Loss: 1.377 Vali Acc: 0.300 Test Loss: 1.377 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 5 cost time: 0.4304509162902832
Epoch: 5, Steps: 3 | Train Loss: 1.295 Vali Loss: 1.368 Vali Acc: 0.300 Test Loss: 1.368 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 6 cost time: 0.4604065418243408
Epoch: 6, Steps: 3 | Train Loss: 1.274 Vali Loss: 1.359 Vali Acc: 0.325 Test Loss: 1.359 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324986).  Saving model ...
Epoch: 7 cost time: 0.487262487411499
Epoch: 7, Steps: 3 | Train Loss: 1.273 Vali Loss: 1.349 Vali Acc: 0.325 Test Loss: 1.349 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324987).  Saving model ...
Epoch: 8 cost time: 0.4707465171813965
Epoch: 8, Steps: 3 | Train Loss: 1.239 Vali Loss: 1.338 Vali Acc: 0.350 Test Loss: 1.338 Test Acc: 0.350
Validation loss decreased (-0.324987 --> -0.349987).  Saving model ...
Epoch: 9 cost time: 0.5787363052368164
Epoch: 9, Steps: 3 | Train Loss: 1.233 Vali Loss: 1.326 Vali Acc: 0.350 Test Loss: 1.326 Test Acc: 0.350
Validation loss decreased (-0.349987 --> -0.349987).  Saving model ...
Epoch: 10 cost time: 0.3952500820159912
Epoch: 10, Steps: 3 | Train Loss: 1.158 Vali Loss: 1.312 Vali Acc: 0.375 Test Loss: 1.312 Test Acc: 0.375
Validation loss decreased (-0.349987 --> -0.374987).  Saving model ...
Epoch: 11 cost time: 0.6167683601379395
Epoch: 11, Steps: 3 | Train Loss: 1.158 Vali Loss: 1.299 Vali Acc: 0.375 Test Loss: 1.299 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 12 cost time: 0.48692941665649414
Epoch: 12, Steps: 3 | Train Loss: 1.120 Vali Loss: 1.285 Vali Acc: 0.400 Test Loss: 1.285 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399987).  Saving model ...
Epoch: 13 cost time: 0.4592247009277344
Epoch: 13, Steps: 3 | Train Loss: 1.096 Vali Loss: 1.270 Vali Acc: 0.400 Test Loss: 1.270 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 14 cost time: 0.5913283824920654
Epoch: 14, Steps: 3 | Train Loss: 1.089 Vali Loss: 1.256 Vali Acc: 0.475 Test Loss: 1.256 Test Acc: 0.475
Validation loss decreased (-0.399987 --> -0.474987).  Saving model ...
Epoch: 15 cost time: 0.5488336086273193
Epoch: 15, Steps: 3 | Train Loss: 1.016 Vali Loss: 1.241 Vali Acc: 0.500 Test Loss: 1.241 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499988).  Saving model ...
Epoch: 16 cost time: 0.7116143703460693
Epoch: 16, Steps: 3 | Train Loss: 0.963 Vali Loss: 1.227 Vali Acc: 0.525 Test Loss: 1.227 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 17 cost time: 0.5214550495147705
Epoch: 17, Steps: 3 | Train Loss: 0.989 Vali Loss: 1.213 Vali Acc: 0.575 Test Loss: 1.213 Test Acc: 0.575
Validation loss decreased (-0.524988 --> -0.574988).  Saving model ...
Epoch: 18 cost time: 0.5859677791595459
Epoch: 18, Steps: 3 | Train Loss: 0.927 Vali Loss: 1.196 Vali Acc: 0.575 Test Loss: 1.196 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 19 cost time: 0.46688318252563477
Epoch: 19, Steps: 3 | Train Loss: 0.940 Vali Loss: 1.180 Vali Acc: 0.600 Test Loss: 1.180 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599988).  Saving model ...
Epoch: 20 cost time: 0.49706363677978516
Epoch: 20, Steps: 3 | Train Loss: 0.904 Vali Loss: 1.164 Vali Acc: 0.600 Test Loss: 1.164 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 21 cost time: 0.5224037170410156
Epoch: 21, Steps: 3 | Train Loss: 0.869 Vali Loss: 1.148 Vali Acc: 0.600 Test Loss: 1.148 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599989).  Saving model ...
Epoch: 22 cost time: 0.522003173828125
Epoch: 22, Steps: 3 | Train Loss: 0.821 Vali Loss: 1.133 Vali Acc: 0.625 Test Loss: 1.133 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 23 cost time: 0.5317955017089844
Epoch: 23, Steps: 3 | Train Loss: 0.807 Vali Loss: 1.118 Vali Acc: 0.625 Test Loss: 1.118 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 24 cost time: 0.4754014015197754
Epoch: 24, Steps: 3 | Train Loss: 0.796 Vali Loss: 1.103 Vali Acc: 0.625 Test Loss: 1.103 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 25 cost time: 0.46264100074768066
Epoch: 25, Steps: 3 | Train Loss: 0.758 Vali Loss: 1.086 Vali Acc: 0.625 Test Loss: 1.086 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 26 cost time: 0.5124244689941406
Epoch: 26, Steps: 3 | Train Loss: 0.724 Vali Loss: 1.071 Vali Acc: 0.625 Test Loss: 1.071 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 27 cost time: 0.6193320751190186
Epoch: 27, Steps: 3 | Train Loss: 0.731 Vali Loss: 1.056 Vali Acc: 0.650 Test Loss: 1.056 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 28 cost time: 0.5596208572387695
Epoch: 28, Steps: 3 | Train Loss: 0.648 Vali Loss: 1.041 Vali Acc: 0.650 Test Loss: 1.041 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649990).  Saving model ...
Epoch: 29 cost time: 0.5658061504364014
Epoch: 29, Steps: 3 | Train Loss: 0.653 Vali Loss: 1.026 Vali Acc: 0.650 Test Loss: 1.026 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 30 cost time: 0.503659725189209
Epoch: 30, Steps: 3 | Train Loss: 0.626 Vali Loss: 1.010 Vali Acc: 0.650 Test Loss: 1.010 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 31 cost time: 0.5293571949005127
Epoch: 31, Steps: 3 | Train Loss: 0.603 Vali Loss: 0.996 Vali Acc: 0.650 Test Loss: 0.996 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 32 cost time: 0.5109908580780029
Epoch: 32, Steps: 3 | Train Loss: 0.591 Vali Loss: 0.982 Vali Acc: 0.650 Test Loss: 0.982 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 33 cost time: 0.4548325538635254
Epoch: 33, Steps: 3 | Train Loss: 0.593 Vali Loss: 0.969 Vali Acc: 0.675 Test Loss: 0.969 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674990).  Saving model ...
Epoch: 34 cost time: 0.5522353649139404
Epoch: 34, Steps: 3 | Train Loss: 0.555 Vali Loss: 0.956 Vali Acc: 0.675 Test Loss: 0.956 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 35 cost time: 0.4602236747741699
Epoch: 35, Steps: 3 | Train Loss: 0.546 Vali Loss: 0.942 Vali Acc: 0.700 Test Loss: 0.942 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699991).  Saving model ...
Epoch: 36 cost time: 0.49278926849365234
Epoch: 36, Steps: 3 | Train Loss: 0.548 Vali Loss: 0.930 Vali Acc: 0.725 Test Loss: 0.930 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724991).  Saving model ...
Epoch: 37 cost time: 0.5346407890319824
Epoch: 37, Steps: 3 | Train Loss: 0.518 Vali Loss: 0.919 Vali Acc: 0.725 Test Loss: 0.919 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 38 cost time: 0.48810887336730957
Epoch: 38, Steps: 3 | Train Loss: 0.475 Vali Loss: 0.907 Vali Acc: 0.750 Test Loss: 0.907 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749991).  Saving model ...
Epoch: 39 cost time: 0.5487525463104248
Epoch: 39, Steps: 3 | Train Loss: 0.465 Vali Loss: 0.897 Vali Acc: 0.775 Test Loss: 0.897 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774991).  Saving model ...
Epoch: 40 cost time: 0.576730489730835
Epoch: 40, Steps: 3 | Train Loss: 0.452 Vali Loss: 0.887 Vali Acc: 0.775 Test Loss: 0.887 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 41 cost time: 0.4990999698638916
Epoch: 41, Steps: 3 | Train Loss: 0.451 Vali Loss: 0.878 Vali Acc: 0.775 Test Loss: 0.878 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 42 cost time: 0.4035916328430176
Epoch: 42, Steps: 3 | Train Loss: 0.399 Vali Loss: 0.868 Vali Acc: 0.800 Test Loss: 0.868 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799991).  Saving model ...
Epoch: 43 cost time: 0.47683191299438477
Epoch: 43, Steps: 3 | Train Loss: 0.409 Vali Loss: 0.859 Vali Acc: 0.800 Test Loss: 0.859 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 44 cost time: 0.5449957847595215
Epoch: 44, Steps: 3 | Train Loss: 0.392 Vali Loss: 0.851 Vali Acc: 0.800 Test Loss: 0.851 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 45 cost time: 0.4134938716888428
Epoch: 45, Steps: 3 | Train Loss: 0.383 Vali Loss: 0.842 Vali Acc: 0.800 Test Loss: 0.842 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799992).  Saving model ...
Epoch: 46 cost time: 0.47520947456359863
Epoch: 46, Steps: 3 | Train Loss: 0.356 Vali Loss: 0.835 Vali Acc: 0.800 Test Loss: 0.835 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 47 cost time: 0.46929097175598145
Epoch: 47, Steps: 3 | Train Loss: 0.368 Vali Loss: 0.828 Vali Acc: 0.800 Test Loss: 0.828 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 48 cost time: 0.47489047050476074
Epoch: 48, Steps: 3 | Train Loss: 0.345 Vali Loss: 0.820 Vali Acc: 0.800 Test Loss: 0.820 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 49 cost time: 0.5207686424255371
Epoch: 49, Steps: 3 | Train Loss: 0.320 Vali Loss: 0.814 Vali Acc: 0.825 Test Loss: 0.814 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824992).  Saving model ...
Epoch: 50 cost time: 0.5092995166778564
Epoch: 50, Steps: 3 | Train Loss: 0.348 Vali Loss: 0.809 Vali Acc: 0.825 Test Loss: 0.809 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 51 cost time: 0.44602227210998535
Epoch: 51, Steps: 3 | Train Loss: 0.351 Vali Loss: 0.803 Vali Acc: 0.800 Test Loss: 0.803 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.4915165901184082
Epoch: 52, Steps: 3 | Train Loss: 0.317 Vali Loss: 0.799 Vali Acc: 0.800 Test Loss: 0.799 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.49816203117370605
Epoch: 53, Steps: 3 | Train Loss: 0.303 Vali Loss: 0.794 Vali Acc: 0.800 Test Loss: 0.794 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.45200347900390625
Epoch: 54, Steps: 3 | Train Loss: 0.283 Vali Loss: 0.789 Vali Acc: 0.825 Test Loss: 0.789 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 55 cost time: 0.5872933864593506
Epoch: 55, Steps: 3 | Train Loss: 0.292 Vali Loss: 0.785 Vali Acc: 0.825 Test Loss: 0.785 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 56 cost time: 0.4444406032562256
Epoch: 56, Steps: 3 | Train Loss: 0.280 Vali Loss: 0.781 Vali Acc: 0.825 Test Loss: 0.781 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 57 cost time: 0.5771119594573975
Epoch: 57, Steps: 3 | Train Loss: 0.250 Vali Loss: 0.776 Vali Acc: 0.800 Test Loss: 0.776 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.5088613033294678
Epoch: 58, Steps: 3 | Train Loss: 0.274 Vali Loss: 0.772 Vali Acc: 0.800 Test Loss: 0.772 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.4709336757659912
Epoch: 59, Steps: 3 | Train Loss: 0.256 Vali Loss: 0.768 Vali Acc: 0.800 Test Loss: 0.768 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.5249757766723633
Epoch: 60, Steps: 3 | Train Loss: 0.255 Vali Loss: 0.764 Vali Acc: 0.800 Test Loss: 0.764 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 0.5190639495849609
Epoch: 61, Steps: 3 | Train Loss: 0.250 Vali Loss: 0.759 Vali Acc: 0.800 Test Loss: 0.759 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 0.538928747177124
Epoch: 62, Steps: 3 | Train Loss: 0.239 Vali Loss: 0.754 Vali Acc: 0.800 Test Loss: 0.754 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 0.6686880588531494
Epoch: 63, Steps: 3 | Train Loss: 0.257 Vali Loss: 0.749 Vali Acc: 0.825 Test Loss: 0.749 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824993).  Saving model ...
Epoch: 64 cost time: 0.5322163105010986
Epoch: 64, Steps: 3 | Train Loss: 0.217 Vali Loss: 0.745 Vali Acc: 0.825 Test Loss: 0.745 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 65 cost time: 0.5743262767791748
Epoch: 65, Steps: 3 | Train Loss: 0.209 Vali Loss: 0.741 Vali Acc: 0.825 Test Loss: 0.741 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 66 cost time: 0.4727957248687744
Epoch: 66, Steps: 3 | Train Loss: 0.212 Vali Loss: 0.737 Vali Acc: 0.825 Test Loss: 0.737 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 67 cost time: 0.5454189777374268
Epoch: 67, Steps: 3 | Train Loss: 0.243 Vali Loss: 0.734 Vali Acc: 0.825 Test Loss: 0.734 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 68 cost time: 0.42935800552368164
Epoch: 68, Steps: 3 | Train Loss: 0.215 Vali Loss: 0.731 Vali Acc: 0.825 Test Loss: 0.731 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 69 cost time: 0.45124292373657227
Epoch: 69, Steps: 3 | Train Loss: 0.192 Vali Loss: 0.729 Vali Acc: 0.825 Test Loss: 0.729 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 70 cost time: 0.4516019821166992
Epoch: 70, Steps: 3 | Train Loss: 0.179 Vali Loss: 0.727 Vali Acc: 0.825 Test Loss: 0.727 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 71 cost time: 0.5774693489074707
Epoch: 71, Steps: 3 | Train Loss: 0.180 Vali Loss: 0.725 Vali Acc: 0.825 Test Loss: 0.725 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 72 cost time: 0.49740123748779297
Epoch: 72, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.722 Vali Acc: 0.825 Test Loss: 0.722 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 73 cost time: 0.5546987056732178
Epoch: 73, Steps: 3 | Train Loss: 0.178 Vali Loss: 0.720 Vali Acc: 0.825 Test Loss: 0.720 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 74 cost time: 0.508587121963501
Epoch: 74, Steps: 3 | Train Loss: 0.168 Vali Loss: 0.717 Vali Acc: 0.825 Test Loss: 0.717 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 75 cost time: 0.5113205909729004
Epoch: 75, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.715 Vali Acc: 0.825 Test Loss: 0.715 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 76 cost time: 0.504307746887207
Epoch: 76, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.712 Vali Acc: 0.825 Test Loss: 0.712 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 77 cost time: 0.4862406253814697
Epoch: 77, Steps: 3 | Train Loss: 0.150 Vali Loss: 0.710 Vali Acc: 0.825 Test Loss: 0.710 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 78 cost time: 0.5002341270446777
Epoch: 78, Steps: 3 | Train Loss: 0.149 Vali Loss: 0.709 Vali Acc: 0.825 Test Loss: 0.709 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 79 cost time: 0.48304247856140137
Epoch: 79, Steps: 3 | Train Loss: 0.150 Vali Loss: 0.708 Vali Acc: 0.825 Test Loss: 0.708 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 80 cost time: 0.45487022399902344
Epoch: 80, Steps: 3 | Train Loss: 0.123 Vali Loss: 0.708 Vali Acc: 0.825 Test Loss: 0.708 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 0.4133577346801758
Epoch: 81, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.708 Vali Acc: 0.825 Test Loss: 0.708 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 0.447951078414917
Epoch: 82, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.708 Vali Acc: 0.825 Test Loss: 0.708 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 83 cost time: 0.40082526206970215
Epoch: 83, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.707 Vali Acc: 0.825 Test Loss: 0.707 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 84 cost time: 0.4294710159301758
Epoch: 84, Steps: 3 | Train Loss: 0.109 Vali Loss: 0.708 Vali Acc: 0.825 Test Loss: 0.708 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 0.5536856651306152
Epoch: 85, Steps: 3 | Train Loss: 0.120 Vali Loss: 0.709 Vali Acc: 0.825 Test Loss: 0.709 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 0.4650917053222656
Epoch: 86, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.710 Vali Acc: 0.825 Test Loss: 0.710 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 87 cost time: 0.3654468059539795
Epoch: 87, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.713 Vali Acc: 0.800 Test Loss: 0.713 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 88 cost time: 0.38355159759521484
Epoch: 88, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.715 Vali Acc: 0.800 Test Loss: 0.715 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 89 cost time: 0.5837631225585938
Epoch: 89, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.719 Vali Acc: 0.800 Test Loss: 0.719 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 90 cost time: 0.5934860706329346
Epoch: 90, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.723 Vali Acc: 0.800 Test Loss: 0.723 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 91 cost time: 0.5189909934997559
Epoch: 91, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.728 Vali Acc: 0.800 Test Loss: 0.728 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 92 cost time: 0.5029256343841553
Epoch: 92, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.734 Vali Acc: 0.800 Test Loss: 0.734 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 93 cost time: 0.5335478782653809
Epoch: 93, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.740 Vali Acc: 0.800 Test Loss: 0.740 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm64_cs50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.825
model parameter : 16712
model size : 0.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm64_cs34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.5659327507019043
Epoch: 1, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.441 Vali Acc: 0.275 Test Loss: 1.441 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.4666404724121094
Epoch: 2, Steps: 3 | Train Loss: 1.358 Vali Loss: 1.432 Vali Acc: 0.325 Test Loss: 1.432 Test Acc: 0.325
Validation loss decreased (-0.274986 --> -0.324986).  Saving model ...
Epoch: 3 cost time: 0.48821377754211426
Epoch: 3, Steps: 3 | Train Loss: 1.359 Vali Loss: 1.426 Vali Acc: 0.350 Test Loss: 1.426 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349986).  Saving model ...
Epoch: 4 cost time: 0.5053925514221191
Epoch: 4, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.417 Vali Acc: 0.350 Test Loss: 1.417 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 5 cost time: 0.38420701026916504
Epoch: 5, Steps: 3 | Train Loss: 1.328 Vali Loss: 1.407 Vali Acc: 0.350 Test Loss: 1.407 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 6 cost time: 0.48249387741088867
Epoch: 6, Steps: 3 | Train Loss: 1.309 Vali Loss: 1.396 Vali Acc: 0.400 Test Loss: 1.396 Test Acc: 0.400
Validation loss decreased (-0.349986 --> -0.399986).  Saving model ...
Epoch: 7 cost time: 0.5050685405731201
Epoch: 7, Steps: 3 | Train Loss: 1.285 Vali Loss: 1.383 Vali Acc: 0.475 Test Loss: 1.383 Test Acc: 0.475
Validation loss decreased (-0.399986 --> -0.474986).  Saving model ...
Epoch: 8 cost time: 0.4927253723144531
Epoch: 8, Steps: 3 | Train Loss: 1.272 Vali Loss: 1.369 Vali Acc: 0.475 Test Loss: 1.369 Test Acc: 0.475
Validation loss decreased (-0.474986 --> -0.474986).  Saving model ...
Epoch: 9 cost time: 0.46956300735473633
Epoch: 9, Steps: 3 | Train Loss: 1.225 Vali Loss: 1.354 Vali Acc: 0.525 Test Loss: 1.354 Test Acc: 0.525
Validation loss decreased (-0.474986 --> -0.524986).  Saving model ...
Epoch: 10 cost time: 0.5777819156646729
Epoch: 10, Steps: 3 | Train Loss: 1.176 Vali Loss: 1.338 Vali Acc: 0.525 Test Loss: 1.338 Test Acc: 0.525
Validation loss decreased (-0.524986 --> -0.524987).  Saving model ...
Epoch: 11 cost time: 0.5081114768981934
Epoch: 11, Steps: 3 | Train Loss: 1.176 Vali Loss: 1.322 Vali Acc: 0.600 Test Loss: 1.322 Test Acc: 0.600
Validation loss decreased (-0.524987 --> -0.599987).  Saving model ...
Epoch: 12 cost time: 0.42445826530456543
Epoch: 12, Steps: 3 | Train Loss: 1.132 Vali Loss: 1.306 Vali Acc: 0.600 Test Loss: 1.306 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599987).  Saving model ...
Epoch: 13 cost time: 0.4727489948272705
Epoch: 13, Steps: 3 | Train Loss: 1.102 Vali Loss: 1.290 Vali Acc: 0.650 Test Loss: 1.290 Test Acc: 0.650
Validation loss decreased (-0.599987 --> -0.649987).  Saving model ...
Epoch: 14 cost time: 0.5329265594482422
Epoch: 14, Steps: 3 | Train Loss: 1.082 Vali Loss: 1.273 Vali Acc: 0.700 Test Loss: 1.273 Test Acc: 0.700
Validation loss decreased (-0.649987 --> -0.699987).  Saving model ...
Epoch: 15 cost time: 0.40694332122802734
Epoch: 15, Steps: 3 | Train Loss: 1.071 Vali Loss: 1.257 Vali Acc: 0.725 Test Loss: 1.257 Test Acc: 0.725
Validation loss decreased (-0.699987 --> -0.724987).  Saving model ...
Epoch: 16 cost time: 0.5382380485534668
Epoch: 16, Steps: 3 | Train Loss: 0.990 Vali Loss: 1.241 Vali Acc: 0.750 Test Loss: 1.241 Test Acc: 0.750
Validation loss decreased (-0.724987 --> -0.749988).  Saving model ...
Epoch: 17 cost time: 0.5378491878509521
Epoch: 17, Steps: 3 | Train Loss: 0.975 Vali Loss: 1.225 Vali Acc: 0.800 Test Loss: 1.225 Test Acc: 0.800
Validation loss decreased (-0.749988 --> -0.799988).  Saving model ...
Epoch: 18 cost time: 0.4594285488128662
Epoch: 18, Steps: 3 | Train Loss: 0.932 Vali Loss: 1.208 Vali Acc: 0.800 Test Loss: 1.208 Test Acc: 0.800
Validation loss decreased (-0.799988 --> -0.799988).  Saving model ...
Epoch: 19 cost time: 0.6148252487182617
Epoch: 19, Steps: 3 | Train Loss: 0.919 Vali Loss: 1.193 Vali Acc: 0.800 Test Loss: 1.193 Test Acc: 0.800
Validation loss decreased (-0.799988 --> -0.799988).  Saving model ...
Epoch: 20 cost time: 0.5724258422851562
Epoch: 20, Steps: 3 | Train Loss: 0.899 Vali Loss: 1.177 Vali Acc: 0.825 Test Loss: 1.177 Test Acc: 0.825
Validation loss decreased (-0.799988 --> -0.824988).  Saving model ...
Epoch: 21 cost time: 0.44983935356140137
Epoch: 21, Steps: 3 | Train Loss: 0.870 Vali Loss: 1.161 Vali Acc: 0.850 Test Loss: 1.161 Test Acc: 0.850
Validation loss decreased (-0.824988 --> -0.849988).  Saving model ...
Epoch: 22 cost time: 0.5762641429901123
Epoch: 22, Steps: 3 | Train Loss: 0.826 Vali Loss: 1.146 Vali Acc: 0.850 Test Loss: 1.146 Test Acc: 0.850
Validation loss decreased (-0.849988 --> -0.849989).  Saving model ...
Epoch: 23 cost time: 0.4994509220123291
Epoch: 23, Steps: 3 | Train Loss: 0.804 Vali Loss: 1.132 Vali Acc: 0.825 Test Loss: 1.132 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5191214084625244
Epoch: 24, Steps: 3 | Train Loss: 0.779 Vali Loss: 1.117 Vali Acc: 0.775 Test Loss: 1.117 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.6008036136627197
Epoch: 25, Steps: 3 | Train Loss: 0.783 Vali Loss: 1.103 Vali Acc: 0.775 Test Loss: 1.103 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.5725243091583252
Epoch: 26, Steps: 3 | Train Loss: 0.742 Vali Loss: 1.089 Vali Acc: 0.775 Test Loss: 1.089 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.46589064598083496
Epoch: 27, Steps: 3 | Train Loss: 0.686 Vali Loss: 1.074 Vali Acc: 0.775 Test Loss: 1.074 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.5176746845245361
Epoch: 28, Steps: 3 | Train Loss: 0.680 Vali Loss: 1.059 Vali Acc: 0.775 Test Loss: 1.059 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.5795178413391113
Epoch: 29, Steps: 3 | Train Loss: 0.673 Vali Loss: 1.043 Vali Acc: 0.775 Test Loss: 1.043 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.5537340641021729
Epoch: 30, Steps: 3 | Train Loss: 0.640 Vali Loss: 1.029 Vali Acc: 0.775 Test Loss: 1.029 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.548213005065918
Epoch: 31, Steps: 3 | Train Loss: 0.640 Vali Loss: 1.016 Vali Acc: 0.775 Test Loss: 1.016 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.5056264400482178
Epoch: 32, Steps: 3 | Train Loss: 0.569 Vali Loss: 1.000 Vali Acc: 0.775 Test Loss: 1.000 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm64_cs34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.85
model parameter : 16414
model size : 0.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm64_cs25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6421277523040771
Epoch: 1, Steps: 3 | Train Loss: 1.411 Vali Loss: 1.506 Vali Acc: 0.275 Test Loss: 1.506 Test Acc: 0.275
Validation loss decreased (inf --> -0.274985).  Saving model ...
Epoch: 2 cost time: 0.61344313621521
Epoch: 2, Steps: 3 | Train Loss: 1.347 Vali Loss: 1.495 Vali Acc: 0.275 Test Loss: 1.495 Test Acc: 0.275
Validation loss decreased (-0.274985 --> -0.274985).  Saving model ...
Epoch: 3 cost time: 0.4582698345184326
Epoch: 3, Steps: 3 | Train Loss: 1.355 Vali Loss: 1.486 Vali Acc: 0.275 Test Loss: 1.486 Test Acc: 0.275
Validation loss decreased (-0.274985 --> -0.274985).  Saving model ...
Epoch: 4 cost time: 0.5307748317718506
Epoch: 4, Steps: 3 | Train Loss: 1.320 Vali Loss: 1.474 Vali Acc: 0.250 Test Loss: 1.474 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6001396179199219
Epoch: 5, Steps: 3 | Train Loss: 1.340 Vali Loss: 1.460 Vali Acc: 0.250 Test Loss: 1.460 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.4664943218231201
Epoch: 6, Steps: 3 | Train Loss: 1.301 Vali Loss: 1.445 Vali Acc: 0.250 Test Loss: 1.445 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5327434539794922
Epoch: 7, Steps: 3 | Train Loss: 1.254 Vali Loss: 1.428 Vali Acc: 0.275 Test Loss: 1.428 Test Acc: 0.275
Validation loss decreased (-0.274985 --> -0.274986).  Saving model ...
Epoch: 8 cost time: 0.49634456634521484
Epoch: 8, Steps: 3 | Train Loss: 1.221 Vali Loss: 1.411 Vali Acc: 0.275 Test Loss: 1.411 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274986).  Saving model ...
Epoch: 9 cost time: 0.48902225494384766
Epoch: 9, Steps: 3 | Train Loss: 1.218 Vali Loss: 1.394 Vali Acc: 0.275 Test Loss: 1.394 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274986).  Saving model ...
Epoch: 10 cost time: 0.3976316452026367
Epoch: 10, Steps: 3 | Train Loss: 1.201 Vali Loss: 1.375 Vali Acc: 0.300 Test Loss: 1.375 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299986).  Saving model ...
Epoch: 11 cost time: 0.4641122817993164
Epoch: 11, Steps: 3 | Train Loss: 1.116 Vali Loss: 1.356 Vali Acc: 0.375 Test Loss: 1.356 Test Acc: 0.375
Validation loss decreased (-0.299986 --> -0.374986).  Saving model ...
Epoch: 12 cost time: 0.46608591079711914
Epoch: 12, Steps: 3 | Train Loss: 1.118 Vali Loss: 1.337 Vali Acc: 0.425 Test Loss: 1.337 Test Acc: 0.425
Validation loss decreased (-0.374986 --> -0.424987).  Saving model ...
Epoch: 13 cost time: 0.45524144172668457
Epoch: 13, Steps: 3 | Train Loss: 1.089 Vali Loss: 1.317 Vali Acc: 0.425 Test Loss: 1.317 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 14 cost time: 0.43999266624450684
Epoch: 14, Steps: 3 | Train Loss: 1.048 Vali Loss: 1.297 Vali Acc: 0.450 Test Loss: 1.297 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449987).  Saving model ...
Epoch: 15 cost time: 0.474637508392334
Epoch: 15, Steps: 3 | Train Loss: 1.024 Vali Loss: 1.277 Vali Acc: 0.525 Test Loss: 1.277 Test Acc: 0.525
Validation loss decreased (-0.449987 --> -0.524987).  Saving model ...
Epoch: 16 cost time: 0.5210797786712646
Epoch: 16, Steps: 3 | Train Loss: 0.987 Vali Loss: 1.257 Vali Acc: 0.575 Test Loss: 1.257 Test Acc: 0.575
Validation loss decreased (-0.524987 --> -0.574987).  Saving model ...
Epoch: 17 cost time: 0.4964911937713623
Epoch: 17, Steps: 3 | Train Loss: 0.929 Vali Loss: 1.235 Vali Acc: 0.575 Test Loss: 1.235 Test Acc: 0.575
Validation loss decreased (-0.574987 --> -0.574988).  Saving model ...
Epoch: 18 cost time: 0.577460527420044
Epoch: 18, Steps: 3 | Train Loss: 0.940 Vali Loss: 1.214 Vali Acc: 0.575 Test Loss: 1.214 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 19 cost time: 0.49478864669799805
Epoch: 19, Steps: 3 | Train Loss: 0.895 Vali Loss: 1.192 Vali Acc: 0.625 Test Loss: 1.192 Test Acc: 0.625
Validation loss decreased (-0.574988 --> -0.624988).  Saving model ...
Epoch: 20 cost time: 0.5257089138031006
Epoch: 20, Steps: 3 | Train Loss: 0.885 Vali Loss: 1.171 Vali Acc: 0.650 Test Loss: 1.171 Test Acc: 0.650
Validation loss decreased (-0.624988 --> -0.649988).  Saving model ...
Epoch: 21 cost time: 0.5098230838775635
Epoch: 21, Steps: 3 | Train Loss: 0.820 Vali Loss: 1.151 Vali Acc: 0.675 Test Loss: 1.151 Test Acc: 0.675
Validation loss decreased (-0.649988 --> -0.674988).  Saving model ...
Epoch: 22 cost time: 0.5129072666168213
Epoch: 22, Steps: 3 | Train Loss: 0.822 Vali Loss: 1.129 Vali Acc: 0.675 Test Loss: 1.129 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674989).  Saving model ...
Epoch: 23 cost time: 0.4462900161743164
Epoch: 23, Steps: 3 | Train Loss: 0.789 Vali Loss: 1.106 Vali Acc: 0.675 Test Loss: 1.106 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 24 cost time: 0.5591063499450684
Epoch: 24, Steps: 3 | Train Loss: 0.791 Vali Loss: 1.085 Vali Acc: 0.675 Test Loss: 1.085 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 25 cost time: 0.48491477966308594
Epoch: 25, Steps: 3 | Train Loss: 0.713 Vali Loss: 1.065 Vali Acc: 0.675 Test Loss: 1.065 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 26 cost time: 0.4991741180419922
Epoch: 26, Steps: 3 | Train Loss: 0.710 Vali Loss: 1.044 Vali Acc: 0.700 Test Loss: 1.044 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699990).  Saving model ...
Epoch: 27 cost time: 0.545154333114624
Epoch: 27, Steps: 3 | Train Loss: 0.677 Vali Loss: 1.024 Vali Acc: 0.725 Test Loss: 1.024 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724990).  Saving model ...
Epoch: 28 cost time: 0.48665642738342285
Epoch: 28, Steps: 3 | Train Loss: 0.655 Vali Loss: 1.005 Vali Acc: 0.700 Test Loss: 1.005 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.4388606548309326
Epoch: 29, Steps: 3 | Train Loss: 0.641 Vali Loss: 0.984 Vali Acc: 0.700 Test Loss: 0.984 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.5783951282501221
Epoch: 30, Steps: 3 | Train Loss: 0.620 Vali Loss: 0.966 Vali Acc: 0.700 Test Loss: 0.966 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.555591344833374
Epoch: 31, Steps: 3 | Train Loss: 0.574 Vali Loss: 0.947 Vali Acc: 0.700 Test Loss: 0.947 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.5100803375244141
Epoch: 32, Steps: 3 | Train Loss: 0.556 Vali Loss: 0.929 Vali Acc: 0.700 Test Loss: 0.929 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.5112957954406738
Epoch: 33, Steps: 3 | Train Loss: 0.564 Vali Loss: 0.910 Vali Acc: 0.700 Test Loss: 0.910 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.4225904941558838
Epoch: 34, Steps: 3 | Train Loss: 0.530 Vali Loss: 0.892 Vali Acc: 0.725 Test Loss: 0.892 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724991).  Saving model ...
Epoch: 35 cost time: 0.47103261947631836
Epoch: 35, Steps: 3 | Train Loss: 0.505 Vali Loss: 0.875 Vali Acc: 0.725 Test Loss: 0.875 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 36 cost time: 0.5149943828582764
Epoch: 36, Steps: 3 | Train Loss: 0.480 Vali Loss: 0.859 Vali Acc: 0.725 Test Loss: 0.859 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 37 cost time: 0.5979189872741699
Epoch: 37, Steps: 3 | Train Loss: 0.485 Vali Loss: 0.843 Vali Acc: 0.725 Test Loss: 0.843 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724992).  Saving model ...
Epoch: 38 cost time: 0.472794771194458
Epoch: 38, Steps: 3 | Train Loss: 0.477 Vali Loss: 0.825 Vali Acc: 0.725 Test Loss: 0.825 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 39 cost time: 0.5632889270782471
Epoch: 39, Steps: 3 | Train Loss: 0.434 Vali Loss: 0.807 Vali Acc: 0.725 Test Loss: 0.807 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 40 cost time: 0.5241167545318604
Epoch: 40, Steps: 3 | Train Loss: 0.413 Vali Loss: 0.789 Vali Acc: 0.750 Test Loss: 0.789 Test Acc: 0.750
Validation loss decreased (-0.724992 --> -0.749992).  Saving model ...
Epoch: 41 cost time: 0.4954969882965088
Epoch: 41, Steps: 3 | Train Loss: 0.397 Vali Loss: 0.768 Vali Acc: 0.750 Test Loss: 0.768 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 42 cost time: 0.5922586917877197
Epoch: 42, Steps: 3 | Train Loss: 0.395 Vali Loss: 0.750 Vali Acc: 0.800 Test Loss: 0.750 Test Acc: 0.800
Validation loss decreased (-0.749992 --> -0.799993).  Saving model ...
Epoch: 43 cost time: 0.48200249671936035
Epoch: 43, Steps: 3 | Train Loss: 0.428 Vali Loss: 0.733 Vali Acc: 0.800 Test Loss: 0.733 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 44 cost time: 0.4952843189239502
Epoch: 44, Steps: 3 | Train Loss: 0.356 Vali Loss: 0.717 Vali Acc: 0.800 Test Loss: 0.717 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 45 cost time: 0.4650862216949463
Epoch: 45, Steps: 3 | Train Loss: 0.346 Vali Loss: 0.702 Vali Acc: 0.825 Test Loss: 0.702 Test Acc: 0.825
Validation loss decreased (-0.799993 --> -0.824993).  Saving model ...
Epoch: 46 cost time: 0.6961288452148438
Epoch: 46, Steps: 3 | Train Loss: 0.329 Vali Loss: 0.687 Vali Acc: 0.825 Test Loss: 0.687 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 47 cost time: 0.49143242835998535
Epoch: 47, Steps: 3 | Train Loss: 0.370 Vali Loss: 0.672 Vali Acc: 0.825 Test Loss: 0.672 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 48 cost time: 0.4667994976043701
Epoch: 48, Steps: 3 | Train Loss: 0.318 Vali Loss: 0.658 Vali Acc: 0.825 Test Loss: 0.658 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 49 cost time: 0.6762533187866211
Epoch: 49, Steps: 3 | Train Loss: 0.300 Vali Loss: 0.643 Vali Acc: 0.825 Test Loss: 0.643 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824994).  Saving model ...
Epoch: 50 cost time: 0.5273206233978271
Epoch: 50, Steps: 3 | Train Loss: 0.319 Vali Loss: 0.627 Vali Acc: 0.850 Test Loss: 0.627 Test Acc: 0.850
Validation loss decreased (-0.824994 --> -0.849994).  Saving model ...
Epoch: 51 cost time: 0.6203536987304688
Epoch: 51, Steps: 3 | Train Loss: 0.292 Vali Loss: 0.611 Vali Acc: 0.850 Test Loss: 0.611 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 52 cost time: 0.5500681400299072
Epoch: 52, Steps: 3 | Train Loss: 0.277 Vali Loss: 0.595 Vali Acc: 0.850 Test Loss: 0.595 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 53 cost time: 0.5151205062866211
Epoch: 53, Steps: 3 | Train Loss: 0.274 Vali Loss: 0.578 Vali Acc: 0.850 Test Loss: 0.578 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 54 cost time: 0.592740535736084
Epoch: 54, Steps: 3 | Train Loss: 0.272 Vali Loss: 0.562 Vali Acc: 0.850 Test Loss: 0.562 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 55 cost time: 0.48799872398376465
Epoch: 55, Steps: 3 | Train Loss: 0.239 Vali Loss: 0.546 Vali Acc: 0.875 Test Loss: 0.546 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874995).  Saving model ...
Epoch: 56 cost time: 0.5281543731689453
Epoch: 56, Steps: 3 | Train Loss: 0.231 Vali Loss: 0.529 Vali Acc: 0.875 Test Loss: 0.529 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 57 cost time: 0.49584054946899414
Epoch: 57, Steps: 3 | Train Loss: 0.256 Vali Loss: 0.511 Vali Acc: 0.875 Test Loss: 0.511 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 58 cost time: 0.5742454528808594
Epoch: 58, Steps: 3 | Train Loss: 0.214 Vali Loss: 0.495 Vali Acc: 0.875 Test Loss: 0.495 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 59 cost time: 0.4778015613555908
Epoch: 59, Steps: 3 | Train Loss: 0.210 Vali Loss: 0.478 Vali Acc: 0.875 Test Loss: 0.478 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 60 cost time: 0.5451321601867676
Epoch: 60, Steps: 3 | Train Loss: 0.198 Vali Loss: 0.462 Vali Acc: 0.875 Test Loss: 0.462 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 61 cost time: 0.5765244960784912
Epoch: 61, Steps: 3 | Train Loss: 0.192 Vali Loss: 0.445 Vali Acc: 0.875 Test Loss: 0.445 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 62 cost time: 0.4989900588989258
Epoch: 62, Steps: 3 | Train Loss: 0.179 Vali Loss: 0.428 Vali Acc: 0.875 Test Loss: 0.428 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 63 cost time: 0.525874137878418
Epoch: 63, Steps: 3 | Train Loss: 0.188 Vali Loss: 0.412 Vali Acc: 0.875 Test Loss: 0.412 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 64 cost time: 0.44652366638183594
Epoch: 64, Steps: 3 | Train Loss: 0.173 Vali Loss: 0.394 Vali Acc: 0.875 Test Loss: 0.394 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 65 cost time: 0.4549558162689209
Epoch: 65, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.375 Vali Acc: 0.875 Test Loss: 0.375 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 66 cost time: 0.44536828994750977
Epoch: 66, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.357 Vali Acc: 0.875 Test Loss: 0.357 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 67 cost time: 0.4167163372039795
Epoch: 67, Steps: 3 | Train Loss: 0.133 Vali Loss: 0.340 Vali Acc: 0.900 Test Loss: 0.340 Test Acc: 0.900
Validation loss decreased (-0.874996 --> -0.899997).  Saving model ...
Epoch: 68 cost time: 0.4582328796386719
Epoch: 68, Steps: 3 | Train Loss: 0.129 Vali Loss: 0.323 Vali Acc: 0.900 Test Loss: 0.323 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 69 cost time: 0.4916245937347412
Epoch: 69, Steps: 3 | Train Loss: 0.112 Vali Loss: 0.307 Vali Acc: 0.925 Test Loss: 0.307 Test Acc: 0.925
Validation loss decreased (-0.899997 --> -0.924997).  Saving model ...
Epoch: 70 cost time: 0.455092191696167
Epoch: 70, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.291 Vali Acc: 0.925 Test Loss: 0.291 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 71 cost time: 0.5097317695617676
Epoch: 71, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.274 Vali Acc: 0.925 Test Loss: 0.274 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 72 cost time: 0.5103600025177002
Epoch: 72, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.259 Vali Acc: 0.925 Test Loss: 0.259 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 73 cost time: 0.5424909591674805
Epoch: 73, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.245 Vali Acc: 0.925 Test Loss: 0.245 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924998).  Saving model ...
Epoch: 74 cost time: 0.45372962951660156
Epoch: 74, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.231 Vali Acc: 0.925 Test Loss: 0.231 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 75 cost time: 0.6316461563110352
Epoch: 75, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.219 Vali Acc: 0.925 Test Loss: 0.219 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 76 cost time: 0.49655580520629883
Epoch: 76, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.207 Vali Acc: 0.925 Test Loss: 0.207 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 77 cost time: 0.4984142780303955
Epoch: 77, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.197 Vali Acc: 0.925 Test Loss: 0.197 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 78 cost time: 0.43197131156921387
Epoch: 78, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.187 Vali Acc: 0.975 Test Loss: 0.187 Test Acc: 0.975
Validation loss decreased (-0.924998 --> -0.974998).  Saving model ...
Epoch: 79 cost time: 0.560570478439331
Epoch: 79, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.178 Vali Acc: 0.975 Test Loss: 0.178 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 80 cost time: 0.5616660118103027
Epoch: 80, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.170 Vali Acc: 0.975 Test Loss: 0.170 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 81 cost time: 0.44364142417907715
Epoch: 81, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.163 Vali Acc: 0.975 Test Loss: 0.163 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 82 cost time: 0.508641242980957
Epoch: 82, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.156 Vali Acc: 1.000 Test Loss: 0.156 Test Acc: 1.000
Validation loss decreased (-0.974998 --> -0.999998).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm64_cs25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 15944
model size : 0.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm64_cs20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7111802101135254
Epoch: 1, Steps: 3 | Train Loss: 1.391 Vali Loss: 1.501 Vali Acc: 0.275 Test Loss: 1.501 Test Acc: 0.275
Validation loss decreased (inf --> -0.274985).  Saving model ...
Epoch: 2 cost time: 0.5314249992370605
Epoch: 2, Steps: 3 | Train Loss: 1.415 Vali Loss: 1.493 Vali Acc: 0.275 Test Loss: 1.493 Test Acc: 0.275
Validation loss decreased (-0.274985 --> -0.274985).  Saving model ...
Epoch: 3 cost time: 0.4714388847351074
Epoch: 3, Steps: 3 | Train Loss: 1.381 Vali Loss: 1.485 Vali Acc: 0.275 Test Loss: 1.485 Test Acc: 0.275
Validation loss decreased (-0.274985 --> -0.274985).  Saving model ...
Epoch: 4 cost time: 0.4558119773864746
Epoch: 4, Steps: 3 | Train Loss: 1.343 Vali Loss: 1.476 Vali Acc: 0.300 Test Loss: 1.476 Test Acc: 0.300
Validation loss decreased (-0.274985 --> -0.299985).  Saving model ...
Epoch: 5 cost time: 0.5394647121429443
Epoch: 5, Steps: 3 | Train Loss: 1.309 Vali Loss: 1.464 Vali Acc: 0.325 Test Loss: 1.464 Test Acc: 0.325
Validation loss decreased (-0.299985 --> -0.324985).  Saving model ...
Epoch: 6 cost time: 0.45565271377563477
Epoch: 6, Steps: 3 | Train Loss: 1.295 Vali Loss: 1.452 Vali Acc: 0.350 Test Loss: 1.452 Test Acc: 0.350
Validation loss decreased (-0.324985 --> -0.349985).  Saving model ...
Epoch: 7 cost time: 0.45614147186279297
Epoch: 7, Steps: 3 | Train Loss: 1.286 Vali Loss: 1.438 Vali Acc: 0.350 Test Loss: 1.438 Test Acc: 0.350
Validation loss decreased (-0.349985 --> -0.349986).  Saving model ...
Epoch: 8 cost time: 0.5367820262908936
Epoch: 8, Steps: 3 | Train Loss: 1.255 Vali Loss: 1.423 Vali Acc: 0.300 Test Loss: 1.423 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5153069496154785
Epoch: 9, Steps: 3 | Train Loss: 1.224 Vali Loss: 1.407 Vali Acc: 0.300 Test Loss: 1.407 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.48783063888549805
Epoch: 10, Steps: 3 | Train Loss: 1.198 Vali Loss: 1.389 Vali Acc: 0.300 Test Loss: 1.389 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5349674224853516
Epoch: 11, Steps: 3 | Train Loss: 1.131 Vali Loss: 1.371 Vali Acc: 0.300 Test Loss: 1.371 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.5632045269012451
Epoch: 12, Steps: 3 | Train Loss: 1.123 Vali Loss: 1.353 Vali Acc: 0.300 Test Loss: 1.353 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.45328521728515625
Epoch: 13, Steps: 3 | Train Loss: 1.096 Vali Loss: 1.334 Vali Acc: 0.300 Test Loss: 1.334 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.5697224140167236
Epoch: 14, Steps: 3 | Train Loss: 1.055 Vali Loss: 1.314 Vali Acc: 0.300 Test Loss: 1.314 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.5273535251617432
Epoch: 15, Steps: 3 | Train Loss: 1.043 Vali Loss: 1.295 Vali Acc: 0.300 Test Loss: 1.295 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.4919595718383789
Epoch: 16, Steps: 3 | Train Loss: 1.003 Vali Loss: 1.276 Vali Acc: 0.350 Test Loss: 1.276 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349987).  Saving model ...
Epoch: 17 cost time: 0.43483877182006836
Epoch: 17, Steps: 3 | Train Loss: 0.989 Vali Loss: 1.257 Vali Acc: 0.375 Test Loss: 1.257 Test Acc: 0.375
Validation loss decreased (-0.349987 --> -0.374987).  Saving model ...
Epoch: 18 cost time: 0.4539201259613037
Epoch: 18, Steps: 3 | Train Loss: 0.927 Vali Loss: 1.237 Vali Acc: 0.425 Test Loss: 1.237 Test Acc: 0.425
Validation loss decreased (-0.374987 --> -0.424988).  Saving model ...
Epoch: 19 cost time: 0.5469362735748291
Epoch: 19, Steps: 3 | Train Loss: 0.898 Vali Loss: 1.216 Vali Acc: 0.425 Test Loss: 1.216 Test Acc: 0.425
Validation loss decreased (-0.424988 --> -0.424988).  Saving model ...
Epoch: 20 cost time: 0.4460935592651367
Epoch: 20, Steps: 3 | Train Loss: 0.874 Vali Loss: 1.195 Vali Acc: 0.475 Test Loss: 1.195 Test Acc: 0.475
Validation loss decreased (-0.424988 --> -0.474988).  Saving model ...
Epoch: 21 cost time: 0.5337634086608887
Epoch: 21, Steps: 3 | Train Loss: 0.829 Vali Loss: 1.175 Vali Acc: 0.525 Test Loss: 1.175 Test Acc: 0.525
Validation loss decreased (-0.474988 --> -0.524988).  Saving model ...
Epoch: 22 cost time: 0.4908106327056885
Epoch: 22, Steps: 3 | Train Loss: 0.778 Vali Loss: 1.156 Vali Acc: 0.525 Test Loss: 1.156 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 23 cost time: 0.47767043113708496
Epoch: 23, Steps: 3 | Train Loss: 0.770 Vali Loss: 1.137 Vali Acc: 0.550 Test Loss: 1.137 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549989).  Saving model ...
Epoch: 24 cost time: 0.5488920211791992
Epoch: 24, Steps: 3 | Train Loss: 0.739 Vali Loss: 1.119 Vali Acc: 0.550 Test Loss: 1.119 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 25 cost time: 0.44747209548950195
Epoch: 25, Steps: 3 | Train Loss: 0.737 Vali Loss: 1.101 Vali Acc: 0.575 Test Loss: 1.101 Test Acc: 0.575
Validation loss decreased (-0.549989 --> -0.574989).  Saving model ...
Epoch: 26 cost time: 0.5653281211853027
Epoch: 26, Steps: 3 | Train Loss: 0.693 Vali Loss: 1.084 Vali Acc: 0.625 Test Loss: 1.084 Test Acc: 0.625
Validation loss decreased (-0.574989 --> -0.624989).  Saving model ...
Epoch: 27 cost time: 0.45301079750061035
Epoch: 27, Steps: 3 | Train Loss: 0.657 Vali Loss: 1.067 Vali Acc: 0.625 Test Loss: 1.067 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 28 cost time: 0.5000004768371582
Epoch: 28, Steps: 3 | Train Loss: 0.613 Vali Loss: 1.050 Vali Acc: 0.625 Test Loss: 1.050 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 29 cost time: 0.5316576957702637
Epoch: 29, Steps: 3 | Train Loss: 0.645 Vali Loss: 1.034 Vali Acc: 0.675 Test Loss: 1.034 Test Acc: 0.675
Validation loss decreased (-0.624989 --> -0.674990).  Saving model ...
Epoch: 30 cost time: 0.4304201602935791
Epoch: 30, Steps: 3 | Train Loss: 0.595 Vali Loss: 1.018 Vali Acc: 0.675 Test Loss: 1.018 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 31 cost time: 0.5446696281433105
Epoch: 31, Steps: 3 | Train Loss: 0.571 Vali Loss: 1.002 Vali Acc: 0.675 Test Loss: 1.002 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 32 cost time: 0.47055530548095703
Epoch: 32, Steps: 3 | Train Loss: 0.559 Vali Loss: 0.987 Vali Acc: 0.675 Test Loss: 0.987 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 33 cost time: 0.5041821002960205
Epoch: 33, Steps: 3 | Train Loss: 0.544 Vali Loss: 0.973 Vali Acc: 0.650 Test Loss: 0.973 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.49962425231933594
Epoch: 34, Steps: 3 | Train Loss: 0.533 Vali Loss: 0.960 Vali Acc: 0.650 Test Loss: 0.960 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.47179365158081055
Epoch: 35, Steps: 3 | Train Loss: 0.494 Vali Loss: 0.947 Vali Acc: 0.675 Test Loss: 0.947 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674991).  Saving model ...
Epoch: 36 cost time: 0.5052871704101562
Epoch: 36, Steps: 3 | Train Loss: 0.500 Vali Loss: 0.935 Vali Acc: 0.675 Test Loss: 0.935 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 37 cost time: 0.43031954765319824
Epoch: 37, Steps: 3 | Train Loss: 0.466 Vali Loss: 0.924 Vali Acc: 0.675 Test Loss: 0.924 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 38 cost time: 0.5408000946044922
Epoch: 38, Steps: 3 | Train Loss: 0.463 Vali Loss: 0.913 Vali Acc: 0.700 Test Loss: 0.913 Test Acc: 0.700
Validation loss decreased (-0.674991 --> -0.699991).  Saving model ...
Epoch: 39 cost time: 0.5524649620056152
Epoch: 39, Steps: 3 | Train Loss: 0.453 Vali Loss: 0.902 Vali Acc: 0.700 Test Loss: 0.902 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 40 cost time: 0.5412189960479736
Epoch: 40, Steps: 3 | Train Loss: 0.436 Vali Loss: 0.892 Vali Acc: 0.700 Test Loss: 0.892 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 41 cost time: 0.45104146003723145
Epoch: 41, Steps: 3 | Train Loss: 0.406 Vali Loss: 0.882 Vali Acc: 0.700 Test Loss: 0.882 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 42 cost time: 0.4745323657989502
Epoch: 42, Steps: 3 | Train Loss: 0.418 Vali Loss: 0.873 Vali Acc: 0.725 Test Loss: 0.873 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724991).  Saving model ...
Epoch: 43 cost time: 0.5183296203613281
Epoch: 43, Steps: 3 | Train Loss: 0.390 Vali Loss: 0.866 Vali Acc: 0.725 Test Loss: 0.866 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 44 cost time: 0.4269258975982666
Epoch: 44, Steps: 3 | Train Loss: 0.382 Vali Loss: 0.858 Vali Acc: 0.725 Test Loss: 0.858 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 45 cost time: 0.49834632873535156
Epoch: 45, Steps: 3 | Train Loss: 0.360 Vali Loss: 0.850 Vali Acc: 0.725 Test Loss: 0.850 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 46 cost time: 0.5153830051422119
Epoch: 46, Steps: 3 | Train Loss: 0.340 Vali Loss: 0.843 Vali Acc: 0.725 Test Loss: 0.843 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724992).  Saving model ...
Epoch: 47 cost time: 0.474912166595459
Epoch: 47, Steps: 3 | Train Loss: 0.381 Vali Loss: 0.836 Vali Acc: 0.750 Test Loss: 0.836 Test Acc: 0.750
Validation loss decreased (-0.724992 --> -0.749992).  Saving model ...
Epoch: 48 cost time: 0.4634988307952881
Epoch: 48, Steps: 3 | Train Loss: 0.328 Vali Loss: 0.830 Vali Acc: 0.750 Test Loss: 0.830 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 49 cost time: 0.47811174392700195
Epoch: 49, Steps: 3 | Train Loss: 0.359 Vali Loss: 0.824 Vali Acc: 0.725 Test Loss: 0.824 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.5563311576843262
Epoch: 50, Steps: 3 | Train Loss: 0.357 Vali Loss: 0.818 Vali Acc: 0.750 Test Loss: 0.818 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 51 cost time: 0.5022215843200684
Epoch: 51, Steps: 3 | Train Loss: 0.297 Vali Loss: 0.812 Vali Acc: 0.775 Test Loss: 0.812 Test Acc: 0.775
Validation loss decreased (-0.749992 --> -0.774992).  Saving model ...
Epoch: 52 cost time: 0.48024487495422363
Epoch: 52, Steps: 3 | Train Loss: 0.325 Vali Loss: 0.807 Vali Acc: 0.775 Test Loss: 0.807 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 53 cost time: 0.4582388401031494
Epoch: 53, Steps: 3 | Train Loss: 0.289 Vali Loss: 0.800 Vali Acc: 0.775 Test Loss: 0.800 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 54 cost time: 0.5476529598236084
Epoch: 54, Steps: 3 | Train Loss: 0.287 Vali Loss: 0.794 Vali Acc: 0.800 Test Loss: 0.794 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799992).  Saving model ...
Epoch: 55 cost time: 0.46405482292175293
Epoch: 55, Steps: 3 | Train Loss: 0.265 Vali Loss: 0.790 Vali Acc: 0.825 Test Loss: 0.790 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824992).  Saving model ...
Epoch: 56 cost time: 0.5127434730529785
Epoch: 56, Steps: 3 | Train Loss: 0.263 Vali Loss: 0.784 Vali Acc: 0.825 Test Loss: 0.784 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 57 cost time: 0.5273606777191162
Epoch: 57, Steps: 3 | Train Loss: 0.247 Vali Loss: 0.780 Vali Acc: 0.825 Test Loss: 0.780 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 58 cost time: 0.48560547828674316
Epoch: 58, Steps: 3 | Train Loss: 0.285 Vali Loss: 0.774 Vali Acc: 0.825 Test Loss: 0.774 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 59 cost time: 0.5684309005737305
Epoch: 59, Steps: 3 | Train Loss: 0.250 Vali Loss: 0.769 Vali Acc: 0.825 Test Loss: 0.769 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 60 cost time: 0.5882155895233154
Epoch: 60, Steps: 3 | Train Loss: 0.240 Vali Loss: 0.764 Vali Acc: 0.825 Test Loss: 0.764 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 61 cost time: 0.4382474422454834
Epoch: 61, Steps: 3 | Train Loss: 0.254 Vali Loss: 0.758 Vali Acc: 0.825 Test Loss: 0.758 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 62 cost time: 0.4763197898864746
Epoch: 62, Steps: 3 | Train Loss: 0.231 Vali Loss: 0.752 Vali Acc: 0.825 Test Loss: 0.752 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 63 cost time: 0.47689080238342285
Epoch: 63, Steps: 3 | Train Loss: 0.218 Vali Loss: 0.744 Vali Acc: 0.825 Test Loss: 0.744 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824993).  Saving model ...
Epoch: 64 cost time: 0.48567676544189453
Epoch: 64, Steps: 3 | Train Loss: 0.198 Vali Loss: 0.737 Vali Acc: 0.825 Test Loss: 0.737 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 65 cost time: 0.432598352432251
Epoch: 65, Steps: 3 | Train Loss: 0.216 Vali Loss: 0.730 Vali Acc: 0.825 Test Loss: 0.730 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 66 cost time: 0.5530796051025391
Epoch: 66, Steps: 3 | Train Loss: 0.181 Vali Loss: 0.721 Vali Acc: 0.825 Test Loss: 0.721 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 67 cost time: 0.7353484630584717
Epoch: 67, Steps: 3 | Train Loss: 0.201 Vali Loss: 0.712 Vali Acc: 0.850 Test Loss: 0.712 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849993).  Saving model ...
Epoch: 68 cost time: 0.4753413200378418
Epoch: 68, Steps: 3 | Train Loss: 0.196 Vali Loss: 0.706 Vali Acc: 0.850 Test Loss: 0.706 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 69 cost time: 0.505964994430542
Epoch: 69, Steps: 3 | Train Loss: 0.199 Vali Loss: 0.701 Vali Acc: 0.875 Test Loss: 0.701 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874993).  Saving model ...
Epoch: 70 cost time: 0.5245885848999023
Epoch: 70, Steps: 3 | Train Loss: 0.183 Vali Loss: 0.695 Vali Acc: 0.875 Test Loss: 0.695 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 71 cost time: 0.4031510353088379
Epoch: 71, Steps: 3 | Train Loss: 0.177 Vali Loss: 0.687 Vali Acc: 0.875 Test Loss: 0.687 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 72 cost time: 0.4365730285644531
Epoch: 72, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.678 Vali Acc: 0.875 Test Loss: 0.678 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 73 cost time: 0.41858458518981934
Epoch: 73, Steps: 3 | Train Loss: 0.150 Vali Loss: 0.670 Vali Acc: 0.875 Test Loss: 0.670 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 74 cost time: 0.5510094165802002
Epoch: 74, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.662 Vali Acc: 0.875 Test Loss: 0.662 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 75 cost time: 0.5088808536529541
Epoch: 75, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.655 Vali Acc: 0.875 Test Loss: 0.655 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 76 cost time: 0.42032647132873535
Epoch: 76, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.650 Vali Acc: 0.875 Test Loss: 0.650 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 77 cost time: 0.39282989501953125
Epoch: 77, Steps: 3 | Train Loss: 0.121 Vali Loss: 0.644 Vali Acc: 0.875 Test Loss: 0.644 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 78 cost time: 0.40851688385009766
Epoch: 78, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.637 Vali Acc: 0.875 Test Loss: 0.637 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 79 cost time: 0.41931605339050293
Epoch: 79, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.629 Vali Acc: 0.875 Test Loss: 0.629 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 80 cost time: 0.5100324153900146
Epoch: 80, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.617 Vali Acc: 0.875 Test Loss: 0.617 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 81 cost time: 0.5155677795410156
Epoch: 81, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.605 Vali Acc: 0.875 Test Loss: 0.605 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 82 cost time: 0.5185296535491943
Epoch: 82, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.597 Vali Acc: 0.875 Test Loss: 0.597 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 83 cost time: 0.47750186920166016
Epoch: 83, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.591 Vali Acc: 0.875 Test Loss: 0.591 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 84 cost time: 0.48854923248291016
Epoch: 84, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.583 Vali Acc: 0.875 Test Loss: 0.583 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 85 cost time: 0.6703102588653564
Epoch: 85, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.578 Vali Acc: 0.900 Test Loss: 0.578 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899994).  Saving model ...
Epoch: 86 cost time: 0.5505564212799072
Epoch: 86, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.574 Vali Acc: 0.900 Test Loss: 0.574 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 87 cost time: 0.5820088386535645
Epoch: 87, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.571 Vali Acc: 0.900 Test Loss: 0.571 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 88 cost time: 0.5239033699035645
Epoch: 88, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.570 Vali Acc: 0.900 Test Loss: 0.570 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 89 cost time: 0.6460599899291992
Epoch: 89, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.572 Vali Acc: 0.900 Test Loss: 0.572 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 0.6576404571533203
Epoch: 90, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.573 Vali Acc: 0.900 Test Loss: 0.573 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 91 cost time: 0.5664339065551758
Epoch: 91, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.575 Vali Acc: 0.900 Test Loss: 0.575 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 92 cost time: 0.6569035053253174
Epoch: 92, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.576 Vali Acc: 0.900 Test Loss: 0.576 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 93 cost time: 0.551957368850708
Epoch: 93, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.578 Vali Acc: 0.900 Test Loss: 0.578 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 94 cost time: 0.7927055358886719
Epoch: 94, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.582 Vali Acc: 0.900 Test Loss: 0.582 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 95 cost time: 0.6022615432739258
Epoch: 95, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.587 Vali Acc: 0.900 Test Loss: 0.587 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 96 cost time: 0.5620677471160889
Epoch: 96, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.591 Vali Acc: 0.900 Test Loss: 0.591 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 97 cost time: 0.5213966369628906
Epoch: 97, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.596 Vali Acc: 0.900 Test Loss: 0.596 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 98 cost time: 0.5390710830688477
Epoch: 98, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.603 Vali Acc: 0.900 Test Loss: 0.603 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm64_cs20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 15806
model size : 0.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm64_cs17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7460267543792725
Epoch: 1, Steps: 3 | Train Loss: 1.342 Vali Loss: 1.325 Vali Acc: 0.250 Test Loss: 1.325 Test Acc: 0.250
Validation loss decreased (inf --> -0.249987).  Saving model ...
Epoch: 2 cost time: 0.48964834213256836
Epoch: 2, Steps: 3 | Train Loss: 1.316 Vali Loss: 1.319 Vali Acc: 0.250 Test Loss: 1.319 Test Acc: 0.250
Validation loss decreased (-0.249987 --> -0.249987).  Saving model ...
Epoch: 3 cost time: 0.4756317138671875
Epoch: 3, Steps: 3 | Train Loss: 1.298 Vali Loss: 1.313 Vali Acc: 0.250 Test Loss: 1.313 Test Acc: 0.250
Validation loss decreased (-0.249987 --> -0.249987).  Saving model ...
Epoch: 4 cost time: 0.5516259670257568
Epoch: 4, Steps: 3 | Train Loss: 1.290 Vali Loss: 1.305 Vali Acc: 0.250 Test Loss: 1.305 Test Acc: 0.250
Validation loss decreased (-0.249987 --> -0.249987).  Saving model ...
Epoch: 5 cost time: 0.39624953269958496
Epoch: 5, Steps: 3 | Train Loss: 1.282 Vali Loss: 1.296 Vali Acc: 0.250 Test Loss: 1.296 Test Acc: 0.250
Validation loss decreased (-0.249987 --> -0.249987).  Saving model ...
Epoch: 6 cost time: 0.40080976486206055
Epoch: 6, Steps: 3 | Train Loss: 1.229 Vali Loss: 1.285 Vali Acc: 0.275 Test Loss: 1.285 Test Acc: 0.275
Validation loss decreased (-0.249987 --> -0.274987).  Saving model ...
Epoch: 7 cost time: 0.6794471740722656
Epoch: 7, Steps: 3 | Train Loss: 1.238 Vali Loss: 1.274 Vali Acc: 0.375 Test Loss: 1.274 Test Acc: 0.375
Validation loss decreased (-0.274987 --> -0.374987).  Saving model ...
Epoch: 8 cost time: 0.44954419136047363
Epoch: 8, Steps: 3 | Train Loss: 1.182 Vali Loss: 1.262 Vali Acc: 0.400 Test Loss: 1.262 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399987).  Saving model ...
Epoch: 9 cost time: 0.4096086025238037
Epoch: 9, Steps: 3 | Train Loss: 1.203 Vali Loss: 1.251 Vali Acc: 0.450 Test Loss: 1.251 Test Acc: 0.450
Validation loss decreased (-0.399987 --> -0.449987).  Saving model ...
Epoch: 10 cost time: 0.5125529766082764
Epoch: 10, Steps: 3 | Train Loss: 1.146 Vali Loss: 1.238 Vali Acc: 0.475 Test Loss: 1.238 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474988).  Saving model ...
Epoch: 11 cost time: 0.4866831302642822
Epoch: 11, Steps: 3 | Train Loss: 1.131 Vali Loss: 1.225 Vali Acc: 0.575 Test Loss: 1.225 Test Acc: 0.575
Validation loss decreased (-0.474988 --> -0.574988).  Saving model ...
Epoch: 12 cost time: 0.44696569442749023
Epoch: 12, Steps: 3 | Train Loss: 1.085 Vali Loss: 1.211 Vali Acc: 0.650 Test Loss: 1.211 Test Acc: 0.650
Validation loss decreased (-0.574988 --> -0.649988).  Saving model ...
Epoch: 13 cost time: 0.456834077835083
Epoch: 13, Steps: 3 | Train Loss: 1.064 Vali Loss: 1.197 Vali Acc: 0.700 Test Loss: 1.197 Test Acc: 0.700
Validation loss decreased (-0.649988 --> -0.699988).  Saving model ...
Epoch: 14 cost time: 0.46975207328796387
Epoch: 14, Steps: 3 | Train Loss: 1.027 Vali Loss: 1.182 Vali Acc: 0.725 Test Loss: 1.182 Test Acc: 0.725
Validation loss decreased (-0.699988 --> -0.724988).  Saving model ...
Epoch: 15 cost time: 0.5004293918609619
Epoch: 15, Steps: 3 | Train Loss: 1.004 Vali Loss: 1.168 Vali Acc: 0.725 Test Loss: 1.168 Test Acc: 0.725
Validation loss decreased (-0.724988 --> -0.724988).  Saving model ...
Epoch: 16 cost time: 0.4793894290924072
Epoch: 16, Steps: 3 | Train Loss: 0.986 Vali Loss: 1.153 Vali Acc: 0.750 Test Loss: 1.153 Test Acc: 0.750
Validation loss decreased (-0.724988 --> -0.749988).  Saving model ...
Epoch: 17 cost time: 0.5466787815093994
Epoch: 17, Steps: 3 | Train Loss: 0.914 Vali Loss: 1.138 Vali Acc: 0.775 Test Loss: 1.138 Test Acc: 0.775
Validation loss decreased (-0.749988 --> -0.774989).  Saving model ...
Epoch: 18 cost time: 0.5197365283966064
Epoch: 18, Steps: 3 | Train Loss: 0.884 Vali Loss: 1.122 Vali Acc: 0.800 Test Loss: 1.122 Test Acc: 0.800
Validation loss decreased (-0.774989 --> -0.799989).  Saving model ...
Epoch: 19 cost time: 0.41814446449279785
Epoch: 19, Steps: 3 | Train Loss: 0.879 Vali Loss: 1.106 Vali Acc: 0.800 Test Loss: 1.106 Test Acc: 0.800
Validation loss decreased (-0.799989 --> -0.799989).  Saving model ...
Epoch: 20 cost time: 0.48497509956359863
Epoch: 20, Steps: 3 | Train Loss: 0.857 Vali Loss: 1.090 Vali Acc: 0.800 Test Loss: 1.090 Test Acc: 0.800
Validation loss decreased (-0.799989 --> -0.799989).  Saving model ...
Epoch: 21 cost time: 0.46471428871154785
Epoch: 21, Steps: 3 | Train Loss: 0.831 Vali Loss: 1.074 Vali Acc: 0.800 Test Loss: 1.074 Test Acc: 0.800
Validation loss decreased (-0.799989 --> -0.799989).  Saving model ...
Epoch: 22 cost time: 0.4913954734802246
Epoch: 22, Steps: 3 | Train Loss: 0.770 Vali Loss: 1.059 Vali Acc: 0.800 Test Loss: 1.059 Test Acc: 0.800
Validation loss decreased (-0.799989 --> -0.799989).  Saving model ...
Epoch: 23 cost time: 0.41805338859558105
Epoch: 23, Steps: 3 | Train Loss: 0.768 Vali Loss: 1.043 Vali Acc: 0.800 Test Loss: 1.043 Test Acc: 0.800
Validation loss decreased (-0.799989 --> -0.799990).  Saving model ...
Epoch: 24 cost time: 0.47911643981933594
Epoch: 24, Steps: 3 | Train Loss: 0.735 Vali Loss: 1.026 Vali Acc: 0.800 Test Loss: 1.026 Test Acc: 0.800
Validation loss decreased (-0.799990 --> -0.799990).  Saving model ...
Epoch: 25 cost time: 0.6117062568664551
Epoch: 25, Steps: 3 | Train Loss: 0.751 Vali Loss: 1.010 Vali Acc: 0.800 Test Loss: 1.010 Test Acc: 0.800
Validation loss decreased (-0.799990 --> -0.799990).  Saving model ...
Epoch: 26 cost time: 0.45369505882263184
Epoch: 26, Steps: 3 | Train Loss: 0.667 Vali Loss: 0.995 Vali Acc: 0.825 Test Loss: 0.995 Test Acc: 0.825
Validation loss decreased (-0.799990 --> -0.824990).  Saving model ...
Epoch: 27 cost time: 0.6457245349884033
Epoch: 27, Steps: 3 | Train Loss: 0.680 Vali Loss: 0.980 Vali Acc: 0.850 Test Loss: 0.980 Test Acc: 0.850
Validation loss decreased (-0.824990 --> -0.849990).  Saving model ...
Epoch: 28 cost time: 0.5086402893066406
Epoch: 28, Steps: 3 | Train Loss: 0.641 Vali Loss: 0.965 Vali Acc: 0.850 Test Loss: 0.965 Test Acc: 0.850
Validation loss decreased (-0.849990 --> -0.849990).  Saving model ...
Epoch: 29 cost time: 0.4672386646270752
Epoch: 29, Steps: 3 | Train Loss: 0.619 Vali Loss: 0.950 Vali Acc: 0.850 Test Loss: 0.950 Test Acc: 0.850
Validation loss decreased (-0.849990 --> -0.849990).  Saving model ...
Epoch: 30 cost time: 0.4755995273590088
Epoch: 30, Steps: 3 | Train Loss: 0.618 Vali Loss: 0.935 Vali Acc: 0.850 Test Loss: 0.935 Test Acc: 0.850
Validation loss decreased (-0.849990 --> -0.849991).  Saving model ...
Epoch: 31 cost time: 0.4679262638092041
Epoch: 31, Steps: 3 | Train Loss: 0.587 Vali Loss: 0.920 Vali Acc: 0.850 Test Loss: 0.920 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849991).  Saving model ...
Epoch: 32 cost time: 0.4990990161895752
Epoch: 32, Steps: 3 | Train Loss: 0.550 Vali Loss: 0.907 Vali Acc: 0.850 Test Loss: 0.907 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849991).  Saving model ...
Epoch: 33 cost time: 0.3826026916503906
Epoch: 33, Steps: 3 | Train Loss: 0.535 Vali Loss: 0.893 Vali Acc: 0.825 Test Loss: 0.893 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5000877380371094
Epoch: 34, Steps: 3 | Train Loss: 0.551 Vali Loss: 0.880 Vali Acc: 0.825 Test Loss: 0.880 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.4815800189971924
Epoch: 35, Steps: 3 | Train Loss: 0.514 Vali Loss: 0.868 Vali Acc: 0.825 Test Loss: 0.868 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.4987664222717285
Epoch: 36, Steps: 3 | Train Loss: 0.494 Vali Loss: 0.855 Vali Acc: 0.800 Test Loss: 0.855 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.3814094066619873
Epoch: 37, Steps: 3 | Train Loss: 0.471 Vali Loss: 0.844 Vali Acc: 0.800 Test Loss: 0.844 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.47437596321105957
Epoch: 38, Steps: 3 | Train Loss: 0.472 Vali Loss: 0.834 Vali Acc: 0.800 Test Loss: 0.834 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.5845062732696533
Epoch: 39, Steps: 3 | Train Loss: 0.464 Vali Loss: 0.823 Vali Acc: 0.800 Test Loss: 0.823 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.4284496307373047
Epoch: 40, Steps: 3 | Train Loss: 0.424 Vali Loss: 0.812 Vali Acc: 0.775 Test Loss: 0.812 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.5632510185241699
Epoch: 41, Steps: 3 | Train Loss: 0.407 Vali Loss: 0.801 Vali Acc: 0.800 Test Loss: 0.801 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.5781512260437012
Epoch: 42, Steps: 3 | Train Loss: 0.394 Vali Loss: 0.790 Vali Acc: 0.800 Test Loss: 0.790 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm64_cs17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.85
model parameter : 15936
model size : 0.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm64_cs15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7473511695861816
Epoch: 1, Steps: 3 | Train Loss: 1.443 Vali Loss: 1.379 Vali Acc: 0.400 Test Loss: 1.379 Test Acc: 0.400
Validation loss decreased (inf --> -0.399986).  Saving model ...
Epoch: 2 cost time: 0.5486359596252441
Epoch: 2, Steps: 3 | Train Loss: 1.400 Vali Loss: 1.373 Vali Acc: 0.425 Test Loss: 1.373 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424986).  Saving model ...
Epoch: 3 cost time: 0.5001366138458252
Epoch: 3, Steps: 3 | Train Loss: 1.403 Vali Loss: 1.368 Vali Acc: 0.425 Test Loss: 1.368 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424986).  Saving model ...
Epoch: 4 cost time: 0.7054221630096436
Epoch: 4, Steps: 3 | Train Loss: 1.389 Vali Loss: 1.362 Vali Acc: 0.425 Test Loss: 1.362 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424986).  Saving model ...
Epoch: 5 cost time: 0.603111743927002
Epoch: 5, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.354 Vali Acc: 0.450 Test Loss: 1.354 Test Acc: 0.450
Validation loss decreased (-0.424986 --> -0.449986).  Saving model ...
Epoch: 6 cost time: 0.535820722579956
Epoch: 6, Steps: 3 | Train Loss: 1.351 Vali Loss: 1.345 Vali Acc: 0.450 Test Loss: 1.345 Test Acc: 0.450
Validation loss decreased (-0.449986 --> -0.449987).  Saving model ...
Epoch: 7 cost time: 0.6583940982818604
Epoch: 7, Steps: 3 | Train Loss: 1.304 Vali Loss: 1.336 Vali Acc: 0.425 Test Loss: 1.336 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.48517656326293945
Epoch: 8, Steps: 3 | Train Loss: 1.297 Vali Loss: 1.326 Vali Acc: 0.450 Test Loss: 1.326 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 9 cost time: 0.4900946617126465
Epoch: 9, Steps: 3 | Train Loss: 1.246 Vali Loss: 1.315 Vali Acc: 0.475 Test Loss: 1.315 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474987).  Saving model ...
Epoch: 10 cost time: 0.4747128486633301
Epoch: 10, Steps: 3 | Train Loss: 1.263 Vali Loss: 1.303 Vali Acc: 0.475 Test Loss: 1.303 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 11 cost time: 0.5145962238311768
Epoch: 11, Steps: 3 | Train Loss: 1.209 Vali Loss: 1.290 Vali Acc: 0.500 Test Loss: 1.290 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499987).  Saving model ...
Epoch: 12 cost time: 0.5367152690887451
Epoch: 12, Steps: 3 | Train Loss: 1.185 Vali Loss: 1.276 Vali Acc: 0.500 Test Loss: 1.276 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 13 cost time: 0.47882676124572754
Epoch: 13, Steps: 3 | Train Loss: 1.120 Vali Loss: 1.262 Vali Acc: 0.525 Test Loss: 1.262 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524987).  Saving model ...
Epoch: 14 cost time: 0.5174624919891357
Epoch: 14, Steps: 3 | Train Loss: 1.114 Vali Loss: 1.247 Vali Acc: 0.500 Test Loss: 1.247 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.545626163482666
Epoch: 15, Steps: 3 | Train Loss: 1.073 Vali Loss: 1.233 Vali Acc: 0.500 Test Loss: 1.233 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.4696023464202881
Epoch: 16, Steps: 3 | Train Loss: 1.075 Vali Loss: 1.219 Vali Acc: 0.600 Test Loss: 1.219 Test Acc: 0.600
Validation loss decreased (-0.524987 --> -0.599988).  Saving model ...
Epoch: 17 cost time: 0.6230199337005615
Epoch: 17, Steps: 3 | Train Loss: 1.028 Vali Loss: 1.204 Vali Acc: 0.625 Test Loss: 1.204 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624988).  Saving model ...
Epoch: 18 cost time: 0.6084260940551758
Epoch: 18, Steps: 3 | Train Loss: 1.011 Vali Loss: 1.189 Vali Acc: 0.625 Test Loss: 1.189 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 19 cost time: 0.5151607990264893
Epoch: 19, Steps: 3 | Train Loss: 0.981 Vali Loss: 1.174 Vali Acc: 0.625 Test Loss: 1.174 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 20 cost time: 0.5540170669555664
Epoch: 20, Steps: 3 | Train Loss: 0.912 Vali Loss: 1.158 Vali Acc: 0.625 Test Loss: 1.158 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 21 cost time: 0.5288355350494385
Epoch: 21, Steps: 3 | Train Loss: 0.864 Vali Loss: 1.142 Vali Acc: 0.625 Test Loss: 1.142 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624989).  Saving model ...
Epoch: 22 cost time: 0.4853951930999756
Epoch: 22, Steps: 3 | Train Loss: 0.892 Vali Loss: 1.127 Vali Acc: 0.625 Test Loss: 1.127 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 23 cost time: 0.5440905094146729
Epoch: 23, Steps: 3 | Train Loss: 0.812 Vali Loss: 1.111 Vali Acc: 0.650 Test Loss: 1.111 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 24 cost time: 0.43763136863708496
Epoch: 24, Steps: 3 | Train Loss: 0.845 Vali Loss: 1.096 Vali Acc: 0.650 Test Loss: 1.096 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 25 cost time: 0.5067987442016602
Epoch: 25, Steps: 3 | Train Loss: 0.805 Vali Loss: 1.080 Vali Acc: 0.675 Test Loss: 1.080 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674989).  Saving model ...
Epoch: 26 cost time: 0.6675014495849609
Epoch: 26, Steps: 3 | Train Loss: 0.739 Vali Loss: 1.065 Vali Acc: 0.700 Test Loss: 1.065 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699989).  Saving model ...
Epoch: 27 cost time: 0.5522997379302979
Epoch: 27, Steps: 3 | Train Loss: 0.757 Vali Loss: 1.051 Vali Acc: 0.725 Test Loss: 1.051 Test Acc: 0.725
Validation loss decreased (-0.699989 --> -0.724989).  Saving model ...
Epoch: 28 cost time: 0.5486392974853516
Epoch: 28, Steps: 3 | Train Loss: 0.697 Vali Loss: 1.036 Vali Acc: 0.725 Test Loss: 1.036 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724990).  Saving model ...
Epoch: 29 cost time: 0.4765045642852783
Epoch: 29, Steps: 3 | Train Loss: 0.696 Vali Loss: 1.021 Vali Acc: 0.725 Test Loss: 1.021 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 30 cost time: 0.5770039558410645
Epoch: 30, Steps: 3 | Train Loss: 0.679 Vali Loss: 1.008 Vali Acc: 0.725 Test Loss: 1.008 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 31 cost time: 0.5742180347442627
Epoch: 31, Steps: 3 | Train Loss: 0.637 Vali Loss: 0.993 Vali Acc: 0.725 Test Loss: 0.993 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 32 cost time: 0.5246033668518066
Epoch: 32, Steps: 3 | Train Loss: 0.589 Vali Loss: 0.979 Vali Acc: 0.750 Test Loss: 0.979 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749990).  Saving model ...
Epoch: 33 cost time: 0.5858848094940186
Epoch: 33, Steps: 3 | Train Loss: 0.605 Vali Loss: 0.965 Vali Acc: 0.750 Test Loss: 0.965 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 34 cost time: 0.506040096282959
Epoch: 34, Steps: 3 | Train Loss: 0.586 Vali Loss: 0.951 Vali Acc: 0.750 Test Loss: 0.951 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 35 cost time: 0.5229740142822266
Epoch: 35, Steps: 3 | Train Loss: 0.538 Vali Loss: 0.939 Vali Acc: 0.775 Test Loss: 0.939 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774991).  Saving model ...
Epoch: 36 cost time: 0.4767141342163086
Epoch: 36, Steps: 3 | Train Loss: 0.570 Vali Loss: 0.926 Vali Acc: 0.775 Test Loss: 0.926 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 37 cost time: 0.46637797355651855
Epoch: 37, Steps: 3 | Train Loss: 0.520 Vali Loss: 0.914 Vali Acc: 0.775 Test Loss: 0.914 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 38 cost time: 0.4532487392425537
Epoch: 38, Steps: 3 | Train Loss: 0.498 Vali Loss: 0.902 Vali Acc: 0.800 Test Loss: 0.902 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799991).  Saving model ...
Epoch: 39 cost time: 0.5380163192749023
Epoch: 39, Steps: 3 | Train Loss: 0.455 Vali Loss: 0.888 Vali Acc: 0.800 Test Loss: 0.888 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 40 cost time: 0.6184308528900146
Epoch: 40, Steps: 3 | Train Loss: 0.474 Vali Loss: 0.874 Vali Acc: 0.800 Test Loss: 0.874 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 41 cost time: 0.4779844284057617
Epoch: 41, Steps: 3 | Train Loss: 0.443 Vali Loss: 0.861 Vali Acc: 0.825 Test Loss: 0.861 Test Acc: 0.825
Validation loss decreased (-0.799991 --> -0.824991).  Saving model ...
Epoch: 42 cost time: 0.5613372325897217
Epoch: 42, Steps: 3 | Train Loss: 0.431 Vali Loss: 0.846 Vali Acc: 0.825 Test Loss: 0.846 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824992).  Saving model ...
Epoch: 43 cost time: 0.5383398532867432
Epoch: 43, Steps: 3 | Train Loss: 0.390 Vali Loss: 0.831 Vali Acc: 0.825 Test Loss: 0.831 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 44 cost time: 0.4637489318847656
Epoch: 44, Steps: 3 | Train Loss: 0.417 Vali Loss: 0.817 Vali Acc: 0.825 Test Loss: 0.817 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 45 cost time: 0.5616621971130371
Epoch: 45, Steps: 3 | Train Loss: 0.398 Vali Loss: 0.803 Vali Acc: 0.825 Test Loss: 0.803 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 46 cost time: 0.5965855121612549
Epoch: 46, Steps: 3 | Train Loss: 0.366 Vali Loss: 0.790 Vali Acc: 0.825 Test Loss: 0.790 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 47 cost time: 0.4836299419403076
Epoch: 47, Steps: 3 | Train Loss: 0.364 Vali Loss: 0.776 Vali Acc: 0.825 Test Loss: 0.776 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 48 cost time: 0.4963114261627197
Epoch: 48, Steps: 3 | Train Loss: 0.370 Vali Loss: 0.764 Vali Acc: 0.825 Test Loss: 0.764 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 49 cost time: 0.52425217628479
Epoch: 49, Steps: 3 | Train Loss: 0.335 Vali Loss: 0.751 Vali Acc: 0.825 Test Loss: 0.751 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 50 cost time: 0.5311689376831055
Epoch: 50, Steps: 3 | Train Loss: 0.349 Vali Loss: 0.738 Vali Acc: 0.825 Test Loss: 0.738 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824993).  Saving model ...
Epoch: 51 cost time: 0.5427970886230469
Epoch: 51, Steps: 3 | Train Loss: 0.315 Vali Loss: 0.726 Vali Acc: 0.825 Test Loss: 0.726 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 52 cost time: 0.46805310249328613
Epoch: 52, Steps: 3 | Train Loss: 0.282 Vali Loss: 0.715 Vali Acc: 0.825 Test Loss: 0.715 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 53 cost time: 0.4395267963409424
Epoch: 53, Steps: 3 | Train Loss: 0.309 Vali Loss: 0.701 Vali Acc: 0.825 Test Loss: 0.701 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 54 cost time: 0.5931892395019531
Epoch: 54, Steps: 3 | Train Loss: 0.266 Vali Loss: 0.689 Vali Acc: 0.825 Test Loss: 0.689 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 55 cost time: 0.43759870529174805
Epoch: 55, Steps: 3 | Train Loss: 0.280 Vali Loss: 0.676 Vali Acc: 0.825 Test Loss: 0.676 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 56 cost time: 0.5159018039703369
Epoch: 56, Steps: 3 | Train Loss: 0.234 Vali Loss: 0.662 Vali Acc: 0.825 Test Loss: 0.662 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 57 cost time: 0.4075472354888916
Epoch: 57, Steps: 3 | Train Loss: 0.230 Vali Loss: 0.648 Vali Acc: 0.825 Test Loss: 0.648 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824994).  Saving model ...
Epoch: 58 cost time: 0.5348620414733887
Epoch: 58, Steps: 3 | Train Loss: 0.212 Vali Loss: 0.634 Vali Acc: 0.800 Test Loss: 0.634 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.6664454936981201
Epoch: 59, Steps: 3 | Train Loss: 0.210 Vali Loss: 0.621 Vali Acc: 0.825 Test Loss: 0.621 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 60 cost time: 0.5283725261688232
Epoch: 60, Steps: 3 | Train Loss: 0.230 Vali Loss: 0.607 Vali Acc: 0.825 Test Loss: 0.607 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 61 cost time: 0.5533802509307861
Epoch: 61, Steps: 3 | Train Loss: 0.211 Vali Loss: 0.594 Vali Acc: 0.850 Test Loss: 0.594 Test Acc: 0.850
Validation loss decreased (-0.824994 --> -0.849994).  Saving model ...
Epoch: 62 cost time: 0.5111794471740723
Epoch: 62, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.579 Vali Acc: 0.850 Test Loss: 0.579 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 63 cost time: 0.5266354084014893
Epoch: 63, Steps: 3 | Train Loss: 0.164 Vali Loss: 0.566 Vali Acc: 0.850 Test Loss: 0.566 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 64 cost time: 0.6628708839416504
Epoch: 64, Steps: 3 | Train Loss: 0.156 Vali Loss: 0.552 Vali Acc: 0.850 Test Loss: 0.552 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 65 cost time: 0.5401780605316162
Epoch: 65, Steps: 3 | Train Loss: 0.145 Vali Loss: 0.538 Vali Acc: 0.850 Test Loss: 0.538 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 66 cost time: 0.4358186721801758
Epoch: 66, Steps: 3 | Train Loss: 0.127 Vali Loss: 0.525 Vali Acc: 0.850 Test Loss: 0.525 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 67 cost time: 0.5378396511077881
Epoch: 67, Steps: 3 | Train Loss: 0.139 Vali Loss: 0.512 Vali Acc: 0.850 Test Loss: 0.512 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 68 cost time: 0.592587947845459
Epoch: 68, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.500 Vali Acc: 0.850 Test Loss: 0.500 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 69 cost time: 0.5003345012664795
Epoch: 69, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.487 Vali Acc: 0.850 Test Loss: 0.487 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 70 cost time: 0.5280475616455078
Epoch: 70, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.475 Vali Acc: 0.850 Test Loss: 0.475 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 71 cost time: 0.49085187911987305
Epoch: 71, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.463 Vali Acc: 0.850 Test Loss: 0.463 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 72 cost time: 0.5055692195892334
Epoch: 72, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.451 Vali Acc: 0.875 Test Loss: 0.451 Test Acc: 0.875
Validation loss decreased (-0.849995 --> -0.874995).  Saving model ...
Epoch: 73 cost time: 0.5202131271362305
Epoch: 73, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.439 Vali Acc: 0.875 Test Loss: 0.439 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 74 cost time: 0.5462744235992432
Epoch: 74, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.426 Vali Acc: 0.875 Test Loss: 0.426 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 75 cost time: 0.48171210289001465
Epoch: 75, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.414 Vali Acc: 0.900 Test Loss: 0.414 Test Acc: 0.900
Validation loss decreased (-0.874996 --> -0.899996).  Saving model ...
Epoch: 76 cost time: 0.5859837532043457
Epoch: 76, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.402 Vali Acc: 0.900 Test Loss: 0.402 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 77 cost time: 0.5265321731567383
Epoch: 77, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.391 Vali Acc: 0.900 Test Loss: 0.391 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 78 cost time: 0.730454683303833
Epoch: 78, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.380 Vali Acc: 0.900 Test Loss: 0.380 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 79 cost time: 0.5743138790130615
Epoch: 79, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.370 Vali Acc: 0.900 Test Loss: 0.370 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 80 cost time: 0.4886782169342041
Epoch: 80, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.362 Vali Acc: 0.900 Test Loss: 0.362 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 81 cost time: 0.502629280090332
Epoch: 81, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.355 Vali Acc: 0.900 Test Loss: 0.355 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 82 cost time: 0.42217516899108887
Epoch: 82, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.347 Vali Acc: 0.900 Test Loss: 0.347 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 83 cost time: 0.47559690475463867
Epoch: 83, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.341 Vali Acc: 0.900 Test Loss: 0.341 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 84 cost time: 0.4850151538848877
Epoch: 84, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.335 Vali Acc: 0.875 Test Loss: 0.335 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 0.5608935356140137
Epoch: 85, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.330 Vali Acc: 0.875 Test Loss: 0.330 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 0.607917308807373
Epoch: 86, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.325 Vali Acc: 0.875 Test Loss: 0.325 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 87 cost time: 0.5679333209991455
Epoch: 87, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.322 Vali Acc: 0.875 Test Loss: 0.322 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 88 cost time: 0.5184252262115479
Epoch: 88, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.318 Vali Acc: 0.875 Test Loss: 0.318 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 89 cost time: 0.5083074569702148
Epoch: 89, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.316 Vali Acc: 0.875 Test Loss: 0.316 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 90 cost time: 0.47734785079956055
Epoch: 90, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.313 Vali Acc: 0.875 Test Loss: 0.313 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 91 cost time: 0.488584041595459
Epoch: 91, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.310 Vali Acc: 0.875 Test Loss: 0.310 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 92 cost time: 0.5896332263946533
Epoch: 92, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.308 Vali Acc: 0.875 Test Loss: 0.308 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 93 cost time: 0.45842885971069336
Epoch: 93, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.306 Vali Acc: 0.900 Test Loss: 0.306 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 94 cost time: 0.48876142501831055
Epoch: 94, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.305 Vali Acc: 0.900 Test Loss: 0.305 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 95 cost time: 0.4831681251525879
Epoch: 95, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.304 Vali Acc: 0.900 Test Loss: 0.304 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 96 cost time: 0.570347785949707
Epoch: 96, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.302 Vali Acc: 0.900 Test Loss: 0.302 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 97 cost time: 0.5923686027526855
Epoch: 97, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.301 Vali Acc: 0.900 Test Loss: 0.301 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 98 cost time: 0.5515933036804199
Epoch: 98, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.300 Vali Acc: 0.900 Test Loss: 0.300 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 99 cost time: 0.5259029865264893
Epoch: 99, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.299 Vali Acc: 0.900 Test Loss: 0.299 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 100 cost time: 0.5216524600982666
Epoch: 100, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.298 Vali Acc: 0.900 Test Loss: 0.298 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm64_cs15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 16202
model size : 0.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm64_cs13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.8596210479736328
Epoch: 1, Steps: 3 | Train Loss: 1.449 Vali Loss: 1.281 Vali Acc: 0.225 Test Loss: 1.281 Test Acc: 0.225
Validation loss decreased (inf --> -0.224987).  Saving model ...
Epoch: 2 cost time: 0.4683806896209717
Epoch: 2, Steps: 3 | Train Loss: 1.442 Vali Loss: 1.274 Vali Acc: 0.250 Test Loss: 1.274 Test Acc: 0.250
Validation loss decreased (-0.224987 --> -0.249987).  Saving model ...
Epoch: 3 cost time: 0.4219083786010742
Epoch: 3, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.268 Vali Acc: 0.250 Test Loss: 1.268 Test Acc: 0.250
Validation loss decreased (-0.249987 --> -0.249987).  Saving model ...
Epoch: 4 cost time: 0.6966686248779297
Epoch: 4, Steps: 3 | Train Loss: 1.390 Vali Loss: 1.261 Vali Acc: 0.250 Test Loss: 1.261 Test Acc: 0.250
Validation loss decreased (-0.249987 --> -0.249987).  Saving model ...
Epoch: 5 cost time: 0.3813822269439697
Epoch: 5, Steps: 3 | Train Loss: 1.401 Vali Loss: 1.252 Vali Acc: 0.250 Test Loss: 1.252 Test Acc: 0.250
Validation loss decreased (-0.249987 --> -0.249987).  Saving model ...
Epoch: 6 cost time: 0.5692911148071289
Epoch: 6, Steps: 3 | Train Loss: 1.351 Vali Loss: 1.242 Vali Acc: 0.300 Test Loss: 1.242 Test Acc: 0.300
Validation loss decreased (-0.249987 --> -0.299988).  Saving model ...
Epoch: 7 cost time: 0.5402355194091797
Epoch: 7, Steps: 3 | Train Loss: 1.336 Vali Loss: 1.231 Vali Acc: 0.325 Test Loss: 1.231 Test Acc: 0.325
Validation loss decreased (-0.299988 --> -0.324988).  Saving model ...
Epoch: 8 cost time: 0.4308340549468994
Epoch: 8, Steps: 3 | Train Loss: 1.301 Vali Loss: 1.219 Vali Acc: 0.350 Test Loss: 1.219 Test Acc: 0.350
Validation loss decreased (-0.324988 --> -0.349988).  Saving model ...
Epoch: 9 cost time: 0.4996964931488037
Epoch: 9, Steps: 3 | Train Loss: 1.238 Vali Loss: 1.207 Vali Acc: 0.425 Test Loss: 1.207 Test Acc: 0.425
Validation loss decreased (-0.349988 --> -0.424988).  Saving model ...
Epoch: 10 cost time: 0.5734443664550781
Epoch: 10, Steps: 3 | Train Loss: 1.229 Vali Loss: 1.194 Vali Acc: 0.575 Test Loss: 1.194 Test Acc: 0.575
Validation loss decreased (-0.424988 --> -0.574988).  Saving model ...
Epoch: 11 cost time: 0.7085351943969727
Epoch: 11, Steps: 3 | Train Loss: 1.207 Vali Loss: 1.181 Vali Acc: 0.625 Test Loss: 1.181 Test Acc: 0.625
Validation loss decreased (-0.574988 --> -0.624988).  Saving model ...
Epoch: 12 cost time: 0.4632985591888428
Epoch: 12, Steps: 3 | Train Loss: 1.165 Vali Loss: 1.168 Vali Acc: 0.675 Test Loss: 1.168 Test Acc: 0.675
Validation loss decreased (-0.624988 --> -0.674988).  Saving model ...
Epoch: 13 cost time: 0.505683183670044
Epoch: 13, Steps: 3 | Train Loss: 1.154 Vali Loss: 1.152 Vali Acc: 0.675 Test Loss: 1.152 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674988).  Saving model ...
Epoch: 14 cost time: 0.5216655731201172
Epoch: 14, Steps: 3 | Train Loss: 1.116 Vali Loss: 1.137 Vali Acc: 0.700 Test Loss: 1.137 Test Acc: 0.700
Validation loss decreased (-0.674988 --> -0.699989).  Saving model ...
Epoch: 15 cost time: 0.42060017585754395
Epoch: 15, Steps: 3 | Train Loss: 1.073 Vali Loss: 1.122 Vali Acc: 0.700 Test Loss: 1.122 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 16 cost time: 0.49543309211730957
Epoch: 16, Steps: 3 | Train Loss: 1.035 Vali Loss: 1.106 Vali Acc: 0.700 Test Loss: 1.106 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 17 cost time: 0.46393394470214844
Epoch: 17, Steps: 3 | Train Loss: 1.026 Vali Loss: 1.090 Vali Acc: 0.750 Test Loss: 1.090 Test Acc: 0.750
Validation loss decreased (-0.699989 --> -0.749989).  Saving model ...
Epoch: 18 cost time: 0.47993922233581543
Epoch: 18, Steps: 3 | Train Loss: 0.967 Vali Loss: 1.073 Vali Acc: 0.775 Test Loss: 1.073 Test Acc: 0.775
Validation loss decreased (-0.749989 --> -0.774989).  Saving model ...
Epoch: 19 cost time: 0.43793535232543945
Epoch: 19, Steps: 3 | Train Loss: 0.941 Vali Loss: 1.056 Vali Acc: 0.775 Test Loss: 1.056 Test Acc: 0.775
Validation loss decreased (-0.774989 --> -0.774989).  Saving model ...
Epoch: 20 cost time: 0.703066349029541
Epoch: 20, Steps: 3 | Train Loss: 0.911 Vali Loss: 1.040 Vali Acc: 0.775 Test Loss: 1.040 Test Acc: 0.775
Validation loss decreased (-0.774989 --> -0.774990).  Saving model ...
Epoch: 21 cost time: 0.6785497665405273
Epoch: 21, Steps: 3 | Train Loss: 0.907 Vali Loss: 1.025 Vali Acc: 0.775 Test Loss: 1.025 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774990).  Saving model ...
Epoch: 22 cost time: 0.4781167507171631
Epoch: 22, Steps: 3 | Train Loss: 0.905 Vali Loss: 1.008 Vali Acc: 0.800 Test Loss: 1.008 Test Acc: 0.800
Validation loss decreased (-0.774990 --> -0.799990).  Saving model ...
Epoch: 23 cost time: 0.5355911254882812
Epoch: 23, Steps: 3 | Train Loss: 0.823 Vali Loss: 0.992 Vali Acc: 0.825 Test Loss: 0.992 Test Acc: 0.825
Validation loss decreased (-0.799990 --> -0.824990).  Saving model ...
Epoch: 24 cost time: 0.5136680603027344
Epoch: 24, Steps: 3 | Train Loss: 0.808 Vali Loss: 0.976 Vali Acc: 0.825 Test Loss: 0.976 Test Acc: 0.825
Validation loss decreased (-0.824990 --> -0.824990).  Saving model ...
Epoch: 25 cost time: 0.5093021392822266
Epoch: 25, Steps: 3 | Train Loss: 0.762 Vali Loss: 0.959 Vali Acc: 0.825 Test Loss: 0.959 Test Acc: 0.825
Validation loss decreased (-0.824990 --> -0.824990).  Saving model ...
Epoch: 26 cost time: 0.4725325107574463
Epoch: 26, Steps: 3 | Train Loss: 0.761 Vali Loss: 0.943 Vali Acc: 0.825 Test Loss: 0.943 Test Acc: 0.825
Validation loss decreased (-0.824990 --> -0.824991).  Saving model ...
Epoch: 27 cost time: 0.46183133125305176
Epoch: 27, Steps: 3 | Train Loss: 0.776 Vali Loss: 0.927 Vali Acc: 0.825 Test Loss: 0.927 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824991).  Saving model ...
Epoch: 28 cost time: 0.551281213760376
Epoch: 28, Steps: 3 | Train Loss: 0.679 Vali Loss: 0.912 Vali Acc: 0.825 Test Loss: 0.912 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824991).  Saving model ...
Epoch: 29 cost time: 0.6262941360473633
Epoch: 29, Steps: 3 | Train Loss: 0.691 Vali Loss: 0.898 Vali Acc: 0.825 Test Loss: 0.898 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824991).  Saving model ...
Epoch: 30 cost time: 0.40198588371276855
Epoch: 30, Steps: 3 | Train Loss: 0.647 Vali Loss: 0.884 Vali Acc: 0.825 Test Loss: 0.884 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824991).  Saving model ...
Epoch: 31 cost time: 0.5403060913085938
Epoch: 31, Steps: 3 | Train Loss: 0.663 Vali Loss: 0.870 Vali Acc: 0.825 Test Loss: 0.870 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824991).  Saving model ...
Epoch: 32 cost time: 0.44940876960754395
Epoch: 32, Steps: 3 | Train Loss: 0.626 Vali Loss: 0.856 Vali Acc: 0.825 Test Loss: 0.856 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824991).  Saving model ...
Epoch: 33 cost time: 0.3915257453918457
Epoch: 33, Steps: 3 | Train Loss: 0.584 Vali Loss: 0.842 Vali Acc: 0.825 Test Loss: 0.842 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824992).  Saving model ...
Epoch: 34 cost time: 0.4158601760864258
Epoch: 34, Steps: 3 | Train Loss: 0.589 Vali Loss: 0.828 Vali Acc: 0.825 Test Loss: 0.828 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 35 cost time: 0.4227418899536133
Epoch: 35, Steps: 3 | Train Loss: 0.566 Vali Loss: 0.815 Vali Acc: 0.825 Test Loss: 0.815 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 36 cost time: 0.5147290229797363
Epoch: 36, Steps: 3 | Train Loss: 0.553 Vali Loss: 0.802 Vali Acc: 0.825 Test Loss: 0.802 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 37 cost time: 0.44388270378112793
Epoch: 37, Steps: 3 | Train Loss: 0.524 Vali Loss: 0.790 Vali Acc: 0.825 Test Loss: 0.790 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 38 cost time: 0.47732996940612793
Epoch: 38, Steps: 3 | Train Loss: 0.508 Vali Loss: 0.778 Vali Acc: 0.825 Test Loss: 0.778 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 39 cost time: 0.5911517143249512
Epoch: 39, Steps: 3 | Train Loss: 0.475 Vali Loss: 0.767 Vali Acc: 0.825 Test Loss: 0.767 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 40 cost time: 0.537482738494873
Epoch: 40, Steps: 3 | Train Loss: 0.461 Vali Loss: 0.755 Vali Acc: 0.825 Test Loss: 0.755 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 41 cost time: 0.5675356388092041
Epoch: 41, Steps: 3 | Train Loss: 0.491 Vali Loss: 0.744 Vali Acc: 0.825 Test Loss: 0.744 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824993).  Saving model ...
Epoch: 42 cost time: 0.5091512203216553
Epoch: 42, Steps: 3 | Train Loss: 0.427 Vali Loss: 0.733 Vali Acc: 0.850 Test Loss: 0.733 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849993).  Saving model ...
Epoch: 43 cost time: 0.5750176906585693
Epoch: 43, Steps: 3 | Train Loss: 0.430 Vali Loss: 0.723 Vali Acc: 0.850 Test Loss: 0.723 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 44 cost time: 0.4399244785308838
Epoch: 44, Steps: 3 | Train Loss: 0.401 Vali Loss: 0.713 Vali Acc: 0.825 Test Loss: 0.713 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.621802568435669
Epoch: 45, Steps: 3 | Train Loss: 0.403 Vali Loss: 0.704 Vali Acc: 0.800 Test Loss: 0.704 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.5360701084136963
Epoch: 46, Steps: 3 | Train Loss: 0.388 Vali Loss: 0.695 Vali Acc: 0.800 Test Loss: 0.695 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.5045537948608398
Epoch: 47, Steps: 3 | Train Loss: 0.396 Vali Loss: 0.687 Vali Acc: 0.800 Test Loss: 0.687 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.5111463069915771
Epoch: 48, Steps: 3 | Train Loss: 0.391 Vali Loss: 0.678 Vali Acc: 0.800 Test Loss: 0.678 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.4379453659057617
Epoch: 49, Steps: 3 | Train Loss: 0.351 Vali Loss: 0.669 Vali Acc: 0.800 Test Loss: 0.669 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.515289306640625
Epoch: 50, Steps: 3 | Train Loss: 0.340 Vali Loss: 0.662 Vali Acc: 0.800 Test Loss: 0.662 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 0.395798921585083
Epoch: 51, Steps: 3 | Train Loss: 0.324 Vali Loss: 0.654 Vali Acc: 0.775 Test Loss: 0.654 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 0.5700926780700684
Epoch: 52, Steps: 3 | Train Loss: 0.336 Vali Loss: 0.647 Vali Acc: 0.775 Test Loss: 0.647 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 0.5118393898010254
Epoch: 53, Steps: 3 | Train Loss: 0.308 Vali Loss: 0.639 Vali Acc: 0.775 Test Loss: 0.639 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm64_cs13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.85
model parameter : 16072
model size : 0.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm64_cs12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.713688611984253
Epoch: 1, Steps: 3 | Train Loss: 1.421 Vali Loss: 1.379 Vali Acc: 0.225 Test Loss: 1.379 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 0.4554018974304199
Epoch: 2, Steps: 3 | Train Loss: 1.379 Vali Loss: 1.373 Vali Acc: 0.200 Test Loss: 1.373 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5107548236846924
Epoch: 3, Steps: 3 | Train Loss: 1.394 Vali Loss: 1.368 Vali Acc: 0.200 Test Loss: 1.368 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.43923354148864746
Epoch: 4, Steps: 3 | Train Loss: 1.377 Vali Loss: 1.360 Vali Acc: 0.200 Test Loss: 1.360 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4671132564544678
Epoch: 5, Steps: 3 | Train Loss: 1.377 Vali Loss: 1.352 Vali Acc: 0.200 Test Loss: 1.352 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.4756596088409424
Epoch: 6, Steps: 3 | Train Loss: 1.350 Vali Loss: 1.342 Vali Acc: 0.200 Test Loss: 1.342 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.47170448303222656
Epoch: 7, Steps: 3 | Train Loss: 1.314 Vali Loss: 1.331 Vali Acc: 0.250 Test Loss: 1.331 Test Acc: 0.250
Validation loss decreased (-0.224986 --> -0.249987).  Saving model ...
Epoch: 8 cost time: 0.4921684265136719
Epoch: 8, Steps: 3 | Train Loss: 1.258 Vali Loss: 1.318 Vali Acc: 0.275 Test Loss: 1.318 Test Acc: 0.275
Validation loss decreased (-0.249987 --> -0.274987).  Saving model ...
Epoch: 9 cost time: 0.49041748046875
Epoch: 9, Steps: 3 | Train Loss: 1.238 Vali Loss: 1.306 Vali Acc: 0.300 Test Loss: 1.306 Test Acc: 0.300
Validation loss decreased (-0.274987 --> -0.299987).  Saving model ...
Epoch: 10 cost time: 0.48517942428588867
Epoch: 10, Steps: 3 | Train Loss: 1.216 Vali Loss: 1.292 Vali Acc: 0.325 Test Loss: 1.292 Test Acc: 0.325
Validation loss decreased (-0.299987 --> -0.324987).  Saving model ...
Epoch: 11 cost time: 0.44215846061706543
Epoch: 11, Steps: 3 | Train Loss: 1.219 Vali Loss: 1.279 Vali Acc: 0.350 Test Loss: 1.279 Test Acc: 0.350
Validation loss decreased (-0.324987 --> -0.349987).  Saving model ...
Epoch: 12 cost time: 0.4682497978210449
Epoch: 12, Steps: 3 | Train Loss: 1.169 Vali Loss: 1.265 Vali Acc: 0.425 Test Loss: 1.265 Test Acc: 0.425
Validation loss decreased (-0.349987 --> -0.424987).  Saving model ...
Epoch: 13 cost time: 0.49877190589904785
Epoch: 13, Steps: 3 | Train Loss: 1.157 Vali Loss: 1.250 Vali Acc: 0.575 Test Loss: 1.250 Test Acc: 0.575
Validation loss decreased (-0.424987 --> -0.574988).  Saving model ...
Epoch: 14 cost time: 0.4323160648345947
Epoch: 14, Steps: 3 | Train Loss: 1.118 Vali Loss: 1.235 Vali Acc: 0.600 Test Loss: 1.235 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599988).  Saving model ...
Epoch: 15 cost time: 0.5392777919769287
Epoch: 15, Steps: 3 | Train Loss: 1.047 Vali Loss: 1.220 Vali Acc: 0.625 Test Loss: 1.220 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624988).  Saving model ...
Epoch: 16 cost time: 0.44347620010375977
Epoch: 16, Steps: 3 | Train Loss: 1.038 Vali Loss: 1.205 Vali Acc: 0.700 Test Loss: 1.205 Test Acc: 0.700
Validation loss decreased (-0.624988 --> -0.699988).  Saving model ...
Epoch: 17 cost time: 0.47748351097106934
Epoch: 17, Steps: 3 | Train Loss: 1.026 Vali Loss: 1.190 Vali Acc: 0.725 Test Loss: 1.190 Test Acc: 0.725
Validation loss decreased (-0.699988 --> -0.724988).  Saving model ...
Epoch: 18 cost time: 0.474196195602417
Epoch: 18, Steps: 3 | Train Loss: 0.996 Vali Loss: 1.174 Vali Acc: 0.750 Test Loss: 1.174 Test Acc: 0.750
Validation loss decreased (-0.724988 --> -0.749988).  Saving model ...
Epoch: 19 cost time: 0.45592188835144043
Epoch: 19, Steps: 3 | Train Loss: 0.934 Vali Loss: 1.157 Vali Acc: 0.750 Test Loss: 1.157 Test Acc: 0.750
Validation loss decreased (-0.749988 --> -0.749988).  Saving model ...
Epoch: 20 cost time: 0.4678843021392822
Epoch: 20, Steps: 3 | Train Loss: 0.928 Vali Loss: 1.140 Vali Acc: 0.750 Test Loss: 1.140 Test Acc: 0.750
Validation loss decreased (-0.749988 --> -0.749989).  Saving model ...
Epoch: 21 cost time: 0.38724184036254883
Epoch: 21, Steps: 3 | Train Loss: 0.904 Vali Loss: 1.122 Vali Acc: 0.750 Test Loss: 1.122 Test Acc: 0.750
Validation loss decreased (-0.749989 --> -0.749989).  Saving model ...
Epoch: 22 cost time: 0.4588439464569092
Epoch: 22, Steps: 3 | Train Loss: 0.876 Vali Loss: 1.104 Vali Acc: 0.750 Test Loss: 1.104 Test Acc: 0.750
Validation loss decreased (-0.749989 --> -0.749989).  Saving model ...
Epoch: 23 cost time: 0.4625675678253174
Epoch: 23, Steps: 3 | Train Loss: 0.860 Vali Loss: 1.087 Vali Acc: 0.775 Test Loss: 1.087 Test Acc: 0.775
Validation loss decreased (-0.749989 --> -0.774989).  Saving model ...
Epoch: 24 cost time: 0.40567970275878906
Epoch: 24, Steps: 3 | Train Loss: 0.769 Vali Loss: 1.068 Vali Acc: 0.775 Test Loss: 1.068 Test Acc: 0.775
Validation loss decreased (-0.774989 --> -0.774989).  Saving model ...
Epoch: 25 cost time: 0.46938657760620117
Epoch: 25, Steps: 3 | Train Loss: 0.797 Vali Loss: 1.050 Vali Acc: 0.775 Test Loss: 1.050 Test Acc: 0.775
Validation loss decreased (-0.774989 --> -0.774990).  Saving model ...
Epoch: 26 cost time: 0.3740262985229492
Epoch: 26, Steps: 3 | Train Loss: 0.748 Vali Loss: 1.031 Vali Acc: 0.775 Test Loss: 1.031 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774990).  Saving model ...
Epoch: 27 cost time: 0.45313549041748047
Epoch: 27, Steps: 3 | Train Loss: 0.737 Vali Loss: 1.012 Vali Acc: 0.750 Test Loss: 1.012 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.3635749816894531
Epoch: 28, Steps: 3 | Train Loss: 0.659 Vali Loss: 0.995 Vali Acc: 0.750 Test Loss: 0.995 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.5778319835662842
Epoch: 29, Steps: 3 | Train Loss: 0.682 Vali Loss: 0.978 Vali Acc: 0.725 Test Loss: 0.978 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.5590512752532959
Epoch: 30, Steps: 3 | Train Loss: 0.653 Vali Loss: 0.961 Vali Acc: 0.725 Test Loss: 0.961 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.39469432830810547
Epoch: 31, Steps: 3 | Train Loss: 0.643 Vali Loss: 0.944 Vali Acc: 0.725 Test Loss: 0.944 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.5932455062866211
Epoch: 32, Steps: 3 | Train Loss: 0.637 Vali Loss: 0.927 Vali Acc: 0.750 Test Loss: 0.927 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.5260365009307861
Epoch: 33, Steps: 3 | Train Loss: 0.559 Vali Loss: 0.910 Vali Acc: 0.775 Test Loss: 0.910 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774991).  Saving model ...
Epoch: 34 cost time: 0.4524989128112793
Epoch: 34, Steps: 3 | Train Loss: 0.554 Vali Loss: 0.895 Vali Acc: 0.775 Test Loss: 0.895 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 35 cost time: 0.5313334465026855
Epoch: 35, Steps: 3 | Train Loss: 0.523 Vali Loss: 0.880 Vali Acc: 0.800 Test Loss: 0.880 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799991).  Saving model ...
Epoch: 36 cost time: 0.48323678970336914
Epoch: 36, Steps: 3 | Train Loss: 0.514 Vali Loss: 0.867 Vali Acc: 0.800 Test Loss: 0.867 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 37 cost time: 0.4910759925842285
Epoch: 37, Steps: 3 | Train Loss: 0.530 Vali Loss: 0.855 Vali Acc: 0.800 Test Loss: 0.855 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 38 cost time: 0.4891505241394043
Epoch: 38, Steps: 3 | Train Loss: 0.518 Vali Loss: 0.843 Vali Acc: 0.800 Test Loss: 0.843 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799992).  Saving model ...
Epoch: 39 cost time: 0.3834249973297119
Epoch: 39, Steps: 3 | Train Loss: 0.458 Vali Loss: 0.831 Vali Acc: 0.800 Test Loss: 0.831 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 40 cost time: 0.5622775554656982
Epoch: 40, Steps: 3 | Train Loss: 0.451 Vali Loss: 0.819 Vali Acc: 0.800 Test Loss: 0.819 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 41 cost time: 0.5108885765075684
Epoch: 41, Steps: 3 | Train Loss: 0.474 Vali Loss: 0.806 Vali Acc: 0.800 Test Loss: 0.806 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 42 cost time: 0.4538264274597168
Epoch: 42, Steps: 3 | Train Loss: 0.397 Vali Loss: 0.794 Vali Acc: 0.800 Test Loss: 0.794 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 43 cost time: 0.48504066467285156
Epoch: 43, Steps: 3 | Train Loss: 0.397 Vali Loss: 0.783 Vali Acc: 0.800 Test Loss: 0.783 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 44 cost time: 0.49193644523620605
Epoch: 44, Steps: 3 | Train Loss: 0.384 Vali Loss: 0.771 Vali Acc: 0.800 Test Loss: 0.771 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 45 cost time: 0.509545087814331
Epoch: 45, Steps: 3 | Train Loss: 0.396 Vali Loss: 0.760 Vali Acc: 0.800 Test Loss: 0.760 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 46 cost time: 0.46097230911254883
Epoch: 46, Steps: 3 | Train Loss: 0.391 Vali Loss: 0.749 Vali Acc: 0.775 Test Loss: 0.749 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.4938967227935791
Epoch: 47, Steps: 3 | Train Loss: 0.386 Vali Loss: 0.739 Vali Acc: 0.775 Test Loss: 0.739 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.4678652286529541
Epoch: 48, Steps: 3 | Train Loss: 0.380 Vali Loss: 0.731 Vali Acc: 0.775 Test Loss: 0.731 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.43500447273254395
Epoch: 49, Steps: 3 | Train Loss: 0.339 Vali Loss: 0.722 Vali Acc: 0.775 Test Loss: 0.722 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.5306453704833984
Epoch: 50, Steps: 3 | Train Loss: 0.321 Vali Loss: 0.714 Vali Acc: 0.775 Test Loss: 0.714 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.5083818435668945
Epoch: 51, Steps: 3 | Train Loss: 0.325 Vali Loss: 0.706 Vali Acc: 0.775 Test Loss: 0.706 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 0.4968607425689697
Epoch: 52, Steps: 3 | Train Loss: 0.294 Vali Loss: 0.697 Vali Acc: 0.775 Test Loss: 0.697 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 0.5842690467834473
Epoch: 53, Steps: 3 | Train Loss: 0.314 Vali Loss: 0.689 Vali Acc: 0.775 Test Loss: 0.689 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 0.4695851802825928
Epoch: 54, Steps: 3 | Train Loss: 0.287 Vali Loss: 0.681 Vali Acc: 0.775 Test Loss: 0.681 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 0.4627068042755127
Epoch: 55, Steps: 3 | Train Loss: 0.284 Vali Loss: 0.674 Vali Acc: 0.775 Test Loss: 0.674 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm64_cs12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.8
model parameter : 16478
model size : 0.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm64_cs10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7054753303527832
Epoch: 1, Steps: 3 | Train Loss: 1.503 Vali Loss: 1.489 Vali Acc: 0.300 Test Loss: 1.489 Test Acc: 0.300
Validation loss decreased (inf --> -0.299985).  Saving model ...
Epoch: 2 cost time: 0.5647947788238525
Epoch: 2, Steps: 3 | Train Loss: 1.457 Vali Loss: 1.481 Vali Acc: 0.300 Test Loss: 1.481 Test Acc: 0.300
Validation loss decreased (-0.299985 --> -0.299985).  Saving model ...
Epoch: 3 cost time: 0.5393621921539307
Epoch: 3, Steps: 3 | Train Loss: 1.481 Vali Loss: 1.473 Vali Acc: 0.300 Test Loss: 1.473 Test Acc: 0.300
Validation loss decreased (-0.299985 --> -0.299985).  Saving model ...
Epoch: 4 cost time: 0.46779441833496094
Epoch: 4, Steps: 3 | Train Loss: 1.433 Vali Loss: 1.463 Vali Acc: 0.300 Test Loss: 1.463 Test Acc: 0.300
Validation loss decreased (-0.299985 --> -0.299985).  Saving model ...
Epoch: 5 cost time: 0.7336230278015137
Epoch: 5, Steps: 3 | Train Loss: 1.412 Vali Loss: 1.451 Vali Acc: 0.300 Test Loss: 1.451 Test Acc: 0.300
Validation loss decreased (-0.299985 --> -0.299985).  Saving model ...
Epoch: 6 cost time: 0.5128538608551025
Epoch: 6, Steps: 3 | Train Loss: 1.389 Vali Loss: 1.439 Vali Acc: 0.300 Test Loss: 1.439 Test Acc: 0.300
Validation loss decreased (-0.299985 --> -0.299986).  Saving model ...
Epoch: 7 cost time: 0.45263147354125977
Epoch: 7, Steps: 3 | Train Loss: 1.359 Vali Loss: 1.425 Vali Acc: 0.325 Test Loss: 1.425 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324986).  Saving model ...
Epoch: 8 cost time: 0.4843583106994629
Epoch: 8, Steps: 3 | Train Loss: 1.323 Vali Loss: 1.411 Vali Acc: 0.350 Test Loss: 1.411 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349986).  Saving model ...
Epoch: 9 cost time: 0.5458400249481201
Epoch: 9, Steps: 3 | Train Loss: 1.280 Vali Loss: 1.396 Vali Acc: 0.375 Test Loss: 1.396 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374986).  Saving model ...
Epoch: 10 cost time: 0.48073530197143555
Epoch: 10, Steps: 3 | Train Loss: 1.275 Vali Loss: 1.380 Vali Acc: 0.375 Test Loss: 1.380 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 11 cost time: 0.4876391887664795
Epoch: 11, Steps: 3 | Train Loss: 1.252 Vali Loss: 1.365 Vali Acc: 0.375 Test Loss: 1.365 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 12 cost time: 0.5261471271514893
Epoch: 12, Steps: 3 | Train Loss: 1.225 Vali Loss: 1.349 Vali Acc: 0.375 Test Loss: 1.349 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374987).  Saving model ...
Epoch: 13 cost time: 0.5065557956695557
Epoch: 13, Steps: 3 | Train Loss: 1.182 Vali Loss: 1.333 Vali Acc: 0.375 Test Loss: 1.333 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 14 cost time: 0.45148801803588867
Epoch: 14, Steps: 3 | Train Loss: 1.144 Vali Loss: 1.316 Vali Acc: 0.425 Test Loss: 1.316 Test Acc: 0.425
Validation loss decreased (-0.374987 --> -0.424987).  Saving model ...
Epoch: 15 cost time: 0.4275674819946289
Epoch: 15, Steps: 3 | Train Loss: 1.116 Vali Loss: 1.299 Vali Acc: 0.475 Test Loss: 1.299 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474987).  Saving model ...
Epoch: 16 cost time: 0.5539646148681641
Epoch: 16, Steps: 3 | Train Loss: 1.079 Vali Loss: 1.282 Vali Acc: 0.500 Test Loss: 1.282 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499987).  Saving model ...
Epoch: 17 cost time: 0.43950867652893066
Epoch: 17, Steps: 3 | Train Loss: 1.032 Vali Loss: 1.264 Vali Acc: 0.550 Test Loss: 1.264 Test Acc: 0.550
Validation loss decreased (-0.499987 --> -0.549987).  Saving model ...
Epoch: 18 cost time: 0.4435758590698242
Epoch: 18, Steps: 3 | Train Loss: 1.010 Vali Loss: 1.246 Vali Acc: 0.575 Test Loss: 1.246 Test Acc: 0.575
Validation loss decreased (-0.549987 --> -0.574988).  Saving model ...
Epoch: 19 cost time: 0.507164716720581
Epoch: 19, Steps: 3 | Train Loss: 0.974 Vali Loss: 1.227 Vali Acc: 0.575 Test Loss: 1.227 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 20 cost time: 0.40746116638183594
Epoch: 20, Steps: 3 | Train Loss: 0.956 Vali Loss: 1.209 Vali Acc: 0.600 Test Loss: 1.209 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599988).  Saving model ...
Epoch: 21 cost time: 0.43029189109802246
Epoch: 21, Steps: 3 | Train Loss: 0.934 Vali Loss: 1.191 Vali Acc: 0.675 Test Loss: 1.191 Test Acc: 0.675
Validation loss decreased (-0.599988 --> -0.674988).  Saving model ...
Epoch: 22 cost time: 0.48194289207458496
Epoch: 22, Steps: 3 | Train Loss: 0.887 Vali Loss: 1.172 Vali Acc: 0.675 Test Loss: 1.172 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674988).  Saving model ...
Epoch: 23 cost time: 0.5071249008178711
Epoch: 23, Steps: 3 | Train Loss: 0.861 Vali Loss: 1.152 Vali Acc: 0.675 Test Loss: 1.152 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674988).  Saving model ...
Epoch: 24 cost time: 0.5110628604888916
Epoch: 24, Steps: 3 | Train Loss: 0.802 Vali Loss: 1.131 Vali Acc: 0.675 Test Loss: 1.131 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674989).  Saving model ...
Epoch: 25 cost time: 0.4089035987854004
Epoch: 25, Steps: 3 | Train Loss: 0.798 Vali Loss: 1.112 Vali Acc: 0.675 Test Loss: 1.112 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 26 cost time: 0.4985058307647705
Epoch: 26, Steps: 3 | Train Loss: 0.805 Vali Loss: 1.093 Vali Acc: 0.675 Test Loss: 1.093 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 27 cost time: 0.46126341819763184
Epoch: 27, Steps: 3 | Train Loss: 0.757 Vali Loss: 1.075 Vali Acc: 0.675 Test Loss: 1.075 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 28 cost time: 0.4644291400909424
Epoch: 28, Steps: 3 | Train Loss: 0.708 Vali Loss: 1.059 Vali Acc: 0.675 Test Loss: 1.059 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 29 cost time: 0.49093008041381836
Epoch: 29, Steps: 3 | Train Loss: 0.714 Vali Loss: 1.043 Vali Acc: 0.675 Test Loss: 1.043 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674990).  Saving model ...
Epoch: 30 cost time: 0.5129661560058594
Epoch: 30, Steps: 3 | Train Loss: 0.642 Vali Loss: 1.027 Vali Acc: 0.675 Test Loss: 1.027 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 31 cost time: 0.4703483581542969
Epoch: 31, Steps: 3 | Train Loss: 0.639 Vali Loss: 1.012 Vali Acc: 0.675 Test Loss: 1.012 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 32 cost time: 0.4067387580871582
Epoch: 32, Steps: 3 | Train Loss: 0.631 Vali Loss: 0.997 Vali Acc: 0.675 Test Loss: 0.997 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 33 cost time: 0.7244646549224854
Epoch: 33, Steps: 3 | Train Loss: 0.615 Vali Loss: 0.982 Vali Acc: 0.675 Test Loss: 0.982 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 34 cost time: 0.5596256256103516
Epoch: 34, Steps: 3 | Train Loss: 0.604 Vali Loss: 0.968 Vali Acc: 0.675 Test Loss: 0.968 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 35 cost time: 0.6000738143920898
Epoch: 35, Steps: 3 | Train Loss: 0.550 Vali Loss: 0.955 Vali Acc: 0.700 Test Loss: 0.955 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 36 cost time: 0.5391213893890381
Epoch: 36, Steps: 3 | Train Loss: 0.553 Vali Loss: 0.942 Vali Acc: 0.700 Test Loss: 0.942 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699991).  Saving model ...
Epoch: 37 cost time: 0.5079746246337891
Epoch: 37, Steps: 3 | Train Loss: 0.535 Vali Loss: 0.928 Vali Acc: 0.725 Test Loss: 0.928 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724991).  Saving model ...
Epoch: 38 cost time: 0.5042846202850342
Epoch: 38, Steps: 3 | Train Loss: 0.506 Vali Loss: 0.916 Vali Acc: 0.725 Test Loss: 0.916 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 39 cost time: 0.5479960441589355
Epoch: 39, Steps: 3 | Train Loss: 0.475 Vali Loss: 0.904 Vali Acc: 0.725 Test Loss: 0.904 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 40 cost time: 0.5736558437347412
Epoch: 40, Steps: 3 | Train Loss: 0.482 Vali Loss: 0.892 Vali Acc: 0.750 Test Loss: 0.892 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749991).  Saving model ...
Epoch: 41 cost time: 0.6134302616119385
Epoch: 41, Steps: 3 | Train Loss: 0.456 Vali Loss: 0.883 Vali Acc: 0.750 Test Loss: 0.883 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 42 cost time: 0.551184892654419
Epoch: 42, Steps: 3 | Train Loss: 0.435 Vali Loss: 0.872 Vali Acc: 0.750 Test Loss: 0.872 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 43 cost time: 0.672555685043335
Epoch: 43, Steps: 3 | Train Loss: 0.430 Vali Loss: 0.863 Vali Acc: 0.775 Test Loss: 0.863 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774991).  Saving model ...
Epoch: 44 cost time: 0.7106821537017822
Epoch: 44, Steps: 3 | Train Loss: 0.454 Vali Loss: 0.855 Vali Acc: 0.775 Test Loss: 0.855 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 45 cost time: 0.5834043025970459
Epoch: 45, Steps: 3 | Train Loss: 0.422 Vali Loss: 0.846 Vali Acc: 0.775 Test Loss: 0.846 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774992).  Saving model ...
Epoch: 46 cost time: 0.6114294528961182
Epoch: 46, Steps: 3 | Train Loss: 0.429 Vali Loss: 0.838 Vali Acc: 0.775 Test Loss: 0.838 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 47 cost time: 0.8417263031005859
Epoch: 47, Steps: 3 | Train Loss: 0.392 Vali Loss: 0.829 Vali Acc: 0.775 Test Loss: 0.829 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 48 cost time: 0.5236022472381592
Epoch: 48, Steps: 3 | Train Loss: 0.393 Vali Loss: 0.821 Vali Acc: 0.775 Test Loss: 0.821 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 49 cost time: 0.6359267234802246
Epoch: 49, Steps: 3 | Train Loss: 0.376 Vali Loss: 0.813 Vali Acc: 0.825 Test Loss: 0.813 Test Acc: 0.825
Validation loss decreased (-0.774992 --> -0.824992).  Saving model ...
Epoch: 50 cost time: 0.6046562194824219
Epoch: 50, Steps: 3 | Train Loss: 0.355 Vali Loss: 0.805 Vali Acc: 0.825 Test Loss: 0.805 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 51 cost time: 0.5320990085601807
Epoch: 51, Steps: 3 | Train Loss: 0.352 Vali Loss: 0.797 Vali Acc: 0.825 Test Loss: 0.797 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 52 cost time: 0.6353075504302979
Epoch: 52, Steps: 3 | Train Loss: 0.332 Vali Loss: 0.790 Vali Acc: 0.825 Test Loss: 0.790 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 53 cost time: 0.5794737339019775
Epoch: 53, Steps: 3 | Train Loss: 0.315 Vali Loss: 0.783 Vali Acc: 0.850 Test Loss: 0.783 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849992).  Saving model ...
Epoch: 54 cost time: 0.5528051853179932
Epoch: 54, Steps: 3 | Train Loss: 0.317 Vali Loss: 0.775 Vali Acc: 0.875 Test Loss: 0.775 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874992).  Saving model ...
Epoch: 55 cost time: 0.6310973167419434
Epoch: 55, Steps: 3 | Train Loss: 0.323 Vali Loss: 0.766 Vali Acc: 0.825 Test Loss: 0.766 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.5705509185791016
Epoch: 56, Steps: 3 | Train Loss: 0.310 Vali Loss: 0.759 Vali Acc: 0.850 Test Loss: 0.759 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.5817382335662842
Epoch: 57, Steps: 3 | Train Loss: 0.275 Vali Loss: 0.754 Vali Acc: 0.850 Test Loss: 0.754 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.5810730457305908
Epoch: 58, Steps: 3 | Train Loss: 0.275 Vali Loss: 0.746 Vali Acc: 0.850 Test Loss: 0.746 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 0.48744821548461914
Epoch: 59, Steps: 3 | Train Loss: 0.288 Vali Loss: 0.739 Vali Acc: 0.850 Test Loss: 0.739 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 0.666968822479248
Epoch: 60, Steps: 3 | Train Loss: 0.292 Vali Loss: 0.733 Vali Acc: 0.850 Test Loss: 0.733 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 0.7537121772766113
Epoch: 61, Steps: 3 | Train Loss: 0.255 Vali Loss: 0.728 Vali Acc: 0.850 Test Loss: 0.728 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 0.4740445613861084
Epoch: 62, Steps: 3 | Train Loss: 0.284 Vali Loss: 0.723 Vali Acc: 0.850 Test Loss: 0.723 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 0.6546261310577393
Epoch: 63, Steps: 3 | Train Loss: 0.236 Vali Loss: 0.718 Vali Acc: 0.850 Test Loss: 0.718 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 0.6360299587249756
Epoch: 64, Steps: 3 | Train Loss: 0.241 Vali Loss: 0.715 Vali Acc: 0.875 Test Loss: 0.715 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874993).  Saving model ...
Epoch: 65 cost time: 0.49072861671447754
Epoch: 65, Steps: 3 | Train Loss: 0.242 Vali Loss: 0.710 Vali Acc: 0.875 Test Loss: 0.710 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 66 cost time: 0.5743584632873535
Epoch: 66, Steps: 3 | Train Loss: 0.250 Vali Loss: 0.706 Vali Acc: 0.875 Test Loss: 0.706 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 67 cost time: 0.5757176876068115
Epoch: 67, Steps: 3 | Train Loss: 0.226 Vali Loss: 0.701 Vali Acc: 0.875 Test Loss: 0.701 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 68 cost time: 0.5845787525177002
Epoch: 68, Steps: 3 | Train Loss: 0.219 Vali Loss: 0.696 Vali Acc: 0.875 Test Loss: 0.696 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 69 cost time: 0.6749699115753174
Epoch: 69, Steps: 3 | Train Loss: 0.246 Vali Loss: 0.692 Vali Acc: 0.875 Test Loss: 0.692 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 70 cost time: 0.6640334129333496
Epoch: 70, Steps: 3 | Train Loss: 0.212 Vali Loss: 0.687 Vali Acc: 0.875 Test Loss: 0.687 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 71 cost time: 0.5551462173461914
Epoch: 71, Steps: 3 | Train Loss: 0.212 Vali Loss: 0.683 Vali Acc: 0.875 Test Loss: 0.683 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 72 cost time: 0.6839261054992676
Epoch: 72, Steps: 3 | Train Loss: 0.209 Vali Loss: 0.679 Vali Acc: 0.875 Test Loss: 0.679 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 73 cost time: 0.5880281925201416
Epoch: 73, Steps: 3 | Train Loss: 0.208 Vali Loss: 0.675 Vali Acc: 0.875 Test Loss: 0.675 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 74 cost time: 0.5645227432250977
Epoch: 74, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.670 Vali Acc: 0.875 Test Loss: 0.670 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 75 cost time: 0.5452532768249512
Epoch: 75, Steps: 3 | Train Loss: 0.193 Vali Loss: 0.664 Vali Acc: 0.875 Test Loss: 0.664 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 76 cost time: 0.6127195358276367
Epoch: 76, Steps: 3 | Train Loss: 0.178 Vali Loss: 0.661 Vali Acc: 0.875 Test Loss: 0.661 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 77 cost time: 0.8230667114257812
Epoch: 77, Steps: 3 | Train Loss: 0.178 Vali Loss: 0.655 Vali Acc: 0.850 Test Loss: 0.655 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 0.5787308216094971
Epoch: 78, Steps: 3 | Train Loss: 0.177 Vali Loss: 0.649 Vali Acc: 0.850 Test Loss: 0.649 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 0.5599367618560791
Epoch: 79, Steps: 3 | Train Loss: 0.212 Vali Loss: 0.645 Vali Acc: 0.850 Test Loss: 0.645 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 0.6782352924346924
Epoch: 80, Steps: 3 | Train Loss: 0.168 Vali Loss: 0.643 Vali Acc: 0.850 Test Loss: 0.643 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 81 cost time: 0.5416214466094971
Epoch: 81, Steps: 3 | Train Loss: 0.162 Vali Loss: 0.641 Vali Acc: 0.850 Test Loss: 0.641 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 82 cost time: 0.6442816257476807
Epoch: 82, Steps: 3 | Train Loss: 0.154 Vali Loss: 0.638 Vali Acc: 0.850 Test Loss: 0.638 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 83 cost time: 0.5958614349365234
Epoch: 83, Steps: 3 | Train Loss: 0.187 Vali Loss: 0.631 Vali Acc: 0.850 Test Loss: 0.631 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 84 cost time: 0.6296138763427734
Epoch: 84, Steps: 3 | Train Loss: 0.152 Vali Loss: 0.628 Vali Acc: 0.850 Test Loss: 0.628 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 85 cost time: 0.6504292488098145
Epoch: 85, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.623 Vali Acc: 0.850 Test Loss: 0.623 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 86 cost time: 0.6301484107971191
Epoch: 86, Steps: 3 | Train Loss: 0.164 Vali Loss: 0.615 Vali Acc: 0.850 Test Loss: 0.615 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm64_cs10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 15656
model size : 0.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm64_cs9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.0486819744110107
Epoch: 1, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.426 Vali Acc: 0.225 Test Loss: 1.426 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 0.5822858810424805
Epoch: 2, Steps: 3 | Train Loss: 1.358 Vali Loss: 1.419 Vali Acc: 0.225 Test Loss: 1.419 Test Acc: 0.225
Validation loss decreased (-0.224986 --> -0.224986).  Saving model ...
Epoch: 3 cost time: 0.6079542636871338
Epoch: 3, Steps: 3 | Train Loss: 1.365 Vali Loss: 1.413 Vali Acc: 0.225 Test Loss: 1.413 Test Acc: 0.225
Validation loss decreased (-0.224986 --> -0.224986).  Saving model ...
Epoch: 4 cost time: 0.5444092750549316
Epoch: 4, Steps: 3 | Train Loss: 1.340 Vali Loss: 1.405 Vali Acc: 0.225 Test Loss: 1.405 Test Acc: 0.225
Validation loss decreased (-0.224986 --> -0.224986).  Saving model ...
Epoch: 5 cost time: 0.5593287944793701
Epoch: 5, Steps: 3 | Train Loss: 1.306 Vali Loss: 1.396 Vali Acc: 0.250 Test Loss: 1.396 Test Acc: 0.250
Validation loss decreased (-0.224986 --> -0.249986).  Saving model ...
Epoch: 6 cost time: 0.7181432247161865
Epoch: 6, Steps: 3 | Train Loss: 1.304 Vali Loss: 1.385 Vali Acc: 0.300 Test Loss: 1.385 Test Acc: 0.300
Validation loss decreased (-0.249986 --> -0.299986).  Saving model ...
Epoch: 7 cost time: 0.6062440872192383
Epoch: 7, Steps: 3 | Train Loss: 1.273 Vali Loss: 1.372 Vali Acc: 0.325 Test Loss: 1.372 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324986).  Saving model ...
Epoch: 8 cost time: 0.6893050670623779
Epoch: 8, Steps: 3 | Train Loss: 1.254 Vali Loss: 1.359 Vali Acc: 0.325 Test Loss: 1.359 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324986).  Saving model ...
Epoch: 9 cost time: 0.5922048091888428
Epoch: 9, Steps: 3 | Train Loss: 1.226 Vali Loss: 1.346 Vali Acc: 0.350 Test Loss: 1.346 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349987).  Saving model ...
Epoch: 10 cost time: 0.6187217235565186
Epoch: 10, Steps: 3 | Train Loss: 1.175 Vali Loss: 1.331 Vali Acc: 0.375 Test Loss: 1.331 Test Acc: 0.375
Validation loss decreased (-0.349987 --> -0.374987).  Saving model ...
Epoch: 11 cost time: 0.6823067665100098
Epoch: 11, Steps: 3 | Train Loss: 1.163 Vali Loss: 1.316 Vali Acc: 0.375 Test Loss: 1.316 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 12 cost time: 0.5632355213165283
Epoch: 12, Steps: 3 | Train Loss: 1.125 Vali Loss: 1.302 Vali Acc: 0.375 Test Loss: 1.302 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 13 cost time: 0.6618213653564453
Epoch: 13, Steps: 3 | Train Loss: 1.069 Vali Loss: 1.288 Vali Acc: 0.375 Test Loss: 1.288 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 14 cost time: 0.575432300567627
Epoch: 14, Steps: 3 | Train Loss: 1.063 Vali Loss: 1.274 Vali Acc: 0.400 Test Loss: 1.274 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399987).  Saving model ...
Epoch: 15 cost time: 0.6600594520568848
Epoch: 15, Steps: 3 | Train Loss: 1.030 Vali Loss: 1.259 Vali Acc: 0.400 Test Loss: 1.259 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 16 cost time: 0.7266702651977539
Epoch: 16, Steps: 3 | Train Loss: 1.020 Vali Loss: 1.244 Vali Acc: 0.400 Test Loss: 1.244 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399988).  Saving model ...
Epoch: 17 cost time: 0.6564157009124756
Epoch: 17, Steps: 3 | Train Loss: 0.981 Vali Loss: 1.229 Vali Acc: 0.425 Test Loss: 1.229 Test Acc: 0.425
Validation loss decreased (-0.399988 --> -0.424988).  Saving model ...
Epoch: 18 cost time: 0.7287130355834961
Epoch: 18, Steps: 3 | Train Loss: 0.963 Vali Loss: 1.213 Vali Acc: 0.450 Test Loss: 1.213 Test Acc: 0.450
Validation loss decreased (-0.424988 --> -0.449988).  Saving model ...
Epoch: 19 cost time: 0.7557094097137451
Epoch: 19, Steps: 3 | Train Loss: 0.920 Vali Loss: 1.197 Vali Acc: 0.450 Test Loss: 1.197 Test Acc: 0.450
Validation loss decreased (-0.449988 --> -0.449988).  Saving model ...
Epoch: 20 cost time: 0.6149280071258545
Epoch: 20, Steps: 3 | Train Loss: 0.861 Vali Loss: 1.180 Vali Acc: 0.475 Test Loss: 1.180 Test Acc: 0.475
Validation loss decreased (-0.449988 --> -0.474988).  Saving model ...
Epoch: 21 cost time: 0.49558520317077637
Epoch: 21, Steps: 3 | Train Loss: 0.837 Vali Loss: 1.164 Vali Acc: 0.500 Test Loss: 1.164 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499988).  Saving model ...
Epoch: 22 cost time: 0.6005690097808838
Epoch: 22, Steps: 3 | Train Loss: 0.810 Vali Loss: 1.148 Vali Acc: 0.500 Test Loss: 1.148 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499989).  Saving model ...
Epoch: 23 cost time: 0.6833541393280029
Epoch: 23, Steps: 3 | Train Loss: 0.796 Vali Loss: 1.132 Vali Acc: 0.550 Test Loss: 1.132 Test Acc: 0.550
Validation loss decreased (-0.499989 --> -0.549989).  Saving model ...
Epoch: 24 cost time: 0.6060054302215576
Epoch: 24, Steps: 3 | Train Loss: 0.781 Vali Loss: 1.116 Vali Acc: 0.550 Test Loss: 1.116 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 25 cost time: 0.5293114185333252
Epoch: 25, Steps: 3 | Train Loss: 0.758 Vali Loss: 1.102 Vali Acc: 0.550 Test Loss: 1.102 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 26 cost time: 0.6374623775482178
Epoch: 26, Steps: 3 | Train Loss: 0.711 Vali Loss: 1.087 Vali Acc: 0.550 Test Loss: 1.087 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 27 cost time: 0.6064388751983643
Epoch: 27, Steps: 3 | Train Loss: 0.703 Vali Loss: 1.072 Vali Acc: 0.550 Test Loss: 1.072 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 28 cost time: 0.609915018081665
Epoch: 28, Steps: 3 | Train Loss: 0.720 Vali Loss: 1.058 Vali Acc: 0.575 Test Loss: 1.058 Test Acc: 0.575
Validation loss decreased (-0.549989 --> -0.574989).  Saving model ...
Epoch: 29 cost time: 0.5409700870513916
Epoch: 29, Steps: 3 | Train Loss: 0.655 Vali Loss: 1.046 Vali Acc: 0.600 Test Loss: 1.046 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599990).  Saving model ...
Epoch: 30 cost time: 0.6712498664855957
Epoch: 30, Steps: 3 | Train Loss: 0.631 Vali Loss: 1.034 Vali Acc: 0.625 Test Loss: 1.034 Test Acc: 0.625
Validation loss decreased (-0.599990 --> -0.624990).  Saving model ...
Epoch: 31 cost time: 0.7063159942626953
Epoch: 31, Steps: 3 | Train Loss: 0.605 Vali Loss: 1.020 Vali Acc: 0.725 Test Loss: 1.020 Test Acc: 0.725
Validation loss decreased (-0.624990 --> -0.724990).  Saving model ...
Epoch: 32 cost time: 0.5752589702606201
Epoch: 32, Steps: 3 | Train Loss: 0.627 Vali Loss: 1.007 Vali Acc: 0.725 Test Loss: 1.007 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 33 cost time: 0.5156190395355225
Epoch: 33, Steps: 3 | Train Loss: 0.581 Vali Loss: 0.993 Vali Acc: 0.725 Test Loss: 0.993 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 34 cost time: 0.5630037784576416
Epoch: 34, Steps: 3 | Train Loss: 0.561 Vali Loss: 0.979 Vali Acc: 0.725 Test Loss: 0.979 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 35 cost time: 0.5731868743896484
Epoch: 35, Steps: 3 | Train Loss: 0.548 Vali Loss: 0.967 Vali Acc: 0.725 Test Loss: 0.967 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 36 cost time: 0.6826291084289551
Epoch: 36, Steps: 3 | Train Loss: 0.543 Vali Loss: 0.953 Vali Acc: 0.725 Test Loss: 0.953 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 37 cost time: 0.7511923313140869
Epoch: 37, Steps: 3 | Train Loss: 0.532 Vali Loss: 0.939 Vali Acc: 0.725 Test Loss: 0.939 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724991).  Saving model ...
Epoch: 38 cost time: 0.6396126747131348
Epoch: 38, Steps: 3 | Train Loss: 0.524 Vali Loss: 0.926 Vali Acc: 0.725 Test Loss: 0.926 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 39 cost time: 0.5628149509429932
Epoch: 39, Steps: 3 | Train Loss: 0.468 Vali Loss: 0.914 Vali Acc: 0.725 Test Loss: 0.914 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 40 cost time: 0.7973058223724365
Epoch: 40, Steps: 3 | Train Loss: 0.440 Vali Loss: 0.903 Vali Acc: 0.725 Test Loss: 0.903 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 41 cost time: 0.667494535446167
Epoch: 41, Steps: 3 | Train Loss: 0.459 Vali Loss: 0.892 Vali Acc: 0.725 Test Loss: 0.892 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 42 cost time: 0.6328785419464111
Epoch: 42, Steps: 3 | Train Loss: 0.431 Vali Loss: 0.880 Vali Acc: 0.725 Test Loss: 0.880 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 43 cost time: 0.6176037788391113
Epoch: 43, Steps: 3 | Train Loss: 0.433 Vali Loss: 0.870 Vali Acc: 0.750 Test Loss: 0.870 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749991).  Saving model ...
Epoch: 44 cost time: 0.7565927505493164
Epoch: 44, Steps: 3 | Train Loss: 0.428 Vali Loss: 0.861 Vali Acc: 0.750 Test Loss: 0.861 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 45 cost time: 0.7305889129638672
Epoch: 45, Steps: 3 | Train Loss: 0.401 Vali Loss: 0.853 Vali Acc: 0.750 Test Loss: 0.853 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 46 cost time: 0.5532565116882324
Epoch: 46, Steps: 3 | Train Loss: 0.389 Vali Loss: 0.846 Vali Acc: 0.750 Test Loss: 0.846 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 47 cost time: 0.7226526737213135
Epoch: 47, Steps: 3 | Train Loss: 0.369 Vali Loss: 0.838 Vali Acc: 0.750 Test Loss: 0.838 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 48 cost time: 0.6053564548492432
Epoch: 48, Steps: 3 | Train Loss: 0.351 Vali Loss: 0.831 Vali Acc: 0.750 Test Loss: 0.831 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 49 cost time: 0.5860049724578857
Epoch: 49, Steps: 3 | Train Loss: 0.355 Vali Loss: 0.825 Vali Acc: 0.750 Test Loss: 0.825 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 50 cost time: 0.7069404125213623
Epoch: 50, Steps: 3 | Train Loss: 0.342 Vali Loss: 0.818 Vali Acc: 0.750 Test Loss: 0.818 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 51 cost time: 0.5808322429656982
Epoch: 51, Steps: 3 | Train Loss: 0.327 Vali Loss: 0.812 Vali Acc: 0.750 Test Loss: 0.812 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 52 cost time: 0.7537176609039307
Epoch: 52, Steps: 3 | Train Loss: 0.298 Vali Loss: 0.804 Vali Acc: 0.750 Test Loss: 0.804 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 53 cost time: 0.6122560501098633
Epoch: 53, Steps: 3 | Train Loss: 0.307 Vali Loss: 0.797 Vali Acc: 0.750 Test Loss: 0.797 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 54 cost time: 0.7163982391357422
Epoch: 54, Steps: 3 | Train Loss: 0.302 Vali Loss: 0.790 Vali Acc: 0.775 Test Loss: 0.790 Test Acc: 0.775
Validation loss decreased (-0.749992 --> -0.774992).  Saving model ...
Epoch: 55 cost time: 0.6709556579589844
Epoch: 55, Steps: 3 | Train Loss: 0.295 Vali Loss: 0.785 Vali Acc: 0.775 Test Loss: 0.785 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 56 cost time: 0.8302567005157471
Epoch: 56, Steps: 3 | Train Loss: 0.286 Vali Loss: 0.780 Vali Acc: 0.775 Test Loss: 0.780 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 57 cost time: 0.733654260635376
Epoch: 57, Steps: 3 | Train Loss: 0.281 Vali Loss: 0.775 Vali Acc: 0.775 Test Loss: 0.775 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 58 cost time: 0.6523735523223877
Epoch: 58, Steps: 3 | Train Loss: 0.279 Vali Loss: 0.770 Vali Acc: 0.775 Test Loss: 0.770 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 59 cost time: 0.6217968463897705
Epoch: 59, Steps: 3 | Train Loss: 0.280 Vali Loss: 0.764 Vali Acc: 0.775 Test Loss: 0.764 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 60 cost time: 0.5791125297546387
Epoch: 60, Steps: 3 | Train Loss: 0.264 Vali Loss: 0.760 Vali Acc: 0.800 Test Loss: 0.760 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799992).  Saving model ...
Epoch: 61 cost time: 0.5613570213317871
Epoch: 61, Steps: 3 | Train Loss: 0.269 Vali Loss: 0.755 Vali Acc: 0.800 Test Loss: 0.755 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 62 cost time: 0.5976009368896484
Epoch: 62, Steps: 3 | Train Loss: 0.243 Vali Loss: 0.752 Vali Acc: 0.800 Test Loss: 0.752 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 63 cost time: 0.5935494899749756
Epoch: 63, Steps: 3 | Train Loss: 0.235 Vali Loss: 0.749 Vali Acc: 0.800 Test Loss: 0.749 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799993).  Saving model ...
Epoch: 64 cost time: 0.6557965278625488
Epoch: 64, Steps: 3 | Train Loss: 0.242 Vali Loss: 0.745 Vali Acc: 0.775 Test Loss: 0.745 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.7012977600097656
Epoch: 65, Steps: 3 | Train Loss: 0.241 Vali Loss: 0.740 Vali Acc: 0.775 Test Loss: 0.740 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 0.5739388465881348
Epoch: 66, Steps: 3 | Train Loss: 0.211 Vali Loss: 0.737 Vali Acc: 0.775 Test Loss: 0.737 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 0.6938393115997314
Epoch: 67, Steps: 3 | Train Loss: 0.227 Vali Loss: 0.733 Vali Acc: 0.775 Test Loss: 0.733 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 0.6865410804748535
Epoch: 68, Steps: 3 | Train Loss: 0.212 Vali Loss: 0.729 Vali Acc: 0.800 Test Loss: 0.729 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 69 cost time: 0.7367126941680908
Epoch: 69, Steps: 3 | Train Loss: 0.208 Vali Loss: 0.725 Vali Acc: 0.800 Test Loss: 0.725 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 70 cost time: 0.6302595138549805
Epoch: 70, Steps: 3 | Train Loss: 0.189 Vali Loss: 0.722 Vali Acc: 0.800 Test Loss: 0.722 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 71 cost time: 0.8391075134277344
Epoch: 71, Steps: 3 | Train Loss: 0.208 Vali Loss: 0.718 Vali Acc: 0.800 Test Loss: 0.718 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 72 cost time: 0.6615264415740967
Epoch: 72, Steps: 3 | Train Loss: 0.185 Vali Loss: 0.714 Vali Acc: 0.800 Test Loss: 0.714 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 73 cost time: 0.764991283416748
Epoch: 73, Steps: 3 | Train Loss: 0.174 Vali Loss: 0.711 Vali Acc: 0.800 Test Loss: 0.711 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 74 cost time: 0.6983847618103027
Epoch: 74, Steps: 3 | Train Loss: 0.195 Vali Loss: 0.709 Vali Acc: 0.800 Test Loss: 0.709 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 75 cost time: 0.8026800155639648
Epoch: 75, Steps: 3 | Train Loss: 0.197 Vali Loss: 0.708 Vali Acc: 0.800 Test Loss: 0.708 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 76 cost time: 0.6674110889434814
Epoch: 76, Steps: 3 | Train Loss: 0.179 Vali Loss: 0.709 Vali Acc: 0.800 Test Loss: 0.709 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 0.6030542850494385
Epoch: 77, Steps: 3 | Train Loss: 0.164 Vali Loss: 0.709 Vali Acc: 0.800 Test Loss: 0.709 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 0.7266619205474854
Epoch: 78, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.709 Vali Acc: 0.800 Test Loss: 0.709 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 0.6122779846191406
Epoch: 79, Steps: 3 | Train Loss: 0.161 Vali Loss: 0.705 Vali Acc: 0.800 Test Loss: 0.705 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 80 cost time: 0.7244541645050049
Epoch: 80, Steps: 3 | Train Loss: 0.158 Vali Loss: 0.701 Vali Acc: 0.800 Test Loss: 0.701 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 81 cost time: 0.794823408126831
Epoch: 81, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.701 Vali Acc: 0.800 Test Loss: 0.701 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 82 cost time: 0.8148148059844971
Epoch: 82, Steps: 3 | Train Loss: 0.150 Vali Loss: 0.697 Vali Acc: 0.800 Test Loss: 0.697 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 83 cost time: 0.615675687789917
Epoch: 83, Steps: 3 | Train Loss: 0.139 Vali Loss: 0.696 Vali Acc: 0.800 Test Loss: 0.696 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 84 cost time: 0.6191647052764893
Epoch: 84, Steps: 3 | Train Loss: 0.135 Vali Loss: 0.691 Vali Acc: 0.800 Test Loss: 0.691 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 85 cost time: 0.7260696887969971
Epoch: 85, Steps: 3 | Train Loss: 0.133 Vali Loss: 0.683 Vali Acc: 0.800 Test Loss: 0.683 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 86 cost time: 0.8348596096038818
Epoch: 86, Steps: 3 | Train Loss: 0.130 Vali Loss: 0.675 Vali Acc: 0.800 Test Loss: 0.675 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 87 cost time: 0.6592357158660889
Epoch: 87, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.670 Vali Acc: 0.800 Test Loss: 0.670 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 88 cost time: 0.698920488357544
Epoch: 88, Steps: 3 | Train Loss: 0.113 Vali Loss: 0.667 Vali Acc: 0.800 Test Loss: 0.667 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 89 cost time: 0.7034602165222168
Epoch: 89, Steps: 3 | Train Loss: 0.105 Vali Loss: 0.667 Vali Acc: 0.800 Test Loss: 0.667 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 90 cost time: 0.6595196723937988
Epoch: 90, Steps: 3 | Train Loss: 0.106 Vali Loss: 0.664 Vali Acc: 0.800 Test Loss: 0.664 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 91 cost time: 0.8991212844848633
Epoch: 91, Steps: 3 | Train Loss: 0.120 Vali Loss: 0.661 Vali Acc: 0.800 Test Loss: 0.661 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 92 cost time: 0.6667582988739014
Epoch: 92, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.662 Vali Acc: 0.800 Test Loss: 0.662 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 93 cost time: 0.6273126602172852
Epoch: 93, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.659 Vali Acc: 0.800 Test Loss: 0.659 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 94 cost time: 0.8412144184112549
Epoch: 94, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.655 Vali Acc: 0.800 Test Loss: 0.655 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 95 cost time: 0.7650284767150879
Epoch: 95, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.648 Vali Acc: 0.800 Test Loss: 0.648 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799994).  Saving model ...
Epoch: 96 cost time: 0.7313323020935059
Epoch: 96, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.642 Vali Acc: 0.800 Test Loss: 0.642 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 97 cost time: 0.8197536468505859
Epoch: 97, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.635 Vali Acc: 0.800 Test Loss: 0.635 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 98 cost time: 0.7096600532531738
Epoch: 98, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.632 Vali Acc: 0.800 Test Loss: 0.632 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 99 cost time: 0.6051933765411377
Epoch: 99, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.635 Vali Acc: 0.825 Test Loss: 0.635 Test Acc: 0.825
Validation loss decreased (-0.799994 --> -0.824994).  Saving model ...
Epoch: 100 cost time: 0.8535821437835693
Epoch: 100, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.634 Vali Acc: 0.825 Test Loss: 0.634 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm64_cs9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.825
model parameter : 16520
model size : 0.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm64_cs8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4434568881988525
Epoch: 1, Steps: 3 | Train Loss: 1.496 Vali Loss: 1.349 Vali Acc: 0.225 Test Loss: 1.349 Test Acc: 0.225
Validation loss decreased (inf --> -0.224987).  Saving model ...
Epoch: 2 cost time: 0.6196258068084717
Epoch: 2, Steps: 3 | Train Loss: 1.436 Vali Loss: 1.343 Vali Acc: 0.200 Test Loss: 1.343 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7801408767700195
Epoch: 3, Steps: 3 | Train Loss: 1.440 Vali Loss: 1.338 Vali Acc: 0.200 Test Loss: 1.338 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7652895450592041
Epoch: 4, Steps: 3 | Train Loss: 1.429 Vali Loss: 1.331 Vali Acc: 0.200 Test Loss: 1.331 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7625181674957275
Epoch: 5, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.323 Vali Acc: 0.200 Test Loss: 1.323 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7215557098388672
Epoch: 6, Steps: 3 | Train Loss: 1.378 Vali Loss: 1.314 Vali Acc: 0.200 Test Loss: 1.314 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7131185531616211
Epoch: 7, Steps: 3 | Train Loss: 1.354 Vali Loss: 1.304 Vali Acc: 0.300 Test Loss: 1.304 Test Acc: 0.300
Validation loss decreased (-0.224987 --> -0.299987).  Saving model ...
Epoch: 8 cost time: 0.6927356719970703
Epoch: 8, Steps: 3 | Train Loss: 1.342 Vali Loss: 1.294 Vali Acc: 0.375 Test Loss: 1.294 Test Acc: 0.375
Validation loss decreased (-0.299987 --> -0.374987).  Saving model ...
Epoch: 9 cost time: 0.5717847347259521
Epoch: 9, Steps: 3 | Train Loss: 1.292 Vali Loss: 1.283 Vali Acc: 0.500 Test Loss: 1.283 Test Acc: 0.500
Validation loss decreased (-0.374987 --> -0.499987).  Saving model ...
Epoch: 10 cost time: 0.6698343753814697
Epoch: 10, Steps: 3 | Train Loss: 1.281 Vali Loss: 1.271 Vali Acc: 0.525 Test Loss: 1.271 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524987).  Saving model ...
Epoch: 11 cost time: 0.9028067588806152
Epoch: 11, Steps: 3 | Train Loss: 1.262 Vali Loss: 1.258 Vali Acc: 0.600 Test Loss: 1.258 Test Acc: 0.600
Validation loss decreased (-0.524987 --> -0.599987).  Saving model ...
Epoch: 12 cost time: 0.6256728172302246
Epoch: 12, Steps: 3 | Train Loss: 1.208 Vali Loss: 1.246 Vali Acc: 0.625 Test Loss: 1.246 Test Acc: 0.625
Validation loss decreased (-0.599987 --> -0.624988).  Saving model ...
Epoch: 13 cost time: 0.698174238204956
Epoch: 13, Steps: 3 | Train Loss: 1.164 Vali Loss: 1.233 Vali Acc: 0.600 Test Loss: 1.233 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6498808860778809
Epoch: 14, Steps: 3 | Train Loss: 1.128 Vali Loss: 1.219 Vali Acc: 0.625 Test Loss: 1.219 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 15 cost time: 0.9173808097839355
Epoch: 15, Steps: 3 | Train Loss: 1.074 Vali Loss: 1.205 Vali Acc: 0.650 Test Loss: 1.205 Test Acc: 0.650
Validation loss decreased (-0.624988 --> -0.649988).  Saving model ...
Epoch: 16 cost time: 0.7753198146820068
Epoch: 16, Steps: 3 | Train Loss: 1.084 Vali Loss: 1.192 Vali Acc: 0.650 Test Loss: 1.192 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649988).  Saving model ...
Epoch: 17 cost time: 0.7203786373138428
Epoch: 17, Steps: 3 | Train Loss: 1.053 Vali Loss: 1.179 Vali Acc: 0.650 Test Loss: 1.179 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649988).  Saving model ...
Epoch: 18 cost time: 0.7611546516418457
Epoch: 18, Steps: 3 | Train Loss: 1.001 Vali Loss: 1.166 Vali Acc: 0.650 Test Loss: 1.166 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649988).  Saving model ...
Epoch: 19 cost time: 0.6088106632232666
Epoch: 19, Steps: 3 | Train Loss: 1.009 Vali Loss: 1.151 Vali Acc: 0.675 Test Loss: 1.151 Test Acc: 0.675
Validation loss decreased (-0.649988 --> -0.674988).  Saving model ...
Epoch: 20 cost time: 0.6715178489685059
Epoch: 20, Steps: 3 | Train Loss: 0.932 Vali Loss: 1.137 Vali Acc: 0.675 Test Loss: 1.137 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674989).  Saving model ...
Epoch: 21 cost time: 0.6998424530029297
Epoch: 21, Steps: 3 | Train Loss: 0.912 Vali Loss: 1.123 Vali Acc: 0.700 Test Loss: 1.123 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699989).  Saving model ...
Epoch: 22 cost time: 0.6284573078155518
Epoch: 22, Steps: 3 | Train Loss: 0.872 Vali Loss: 1.108 Vali Acc: 0.700 Test Loss: 1.108 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 23 cost time: 0.7799355983734131
Epoch: 23, Steps: 3 | Train Loss: 0.862 Vali Loss: 1.094 Vali Acc: 0.700 Test Loss: 1.094 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 24 cost time: 0.7742750644683838
Epoch: 24, Steps: 3 | Train Loss: 0.793 Vali Loss: 1.080 Vali Acc: 0.700 Test Loss: 1.080 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 25 cost time: 0.6459276676177979
Epoch: 25, Steps: 3 | Train Loss: 0.787 Vali Loss: 1.064 Vali Acc: 0.675 Test Loss: 1.064 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7839462757110596
Epoch: 26, Steps: 3 | Train Loss: 0.787 Vali Loss: 1.050 Vali Acc: 0.675 Test Loss: 1.050 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6850705146789551
Epoch: 27, Steps: 3 | Train Loss: 0.757 Vali Loss: 1.037 Vali Acc: 0.700 Test Loss: 1.037 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699990).  Saving model ...
Epoch: 28 cost time: 0.6037919521331787
Epoch: 28, Steps: 3 | Train Loss: 0.734 Vali Loss: 1.024 Vali Acc: 0.700 Test Loss: 1.024 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 29 cost time: 0.781043291091919
Epoch: 29, Steps: 3 | Train Loss: 0.697 Vali Loss: 1.010 Vali Acc: 0.675 Test Loss: 1.010 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8306515216827393
Epoch: 30, Steps: 3 | Train Loss: 0.698 Vali Loss: 0.997 Vali Acc: 0.675 Test Loss: 0.997 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.7106442451477051
Epoch: 31, Steps: 3 | Train Loss: 0.643 Vali Loss: 0.986 Vali Acc: 0.700 Test Loss: 0.986 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 32 cost time: 0.8483679294586182
Epoch: 32, Steps: 3 | Train Loss: 0.649 Vali Loss: 0.974 Vali Acc: 0.700 Test Loss: 0.974 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 33 cost time: 0.8189082145690918
Epoch: 33, Steps: 3 | Train Loss: 0.595 Vali Loss: 0.963 Vali Acc: 0.725 Test Loss: 0.963 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724990).  Saving model ...
Epoch: 34 cost time: 0.7449719905853271
Epoch: 34, Steps: 3 | Train Loss: 0.565 Vali Loss: 0.951 Vali Acc: 0.700 Test Loss: 0.951 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8496520519256592
Epoch: 35, Steps: 3 | Train Loss: 0.570 Vali Loss: 0.940 Vali Acc: 0.700 Test Loss: 0.940 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.8497273921966553
Epoch: 36, Steps: 3 | Train Loss: 0.568 Vali Loss: 0.928 Vali Acc: 0.700 Test Loss: 0.928 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.7085402011871338
Epoch: 37, Steps: 3 | Train Loss: 0.520 Vali Loss: 0.916 Vali Acc: 0.700 Test Loss: 0.916 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.5686583518981934
Epoch: 38, Steps: 3 | Train Loss: 0.517 Vali Loss: 0.905 Vali Acc: 0.700 Test Loss: 0.905 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.7217063903808594
Epoch: 39, Steps: 3 | Train Loss: 0.467 Vali Loss: 0.894 Vali Acc: 0.700 Test Loss: 0.894 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.6661489009857178
Epoch: 40, Steps: 3 | Train Loss: 0.490 Vali Loss: 0.884 Vali Acc: 0.725 Test Loss: 0.884 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724991).  Saving model ...
Epoch: 41 cost time: 0.8348462581634521
Epoch: 41, Steps: 3 | Train Loss: 0.472 Vali Loss: 0.875 Vali Acc: 0.725 Test Loss: 0.875 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 42 cost time: 0.6821844577789307
Epoch: 42, Steps: 3 | Train Loss: 0.453 Vali Loss: 0.865 Vali Acc: 0.725 Test Loss: 0.865 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 43 cost time: 0.7497344017028809
Epoch: 43, Steps: 3 | Train Loss: 0.415 Vali Loss: 0.856 Vali Acc: 0.750 Test Loss: 0.856 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749991).  Saving model ...
Epoch: 44 cost time: 0.9023544788360596
Epoch: 44, Steps: 3 | Train Loss: 0.407 Vali Loss: 0.846 Vali Acc: 0.750 Test Loss: 0.846 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 45 cost time: 0.9889788627624512
Epoch: 45, Steps: 3 | Train Loss: 0.428 Vali Loss: 0.838 Vali Acc: 0.750 Test Loss: 0.838 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 46 cost time: 0.8109269142150879
Epoch: 46, Steps: 3 | Train Loss: 0.383 Vali Loss: 0.830 Vali Acc: 0.750 Test Loss: 0.830 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 47 cost time: 0.7189087867736816
Epoch: 47, Steps: 3 | Train Loss: 0.394 Vali Loss: 0.822 Vali Acc: 0.750 Test Loss: 0.822 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 48 cost time: 0.6607241630554199
Epoch: 48, Steps: 3 | Train Loss: 0.372 Vali Loss: 0.815 Vali Acc: 0.750 Test Loss: 0.815 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 49 cost time: 0.6415271759033203
Epoch: 49, Steps: 3 | Train Loss: 0.394 Vali Loss: 0.808 Vali Acc: 0.750 Test Loss: 0.808 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 50 cost time: 0.5579385757446289
Epoch: 50, Steps: 3 | Train Loss: 0.347 Vali Loss: 0.803 Vali Acc: 0.775 Test Loss: 0.803 Test Acc: 0.775
Validation loss decreased (-0.749992 --> -0.774992).  Saving model ...
Epoch: 51 cost time: 0.694371223449707
Epoch: 51, Steps: 3 | Train Loss: 0.345 Vali Loss: 0.798 Vali Acc: 0.775 Test Loss: 0.798 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 52 cost time: 0.6667029857635498
Epoch: 52, Steps: 3 | Train Loss: 0.322 Vali Loss: 0.793 Vali Acc: 0.775 Test Loss: 0.793 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 53 cost time: 0.9346451759338379
Epoch: 53, Steps: 3 | Train Loss: 0.316 Vali Loss: 0.788 Vali Acc: 0.775 Test Loss: 0.788 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 54 cost time: 0.8085696697235107
Epoch: 54, Steps: 3 | Train Loss: 0.321 Vali Loss: 0.783 Vali Acc: 0.775 Test Loss: 0.783 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 55 cost time: 0.7085204124450684
Epoch: 55, Steps: 3 | Train Loss: 0.314 Vali Loss: 0.778 Vali Acc: 0.775 Test Loss: 0.778 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 56 cost time: 0.728905439376831
Epoch: 56, Steps: 3 | Train Loss: 0.289 Vali Loss: 0.774 Vali Acc: 0.775 Test Loss: 0.774 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 57 cost time: 0.7586493492126465
Epoch: 57, Steps: 3 | Train Loss: 0.306 Vali Loss: 0.770 Vali Acc: 0.775 Test Loss: 0.770 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 58 cost time: 0.587846040725708
Epoch: 58, Steps: 3 | Train Loss: 0.273 Vali Loss: 0.766 Vali Acc: 0.775 Test Loss: 0.766 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 59 cost time: 0.7286555767059326
Epoch: 59, Steps: 3 | Train Loss: 0.286 Vali Loss: 0.762 Vali Acc: 0.775 Test Loss: 0.762 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 60 cost time: 0.8000576496124268
Epoch: 60, Steps: 3 | Train Loss: 0.268 Vali Loss: 0.758 Vali Acc: 0.775 Test Loss: 0.758 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 61 cost time: 0.9830200672149658
Epoch: 61, Steps: 3 | Train Loss: 0.250 Vali Loss: 0.754 Vali Acc: 0.775 Test Loss: 0.754 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 62 cost time: 0.8672800064086914
Epoch: 62, Steps: 3 | Train Loss: 0.249 Vali Loss: 0.749 Vali Acc: 0.775 Test Loss: 0.749 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774993).  Saving model ...
Epoch: 63 cost time: 0.9449188709259033
Epoch: 63, Steps: 3 | Train Loss: 0.258 Vali Loss: 0.745 Vali Acc: 0.775 Test Loss: 0.745 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 64 cost time: 0.8860809803009033
Epoch: 64, Steps: 3 | Train Loss: 0.233 Vali Loss: 0.741 Vali Acc: 0.775 Test Loss: 0.741 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 65 cost time: 0.7773182392120361
Epoch: 65, Steps: 3 | Train Loss: 0.232 Vali Loss: 0.738 Vali Acc: 0.775 Test Loss: 0.738 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 66 cost time: 0.8377494812011719
Epoch: 66, Steps: 3 | Train Loss: 0.224 Vali Loss: 0.733 Vali Acc: 0.775 Test Loss: 0.733 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 67 cost time: 0.7328498363494873
Epoch: 67, Steps: 3 | Train Loss: 0.222 Vali Loss: 0.730 Vali Acc: 0.775 Test Loss: 0.730 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 68 cost time: 0.6838593482971191
Epoch: 68, Steps: 3 | Train Loss: 0.210 Vali Loss: 0.726 Vali Acc: 0.775 Test Loss: 0.726 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 69 cost time: 0.8228321075439453
Epoch: 69, Steps: 3 | Train Loss: 0.240 Vali Loss: 0.722 Vali Acc: 0.825 Test Loss: 0.722 Test Acc: 0.825
Validation loss decreased (-0.774993 --> -0.824993).  Saving model ...
Epoch: 70 cost time: 0.7881174087524414
Epoch: 70, Steps: 3 | Train Loss: 0.195 Vali Loss: 0.719 Vali Acc: 0.825 Test Loss: 0.719 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 71 cost time: 0.7323427200317383
Epoch: 71, Steps: 3 | Train Loss: 0.203 Vali Loss: 0.716 Vali Acc: 0.825 Test Loss: 0.716 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 72 cost time: 0.810352087020874
Epoch: 72, Steps: 3 | Train Loss: 0.190 Vali Loss: 0.712 Vali Acc: 0.825 Test Loss: 0.712 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 73 cost time: 0.655925989151001
Epoch: 73, Steps: 3 | Train Loss: 0.191 Vali Loss: 0.709 Vali Acc: 0.825 Test Loss: 0.709 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 74 cost time: 0.6952178478240967
Epoch: 74, Steps: 3 | Train Loss: 0.198 Vali Loss: 0.706 Vali Acc: 0.825 Test Loss: 0.706 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 75 cost time: 0.6597895622253418
Epoch: 75, Steps: 3 | Train Loss: 0.168 Vali Loss: 0.704 Vali Acc: 0.825 Test Loss: 0.704 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 76 cost time: 0.6451835632324219
Epoch: 76, Steps: 3 | Train Loss: 0.186 Vali Loss: 0.701 Vali Acc: 0.800 Test Loss: 0.701 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 0.6708614826202393
Epoch: 77, Steps: 3 | Train Loss: 0.162 Vali Loss: 0.699 Vali Acc: 0.800 Test Loss: 0.699 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 0.7533860206604004
Epoch: 78, Steps: 3 | Train Loss: 0.168 Vali Loss: 0.698 Vali Acc: 0.825 Test Loss: 0.698 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 79 cost time: 0.6062688827514648
Epoch: 79, Steps: 3 | Train Loss: 0.178 Vali Loss: 0.697 Vali Acc: 0.825 Test Loss: 0.697 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 80 cost time: 0.5061149597167969
Epoch: 80, Steps: 3 | Train Loss: 0.176 Vali Loss: 0.697 Vali Acc: 0.825 Test Loss: 0.697 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 81 cost time: 0.5630567073822021
Epoch: 81, Steps: 3 | Train Loss: 0.159 Vali Loss: 0.698 Vali Acc: 0.825 Test Loss: 0.698 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 0.8500416278839111
Epoch: 82, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.699 Vali Acc: 0.825 Test Loss: 0.699 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 0.8114683628082275
Epoch: 83, Steps: 3 | Train Loss: 0.180 Vali Loss: 0.698 Vali Acc: 0.825 Test Loss: 0.698 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 84 cost time: 0.9101588726043701
Epoch: 84, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.700 Vali Acc: 0.825 Test Loss: 0.700 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 85 cost time: 0.7183372974395752
Epoch: 85, Steps: 3 | Train Loss: 0.142 Vali Loss: 0.699 Vali Acc: 0.825 Test Loss: 0.699 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 86 cost time: 0.875633716583252
Epoch: 86, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.697 Vali Acc: 0.825 Test Loss: 0.697 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 87 cost time: 0.7878031730651855
Epoch: 87, Steps: 3 | Train Loss: 0.138 Vali Loss: 0.694 Vali Acc: 0.825 Test Loss: 0.694 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 88 cost time: 0.7186088562011719
Epoch: 88, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.691 Vali Acc: 0.825 Test Loss: 0.691 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 89 cost time: 0.6354982852935791
Epoch: 89, Steps: 3 | Train Loss: 0.152 Vali Loss: 0.689 Vali Acc: 0.825 Test Loss: 0.689 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 90 cost time: 0.7028570175170898
Epoch: 90, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.688 Vali Acc: 0.825 Test Loss: 0.688 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 91 cost time: 0.6754617691040039
Epoch: 91, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.689 Vali Acc: 0.825 Test Loss: 0.689 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 0.8432986736297607
Epoch: 92, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.688 Vali Acc: 0.825 Test Loss: 0.688 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 93 cost time: 0.5929491519927979
Epoch: 93, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.687 Vali Acc: 0.825 Test Loss: 0.687 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 94 cost time: 0.6971487998962402
Epoch: 94, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.684 Vali Acc: 0.825 Test Loss: 0.684 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 95 cost time: 0.6885638236999512
Epoch: 95, Steps: 3 | Train Loss: 0.113 Vali Loss: 0.682 Vali Acc: 0.825 Test Loss: 0.682 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 96 cost time: 0.6485464572906494
Epoch: 96, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.681 Vali Acc: 0.825 Test Loss: 0.681 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 97 cost time: 0.8132903575897217
Epoch: 97, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.679 Vali Acc: 0.825 Test Loss: 0.679 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 98 cost time: 0.7666354179382324
Epoch: 98, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.678 Vali Acc: 0.825 Test Loss: 0.678 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 99 cost time: 0.8189711570739746
Epoch: 99, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.675 Vali Acc: 0.825 Test Loss: 0.675 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 100 cost time: 0.6370010375976562
Epoch: 100, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.672 Vali Acc: 0.825 Test Loss: 0.672 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm64_cs8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.825
model parameter : 16142
model size : 0.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm64_cs7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.953317165374756
Epoch: 1, Steps: 3 | Train Loss: 1.425 Vali Loss: 1.334 Vali Acc: 0.225 Test Loss: 1.334 Test Acc: 0.225
Validation loss decreased (inf --> -0.224987).  Saving model ...
Epoch: 2 cost time: 0.6380512714385986
Epoch: 2, Steps: 3 | Train Loss: 1.395 Vali Loss: 1.326 Vali Acc: 0.275 Test Loss: 1.326 Test Acc: 0.275
Validation loss decreased (-0.224987 --> -0.274987).  Saving model ...
Epoch: 3 cost time: 0.735759973526001
Epoch: 3, Steps: 3 | Train Loss: 1.378 Vali Loss: 1.321 Vali Acc: 0.275 Test Loss: 1.321 Test Acc: 0.275
Validation loss decreased (-0.274987 --> -0.274987).  Saving model ...
Epoch: 4 cost time: 0.6558465957641602
Epoch: 4, Steps: 3 | Train Loss: 1.368 Vali Loss: 1.313 Vali Acc: 0.275 Test Loss: 1.313 Test Acc: 0.275
Validation loss decreased (-0.274987 --> -0.274987).  Saving model ...
Epoch: 5 cost time: 0.6401665210723877
Epoch: 5, Steps: 3 | Train Loss: 1.358 Vali Loss: 1.303 Vali Acc: 0.275 Test Loss: 1.303 Test Acc: 0.275
Validation loss decreased (-0.274987 --> -0.274987).  Saving model ...
Epoch: 6 cost time: 0.6690974235534668
Epoch: 6, Steps: 3 | Train Loss: 1.346 Vali Loss: 1.293 Vali Acc: 0.275 Test Loss: 1.293 Test Acc: 0.275
Validation loss decreased (-0.274987 --> -0.274987).  Saving model ...
Epoch: 7 cost time: 0.9619550704956055
Epoch: 7, Steps: 3 | Train Loss: 1.296 Vali Loss: 1.281 Vali Acc: 0.300 Test Loss: 1.281 Test Acc: 0.300
Validation loss decreased (-0.274987 --> -0.299987).  Saving model ...
Epoch: 8 cost time: 0.6602671146392822
Epoch: 8, Steps: 3 | Train Loss: 1.262 Vali Loss: 1.269 Vali Acc: 0.325 Test Loss: 1.269 Test Acc: 0.325
Validation loss decreased (-0.299987 --> -0.324987).  Saving model ...
Epoch: 9 cost time: 0.656907320022583
Epoch: 9, Steps: 3 | Train Loss: 1.263 Vali Loss: 1.256 Vali Acc: 0.450 Test Loss: 1.256 Test Acc: 0.450
Validation loss decreased (-0.324987 --> -0.449987).  Saving model ...
Epoch: 10 cost time: 0.6241886615753174
Epoch: 10, Steps: 3 | Train Loss: 1.200 Vali Loss: 1.243 Vali Acc: 0.475 Test Loss: 1.243 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474988).  Saving model ...
Epoch: 11 cost time: 0.66373610496521
Epoch: 11, Steps: 3 | Train Loss: 1.174 Vali Loss: 1.229 Vali Acc: 0.525 Test Loss: 1.229 Test Acc: 0.525
Validation loss decreased (-0.474988 --> -0.524988).  Saving model ...
Epoch: 12 cost time: 0.695023775100708
Epoch: 12, Steps: 3 | Train Loss: 1.125 Vali Loss: 1.216 Vali Acc: 0.575 Test Loss: 1.216 Test Acc: 0.575
Validation loss decreased (-0.524988 --> -0.574988).  Saving model ...
Epoch: 13 cost time: 0.8420510292053223
Epoch: 13, Steps: 3 | Train Loss: 1.126 Vali Loss: 1.201 Vali Acc: 0.625 Test Loss: 1.201 Test Acc: 0.625
Validation loss decreased (-0.574988 --> -0.624988).  Saving model ...
Epoch: 14 cost time: 0.7075552940368652
Epoch: 14, Steps: 3 | Train Loss: 1.070 Vali Loss: 1.186 Vali Acc: 0.650 Test Loss: 1.186 Test Acc: 0.650
Validation loss decreased (-0.624988 --> -0.649988).  Saving model ...
Epoch: 15 cost time: 0.6964607238769531
Epoch: 15, Steps: 3 | Train Loss: 1.053 Vali Loss: 1.172 Vali Acc: 0.675 Test Loss: 1.172 Test Acc: 0.675
Validation loss decreased (-0.649988 --> -0.674988).  Saving model ...
Epoch: 16 cost time: 0.6809213161468506
Epoch: 16, Steps: 3 | Train Loss: 0.984 Vali Loss: 1.157 Vali Acc: 0.750 Test Loss: 1.157 Test Acc: 0.750
Validation loss decreased (-0.674988 --> -0.749988).  Saving model ...
Epoch: 17 cost time: 0.7589774131774902
Epoch: 17, Steps: 3 | Train Loss: 0.990 Vali Loss: 1.142 Vali Acc: 0.750 Test Loss: 1.142 Test Acc: 0.750
Validation loss decreased (-0.749988 --> -0.749989).  Saving model ...
Epoch: 18 cost time: 0.8411335945129395
Epoch: 18, Steps: 3 | Train Loss: 0.963 Vali Loss: 1.129 Vali Acc: 0.725 Test Loss: 1.129 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6763451099395752
Epoch: 19, Steps: 3 | Train Loss: 0.911 Vali Loss: 1.115 Vali Acc: 0.700 Test Loss: 1.115 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7523572444915771
Epoch: 20, Steps: 3 | Train Loss: 0.925 Vali Loss: 1.101 Vali Acc: 0.725 Test Loss: 1.101 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6098639965057373
Epoch: 21, Steps: 3 | Train Loss: 0.859 Vali Loss: 1.089 Vali Acc: 0.725 Test Loss: 1.089 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7764501571655273
Epoch: 22, Steps: 3 | Train Loss: 0.829 Vali Loss: 1.076 Vali Acc: 0.750 Test Loss: 1.076 Test Acc: 0.750
Validation loss decreased (-0.749989 --> -0.749989).  Saving model ...
Epoch: 23 cost time: 0.5397861003875732
Epoch: 23, Steps: 3 | Train Loss: 0.777 Vali Loss: 1.062 Vali Acc: 0.750 Test Loss: 1.062 Test Acc: 0.750
Validation loss decreased (-0.749989 --> -0.749989).  Saving model ...
Epoch: 24 cost time: 0.689401388168335
Epoch: 24, Steps: 3 | Train Loss: 0.775 Vali Loss: 1.047 Vali Acc: 0.750 Test Loss: 1.047 Test Acc: 0.750
Validation loss decreased (-0.749989 --> -0.749990).  Saving model ...
Epoch: 25 cost time: 0.6219837665557861
Epoch: 25, Steps: 3 | Train Loss: 0.731 Vali Loss: 1.032 Vali Acc: 0.750 Test Loss: 1.032 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 26 cost time: 0.7362565994262695
Epoch: 26, Steps: 3 | Train Loss: 0.730 Vali Loss: 1.018 Vali Acc: 0.725 Test Loss: 1.018 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9540023803710938
Epoch: 27, Steps: 3 | Train Loss: 0.666 Vali Loss: 1.002 Vali Acc: 0.725 Test Loss: 1.002 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9092385768890381
Epoch: 28, Steps: 3 | Train Loss: 0.674 Vali Loss: 0.988 Vali Acc: 0.725 Test Loss: 0.988 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.8305201530456543
Epoch: 29, Steps: 3 | Train Loss: 0.645 Vali Loss: 0.973 Vali Acc: 0.725 Test Loss: 0.973 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.8938767910003662
Epoch: 30, Steps: 3 | Train Loss: 0.619 Vali Loss: 0.960 Vali Acc: 0.725 Test Loss: 0.960 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.6895184516906738
Epoch: 31, Steps: 3 | Train Loss: 0.622 Vali Loss: 0.946 Vali Acc: 0.725 Test Loss: 0.946 Test Acc: 0.725
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.0122337341308594
Epoch: 32, Steps: 3 | Train Loss: 0.599 Vali Loss: 0.934 Vali Acc: 0.725 Test Loss: 0.934 Test Acc: 0.725
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.7366023063659668
Epoch: 33, Steps: 3 | Train Loss: 0.580 Vali Loss: 0.922 Vali Acc: 0.725 Test Loss: 0.922 Test Acc: 0.725
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.0870811939239502
Epoch: 34, Steps: 3 | Train Loss: 0.592 Vali Loss: 0.909 Vali Acc: 0.725 Test Loss: 0.909 Test Acc: 0.725
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.7673423290252686
Epoch: 35, Steps: 3 | Train Loss: 0.539 Vali Loss: 0.899 Vali Acc: 0.800 Test Loss: 0.899 Test Acc: 0.800
Validation loss decreased (-0.749990 --> -0.799991).  Saving model ...
Epoch: 36 cost time: 0.7001612186431885
Epoch: 36, Steps: 3 | Train Loss: 0.506 Vali Loss: 0.889 Vali Acc: 0.800 Test Loss: 0.889 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 37 cost time: 0.766869306564331
Epoch: 37, Steps: 3 | Train Loss: 0.515 Vali Loss: 0.879 Vali Acc: 0.800 Test Loss: 0.879 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 38 cost time: 0.6914162635803223
Epoch: 38, Steps: 3 | Train Loss: 0.476 Vali Loss: 0.870 Vali Acc: 0.800 Test Loss: 0.870 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 39 cost time: 0.7523658275604248
Epoch: 39, Steps: 3 | Train Loss: 0.474 Vali Loss: 0.861 Vali Acc: 0.800 Test Loss: 0.861 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 40 cost time: 0.7489242553710938
Epoch: 40, Steps: 3 | Train Loss: 0.424 Vali Loss: 0.851 Vali Acc: 0.800 Test Loss: 0.851 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 41 cost time: 0.6210546493530273
Epoch: 41, Steps: 3 | Train Loss: 0.437 Vali Loss: 0.843 Vali Acc: 0.825 Test Loss: 0.843 Test Acc: 0.825
Validation loss decreased (-0.799991 --> -0.824992).  Saving model ...
Epoch: 42 cost time: 0.6980361938476562
Epoch: 42, Steps: 3 | Train Loss: 0.409 Vali Loss: 0.833 Vali Acc: 0.825 Test Loss: 0.833 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 43 cost time: 0.8509101867675781
Epoch: 43, Steps: 3 | Train Loss: 0.402 Vali Loss: 0.826 Vali Acc: 0.850 Test Loss: 0.826 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849992).  Saving model ...
Epoch: 44 cost time: 0.9553732872009277
Epoch: 44, Steps: 3 | Train Loss: 0.409 Vali Loss: 0.818 Vali Acc: 0.850 Test Loss: 0.818 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 45 cost time: 1.0988075733184814
Epoch: 45, Steps: 3 | Train Loss: 0.407 Vali Loss: 0.811 Vali Acc: 0.850 Test Loss: 0.811 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 46 cost time: 0.7523291110992432
Epoch: 46, Steps: 3 | Train Loss: 0.349 Vali Loss: 0.803 Vali Acc: 0.850 Test Loss: 0.803 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 47 cost time: 0.8476946353912354
Epoch: 47, Steps: 3 | Train Loss: 0.354 Vali Loss: 0.796 Vali Acc: 0.850 Test Loss: 0.796 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 48 cost time: 0.8581809997558594
Epoch: 48, Steps: 3 | Train Loss: 0.340 Vali Loss: 0.789 Vali Acc: 0.850 Test Loss: 0.789 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 49 cost time: 0.7457187175750732
Epoch: 49, Steps: 3 | Train Loss: 0.347 Vali Loss: 0.783 Vali Acc: 0.850 Test Loss: 0.783 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 50 cost time: 0.7039787769317627
Epoch: 50, Steps: 3 | Train Loss: 0.309 Vali Loss: 0.777 Vali Acc: 0.850 Test Loss: 0.777 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 51 cost time: 0.8123767375946045
Epoch: 51, Steps: 3 | Train Loss: 0.341 Vali Loss: 0.771 Vali Acc: 0.850 Test Loss: 0.771 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 52 cost time: 0.779320240020752
Epoch: 52, Steps: 3 | Train Loss: 0.301 Vali Loss: 0.767 Vali Acc: 0.850 Test Loss: 0.767 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 53 cost time: 0.6603903770446777
Epoch: 53, Steps: 3 | Train Loss: 0.300 Vali Loss: 0.762 Vali Acc: 0.825 Test Loss: 0.762 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.8240296840667725
Epoch: 54, Steps: 3 | Train Loss: 0.280 Vali Loss: 0.758 Vali Acc: 0.825 Test Loss: 0.758 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.8402214050292969
Epoch: 55, Steps: 3 | Train Loss: 0.299 Vali Loss: 0.754 Vali Acc: 0.825 Test Loss: 0.754 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.7976820468902588
Epoch: 56, Steps: 3 | Train Loss: 0.303 Vali Loss: 0.749 Vali Acc: 0.825 Test Loss: 0.749 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.8914027214050293
Epoch: 57, Steps: 3 | Train Loss: 0.266 Vali Loss: 0.746 Vali Acc: 0.825 Test Loss: 0.746 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 0.7426314353942871
Epoch: 58, Steps: 3 | Train Loss: 0.266 Vali Loss: 0.741 Vali Acc: 0.825 Test Loss: 0.741 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 0.7955517768859863
Epoch: 59, Steps: 3 | Train Loss: 0.257 Vali Loss: 0.738 Vali Acc: 0.825 Test Loss: 0.738 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 0.731297492980957
Epoch: 60, Steps: 3 | Train Loss: 0.238 Vali Loss: 0.735 Vali Acc: 0.825 Test Loss: 0.735 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 0.7003674507141113
Epoch: 61, Steps: 3 | Train Loss: 0.257 Vali Loss: 0.733 Vali Acc: 0.825 Test Loss: 0.733 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 0.7062907218933105
Epoch: 62, Steps: 3 | Train Loss: 0.230 Vali Loss: 0.731 Vali Acc: 0.825 Test Loss: 0.731 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm64_cs7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.85
model parameter : 16330
model size : 0.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm64_cs6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6030054092407227
Epoch: 1, Steps: 3 | Train Loss: 1.488 Vali Loss: 1.555 Vali Acc: 0.150 Test Loss: 1.555 Test Acc: 0.150
Validation loss decreased (inf --> -0.149984).  Saving model ...
Epoch: 2 cost time: 0.8156695365905762
Epoch: 2, Steps: 3 | Train Loss: 1.471 Vali Loss: 1.549 Vali Acc: 0.150 Test Loss: 1.549 Test Acc: 0.150
Validation loss decreased (-0.149984 --> -0.149985).  Saving model ...
Epoch: 3 cost time: 0.6444735527038574
Epoch: 3, Steps: 3 | Train Loss: 1.437 Vali Loss: 1.543 Vali Acc: 0.150 Test Loss: 1.543 Test Acc: 0.150
Validation loss decreased (-0.149985 --> -0.149985).  Saving model ...
Epoch: 4 cost time: 0.8198955059051514
Epoch: 4, Steps: 3 | Train Loss: 1.411 Vali Loss: 1.535 Vali Acc: 0.150 Test Loss: 1.535 Test Acc: 0.150
Validation loss decreased (-0.149985 --> -0.149985).  Saving model ...
Epoch: 5 cost time: 0.7339088916778564
Epoch: 5, Steps: 3 | Train Loss: 1.421 Vali Loss: 1.526 Vali Acc: 0.150 Test Loss: 1.526 Test Acc: 0.150
Validation loss decreased (-0.149985 --> -0.149985).  Saving model ...
Epoch: 6 cost time: 0.6334078311920166
Epoch: 6, Steps: 3 | Train Loss: 1.394 Vali Loss: 1.515 Vali Acc: 0.250 Test Loss: 1.515 Test Acc: 0.250
Validation loss decreased (-0.149985 --> -0.249985).  Saving model ...
Epoch: 7 cost time: 0.6462116241455078
Epoch: 7, Steps: 3 | Train Loss: 1.354 Vali Loss: 1.503 Vali Acc: 0.325 Test Loss: 1.503 Test Acc: 0.325
Validation loss decreased (-0.249985 --> -0.324985).  Saving model ...
Epoch: 8 cost time: 0.6683094501495361
Epoch: 8, Steps: 3 | Train Loss: 1.337 Vali Loss: 1.491 Vali Acc: 0.400 Test Loss: 1.491 Test Acc: 0.400
Validation loss decreased (-0.324985 --> -0.399985).  Saving model ...
Epoch: 9 cost time: 0.5885725021362305
Epoch: 9, Steps: 3 | Train Loss: 1.326 Vali Loss: 1.478 Vali Acc: 0.450 Test Loss: 1.478 Test Acc: 0.450
Validation loss decreased (-0.399985 --> -0.449985).  Saving model ...
Epoch: 10 cost time: 0.7557744979858398
Epoch: 10, Steps: 3 | Train Loss: 1.274 Vali Loss: 1.465 Vali Acc: 0.450 Test Loss: 1.465 Test Acc: 0.450
Validation loss decreased (-0.449985 --> -0.449985).  Saving model ...
Epoch: 11 cost time: 0.7405176162719727
Epoch: 11, Steps: 3 | Train Loss: 1.243 Vali Loss: 1.451 Vali Acc: 0.475 Test Loss: 1.451 Test Acc: 0.475
Validation loss decreased (-0.449985 --> -0.474985).  Saving model ...
Epoch: 12 cost time: 0.6640470027923584
Epoch: 12, Steps: 3 | Train Loss: 1.202 Vali Loss: 1.436 Vali Acc: 0.500 Test Loss: 1.436 Test Acc: 0.500
Validation loss decreased (-0.474985 --> -0.499986).  Saving model ...
Epoch: 13 cost time: 0.5768065452575684
Epoch: 13, Steps: 3 | Train Loss: 1.192 Vali Loss: 1.421 Vali Acc: 0.500 Test Loss: 1.421 Test Acc: 0.500
Validation loss decreased (-0.499986 --> -0.499986).  Saving model ...
Epoch: 14 cost time: 0.7464597225189209
Epoch: 14, Steps: 3 | Train Loss: 1.131 Vali Loss: 1.406 Vali Acc: 0.550 Test Loss: 1.406 Test Acc: 0.550
Validation loss decreased (-0.499986 --> -0.549986).  Saving model ...
Epoch: 15 cost time: 0.683114767074585
Epoch: 15, Steps: 3 | Train Loss: 1.106 Vali Loss: 1.390 Vali Acc: 0.550 Test Loss: 1.390 Test Acc: 0.550
Validation loss decreased (-0.549986 --> -0.549986).  Saving model ...
Epoch: 16 cost time: 0.613701343536377
Epoch: 16, Steps: 3 | Train Loss: 1.043 Vali Loss: 1.374 Vali Acc: 0.550 Test Loss: 1.374 Test Acc: 0.550
Validation loss decreased (-0.549986 --> -0.549986).  Saving model ...
Epoch: 17 cost time: 0.7540576457977295
Epoch: 17, Steps: 3 | Train Loss: 1.060 Vali Loss: 1.358 Vali Acc: 0.575 Test Loss: 1.358 Test Acc: 0.575
Validation loss decreased (-0.549986 --> -0.574986).  Saving model ...
Epoch: 18 cost time: 0.8236057758331299
Epoch: 18, Steps: 3 | Train Loss: 1.017 Vali Loss: 1.342 Vali Acc: 0.575 Test Loss: 1.342 Test Acc: 0.575
Validation loss decreased (-0.574986 --> -0.574987).  Saving model ...
Epoch: 19 cost time: 0.6183340549468994
Epoch: 19, Steps: 3 | Train Loss: 0.985 Vali Loss: 1.327 Vali Acc: 0.575 Test Loss: 1.327 Test Acc: 0.575
Validation loss decreased (-0.574987 --> -0.574987).  Saving model ...
Epoch: 20 cost time: 0.8520915508270264
Epoch: 20, Steps: 3 | Train Loss: 0.992 Vali Loss: 1.311 Vali Acc: 0.575 Test Loss: 1.311 Test Acc: 0.575
Validation loss decreased (-0.574987 --> -0.574987).  Saving model ...
Epoch: 21 cost time: 0.7278919219970703
Epoch: 21, Steps: 3 | Train Loss: 0.916 Vali Loss: 1.294 Vali Acc: 0.575 Test Loss: 1.294 Test Acc: 0.575
Validation loss decreased (-0.574987 --> -0.574987).  Saving model ...
Epoch: 22 cost time: 0.7009704113006592
Epoch: 22, Steps: 3 | Train Loss: 0.879 Vali Loss: 1.278 Vali Acc: 0.575 Test Loss: 1.278 Test Acc: 0.575
Validation loss decreased (-0.574987 --> -0.574987).  Saving model ...
Epoch: 23 cost time: 0.7576098442077637
Epoch: 23, Steps: 3 | Train Loss: 0.846 Vali Loss: 1.261 Vali Acc: 0.575 Test Loss: 1.261 Test Acc: 0.575
Validation loss decreased (-0.574987 --> -0.574987).  Saving model ...
Epoch: 24 cost time: 0.8309750556945801
Epoch: 24, Steps: 3 | Train Loss: 0.852 Vali Loss: 1.245 Vali Acc: 0.575 Test Loss: 1.245 Test Acc: 0.575
Validation loss decreased (-0.574987 --> -0.574988).  Saving model ...
Epoch: 25 cost time: 0.7490782737731934
Epoch: 25, Steps: 3 | Train Loss: 0.767 Vali Loss: 1.229 Vali Acc: 0.575 Test Loss: 1.229 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 26 cost time: 0.5896389484405518
Epoch: 26, Steps: 3 | Train Loss: 0.765 Vali Loss: 1.211 Vali Acc: 0.600 Test Loss: 1.211 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599988).  Saving model ...
Epoch: 27 cost time: 0.7678601741790771
Epoch: 27, Steps: 3 | Train Loss: 0.764 Vali Loss: 1.195 Vali Acc: 0.625 Test Loss: 1.195 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624988).  Saving model ...
Epoch: 28 cost time: 0.5919723510742188
Epoch: 28, Steps: 3 | Train Loss: 0.743 Vali Loss: 1.180 Vali Acc: 0.625 Test Loss: 1.180 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 29 cost time: 0.5854361057281494
Epoch: 29, Steps: 3 | Train Loss: 0.710 Vali Loss: 1.165 Vali Acc: 0.625 Test Loss: 1.165 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 30 cost time: 0.7967216968536377
Epoch: 30, Steps: 3 | Train Loss: 0.669 Vali Loss: 1.150 Vali Acc: 0.625 Test Loss: 1.150 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624989).  Saving model ...
Epoch: 31 cost time: 0.7972915172576904
Epoch: 31, Steps: 3 | Train Loss: 0.687 Vali Loss: 1.135 Vali Acc: 0.625 Test Loss: 1.135 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 32 cost time: 0.5705461502075195
Epoch: 32, Steps: 3 | Train Loss: 0.626 Vali Loss: 1.122 Vali Acc: 0.625 Test Loss: 1.122 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 33 cost time: 0.8340251445770264
Epoch: 33, Steps: 3 | Train Loss: 0.632 Vali Loss: 1.108 Vali Acc: 0.675 Test Loss: 1.108 Test Acc: 0.675
Validation loss decreased (-0.624989 --> -0.674989).  Saving model ...
Epoch: 34 cost time: 0.8567562103271484
Epoch: 34, Steps: 3 | Train Loss: 0.583 Vali Loss: 1.095 Vali Acc: 0.675 Test Loss: 1.095 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 35 cost time: 0.5592951774597168
Epoch: 35, Steps: 3 | Train Loss: 0.552 Vali Loss: 1.082 Vali Acc: 0.675 Test Loss: 1.082 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 36 cost time: 0.6761758327484131
Epoch: 36, Steps: 3 | Train Loss: 0.557 Vali Loss: 1.069 Vali Acc: 0.675 Test Loss: 1.069 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 37 cost time: 0.7079622745513916
Epoch: 37, Steps: 3 | Train Loss: 0.548 Vali Loss: 1.055 Vali Acc: 0.700 Test Loss: 1.055 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699989).  Saving model ...
Epoch: 38 cost time: 0.5641679763793945
Epoch: 38, Steps: 3 | Train Loss: 0.505 Vali Loss: 1.041 Vali Acc: 0.700 Test Loss: 1.041 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699990).  Saving model ...
Epoch: 39 cost time: 0.7565457820892334
Epoch: 39, Steps: 3 | Train Loss: 0.513 Vali Loss: 1.028 Vali Acc: 0.700 Test Loss: 1.028 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 40 cost time: 0.9905705451965332
Epoch: 40, Steps: 3 | Train Loss: 0.450 Vali Loss: 1.013 Vali Acc: 0.700 Test Loss: 1.013 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 41 cost time: 0.8597345352172852
Epoch: 41, Steps: 3 | Train Loss: 0.470 Vali Loss: 1.000 Vali Acc: 0.700 Test Loss: 1.000 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 42 cost time: 0.7449240684509277
Epoch: 42, Steps: 3 | Train Loss: 0.450 Vali Loss: 0.988 Vali Acc: 0.700 Test Loss: 0.988 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 43 cost time: 0.8009040355682373
Epoch: 43, Steps: 3 | Train Loss: 0.439 Vali Loss: 0.975 Vali Acc: 0.700 Test Loss: 0.975 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 44 cost time: 0.7539966106414795
Epoch: 44, Steps: 3 | Train Loss: 0.408 Vali Loss: 0.962 Vali Acc: 0.725 Test Loss: 0.962 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724990).  Saving model ...
Epoch: 45 cost time: 0.8190639019012451
Epoch: 45, Steps: 3 | Train Loss: 0.394 Vali Loss: 0.950 Vali Acc: 0.725 Test Loss: 0.950 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724991).  Saving model ...
Epoch: 46 cost time: 0.8066720962524414
Epoch: 46, Steps: 3 | Train Loss: 0.408 Vali Loss: 0.937 Vali Acc: 0.750 Test Loss: 0.937 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749991).  Saving model ...
Epoch: 47 cost time: 1.1622231006622314
Epoch: 47, Steps: 3 | Train Loss: 0.364 Vali Loss: 0.924 Vali Acc: 0.750 Test Loss: 0.924 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 48 cost time: 0.8443012237548828
Epoch: 48, Steps: 3 | Train Loss: 0.375 Vali Loss: 0.912 Vali Acc: 0.750 Test Loss: 0.912 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 49 cost time: 0.7809178829193115
Epoch: 49, Steps: 3 | Train Loss: 0.350 Vali Loss: 0.902 Vali Acc: 0.750 Test Loss: 0.902 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 50 cost time: 0.9742429256439209
Epoch: 50, Steps: 3 | Train Loss: 0.381 Vali Loss: 0.891 Vali Acc: 0.750 Test Loss: 0.891 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 51 cost time: 0.8627810478210449
Epoch: 51, Steps: 3 | Train Loss: 0.328 Vali Loss: 0.882 Vali Acc: 0.750 Test Loss: 0.882 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 52 cost time: 0.6976542472839355
Epoch: 52, Steps: 3 | Train Loss: 0.324 Vali Loss: 0.873 Vali Acc: 0.750 Test Loss: 0.873 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 53 cost time: 0.7773792743682861
Epoch: 53, Steps: 3 | Train Loss: 0.305 Vali Loss: 0.862 Vali Acc: 0.750 Test Loss: 0.862 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 54 cost time: 0.9443995952606201
Epoch: 54, Steps: 3 | Train Loss: 0.297 Vali Loss: 0.852 Vali Acc: 0.775 Test Loss: 0.852 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774991).  Saving model ...
Epoch: 55 cost time: 0.6794180870056152
Epoch: 55, Steps: 3 | Train Loss: 0.300 Vali Loss: 0.841 Vali Acc: 0.775 Test Loss: 0.841 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774992).  Saving model ...
Epoch: 56 cost time: 0.7289366722106934
Epoch: 56, Steps: 3 | Train Loss: 0.293 Vali Loss: 0.829 Vali Acc: 0.775 Test Loss: 0.829 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 57 cost time: 0.9029791355133057
Epoch: 57, Steps: 3 | Train Loss: 0.267 Vali Loss: 0.819 Vali Acc: 0.775 Test Loss: 0.819 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 58 cost time: 1.2407186031341553
Epoch: 58, Steps: 3 | Train Loss: 0.284 Vali Loss: 0.808 Vali Acc: 0.775 Test Loss: 0.808 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 59 cost time: 0.8088598251342773
Epoch: 59, Steps: 3 | Train Loss: 0.253 Vali Loss: 0.796 Vali Acc: 0.775 Test Loss: 0.796 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 60 cost time: 0.8822016716003418
Epoch: 60, Steps: 3 | Train Loss: 0.263 Vali Loss: 0.783 Vali Acc: 0.775 Test Loss: 0.783 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 61 cost time: 1.0141751766204834
Epoch: 61, Steps: 3 | Train Loss: 0.246 Vali Loss: 0.771 Vali Acc: 0.775 Test Loss: 0.771 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 62 cost time: 0.6745190620422363
Epoch: 62, Steps: 3 | Train Loss: 0.225 Vali Loss: 0.755 Vali Acc: 0.775 Test Loss: 0.755 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 63 cost time: 0.9154000282287598
Epoch: 63, Steps: 3 | Train Loss: 0.222 Vali Loss: 0.739 Vali Acc: 0.775 Test Loss: 0.739 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774993).  Saving model ...
Epoch: 64 cost time: 0.7587001323699951
Epoch: 64, Steps: 3 | Train Loss: 0.229 Vali Loss: 0.724 Vali Acc: 0.775 Test Loss: 0.724 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 65 cost time: 0.8878450393676758
Epoch: 65, Steps: 3 | Train Loss: 0.207 Vali Loss: 0.709 Vali Acc: 0.775 Test Loss: 0.709 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 66 cost time: 0.9047081470489502
Epoch: 66, Steps: 3 | Train Loss: 0.202 Vali Loss: 0.694 Vali Acc: 0.775 Test Loss: 0.694 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 67 cost time: 0.9197964668273926
Epoch: 67, Steps: 3 | Train Loss: 0.193 Vali Loss: 0.678 Vali Acc: 0.775 Test Loss: 0.678 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 68 cost time: 0.7792778015136719
Epoch: 68, Steps: 3 | Train Loss: 0.188 Vali Loss: 0.661 Vali Acc: 0.775 Test Loss: 0.661 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 69 cost time: 0.7487828731536865
Epoch: 69, Steps: 3 | Train Loss: 0.176 Vali Loss: 0.643 Vali Acc: 0.800 Test Loss: 0.643 Test Acc: 0.800
Validation loss decreased (-0.774993 --> -0.799994).  Saving model ...
Epoch: 70 cost time: 0.7601456642150879
Epoch: 70, Steps: 3 | Train Loss: 0.195 Vali Loss: 0.626 Vali Acc: 0.800 Test Loss: 0.626 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 71 cost time: 0.9900081157684326
Epoch: 71, Steps: 3 | Train Loss: 0.158 Vali Loss: 0.608 Vali Acc: 0.800 Test Loss: 0.608 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 72 cost time: 0.8068809509277344
Epoch: 72, Steps: 3 | Train Loss: 0.160 Vali Loss: 0.594 Vali Acc: 0.800 Test Loss: 0.594 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 73 cost time: 0.9781041145324707
Epoch: 73, Steps: 3 | Train Loss: 0.149 Vali Loss: 0.577 Vali Acc: 0.800 Test Loss: 0.577 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 74 cost time: 0.7725589275360107
Epoch: 74, Steps: 3 | Train Loss: 0.145 Vali Loss: 0.563 Vali Acc: 0.800 Test Loss: 0.563 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 75 cost time: 0.6935293674468994
Epoch: 75, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.546 Vali Acc: 0.800 Test Loss: 0.546 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799995).  Saving model ...
Epoch: 76 cost time: 0.835759162902832
Epoch: 76, Steps: 3 | Train Loss: 0.121 Vali Loss: 0.529 Vali Acc: 0.800 Test Loss: 0.529 Test Acc: 0.800
Validation loss decreased (-0.799995 --> -0.799995).  Saving model ...
Epoch: 77 cost time: 0.7362208366394043
Epoch: 77, Steps: 3 | Train Loss: 0.135 Vali Loss: 0.513 Vali Acc: 0.825 Test Loss: 0.513 Test Acc: 0.825
Validation loss decreased (-0.799995 --> -0.824995).  Saving model ...
Epoch: 78 cost time: 0.7694075107574463
Epoch: 78, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.497 Vali Acc: 0.825 Test Loss: 0.497 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 79 cost time: 1.0615341663360596
Epoch: 79, Steps: 3 | Train Loss: 0.109 Vali Loss: 0.482 Vali Acc: 0.825 Test Loss: 0.482 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 80 cost time: 0.8647964000701904
Epoch: 80, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.467 Vali Acc: 0.825 Test Loss: 0.467 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 81 cost time: 0.6038479804992676
Epoch: 81, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.451 Vali Acc: 0.850 Test Loss: 0.451 Test Acc: 0.850
Validation loss decreased (-0.824995 --> -0.849995).  Saving model ...
Epoch: 82 cost time: 0.8792412281036377
Epoch: 82, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.431 Vali Acc: 0.850 Test Loss: 0.431 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849996).  Saving model ...
Epoch: 83 cost time: 0.7682285308837891
Epoch: 83, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.413 Vali Acc: 0.875 Test Loss: 0.413 Test Acc: 0.875
Validation loss decreased (-0.849996 --> -0.874996).  Saving model ...
Epoch: 84 cost time: 0.7632038593292236
Epoch: 84, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.401 Vali Acc: 0.875 Test Loss: 0.401 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 85 cost time: 0.7473924160003662
Epoch: 85, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.387 Vali Acc: 0.875 Test Loss: 0.387 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 86 cost time: 0.8865351676940918
Epoch: 86, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.378 Vali Acc: 0.875 Test Loss: 0.378 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 87 cost time: 0.7587699890136719
Epoch: 87, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.370 Vali Acc: 0.875 Test Loss: 0.370 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 88 cost time: 0.7170882225036621
Epoch: 88, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.362 Vali Acc: 0.900 Test Loss: 0.362 Test Acc: 0.900
Validation loss decreased (-0.874996 --> -0.899996).  Saving model ...
Epoch: 89 cost time: 0.6564364433288574
Epoch: 89, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.350 Vali Acc: 0.900 Test Loss: 0.350 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 90 cost time: 0.7904317378997803
Epoch: 90, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.334 Vali Acc: 0.900 Test Loss: 0.334 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 91 cost time: 0.7238802909851074
Epoch: 91, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.313 Vali Acc: 0.900 Test Loss: 0.313 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 92 cost time: 0.826970100402832
Epoch: 92, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.296 Vali Acc: 0.900 Test Loss: 0.296 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 93 cost time: 0.786550760269165
Epoch: 93, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.284 Vali Acc: 0.900 Test Loss: 0.284 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 94 cost time: 0.7218003273010254
Epoch: 94, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.271 Vali Acc: 0.900 Test Loss: 0.271 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 95 cost time: 0.7127928733825684
Epoch: 95, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.261 Vali Acc: 0.900 Test Loss: 0.261 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 96 cost time: 0.8025338649749756
Epoch: 96, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.250 Vali Acc: 0.900 Test Loss: 0.250 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899998).  Saving model ...
Epoch: 97 cost time: 0.9068291187286377
Epoch: 97, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.238 Vali Acc: 0.900 Test Loss: 0.238 Test Acc: 0.900
Validation loss decreased (-0.899998 --> -0.899998).  Saving model ...
Epoch: 98 cost time: 0.8623049259185791
Epoch: 98, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.227 Vali Acc: 0.900 Test Loss: 0.227 Test Acc: 0.900
Validation loss decreased (-0.899998 --> -0.899998).  Saving model ...
Epoch: 99 cost time: 0.7288365364074707
Epoch: 99, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.211 Vali Acc: 0.900 Test Loss: 0.211 Test Acc: 0.900
Validation loss decreased (-0.899998 --> -0.899998).  Saving model ...
Epoch: 100 cost time: 0.7978999614715576
Epoch: 100, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.197 Vali Acc: 0.900 Test Loss: 0.197 Test Acc: 0.900
Validation loss decreased (-0.899998 --> -0.899998).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm64_cs6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 16134
model size : 0.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm64_cs5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.2113935947418213
Epoch: 1, Steps: 3 | Train Loss: 1.418 Vali Loss: 1.336 Vali Acc: 0.350 Test Loss: 1.336 Test Acc: 0.350
Validation loss decreased (inf --> -0.349987).  Saving model ...
Epoch: 2 cost time: 0.626335859298706
Epoch: 2, Steps: 3 | Train Loss: 1.408 Vali Loss: 1.329 Vali Acc: 0.350 Test Loss: 1.329 Test Acc: 0.350
Validation loss decreased (-0.349987 --> -0.349987).  Saving model ...
Epoch: 3 cost time: 0.7908129692077637
Epoch: 3, Steps: 3 | Train Loss: 1.383 Vali Loss: 1.323 Vali Acc: 0.350 Test Loss: 1.323 Test Acc: 0.350
Validation loss decreased (-0.349987 --> -0.349987).  Saving model ...
Epoch: 4 cost time: 0.667133092880249
Epoch: 4, Steps: 3 | Train Loss: 1.343 Vali Loss: 1.316 Vali Acc: 0.350 Test Loss: 1.316 Test Acc: 0.350
Validation loss decreased (-0.349987 --> -0.349987).  Saving model ...
Epoch: 5 cost time: 0.7849352359771729
Epoch: 5, Steps: 3 | Train Loss: 1.343 Vali Loss: 1.306 Vali Acc: 0.350 Test Loss: 1.306 Test Acc: 0.350
Validation loss decreased (-0.349987 --> -0.349987).  Saving model ...
Epoch: 6 cost time: 0.6312503814697266
Epoch: 6, Steps: 3 | Train Loss: 1.312 Vali Loss: 1.295 Vali Acc: 0.350 Test Loss: 1.295 Test Acc: 0.350
Validation loss decreased (-0.349987 --> -0.349987).  Saving model ...
Epoch: 7 cost time: 0.9829890727996826
Epoch: 7, Steps: 3 | Train Loss: 1.288 Vali Loss: 1.284 Vali Acc: 0.375 Test Loss: 1.284 Test Acc: 0.375
Validation loss decreased (-0.349987 --> -0.374987).  Saving model ...
Epoch: 8 cost time: 0.704193115234375
Epoch: 8, Steps: 3 | Train Loss: 1.266 Vali Loss: 1.270 Vali Acc: 0.400 Test Loss: 1.270 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399987).  Saving model ...
Epoch: 9 cost time: 0.6449379920959473
Epoch: 9, Steps: 3 | Train Loss: 1.239 Vali Loss: 1.257 Vali Acc: 0.450 Test Loss: 1.257 Test Acc: 0.450
Validation loss decreased (-0.399987 --> -0.449987).  Saving model ...
Epoch: 10 cost time: 0.7814960479736328
Epoch: 10, Steps: 3 | Train Loss: 1.227 Vali Loss: 1.242 Vali Acc: 0.475 Test Loss: 1.242 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474988).  Saving model ...
Epoch: 11 cost time: 0.8261280059814453
Epoch: 11, Steps: 3 | Train Loss: 1.180 Vali Loss: 1.227 Vali Acc: 0.525 Test Loss: 1.227 Test Acc: 0.525
Validation loss decreased (-0.474988 --> -0.524988).  Saving model ...
Epoch: 12 cost time: 0.7233390808105469
Epoch: 12, Steps: 3 | Train Loss: 1.149 Vali Loss: 1.212 Vali Acc: 0.550 Test Loss: 1.212 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 13 cost time: 0.7637689113616943
Epoch: 13, Steps: 3 | Train Loss: 1.138 Vali Loss: 1.197 Vali Acc: 0.575 Test Loss: 1.197 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 14 cost time: 0.7602529525756836
Epoch: 14, Steps: 3 | Train Loss: 1.107 Vali Loss: 1.182 Vali Acc: 0.575 Test Loss: 1.182 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 15 cost time: 0.6611125469207764
Epoch: 15, Steps: 3 | Train Loss: 1.051 Vali Loss: 1.166 Vali Acc: 0.625 Test Loss: 1.166 Test Acc: 0.625
Validation loss decreased (-0.574988 --> -0.624988).  Saving model ...
Epoch: 16 cost time: 0.7118480205535889
Epoch: 16, Steps: 3 | Train Loss: 1.007 Vali Loss: 1.150 Vali Acc: 0.625 Test Loss: 1.150 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624989).  Saving model ...
Epoch: 17 cost time: 0.8064379692077637
Epoch: 17, Steps: 3 | Train Loss: 0.988 Vali Loss: 1.133 Vali Acc: 0.625 Test Loss: 1.133 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 18 cost time: 0.7413437366485596
Epoch: 18, Steps: 3 | Train Loss: 0.970 Vali Loss: 1.116 Vali Acc: 0.650 Test Loss: 1.116 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 19 cost time: 0.8232555389404297
Epoch: 19, Steps: 3 | Train Loss: 0.968 Vali Loss: 1.099 Vali Acc: 0.650 Test Loss: 1.099 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 20 cost time: 0.7113246917724609
Epoch: 20, Steps: 3 | Train Loss: 0.870 Vali Loss: 1.083 Vali Acc: 0.650 Test Loss: 1.083 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 21 cost time: 0.7062077522277832
Epoch: 21, Steps: 3 | Train Loss: 0.873 Vali Loss: 1.069 Vali Acc: 0.675 Test Loss: 1.069 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674989).  Saving model ...
Epoch: 22 cost time: 0.8621842861175537
Epoch: 22, Steps: 3 | Train Loss: 0.825 Vali Loss: 1.054 Vali Acc: 0.700 Test Loss: 1.054 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699989).  Saving model ...
Epoch: 23 cost time: 0.8671760559082031
Epoch: 23, Steps: 3 | Train Loss: 0.837 Vali Loss: 1.038 Vali Acc: 0.700 Test Loss: 1.038 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699990).  Saving model ...
Epoch: 24 cost time: 0.8189582824707031
Epoch: 24, Steps: 3 | Train Loss: 0.809 Vali Loss: 1.024 Vali Acc: 0.675 Test Loss: 1.024 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7257914543151855
Epoch: 25, Steps: 3 | Train Loss: 0.752 Vali Loss: 1.007 Vali Acc: 0.675 Test Loss: 1.007 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8502864837646484
Epoch: 26, Steps: 3 | Train Loss: 0.745 Vali Loss: 0.991 Vali Acc: 0.675 Test Loss: 0.991 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.6085386276245117
Epoch: 27, Steps: 3 | Train Loss: 0.725 Vali Loss: 0.976 Vali Acc: 0.675 Test Loss: 0.976 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.7842421531677246
Epoch: 28, Steps: 3 | Train Loss: 0.716 Vali Loss: 0.961 Vali Acc: 0.675 Test Loss: 0.961 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.8811769485473633
Epoch: 29, Steps: 3 | Train Loss: 0.663 Vali Loss: 0.946 Vali Acc: 0.725 Test Loss: 0.946 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724991).  Saving model ...
Epoch: 30 cost time: 0.7709481716156006
Epoch: 30, Steps: 3 | Train Loss: 0.641 Vali Loss: 0.931 Vali Acc: 0.750 Test Loss: 0.931 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749991).  Saving model ...
Epoch: 31 cost time: 0.9115164279937744
Epoch: 31, Steps: 3 | Train Loss: 0.606 Vali Loss: 0.916 Vali Acc: 0.775 Test Loss: 0.916 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774991).  Saving model ...
Epoch: 32 cost time: 0.8323259353637695
Epoch: 32, Steps: 3 | Train Loss: 0.589 Vali Loss: 0.901 Vali Acc: 0.775 Test Loss: 0.901 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 33 cost time: 0.787097692489624
Epoch: 33, Steps: 3 | Train Loss: 0.617 Vali Loss: 0.884 Vali Acc: 0.775 Test Loss: 0.884 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 34 cost time: 0.7266261577606201
Epoch: 34, Steps: 3 | Train Loss: 0.548 Vali Loss: 0.870 Vali Acc: 0.775 Test Loss: 0.870 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 35 cost time: 0.8741612434387207
Epoch: 35, Steps: 3 | Train Loss: 0.542 Vali Loss: 0.855 Vali Acc: 0.775 Test Loss: 0.855 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 36 cost time: 0.8518176078796387
Epoch: 36, Steps: 3 | Train Loss: 0.505 Vali Loss: 0.841 Vali Acc: 0.775 Test Loss: 0.841 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774992).  Saving model ...
Epoch: 37 cost time: 0.7632958889007568
Epoch: 37, Steps: 3 | Train Loss: 0.509 Vali Loss: 0.826 Vali Acc: 0.775 Test Loss: 0.826 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 38 cost time: 0.7574315071105957
Epoch: 38, Steps: 3 | Train Loss: 0.486 Vali Loss: 0.811 Vali Acc: 0.775 Test Loss: 0.811 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 39 cost time: 0.7328512668609619
Epoch: 39, Steps: 3 | Train Loss: 0.487 Vali Loss: 0.796 Vali Acc: 0.775 Test Loss: 0.796 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 40 cost time: 0.7149820327758789
Epoch: 40, Steps: 3 | Train Loss: 0.481 Vali Loss: 0.780 Vali Acc: 0.800 Test Loss: 0.780 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799992).  Saving model ...
Epoch: 41 cost time: 0.7264456748962402
Epoch: 41, Steps: 3 | Train Loss: 0.434 Vali Loss: 0.764 Vali Acc: 0.825 Test Loss: 0.764 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824992).  Saving model ...
Epoch: 42 cost time: 0.7173285484313965
Epoch: 42, Steps: 3 | Train Loss: 0.426 Vali Loss: 0.748 Vali Acc: 0.825 Test Loss: 0.748 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824993).  Saving model ...
Epoch: 43 cost time: 0.7449276447296143
Epoch: 43, Steps: 3 | Train Loss: 0.394 Vali Loss: 0.733 Vali Acc: 0.800 Test Loss: 0.733 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.7423610687255859
Epoch: 44, Steps: 3 | Train Loss: 0.405 Vali Loss: 0.717 Vali Acc: 0.825 Test Loss: 0.717 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 45 cost time: 0.777245044708252
Epoch: 45, Steps: 3 | Train Loss: 0.368 Vali Loss: 0.701 Vali Acc: 0.825 Test Loss: 0.701 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 46 cost time: 0.9570670127868652
Epoch: 46, Steps: 3 | Train Loss: 0.388 Vali Loss: 0.685 Vali Acc: 0.825 Test Loss: 0.685 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 47 cost time: 0.6898791790008545
Epoch: 47, Steps: 3 | Train Loss: 0.379 Vali Loss: 0.667 Vali Acc: 0.825 Test Loss: 0.667 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 48 cost time: 0.6369485855102539
Epoch: 48, Steps: 3 | Train Loss: 0.324 Vali Loss: 0.650 Vali Acc: 0.825 Test Loss: 0.650 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824994).  Saving model ...
Epoch: 49 cost time: 0.7366161346435547
Epoch: 49, Steps: 3 | Train Loss: 0.308 Vali Loss: 0.633 Vali Acc: 0.825 Test Loss: 0.633 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 50 cost time: 0.750572919845581
Epoch: 50, Steps: 3 | Train Loss: 0.315 Vali Loss: 0.617 Vali Acc: 0.825 Test Loss: 0.617 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 51 cost time: 0.6119608879089355
Epoch: 51, Steps: 3 | Train Loss: 0.310 Vali Loss: 0.601 Vali Acc: 0.825 Test Loss: 0.601 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 52 cost time: 0.8445217609405518
Epoch: 52, Steps: 3 | Train Loss: 0.312 Vali Loss: 0.584 Vali Acc: 0.850 Test Loss: 0.584 Test Acc: 0.850
Validation loss decreased (-0.824994 --> -0.849994).  Saving model ...
Epoch: 53 cost time: 0.7808752059936523
Epoch: 53, Steps: 3 | Train Loss: 0.301 Vali Loss: 0.569 Vali Acc: 0.850 Test Loss: 0.569 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 54 cost time: 0.7392294406890869
Epoch: 54, Steps: 3 | Train Loss: 0.267 Vali Loss: 0.552 Vali Acc: 0.850 Test Loss: 0.552 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 55 cost time: 0.8398809432983398
Epoch: 55, Steps: 3 | Train Loss: 0.270 Vali Loss: 0.534 Vali Acc: 0.850 Test Loss: 0.534 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 56 cost time: 0.7180333137512207
Epoch: 56, Steps: 3 | Train Loss: 0.256 Vali Loss: 0.517 Vali Acc: 0.850 Test Loss: 0.517 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 57 cost time: 0.7363770008087158
Epoch: 57, Steps: 3 | Train Loss: 0.286 Vali Loss: 0.498 Vali Acc: 0.850 Test Loss: 0.498 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 58 cost time: 0.5089850425720215
Epoch: 58, Steps: 3 | Train Loss: 0.244 Vali Loss: 0.477 Vali Acc: 0.850 Test Loss: 0.477 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 59 cost time: 0.6458265781402588
Epoch: 59, Steps: 3 | Train Loss: 0.259 Vali Loss: 0.459 Vali Acc: 0.850 Test Loss: 0.459 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 60 cost time: 0.6272921562194824
Epoch: 60, Steps: 3 | Train Loss: 0.223 Vali Loss: 0.443 Vali Acc: 0.850 Test Loss: 0.443 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849996).  Saving model ...
Epoch: 61 cost time: 0.7155647277832031
Epoch: 61, Steps: 3 | Train Loss: 0.213 Vali Loss: 0.426 Vali Acc: 0.875 Test Loss: 0.426 Test Acc: 0.875
Validation loss decreased (-0.849996 --> -0.874996).  Saving model ...
Epoch: 62 cost time: 0.7196192741394043
Epoch: 62, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.408 Vali Acc: 0.875 Test Loss: 0.408 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 63 cost time: 0.7754619121551514
Epoch: 63, Steps: 3 | Train Loss: 0.211 Vali Loss: 0.391 Vali Acc: 0.875 Test Loss: 0.391 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 64 cost time: 0.9136524200439453
Epoch: 64, Steps: 3 | Train Loss: 0.200 Vali Loss: 0.373 Vali Acc: 0.875 Test Loss: 0.373 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 65 cost time: 1.0545413494110107
Epoch: 65, Steps: 3 | Train Loss: 0.178 Vali Loss: 0.354 Vali Acc: 0.900 Test Loss: 0.354 Test Acc: 0.900
Validation loss decreased (-0.874996 --> -0.899996).  Saving model ...
Epoch: 66 cost time: 0.8022587299346924
Epoch: 66, Steps: 3 | Train Loss: 0.183 Vali Loss: 0.334 Vali Acc: 0.925 Test Loss: 0.334 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924997).  Saving model ...
Epoch: 67 cost time: 0.7397723197937012
Epoch: 67, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.316 Vali Acc: 0.950 Test Loss: 0.316 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 68 cost time: 0.5647361278533936
Epoch: 68, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.298 Vali Acc: 0.950 Test Loss: 0.298 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 69 cost time: 0.9920225143432617
Epoch: 69, Steps: 3 | Train Loss: 0.158 Vali Loss: 0.278 Vali Acc: 0.950 Test Loss: 0.278 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 70 cost time: 0.6908998489379883
Epoch: 70, Steps: 3 | Train Loss: 0.132 Vali Loss: 0.255 Vali Acc: 0.950 Test Loss: 0.255 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 71 cost time: 0.6653263568878174
Epoch: 71, Steps: 3 | Train Loss: 0.138 Vali Loss: 0.231 Vali Acc: 0.950 Test Loss: 0.231 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 72 cost time: 0.8748564720153809
Epoch: 72, Steps: 3 | Train Loss: 0.128 Vali Loss: 0.208 Vali Acc: 0.975 Test Loss: 0.208 Test Acc: 0.975
Validation loss decreased (-0.949998 --> -0.974998).  Saving model ...
Epoch: 73 cost time: 0.6971113681793213
Epoch: 73, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.190 Vali Acc: 0.975 Test Loss: 0.190 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 74 cost time: 0.7867450714111328
Epoch: 74, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.173 Vali Acc: 0.975 Test Loss: 0.173 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 75 cost time: 0.7203199863433838
Epoch: 75, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.158 Vali Acc: 0.975 Test Loss: 0.158 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 76 cost time: 0.8493866920471191
Epoch: 76, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.145 Vali Acc: 0.975 Test Loss: 0.145 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 77 cost time: 0.7820947170257568
Epoch: 77, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.129 Vali Acc: 1.000 Test Loss: 0.129 Test Acc: 1.000
Validation loss decreased (-0.974999 --> -0.999999).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm64_cs5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 16136
model size : 0.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm32_cs50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5309507846832275
Epoch: 1, Steps: 3 | Train Loss: 1.421 Vali Loss: 1.404 Vali Acc: 0.200 Test Loss: 1.404 Test Acc: 0.200
Validation loss decreased (inf --> -0.199986).  Saving model ...
Epoch: 2 cost time: 0.602332592010498
Epoch: 2, Steps: 3 | Train Loss: 1.348 Vali Loss: 1.397 Vali Acc: 0.200 Test Loss: 1.397 Test Acc: 0.200
Validation loss decreased (-0.199986 --> -0.199986).  Saving model ...
Epoch: 3 cost time: 0.7964432239532471
Epoch: 3, Steps: 3 | Train Loss: 1.400 Vali Loss: 1.392 Vali Acc: 0.200 Test Loss: 1.392 Test Acc: 0.200
Validation loss decreased (-0.199986 --> -0.199986).  Saving model ...
Epoch: 4 cost time: 0.7107255458831787
Epoch: 4, Steps: 3 | Train Loss: 1.385 Vali Loss: 1.385 Vali Acc: 0.225 Test Loss: 1.385 Test Acc: 0.225
Validation loss decreased (-0.199986 --> -0.224986).  Saving model ...
Epoch: 5 cost time: 0.8041813373565674
Epoch: 5, Steps: 3 | Train Loss: 1.352 Vali Loss: 1.376 Vali Acc: 0.250 Test Loss: 1.376 Test Acc: 0.250
Validation loss decreased (-0.224986 --> -0.249986).  Saving model ...
Epoch: 6 cost time: 0.6706092357635498
Epoch: 6, Steps: 3 | Train Loss: 1.353 Vali Loss: 1.366 Vali Acc: 0.275 Test Loss: 1.366 Test Acc: 0.275
Validation loss decreased (-0.249986 --> -0.274986).  Saving model ...
Epoch: 7 cost time: 0.824195146560669
Epoch: 7, Steps: 3 | Train Loss: 1.326 Vali Loss: 1.355 Vali Acc: 0.275 Test Loss: 1.355 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274986).  Saving model ...
Epoch: 8 cost time: 0.5985212326049805
Epoch: 8, Steps: 3 | Train Loss: 1.274 Vali Loss: 1.342 Vali Acc: 0.325 Test Loss: 1.342 Test Acc: 0.325
Validation loss decreased (-0.274986 --> -0.324987).  Saving model ...
Epoch: 9 cost time: 0.678717851638794
Epoch: 9, Steps: 3 | Train Loss: 1.248 Vali Loss: 1.329 Vali Acc: 0.325 Test Loss: 1.329 Test Acc: 0.325
Validation loss decreased (-0.324987 --> -0.324987).  Saving model ...
Epoch: 10 cost time: 0.8088111877441406
Epoch: 10, Steps: 3 | Train Loss: 1.248 Vali Loss: 1.317 Vali Acc: 0.350 Test Loss: 1.317 Test Acc: 0.350
Validation loss decreased (-0.324987 --> -0.349987).  Saving model ...
Epoch: 11 cost time: 0.7526905536651611
Epoch: 11, Steps: 3 | Train Loss: 1.212 Vali Loss: 1.303 Vali Acc: 0.375 Test Loss: 1.303 Test Acc: 0.375
Validation loss decreased (-0.349987 --> -0.374987).  Saving model ...
Epoch: 12 cost time: 0.9057416915893555
Epoch: 12, Steps: 3 | Train Loss: 1.174 Vali Loss: 1.289 Vali Acc: 0.500 Test Loss: 1.289 Test Acc: 0.500
Validation loss decreased (-0.374987 --> -0.499987).  Saving model ...
Epoch: 13 cost time: 0.6976480484008789
Epoch: 13, Steps: 3 | Train Loss: 1.132 Vali Loss: 1.274 Vali Acc: 0.500 Test Loss: 1.274 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 14 cost time: 0.6629467010498047
Epoch: 14, Steps: 3 | Train Loss: 1.101 Vali Loss: 1.258 Vali Acc: 0.475 Test Loss: 1.258 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8819053173065186
Epoch: 15, Steps: 3 | Train Loss: 1.077 Vali Loss: 1.243 Vali Acc: 0.475 Test Loss: 1.243 Test Acc: 0.475
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8991260528564453
Epoch: 16, Steps: 3 | Train Loss: 1.061 Vali Loss: 1.227 Vali Acc: 0.500 Test Loss: 1.227 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499988).  Saving model ...
Epoch: 17 cost time: 0.5481076240539551
Epoch: 17, Steps: 3 | Train Loss: 1.007 Vali Loss: 1.211 Vali Acc: 0.550 Test Loss: 1.211 Test Acc: 0.550
Validation loss decreased (-0.499988 --> -0.549988).  Saving model ...
Epoch: 18 cost time: 0.6174542903900146
Epoch: 18, Steps: 3 | Train Loss: 0.987 Vali Loss: 1.194 Vali Acc: 0.575 Test Loss: 1.194 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 19 cost time: 0.5719361305236816
Epoch: 19, Steps: 3 | Train Loss: 0.962 Vali Loss: 1.177 Vali Acc: 0.575 Test Loss: 1.177 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 20 cost time: 0.6161539554595947
Epoch: 20, Steps: 3 | Train Loss: 0.911 Vali Loss: 1.162 Vali Acc: 0.575 Test Loss: 1.162 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 21 cost time: 0.6308743953704834
Epoch: 21, Steps: 3 | Train Loss: 0.904 Vali Loss: 1.145 Vali Acc: 0.575 Test Loss: 1.145 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574989).  Saving model ...
Epoch: 22 cost time: 0.6445167064666748
Epoch: 22, Steps: 3 | Train Loss: 0.855 Vali Loss: 1.128 Vali Acc: 0.575 Test Loss: 1.128 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 23 cost time: 0.64202880859375
Epoch: 23, Steps: 3 | Train Loss: 0.849 Vali Loss: 1.112 Vali Acc: 0.600 Test Loss: 1.112 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599989).  Saving model ...
Epoch: 24 cost time: 0.6484715938568115
Epoch: 24, Steps: 3 | Train Loss: 0.792 Vali Loss: 1.096 Vali Acc: 0.625 Test Loss: 1.096 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 25 cost time: 0.688478946685791
Epoch: 25, Steps: 3 | Train Loss: 0.781 Vali Loss: 1.080 Vali Acc: 0.675 Test Loss: 1.080 Test Acc: 0.675
Validation loss decreased (-0.624989 --> -0.674989).  Saving model ...
Epoch: 26 cost time: 0.5916886329650879
Epoch: 26, Steps: 3 | Train Loss: 0.752 Vali Loss: 1.064 Vali Acc: 0.675 Test Loss: 1.064 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 27 cost time: 0.5579540729522705
Epoch: 27, Steps: 3 | Train Loss: 0.743 Vali Loss: 1.049 Vali Acc: 0.675 Test Loss: 1.049 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674990).  Saving model ...
Epoch: 28 cost time: 0.4912247657775879
Epoch: 28, Steps: 3 | Train Loss: 0.738 Vali Loss: 1.033 Vali Acc: 0.675 Test Loss: 1.033 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 29 cost time: 0.6850430965423584
Epoch: 29, Steps: 3 | Train Loss: 0.689 Vali Loss: 1.017 Vali Acc: 0.725 Test Loss: 1.017 Test Acc: 0.725
Validation loss decreased (-0.674990 --> -0.724990).  Saving model ...
Epoch: 30 cost time: 0.6680586338043213
Epoch: 30, Steps: 3 | Train Loss: 0.673 Vali Loss: 1.000 Vali Acc: 0.725 Test Loss: 1.000 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 31 cost time: 0.7142729759216309
Epoch: 31, Steps: 3 | Train Loss: 0.631 Vali Loss: 0.984 Vali Acc: 0.725 Test Loss: 0.984 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 32 cost time: 0.656358003616333
Epoch: 32, Steps: 3 | Train Loss: 0.613 Vali Loss: 0.969 Vali Acc: 0.725 Test Loss: 0.969 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 33 cost time: 0.5807371139526367
Epoch: 33, Steps: 3 | Train Loss: 0.572 Vali Loss: 0.954 Vali Acc: 0.725 Test Loss: 0.954 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 34 cost time: 0.5905764102935791
Epoch: 34, Steps: 3 | Train Loss: 0.579 Vali Loss: 0.940 Vali Acc: 0.725 Test Loss: 0.940 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724991).  Saving model ...
Epoch: 35 cost time: 0.7684590816497803
Epoch: 35, Steps: 3 | Train Loss: 0.566 Vali Loss: 0.926 Vali Acc: 0.750 Test Loss: 0.926 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749991).  Saving model ...
Epoch: 36 cost time: 0.6649482250213623
Epoch: 36, Steps: 3 | Train Loss: 0.537 Vali Loss: 0.912 Vali Acc: 0.750 Test Loss: 0.912 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 37 cost time: 0.6122791767120361
Epoch: 37, Steps: 3 | Train Loss: 0.525 Vali Loss: 0.899 Vali Acc: 0.750 Test Loss: 0.899 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 38 cost time: 0.6500875949859619
Epoch: 38, Steps: 3 | Train Loss: 0.501 Vali Loss: 0.888 Vali Acc: 0.750 Test Loss: 0.888 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 39 cost time: 0.4895954132080078
Epoch: 39, Steps: 3 | Train Loss: 0.487 Vali Loss: 0.877 Vali Acc: 0.775 Test Loss: 0.877 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774991).  Saving model ...
Epoch: 40 cost time: 0.7693784236907959
Epoch: 40, Steps: 3 | Train Loss: 0.452 Vali Loss: 0.866 Vali Acc: 0.775 Test Loss: 0.866 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 41 cost time: 0.6464989185333252
Epoch: 41, Steps: 3 | Train Loss: 0.450 Vali Loss: 0.856 Vali Acc: 0.775 Test Loss: 0.856 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 42 cost time: 0.7396161556243896
Epoch: 42, Steps: 3 | Train Loss: 0.447 Vali Loss: 0.847 Vali Acc: 0.775 Test Loss: 0.847 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774992).  Saving model ...
Epoch: 43 cost time: 0.6959505081176758
Epoch: 43, Steps: 3 | Train Loss: 0.438 Vali Loss: 0.838 Vali Acc: 0.775 Test Loss: 0.838 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 44 cost time: 0.5256705284118652
Epoch: 44, Steps: 3 | Train Loss: 0.421 Vali Loss: 0.830 Vali Acc: 0.800 Test Loss: 0.830 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799992).  Saving model ...
Epoch: 45 cost time: 0.6970272064208984
Epoch: 45, Steps: 3 | Train Loss: 0.417 Vali Loss: 0.822 Vali Acc: 0.800 Test Loss: 0.822 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 46 cost time: 0.6254768371582031
Epoch: 46, Steps: 3 | Train Loss: 0.386 Vali Loss: 0.815 Vali Acc: 0.800 Test Loss: 0.815 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 47 cost time: 0.6319191455841064
Epoch: 47, Steps: 3 | Train Loss: 0.364 Vali Loss: 0.807 Vali Acc: 0.800 Test Loss: 0.807 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 48 cost time: 0.6490316390991211
Epoch: 48, Steps: 3 | Train Loss: 0.364 Vali Loss: 0.799 Vali Acc: 0.800 Test Loss: 0.799 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 49 cost time: 0.5646953582763672
Epoch: 49, Steps: 3 | Train Loss: 0.380 Vali Loss: 0.792 Vali Acc: 0.800 Test Loss: 0.792 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 50 cost time: 0.5516195297241211
Epoch: 50, Steps: 3 | Train Loss: 0.365 Vali Loss: 0.784 Vali Acc: 0.800 Test Loss: 0.784 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 51 cost time: 0.5688841342926025
Epoch: 51, Steps: 3 | Train Loss: 0.319 Vali Loss: 0.778 Vali Acc: 0.800 Test Loss: 0.778 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 52 cost time: 0.7045438289642334
Epoch: 52, Steps: 3 | Train Loss: 0.304 Vali Loss: 0.772 Vali Acc: 0.800 Test Loss: 0.772 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 53 cost time: 0.7607951164245605
Epoch: 53, Steps: 3 | Train Loss: 0.328 Vali Loss: 0.765 Vali Acc: 0.800 Test Loss: 0.765 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 54 cost time: 0.7163779735565186
Epoch: 54, Steps: 3 | Train Loss: 0.317 Vali Loss: 0.760 Vali Acc: 0.800 Test Loss: 0.760 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 55 cost time: 0.7447774410247803
Epoch: 55, Steps: 3 | Train Loss: 0.292 Vali Loss: 0.755 Vali Acc: 0.775 Test Loss: 0.755 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.6495397090911865
Epoch: 56, Steps: 3 | Train Loss: 0.313 Vali Loss: 0.751 Vali Acc: 0.775 Test Loss: 0.751 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.6244161128997803
Epoch: 57, Steps: 3 | Train Loss: 0.280 Vali Loss: 0.746 Vali Acc: 0.775 Test Loss: 0.746 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.7497575283050537
Epoch: 58, Steps: 3 | Train Loss: 0.289 Vali Loss: 0.743 Vali Acc: 0.775 Test Loss: 0.743 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 0.6845593452453613
Epoch: 59, Steps: 3 | Train Loss: 0.269 Vali Loss: 0.740 Vali Acc: 0.775 Test Loss: 0.740 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 0.7049026489257812
Epoch: 60, Steps: 3 | Train Loss: 0.252 Vali Loss: 0.737 Vali Acc: 0.775 Test Loss: 0.737 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 0.7117409706115723
Epoch: 61, Steps: 3 | Train Loss: 0.248 Vali Loss: 0.733 Vali Acc: 0.775 Test Loss: 0.733 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 0.6894693374633789
Epoch: 62, Steps: 3 | Train Loss: 0.253 Vali Loss: 0.729 Vali Acc: 0.775 Test Loss: 0.729 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 0.8818492889404297
Epoch: 63, Steps: 3 | Train Loss: 0.239 Vali Loss: 0.727 Vali Acc: 0.775 Test Loss: 0.727 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 0.5889055728912354
Epoch: 64, Steps: 3 | Train Loss: 0.256 Vali Loss: 0.724 Vali Acc: 0.775 Test Loss: 0.724 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm32_cs50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.8
model parameter : 14304
model size : 0.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm32_cs34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.8015758991241455
Epoch: 1, Steps: 3 | Train Loss: 1.526 Vali Loss: 1.426 Vali Acc: 0.250 Test Loss: 1.426 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.592627763748169
Epoch: 2, Steps: 3 | Train Loss: 1.492 Vali Loss: 1.420 Vali Acc: 0.250 Test Loss: 1.420 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 0.5626330375671387
Epoch: 3, Steps: 3 | Train Loss: 1.484 Vali Loss: 1.414 Vali Acc: 0.250 Test Loss: 1.414 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 4 cost time: 0.5118913650512695
Epoch: 4, Steps: 3 | Train Loss: 1.470 Vali Loss: 1.406 Vali Acc: 0.300 Test Loss: 1.406 Test Acc: 0.300
Validation loss decreased (-0.249986 --> -0.299986).  Saving model ...
Epoch: 5 cost time: 0.5308177471160889
Epoch: 5, Steps: 3 | Train Loss: 1.456 Vali Loss: 1.397 Vali Acc: 0.300 Test Loss: 1.397 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 6 cost time: 0.6665630340576172
Epoch: 6, Steps: 3 | Train Loss: 1.408 Vali Loss: 1.387 Vali Acc: 0.350 Test Loss: 1.387 Test Acc: 0.350
Validation loss decreased (-0.299986 --> -0.349986).  Saving model ...
Epoch: 7 cost time: 0.7876605987548828
Epoch: 7, Steps: 3 | Train Loss: 1.397 Vali Loss: 1.375 Vali Acc: 0.450 Test Loss: 1.375 Test Acc: 0.450
Validation loss decreased (-0.349986 --> -0.449986).  Saving model ...
Epoch: 8 cost time: 0.7362525463104248
Epoch: 8, Steps: 3 | Train Loss: 1.373 Vali Loss: 1.364 Vali Acc: 0.525 Test Loss: 1.364 Test Acc: 0.525
Validation loss decreased (-0.449986 --> -0.524986).  Saving model ...
Epoch: 9 cost time: 0.6265168190002441
Epoch: 9, Steps: 3 | Train Loss: 1.349 Vali Loss: 1.351 Vali Acc: 0.575 Test Loss: 1.351 Test Acc: 0.575
Validation loss decreased (-0.524986 --> -0.574986).  Saving model ...
Epoch: 10 cost time: 0.7355105876922607
Epoch: 10, Steps: 3 | Train Loss: 1.317 Vali Loss: 1.339 Vali Acc: 0.600 Test Loss: 1.339 Test Acc: 0.600
Validation loss decreased (-0.574986 --> -0.599987).  Saving model ...
Epoch: 11 cost time: 0.5111041069030762
Epoch: 11, Steps: 3 | Train Loss: 1.270 Vali Loss: 1.324 Vali Acc: 0.600 Test Loss: 1.324 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599987).  Saving model ...
Epoch: 12 cost time: 0.7094624042510986
Epoch: 12, Steps: 3 | Train Loss: 1.230 Vali Loss: 1.310 Vali Acc: 0.650 Test Loss: 1.310 Test Acc: 0.650
Validation loss decreased (-0.599987 --> -0.649987).  Saving model ...
Epoch: 13 cost time: 0.6057372093200684
Epoch: 13, Steps: 3 | Train Loss: 1.196 Vali Loss: 1.297 Vali Acc: 0.625 Test Loss: 1.297 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5602576732635498
Epoch: 14, Steps: 3 | Train Loss: 1.161 Vali Loss: 1.282 Vali Acc: 0.625 Test Loss: 1.282 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6145048141479492
Epoch: 15, Steps: 3 | Train Loss: 1.131 Vali Loss: 1.268 Vali Acc: 0.650 Test Loss: 1.268 Test Acc: 0.650
Validation loss decreased (-0.649987 --> -0.649987).  Saving model ...
Epoch: 16 cost time: 0.7738082408905029
Epoch: 16, Steps: 3 | Train Loss: 1.100 Vali Loss: 1.254 Vali Acc: 0.725 Test Loss: 1.254 Test Acc: 0.725
Validation loss decreased (-0.649987 --> -0.724987).  Saving model ...
Epoch: 17 cost time: 0.5666570663452148
Epoch: 17, Steps: 3 | Train Loss: 1.063 Vali Loss: 1.240 Vali Acc: 0.725 Test Loss: 1.240 Test Acc: 0.725
Validation loss decreased (-0.724987 --> -0.724988).  Saving model ...
Epoch: 18 cost time: 0.6131935119628906
Epoch: 18, Steps: 3 | Train Loss: 1.031 Vali Loss: 1.226 Vali Acc: 0.725 Test Loss: 1.226 Test Acc: 0.725
Validation loss decreased (-0.724988 --> -0.724988).  Saving model ...
Epoch: 19 cost time: 0.7895817756652832
Epoch: 19, Steps: 3 | Train Loss: 0.994 Vali Loss: 1.210 Vali Acc: 0.725 Test Loss: 1.210 Test Acc: 0.725
Validation loss decreased (-0.724988 --> -0.724988).  Saving model ...
Epoch: 20 cost time: 0.8044071197509766
Epoch: 20, Steps: 3 | Train Loss: 0.971 Vali Loss: 1.195 Vali Acc: 0.725 Test Loss: 1.195 Test Acc: 0.725
Validation loss decreased (-0.724988 --> -0.724988).  Saving model ...
Epoch: 21 cost time: 0.707984209060669
Epoch: 21, Steps: 3 | Train Loss: 0.932 Vali Loss: 1.180 Vali Acc: 0.750 Test Loss: 1.180 Test Acc: 0.750
Validation loss decreased (-0.724988 --> -0.749988).  Saving model ...
Epoch: 22 cost time: 0.7744796276092529
Epoch: 22, Steps: 3 | Train Loss: 0.891 Vali Loss: 1.167 Vali Acc: 0.750 Test Loss: 1.167 Test Acc: 0.750
Validation loss decreased (-0.749988 --> -0.749988).  Saving model ...
Epoch: 23 cost time: 0.7617819309234619
Epoch: 23, Steps: 3 | Train Loss: 0.902 Vali Loss: 1.152 Vali Acc: 0.750 Test Loss: 1.152 Test Acc: 0.750
Validation loss decreased (-0.749988 --> -0.749988).  Saving model ...
Epoch: 24 cost time: 0.6501634120941162
Epoch: 24, Steps: 3 | Train Loss: 0.857 Vali Loss: 1.139 Vali Acc: 0.750 Test Loss: 1.139 Test Acc: 0.750
Validation loss decreased (-0.749988 --> -0.749989).  Saving model ...
Epoch: 25 cost time: 0.7429039478302002
Epoch: 25, Steps: 3 | Train Loss: 0.831 Vali Loss: 1.126 Vali Acc: 0.750 Test Loss: 1.126 Test Acc: 0.750
Validation loss decreased (-0.749989 --> -0.749989).  Saving model ...
Epoch: 26 cost time: 0.663837194442749
Epoch: 26, Steps: 3 | Train Loss: 0.806 Vali Loss: 1.113 Vali Acc: 0.750 Test Loss: 1.113 Test Acc: 0.750
Validation loss decreased (-0.749989 --> -0.749989).  Saving model ...
Epoch: 27 cost time: 0.7788534164428711
Epoch: 27, Steps: 3 | Train Loss: 0.771 Vali Loss: 1.099 Vali Acc: 0.750 Test Loss: 1.099 Test Acc: 0.750
Validation loss decreased (-0.749989 --> -0.749989).  Saving model ...
Epoch: 28 cost time: 0.6700172424316406
Epoch: 28, Steps: 3 | Train Loss: 0.744 Vali Loss: 1.087 Vali Acc: 0.750 Test Loss: 1.087 Test Acc: 0.750
Validation loss decreased (-0.749989 --> -0.749989).  Saving model ...
Epoch: 29 cost time: 0.6481702327728271
Epoch: 29, Steps: 3 | Train Loss: 0.756 Vali Loss: 1.073 Vali Acc: 0.750 Test Loss: 1.073 Test Acc: 0.750
Validation loss decreased (-0.749989 --> -0.749989).  Saving model ...
Epoch: 30 cost time: 0.694441556930542
Epoch: 30, Steps: 3 | Train Loss: 0.708 Vali Loss: 1.059 Vali Acc: 0.725 Test Loss: 1.059 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7696442604064941
Epoch: 31, Steps: 3 | Train Loss: 0.651 Vali Loss: 1.047 Vali Acc: 0.725 Test Loss: 1.047 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.6344623565673828
Epoch: 32, Steps: 3 | Train Loss: 0.663 Vali Loss: 1.035 Vali Acc: 0.725 Test Loss: 1.035 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.8326616287231445
Epoch: 33, Steps: 3 | Train Loss: 0.628 Vali Loss: 1.023 Vali Acc: 0.725 Test Loss: 1.023 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.7458126544952393
Epoch: 34, Steps: 3 | Train Loss: 0.624 Vali Loss: 1.009 Vali Acc: 0.725 Test Loss: 1.009 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.7190060615539551
Epoch: 35, Steps: 3 | Train Loss: 0.568 Vali Loss: 0.996 Vali Acc: 0.725 Test Loss: 0.996 Test Acc: 0.725
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.93399977684021
Epoch: 36, Steps: 3 | Train Loss: 0.554 Vali Loss: 0.983 Vali Acc: 0.725 Test Loss: 0.983 Test Acc: 0.725
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.7637152671813965
Epoch: 37, Steps: 3 | Train Loss: 0.537 Vali Loss: 0.969 Vali Acc: 0.725 Test Loss: 0.969 Test Acc: 0.725
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.7935192584991455
Epoch: 38, Steps: 3 | Train Loss: 0.488 Vali Loss: 0.955 Vali Acc: 0.750 Test Loss: 0.955 Test Acc: 0.750
Validation loss decreased (-0.749989 --> -0.749990).  Saving model ...
Epoch: 39 cost time: 0.6759510040283203
Epoch: 39, Steps: 3 | Train Loss: 0.533 Vali Loss: 0.942 Vali Acc: 0.750 Test Loss: 0.942 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749991).  Saving model ...
Epoch: 40 cost time: 0.8872807025909424
Epoch: 40, Steps: 3 | Train Loss: 0.493 Vali Loss: 0.929 Vali Acc: 0.775 Test Loss: 0.929 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774991).  Saving model ...
Epoch: 41 cost time: 0.6957359313964844
Epoch: 41, Steps: 3 | Train Loss: 0.474 Vali Loss: 0.915 Vali Acc: 0.750 Test Loss: 0.915 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.7402389049530029
Epoch: 42, Steps: 3 | Train Loss: 0.460 Vali Loss: 0.902 Vali Acc: 0.750 Test Loss: 0.902 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.6927754878997803
Epoch: 43, Steps: 3 | Train Loss: 0.443 Vali Loss: 0.891 Vali Acc: 0.750 Test Loss: 0.891 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.6253786087036133
Epoch: 44, Steps: 3 | Train Loss: 0.444 Vali Loss: 0.881 Vali Acc: 0.775 Test Loss: 0.881 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 45 cost time: 0.6196997165679932
Epoch: 45, Steps: 3 | Train Loss: 0.386 Vali Loss: 0.871 Vali Acc: 0.775 Test Loss: 0.871 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 46 cost time: 0.555333137512207
Epoch: 46, Steps: 3 | Train Loss: 0.397 Vali Loss: 0.863 Vali Acc: 0.775 Test Loss: 0.863 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 47 cost time: 0.5491237640380859
Epoch: 47, Steps: 3 | Train Loss: 0.410 Vali Loss: 0.857 Vali Acc: 0.800 Test Loss: 0.857 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799991).  Saving model ...
Epoch: 48 cost time: 0.7209887504577637
Epoch: 48, Steps: 3 | Train Loss: 0.389 Vali Loss: 0.851 Vali Acc: 0.800 Test Loss: 0.851 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 49 cost time: 0.6622574329376221
Epoch: 49, Steps: 3 | Train Loss: 0.377 Vali Loss: 0.844 Vali Acc: 0.800 Test Loss: 0.844 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799992).  Saving model ...
Epoch: 50 cost time: 0.6683979034423828
Epoch: 50, Steps: 3 | Train Loss: 0.380 Vali Loss: 0.836 Vali Acc: 0.825 Test Loss: 0.836 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824992).  Saving model ...
Epoch: 51 cost time: 0.6565563678741455
Epoch: 51, Steps: 3 | Train Loss: 0.339 Vali Loss: 0.826 Vali Acc: 0.825 Test Loss: 0.826 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 52 cost time: 0.7243325710296631
Epoch: 52, Steps: 3 | Train Loss: 0.353 Vali Loss: 0.818 Vali Acc: 0.825 Test Loss: 0.818 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 53 cost time: 0.5776684284210205
Epoch: 53, Steps: 3 | Train Loss: 0.324 Vali Loss: 0.809 Vali Acc: 0.825 Test Loss: 0.809 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 54 cost time: 0.7002558708190918
Epoch: 54, Steps: 3 | Train Loss: 0.324 Vali Loss: 0.801 Vali Acc: 0.825 Test Loss: 0.801 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 55 cost time: 0.6444036960601807
Epoch: 55, Steps: 3 | Train Loss: 0.321 Vali Loss: 0.794 Vali Acc: 0.825 Test Loss: 0.794 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 56 cost time: 0.5579354763031006
Epoch: 56, Steps: 3 | Train Loss: 0.317 Vali Loss: 0.786 Vali Acc: 0.825 Test Loss: 0.786 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 57 cost time: 0.6267855167388916
Epoch: 57, Steps: 3 | Train Loss: 0.309 Vali Loss: 0.781 Vali Acc: 0.825 Test Loss: 0.781 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 58 cost time: 0.6771771907806396
Epoch: 58, Steps: 3 | Train Loss: 0.289 Vali Loss: 0.775 Vali Acc: 0.825 Test Loss: 0.775 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 59 cost time: 0.5742173194885254
Epoch: 59, Steps: 3 | Train Loss: 0.270 Vali Loss: 0.771 Vali Acc: 0.850 Test Loss: 0.771 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849992).  Saving model ...
Epoch: 60 cost time: 0.6510083675384521
Epoch: 60, Steps: 3 | Train Loss: 0.268 Vali Loss: 0.768 Vali Acc: 0.850 Test Loss: 0.768 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 61 cost time: 0.7577428817749023
Epoch: 61, Steps: 3 | Train Loss: 0.262 Vali Loss: 0.763 Vali Acc: 0.850 Test Loss: 0.763 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 62 cost time: 0.8537869453430176
Epoch: 62, Steps: 3 | Train Loss: 0.258 Vali Loss: 0.759 Vali Acc: 0.850 Test Loss: 0.759 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 63 cost time: 0.7474780082702637
Epoch: 63, Steps: 3 | Train Loss: 0.251 Vali Loss: 0.754 Vali Acc: 0.850 Test Loss: 0.754 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 64 cost time: 0.731067419052124
Epoch: 64, Steps: 3 | Train Loss: 0.242 Vali Loss: 0.748 Vali Acc: 0.850 Test Loss: 0.748 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849993).  Saving model ...
Epoch: 65 cost time: 0.8001477718353271
Epoch: 65, Steps: 3 | Train Loss: 0.245 Vali Loss: 0.744 Vali Acc: 0.850 Test Loss: 0.744 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 66 cost time: 0.6642804145812988
Epoch: 66, Steps: 3 | Train Loss: 0.238 Vali Loss: 0.740 Vali Acc: 0.850 Test Loss: 0.740 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 67 cost time: 0.7496697902679443
Epoch: 67, Steps: 3 | Train Loss: 0.234 Vali Loss: 0.735 Vali Acc: 0.825 Test Loss: 0.735 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.7288365364074707
Epoch: 68, Steps: 3 | Train Loss: 0.225 Vali Loss: 0.731 Vali Acc: 0.850 Test Loss: 0.731 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 69 cost time: 0.6352040767669678
Epoch: 69, Steps: 3 | Train Loss: 0.250 Vali Loss: 0.728 Vali Acc: 0.825 Test Loss: 0.728 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.7158923149108887
Epoch: 70, Steps: 3 | Train Loss: 0.206 Vali Loss: 0.726 Vali Acc: 0.825 Test Loss: 0.726 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 0.799262285232544
Epoch: 71, Steps: 3 | Train Loss: 0.217 Vali Loss: 0.724 Vali Acc: 0.825 Test Loss: 0.724 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 0.795745849609375
Epoch: 72, Steps: 3 | Train Loss: 0.211 Vali Loss: 0.720 Vali Acc: 0.825 Test Loss: 0.720 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 0.783301591873169
Epoch: 73, Steps: 3 | Train Loss: 0.182 Vali Loss: 0.718 Vali Acc: 0.825 Test Loss: 0.718 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 0.9055585861206055
Epoch: 74, Steps: 3 | Train Loss: 0.185 Vali Loss: 0.714 Vali Acc: 0.825 Test Loss: 0.714 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 75 cost time: 0.8775656223297119
Epoch: 75, Steps: 3 | Train Loss: 0.205 Vali Loss: 0.710 Vali Acc: 0.825 Test Loss: 0.710 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 76 cost time: 0.8263645172119141
Epoch: 76, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.707 Vali Acc: 0.825 Test Loss: 0.707 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 77 cost time: 0.7543356418609619
Epoch: 77, Steps: 3 | Train Loss: 0.166 Vali Loss: 0.703 Vali Acc: 0.825 Test Loss: 0.703 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 78 cost time: 0.6859269142150879
Epoch: 78, Steps: 3 | Train Loss: 0.190 Vali Loss: 0.699 Vali Acc: 0.825 Test Loss: 0.699 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm32_cs34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.85
model parameter : 14262
model size : 0.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm32_cs25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.9091832637786865
Epoch: 1, Steps: 3 | Train Loss: 1.576 Vali Loss: 1.499 Vali Acc: 0.325 Test Loss: 1.499 Test Acc: 0.325
Validation loss decreased (inf --> -0.324985).  Saving model ...
Epoch: 2 cost time: 0.5098617076873779
Epoch: 2, Steps: 3 | Train Loss: 1.586 Vali Loss: 1.482 Vali Acc: 0.325 Test Loss: 1.482 Test Acc: 0.325
Validation loss decreased (-0.324985 --> -0.324985).  Saving model ...
Epoch: 3 cost time: 0.8836874961853027
Epoch: 3, Steps: 3 | Train Loss: 1.495 Vali Loss: 1.473 Vali Acc: 0.350 Test Loss: 1.473 Test Acc: 0.350
Validation loss decreased (-0.324985 --> -0.349985).  Saving model ...
Epoch: 4 cost time: 0.7948544025421143
Epoch: 4, Steps: 3 | Train Loss: 1.525 Vali Loss: 1.461 Vali Acc: 0.350 Test Loss: 1.461 Test Acc: 0.350
Validation loss decreased (-0.349985 --> -0.349985).  Saving model ...
Epoch: 5 cost time: 0.6186423301696777
Epoch: 5, Steps: 3 | Train Loss: 1.507 Vali Loss: 1.447 Vali Acc: 0.350 Test Loss: 1.447 Test Acc: 0.350
Validation loss decreased (-0.349985 --> -0.349986).  Saving model ...
Epoch: 6 cost time: 0.5142650604248047
Epoch: 6, Steps: 3 | Train Loss: 1.481 Vali Loss: 1.432 Vali Acc: 0.375 Test Loss: 1.432 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374986).  Saving model ...
Epoch: 7 cost time: 0.6338236331939697
Epoch: 7, Steps: 3 | Train Loss: 1.442 Vali Loss: 1.414 Vali Acc: 0.400 Test Loss: 1.414 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399986).  Saving model ...
Epoch: 8 cost time: 0.6029481887817383
Epoch: 8, Steps: 3 | Train Loss: 1.385 Vali Loss: 1.395 Vali Acc: 0.425 Test Loss: 1.395 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424986).  Saving model ...
Epoch: 9 cost time: 0.5539591312408447
Epoch: 9, Steps: 3 | Train Loss: 1.378 Vali Loss: 1.375 Vali Acc: 0.375 Test Loss: 1.375 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.48314952850341797
Epoch: 10, Steps: 3 | Train Loss: 1.320 Vali Loss: 1.356 Vali Acc: 0.375 Test Loss: 1.356 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5393691062927246
Epoch: 11, Steps: 3 | Train Loss: 1.301 Vali Loss: 1.338 Vali Acc: 0.400 Test Loss: 1.338 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.5509896278381348
Epoch: 12, Steps: 3 | Train Loss: 1.283 Vali Loss: 1.319 Vali Acc: 0.350 Test Loss: 1.319 Test Acc: 0.350
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.4822509288787842
Epoch: 13, Steps: 3 | Train Loss: 1.221 Vali Loss: 1.300 Vali Acc: 0.275 Test Loss: 1.300 Test Acc: 0.275
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.5411050319671631
Epoch: 14, Steps: 3 | Train Loss: 1.198 Vali Loss: 1.284 Vali Acc: 0.300 Test Loss: 1.284 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.582876443862915
Epoch: 15, Steps: 3 | Train Loss: 1.138 Vali Loss: 1.268 Vali Acc: 0.325 Test Loss: 1.268 Test Acc: 0.325
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.5747840404510498
Epoch: 16, Steps: 3 | Train Loss: 1.116 Vali Loss: 1.251 Vali Acc: 0.350 Test Loss: 1.251 Test Acc: 0.350
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.5297017097473145
Epoch: 17, Steps: 3 | Train Loss: 1.095 Vali Loss: 1.236 Vali Acc: 0.350 Test Loss: 1.236 Test Acc: 0.350
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.5410594940185547
Epoch: 18, Steps: 3 | Train Loss: 1.088 Vali Loss: 1.220 Vali Acc: 0.350 Test Loss: 1.220 Test Acc: 0.350
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm32_cs25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.425
model parameter : 13936
model size : 0.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm32_cs20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.285706043243408
Epoch: 1, Steps: 3 | Train Loss: 1.502 Vali Loss: 1.432 Vali Acc: 0.375 Test Loss: 1.432 Test Acc: 0.375
Validation loss decreased (inf --> -0.374986).  Saving model ...
Epoch: 2 cost time: 0.7627584934234619
Epoch: 2, Steps: 3 | Train Loss: 1.440 Vali Loss: 1.423 Vali Acc: 0.400 Test Loss: 1.423 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399986).  Saving model ...
Epoch: 3 cost time: 0.720212459564209
Epoch: 3, Steps: 3 | Train Loss: 1.419 Vali Loss: 1.416 Vali Acc: 0.400 Test Loss: 1.416 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399986).  Saving model ...
Epoch: 4 cost time: 0.7569000720977783
Epoch: 4, Steps: 3 | Train Loss: 1.398 Vali Loss: 1.407 Vali Acc: 0.425 Test Loss: 1.407 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424986).  Saving model ...
Epoch: 5 cost time: 0.6744503974914551
Epoch: 5, Steps: 3 | Train Loss: 1.409 Vali Loss: 1.397 Vali Acc: 0.425 Test Loss: 1.397 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424986).  Saving model ...
Epoch: 6 cost time: 0.7852580547332764
Epoch: 6, Steps: 3 | Train Loss: 1.373 Vali Loss: 1.385 Vali Acc: 0.425 Test Loss: 1.385 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424986).  Saving model ...
Epoch: 7 cost time: 0.5726418495178223
Epoch: 7, Steps: 3 | Train Loss: 1.339 Vali Loss: 1.372 Vali Acc: 0.450 Test Loss: 1.372 Test Acc: 0.450
Validation loss decreased (-0.424986 --> -0.449986).  Saving model ...
Epoch: 8 cost time: 0.9732511043548584
Epoch: 8, Steps: 3 | Train Loss: 1.339 Vali Loss: 1.358 Vali Acc: 0.450 Test Loss: 1.358 Test Acc: 0.450
Validation loss decreased (-0.449986 --> -0.449986).  Saving model ...
Epoch: 9 cost time: 0.5608580112457275
Epoch: 9, Steps: 3 | Train Loss: 1.273 Vali Loss: 1.343 Vali Acc: 0.450 Test Loss: 1.343 Test Acc: 0.450
Validation loss decreased (-0.449986 --> -0.449987).  Saving model ...
Epoch: 10 cost time: 0.6847836971282959
Epoch: 10, Steps: 3 | Train Loss: 1.254 Vali Loss: 1.328 Vali Acc: 0.450 Test Loss: 1.328 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 11 cost time: 0.5550055503845215
Epoch: 11, Steps: 3 | Train Loss: 1.237 Vali Loss: 1.312 Vali Acc: 0.450 Test Loss: 1.312 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 12 cost time: 0.6337502002716064
Epoch: 12, Steps: 3 | Train Loss: 1.187 Vali Loss: 1.297 Vali Acc: 0.450 Test Loss: 1.297 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 13 cost time: 0.5202343463897705
Epoch: 13, Steps: 3 | Train Loss: 1.139 Vali Loss: 1.281 Vali Acc: 0.450 Test Loss: 1.281 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 14 cost time: 0.7068710327148438
Epoch: 14, Steps: 3 | Train Loss: 1.116 Vali Loss: 1.265 Vali Acc: 0.475 Test Loss: 1.265 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474987).  Saving model ...
Epoch: 15 cost time: 0.5966503620147705
Epoch: 15, Steps: 3 | Train Loss: 1.096 Vali Loss: 1.249 Vali Acc: 0.475 Test Loss: 1.249 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474988).  Saving model ...
Epoch: 16 cost time: 0.5976743698120117
Epoch: 16, Steps: 3 | Train Loss: 1.049 Vali Loss: 1.232 Vali Acc: 0.500 Test Loss: 1.232 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499988).  Saving model ...
Epoch: 17 cost time: 0.7291395664215088
Epoch: 17, Steps: 3 | Train Loss: 1.002 Vali Loss: 1.216 Vali Acc: 0.550 Test Loss: 1.216 Test Acc: 0.550
Validation loss decreased (-0.499988 --> -0.549988).  Saving model ...
Epoch: 18 cost time: 0.6758170127868652
Epoch: 18, Steps: 3 | Train Loss: 1.005 Vali Loss: 1.200 Vali Acc: 0.575 Test Loss: 1.200 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 19 cost time: 0.6626360416412354
Epoch: 19, Steps: 3 | Train Loss: 0.942 Vali Loss: 1.181 Vali Acc: 0.575 Test Loss: 1.181 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 20 cost time: 0.8699145317077637
Epoch: 20, Steps: 3 | Train Loss: 0.941 Vali Loss: 1.165 Vali Acc: 0.575 Test Loss: 1.165 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 21 cost time: 0.6268906593322754
Epoch: 21, Steps: 3 | Train Loss: 0.906 Vali Loss: 1.149 Vali Acc: 0.600 Test Loss: 1.149 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599989).  Saving model ...
Epoch: 22 cost time: 0.724362850189209
Epoch: 22, Steps: 3 | Train Loss: 0.844 Vali Loss: 1.134 Vali Acc: 0.625 Test Loss: 1.134 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 23 cost time: 0.7709376811981201
Epoch: 23, Steps: 3 | Train Loss: 0.866 Vali Loss: 1.119 Vali Acc: 0.675 Test Loss: 1.119 Test Acc: 0.675
Validation loss decreased (-0.624989 --> -0.674989).  Saving model ...
Epoch: 24 cost time: 0.6832993030548096
Epoch: 24, Steps: 3 | Train Loss: 0.859 Vali Loss: 1.103 Vali Acc: 0.675 Test Loss: 1.103 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 25 cost time: 0.6823158264160156
Epoch: 25, Steps: 3 | Train Loss: 0.783 Vali Loss: 1.088 Vali Acc: 0.700 Test Loss: 1.088 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699989).  Saving model ...
Epoch: 26 cost time: 0.5642416477203369
Epoch: 26, Steps: 3 | Train Loss: 0.744 Vali Loss: 1.075 Vali Acc: 0.700 Test Loss: 1.075 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 27 cost time: 0.6312563419342041
Epoch: 27, Steps: 3 | Train Loss: 0.760 Vali Loss: 1.062 Vali Acc: 0.700 Test Loss: 1.062 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 28 cost time: 0.945605993270874
Epoch: 28, Steps: 3 | Train Loss: 0.686 Vali Loss: 1.049 Vali Acc: 0.700 Test Loss: 1.049 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699990).  Saving model ...
Epoch: 29 cost time: 0.6825623512268066
Epoch: 29, Steps: 3 | Train Loss: 0.644 Vali Loss: 1.036 Vali Acc: 0.725 Test Loss: 1.036 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724990).  Saving model ...
Epoch: 30 cost time: 0.5722851753234863
Epoch: 30, Steps: 3 | Train Loss: 0.683 Vali Loss: 1.025 Vali Acc: 0.725 Test Loss: 1.025 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 31 cost time: 0.6232597827911377
Epoch: 31, Steps: 3 | Train Loss: 0.639 Vali Loss: 1.012 Vali Acc: 0.725 Test Loss: 1.012 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 32 cost time: 0.5605642795562744
Epoch: 32, Steps: 3 | Train Loss: 0.637 Vali Loss: 0.999 Vali Acc: 0.725 Test Loss: 0.999 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 33 cost time: 0.6463766098022461
Epoch: 33, Steps: 3 | Train Loss: 0.641 Vali Loss: 0.988 Vali Acc: 0.675 Test Loss: 0.988 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7505319118499756
Epoch: 34, Steps: 3 | Train Loss: 0.577 Vali Loss: 0.979 Vali Acc: 0.675 Test Loss: 0.979 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.8071720600128174
Epoch: 35, Steps: 3 | Train Loss: 0.600 Vali Loss: 0.968 Vali Acc: 0.725 Test Loss: 0.968 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 36 cost time: 0.852003812789917
Epoch: 36, Steps: 3 | Train Loss: 0.524 Vali Loss: 0.958 Vali Acc: 0.750 Test Loss: 0.958 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749990).  Saving model ...
Epoch: 37 cost time: 0.7205452919006348
Epoch: 37, Steps: 3 | Train Loss: 0.558 Vali Loss: 0.948 Vali Acc: 0.750 Test Loss: 0.948 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749991).  Saving model ...
Epoch: 38 cost time: 0.5988707542419434
Epoch: 38, Steps: 3 | Train Loss: 0.538 Vali Loss: 0.938 Vali Acc: 0.750 Test Loss: 0.938 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 39 cost time: 0.6322920322418213
Epoch: 39, Steps: 3 | Train Loss: 0.487 Vali Loss: 0.926 Vali Acc: 0.750 Test Loss: 0.926 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 40 cost time: 0.6732802391052246
Epoch: 40, Steps: 3 | Train Loss: 0.496 Vali Loss: 0.916 Vali Acc: 0.750 Test Loss: 0.916 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 41 cost time: 0.6907486915588379
Epoch: 41, Steps: 3 | Train Loss: 0.467 Vali Loss: 0.907 Vali Acc: 0.750 Test Loss: 0.907 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 42 cost time: 0.6840391159057617
Epoch: 42, Steps: 3 | Train Loss: 0.437 Vali Loss: 0.899 Vali Acc: 0.750 Test Loss: 0.899 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 43 cost time: 0.5274844169616699
Epoch: 43, Steps: 3 | Train Loss: 0.443 Vali Loss: 0.889 Vali Acc: 0.750 Test Loss: 0.889 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 44 cost time: 0.6225433349609375
Epoch: 44, Steps: 3 | Train Loss: 0.430 Vali Loss: 0.880 Vali Acc: 0.750 Test Loss: 0.880 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 45 cost time: 0.6087958812713623
Epoch: 45, Steps: 3 | Train Loss: 0.413 Vali Loss: 0.872 Vali Acc: 0.750 Test Loss: 0.872 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 46 cost time: 0.8280856609344482
Epoch: 46, Steps: 3 | Train Loss: 0.405 Vali Loss: 0.863 Vali Acc: 0.750 Test Loss: 0.863 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 47 cost time: 0.5854957103729248
Epoch: 47, Steps: 3 | Train Loss: 0.393 Vali Loss: 0.856 Vali Acc: 0.750 Test Loss: 0.856 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 48 cost time: 0.7529051303863525
Epoch: 48, Steps: 3 | Train Loss: 0.368 Vali Loss: 0.849 Vali Acc: 0.750 Test Loss: 0.849 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 49 cost time: 0.6548376083374023
Epoch: 49, Steps: 3 | Train Loss: 0.378 Vali Loss: 0.841 Vali Acc: 0.750 Test Loss: 0.841 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 50 cost time: 0.5624964237213135
Epoch: 50, Steps: 3 | Train Loss: 0.352 Vali Loss: 0.834 Vali Acc: 0.750 Test Loss: 0.834 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 51 cost time: 0.5819919109344482
Epoch: 51, Steps: 3 | Train Loss: 0.374 Vali Loss: 0.829 Vali Acc: 0.750 Test Loss: 0.829 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 52 cost time: 0.6615204811096191
Epoch: 52, Steps: 3 | Train Loss: 0.363 Vali Loss: 0.824 Vali Acc: 0.775 Test Loss: 0.824 Test Acc: 0.775
Validation loss decreased (-0.749992 --> -0.774992).  Saving model ...
Epoch: 53 cost time: 0.678032398223877
Epoch: 53, Steps: 3 | Train Loss: 0.316 Vali Loss: 0.820 Vali Acc: 0.775 Test Loss: 0.820 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 54 cost time: 0.6537401676177979
Epoch: 54, Steps: 3 | Train Loss: 0.327 Vali Loss: 0.816 Vali Acc: 0.775 Test Loss: 0.816 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 55 cost time: 0.6622788906097412
Epoch: 55, Steps: 3 | Train Loss: 0.313 Vali Loss: 0.813 Vali Acc: 0.775 Test Loss: 0.813 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 56 cost time: 0.6050586700439453
Epoch: 56, Steps: 3 | Train Loss: 0.305 Vali Loss: 0.811 Vali Acc: 0.775 Test Loss: 0.811 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 57 cost time: 0.7323434352874756
Epoch: 57, Steps: 3 | Train Loss: 0.290 Vali Loss: 0.808 Vali Acc: 0.775 Test Loss: 0.808 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 58 cost time: 0.6015183925628662
Epoch: 58, Steps: 3 | Train Loss: 0.284 Vali Loss: 0.805 Vali Acc: 0.775 Test Loss: 0.805 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 59 cost time: 0.6965751647949219
Epoch: 59, Steps: 3 | Train Loss: 0.282 Vali Loss: 0.800 Vali Acc: 0.775 Test Loss: 0.800 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 60 cost time: 0.9056761264801025
Epoch: 60, Steps: 3 | Train Loss: 0.282 Vali Loss: 0.796 Vali Acc: 0.775 Test Loss: 0.796 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 61 cost time: 0.6058850288391113
Epoch: 61, Steps: 3 | Train Loss: 0.258 Vali Loss: 0.793 Vali Acc: 0.775 Test Loss: 0.793 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 62 cost time: 0.6528689861297607
Epoch: 62, Steps: 3 | Train Loss: 0.268 Vali Loss: 0.789 Vali Acc: 0.775 Test Loss: 0.789 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 63 cost time: 0.6766438484191895
Epoch: 63, Steps: 3 | Train Loss: 0.284 Vali Loss: 0.788 Vali Acc: 0.775 Test Loss: 0.788 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 64 cost time: 0.8067920207977295
Epoch: 64, Steps: 3 | Train Loss: 0.261 Vali Loss: 0.787 Vali Acc: 0.775 Test Loss: 0.787 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 65 cost time: 0.6574585437774658
Epoch: 65, Steps: 3 | Train Loss: 0.245 Vali Loss: 0.787 Vali Acc: 0.775 Test Loss: 0.787 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 66 cost time: 0.585707426071167
Epoch: 66, Steps: 3 | Train Loss: 0.239 Vali Loss: 0.787 Vali Acc: 0.775 Test Loss: 0.787 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.7602925300598145
Epoch: 67, Steps: 3 | Train Loss: 0.250 Vali Loss: 0.785 Vali Acc: 0.775 Test Loss: 0.785 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 68 cost time: 0.6221437454223633
Epoch: 68, Steps: 3 | Train Loss: 0.249 Vali Loss: 0.784 Vali Acc: 0.800 Test Loss: 0.784 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799992).  Saving model ...
Epoch: 69 cost time: 0.6250929832458496
Epoch: 69, Steps: 3 | Train Loss: 0.235 Vali Loss: 0.782 Vali Acc: 0.825 Test Loss: 0.782 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824992).  Saving model ...
Epoch: 70 cost time: 0.7131369113922119
Epoch: 70, Steps: 3 | Train Loss: 0.216 Vali Loss: 0.781 Vali Acc: 0.825 Test Loss: 0.781 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 71 cost time: 0.7743375301361084
Epoch: 71, Steps: 3 | Train Loss: 0.239 Vali Loss: 0.779 Vali Acc: 0.800 Test Loss: 0.779 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 0.6922013759613037
Epoch: 72, Steps: 3 | Train Loss: 0.229 Vali Loss: 0.778 Vali Acc: 0.800 Test Loss: 0.778 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 0.6527402400970459
Epoch: 73, Steps: 3 | Train Loss: 0.241 Vali Loss: 0.777 Vali Acc: 0.800 Test Loss: 0.777 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 0.714510440826416
Epoch: 74, Steps: 3 | Train Loss: 0.223 Vali Loss: 0.778 Vali Acc: 0.825 Test Loss: 0.778 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 75 cost time: 0.7155947685241699
Epoch: 75, Steps: 3 | Train Loss: 0.210 Vali Loss: 0.779 Vali Acc: 0.825 Test Loss: 0.779 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.6424403190612793
Epoch: 76, Steps: 3 | Train Loss: 0.203 Vali Loss: 0.779 Vali Acc: 0.825 Test Loss: 0.779 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 0.6771297454833984
Epoch: 77, Steps: 3 | Train Loss: 0.225 Vali Loss: 0.778 Vali Acc: 0.825 Test Loss: 0.778 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 78 cost time: 0.6115224361419678
Epoch: 78, Steps: 3 | Train Loss: 0.202 Vali Loss: 0.777 Vali Acc: 0.825 Test Loss: 0.777 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 79 cost time: 0.5493454933166504
Epoch: 79, Steps: 3 | Train Loss: 0.181 Vali Loss: 0.778 Vali Acc: 0.825 Test Loss: 0.778 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 0.58235764503479
Epoch: 80, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.778 Vali Acc: 0.825 Test Loss: 0.778 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 0.5933527946472168
Epoch: 81, Steps: 3 | Train Loss: 0.201 Vali Loss: 0.781 Vali Acc: 0.825 Test Loss: 0.781 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 82 cost time: 0.5771706104278564
Epoch: 82, Steps: 3 | Train Loss: 0.197 Vali Loss: 0.784 Vali Acc: 0.825 Test Loss: 0.784 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 83 cost time: 0.7246110439300537
Epoch: 83, Steps: 3 | Train Loss: 0.160 Vali Loss: 0.787 Vali Acc: 0.825 Test Loss: 0.787 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 84 cost time: 0.6819355487823486
Epoch: 84, Steps: 3 | Train Loss: 0.163 Vali Loss: 0.790 Vali Acc: 0.825 Test Loss: 0.790 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 85 cost time: 0.7329866886138916
Epoch: 85, Steps: 3 | Train Loss: 0.159 Vali Loss: 0.792 Vali Acc: 0.825 Test Loss: 0.792 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 86 cost time: 0.7063300609588623
Epoch: 86, Steps: 3 | Train Loss: 0.150 Vali Loss: 0.794 Vali Acc: 0.825 Test Loss: 0.794 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 87 cost time: 0.7585704326629639
Epoch: 87, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.795 Vali Acc: 0.825 Test Loss: 0.795 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 88 cost time: 0.6695146560668945
Epoch: 88, Steps: 3 | Train Loss: 0.154 Vali Loss: 0.795 Vali Acc: 0.825 Test Loss: 0.795 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm32_cs20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.825
model parameter : 13878
model size : 0.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm32_cs17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.406486749649048
Epoch: 1, Steps: 3 | Train Loss: 1.349 Vali Loss: 1.465 Vali Acc: 0.275 Test Loss: 1.465 Test Acc: 0.275
Validation loss decreased (inf --> -0.274985).  Saving model ...
Epoch: 2 cost time: 0.5955157279968262
Epoch: 2, Steps: 3 | Train Loss: 1.353 Vali Loss: 1.458 Vali Acc: 0.275 Test Loss: 1.458 Test Acc: 0.275
Validation loss decreased (-0.274985 --> -0.274985).  Saving model ...
Epoch: 3 cost time: 0.6140515804290771
Epoch: 3, Steps: 3 | Train Loss: 1.359 Vali Loss: 1.452 Vali Acc: 0.275 Test Loss: 1.452 Test Acc: 0.275
Validation loss decreased (-0.274985 --> -0.274985).  Saving model ...
Epoch: 4 cost time: 0.5892446041107178
Epoch: 4, Steps: 3 | Train Loss: 1.335 Vali Loss: 1.443 Vali Acc: 0.275 Test Loss: 1.443 Test Acc: 0.275
Validation loss decreased (-0.274985 --> -0.274986).  Saving model ...
Epoch: 5 cost time: 0.6708769798278809
Epoch: 5, Steps: 3 | Train Loss: 1.312 Vali Loss: 1.434 Vali Acc: 0.275 Test Loss: 1.434 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274986).  Saving model ...
Epoch: 6 cost time: 0.6808285713195801
Epoch: 6, Steps: 3 | Train Loss: 1.261 Vali Loss: 1.422 Vali Acc: 0.325 Test Loss: 1.422 Test Acc: 0.325
Validation loss decreased (-0.274986 --> -0.324986).  Saving model ...
Epoch: 7 cost time: 0.7203338146209717
Epoch: 7, Steps: 3 | Train Loss: 1.261 Vali Loss: 1.410 Vali Acc: 0.325 Test Loss: 1.410 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324986).  Saving model ...
Epoch: 8 cost time: 0.7545044422149658
Epoch: 8, Steps: 3 | Train Loss: 1.220 Vali Loss: 1.396 Vali Acc: 0.325 Test Loss: 1.396 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324986).  Saving model ...
Epoch: 9 cost time: 0.8857553005218506
Epoch: 9, Steps: 3 | Train Loss: 1.208 Vali Loss: 1.384 Vali Acc: 0.325 Test Loss: 1.384 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324986).  Saving model ...
Epoch: 10 cost time: 0.7017905712127686
Epoch: 10, Steps: 3 | Train Loss: 1.205 Vali Loss: 1.370 Vali Acc: 0.350 Test Loss: 1.370 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349986).  Saving model ...
Epoch: 11 cost time: 0.7465903759002686
Epoch: 11, Steps: 3 | Train Loss: 1.160 Vali Loss: 1.355 Vali Acc: 0.400 Test Loss: 1.355 Test Acc: 0.400
Validation loss decreased (-0.349986 --> -0.399986).  Saving model ...
Epoch: 12 cost time: 0.7126471996307373
Epoch: 12, Steps: 3 | Train Loss: 1.088 Vali Loss: 1.340 Vali Acc: 0.425 Test Loss: 1.340 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424987).  Saving model ...
Epoch: 13 cost time: 0.719158411026001
Epoch: 13, Steps: 3 | Train Loss: 1.107 Vali Loss: 1.326 Vali Acc: 0.475 Test Loss: 1.326 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474987).  Saving model ...
Epoch: 14 cost time: 0.7087781429290771
Epoch: 14, Steps: 3 | Train Loss: 1.065 Vali Loss: 1.311 Vali Acc: 0.500 Test Loss: 1.311 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499987).  Saving model ...
Epoch: 15 cost time: 0.6140484809875488
Epoch: 15, Steps: 3 | Train Loss: 1.003 Vali Loss: 1.297 Vali Acc: 0.525 Test Loss: 1.297 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524987).  Saving model ...
Epoch: 16 cost time: 0.6572780609130859
Epoch: 16, Steps: 3 | Train Loss: 1.013 Vali Loss: 1.281 Vali Acc: 0.525 Test Loss: 1.281 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524987).  Saving model ...
Epoch: 17 cost time: 0.7212643623352051
Epoch: 17, Steps: 3 | Train Loss: 1.001 Vali Loss: 1.267 Vali Acc: 0.575 Test Loss: 1.267 Test Acc: 0.575
Validation loss decreased (-0.524987 --> -0.574987).  Saving model ...
Epoch: 18 cost time: 0.7148661613464355
Epoch: 18, Steps: 3 | Train Loss: 0.951 Vali Loss: 1.254 Vali Acc: 0.600 Test Loss: 1.254 Test Acc: 0.600
Validation loss decreased (-0.574987 --> -0.599987).  Saving model ...
Epoch: 19 cost time: 0.8841426372528076
Epoch: 19, Steps: 3 | Train Loss: 0.912 Vali Loss: 1.239 Vali Acc: 0.600 Test Loss: 1.239 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599988).  Saving model ...
Epoch: 20 cost time: 0.8891537189483643
Epoch: 20, Steps: 3 | Train Loss: 0.890 Vali Loss: 1.226 Vali Acc: 0.625 Test Loss: 1.226 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624988).  Saving model ...
Epoch: 21 cost time: 0.8021001815795898
Epoch: 21, Steps: 3 | Train Loss: 0.859 Vali Loss: 1.213 Vali Acc: 0.650 Test Loss: 1.213 Test Acc: 0.650
Validation loss decreased (-0.624988 --> -0.649988).  Saving model ...
Epoch: 22 cost time: 0.6522679328918457
Epoch: 22, Steps: 3 | Train Loss: 0.861 Vali Loss: 1.199 Vali Acc: 0.650 Test Loss: 1.199 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649988).  Saving model ...
Epoch: 23 cost time: 0.8761520385742188
Epoch: 23, Steps: 3 | Train Loss: 0.813 Vali Loss: 1.185 Vali Acc: 0.675 Test Loss: 1.185 Test Acc: 0.675
Validation loss decreased (-0.649988 --> -0.674988).  Saving model ...
Epoch: 24 cost time: 0.6953706741333008
Epoch: 24, Steps: 3 | Train Loss: 0.805 Vali Loss: 1.171 Vali Acc: 0.675 Test Loss: 1.171 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674988).  Saving model ...
Epoch: 25 cost time: 0.7788224220275879
Epoch: 25, Steps: 3 | Train Loss: 0.751 Vali Loss: 1.157 Vali Acc: 0.675 Test Loss: 1.157 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674988).  Saving model ...
Epoch: 26 cost time: 0.6891496181488037
Epoch: 26, Steps: 3 | Train Loss: 0.736 Vali Loss: 1.145 Vali Acc: 0.700 Test Loss: 1.145 Test Acc: 0.700
Validation loss decreased (-0.674988 --> -0.699989).  Saving model ...
Epoch: 27 cost time: 0.8196432590484619
Epoch: 27, Steps: 3 | Train Loss: 0.729 Vali Loss: 1.132 Vali Acc: 0.700 Test Loss: 1.132 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 28 cost time: 0.6430537700653076
Epoch: 28, Steps: 3 | Train Loss: 0.683 Vali Loss: 1.121 Vali Acc: 0.700 Test Loss: 1.121 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 29 cost time: 0.5798208713531494
Epoch: 29, Steps: 3 | Train Loss: 0.646 Vali Loss: 1.108 Vali Acc: 0.700 Test Loss: 1.108 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 30 cost time: 0.6979312896728516
Epoch: 30, Steps: 3 | Train Loss: 0.672 Vali Loss: 1.096 Vali Acc: 0.700 Test Loss: 1.096 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 31 cost time: 0.9126160144805908
Epoch: 31, Steps: 3 | Train Loss: 0.648 Vali Loss: 1.085 Vali Acc: 0.700 Test Loss: 1.085 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 32 cost time: 0.8624038696289062
Epoch: 32, Steps: 3 | Train Loss: 0.622 Vali Loss: 1.075 Vali Acc: 0.725 Test Loss: 1.075 Test Acc: 0.725
Validation loss decreased (-0.699989 --> -0.724989).  Saving model ...
Epoch: 33 cost time: 0.7498056888580322
Epoch: 33, Steps: 3 | Train Loss: 0.563 Vali Loss: 1.067 Vali Acc: 0.725 Test Loss: 1.067 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 34 cost time: 0.6928391456604004
Epoch: 34, Steps: 3 | Train Loss: 0.574 Vali Loss: 1.056 Vali Acc: 0.725 Test Loss: 1.056 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 35 cost time: 0.6906969547271729
Epoch: 35, Steps: 3 | Train Loss: 0.549 Vali Loss: 1.046 Vali Acc: 0.725 Test Loss: 1.046 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724990).  Saving model ...
Epoch: 36 cost time: 0.7154848575592041
Epoch: 36, Steps: 3 | Train Loss: 0.532 Vali Loss: 1.036 Vali Acc: 0.725 Test Loss: 1.036 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 37 cost time: 0.6514890193939209
Epoch: 37, Steps: 3 | Train Loss: 0.518 Vali Loss: 1.026 Vali Acc: 0.725 Test Loss: 1.026 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 38 cost time: 0.9885976314544678
Epoch: 38, Steps: 3 | Train Loss: 0.539 Vali Loss: 1.016 Vali Acc: 0.750 Test Loss: 1.016 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749990).  Saving model ...
Epoch: 39 cost time: 0.7124722003936768
Epoch: 39, Steps: 3 | Train Loss: 0.482 Vali Loss: 1.008 Vali Acc: 0.750 Test Loss: 1.008 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 40 cost time: 0.6274764537811279
Epoch: 40, Steps: 3 | Train Loss: 0.478 Vali Loss: 0.999 Vali Acc: 0.750 Test Loss: 0.999 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 41 cost time: 0.643404483795166
Epoch: 41, Steps: 3 | Train Loss: 0.466 Vali Loss: 0.991 Vali Acc: 0.750 Test Loss: 0.991 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 42 cost time: 0.589655876159668
Epoch: 42, Steps: 3 | Train Loss: 0.453 Vali Loss: 0.983 Vali Acc: 0.750 Test Loss: 0.983 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 43 cost time: 0.6047003269195557
Epoch: 43, Steps: 3 | Train Loss: 0.445 Vali Loss: 0.976 Vali Acc: 0.750 Test Loss: 0.976 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 44 cost time: 0.6778428554534912
Epoch: 44, Steps: 3 | Train Loss: 0.408 Vali Loss: 0.969 Vali Acc: 0.750 Test Loss: 0.969 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 45 cost time: 0.7704143524169922
Epoch: 45, Steps: 3 | Train Loss: 0.400 Vali Loss: 0.960 Vali Acc: 0.750 Test Loss: 0.960 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 46 cost time: 0.8110439777374268
Epoch: 46, Steps: 3 | Train Loss: 0.384 Vali Loss: 0.952 Vali Acc: 0.750 Test Loss: 0.952 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 47 cost time: 0.6904962062835693
Epoch: 47, Steps: 3 | Train Loss: 0.382 Vali Loss: 0.944 Vali Acc: 0.775 Test Loss: 0.944 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774991).  Saving model ...
Epoch: 48 cost time: 0.6427240371704102
Epoch: 48, Steps: 3 | Train Loss: 0.357 Vali Loss: 0.938 Vali Acc: 0.775 Test Loss: 0.938 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 49 cost time: 0.6527681350708008
Epoch: 49, Steps: 3 | Train Loss: 0.371 Vali Loss: 0.931 Vali Acc: 0.775 Test Loss: 0.931 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 50 cost time: 0.6804711818695068
Epoch: 50, Steps: 3 | Train Loss: 0.365 Vali Loss: 0.923 Vali Acc: 0.775 Test Loss: 0.923 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 51 cost time: 0.5352785587310791
Epoch: 51, Steps: 3 | Train Loss: 0.331 Vali Loss: 0.916 Vali Acc: 0.775 Test Loss: 0.916 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 52 cost time: 0.773566484451294
Epoch: 52, Steps: 3 | Train Loss: 0.344 Vali Loss: 0.910 Vali Acc: 0.775 Test Loss: 0.910 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 53 cost time: 0.5790245532989502
Epoch: 53, Steps: 3 | Train Loss: 0.334 Vali Loss: 0.904 Vali Acc: 0.775 Test Loss: 0.904 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 54 cost time: 0.7489304542541504
Epoch: 54, Steps: 3 | Train Loss: 0.338 Vali Loss: 0.898 Vali Acc: 0.775 Test Loss: 0.898 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 55 cost time: 0.5969698429107666
Epoch: 55, Steps: 3 | Train Loss: 0.301 Vali Loss: 0.893 Vali Acc: 0.775 Test Loss: 0.893 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 56 cost time: 0.6480515003204346
Epoch: 56, Steps: 3 | Train Loss: 0.318 Vali Loss: 0.888 Vali Acc: 0.775 Test Loss: 0.888 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 57 cost time: 0.7710509300231934
Epoch: 57, Steps: 3 | Train Loss: 0.320 Vali Loss: 0.883 Vali Acc: 0.775 Test Loss: 0.883 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 58 cost time: 0.9382083415985107
Epoch: 58, Steps: 3 | Train Loss: 0.290 Vali Loss: 0.878 Vali Acc: 0.775 Test Loss: 0.878 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 59 cost time: 0.8124127388000488
Epoch: 59, Steps: 3 | Train Loss: 0.311 Vali Loss: 0.875 Vali Acc: 0.775 Test Loss: 0.875 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 60 cost time: 0.707200288772583
Epoch: 60, Steps: 3 | Train Loss: 0.260 Vali Loss: 0.872 Vali Acc: 0.775 Test Loss: 0.872 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 61 cost time: 0.8393855094909668
Epoch: 61, Steps: 3 | Train Loss: 0.276 Vali Loss: 0.867 Vali Acc: 0.775 Test Loss: 0.867 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 62 cost time: 0.6844515800476074
Epoch: 62, Steps: 3 | Train Loss: 0.254 Vali Loss: 0.863 Vali Acc: 0.775 Test Loss: 0.863 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 63 cost time: 0.6463181972503662
Epoch: 63, Steps: 3 | Train Loss: 0.263 Vali Loss: 0.859 Vali Acc: 0.775 Test Loss: 0.859 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 64 cost time: 0.7386887073516846
Epoch: 64, Steps: 3 | Train Loss: 0.233 Vali Loss: 0.855 Vali Acc: 0.775 Test Loss: 0.855 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 65 cost time: 0.9504415988922119
Epoch: 65, Steps: 3 | Train Loss: 0.245 Vali Loss: 0.852 Vali Acc: 0.800 Test Loss: 0.852 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799991).  Saving model ...
Epoch: 66 cost time: 0.8591485023498535
Epoch: 66, Steps: 3 | Train Loss: 0.242 Vali Loss: 0.848 Vali Acc: 0.775 Test Loss: 0.848 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.6549983024597168
Epoch: 67, Steps: 3 | Train Loss: 0.234 Vali Loss: 0.844 Vali Acc: 0.775 Test Loss: 0.844 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.7084693908691406
Epoch: 68, Steps: 3 | Train Loss: 0.232 Vali Loss: 0.841 Vali Acc: 0.800 Test Loss: 0.841 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799992).  Saving model ...
Epoch: 69 cost time: 0.604677677154541
Epoch: 69, Steps: 3 | Train Loss: 0.228 Vali Loss: 0.837 Vali Acc: 0.800 Test Loss: 0.837 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 70 cost time: 0.7842831611633301
Epoch: 70, Steps: 3 | Train Loss: 0.223 Vali Loss: 0.834 Vali Acc: 0.800 Test Loss: 0.834 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 71 cost time: 0.633882999420166
Epoch: 71, Steps: 3 | Train Loss: 0.201 Vali Loss: 0.831 Vali Acc: 0.800 Test Loss: 0.831 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 72 cost time: 0.6359481811523438
Epoch: 72, Steps: 3 | Train Loss: 0.196 Vali Loss: 0.829 Vali Acc: 0.825 Test Loss: 0.829 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824992).  Saving model ...
Epoch: 73 cost time: 0.7239384651184082
Epoch: 73, Steps: 3 | Train Loss: 0.211 Vali Loss: 0.826 Vali Acc: 0.825 Test Loss: 0.826 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 74 cost time: 0.4668259620666504
Epoch: 74, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.825 Vali Acc: 0.800 Test Loss: 0.825 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 0.908341646194458
Epoch: 75, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.824 Vali Acc: 0.800 Test Loss: 0.824 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 0.697307825088501
Epoch: 76, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.823 Vali Acc: 0.800 Test Loss: 0.823 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 0.6396608352661133
Epoch: 77, Steps: 3 | Train Loss: 0.180 Vali Loss: 0.822 Vali Acc: 0.800 Test Loss: 0.822 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 0.8000349998474121
Epoch: 78, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.818 Vali Acc: 0.800 Test Loss: 0.818 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 0.8538522720336914
Epoch: 79, Steps: 3 | Train Loss: 0.170 Vali Loss: 0.816 Vali Acc: 0.825 Test Loss: 0.816 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 80 cost time: 0.7994065284729004
Epoch: 80, Steps: 3 | Train Loss: 0.183 Vali Loss: 0.813 Vali Acc: 0.825 Test Loss: 0.813 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 81 cost time: 0.6691808700561523
Epoch: 81, Steps: 3 | Train Loss: 0.179 Vali Loss: 0.809 Vali Acc: 0.825 Test Loss: 0.809 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 82 cost time: 0.5679416656494141
Epoch: 82, Steps: 3 | Train Loss: 0.154 Vali Loss: 0.806 Vali Acc: 0.825 Test Loss: 0.806 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 83 cost time: 0.5613975524902344
Epoch: 83, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.804 Vali Acc: 0.825 Test Loss: 0.804 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 84 cost time: 0.6838335990905762
Epoch: 84, Steps: 3 | Train Loss: 0.159 Vali Loss: 0.800 Vali Acc: 0.825 Test Loss: 0.800 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 85 cost time: 0.5553481578826904
Epoch: 85, Steps: 3 | Train Loss: 0.154 Vali Loss: 0.798 Vali Acc: 0.825 Test Loss: 0.798 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 86 cost time: 0.6633565425872803
Epoch: 86, Steps: 3 | Train Loss: 0.139 Vali Loss: 0.797 Vali Acc: 0.825 Test Loss: 0.797 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 87 cost time: 0.6676840782165527
Epoch: 87, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.796 Vali Acc: 0.825 Test Loss: 0.796 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 88 cost time: 0.6329247951507568
Epoch: 88, Steps: 3 | Train Loss: 0.133 Vali Loss: 0.793 Vali Acc: 0.825 Test Loss: 0.793 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 89 cost time: 0.7251076698303223
Epoch: 89, Steps: 3 | Train Loss: 0.139 Vali Loss: 0.792 Vali Acc: 0.825 Test Loss: 0.792 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 90 cost time: 0.76554274559021
Epoch: 90, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.791 Vali Acc: 0.825 Test Loss: 0.791 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 91 cost time: 0.7069389820098877
Epoch: 91, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.788 Vali Acc: 0.825 Test Loss: 0.788 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 92 cost time: 0.6448273658752441
Epoch: 92, Steps: 3 | Train Loss: 0.113 Vali Loss: 0.785 Vali Acc: 0.825 Test Loss: 0.785 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 93 cost time: 0.6762533187866211
Epoch: 93, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.781 Vali Acc: 0.825 Test Loss: 0.781 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 94 cost time: 0.7599565982818604
Epoch: 94, Steps: 3 | Train Loss: 0.109 Vali Loss: 0.778 Vali Acc: 0.825 Test Loss: 0.778 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 95 cost time: 0.592479944229126
Epoch: 95, Steps: 3 | Train Loss: 0.111 Vali Loss: 0.776 Vali Acc: 0.825 Test Loss: 0.776 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 96 cost time: 0.6794188022613525
Epoch: 96, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.774 Vali Acc: 0.825 Test Loss: 0.774 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 97 cost time: 0.6384797096252441
Epoch: 97, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.773 Vali Acc: 0.825 Test Loss: 0.773 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 98 cost time: 0.6210095882415771
Epoch: 98, Steps: 3 | Train Loss: 0.106 Vali Loss: 0.770 Vali Acc: 0.825 Test Loss: 0.770 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 99 cost time: 0.6994378566741943
Epoch: 99, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.767 Vali Acc: 0.825 Test Loss: 0.767 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 100 cost time: 0.7478392124176025
Epoch: 100, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.764 Vali Acc: 0.825 Test Loss: 0.764 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm32_cs17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.825
model parameter : 14056
model size : 0.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm32_cs15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.9315769672393799
Epoch: 1, Steps: 3 | Train Loss: 1.538 Vali Loss: 1.499 Vali Acc: 0.100 Test Loss: 1.499 Test Acc: 0.100
Validation loss decreased (inf --> -0.099985).  Saving model ...
Epoch: 2 cost time: 0.6400187015533447
Epoch: 2, Steps: 3 | Train Loss: 1.490 Vali Loss: 1.494 Vali Acc: 0.125 Test Loss: 1.494 Test Acc: 0.125
Validation loss decreased (-0.099985 --> -0.124985).  Saving model ...
Epoch: 3 cost time: 0.628594160079956
Epoch: 3, Steps: 3 | Train Loss: 1.480 Vali Loss: 1.488 Vali Acc: 0.150 Test Loss: 1.488 Test Acc: 0.150
Validation loss decreased (-0.124985 --> -0.149985).  Saving model ...
Epoch: 4 cost time: 0.5682659149169922
Epoch: 4, Steps: 3 | Train Loss: 1.436 Vali Loss: 1.480 Vali Acc: 0.175 Test Loss: 1.480 Test Acc: 0.175
Validation loss decreased (-0.149985 --> -0.174985).  Saving model ...
Epoch: 5 cost time: 0.6407570838928223
Epoch: 5, Steps: 3 | Train Loss: 1.432 Vali Loss: 1.472 Vali Acc: 0.200 Test Loss: 1.472 Test Acc: 0.200
Validation loss decreased (-0.174985 --> -0.199985).  Saving model ...
Epoch: 6 cost time: 0.6904957294464111
Epoch: 6, Steps: 3 | Train Loss: 1.405 Vali Loss: 1.462 Vali Acc: 0.225 Test Loss: 1.462 Test Acc: 0.225
Validation loss decreased (-0.199985 --> -0.224985).  Saving model ...
Epoch: 7 cost time: 0.5990159511566162
Epoch: 7, Steps: 3 | Train Loss: 1.410 Vali Loss: 1.452 Vali Acc: 0.275 Test Loss: 1.452 Test Acc: 0.275
Validation loss decreased (-0.224985 --> -0.274985).  Saving model ...
Epoch: 8 cost time: 0.5548288822174072
Epoch: 8, Steps: 3 | Train Loss: 1.346 Vali Loss: 1.442 Vali Acc: 0.325 Test Loss: 1.442 Test Acc: 0.325
Validation loss decreased (-0.274985 --> -0.324986).  Saving model ...
Epoch: 9 cost time: 0.7902412414550781
Epoch: 9, Steps: 3 | Train Loss: 1.366 Vali Loss: 1.429 Vali Acc: 0.400 Test Loss: 1.429 Test Acc: 0.400
Validation loss decreased (-0.324986 --> -0.399986).  Saving model ...
Epoch: 10 cost time: 0.642986536026001
Epoch: 10, Steps: 3 | Train Loss: 1.278 Vali Loss: 1.416 Vali Acc: 0.450 Test Loss: 1.416 Test Acc: 0.450
Validation loss decreased (-0.399986 --> -0.449986).  Saving model ...
Epoch: 11 cost time: 0.6498403549194336
Epoch: 11, Steps: 3 | Train Loss: 1.274 Vali Loss: 1.402 Vali Acc: 0.450 Test Loss: 1.402 Test Acc: 0.450
Validation loss decreased (-0.449986 --> -0.449986).  Saving model ...
Epoch: 12 cost time: 0.6299653053283691
Epoch: 12, Steps: 3 | Train Loss: 1.260 Vali Loss: 1.388 Vali Acc: 0.475 Test Loss: 1.388 Test Acc: 0.475
Validation loss decreased (-0.449986 --> -0.474986).  Saving model ...
Epoch: 13 cost time: 0.7269375324249268
Epoch: 13, Steps: 3 | Train Loss: 1.229 Vali Loss: 1.373 Vali Acc: 0.475 Test Loss: 1.373 Test Acc: 0.475
Validation loss decreased (-0.474986 --> -0.474986).  Saving model ...
Epoch: 14 cost time: 0.5405564308166504
Epoch: 14, Steps: 3 | Train Loss: 1.209 Vali Loss: 1.358 Vali Acc: 0.475 Test Loss: 1.358 Test Acc: 0.475
Validation loss decreased (-0.474986 --> -0.474986).  Saving model ...
Epoch: 15 cost time: 0.619896411895752
Epoch: 15, Steps: 3 | Train Loss: 1.176 Vali Loss: 1.341 Vali Acc: 0.500 Test Loss: 1.341 Test Acc: 0.500
Validation loss decreased (-0.474986 --> -0.499987).  Saving model ...
Epoch: 16 cost time: 0.6195399761199951
Epoch: 16, Steps: 3 | Train Loss: 1.139 Vali Loss: 1.323 Vali Acc: 0.550 Test Loss: 1.323 Test Acc: 0.550
Validation loss decreased (-0.499987 --> -0.549987).  Saving model ...
Epoch: 17 cost time: 0.5437335968017578
Epoch: 17, Steps: 3 | Train Loss: 1.083 Vali Loss: 1.304 Vali Acc: 0.575 Test Loss: 1.304 Test Acc: 0.575
Validation loss decreased (-0.549987 --> -0.574987).  Saving model ...
Epoch: 18 cost time: 0.590165376663208
Epoch: 18, Steps: 3 | Train Loss: 1.055 Vali Loss: 1.287 Vali Acc: 0.600 Test Loss: 1.287 Test Acc: 0.600
Validation loss decreased (-0.574987 --> -0.599987).  Saving model ...
Epoch: 19 cost time: 0.7172489166259766
Epoch: 19, Steps: 3 | Train Loss: 1.029 Vali Loss: 1.267 Vali Acc: 0.600 Test Loss: 1.267 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599987).  Saving model ...
Epoch: 20 cost time: 0.6854519844055176
Epoch: 20, Steps: 3 | Train Loss: 1.011 Vali Loss: 1.249 Vali Acc: 0.650 Test Loss: 1.249 Test Acc: 0.650
Validation loss decreased (-0.599987 --> -0.649988).  Saving model ...
Epoch: 21 cost time: 0.7034647464752197
Epoch: 21, Steps: 3 | Train Loss: 0.942 Vali Loss: 1.232 Vali Acc: 0.725 Test Loss: 1.232 Test Acc: 0.725
Validation loss decreased (-0.649988 --> -0.724988).  Saving model ...
Epoch: 22 cost time: 0.8214647769927979
Epoch: 22, Steps: 3 | Train Loss: 0.920 Vali Loss: 1.216 Vali Acc: 0.775 Test Loss: 1.216 Test Acc: 0.775
Validation loss decreased (-0.724988 --> -0.774988).  Saving model ...
Epoch: 23 cost time: 0.5550458431243896
Epoch: 23, Steps: 3 | Train Loss: 0.913 Vali Loss: 1.196 Vali Acc: 0.775 Test Loss: 1.196 Test Acc: 0.775
Validation loss decreased (-0.774988 --> -0.774988).  Saving model ...
Epoch: 24 cost time: 0.6043787002563477
Epoch: 24, Steps: 3 | Train Loss: 0.867 Vali Loss: 1.181 Vali Acc: 0.775 Test Loss: 1.181 Test Acc: 0.775
Validation loss decreased (-0.774988 --> -0.774988).  Saving model ...
Epoch: 25 cost time: 0.596895694732666
Epoch: 25, Steps: 3 | Train Loss: 0.854 Vali Loss: 1.163 Vali Acc: 0.775 Test Loss: 1.163 Test Acc: 0.775
Validation loss decreased (-0.774988 --> -0.774988).  Saving model ...
Epoch: 26 cost time: 0.6203022003173828
Epoch: 26, Steps: 3 | Train Loss: 0.827 Vali Loss: 1.146 Vali Acc: 0.750 Test Loss: 1.146 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5379760265350342
Epoch: 27, Steps: 3 | Train Loss: 0.790 Vali Loss: 1.131 Vali Acc: 0.750 Test Loss: 1.131 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.5474791526794434
Epoch: 28, Steps: 3 | Train Loss: 0.772 Vali Loss: 1.118 Vali Acc: 0.750 Test Loss: 1.118 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.656834602355957
Epoch: 29, Steps: 3 | Train Loss: 0.761 Vali Loss: 1.107 Vali Acc: 0.750 Test Loss: 1.107 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.5893046855926514
Epoch: 30, Steps: 3 | Train Loss: 0.717 Vali Loss: 1.099 Vali Acc: 0.750 Test Loss: 1.099 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.5807161331176758
Epoch: 31, Steps: 3 | Train Loss: 0.680 Vali Loss: 1.090 Vali Acc: 0.750 Test Loss: 1.090 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.6915385723114014
Epoch: 32, Steps: 3 | Train Loss: 0.675 Vali Loss: 1.077 Vali Acc: 0.750 Test Loss: 1.077 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.7843186855316162
Epoch: 33, Steps: 3 | Train Loss: 0.661 Vali Loss: 1.060 Vali Acc: 0.750 Test Loss: 1.060 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.7649044990539551
Epoch: 34, Steps: 3 | Train Loss: 0.624 Vali Loss: 1.045 Vali Acc: 0.750 Test Loss: 1.045 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.5400195121765137
Epoch: 35, Steps: 3 | Train Loss: 0.575 Vali Loss: 1.030 Vali Acc: 0.775 Test Loss: 1.030 Test Acc: 0.775
Validation loss decreased (-0.774988 --> -0.774990).  Saving model ...
Epoch: 36 cost time: 0.7299134731292725
Epoch: 36, Steps: 3 | Train Loss: 0.549 Vali Loss: 1.014 Vali Acc: 0.800 Test Loss: 1.014 Test Acc: 0.800
Validation loss decreased (-0.774990 --> -0.799990).  Saving model ...
Epoch: 37 cost time: 0.655658483505249
Epoch: 37, Steps: 3 | Train Loss: 0.526 Vali Loss: 0.994 Vali Acc: 0.800 Test Loss: 0.994 Test Acc: 0.800
Validation loss decreased (-0.799990 --> -0.799990).  Saving model ...
Epoch: 38 cost time: 0.6687965393066406
Epoch: 38, Steps: 3 | Train Loss: 0.510 Vali Loss: 0.979 Vali Acc: 0.825 Test Loss: 0.979 Test Acc: 0.825
Validation loss decreased (-0.799990 --> -0.824990).  Saving model ...
Epoch: 39 cost time: 0.8112881183624268
Epoch: 39, Steps: 3 | Train Loss: 0.507 Vali Loss: 0.966 Vali Acc: 0.825 Test Loss: 0.966 Test Acc: 0.825
Validation loss decreased (-0.824990 --> -0.824990).  Saving model ...
Epoch: 40 cost time: 0.681643009185791
Epoch: 40, Steps: 3 | Train Loss: 0.509 Vali Loss: 0.954 Vali Acc: 0.825 Test Loss: 0.954 Test Acc: 0.825
Validation loss decreased (-0.824990 --> -0.824990).  Saving model ...
Epoch: 41 cost time: 0.5893023014068604
Epoch: 41, Steps: 3 | Train Loss: 0.482 Vali Loss: 0.942 Vali Acc: 0.825 Test Loss: 0.942 Test Acc: 0.825
Validation loss decreased (-0.824990 --> -0.824991).  Saving model ...
Epoch: 42 cost time: 0.663637638092041
Epoch: 42, Steps: 3 | Train Loss: 0.479 Vali Loss: 0.931 Vali Acc: 0.825 Test Loss: 0.931 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824991).  Saving model ...
Epoch: 43 cost time: 0.604315996170044
Epoch: 43, Steps: 3 | Train Loss: 0.471 Vali Loss: 0.924 Vali Acc: 0.825 Test Loss: 0.924 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824991).  Saving model ...
Epoch: 44 cost time: 0.9217822551727295
Epoch: 44, Steps: 3 | Train Loss: 0.431 Vali Loss: 0.921 Vali Acc: 0.825 Test Loss: 0.921 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824991).  Saving model ...
Epoch: 45 cost time: 0.826869010925293
Epoch: 45, Steps: 3 | Train Loss: 0.433 Vali Loss: 0.914 Vali Acc: 0.800 Test Loss: 0.914 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.5797960758209229
Epoch: 46, Steps: 3 | Train Loss: 0.444 Vali Loss: 0.909 Vali Acc: 0.800 Test Loss: 0.909 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.6885640621185303
Epoch: 47, Steps: 3 | Train Loss: 0.439 Vali Loss: 0.905 Vali Acc: 0.800 Test Loss: 0.905 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.8240761756896973
Epoch: 48, Steps: 3 | Train Loss: 0.391 Vali Loss: 0.900 Vali Acc: 0.800 Test Loss: 0.900 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.8145263195037842
Epoch: 49, Steps: 3 | Train Loss: 0.359 Vali Loss: 0.896 Vali Acc: 0.800 Test Loss: 0.896 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.5726661682128906
Epoch: 50, Steps: 3 | Train Loss: 0.394 Vali Loss: 0.887 Vali Acc: 0.800 Test Loss: 0.887 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.6428472995758057
Epoch: 51, Steps: 3 | Train Loss: 0.383 Vali Loss: 0.881 Vali Acc: 0.825 Test Loss: 0.881 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824991).  Saving model ...
Epoch: 52 cost time: 0.6776943206787109
Epoch: 52, Steps: 3 | Train Loss: 0.319 Vali Loss: 0.878 Vali Acc: 0.825 Test Loss: 0.878 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824991).  Saving model ...
Epoch: 53 cost time: 0.6021995544433594
Epoch: 53, Steps: 3 | Train Loss: 0.345 Vali Loss: 0.870 Vali Acc: 0.825 Test Loss: 0.870 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824991).  Saving model ...
Epoch: 54 cost time: 0.6265659332275391
Epoch: 54, Steps: 3 | Train Loss: 0.352 Vali Loss: 0.866 Vali Acc: 0.825 Test Loss: 0.866 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824991).  Saving model ...
Epoch: 55 cost time: 0.5544078350067139
Epoch: 55, Steps: 3 | Train Loss: 0.337 Vali Loss: 0.863 Vali Acc: 0.825 Test Loss: 0.863 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824991).  Saving model ...
Epoch: 56 cost time: 0.7491276264190674
Epoch: 56, Steps: 3 | Train Loss: 0.300 Vali Loss: 0.859 Vali Acc: 0.825 Test Loss: 0.859 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824991).  Saving model ...
Epoch: 57 cost time: 0.5497100353240967
Epoch: 57, Steps: 3 | Train Loss: 0.311 Vali Loss: 0.855 Vali Acc: 0.825 Test Loss: 0.855 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824991).  Saving model ...
Epoch: 58 cost time: 0.5860583782196045
Epoch: 58, Steps: 3 | Train Loss: 0.324 Vali Loss: 0.852 Vali Acc: 0.825 Test Loss: 0.852 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824991).  Saving model ...
Epoch: 59 cost time: 0.7570285797119141
Epoch: 59, Steps: 3 | Train Loss: 0.282 Vali Loss: 0.849 Vali Acc: 0.825 Test Loss: 0.849 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824992).  Saving model ...
Epoch: 60 cost time: 0.6718909740447998
Epoch: 60, Steps: 3 | Train Loss: 0.315 Vali Loss: 0.847 Vali Acc: 0.825 Test Loss: 0.847 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 61 cost time: 0.5983297824859619
Epoch: 61, Steps: 3 | Train Loss: 0.310 Vali Loss: 0.847 Vali Acc: 0.825 Test Loss: 0.847 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 62 cost time: 0.9267942905426025
Epoch: 62, Steps: 3 | Train Loss: 0.287 Vali Loss: 0.847 Vali Acc: 0.825 Test Loss: 0.847 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 63 cost time: 0.6563282012939453
Epoch: 63, Steps: 3 | Train Loss: 0.266 Vali Loss: 0.847 Vali Acc: 0.825 Test Loss: 0.847 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 64 cost time: 0.710439920425415
Epoch: 64, Steps: 3 | Train Loss: 0.252 Vali Loss: 0.843 Vali Acc: 0.825 Test Loss: 0.843 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 65 cost time: 0.6026420593261719
Epoch: 65, Steps: 3 | Train Loss: 0.270 Vali Loss: 0.839 Vali Acc: 0.825 Test Loss: 0.839 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 66 cost time: 0.7341773509979248
Epoch: 66, Steps: 3 | Train Loss: 0.267 Vali Loss: 0.835 Vali Acc: 0.825 Test Loss: 0.835 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 67 cost time: 0.5664777755737305
Epoch: 67, Steps: 3 | Train Loss: 0.247 Vali Loss: 0.831 Vali Acc: 0.825 Test Loss: 0.831 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 68 cost time: 0.5237665176391602
Epoch: 68, Steps: 3 | Train Loss: 0.243 Vali Loss: 0.830 Vali Acc: 0.825 Test Loss: 0.830 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 69 cost time: 0.5088315010070801
Epoch: 69, Steps: 3 | Train Loss: 0.226 Vali Loss: 0.829 Vali Acc: 0.825 Test Loss: 0.829 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 70 cost time: 0.636249303817749
Epoch: 70, Steps: 3 | Train Loss: 0.243 Vali Loss: 0.827 Vali Acc: 0.825 Test Loss: 0.827 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 71 cost time: 0.7978198528289795
Epoch: 71, Steps: 3 | Train Loss: 0.216 Vali Loss: 0.827 Vali Acc: 0.825 Test Loss: 0.827 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 72 cost time: 0.5453705787658691
Epoch: 72, Steps: 3 | Train Loss: 0.216 Vali Loss: 0.826 Vali Acc: 0.825 Test Loss: 0.826 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 73 cost time: 0.9304485321044922
Epoch: 73, Steps: 3 | Train Loss: 0.215 Vali Loss: 0.825 Vali Acc: 0.825 Test Loss: 0.825 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 74 cost time: 0.7068769931793213
Epoch: 74, Steps: 3 | Train Loss: 0.222 Vali Loss: 0.826 Vali Acc: 0.825 Test Loss: 0.826 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 0.8348605632781982
Epoch: 75, Steps: 3 | Train Loss: 0.210 Vali Loss: 0.829 Vali Acc: 0.825 Test Loss: 0.829 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 0.5567378997802734
Epoch: 76, Steps: 3 | Train Loss: 0.205 Vali Loss: 0.831 Vali Acc: 0.825 Test Loss: 0.831 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 0.6718251705169678
Epoch: 77, Steps: 3 | Train Loss: 0.182 Vali Loss: 0.833 Vali Acc: 0.825 Test Loss: 0.833 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 0.9152998924255371
Epoch: 78, Steps: 3 | Train Loss: 0.192 Vali Loss: 0.831 Vali Acc: 0.825 Test Loss: 0.831 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 0.7682948112487793
Epoch: 79, Steps: 3 | Train Loss: 0.188 Vali Loss: 0.829 Vali Acc: 0.825 Test Loss: 0.829 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 80 cost time: 0.7617859840393066
Epoch: 80, Steps: 3 | Train Loss: 0.186 Vali Loss: 0.827 Vali Acc: 0.825 Test Loss: 0.827 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 81 cost time: 0.7139010429382324
Epoch: 81, Steps: 3 | Train Loss: 0.190 Vali Loss: 0.830 Vali Acc: 0.825 Test Loss: 0.830 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 82 cost time: 0.7242350578308105
Epoch: 82, Steps: 3 | Train Loss: 0.179 Vali Loss: 0.831 Vali Acc: 0.825 Test Loss: 0.831 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 83 cost time: 0.7376642227172852
Epoch: 83, Steps: 3 | Train Loss: 0.184 Vali Loss: 0.827 Vali Acc: 0.825 Test Loss: 0.827 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm32_cs15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.825
model parameter : 14354
model size : 0.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm32_cs13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.300128698348999
Epoch: 1, Steps: 3 | Train Loss: 1.311 Vali Loss: 1.382 Vali Acc: 0.300 Test Loss: 1.382 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.5669538974761963
Epoch: 2, Steps: 3 | Train Loss: 1.310 Vali Loss: 1.377 Vali Acc: 0.300 Test Loss: 1.377 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 0.7477130889892578
Epoch: 3, Steps: 3 | Train Loss: 1.286 Vali Loss: 1.373 Vali Acc: 0.300 Test Loss: 1.373 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 4 cost time: 0.6329364776611328
Epoch: 4, Steps: 3 | Train Loss: 1.289 Vali Loss: 1.367 Vali Acc: 0.325 Test Loss: 1.367 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324986).  Saving model ...
Epoch: 5 cost time: 0.6872732639312744
Epoch: 5, Steps: 3 | Train Loss: 1.279 Vali Loss: 1.361 Vali Acc: 0.400 Test Loss: 1.361 Test Acc: 0.400
Validation loss decreased (-0.324986 --> -0.399986).  Saving model ...
Epoch: 6 cost time: 0.6194829940795898
Epoch: 6, Steps: 3 | Train Loss: 1.253 Vali Loss: 1.353 Vali Acc: 0.425 Test Loss: 1.353 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424986).  Saving model ...
Epoch: 7 cost time: 0.6304891109466553
Epoch: 7, Steps: 3 | Train Loss: 1.221 Vali Loss: 1.346 Vali Acc: 0.450 Test Loss: 1.346 Test Acc: 0.450
Validation loss decreased (-0.424986 --> -0.449987).  Saving model ...
Epoch: 8 cost time: 0.7398562431335449
Epoch: 8, Steps: 3 | Train Loss: 1.179 Vali Loss: 1.338 Vali Acc: 0.475 Test Loss: 1.338 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474987).  Saving model ...
Epoch: 9 cost time: 0.7779848575592041
Epoch: 9, Steps: 3 | Train Loss: 1.180 Vali Loss: 1.328 Vali Acc: 0.500 Test Loss: 1.328 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499987).  Saving model ...
Epoch: 10 cost time: 0.6616530418395996
Epoch: 10, Steps: 3 | Train Loss: 1.156 Vali Loss: 1.317 Vali Acc: 0.500 Test Loss: 1.317 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 11 cost time: 0.5633933544158936
Epoch: 11, Steps: 3 | Train Loss: 1.094 Vali Loss: 1.305 Vali Acc: 0.500 Test Loss: 1.305 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 12 cost time: 0.6559457778930664
Epoch: 12, Steps: 3 | Train Loss: 1.097 Vali Loss: 1.292 Vali Acc: 0.500 Test Loss: 1.292 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 13 cost time: 0.6659882068634033
Epoch: 13, Steps: 3 | Train Loss: 1.072 Vali Loss: 1.278 Vali Acc: 0.500 Test Loss: 1.278 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 14 cost time: 0.5130586624145508
Epoch: 14, Steps: 3 | Train Loss: 1.047 Vali Loss: 1.265 Vali Acc: 0.475 Test Loss: 1.265 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7075560092926025
Epoch: 15, Steps: 3 | Train Loss: 1.003 Vali Loss: 1.251 Vali Acc: 0.475 Test Loss: 1.251 Test Acc: 0.475
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6144008636474609
Epoch: 16, Steps: 3 | Train Loss: 0.969 Vali Loss: 1.237 Vali Acc: 0.475 Test Loss: 1.237 Test Acc: 0.475
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6436169147491455
Epoch: 17, Steps: 3 | Train Loss: 0.961 Vali Loss: 1.223 Vali Acc: 0.500 Test Loss: 1.223 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499988).  Saving model ...
Epoch: 18 cost time: 0.6114282608032227
Epoch: 18, Steps: 3 | Train Loss: 0.910 Vali Loss: 1.207 Vali Acc: 0.650 Test Loss: 1.207 Test Acc: 0.650
Validation loss decreased (-0.499988 --> -0.649988).  Saving model ...
Epoch: 19 cost time: 0.7372992038726807
Epoch: 19, Steps: 3 | Train Loss: 0.854 Vali Loss: 1.191 Vali Acc: 0.650 Test Loss: 1.191 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649988).  Saving model ...
Epoch: 20 cost time: 0.8681068420410156
Epoch: 20, Steps: 3 | Train Loss: 0.824 Vali Loss: 1.172 Vali Acc: 0.675 Test Loss: 1.172 Test Acc: 0.675
Validation loss decreased (-0.649988 --> -0.674988).  Saving model ...
Epoch: 21 cost time: 0.663966178894043
Epoch: 21, Steps: 3 | Train Loss: 0.828 Vali Loss: 1.155 Vali Acc: 0.675 Test Loss: 1.155 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674988).  Saving model ...
Epoch: 22 cost time: 0.6304070949554443
Epoch: 22, Steps: 3 | Train Loss: 0.813 Vali Loss: 1.138 Vali Acc: 0.675 Test Loss: 1.138 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674989).  Saving model ...
Epoch: 23 cost time: 0.5950767993927002
Epoch: 23, Steps: 3 | Train Loss: 0.748 Vali Loss: 1.122 Vali Acc: 0.675 Test Loss: 1.122 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 24 cost time: 0.7772071361541748
Epoch: 24, Steps: 3 | Train Loss: 0.763 Vali Loss: 1.104 Vali Acc: 0.675 Test Loss: 1.104 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 25 cost time: 0.7595267295837402
Epoch: 25, Steps: 3 | Train Loss: 0.744 Vali Loss: 1.088 Vali Acc: 0.675 Test Loss: 1.088 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 26 cost time: 0.6599023342132568
Epoch: 26, Steps: 3 | Train Loss: 0.685 Vali Loss: 1.071 Vali Acc: 0.750 Test Loss: 1.071 Test Acc: 0.750
Validation loss decreased (-0.674989 --> -0.749989).  Saving model ...
Epoch: 27 cost time: 0.7620627880096436
Epoch: 27, Steps: 3 | Train Loss: 0.701 Vali Loss: 1.055 Vali Acc: 0.750 Test Loss: 1.055 Test Acc: 0.750
Validation loss decreased (-0.749989 --> -0.749989).  Saving model ...
Epoch: 28 cost time: 0.6433475017547607
Epoch: 28, Steps: 3 | Train Loss: 0.641 Vali Loss: 1.037 Vali Acc: 0.750 Test Loss: 1.037 Test Acc: 0.750
Validation loss decreased (-0.749989 --> -0.749990).  Saving model ...
Epoch: 29 cost time: 0.6795833110809326
Epoch: 29, Steps: 3 | Train Loss: 0.648 Vali Loss: 1.022 Vali Acc: 0.725 Test Loss: 1.022 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6948018074035645
Epoch: 30, Steps: 3 | Train Loss: 0.592 Vali Loss: 1.007 Vali Acc: 0.725 Test Loss: 1.007 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.7154660224914551
Epoch: 31, Steps: 3 | Train Loss: 0.592 Vali Loss: 0.993 Vali Acc: 0.725 Test Loss: 0.993 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.8139615058898926
Epoch: 32, Steps: 3 | Train Loss: 0.572 Vali Loss: 0.980 Vali Acc: 0.725 Test Loss: 0.980 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.6606299877166748
Epoch: 33, Steps: 3 | Train Loss: 0.552 Vali Loss: 0.966 Vali Acc: 0.750 Test Loss: 0.966 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 34 cost time: 0.9441626071929932
Epoch: 34, Steps: 3 | Train Loss: 0.548 Vali Loss: 0.956 Vali Acc: 0.775 Test Loss: 0.956 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774990).  Saving model ...
Epoch: 35 cost time: 0.702735424041748
Epoch: 35, Steps: 3 | Train Loss: 0.498 Vali Loss: 0.944 Vali Acc: 0.775 Test Loss: 0.944 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774991).  Saving model ...
Epoch: 36 cost time: 0.8981659412384033
Epoch: 36, Steps: 3 | Train Loss: 0.506 Vali Loss: 0.931 Vali Acc: 0.775 Test Loss: 0.931 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 37 cost time: 0.7442681789398193
Epoch: 37, Steps: 3 | Train Loss: 0.475 Vali Loss: 0.919 Vali Acc: 0.775 Test Loss: 0.919 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 38 cost time: 0.7431759834289551
Epoch: 38, Steps: 3 | Train Loss: 0.465 Vali Loss: 0.907 Vali Acc: 0.775 Test Loss: 0.907 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 39 cost time: 0.8899755477905273
Epoch: 39, Steps: 3 | Train Loss: 0.424 Vali Loss: 0.896 Vali Acc: 0.775 Test Loss: 0.896 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 40 cost time: 0.7846975326538086
Epoch: 40, Steps: 3 | Train Loss: 0.438 Vali Loss: 0.887 Vali Acc: 0.775 Test Loss: 0.887 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 41 cost time: 0.8233532905578613
Epoch: 41, Steps: 3 | Train Loss: 0.424 Vali Loss: 0.877 Vali Acc: 0.775 Test Loss: 0.877 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 42 cost time: 0.9207613468170166
Epoch: 42, Steps: 3 | Train Loss: 0.412 Vali Loss: 0.868 Vali Acc: 0.775 Test Loss: 0.868 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 43 cost time: 0.7086901664733887
Epoch: 43, Steps: 3 | Train Loss: 0.406 Vali Loss: 0.859 Vali Acc: 0.775 Test Loss: 0.859 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 44 cost time: 0.7721319198608398
Epoch: 44, Steps: 3 | Train Loss: 0.379 Vali Loss: 0.851 Vali Acc: 0.775 Test Loss: 0.851 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 45 cost time: 0.6662125587463379
Epoch: 45, Steps: 3 | Train Loss: 0.374 Vali Loss: 0.845 Vali Acc: 0.775 Test Loss: 0.845 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774992).  Saving model ...
Epoch: 46 cost time: 0.6221764087677002
Epoch: 46, Steps: 3 | Train Loss: 0.345 Vali Loss: 0.838 Vali Acc: 0.775 Test Loss: 0.838 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 47 cost time: 0.6841890811920166
Epoch: 47, Steps: 3 | Train Loss: 0.341 Vali Loss: 0.833 Vali Acc: 0.775 Test Loss: 0.833 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 48 cost time: 0.6681604385375977
Epoch: 48, Steps: 3 | Train Loss: 0.345 Vali Loss: 0.828 Vali Acc: 0.775 Test Loss: 0.828 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 49 cost time: 0.7985303401947021
Epoch: 49, Steps: 3 | Train Loss: 0.335 Vali Loss: 0.825 Vali Acc: 0.775 Test Loss: 0.825 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 50 cost time: 0.774451732635498
Epoch: 50, Steps: 3 | Train Loss: 0.339 Vali Loss: 0.822 Vali Acc: 0.775 Test Loss: 0.822 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 51 cost time: 0.6106598377227783
Epoch: 51, Steps: 3 | Train Loss: 0.332 Vali Loss: 0.821 Vali Acc: 0.775 Test Loss: 0.821 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 52 cost time: 0.8851733207702637
Epoch: 52, Steps: 3 | Train Loss: 0.303 Vali Loss: 0.816 Vali Acc: 0.775 Test Loss: 0.816 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 53 cost time: 0.5951652526855469
Epoch: 53, Steps: 3 | Train Loss: 0.288 Vali Loss: 0.810 Vali Acc: 0.800 Test Loss: 0.810 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799992).  Saving model ...
Epoch: 54 cost time: 0.7334475517272949
Epoch: 54, Steps: 3 | Train Loss: 0.289 Vali Loss: 0.805 Vali Acc: 0.800 Test Loss: 0.805 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 55 cost time: 0.75211501121521
Epoch: 55, Steps: 3 | Train Loss: 0.305 Vali Loss: 0.800 Vali Acc: 0.800 Test Loss: 0.800 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 56 cost time: 0.6540243625640869
Epoch: 56, Steps: 3 | Train Loss: 0.299 Vali Loss: 0.795 Vali Acc: 0.800 Test Loss: 0.795 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 57 cost time: 0.6617369651794434
Epoch: 57, Steps: 3 | Train Loss: 0.258 Vali Loss: 0.791 Vali Acc: 0.800 Test Loss: 0.791 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 58 cost time: 0.6072654724121094
Epoch: 58, Steps: 3 | Train Loss: 0.240 Vali Loss: 0.788 Vali Acc: 0.800 Test Loss: 0.788 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 59 cost time: 0.6422421932220459
Epoch: 59, Steps: 3 | Train Loss: 0.268 Vali Loss: 0.783 Vali Acc: 0.800 Test Loss: 0.783 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 60 cost time: 0.698662519454956
Epoch: 60, Steps: 3 | Train Loss: 0.260 Vali Loss: 0.781 Vali Acc: 0.800 Test Loss: 0.781 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 61 cost time: 0.8045775890350342
Epoch: 61, Steps: 3 | Train Loss: 0.234 Vali Loss: 0.778 Vali Acc: 0.825 Test Loss: 0.778 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824992).  Saving model ...
Epoch: 62 cost time: 0.6969285011291504
Epoch: 62, Steps: 3 | Train Loss: 0.259 Vali Loss: 0.775 Vali Acc: 0.825 Test Loss: 0.775 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 63 cost time: 0.6820876598358154
Epoch: 63, Steps: 3 | Train Loss: 0.227 Vali Loss: 0.772 Vali Acc: 0.825 Test Loss: 0.772 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 64 cost time: 0.6600005626678467
Epoch: 64, Steps: 3 | Train Loss: 0.236 Vali Loss: 0.771 Vali Acc: 0.825 Test Loss: 0.771 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 65 cost time: 0.652907133102417
Epoch: 65, Steps: 3 | Train Loss: 0.219 Vali Loss: 0.769 Vali Acc: 0.825 Test Loss: 0.769 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 66 cost time: 0.6289429664611816
Epoch: 66, Steps: 3 | Train Loss: 0.202 Vali Loss: 0.768 Vali Acc: 0.825 Test Loss: 0.768 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 67 cost time: 0.6684010028839111
Epoch: 67, Steps: 3 | Train Loss: 0.202 Vali Loss: 0.766 Vali Acc: 0.825 Test Loss: 0.766 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 68 cost time: 0.5581483840942383
Epoch: 68, Steps: 3 | Train Loss: 0.203 Vali Loss: 0.765 Vali Acc: 0.825 Test Loss: 0.765 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 69 cost time: 0.6403279304504395
Epoch: 69, Steps: 3 | Train Loss: 0.197 Vali Loss: 0.766 Vali Acc: 0.825 Test Loss: 0.766 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.7687933444976807
Epoch: 70, Steps: 3 | Train Loss: 0.211 Vali Loss: 0.766 Vali Acc: 0.825 Test Loss: 0.766 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 0.6653628349304199
Epoch: 71, Steps: 3 | Train Loss: 0.184 Vali Loss: 0.764 Vali Acc: 0.825 Test Loss: 0.764 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 72 cost time: 0.6009831428527832
Epoch: 72, Steps: 3 | Train Loss: 0.192 Vali Loss: 0.761 Vali Acc: 0.825 Test Loss: 0.761 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 73 cost time: 0.8795645236968994
Epoch: 73, Steps: 3 | Train Loss: 0.190 Vali Loss: 0.758 Vali Acc: 0.825 Test Loss: 0.758 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 74 cost time: 0.87007737159729
Epoch: 74, Steps: 3 | Train Loss: 0.178 Vali Loss: 0.755 Vali Acc: 0.825 Test Loss: 0.755 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 75 cost time: 0.6703081130981445
Epoch: 75, Steps: 3 | Train Loss: 0.198 Vali Loss: 0.751 Vali Acc: 0.825 Test Loss: 0.751 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 76 cost time: 0.5890517234802246
Epoch: 76, Steps: 3 | Train Loss: 0.191 Vali Loss: 0.750 Vali Acc: 0.825 Test Loss: 0.750 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 77 cost time: 0.5733435153961182
Epoch: 77, Steps: 3 | Train Loss: 0.173 Vali Loss: 0.751 Vali Acc: 0.825 Test Loss: 0.751 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 0.7835657596588135
Epoch: 78, Steps: 3 | Train Loss: 0.181 Vali Loss: 0.752 Vali Acc: 0.825 Test Loss: 0.752 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 0.6191349029541016
Epoch: 79, Steps: 3 | Train Loss: 0.161 Vali Loss: 0.755 Vali Acc: 0.825 Test Loss: 0.755 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 0.827326774597168
Epoch: 80, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.754 Vali Acc: 0.825 Test Loss: 0.754 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 81 cost time: 0.8023431301116943
Epoch: 81, Steps: 3 | Train Loss: 0.142 Vali Loss: 0.753 Vali Acc: 0.825 Test Loss: 0.753 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 82 cost time: 0.6312785148620605
Epoch: 82, Steps: 3 | Train Loss: 0.171 Vali Loss: 0.751 Vali Acc: 0.825 Test Loss: 0.751 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 83 cost time: 0.6082415580749512
Epoch: 83, Steps: 3 | Train Loss: 0.144 Vali Loss: 0.751 Vali Acc: 0.825 Test Loss: 0.751 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 84 cost time: 0.8279125690460205
Epoch: 84, Steps: 3 | Train Loss: 0.139 Vali Loss: 0.749 Vali Acc: 0.825 Test Loss: 0.749 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824993).  Saving model ...
Epoch: 85 cost time: 0.6806223392486572
Epoch: 85, Steps: 3 | Train Loss: 0.139 Vali Loss: 0.749 Vali Acc: 0.825 Test Loss: 0.749 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 0.6091251373291016
Epoch: 86, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.749 Vali Acc: 0.825 Test Loss: 0.749 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 0.6530041694641113
Epoch: 87, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.750 Vali Acc: 0.825 Test Loss: 0.750 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 88 cost time: 0.7467765808105469
Epoch: 88, Steps: 3 | Train Loss: 0.128 Vali Loss: 0.752 Vali Acc: 0.825 Test Loss: 0.752 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 89 cost time: 0.6518852710723877
Epoch: 89, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.754 Vali Acc: 0.825 Test Loss: 0.754 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 90 cost time: 0.7107715606689453
Epoch: 90, Steps: 3 | Train Loss: 0.127 Vali Loss: 0.756 Vali Acc: 0.825 Test Loss: 0.756 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 91 cost time: 0.9190387725830078
Epoch: 91, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.755 Vali Acc: 0.825 Test Loss: 0.755 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 92 cost time: 0.8284385204315186
Epoch: 92, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.753 Vali Acc: 0.825 Test Loss: 0.753 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 93 cost time: 0.6979165077209473
Epoch: 93, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.750 Vali Acc: 0.825 Test Loss: 0.750 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 94 cost time: 1.0125741958618164
Epoch: 94, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.746 Vali Acc: 0.825 Test Loss: 0.746 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 95 cost time: 0.7267820835113525
Epoch: 95, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.745 Vali Acc: 0.825 Test Loss: 0.745 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 96 cost time: 0.7542328834533691
Epoch: 96, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.743 Vali Acc: 0.825 Test Loss: 0.743 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 97 cost time: 0.7597744464874268
Epoch: 97, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.741 Vali Acc: 0.825 Test Loss: 0.741 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 98 cost time: 0.9237022399902344
Epoch: 98, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.739 Vali Acc: 0.825 Test Loss: 0.739 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 99 cost time: 0.8243052959442139
Epoch: 99, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.735 Vali Acc: 0.825 Test Loss: 0.735 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 100 cost time: 0.599370002746582
Epoch: 100, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.734 Vali Acc: 0.825 Test Loss: 0.734 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm32_cs13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.825
model parameter : 14256
model size : 0.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm32_cs12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.8585329055786133
Epoch: 1, Steps: 3 | Train Loss: 1.542 Vali Loss: 1.550 Vali Acc: 0.150 Test Loss: 1.550 Test Acc: 0.150
Validation loss decreased (inf --> -0.149984).  Saving model ...
Epoch: 2 cost time: 0.5428900718688965
Epoch: 2, Steps: 3 | Train Loss: 1.521 Vali Loss: 1.542 Vali Acc: 0.150 Test Loss: 1.542 Test Acc: 0.150
Validation loss decreased (-0.149984 --> -0.149985).  Saving model ...
Epoch: 3 cost time: 0.5886664390563965
Epoch: 3, Steps: 3 | Train Loss: 1.480 Vali Loss: 1.536 Vali Acc: 0.150 Test Loss: 1.536 Test Acc: 0.150
Validation loss decreased (-0.149985 --> -0.149985).  Saving model ...
Epoch: 4 cost time: 0.5700821876525879
Epoch: 4, Steps: 3 | Train Loss: 1.481 Vali Loss: 1.527 Vali Acc: 0.175 Test Loss: 1.527 Test Acc: 0.175
Validation loss decreased (-0.149985 --> -0.174985).  Saving model ...
Epoch: 5 cost time: 0.6690106391906738
Epoch: 5, Steps: 3 | Train Loss: 1.461 Vali Loss: 1.517 Vali Acc: 0.175 Test Loss: 1.517 Test Acc: 0.175
Validation loss decreased (-0.174985 --> -0.174985).  Saving model ...
Epoch: 6 cost time: 0.6593465805053711
Epoch: 6, Steps: 3 | Train Loss: 1.447 Vali Loss: 1.505 Vali Acc: 0.200 Test Loss: 1.505 Test Acc: 0.200
Validation loss decreased (-0.174985 --> -0.199985).  Saving model ...
Epoch: 7 cost time: 0.6224765777587891
Epoch: 7, Steps: 3 | Train Loss: 1.418 Vali Loss: 1.493 Vali Acc: 0.225 Test Loss: 1.493 Test Acc: 0.225
Validation loss decreased (-0.199985 --> -0.224985).  Saving model ...
Epoch: 8 cost time: 0.7702076435089111
Epoch: 8, Steps: 3 | Train Loss: 1.397 Vali Loss: 1.479 Vali Acc: 0.275 Test Loss: 1.479 Test Acc: 0.275
Validation loss decreased (-0.224985 --> -0.274985).  Saving model ...
Epoch: 9 cost time: 0.6850302219390869
Epoch: 9, Steps: 3 | Train Loss: 1.361 Vali Loss: 1.465 Vali Acc: 0.325 Test Loss: 1.465 Test Acc: 0.325
Validation loss decreased (-0.274985 --> -0.324985).  Saving model ...
Epoch: 10 cost time: 0.6904399394989014
Epoch: 10, Steps: 3 | Train Loss: 1.308 Vali Loss: 1.451 Vali Acc: 0.350 Test Loss: 1.451 Test Acc: 0.350
Validation loss decreased (-0.324985 --> -0.349985).  Saving model ...
Epoch: 11 cost time: 0.7158236503601074
Epoch: 11, Steps: 3 | Train Loss: 1.307 Vali Loss: 1.436 Vali Acc: 0.375 Test Loss: 1.436 Test Acc: 0.375
Validation loss decreased (-0.349985 --> -0.374986).  Saving model ...
Epoch: 12 cost time: 0.6041648387908936
Epoch: 12, Steps: 3 | Train Loss: 1.271 Vali Loss: 1.421 Vali Acc: 0.375 Test Loss: 1.421 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 13 cost time: 0.7311344146728516
Epoch: 13, Steps: 3 | Train Loss: 1.249 Vali Loss: 1.407 Vali Acc: 0.375 Test Loss: 1.407 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 14 cost time: 0.7312273979187012
Epoch: 14, Steps: 3 | Train Loss: 1.189 Vali Loss: 1.393 Vali Acc: 0.400 Test Loss: 1.393 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399986).  Saving model ...
Epoch: 15 cost time: 0.6685056686401367
Epoch: 15, Steps: 3 | Train Loss: 1.140 Vali Loss: 1.378 Vali Acc: 0.400 Test Loss: 1.378 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399986).  Saving model ...
Epoch: 16 cost time: 0.7532918453216553
Epoch: 16, Steps: 3 | Train Loss: 1.129 Vali Loss: 1.363 Vali Acc: 0.400 Test Loss: 1.363 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399986).  Saving model ...
Epoch: 17 cost time: 0.8730158805847168
Epoch: 17, Steps: 3 | Train Loss: 1.134 Vali Loss: 1.349 Vali Acc: 0.400 Test Loss: 1.349 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399987).  Saving model ...
Epoch: 18 cost time: 0.6929335594177246
Epoch: 18, Steps: 3 | Train Loss: 1.061 Vali Loss: 1.335 Vali Acc: 0.400 Test Loss: 1.335 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 19 cost time: 0.6061270236968994
Epoch: 19, Steps: 3 | Train Loss: 1.043 Vali Loss: 1.321 Vali Acc: 0.425 Test Loss: 1.321 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424987).  Saving model ...
Epoch: 20 cost time: 0.5916767120361328
Epoch: 20, Steps: 3 | Train Loss: 1.001 Vali Loss: 1.307 Vali Acc: 0.500 Test Loss: 1.307 Test Acc: 0.500
Validation loss decreased (-0.424987 --> -0.499987).  Saving model ...
Epoch: 21 cost time: 0.721160888671875
Epoch: 21, Steps: 3 | Train Loss: 0.969 Vali Loss: 1.293 Vali Acc: 0.525 Test Loss: 1.293 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524987).  Saving model ...
Epoch: 22 cost time: 0.6577069759368896
Epoch: 22, Steps: 3 | Train Loss: 0.961 Vali Loss: 1.279 Vali Acc: 0.550 Test Loss: 1.279 Test Acc: 0.550
Validation loss decreased (-0.524987 --> -0.549987).  Saving model ...
Epoch: 23 cost time: 0.5889391899108887
Epoch: 23, Steps: 3 | Train Loss: 0.939 Vali Loss: 1.264 Vali Acc: 0.575 Test Loss: 1.264 Test Acc: 0.575
Validation loss decreased (-0.549987 --> -0.574987).  Saving model ...
Epoch: 24 cost time: 0.897758960723877
Epoch: 24, Steps: 3 | Train Loss: 0.916 Vali Loss: 1.251 Vali Acc: 0.575 Test Loss: 1.251 Test Acc: 0.575
Validation loss decreased (-0.574987 --> -0.574987).  Saving model ...
Epoch: 25 cost time: 0.6960732936859131
Epoch: 25, Steps: 3 | Train Loss: 0.891 Vali Loss: 1.238 Vali Acc: 0.600 Test Loss: 1.238 Test Acc: 0.600
Validation loss decreased (-0.574987 --> -0.599988).  Saving model ...
Epoch: 26 cost time: 0.6510999202728271
Epoch: 26, Steps: 3 | Train Loss: 0.872 Vali Loss: 1.224 Vali Acc: 0.600 Test Loss: 1.224 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 27 cost time: 0.5734021663665771
Epoch: 27, Steps: 3 | Train Loss: 0.830 Vali Loss: 1.211 Vali Acc: 0.625 Test Loss: 1.211 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624988).  Saving model ...
Epoch: 28 cost time: 0.5777406692504883
Epoch: 28, Steps: 3 | Train Loss: 0.782 Vali Loss: 1.197 Vali Acc: 0.625 Test Loss: 1.197 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 29 cost time: 0.9646317958831787
Epoch: 29, Steps: 3 | Train Loss: 0.758 Vali Loss: 1.183 Vali Acc: 0.650 Test Loss: 1.183 Test Acc: 0.650
Validation loss decreased (-0.624988 --> -0.649988).  Saving model ...
Epoch: 30 cost time: 0.7746810913085938
Epoch: 30, Steps: 3 | Train Loss: 0.744 Vali Loss: 1.170 Vali Acc: 0.650 Test Loss: 1.170 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649988).  Saving model ...
Epoch: 31 cost time: 0.6806559562683105
Epoch: 31, Steps: 3 | Train Loss: 0.697 Vali Loss: 1.156 Vali Acc: 0.700 Test Loss: 1.156 Test Acc: 0.700
Validation loss decreased (-0.649988 --> -0.699988).  Saving model ...
Epoch: 32 cost time: 0.9253101348876953
Epoch: 32, Steps: 3 | Train Loss: 0.675 Vali Loss: 1.141 Vali Acc: 0.700 Test Loss: 1.141 Test Acc: 0.700
Validation loss decreased (-0.699988 --> -0.699989).  Saving model ...
Epoch: 33 cost time: 0.6754982471466064
Epoch: 33, Steps: 3 | Train Loss: 0.671 Vali Loss: 1.129 Vali Acc: 0.650 Test Loss: 1.129 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5856473445892334
Epoch: 34, Steps: 3 | Train Loss: 0.657 Vali Loss: 1.118 Vali Acc: 0.650 Test Loss: 1.118 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.7047932147979736
Epoch: 35, Steps: 3 | Train Loss: 0.620 Vali Loss: 1.106 Vali Acc: 0.675 Test Loss: 1.106 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.6603660583496094
Epoch: 36, Steps: 3 | Train Loss: 0.605 Vali Loss: 1.095 Vali Acc: 0.675 Test Loss: 1.095 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.8180019855499268
Epoch: 37, Steps: 3 | Train Loss: 0.594 Vali Loss: 1.084 Vali Acc: 0.675 Test Loss: 1.084 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.8094916343688965
Epoch: 38, Steps: 3 | Train Loss: 0.592 Vali Loss: 1.072 Vali Acc: 0.675 Test Loss: 1.072 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.7058427333831787
Epoch: 39, Steps: 3 | Train Loss: 0.574 Vali Loss: 1.063 Vali Acc: 0.700 Test Loss: 1.063 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 40 cost time: 0.7690324783325195
Epoch: 40, Steps: 3 | Train Loss: 0.522 Vali Loss: 1.053 Vali Acc: 0.725 Test Loss: 1.053 Test Acc: 0.725
Validation loss decreased (-0.699989 --> -0.724989).  Saving model ...
Epoch: 41 cost time: 0.5608296394348145
Epoch: 41, Steps: 3 | Train Loss: 0.522 Vali Loss: 1.044 Vali Acc: 0.750 Test Loss: 1.044 Test Acc: 0.750
Validation loss decreased (-0.724989 --> -0.749990).  Saving model ...
Epoch: 42 cost time: 0.5053443908691406
Epoch: 42, Steps: 3 | Train Loss: 0.502 Vali Loss: 1.036 Vali Acc: 0.750 Test Loss: 1.036 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 43 cost time: 0.7919104099273682
Epoch: 43, Steps: 3 | Train Loss: 0.487 Vali Loss: 1.027 Vali Acc: 0.750 Test Loss: 1.027 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 44 cost time: 0.5261807441711426
Epoch: 44, Steps: 3 | Train Loss: 0.487 Vali Loss: 1.018 Vali Acc: 0.750 Test Loss: 1.018 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 45 cost time: 0.6633760929107666
Epoch: 45, Steps: 3 | Train Loss: 0.471 Vali Loss: 1.008 Vali Acc: 0.750 Test Loss: 1.008 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 46 cost time: 0.71225905418396
Epoch: 46, Steps: 3 | Train Loss: 0.475 Vali Loss: 0.998 Vali Acc: 0.775 Test Loss: 0.998 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774990).  Saving model ...
Epoch: 47 cost time: 0.5968017578125
Epoch: 47, Steps: 3 | Train Loss: 0.434 Vali Loss: 0.989 Vali Acc: 0.775 Test Loss: 0.989 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774990).  Saving model ...
Epoch: 48 cost time: 0.551612377166748
Epoch: 48, Steps: 3 | Train Loss: 0.421 Vali Loss: 0.980 Vali Acc: 0.750 Test Loss: 0.980 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.715191125869751
Epoch: 49, Steps: 3 | Train Loss: 0.393 Vali Loss: 0.973 Vali Acc: 0.725 Test Loss: 0.973 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.5580282211303711
Epoch: 50, Steps: 3 | Train Loss: 0.404 Vali Loss: 0.964 Vali Acc: 0.725 Test Loss: 0.964 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.5835134983062744
Epoch: 51, Steps: 3 | Train Loss: 0.403 Vali Loss: 0.955 Vali Acc: 0.750 Test Loss: 0.955 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.6212947368621826
Epoch: 52, Steps: 3 | Train Loss: 0.390 Vali Loss: 0.949 Vali Acc: 0.750 Test Loss: 0.949 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 0.5846278667449951
Epoch: 53, Steps: 3 | Train Loss: 0.375 Vali Loss: 0.943 Vali Acc: 0.750 Test Loss: 0.943 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 0.6306197643280029
Epoch: 54, Steps: 3 | Train Loss: 0.377 Vali Loss: 0.938 Vali Acc: 0.750 Test Loss: 0.938 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 0.6130223274230957
Epoch: 55, Steps: 3 | Train Loss: 0.335 Vali Loss: 0.933 Vali Acc: 0.750 Test Loss: 0.933 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 0.650742769241333
Epoch: 56, Steps: 3 | Train Loss: 0.347 Vali Loss: 0.929 Vali Acc: 0.750 Test Loss: 0.929 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 0.7639062404632568
Epoch: 57, Steps: 3 | Train Loss: 0.317 Vali Loss: 0.926 Vali Acc: 0.750 Test Loss: 0.926 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm32_cs12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.775
model parameter : 14678
model size : 0.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm32_cs10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.93831467628479
Epoch: 1, Steps: 3 | Train Loss: 1.430 Vali Loss: 1.439 Vali Acc: 0.300 Test Loss: 1.439 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.6202428340911865
Epoch: 2, Steps: 3 | Train Loss: 1.415 Vali Loss: 1.432 Vali Acc: 0.325 Test Loss: 1.432 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324986).  Saving model ...
Epoch: 3 cost time: 0.5671970844268799
Epoch: 3, Steps: 3 | Train Loss: 1.404 Vali Loss: 1.427 Vali Acc: 0.325 Test Loss: 1.427 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324986).  Saving model ...
Epoch: 4 cost time: 0.7353997230529785
Epoch: 4, Steps: 3 | Train Loss: 1.363 Vali Loss: 1.419 Vali Acc: 0.350 Test Loss: 1.419 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349986).  Saving model ...
Epoch: 5 cost time: 0.5790903568267822
Epoch: 5, Steps: 3 | Train Loss: 1.368 Vali Loss: 1.410 Vali Acc: 0.375 Test Loss: 1.410 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374986).  Saving model ...
Epoch: 6 cost time: 0.6725125312805176
Epoch: 6, Steps: 3 | Train Loss: 1.341 Vali Loss: 1.400 Vali Acc: 0.375 Test Loss: 1.400 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 7 cost time: 0.5350391864776611
Epoch: 7, Steps: 3 | Train Loss: 1.305 Vali Loss: 1.389 Vali Acc: 0.375 Test Loss: 1.389 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 8 cost time: 0.8307929039001465
Epoch: 8, Steps: 3 | Train Loss: 1.316 Vali Loss: 1.376 Vali Acc: 0.400 Test Loss: 1.376 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399986).  Saving model ...
Epoch: 9 cost time: 0.6657686233520508
Epoch: 9, Steps: 3 | Train Loss: 1.272 Vali Loss: 1.362 Vali Acc: 0.425 Test Loss: 1.362 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424986).  Saving model ...
Epoch: 10 cost time: 0.6485605239868164
Epoch: 10, Steps: 3 | Train Loss: 1.235 Vali Loss: 1.348 Vali Acc: 0.450 Test Loss: 1.348 Test Acc: 0.450
Validation loss decreased (-0.424986 --> -0.449987).  Saving model ...
Epoch: 11 cost time: 0.6355605125427246
Epoch: 11, Steps: 3 | Train Loss: 1.201 Vali Loss: 1.334 Vali Acc: 0.450 Test Loss: 1.334 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 12 cost time: 0.5781643390655518
Epoch: 12, Steps: 3 | Train Loss: 1.173 Vali Loss: 1.320 Vali Acc: 0.550 Test Loss: 1.320 Test Acc: 0.550
Validation loss decreased (-0.449987 --> -0.549987).  Saving model ...
Epoch: 13 cost time: 0.6045486927032471
Epoch: 13, Steps: 3 | Train Loss: 1.139 Vali Loss: 1.306 Vali Acc: 0.625 Test Loss: 1.306 Test Acc: 0.625
Validation loss decreased (-0.549987 --> -0.624987).  Saving model ...
Epoch: 14 cost time: 0.7262313365936279
Epoch: 14, Steps: 3 | Train Loss: 1.127 Vali Loss: 1.291 Vali Acc: 0.600 Test Loss: 1.291 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7904350757598877
Epoch: 15, Steps: 3 | Train Loss: 1.068 Vali Loss: 1.274 Vali Acc: 0.600 Test Loss: 1.274 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9101324081420898
Epoch: 16, Steps: 3 | Train Loss: 1.037 Vali Loss: 1.259 Vali Acc: 0.650 Test Loss: 1.259 Test Acc: 0.650
Validation loss decreased (-0.624987 --> -0.649987).  Saving model ...
Epoch: 17 cost time: 0.8861606121063232
Epoch: 17, Steps: 3 | Train Loss: 1.002 Vali Loss: 1.244 Vali Acc: 0.675 Test Loss: 1.244 Test Acc: 0.675
Validation loss decreased (-0.649987 --> -0.674988).  Saving model ...
Epoch: 18 cost time: 0.7728562355041504
Epoch: 18, Steps: 3 | Train Loss: 1.002 Vali Loss: 1.228 Vali Acc: 0.700 Test Loss: 1.228 Test Acc: 0.700
Validation loss decreased (-0.674988 --> -0.699988).  Saving model ...
Epoch: 19 cost time: 0.6048164367675781
Epoch: 19, Steps: 3 | Train Loss: 0.947 Vali Loss: 1.211 Vali Acc: 0.725 Test Loss: 1.211 Test Acc: 0.725
Validation loss decreased (-0.699988 --> -0.724988).  Saving model ...
Epoch: 20 cost time: 0.5728178024291992
Epoch: 20, Steps: 3 | Train Loss: 0.914 Vali Loss: 1.197 Vali Acc: 0.750 Test Loss: 1.197 Test Acc: 0.750
Validation loss decreased (-0.724988 --> -0.749988).  Saving model ...
Epoch: 21 cost time: 0.6373188495635986
Epoch: 21, Steps: 3 | Train Loss: 0.880 Vali Loss: 1.183 Vali Acc: 0.750 Test Loss: 1.183 Test Acc: 0.750
Validation loss decreased (-0.749988 --> -0.749988).  Saving model ...
Epoch: 22 cost time: 0.7383270263671875
Epoch: 22, Steps: 3 | Train Loss: 0.865 Vali Loss: 1.168 Vali Acc: 0.750 Test Loss: 1.168 Test Acc: 0.750
Validation loss decreased (-0.749988 --> -0.749988).  Saving model ...
Epoch: 23 cost time: 0.4731266498565674
Epoch: 23, Steps: 3 | Train Loss: 0.845 Vali Loss: 1.155 Vali Acc: 0.750 Test Loss: 1.155 Test Acc: 0.750
Validation loss decreased (-0.749988 --> -0.749988).  Saving model ...
Epoch: 24 cost time: 0.5746233463287354
Epoch: 24, Steps: 3 | Train Loss: 0.817 Vali Loss: 1.141 Vali Acc: 0.750 Test Loss: 1.141 Test Acc: 0.750
Validation loss decreased (-0.749988 --> -0.749989).  Saving model ...
Epoch: 25 cost time: 0.6121904850006104
Epoch: 25, Steps: 3 | Train Loss: 0.781 Vali Loss: 1.127 Vali Acc: 0.750 Test Loss: 1.127 Test Acc: 0.750
Validation loss decreased (-0.749989 --> -0.749989).  Saving model ...
Epoch: 26 cost time: 0.6287822723388672
Epoch: 26, Steps: 3 | Train Loss: 0.756 Vali Loss: 1.114 Vali Acc: 0.750 Test Loss: 1.114 Test Acc: 0.750
Validation loss decreased (-0.749989 --> -0.749989).  Saving model ...
Epoch: 27 cost time: 0.5529971122741699
Epoch: 27, Steps: 3 | Train Loss: 0.702 Vali Loss: 1.101 Vali Acc: 0.750 Test Loss: 1.101 Test Acc: 0.750
Validation loss decreased (-0.749989 --> -0.749989).  Saving model ...
Epoch: 28 cost time: 0.5460906028747559
Epoch: 28, Steps: 3 | Train Loss: 0.677 Vali Loss: 1.087 Vali Acc: 0.725 Test Loss: 1.087 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6875476837158203
Epoch: 29, Steps: 3 | Train Loss: 0.691 Vali Loss: 1.071 Vali Acc: 0.725 Test Loss: 1.071 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.625962495803833
Epoch: 30, Steps: 3 | Train Loss: 0.630 Vali Loss: 1.059 Vali Acc: 0.725 Test Loss: 1.059 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.5620946884155273
Epoch: 31, Steps: 3 | Train Loss: 0.694 Vali Loss: 1.045 Vali Acc: 0.725 Test Loss: 1.045 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.6506156921386719
Epoch: 32, Steps: 3 | Train Loss: 0.635 Vali Loss: 1.031 Vali Acc: 0.725 Test Loss: 1.031 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.5360548496246338
Epoch: 33, Steps: 3 | Train Loss: 0.584 Vali Loss: 1.019 Vali Acc: 0.725 Test Loss: 1.019 Test Acc: 0.725
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.5263338088989258
Epoch: 34, Steps: 3 | Train Loss: 0.597 Vali Loss: 1.008 Vali Acc: 0.725 Test Loss: 1.008 Test Acc: 0.725
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.7277190685272217
Epoch: 35, Steps: 3 | Train Loss: 0.572 Vali Loss: 0.997 Vali Acc: 0.725 Test Loss: 0.997 Test Acc: 0.725
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.6180894374847412
Epoch: 36, Steps: 3 | Train Loss: 0.526 Vali Loss: 0.987 Vali Acc: 0.700 Test Loss: 0.987 Test Acc: 0.700
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.5419042110443115
Epoch: 37, Steps: 3 | Train Loss: 0.541 Vali Loss: 0.975 Vali Acc: 0.700 Test Loss: 0.975 Test Acc: 0.700
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm32_cs10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.75
model parameter : 13888
model size : 0.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm32_cs9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5623793601989746
Epoch: 1, Steps: 3 | Train Loss: 1.368 Vali Loss: 1.538 Vali Acc: 0.325 Test Loss: 1.538 Test Acc: 0.325
Validation loss decreased (inf --> -0.324985).  Saving model ...
Epoch: 2 cost time: 0.7198517322540283
Epoch: 2, Steps: 3 | Train Loss: 1.346 Vali Loss: 1.529 Vali Acc: 0.325 Test Loss: 1.529 Test Acc: 0.325
Validation loss decreased (-0.324985 --> -0.324985).  Saving model ...
Epoch: 3 cost time: 0.5554301738739014
Epoch: 3, Steps: 3 | Train Loss: 1.319 Vali Loss: 1.521 Vali Acc: 0.325 Test Loss: 1.521 Test Acc: 0.325
Validation loss decreased (-0.324985 --> -0.324985).  Saving model ...
Epoch: 4 cost time: 0.582667350769043
Epoch: 4, Steps: 3 | Train Loss: 1.279 Vali Loss: 1.512 Vali Acc: 0.325 Test Loss: 1.512 Test Acc: 0.325
Validation loss decreased (-0.324985 --> -0.324985).  Saving model ...
Epoch: 5 cost time: 0.6482651233673096
Epoch: 5, Steps: 3 | Train Loss: 1.300 Vali Loss: 1.501 Vali Acc: 0.325 Test Loss: 1.501 Test Acc: 0.325
Validation loss decreased (-0.324985 --> -0.324985).  Saving model ...
Epoch: 6 cost time: 0.7144274711608887
Epoch: 6, Steps: 3 | Train Loss: 1.306 Vali Loss: 1.488 Vali Acc: 0.375 Test Loss: 1.488 Test Acc: 0.375
Validation loss decreased (-0.324985 --> -0.374985).  Saving model ...
Epoch: 7 cost time: 0.5711815357208252
Epoch: 7, Steps: 3 | Train Loss: 1.298 Vali Loss: 1.474 Vali Acc: 0.375 Test Loss: 1.474 Test Acc: 0.375
Validation loss decreased (-0.374985 --> -0.374985).  Saving model ...
Epoch: 8 cost time: 0.8686885833740234
Epoch: 8, Steps: 3 | Train Loss: 1.241 Vali Loss: 1.459 Vali Acc: 0.400 Test Loss: 1.459 Test Acc: 0.400
Validation loss decreased (-0.374985 --> -0.399985).  Saving model ...
Epoch: 9 cost time: 0.7253773212432861
Epoch: 9, Steps: 3 | Train Loss: 1.214 Vali Loss: 1.444 Vali Acc: 0.400 Test Loss: 1.444 Test Acc: 0.400
Validation loss decreased (-0.399985 --> -0.399986).  Saving model ...
Epoch: 10 cost time: 0.8969907760620117
Epoch: 10, Steps: 3 | Train Loss: 1.186 Vali Loss: 1.428 Vali Acc: 0.375 Test Loss: 1.428 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7628512382507324
Epoch: 11, Steps: 3 | Train Loss: 1.169 Vali Loss: 1.412 Vali Acc: 0.350 Test Loss: 1.412 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9368658065795898
Epoch: 12, Steps: 3 | Train Loss: 1.120 Vali Loss: 1.396 Vali Acc: 0.350 Test Loss: 1.396 Test Acc: 0.350
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.767425537109375
Epoch: 13, Steps: 3 | Train Loss: 1.098 Vali Loss: 1.381 Vali Acc: 0.350 Test Loss: 1.381 Test Acc: 0.350
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.830925464630127
Epoch: 14, Steps: 3 | Train Loss: 1.093 Vali Loss: 1.365 Vali Acc: 0.375 Test Loss: 1.365 Test Acc: 0.375
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.590817928314209
Epoch: 15, Steps: 3 | Train Loss: 1.033 Vali Loss: 1.349 Vali Acc: 0.375 Test Loss: 1.349 Test Acc: 0.375
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.6248846054077148
Epoch: 16, Steps: 3 | Train Loss: 1.001 Vali Loss: 1.333 Vali Acc: 0.350 Test Loss: 1.333 Test Acc: 0.350
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.6431889533996582
Epoch: 17, Steps: 3 | Train Loss: 0.959 Vali Loss: 1.318 Vali Acc: 0.350 Test Loss: 1.318 Test Acc: 0.350
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.5838494300842285
Epoch: 18, Steps: 3 | Train Loss: 0.995 Vali Loss: 1.302 Vali Acc: 0.350 Test Loss: 1.302 Test Acc: 0.350
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.6404855251312256
Epoch: 19, Steps: 3 | Train Loss: 0.956 Vali Loss: 1.287 Vali Acc: 0.425 Test Loss: 1.287 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424987).  Saving model ...
Epoch: 20 cost time: 0.7335894107818604
Epoch: 20, Steps: 3 | Train Loss: 0.890 Vali Loss: 1.272 Vali Acc: 0.475 Test Loss: 1.272 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474987).  Saving model ...
Epoch: 21 cost time: 0.679250955581665
Epoch: 21, Steps: 3 | Train Loss: 0.895 Vali Loss: 1.257 Vali Acc: 0.550 Test Loss: 1.257 Test Acc: 0.550
Validation loss decreased (-0.474987 --> -0.549987).  Saving model ...
Epoch: 22 cost time: 0.8765246868133545
Epoch: 22, Steps: 3 | Train Loss: 0.850 Vali Loss: 1.243 Vali Acc: 0.575 Test Loss: 1.243 Test Acc: 0.575
Validation loss decreased (-0.549987 --> -0.574988).  Saving model ...
Epoch: 23 cost time: 0.7132177352905273
Epoch: 23, Steps: 3 | Train Loss: 0.826 Vali Loss: 1.228 Vali Acc: 0.625 Test Loss: 1.228 Test Acc: 0.625
Validation loss decreased (-0.574988 --> -0.624988).  Saving model ...
Epoch: 24 cost time: 0.8632826805114746
Epoch: 24, Steps: 3 | Train Loss: 0.789 Vali Loss: 1.213 Vali Acc: 0.625 Test Loss: 1.213 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 25 cost time: 0.727691650390625
Epoch: 25, Steps: 3 | Train Loss: 0.789 Vali Loss: 1.197 Vali Acc: 0.625 Test Loss: 1.197 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 26 cost time: 0.6532471179962158
Epoch: 26, Steps: 3 | Train Loss: 0.774 Vali Loss: 1.181 Vali Acc: 0.625 Test Loss: 1.181 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 27 cost time: 0.6242375373840332
Epoch: 27, Steps: 3 | Train Loss: 0.736 Vali Loss: 1.162 Vali Acc: 0.625 Test Loss: 1.162 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 28 cost time: 0.7568693161010742
Epoch: 28, Steps: 3 | Train Loss: 0.698 Vali Loss: 1.145 Vali Acc: 0.625 Test Loss: 1.145 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624989).  Saving model ...
Epoch: 29 cost time: 0.8272013664245605
Epoch: 29, Steps: 3 | Train Loss: 0.676 Vali Loss: 1.127 Vali Acc: 0.650 Test Loss: 1.127 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 30 cost time: 0.6304619312286377
Epoch: 30, Steps: 3 | Train Loss: 0.630 Vali Loss: 1.110 Vali Acc: 0.650 Test Loss: 1.110 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 31 cost time: 0.8947298526763916
Epoch: 31, Steps: 3 | Train Loss: 0.606 Vali Loss: 1.096 Vali Acc: 0.650 Test Loss: 1.096 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 32 cost time: 0.7879900932312012
Epoch: 32, Steps: 3 | Train Loss: 0.611 Vali Loss: 1.081 Vali Acc: 0.675 Test Loss: 1.081 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674989).  Saving model ...
Epoch: 33 cost time: 0.8624427318572998
Epoch: 33, Steps: 3 | Train Loss: 0.588 Vali Loss: 1.067 Vali Acc: 0.675 Test Loss: 1.067 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 34 cost time: 1.0129969120025635
Epoch: 34, Steps: 3 | Train Loss: 0.550 Vali Loss: 1.052 Vali Acc: 0.675 Test Loss: 1.052 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 35 cost time: 0.6637413501739502
Epoch: 35, Steps: 3 | Train Loss: 0.543 Vali Loss: 1.038 Vali Acc: 0.700 Test Loss: 1.038 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699990).  Saving model ...
Epoch: 36 cost time: 0.5574862957000732
Epoch: 36, Steps: 3 | Train Loss: 0.542 Vali Loss: 1.024 Vali Acc: 0.675 Test Loss: 1.024 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7285606861114502
Epoch: 37, Steps: 3 | Train Loss: 0.510 Vali Loss: 1.012 Vali Acc: 0.675 Test Loss: 1.012 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.6821539402008057
Epoch: 38, Steps: 3 | Train Loss: 0.473 Vali Loss: 1.001 Vali Acc: 0.700 Test Loss: 1.001 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 39 cost time: 0.5626347064971924
Epoch: 39, Steps: 3 | Train Loss: 0.478 Vali Loss: 0.990 Vali Acc: 0.700 Test Loss: 0.990 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 40 cost time: 0.6639738082885742
Epoch: 40, Steps: 3 | Train Loss: 0.473 Vali Loss: 0.980 Vali Acc: 0.700 Test Loss: 0.980 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 41 cost time: 0.672374963760376
Epoch: 41, Steps: 3 | Train Loss: 0.452 Vali Loss: 0.970 Vali Acc: 0.700 Test Loss: 0.970 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 42 cost time: 0.8331489562988281
Epoch: 42, Steps: 3 | Train Loss: 0.461 Vali Loss: 0.962 Vali Acc: 0.700 Test Loss: 0.962 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 43 cost time: 0.8205902576446533
Epoch: 43, Steps: 3 | Train Loss: 0.440 Vali Loss: 0.954 Vali Acc: 0.700 Test Loss: 0.954 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 44 cost time: 0.8443601131439209
Epoch: 44, Steps: 3 | Train Loss: 0.430 Vali Loss: 0.947 Vali Acc: 0.700 Test Loss: 0.947 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699991).  Saving model ...
Epoch: 45 cost time: 1.0533201694488525
Epoch: 45, Steps: 3 | Train Loss: 0.407 Vali Loss: 0.940 Vali Acc: 0.725 Test Loss: 0.940 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724991).  Saving model ...
Epoch: 46 cost time: 0.7730469703674316
Epoch: 46, Steps: 3 | Train Loss: 0.394 Vali Loss: 0.934 Vali Acc: 0.750 Test Loss: 0.934 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749991).  Saving model ...
Epoch: 47 cost time: 0.6585886478424072
Epoch: 47, Steps: 3 | Train Loss: 0.392 Vali Loss: 0.926 Vali Acc: 0.750 Test Loss: 0.926 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 48 cost time: 0.7616269588470459
Epoch: 48, Steps: 3 | Train Loss: 0.352 Vali Loss: 0.919 Vali Acc: 0.775 Test Loss: 0.919 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774991).  Saving model ...
Epoch: 49 cost time: 0.6468029022216797
Epoch: 49, Steps: 3 | Train Loss: 0.354 Vali Loss: 0.912 Vali Acc: 0.775 Test Loss: 0.912 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 50 cost time: 0.6511321067810059
Epoch: 50, Steps: 3 | Train Loss: 0.337 Vali Loss: 0.904 Vali Acc: 0.775 Test Loss: 0.904 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 51 cost time: 0.7169132232666016
Epoch: 51, Steps: 3 | Train Loss: 0.317 Vali Loss: 0.897 Vali Acc: 0.750 Test Loss: 0.897 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.8212616443634033
Epoch: 52, Steps: 3 | Train Loss: 0.337 Vali Loss: 0.889 Vali Acc: 0.750 Test Loss: 0.889 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.7607264518737793
Epoch: 53, Steps: 3 | Train Loss: 0.308 Vali Loss: 0.882 Vali Acc: 0.775 Test Loss: 0.882 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 54 cost time: 0.742903470993042
Epoch: 54, Steps: 3 | Train Loss: 0.318 Vali Loss: 0.876 Vali Acc: 0.775 Test Loss: 0.876 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 55 cost time: 0.7953248023986816
Epoch: 55, Steps: 3 | Train Loss: 0.280 Vali Loss: 0.870 Vali Acc: 0.775 Test Loss: 0.870 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 56 cost time: 0.8669815063476562
Epoch: 56, Steps: 3 | Train Loss: 0.314 Vali Loss: 0.865 Vali Acc: 0.775 Test Loss: 0.865 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 57 cost time: 0.7006950378417969
Epoch: 57, Steps: 3 | Train Loss: 0.279 Vali Loss: 0.860 Vali Acc: 0.775 Test Loss: 0.860 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 58 cost time: 0.6122870445251465
Epoch: 58, Steps: 3 | Train Loss: 0.278 Vali Loss: 0.856 Vali Acc: 0.775 Test Loss: 0.856 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 59 cost time: 0.6824228763580322
Epoch: 59, Steps: 3 | Train Loss: 0.264 Vali Loss: 0.851 Vali Acc: 0.775 Test Loss: 0.851 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 60 cost time: 0.7356357574462891
Epoch: 60, Steps: 3 | Train Loss: 0.238 Vali Loss: 0.848 Vali Acc: 0.775 Test Loss: 0.848 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774992).  Saving model ...
Epoch: 61 cost time: 0.6321938037872314
Epoch: 61, Steps: 3 | Train Loss: 0.250 Vali Loss: 0.844 Vali Acc: 0.800 Test Loss: 0.844 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799992).  Saving model ...
Epoch: 62 cost time: 0.7523763179779053
Epoch: 62, Steps: 3 | Train Loss: 0.228 Vali Loss: 0.840 Vali Acc: 0.775 Test Loss: 0.840 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.8473944664001465
Epoch: 63, Steps: 3 | Train Loss: 0.237 Vali Loss: 0.834 Vali Acc: 0.775 Test Loss: 0.834 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 0.6975164413452148
Epoch: 64, Steps: 3 | Train Loss: 0.236 Vali Loss: 0.830 Vali Acc: 0.775 Test Loss: 0.830 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 0.7589592933654785
Epoch: 65, Steps: 3 | Train Loss: 0.230 Vali Loss: 0.826 Vali Acc: 0.775 Test Loss: 0.826 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 0.7968618869781494
Epoch: 66, Steps: 3 | Train Loss: 0.224 Vali Loss: 0.821 Vali Acc: 0.775 Test Loss: 0.821 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 0.8846995830535889
Epoch: 67, Steps: 3 | Train Loss: 0.202 Vali Loss: 0.817 Vali Acc: 0.775 Test Loss: 0.817 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 0.664268970489502
Epoch: 68, Steps: 3 | Train Loss: 0.220 Vali Loss: 0.813 Vali Acc: 0.775 Test Loss: 0.813 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 69 cost time: 0.6338376998901367
Epoch: 69, Steps: 3 | Train Loss: 0.213 Vali Loss: 0.808 Vali Acc: 0.775 Test Loss: 0.808 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 70 cost time: 0.6513524055480957
Epoch: 70, Steps: 3 | Train Loss: 0.209 Vali Loss: 0.805 Vali Acc: 0.800 Test Loss: 0.805 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 71 cost time: 0.7533531188964844
Epoch: 71, Steps: 3 | Train Loss: 0.197 Vali Loss: 0.802 Vali Acc: 0.800 Test Loss: 0.802 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 72 cost time: 0.6664431095123291
Epoch: 72, Steps: 3 | Train Loss: 0.217 Vali Loss: 0.799 Vali Acc: 0.800 Test Loss: 0.799 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 73 cost time: 0.6172609329223633
Epoch: 73, Steps: 3 | Train Loss: 0.208 Vali Loss: 0.796 Vali Acc: 0.800 Test Loss: 0.796 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 74 cost time: 0.7664787769317627
Epoch: 74, Steps: 3 | Train Loss: 0.181 Vali Loss: 0.793 Vali Acc: 0.800 Test Loss: 0.793 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 75 cost time: 0.9099240303039551
Epoch: 75, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.790 Vali Acc: 0.800 Test Loss: 0.790 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 76 cost time: 0.7035748958587646
Epoch: 76, Steps: 3 | Train Loss: 0.183 Vali Loss: 0.787 Vali Acc: 0.800 Test Loss: 0.787 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 77 cost time: 0.7550981044769287
Epoch: 77, Steps: 3 | Train Loss: 0.181 Vali Loss: 0.784 Vali Acc: 0.800 Test Loss: 0.784 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 78 cost time: 0.7123963832855225
Epoch: 78, Steps: 3 | Train Loss: 0.166 Vali Loss: 0.781 Vali Acc: 0.800 Test Loss: 0.781 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 79 cost time: 0.6131839752197266
Epoch: 79, Steps: 3 | Train Loss: 0.145 Vali Loss: 0.779 Vali Acc: 0.800 Test Loss: 0.779 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 80 cost time: 0.6002497673034668
Epoch: 80, Steps: 3 | Train Loss: 0.181 Vali Loss: 0.777 Vali Acc: 0.800 Test Loss: 0.777 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 81 cost time: 0.682215690612793
Epoch: 81, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.776 Vali Acc: 0.800 Test Loss: 0.776 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 82 cost time: 0.6056067943572998
Epoch: 82, Steps: 3 | Train Loss: 0.154 Vali Loss: 0.774 Vali Acc: 0.800 Test Loss: 0.774 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 83 cost time: 0.5913856029510498
Epoch: 83, Steps: 3 | Train Loss: 0.156 Vali Loss: 0.773 Vali Acc: 0.800 Test Loss: 0.773 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 84 cost time: 0.988924503326416
Epoch: 84, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.771 Vali Acc: 0.800 Test Loss: 0.771 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 85 cost time: 0.6391909122467041
Epoch: 85, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.769 Vali Acc: 0.800 Test Loss: 0.769 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 86 cost time: 0.6888315677642822
Epoch: 86, Steps: 3 | Train Loss: 0.133 Vali Loss: 0.766 Vali Acc: 0.800 Test Loss: 0.766 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 87 cost time: 0.7433269023895264
Epoch: 87, Steps: 3 | Train Loss: 0.130 Vali Loss: 0.762 Vali Acc: 0.800 Test Loss: 0.762 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 88 cost time: 0.6495761871337891
Epoch: 88, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.760 Vali Acc: 0.800 Test Loss: 0.760 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 89 cost time: 0.7308602333068848
Epoch: 89, Steps: 3 | Train Loss: 0.132 Vali Loss: 0.757 Vali Acc: 0.800 Test Loss: 0.757 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 90 cost time: 0.6476125717163086
Epoch: 90, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.755 Vali Acc: 0.800 Test Loss: 0.755 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 91 cost time: 0.8747761249542236
Epoch: 91, Steps: 3 | Train Loss: 0.124 Vali Loss: 0.751 Vali Acc: 0.800 Test Loss: 0.751 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 92 cost time: 0.6709866523742676
Epoch: 92, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.749 Vali Acc: 0.800 Test Loss: 0.749 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799993).  Saving model ...
Epoch: 93 cost time: 0.8557806015014648
Epoch: 93, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.747 Vali Acc: 0.800 Test Loss: 0.747 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 94 cost time: 0.6044924259185791
Epoch: 94, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.744 Vali Acc: 0.800 Test Loss: 0.744 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 95 cost time: 0.8910918235778809
Epoch: 95, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.741 Vali Acc: 0.800 Test Loss: 0.741 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 96 cost time: 0.7316451072692871
Epoch: 96, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.738 Vali Acc: 0.800 Test Loss: 0.738 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 97 cost time: 0.6910245418548584
Epoch: 97, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.735 Vali Acc: 0.800 Test Loss: 0.735 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 98 cost time: 0.7003638744354248
Epoch: 98, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.731 Vali Acc: 0.800 Test Loss: 0.731 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 99 cost time: 0.7566771507263184
Epoch: 99, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.727 Vali Acc: 0.800 Test Loss: 0.727 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 100 cost time: 0.5760800838470459
Epoch: 100, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.723 Vali Acc: 0.800 Test Loss: 0.723 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm32_cs9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.8
model parameter : 14768
model size : 0.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm32_cs8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.1510281562805176
Epoch: 1, Steps: 3 | Train Loss: 1.430 Vali Loss: 1.444 Vali Acc: 0.350 Test Loss: 1.444 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 0.6121621131896973
Epoch: 2, Steps: 3 | Train Loss: 1.421 Vali Loss: 1.436 Vali Acc: 0.350 Test Loss: 1.436 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 3 cost time: 0.7702145576477051
Epoch: 3, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.429 Vali Acc: 0.350 Test Loss: 1.429 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 4 cost time: 0.5386960506439209
Epoch: 4, Steps: 3 | Train Loss: 1.339 Vali Loss: 1.421 Vali Acc: 0.350 Test Loss: 1.421 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 5 cost time: 0.5835871696472168
Epoch: 5, Steps: 3 | Train Loss: 1.368 Vali Loss: 1.411 Vali Acc: 0.375 Test Loss: 1.411 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374986).  Saving model ...
Epoch: 6 cost time: 0.7283210754394531
Epoch: 6, Steps: 3 | Train Loss: 1.337 Vali Loss: 1.401 Vali Acc: 0.375 Test Loss: 1.401 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 7 cost time: 0.7456982135772705
Epoch: 7, Steps: 3 | Train Loss: 1.306 Vali Loss: 1.389 Vali Acc: 0.375 Test Loss: 1.389 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 8 cost time: 0.6891026496887207
Epoch: 8, Steps: 3 | Train Loss: 1.258 Vali Loss: 1.377 Vali Acc: 0.375 Test Loss: 1.377 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 9 cost time: 0.6972372531890869
Epoch: 9, Steps: 3 | Train Loss: 1.235 Vali Loss: 1.364 Vali Acc: 0.375 Test Loss: 1.364 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 10 cost time: 0.616502046585083
Epoch: 10, Steps: 3 | Train Loss: 1.192 Vali Loss: 1.351 Vali Acc: 0.400 Test Loss: 1.351 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399986).  Saving model ...
Epoch: 11 cost time: 0.7578639984130859
Epoch: 11, Steps: 3 | Train Loss: 1.198 Vali Loss: 1.338 Vali Acc: 0.450 Test Loss: 1.338 Test Acc: 0.450
Validation loss decreased (-0.399986 --> -0.449987).  Saving model ...
Epoch: 12 cost time: 0.6229658126831055
Epoch: 12, Steps: 3 | Train Loss: 1.142 Vali Loss: 1.324 Vali Acc: 0.450 Test Loss: 1.324 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 13 cost time: 0.8679826259613037
Epoch: 13, Steps: 3 | Train Loss: 1.091 Vali Loss: 1.310 Vali Acc: 0.425 Test Loss: 1.310 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6194007396697998
Epoch: 14, Steps: 3 | Train Loss: 1.108 Vali Loss: 1.298 Vali Acc: 0.425 Test Loss: 1.298 Test Acc: 0.425
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7905404567718506
Epoch: 15, Steps: 3 | Train Loss: 1.034 Vali Loss: 1.285 Vali Acc: 0.475 Test Loss: 1.285 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474987).  Saving model ...
Epoch: 16 cost time: 0.7054743766784668
Epoch: 16, Steps: 3 | Train Loss: 1.033 Vali Loss: 1.270 Vali Acc: 0.475 Test Loss: 1.270 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 17 cost time: 0.7905607223510742
Epoch: 17, Steps: 3 | Train Loss: 0.971 Vali Loss: 1.257 Vali Acc: 0.500 Test Loss: 1.257 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499987).  Saving model ...
Epoch: 18 cost time: 0.9081668853759766
Epoch: 18, Steps: 3 | Train Loss: 0.953 Vali Loss: 1.242 Vali Acc: 0.500 Test Loss: 1.242 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499988).  Saving model ...
Epoch: 19 cost time: 0.6040349006652832
Epoch: 19, Steps: 3 | Train Loss: 0.914 Vali Loss: 1.227 Vali Acc: 0.550 Test Loss: 1.227 Test Acc: 0.550
Validation loss decreased (-0.499988 --> -0.549988).  Saving model ...
Epoch: 20 cost time: 0.6259496212005615
Epoch: 20, Steps: 3 | Train Loss: 0.857 Vali Loss: 1.211 Vali Acc: 0.600 Test Loss: 1.211 Test Acc: 0.600
Validation loss decreased (-0.549988 --> -0.599988).  Saving model ...
Epoch: 21 cost time: 0.860971212387085
Epoch: 21, Steps: 3 | Train Loss: 0.887 Vali Loss: 1.196 Vali Acc: 0.600 Test Loss: 1.196 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 22 cost time: 0.6892244815826416
Epoch: 22, Steps: 3 | Train Loss: 0.836 Vali Loss: 1.181 Vali Acc: 0.625 Test Loss: 1.181 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624988).  Saving model ...
Epoch: 23 cost time: 0.8127284049987793
Epoch: 23, Steps: 3 | Train Loss: 0.804 Vali Loss: 1.165 Vali Acc: 0.625 Test Loss: 1.165 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 24 cost time: 0.8068110942840576
Epoch: 24, Steps: 3 | Train Loss: 0.795 Vali Loss: 1.151 Vali Acc: 0.600 Test Loss: 1.151 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8572041988372803
Epoch: 25, Steps: 3 | Train Loss: 0.770 Vali Loss: 1.136 Vali Acc: 0.600 Test Loss: 1.136 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6055214405059814
Epoch: 26, Steps: 3 | Train Loss: 0.769 Vali Loss: 1.122 Vali Acc: 0.600 Test Loss: 1.122 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8850545883178711
Epoch: 27, Steps: 3 | Train Loss: 0.668 Vali Loss: 1.109 Vali Acc: 0.625 Test Loss: 1.109 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624989).  Saving model ...
Epoch: 28 cost time: 0.9317173957824707
Epoch: 28, Steps: 3 | Train Loss: 0.678 Vali Loss: 1.096 Vali Acc: 0.650 Test Loss: 1.096 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 29 cost time: 0.6576781272888184
Epoch: 29, Steps: 3 | Train Loss: 0.689 Vali Loss: 1.086 Vali Acc: 0.675 Test Loss: 1.086 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674989).  Saving model ...
Epoch: 30 cost time: 0.6282131671905518
Epoch: 30, Steps: 3 | Train Loss: 0.660 Vali Loss: 1.076 Vali Acc: 0.675 Test Loss: 1.076 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 31 cost time: 0.6761369705200195
Epoch: 31, Steps: 3 | Train Loss: 0.641 Vali Loss: 1.067 Vali Acc: 0.675 Test Loss: 1.067 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 32 cost time: 0.7673070430755615
Epoch: 32, Steps: 3 | Train Loss: 0.626 Vali Loss: 1.056 Vali Acc: 0.675 Test Loss: 1.056 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 33 cost time: 0.8222177028656006
Epoch: 33, Steps: 3 | Train Loss: 0.579 Vali Loss: 1.044 Vali Acc: 0.700 Test Loss: 1.044 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699990).  Saving model ...
Epoch: 34 cost time: 0.7409050464630127
Epoch: 34, Steps: 3 | Train Loss: 0.580 Vali Loss: 1.032 Vali Acc: 0.725 Test Loss: 1.032 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724990).  Saving model ...
Epoch: 35 cost time: 0.825096607208252
Epoch: 35, Steps: 3 | Train Loss: 0.544 Vali Loss: 1.020 Vali Acc: 0.725 Test Loss: 1.020 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 36 cost time: 0.7379605770111084
Epoch: 36, Steps: 3 | Train Loss: 0.541 Vali Loss: 1.009 Vali Acc: 0.725 Test Loss: 1.009 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 37 cost time: 0.9645099639892578
Epoch: 37, Steps: 3 | Train Loss: 0.526 Vali Loss: 0.998 Vali Acc: 0.725 Test Loss: 0.998 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 38 cost time: 0.8340630531311035
Epoch: 38, Steps: 3 | Train Loss: 0.509 Vali Loss: 0.988 Vali Acc: 0.725 Test Loss: 0.988 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 39 cost time: 0.6357831954956055
Epoch: 39, Steps: 3 | Train Loss: 0.512 Vali Loss: 0.979 Vali Acc: 0.725 Test Loss: 0.979 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 40 cost time: 0.6107082366943359
Epoch: 40, Steps: 3 | Train Loss: 0.476 Vali Loss: 0.970 Vali Acc: 0.725 Test Loss: 0.970 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 41 cost time: 0.744232177734375
Epoch: 41, Steps: 3 | Train Loss: 0.443 Vali Loss: 0.963 Vali Acc: 0.775 Test Loss: 0.963 Test Acc: 0.775
Validation loss decreased (-0.724990 --> -0.774990).  Saving model ...
Epoch: 42 cost time: 0.7149255275726318
Epoch: 42, Steps: 3 | Train Loss: 0.436 Vali Loss: 0.956 Vali Acc: 0.775 Test Loss: 0.956 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774990).  Saving model ...
Epoch: 43 cost time: 0.6764180660247803
Epoch: 43, Steps: 3 | Train Loss: 0.439 Vali Loss: 0.949 Vali Acc: 0.775 Test Loss: 0.949 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774991).  Saving model ...
Epoch: 44 cost time: 0.6517491340637207
Epoch: 44, Steps: 3 | Train Loss: 0.408 Vali Loss: 0.943 Vali Acc: 0.775 Test Loss: 0.943 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 45 cost time: 0.7941787242889404
Epoch: 45, Steps: 3 | Train Loss: 0.405 Vali Loss: 0.936 Vali Acc: 0.775 Test Loss: 0.936 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 46 cost time: 0.8310761451721191
Epoch: 46, Steps: 3 | Train Loss: 0.387 Vali Loss: 0.930 Vali Acc: 0.775 Test Loss: 0.930 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 47 cost time: 0.6674289703369141
Epoch: 47, Steps: 3 | Train Loss: 0.390 Vali Loss: 0.925 Vali Acc: 0.775 Test Loss: 0.925 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 48 cost time: 0.7621815204620361
Epoch: 48, Steps: 3 | Train Loss: 0.365 Vali Loss: 0.919 Vali Acc: 0.775 Test Loss: 0.919 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 49 cost time: 0.8117077350616455
Epoch: 49, Steps: 3 | Train Loss: 0.360 Vali Loss: 0.913 Vali Acc: 0.775 Test Loss: 0.913 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 50 cost time: 0.7369813919067383
Epoch: 50, Steps: 3 | Train Loss: 0.351 Vali Loss: 0.908 Vali Acc: 0.775 Test Loss: 0.908 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 51 cost time: 0.5074646472930908
Epoch: 51, Steps: 3 | Train Loss: 0.378 Vali Loss: 0.904 Vali Acc: 0.775 Test Loss: 0.904 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 52 cost time: 0.7090084552764893
Epoch: 52, Steps: 3 | Train Loss: 0.327 Vali Loss: 0.901 Vali Acc: 0.775 Test Loss: 0.901 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 53 cost time: 0.7237935066223145
Epoch: 53, Steps: 3 | Train Loss: 0.335 Vali Loss: 0.897 Vali Acc: 0.775 Test Loss: 0.897 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 54 cost time: 0.7434890270233154
Epoch: 54, Steps: 3 | Train Loss: 0.326 Vali Loss: 0.893 Vali Acc: 0.775 Test Loss: 0.893 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 55 cost time: 0.9375693798065186
Epoch: 55, Steps: 3 | Train Loss: 0.291 Vali Loss: 0.891 Vali Acc: 0.775 Test Loss: 0.891 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 56 cost time: 0.7655665874481201
Epoch: 56, Steps: 3 | Train Loss: 0.298 Vali Loss: 0.886 Vali Acc: 0.775 Test Loss: 0.886 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 57 cost time: 0.7138481140136719
Epoch: 57, Steps: 3 | Train Loss: 0.324 Vali Loss: 0.882 Vali Acc: 0.775 Test Loss: 0.882 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 58 cost time: 0.7007632255554199
Epoch: 58, Steps: 3 | Train Loss: 0.278 Vali Loss: 0.879 Vali Acc: 0.775 Test Loss: 0.879 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 59 cost time: 0.729271650314331
Epoch: 59, Steps: 3 | Train Loss: 0.272 Vali Loss: 0.876 Vali Acc: 0.775 Test Loss: 0.876 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 60 cost time: 0.7863779067993164
Epoch: 60, Steps: 3 | Train Loss: 0.306 Vali Loss: 0.872 Vali Acc: 0.775 Test Loss: 0.872 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 61 cost time: 0.6810779571533203
Epoch: 61, Steps: 3 | Train Loss: 0.255 Vali Loss: 0.870 Vali Acc: 0.775 Test Loss: 0.870 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 62 cost time: 0.6708402633666992
Epoch: 62, Steps: 3 | Train Loss: 0.253 Vali Loss: 0.868 Vali Acc: 0.775 Test Loss: 0.868 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 63 cost time: 0.8339109420776367
Epoch: 63, Steps: 3 | Train Loss: 0.258 Vali Loss: 0.865 Vali Acc: 0.775 Test Loss: 0.865 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 64 cost time: 0.6375067234039307
Epoch: 64, Steps: 3 | Train Loss: 0.262 Vali Loss: 0.864 Vali Acc: 0.775 Test Loss: 0.864 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 65 cost time: 1.0395786762237549
Epoch: 65, Steps: 3 | Train Loss: 0.231 Vali Loss: 0.863 Vali Acc: 0.800 Test Loss: 0.863 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799991).  Saving model ...
Epoch: 66 cost time: 0.660853385925293
Epoch: 66, Steps: 3 | Train Loss: 0.230 Vali Loss: 0.861 Vali Acc: 0.800 Test Loss: 0.861 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 67 cost time: 0.654994010925293
Epoch: 67, Steps: 3 | Train Loss: 0.248 Vali Loss: 0.859 Vali Acc: 0.800 Test Loss: 0.859 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 68 cost time: 0.8078818321228027
Epoch: 68, Steps: 3 | Train Loss: 0.230 Vali Loss: 0.859 Vali Acc: 0.800 Test Loss: 0.859 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 69 cost time: 0.6382472515106201
Epoch: 69, Steps: 3 | Train Loss: 0.217 Vali Loss: 0.859 Vali Acc: 0.800 Test Loss: 0.859 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.622971773147583
Epoch: 70, Steps: 3 | Train Loss: 0.228 Vali Loss: 0.860 Vali Acc: 0.800 Test Loss: 0.860 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 0.6301214694976807
Epoch: 71, Steps: 3 | Train Loss: 0.205 Vali Loss: 0.861 Vali Acc: 0.800 Test Loss: 0.861 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 0.6737561225891113
Epoch: 72, Steps: 3 | Train Loss: 0.214 Vali Loss: 0.861 Vali Acc: 0.800 Test Loss: 0.861 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 0.7330245971679688
Epoch: 73, Steps: 3 | Train Loss: 0.195 Vali Loss: 0.864 Vali Acc: 0.800 Test Loss: 0.864 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 0.7479872703552246
Epoch: 74, Steps: 3 | Train Loss: 0.187 Vali Loss: 0.866 Vali Acc: 0.800 Test Loss: 0.866 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 75 cost time: 0.8188943862915039
Epoch: 75, Steps: 3 | Train Loss: 0.195 Vali Loss: 0.869 Vali Acc: 0.800 Test Loss: 0.869 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 76 cost time: 0.7026395797729492
Epoch: 76, Steps: 3 | Train Loss: 0.186 Vali Loss: 0.872 Vali Acc: 0.800 Test Loss: 0.872 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 77 cost time: 0.7978975772857666
Epoch: 77, Steps: 3 | Train Loss: 0.195 Vali Loss: 0.871 Vali Acc: 0.800 Test Loss: 0.871 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 78 cost time: 0.6316421031951904
Epoch: 78, Steps: 3 | Train Loss: 0.182 Vali Loss: 0.872 Vali Acc: 0.800 Test Loss: 0.872 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm32_cs8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.8
model parameter : 14406
model size : 0.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm32_cs7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5183370113372803
Epoch: 1, Steps: 3 | Train Loss: 1.412 Vali Loss: 1.479 Vali Acc: 0.375 Test Loss: 1.479 Test Acc: 0.375
Validation loss decreased (inf --> -0.374985).  Saving model ...
Epoch: 2 cost time: 0.7258620262145996
Epoch: 2, Steps: 3 | Train Loss: 1.367 Vali Loss: 1.473 Vali Acc: 0.375 Test Loss: 1.473 Test Acc: 0.375
Validation loss decreased (-0.374985 --> -0.374985).  Saving model ...
Epoch: 3 cost time: 0.5725662708282471
Epoch: 3, Steps: 3 | Train Loss: 1.337 Vali Loss: 1.467 Vali Acc: 0.375 Test Loss: 1.467 Test Acc: 0.375
Validation loss decreased (-0.374985 --> -0.374985).  Saving model ...
Epoch: 4 cost time: 0.6024608612060547
Epoch: 4, Steps: 3 | Train Loss: 1.367 Vali Loss: 1.458 Vali Acc: 0.375 Test Loss: 1.458 Test Acc: 0.375
Validation loss decreased (-0.374985 --> -0.374985).  Saving model ...
Epoch: 5 cost time: 0.71260666847229
Epoch: 5, Steps: 3 | Train Loss: 1.303 Vali Loss: 1.447 Vali Acc: 0.375 Test Loss: 1.447 Test Acc: 0.375
Validation loss decreased (-0.374985 --> -0.374986).  Saving model ...
Epoch: 6 cost time: 0.6340742111206055
Epoch: 6, Steps: 3 | Train Loss: 1.291 Vali Loss: 1.436 Vali Acc: 0.375 Test Loss: 1.436 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 7 cost time: 0.7565457820892334
Epoch: 7, Steps: 3 | Train Loss: 1.259 Vali Loss: 1.422 Vali Acc: 0.375 Test Loss: 1.422 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 8 cost time: 0.7641839981079102
Epoch: 8, Steps: 3 | Train Loss: 1.265 Vali Loss: 1.409 Vali Acc: 0.375 Test Loss: 1.409 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 9 cost time: 1.067441701889038
Epoch: 9, Steps: 3 | Train Loss: 1.234 Vali Loss: 1.394 Vali Acc: 0.400 Test Loss: 1.394 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399986).  Saving model ...
Epoch: 10 cost time: 0.785092830657959
Epoch: 10, Steps: 3 | Train Loss: 1.216 Vali Loss: 1.378 Vali Acc: 0.400 Test Loss: 1.378 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399986).  Saving model ...
Epoch: 11 cost time: 0.8074545860290527
Epoch: 11, Steps: 3 | Train Loss: 1.186 Vali Loss: 1.363 Vali Acc: 0.450 Test Loss: 1.363 Test Acc: 0.450
Validation loss decreased (-0.399986 --> -0.449986).  Saving model ...
Epoch: 12 cost time: 0.7004072666168213
Epoch: 12, Steps: 3 | Train Loss: 1.138 Vali Loss: 1.348 Vali Acc: 0.475 Test Loss: 1.348 Test Acc: 0.475
Validation loss decreased (-0.449986 --> -0.474987).  Saving model ...
Epoch: 13 cost time: 0.6079230308532715
Epoch: 13, Steps: 3 | Train Loss: 1.117 Vali Loss: 1.332 Vali Acc: 0.475 Test Loss: 1.332 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 14 cost time: 0.6498050689697266
Epoch: 14, Steps: 3 | Train Loss: 1.120 Vali Loss: 1.317 Vali Acc: 0.575 Test Loss: 1.317 Test Acc: 0.575
Validation loss decreased (-0.474987 --> -0.574987).  Saving model ...
Epoch: 15 cost time: 0.6754875183105469
Epoch: 15, Steps: 3 | Train Loss: 1.090 Vali Loss: 1.301 Vali Acc: 0.600 Test Loss: 1.301 Test Acc: 0.600
Validation loss decreased (-0.574987 --> -0.599987).  Saving model ...
Epoch: 16 cost time: 0.6616063117980957
Epoch: 16, Steps: 3 | Train Loss: 1.010 Vali Loss: 1.285 Vali Acc: 0.700 Test Loss: 1.285 Test Acc: 0.700
Validation loss decreased (-0.599987 --> -0.699987).  Saving model ...
Epoch: 17 cost time: 0.7433860301971436
Epoch: 17, Steps: 3 | Train Loss: 1.001 Vali Loss: 1.269 Vali Acc: 0.725 Test Loss: 1.269 Test Acc: 0.725
Validation loss decreased (-0.699987 --> -0.724987).  Saving model ...
Epoch: 18 cost time: 0.9734838008880615
Epoch: 18, Steps: 3 | Train Loss: 0.964 Vali Loss: 1.252 Vali Acc: 0.725 Test Loss: 1.252 Test Acc: 0.725
Validation loss decreased (-0.724987 --> -0.724987).  Saving model ...
Epoch: 19 cost time: 0.861962080001831
Epoch: 19, Steps: 3 | Train Loss: 0.961 Vali Loss: 1.235 Vali Acc: 0.725 Test Loss: 1.235 Test Acc: 0.725
Validation loss decreased (-0.724987 --> -0.724988).  Saving model ...
Epoch: 20 cost time: 0.6600916385650635
Epoch: 20, Steps: 3 | Train Loss: 0.870 Vali Loss: 1.220 Vali Acc: 0.725 Test Loss: 1.220 Test Acc: 0.725
Validation loss decreased (-0.724988 --> -0.724988).  Saving model ...
Epoch: 21 cost time: 0.9079630374908447
Epoch: 21, Steps: 3 | Train Loss: 0.878 Vali Loss: 1.203 Vali Acc: 0.725 Test Loss: 1.203 Test Acc: 0.725
Validation loss decreased (-0.724988 --> -0.724988).  Saving model ...
Epoch: 22 cost time: 0.8751158714294434
Epoch: 22, Steps: 3 | Train Loss: 0.855 Vali Loss: 1.187 Vali Acc: 0.725 Test Loss: 1.187 Test Acc: 0.725
Validation loss decreased (-0.724988 --> -0.724988).  Saving model ...
Epoch: 23 cost time: 0.8468413352966309
Epoch: 23, Steps: 3 | Train Loss: 0.869 Vali Loss: 1.172 Vali Acc: 0.725 Test Loss: 1.172 Test Acc: 0.725
Validation loss decreased (-0.724988 --> -0.724988).  Saving model ...
Epoch: 24 cost time: 0.7477636337280273
Epoch: 24, Steps: 3 | Train Loss: 0.768 Vali Loss: 1.158 Vali Acc: 0.725 Test Loss: 1.158 Test Acc: 0.725
Validation loss decreased (-0.724988 --> -0.724988).  Saving model ...
Epoch: 25 cost time: 0.7295553684234619
Epoch: 25, Steps: 3 | Train Loss: 0.778 Vali Loss: 1.142 Vali Acc: 0.725 Test Loss: 1.142 Test Acc: 0.725
Validation loss decreased (-0.724988 --> -0.724989).  Saving model ...
Epoch: 26 cost time: 0.6292483806610107
Epoch: 26, Steps: 3 | Train Loss: 0.767 Vali Loss: 1.127 Vali Acc: 0.750 Test Loss: 1.127 Test Acc: 0.750
Validation loss decreased (-0.724989 --> -0.749989).  Saving model ...
Epoch: 27 cost time: 0.7782590389251709
Epoch: 27, Steps: 3 | Train Loss: 0.712 Vali Loss: 1.111 Vali Acc: 0.725 Test Loss: 1.111 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9203572273254395
Epoch: 28, Steps: 3 | Train Loss: 0.721 Vali Loss: 1.096 Vali Acc: 0.750 Test Loss: 1.096 Test Acc: 0.750
Validation loss decreased (-0.749989 --> -0.749989).  Saving model ...
Epoch: 29 cost time: 0.9360930919647217
Epoch: 29, Steps: 3 | Train Loss: 0.695 Vali Loss: 1.080 Vali Acc: 0.750 Test Loss: 1.080 Test Acc: 0.750
Validation loss decreased (-0.749989 --> -0.749989).  Saving model ...
Epoch: 30 cost time: 0.9941108226776123
Epoch: 30, Steps: 3 | Train Loss: 0.660 Vali Loss: 1.065 Vali Acc: 0.775 Test Loss: 1.065 Test Acc: 0.775
Validation loss decreased (-0.749989 --> -0.774989).  Saving model ...
Epoch: 31 cost time: 0.582094669342041
Epoch: 31, Steps: 3 | Train Loss: 0.625 Vali Loss: 1.050 Vali Acc: 0.800 Test Loss: 1.050 Test Acc: 0.800
Validation loss decreased (-0.774989 --> -0.799990).  Saving model ...
Epoch: 32 cost time: 0.8056514263153076
Epoch: 32, Steps: 3 | Train Loss: 0.602 Vali Loss: 1.035 Vali Acc: 0.825 Test Loss: 1.035 Test Acc: 0.825
Validation loss decreased (-0.799990 --> -0.824990).  Saving model ...
Epoch: 33 cost time: 0.7279067039489746
Epoch: 33, Steps: 3 | Train Loss: 0.613 Vali Loss: 1.022 Vali Acc: 0.825 Test Loss: 1.022 Test Acc: 0.825
Validation loss decreased (-0.824990 --> -0.824990).  Saving model ...
Epoch: 34 cost time: 0.6725509166717529
Epoch: 34, Steps: 3 | Train Loss: 0.590 Vali Loss: 1.008 Vali Acc: 0.825 Test Loss: 1.008 Test Acc: 0.825
Validation loss decreased (-0.824990 --> -0.824990).  Saving model ...
Epoch: 35 cost time: 0.6229109764099121
Epoch: 35, Steps: 3 | Train Loss: 0.580 Vali Loss: 0.995 Vali Acc: 0.825 Test Loss: 0.995 Test Acc: 0.825
Validation loss decreased (-0.824990 --> -0.824990).  Saving model ...
Epoch: 36 cost time: 0.6328299045562744
Epoch: 36, Steps: 3 | Train Loss: 0.552 Vali Loss: 0.982 Vali Acc: 0.850 Test Loss: 0.982 Test Acc: 0.850
Validation loss decreased (-0.824990 --> -0.849990).  Saving model ...
Epoch: 37 cost time: 0.7289369106292725
Epoch: 37, Steps: 3 | Train Loss: 0.514 Vali Loss: 0.970 Vali Acc: 0.850 Test Loss: 0.970 Test Acc: 0.850
Validation loss decreased (-0.849990 --> -0.849990).  Saving model ...
Epoch: 38 cost time: 0.6752414703369141
Epoch: 38, Steps: 3 | Train Loss: 0.525 Vali Loss: 0.957 Vali Acc: 0.850 Test Loss: 0.957 Test Acc: 0.850
Validation loss decreased (-0.849990 --> -0.849990).  Saving model ...
Epoch: 39 cost time: 0.758037805557251
Epoch: 39, Steps: 3 | Train Loss: 0.481 Vali Loss: 0.945 Vali Acc: 0.850 Test Loss: 0.945 Test Acc: 0.850
Validation loss decreased (-0.849990 --> -0.849991).  Saving model ...
Epoch: 40 cost time: 0.6756789684295654
Epoch: 40, Steps: 3 | Train Loss: 0.468 Vali Loss: 0.934 Vali Acc: 0.850 Test Loss: 0.934 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849991).  Saving model ...
Epoch: 41 cost time: 0.8602344989776611
Epoch: 41, Steps: 3 | Train Loss: 0.482 Vali Loss: 0.924 Vali Acc: 0.850 Test Loss: 0.924 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849991).  Saving model ...
Epoch: 42 cost time: 1.1273918151855469
Epoch: 42, Steps: 3 | Train Loss: 0.446 Vali Loss: 0.915 Vali Acc: 0.850 Test Loss: 0.915 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849991).  Saving model ...
Epoch: 43 cost time: 0.6576671600341797
Epoch: 43, Steps: 3 | Train Loss: 0.435 Vali Loss: 0.906 Vali Acc: 0.850 Test Loss: 0.906 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849991).  Saving model ...
Epoch: 44 cost time: 0.6273689270019531
Epoch: 44, Steps: 3 | Train Loss: 0.432 Vali Loss: 0.897 Vali Acc: 0.850 Test Loss: 0.897 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849991).  Saving model ...
Epoch: 45 cost time: 0.7494957447052002
Epoch: 45, Steps: 3 | Train Loss: 0.391 Vali Loss: 0.887 Vali Acc: 0.850 Test Loss: 0.887 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849991).  Saving model ...
Epoch: 46 cost time: 0.6397495269775391
Epoch: 46, Steps: 3 | Train Loss: 0.399 Vali Loss: 0.877 Vali Acc: 0.850 Test Loss: 0.877 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849991).  Saving model ...
Epoch: 47 cost time: 0.7702267169952393
Epoch: 47, Steps: 3 | Train Loss: 0.393 Vali Loss: 0.867 Vali Acc: 0.850 Test Loss: 0.867 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849991).  Saving model ...
Epoch: 48 cost time: 0.7809345722198486
Epoch: 48, Steps: 3 | Train Loss: 0.379 Vali Loss: 0.859 Vali Acc: 0.850 Test Loss: 0.859 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849991).  Saving model ...
Epoch: 49 cost time: 0.8107562065124512
Epoch: 49, Steps: 3 | Train Loss: 0.379 Vali Loss: 0.852 Vali Acc: 0.850 Test Loss: 0.852 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849991).  Saving model ...
Epoch: 50 cost time: 0.7693567276000977
Epoch: 50, Steps: 3 | Train Loss: 0.368 Vali Loss: 0.846 Vali Acc: 0.850 Test Loss: 0.846 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849992).  Saving model ...
Epoch: 51 cost time: 0.719548225402832
Epoch: 51, Steps: 3 | Train Loss: 0.362 Vali Loss: 0.839 Vali Acc: 0.850 Test Loss: 0.839 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 52 cost time: 0.7761926651000977
Epoch: 52, Steps: 3 | Train Loss: 0.319 Vali Loss: 0.833 Vali Acc: 0.850 Test Loss: 0.833 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 53 cost time: 0.8638057708740234
Epoch: 53, Steps: 3 | Train Loss: 0.320 Vali Loss: 0.827 Vali Acc: 0.850 Test Loss: 0.827 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 54 cost time: 0.5778019428253174
Epoch: 54, Steps: 3 | Train Loss: 0.335 Vali Loss: 0.821 Vali Acc: 0.850 Test Loss: 0.821 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 55 cost time: 0.7102105617523193
Epoch: 55, Steps: 3 | Train Loss: 0.351 Vali Loss: 0.816 Vali Acc: 0.850 Test Loss: 0.816 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 56 cost time: 0.6187529563903809
Epoch: 56, Steps: 3 | Train Loss: 0.313 Vali Loss: 0.813 Vali Acc: 0.850 Test Loss: 0.813 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 57 cost time: 0.6909103393554688
Epoch: 57, Steps: 3 | Train Loss: 0.321 Vali Loss: 0.809 Vali Acc: 0.850 Test Loss: 0.809 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 58 cost time: 0.5600399971008301
Epoch: 58, Steps: 3 | Train Loss: 0.308 Vali Loss: 0.804 Vali Acc: 0.850 Test Loss: 0.804 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 59 cost time: 0.8356478214263916
Epoch: 59, Steps: 3 | Train Loss: 0.303 Vali Loss: 0.800 Vali Acc: 0.850 Test Loss: 0.800 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 60 cost time: 0.6066617965698242
Epoch: 60, Steps: 3 | Train Loss: 0.275 Vali Loss: 0.798 Vali Acc: 0.850 Test Loss: 0.798 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 61 cost time: 0.6883857250213623
Epoch: 61, Steps: 3 | Train Loss: 0.265 Vali Loss: 0.794 Vali Acc: 0.850 Test Loss: 0.794 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 62 cost time: 0.9724392890930176
Epoch: 62, Steps: 3 | Train Loss: 0.273 Vali Loss: 0.789 Vali Acc: 0.850 Test Loss: 0.789 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 63 cost time: 0.7314133644104004
Epoch: 63, Steps: 3 | Train Loss: 0.286 Vali Loss: 0.784 Vali Acc: 0.850 Test Loss: 0.784 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 64 cost time: 0.8317689895629883
Epoch: 64, Steps: 3 | Train Loss: 0.258 Vali Loss: 0.781 Vali Acc: 0.850 Test Loss: 0.781 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 65 cost time: 0.741950511932373
Epoch: 65, Steps: 3 | Train Loss: 0.252 Vali Loss: 0.778 Vali Acc: 0.850 Test Loss: 0.778 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 66 cost time: 0.702416181564331
Epoch: 66, Steps: 3 | Train Loss: 0.256 Vali Loss: 0.775 Vali Acc: 0.850 Test Loss: 0.775 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 67 cost time: 0.7685732841491699
Epoch: 67, Steps: 3 | Train Loss: 0.234 Vali Loss: 0.773 Vali Acc: 0.850 Test Loss: 0.773 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 68 cost time: 0.6890277862548828
Epoch: 68, Steps: 3 | Train Loss: 0.219 Vali Loss: 0.771 Vali Acc: 0.850 Test Loss: 0.771 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 69 cost time: 1.045318603515625
Epoch: 69, Steps: 3 | Train Loss: 0.241 Vali Loss: 0.769 Vali Acc: 0.850 Test Loss: 0.769 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 70 cost time: 0.7764015197753906
Epoch: 70, Steps: 3 | Train Loss: 0.214 Vali Loss: 0.768 Vali Acc: 0.850 Test Loss: 0.768 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 71 cost time: 0.8333554267883301
Epoch: 71, Steps: 3 | Train Loss: 0.229 Vali Loss: 0.767 Vali Acc: 0.850 Test Loss: 0.767 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 72 cost time: 0.6616661548614502
Epoch: 72, Steps: 3 | Train Loss: 0.203 Vali Loss: 0.766 Vali Acc: 0.850 Test Loss: 0.766 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 73 cost time: 0.5963208675384521
Epoch: 73, Steps: 3 | Train Loss: 0.205 Vali Loss: 0.764 Vali Acc: 0.850 Test Loss: 0.764 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 74 cost time: 0.8363387584686279
Epoch: 74, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.764 Vali Acc: 0.850 Test Loss: 0.764 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 75 cost time: 0.8244860172271729
Epoch: 75, Steps: 3 | Train Loss: 0.224 Vali Loss: 0.762 Vali Acc: 0.850 Test Loss: 0.762 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 76 cost time: 0.911823034286499
Epoch: 76, Steps: 3 | Train Loss: 0.214 Vali Loss: 0.762 Vali Acc: 0.850 Test Loss: 0.762 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 77 cost time: 0.7138595581054688
Epoch: 77, Steps: 3 | Train Loss: 0.186 Vali Loss: 0.763 Vali Acc: 0.850 Test Loss: 0.763 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 1.0448174476623535
Epoch: 78, Steps: 3 | Train Loss: 0.184 Vali Loss: 0.763 Vali Acc: 0.850 Test Loss: 0.763 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 1.1070921421051025
Epoch: 79, Steps: 3 | Train Loss: 0.180 Vali Loss: 0.764 Vali Acc: 0.850 Test Loss: 0.764 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 0.9587366580963135
Epoch: 80, Steps: 3 | Train Loss: 0.156 Vali Loss: 0.765 Vali Acc: 0.850 Test Loss: 0.765 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 81 cost time: 1.226768970489502
Epoch: 81, Steps: 3 | Train Loss: 0.182 Vali Loss: 0.766 Vali Acc: 0.850 Test Loss: 0.766 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 82 cost time: 0.8450050354003906
Epoch: 82, Steps: 3 | Train Loss: 0.168 Vali Loss: 0.768 Vali Acc: 0.850 Test Loss: 0.768 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 83 cost time: 0.8357603549957275
Epoch: 83, Steps: 3 | Train Loss: 0.179 Vali Loss: 0.768 Vali Acc: 0.850 Test Loss: 0.768 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 84 cost time: 0.8109025955200195
Epoch: 84, Steps: 3 | Train Loss: 0.160 Vali Loss: 0.769 Vali Acc: 0.850 Test Loss: 0.769 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 85 cost time: 0.9937005043029785
Epoch: 85, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.768 Vali Acc: 0.850 Test Loss: 0.768 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 86 cost time: 0.8955342769622803
Epoch: 86, Steps: 3 | Train Loss: 0.160 Vali Loss: 0.766 Vali Acc: 0.850 Test Loss: 0.766 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm32_cs7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.85
model parameter : 14610
model size : 0.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm32_cs6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.2207679748535156
Epoch: 1, Steps: 3 | Train Loss: 1.378 Vali Loss: 1.460 Vali Acc: 0.350 Test Loss: 1.460 Test Acc: 0.350
Validation loss decreased (inf --> -0.349985).  Saving model ...
Epoch: 2 cost time: 0.7760486602783203
Epoch: 2, Steps: 3 | Train Loss: 1.353 Vali Loss: 1.453 Vali Acc: 0.350 Test Loss: 1.453 Test Acc: 0.350
Validation loss decreased (-0.349985 --> -0.349985).  Saving model ...
Epoch: 3 cost time: 0.721271276473999
Epoch: 3, Steps: 3 | Train Loss: 1.347 Vali Loss: 1.447 Vali Acc: 0.350 Test Loss: 1.447 Test Acc: 0.350
Validation loss decreased (-0.349985 --> -0.349986).  Saving model ...
Epoch: 4 cost time: 0.7521560192108154
Epoch: 4, Steps: 3 | Train Loss: 1.343 Vali Loss: 1.439 Vali Acc: 0.375 Test Loss: 1.439 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374986).  Saving model ...
Epoch: 5 cost time: 0.5907647609710693
Epoch: 5, Steps: 3 | Train Loss: 1.324 Vali Loss: 1.429 Vali Acc: 0.375 Test Loss: 1.429 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 6 cost time: 0.7333035469055176
Epoch: 6, Steps: 3 | Train Loss: 1.271 Vali Loss: 1.418 Vali Acc: 0.400 Test Loss: 1.418 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399986).  Saving model ...
Epoch: 7 cost time: 0.8090560436248779
Epoch: 7, Steps: 3 | Train Loss: 1.263 Vali Loss: 1.406 Vali Acc: 0.425 Test Loss: 1.406 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424986).  Saving model ...
Epoch: 8 cost time: 0.6147351264953613
Epoch: 8, Steps: 3 | Train Loss: 1.257 Vali Loss: 1.393 Vali Acc: 0.425 Test Loss: 1.393 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424986).  Saving model ...
Epoch: 9 cost time: 0.7310802936553955
Epoch: 9, Steps: 3 | Train Loss: 1.212 Vali Loss: 1.380 Vali Acc: 0.425 Test Loss: 1.380 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424986).  Saving model ...
Epoch: 10 cost time: 0.7679996490478516
Epoch: 10, Steps: 3 | Train Loss: 1.168 Vali Loss: 1.366 Vali Acc: 0.475 Test Loss: 1.366 Test Acc: 0.475
Validation loss decreased (-0.424986 --> -0.474986).  Saving model ...
Epoch: 11 cost time: 0.6211717128753662
Epoch: 11, Steps: 3 | Train Loss: 1.165 Vali Loss: 1.353 Vali Acc: 0.475 Test Loss: 1.353 Test Acc: 0.475
Validation loss decreased (-0.474986 --> -0.474986).  Saving model ...
Epoch: 12 cost time: 0.6037182807922363
Epoch: 12, Steps: 3 | Train Loss: 1.108 Vali Loss: 1.338 Vali Acc: 0.500 Test Loss: 1.338 Test Acc: 0.500
Validation loss decreased (-0.474986 --> -0.499987).  Saving model ...
Epoch: 13 cost time: 0.6510031223297119
Epoch: 13, Steps: 3 | Train Loss: 1.109 Vali Loss: 1.322 Vali Acc: 0.475 Test Loss: 1.322 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.554368257522583
Epoch: 14, Steps: 3 | Train Loss: 1.055 Vali Loss: 1.308 Vali Acc: 0.500 Test Loss: 1.308 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 15 cost time: 0.6553933620452881
Epoch: 15, Steps: 3 | Train Loss: 1.027 Vali Loss: 1.292 Vali Acc: 0.525 Test Loss: 1.292 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524987).  Saving model ...
Epoch: 16 cost time: 0.6792924404144287
Epoch: 16, Steps: 3 | Train Loss: 0.997 Vali Loss: 1.276 Vali Acc: 0.525 Test Loss: 1.276 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524987).  Saving model ...
Epoch: 17 cost time: 0.6018462181091309
Epoch: 17, Steps: 3 | Train Loss: 0.926 Vali Loss: 1.259 Vali Acc: 0.525 Test Loss: 1.259 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524987).  Saving model ...
Epoch: 18 cost time: 0.5640010833740234
Epoch: 18, Steps: 3 | Train Loss: 0.958 Vali Loss: 1.243 Vali Acc: 0.525 Test Loss: 1.243 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524988).  Saving model ...
Epoch: 19 cost time: 0.616588830947876
Epoch: 19, Steps: 3 | Train Loss: 0.918 Vali Loss: 1.227 Vali Acc: 0.550 Test Loss: 1.227 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 20 cost time: 0.8116047382354736
Epoch: 20, Steps: 3 | Train Loss: 0.877 Vali Loss: 1.211 Vali Acc: 0.575 Test Loss: 1.211 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 21 cost time: 0.5359764099121094
Epoch: 21, Steps: 3 | Train Loss: 0.857 Vali Loss: 1.195 Vali Acc: 0.575 Test Loss: 1.195 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 22 cost time: 0.6907286643981934
Epoch: 22, Steps: 3 | Train Loss: 0.841 Vali Loss: 1.179 Vali Acc: 0.575 Test Loss: 1.179 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 23 cost time: 0.875413179397583
Epoch: 23, Steps: 3 | Train Loss: 0.835 Vali Loss: 1.163 Vali Acc: 0.600 Test Loss: 1.163 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599988).  Saving model ...
Epoch: 24 cost time: 0.8465414047241211
Epoch: 24, Steps: 3 | Train Loss: 0.732 Vali Loss: 1.147 Vali Acc: 0.650 Test Loss: 1.147 Test Acc: 0.650
Validation loss decreased (-0.599988 --> -0.649989).  Saving model ...
Epoch: 25 cost time: 0.604255199432373
Epoch: 25, Steps: 3 | Train Loss: 0.734 Vali Loss: 1.132 Vali Acc: 0.625 Test Loss: 1.132 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5498833656311035
Epoch: 26, Steps: 3 | Train Loss: 0.753 Vali Loss: 1.118 Vali Acc: 0.625 Test Loss: 1.118 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7476894855499268
Epoch: 27, Steps: 3 | Train Loss: 0.713 Vali Loss: 1.106 Vali Acc: 0.625 Test Loss: 1.106 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6781156063079834
Epoch: 28, Steps: 3 | Train Loss: 0.694 Vali Loss: 1.094 Vali Acc: 0.650 Test Loss: 1.094 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 29 cost time: 0.621333122253418
Epoch: 29, Steps: 3 | Train Loss: 0.685 Vali Loss: 1.080 Vali Acc: 0.650 Test Loss: 1.080 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 30 cost time: 0.6564445495605469
Epoch: 30, Steps: 3 | Train Loss: 0.629 Vali Loss: 1.066 Vali Acc: 0.650 Test Loss: 1.066 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 31 cost time: 0.7790448665618896
Epoch: 31, Steps: 3 | Train Loss: 0.632 Vali Loss: 1.053 Vali Acc: 0.650 Test Loss: 1.053 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 32 cost time: 0.6786642074584961
Epoch: 32, Steps: 3 | Train Loss: 0.589 Vali Loss: 1.041 Vali Acc: 0.675 Test Loss: 1.041 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674990).  Saving model ...
Epoch: 33 cost time: 0.7436456680297852
Epoch: 33, Steps: 3 | Train Loss: 0.586 Vali Loss: 1.029 Vali Acc: 0.675 Test Loss: 1.029 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 34 cost time: 0.6795463562011719
Epoch: 34, Steps: 3 | Train Loss: 0.570 Vali Loss: 1.018 Vali Acc: 0.700 Test Loss: 1.018 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 35 cost time: 0.665543794631958
Epoch: 35, Steps: 3 | Train Loss: 0.553 Vali Loss: 1.006 Vali Acc: 0.725 Test Loss: 1.006 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724990).  Saving model ...
Epoch: 36 cost time: 0.6889050006866455
Epoch: 36, Steps: 3 | Train Loss: 0.561 Vali Loss: 0.997 Vali Acc: 0.725 Test Loss: 0.997 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 37 cost time: 0.5898678302764893
Epoch: 37, Steps: 3 | Train Loss: 0.523 Vali Loss: 0.986 Vali Acc: 0.725 Test Loss: 0.986 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 38 cost time: 0.5492520332336426
Epoch: 38, Steps: 3 | Train Loss: 0.479 Vali Loss: 0.976 Vali Acc: 0.725 Test Loss: 0.976 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 39 cost time: 0.5693449974060059
Epoch: 39, Steps: 3 | Train Loss: 0.473 Vali Loss: 0.966 Vali Acc: 0.775 Test Loss: 0.966 Test Acc: 0.775
Validation loss decreased (-0.724990 --> -0.774990).  Saving model ...
Epoch: 40 cost time: 0.6535289287567139
Epoch: 40, Steps: 3 | Train Loss: 0.475 Vali Loss: 0.957 Vali Acc: 0.775 Test Loss: 0.957 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774990).  Saving model ...
Epoch: 41 cost time: 0.6511902809143066
Epoch: 41, Steps: 3 | Train Loss: 0.439 Vali Loss: 0.949 Vali Acc: 0.775 Test Loss: 0.949 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774991).  Saving model ...
Epoch: 42 cost time: 0.6810064315795898
Epoch: 42, Steps: 3 | Train Loss: 0.435 Vali Loss: 0.941 Vali Acc: 0.775 Test Loss: 0.941 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 43 cost time: 0.722531795501709
Epoch: 43, Steps: 3 | Train Loss: 0.416 Vali Loss: 0.933 Vali Acc: 0.800 Test Loss: 0.933 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799991).  Saving model ...
Epoch: 44 cost time: 0.6688930988311768
Epoch: 44, Steps: 3 | Train Loss: 0.418 Vali Loss: 0.927 Vali Acc: 0.800 Test Loss: 0.927 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 45 cost time: 0.6004161834716797
Epoch: 45, Steps: 3 | Train Loss: 0.392 Vali Loss: 0.922 Vali Acc: 0.800 Test Loss: 0.922 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 46 cost time: 0.6679849624633789
Epoch: 46, Steps: 3 | Train Loss: 0.383 Vali Loss: 0.916 Vali Acc: 0.800 Test Loss: 0.916 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 47 cost time: 0.9125897884368896
Epoch: 47, Steps: 3 | Train Loss: 0.376 Vali Loss: 0.911 Vali Acc: 0.800 Test Loss: 0.911 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 48 cost time: 0.46816325187683105
Epoch: 48, Steps: 3 | Train Loss: 0.395 Vali Loss: 0.906 Vali Acc: 0.800 Test Loss: 0.906 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 49 cost time: 0.6718072891235352
Epoch: 49, Steps: 3 | Train Loss: 0.344 Vali Loss: 0.902 Vali Acc: 0.800 Test Loss: 0.902 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 50 cost time: 0.64736008644104
Epoch: 50, Steps: 3 | Train Loss: 0.353 Vali Loss: 0.898 Vali Acc: 0.800 Test Loss: 0.898 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 51 cost time: 0.6467030048370361
Epoch: 51, Steps: 3 | Train Loss: 0.344 Vali Loss: 0.895 Vali Acc: 0.800 Test Loss: 0.895 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 52 cost time: 0.6238498687744141
Epoch: 52, Steps: 3 | Train Loss: 0.308 Vali Loss: 0.891 Vali Acc: 0.800 Test Loss: 0.891 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 53 cost time: 0.716381311416626
Epoch: 53, Steps: 3 | Train Loss: 0.312 Vali Loss: 0.887 Vali Acc: 0.800 Test Loss: 0.887 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 54 cost time: 0.8349318504333496
Epoch: 54, Steps: 3 | Train Loss: 0.336 Vali Loss: 0.882 Vali Acc: 0.800 Test Loss: 0.882 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 55 cost time: 0.7939581871032715
Epoch: 55, Steps: 3 | Train Loss: 0.293 Vali Loss: 0.879 Vali Acc: 0.800 Test Loss: 0.879 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 56 cost time: 0.6907265186309814
Epoch: 56, Steps: 3 | Train Loss: 0.285 Vali Loss: 0.875 Vali Acc: 0.800 Test Loss: 0.875 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 57 cost time: 0.8203837871551514
Epoch: 57, Steps: 3 | Train Loss: 0.318 Vali Loss: 0.872 Vali Acc: 0.800 Test Loss: 0.872 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 58 cost time: 0.5906140804290771
Epoch: 58, Steps: 3 | Train Loss: 0.267 Vali Loss: 0.869 Vali Acc: 0.800 Test Loss: 0.869 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 59 cost time: 0.6919660568237305
Epoch: 59, Steps: 3 | Train Loss: 0.262 Vali Loss: 0.867 Vali Acc: 0.800 Test Loss: 0.867 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 60 cost time: 0.6674737930297852
Epoch: 60, Steps: 3 | Train Loss: 0.271 Vali Loss: 0.865 Vali Acc: 0.800 Test Loss: 0.865 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 61 cost time: 0.728769063949585
Epoch: 61, Steps: 3 | Train Loss: 0.272 Vali Loss: 0.863 Vali Acc: 0.800 Test Loss: 0.863 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 62 cost time: 0.6645276546478271
Epoch: 62, Steps: 3 | Train Loss: 0.239 Vali Loss: 0.861 Vali Acc: 0.800 Test Loss: 0.861 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 63 cost time: 0.6554896831512451
Epoch: 63, Steps: 3 | Train Loss: 0.237 Vali Loss: 0.859 Vali Acc: 0.800 Test Loss: 0.859 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 64 cost time: 0.8291370868682861
Epoch: 64, Steps: 3 | Train Loss: 0.261 Vali Loss: 0.858 Vali Acc: 0.800 Test Loss: 0.858 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 65 cost time: 0.828803539276123
Epoch: 65, Steps: 3 | Train Loss: 0.236 Vali Loss: 0.858 Vali Acc: 0.800 Test Loss: 0.858 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.5853664875030518
Epoch: 66, Steps: 3 | Train Loss: 0.223 Vali Loss: 0.858 Vali Acc: 0.825 Test Loss: 0.858 Test Acc: 0.825
Validation loss decreased (-0.799991 --> -0.824991).  Saving model ...
Epoch: 67 cost time: 0.7409813404083252
Epoch: 67, Steps: 3 | Train Loss: 0.237 Vali Loss: 0.859 Vali Acc: 0.825 Test Loss: 0.859 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.8229482173919678
Epoch: 68, Steps: 3 | Train Loss: 0.212 Vali Loss: 0.859 Vali Acc: 0.825 Test Loss: 0.859 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.6843676567077637
Epoch: 69, Steps: 3 | Train Loss: 0.217 Vali Loss: 0.860 Vali Acc: 0.825 Test Loss: 0.860 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 0.7290956974029541
Epoch: 70, Steps: 3 | Train Loss: 0.200 Vali Loss: 0.862 Vali Acc: 0.825 Test Loss: 0.862 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 0.8682124614715576
Epoch: 71, Steps: 3 | Train Loss: 0.192 Vali Loss: 0.865 Vali Acc: 0.825 Test Loss: 0.865 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 0.7705116271972656
Epoch: 72, Steps: 3 | Train Loss: 0.200 Vali Loss: 0.868 Vali Acc: 0.825 Test Loss: 0.868 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 0.8374156951904297
Epoch: 73, Steps: 3 | Train Loss: 0.190 Vali Loss: 0.871 Vali Acc: 0.825 Test Loss: 0.871 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 0.7624998092651367
Epoch: 74, Steps: 3 | Train Loss: 0.203 Vali Loss: 0.873 Vali Acc: 0.825 Test Loss: 0.873 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 0.9126830101013184
Epoch: 75, Steps: 3 | Train Loss: 0.185 Vali Loss: 0.876 Vali Acc: 0.825 Test Loss: 0.876 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 76 cost time: 0.9638261795043945
Epoch: 76, Steps: 3 | Train Loss: 0.182 Vali Loss: 0.878 Vali Acc: 0.825 Test Loss: 0.878 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm32_cs6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.825
model parameter : 14430
model size : 0.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm32_cs5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.1208155155181885
Epoch: 1, Steps: 3 | Train Loss: 1.452 Vali Loss: 1.412 Vali Acc: 0.100 Test Loss: 1.412 Test Acc: 0.100
Validation loss decreased (inf --> -0.099986).  Saving model ...
Epoch: 2 cost time: 0.660778284072876
Epoch: 2, Steps: 3 | Train Loss: 1.416 Vali Loss: 1.406 Vali Acc: 0.100 Test Loss: 1.406 Test Acc: 0.100
Validation loss decreased (-0.099986 --> -0.099986).  Saving model ...
Epoch: 3 cost time: 0.7446174621582031
Epoch: 3, Steps: 3 | Train Loss: 1.398 Vali Loss: 1.401 Vali Acc: 0.100 Test Loss: 1.401 Test Acc: 0.100
Validation loss decreased (-0.099986 --> -0.099986).  Saving model ...
Epoch: 4 cost time: 0.9659512042999268
Epoch: 4, Steps: 3 | Train Loss: 1.399 Vali Loss: 1.393 Vali Acc: 0.100 Test Loss: 1.393 Test Acc: 0.100
Validation loss decreased (-0.099986 --> -0.099986).  Saving model ...
Epoch: 5 cost time: 0.6592624187469482
Epoch: 5, Steps: 3 | Train Loss: 1.373 Vali Loss: 1.384 Vali Acc: 0.100 Test Loss: 1.384 Test Acc: 0.100
Validation loss decreased (-0.099986 --> -0.099986).  Saving model ...
Epoch: 6 cost time: 0.6823043823242188
Epoch: 6, Steps: 3 | Train Loss: 1.344 Vali Loss: 1.374 Vali Acc: 0.100 Test Loss: 1.374 Test Acc: 0.100
Validation loss decreased (-0.099986 --> -0.099986).  Saving model ...
Epoch: 7 cost time: 0.5353958606719971
Epoch: 7, Steps: 3 | Train Loss: 1.290 Vali Loss: 1.364 Vali Acc: 0.100 Test Loss: 1.364 Test Acc: 0.100
Validation loss decreased (-0.099986 --> -0.099986).  Saving model ...
Epoch: 8 cost time: 0.7197329998016357
Epoch: 8, Steps: 3 | Train Loss: 1.262 Vali Loss: 1.353 Vali Acc: 0.100 Test Loss: 1.353 Test Acc: 0.100
Validation loss decreased (-0.099986 --> -0.099986).  Saving model ...
Epoch: 9 cost time: 0.616635799407959
Epoch: 9, Steps: 3 | Train Loss: 1.241 Vali Loss: 1.342 Vali Acc: 0.200 Test Loss: 1.342 Test Acc: 0.200
Validation loss decreased (-0.099986 --> -0.199987).  Saving model ...
Epoch: 10 cost time: 0.8757236003875732
Epoch: 10, Steps: 3 | Train Loss: 1.198 Vali Loss: 1.331 Vali Acc: 0.400 Test Loss: 1.331 Test Acc: 0.400
Validation loss decreased (-0.199987 --> -0.399987).  Saving model ...
Epoch: 11 cost time: 0.754744291305542
Epoch: 11, Steps: 3 | Train Loss: 1.156 Vali Loss: 1.319 Vali Acc: 0.425 Test Loss: 1.319 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424987).  Saving model ...
Epoch: 12 cost time: 0.8584561347961426
Epoch: 12, Steps: 3 | Train Loss: 1.163 Vali Loss: 1.306 Vali Acc: 0.425 Test Loss: 1.306 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 13 cost time: 0.5736868381500244
Epoch: 13, Steps: 3 | Train Loss: 1.117 Vali Loss: 1.293 Vali Acc: 0.425 Test Loss: 1.293 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 14 cost time: 0.7828652858734131
Epoch: 14, Steps: 3 | Train Loss: 1.069 Vali Loss: 1.279 Vali Acc: 0.500 Test Loss: 1.279 Test Acc: 0.500
Validation loss decreased (-0.424987 --> -0.499987).  Saving model ...
Epoch: 15 cost time: 0.6847426891326904
Epoch: 15, Steps: 3 | Train Loss: 1.030 Vali Loss: 1.264 Vali Acc: 0.550 Test Loss: 1.264 Test Acc: 0.550
Validation loss decreased (-0.499987 --> -0.549987).  Saving model ...
Epoch: 16 cost time: 0.6138372421264648
Epoch: 16, Steps: 3 | Train Loss: 1.005 Vali Loss: 1.251 Vali Acc: 0.600 Test Loss: 1.251 Test Acc: 0.600
Validation loss decreased (-0.549987 --> -0.599987).  Saving model ...
Epoch: 17 cost time: 0.7320044040679932
Epoch: 17, Steps: 3 | Train Loss: 0.985 Vali Loss: 1.236 Vali Acc: 0.625 Test Loss: 1.236 Test Acc: 0.625
Validation loss decreased (-0.599987 --> -0.624988).  Saving model ...
Epoch: 18 cost time: 0.9818272590637207
Epoch: 18, Steps: 3 | Train Loss: 0.955 Vali Loss: 1.220 Vali Acc: 0.625 Test Loss: 1.220 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 19 cost time: 0.7319798469543457
Epoch: 19, Steps: 3 | Train Loss: 0.921 Vali Loss: 1.204 Vali Acc: 0.625 Test Loss: 1.204 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 20 cost time: 0.9365816116333008
Epoch: 20, Steps: 3 | Train Loss: 0.877 Vali Loss: 1.189 Vali Acc: 0.625 Test Loss: 1.189 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 21 cost time: 0.6834990978240967
Epoch: 21, Steps: 3 | Train Loss: 0.858 Vali Loss: 1.173 Vali Acc: 0.625 Test Loss: 1.173 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 22 cost time: 0.6765458583831787
Epoch: 22, Steps: 3 | Train Loss: 0.814 Vali Loss: 1.157 Vali Acc: 0.650 Test Loss: 1.157 Test Acc: 0.650
Validation loss decreased (-0.624988 --> -0.649988).  Saving model ...
Epoch: 23 cost time: 0.8878922462463379
Epoch: 23, Steps: 3 | Train Loss: 0.799 Vali Loss: 1.141 Vali Acc: 0.675 Test Loss: 1.141 Test Acc: 0.675
Validation loss decreased (-0.649988 --> -0.674989).  Saving model ...
Epoch: 24 cost time: 0.7390329837799072
Epoch: 24, Steps: 3 | Train Loss: 0.774 Vali Loss: 1.124 Vali Acc: 0.700 Test Loss: 1.124 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699989).  Saving model ...
Epoch: 25 cost time: 0.9491572380065918
Epoch: 25, Steps: 3 | Train Loss: 0.763 Vali Loss: 1.108 Vali Acc: 0.700 Test Loss: 1.108 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 26 cost time: 0.8093039989471436
Epoch: 26, Steps: 3 | Train Loss: 0.726 Vali Loss: 1.092 Vali Acc: 0.675 Test Loss: 1.092 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.103733777999878
Epoch: 27, Steps: 3 | Train Loss: 0.711 Vali Loss: 1.078 Vali Acc: 0.700 Test Loss: 1.078 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 28 cost time: 0.8559832572937012
Epoch: 28, Steps: 3 | Train Loss: 0.674 Vali Loss: 1.063 Vali Acc: 0.700 Test Loss: 1.063 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 29 cost time: 0.7759308815002441
Epoch: 29, Steps: 3 | Train Loss: 0.633 Vali Loss: 1.045 Vali Acc: 0.775 Test Loss: 1.045 Test Acc: 0.775
Validation loss decreased (-0.699989 --> -0.774990).  Saving model ...
Epoch: 30 cost time: 1.256892442703247
Epoch: 30, Steps: 3 | Train Loss: 0.639 Vali Loss: 1.029 Vali Acc: 0.750 Test Loss: 1.029 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7784261703491211
Epoch: 31, Steps: 3 | Train Loss: 0.639 Vali Loss: 1.012 Vali Acc: 0.750 Test Loss: 1.012 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8361659049987793
Epoch: 32, Steps: 3 | Train Loss: 0.596 Vali Loss: 0.995 Vali Acc: 0.750 Test Loss: 0.995 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.236891746520996
Epoch: 33, Steps: 3 | Train Loss: 0.546 Vali Loss: 0.979 Vali Acc: 0.750 Test Loss: 0.979 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.9637143611907959
Epoch: 34, Steps: 3 | Train Loss: 0.511 Vali Loss: 0.965 Vali Acc: 0.750 Test Loss: 0.965 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.9784486293792725
Epoch: 35, Steps: 3 | Train Loss: 0.528 Vali Loss: 0.948 Vali Acc: 0.750 Test Loss: 0.948 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.8603677749633789
Epoch: 36, Steps: 3 | Train Loss: 0.523 Vali Loss: 0.934 Vali Acc: 0.750 Test Loss: 0.934 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.9912796020507812
Epoch: 37, Steps: 3 | Train Loss: 0.479 Vali Loss: 0.920 Vali Acc: 0.750 Test Loss: 0.920 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.0078229904174805
Epoch: 38, Steps: 3 | Train Loss: 0.487 Vali Loss: 0.907 Vali Acc: 0.750 Test Loss: 0.907 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.2796685695648193
Epoch: 39, Steps: 3 | Train Loss: 0.449 Vali Loss: 0.893 Vali Acc: 0.775 Test Loss: 0.893 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774991).  Saving model ...
Epoch: 40 cost time: 0.8733949661254883
Epoch: 40, Steps: 3 | Train Loss: 0.453 Vali Loss: 0.882 Vali Acc: 0.775 Test Loss: 0.882 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 41 cost time: 0.8636078834533691
Epoch: 41, Steps: 3 | Train Loss: 0.433 Vali Loss: 0.871 Vali Acc: 0.750 Test Loss: 0.871 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.1966586112976074
Epoch: 42, Steps: 3 | Train Loss: 0.395 Vali Loss: 0.860 Vali Acc: 0.750 Test Loss: 0.860 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.0627095699310303
Epoch: 43, Steps: 3 | Train Loss: 0.393 Vali Loss: 0.847 Vali Acc: 0.750 Test Loss: 0.847 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.9978482723236084
Epoch: 44, Steps: 3 | Train Loss: 0.400 Vali Loss: 0.834 Vali Acc: 0.775 Test Loss: 0.834 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774992).  Saving model ...
Epoch: 45 cost time: 1.1730601787567139
Epoch: 45, Steps: 3 | Train Loss: 0.370 Vali Loss: 0.823 Vali Acc: 0.800 Test Loss: 0.823 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799992).  Saving model ...
Epoch: 46 cost time: 0.9080407619476318
Epoch: 46, Steps: 3 | Train Loss: 0.379 Vali Loss: 0.812 Vali Acc: 0.800 Test Loss: 0.812 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 47 cost time: 1.0127880573272705
Epoch: 47, Steps: 3 | Train Loss: 0.342 Vali Loss: 0.798 Vali Acc: 0.825 Test Loss: 0.798 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824992).  Saving model ...
Epoch: 48 cost time: 0.9408116340637207
Epoch: 48, Steps: 3 | Train Loss: 0.353 Vali Loss: 0.784 Vali Acc: 0.825 Test Loss: 0.784 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 49 cost time: 0.8008983135223389
Epoch: 49, Steps: 3 | Train Loss: 0.345 Vali Loss: 0.769 Vali Acc: 0.825 Test Loss: 0.769 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 50 cost time: 0.8622517585754395
Epoch: 50, Steps: 3 | Train Loss: 0.323 Vali Loss: 0.755 Vali Acc: 0.850 Test Loss: 0.755 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849992).  Saving model ...
Epoch: 51 cost time: 0.9511773586273193
Epoch: 51, Steps: 3 | Train Loss: 0.346 Vali Loss: 0.740 Vali Acc: 0.850 Test Loss: 0.740 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849993).  Saving model ...
Epoch: 52 cost time: 1.0470852851867676
Epoch: 52, Steps: 3 | Train Loss: 0.332 Vali Loss: 0.728 Vali Acc: 0.850 Test Loss: 0.728 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 53 cost time: 1.1405174732208252
Epoch: 53, Steps: 3 | Train Loss: 0.309 Vali Loss: 0.717 Vali Acc: 0.850 Test Loss: 0.717 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 54 cost time: 1.0776183605194092
Epoch: 54, Steps: 3 | Train Loss: 0.319 Vali Loss: 0.707 Vali Acc: 0.850 Test Loss: 0.707 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 55 cost time: 1.0308077335357666
Epoch: 55, Steps: 3 | Train Loss: 0.283 Vali Loss: 0.698 Vali Acc: 0.850 Test Loss: 0.698 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 56 cost time: 0.8287153244018555
Epoch: 56, Steps: 3 | Train Loss: 0.260 Vali Loss: 0.688 Vali Acc: 0.850 Test Loss: 0.688 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 57 cost time: 0.8598933219909668
Epoch: 57, Steps: 3 | Train Loss: 0.251 Vali Loss: 0.677 Vali Acc: 0.850 Test Loss: 0.677 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 58 cost time: 0.8610951900482178
Epoch: 58, Steps: 3 | Train Loss: 0.292 Vali Loss: 0.666 Vali Acc: 0.850 Test Loss: 0.666 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 59 cost time: 0.9769117832183838
Epoch: 59, Steps: 3 | Train Loss: 0.253 Vali Loss: 0.656 Vali Acc: 0.850 Test Loss: 0.656 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 60 cost time: 0.8830466270446777
Epoch: 60, Steps: 3 | Train Loss: 0.240 Vali Loss: 0.643 Vali Acc: 0.850 Test Loss: 0.643 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 61 cost time: 0.8369593620300293
Epoch: 61, Steps: 3 | Train Loss: 0.241 Vali Loss: 0.631 Vali Acc: 0.850 Test Loss: 0.631 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 62 cost time: 0.9087283611297607
Epoch: 62, Steps: 3 | Train Loss: 0.229 Vali Loss: 0.617 Vali Acc: 0.850 Test Loss: 0.617 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 63 cost time: 0.9811837673187256
Epoch: 63, Steps: 3 | Train Loss: 0.236 Vali Loss: 0.604 Vali Acc: 0.850 Test Loss: 0.604 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 64 cost time: 0.7527358531951904
Epoch: 64, Steps: 3 | Train Loss: 0.216 Vali Loss: 0.589 Vali Acc: 0.850 Test Loss: 0.589 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 65 cost time: 0.9008054733276367
Epoch: 65, Steps: 3 | Train Loss: 0.202 Vali Loss: 0.575 Vali Acc: 0.850 Test Loss: 0.575 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 66 cost time: 1.3092665672302246
Epoch: 66, Steps: 3 | Train Loss: 0.207 Vali Loss: 0.561 Vali Acc: 0.850 Test Loss: 0.561 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 67 cost time: 0.8514211177825928
Epoch: 67, Steps: 3 | Train Loss: 0.194 Vali Loss: 0.544 Vali Acc: 0.850 Test Loss: 0.544 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 68 cost time: 1.050414800643921
Epoch: 68, Steps: 3 | Train Loss: 0.173 Vali Loss: 0.527 Vali Acc: 0.850 Test Loss: 0.527 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 69 cost time: 0.8676333427429199
Epoch: 69, Steps: 3 | Train Loss: 0.182 Vali Loss: 0.508 Vali Acc: 0.850 Test Loss: 0.508 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 70 cost time: 0.8869738578796387
Epoch: 70, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.490 Vali Acc: 0.850 Test Loss: 0.490 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 71 cost time: 0.9412972927093506
Epoch: 71, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.477 Vali Acc: 0.850 Test Loss: 0.477 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 72 cost time: 0.8571610450744629
Epoch: 72, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.461 Vali Acc: 0.850 Test Loss: 0.461 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 73 cost time: 1.0357413291931152
Epoch: 73, Steps: 3 | Train Loss: 0.130 Vali Loss: 0.444 Vali Acc: 0.850 Test Loss: 0.444 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849996).  Saving model ...
Epoch: 74 cost time: 0.9494650363922119
Epoch: 74, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.424 Vali Acc: 0.850 Test Loss: 0.424 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 75 cost time: 0.9640293121337891
Epoch: 75, Steps: 3 | Train Loss: 0.123 Vali Loss: 0.404 Vali Acc: 0.850 Test Loss: 0.404 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 76 cost time: 0.8139629364013672
Epoch: 76, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.386 Vali Acc: 0.850 Test Loss: 0.386 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 77 cost time: 0.7365522384643555
Epoch: 77, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.368 Vali Acc: 0.850 Test Loss: 0.368 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 78 cost time: 0.7638936042785645
Epoch: 78, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.355 Vali Acc: 0.850 Test Loss: 0.355 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 79 cost time: 0.8776645660400391
Epoch: 79, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.337 Vali Acc: 0.850 Test Loss: 0.337 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849997).  Saving model ...
Epoch: 80 cost time: 1.0382328033447266
Epoch: 80, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.319 Vali Acc: 0.875 Test Loss: 0.319 Test Acc: 0.875
Validation loss decreased (-0.849997 --> -0.874997).  Saving model ...
Epoch: 81 cost time: 0.7362704277038574
Epoch: 81, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.306 Vali Acc: 0.875 Test Loss: 0.306 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 82 cost time: 0.8705456256866455
Epoch: 82, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.294 Vali Acc: 0.875 Test Loss: 0.294 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 83 cost time: 0.8928794860839844
Epoch: 83, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.283 Vali Acc: 0.900 Test Loss: 0.283 Test Acc: 0.900
Validation loss decreased (-0.874997 --> -0.899997).  Saving model ...
Epoch: 84 cost time: 1.0132691860198975
Epoch: 84, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.268 Vali Acc: 0.900 Test Loss: 0.268 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 85 cost time: 0.7021331787109375
Epoch: 85, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.261 Vali Acc: 0.925 Test Loss: 0.261 Test Acc: 0.925
Validation loss decreased (-0.899997 --> -0.924997).  Saving model ...
Epoch: 86 cost time: 0.8391745090484619
Epoch: 86, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.253 Vali Acc: 0.925 Test Loss: 0.253 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 87 cost time: 1.1377999782562256
Epoch: 87, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.239 Vali Acc: 0.925 Test Loss: 0.239 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924998).  Saving model ...
Epoch: 88 cost time: 0.7553260326385498
Epoch: 88, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.223 Vali Acc: 0.950 Test Loss: 0.223 Test Acc: 0.950
Validation loss decreased (-0.924998 --> -0.949998).  Saving model ...
Epoch: 89 cost time: 1.0782504081726074
Epoch: 89, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.204 Vali Acc: 0.950 Test Loss: 0.204 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 90 cost time: 0.8981642723083496
Epoch: 90, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.180 Vali Acc: 1.000 Test Loss: 0.180 Test Acc: 1.000
Validation loss decreased (-0.949998 --> -0.999998).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_LightTS_UEA_ftM_sl100_ll0_pl0_dm32_cs5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 14448
model size : 0.07MB
