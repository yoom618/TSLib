Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.958056211471558
Epoch: 1, Steps: 10 | Train Loss: 1.577 Vali Loss: 1.353 Vali Acc: 0.446 Test Loss: 1.353 Test Acc: 0.446
Validation loss decreased (inf --> -0.445932).  Saving model ...
Epoch: 2 cost time: 4.306979179382324
Epoch: 2, Steps: 10 | Train Loss: 1.461 Vali Loss: 1.365 Vali Acc: 0.419 Test Loss: 1.365 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.44948410987854
Epoch: 3, Steps: 10 | Train Loss: 1.202 Vali Loss: 1.274 Vali Acc: 0.419 Test Loss: 1.274 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.297411918640137
Epoch: 4, Steps: 10 | Train Loss: 1.020 Vali Loss: 1.229 Vali Acc: 0.419 Test Loss: 1.229 Test Acc: 0.419
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.828200578689575
Epoch: 5, Steps: 10 | Train Loss: 0.787 Vali Loss: 1.186 Vali Acc: 0.527 Test Loss: 1.186 Test Acc: 0.527
Validation loss decreased (-0.445932 --> -0.527015).  Saving model ...
Epoch: 6 cost time: 3.9893877506256104
Epoch: 6, Steps: 10 | Train Loss: 0.689 Vali Loss: 1.246 Vali Acc: 0.541 Test Loss: 1.246 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540528).  Saving model ...
Epoch: 7 cost time: 4.293781042098999
Epoch: 7, Steps: 10 | Train Loss: 0.473 Vali Loss: 1.275 Vali Acc: 0.514 Test Loss: 1.275 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.774817943572998
Epoch: 8, Steps: 10 | Train Loss: 0.269 Vali Loss: 1.244 Vali Acc: 0.581 Test Loss: 1.244 Test Acc: 0.581
Validation loss decreased (-0.540528 --> -0.581069).  Saving model ...
Epoch: 9 cost time: 3.5214476585388184
Epoch: 9, Steps: 10 | Train Loss: 0.151 Vali Loss: 1.353 Vali Acc: 0.541 Test Loss: 1.353 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.097825527191162
Epoch: 10, Steps: 10 | Train Loss: 0.071 Vali Loss: 1.428 Vali Acc: 0.514 Test Loss: 1.428 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.974273443222046
Epoch: 11, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.521 Vali Acc: 0.500 Test Loss: 1.521 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.5667901039123535
Epoch: 12, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.623 Vali Acc: 0.581 Test Loss: 1.623 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.363295316696167
Epoch: 13, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.628 Vali Acc: 0.541 Test Loss: 1.628 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.914991617202759
Epoch: 14, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.736 Vali Acc: 0.514 Test Loss: 1.736 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.7456490993499756
Epoch: 15, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.617 Vali Acc: 0.514 Test Loss: 1.617 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.7552244663238525
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.663 Vali Acc: 0.527 Test Loss: 1.663 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.936183214187622
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.767 Vali Acc: 0.514 Test Loss: 1.767 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.081838369369507
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.773 Vali Acc: 0.500 Test Loss: 1.773 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 14456128
model size : 60.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.158313989639282
Epoch: 1, Steps: 10 | Train Loss: 1.623 Vali Loss: 2.277 Vali Acc: 0.189 Test Loss: 2.277 Test Acc: 0.189
Validation loss decreased (inf --> -0.189166).  Saving model ...
Epoch: 2 cost time: 4.224562406539917
Epoch: 2, Steps: 10 | Train Loss: 1.582 Vali Loss: 1.380 Vali Acc: 0.419 Test Loss: 1.380 Test Acc: 0.419
Validation loss decreased (-0.189166 --> -0.418905).  Saving model ...
Epoch: 3 cost time: 3.6911919116973877
Epoch: 3, Steps: 10 | Train Loss: 1.230 Vali Loss: 1.658 Vali Acc: 0.216 Test Loss: 1.658 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.8381614685058594
Epoch: 4, Steps: 10 | Train Loss: 1.120 Vali Loss: 1.299 Vali Acc: 0.432 Test Loss: 1.299 Test Acc: 0.432
Validation loss decreased (-0.418905 --> -0.432419).  Saving model ...
Epoch: 5 cost time: 4.124222040176392
Epoch: 5, Steps: 10 | Train Loss: 0.796 Vali Loss: 1.150 Vali Acc: 0.527 Test Loss: 1.150 Test Acc: 0.527
Validation loss decreased (-0.432419 --> -0.527016).  Saving model ...
Epoch: 6 cost time: 3.9679040908813477
Epoch: 6, Steps: 10 | Train Loss: 0.561 Vali Loss: 1.255 Vali Acc: 0.486 Test Loss: 1.255 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.185796737670898
Epoch: 7, Steps: 10 | Train Loss: 0.463 Vali Loss: 1.216 Vali Acc: 0.527 Test Loss: 1.216 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.736891508102417
Epoch: 8, Steps: 10 | Train Loss: 0.237 Vali Loss: 1.316 Vali Acc: 0.527 Test Loss: 1.316 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.8528757095336914
Epoch: 9, Steps: 10 | Train Loss: 0.165 Vali Loss: 1.253 Vali Acc: 0.527 Test Loss: 1.253 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.7811007499694824
Epoch: 10, Steps: 10 | Train Loss: 0.105 Vali Loss: 1.350 Vali Acc: 0.595 Test Loss: 1.350 Test Acc: 0.595
Validation loss decreased (-0.527016 --> -0.594581).  Saving model ...
Epoch: 11 cost time: 2.6134607791900635
Epoch: 11, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.644 Vali Acc: 0.581 Test Loss: 1.644 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.287058115005493
Epoch: 12, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.532 Vali Acc: 0.554 Test Loss: 1.532 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.6355841159820557
Epoch: 13, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.519 Vali Acc: 0.459 Test Loss: 1.519 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.8959410190582275
Epoch: 14, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.683 Vali Acc: 0.500 Test Loss: 1.683 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.0132596492767334
Epoch: 15, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.752 Vali Acc: 0.500 Test Loss: 1.752 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.341702461242676
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.737 Vali Acc: 0.527 Test Loss: 1.737 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.082206726074219
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.739 Vali Acc: 0.500 Test Loss: 1.739 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.2666783332824707
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.761 Vali Acc: 0.486 Test Loss: 1.761 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.0006067752838135
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.723 Vali Acc: 0.514 Test Loss: 1.723 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.54878830909729
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.739 Vali Acc: 0.514 Test Loss: 1.739 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 14439488
model size : 60.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.188553094863892
Epoch: 1, Steps: 10 | Train Loss: 1.493 Vali Loss: 1.806 Vali Acc: 0.257 Test Loss: 1.806 Test Acc: 0.257
Validation loss decreased (inf --> -0.256739).  Saving model ...
Epoch: 2 cost time: 3.3381426334381104
Epoch: 2, Steps: 10 | Train Loss: 1.350 Vali Loss: 1.414 Vali Acc: 0.473 Test Loss: 1.414 Test Acc: 0.473
Validation loss decreased (-0.256739 --> -0.472959).  Saving model ...
Epoch: 3 cost time: 3.7841551303863525
Epoch: 3, Steps: 10 | Train Loss: 1.205 Vali Loss: 1.266 Vali Acc: 0.459 Test Loss: 1.266 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.133662223815918
Epoch: 4, Steps: 10 | Train Loss: 1.042 Vali Loss: 1.207 Vali Acc: 0.486 Test Loss: 1.207 Test Acc: 0.486
Validation loss decreased (-0.472959 --> -0.486474).  Saving model ...
Epoch: 5 cost time: 3.2854959964752197
Epoch: 5, Steps: 10 | Train Loss: 0.815 Vali Loss: 1.648 Vali Acc: 0.365 Test Loss: 1.648 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.687382698059082
Epoch: 6, Steps: 10 | Train Loss: 0.789 Vali Loss: 1.504 Vali Acc: 0.459 Test Loss: 1.504 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.3094942569732666
Epoch: 7, Steps: 10 | Train Loss: 0.545 Vali Loss: 1.425 Vali Acc: 0.514 Test Loss: 1.425 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513499).  Saving model ...
Epoch: 8 cost time: 3.402710437774658
Epoch: 8, Steps: 10 | Train Loss: 0.325 Vali Loss: 1.209 Vali Acc: 0.541 Test Loss: 1.209 Test Acc: 0.541
Validation loss decreased (-0.513499 --> -0.540528).  Saving model ...
Epoch: 9 cost time: 2.627802848815918
Epoch: 9, Steps: 10 | Train Loss: 0.271 Vali Loss: 1.901 Vali Acc: 0.486 Test Loss: 1.901 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.8569743633270264
Epoch: 10, Steps: 10 | Train Loss: 0.147 Vali Loss: 1.513 Vali Acc: 0.500 Test Loss: 1.513 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.9649362564086914
Epoch: 11, Steps: 10 | Train Loss: 0.080 Vali Loss: 1.359 Vali Acc: 0.568 Test Loss: 1.359 Test Acc: 0.568
Validation loss decreased (-0.540528 --> -0.567554).  Saving model ...
Epoch: 12 cost time: 2.947077989578247
Epoch: 12, Steps: 10 | Train Loss: 0.073 Vali Loss: 1.576 Vali Acc: 0.527 Test Loss: 1.576 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.279322147369385
Epoch: 13, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.566 Vali Acc: 0.527 Test Loss: 1.566 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.83686900138855
Epoch: 14, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.774 Vali Acc: 0.568 Test Loss: 1.774 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.660555601119995
Epoch: 15, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.541 Vali Acc: 0.595 Test Loss: 1.541 Test Acc: 0.595
Validation loss decreased (-0.567554 --> -0.594579).  Saving model ...
Epoch: 16 cost time: 4.064654588699341
Epoch: 16, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.683 Vali Acc: 0.622 Test Loss: 1.683 Test Acc: 0.622
Validation loss decreased (-0.594579 --> -0.621605).  Saving model ...
Epoch: 17 cost time: 3.2744760513305664
Epoch: 17, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.786 Vali Acc: 0.541 Test Loss: 1.786 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.8683812618255615
Epoch: 18, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.955 Vali Acc: 0.568 Test Loss: 1.955 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.699763059616089
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.889 Vali Acc: 0.581 Test Loss: 1.889 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.727348804473877
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.758 Vali Acc: 0.554 Test Loss: 1.758 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.646336793899536
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.762 Vali Acc: 0.581 Test Loss: 1.762 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.906653642654419
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.874 Vali Acc: 0.581 Test Loss: 1.874 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.4607081413269043
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.860 Vali Acc: 0.541 Test Loss: 1.860 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.588146448135376
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.823 Vali Acc: 0.527 Test Loss: 1.823 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.6936886310577393
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.811 Vali Acc: 0.527 Test Loss: 1.811 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.860126256942749
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.811 Vali Acc: 0.527 Test Loss: 1.811 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 14422848
model size : 60.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.001188039779663
Epoch: 1, Steps: 10 | Train Loss: 1.483 Vali Loss: 1.340 Vali Acc: 0.378 Test Loss: 1.340 Test Acc: 0.378
Validation loss decreased (inf --> -0.378365).  Saving model ...
Epoch: 2 cost time: 3.5192742347717285
Epoch: 2, Steps: 10 | Train Loss: 1.421 Vali Loss: 1.287 Vali Acc: 0.405 Test Loss: 1.287 Test Acc: 0.405
Validation loss decreased (-0.378365 --> -0.405393).  Saving model ...
Epoch: 3 cost time: 2.462578535079956
Epoch: 3, Steps: 10 | Train Loss: 1.186 Vali Loss: 1.301 Vali Acc: 0.365 Test Loss: 1.301 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.4322609901428223
Epoch: 4, Steps: 10 | Train Loss: 1.088 Vali Loss: 1.303 Vali Acc: 0.459 Test Loss: 1.303 Test Acc: 0.459
Validation loss decreased (-0.405393 --> -0.459446).  Saving model ...
Epoch: 5 cost time: 3.53645396232605
Epoch: 5, Steps: 10 | Train Loss: 0.832 Vali Loss: 1.655 Vali Acc: 0.284 Test Loss: 1.655 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.459411859512329
Epoch: 6, Steps: 10 | Train Loss: 0.734 Vali Loss: 1.307 Vali Acc: 0.446 Test Loss: 1.307 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.9113926887512207
Epoch: 7, Steps: 10 | Train Loss: 0.416 Vali Loss: 1.214 Vali Acc: 0.514 Test Loss: 1.214 Test Acc: 0.514
Validation loss decreased (-0.459446 --> -0.513501).  Saving model ...
Epoch: 8 cost time: 3.0094847679138184
Epoch: 8, Steps: 10 | Train Loss: 0.307 Vali Loss: 1.518 Vali Acc: 0.405 Test Loss: 1.518 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.596372365951538
Epoch: 9, Steps: 10 | Train Loss: 0.193 Vali Loss: 1.695 Vali Acc: 0.459 Test Loss: 1.695 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.544562339782715
Epoch: 10, Steps: 10 | Train Loss: 0.217 Vali Loss: 1.696 Vali Acc: 0.527 Test Loss: 1.696 Test Acc: 0.527
Validation loss decreased (-0.513501 --> -0.527010).  Saving model ...
Epoch: 11 cost time: 3.6705594062805176
Epoch: 11, Steps: 10 | Train Loss: 0.098 Vali Loss: 1.778 Vali Acc: 0.500 Test Loss: 1.778 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.048552989959717
Epoch: 12, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.644 Vali Acc: 0.554 Test Loss: 1.644 Test Acc: 0.554
Validation loss decreased (-0.527010 --> -0.554038).  Saving model ...
Epoch: 13 cost time: 3.335583448410034
Epoch: 13, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.734 Vali Acc: 0.500 Test Loss: 1.734 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.0544745922088623
Epoch: 14, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.742 Vali Acc: 0.568 Test Loss: 1.742 Test Acc: 0.568
Validation loss decreased (-0.554038 --> -0.567550).  Saving model ...
Epoch: 15 cost time: 4.102053165435791
Epoch: 15, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.802 Vali Acc: 0.500 Test Loss: 1.802 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.7523441314697266
Epoch: 16, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.769 Vali Acc: 0.541 Test Loss: 1.769 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.926161289215088
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.814 Vali Acc: 0.527 Test Loss: 1.814 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.7129387855529785
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.721 Vali Acc: 0.527 Test Loss: 1.721 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.5838019847869873
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.707 Vali Acc: 0.568 Test Loss: 1.707 Test Acc: 0.568
Validation loss decreased (-0.567550 --> -0.567550).  Saving model ...
Epoch: 20 cost time: 3.419187068939209
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.782 Vali Acc: 0.568 Test Loss: 1.782 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.5843913555145264
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.664 Vali Acc: 0.554 Test Loss: 1.664 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.4157605171203613
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.660 Vali Acc: 0.568 Test Loss: 1.660 Test Acc: 0.568
Validation loss decreased (-0.567550 --> -0.567551).  Saving model ...
Epoch: 23 cost time: 3.2000184059143066
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.698 Vali Acc: 0.554 Test Loss: 1.698 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.7144672870635986
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.725 Vali Acc: 0.568 Test Loss: 1.725 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.232360601425171
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.739 Vali Acc: 0.581 Test Loss: 1.739 Test Acc: 0.581
Validation loss decreased (-0.567551 --> -0.581064).  Saving model ...
Epoch: 26 cost time: 3.5430097579956055
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.742 Vali Acc: 0.541 Test Loss: 1.742 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.418811321258545
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.744 Vali Acc: 0.554 Test Loss: 1.744 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.575174570083618
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.755 Vali Acc: 0.554 Test Loss: 1.755 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.9786696434020996
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.766 Vali Acc: 0.554 Test Loss: 1.766 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.759798526763916
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.771 Vali Acc: 0.554 Test Loss: 1.771 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.266894578933716
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.784 Vali Acc: 0.568 Test Loss: 1.784 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 3.5375845432281494
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.794 Vali Acc: 0.568 Test Loss: 1.794 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 3.4096763134002686
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.801 Vali Acc: 0.568 Test Loss: 1.801 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 3.277794599533081
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.802 Vali Acc: 0.554 Test Loss: 1.802 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.9938268661499023
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.808 Vali Acc: 0.554 Test Loss: 1.808 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 14406208
model size : 60.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.134227752685547
Epoch: 1, Steps: 10 | Train Loss: 1.500 Vali Loss: 1.340 Vali Acc: 0.378 Test Loss: 1.340 Test Acc: 0.378
Validation loss decreased (inf --> -0.378365).  Saving model ...
Epoch: 2 cost time: 3.112058401107788
Epoch: 2, Steps: 10 | Train Loss: 1.326 Vali Loss: 1.452 Vali Acc: 0.216 Test Loss: 1.452 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.065601110458374
Epoch: 3, Steps: 10 | Train Loss: 1.210 Vali Loss: 1.329 Vali Acc: 0.378 Test Loss: 1.329 Test Acc: 0.378
Validation loss decreased (-0.378365 --> -0.378365).  Saving model ...
Epoch: 4 cost time: 4.433305978775024
Epoch: 4, Steps: 10 | Train Loss: 1.075 Vali Loss: 1.209 Vali Acc: 0.486 Test Loss: 1.209 Test Acc: 0.486
Validation loss decreased (-0.378365 --> -0.486474).  Saving model ...
Epoch: 5 cost time: 3.284780740737915
Epoch: 5, Steps: 10 | Train Loss: 0.904 Vali Loss: 1.258 Vali Acc: 0.486 Test Loss: 1.258 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.4408490657806396
Epoch: 6, Steps: 10 | Train Loss: 0.671 Vali Loss: 1.159 Vali Acc: 0.514 Test Loss: 1.159 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513502).  Saving model ...
Epoch: 7 cost time: 3.349442720413208
Epoch: 7, Steps: 10 | Train Loss: 0.457 Vali Loss: 1.800 Vali Acc: 0.459 Test Loss: 1.800 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.682461977005005
Epoch: 8, Steps: 10 | Train Loss: 0.514 Vali Loss: 1.186 Vali Acc: 0.554 Test Loss: 1.186 Test Acc: 0.554
Validation loss decreased (-0.513502 --> -0.554042).  Saving model ...
Epoch: 9 cost time: 3.7755959033966064
Epoch: 9, Steps: 10 | Train Loss: 0.253 Vali Loss: 1.307 Vali Acc: 0.581 Test Loss: 1.307 Test Acc: 0.581
Validation loss decreased (-0.554042 --> -0.581068).  Saving model ...
Epoch: 10 cost time: 3.629436731338501
Epoch: 10, Steps: 10 | Train Loss: 0.135 Vali Loss: 1.301 Vali Acc: 0.541 Test Loss: 1.301 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.18827223777771
Epoch: 11, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.243 Vali Acc: 0.622 Test Loss: 1.243 Test Acc: 0.622
Validation loss decreased (-0.581068 --> -0.621609).  Saving model ...
Epoch: 12 cost time: 4.249274253845215
Epoch: 12, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.501 Vali Acc: 0.486 Test Loss: 1.501 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.745177984237671
Epoch: 13, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.668 Vali Acc: 0.486 Test Loss: 1.668 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.7042782306671143
Epoch: 14, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.770 Vali Acc: 0.514 Test Loss: 1.770 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.955036163330078
Epoch: 15, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.729 Vali Acc: 0.554 Test Loss: 1.729 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.169824123382568
Epoch: 16, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.674 Vali Acc: 0.568 Test Loss: 1.674 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.008077621459961
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.843 Vali Acc: 0.514 Test Loss: 1.843 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.394570827484131
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.768 Vali Acc: 0.541 Test Loss: 1.768 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.151696681976318
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.816 Vali Acc: 0.527 Test Loss: 1.816 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.676029682159424
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.974 Vali Acc: 0.486 Test Loss: 1.974 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.8436012268066406
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.883 Vali Acc: 0.500 Test Loss: 1.883 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 12092224
model size : 51.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.285309076309204
Epoch: 1, Steps: 10 | Train Loss: 1.493 Vali Loss: 1.463 Vali Acc: 0.216 Test Loss: 1.463 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 3.051126718521118
Epoch: 2, Steps: 10 | Train Loss: 1.373 Vali Loss: 1.700 Vali Acc: 0.243 Test Loss: 1.700 Test Acc: 0.243
Validation loss decreased (-0.216202 --> -0.243226).  Saving model ...
Epoch: 3 cost time: 2.3175342082977295
Epoch: 3, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.479 Vali Acc: 0.338 Test Loss: 1.479 Test Acc: 0.338
Validation loss decreased (-0.243226 --> -0.337823).  Saving model ...
Epoch: 4 cost time: 1.8350558280944824
Epoch: 4, Steps: 10 | Train Loss: 1.185 Vali Loss: 1.217 Vali Acc: 0.405 Test Loss: 1.217 Test Acc: 0.405
Validation loss decreased (-0.337823 --> -0.405393).  Saving model ...
Epoch: 5 cost time: 2.276411771774292
Epoch: 5, Steps: 10 | Train Loss: 0.869 Vali Loss: 1.125 Vali Acc: 0.446 Test Loss: 1.125 Test Acc: 0.446
Validation loss decreased (-0.405393 --> -0.445935).  Saving model ...
Epoch: 6 cost time: 2.0635547637939453
Epoch: 6, Steps: 10 | Train Loss: 0.735 Vali Loss: 1.356 Vali Acc: 0.473 Test Loss: 1.356 Test Acc: 0.473
Validation loss decreased (-0.445935 --> -0.472959).  Saving model ...
Epoch: 7 cost time: 2.7881593704223633
Epoch: 7, Steps: 10 | Train Loss: 0.649 Vali Loss: 1.821 Vali Acc: 0.432 Test Loss: 1.821 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.599579095840454
Epoch: 8, Steps: 10 | Train Loss: 0.568 Vali Loss: 1.296 Vali Acc: 0.514 Test Loss: 1.296 Test Acc: 0.514
Validation loss decreased (-0.472959 --> -0.513501).  Saving model ...
Epoch: 9 cost time: 3.9254724979400635
Epoch: 9, Steps: 10 | Train Loss: 0.234 Vali Loss: 1.337 Vali Acc: 0.568 Test Loss: 1.337 Test Acc: 0.568
Validation loss decreased (-0.513501 --> -0.567554).  Saving model ...
Epoch: 10 cost time: 3.821808338165283
Epoch: 10, Steps: 10 | Train Loss: 0.133 Vali Loss: 1.392 Vali Acc: 0.568 Test Loss: 1.392 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.9059579372406006
Epoch: 11, Steps: 10 | Train Loss: 0.098 Vali Loss: 1.371 Vali Acc: 0.527 Test Loss: 1.371 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.367034435272217
Epoch: 12, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.467 Vali Acc: 0.514 Test Loss: 1.467 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.9107396602630615
Epoch: 13, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.700 Vali Acc: 0.514 Test Loss: 1.700 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.5947928428649902
Epoch: 14, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.872 Vali Acc: 0.527 Test Loss: 1.872 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.480051279067993
Epoch: 15, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.760 Vali Acc: 0.554 Test Loss: 1.760 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.2375166416168213
Epoch: 16, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.704 Vali Acc: 0.581 Test Loss: 1.704 Test Acc: 0.581
Validation loss decreased (-0.567554 --> -0.581064).  Saving model ...
Epoch: 17 cost time: 3.9922966957092285
Epoch: 17, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.755 Vali Acc: 0.554 Test Loss: 1.755 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.703216075897217
Epoch: 18, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.596 Vali Acc: 0.568 Test Loss: 1.596 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.7133145332336426
Epoch: 19, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.899 Vali Acc: 0.554 Test Loss: 1.899 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.558609962463379
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.722 Vali Acc: 0.595 Test Loss: 1.722 Test Acc: 0.595
Validation loss decreased (-0.581064 --> -0.594577).  Saving model ...
Epoch: 21 cost time: 3.1312246322631836
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.926 Vali Acc: 0.541 Test Loss: 1.926 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.4846935272216797
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.690 Vali Acc: 0.595 Test Loss: 1.690 Test Acc: 0.595
Validation loss decreased (-0.594577 --> -0.594578).  Saving model ...
Epoch: 23 cost time: 2.2551591396331787
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.031 Vali Acc: 0.554 Test Loss: 2.031 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.34123158454895
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.883 Vali Acc: 0.541 Test Loss: 1.883 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.5854873657226562
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.063 Vali Acc: 0.554 Test Loss: 2.063 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.7819929122924805
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.830 Vali Acc: 0.581 Test Loss: 1.830 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.052706003189087
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.808 Vali Acc: 0.581 Test Loss: 1.808 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.1171329021453857
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.851 Vali Acc: 0.568 Test Loss: 1.851 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.7668726444244385
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.880 Vali Acc: 0.568 Test Loss: 1.880 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.6190919876098633
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.895 Vali Acc: 0.568 Test Loss: 1.895 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 3.2995216846466064
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.898 Vali Acc: 0.581 Test Loss: 1.898 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.8923981189727783
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.899 Vali Acc: 0.581 Test Loss: 1.899 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 12075584
model size : 51.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.380571126937866
Epoch: 1, Steps: 10 | Train Loss: 1.512 Vali Loss: 1.585 Vali Acc: 0.216 Test Loss: 1.585 Test Acc: 0.216
Validation loss decreased (inf --> -0.216200).  Saving model ...
Epoch: 2 cost time: 3.2948801517486572
Epoch: 2, Steps: 10 | Train Loss: 1.447 Vali Loss: 1.579 Vali Acc: 0.257 Test Loss: 1.579 Test Acc: 0.257
Validation loss decreased (-0.216200 --> -0.256741).  Saving model ...
Epoch: 3 cost time: 3.4913222789764404
Epoch: 3, Steps: 10 | Train Loss: 1.297 Vali Loss: 1.179 Vali Acc: 0.446 Test Loss: 1.179 Test Acc: 0.446
Validation loss decreased (-0.256741 --> -0.445934).  Saving model ...
Epoch: 4 cost time: 3.3776655197143555
Epoch: 4, Steps: 10 | Train Loss: 1.090 Vali Loss: 1.245 Vali Acc: 0.446 Test Loss: 1.245 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.7736904621124268
Epoch: 5, Steps: 10 | Train Loss: 0.865 Vali Loss: 1.295 Vali Acc: 0.486 Test Loss: 1.295 Test Acc: 0.486
Validation loss decreased (-0.445934 --> -0.486474).  Saving model ...
Epoch: 6 cost time: 3.5961716175079346
Epoch: 6, Steps: 10 | Train Loss: 0.655 Vali Loss: 1.213 Vali Acc: 0.595 Test Loss: 1.213 Test Acc: 0.595
Validation loss decreased (-0.486474 --> -0.594582).  Saving model ...
Epoch: 7 cost time: 3.3126490116119385
Epoch: 7, Steps: 10 | Train Loss: 0.478 Vali Loss: 1.241 Vali Acc: 0.459 Test Loss: 1.241 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.095465660095215
Epoch: 8, Steps: 10 | Train Loss: 0.263 Vali Loss: 1.380 Vali Acc: 0.459 Test Loss: 1.380 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.865217447280884
Epoch: 9, Steps: 10 | Train Loss: 0.281 Vali Loss: 1.554 Vali Acc: 0.486 Test Loss: 1.554 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.200063705444336
Epoch: 10, Steps: 10 | Train Loss: 0.197 Vali Loss: 1.418 Vali Acc: 0.527 Test Loss: 1.418 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.765514850616455
Epoch: 11, Steps: 10 | Train Loss: 0.079 Vali Loss: 1.454 Vali Acc: 0.486 Test Loss: 1.454 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.877173662185669
Epoch: 12, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.617 Vali Acc: 0.486 Test Loss: 1.617 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.2761197090148926
Epoch: 13, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.661 Vali Acc: 0.500 Test Loss: 1.661 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.0466437339782715
Epoch: 14, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.815 Vali Acc: 0.527 Test Loss: 1.815 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.7160680294036865
Epoch: 15, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.987 Vali Acc: 0.500 Test Loss: 1.987 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.7656967639923096
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.794 Vali Acc: 0.541 Test Loss: 1.794 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 12058944
model size : 51.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.12977933883667
Epoch: 1, Steps: 10 | Train Loss: 1.526 Vali Loss: 1.648 Vali Acc: 0.203 Test Loss: 1.648 Test Acc: 0.203
Validation loss decreased (inf --> -0.202686).  Saving model ...
Epoch: 2 cost time: 2.488593816757202
Epoch: 2, Steps: 10 | Train Loss: 1.486 Vali Loss: 1.492 Vali Acc: 0.270 Test Loss: 1.492 Test Acc: 0.270
Validation loss decreased (-0.202686 --> -0.270255).  Saving model ...
Epoch: 3 cost time: 3.0754380226135254
Epoch: 3, Steps: 10 | Train Loss: 1.354 Vali Loss: 1.672 Vali Acc: 0.216 Test Loss: 1.672 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.2228963375091553
Epoch: 4, Steps: 10 | Train Loss: 1.202 Vali Loss: 1.276 Vali Acc: 0.459 Test Loss: 1.276 Test Acc: 0.459
Validation loss decreased (-0.270255 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 2.5230281352996826
Epoch: 5, Steps: 10 | Train Loss: 0.866 Vali Loss: 1.173 Vali Acc: 0.514 Test Loss: 1.173 Test Acc: 0.514
Validation loss decreased (-0.459447 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 3.2592203617095947
Epoch: 6, Steps: 10 | Train Loss: 0.693 Vali Loss: 1.177 Vali Acc: 0.446 Test Loss: 1.177 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.4766488075256348
Epoch: 7, Steps: 10 | Train Loss: 0.392 Vali Loss: 1.176 Vali Acc: 0.527 Test Loss: 1.176 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527015).  Saving model ...
Epoch: 8 cost time: 3.1350951194763184
Epoch: 8, Steps: 10 | Train Loss: 0.330 Vali Loss: 1.577 Vali Acc: 0.419 Test Loss: 1.577 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.0381410121917725
Epoch: 9, Steps: 10 | Train Loss: 0.173 Vali Loss: 1.452 Vali Acc: 0.500 Test Loss: 1.452 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.0374605655670166
Epoch: 10, Steps: 10 | Train Loss: 0.125 Vali Loss: 1.548 Vali Acc: 0.500 Test Loss: 1.548 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.4275646209716797
Epoch: 11, Steps: 10 | Train Loss: 0.086 Vali Loss: 1.394 Vali Acc: 0.595 Test Loss: 1.394 Test Acc: 0.595
Validation loss decreased (-0.527015 --> -0.594581).  Saving model ...
Epoch: 12 cost time: 2.9430229663848877
Epoch: 12, Steps: 10 | Train Loss: 0.061 Vali Loss: 1.553 Vali Acc: 0.554 Test Loss: 1.553 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.306443929672241
Epoch: 13, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.832 Vali Acc: 0.527 Test Loss: 1.832 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.6821553707122803
Epoch: 14, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.540 Vali Acc: 0.527 Test Loss: 1.540 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.965543270111084
Epoch: 15, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.640 Vali Acc: 0.581 Test Loss: 1.640 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.96270751953125
Epoch: 16, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.763 Vali Acc: 0.527 Test Loss: 1.763 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.987982749938965
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.540 Vali Acc: 0.581 Test Loss: 1.540 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.9230287075042725
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.593 Vali Acc: 0.554 Test Loss: 1.593 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.089599132537842
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.555 Vali Acc: 0.554 Test Loss: 1.555 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.2101571559906006
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.510 Vali Acc: 0.568 Test Loss: 1.510 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.1853644847869873
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.577 Vali Acc: 0.554 Test Loss: 1.577 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 12042304
model size : 51.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.4917151927948
Epoch: 1, Steps: 10 | Train Loss: 1.460 Vali Loss: 1.408 Vali Acc: 0.365 Test Loss: 1.408 Test Acc: 0.365
Validation loss decreased (inf --> -0.364851).  Saving model ...
Epoch: 2 cost time: 4.438003063201904
Epoch: 2, Steps: 10 | Train Loss: 1.436 Vali Loss: 1.522 Vali Acc: 0.203 Test Loss: 1.522 Test Acc: 0.203
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.94728946685791
Epoch: 3, Steps: 10 | Train Loss: 1.409 Vali Loss: 2.152 Vali Acc: 0.203 Test Loss: 2.152 Test Acc: 0.203
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.7361860275268555
Epoch: 4, Steps: 10 | Train Loss: 1.205 Vali Loss: 1.316 Vali Acc: 0.351 Test Loss: 1.316 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.278749942779541
Epoch: 5, Steps: 10 | Train Loss: 0.852 Vali Loss: 1.197 Vali Acc: 0.473 Test Loss: 1.197 Test Acc: 0.473
Validation loss decreased (-0.364851 --> -0.472961).  Saving model ...
Epoch: 6 cost time: 2.6706454753875732
Epoch: 6, Steps: 10 | Train Loss: 0.667 Vali Loss: 1.208 Vali Acc: 0.459 Test Loss: 1.208 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.873136043548584
Epoch: 7, Steps: 10 | Train Loss: 0.480 Vali Loss: 1.222 Vali Acc: 0.568 Test Loss: 1.222 Test Acc: 0.568
Validation loss decreased (-0.472961 --> -0.567555).  Saving model ...
Epoch: 8 cost time: 2.69041109085083
Epoch: 8, Steps: 10 | Train Loss: 0.321 Vali Loss: 1.342 Vali Acc: 0.486 Test Loss: 1.342 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.095515727996826
Epoch: 9, Steps: 10 | Train Loss: 0.176 Vali Loss: 1.202 Vali Acc: 0.581 Test Loss: 1.202 Test Acc: 0.581
Validation loss decreased (-0.567555 --> -0.581069).  Saving model ...
Epoch: 10 cost time: 3.9353201389312744
Epoch: 10, Steps: 10 | Train Loss: 0.116 Vali Loss: 1.733 Vali Acc: 0.527 Test Loss: 1.733 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.9713711738586426
Epoch: 11, Steps: 10 | Train Loss: 0.105 Vali Loss: 1.550 Vali Acc: 0.527 Test Loss: 1.550 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.9564688205718994
Epoch: 12, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.489 Vali Acc: 0.568 Test Loss: 1.489 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.8867199420928955
Epoch: 13, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.668 Vali Acc: 0.527 Test Loss: 1.668 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.9560184478759766
Epoch: 14, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.767 Vali Acc: 0.500 Test Loss: 1.767 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.8060522079467773
Epoch: 15, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.790 Vali Acc: 0.541 Test Loss: 1.790 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.07184624671936
Epoch: 16, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.940 Vali Acc: 0.568 Test Loss: 1.940 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.2242929935455322
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.828 Vali Acc: 0.527 Test Loss: 1.828 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.6424496173858643
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 2.426 Vali Acc: 0.514 Test Loss: 2.426 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.7128047943115234
Epoch: 19, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.986 Vali Acc: 0.514 Test Loss: 1.986 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 10910272
model size : 46.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.707061290740967
Epoch: 1, Steps: 10 | Train Loss: 1.473 Vali Loss: 1.388 Vali Acc: 0.257 Test Loss: 1.388 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 2.238013744354248
Epoch: 2, Steps: 10 | Train Loss: 1.339 Vali Loss: 1.436 Vali Acc: 0.243 Test Loss: 1.436 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.560032844543457
Epoch: 3, Steps: 10 | Train Loss: 1.228 Vali Loss: 1.215 Vali Acc: 0.419 Test Loss: 1.215 Test Acc: 0.419
Validation loss decreased (-0.256743 --> -0.418907).  Saving model ...
Epoch: 4 cost time: 3.153502941131592
Epoch: 4, Steps: 10 | Train Loss: 1.105 Vali Loss: 1.342 Vali Acc: 0.446 Test Loss: 1.342 Test Acc: 0.446
Validation loss decreased (-0.418907 --> -0.445933).  Saving model ...
Epoch: 5 cost time: 3.462299108505249
Epoch: 5, Steps: 10 | Train Loss: 0.855 Vali Loss: 1.163 Vali Acc: 0.446 Test Loss: 1.163 Test Acc: 0.446
Validation loss decreased (-0.445933 --> -0.445934).  Saving model ...
Epoch: 6 cost time: 3.5128087997436523
Epoch: 6, Steps: 10 | Train Loss: 0.730 Vali Loss: 1.144 Vali Acc: 0.527 Test Loss: 1.144 Test Acc: 0.527
Validation loss decreased (-0.445934 --> -0.527016).  Saving model ...
Epoch: 7 cost time: 3.6876161098480225
Epoch: 7, Steps: 10 | Train Loss: 0.556 Vali Loss: 1.228 Vali Acc: 0.473 Test Loss: 1.228 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.012273788452148
Epoch: 8, Steps: 10 | Train Loss: 0.313 Vali Loss: 1.272 Vali Acc: 0.514 Test Loss: 1.272 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.5010921955108643
Epoch: 9, Steps: 10 | Train Loss: 0.197 Vali Loss: 1.415 Vali Acc: 0.459 Test Loss: 1.415 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.5500192642211914
Epoch: 10, Steps: 10 | Train Loss: 0.125 Vali Loss: 1.398 Vali Acc: 0.581 Test Loss: 1.398 Test Acc: 0.581
Validation loss decreased (-0.527016 --> -0.581067).  Saving model ...
Epoch: 11 cost time: 3.3172242641448975
Epoch: 11, Steps: 10 | Train Loss: 0.071 Vali Loss: 1.520 Vali Acc: 0.581 Test Loss: 1.520 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.886847734451294
Epoch: 12, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.680 Vali Acc: 0.527 Test Loss: 1.680 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.819020986557007
Epoch: 13, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.688 Vali Acc: 0.581 Test Loss: 1.688 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.2715396881103516
Epoch: 14, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.769 Vali Acc: 0.541 Test Loss: 1.769 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.1636641025543213
Epoch: 15, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.817 Vali Acc: 0.568 Test Loss: 1.817 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.6102774143218994
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.872 Vali Acc: 0.568 Test Loss: 1.872 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.60320782661438
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.835 Vali Acc: 0.541 Test Loss: 1.835 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.800382375717163
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.922 Vali Acc: 0.541 Test Loss: 1.922 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.7077975273132324
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.840 Vali Acc: 0.527 Test Loss: 1.840 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.7631306648254395
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.814 Vali Acc: 0.541 Test Loss: 1.814 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 10893632
model size : 46.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.76816987991333
Epoch: 1, Steps: 10 | Train Loss: 1.513 Vali Loss: 1.457 Vali Acc: 0.176 Test Loss: 1.457 Test Acc: 0.176
Validation loss decreased (inf --> -0.175661).  Saving model ...
Epoch: 2 cost time: 3.52542781829834
Epoch: 2, Steps: 10 | Train Loss: 1.511 Vali Loss: 1.618 Vali Acc: 0.203 Test Loss: 1.618 Test Acc: 0.203
Validation loss decreased (-0.175661 --> -0.202687).  Saving model ...
Epoch: 3 cost time: 2.8771369457244873
Epoch: 3, Steps: 10 | Train Loss: 1.428 Vali Loss: 1.478 Vali Acc: 0.243 Test Loss: 1.478 Test Acc: 0.243
Validation loss decreased (-0.202687 --> -0.243228).  Saving model ...
Epoch: 4 cost time: 3.2620344161987305
Epoch: 4, Steps: 10 | Train Loss: 1.183 Vali Loss: 1.634 Vali Acc: 0.338 Test Loss: 1.634 Test Acc: 0.338
Validation loss decreased (-0.243228 --> -0.337822).  Saving model ...
Epoch: 5 cost time: 3.4105722904205322
Epoch: 5, Steps: 10 | Train Loss: 1.000 Vali Loss: 1.333 Vali Acc: 0.432 Test Loss: 1.333 Test Acc: 0.432
Validation loss decreased (-0.337822 --> -0.432419).  Saving model ...
Epoch: 6 cost time: 3.0253021717071533
Epoch: 6, Steps: 10 | Train Loss: 0.730 Vali Loss: 1.258 Vali Acc: 0.446 Test Loss: 1.258 Test Acc: 0.446
Validation loss decreased (-0.432419 --> -0.445933).  Saving model ...
Epoch: 7 cost time: 2.9730517864227295
Epoch: 7, Steps: 10 | Train Loss: 0.602 Vali Loss: 1.553 Vali Acc: 0.419 Test Loss: 1.553 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.246859073638916
Epoch: 8, Steps: 10 | Train Loss: 0.492 Vali Loss: 1.470 Vali Acc: 0.432 Test Loss: 1.470 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.121859550476074
Epoch: 9, Steps: 10 | Train Loss: 0.345 Vali Loss: 1.430 Vali Acc: 0.527 Test Loss: 1.430 Test Acc: 0.527
Validation loss decreased (-0.445933 --> -0.527013).  Saving model ...
Epoch: 10 cost time: 3.4188971519470215
Epoch: 10, Steps: 10 | Train Loss: 0.211 Vali Loss: 1.359 Vali Acc: 0.473 Test Loss: 1.359 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.1889421939849854
Epoch: 11, Steps: 10 | Train Loss: 0.086 Vali Loss: 1.599 Vali Acc: 0.541 Test Loss: 1.599 Test Acc: 0.541
Validation loss decreased (-0.527013 --> -0.540525).  Saving model ...
Epoch: 12 cost time: 3.46087646484375
Epoch: 12, Steps: 10 | Train Loss: 0.094 Vali Loss: 1.726 Vali Acc: 0.541 Test Loss: 1.726 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.5903024673461914
Epoch: 13, Steps: 10 | Train Loss: 0.079 Vali Loss: 1.579 Vali Acc: 0.554 Test Loss: 1.579 Test Acc: 0.554
Validation loss decreased (-0.540525 --> -0.554038).  Saving model ...
Epoch: 14 cost time: 3.746124267578125
Epoch: 14, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.829 Vali Acc: 0.541 Test Loss: 1.829 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.870197296142578
Epoch: 15, Steps: 10 | Train Loss: 0.035 Vali Loss: 2.140 Vali Acc: 0.514 Test Loss: 2.140 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.268383026123047
Epoch: 16, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.845 Vali Acc: 0.500 Test Loss: 1.845 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.6925861835479736
Epoch: 17, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.966 Vali Acc: 0.514 Test Loss: 1.966 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.42467999458313
Epoch: 18, Steps: 10 | Train Loss: 0.025 Vali Loss: 2.070 Vali Acc: 0.446 Test Loss: 2.070 Test Acc: 0.446
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.263465166091919
Epoch: 19, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.911 Vali Acc: 0.568 Test Loss: 1.911 Test Acc: 0.568
Validation loss decreased (-0.554038 --> -0.567548).  Saving model ...
Epoch: 20 cost time: 3.027209997177124
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.826 Vali Acc: 0.554 Test Loss: 1.826 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.3054189682006836
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.779 Vali Acc: 0.568 Test Loss: 1.779 Test Acc: 0.568
Validation loss decreased (-0.567548 --> -0.567550).  Saving model ...
Epoch: 22 cost time: 3.5438618659973145
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.885 Vali Acc: 0.554 Test Loss: 1.885 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.8924076557159424
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.919 Vali Acc: 0.581 Test Loss: 1.919 Test Acc: 0.581
Validation loss decreased (-0.567550 --> -0.581062).  Saving model ...
Epoch: 24 cost time: 3.6987199783325195
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.866 Vali Acc: 0.581 Test Loss: 1.866 Test Acc: 0.581
Validation loss decreased (-0.581062 --> -0.581062).  Saving model ...
Epoch: 25 cost time: 3.3835599422454834
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.846 Vali Acc: 0.581 Test Loss: 1.846 Test Acc: 0.581
Validation loss decreased (-0.581062 --> -0.581063).  Saving model ...
Epoch: 26 cost time: 4.023049354553223
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.854 Vali Acc: 0.568 Test Loss: 1.854 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.5082340240478516
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.857 Vali Acc: 0.568 Test Loss: 1.857 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.4986395835876465
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.855 Vali Acc: 0.568 Test Loss: 1.855 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.3749001026153564
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.857 Vali Acc: 0.568 Test Loss: 1.857 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.812983989715576
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.854 Vali Acc: 0.568 Test Loss: 1.854 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.555901527404785
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.854 Vali Acc: 0.568 Test Loss: 1.854 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 3.2429394721984863
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.852 Vali Acc: 0.568 Test Loss: 1.852 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 3.46586012840271
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.854 Vali Acc: 0.568 Test Loss: 1.854 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 3.817756175994873
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.853 Vali Acc: 0.554 Test Loss: 1.853 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 3.4148666858673096
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.854 Vali Acc: 0.554 Test Loss: 1.854 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 10876992
model size : 46.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.4251017570495605
Epoch: 1, Steps: 10 | Train Loss: 1.604 Vali Loss: 1.345 Vali Acc: 0.392 Test Loss: 1.345 Test Acc: 0.392
Validation loss decreased (inf --> -0.391878).  Saving model ...
Epoch: 2 cost time: 2.813845634460449
Epoch: 2, Steps: 10 | Train Loss: 1.537 Vali Loss: 1.407 Vali Acc: 0.486 Test Loss: 1.407 Test Acc: 0.486
Validation loss decreased (-0.391878 --> -0.486472).  Saving model ...
Epoch: 3 cost time: 3.4504823684692383
Epoch: 3, Steps: 10 | Train Loss: 1.348 Vali Loss: 1.468 Vali Acc: 0.486 Test Loss: 1.468 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.9355998039245605
Epoch: 4, Steps: 10 | Train Loss: 1.271 Vali Loss: 2.195 Vali Acc: 0.311 Test Loss: 2.195 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.0703256130218506
Epoch: 5, Steps: 10 | Train Loss: 1.072 Vali Loss: 1.333 Vali Acc: 0.446 Test Loss: 1.333 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.968881130218506
Epoch: 6, Steps: 10 | Train Loss: 0.714 Vali Loss: 1.104 Vali Acc: 0.608 Test Loss: 1.104 Test Acc: 0.608
Validation loss decreased (-0.486472 --> -0.608097).  Saving model ...
Epoch: 7 cost time: 3.337829828262329
Epoch: 7, Steps: 10 | Train Loss: 0.591 Vali Loss: 1.149 Vali Acc: 0.568 Test Loss: 1.149 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.8678178787231445
Epoch: 8, Steps: 10 | Train Loss: 0.375 Vali Loss: 1.296 Vali Acc: 0.554 Test Loss: 1.296 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.5674517154693604
Epoch: 9, Steps: 10 | Train Loss: 0.313 Vali Loss: 1.311 Vali Acc: 0.554 Test Loss: 1.311 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.4265472888946533
Epoch: 10, Steps: 10 | Train Loss: 0.174 Vali Loss: 1.791 Vali Acc: 0.500 Test Loss: 1.791 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.409507989883423
Epoch: 11, Steps: 10 | Train Loss: 0.127 Vali Loss: 1.427 Vali Acc: 0.541 Test Loss: 1.427 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.480931520462036
Epoch: 12, Steps: 10 | Train Loss: 0.103 Vali Loss: 1.509 Vali Acc: 0.568 Test Loss: 1.509 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.228640556335449
Epoch: 13, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.818 Vali Acc: 0.527 Test Loss: 1.818 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.26011323928833
Epoch: 14, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.828 Vali Acc: 0.486 Test Loss: 1.828 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.511803388595581
Epoch: 15, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.819 Vali Acc: 0.459 Test Loss: 1.819 Test Acc: 0.459
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.188554286956787
Epoch: 16, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.621 Vali Acc: 0.635 Test Loss: 1.621 Test Acc: 0.635
Validation loss decreased (-0.608097 --> -0.635119).  Saving model ...
Epoch: 17 cost time: 3.0627071857452393
Epoch: 17, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.667 Vali Acc: 0.554 Test Loss: 1.667 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.897958755493164
Epoch: 18, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.935 Vali Acc: 0.527 Test Loss: 1.935 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.359104633331299
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.599 Vali Acc: 0.595 Test Loss: 1.599 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.374685287475586
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.606 Vali Acc: 0.622 Test Loss: 1.606 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.908991575241089
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.727 Vali Acc: 0.554 Test Loss: 1.727 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.5994505882263184
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.730 Vali Acc: 0.568 Test Loss: 1.730 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.138484001159668
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.678 Vali Acc: 0.581 Test Loss: 1.678 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.265803337097168
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.641 Vali Acc: 0.622 Test Loss: 1.641 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.597588300704956
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.633 Vali Acc: 0.635 Test Loss: 1.633 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.517918109893799
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.633 Vali Acc: 0.635 Test Loss: 1.633 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 10860352
model size : 46.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.71553111076355
Epoch: 1, Steps: 10 | Train Loss: 1.500 Vali Loss: 1.483 Vali Acc: 0.230 Test Loss: 1.483 Test Acc: 0.230
Validation loss decreased (inf --> -0.229715).  Saving model ...
Epoch: 2 cost time: 2.202528953552246
Epoch: 2, Steps: 10 | Train Loss: 1.390 Vali Loss: 1.335 Vali Acc: 0.311 Test Loss: 1.335 Test Acc: 0.311
Validation loss decreased (-0.229715 --> -0.310797).  Saving model ...
Epoch: 3 cost time: 1.8027124404907227
Epoch: 3, Steps: 10 | Train Loss: 1.273 Vali Loss: 1.479 Vali Acc: 0.297 Test Loss: 1.479 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9655356407165527
Epoch: 4, Steps: 10 | Train Loss: 1.214 Vali Loss: 1.164 Vali Acc: 0.446 Test Loss: 1.164 Test Acc: 0.446
Validation loss decreased (-0.310797 --> -0.445934).  Saving model ...
Epoch: 5 cost time: 2.770216703414917
Epoch: 5, Steps: 10 | Train Loss: 0.808 Vali Loss: 1.380 Vali Acc: 0.405 Test Loss: 1.380 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.7284727096557617
Epoch: 6, Steps: 10 | Train Loss: 0.792 Vali Loss: 1.454 Vali Acc: 0.392 Test Loss: 1.454 Test Acc: 0.392
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.6271920204162598
Epoch: 7, Steps: 10 | Train Loss: 0.627 Vali Loss: 1.423 Vali Acc: 0.446 Test Loss: 1.423 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.8397057056427
Epoch: 8, Steps: 10 | Train Loss: 0.431 Vali Loss: 1.327 Vali Acc: 0.500 Test Loss: 1.327 Test Acc: 0.500
Validation loss decreased (-0.445934 --> -0.499987).  Saving model ...
Epoch: 9 cost time: 3.8422164916992188
Epoch: 9, Steps: 10 | Train Loss: 0.301 Vali Loss: 1.224 Vali Acc: 0.554 Test Loss: 1.224 Test Acc: 0.554
Validation loss decreased (-0.499987 --> -0.554042).  Saving model ...
Epoch: 10 cost time: 3.345602035522461
Epoch: 10, Steps: 10 | Train Loss: 0.195 Vali Loss: 1.423 Vali Acc: 0.541 Test Loss: 1.423 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.7530479431152344
Epoch: 11, Steps: 10 | Train Loss: 0.089 Vali Loss: 1.272 Vali Acc: 0.595 Test Loss: 1.272 Test Acc: 0.595
Validation loss decreased (-0.554042 --> -0.594582).  Saving model ...
Epoch: 12 cost time: 3.611835479736328
Epoch: 12, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.438 Vali Acc: 0.527 Test Loss: 1.438 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.5376737117767334
Epoch: 13, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.510 Vali Acc: 0.568 Test Loss: 1.510 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.749155044555664
Epoch: 14, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.459 Vali Acc: 0.541 Test Loss: 1.459 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.35634183883667
Epoch: 15, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.533 Vali Acc: 0.541 Test Loss: 1.533 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.676806926727295
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.520 Vali Acc: 0.486 Test Loss: 1.520 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.504884719848633
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.541 Vali Acc: 0.568 Test Loss: 1.541 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.183316469192505
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.555 Vali Acc: 0.554 Test Loss: 1.555 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.3799777030944824
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.541 Vali Acc: 0.581 Test Loss: 1.541 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.5592236518859863
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.541 Vali Acc: 0.554 Test Loss: 1.541 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.8959805965423584
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.547 Vali Acc: 0.568 Test Loss: 1.547 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 10319296
model size : 44.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.075225353240967
Epoch: 1, Steps: 10 | Train Loss: 1.436 Vali Loss: 1.587 Vali Acc: 0.257 Test Loss: 1.587 Test Acc: 0.257
Validation loss decreased (inf --> -0.256741).  Saving model ...
Epoch: 2 cost time: 3.1334803104400635
Epoch: 2, Steps: 10 | Train Loss: 1.426 Vali Loss: 1.465 Vali Acc: 0.257 Test Loss: 1.465 Test Acc: 0.257
Validation loss decreased (-0.256741 --> -0.256742).  Saving model ...
Epoch: 3 cost time: 3.198852300643921
Epoch: 3, Steps: 10 | Train Loss: 1.444 Vali Loss: 1.603 Vali Acc: 0.338 Test Loss: 1.603 Test Acc: 0.338
Validation loss decreased (-0.256742 --> -0.337822).  Saving model ...
Epoch: 4 cost time: 3.53053879737854
Epoch: 4, Steps: 10 | Train Loss: 1.308 Vali Loss: 1.185 Vali Acc: 0.500 Test Loss: 1.185 Test Acc: 0.500
Validation loss decreased (-0.337822 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 2.778688907623291
Epoch: 5, Steps: 10 | Train Loss: 1.180 Vali Loss: 1.714 Vali Acc: 0.243 Test Loss: 1.714 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.4541373252868652
Epoch: 6, Steps: 10 | Train Loss: 0.856 Vali Loss: 1.157 Vali Acc: 0.514 Test Loss: 1.157 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 7 cost time: 2.755126476287842
Epoch: 7, Steps: 10 | Train Loss: 0.667 Vali Loss: 1.143 Vali Acc: 0.527 Test Loss: 1.143 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 8 cost time: 3.022285223007202
Epoch: 8, Steps: 10 | Train Loss: 0.429 Vali Loss: 1.354 Vali Acc: 0.473 Test Loss: 1.354 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.352381706237793
Epoch: 9, Steps: 10 | Train Loss: 0.302 Vali Loss: 1.192 Vali Acc: 0.554 Test Loss: 1.192 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554042).  Saving model ...
Epoch: 10 cost time: 3.2136096954345703
Epoch: 10, Steps: 10 | Train Loss: 0.212 Vali Loss: 1.357 Vali Acc: 0.541 Test Loss: 1.357 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.0790762901306152
Epoch: 11, Steps: 10 | Train Loss: 0.091 Vali Loss: 1.459 Vali Acc: 0.595 Test Loss: 1.459 Test Acc: 0.595
Validation loss decreased (-0.554042 --> -0.594580).  Saving model ...
Epoch: 12 cost time: 2.4750986099243164
Epoch: 12, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.291 Vali Acc: 0.595 Test Loss: 1.291 Test Acc: 0.595
Validation loss decreased (-0.594580 --> -0.594582).  Saving model ...
Epoch: 13 cost time: 2.092648983001709
Epoch: 13, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.369 Vali Acc: 0.595 Test Loss: 1.369 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.2990782260894775
Epoch: 14, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.614 Vali Acc: 0.541 Test Loss: 1.614 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.2917912006378174
Epoch: 15, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.642 Vali Acc: 0.554 Test Loss: 1.642 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.265772819519043
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.740 Vali Acc: 0.554 Test Loss: 1.740 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.405862331390381
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.629 Vali Acc: 0.568 Test Loss: 1.629 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.937285900115967
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.644 Vali Acc: 0.541 Test Loss: 1.644 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.962892532348633
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.738 Vali Acc: 0.541 Test Loss: 1.738 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.9810354709625244
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.661 Vali Acc: 0.527 Test Loss: 1.661 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.8879916667938232
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.653 Vali Acc: 0.527 Test Loss: 1.653 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.4489917755126953
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.666 Vali Acc: 0.527 Test Loss: 1.666 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 10302656
model size : 44.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.2334582805633545
Epoch: 1, Steps: 10 | Train Loss: 1.558 Vali Loss: 1.684 Vali Acc: 0.203 Test Loss: 1.684 Test Acc: 0.203
Validation loss decreased (inf --> -0.202686).  Saving model ...
Epoch: 2 cost time: 3.3780598640441895
Epoch: 2, Steps: 10 | Train Loss: 1.521 Vali Loss: 1.572 Vali Acc: 0.203 Test Loss: 1.572 Test Acc: 0.203
Validation loss decreased (-0.202686 --> -0.202687).  Saving model ...
Epoch: 3 cost time: 3.7179923057556152
Epoch: 3, Steps: 10 | Train Loss: 1.308 Vali Loss: 1.230 Vali Acc: 0.405 Test Loss: 1.230 Test Acc: 0.405
Validation loss decreased (-0.202687 --> -0.405393).  Saving model ...
Epoch: 4 cost time: 3.3162314891815186
Epoch: 4, Steps: 10 | Train Loss: 1.028 Vali Loss: 1.183 Vali Acc: 0.432 Test Loss: 1.183 Test Acc: 0.432
Validation loss decreased (-0.405393 --> -0.432421).  Saving model ...
Epoch: 5 cost time: 4.025619745254517
Epoch: 5, Steps: 10 | Train Loss: 0.851 Vali Loss: 1.278 Vali Acc: 0.392 Test Loss: 1.278 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.7125210762023926
Epoch: 6, Steps: 10 | Train Loss: 0.757 Vali Loss: 1.664 Vali Acc: 0.365 Test Loss: 1.664 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.5499563217163086
Epoch: 7, Steps: 10 | Train Loss: 0.597 Vali Loss: 1.411 Vali Acc: 0.419 Test Loss: 1.411 Test Acc: 0.419
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.5893380641937256
Epoch: 8, Steps: 10 | Train Loss: 0.426 Vali Loss: 1.393 Vali Acc: 0.446 Test Loss: 1.393 Test Acc: 0.446
Validation loss decreased (-0.432421 --> -0.445932).  Saving model ...
Epoch: 9 cost time: 2.9049482345581055
Epoch: 9, Steps: 10 | Train Loss: 0.265 Vali Loss: 1.240 Vali Acc: 0.527 Test Loss: 1.240 Test Acc: 0.527
Validation loss decreased (-0.445932 --> -0.527015).  Saving model ...
Epoch: 10 cost time: 3.6382904052734375
Epoch: 10, Steps: 10 | Train Loss: 0.217 Vali Loss: 1.312 Vali Acc: 0.500 Test Loss: 1.312 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.387444496154785
Epoch: 11, Steps: 10 | Train Loss: 0.095 Vali Loss: 1.680 Vali Acc: 0.486 Test Loss: 1.680 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.3028926849365234
Epoch: 12, Steps: 10 | Train Loss: 0.071 Vali Loss: 1.482 Vali Acc: 0.541 Test Loss: 1.482 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540526).  Saving model ...
Epoch: 13 cost time: 3.562971591949463
Epoch: 13, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.742 Vali Acc: 0.473 Test Loss: 1.742 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.6428306102752686
Epoch: 14, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.895 Vali Acc: 0.473 Test Loss: 1.895 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.7832634449005127
Epoch: 15, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.592 Vali Acc: 0.608 Test Loss: 1.592 Test Acc: 0.608
Validation loss decreased (-0.540526 --> -0.608092).  Saving model ...
Epoch: 16 cost time: 3.2037250995635986
Epoch: 16, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.698 Vali Acc: 0.541 Test Loss: 1.698 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.6274209022521973
Epoch: 17, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.756 Vali Acc: 0.581 Test Loss: 1.756 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.3664283752441406
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.826 Vali Acc: 0.500 Test Loss: 1.826 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.7403199672698975
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.801 Vali Acc: 0.500 Test Loss: 1.801 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.552495002746582
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.867 Vali Acc: 0.500 Test Loss: 1.867 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.2281482219696045
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.883 Vali Acc: 0.486 Test Loss: 1.883 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.4942893981933594
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.876 Vali Acc: 0.486 Test Loss: 1.876 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.5920867919921875
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.881 Vali Acc: 0.500 Test Loss: 1.881 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.1205499172210693
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.878 Vali Acc: 0.486 Test Loss: 1.878 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.548889636993408
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.876 Vali Acc: 0.486 Test Loss: 1.876 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 10286016
model size : 44.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.726155042648315
Epoch: 1, Steps: 10 | Train Loss: 1.492 Vali Loss: 1.396 Vali Acc: 0.270 Test Loss: 1.396 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 3.867543935775757
Epoch: 2, Steps: 10 | Train Loss: 1.375 Vali Loss: 1.569 Vali Acc: 0.216 Test Loss: 1.569 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.65897274017334
Epoch: 3, Steps: 10 | Train Loss: 1.326 Vali Loss: 1.277 Vali Acc: 0.392 Test Loss: 1.277 Test Acc: 0.392
Validation loss decreased (-0.270256 --> -0.391879).  Saving model ...
Epoch: 4 cost time: 3.5373177528381348
Epoch: 4, Steps: 10 | Train Loss: 1.115 Vali Loss: 1.467 Vali Acc: 0.392 Test Loss: 1.467 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.2158234119415283
Epoch: 5, Steps: 10 | Train Loss: 1.002 Vali Loss: 1.502 Vali Acc: 0.351 Test Loss: 1.502 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.308084011077881
Epoch: 6, Steps: 10 | Train Loss: 0.778 Vali Loss: 1.353 Vali Acc: 0.405 Test Loss: 1.353 Test Acc: 0.405
Validation loss decreased (-0.391879 --> -0.405392).  Saving model ...
Epoch: 7 cost time: 3.8301122188568115
Epoch: 7, Steps: 10 | Train Loss: 0.632 Vali Loss: 1.122 Vali Acc: 0.514 Test Loss: 1.122 Test Acc: 0.514
Validation loss decreased (-0.405392 --> -0.513502).  Saving model ...
Epoch: 8 cost time: 3.820289373397827
Epoch: 8, Steps: 10 | Train Loss: 0.402 Vali Loss: 1.294 Vali Acc: 0.541 Test Loss: 1.294 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540528).  Saving model ...
Epoch: 9 cost time: 3.5686652660369873
Epoch: 9, Steps: 10 | Train Loss: 0.251 Vali Loss: 1.344 Vali Acc: 0.514 Test Loss: 1.344 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.6512725353240967
Epoch: 10, Steps: 10 | Train Loss: 0.196 Vali Loss: 1.237 Vali Acc: 0.581 Test Loss: 1.237 Test Acc: 0.581
Validation loss decreased (-0.540528 --> -0.581069).  Saving model ...
Epoch: 11 cost time: 3.6469388008117676
Epoch: 11, Steps: 10 | Train Loss: 0.131 Vali Loss: 1.602 Vali Acc: 0.527 Test Loss: 1.602 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.714298963546753
Epoch: 12, Steps: 10 | Train Loss: 0.076 Vali Loss: 1.451 Vali Acc: 0.608 Test Loss: 1.451 Test Acc: 0.608
Validation loss decreased (-0.581069 --> -0.608094).  Saving model ...
Epoch: 13 cost time: 3.350389242172241
Epoch: 13, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.374 Vali Acc: 0.595 Test Loss: 1.374 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.660006523132324
Epoch: 14, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.360 Vali Acc: 0.608 Test Loss: 1.360 Test Acc: 0.608
Validation loss decreased (-0.608094 --> -0.608095).  Saving model ...
Epoch: 15 cost time: 3.5030088424682617
Epoch: 15, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.349 Vali Acc: 0.608 Test Loss: 1.349 Test Acc: 0.608
Validation loss decreased (-0.608095 --> -0.608095).  Saving model ...
Epoch: 16 cost time: 3.203235626220703
Epoch: 16, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.586 Vali Acc: 0.568 Test Loss: 1.586 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.89605450630188
Epoch: 17, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.619 Vali Acc: 0.581 Test Loss: 1.619 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.866486072540283
Epoch: 18, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.756 Vali Acc: 0.581 Test Loss: 1.756 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.5143940448760986
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.693 Vali Acc: 0.595 Test Loss: 1.693 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.8259079456329346
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.696 Vali Acc: 0.595 Test Loss: 1.696 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.479320526123047
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.697 Vali Acc: 0.568 Test Loss: 1.697 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.475470781326294
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.653 Vali Acc: 0.595 Test Loss: 1.653 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.7569403648376465
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.641 Vali Acc: 0.581 Test Loss: 1.641 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.639242649078369
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.646 Vali Acc: 0.595 Test Loss: 1.646 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.5772616863250732
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.662 Vali Acc: 0.595 Test Loss: 1.662 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 10269376
model size : 44.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.709632158279419
Epoch: 1, Steps: 10 | Train Loss: 1.476 Vali Loss: 1.343 Vali Acc: 0.419 Test Loss: 1.343 Test Acc: 0.419
Validation loss decreased (inf --> -0.418905).  Saving model ...
Epoch: 2 cost time: 4.201434135437012
Epoch: 2, Steps: 10 | Train Loss: 1.437 Vali Loss: 1.604 Vali Acc: 0.243 Test Loss: 1.604 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.526275634765625
Epoch: 3, Steps: 10 | Train Loss: 1.443 Vali Loss: 1.378 Vali Acc: 0.432 Test Loss: 1.378 Test Acc: 0.432
Validation loss decreased (-0.418905 --> -0.432419).  Saving model ...
Epoch: 4 cost time: 2.955803155899048
Epoch: 4, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.578 Vali Acc: 0.230 Test Loss: 1.578 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.5369350910186768
Epoch: 5, Steps: 10 | Train Loss: 1.368 Vali Loss: 1.666 Vali Acc: 0.311 Test Loss: 1.666 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.367293357849121
Epoch: 6, Steps: 10 | Train Loss: 1.154 Vali Loss: 1.183 Vali Acc: 0.500 Test Loss: 1.183 Test Acc: 0.500
Validation loss decreased (-0.432419 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 2.9283883571624756
Epoch: 7, Steps: 10 | Train Loss: 0.856 Vali Loss: 1.220 Vali Acc: 0.514 Test Loss: 1.220 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513501).  Saving model ...
Epoch: 8 cost time: 3.017024278640747
Epoch: 8, Steps: 10 | Train Loss: 0.717 Vali Loss: 1.142 Vali Acc: 0.446 Test Loss: 1.142 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.9246602058410645
Epoch: 9, Steps: 10 | Train Loss: 0.565 Vali Loss: 1.508 Vali Acc: 0.405 Test Loss: 1.508 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.6761314868927
Epoch: 10, Steps: 10 | Train Loss: 0.489 Vali Loss: 1.458 Vali Acc: 0.568 Test Loss: 1.458 Test Acc: 0.568
Validation loss decreased (-0.513501 --> -0.567553).  Saving model ...
Epoch: 11 cost time: 4.61788010597229
Epoch: 11, Steps: 10 | Train Loss: 0.409 Vali Loss: 1.483 Vali Acc: 0.486 Test Loss: 1.483 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.4604697227478027
Epoch: 12, Steps: 10 | Train Loss: 0.286 Vali Loss: 1.205 Vali Acc: 0.500 Test Loss: 1.205 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.18723726272583
Epoch: 13, Steps: 10 | Train Loss: 0.159 Vali Loss: 1.213 Vali Acc: 0.568 Test Loss: 1.213 Test Acc: 0.568
Validation loss decreased (-0.567553 --> -0.567555).  Saving model ...
Epoch: 14 cost time: 4.429664850234985
Epoch: 14, Steps: 10 | Train Loss: 0.093 Vali Loss: 1.258 Vali Acc: 0.541 Test Loss: 1.258 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.716613531112671
Epoch: 15, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.424 Vali Acc: 0.486 Test Loss: 1.424 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.41471004486084
Epoch: 16, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.323 Vali Acc: 0.554 Test Loss: 1.323 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.661626100540161
Epoch: 17, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.421 Vali Acc: 0.541 Test Loss: 1.421 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.176665544509888
Epoch: 18, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.298 Vali Acc: 0.554 Test Loss: 1.298 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.096275091171265
Epoch: 19, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.367 Vali Acc: 0.554 Test Loss: 1.367 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.0616090297698975
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.364 Vali Acc: 0.554 Test Loss: 1.364 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.967397928237915
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.356 Vali Acc: 0.568 Test Loss: 1.356 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.7980241775512695
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.341 Vali Acc: 0.568 Test Loss: 1.341 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.890475273132324
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.362 Vali Acc: 0.568 Test Loss: 1.362 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 4873408
model size : 21.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.936128616333008
Epoch: 1, Steps: 10 | Train Loss: 1.559 Vali Loss: 1.534 Vali Acc: 0.176 Test Loss: 1.534 Test Acc: 0.176
Validation loss decreased (inf --> -0.175660).  Saving model ...
Epoch: 2 cost time: 2.6495559215545654
Epoch: 2, Steps: 10 | Train Loss: 1.422 Vali Loss: 1.406 Vali Acc: 0.216 Test Loss: 1.406 Test Acc: 0.216
Validation loss decreased (-0.175660 --> -0.216202).  Saving model ...
Epoch: 3 cost time: 3.334519386291504
Epoch: 3, Steps: 10 | Train Loss: 1.377 Vali Loss: 1.395 Vali Acc: 0.365 Test Loss: 1.395 Test Acc: 0.365
Validation loss decreased (-0.216202 --> -0.364851).  Saving model ...
Epoch: 4 cost time: 3.2426397800445557
Epoch: 4, Steps: 10 | Train Loss: 1.321 Vali Loss: 1.338 Vali Acc: 0.365 Test Loss: 1.338 Test Acc: 0.365
Validation loss decreased (-0.364851 --> -0.364851).  Saving model ...
Epoch: 5 cost time: 3.3980276584625244
Epoch: 5, Steps: 10 | Train Loss: 1.177 Vali Loss: 1.384 Vali Acc: 0.284 Test Loss: 1.384 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.93402099609375
Epoch: 6, Steps: 10 | Train Loss: 1.010 Vali Loss: 1.221 Vali Acc: 0.446 Test Loss: 1.221 Test Acc: 0.446
Validation loss decreased (-0.364851 --> -0.445934).  Saving model ...
Epoch: 7 cost time: 4.00862193107605
Epoch: 7, Steps: 10 | Train Loss: 0.840 Vali Loss: 1.109 Vali Acc: 0.527 Test Loss: 1.109 Test Acc: 0.527
Validation loss decreased (-0.445934 --> -0.527016).  Saving model ...
Epoch: 8 cost time: 4.259434223175049
Epoch: 8, Steps: 10 | Train Loss: 0.625 Vali Loss: 1.396 Vali Acc: 0.459 Test Loss: 1.396 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.6993346214294434
Epoch: 9, Steps: 10 | Train Loss: 0.514 Vali Loss: 1.418 Vali Acc: 0.432 Test Loss: 1.418 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.560302257537842
Epoch: 10, Steps: 10 | Train Loss: 0.419 Vali Loss: 1.269 Vali Acc: 0.527 Test Loss: 1.269 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.599241018295288
Epoch: 11, Steps: 10 | Train Loss: 0.245 Vali Loss: 1.309 Vali Acc: 0.459 Test Loss: 1.309 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.606285572052002
Epoch: 12, Steps: 10 | Train Loss: 0.153 Vali Loss: 1.270 Vali Acc: 0.514 Test Loss: 1.270 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.1315231323242188
Epoch: 13, Steps: 10 | Train Loss: 0.088 Vali Loss: 1.272 Vali Acc: 0.568 Test Loss: 1.272 Test Acc: 0.568
Validation loss decreased (-0.527016 --> -0.567555).  Saving model ...
Epoch: 14 cost time: 2.020540237426758
Epoch: 14, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.327 Vali Acc: 0.514 Test Loss: 1.327 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.039125680923462
Epoch: 15, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.307 Vali Acc: 0.541 Test Loss: 1.307 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.5191471576690674
Epoch: 16, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.387 Vali Acc: 0.514 Test Loss: 1.387 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.9215452671051025
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.351 Vali Acc: 0.554 Test Loss: 1.351 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.7307353019714355
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.393 Vali Acc: 0.554 Test Loss: 1.393 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.057039499282837
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.408 Vali Acc: 0.527 Test Loss: 1.408 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.0464653968811035
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.420 Vali Acc: 0.514 Test Loss: 1.420 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.418226957321167
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.438 Vali Acc: 0.541 Test Loss: 1.438 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.7588744163513184
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.427 Vali Acc: 0.514 Test Loss: 1.427 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.9211602210998535
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.448 Vali Acc: 0.514 Test Loss: 1.448 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 4865088
model size : 21.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.647125482559204
Epoch: 1, Steps: 10 | Train Loss: 1.480 Vali Loss: 1.638 Vali Acc: 0.176 Test Loss: 1.638 Test Acc: 0.176
Validation loss decreased (inf --> -0.175659).  Saving model ...
Epoch: 2 cost time: 3.910555362701416
Epoch: 2, Steps: 10 | Train Loss: 1.461 Vali Loss: 1.478 Vali Acc: 0.243 Test Loss: 1.478 Test Acc: 0.243
Validation loss decreased (-0.175659 --> -0.243228).  Saving model ...
Epoch: 3 cost time: 3.9839131832122803
Epoch: 3, Steps: 10 | Train Loss: 1.363 Vali Loss: 1.365 Vali Acc: 0.270 Test Loss: 1.365 Test Acc: 0.270
Validation loss decreased (-0.243228 --> -0.270257).  Saving model ...
Epoch: 4 cost time: 4.081150054931641
Epoch: 4, Steps: 10 | Train Loss: 1.275 Vali Loss: 1.423 Vali Acc: 0.473 Test Loss: 1.423 Test Acc: 0.473
Validation loss decreased (-0.270257 --> -0.472959).  Saving model ...
Epoch: 5 cost time: 3.7464072704315186
Epoch: 5, Steps: 10 | Train Loss: 1.095 Vali Loss: 1.241 Vali Acc: 0.446 Test Loss: 1.241 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.2327606678009033
Epoch: 6, Steps: 10 | Train Loss: 0.860 Vali Loss: 1.176 Vali Acc: 0.514 Test Loss: 1.176 Test Acc: 0.514
Validation loss decreased (-0.472959 --> -0.513502).  Saving model ...
Epoch: 7 cost time: 3.8958756923675537
Epoch: 7, Steps: 10 | Train Loss: 0.823 Vali Loss: 1.143 Vali Acc: 0.541 Test Loss: 1.143 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540529).  Saving model ...
Epoch: 8 cost time: 3.0389153957366943
Epoch: 8, Steps: 10 | Train Loss: 0.544 Vali Loss: 1.324 Vali Acc: 0.432 Test Loss: 1.324 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.2443883419036865
Epoch: 9, Steps: 10 | Train Loss: 0.448 Vali Loss: 1.215 Vali Acc: 0.581 Test Loss: 1.215 Test Acc: 0.581
Validation loss decreased (-0.540529 --> -0.581069).  Saving model ...
Epoch: 10 cost time: 3.608736038208008
Epoch: 10, Steps: 10 | Train Loss: 0.291 Vali Loss: 1.164 Vali Acc: 0.581 Test Loss: 1.164 Test Acc: 0.581
Validation loss decreased (-0.581069 --> -0.581069).  Saving model ...
Epoch: 11 cost time: 3.604680061340332
Epoch: 11, Steps: 10 | Train Loss: 0.186 Vali Loss: 1.311 Vali Acc: 0.500 Test Loss: 1.311 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.640622615814209
Epoch: 12, Steps: 10 | Train Loss: 0.105 Vali Loss: 1.415 Vali Acc: 0.514 Test Loss: 1.415 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.4094085693359375
Epoch: 13, Steps: 10 | Train Loss: 0.072 Vali Loss: 1.332 Vali Acc: 0.541 Test Loss: 1.332 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.11919903755188
Epoch: 14, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.408 Vali Acc: 0.554 Test Loss: 1.408 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.3879189491271973
Epoch: 15, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.376 Vali Acc: 0.568 Test Loss: 1.376 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.193140983581543
Epoch: 16, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.360 Vali Acc: 0.595 Test Loss: 1.360 Test Acc: 0.595
Validation loss decreased (-0.581069 --> -0.594581).  Saving model ...
Epoch: 17 cost time: 3.7693214416503906
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.429 Vali Acc: 0.568 Test Loss: 1.429 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.7334868907928467
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.456 Vali Acc: 0.541 Test Loss: 1.456 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.6109023094177246
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.485 Vali Acc: 0.568 Test Loss: 1.485 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.413257598876953
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.464 Vali Acc: 0.554 Test Loss: 1.464 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.0924079418182373
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.499 Vali Acc: 0.581 Test Loss: 1.499 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.9910762310028076
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.479 Vali Acc: 0.554 Test Loss: 1.479 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.298173427581787
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.508 Vali Acc: 0.568 Test Loss: 1.508 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.427190065383911
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.511 Vali Acc: 0.581 Test Loss: 1.511 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.1766011714935303
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.504 Vali Acc: 0.554 Test Loss: 1.504 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 4.2279932498931885
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.534 Vali Acc: 0.554 Test Loss: 1.534 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 4856768
model size : 21.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.623272180557251
Epoch: 1, Steps: 10 | Train Loss: 1.435 Vali Loss: 1.364 Vali Acc: 0.257 Test Loss: 1.364 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 3.6302483081817627
Epoch: 2, Steps: 10 | Train Loss: 1.404 Vali Loss: 1.512 Vali Acc: 0.284 Test Loss: 1.512 Test Acc: 0.284
Validation loss decreased (-0.256743 --> -0.283769).  Saving model ...
Epoch: 3 cost time: 3.5633955001831055
Epoch: 3, Steps: 10 | Train Loss: 1.330 Vali Loss: 1.551 Vali Acc: 0.243 Test Loss: 1.551 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.072138547897339
Epoch: 4, Steps: 10 | Train Loss: 1.192 Vali Loss: 1.330 Vali Acc: 0.419 Test Loss: 1.330 Test Acc: 0.419
Validation loss decreased (-0.283769 --> -0.418906).  Saving model ...
Epoch: 5 cost time: 2.7609856128692627
Epoch: 5, Steps: 10 | Train Loss: 0.983 Vali Loss: 1.250 Vali Acc: 0.392 Test Loss: 1.250 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.871744155883789
Epoch: 6, Steps: 10 | Train Loss: 0.869 Vali Loss: 1.186 Vali Acc: 0.446 Test Loss: 1.186 Test Acc: 0.446
Validation loss decreased (-0.418906 --> -0.445934).  Saving model ...
Epoch: 7 cost time: 2.8648693561553955
Epoch: 7, Steps: 10 | Train Loss: 0.643 Vali Loss: 1.161 Vali Acc: 0.527 Test Loss: 1.161 Test Acc: 0.527
Validation loss decreased (-0.445934 --> -0.527015).  Saving model ...
Epoch: 8 cost time: 2.6331944465637207
Epoch: 8, Steps: 10 | Train Loss: 0.510 Vali Loss: 1.128 Vali Acc: 0.514 Test Loss: 1.128 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.4320669174194336
Epoch: 9, Steps: 10 | Train Loss: 0.419 Vali Loss: 1.469 Vali Acc: 0.527 Test Loss: 1.469 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.202653646469116
Epoch: 10, Steps: 10 | Train Loss: 0.264 Vali Loss: 1.211 Vali Acc: 0.527 Test Loss: 1.211 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.2282352447509766
Epoch: 11, Steps: 10 | Train Loss: 0.175 Vali Loss: 1.300 Vali Acc: 0.541 Test Loss: 1.300 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540528).  Saving model ...
Epoch: 12 cost time: 2.567755699157715
Epoch: 12, Steps: 10 | Train Loss: 0.098 Vali Loss: 1.264 Vali Acc: 0.527 Test Loss: 1.264 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.9433724880218506
Epoch: 13, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.239 Vali Acc: 0.541 Test Loss: 1.239 Test Acc: 0.541
Validation loss decreased (-0.540528 --> -0.540528).  Saving model ...
Epoch: 14 cost time: 3.2494289875030518
Epoch: 14, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.383 Vali Acc: 0.541 Test Loss: 1.383 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.264244556427002
Epoch: 15, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.259 Vali Acc: 0.527 Test Loss: 1.259 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.2630319595336914
Epoch: 16, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.446 Vali Acc: 0.554 Test Loss: 1.446 Test Acc: 0.554
Validation loss decreased (-0.540528 --> -0.554040).  Saving model ...
Epoch: 17 cost time: 2.958962917327881
Epoch: 17, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.343 Vali Acc: 0.541 Test Loss: 1.343 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.1989407539367676
Epoch: 18, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.443 Vali Acc: 0.541 Test Loss: 1.443 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.505312442779541
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.368 Vali Acc: 0.554 Test Loss: 1.368 Test Acc: 0.554
Validation loss decreased (-0.554040 --> -0.554040).  Saving model ...
Epoch: 20 cost time: 3.345973253250122
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.369 Vali Acc: 0.568 Test Loss: 1.369 Test Acc: 0.568
Validation loss decreased (-0.554040 --> -0.567554).  Saving model ...
Epoch: 21 cost time: 3.2207255363464355
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.447 Vali Acc: 0.541 Test Loss: 1.447 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.2920265197753906
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.421 Vali Acc: 0.500 Test Loss: 1.421 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.4125020503997803
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.435 Vali Acc: 0.527 Test Loss: 1.435 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.4710094928741455
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.458 Vali Acc: 0.541 Test Loss: 1.458 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.649973154067993
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.468 Vali Acc: 0.541 Test Loss: 1.468 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.4457082748413086
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.452 Vali Acc: 0.527 Test Loss: 1.452 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.57588529586792
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.464 Vali Acc: 0.527 Test Loss: 1.464 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.558232307434082
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.487 Vali Acc: 0.527 Test Loss: 1.487 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.4842894077301025
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.477 Vali Acc: 0.527 Test Loss: 1.477 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.652500867843628
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.498 Vali Acc: 0.541 Test Loss: 1.498 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 4848448
model size : 21.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.3281636238098145
Epoch: 1, Steps: 10 | Train Loss: 1.428 Vali Loss: 1.365 Vali Acc: 0.284 Test Loss: 1.365 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 3.9740195274353027
Epoch: 2, Steps: 10 | Train Loss: 1.410 Vali Loss: 1.395 Vali Acc: 0.257 Test Loss: 1.395 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.992241859436035
Epoch: 3, Steps: 10 | Train Loss: 1.404 Vali Loss: 1.443 Vali Acc: 0.486 Test Loss: 1.443 Test Acc: 0.486
Validation loss decreased (-0.283770 --> -0.486472).  Saving model ...
Epoch: 4 cost time: 3.9537642002105713
Epoch: 4, Steps: 10 | Train Loss: 1.346 Vali Loss: 1.450 Vali Acc: 0.284 Test Loss: 1.450 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.7529306411743164
Epoch: 5, Steps: 10 | Train Loss: 1.163 Vali Loss: 1.303 Vali Acc: 0.500 Test Loss: 1.303 Test Acc: 0.500
Validation loss decreased (-0.486472 --> -0.499987).  Saving model ...
Epoch: 6 cost time: 3.9586987495422363
Epoch: 6, Steps: 10 | Train Loss: 1.012 Vali Loss: 1.266 Vali Acc: 0.446 Test Loss: 1.266 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.8457765579223633
Epoch: 7, Steps: 10 | Train Loss: 0.841 Vali Loss: 1.704 Vali Acc: 0.338 Test Loss: 1.704 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.662226676940918
Epoch: 8, Steps: 10 | Train Loss: 0.760 Vali Loss: 1.208 Vali Acc: 0.541 Test Loss: 1.208 Test Acc: 0.541
Validation loss decreased (-0.499987 --> -0.540528).  Saving model ...
Epoch: 9 cost time: 3.684354305267334
Epoch: 9, Steps: 10 | Train Loss: 0.578 Vali Loss: 1.195 Vali Acc: 0.527 Test Loss: 1.195 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.7226052284240723
Epoch: 10, Steps: 10 | Train Loss: 0.436 Vali Loss: 1.357 Vali Acc: 0.500 Test Loss: 1.357 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.782115936279297
Epoch: 11, Steps: 10 | Train Loss: 0.324 Vali Loss: 1.394 Vali Acc: 0.527 Test Loss: 1.394 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.023951530456543
Epoch: 12, Steps: 10 | Train Loss: 0.207 Vali Loss: 1.358 Vali Acc: 0.527 Test Loss: 1.358 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.6489927768707275
Epoch: 13, Steps: 10 | Train Loss: 0.131 Vali Loss: 1.447 Vali Acc: 0.541 Test Loss: 1.447 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.6104390621185303
Epoch: 14, Steps: 10 | Train Loss: 0.082 Vali Loss: 1.582 Vali Acc: 0.514 Test Loss: 1.582 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.753650665283203
Epoch: 15, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.561 Vali Acc: 0.500 Test Loss: 1.561 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.188312530517578
Epoch: 16, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.485 Vali Acc: 0.568 Test Loss: 1.485 Test Acc: 0.568
Validation loss decreased (-0.540528 --> -0.567553).  Saving model ...
Epoch: 17 cost time: 3.878826141357422
Epoch: 17, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.646 Vali Acc: 0.500 Test Loss: 1.646 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.635382652282715
Epoch: 18, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.586 Vali Acc: 0.554 Test Loss: 1.586 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.9366917610168457
Epoch: 19, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.698 Vali Acc: 0.527 Test Loss: 1.698 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.624042510986328
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.628 Vali Acc: 0.554 Test Loss: 1.628 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.653848886489868
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.702 Vali Acc: 0.527 Test Loss: 1.702 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.3810317516326904
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.715 Vali Acc: 0.541 Test Loss: 1.715 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.2623798847198486
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.723 Vali Acc: 0.527 Test Loss: 1.723 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.45967173576355
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.714 Vali Acc: 0.541 Test Loss: 1.714 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.509739637374878
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.727 Vali Acc: 0.527 Test Loss: 1.727 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.5825002193450928
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.752 Vali Acc: 0.514 Test Loss: 1.752 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 3689152
model size : 16.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.520935773849487
Epoch: 1, Steps: 10 | Train Loss: 1.444 Vali Loss: 1.346 Vali Acc: 0.378 Test Loss: 1.346 Test Acc: 0.378
Validation loss decreased (inf --> -0.378365).  Saving model ...
Epoch: 2 cost time: 3.471391201019287
Epoch: 2, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.362 Vali Acc: 0.270 Test Loss: 1.362 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.086771249771118
Epoch: 3, Steps: 10 | Train Loss: 1.371 Vali Loss: 1.602 Vali Acc: 0.230 Test Loss: 1.602 Test Acc: 0.230
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.440352439880371
Epoch: 4, Steps: 10 | Train Loss: 1.204 Vali Loss: 1.236 Vali Acc: 0.514 Test Loss: 1.236 Test Acc: 0.514
Validation loss decreased (-0.378365 --> -0.513501).  Saving model ...
Epoch: 5 cost time: 3.75046968460083
Epoch: 5, Steps: 10 | Train Loss: 1.039 Vali Loss: 1.221 Vali Acc: 0.459 Test Loss: 1.221 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.107837200164795
Epoch: 6, Steps: 10 | Train Loss: 0.935 Vali Loss: 1.258 Vali Acc: 0.432 Test Loss: 1.258 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.911172389984131
Epoch: 7, Steps: 10 | Train Loss: 0.850 Vali Loss: 1.180 Vali Acc: 0.500 Test Loss: 1.180 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.567880630493164
Epoch: 8, Steps: 10 | Train Loss: 0.728 Vali Loss: 1.154 Vali Acc: 0.500 Test Loss: 1.154 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.206968307495117
Epoch: 9, Steps: 10 | Train Loss: 0.578 Vali Loss: 1.242 Vali Acc: 0.527 Test Loss: 1.242 Test Acc: 0.527
Validation loss decreased (-0.513501 --> -0.527015).  Saving model ...
Epoch: 10 cost time: 3.2281315326690674
Epoch: 10, Steps: 10 | Train Loss: 0.370 Vali Loss: 1.110 Vali Acc: 0.541 Test Loss: 1.110 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540529).  Saving model ...
Epoch: 11 cost time: 3.770538806915283
Epoch: 11, Steps: 10 | Train Loss: 0.276 Vali Loss: 1.238 Vali Acc: 0.554 Test Loss: 1.238 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554042).  Saving model ...
Epoch: 12 cost time: 2.920865774154663
Epoch: 12, Steps: 10 | Train Loss: 0.216 Vali Loss: 1.303 Vali Acc: 0.514 Test Loss: 1.303 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.800632953643799
Epoch: 13, Steps: 10 | Train Loss: 0.110 Vali Loss: 1.418 Vali Acc: 0.500 Test Loss: 1.418 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.413259983062744
Epoch: 14, Steps: 10 | Train Loss: 0.073 Vali Loss: 1.402 Vali Acc: 0.514 Test Loss: 1.402 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.585057258605957
Epoch: 15, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.393 Vali Acc: 0.568 Test Loss: 1.393 Test Acc: 0.568
Validation loss decreased (-0.554042 --> -0.567554).  Saving model ...
Epoch: 16 cost time: 3.750871419906616
Epoch: 16, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.464 Vali Acc: 0.541 Test Loss: 1.464 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.5638489723205566
Epoch: 17, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.490 Vali Acc: 0.554 Test Loss: 1.490 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.7085189819335938
Epoch: 18, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.472 Vali Acc: 0.527 Test Loss: 1.472 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.6286518573760986
Epoch: 19, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.518 Vali Acc: 0.554 Test Loss: 1.518 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.707425594329834
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.519 Vali Acc: 0.527 Test Loss: 1.519 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.5904107093811035
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.524 Vali Acc: 0.541 Test Loss: 1.524 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.112388610839844
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.541 Vali Acc: 0.527 Test Loss: 1.541 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.4977900981903076
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.547 Vali Acc: 0.527 Test Loss: 1.547 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.578016996383667
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.553 Vali Acc: 0.527 Test Loss: 1.553 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.464449644088745
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.568 Vali Acc: 0.527 Test Loss: 1.568 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 3680832
model size : 16.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.79373574256897
Epoch: 1, Steps: 10 | Train Loss: 1.506 Vali Loss: 1.655 Vali Acc: 0.162 Test Loss: 1.655 Test Acc: 0.162
Validation loss decreased (inf --> -0.162146).  Saving model ...
Epoch: 2 cost time: 4.028065204620361
Epoch: 2, Steps: 10 | Train Loss: 1.485 Vali Loss: 1.340 Vali Acc: 0.284 Test Loss: 1.340 Test Acc: 0.284
Validation loss decreased (-0.162146 --> -0.283770).  Saving model ...
Epoch: 3 cost time: 3.9708781242370605
Epoch: 3, Steps: 10 | Train Loss: 1.297 Vali Loss: 1.592 Vali Acc: 0.189 Test Loss: 1.592 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.382532119750977
Epoch: 4, Steps: 10 | Train Loss: 1.404 Vali Loss: 1.364 Vali Acc: 0.338 Test Loss: 1.364 Test Acc: 0.338
Validation loss decreased (-0.283770 --> -0.337824).  Saving model ...
Epoch: 5 cost time: 4.033967971801758
Epoch: 5, Steps: 10 | Train Loss: 1.216 Vali Loss: 1.258 Vali Acc: 0.432 Test Loss: 1.258 Test Acc: 0.432
Validation loss decreased (-0.337824 --> -0.432420).  Saving model ...
Epoch: 6 cost time: 4.115708351135254
Epoch: 6, Steps: 10 | Train Loss: 1.018 Vali Loss: 1.417 Vali Acc: 0.351 Test Loss: 1.417 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.225002288818359
Epoch: 7, Steps: 10 | Train Loss: 0.886 Vali Loss: 1.317 Vali Acc: 0.365 Test Loss: 1.317 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.363908767700195
Epoch: 8, Steps: 10 | Train Loss: 0.682 Vali Loss: 1.196 Vali Acc: 0.554 Test Loss: 1.196 Test Acc: 0.554
Validation loss decreased (-0.432420 --> -0.554042).  Saving model ...
Epoch: 9 cost time: 4.722233295440674
Epoch: 9, Steps: 10 | Train Loss: 0.522 Vali Loss: 1.175 Vali Acc: 0.541 Test Loss: 1.175 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.633671045303345
Epoch: 10, Steps: 10 | Train Loss: 0.411 Vali Loss: 1.167 Vali Acc: 0.554 Test Loss: 1.167 Test Acc: 0.554
Validation loss decreased (-0.554042 --> -0.554042).  Saving model ...
Epoch: 11 cost time: 3.836190700531006
Epoch: 11, Steps: 10 | Train Loss: 0.284 Vali Loss: 1.333 Vali Acc: 0.473 Test Loss: 1.333 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.344958782196045
Epoch: 12, Steps: 10 | Train Loss: 0.183 Vali Loss: 1.501 Vali Acc: 0.459 Test Loss: 1.501 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.816991090774536
Epoch: 13, Steps: 10 | Train Loss: 0.176 Vali Loss: 1.623 Vali Acc: 0.500 Test Loss: 1.623 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.187197685241699
Epoch: 14, Steps: 10 | Train Loss: 0.128 Vali Loss: 1.401 Vali Acc: 0.541 Test Loss: 1.401 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.8626492023468018
Epoch: 15, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.432 Vali Acc: 0.554 Test Loss: 1.432 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.080538511276245
Epoch: 16, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.419 Vali Acc: 0.568 Test Loss: 1.419 Test Acc: 0.568
Validation loss decreased (-0.554042 --> -0.567553).  Saving model ...
Epoch: 17 cost time: 3.8808584213256836
Epoch: 17, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.457 Vali Acc: 0.541 Test Loss: 1.457 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.826223611831665
Epoch: 18, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.487 Vali Acc: 0.568 Test Loss: 1.487 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.749160051345825
Epoch: 19, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.516 Vali Acc: 0.541 Test Loss: 1.516 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.9070940017700195
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.524 Vali Acc: 0.554 Test Loss: 1.524 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.939319372177124
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.573 Vali Acc: 0.554 Test Loss: 1.573 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.872921943664551
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.563 Vali Acc: 0.568 Test Loss: 1.563 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.9748830795288086
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.577 Vali Acc: 0.554 Test Loss: 1.577 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.7562105655670166
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.604 Vali Acc: 0.554 Test Loss: 1.604 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.6506335735321045
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.605 Vali Acc: 0.554 Test Loss: 1.605 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.4844255447387695
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.630 Vali Acc: 0.581 Test Loss: 1.630 Test Acc: 0.581
Validation loss decreased (-0.567553 --> -0.581065).  Saving model ...
Epoch: 27 cost time: 3.8195765018463135
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.626 Vali Acc: 0.568 Test Loss: 1.626 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.379941701889038
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.652 Vali Acc: 0.581 Test Loss: 1.652 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.712678909301758
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.656 Vali Acc: 0.568 Test Loss: 1.656 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.0592455863952637
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.663 Vali Acc: 0.568 Test Loss: 1.663 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.750030040740967
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.672 Vali Acc: 0.568 Test Loss: 1.672 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 3.933868408203125
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.688 Vali Acc: 0.568 Test Loss: 1.688 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 3.7355597019195557
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.702 Vali Acc: 0.568 Test Loss: 1.702 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 3.9189705848693848
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.720 Vali Acc: 0.568 Test Loss: 1.720 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 4.090490818023682
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.735 Vali Acc: 0.568 Test Loss: 1.735 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 4.275739908218384
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.740 Vali Acc: 0.568 Test Loss: 1.740 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 3672512
model size : 16.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.3009443283081055
Epoch: 1, Steps: 10 | Train Loss: 1.485 Vali Loss: 1.376 Vali Acc: 0.392 Test Loss: 1.376 Test Acc: 0.392
Validation loss decreased (inf --> -0.391878).  Saving model ...
Epoch: 2 cost time: 3.5242815017700195
Epoch: 2, Steps: 10 | Train Loss: 1.427 Vali Loss: 1.607 Vali Acc: 0.176 Test Loss: 1.607 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.7152175903320312
Epoch: 3, Steps: 10 | Train Loss: 1.334 Vali Loss: 1.300 Vali Acc: 0.405 Test Loss: 1.300 Test Acc: 0.405
Validation loss decreased (-0.391878 --> -0.405392).  Saving model ...
Epoch: 4 cost time: 3.5691018104553223
Epoch: 4, Steps: 10 | Train Loss: 1.173 Vali Loss: 1.324 Vali Acc: 0.405 Test Loss: 1.324 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.4036426544189453
Epoch: 5, Steps: 10 | Train Loss: 1.147 Vali Loss: 1.217 Vali Acc: 0.473 Test Loss: 1.217 Test Acc: 0.473
Validation loss decreased (-0.405392 --> -0.472961).  Saving model ...
Epoch: 6 cost time: 3.9087471961975098
Epoch: 6, Steps: 10 | Train Loss: 0.865 Vali Loss: 1.243 Vali Acc: 0.486 Test Loss: 1.243 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486474).  Saving model ...
Epoch: 7 cost time: 3.3827505111694336
Epoch: 7, Steps: 10 | Train Loss: 0.715 Vali Loss: 1.215 Vali Acc: 0.473 Test Loss: 1.215 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.3312017917633057
Epoch: 8, Steps: 10 | Train Loss: 0.561 Vali Loss: 1.201 Vali Acc: 0.500 Test Loss: 1.201 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499988).  Saving model ...
Epoch: 9 cost time: 3.3974721431732178
Epoch: 9, Steps: 10 | Train Loss: 0.477 Vali Loss: 1.304 Vali Acc: 0.527 Test Loss: 1.304 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527014).  Saving model ...
Epoch: 10 cost time: 3.5003082752227783
Epoch: 10, Steps: 10 | Train Loss: 0.393 Vali Loss: 1.372 Vali Acc: 0.568 Test Loss: 1.372 Test Acc: 0.568
Validation loss decreased (-0.527014 --> -0.567554).  Saving model ...
Epoch: 11 cost time: 3.07452392578125
Epoch: 11, Steps: 10 | Train Loss: 0.306 Vali Loss: 1.279 Vali Acc: 0.527 Test Loss: 1.279 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.395397186279297
Epoch: 12, Steps: 10 | Train Loss: 0.173 Vali Loss: 1.312 Vali Acc: 0.541 Test Loss: 1.312 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.169896364212036
Epoch: 13, Steps: 10 | Train Loss: 0.126 Vali Loss: 1.261 Vali Acc: 0.568 Test Loss: 1.261 Test Acc: 0.568
Validation loss decreased (-0.567554 --> -0.567555).  Saving model ...
Epoch: 14 cost time: 2.4295294284820557
Epoch: 14, Steps: 10 | Train Loss: 0.075 Vali Loss: 1.215 Vali Acc: 0.554 Test Loss: 1.215 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.408513069152832
Epoch: 15, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.422 Vali Acc: 0.514 Test Loss: 1.422 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.9439167976379395
Epoch: 16, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.314 Vali Acc: 0.608 Test Loss: 1.314 Test Acc: 0.608
Validation loss decreased (-0.567555 --> -0.608095).  Saving model ...
Epoch: 17 cost time: 2.631706953048706
Epoch: 17, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.390 Vali Acc: 0.608 Test Loss: 1.390 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.928130626678467
Epoch: 18, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.347 Vali Acc: 0.635 Test Loss: 1.347 Test Acc: 0.635
Validation loss decreased (-0.608095 --> -0.635122).  Saving model ...
Epoch: 19 cost time: 3.1804351806640625
Epoch: 19, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.370 Vali Acc: 0.622 Test Loss: 1.370 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.4657723903656006
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.386 Vali Acc: 0.608 Test Loss: 1.386 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.1427671909332275
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.371 Vali Acc: 0.581 Test Loss: 1.371 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.54364013671875
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.398 Vali Acc: 0.595 Test Loss: 1.398 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.404353380203247
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.392 Vali Acc: 0.608 Test Loss: 1.392 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.5913562774658203
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.397 Vali Acc: 0.581 Test Loss: 1.397 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.1257247924804688
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.428 Vali Acc: 0.595 Test Loss: 1.428 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.5766210556030273
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.410 Vali Acc: 0.595 Test Loss: 1.410 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.3514881134033203
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.425 Vali Acc: 0.581 Test Loss: 1.425 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 3.1623125076293945
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.431 Vali Acc: 0.581 Test Loss: 1.431 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 3664192
model size : 16.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.778548002243042
Epoch: 1, Steps: 10 | Train Loss: 1.424 Vali Loss: 1.425 Vali Acc: 0.257 Test Loss: 1.425 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 4.060000658035278
Epoch: 2, Steps: 10 | Train Loss: 1.426 Vali Loss: 1.437 Vali Acc: 0.257 Test Loss: 1.437 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.425931692123413
Epoch: 3, Steps: 10 | Train Loss: 1.345 Vali Loss: 1.391 Vali Acc: 0.189 Test Loss: 1.391 Test Acc: 0.189
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.38436484336853
Epoch: 4, Steps: 10 | Train Loss: 1.285 Vali Loss: 1.517 Vali Acc: 0.419 Test Loss: 1.517 Test Acc: 0.419
Validation loss decreased (-0.256743 --> -0.418904).  Saving model ...
Epoch: 5 cost time: 4.355994701385498
Epoch: 5, Steps: 10 | Train Loss: 1.161 Vali Loss: 1.270 Vali Acc: 0.432 Test Loss: 1.270 Test Acc: 0.432
Validation loss decreased (-0.418904 --> -0.432420).  Saving model ...
Epoch: 6 cost time: 4.129224061965942
Epoch: 6, Steps: 10 | Train Loss: 1.052 Vali Loss: 1.263 Vali Acc: 0.405 Test Loss: 1.263 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.4896020889282227
Epoch: 7, Steps: 10 | Train Loss: 0.888 Vali Loss: 1.325 Vali Acc: 0.473 Test Loss: 1.325 Test Acc: 0.473
Validation loss decreased (-0.432420 --> -0.472960).  Saving model ...
Epoch: 8 cost time: 3.9974517822265625
Epoch: 8, Steps: 10 | Train Loss: 0.727 Vali Loss: 1.480 Vali Acc: 0.432 Test Loss: 1.480 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.670325756072998
Epoch: 9, Steps: 10 | Train Loss: 0.668 Vali Loss: 1.190 Vali Acc: 0.527 Test Loss: 1.190 Test Acc: 0.527
Validation loss decreased (-0.472960 --> -0.527015).  Saving model ...
Epoch: 10 cost time: 3.797767400741577
Epoch: 10, Steps: 10 | Train Loss: 0.528 Vali Loss: 1.161 Vali Acc: 0.581 Test Loss: 1.161 Test Acc: 0.581
Validation loss decreased (-0.527015 --> -0.581069).  Saving model ...
Epoch: 11 cost time: 2.5699312686920166
Epoch: 11, Steps: 10 | Train Loss: 0.385 Vali Loss: 1.130 Vali Acc: 0.581 Test Loss: 1.130 Test Acc: 0.581
Validation loss decreased (-0.581069 --> -0.581070).  Saving model ...
Epoch: 12 cost time: 3.866834878921509
Epoch: 12, Steps: 10 | Train Loss: 0.287 Vali Loss: 1.269 Vali Acc: 0.527 Test Loss: 1.269 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.122471332550049
Epoch: 13, Steps: 10 | Train Loss: 0.190 Vali Loss: 1.163 Vali Acc: 0.581 Test Loss: 1.163 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.6663382053375244
Epoch: 14, Steps: 10 | Train Loss: 0.123 Vali Loss: 1.115 Vali Acc: 0.622 Test Loss: 1.115 Test Acc: 0.622
Validation loss decreased (-0.581070 --> -0.621610).  Saving model ...
Epoch: 15 cost time: 3.5279645919799805
Epoch: 15, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.184 Vali Acc: 0.581 Test Loss: 1.184 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.7391676902770996
Epoch: 16, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.298 Vali Acc: 0.568 Test Loss: 1.298 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.924614667892456
Epoch: 17, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.222 Vali Acc: 0.608 Test Loss: 1.222 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.047153949737549
Epoch: 18, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.320 Vali Acc: 0.608 Test Loss: 1.320 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.539318799972534
Epoch: 19, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.359 Vali Acc: 0.595 Test Loss: 1.359 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.9393906593322754
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.407 Vali Acc: 0.595 Test Loss: 1.407 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.4967398643493652
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.369 Vali Acc: 0.568 Test Loss: 1.369 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.9793331623077393
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.405 Vali Acc: 0.581 Test Loss: 1.405 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.958855152130127
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.410 Vali Acc: 0.595 Test Loss: 1.410 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.743161678314209
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.413 Vali Acc: 0.595 Test Loss: 1.413 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 3097024
model size : 14.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.495652437210083
Epoch: 1, Steps: 10 | Train Loss: 1.467 Vali Loss: 1.486 Vali Acc: 0.378 Test Loss: 1.486 Test Acc: 0.378
Validation loss decreased (inf --> -0.378364).  Saving model ...
Epoch: 2 cost time: 3.4908621311187744
Epoch: 2, Steps: 10 | Train Loss: 1.409 Vali Loss: 1.493 Vali Acc: 0.216 Test Loss: 1.493 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.2633354663848877
Epoch: 3, Steps: 10 | Train Loss: 1.429 Vali Loss: 1.506 Vali Acc: 0.338 Test Loss: 1.506 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.388493299484253
Epoch: 4, Steps: 10 | Train Loss: 1.307 Vali Loss: 1.313 Vali Acc: 0.419 Test Loss: 1.313 Test Acc: 0.419
Validation loss decreased (-0.378364 --> -0.418906).  Saving model ...
Epoch: 5 cost time: 3.393097400665283
Epoch: 5, Steps: 10 | Train Loss: 1.114 Vali Loss: 1.239 Vali Acc: 0.392 Test Loss: 1.239 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.7109174728393555
Epoch: 6, Steps: 10 | Train Loss: 0.964 Vali Loss: 1.308 Vali Acc: 0.392 Test Loss: 1.308 Test Acc: 0.392
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.803025722503662
Epoch: 7, Steps: 10 | Train Loss: 0.814 Vali Loss: 1.284 Vali Acc: 0.405 Test Loss: 1.284 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.7010228633880615
Epoch: 8, Steps: 10 | Train Loss: 0.668 Vali Loss: 1.449 Vali Acc: 0.459 Test Loss: 1.449 Test Acc: 0.459
Validation loss decreased (-0.418906 --> -0.459445).  Saving model ...
Epoch: 9 cost time: 3.1533150672912598
Epoch: 9, Steps: 10 | Train Loss: 0.601 Vali Loss: 1.626 Vali Acc: 0.446 Test Loss: 1.626 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.6424098014831543
Epoch: 10, Steps: 10 | Train Loss: 0.565 Vali Loss: 1.191 Vali Acc: 0.486 Test Loss: 1.191 Test Acc: 0.486
Validation loss decreased (-0.459445 --> -0.486475).  Saving model ...
Epoch: 11 cost time: 3.6973774433135986
Epoch: 11, Steps: 10 | Train Loss: 0.343 Vali Loss: 1.214 Vali Acc: 0.541 Test Loss: 1.214 Test Acc: 0.541
Validation loss decreased (-0.486475 --> -0.540528).  Saving model ...
Epoch: 12 cost time: 3.519686460494995
Epoch: 12, Steps: 10 | Train Loss: 0.232 Vali Loss: 1.209 Vali Acc: 0.500 Test Loss: 1.209 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.30265736579895
Epoch: 13, Steps: 10 | Train Loss: 0.191 Vali Loss: 1.301 Vali Acc: 0.486 Test Loss: 1.301 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.761650562286377
Epoch: 14, Steps: 10 | Train Loss: 0.130 Vali Loss: 1.338 Vali Acc: 0.514 Test Loss: 1.338 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.279137134552002
Epoch: 15, Steps: 10 | Train Loss: 0.079 Vali Loss: 1.383 Vali Acc: 0.541 Test Loss: 1.383 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.544936418533325
Epoch: 16, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.803 Vali Acc: 0.554 Test Loss: 1.803 Test Acc: 0.554
Validation loss decreased (-0.540528 --> -0.554036).  Saving model ...
Epoch: 17 cost time: 2.8796677589416504
Epoch: 17, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.383 Vali Acc: 0.554 Test Loss: 1.383 Test Acc: 0.554
Validation loss decreased (-0.554036 --> -0.554040).  Saving model ...
Epoch: 18 cost time: 3.0405428409576416
Epoch: 18, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.404 Vali Acc: 0.581 Test Loss: 1.404 Test Acc: 0.581
Validation loss decreased (-0.554040 --> -0.581067).  Saving model ...
Epoch: 19 cost time: 2.918804168701172
Epoch: 19, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.391 Vali Acc: 0.581 Test Loss: 1.391 Test Acc: 0.581
Validation loss decreased (-0.581067 --> -0.581067).  Saving model ...
Epoch: 20 cost time: 3.1344096660614014
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.440 Vali Acc: 0.554 Test Loss: 1.440 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.10348916053772
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.435 Vali Acc: 0.581 Test Loss: 1.435 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.3379857540130615
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.515 Vali Acc: 0.554 Test Loss: 1.515 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.9291114807128906
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.531 Vali Acc: 0.554 Test Loss: 1.531 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.748321533203125
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.549 Vali Acc: 0.554 Test Loss: 1.549 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.564363718032837
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.549 Vali Acc: 0.541 Test Loss: 1.549 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.558494806289673
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.573 Vali Acc: 0.541 Test Loss: 1.573 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.9234108924865723
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.571 Vali Acc: 0.554 Test Loss: 1.571 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.7041685581207275
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.582 Vali Acc: 0.541 Test Loss: 1.582 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.0886330604553223
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.605 Vali Acc: 0.541 Test Loss: 1.605 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 3088704
model size : 14.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.167705059051514
Epoch: 1, Steps: 10 | Train Loss: 1.424 Vali Loss: 1.475 Vali Acc: 0.203 Test Loss: 1.475 Test Acc: 0.203
Validation loss decreased (inf --> -0.202688).  Saving model ...
Epoch: 2 cost time: 3.4296762943267822
Epoch: 2, Steps: 10 | Train Loss: 1.444 Vali Loss: 1.296 Vali Acc: 0.338 Test Loss: 1.296 Test Acc: 0.338
Validation loss decreased (-0.202688 --> -0.337825).  Saving model ...
Epoch: 3 cost time: 3.309852361679077
Epoch: 3, Steps: 10 | Train Loss: 1.350 Vali Loss: 1.396 Vali Acc: 0.297 Test Loss: 1.396 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.5797693729400635
Epoch: 4, Steps: 10 | Train Loss: 1.340 Vali Loss: 1.422 Vali Acc: 0.230 Test Loss: 1.422 Test Acc: 0.230
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.301316022872925
Epoch: 5, Steps: 10 | Train Loss: 1.158 Vali Loss: 1.240 Vali Acc: 0.432 Test Loss: 1.240 Test Acc: 0.432
Validation loss decreased (-0.337825 --> -0.432420).  Saving model ...
Epoch: 6 cost time: 3.5462653636932373
Epoch: 6, Steps: 10 | Train Loss: 1.006 Vali Loss: 1.426 Vali Acc: 0.378 Test Loss: 1.426 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.9096739292144775
Epoch: 7, Steps: 10 | Train Loss: 0.892 Vali Loss: 1.260 Vali Acc: 0.486 Test Loss: 1.260 Test Acc: 0.486
Validation loss decreased (-0.432420 --> -0.486474).  Saving model ...
Epoch: 8 cost time: 3.7737889289855957
Epoch: 8, Steps: 10 | Train Loss: 0.753 Vali Loss: 1.177 Vali Acc: 0.405 Test Loss: 1.177 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.283658504486084
Epoch: 9, Steps: 10 | Train Loss: 0.696 Vali Loss: 1.345 Vali Acc: 0.459 Test Loss: 1.345 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.6341567039489746
Epoch: 10, Steps: 10 | Train Loss: 0.557 Vali Loss: 1.214 Vali Acc: 0.554 Test Loss: 1.214 Test Acc: 0.554
Validation loss decreased (-0.486474 --> -0.554042).  Saving model ...
Epoch: 11 cost time: 3.708343982696533
Epoch: 11, Steps: 10 | Train Loss: 0.380 Vali Loss: 1.191 Vali Acc: 0.541 Test Loss: 1.191 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.4701123237609863
Epoch: 12, Steps: 10 | Train Loss: 0.256 Vali Loss: 1.109 Vali Acc: 0.500 Test Loss: 1.109 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.3690762519836426
Epoch: 13, Steps: 10 | Train Loss: 0.181 Vali Loss: 1.098 Vali Acc: 0.541 Test Loss: 1.098 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.5649030208587646
Epoch: 14, Steps: 10 | Train Loss: 0.133 Vali Loss: 1.296 Vali Acc: 0.514 Test Loss: 1.296 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.046426296234131
Epoch: 15, Steps: 10 | Train Loss: 0.071 Vali Loss: 1.253 Vali Acc: 0.568 Test Loss: 1.253 Test Acc: 0.568
Validation loss decreased (-0.554042 --> -0.567555).  Saving model ...
Epoch: 16 cost time: 3.1867024898529053
Epoch: 16, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.137 Vali Acc: 0.554 Test Loss: 1.137 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.360447883605957
Epoch: 17, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.260 Vali Acc: 0.568 Test Loss: 1.260 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.359881639480591
Epoch: 18, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.173 Vali Acc: 0.622 Test Loss: 1.173 Test Acc: 0.622
Validation loss decreased (-0.567555 --> -0.621610).  Saving model ...
Epoch: 19 cost time: 3.5786259174346924
Epoch: 19, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.275 Vali Acc: 0.608 Test Loss: 1.275 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.5758817195892334
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.219 Vali Acc: 0.595 Test Loss: 1.219 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.783010244369507
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.279 Vali Acc: 0.581 Test Loss: 1.279 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.659050703048706
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.265 Vali Acc: 0.595 Test Loss: 1.265 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.9359290599823
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.303 Vali Acc: 0.595 Test Loss: 1.303 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.511098623275757
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.276 Vali Acc: 0.595 Test Loss: 1.276 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 4.019109725952148
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.294 Vali Acc: 0.581 Test Loss: 1.294 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.8846187591552734
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.294 Vali Acc: 0.581 Test Loss: 1.294 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.7477850914001465
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.319 Vali Acc: 0.595 Test Loss: 1.319 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 3.5730538368225098
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.348 Vali Acc: 0.595 Test Loss: 1.348 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 3080384
model size : 14.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.738117933273315
Epoch: 1, Steps: 10 | Train Loss: 1.461 Vali Loss: 1.558 Vali Acc: 0.203 Test Loss: 1.558 Test Acc: 0.203
Validation loss decreased (inf --> -0.202687).  Saving model ...
Epoch: 2 cost time: 2.8883280754089355
Epoch: 2, Steps: 10 | Train Loss: 1.467 Vali Loss: 1.318 Vali Acc: 0.405 Test Loss: 1.318 Test Acc: 0.405
Validation loss decreased (-0.202687 --> -0.405392).  Saving model ...
Epoch: 3 cost time: 2.824111223220825
Epoch: 3, Steps: 10 | Train Loss: 1.469 Vali Loss: 1.484 Vali Acc: 0.338 Test Loss: 1.484 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.0313880443573
Epoch: 4, Steps: 10 | Train Loss: 1.322 Vali Loss: 1.372 Vali Acc: 0.243 Test Loss: 1.372 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.8127899169921875
Epoch: 5, Steps: 10 | Train Loss: 1.174 Vali Loss: 1.261 Vali Acc: 0.378 Test Loss: 1.261 Test Acc: 0.378
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.660475730895996
Epoch: 6, Steps: 10 | Train Loss: 1.028 Vali Loss: 1.232 Vali Acc: 0.392 Test Loss: 1.232 Test Acc: 0.392
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.1964170932769775
Epoch: 7, Steps: 10 | Train Loss: 0.885 Vali Loss: 1.134 Vali Acc: 0.500 Test Loss: 1.134 Test Acc: 0.500
Validation loss decreased (-0.405392 --> -0.499989).  Saving model ...
Epoch: 8 cost time: 3.4137673377990723
Epoch: 8, Steps: 10 | Train Loss: 0.708 Vali Loss: 1.109 Vali Acc: 0.514 Test Loss: 1.109 Test Acc: 0.514
Validation loss decreased (-0.499989 --> -0.513502).  Saving model ...
Epoch: 9 cost time: 2.4999125003814697
Epoch: 9, Steps: 10 | Train Loss: 0.567 Vali Loss: 1.119 Vali Acc: 0.541 Test Loss: 1.119 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540529).  Saving model ...
Epoch: 10 cost time: 3.3939051628112793
Epoch: 10, Steps: 10 | Train Loss: 0.450 Vali Loss: 1.546 Vali Acc: 0.473 Test Loss: 1.546 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.5755934715270996
Epoch: 11, Steps: 10 | Train Loss: 0.407 Vali Loss: 1.271 Vali Acc: 0.514 Test Loss: 1.271 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.4948995113372803
Epoch: 12, Steps: 10 | Train Loss: 0.361 Vali Loss: 1.239 Vali Acc: 0.595 Test Loss: 1.239 Test Acc: 0.595
Validation loss decreased (-0.540529 --> -0.594582).  Saving model ...
Epoch: 13 cost time: 3.123243808746338
Epoch: 13, Steps: 10 | Train Loss: 0.199 Vali Loss: 1.360 Vali Acc: 0.527 Test Loss: 1.360 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.374786853790283
Epoch: 14, Steps: 10 | Train Loss: 0.122 Vali Loss: 1.335 Vali Acc: 0.541 Test Loss: 1.335 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.743673086166382
Epoch: 15, Steps: 10 | Train Loss: 0.095 Vali Loss: 1.330 Vali Acc: 0.541 Test Loss: 1.330 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.677100658416748
Epoch: 16, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.373 Vali Acc: 0.541 Test Loss: 1.373 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.0446619987487793
Epoch: 17, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.289 Vali Acc: 0.541 Test Loss: 1.289 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.666513442993164
Epoch: 18, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.393 Vali Acc: 0.581 Test Loss: 1.393 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.254852771759033
Epoch: 19, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.372 Vali Acc: 0.568 Test Loss: 1.372 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.737659215927124
Epoch: 20, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.466 Vali Acc: 0.595 Test Loss: 1.466 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.5739080905914307
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.400 Vali Acc: 0.554 Test Loss: 1.400 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.3179261684417725
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.428 Vali Acc: 0.595 Test Loss: 1.428 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 3072064
model size : 14.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.575438976287842
Epoch: 1, Steps: 10 | Train Loss: 1.441 Vali Loss: 1.414 Vali Acc: 0.270 Test Loss: 1.414 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 2.8101730346679688
Epoch: 2, Steps: 10 | Train Loss: 1.424 Vali Loss: 1.432 Vali Acc: 0.230 Test Loss: 1.432 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.380452871322632
Epoch: 3, Steps: 10 | Train Loss: 1.367 Vali Loss: 1.354 Vali Acc: 0.419 Test Loss: 1.354 Test Acc: 0.419
Validation loss decreased (-0.270256 --> -0.418905).  Saving model ...
Epoch: 4 cost time: 3.378610610961914
Epoch: 4, Steps: 10 | Train Loss: 1.433 Vali Loss: 1.545 Vali Acc: 0.216 Test Loss: 1.545 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.690822124481201
Epoch: 5, Steps: 10 | Train Loss: 1.231 Vali Loss: 1.331 Vali Acc: 0.365 Test Loss: 1.331 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.720207691192627
Epoch: 6, Steps: 10 | Train Loss: 1.125 Vali Loss: 1.359 Vali Acc: 0.351 Test Loss: 1.359 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.688664674758911
Epoch: 7, Steps: 10 | Train Loss: 0.927 Vali Loss: 1.239 Vali Acc: 0.432 Test Loss: 1.239 Test Acc: 0.432
Validation loss decreased (-0.418905 --> -0.432420).  Saving model ...
Epoch: 8 cost time: 3.654203414916992
Epoch: 8, Steps: 10 | Train Loss: 0.790 Vali Loss: 1.221 Vali Acc: 0.473 Test Loss: 1.221 Test Acc: 0.473
Validation loss decreased (-0.432420 --> -0.472961).  Saving model ...
Epoch: 9 cost time: 4.1249895095825195
Epoch: 9, Steps: 10 | Train Loss: 0.653 Vali Loss: 1.305 Vali Acc: 0.419 Test Loss: 1.305 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.442340135574341
Epoch: 10, Steps: 10 | Train Loss: 0.506 Vali Loss: 1.328 Vali Acc: 0.432 Test Loss: 1.328 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.703298330307007
Epoch: 11, Steps: 10 | Train Loss: 0.423 Vali Loss: 1.223 Vali Acc: 0.500 Test Loss: 1.223 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499988).  Saving model ...
Epoch: 12 cost time: 3.7866036891937256
Epoch: 12, Steps: 10 | Train Loss: 0.327 Vali Loss: 1.238 Vali Acc: 0.568 Test Loss: 1.238 Test Acc: 0.568
Validation loss decreased (-0.499988 --> -0.567555).  Saving model ...
Epoch: 13 cost time: 3.099141836166382
Epoch: 13, Steps: 10 | Train Loss: 0.217 Vali Loss: 1.275 Vali Acc: 0.541 Test Loss: 1.275 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.1248440742492676
Epoch: 14, Steps: 10 | Train Loss: 0.134 Vali Loss: 1.262 Vali Acc: 0.568 Test Loss: 1.262 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.0138869285583496
Epoch: 15, Steps: 10 | Train Loss: 0.073 Vali Loss: 1.384 Vali Acc: 0.527 Test Loss: 1.384 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.083993673324585
Epoch: 16, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.742 Vali Acc: 0.514 Test Loss: 1.742 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.164921522140503
Epoch: 17, Steps: 10 | Train Loss: 0.061 Vali Loss: 1.456 Vali Acc: 0.527 Test Loss: 1.456 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.30064058303833
Epoch: 18, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.560 Vali Acc: 0.541 Test Loss: 1.560 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.8773245811462402
Epoch: 19, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.628 Vali Acc: 0.514 Test Loss: 1.628 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.064566612243652
Epoch: 20, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.509 Vali Acc: 0.568 Test Loss: 1.509 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.117966175079346
Epoch: 21, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.493 Vali Acc: 0.581 Test Loss: 1.493 Test Acc: 0.581
Validation loss decreased (-0.567555 --> -0.581066).  Saving model ...
Epoch: 22 cost time: 3.8884780406951904
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.495 Vali Acc: 0.595 Test Loss: 1.495 Test Acc: 0.595
Validation loss decreased (-0.581066 --> -0.594580).  Saving model ...
Epoch: 23 cost time: 3.2084200382232666
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.524 Vali Acc: 0.581 Test Loss: 1.524 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.87807297706604
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.534 Vali Acc: 0.568 Test Loss: 1.534 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.6022512912750244
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.545 Vali Acc: 0.568 Test Loss: 1.545 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.905515670776367
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.550 Vali Acc: 0.568 Test Loss: 1.550 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.993628740310669
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.564 Vali Acc: 0.568 Test Loss: 1.564 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.8377766609191895
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.587 Vali Acc: 0.568 Test Loss: 1.587 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.7992665767669678
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.589 Vali Acc: 0.568 Test Loss: 1.589 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.718916654586792
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.593 Vali Acc: 0.568 Test Loss: 1.593 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 3.783991575241089
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.603 Vali Acc: 0.581 Test Loss: 1.603 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 3.371184825897217
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.607 Vali Acc: 0.568 Test Loss: 1.607 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 2800960
model size : 13.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.652637481689453
Epoch: 1, Steps: 10 | Train Loss: 1.508 Vali Loss: 1.495 Vali Acc: 0.297 Test Loss: 1.495 Test Acc: 0.297
Validation loss decreased (inf --> -0.297282).  Saving model ...
Epoch: 2 cost time: 2.9997291564941406
Epoch: 2, Steps: 10 | Train Loss: 1.469 Vali Loss: 1.320 Vali Acc: 0.324 Test Loss: 1.320 Test Acc: 0.324
Validation loss decreased (-0.297282 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 4.0567545890808105
Epoch: 3, Steps: 10 | Train Loss: 1.361 Vali Loss: 1.355 Vali Acc: 0.338 Test Loss: 1.355 Test Acc: 0.338
Validation loss decreased (-0.324311 --> -0.337824).  Saving model ...
Epoch: 4 cost time: 2.9473378658294678
Epoch: 4, Steps: 10 | Train Loss: 1.336 Vali Loss: 1.371 Vali Acc: 0.378 Test Loss: 1.371 Test Acc: 0.378
Validation loss decreased (-0.337824 --> -0.378365).  Saving model ...
Epoch: 5 cost time: 3.847165107727051
Epoch: 5, Steps: 10 | Train Loss: 1.147 Vali Loss: 1.284 Vali Acc: 0.378 Test Loss: 1.284 Test Acc: 0.378
Validation loss decreased (-0.378365 --> -0.378366).  Saving model ...
Epoch: 6 cost time: 2.9650120735168457
Epoch: 6, Steps: 10 | Train Loss: 1.010 Vali Loss: 1.282 Vali Acc: 0.446 Test Loss: 1.282 Test Acc: 0.446
Validation loss decreased (-0.378366 --> -0.445933).  Saving model ...
Epoch: 7 cost time: 3.726060390472412
Epoch: 7, Steps: 10 | Train Loss: 0.842 Vali Loss: 1.235 Vali Acc: 0.459 Test Loss: 1.235 Test Acc: 0.459
Validation loss decreased (-0.445933 --> -0.459447).  Saving model ...
Epoch: 8 cost time: 3.518005847930908
Epoch: 8, Steps: 10 | Train Loss: 0.723 Vali Loss: 1.326 Vali Acc: 0.446 Test Loss: 1.326 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.5603246688842773
Epoch: 9, Steps: 10 | Train Loss: 0.608 Vali Loss: 1.182 Vali Acc: 0.514 Test Loss: 1.182 Test Acc: 0.514
Validation loss decreased (-0.459447 --> -0.513502).  Saving model ...
Epoch: 10 cost time: 3.5666005611419678
Epoch: 10, Steps: 10 | Train Loss: 0.491 Vali Loss: 1.175 Vali Acc: 0.514 Test Loss: 1.175 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513502).  Saving model ...
Epoch: 11 cost time: 3.680819272994995
Epoch: 11, Steps: 10 | Train Loss: 0.348 Vali Loss: 1.141 Vali Acc: 0.541 Test Loss: 1.141 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540529).  Saving model ...
Epoch: 12 cost time: 3.8539962768554688
Epoch: 12, Steps: 10 | Train Loss: 0.279 Vali Loss: 1.157 Vali Acc: 0.554 Test Loss: 1.157 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554042).  Saving model ...
Epoch: 13 cost time: 3.776583433151245
Epoch: 13, Steps: 10 | Train Loss: 0.206 Vali Loss: 1.222 Vali Acc: 0.595 Test Loss: 1.222 Test Acc: 0.595
Validation loss decreased (-0.554042 --> -0.594582).  Saving model ...
Epoch: 14 cost time: 3.7339224815368652
Epoch: 14, Steps: 10 | Train Loss: 0.116 Vali Loss: 1.445 Vali Acc: 0.554 Test Loss: 1.445 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.938681125640869
Epoch: 15, Steps: 10 | Train Loss: 0.094 Vali Loss: 1.397 Vali Acc: 0.568 Test Loss: 1.397 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.268537282943726
Epoch: 16, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.346 Vali Acc: 0.554 Test Loss: 1.346 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.4492053985595703
Epoch: 17, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.423 Vali Acc: 0.554 Test Loss: 1.423 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.8234403133392334
Epoch: 18, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.379 Vali Acc: 0.568 Test Loss: 1.379 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.065085172653198
Epoch: 19, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.457 Vali Acc: 0.568 Test Loss: 1.457 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.089967727661133
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.427 Vali Acc: 0.527 Test Loss: 1.427 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.5398452281951904
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.443 Vali Acc: 0.568 Test Loss: 1.443 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.1087563037872314
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.496 Vali Acc: 0.554 Test Loss: 1.496 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.779094696044922
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.475 Vali Acc: 0.541 Test Loss: 1.475 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 2792640
model size : 13.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.2282774448394775
Epoch: 1, Steps: 10 | Train Loss: 1.575 Vali Loss: 1.585 Vali Acc: 0.189 Test Loss: 1.585 Test Acc: 0.189
Validation loss decreased (inf --> -0.189173).  Saving model ...
Epoch: 2 cost time: 3.079249382019043
Epoch: 2, Steps: 10 | Train Loss: 1.492 Vali Loss: 1.471 Vali Acc: 0.243 Test Loss: 1.471 Test Acc: 0.243
Validation loss decreased (-0.189173 --> -0.243229).  Saving model ...
Epoch: 3 cost time: 2.3972184658050537
Epoch: 3, Steps: 10 | Train Loss: 1.415 Vali Loss: 1.299 Vali Acc: 0.459 Test Loss: 1.299 Test Acc: 0.459
Validation loss decreased (-0.243229 --> -0.459446).  Saving model ...
Epoch: 4 cost time: 2.4814484119415283
Epoch: 4, Steps: 10 | Train Loss: 1.245 Vali Loss: 1.420 Vali Acc: 0.270 Test Loss: 1.420 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.9617929458618164
Epoch: 5, Steps: 10 | Train Loss: 1.155 Vali Loss: 1.271 Vali Acc: 0.500 Test Loss: 1.271 Test Acc: 0.500
Validation loss decreased (-0.459446 --> -0.499987).  Saving model ...
Epoch: 6 cost time: 2.6820271015167236
Epoch: 6, Steps: 10 | Train Loss: 1.038 Vali Loss: 1.202 Vali Acc: 0.527 Test Loss: 1.202 Test Acc: 0.527
Validation loss decreased (-0.499987 --> -0.527015).  Saving model ...
Epoch: 7 cost time: 2.3507866859436035
Epoch: 7, Steps: 10 | Train Loss: 0.917 Vali Loss: 1.288 Vali Acc: 0.419 Test Loss: 1.288 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.07308554649353
Epoch: 8, Steps: 10 | Train Loss: 0.714 Vali Loss: 1.198 Vali Acc: 0.500 Test Loss: 1.198 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.3498623371124268
Epoch: 9, Steps: 10 | Train Loss: 0.632 Vali Loss: 1.121 Vali Acc: 0.568 Test Loss: 1.121 Test Acc: 0.568
Validation loss decreased (-0.527015 --> -0.567556).  Saving model ...
Epoch: 10 cost time: 3.6410093307495117
Epoch: 10, Steps: 10 | Train Loss: 0.484 Vali Loss: 1.161 Vali Acc: 0.514 Test Loss: 1.161 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.2122833728790283
Epoch: 11, Steps: 10 | Train Loss: 0.395 Vali Loss: 1.090 Vali Acc: 0.554 Test Loss: 1.090 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.875688076019287
Epoch: 12, Steps: 10 | Train Loss: 0.282 Vali Loss: 1.221 Vali Acc: 0.541 Test Loss: 1.221 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.0540356636047363
Epoch: 13, Steps: 10 | Train Loss: 0.185 Vali Loss: 1.216 Vali Acc: 0.527 Test Loss: 1.216 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.585404872894287
Epoch: 14, Steps: 10 | Train Loss: 0.104 Vali Loss: 1.277 Vali Acc: 0.554 Test Loss: 1.277 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.989813804626465
Epoch: 15, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.395 Vali Acc: 0.527 Test Loss: 1.395 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.037684202194214
Epoch: 16, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.484 Vali Acc: 0.541 Test Loss: 1.484 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.25246000289917
Epoch: 17, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.356 Vali Acc: 0.500 Test Loss: 1.356 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.6854376792907715
Epoch: 18, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.509 Vali Acc: 0.541 Test Loss: 1.509 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.4206154346466064
Epoch: 19, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.477 Vali Acc: 0.527 Test Loss: 1.477 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 2784320
model size : 13.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.805164337158203
Epoch: 1, Steps: 10 | Train Loss: 1.479 Vali Loss: 1.480 Vali Acc: 0.216 Test Loss: 1.480 Test Acc: 0.216
Validation loss decreased (inf --> -0.216201).  Saving model ...
Epoch: 2 cost time: 3.689298391342163
Epoch: 2, Steps: 10 | Train Loss: 1.424 Vali Loss: 1.333 Vali Acc: 0.338 Test Loss: 1.333 Test Acc: 0.338
Validation loss decreased (-0.216201 --> -0.337825).  Saving model ...
Epoch: 3 cost time: 3.405731439590454
Epoch: 3, Steps: 10 | Train Loss: 1.361 Vali Loss: 1.622 Vali Acc: 0.230 Test Loss: 1.622 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.346787452697754
Epoch: 4, Steps: 10 | Train Loss: 1.275 Vali Loss: 1.297 Vali Acc: 0.392 Test Loss: 1.297 Test Acc: 0.392
Validation loss decreased (-0.337825 --> -0.391879).  Saving model ...
Epoch: 5 cost time: 3.4251437187194824
Epoch: 5, Steps: 10 | Train Loss: 1.196 Vali Loss: 1.350 Vali Acc: 0.284 Test Loss: 1.350 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.372753381729126
Epoch: 6, Steps: 10 | Train Loss: 1.017 Vali Loss: 1.307 Vali Acc: 0.432 Test Loss: 1.307 Test Acc: 0.432
Validation loss decreased (-0.391879 --> -0.432419).  Saving model ...
Epoch: 7 cost time: 2.956376314163208
Epoch: 7, Steps: 10 | Train Loss: 0.894 Vali Loss: 1.225 Vali Acc: 0.432 Test Loss: 1.225 Test Acc: 0.432
Validation loss decreased (-0.432419 --> -0.432420).  Saving model ...
Epoch: 8 cost time: 3.300546884536743
Epoch: 8, Steps: 10 | Train Loss: 0.732 Vali Loss: 1.291 Vali Acc: 0.446 Test Loss: 1.291 Test Acc: 0.446
Validation loss decreased (-0.432420 --> -0.445933).  Saving model ...
Epoch: 9 cost time: 2.8261539936065674
Epoch: 9, Steps: 10 | Train Loss: 0.656 Vali Loss: 1.295 Vali Acc: 0.419 Test Loss: 1.295 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.925436019897461
Epoch: 10, Steps: 10 | Train Loss: 0.503 Vali Loss: 1.229 Vali Acc: 0.554 Test Loss: 1.229 Test Acc: 0.554
Validation loss decreased (-0.445933 --> -0.554042).  Saving model ...
Epoch: 11 cost time: 2.6006102561950684
Epoch: 11, Steps: 10 | Train Loss: 0.437 Vali Loss: 1.167 Vali Acc: 0.500 Test Loss: 1.167 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.6799468994140625
Epoch: 12, Steps: 10 | Train Loss: 0.294 Vali Loss: 1.123 Vali Acc: 0.581 Test Loss: 1.123 Test Acc: 0.581
Validation loss decreased (-0.554042 --> -0.581070).  Saving model ...
Epoch: 13 cost time: 3.5868289470672607
Epoch: 13, Steps: 10 | Train Loss: 0.202 Vali Loss: 1.155 Vali Acc: 0.554 Test Loss: 1.155 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.314549684524536
Epoch: 14, Steps: 10 | Train Loss: 0.170 Vali Loss: 1.349 Vali Acc: 0.514 Test Loss: 1.349 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.6396427154541016
Epoch: 15, Steps: 10 | Train Loss: 0.096 Vali Loss: 1.241 Vali Acc: 0.527 Test Loss: 1.241 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.959899663925171
Epoch: 16, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.219 Vali Acc: 0.568 Test Loss: 1.219 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.2603888511657715
Epoch: 17, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.154 Vali Acc: 0.608 Test Loss: 1.154 Test Acc: 0.608
Validation loss decreased (-0.581070 --> -0.608097).  Saving model ...
Epoch: 18 cost time: 3.446657180786133
Epoch: 18, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.361 Vali Acc: 0.486 Test Loss: 1.361 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.223860263824463
Epoch: 19, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.224 Vali Acc: 0.608 Test Loss: 1.224 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.971531867980957
Epoch: 20, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.270 Vali Acc: 0.581 Test Loss: 1.270 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.252715826034546
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.304 Vali Acc: 0.608 Test Loss: 1.304 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.8236305713653564
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.363 Vali Acc: 0.527 Test Loss: 1.363 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.676187753677368
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.322 Vali Acc: 0.595 Test Loss: 1.322 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.8521838188171387
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.344 Vali Acc: 0.568 Test Loss: 1.344 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.667217493057251
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.339 Vali Acc: 0.595 Test Loss: 1.339 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.476911783218384
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.338 Vali Acc: 0.595 Test Loss: 1.338 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.7743730545043945
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.354 Vali Acc: 0.568 Test Loss: 1.354 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 2776000
model size : 13.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.059757709503174
Epoch: 1, Steps: 10 | Train Loss: 1.608 Vali Loss: 1.483 Vali Acc: 0.149 Test Loss: 1.483 Test Acc: 0.149
Validation loss decreased (inf --> -0.148634).  Saving model ...
Epoch: 2 cost time: 3.0501708984375
Epoch: 2, Steps: 10 | Train Loss: 1.406 Vali Loss: 1.362 Vali Acc: 0.311 Test Loss: 1.362 Test Acc: 0.311
Validation loss decreased (-0.148634 --> -0.310797).  Saving model ...
Epoch: 3 cost time: 2.635847330093384
Epoch: 3, Steps: 10 | Train Loss: 1.405 Vali Loss: 1.453 Vali Acc: 0.189 Test Loss: 1.453 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.2192609310150146
Epoch: 4, Steps: 10 | Train Loss: 1.286 Vali Loss: 1.351 Vali Acc: 0.351 Test Loss: 1.351 Test Acc: 0.351
Validation loss decreased (-0.310797 --> -0.351338).  Saving model ...
Epoch: 5 cost time: 2.5302348136901855
Epoch: 5, Steps: 10 | Train Loss: 1.201 Vali Loss: 1.377 Vali Acc: 0.338 Test Loss: 1.377 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.2309458255767822
Epoch: 6, Steps: 10 | Train Loss: 1.100 Vali Loss: 1.235 Vali Acc: 0.473 Test Loss: 1.235 Test Acc: 0.473
Validation loss decreased (-0.351338 --> -0.472961).  Saving model ...
Epoch: 7 cost time: 2.7931466102600098
Epoch: 7, Steps: 10 | Train Loss: 0.925 Vali Loss: 1.266 Vali Acc: 0.419 Test Loss: 1.266 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.2226743698120117
Epoch: 8, Steps: 10 | Train Loss: 0.773 Vali Loss: 1.250 Vali Acc: 0.446 Test Loss: 1.250 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.1917521953582764
Epoch: 9, Steps: 10 | Train Loss: 0.665 Vali Loss: 1.185 Vali Acc: 0.486 Test Loss: 1.185 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486475).  Saving model ...
Epoch: 10 cost time: 3.1353092193603516
Epoch: 10, Steps: 10 | Train Loss: 0.558 Vali Loss: 1.290 Vali Acc: 0.432 Test Loss: 1.290 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.407205581665039
Epoch: 11, Steps: 10 | Train Loss: 0.424 Vali Loss: 1.181 Vali Acc: 0.514 Test Loss: 1.181 Test Acc: 0.514
Validation loss decreased (-0.486475 --> -0.513502).  Saving model ...
Epoch: 12 cost time: 2.9874651432037354
Epoch: 12, Steps: 10 | Train Loss: 0.344 Vali Loss: 1.207 Vali Acc: 0.541 Test Loss: 1.207 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540528).  Saving model ...
Epoch: 13 cost time: 2.6093521118164062
Epoch: 13, Steps: 10 | Train Loss: 0.263 Vali Loss: 1.187 Vali Acc: 0.486 Test Loss: 1.187 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.0329298973083496
Epoch: 14, Steps: 10 | Train Loss: 0.209 Vali Loss: 1.220 Vali Acc: 0.527 Test Loss: 1.220 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.7471954822540283
Epoch: 15, Steps: 10 | Train Loss: 0.129 Vali Loss: 1.252 Vali Acc: 0.500 Test Loss: 1.252 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.859736204147339
Epoch: 16, Steps: 10 | Train Loss: 0.106 Vali Loss: 1.351 Vali Acc: 0.514 Test Loss: 1.351 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.345088243484497
Epoch: 17, Steps: 10 | Train Loss: 0.080 Vali Loss: 1.372 Vali Acc: 0.554 Test Loss: 1.372 Test Acc: 0.554
Validation loss decreased (-0.540528 --> -0.554040).  Saving model ...
Epoch: 18 cost time: 2.951709508895874
Epoch: 18, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.316 Vali Acc: 0.541 Test Loss: 1.316 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.1858317852020264
Epoch: 19, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.367 Vali Acc: 0.500 Test Loss: 1.367 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.4895527362823486
Epoch: 20, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.381 Vali Acc: 0.554 Test Loss: 1.381 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.246366262435913
Epoch: 21, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.376 Vali Acc: 0.500 Test Loss: 1.376 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.2119009494781494
Epoch: 22, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.398 Vali Acc: 0.500 Test Loss: 1.398 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.566598415374756
Epoch: 23, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.435 Vali Acc: 0.514 Test Loss: 1.435 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.3468072414398193
Epoch: 24, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.431 Vali Acc: 0.500 Test Loss: 1.431 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.369065761566162
Epoch: 25, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.458 Vali Acc: 0.527 Test Loss: 1.458 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.969313859939575
Epoch: 26, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.467 Vali Acc: 0.514 Test Loss: 1.467 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.836658477783203
Epoch: 27, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.461 Vali Acc: 0.500 Test Loss: 1.461 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 1851520
model size : 8.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.830071449279785
Epoch: 1, Steps: 10 | Train Loss: 1.487 Vali Loss: 1.457 Vali Acc: 0.149 Test Loss: 1.457 Test Acc: 0.149
Validation loss decreased (inf --> -0.148634).  Saving model ...
Epoch: 2 cost time: 3.1520774364471436
Epoch: 2, Steps: 10 | Train Loss: 1.497 Vali Loss: 1.393 Vali Acc: 0.270 Test Loss: 1.393 Test Acc: 0.270
Validation loss decreased (-0.148634 --> -0.270256).  Saving model ...
Epoch: 3 cost time: 2.984363555908203
Epoch: 3, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.452 Vali Acc: 0.284 Test Loss: 1.452 Test Acc: 0.284
Validation loss decreased (-0.270256 --> -0.283769).  Saving model ...
Epoch: 4 cost time: 2.8908631801605225
Epoch: 4, Steps: 10 | Train Loss: 1.356 Vali Loss: 1.334 Vali Acc: 0.392 Test Loss: 1.334 Test Acc: 0.392
Validation loss decreased (-0.283769 --> -0.391879).  Saving model ...
Epoch: 5 cost time: 2.8081960678100586
Epoch: 5, Steps: 10 | Train Loss: 1.290 Vali Loss: 1.315 Vali Acc: 0.419 Test Loss: 1.315 Test Acc: 0.419
Validation loss decreased (-0.391879 --> -0.418906).  Saving model ...
Epoch: 6 cost time: 2.8286123275756836
Epoch: 6, Steps: 10 | Train Loss: 1.127 Vali Loss: 1.313 Vali Acc: 0.351 Test Loss: 1.313 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.0289440155029297
Epoch: 7, Steps: 10 | Train Loss: 1.014 Vali Loss: 1.176 Vali Acc: 0.554 Test Loss: 1.176 Test Acc: 0.554
Validation loss decreased (-0.418906 --> -0.554042).  Saving model ...
Epoch: 8 cost time: 3.013291120529175
Epoch: 8, Steps: 10 | Train Loss: 0.869 Vali Loss: 1.298 Vali Acc: 0.432 Test Loss: 1.298 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.222581386566162
Epoch: 9, Steps: 10 | Train Loss: 0.732 Vali Loss: 1.288 Vali Acc: 0.419 Test Loss: 1.288 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.1646127700805664
Epoch: 10, Steps: 10 | Train Loss: 0.647 Vali Loss: 1.129 Vali Acc: 0.527 Test Loss: 1.129 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.188675880432129
Epoch: 11, Steps: 10 | Train Loss: 0.512 Vali Loss: 1.233 Vali Acc: 0.527 Test Loss: 1.233 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.027254104614258
Epoch: 12, Steps: 10 | Train Loss: 0.429 Vali Loss: 1.183 Vali Acc: 0.486 Test Loss: 1.183 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.043936014175415
Epoch: 13, Steps: 10 | Train Loss: 0.343 Vali Loss: 1.157 Vali Acc: 0.541 Test Loss: 1.157 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.887739658355713
Epoch: 14, Steps: 10 | Train Loss: 0.267 Vali Loss: 1.251 Vali Acc: 0.541 Test Loss: 1.251 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.0924766063690186
Epoch: 15, Steps: 10 | Train Loss: 0.204 Vali Loss: 1.284 Vali Acc: 0.568 Test Loss: 1.284 Test Acc: 0.568
Validation loss decreased (-0.554042 --> -0.567555).  Saving model ...
Epoch: 16 cost time: 3.134361982345581
Epoch: 16, Steps: 10 | Train Loss: 0.160 Vali Loss: 1.166 Vali Acc: 0.568 Test Loss: 1.166 Test Acc: 0.568
Validation loss decreased (-0.567555 --> -0.567556).  Saving model ...
Epoch: 17 cost time: 3.1153616905212402
Epoch: 17, Steps: 10 | Train Loss: 0.107 Vali Loss: 1.274 Vali Acc: 0.554 Test Loss: 1.274 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.6096949577331543
Epoch: 18, Steps: 10 | Train Loss: 0.065 Vali Loss: 1.110 Vali Acc: 0.581 Test Loss: 1.110 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581070).  Saving model ...
Epoch: 19 cost time: 2.968594551086426
Epoch: 19, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.211 Vali Acc: 0.568 Test Loss: 1.211 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.697889566421509
Epoch: 20, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.211 Vali Acc: 0.554 Test Loss: 1.211 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.6546363830566406
Epoch: 21, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.217 Vali Acc: 0.568 Test Loss: 1.217 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.813383102416992
Epoch: 22, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.218 Vali Acc: 0.541 Test Loss: 1.218 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.7584586143493652
Epoch: 23, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.254 Vali Acc: 0.581 Test Loss: 1.254 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.373570442199707
Epoch: 24, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.198 Vali Acc: 0.554 Test Loss: 1.198 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.8490827083587646
Epoch: 25, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.252 Vali Acc: 0.554 Test Loss: 1.252 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.425555467605591
Epoch: 26, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.232 Vali Acc: 0.541 Test Loss: 1.232 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.7327921390533447
Epoch: 27, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.237 Vali Acc: 0.568 Test Loss: 1.237 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.9665043354034424
Epoch: 28, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.296 Vali Acc: 0.541 Test Loss: 1.296 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 1847360
model size : 8.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.943456172943115
Epoch: 1, Steps: 10 | Train Loss: 1.456 Vali Loss: 1.356 Vali Acc: 0.392 Test Loss: 1.356 Test Acc: 0.392
Validation loss decreased (inf --> -0.391878).  Saving model ...
Epoch: 2 cost time: 2.708493947982788
Epoch: 2, Steps: 10 | Train Loss: 1.360 Vali Loss: 1.454 Vali Acc: 0.216 Test Loss: 1.454 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.980137825012207
Epoch: 3, Steps: 10 | Train Loss: 1.411 Vali Loss: 1.347 Vali Acc: 0.351 Test Loss: 1.347 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.7559750080108643
Epoch: 4, Steps: 10 | Train Loss: 1.264 Vali Loss: 1.420 Vali Acc: 0.338 Test Loss: 1.420 Test Acc: 0.338
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.565223455429077
Epoch: 5, Steps: 10 | Train Loss: 1.169 Vali Loss: 1.221 Vali Acc: 0.432 Test Loss: 1.221 Test Acc: 0.432
Validation loss decreased (-0.391878 --> -0.432420).  Saving model ...
Epoch: 6 cost time: 2.6219873428344727
Epoch: 6, Steps: 10 | Train Loss: 1.015 Vali Loss: 1.341 Vali Acc: 0.392 Test Loss: 1.341 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.950212240219116
Epoch: 7, Steps: 10 | Train Loss: 0.948 Vali Loss: 1.205 Vali Acc: 0.486 Test Loss: 1.205 Test Acc: 0.486
Validation loss decreased (-0.432420 --> -0.486474).  Saving model ...
Epoch: 8 cost time: 3.070925712585449
Epoch: 8, Steps: 10 | Train Loss: 0.824 Vali Loss: 1.196 Vali Acc: 0.473 Test Loss: 1.196 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.758934259414673
Epoch: 9, Steps: 10 | Train Loss: 0.726 Vali Loss: 1.272 Vali Acc: 0.486 Test Loss: 1.272 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.732125759124756
Epoch: 10, Steps: 10 | Train Loss: 0.583 Vali Loss: 1.171 Vali Acc: 0.541 Test Loss: 1.171 Test Acc: 0.541
Validation loss decreased (-0.486474 --> -0.540529).  Saving model ...
Epoch: 11 cost time: 2.6575229167938232
Epoch: 11, Steps: 10 | Train Loss: 0.459 Vali Loss: 1.152 Vali Acc: 0.554 Test Loss: 1.152 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554043).  Saving model ...
Epoch: 12 cost time: 2.5969948768615723
Epoch: 12, Steps: 10 | Train Loss: 0.391 Vali Loss: 1.109 Vali Acc: 0.527 Test Loss: 1.109 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.760993242263794
Epoch: 13, Steps: 10 | Train Loss: 0.290 Vali Loss: 1.212 Vali Acc: 0.514 Test Loss: 1.212 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.812598466873169
Epoch: 14, Steps: 10 | Train Loss: 0.210 Vali Loss: 1.251 Vali Acc: 0.527 Test Loss: 1.251 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.6636767387390137
Epoch: 15, Steps: 10 | Train Loss: 0.162 Vali Loss: 1.188 Vali Acc: 0.581 Test Loss: 1.188 Test Acc: 0.581
Validation loss decreased (-0.554043 --> -0.581069).  Saving model ...
Epoch: 16 cost time: 2.3857688903808594
Epoch: 16, Steps: 10 | Train Loss: 0.132 Vali Loss: 1.228 Vali Acc: 0.500 Test Loss: 1.228 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.1854605674743652
Epoch: 17, Steps: 10 | Train Loss: 0.084 Vali Loss: 1.328 Vali Acc: 0.514 Test Loss: 1.328 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.021792411804199
Epoch: 18, Steps: 10 | Train Loss: 0.064 Vali Loss: 1.293 Vali Acc: 0.500 Test Loss: 1.293 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.615760087966919
Epoch: 19, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.266 Vali Acc: 0.527 Test Loss: 1.266 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.9242899417877197
Epoch: 20, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.313 Vali Acc: 0.541 Test Loss: 1.313 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.259387969970703
Epoch: 21, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.345 Vali Acc: 0.473 Test Loss: 1.345 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.2399187088012695
Epoch: 22, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.319 Vali Acc: 0.541 Test Loss: 1.319 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.020989418029785
Epoch: 23, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.343 Vali Acc: 0.500 Test Loss: 1.343 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.2315096855163574
Epoch: 24, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.327 Vali Acc: 0.514 Test Loss: 1.327 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.7441539764404297
Epoch: 25, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.335 Vali Acc: 0.541 Test Loss: 1.335 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 1843200
model size : 8.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.982290983200073
Epoch: 1, Steps: 10 | Train Loss: 1.473 Vali Loss: 1.406 Vali Acc: 0.203 Test Loss: 1.406 Test Acc: 0.203
Validation loss decreased (inf --> -0.202689).  Saving model ...
Epoch: 2 cost time: 3.0972354412078857
Epoch: 2, Steps: 10 | Train Loss: 1.411 Vali Loss: 1.418 Vali Acc: 0.230 Test Loss: 1.418 Test Acc: 0.230
Validation loss decreased (-0.202689 --> -0.229716).  Saving model ...
Epoch: 3 cost time: 2.7501678466796875
Epoch: 3, Steps: 10 | Train Loss: 1.334 Vali Loss: 1.381 Vali Acc: 0.297 Test Loss: 1.381 Test Acc: 0.297
Validation loss decreased (-0.229716 --> -0.297283).  Saving model ...
Epoch: 4 cost time: 2.6439831256866455
Epoch: 4, Steps: 10 | Train Loss: 1.246 Vali Loss: 1.321 Vali Acc: 0.324 Test Loss: 1.321 Test Acc: 0.324
Validation loss decreased (-0.297283 --> -0.324311).  Saving model ...
Epoch: 5 cost time: 2.4644014835357666
Epoch: 5, Steps: 10 | Train Loss: 1.148 Vali Loss: 1.282 Vali Acc: 0.378 Test Loss: 1.282 Test Acc: 0.378
Validation loss decreased (-0.324311 --> -0.378366).  Saving model ...
Epoch: 6 cost time: 2.579631805419922
Epoch: 6, Steps: 10 | Train Loss: 1.078 Vali Loss: 1.398 Vali Acc: 0.297 Test Loss: 1.398 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.442640542984009
Epoch: 7, Steps: 10 | Train Loss: 0.957 Vali Loss: 1.208 Vali Acc: 0.446 Test Loss: 1.208 Test Acc: 0.446
Validation loss decreased (-0.378366 --> -0.445934).  Saving model ...
Epoch: 8 cost time: 2.5910515785217285
Epoch: 8, Steps: 10 | Train Loss: 0.849 Vali Loss: 1.298 Vali Acc: 0.405 Test Loss: 1.298 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.7748758792877197
Epoch: 9, Steps: 10 | Train Loss: 0.739 Vali Loss: 1.179 Vali Acc: 0.473 Test Loss: 1.179 Test Acc: 0.473
Validation loss decreased (-0.445934 --> -0.472961).  Saving model ...
Epoch: 10 cost time: 2.695201873779297
Epoch: 10, Steps: 10 | Train Loss: 0.608 Vali Loss: 1.179 Vali Acc: 0.514 Test Loss: 1.179 Test Acc: 0.514
Validation loss decreased (-0.472961 --> -0.513502).  Saving model ...
Epoch: 11 cost time: 2.8741910457611084
Epoch: 11, Steps: 10 | Train Loss: 0.481 Vali Loss: 1.188 Vali Acc: 0.527 Test Loss: 1.188 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527015).  Saving model ...
Epoch: 12 cost time: 3.0891737937927246
Epoch: 12, Steps: 10 | Train Loss: 0.367 Vali Loss: 1.191 Vali Acc: 0.514 Test Loss: 1.191 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.7573130130767822
Epoch: 13, Steps: 10 | Train Loss: 0.281 Vali Loss: 1.215 Vali Acc: 0.568 Test Loss: 1.215 Test Acc: 0.568
Validation loss decreased (-0.527015 --> -0.567555).  Saving model ...
Epoch: 14 cost time: 2.790109395980835
Epoch: 14, Steps: 10 | Train Loss: 0.212 Vali Loss: 1.264 Vali Acc: 0.446 Test Loss: 1.264 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.777902841567993
Epoch: 15, Steps: 10 | Train Loss: 0.138 Vali Loss: 1.135 Vali Acc: 0.581 Test Loss: 1.135 Test Acc: 0.581
Validation loss decreased (-0.567555 --> -0.581070).  Saving model ...
Epoch: 16 cost time: 3.077230215072632
Epoch: 16, Steps: 10 | Train Loss: 0.095 Vali Loss: 1.302 Vali Acc: 0.473 Test Loss: 1.302 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.0051381587982178
Epoch: 17, Steps: 10 | Train Loss: 0.078 Vali Loss: 1.296 Vali Acc: 0.541 Test Loss: 1.296 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.2377212047576904
Epoch: 18, Steps: 10 | Train Loss: 0.061 Vali Loss: 1.334 Vali Acc: 0.568 Test Loss: 1.334 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.0700411796569824
Epoch: 19, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.324 Vali Acc: 0.568 Test Loss: 1.324 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.0173168182373047
Epoch: 20, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.348 Vali Acc: 0.486 Test Loss: 1.348 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.3245534896850586
Epoch: 21, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.377 Vali Acc: 0.527 Test Loss: 1.377 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.785946846008301
Epoch: 22, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.401 Vali Acc: 0.486 Test Loss: 1.401 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.0451157093048096
Epoch: 23, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.468 Vali Acc: 0.527 Test Loss: 1.468 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.1571156978607178
Epoch: 24, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.419 Vali Acc: 0.541 Test Loss: 1.419 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.4123337268829346
Epoch: 25, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.447 Vali Acc: 0.514 Test Loss: 1.447 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 1839040
model size : 8.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.392879009246826
Epoch: 1, Steps: 10 | Train Loss: 1.472 Vali Loss: 1.374 Vali Acc: 0.270 Test Loss: 1.374 Test Acc: 0.270
Validation loss decreased (inf --> -0.270257).  Saving model ...
Epoch: 2 cost time: 2.863166570663452
Epoch: 2, Steps: 10 | Train Loss: 1.465 Vali Loss: 1.422 Vali Acc: 0.311 Test Loss: 1.422 Test Acc: 0.311
Validation loss decreased (-0.270257 --> -0.310797).  Saving model ...
Epoch: 3 cost time: 2.481861114501953
Epoch: 3, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.380 Vali Acc: 0.284 Test Loss: 1.380 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.1909213066101074
Epoch: 4, Steps: 10 | Train Loss: 1.351 Vali Loss: 1.346 Vali Acc: 0.270 Test Loss: 1.346 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.956566095352173
Epoch: 5, Steps: 10 | Train Loss: 1.293 Vali Loss: 1.258 Vali Acc: 0.500 Test Loss: 1.258 Test Acc: 0.500
Validation loss decreased (-0.310797 --> -0.499987).  Saving model ...
Epoch: 6 cost time: 3.3672397136688232
Epoch: 6, Steps: 10 | Train Loss: 1.214 Vali Loss: 1.318 Vali Acc: 0.405 Test Loss: 1.318 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.788114547729492
Epoch: 7, Steps: 10 | Train Loss: 1.127 Vali Loss: 1.179 Vali Acc: 0.514 Test Loss: 1.179 Test Acc: 0.514
Validation loss decreased (-0.499987 --> -0.513502).  Saving model ...
Epoch: 8 cost time: 3.1376748085021973
Epoch: 8, Steps: 10 | Train Loss: 0.976 Vali Loss: 1.170 Vali Acc: 0.486 Test Loss: 1.170 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.3467154502868652
Epoch: 9, Steps: 10 | Train Loss: 0.839 Vali Loss: 1.093 Vali Acc: 0.486 Test Loss: 1.093 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.898681640625
Epoch: 10, Steps: 10 | Train Loss: 0.724 Vali Loss: 1.048 Vali Acc: 0.554 Test Loss: 1.048 Test Acc: 0.554
Validation loss decreased (-0.513502 --> -0.554044).  Saving model ...
Epoch: 11 cost time: 2.9917662143707275
Epoch: 11, Steps: 10 | Train Loss: 0.631 Vali Loss: 1.029 Vali Acc: 0.500 Test Loss: 1.029 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.8811566829681396
Epoch: 12, Steps: 10 | Train Loss: 0.502 Vali Loss: 1.042 Vali Acc: 0.541 Test Loss: 1.042 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.6939053535461426
Epoch: 13, Steps: 10 | Train Loss: 0.426 Vali Loss: 1.046 Vali Acc: 0.581 Test Loss: 1.046 Test Acc: 0.581
Validation loss decreased (-0.554044 --> -0.581071).  Saving model ...
Epoch: 14 cost time: 3.0603487491607666
Epoch: 14, Steps: 10 | Train Loss: 0.349 Vali Loss: 1.072 Vali Acc: 0.595 Test Loss: 1.072 Test Acc: 0.595
Validation loss decreased (-0.581071 --> -0.594584).  Saving model ...
Epoch: 15 cost time: 2.387157917022705
Epoch: 15, Steps: 10 | Train Loss: 0.234 Vali Loss: 1.146 Vali Acc: 0.514 Test Loss: 1.146 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.9914019107818604
Epoch: 16, Steps: 10 | Train Loss: 0.214 Vali Loss: 1.160 Vali Acc: 0.500 Test Loss: 1.160 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.3552768230438232
Epoch: 17, Steps: 10 | Train Loss: 0.178 Vali Loss: 1.136 Vali Acc: 0.541 Test Loss: 1.136 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.3100547790527344
Epoch: 18, Steps: 10 | Train Loss: 0.108 Vali Loss: 1.081 Vali Acc: 0.541 Test Loss: 1.081 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.030116081237793
Epoch: 19, Steps: 10 | Train Loss: 0.076 Vali Loss: 1.116 Vali Acc: 0.554 Test Loss: 1.116 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.4307138919830322
Epoch: 20, Steps: 10 | Train Loss: 0.060 Vali Loss: 1.128 Vali Acc: 0.568 Test Loss: 1.128 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.2305543422698975
Epoch: 21, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.143 Vali Acc: 0.568 Test Loss: 1.143 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.7849583625793457
Epoch: 22, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.154 Vali Acc: 0.568 Test Loss: 1.154 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.175855875015259
Epoch: 23, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.216 Vali Acc: 0.541 Test Loss: 1.216 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.6984870433807373
Epoch: 24, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.214 Vali Acc: 0.541 Test Loss: 1.214 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 1257088
model size : 6.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.797097682952881
Epoch: 1, Steps: 10 | Train Loss: 1.561 Vali Loss: 1.375 Vali Acc: 0.270 Test Loss: 1.375 Test Acc: 0.270
Validation loss decreased (inf --> -0.270257).  Saving model ...
Epoch: 2 cost time: 3.17276930809021
Epoch: 2, Steps: 10 | Train Loss: 1.425 Vali Loss: 1.366 Vali Acc: 0.338 Test Loss: 1.366 Test Acc: 0.338
Validation loss decreased (-0.270257 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 2.7098934650421143
Epoch: 3, Steps: 10 | Train Loss: 1.374 Vali Loss: 1.386 Vali Acc: 0.297 Test Loss: 1.386 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.783921957015991
Epoch: 4, Steps: 10 | Train Loss: 1.318 Vali Loss: 1.299 Vali Acc: 0.405 Test Loss: 1.299 Test Acc: 0.405
Validation loss decreased (-0.337824 --> -0.405392).  Saving model ...
Epoch: 5 cost time: 2.9522945880889893
Epoch: 5, Steps: 10 | Train Loss: 1.225 Vali Loss: 1.307 Vali Acc: 0.419 Test Loss: 1.307 Test Acc: 0.419
Validation loss decreased (-0.405392 --> -0.418906).  Saving model ...
Epoch: 6 cost time: 2.975888729095459
Epoch: 6, Steps: 10 | Train Loss: 1.133 Vali Loss: 1.255 Vali Acc: 0.419 Test Loss: 1.255 Test Acc: 0.419
Validation loss decreased (-0.418906 --> -0.418906).  Saving model ...
Epoch: 7 cost time: 2.9034993648529053
Epoch: 7, Steps: 10 | Train Loss: 1.042 Vali Loss: 1.230 Vali Acc: 0.486 Test Loss: 1.230 Test Acc: 0.486
Validation loss decreased (-0.418906 --> -0.486474).  Saving model ...
Epoch: 8 cost time: 2.8785722255706787
Epoch: 8, Steps: 10 | Train Loss: 0.902 Vali Loss: 1.226 Vali Acc: 0.432 Test Loss: 1.226 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.340745687484741
Epoch: 9, Steps: 10 | Train Loss: 0.764 Vali Loss: 1.174 Vali Acc: 0.541 Test Loss: 1.174 Test Acc: 0.541
Validation loss decreased (-0.486474 --> -0.540529).  Saving model ...
Epoch: 10 cost time: 3.4607555866241455
Epoch: 10, Steps: 10 | Train Loss: 0.669 Vali Loss: 1.128 Vali Acc: 0.527 Test Loss: 1.128 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.0238196849823
Epoch: 11, Steps: 10 | Train Loss: 0.581 Vali Loss: 1.112 Vali Acc: 0.541 Test Loss: 1.112 Test Acc: 0.541
Validation loss decreased (-0.540529 --> -0.540529).  Saving model ...
Epoch: 12 cost time: 2.925473213195801
Epoch: 12, Steps: 10 | Train Loss: 0.477 Vali Loss: 1.099 Vali Acc: 0.554 Test Loss: 1.099 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554043).  Saving model ...
Epoch: 13 cost time: 2.913116693496704
Epoch: 13, Steps: 10 | Train Loss: 0.362 Vali Loss: 1.158 Vali Acc: 0.554 Test Loss: 1.158 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.852853298187256
Epoch: 14, Steps: 10 | Train Loss: 0.272 Vali Loss: 1.095 Vali Acc: 0.527 Test Loss: 1.095 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.6207785606384277
Epoch: 15, Steps: 10 | Train Loss: 0.209 Vali Loss: 1.153 Vali Acc: 0.568 Test Loss: 1.153 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567556).  Saving model ...
Epoch: 16 cost time: 2.6816585063934326
Epoch: 16, Steps: 10 | Train Loss: 0.162 Vali Loss: 1.332 Vali Acc: 0.500 Test Loss: 1.332 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.772338628768921
Epoch: 17, Steps: 10 | Train Loss: 0.130 Vali Loss: 1.247 Vali Acc: 0.527 Test Loss: 1.247 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.683720588684082
Epoch: 18, Steps: 10 | Train Loss: 0.100 Vali Loss: 1.214 Vali Acc: 0.514 Test Loss: 1.214 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.861514091491699
Epoch: 19, Steps: 10 | Train Loss: 0.063 Vali Loss: 1.196 Vali Acc: 0.500 Test Loss: 1.196 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.9304983615875244
Epoch: 20, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.202 Vali Acc: 0.541 Test Loss: 1.202 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.6327145099639893
Epoch: 21, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.226 Vali Acc: 0.541 Test Loss: 1.226 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.917895793914795
Epoch: 22, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.272 Vali Acc: 0.554 Test Loss: 1.272 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.5656192302703857
Epoch: 23, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.244 Vali Acc: 0.514 Test Loss: 1.244 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.008138418197632
Epoch: 24, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.288 Vali Acc: 0.541 Test Loss: 1.288 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.6304969787597656
Epoch: 25, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.275 Vali Acc: 0.500 Test Loss: 1.275 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 1252928
model size : 6.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.731866359710693
Epoch: 1, Steps: 10 | Train Loss: 1.461 Vali Loss: 1.478 Vali Acc: 0.243 Test Loss: 1.478 Test Acc: 0.243
Validation loss decreased (inf --> -0.243228).  Saving model ...
Epoch: 2 cost time: 2.9532508850097656
Epoch: 2, Steps: 10 | Train Loss: 1.422 Vali Loss: 1.368 Vali Acc: 0.284 Test Loss: 1.368 Test Acc: 0.284
Validation loss decreased (-0.243228 --> -0.283770).  Saving model ...
Epoch: 3 cost time: 2.478832244873047
Epoch: 3, Steps: 10 | Train Loss: 1.375 Vali Loss: 1.358 Vali Acc: 0.324 Test Loss: 1.358 Test Acc: 0.324
Validation loss decreased (-0.283770 --> -0.324311).  Saving model ...
Epoch: 4 cost time: 3.0293045043945312
Epoch: 4, Steps: 10 | Train Loss: 1.326 Vali Loss: 1.311 Vali Acc: 0.432 Test Loss: 1.311 Test Acc: 0.432
Validation loss decreased (-0.324311 --> -0.432419).  Saving model ...
Epoch: 5 cost time: 2.7811391353607178
Epoch: 5, Steps: 10 | Train Loss: 1.239 Vali Loss: 1.348 Vali Acc: 0.392 Test Loss: 1.348 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.6338820457458496
Epoch: 6, Steps: 10 | Train Loss: 1.112 Vali Loss: 1.255 Vali Acc: 0.405 Test Loss: 1.255 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.2134313583374023
Epoch: 7, Steps: 10 | Train Loss: 1.073 Vali Loss: 1.318 Vali Acc: 0.365 Test Loss: 1.318 Test Acc: 0.365
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.7200143337249756
Epoch: 8, Steps: 10 | Train Loss: 0.984 Vali Loss: 1.270 Vali Acc: 0.459 Test Loss: 1.270 Test Acc: 0.459
Validation loss decreased (-0.432419 --> -0.459447).  Saving model ...
Epoch: 9 cost time: 3.3858699798583984
Epoch: 9, Steps: 10 | Train Loss: 0.797 Vali Loss: 1.169 Vali Acc: 0.514 Test Loss: 1.169 Test Acc: 0.514
Validation loss decreased (-0.459447 --> -0.513502).  Saving model ...
Epoch: 10 cost time: 3.0294711589813232
Epoch: 10, Steps: 10 | Train Loss: 0.710 Vali Loss: 1.322 Vali Acc: 0.432 Test Loss: 1.322 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.6179397106170654
Epoch: 11, Steps: 10 | Train Loss: 0.643 Vali Loss: 1.231 Vali Acc: 0.500 Test Loss: 1.231 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.906334161758423
Epoch: 12, Steps: 10 | Train Loss: 0.504 Vali Loss: 1.249 Vali Acc: 0.527 Test Loss: 1.249 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527015).  Saving model ...
Epoch: 13 cost time: 3.563854455947876
Epoch: 13, Steps: 10 | Train Loss: 0.414 Vali Loss: 1.356 Vali Acc: 0.459 Test Loss: 1.356 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.2524185180664062
Epoch: 14, Steps: 10 | Train Loss: 0.349 Vali Loss: 1.353 Vali Acc: 0.500 Test Loss: 1.353 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.4033679962158203
Epoch: 15, Steps: 10 | Train Loss: 0.267 Vali Loss: 1.297 Vali Acc: 0.514 Test Loss: 1.297 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.110182523727417
Epoch: 16, Steps: 10 | Train Loss: 0.197 Vali Loss: 1.254 Vali Acc: 0.486 Test Loss: 1.254 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.448756694793701
Epoch: 17, Steps: 10 | Train Loss: 0.153 Vali Loss: 1.303 Vali Acc: 0.514 Test Loss: 1.303 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.047694444656372
Epoch: 18, Steps: 10 | Train Loss: 0.122 Vali Loss: 1.441 Vali Acc: 0.514 Test Loss: 1.441 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.6541056632995605
Epoch: 19, Steps: 10 | Train Loss: 0.105 Vali Loss: 1.489 Vali Acc: 0.500 Test Loss: 1.489 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.214459180831909
Epoch: 20, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.400 Vali Acc: 0.541 Test Loss: 1.400 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540527).  Saving model ...
Epoch: 21 cost time: 2.5223913192749023
Epoch: 21, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.398 Vali Acc: 0.514 Test Loss: 1.398 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.1957876682281494
Epoch: 22, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.446 Vali Acc: 0.554 Test Loss: 1.446 Test Acc: 0.554
Validation loss decreased (-0.540527 --> -0.554040).  Saving model ...
Epoch: 23 cost time: 3.0126986503601074
Epoch: 23, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.465 Vali Acc: 0.514 Test Loss: 1.465 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.1485230922698975
Epoch: 24, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.483 Vali Acc: 0.500 Test Loss: 1.483 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.320072650909424
Epoch: 25, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.512 Vali Acc: 0.541 Test Loss: 1.512 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.833590507507324
Epoch: 26, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.504 Vali Acc: 0.541 Test Loss: 1.504 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.169879198074341
Epoch: 27, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.526 Vali Acc: 0.527 Test Loss: 1.526 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.7951223850250244
Epoch: 28, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.541 Vali Acc: 0.514 Test Loss: 1.541 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.9087014198303223
Epoch: 29, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.563 Vali Acc: 0.500 Test Loss: 1.563 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.0538735389709473
Epoch: 30, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.596 Vali Acc: 0.514 Test Loss: 1.596 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.833052396774292
Epoch: 31, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.578 Vali Acc: 0.514 Test Loss: 1.578 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.887977361679077
Epoch: 32, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.636 Vali Acc: 0.514 Test Loss: 1.636 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 1248768
model size : 6.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.156676530838013
Epoch: 1, Steps: 10 | Train Loss: 1.444 Vali Loss: 1.405 Vali Acc: 0.203 Test Loss: 1.405 Test Acc: 0.203
Validation loss decreased (inf --> -0.202689).  Saving model ...
Epoch: 2 cost time: 2.5816822052001953
Epoch: 2, Steps: 10 | Train Loss: 1.406 Vali Loss: 1.307 Vali Acc: 0.432 Test Loss: 1.307 Test Acc: 0.432
Validation loss decreased (-0.202689 --> -0.432419).  Saving model ...
Epoch: 3 cost time: 3.1122324466705322
Epoch: 3, Steps: 10 | Train Loss: 1.349 Vali Loss: 1.332 Vali Acc: 0.392 Test Loss: 1.332 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.9358627796173096
Epoch: 4, Steps: 10 | Train Loss: 1.250 Vali Loss: 1.281 Vali Acc: 0.473 Test Loss: 1.281 Test Acc: 0.473
Validation loss decreased (-0.432419 --> -0.472960).  Saving model ...
Epoch: 5 cost time: 3.1794514656066895
Epoch: 5, Steps: 10 | Train Loss: 1.210 Vali Loss: 1.259 Vali Acc: 0.392 Test Loss: 1.259 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.9974188804626465
Epoch: 6, Steps: 10 | Train Loss: 1.053 Vali Loss: 1.150 Vali Acc: 0.581 Test Loss: 1.150 Test Acc: 0.581
Validation loss decreased (-0.472960 --> -0.581070).  Saving model ...
Epoch: 7 cost time: 3.3321597576141357
Epoch: 7, Steps: 10 | Train Loss: 0.939 Vali Loss: 1.194 Vali Acc: 0.527 Test Loss: 1.194 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.0605618953704834
Epoch: 8, Steps: 10 | Train Loss: 0.831 Vali Loss: 1.098 Vali Acc: 0.514 Test Loss: 1.098 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.9887855052948
Epoch: 9, Steps: 10 | Train Loss: 0.759 Vali Loss: 1.120 Vali Acc: 0.568 Test Loss: 1.120 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.0126187801361084
Epoch: 10, Steps: 10 | Train Loss: 0.600 Vali Loss: 1.199 Vali Acc: 0.500 Test Loss: 1.199 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.1803956031799316
Epoch: 11, Steps: 10 | Train Loss: 0.520 Vali Loss: 1.065 Vali Acc: 0.554 Test Loss: 1.065 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.1132256984710693
Epoch: 12, Steps: 10 | Train Loss: 0.400 Vali Loss: 1.189 Vali Acc: 0.500 Test Loss: 1.189 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.8515515327453613
Epoch: 13, Steps: 10 | Train Loss: 0.368 Vali Loss: 1.186 Vali Acc: 0.581 Test Loss: 1.186 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.0948116779327393
Epoch: 14, Steps: 10 | Train Loss: 0.250 Vali Loss: 1.133 Vali Acc: 0.486 Test Loss: 1.133 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.8917698860168457
Epoch: 15, Steps: 10 | Train Loss: 0.193 Vali Loss: 1.197 Vali Acc: 0.527 Test Loss: 1.197 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.3097198009490967
Epoch: 16, Steps: 10 | Train Loss: 0.155 Vali Loss: 1.149 Vali Acc: 0.595 Test Loss: 1.149 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594583).  Saving model ...
Epoch: 17 cost time: 2.9968624114990234
Epoch: 17, Steps: 10 | Train Loss: 0.114 Vali Loss: 1.152 Vali Acc: 0.527 Test Loss: 1.152 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.944157838821411
Epoch: 18, Steps: 10 | Train Loss: 0.080 Vali Loss: 1.198 Vali Acc: 0.581 Test Loss: 1.198 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.7052223682403564
Epoch: 19, Steps: 10 | Train Loss: 0.062 Vali Loss: 1.188 Vali Acc: 0.568 Test Loss: 1.188 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.916459083557129
Epoch: 20, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.164 Vali Acc: 0.514 Test Loss: 1.164 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.026855230331421
Epoch: 21, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.195 Vali Acc: 0.554 Test Loss: 1.195 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.9887969493865967
Epoch: 22, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.170 Vali Acc: 0.568 Test Loss: 1.170 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.4699766635894775
Epoch: 23, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.219 Vali Acc: 0.568 Test Loss: 1.219 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.7539420127868652
Epoch: 24, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.221 Vali Acc: 0.581 Test Loss: 1.221 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.7812483310699463
Epoch: 25, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.217 Vali Acc: 0.608 Test Loss: 1.217 Test Acc: 0.608
Validation loss decreased (-0.594583 --> -0.608096).  Saving model ...
Epoch: 26 cost time: 2.9028987884521484
Epoch: 26, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.231 Vali Acc: 0.595 Test Loss: 1.231 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.881019115447998
Epoch: 27, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.267 Vali Acc: 0.568 Test Loss: 1.267 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.145738363265991
Epoch: 28, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.255 Vali Acc: 0.554 Test Loss: 1.255 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.82997727394104
Epoch: 29, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.327 Vali Acc: 0.568 Test Loss: 1.327 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.8992369174957275
Epoch: 30, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.289 Vali Acc: 0.581 Test Loss: 1.289 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.8965365886688232
Epoch: 31, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.285 Vali Acc: 0.568 Test Loss: 1.285 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.511335611343384
Epoch: 32, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.328 Vali Acc: 0.541 Test Loss: 1.328 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.642782688140869
Epoch: 33, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.334 Vali Acc: 0.541 Test Loss: 1.334 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.697331190109253
Epoch: 34, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.328 Vali Acc: 0.541 Test Loss: 1.328 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.4560530185699463
Epoch: 35, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.358 Vali Acc: 0.568 Test Loss: 1.358 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 1244608
model size : 6.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.369143486022949
Epoch: 1, Steps: 10 | Train Loss: 1.430 Vali Loss: 1.374 Vali Acc: 0.257 Test Loss: 1.374 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 3.1008191108703613
Epoch: 2, Steps: 10 | Train Loss: 1.437 Vali Loss: 1.362 Vali Acc: 0.338 Test Loss: 1.362 Test Acc: 0.338
Validation loss decreased (-0.256743 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 2.945406198501587
Epoch: 3, Steps: 10 | Train Loss: 1.401 Vali Loss: 1.349 Vali Acc: 0.405 Test Loss: 1.349 Test Acc: 0.405
Validation loss decreased (-0.337824 --> -0.405392).  Saving model ...
Epoch: 4 cost time: 3.9846038818359375
Epoch: 4, Steps: 10 | Train Loss: 1.332 Vali Loss: 1.300 Vali Acc: 0.378 Test Loss: 1.300 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.553734540939331
Epoch: 5, Steps: 10 | Train Loss: 1.252 Vali Loss: 1.288 Vali Acc: 0.392 Test Loss: 1.288 Test Acc: 0.392
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.7101917266845703
Epoch: 6, Steps: 10 | Train Loss: 1.154 Vali Loss: 1.282 Vali Acc: 0.446 Test Loss: 1.282 Test Acc: 0.446
Validation loss decreased (-0.405392 --> -0.445933).  Saving model ...
Epoch: 7 cost time: 3.3650808334350586
Epoch: 7, Steps: 10 | Train Loss: 1.064 Vali Loss: 1.175 Vali Acc: 0.527 Test Loss: 1.175 Test Acc: 0.527
Validation loss decreased (-0.445933 --> -0.527015).  Saving model ...
Epoch: 8 cost time: 3.212924003601074
Epoch: 8, Steps: 10 | Train Loss: 0.962 Vali Loss: 1.208 Vali Acc: 0.473 Test Loss: 1.208 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.3854715824127197
Epoch: 9, Steps: 10 | Train Loss: 0.826 Vali Loss: 1.178 Vali Acc: 0.500 Test Loss: 1.178 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.364516496658325
Epoch: 10, Steps: 10 | Train Loss: 0.755 Vali Loss: 1.187 Vali Acc: 0.514 Test Loss: 1.187 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.4024829864501953
Epoch: 11, Steps: 10 | Train Loss: 0.645 Vali Loss: 1.140 Vali Acc: 0.568 Test Loss: 1.140 Test Acc: 0.568
Validation loss decreased (-0.527015 --> -0.567556).  Saving model ...
Epoch: 12 cost time: 3.0066781044006348
Epoch: 12, Steps: 10 | Train Loss: 0.540 Vali Loss: 1.154 Vali Acc: 0.527 Test Loss: 1.154 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.395814895629883
Epoch: 13, Steps: 10 | Train Loss: 0.433 Vali Loss: 1.168 Vali Acc: 0.527 Test Loss: 1.168 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.0720458030700684
Epoch: 14, Steps: 10 | Train Loss: 0.370 Vali Loss: 1.245 Vali Acc: 0.459 Test Loss: 1.245 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.0201423168182373
Epoch: 15, Steps: 10 | Train Loss: 0.293 Vali Loss: 1.128 Vali Acc: 0.554 Test Loss: 1.128 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.2387728691101074
Epoch: 16, Steps: 10 | Train Loss: 0.218 Vali Loss: 1.234 Vali Acc: 0.459 Test Loss: 1.234 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.920821189880371
Epoch: 17, Steps: 10 | Train Loss: 0.172 Vali Loss: 1.201 Vali Acc: 0.500 Test Loss: 1.201 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.0914690494537354
Epoch: 18, Steps: 10 | Train Loss: 0.129 Vali Loss: 1.331 Vali Acc: 0.527 Test Loss: 1.331 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.4164364337921143
Epoch: 19, Steps: 10 | Train Loss: 0.103 Vali Loss: 1.265 Vali Acc: 0.527 Test Loss: 1.265 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.2194788455963135
Epoch: 20, Steps: 10 | Train Loss: 0.074 Vali Loss: 1.397 Vali Acc: 0.473 Test Loss: 1.397 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.237023115158081
Epoch: 21, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.379 Vali Acc: 0.486 Test Loss: 1.379 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 959872
model size : 5.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.421325206756592
Epoch: 1, Steps: 10 | Train Loss: 1.427 Vali Loss: 1.352 Vali Acc: 0.351 Test Loss: 1.352 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 2.6164674758911133
Epoch: 2, Steps: 10 | Train Loss: 1.408 Vali Loss: 1.369 Vali Acc: 0.270 Test Loss: 1.369 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.080514669418335
Epoch: 3, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.286 Vali Acc: 0.527 Test Loss: 1.286 Test Acc: 0.527
Validation loss decreased (-0.351338 --> -0.527014).  Saving model ...
Epoch: 4 cost time: 2.890719413757324
Epoch: 4, Steps: 10 | Train Loss: 1.281 Vali Loss: 1.342 Vali Acc: 0.365 Test Loss: 1.342 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.9673688411712646
Epoch: 5, Steps: 10 | Train Loss: 1.238 Vali Loss: 1.283 Vali Acc: 0.419 Test Loss: 1.283 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.679957866668701
Epoch: 6, Steps: 10 | Train Loss: 1.182 Vali Loss: 1.196 Vali Acc: 0.473 Test Loss: 1.196 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.3762001991271973
Epoch: 7, Steps: 10 | Train Loss: 1.064 Vali Loss: 1.195 Vali Acc: 0.459 Test Loss: 1.195 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.789508104324341
Epoch: 8, Steps: 10 | Train Loss: 0.979 Vali Loss: 1.227 Vali Acc: 0.405 Test Loss: 1.227 Test Acc: 0.405
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.7094125747680664
Epoch: 9, Steps: 10 | Train Loss: 0.829 Vali Loss: 1.147 Vali Acc: 0.514 Test Loss: 1.147 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.7844433784484863
Epoch: 10, Steps: 10 | Train Loss: 0.767 Vali Loss: 1.157 Vali Acc: 0.405 Test Loss: 1.157 Test Acc: 0.405
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.153006076812744
Epoch: 11, Steps: 10 | Train Loss: 0.675 Vali Loss: 1.217 Vali Acc: 0.459 Test Loss: 1.217 Test Acc: 0.459
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.3474552631378174
Epoch: 12, Steps: 10 | Train Loss: 0.554 Vali Loss: 1.129 Vali Acc: 0.581 Test Loss: 1.129 Test Acc: 0.581
Validation loss decreased (-0.527014 --> -0.581070).  Saving model ...
Epoch: 13 cost time: 2.5668959617614746
Epoch: 13, Steps: 10 | Train Loss: 0.521 Vali Loss: 1.196 Vali Acc: 0.486 Test Loss: 1.196 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.1901350021362305
Epoch: 14, Steps: 10 | Train Loss: 0.395 Vali Loss: 1.095 Vali Acc: 0.554 Test Loss: 1.095 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.4141018390655518
Epoch: 15, Steps: 10 | Train Loss: 0.319 Vali Loss: 1.165 Vali Acc: 0.527 Test Loss: 1.165 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.764610528945923
Epoch: 16, Steps: 10 | Train Loss: 0.232 Vali Loss: 1.153 Vali Acc: 0.568 Test Loss: 1.153 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.6341712474823
Epoch: 17, Steps: 10 | Train Loss: 0.182 Vali Loss: 1.199 Vali Acc: 0.514 Test Loss: 1.199 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.042905807495117
Epoch: 18, Steps: 10 | Train Loss: 0.146 Vali Loss: 1.292 Vali Acc: 0.500 Test Loss: 1.292 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.5746145248413086
Epoch: 19, Steps: 10 | Train Loss: 0.109 Vali Loss: 1.263 Vali Acc: 0.554 Test Loss: 1.263 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.1726861000061035
Epoch: 20, Steps: 10 | Train Loss: 0.092 Vali Loss: 1.388 Vali Acc: 0.527 Test Loss: 1.388 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.2599034309387207
Epoch: 21, Steps: 10 | Train Loss: 0.082 Vali Loss: 1.388 Vali Acc: 0.486 Test Loss: 1.388 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.390094757080078
Epoch: 22, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.333 Vali Acc: 0.581 Test Loss: 1.333 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 955712
model size : 5.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.525632381439209
Epoch: 1, Steps: 10 | Train Loss: 1.459 Vali Loss: 1.427 Vali Acc: 0.203 Test Loss: 1.427 Test Acc: 0.203
Validation loss decreased (inf --> -0.202688).  Saving model ...
Epoch: 2 cost time: 2.8455069065093994
Epoch: 2, Steps: 10 | Train Loss: 1.428 Vali Loss: 1.377 Vali Acc: 0.284 Test Loss: 1.377 Test Acc: 0.284
Validation loss decreased (-0.202688 --> -0.283770).  Saving model ...
Epoch: 3 cost time: 2.4397919178009033
Epoch: 3, Steps: 10 | Train Loss: 1.374 Vali Loss: 1.358 Vali Acc: 0.297 Test Loss: 1.358 Test Acc: 0.297
Validation loss decreased (-0.283770 --> -0.297284).  Saving model ...
Epoch: 4 cost time: 2.9174060821533203
Epoch: 4, Steps: 10 | Train Loss: 1.303 Vali Loss: 1.448 Vali Acc: 0.270 Test Loss: 1.448 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.8319756984710693
Epoch: 5, Steps: 10 | Train Loss: 1.314 Vali Loss: 1.347 Vali Acc: 0.351 Test Loss: 1.347 Test Acc: 0.351
Validation loss decreased (-0.297284 --> -0.351338).  Saving model ...
Epoch: 6 cost time: 2.7112371921539307
Epoch: 6, Steps: 10 | Train Loss: 1.166 Vali Loss: 1.328 Vali Acc: 0.338 Test Loss: 1.328 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.526547908782959
Epoch: 7, Steps: 10 | Train Loss: 1.119 Vali Loss: 1.286 Vali Acc: 0.392 Test Loss: 1.286 Test Acc: 0.392
Validation loss decreased (-0.351338 --> -0.391879).  Saving model ...
Epoch: 8 cost time: 2.7077245712280273
Epoch: 8, Steps: 10 | Train Loss: 0.989 Vali Loss: 1.205 Vali Acc: 0.432 Test Loss: 1.205 Test Acc: 0.432
Validation loss decreased (-0.391879 --> -0.432420).  Saving model ...
Epoch: 9 cost time: 2.7307910919189453
Epoch: 9, Steps: 10 | Train Loss: 0.897 Vali Loss: 1.182 Vali Acc: 0.432 Test Loss: 1.182 Test Acc: 0.432
Validation loss decreased (-0.432420 --> -0.432421).  Saving model ...
Epoch: 10 cost time: 2.9433584213256836
Epoch: 10, Steps: 10 | Train Loss: 0.777 Vali Loss: 1.105 Vali Acc: 0.486 Test Loss: 1.105 Test Acc: 0.486
Validation loss decreased (-0.432421 --> -0.486475).  Saving model ...
Epoch: 11 cost time: 3.013897180557251
Epoch: 11, Steps: 10 | Train Loss: 0.663 Vali Loss: 1.103 Vali Acc: 0.459 Test Loss: 1.103 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.8984079360961914
Epoch: 12, Steps: 10 | Train Loss: 0.580 Vali Loss: 1.263 Vali Acc: 0.392 Test Loss: 1.263 Test Acc: 0.392
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.863213062286377
Epoch: 13, Steps: 10 | Train Loss: 0.482 Vali Loss: 1.113 Vali Acc: 0.581 Test Loss: 1.113 Test Acc: 0.581
Validation loss decreased (-0.486475 --> -0.581070).  Saving model ...
Epoch: 14 cost time: 3.072021722793579
Epoch: 14, Steps: 10 | Train Loss: 0.411 Vali Loss: 1.116 Vali Acc: 0.500 Test Loss: 1.116 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.8133432865142822
Epoch: 15, Steps: 10 | Train Loss: 0.363 Vali Loss: 1.203 Vali Acc: 0.514 Test Loss: 1.203 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.9680564403533936
Epoch: 16, Steps: 10 | Train Loss: 0.273 Vali Loss: 1.123 Vali Acc: 0.554 Test Loss: 1.123 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.419111728668213
Epoch: 17, Steps: 10 | Train Loss: 0.210 Vali Loss: 1.186 Vali Acc: 0.514 Test Loss: 1.186 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.0304882526397705
Epoch: 18, Steps: 10 | Train Loss: 0.149 Vali Loss: 1.191 Vali Acc: 0.554 Test Loss: 1.191 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.8324928283691406
Epoch: 19, Steps: 10 | Train Loss: 0.115 Vali Loss: 1.196 Vali Acc: 0.568 Test Loss: 1.196 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.954896926879883
Epoch: 20, Steps: 10 | Train Loss: 0.083 Vali Loss: 1.279 Vali Acc: 0.541 Test Loss: 1.279 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.284663438796997
Epoch: 21, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.332 Vali Acc: 0.527 Test Loss: 1.332 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.4549567699432373
Epoch: 22, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.338 Vali Acc: 0.527 Test Loss: 1.338 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.202761650085449
Epoch: 23, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.333 Vali Acc: 0.527 Test Loss: 1.333 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 951552
model size : 5.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.964377164840698
Epoch: 1, Steps: 10 | Train Loss: 1.470 Vali Loss: 1.389 Vali Acc: 0.270 Test Loss: 1.389 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 2.5190787315368652
Epoch: 2, Steps: 10 | Train Loss: 1.410 Vali Loss: 1.444 Vali Acc: 0.230 Test Loss: 1.444 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.683793783187866
Epoch: 3, Steps: 10 | Train Loss: 1.396 Vali Loss: 1.347 Vali Acc: 0.378 Test Loss: 1.347 Test Acc: 0.378
Validation loss decreased (-0.270256 --> -0.378365).  Saving model ...
Epoch: 4 cost time: 2.3771700859069824
Epoch: 4, Steps: 10 | Train Loss: 1.375 Vali Loss: 1.410 Vali Acc: 0.270 Test Loss: 1.410 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.7759926319122314
Epoch: 5, Steps: 10 | Train Loss: 1.349 Vali Loss: 1.329 Vali Acc: 0.405 Test Loss: 1.329 Test Acc: 0.405
Validation loss decreased (-0.378365 --> -0.405392).  Saving model ...
Epoch: 6 cost time: 2.8566925525665283
Epoch: 6, Steps: 10 | Train Loss: 1.230 Vali Loss: 1.329 Vali Acc: 0.365 Test Loss: 1.329 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.8423759937286377
Epoch: 7, Steps: 10 | Train Loss: 1.139 Vali Loss: 1.292 Vali Acc: 0.432 Test Loss: 1.292 Test Acc: 0.432
Validation loss decreased (-0.405392 --> -0.432420).  Saving model ...
Epoch: 8 cost time: 2.893944263458252
Epoch: 8, Steps: 10 | Train Loss: 1.117 Vali Loss: 1.260 Vali Acc: 0.405 Test Loss: 1.260 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.833634853363037
Epoch: 9, Steps: 10 | Train Loss: 1.025 Vali Loss: 1.255 Vali Acc: 0.419 Test Loss: 1.255 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.925725221633911
Epoch: 10, Steps: 10 | Train Loss: 0.909 Vali Loss: 1.181 Vali Acc: 0.486 Test Loss: 1.181 Test Acc: 0.486
Validation loss decreased (-0.432420 --> -0.486475).  Saving model ...
Epoch: 11 cost time: 2.935925245285034
Epoch: 11, Steps: 10 | Train Loss: 0.779 Vali Loss: 1.185 Vali Acc: 0.473 Test Loss: 1.185 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.597372055053711
Epoch: 12, Steps: 10 | Train Loss: 0.715 Vali Loss: 1.174 Vali Acc: 0.500 Test Loss: 1.174 Test Acc: 0.500
Validation loss decreased (-0.486475 --> -0.499988).  Saving model ...
Epoch: 13 cost time: 2.7873711585998535
Epoch: 13, Steps: 10 | Train Loss: 0.604 Vali Loss: 1.293 Vali Acc: 0.500 Test Loss: 1.293 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.727724313735962
Epoch: 14, Steps: 10 | Train Loss: 0.480 Vali Loss: 1.156 Vali Acc: 0.514 Test Loss: 1.156 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 15 cost time: 2.813800096511841
Epoch: 15, Steps: 10 | Train Loss: 0.394 Vali Loss: 1.188 Vali Acc: 0.554 Test Loss: 1.188 Test Acc: 0.554
Validation loss decreased (-0.513502 --> -0.554042).  Saving model ...
Epoch: 16 cost time: 2.223864793777466
Epoch: 16, Steps: 10 | Train Loss: 0.302 Vali Loss: 1.149 Vali Acc: 0.568 Test Loss: 1.149 Test Acc: 0.568
Validation loss decreased (-0.554042 --> -0.567556).  Saving model ...
Epoch: 17 cost time: 2.8880228996276855
Epoch: 17, Steps: 10 | Train Loss: 0.253 Vali Loss: 1.314 Vali Acc: 0.527 Test Loss: 1.314 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.4424431324005127
Epoch: 18, Steps: 10 | Train Loss: 0.194 Vali Loss: 1.200 Vali Acc: 0.527 Test Loss: 1.200 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.020742177963257
Epoch: 19, Steps: 10 | Train Loss: 0.130 Vali Loss: 1.219 Vali Acc: 0.554 Test Loss: 1.219 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.783555030822754
Epoch: 20, Steps: 10 | Train Loss: 0.098 Vali Loss: 1.177 Vali Acc: 0.554 Test Loss: 1.177 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.5638656616210938
Epoch: 21, Steps: 10 | Train Loss: 0.075 Vali Loss: 1.244 Vali Acc: 0.568 Test Loss: 1.244 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.641382932662964
Epoch: 22, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.239 Vali Acc: 0.568 Test Loss: 1.239 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.378598213195801
Epoch: 23, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.287 Vali Acc: 0.541 Test Loss: 1.287 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.7969043254852295
Epoch: 24, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.301 Vali Acc: 0.541 Test Loss: 1.301 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.56658673286438
Epoch: 25, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.322 Vali Acc: 0.568 Test Loss: 1.322 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.9308319091796875
Epoch: 26, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.341 Vali Acc: 0.541 Test Loss: 1.341 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 947392
model size : 5.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.959700345993042
Epoch: 1, Steps: 10 | Train Loss: 1.438 Vali Loss: 1.372 Vali Acc: 0.297 Test Loss: 1.372 Test Acc: 0.297
Validation loss decreased (inf --> -0.297284).  Saving model ...
Epoch: 2 cost time: 3.051844596862793
Epoch: 2, Steps: 10 | Train Loss: 1.463 Vali Loss: 1.378 Vali Acc: 0.297 Test Loss: 1.378 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.0343945026397705
Epoch: 3, Steps: 10 | Train Loss: 1.402 Vali Loss: 1.368 Vali Acc: 0.378 Test Loss: 1.368 Test Acc: 0.378
Validation loss decreased (-0.297284 --> -0.378365).  Saving model ...
Epoch: 4 cost time: 3.0842368602752686
Epoch: 4, Steps: 10 | Train Loss: 1.321 Vali Loss: 1.319 Vali Acc: 0.378 Test Loss: 1.319 Test Acc: 0.378
Validation loss decreased (-0.378365 --> -0.378365).  Saving model ...
Epoch: 5 cost time: 3.3881096839904785
Epoch: 5, Steps: 10 | Train Loss: 1.292 Vali Loss: 1.310 Vali Acc: 0.419 Test Loss: 1.310 Test Acc: 0.419
Validation loss decreased (-0.378365 --> -0.418906).  Saving model ...
Epoch: 6 cost time: 2.9571845531463623
Epoch: 6, Steps: 10 | Train Loss: 1.224 Vali Loss: 1.319 Vali Acc: 0.351 Test Loss: 1.319 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.8745102882385254
Epoch: 7, Steps: 10 | Train Loss: 1.104 Vali Loss: 1.209 Vali Acc: 0.459 Test Loss: 1.209 Test Acc: 0.459
Validation loss decreased (-0.418906 --> -0.459447).  Saving model ...
Epoch: 8 cost time: 3.221796751022339
Epoch: 8, Steps: 10 | Train Loss: 1.058 Vali Loss: 1.201 Vali Acc: 0.486 Test Loss: 1.201 Test Acc: 0.486
Validation loss decreased (-0.459447 --> -0.486474).  Saving model ...
Epoch: 9 cost time: 3.3478691577911377
Epoch: 9, Steps: 10 | Train Loss: 0.850 Vali Loss: 1.200 Vali Acc: 0.473 Test Loss: 1.200 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.8412859439849854
Epoch: 10, Steps: 10 | Train Loss: 0.774 Vali Loss: 1.221 Vali Acc: 0.419 Test Loss: 1.221 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.6090383529663086
Epoch: 11, Steps: 10 | Train Loss: 0.686 Vali Loss: 1.196 Vali Acc: 0.514 Test Loss: 1.196 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513502).  Saving model ...
Epoch: 12 cost time: 3.091660261154175
Epoch: 12, Steps: 10 | Train Loss: 0.639 Vali Loss: 1.111 Vali Acc: 0.541 Test Loss: 1.111 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540529).  Saving model ...
Epoch: 13 cost time: 2.813185453414917
Epoch: 13, Steps: 10 | Train Loss: 0.511 Vali Loss: 1.174 Vali Acc: 0.554 Test Loss: 1.174 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554042).  Saving model ...
Epoch: 14 cost time: 2.9669361114501953
Epoch: 14, Steps: 10 | Train Loss: 0.461 Vali Loss: 1.153 Vali Acc: 0.500 Test Loss: 1.153 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.4741945266723633
Epoch: 15, Steps: 10 | Train Loss: 0.382 Vali Loss: 1.198 Vali Acc: 0.568 Test Loss: 1.198 Test Acc: 0.568
Validation loss decreased (-0.554042 --> -0.567556).  Saving model ...
Epoch: 16 cost time: 3.242492437362671
Epoch: 16, Steps: 10 | Train Loss: 0.316 Vali Loss: 1.233 Vali Acc: 0.527 Test Loss: 1.233 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.4877469539642334
Epoch: 17, Steps: 10 | Train Loss: 0.265 Vali Loss: 1.215 Vali Acc: 0.486 Test Loss: 1.215 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.6283881664276123
Epoch: 18, Steps: 10 | Train Loss: 0.207 Vali Loss: 1.095 Vali Acc: 0.541 Test Loss: 1.095 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.282468318939209
Epoch: 19, Steps: 10 | Train Loss: 0.152 Vali Loss: 1.218 Vali Acc: 0.527 Test Loss: 1.218 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.977391004562378
Epoch: 20, Steps: 10 | Train Loss: 0.116 Vali Loss: 1.388 Vali Acc: 0.514 Test Loss: 1.388 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.6552138328552246
Epoch: 21, Steps: 10 | Train Loss: 0.091 Vali Loss: 1.234 Vali Acc: 0.554 Test Loss: 1.234 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.4264512062072754
Epoch: 22, Steps: 10 | Train Loss: 0.062 Vali Loss: 1.299 Vali Acc: 0.581 Test Loss: 1.299 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581068).  Saving model ...
Epoch: 23 cost time: 3.0264806747436523
Epoch: 23, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.294 Vali Acc: 0.541 Test Loss: 1.294 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.960456132888794
Epoch: 24, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.341 Vali Acc: 0.554 Test Loss: 1.341 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.5561301708221436
Epoch: 25, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.368 Vali Acc: 0.541 Test Loss: 1.368 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.7111945152282715
Epoch: 26, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.361 Vali Acc: 0.554 Test Loss: 1.361 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.736604928970337
Epoch: 27, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.386 Vali Acc: 0.541 Test Loss: 1.386 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.1022677421569824
Epoch: 28, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.402 Vali Acc: 0.541 Test Loss: 1.402 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.96882700920105
Epoch: 29, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.427 Vali Acc: 0.554 Test Loss: 1.427 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.967160940170288
Epoch: 30, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.433 Vali Acc: 0.541 Test Loss: 1.433 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 3.0111215114593506
Epoch: 31, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.477 Vali Acc: 0.554 Test Loss: 1.477 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.998753786087036
Epoch: 32, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.461 Vali Acc: 0.541 Test Loss: 1.461 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 811264
model size : 4.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.67964506149292
Epoch: 1, Steps: 10 | Train Loss: 1.465 Vali Loss: 1.405 Vali Acc: 0.351 Test Loss: 1.405 Test Acc: 0.351
Validation loss decreased (inf --> -0.351337).  Saving model ...
Epoch: 2 cost time: 2.878054141998291
Epoch: 2, Steps: 10 | Train Loss: 1.468 Vali Loss: 1.422 Vali Acc: 0.230 Test Loss: 1.422 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.658306360244751
Epoch: 3, Steps: 10 | Train Loss: 1.399 Vali Loss: 1.408 Vali Acc: 0.270 Test Loss: 1.408 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.960451126098633
Epoch: 4, Steps: 10 | Train Loss: 1.391 Vali Loss: 1.388 Vali Acc: 0.311 Test Loss: 1.388 Test Acc: 0.311
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.5228309631347656
Epoch: 5, Steps: 10 | Train Loss: 1.300 Vali Loss: 1.312 Vali Acc: 0.419 Test Loss: 1.312 Test Acc: 0.419
Validation loss decreased (-0.351337 --> -0.418906).  Saving model ...
Epoch: 6 cost time: 2.6189520359039307
Epoch: 6, Steps: 10 | Train Loss: 1.199 Vali Loss: 1.319 Vali Acc: 0.365 Test Loss: 1.319 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.160686731338501
Epoch: 7, Steps: 10 | Train Loss: 1.107 Vali Loss: 1.279 Vali Acc: 0.338 Test Loss: 1.279 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.5211172103881836
Epoch: 8, Steps: 10 | Train Loss: 1.003 Vali Loss: 1.247 Vali Acc: 0.432 Test Loss: 1.247 Test Acc: 0.432
Validation loss decreased (-0.418906 --> -0.432420).  Saving model ...
Epoch: 9 cost time: 2.074082851409912
Epoch: 9, Steps: 10 | Train Loss: 0.888 Vali Loss: 1.268 Vali Acc: 0.473 Test Loss: 1.268 Test Acc: 0.473
Validation loss decreased (-0.432420 --> -0.472960).  Saving model ...
Epoch: 10 cost time: 2.47060489654541
Epoch: 10, Steps: 10 | Train Loss: 0.783 Vali Loss: 1.238 Vali Acc: 0.473 Test Loss: 1.238 Test Acc: 0.473
Validation loss decreased (-0.472960 --> -0.472961).  Saving model ...
Epoch: 11 cost time: 2.476964235305786
Epoch: 11, Steps: 10 | Train Loss: 0.708 Vali Loss: 1.116 Vali Acc: 0.486 Test Loss: 1.116 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486475).  Saving model ...
Epoch: 12 cost time: 2.277348041534424
Epoch: 12, Steps: 10 | Train Loss: 0.609 Vali Loss: 1.162 Vali Acc: 0.446 Test Loss: 1.162 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.5214669704437256
Epoch: 13, Steps: 10 | Train Loss: 0.510 Vali Loss: 1.128 Vali Acc: 0.473 Test Loss: 1.128 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.8223514556884766
Epoch: 14, Steps: 10 | Train Loss: 0.443 Vali Loss: 1.183 Vali Acc: 0.568 Test Loss: 1.183 Test Acc: 0.568
Validation loss decreased (-0.486475 --> -0.567556).  Saving model ...
Epoch: 15 cost time: 3.0126047134399414
Epoch: 15, Steps: 10 | Train Loss: 0.365 Vali Loss: 1.067 Vali Acc: 0.527 Test Loss: 1.067 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.7951295375823975
Epoch: 16, Steps: 10 | Train Loss: 0.282 Vali Loss: 1.085 Vali Acc: 0.554 Test Loss: 1.085 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.2132456302642822
Epoch: 17, Steps: 10 | Train Loss: 0.223 Vali Loss: 1.119 Vali Acc: 0.554 Test Loss: 1.119 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.7281007766723633
Epoch: 18, Steps: 10 | Train Loss: 0.170 Vali Loss: 1.255 Vali Acc: 0.541 Test Loss: 1.255 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.5916271209716797
Epoch: 19, Steps: 10 | Train Loss: 0.142 Vali Loss: 1.202 Vali Acc: 0.500 Test Loss: 1.202 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.5032501220703125
Epoch: 20, Steps: 10 | Train Loss: 0.104 Vali Loss: 1.214 Vali Acc: 0.541 Test Loss: 1.214 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.386732578277588
Epoch: 21, Steps: 10 | Train Loss: 0.075 Vali Loss: 1.191 Vali Acc: 0.568 Test Loss: 1.191 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.540926694869995
Epoch: 22, Steps: 10 | Train Loss: 0.063 Vali Loss: 1.225 Vali Acc: 0.527 Test Loss: 1.225 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.7642099857330322
Epoch: 23, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.262 Vali Acc: 0.568 Test Loss: 1.262 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.944201946258545
Epoch: 24, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.231 Vali Acc: 0.554 Test Loss: 1.231 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 807104
model size : 4.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.009739637374878
Epoch: 1, Steps: 10 | Train Loss: 1.467 Vali Loss: 1.414 Vali Acc: 0.203 Test Loss: 1.414 Test Acc: 0.203
Validation loss decreased (inf --> -0.202689).  Saving model ...
Epoch: 2 cost time: 2.5441014766693115
Epoch: 2, Steps: 10 | Train Loss: 1.444 Vali Loss: 1.353 Vali Acc: 0.378 Test Loss: 1.353 Test Acc: 0.378
Validation loss decreased (-0.202689 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 2.4871320724487305
Epoch: 3, Steps: 10 | Train Loss: 1.450 Vali Loss: 1.395 Vali Acc: 0.203 Test Loss: 1.395 Test Acc: 0.203
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.8440120220184326
Epoch: 4, Steps: 10 | Train Loss: 1.402 Vali Loss: 1.343 Vali Acc: 0.405 Test Loss: 1.343 Test Acc: 0.405
Validation loss decreased (-0.378365 --> -0.405392).  Saving model ...
Epoch: 5 cost time: 2.5232913494110107
Epoch: 5, Steps: 10 | Train Loss: 1.306 Vali Loss: 1.344 Vali Acc: 0.338 Test Loss: 1.344 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.7610621452331543
Epoch: 6, Steps: 10 | Train Loss: 1.218 Vali Loss: 1.305 Vali Acc: 0.270 Test Loss: 1.305 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.7163171768188477
Epoch: 7, Steps: 10 | Train Loss: 1.145 Vali Loss: 1.284 Vali Acc: 0.432 Test Loss: 1.284 Test Acc: 0.432
Validation loss decreased (-0.405392 --> -0.432420).  Saving model ...
Epoch: 8 cost time: 2.734572410583496
Epoch: 8, Steps: 10 | Train Loss: 1.040 Vali Loss: 1.194 Vali Acc: 0.446 Test Loss: 1.194 Test Acc: 0.446
Validation loss decreased (-0.432420 --> -0.445934).  Saving model ...
Epoch: 9 cost time: 2.8672688007354736
Epoch: 9, Steps: 10 | Train Loss: 0.925 Vali Loss: 1.278 Vali Acc: 0.365 Test Loss: 1.278 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.9502177238464355
Epoch: 10, Steps: 10 | Train Loss: 0.831 Vali Loss: 1.189 Vali Acc: 0.473 Test Loss: 1.189 Test Acc: 0.473
Validation loss decreased (-0.445934 --> -0.472961).  Saving model ...
Epoch: 11 cost time: 3.281801700592041
Epoch: 11, Steps: 10 | Train Loss: 0.705 Vali Loss: 1.221 Vali Acc: 0.419 Test Loss: 1.221 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.779698371887207
Epoch: 12, Steps: 10 | Train Loss: 0.638 Vali Loss: 1.225 Vali Acc: 0.459 Test Loss: 1.225 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.5320024490356445
Epoch: 13, Steps: 10 | Train Loss: 0.568 Vali Loss: 1.197 Vali Acc: 0.459 Test Loss: 1.197 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.729484796524048
Epoch: 14, Steps: 10 | Train Loss: 0.444 Vali Loss: 1.186 Vali Acc: 0.500 Test Loss: 1.186 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499988).  Saving model ...
Epoch: 15 cost time: 2.609769105911255
Epoch: 15, Steps: 10 | Train Loss: 0.345 Vali Loss: 1.295 Vali Acc: 0.486 Test Loss: 1.295 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.9854986667633057
Epoch: 16, Steps: 10 | Train Loss: 0.299 Vali Loss: 1.244 Vali Acc: 0.514 Test Loss: 1.244 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513501).  Saving model ...
Epoch: 17 cost time: 3.0226807594299316
Epoch: 17, Steps: 10 | Train Loss: 0.236 Vali Loss: 1.201 Vali Acc: 0.568 Test Loss: 1.201 Test Acc: 0.568
Validation loss decreased (-0.513501 --> -0.567556).  Saving model ...
Epoch: 18 cost time: 2.640824556350708
Epoch: 18, Steps: 10 | Train Loss: 0.156 Vali Loss: 1.266 Vali Acc: 0.541 Test Loss: 1.266 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.1873271465301514
Epoch: 19, Steps: 10 | Train Loss: 0.128 Vali Loss: 1.356 Vali Acc: 0.527 Test Loss: 1.356 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.2534019947052
Epoch: 20, Steps: 10 | Train Loss: 0.092 Vali Loss: 1.289 Vali Acc: 0.514 Test Loss: 1.289 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.092831611633301
Epoch: 21, Steps: 10 | Train Loss: 0.077 Vali Loss: 1.369 Vali Acc: 0.500 Test Loss: 1.369 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.302149772644043
Epoch: 22, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.456 Vali Acc: 0.541 Test Loss: 1.456 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.154097318649292
Epoch: 23, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.359 Vali Acc: 0.554 Test Loss: 1.359 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.018038511276245
Epoch: 24, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.438 Vali Acc: 0.527 Test Loss: 1.438 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.842407703399658
Epoch: 25, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.440 Vali Acc: 0.514 Test Loss: 1.440 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.389437675476074
Epoch: 26, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.443 Vali Acc: 0.500 Test Loss: 1.443 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.104163646697998
Epoch: 27, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.445 Vali Acc: 0.500 Test Loss: 1.445 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 802944
model size : 4.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.3841869831085205
Epoch: 1, Steps: 10 | Train Loss: 1.426 Vali Loss: 1.360 Vali Acc: 0.284 Test Loss: 1.360 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 2.6550304889678955
Epoch: 2, Steps: 10 | Train Loss: 1.393 Vali Loss: 1.407 Vali Acc: 0.351 Test Loss: 1.407 Test Acc: 0.351
Validation loss decreased (-0.283770 --> -0.351337).  Saving model ...
Epoch: 3 cost time: 2.951145648956299
Epoch: 3, Steps: 10 | Train Loss: 1.411 Vali Loss: 1.348 Vali Acc: 0.351 Test Loss: 1.348 Test Acc: 0.351
Validation loss decreased (-0.351337 --> -0.351338).  Saving model ...
Epoch: 4 cost time: 2.772474765777588
Epoch: 4, Steps: 10 | Train Loss: 1.408 Vali Loss: 1.378 Vali Acc: 0.365 Test Loss: 1.378 Test Acc: 0.365
Validation loss decreased (-0.351338 --> -0.364851).  Saving model ...
Epoch: 5 cost time: 2.573378324508667
Epoch: 5, Steps: 10 | Train Loss: 1.256 Vali Loss: 1.317 Vali Acc: 0.392 Test Loss: 1.317 Test Acc: 0.392
Validation loss decreased (-0.364851 --> -0.391879).  Saving model ...
Epoch: 6 cost time: 2.8068482875823975
Epoch: 6, Steps: 10 | Train Loss: 1.209 Vali Loss: 1.265 Vali Acc: 0.459 Test Loss: 1.265 Test Acc: 0.459
Validation loss decreased (-0.391879 --> -0.459447).  Saving model ...
Epoch: 7 cost time: 2.4320924282073975
Epoch: 7, Steps: 10 | Train Loss: 1.107 Vali Loss: 1.255 Vali Acc: 0.486 Test Loss: 1.255 Test Acc: 0.486
Validation loss decreased (-0.459447 --> -0.486474).  Saving model ...
Epoch: 8 cost time: 2.5451412200927734
Epoch: 8, Steps: 10 | Train Loss: 0.971 Vali Loss: 1.335 Vali Acc: 0.378 Test Loss: 1.335 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.6231465339660645
Epoch: 9, Steps: 10 | Train Loss: 0.936 Vali Loss: 1.274 Vali Acc: 0.432 Test Loss: 1.274 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.754455327987671
Epoch: 10, Steps: 10 | Train Loss: 0.836 Vali Loss: 1.197 Vali Acc: 0.514 Test Loss: 1.197 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513502).  Saving model ...
Epoch: 11 cost time: 2.928429365158081
Epoch: 11, Steps: 10 | Train Loss: 0.739 Vali Loss: 1.262 Vali Acc: 0.486 Test Loss: 1.262 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.567382335662842
Epoch: 12, Steps: 10 | Train Loss: 0.610 Vali Loss: 1.309 Vali Acc: 0.446 Test Loss: 1.309 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.7242038249969482
Epoch: 13, Steps: 10 | Train Loss: 0.528 Vali Loss: 1.247 Vali Acc: 0.554 Test Loss: 1.247 Test Acc: 0.554
Validation loss decreased (-0.513502 --> -0.554042).  Saving model ...
Epoch: 14 cost time: 2.3590922355651855
Epoch: 14, Steps: 10 | Train Loss: 0.436 Vali Loss: 1.200 Vali Acc: 0.527 Test Loss: 1.200 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.22050404548645
Epoch: 15, Steps: 10 | Train Loss: 0.381 Vali Loss: 1.347 Vali Acc: 0.500 Test Loss: 1.347 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.579685926437378
Epoch: 16, Steps: 10 | Train Loss: 0.331 Vali Loss: 1.279 Vali Acc: 0.500 Test Loss: 1.279 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.7559165954589844
Epoch: 17, Steps: 10 | Train Loss: 0.221 Vali Loss: 1.288 Vali Acc: 0.568 Test Loss: 1.288 Test Acc: 0.568
Validation loss decreased (-0.554042 --> -0.567555).  Saving model ...
Epoch: 18 cost time: 2.2872800827026367
Epoch: 18, Steps: 10 | Train Loss: 0.172 Vali Loss: 1.391 Vali Acc: 0.486 Test Loss: 1.391 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.307605504989624
Epoch: 19, Steps: 10 | Train Loss: 0.145 Vali Loss: 1.394 Vali Acc: 0.568 Test Loss: 1.394 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.783691167831421
Epoch: 20, Steps: 10 | Train Loss: 0.103 Vali Loss: 1.439 Vali Acc: 0.541 Test Loss: 1.439 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.0865702629089355
Epoch: 21, Steps: 10 | Train Loss: 0.082 Vali Loss: 1.438 Vali Acc: 0.554 Test Loss: 1.438 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.351057767868042
Epoch: 22, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.543 Vali Acc: 0.527 Test Loss: 1.543 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.627068281173706
Epoch: 23, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.525 Vali Acc: 0.527 Test Loss: 1.525 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.803925037384033
Epoch: 24, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.514 Vali Acc: 0.568 Test Loss: 1.514 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.1479952335357666
Epoch: 25, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.586 Vali Acc: 0.541 Test Loss: 1.586 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.955141067504883
Epoch: 26, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.601 Vali Acc: 0.541 Test Loss: 1.601 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.060765027999878
Epoch: 27, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.689 Vali Acc: 0.514 Test Loss: 1.689 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 798784
model size : 4.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.554954528808594
Epoch: 1, Steps: 10 | Train Loss: 1.510 Vali Loss: 1.417 Vali Acc: 0.365 Test Loss: 1.417 Test Acc: 0.365
Validation loss decreased (inf --> -0.364851).  Saving model ...
Epoch: 2 cost time: 2.15879225730896
Epoch: 2, Steps: 10 | Train Loss: 1.441 Vali Loss: 1.393 Vali Acc: 0.203 Test Loss: 1.393 Test Acc: 0.203
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.540133476257324
Epoch: 3, Steps: 10 | Train Loss: 1.398 Vali Loss: 1.383 Vali Acc: 0.311 Test Loss: 1.383 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.467503309249878
Epoch: 4, Steps: 10 | Train Loss: 1.336 Vali Loss: 1.362 Vali Acc: 0.270 Test Loss: 1.362 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.5520944595336914
Epoch: 5, Steps: 10 | Train Loss: 1.305 Vali Loss: 1.331 Vali Acc: 0.392 Test Loss: 1.331 Test Acc: 0.392
Validation loss decreased (-0.364851 --> -0.391879).  Saving model ...
Epoch: 6 cost time: 2.4150094985961914
Epoch: 6, Steps: 10 | Train Loss: 1.241 Vali Loss: 1.326 Vali Acc: 0.365 Test Loss: 1.326 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.247607469558716
Epoch: 7, Steps: 10 | Train Loss: 1.154 Vali Loss: 1.288 Vali Acc: 0.338 Test Loss: 1.288 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.2273917198181152
Epoch: 8, Steps: 10 | Train Loss: 1.086 Vali Loss: 1.277 Vali Acc: 0.405 Test Loss: 1.277 Test Acc: 0.405
Validation loss decreased (-0.391879 --> -0.405393).  Saving model ...
Epoch: 9 cost time: 2.685615301132202
Epoch: 9, Steps: 10 | Train Loss: 1.014 Vali Loss: 1.218 Vali Acc: 0.432 Test Loss: 1.218 Test Acc: 0.432
Validation loss decreased (-0.405393 --> -0.432420).  Saving model ...
Epoch: 10 cost time: 2.5750513076782227
Epoch: 10, Steps: 10 | Train Loss: 0.918 Vali Loss: 1.289 Vali Acc: 0.351 Test Loss: 1.289 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.5024380683898926
Epoch: 11, Steps: 10 | Train Loss: 0.835 Vali Loss: 1.192 Vali Acc: 0.405 Test Loss: 1.192 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.25266695022583
Epoch: 12, Steps: 10 | Train Loss: 0.843 Vali Loss: 1.224 Vali Acc: 0.419 Test Loss: 1.224 Test Acc: 0.419
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.2269973754882812
Epoch: 13, Steps: 10 | Train Loss: 0.674 Vali Loss: 1.230 Vali Acc: 0.432 Test Loss: 1.230 Test Acc: 0.432
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.2907304763793945
Epoch: 14, Steps: 10 | Train Loss: 0.579 Vali Loss: 1.295 Vali Acc: 0.365 Test Loss: 1.295 Test Acc: 0.365
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.521796703338623
Epoch: 15, Steps: 10 | Train Loss: 0.547 Vali Loss: 1.218 Vali Acc: 0.473 Test Loss: 1.218 Test Acc: 0.473
Validation loss decreased (-0.432420 --> -0.472961).  Saving model ...
Epoch: 16 cost time: 2.772117853164673
Epoch: 16, Steps: 10 | Train Loss: 0.456 Vali Loss: 1.200 Vali Acc: 0.500 Test Loss: 1.200 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499988).  Saving model ...
Epoch: 17 cost time: 2.4560298919677734
Epoch: 17, Steps: 10 | Train Loss: 0.371 Vali Loss: 1.306 Vali Acc: 0.459 Test Loss: 1.306 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.325772762298584
Epoch: 18, Steps: 10 | Train Loss: 0.304 Vali Loss: 1.233 Vali Acc: 0.405 Test Loss: 1.233 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.4000356197357178
Epoch: 19, Steps: 10 | Train Loss: 0.266 Vali Loss: 1.399 Vali Acc: 0.459 Test Loss: 1.399 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.588275909423828
Epoch: 20, Steps: 10 | Train Loss: 0.248 Vali Loss: 1.232 Vali Acc: 0.405 Test Loss: 1.232 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.816615343093872
Epoch: 21, Steps: 10 | Train Loss: 0.184 Vali Loss: 1.329 Vali Acc: 0.541 Test Loss: 1.329 Test Acc: 0.541
Validation loss decreased (-0.499988 --> -0.540527).  Saving model ...
Epoch: 22 cost time: 2.344917058944702
Epoch: 22, Steps: 10 | Train Loss: 0.155 Vali Loss: 1.291 Vali Acc: 0.432 Test Loss: 1.291 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.3734240531921387
Epoch: 23, Steps: 10 | Train Loss: 0.104 Vali Loss: 1.399 Vali Acc: 0.527 Test Loss: 1.399 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.5089457035064697
Epoch: 24, Steps: 10 | Train Loss: 0.096 Vali Loss: 1.348 Vali Acc: 0.473 Test Loss: 1.348 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.4676785469055176
Epoch: 25, Steps: 10 | Train Loss: 0.077 Vali Loss: 1.399 Vali Acc: 0.514 Test Loss: 1.399 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.1167337894439697
Epoch: 26, Steps: 10 | Train Loss: 0.061 Vali Loss: 1.333 Vali Acc: 0.459 Test Loss: 1.333 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.24872088432312
Epoch: 27, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.402 Vali Acc: 0.473 Test Loss: 1.402 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.1852171421051025
Epoch: 28, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.423 Vali Acc: 0.500 Test Loss: 1.423 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.245440721511841
Epoch: 29, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.438 Vali Acc: 0.473 Test Loss: 1.438 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.5533950328826904
Epoch: 30, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.431 Vali Acc: 0.486 Test Loss: 1.431 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.8052778244018555
Epoch: 31, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.481 Vali Acc: 0.473 Test Loss: 1.481 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 782944
model size : 3.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.899207353591919
Epoch: 1, Steps: 10 | Train Loss: 1.472 Vali Loss: 1.398 Vali Acc: 0.284 Test Loss: 1.398 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 2.8315811157226562
Epoch: 2, Steps: 10 | Train Loss: 1.465 Vali Loss: 1.422 Vali Acc: 0.243 Test Loss: 1.422 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.9333674907684326
Epoch: 3, Steps: 10 | Train Loss: 1.393 Vali Loss: 1.365 Vali Acc: 0.365 Test Loss: 1.365 Test Acc: 0.365
Validation loss decreased (-0.283770 --> -0.364851).  Saving model ...
Epoch: 4 cost time: 2.730337142944336
Epoch: 4, Steps: 10 | Train Loss: 1.365 Vali Loss: 1.391 Vali Acc: 0.270 Test Loss: 1.391 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.8816275596618652
Epoch: 5, Steps: 10 | Train Loss: 1.306 Vali Loss: 1.304 Vali Acc: 0.500 Test Loss: 1.304 Test Acc: 0.500
Validation loss decreased (-0.364851 --> -0.499987).  Saving model ...
Epoch: 6 cost time: 2.838902711868286
Epoch: 6, Steps: 10 | Train Loss: 1.234 Vali Loss: 1.313 Vali Acc: 0.392 Test Loss: 1.313 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.646151065826416
Epoch: 7, Steps: 10 | Train Loss: 1.231 Vali Loss: 1.247 Vali Acc: 0.459 Test Loss: 1.247 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.449280023574829
Epoch: 8, Steps: 10 | Train Loss: 1.110 Vali Loss: 1.289 Vali Acc: 0.459 Test Loss: 1.289 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.3820672035217285
Epoch: 9, Steps: 10 | Train Loss: 1.042 Vali Loss: 1.215 Vali Acc: 0.419 Test Loss: 1.215 Test Acc: 0.419
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.479670286178589
Epoch: 10, Steps: 10 | Train Loss: 0.968 Vali Loss: 1.260 Vali Acc: 0.405 Test Loss: 1.260 Test Acc: 0.405
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.1537039279937744
Epoch: 11, Steps: 10 | Train Loss: 0.841 Vali Loss: 1.190 Vali Acc: 0.486 Test Loss: 1.190 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.937854051589966
Epoch: 12, Steps: 10 | Train Loss: 0.716 Vali Loss: 1.222 Vali Acc: 0.432 Test Loss: 1.222 Test Acc: 0.432
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.7918853759765625
Epoch: 13, Steps: 10 | Train Loss: 0.682 Vali Loss: 1.131 Vali Acc: 0.432 Test Loss: 1.131 Test Acc: 0.432
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.400116205215454
Epoch: 14, Steps: 10 | Train Loss: 0.571 Vali Loss: 1.126 Vali Acc: 0.473 Test Loss: 1.126 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.5448689460754395
Epoch: 15, Steps: 10 | Train Loss: 0.488 Vali Loss: 1.164 Vali Acc: 0.446 Test Loss: 1.164 Test Acc: 0.446
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5
model parameter : 780864
model size : 3.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.947315454483032
Epoch: 1, Steps: 10 | Train Loss: 1.484 Vali Loss: 1.375 Vali Acc: 0.311 Test Loss: 1.375 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 1.9866704940795898
Epoch: 2, Steps: 10 | Train Loss: 1.467 Vali Loss: 1.416 Vali Acc: 0.216 Test Loss: 1.416 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.1745779514312744
Epoch: 3, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.375 Vali Acc: 0.324 Test Loss: 1.375 Test Acc: 0.324
Validation loss decreased (-0.310797 --> -0.324311).  Saving model ...
Epoch: 4 cost time: 2.4390368461608887
Epoch: 4, Steps: 10 | Train Loss: 1.379 Vali Loss: 1.379 Vali Acc: 0.284 Test Loss: 1.379 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.9195640087127686
Epoch: 5, Steps: 10 | Train Loss: 1.264 Vali Loss: 1.350 Vali Acc: 0.311 Test Loss: 1.350 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.0276105403900146
Epoch: 6, Steps: 10 | Train Loss: 1.227 Vali Loss: 1.329 Vali Acc: 0.405 Test Loss: 1.329 Test Acc: 0.405
Validation loss decreased (-0.324311 --> -0.405392).  Saving model ...
Epoch: 7 cost time: 2.3064045906066895
Epoch: 7, Steps: 10 | Train Loss: 1.158 Vali Loss: 1.276 Vali Acc: 0.392 Test Loss: 1.276 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9761483669281006
Epoch: 8, Steps: 10 | Train Loss: 1.054 Vali Loss: 1.276 Vali Acc: 0.432 Test Loss: 1.276 Test Acc: 0.432
Validation loss decreased (-0.405392 --> -0.432420).  Saving model ...
Epoch: 9 cost time: 2.296142578125
Epoch: 9, Steps: 10 | Train Loss: 0.953 Vali Loss: 1.217 Vali Acc: 0.473 Test Loss: 1.217 Test Acc: 0.473
Validation loss decreased (-0.432420 --> -0.472961).  Saving model ...
Epoch: 10 cost time: 2.5133280754089355
Epoch: 10, Steps: 10 | Train Loss: 0.846 Vali Loss: 1.291 Vali Acc: 0.378 Test Loss: 1.291 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.4380223751068115
Epoch: 11, Steps: 10 | Train Loss: 0.830 Vali Loss: 1.180 Vali Acc: 0.500 Test Loss: 1.180 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499988).  Saving model ...
Epoch: 12 cost time: 2.686220169067383
Epoch: 12, Steps: 10 | Train Loss: 0.696 Vali Loss: 1.262 Vali Acc: 0.500 Test Loss: 1.262 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.2847111225128174
Epoch: 13, Steps: 10 | Train Loss: 0.629 Vali Loss: 1.174 Vali Acc: 0.486 Test Loss: 1.174 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.776447296142578
Epoch: 14, Steps: 10 | Train Loss: 0.562 Vali Loss: 1.351 Vali Acc: 0.432 Test Loss: 1.351 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.537008047103882
Epoch: 15, Steps: 10 | Train Loss: 0.461 Vali Loss: 1.189 Vali Acc: 0.459 Test Loss: 1.189 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.391589879989624
Epoch: 16, Steps: 10 | Train Loss: 0.420 Vali Loss: 1.297 Vali Acc: 0.459 Test Loss: 1.297 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.4070324897766113
Epoch: 17, Steps: 10 | Train Loss: 0.358 Vali Loss: 1.250 Vali Acc: 0.432 Test Loss: 1.250 Test Acc: 0.432
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.6852262020111084
Epoch: 18, Steps: 10 | Train Loss: 0.298 Vali Loss: 1.171 Vali Acc: 0.500 Test Loss: 1.171 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 19 cost time: 1.8991940021514893
Epoch: 19, Steps: 10 | Train Loss: 0.246 Vali Loss: 1.201 Vali Acc: 0.473 Test Loss: 1.201 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.803567409515381
Epoch: 20, Steps: 10 | Train Loss: 0.205 Vali Loss: 1.366 Vali Acc: 0.473 Test Loss: 1.366 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.578718900680542
Epoch: 21, Steps: 10 | Train Loss: 0.157 Vali Loss: 1.327 Vali Acc: 0.459 Test Loss: 1.327 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.343052864074707
Epoch: 22, Steps: 10 | Train Loss: 0.147 Vali Loss: 1.323 Vali Acc: 0.432 Test Loss: 1.323 Test Acc: 0.432
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.3877553939819336
Epoch: 23, Steps: 10 | Train Loss: 0.124 Vali Loss: 1.363 Vali Acc: 0.446 Test Loss: 1.363 Test Acc: 0.446
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.6411547660827637
Epoch: 24, Steps: 10 | Train Loss: 0.088 Vali Loss: 1.339 Vali Acc: 0.459 Test Loss: 1.339 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.89595627784729
Epoch: 25, Steps: 10 | Train Loss: 0.080 Vali Loss: 1.346 Vali Acc: 0.446 Test Loss: 1.346 Test Acc: 0.446
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.5249626636505127
Epoch: 26, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.419 Vali Acc: 0.432 Test Loss: 1.419 Test Acc: 0.432
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.4504480361938477
Epoch: 27, Steps: 10 | Train Loss: 0.061 Vali Loss: 1.468 Vali Acc: 0.392 Test Loss: 1.468 Test Acc: 0.392
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.4001379013061523
Epoch: 28, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.337 Vali Acc: 0.432 Test Loss: 1.337 Test Acc: 0.432
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5
model parameter : 778784
model size : 3.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.282188177108765
Epoch: 1, Steps: 10 | Train Loss: 1.479 Vali Loss: 1.391 Vali Acc: 0.324 Test Loss: 1.391 Test Acc: 0.324
Validation loss decreased (inf --> -0.324310).  Saving model ...
Epoch: 2 cost time: 3.051769733428955
Epoch: 2, Steps: 10 | Train Loss: 1.448 Vali Loss: 1.433 Vali Acc: 0.189 Test Loss: 1.433 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.651447296142578
Epoch: 3, Steps: 10 | Train Loss: 1.380 Vali Loss: 1.404 Vali Acc: 0.351 Test Loss: 1.404 Test Acc: 0.351
Validation loss decreased (-0.324310 --> -0.351337).  Saving model ...
Epoch: 4 cost time: 2.5126004219055176
Epoch: 4, Steps: 10 | Train Loss: 1.375 Vali Loss: 1.375 Vali Acc: 0.216 Test Loss: 1.375 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.6474575996398926
Epoch: 5, Steps: 10 | Train Loss: 1.273 Vali Loss: 1.408 Vali Acc: 0.284 Test Loss: 1.408 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.1024436950683594
Epoch: 6, Steps: 10 | Train Loss: 1.268 Vali Loss: 1.357 Vali Acc: 0.378 Test Loss: 1.357 Test Acc: 0.378
Validation loss decreased (-0.351337 --> -0.378365).  Saving model ...
Epoch: 7 cost time: 2.2379019260406494
Epoch: 7, Steps: 10 | Train Loss: 1.210 Vali Loss: 1.376 Vali Acc: 0.297 Test Loss: 1.376 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.819572925567627
Epoch: 8, Steps: 10 | Train Loss: 1.105 Vali Loss: 1.381 Vali Acc: 0.338 Test Loss: 1.381 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.2509138584136963
Epoch: 9, Steps: 10 | Train Loss: 1.016 Vali Loss: 1.341 Vali Acc: 0.432 Test Loss: 1.341 Test Acc: 0.432
Validation loss decreased (-0.378365 --> -0.432419).  Saving model ...
Epoch: 10 cost time: 2.1641428470611572
Epoch: 10, Steps: 10 | Train Loss: 0.949 Vali Loss: 1.381 Vali Acc: 0.338 Test Loss: 1.381 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.3509726524353027
Epoch: 11, Steps: 10 | Train Loss: 0.848 Vali Loss: 1.286 Vali Acc: 0.473 Test Loss: 1.286 Test Acc: 0.473
Validation loss decreased (-0.432419 --> -0.472960).  Saving model ...
Epoch: 12 cost time: 2.2633535861968994
Epoch: 12, Steps: 10 | Train Loss: 0.774 Vali Loss: 1.292 Vali Acc: 0.446 Test Loss: 1.292 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.550313949584961
Epoch: 13, Steps: 10 | Train Loss: 0.712 Vali Loss: 1.336 Vali Acc: 0.432 Test Loss: 1.336 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.1088225841522217
Epoch: 14, Steps: 10 | Train Loss: 0.634 Vali Loss: 1.300 Vali Acc: 0.500 Test Loss: 1.300 Test Acc: 0.500
Validation loss decreased (-0.472960 --> -0.499987).  Saving model ...
Epoch: 15 cost time: 2.692037582397461
Epoch: 15, Steps: 10 | Train Loss: 0.527 Vali Loss: 1.325 Vali Acc: 0.459 Test Loss: 1.325 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.6143717765808105
Epoch: 16, Steps: 10 | Train Loss: 0.468 Vali Loss: 1.371 Vali Acc: 0.486 Test Loss: 1.371 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.409980297088623
Epoch: 17, Steps: 10 | Train Loss: 0.384 Vali Loss: 1.297 Vali Acc: 0.500 Test Loss: 1.297 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 18 cost time: 2.3967905044555664
Epoch: 18, Steps: 10 | Train Loss: 0.352 Vali Loss: 1.392 Vali Acc: 0.486 Test Loss: 1.392 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.583638906478882
Epoch: 19, Steps: 10 | Train Loss: 0.291 Vali Loss: 1.420 Vali Acc: 0.419 Test Loss: 1.420 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.4321746826171875
Epoch: 20, Steps: 10 | Train Loss: 0.241 Vali Loss: 1.485 Vali Acc: 0.446 Test Loss: 1.485 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.5534465312957764
Epoch: 21, Steps: 10 | Train Loss: 0.187 Vali Loss: 1.422 Vali Acc: 0.486 Test Loss: 1.422 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.1682231426239014
Epoch: 22, Steps: 10 | Train Loss: 0.165 Vali Loss: 1.378 Vali Acc: 0.473 Test Loss: 1.378 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.0472753047943115
Epoch: 23, Steps: 10 | Train Loss: 0.135 Vali Loss: 1.551 Vali Acc: 0.486 Test Loss: 1.551 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.383822441101074
Epoch: 24, Steps: 10 | Train Loss: 0.097 Vali Loss: 1.541 Vali Acc: 0.473 Test Loss: 1.541 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.513749361038208
Epoch: 25, Steps: 10 | Train Loss: 0.073 Vali Loss: 1.521 Vali Acc: 0.473 Test Loss: 1.521 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.775937795639038
Epoch: 26, Steps: 10 | Train Loss: 0.062 Vali Loss: 1.544 Vali Acc: 0.446 Test Loss: 1.544 Test Acc: 0.446
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.1625049114227295
Epoch: 27, Steps: 10 | Train Loss: 0.060 Vali Loss: 1.619 Vali Acc: 0.432 Test Loss: 1.619 Test Acc: 0.432
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5
model parameter : 776704
model size : 3.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.973067283630371
Epoch: 1, Steps: 10 | Train Loss: 1.495 Vali Loss: 1.413 Vali Acc: 0.338 Test Loss: 1.413 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 2.369386672973633
Epoch: 2, Steps: 10 | Train Loss: 1.439 Vali Loss: 1.427 Vali Acc: 0.243 Test Loss: 1.427 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.1770267486572266
Epoch: 3, Steps: 10 | Train Loss: 1.428 Vali Loss: 1.359 Vali Acc: 0.338 Test Loss: 1.359 Test Acc: 0.338
Validation loss decreased (-0.337824 --> -0.337824).  Saving model ...
Epoch: 4 cost time: 2.2027783393859863
Epoch: 4, Steps: 10 | Train Loss: 1.389 Vali Loss: 1.393 Vali Acc: 0.230 Test Loss: 1.393 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.337252616882324
Epoch: 5, Steps: 10 | Train Loss: 1.368 Vali Loss: 1.374 Vali Acc: 0.284 Test Loss: 1.374 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.4569616317749023
Epoch: 6, Steps: 10 | Train Loss: 1.221 Vali Loss: 1.332 Vali Acc: 0.324 Test Loss: 1.332 Test Acc: 0.324
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.2159030437469482
Epoch: 7, Steps: 10 | Train Loss: 1.242 Vali Loss: 1.313 Vali Acc: 0.311 Test Loss: 1.313 Test Acc: 0.311
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.0242700576782227
Epoch: 8, Steps: 10 | Train Loss: 1.174 Vali Loss: 1.324 Vali Acc: 0.378 Test Loss: 1.324 Test Acc: 0.378
Validation loss decreased (-0.337824 --> -0.378365).  Saving model ...
Epoch: 9 cost time: 2.16801381111145
Epoch: 9, Steps: 10 | Train Loss: 1.151 Vali Loss: 1.261 Vali Acc: 0.311 Test Loss: 1.261 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.475196123123169
Epoch: 10, Steps: 10 | Train Loss: 1.019 Vali Loss: 1.316 Vali Acc: 0.392 Test Loss: 1.316 Test Acc: 0.392
Validation loss decreased (-0.378365 --> -0.391879).  Saving model ...
Epoch: 11 cost time: 2.425154685974121
Epoch: 11, Steps: 10 | Train Loss: 0.971 Vali Loss: 1.213 Vali Acc: 0.392 Test Loss: 1.213 Test Acc: 0.392
Validation loss decreased (-0.391879 --> -0.391880).  Saving model ...
Epoch: 12 cost time: 2.105067491531372
Epoch: 12, Steps: 10 | Train Loss: 0.869 Vali Loss: 1.279 Vali Acc: 0.365 Test Loss: 1.279 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.1374545097351074
Epoch: 13, Steps: 10 | Train Loss: 0.802 Vali Loss: 1.174 Vali Acc: 0.473 Test Loss: 1.174 Test Acc: 0.473
Validation loss decreased (-0.391880 --> -0.472961).  Saving model ...
Epoch: 14 cost time: 2.4735865592956543
Epoch: 14, Steps: 10 | Train Loss: 0.729 Vali Loss: 1.283 Vali Acc: 0.419 Test Loss: 1.283 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.6398239135742188
Epoch: 15, Steps: 10 | Train Loss: 0.668 Vali Loss: 1.172 Vali Acc: 0.514 Test Loss: 1.172 Test Acc: 0.514
Validation loss decreased (-0.472961 --> -0.513502).  Saving model ...
Epoch: 16 cost time: 2.4064137935638428
Epoch: 16, Steps: 10 | Train Loss: 0.599 Vali Loss: 1.198 Vali Acc: 0.446 Test Loss: 1.198 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.5609848499298096
Epoch: 17, Steps: 10 | Train Loss: 0.545 Vali Loss: 1.184 Vali Acc: 0.486 Test Loss: 1.184 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.9082942008972168
Epoch: 18, Steps: 10 | Train Loss: 0.456 Vali Loss: 1.160 Vali Acc: 0.514 Test Loss: 1.160 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513502).  Saving model ...
Epoch: 19 cost time: 2.347604274749756
Epoch: 19, Steps: 10 | Train Loss: 0.384 Vali Loss: 1.276 Vali Acc: 0.419 Test Loss: 1.276 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.8843910694122314
Epoch: 20, Steps: 10 | Train Loss: 0.350 Vali Loss: 1.163 Vali Acc: 0.514 Test Loss: 1.163 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.418936014175415
Epoch: 21, Steps: 10 | Train Loss: 0.278 Vali Loss: 1.199 Vali Acc: 0.459 Test Loss: 1.199 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.1294264793395996
Epoch: 22, Steps: 10 | Train Loss: 0.239 Vali Loss: 1.227 Vali Acc: 0.405 Test Loss: 1.227 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.3976190090179443
Epoch: 23, Steps: 10 | Train Loss: 0.222 Vali Loss: 1.264 Vali Acc: 0.459 Test Loss: 1.264 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.060871124267578
Epoch: 24, Steps: 10 | Train Loss: 0.175 Vali Loss: 1.285 Vali Acc: 0.486 Test Loss: 1.285 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.4141218662261963
Epoch: 25, Steps: 10 | Train Loss: 0.140 Vali Loss: 1.306 Vali Acc: 0.432 Test Loss: 1.306 Test Acc: 0.432
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.067905902862549
Epoch: 26, Steps: 10 | Train Loss: 0.127 Vali Loss: 1.272 Vali Acc: 0.446 Test Loss: 1.272 Test Acc: 0.446
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.72650408744812
Epoch: 27, Steps: 10 | Train Loss: 0.102 Vali Loss: 1.329 Vali Acc: 0.432 Test Loss: 1.329 Test Acc: 0.432
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.253906488418579
Epoch: 28, Steps: 10 | Train Loss: 0.087 Vali Loss: 1.372 Vali Acc: 0.473 Test Loss: 1.372 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5135135135135135
model parameter : 483424
model size : 2.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.100553035736084
Epoch: 1, Steps: 10 | Train Loss: 1.458 Vali Loss: 1.419 Vali Acc: 0.230 Test Loss: 1.419 Test Acc: 0.230
Validation loss decreased (inf --> -0.229716).  Saving model ...
Epoch: 2 cost time: 2.101235866546631
Epoch: 2, Steps: 10 | Train Loss: 1.424 Vali Loss: 1.380 Vali Acc: 0.216 Test Loss: 1.380 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.117053747177124
Epoch: 3, Steps: 10 | Train Loss: 1.379 Vali Loss: 1.404 Vali Acc: 0.243 Test Loss: 1.404 Test Acc: 0.243
Validation loss decreased (-0.229716 --> -0.243229).  Saving model ...
Epoch: 4 cost time: 2.3814942836761475
Epoch: 4, Steps: 10 | Train Loss: 1.342 Vali Loss: 1.384 Vali Acc: 0.311 Test Loss: 1.384 Test Acc: 0.311
Validation loss decreased (-0.243229 --> -0.310797).  Saving model ...
Epoch: 5 cost time: 2.3640036582946777
Epoch: 5, Steps: 10 | Train Loss: 1.343 Vali Loss: 1.352 Vali Acc: 0.284 Test Loss: 1.352 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.166494607925415
Epoch: 6, Steps: 10 | Train Loss: 1.294 Vali Loss: 1.367 Vali Acc: 0.351 Test Loss: 1.367 Test Acc: 0.351
Validation loss decreased (-0.310797 --> -0.351338).  Saving model ...
Epoch: 7 cost time: 1.9604582786560059
Epoch: 7, Steps: 10 | Train Loss: 1.191 Vali Loss: 1.351 Vali Acc: 0.270 Test Loss: 1.351 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.1844213008880615
Epoch: 8, Steps: 10 | Train Loss: 1.169 Vali Loss: 1.311 Vali Acc: 0.338 Test Loss: 1.311 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.107534170150757
Epoch: 9, Steps: 10 | Train Loss: 1.102 Vali Loss: 1.350 Vali Acc: 0.392 Test Loss: 1.350 Test Acc: 0.392
Validation loss decreased (-0.351338 --> -0.391878).  Saving model ...
Epoch: 10 cost time: 2.2546963691711426
Epoch: 10, Steps: 10 | Train Loss: 1.051 Vali Loss: 1.288 Vali Acc: 0.419 Test Loss: 1.288 Test Acc: 0.419
Validation loss decreased (-0.391878 --> -0.418906).  Saving model ...
Epoch: 11 cost time: 2.1590323448181152
Epoch: 11, Steps: 10 | Train Loss: 0.940 Vali Loss: 1.329 Vali Acc: 0.392 Test Loss: 1.329 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.618159770965576
Epoch: 12, Steps: 10 | Train Loss: 0.845 Vali Loss: 1.252 Vali Acc: 0.486 Test Loss: 1.252 Test Acc: 0.486
Validation loss decreased (-0.418906 --> -0.486474).  Saving model ...
Epoch: 13 cost time: 2.4751672744750977
Epoch: 13, Steps: 10 | Train Loss: 0.760 Vali Loss: 1.350 Vali Acc: 0.405 Test Loss: 1.350 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.615508794784546
Epoch: 14, Steps: 10 | Train Loss: 0.692 Vali Loss: 1.227 Vali Acc: 0.473 Test Loss: 1.227 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.6514596939086914
Epoch: 15, Steps: 10 | Train Loss: 0.623 Vali Loss: 1.257 Vali Acc: 0.486 Test Loss: 1.257 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.380702495574951
Epoch: 16, Steps: 10 | Train Loss: 0.561 Vali Loss: 1.336 Vali Acc: 0.432 Test Loss: 1.336 Test Acc: 0.432
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.5482423305511475
Epoch: 17, Steps: 10 | Train Loss: 0.458 Vali Loss: 1.311 Vali Acc: 0.473 Test Loss: 1.311 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.6371819972991943
Epoch: 18, Steps: 10 | Train Loss: 0.400 Vali Loss: 1.282 Vali Acc: 0.473 Test Loss: 1.282 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.3111655712127686
Epoch: 19, Steps: 10 | Train Loss: 0.355 Vali Loss: 1.398 Vali Acc: 0.446 Test Loss: 1.398 Test Acc: 0.446
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.585615396499634
Epoch: 20, Steps: 10 | Train Loss: 0.324 Vali Loss: 1.334 Vali Acc: 0.432 Test Loss: 1.334 Test Acc: 0.432
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.2854771614074707
Epoch: 21, Steps: 10 | Train Loss: 0.255 Vali Loss: 1.361 Vali Acc: 0.459 Test Loss: 1.361 Test Acc: 0.459
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.1055285930633545
Epoch: 22, Steps: 10 | Train Loss: 0.211 Vali Loss: 1.399 Vali Acc: 0.446 Test Loss: 1.399 Test Acc: 0.446
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.4864864864864865
model parameter : 481344
model size : 2.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.121227979660034
Epoch: 1, Steps: 10 | Train Loss: 1.454 Vali Loss: 1.420 Vali Acc: 0.243 Test Loss: 1.420 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 2.099163055419922
Epoch: 2, Steps: 10 | Train Loss: 1.445 Vali Loss: 1.379 Vali Acc: 0.230 Test Loss: 1.379 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.430882453918457
Epoch: 3, Steps: 10 | Train Loss: 1.397 Vali Loss: 1.393 Vali Acc: 0.351 Test Loss: 1.393 Test Acc: 0.351
Validation loss decreased (-0.243229 --> -0.351337).  Saving model ...
Epoch: 4 cost time: 2.5172007083892822
Epoch: 4, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.383 Vali Acc: 0.257 Test Loss: 1.383 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.3254313468933105
Epoch: 5, Steps: 10 | Train Loss: 1.379 Vali Loss: 1.422 Vali Acc: 0.216 Test Loss: 1.422 Test Acc: 0.216
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.9698474407196045
Epoch: 6, Steps: 10 | Train Loss: 1.308 Vali Loss: 1.362 Vali Acc: 0.365 Test Loss: 1.362 Test Acc: 0.365
Validation loss decreased (-0.351337 --> -0.364851).  Saving model ...
Epoch: 7 cost time: 1.9824495315551758
Epoch: 7, Steps: 10 | Train Loss: 1.312 Vali Loss: 1.349 Vali Acc: 0.338 Test Loss: 1.349 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.107685089111328
Epoch: 8, Steps: 10 | Train Loss: 1.269 Vali Loss: 1.304 Vali Acc: 0.473 Test Loss: 1.304 Test Acc: 0.473
Validation loss decreased (-0.364851 --> -0.472960).  Saving model ...
Epoch: 9 cost time: 2.1224920749664307
Epoch: 9, Steps: 10 | Train Loss: 1.160 Vali Loss: 1.263 Vali Acc: 0.419 Test Loss: 1.263 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.6539289951324463
Epoch: 10, Steps: 10 | Train Loss: 1.063 Vali Loss: 1.209 Vali Acc: 0.486 Test Loss: 1.209 Test Acc: 0.486
Validation loss decreased (-0.472960 --> -0.486474).  Saving model ...
Epoch: 11 cost time: 2.78949236869812
Epoch: 11, Steps: 10 | Train Loss: 0.994 Vali Loss: 1.221 Vali Acc: 0.473 Test Loss: 1.221 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.0537633895874023
Epoch: 12, Steps: 10 | Train Loss: 0.892 Vali Loss: 1.178 Vali Acc: 0.554 Test Loss: 1.178 Test Acc: 0.554
Validation loss decreased (-0.486474 --> -0.554042).  Saving model ...
Epoch: 13 cost time: 4.740571737289429
Epoch: 13, Steps: 10 | Train Loss: 0.801 Vali Loss: 1.163 Vali Acc: 0.541 Test Loss: 1.163 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.071909666061401
Epoch: 14, Steps: 10 | Train Loss: 0.760 Vali Loss: 1.172 Vali Acc: 0.500 Test Loss: 1.172 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.767049789428711
Epoch: 15, Steps: 10 | Train Loss: 0.680 Vali Loss: 1.204 Vali Acc: 0.514 Test Loss: 1.204 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.046769380569458
Epoch: 16, Steps: 10 | Train Loss: 0.604 Vali Loss: 1.233 Vali Acc: 0.486 Test Loss: 1.233 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.211376428604126
Epoch: 17, Steps: 10 | Train Loss: 0.496 Vali Loss: 1.142 Vali Acc: 0.514 Test Loss: 1.142 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.2671029567718506
Epoch: 18, Steps: 10 | Train Loss: 0.459 Vali Loss: 1.250 Vali Acc: 0.486 Test Loss: 1.250 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.828963279724121
Epoch: 19, Steps: 10 | Train Loss: 0.391 Vali Loss: 1.174 Vali Acc: 0.473 Test Loss: 1.174 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.2655885219573975
Epoch: 20, Steps: 10 | Train Loss: 0.334 Vali Loss: 1.213 Vali Acc: 0.500 Test Loss: 1.213 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.3624117374420166
Epoch: 21, Steps: 10 | Train Loss: 0.258 Vali Loss: 1.155 Vali Acc: 0.527 Test Loss: 1.155 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.5045788288116455
Epoch: 22, Steps: 10 | Train Loss: 0.219 Vali Loss: 1.258 Vali Acc: 0.473 Test Loss: 1.258 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 479264
model size : 2.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.318176031112671
Epoch: 1, Steps: 10 | Train Loss: 1.505 Vali Loss: 1.451 Vali Acc: 0.216 Test Loss: 1.451 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 2.3676071166992188
Epoch: 2, Steps: 10 | Train Loss: 1.418 Vali Loss: 1.393 Vali Acc: 0.203 Test Loss: 1.393 Test Acc: 0.203
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.631530284881592
Epoch: 3, Steps: 10 | Train Loss: 1.431 Vali Loss: 1.402 Vali Acc: 0.216 Test Loss: 1.402 Test Acc: 0.216
Validation loss decreased (-0.216202 --> -0.216202).  Saving model ...
Epoch: 4 cost time: 2.351731777191162
Epoch: 4, Steps: 10 | Train Loss: 1.372 Vali Loss: 1.395 Vali Acc: 0.270 Test Loss: 1.395 Test Acc: 0.270
Validation loss decreased (-0.216202 --> -0.270256).  Saving model ...
Epoch: 5 cost time: 1.7774443626403809
Epoch: 5, Steps: 10 | Train Loss: 1.341 Vali Loss: 1.383 Vali Acc: 0.243 Test Loss: 1.383 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.0920443534851074
Epoch: 6, Steps: 10 | Train Loss: 1.322 Vali Loss: 1.375 Vali Acc: 0.284 Test Loss: 1.375 Test Acc: 0.284
Validation loss decreased (-0.270256 --> -0.283770).  Saving model ...
Epoch: 7 cost time: 2.276960849761963
Epoch: 7, Steps: 10 | Train Loss: 1.255 Vali Loss: 1.296 Vali Acc: 0.405 Test Loss: 1.296 Test Acc: 0.405
Validation loss decreased (-0.283770 --> -0.405392).  Saving model ...
Epoch: 8 cost time: 2.444016218185425
Epoch: 8, Steps: 10 | Train Loss: 1.208 Vali Loss: 1.381 Vali Acc: 0.216 Test Loss: 1.381 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.5777270793914795
Epoch: 9, Steps: 10 | Train Loss: 1.157 Vali Loss: 1.250 Vali Acc: 0.378 Test Loss: 1.250 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.2716610431671143
Epoch: 10, Steps: 10 | Train Loss: 1.034 Vali Loss: 1.380 Vali Acc: 0.284 Test Loss: 1.380 Test Acc: 0.284
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.3197953701019287
Epoch: 11, Steps: 10 | Train Loss: 0.996 Vali Loss: 1.194 Vali Acc: 0.405 Test Loss: 1.194 Test Acc: 0.405
Validation loss decreased (-0.405392 --> -0.405393).  Saving model ...
Epoch: 12 cost time: 2.0093460083007812
Epoch: 12, Steps: 10 | Train Loss: 0.871 Vali Loss: 1.200 Vali Acc: 0.419 Test Loss: 1.200 Test Acc: 0.419
Validation loss decreased (-0.405393 --> -0.418907).  Saving model ...
Epoch: 13 cost time: 2.1867008209228516
Epoch: 13, Steps: 10 | Train Loss: 0.785 Vali Loss: 1.183 Vali Acc: 0.405 Test Loss: 1.183 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.1208643913269043
Epoch: 14, Steps: 10 | Train Loss: 0.709 Vali Loss: 1.175 Vali Acc: 0.392 Test Loss: 1.175 Test Acc: 0.392
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.056774377822876
Epoch: 15, Steps: 10 | Train Loss: 0.623 Vali Loss: 1.163 Vali Acc: 0.405 Test Loss: 1.163 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.3169538974761963
Epoch: 16, Steps: 10 | Train Loss: 0.545 Vali Loss: 1.110 Vali Acc: 0.473 Test Loss: 1.110 Test Acc: 0.473
Validation loss decreased (-0.418907 --> -0.472962).  Saving model ...
Epoch: 17 cost time: 2.2803561687469482
Epoch: 17, Steps: 10 | Train Loss: 0.479 Vali Loss: 1.181 Vali Acc: 0.392 Test Loss: 1.181 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.295597553253174
Epoch: 18, Steps: 10 | Train Loss: 0.443 Vali Loss: 1.121 Vali Acc: 0.419 Test Loss: 1.121 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.9783222675323486
Epoch: 19, Steps: 10 | Train Loss: 0.351 Vali Loss: 1.075 Vali Acc: 0.500 Test Loss: 1.075 Test Acc: 0.500
Validation loss decreased (-0.472962 --> -0.499989).  Saving model ...
Epoch: 20 cost time: 2.3881218433380127
Epoch: 20, Steps: 10 | Train Loss: 0.310 Vali Loss: 1.097 Vali Acc: 0.446 Test Loss: 1.097 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.3751208782196045
Epoch: 21, Steps: 10 | Train Loss: 0.244 Vali Loss: 1.116 Vali Acc: 0.486 Test Loss: 1.116 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.352679491043091
Epoch: 22, Steps: 10 | Train Loss: 0.213 Vali Loss: 1.222 Vali Acc: 0.459 Test Loss: 1.222 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.051504611968994
Epoch: 23, Steps: 10 | Train Loss: 0.171 Vali Loss: 1.131 Vali Acc: 0.527 Test Loss: 1.131 Test Acc: 0.527
Validation loss decreased (-0.499989 --> -0.527016).  Saving model ...
Epoch: 24 cost time: 2.2998199462890625
Epoch: 24, Steps: 10 | Train Loss: 0.139 Vali Loss: 1.177 Vali Acc: 0.419 Test Loss: 1.177 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.5258889198303223
Epoch: 25, Steps: 10 | Train Loss: 0.136 Vali Loss: 1.163 Vali Acc: 0.446 Test Loss: 1.163 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.4191734790802
Epoch: 26, Steps: 10 | Train Loss: 0.107 Vali Loss: 1.168 Vali Acc: 0.473 Test Loss: 1.168 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.042962074279785
Epoch: 27, Steps: 10 | Train Loss: 0.095 Vali Loss: 1.227 Vali Acc: 0.541 Test Loss: 1.227 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540528).  Saving model ...
Epoch: 28 cost time: 2.240230083465576
Epoch: 28, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.195 Vali Acc: 0.459 Test Loss: 1.195 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.4429750442504883
Epoch: 29, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.204 Vali Acc: 0.500 Test Loss: 1.204 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.4690043926239014
Epoch: 30, Steps: 10 | Train Loss: 0.062 Vali Loss: 1.247 Vali Acc: 0.486 Test Loss: 1.247 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.149174690246582
Epoch: 31, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.227 Vali Acc: 0.446 Test Loss: 1.227 Test Acc: 0.446
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.9528167247772217
Epoch: 32, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.273 Vali Acc: 0.514 Test Loss: 1.273 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.1552319526672363
Epoch: 33, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.295 Vali Acc: 0.473 Test Loss: 1.295 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.1173973083496094
Epoch: 34, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.348 Vali Acc: 0.514 Test Loss: 1.348 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 2.3135340213775635
Epoch: 35, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.329 Vali Acc: 0.486 Test Loss: 1.329 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 2.070344924926758
Epoch: 36, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.350 Vali Acc: 0.473 Test Loss: 1.350 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.9217610359191895
Epoch: 37, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.402 Vali Acc: 0.459 Test Loss: 1.402 Test Acc: 0.459
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 477184
model size : 2.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.009097337722778
Epoch: 1, Steps: 10 | Train Loss: 1.477 Vali Loss: 1.401 Vali Acc: 0.230 Test Loss: 1.401 Test Acc: 0.230
Validation loss decreased (inf --> -0.229716).  Saving model ...
Epoch: 2 cost time: 2.0658223628997803
Epoch: 2, Steps: 10 | Train Loss: 1.409 Vali Loss: 1.361 Vali Acc: 0.270 Test Loss: 1.361 Test Acc: 0.270
Validation loss decreased (-0.229716 --> -0.270257).  Saving model ...
Epoch: 3 cost time: 2.078162908554077
Epoch: 3, Steps: 10 | Train Loss: 1.368 Vali Loss: 1.364 Vali Acc: 0.257 Test Loss: 1.364 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.151118516921997
Epoch: 4, Steps: 10 | Train Loss: 1.352 Vali Loss: 1.414 Vali Acc: 0.230 Test Loss: 1.414 Test Acc: 0.230
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.949732780456543
Epoch: 5, Steps: 10 | Train Loss: 1.334 Vali Loss: 1.329 Vali Acc: 0.392 Test Loss: 1.329 Test Acc: 0.392
Validation loss decreased (-0.270257 --> -0.391879).  Saving model ...
Epoch: 6 cost time: 1.9263248443603516
Epoch: 6, Steps: 10 | Train Loss: 1.311 Vali Loss: 1.394 Vali Acc: 0.230 Test Loss: 1.394 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.3271539211273193
Epoch: 7, Steps: 10 | Train Loss: 1.198 Vali Loss: 1.310 Vali Acc: 0.378 Test Loss: 1.310 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.0810203552246094
Epoch: 8, Steps: 10 | Train Loss: 1.163 Vali Loss: 1.340 Vali Acc: 0.284 Test Loss: 1.340 Test Acc: 0.284
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.13649582862854
Epoch: 9, Steps: 10 | Train Loss: 1.082 Vali Loss: 1.290 Vali Acc: 0.324 Test Loss: 1.290 Test Acc: 0.324
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.1082839965820312
Epoch: 10, Steps: 10 | Train Loss: 1.014 Vali Loss: 1.297 Vali Acc: 0.392 Test Loss: 1.297 Test Acc: 0.392
Validation loss decreased (-0.391879 --> -0.391879).  Saving model ...
Epoch: 11 cost time: 2.0708792209625244
Epoch: 11, Steps: 10 | Train Loss: 0.940 Vali Loss: 1.228 Vali Acc: 0.405 Test Loss: 1.228 Test Acc: 0.405
Validation loss decreased (-0.391879 --> -0.405393).  Saving model ...
Epoch: 12 cost time: 2.453808546066284
Epoch: 12, Steps: 10 | Train Loss: 0.887 Vali Loss: 1.317 Vali Acc: 0.378 Test Loss: 1.317 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.4114513397216797
Epoch: 13, Steps: 10 | Train Loss: 0.817 Vali Loss: 1.179 Vali Acc: 0.378 Test Loss: 1.179 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.162551164627075
Epoch: 14, Steps: 10 | Train Loss: 0.728 Vali Loss: 1.219 Vali Acc: 0.473 Test Loss: 1.219 Test Acc: 0.473
Validation loss decreased (-0.405393 --> -0.472961).  Saving model ...
Epoch: 15 cost time: 2.024261474609375
Epoch: 15, Steps: 10 | Train Loss: 0.648 Vali Loss: 1.175 Vali Acc: 0.405 Test Loss: 1.175 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8318850994110107
Epoch: 16, Steps: 10 | Train Loss: 0.576 Vali Loss: 1.168 Vali Acc: 0.459 Test Loss: 1.168 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.3424887657165527
Epoch: 17, Steps: 10 | Train Loss: 0.492 Vali Loss: 1.173 Vali Acc: 0.419 Test Loss: 1.173 Test Acc: 0.419
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.2299394607543945
Epoch: 18, Steps: 10 | Train Loss: 0.457 Vali Loss: 1.154 Vali Acc: 0.459 Test Loss: 1.154 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.0410406589508057
Epoch: 19, Steps: 10 | Train Loss: 0.370 Vali Loss: 1.179 Vali Acc: 0.473 Test Loss: 1.179 Test Acc: 0.473
Validation loss decreased (-0.472961 --> -0.472961).  Saving model ...
Epoch: 20 cost time: 2.0652687549591064
Epoch: 20, Steps: 10 | Train Loss: 0.327 Vali Loss: 1.184 Vali Acc: 0.432 Test Loss: 1.184 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.0146632194519043
Epoch: 21, Steps: 10 | Train Loss: 0.279 Vali Loss: 1.213 Vali Acc: 0.500 Test Loss: 1.213 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499988).  Saving model ...
Epoch: 22 cost time: 2.1828389167785645
Epoch: 22, Steps: 10 | Train Loss: 0.231 Vali Loss: 1.140 Vali Acc: 0.514 Test Loss: 1.140 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 23 cost time: 2.1555473804473877
Epoch: 23, Steps: 10 | Train Loss: 0.180 Vali Loss: 1.204 Vali Acc: 0.473 Test Loss: 1.204 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.017056465148926
Epoch: 24, Steps: 10 | Train Loss: 0.169 Vali Loss: 1.221 Vali Acc: 0.446 Test Loss: 1.221 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.136928081512451
Epoch: 25, Steps: 10 | Train Loss: 0.138 Vali Loss: 1.212 Vali Acc: 0.473 Test Loss: 1.212 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.9890868663787842
Epoch: 26, Steps: 10 | Train Loss: 0.119 Vali Loss: 1.268 Vali Acc: 0.459 Test Loss: 1.268 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.2824103832244873
Epoch: 27, Steps: 10 | Train Loss: 0.092 Vali Loss: 1.239 Vali Acc: 0.486 Test Loss: 1.239 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.3217692375183105
Epoch: 28, Steps: 10 | Train Loss: 0.085 Vali Loss: 1.241 Vali Acc: 0.473 Test Loss: 1.241 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.326495409011841
Epoch: 29, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.269 Vali Acc: 0.459 Test Loss: 1.269 Test Acc: 0.459
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.9375808238983154
Epoch: 30, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.281 Vali Acc: 0.486 Test Loss: 1.281 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.260509729385376
Epoch: 31, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.299 Vali Acc: 0.459 Test Loss: 1.299 Test Acc: 0.459
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.9238996505737305
Epoch: 32, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.293 Vali Acc: 0.486 Test Loss: 1.293 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5135135135135135
model parameter : 333664
model size : 2.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.070511817932129
Epoch: 1, Steps: 10 | Train Loss: 1.572 Vali Loss: 1.393 Vali Acc: 0.216 Test Loss: 1.393 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 1.847787618637085
Epoch: 2, Steps: 10 | Train Loss: 1.452 Vali Loss: 1.360 Vali Acc: 0.351 Test Loss: 1.360 Test Acc: 0.351
Validation loss decreased (-0.216202 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 2.123054265975952
Epoch: 3, Steps: 10 | Train Loss: 1.425 Vali Loss: 1.431 Vali Acc: 0.176 Test Loss: 1.431 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.6168689727783203
Epoch: 4, Steps: 10 | Train Loss: 1.367 Vali Loss: 1.348 Vali Acc: 0.311 Test Loss: 1.348 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.4702489376068115
Epoch: 5, Steps: 10 | Train Loss: 1.341 Vali Loss: 1.334 Vali Acc: 0.405 Test Loss: 1.334 Test Acc: 0.405
Validation loss decreased (-0.351338 --> -0.405392).  Saving model ...
Epoch: 6 cost time: 2.4733731746673584
Epoch: 6, Steps: 10 | Train Loss: 1.330 Vali Loss: 1.349 Vali Acc: 0.284 Test Loss: 1.349 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.184232473373413
Epoch: 7, Steps: 10 | Train Loss: 1.277 Vali Loss: 1.276 Vali Acc: 0.473 Test Loss: 1.276 Test Acc: 0.473
Validation loss decreased (-0.405392 --> -0.472960).  Saving model ...
Epoch: 8 cost time: 2.437758445739746
Epoch: 8, Steps: 10 | Train Loss: 1.217 Vali Loss: 1.267 Vali Acc: 0.459 Test Loss: 1.267 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.281883478164673
Epoch: 9, Steps: 10 | Train Loss: 1.127 Vali Loss: 1.242 Vali Acc: 0.459 Test Loss: 1.242 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.48819899559021
Epoch: 10, Steps: 10 | Train Loss: 1.060 Vali Loss: 1.227 Vali Acc: 0.514 Test Loss: 1.227 Test Acc: 0.514
Validation loss decreased (-0.472960 --> -0.513501).  Saving model ...
Epoch: 11 cost time: 2.040398120880127
Epoch: 11, Steps: 10 | Train Loss: 1.011 Vali Loss: 1.173 Vali Acc: 0.514 Test Loss: 1.173 Test Acc: 0.514
Validation loss decreased (-0.513501 --> -0.513502).  Saving model ...
Epoch: 12 cost time: 2.328801155090332
Epoch: 12, Steps: 10 | Train Loss: 0.901 Vali Loss: 1.199 Vali Acc: 0.500 Test Loss: 1.199 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.3787384033203125
Epoch: 13, Steps: 10 | Train Loss: 0.828 Vali Loss: 1.137 Vali Acc: 0.568 Test Loss: 1.137 Test Acc: 0.568
Validation loss decreased (-0.513502 --> -0.567556).  Saving model ...
Epoch: 14 cost time: 1.9882309436798096
Epoch: 14, Steps: 10 | Train Loss: 0.763 Vali Loss: 1.143 Vali Acc: 0.554 Test Loss: 1.143 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.466156005859375
Epoch: 15, Steps: 10 | Train Loss: 0.710 Vali Loss: 1.117 Vali Acc: 0.541 Test Loss: 1.117 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.0527195930480957
Epoch: 16, Steps: 10 | Train Loss: 0.646 Vali Loss: 1.110 Vali Acc: 0.527 Test Loss: 1.110 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.3928661346435547
Epoch: 17, Steps: 10 | Train Loss: 0.559 Vali Loss: 1.128 Vali Acc: 0.500 Test Loss: 1.128 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.4989233016967773
Epoch: 18, Steps: 10 | Train Loss: 0.488 Vali Loss: 1.095 Vali Acc: 0.527 Test Loss: 1.095 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.377840280532837
Epoch: 19, Steps: 10 | Train Loss: 0.442 Vali Loss: 1.101 Vali Acc: 0.486 Test Loss: 1.101 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.937775135040283
Epoch: 20, Steps: 10 | Train Loss: 0.379 Vali Loss: 1.095 Vali Acc: 0.473 Test Loss: 1.095 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.256575584411621
Epoch: 21, Steps: 10 | Train Loss: 0.312 Vali Loss: 1.089 Vali Acc: 0.527 Test Loss: 1.089 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.0353493690490723
Epoch: 22, Steps: 10 | Train Loss: 0.289 Vali Loss: 1.103 Vali Acc: 0.514 Test Loss: 1.103 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.2082784175872803
Epoch: 23, Steps: 10 | Train Loss: 0.233 Vali Loss: 1.155 Vali Acc: 0.514 Test Loss: 1.155 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 331584
model size : 2.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.106119394302368
Epoch: 1, Steps: 10 | Train Loss: 1.543 Vali Loss: 1.387 Vali Acc: 0.230 Test Loss: 1.387 Test Acc: 0.230
Validation loss decreased (inf --> -0.229716).  Saving model ...
Epoch: 2 cost time: 2.2873713970184326
Epoch: 2, Steps: 10 | Train Loss: 1.460 Vali Loss: 1.374 Vali Acc: 0.284 Test Loss: 1.374 Test Acc: 0.284
Validation loss decreased (-0.229716 --> -0.283770).  Saving model ...
Epoch: 3 cost time: 2.1198136806488037
Epoch: 3, Steps: 10 | Train Loss: 1.454 Vali Loss: 1.358 Vali Acc: 0.297 Test Loss: 1.358 Test Acc: 0.297
Validation loss decreased (-0.283770 --> -0.297284).  Saving model ...
Epoch: 4 cost time: 2.556730270385742
Epoch: 4, Steps: 10 | Train Loss: 1.433 Vali Loss: 1.381 Vali Acc: 0.230 Test Loss: 1.381 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2400333881378174
Epoch: 5, Steps: 10 | Train Loss: 1.342 Vali Loss: 1.386 Vali Acc: 0.243 Test Loss: 1.386 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.346327066421509
Epoch: 6, Steps: 10 | Train Loss: 1.344 Vali Loss: 1.332 Vali Acc: 0.378 Test Loss: 1.332 Test Acc: 0.378
Validation loss decreased (-0.297284 --> -0.378365).  Saving model ...
Epoch: 7 cost time: 2.726624011993408
Epoch: 7, Steps: 10 | Train Loss: 1.326 Vali Loss: 1.330 Vali Acc: 0.392 Test Loss: 1.330 Test Acc: 0.392
Validation loss decreased (-0.378365 --> -0.391879).  Saving model ...
Epoch: 8 cost time: 2.036302328109741
Epoch: 8, Steps: 10 | Train Loss: 1.309 Vali Loss: 1.342 Vali Acc: 0.351 Test Loss: 1.342 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.4462716579437256
Epoch: 9, Steps: 10 | Train Loss: 1.216 Vali Loss: 1.303 Vali Acc: 0.392 Test Loss: 1.303 Test Acc: 0.392
Validation loss decreased (-0.391879 --> -0.391879).  Saving model ...
Epoch: 10 cost time: 2.5216469764709473
Epoch: 10, Steps: 10 | Train Loss: 1.184 Vali Loss: 1.317 Vali Acc: 0.351 Test Loss: 1.317 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.2500550746917725
Epoch: 11, Steps: 10 | Train Loss: 1.105 Vali Loss: 1.201 Vali Acc: 0.486 Test Loss: 1.201 Test Acc: 0.486
Validation loss decreased (-0.391879 --> -0.486474).  Saving model ...
Epoch: 12 cost time: 2.180389165878296
Epoch: 12, Steps: 10 | Train Loss: 1.050 Vali Loss: 1.279 Vali Acc: 0.446 Test Loss: 1.279 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.191460609436035
Epoch: 13, Steps: 10 | Train Loss: 0.934 Vali Loss: 1.141 Vali Acc: 0.514 Test Loss: 1.141 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513502).  Saving model ...
Epoch: 14 cost time: 2.2439417839050293
Epoch: 14, Steps: 10 | Train Loss: 0.806 Vali Loss: 1.200 Vali Acc: 0.486 Test Loss: 1.200 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.311245918273926
Epoch: 15, Steps: 10 | Train Loss: 0.765 Vali Loss: 1.160 Vali Acc: 0.486 Test Loss: 1.160 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.143490791320801
Epoch: 16, Steps: 10 | Train Loss: 0.648 Vali Loss: 1.136 Vali Acc: 0.541 Test Loss: 1.136 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540529).  Saving model ...
Epoch: 17 cost time: 2.297852039337158
Epoch: 17, Steps: 10 | Train Loss: 0.575 Vali Loss: 1.147 Vali Acc: 0.554 Test Loss: 1.147 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554043).  Saving model ...
Epoch: 18 cost time: 2.294639825820923
Epoch: 18, Steps: 10 | Train Loss: 0.506 Vali Loss: 1.120 Vali Acc: 0.554 Test Loss: 1.120 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554043).  Saving model ...
Epoch: 19 cost time: 2.074023485183716
Epoch: 19, Steps: 10 | Train Loss: 0.455 Vali Loss: 1.209 Vali Acc: 0.500 Test Loss: 1.209 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.4798033237457275
Epoch: 20, Steps: 10 | Train Loss: 0.374 Vali Loss: 1.165 Vali Acc: 0.500 Test Loss: 1.165 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.3939764499664307
Epoch: 21, Steps: 10 | Train Loss: 0.318 Vali Loss: 1.256 Vali Acc: 0.486 Test Loss: 1.256 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.13672137260437
Epoch: 22, Steps: 10 | Train Loss: 0.272 Vali Loss: 1.198 Vali Acc: 0.541 Test Loss: 1.198 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.298994541168213
Epoch: 23, Steps: 10 | Train Loss: 0.214 Vali Loss: 1.237 Vali Acc: 0.500 Test Loss: 1.237 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.1427597999572754
Epoch: 24, Steps: 10 | Train Loss: 0.172 Vali Loss: 1.278 Vali Acc: 0.500 Test Loss: 1.278 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.888235092163086
Epoch: 25, Steps: 10 | Train Loss: 0.149 Vali Loss: 1.307 Vali Acc: 0.486 Test Loss: 1.307 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.078714609146118
Epoch: 26, Steps: 10 | Train Loss: 0.115 Vali Loss: 1.273 Vali Acc: 0.527 Test Loss: 1.273 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.3586184978485107
Epoch: 27, Steps: 10 | Train Loss: 0.111 Vali Loss: 1.303 Vali Acc: 0.527 Test Loss: 1.303 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.4096567630767822
Epoch: 28, Steps: 10 | Train Loss: 0.104 Vali Loss: 1.388 Vali Acc: 0.486 Test Loss: 1.388 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 329504
model size : 2.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.33897590637207
Epoch: 1, Steps: 10 | Train Loss: 1.498 Vali Loss: 1.410 Vali Acc: 0.284 Test Loss: 1.410 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 2.1010372638702393
Epoch: 2, Steps: 10 | Train Loss: 1.423 Vali Loss: 1.352 Vali Acc: 0.392 Test Loss: 1.352 Test Acc: 0.392
Validation loss decreased (-0.283770 --> -0.391878).  Saving model ...
Epoch: 3 cost time: 2.0405120849609375
Epoch: 3, Steps: 10 | Train Loss: 1.413 Vali Loss: 1.380 Vali Acc: 0.351 Test Loss: 1.380 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.09965443611145
Epoch: 4, Steps: 10 | Train Loss: 1.373 Vali Loss: 1.374 Vali Acc: 0.257 Test Loss: 1.374 Test Acc: 0.257
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.893706798553467
Epoch: 5, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.392 Vali Acc: 0.243 Test Loss: 1.392 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.6748008728027344
Epoch: 6, Steps: 10 | Train Loss: 1.348 Vali Loss: 1.348 Vali Acc: 0.392 Test Loss: 1.348 Test Acc: 0.392
Validation loss decreased (-0.391878 --> -0.391878).  Saving model ...
Epoch: 7 cost time: 2.3215250968933105
Epoch: 7, Steps: 10 | Train Loss: 1.256 Vali Loss: 1.362 Vali Acc: 0.311 Test Loss: 1.362 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.1641952991485596
Epoch: 8, Steps: 10 | Train Loss: 1.238 Vali Loss: 1.306 Vali Acc: 0.392 Test Loss: 1.306 Test Acc: 0.392
Validation loss decreased (-0.391878 --> -0.391879).  Saving model ...
Epoch: 9 cost time: 2.0863726139068604
Epoch: 9, Steps: 10 | Train Loss: 1.210 Vali Loss: 1.335 Vali Acc: 0.351 Test Loss: 1.335 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.362769842147827
Epoch: 10, Steps: 10 | Train Loss: 1.116 Vali Loss: 1.261 Vali Acc: 0.419 Test Loss: 1.261 Test Acc: 0.419
Validation loss decreased (-0.391879 --> -0.418906).  Saving model ...
Epoch: 11 cost time: 2.2043097019195557
Epoch: 11, Steps: 10 | Train Loss: 1.042 Vali Loss: 1.281 Vali Acc: 0.459 Test Loss: 1.281 Test Acc: 0.459
Validation loss decreased (-0.418906 --> -0.459447).  Saving model ...
Epoch: 12 cost time: 2.394253969192505
Epoch: 12, Steps: 10 | Train Loss: 0.958 Vali Loss: 1.258 Vali Acc: 0.486 Test Loss: 1.258 Test Acc: 0.486
Validation loss decreased (-0.459447 --> -0.486474).  Saving model ...
Epoch: 13 cost time: 2.1598751544952393
Epoch: 13, Steps: 10 | Train Loss: 0.930 Vali Loss: 1.252 Vali Acc: 0.446 Test Loss: 1.252 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.332423210144043
Epoch: 14, Steps: 10 | Train Loss: 0.807 Vali Loss: 1.281 Vali Acc: 0.432 Test Loss: 1.281 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.258254289627075
Epoch: 15, Steps: 10 | Train Loss: 0.705 Vali Loss: 1.237 Vali Acc: 0.486 Test Loss: 1.237 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486474).  Saving model ...
Epoch: 16 cost time: 2.272515058517456
Epoch: 16, Steps: 10 | Train Loss: 0.684 Vali Loss: 1.201 Vali Acc: 0.459 Test Loss: 1.201 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8719983100891113
Epoch: 17, Steps: 10 | Train Loss: 0.577 Vali Loss: 1.228 Vali Acc: 0.486 Test Loss: 1.228 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486474).  Saving model ...
Epoch: 18 cost time: 2.0094306468963623
Epoch: 18, Steps: 10 | Train Loss: 0.508 Vali Loss: 1.233 Vali Acc: 0.473 Test Loss: 1.233 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.1063199043273926
Epoch: 19, Steps: 10 | Train Loss: 0.479 Vali Loss: 1.281 Vali Acc: 0.459 Test Loss: 1.281 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.9376137256622314
Epoch: 20, Steps: 10 | Train Loss: 0.436 Vali Loss: 1.333 Vali Acc: 0.473 Test Loss: 1.333 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.13085675239563
Epoch: 21, Steps: 10 | Train Loss: 0.387 Vali Loss: 1.244 Vali Acc: 0.473 Test Loss: 1.244 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.9943277835845947
Epoch: 22, Steps: 10 | Train Loss: 0.322 Vali Loss: 1.428 Vali Acc: 0.473 Test Loss: 1.428 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.298403024673462
Epoch: 23, Steps: 10 | Train Loss: 0.266 Vali Loss: 1.278 Vali Acc: 0.459 Test Loss: 1.278 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.9713134765625
Epoch: 24, Steps: 10 | Train Loss: 0.225 Vali Loss: 1.417 Vali Acc: 0.419 Test Loss: 1.417 Test Acc: 0.419
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.0861165523529053
Epoch: 25, Steps: 10 | Train Loss: 0.182 Vali Loss: 1.280 Vali Acc: 0.432 Test Loss: 1.280 Test Acc: 0.432
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.3037259578704834
Epoch: 26, Steps: 10 | Train Loss: 0.156 Vali Loss: 1.386 Vali Acc: 0.446 Test Loss: 1.386 Test Acc: 0.446
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.3752167224884033
Epoch: 27, Steps: 10 | Train Loss: 0.141 Vali Loss: 1.396 Vali Acc: 0.405 Test Loss: 1.396 Test Acc: 0.405
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.4864864864864865
model parameter : 327424
model size : 2.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.521119117736816
Epoch: 1, Steps: 10 | Train Loss: 1.438 Vali Loss: 1.399 Vali Acc: 0.216 Test Loss: 1.399 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 2.305647611618042
Epoch: 2, Steps: 10 | Train Loss: 1.431 Vali Loss: 1.422 Vali Acc: 0.257 Test Loss: 1.422 Test Acc: 0.257
Validation loss decreased (-0.216202 --> -0.256743).  Saving model ...
Epoch: 3 cost time: 2.195394992828369
Epoch: 3, Steps: 10 | Train Loss: 1.417 Vali Loss: 1.411 Vali Acc: 0.176 Test Loss: 1.411 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.264793634414673
Epoch: 4, Steps: 10 | Train Loss: 1.374 Vali Loss: 1.376 Vali Acc: 0.257 Test Loss: 1.376 Test Acc: 0.257
Validation loss decreased (-0.256743 --> -0.256743).  Saving model ...
Epoch: 5 cost time: 2.190030097961426
Epoch: 5, Steps: 10 | Train Loss: 1.365 Vali Loss: 1.459 Vali Acc: 0.284 Test Loss: 1.459 Test Acc: 0.284
Validation loss decreased (-0.256743 --> -0.283769).  Saving model ...
Epoch: 6 cost time: 2.0764048099517822
Epoch: 6, Steps: 10 | Train Loss: 1.395 Vali Loss: 1.361 Vali Acc: 0.311 Test Loss: 1.361 Test Acc: 0.311
Validation loss decreased (-0.283769 --> -0.310797).  Saving model ...
Epoch: 7 cost time: 2.176274299621582
Epoch: 7, Steps: 10 | Train Loss: 1.332 Vali Loss: 1.407 Vali Acc: 0.176 Test Loss: 1.407 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.156372547149658
Epoch: 8, Steps: 10 | Train Loss: 1.281 Vali Loss: 1.351 Vali Acc: 0.311 Test Loss: 1.351 Test Acc: 0.311
Validation loss decreased (-0.310797 --> -0.310797).  Saving model ...
Epoch: 9 cost time: 2.382732629776001
Epoch: 9, Steps: 10 | Train Loss: 1.214 Vali Loss: 1.410 Vali Acc: 0.243 Test Loss: 1.410 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.18145751953125
Epoch: 10, Steps: 10 | Train Loss: 1.158 Vali Loss: 1.306 Vali Acc: 0.365 Test Loss: 1.306 Test Acc: 0.365
Validation loss decreased (-0.310797 --> -0.364852).  Saving model ...
Epoch: 11 cost time: 2.4241387844085693
Epoch: 11, Steps: 10 | Train Loss: 1.097 Vali Loss: 1.388 Vali Acc: 0.297 Test Loss: 1.388 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.0834226608276367
Epoch: 12, Steps: 10 | Train Loss: 0.996 Vali Loss: 1.310 Vali Acc: 0.351 Test Loss: 1.310 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.9973223209381104
Epoch: 13, Steps: 10 | Train Loss: 0.932 Vali Loss: 1.309 Vali Acc: 0.378 Test Loss: 1.309 Test Acc: 0.378
Validation loss decreased (-0.364852 --> -0.378365).  Saving model ...
Epoch: 14 cost time: 2.4332828521728516
Epoch: 14, Steps: 10 | Train Loss: 0.843 Vali Loss: 1.271 Vali Acc: 0.351 Test Loss: 1.271 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.5547800064086914
Epoch: 15, Steps: 10 | Train Loss: 0.809 Vali Loss: 1.253 Vali Acc: 0.392 Test Loss: 1.253 Test Acc: 0.392
Validation loss decreased (-0.378365 --> -0.391879).  Saving model ...
Epoch: 16 cost time: 1.971114158630371
Epoch: 16, Steps: 10 | Train Loss: 0.745 Vali Loss: 1.279 Vali Acc: 0.405 Test Loss: 1.279 Test Acc: 0.405
Validation loss decreased (-0.391879 --> -0.405393).  Saving model ...
Epoch: 17 cost time: 2.450751781463623
Epoch: 17, Steps: 10 | Train Loss: 0.642 Vali Loss: 1.276 Vali Acc: 0.405 Test Loss: 1.276 Test Acc: 0.405
Validation loss decreased (-0.405393 --> -0.405393).  Saving model ...
Epoch: 18 cost time: 1.9342079162597656
Epoch: 18, Steps: 10 | Train Loss: 0.574 Vali Loss: 1.270 Vali Acc: 0.432 Test Loss: 1.270 Test Acc: 0.432
Validation loss decreased (-0.405393 --> -0.432420).  Saving model ...
Epoch: 19 cost time: 2.4238474369049072
Epoch: 19, Steps: 10 | Train Loss: 0.547 Vali Loss: 1.210 Vali Acc: 0.419 Test Loss: 1.210 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.5702309608459473
Epoch: 20, Steps: 10 | Train Loss: 0.484 Vali Loss: 1.296 Vali Acc: 0.432 Test Loss: 1.296 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.9683775901794434
Epoch: 21, Steps: 10 | Train Loss: 0.420 Vali Loss: 1.252 Vali Acc: 0.514 Test Loss: 1.252 Test Acc: 0.514
Validation loss decreased (-0.432420 --> -0.513501).  Saving model ...
Epoch: 22 cost time: 2.2262816429138184
Epoch: 22, Steps: 10 | Train Loss: 0.345 Vali Loss: 1.231 Vali Acc: 0.459 Test Loss: 1.231 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.3230063915252686
Epoch: 23, Steps: 10 | Train Loss: 0.288 Vali Loss: 1.301 Vali Acc: 0.473 Test Loss: 1.301 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.116793632507324
Epoch: 24, Steps: 10 | Train Loss: 0.253 Vali Loss: 1.263 Vali Acc: 0.446 Test Loss: 1.263 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.9854974746704102
Epoch: 25, Steps: 10 | Train Loss: 0.208 Vali Loss: 1.259 Vali Acc: 0.527 Test Loss: 1.259 Test Acc: 0.527
Validation loss decreased (-0.513501 --> -0.527014).  Saving model ...
Epoch: 26 cost time: 1.9035229682922363
Epoch: 26, Steps: 10 | Train Loss: 0.181 Vali Loss: 1.352 Vali Acc: 0.486 Test Loss: 1.352 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.3538002967834473
Epoch: 27, Steps: 10 | Train Loss: 0.136 Vali Loss: 1.290 Vali Acc: 0.473 Test Loss: 1.290 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.0829825401306152
Epoch: 28, Steps: 10 | Train Loss: 0.128 Vali Loss: 1.345 Vali Acc: 0.459 Test Loss: 1.345 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.4608354568481445
Epoch: 29, Steps: 10 | Train Loss: 0.106 Vali Loss: 1.370 Vali Acc: 0.486 Test Loss: 1.370 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.0403547286987305
Epoch: 30, Steps: 10 | Train Loss: 0.081 Vali Loss: 1.400 Vali Acc: 0.527 Test Loss: 1.400 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.8007328510284424
Epoch: 31, Steps: 10 | Train Loss: 0.075 Vali Loss: 1.369 Vali Acc: 0.486 Test Loss: 1.369 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.1041746139526367
Epoch: 32, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.444 Vali Acc: 0.500 Test Loss: 1.444 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.0303072929382324
Epoch: 33, Steps: 10 | Train Loss: 0.060 Vali Loss: 1.408 Vali Acc: 0.459 Test Loss: 1.408 Test Acc: 0.459
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.0956313610076904
Epoch: 34, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.424 Vali Acc: 0.486 Test Loss: 1.424 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.2625179290771484
Epoch: 35, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.511 Vali Acc: 0.500 Test Loss: 1.511 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 258784
model size : 1.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.328229665756226
Epoch: 1, Steps: 10 | Train Loss: 1.464 Vali Loss: 1.414 Vali Acc: 0.216 Test Loss: 1.414 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 2.2094571590423584
Epoch: 2, Steps: 10 | Train Loss: 1.406 Vali Loss: 1.372 Vali Acc: 0.257 Test Loss: 1.372 Test Acc: 0.257
Validation loss decreased (-0.216202 --> -0.256743).  Saving model ...
Epoch: 3 cost time: 2.004772186279297
Epoch: 3, Steps: 10 | Train Loss: 1.404 Vali Loss: 1.380 Vali Acc: 0.284 Test Loss: 1.380 Test Acc: 0.284
Validation loss decreased (-0.256743 --> -0.283770).  Saving model ...
Epoch: 4 cost time: 2.29744029045105
Epoch: 4, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.375 Vali Acc: 0.243 Test Loss: 1.375 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0543549060821533
Epoch: 5, Steps: 10 | Train Loss: 1.322 Vali Loss: 1.413 Vali Acc: 0.216 Test Loss: 1.413 Test Acc: 0.216
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.3405559062957764
Epoch: 6, Steps: 10 | Train Loss: 1.350 Vali Loss: 1.346 Vali Acc: 0.297 Test Loss: 1.346 Test Acc: 0.297
Validation loss decreased (-0.283770 --> -0.297284).  Saving model ...
Epoch: 7 cost time: 2.1231465339660645
Epoch: 7, Steps: 10 | Train Loss: 1.309 Vali Loss: 1.401 Vali Acc: 0.270 Test Loss: 1.401 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.1453888416290283
Epoch: 8, Steps: 10 | Train Loss: 1.235 Vali Loss: 1.361 Vali Acc: 0.243 Test Loss: 1.361 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.0544228553771973
Epoch: 9, Steps: 10 | Train Loss: 1.236 Vali Loss: 1.260 Vali Acc: 0.459 Test Loss: 1.260 Test Acc: 0.459
Validation loss decreased (-0.297284 --> -0.459447).  Saving model ...
Epoch: 10 cost time: 2.074667453765869
Epoch: 10, Steps: 10 | Train Loss: 1.174 Vali Loss: 1.258 Vali Acc: 0.432 Test Loss: 1.258 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.2727713584899902
Epoch: 11, Steps: 10 | Train Loss: 1.101 Vali Loss: 1.238 Vali Acc: 0.473 Test Loss: 1.238 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472961).  Saving model ...
Epoch: 12 cost time: 1.8512458801269531
Epoch: 12, Steps: 10 | Train Loss: 1.104 Vali Loss: 1.198 Vali Acc: 0.473 Test Loss: 1.198 Test Acc: 0.473
Validation loss decreased (-0.472961 --> -0.472961).  Saving model ...
Epoch: 13 cost time: 2.4581668376922607
Epoch: 13, Steps: 10 | Train Loss: 1.017 Vali Loss: 1.237 Vali Acc: 0.446 Test Loss: 1.237 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.2062625885009766
Epoch: 14, Steps: 10 | Train Loss: 0.933 Vali Loss: 1.135 Vali Acc: 0.581 Test Loss: 1.135 Test Acc: 0.581
Validation loss decreased (-0.472961 --> -0.581070).  Saving model ...
Epoch: 15 cost time: 2.413844585418701
Epoch: 15, Steps: 10 | Train Loss: 0.837 Vali Loss: 1.162 Vali Acc: 0.554 Test Loss: 1.162 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9847030639648438
Epoch: 16, Steps: 10 | Train Loss: 0.746 Vali Loss: 1.083 Vali Acc: 0.541 Test Loss: 1.083 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.2934134006500244
Epoch: 17, Steps: 10 | Train Loss: 0.709 Vali Loss: 1.100 Vali Acc: 0.554 Test Loss: 1.100 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.0085861682891846
Epoch: 18, Steps: 10 | Train Loss: 0.639 Vali Loss: 1.120 Vali Acc: 0.581 Test Loss: 1.120 Test Acc: 0.581
Validation loss decreased (-0.581070 --> -0.581070).  Saving model ...
Epoch: 19 cost time: 1.8289644718170166
Epoch: 19, Steps: 10 | Train Loss: 0.601 Vali Loss: 1.107 Vali Acc: 0.514 Test Loss: 1.107 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.1101818084716797
Epoch: 20, Steps: 10 | Train Loss: 0.518 Vali Loss: 1.128 Vali Acc: 0.554 Test Loss: 1.128 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.2294764518737793
Epoch: 21, Steps: 10 | Train Loss: 0.437 Vali Loss: 1.181 Vali Acc: 0.527 Test Loss: 1.181 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.0049266815185547
Epoch: 22, Steps: 10 | Train Loss: 0.426 Vali Loss: 1.096 Vali Acc: 0.541 Test Loss: 1.096 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.384896755218506
Epoch: 23, Steps: 10 | Train Loss: 0.352 Vali Loss: 1.138 Vali Acc: 0.527 Test Loss: 1.138 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.069725513458252
Epoch: 24, Steps: 10 | Train Loss: 0.286 Vali Loss: 1.132 Vali Acc: 0.514 Test Loss: 1.132 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.4897310733795166
Epoch: 25, Steps: 10 | Train Loss: 0.240 Vali Loss: 1.184 Vali Acc: 0.500 Test Loss: 1.184 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.790754556655884
Epoch: 26, Steps: 10 | Train Loss: 0.199 Vali Loss: 1.189 Vali Acc: 0.541 Test Loss: 1.189 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.2367727756500244
Epoch: 27, Steps: 10 | Train Loss: 0.178 Vali Loss: 1.223 Vali Acc: 0.500 Test Loss: 1.223 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.3725264072418213
Epoch: 28, Steps: 10 | Train Loss: 0.163 Vali Loss: 1.204 Vali Acc: 0.500 Test Loss: 1.204 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 256704
model size : 1.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.033701419830322
Epoch: 1, Steps: 10 | Train Loss: 1.525 Vali Loss: 1.430 Vali Acc: 0.284 Test Loss: 1.430 Test Acc: 0.284
Validation loss decreased (inf --> -0.283769).  Saving model ...
Epoch: 2 cost time: 2.0876822471618652
Epoch: 2, Steps: 10 | Train Loss: 1.414 Vali Loss: 1.312 Vali Acc: 0.392 Test Loss: 1.312 Test Acc: 0.392
Validation loss decreased (-0.283769 --> -0.391879).  Saving model ...
Epoch: 3 cost time: 2.175321102142334
Epoch: 3, Steps: 10 | Train Loss: 1.404 Vali Loss: 1.332 Vali Acc: 0.365 Test Loss: 1.332 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.2252447605133057
Epoch: 4, Steps: 10 | Train Loss: 1.366 Vali Loss: 1.354 Vali Acc: 0.351 Test Loss: 1.354 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.343844413757324
Epoch: 5, Steps: 10 | Train Loss: 1.388 Vali Loss: 1.314 Vali Acc: 0.432 Test Loss: 1.314 Test Acc: 0.432
Validation loss decreased (-0.391879 --> -0.432419).  Saving model ...
Epoch: 6 cost time: 2.221676826477051
Epoch: 6, Steps: 10 | Train Loss: 1.347 Vali Loss: 1.329 Vali Acc: 0.338 Test Loss: 1.329 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.1049842834472656
Epoch: 7, Steps: 10 | Train Loss: 1.296 Vali Loss: 1.334 Vali Acc: 0.338 Test Loss: 1.334 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.9981958866119385
Epoch: 8, Steps: 10 | Train Loss: 1.239 Vali Loss: 1.259 Vali Acc: 0.446 Test Loss: 1.259 Test Acc: 0.446
Validation loss decreased (-0.432419 --> -0.445933).  Saving model ...
Epoch: 9 cost time: 2.2265379428863525
Epoch: 9, Steps: 10 | Train Loss: 1.217 Vali Loss: 1.319 Vali Acc: 0.351 Test Loss: 1.319 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0694644451141357
Epoch: 10, Steps: 10 | Train Loss: 1.165 Vali Loss: 1.232 Vali Acc: 0.486 Test Loss: 1.232 Test Acc: 0.486
Validation loss decreased (-0.445933 --> -0.486474).  Saving model ...
Epoch: 11 cost time: 1.79693603515625
Epoch: 11, Steps: 10 | Train Loss: 1.118 Vali Loss: 1.281 Vali Acc: 0.446 Test Loss: 1.281 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.2707087993621826
Epoch: 12, Steps: 10 | Train Loss: 1.031 Vali Loss: 1.248 Vali Acc: 0.432 Test Loss: 1.248 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.010589361190796
Epoch: 13, Steps: 10 | Train Loss: 0.983 Vali Loss: 1.210 Vali Acc: 0.446 Test Loss: 1.210 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.4376003742218018
Epoch: 14, Steps: 10 | Train Loss: 0.887 Vali Loss: 1.212 Vali Acc: 0.473 Test Loss: 1.212 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.4360201358795166
Epoch: 15, Steps: 10 | Train Loss: 0.840 Vali Loss: 1.219 Vali Acc: 0.446 Test Loss: 1.219 Test Acc: 0.446
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.188769578933716
Epoch: 16, Steps: 10 | Train Loss: 0.724 Vali Loss: 1.202 Vali Acc: 0.486 Test Loss: 1.202 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486474).  Saving model ...
Epoch: 17 cost time: 2.097529411315918
Epoch: 17, Steps: 10 | Train Loss: 0.677 Vali Loss: 1.201 Vali Acc: 0.486 Test Loss: 1.201 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486474).  Saving model ...
Epoch: 18 cost time: 2.4659931659698486
Epoch: 18, Steps: 10 | Train Loss: 0.596 Vali Loss: 1.195 Vali Acc: 0.500 Test Loss: 1.195 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499988).  Saving model ...
Epoch: 19 cost time: 2.261336088180542
Epoch: 19, Steps: 10 | Train Loss: 0.552 Vali Loss: 1.179 Vali Acc: 0.514 Test Loss: 1.179 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 20 cost time: 2.2779500484466553
Epoch: 20, Steps: 10 | Train Loss: 0.464 Vali Loss: 1.177 Vali Acc: 0.514 Test Loss: 1.177 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513502).  Saving model ...
Epoch: 21 cost time: 2.6692094802856445
Epoch: 21, Steps: 10 | Train Loss: 0.450 Vali Loss: 1.220 Vali Acc: 0.500 Test Loss: 1.220 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.576871156692505
Epoch: 22, Steps: 10 | Train Loss: 0.394 Vali Loss: 1.301 Vali Acc: 0.500 Test Loss: 1.301 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.322571277618408
Epoch: 23, Steps: 10 | Train Loss: 0.339 Vali Loss: 1.230 Vali Acc: 0.541 Test Loss: 1.230 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540528).  Saving model ...
Epoch: 24 cost time: 2.744091033935547
Epoch: 24, Steps: 10 | Train Loss: 0.277 Vali Loss: 1.209 Vali Acc: 0.554 Test Loss: 1.209 Test Acc: 0.554
Validation loss decreased (-0.540528 --> -0.554042).  Saving model ...
Epoch: 25 cost time: 2.1205732822418213
Epoch: 25, Steps: 10 | Train Loss: 0.239 Vali Loss: 1.261 Vali Acc: 0.554 Test Loss: 1.261 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.1874825954437256
Epoch: 26, Steps: 10 | Train Loss: 0.184 Vali Loss: 1.294 Vali Acc: 0.514 Test Loss: 1.294 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.5848333835601807
Epoch: 27, Steps: 10 | Train Loss: 0.167 Vali Loss: 1.313 Vali Acc: 0.527 Test Loss: 1.313 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.2950143814086914
Epoch: 28, Steps: 10 | Train Loss: 0.146 Vali Loss: 1.324 Vali Acc: 0.527 Test Loss: 1.324 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.525015354156494
Epoch: 29, Steps: 10 | Train Loss: 0.124 Vali Loss: 1.337 Vali Acc: 0.568 Test Loss: 1.337 Test Acc: 0.568
Validation loss decreased (-0.554042 --> -0.567554).  Saving model ...
Epoch: 30 cost time: 2.409977436065674
Epoch: 30, Steps: 10 | Train Loss: 0.113 Vali Loss: 1.344 Vali Acc: 0.486 Test Loss: 1.344 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.1175270080566406
Epoch: 31, Steps: 10 | Train Loss: 0.093 Vali Loss: 1.386 Vali Acc: 0.473 Test Loss: 1.386 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.8991644382476807
Epoch: 32, Steps: 10 | Train Loss: 0.084 Vali Loss: 1.413 Vali Acc: 0.514 Test Loss: 1.413 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.071904182434082
Epoch: 33, Steps: 10 | Train Loss: 0.072 Vali Loss: 1.429 Vali Acc: 0.514 Test Loss: 1.429 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.368396520614624
Epoch: 34, Steps: 10 | Train Loss: 0.062 Vali Loss: 1.449 Vali Acc: 0.514 Test Loss: 1.449 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.524815797805786
Epoch: 35, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.491 Vali Acc: 0.514 Test Loss: 1.491 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.999971628189087
Epoch: 36, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.498 Vali Acc: 0.500 Test Loss: 1.498 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 2.0817465782165527
Epoch: 37, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.505 Vali Acc: 0.500 Test Loss: 1.505 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 2.030580997467041
Epoch: 38, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.518 Vali Acc: 0.473 Test Loss: 1.518 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 2.153672933578491
Epoch: 39, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.547 Vali Acc: 0.527 Test Loss: 1.547 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 254624
model size : 1.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.304426431655884
Epoch: 1, Steps: 10 | Train Loss: 1.474 Vali Loss: 1.412 Vali Acc: 0.257 Test Loss: 1.412 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 2.0715248584747314
Epoch: 2, Steps: 10 | Train Loss: 1.390 Vali Loss: 1.412 Vali Acc: 0.243 Test Loss: 1.412 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0259974002838135
Epoch: 3, Steps: 10 | Train Loss: 1.402 Vali Loss: 1.462 Vali Acc: 0.203 Test Loss: 1.462 Test Acc: 0.203
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.147646903991699
Epoch: 4, Steps: 10 | Train Loss: 1.416 Vali Loss: 1.368 Vali Acc: 0.365 Test Loss: 1.368 Test Acc: 0.365
Validation loss decreased (-0.256743 --> -0.364851).  Saving model ...
Epoch: 5 cost time: 2.1927669048309326
Epoch: 5, Steps: 10 | Train Loss: 1.391 Vali Loss: 1.428 Vali Acc: 0.243 Test Loss: 1.428 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.3924360275268555
Epoch: 6, Steps: 10 | Train Loss: 1.325 Vali Loss: 1.360 Vali Acc: 0.378 Test Loss: 1.360 Test Acc: 0.378
Validation loss decreased (-0.364851 --> -0.378365).  Saving model ...
Epoch: 7 cost time: 2.384758472442627
Epoch: 7, Steps: 10 | Train Loss: 1.291 Vali Loss: 1.380 Vali Acc: 0.365 Test Loss: 1.380 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.1832077503204346
Epoch: 8, Steps: 10 | Train Loss: 1.252 Vali Loss: 1.356 Vali Acc: 0.351 Test Loss: 1.356 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.0844106674194336
Epoch: 9, Steps: 10 | Train Loss: 1.200 Vali Loss: 1.339 Vali Acc: 0.378 Test Loss: 1.339 Test Acc: 0.378
Validation loss decreased (-0.378365 --> -0.378365).  Saving model ...
Epoch: 10 cost time: 2.0782482624053955
Epoch: 10, Steps: 10 | Train Loss: 1.142 Vali Loss: 1.332 Vali Acc: 0.338 Test Loss: 1.332 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.1264004707336426
Epoch: 11, Steps: 10 | Train Loss: 1.035 Vali Loss: 1.302 Vali Acc: 0.365 Test Loss: 1.302 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.35589599609375
Epoch: 12, Steps: 10 | Train Loss: 1.044 Vali Loss: 1.260 Vali Acc: 0.365 Test Loss: 1.260 Test Acc: 0.365
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.351182699203491
Epoch: 13, Steps: 10 | Train Loss: 0.913 Vali Loss: 1.283 Vali Acc: 0.378 Test Loss: 1.283 Test Acc: 0.378
Validation loss decreased (-0.378365 --> -0.378366).  Saving model ...
Epoch: 14 cost time: 1.9738719463348389
Epoch: 14, Steps: 10 | Train Loss: 0.890 Vali Loss: 1.234 Vali Acc: 0.405 Test Loss: 1.234 Test Acc: 0.405
Validation loss decreased (-0.378366 --> -0.405393).  Saving model ...
Epoch: 15 cost time: 2.227017641067505
Epoch: 15, Steps: 10 | Train Loss: 0.813 Vali Loss: 1.233 Vali Acc: 0.446 Test Loss: 1.233 Test Acc: 0.446
Validation loss decreased (-0.405393 --> -0.445934).  Saving model ...
Epoch: 16 cost time: 2.2052760124206543
Epoch: 16, Steps: 10 | Train Loss: 0.725 Vali Loss: 1.220 Vali Acc: 0.432 Test Loss: 1.220 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8225109577178955
Epoch: 17, Steps: 10 | Train Loss: 0.634 Vali Loss: 1.214 Vali Acc: 0.419 Test Loss: 1.214 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.024503469467163
Epoch: 18, Steps: 10 | Train Loss: 0.592 Vali Loss: 1.192 Vali Acc: 0.473 Test Loss: 1.192 Test Acc: 0.473
Validation loss decreased (-0.445934 --> -0.472961).  Saving model ...
Epoch: 19 cost time: 2.4798362255096436
Epoch: 19, Steps: 10 | Train Loss: 0.526 Vali Loss: 1.265 Vali Acc: 0.473 Test Loss: 1.265 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.319573163986206
Epoch: 20, Steps: 10 | Train Loss: 0.465 Vali Loss: 1.198 Vali Acc: 0.486 Test Loss: 1.198 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486475).  Saving model ...
Epoch: 21 cost time: 1.979607105255127
Epoch: 21, Steps: 10 | Train Loss: 0.428 Vali Loss: 1.291 Vali Acc: 0.486 Test Loss: 1.291 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.9653747081756592
Epoch: 22, Steps: 10 | Train Loss: 0.346 Vali Loss: 1.220 Vali Acc: 0.541 Test Loss: 1.220 Test Acc: 0.541
Validation loss decreased (-0.486475 --> -0.540528).  Saving model ...
Epoch: 23 cost time: 2.020887613296509
Epoch: 23, Steps: 10 | Train Loss: 0.294 Vali Loss: 1.252 Vali Acc: 0.486 Test Loss: 1.252 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.279831647872925
Epoch: 24, Steps: 10 | Train Loss: 0.244 Vali Loss: 1.294 Vali Acc: 0.514 Test Loss: 1.294 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.313994884490967
Epoch: 25, Steps: 10 | Train Loss: 0.203 Vali Loss: 1.334 Vali Acc: 0.500 Test Loss: 1.334 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.4509034156799316
Epoch: 26, Steps: 10 | Train Loss: 0.177 Vali Loss: 1.293 Vali Acc: 0.527 Test Loss: 1.293 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.3508360385894775
Epoch: 27, Steps: 10 | Train Loss: 0.165 Vali Loss: 1.356 Vali Acc: 0.514 Test Loss: 1.356 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.3808352947235107
Epoch: 28, Steps: 10 | Train Loss: 0.133 Vali Loss: 1.417 Vali Acc: 0.500 Test Loss: 1.417 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.4002861976623535
Epoch: 29, Steps: 10 | Train Loss: 0.119 Vali Loss: 1.321 Vali Acc: 0.527 Test Loss: 1.321 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.073610782623291
Epoch: 30, Steps: 10 | Train Loss: 0.091 Vali Loss: 1.435 Vali Acc: 0.486 Test Loss: 1.435 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.1589152812957764
Epoch: 31, Steps: 10 | Train Loss: 0.075 Vali Loss: 1.385 Vali Acc: 0.527 Test Loss: 1.385 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.044705390930176
Epoch: 32, Steps: 10 | Train Loss: 0.071 Vali Loss: 1.408 Vali Acc: 0.514 Test Loss: 1.408 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 252544
model size : 1.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.331425428390503
Epoch: 1, Steps: 10 | Train Loss: 1.512 Vali Loss: 1.496 Vali Acc: 0.230 Test Loss: 1.496 Test Acc: 0.230
Validation loss decreased (inf --> -0.229715).  Saving model ...
Epoch: 2 cost time: 3.0949957370758057
Epoch: 2, Steps: 10 | Train Loss: 1.437 Vali Loss: 2.646 Vali Acc: 0.203 Test Loss: 2.646 Test Acc: 0.203
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.448986530303955
Epoch: 3, Steps: 10 | Train Loss: 1.603 Vali Loss: 1.349 Vali Acc: 0.432 Test Loss: 1.349 Test Acc: 0.432
Validation loss decreased (-0.229715 --> -0.432419).  Saving model ...
Epoch: 4 cost time: 3.413698434829712
Epoch: 4, Steps: 10 | Train Loss: 1.065 Vali Loss: 1.238 Vali Acc: 0.459 Test Loss: 1.238 Test Acc: 0.459
Validation loss decreased (-0.432419 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 3.0564329624176025
Epoch: 5, Steps: 10 | Train Loss: 0.858 Vali Loss: 1.295 Vali Acc: 0.446 Test Loss: 1.295 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.8693954944610596
Epoch: 6, Steps: 10 | Train Loss: 0.575 Vali Loss: 1.417 Vali Acc: 0.446 Test Loss: 1.417 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.66805100440979
Epoch: 7, Steps: 10 | Train Loss: 0.388 Vali Loss: 1.445 Vali Acc: 0.459 Test Loss: 1.445 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.229278564453125
Epoch: 8, Steps: 10 | Train Loss: 0.282 Vali Loss: 1.504 Vali Acc: 0.486 Test Loss: 1.504 Test Acc: 0.486
Validation loss decreased (-0.459447 --> -0.486471).  Saving model ...
Epoch: 9 cost time: 2.7221899032592773
Epoch: 9, Steps: 10 | Train Loss: 0.185 Vali Loss: 1.412 Vali Acc: 0.473 Test Loss: 1.412 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.013644218444824
Epoch: 10, Steps: 10 | Train Loss: 0.081 Vali Loss: 1.604 Vali Acc: 0.473 Test Loss: 1.604 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.96795916557312
Epoch: 11, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.579 Vali Acc: 0.527 Test Loss: 1.579 Test Acc: 0.527
Validation loss decreased (-0.486471 --> -0.527011).  Saving model ...
Epoch: 12 cost time: 2.88822865486145
Epoch: 12, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.809 Vali Acc: 0.554 Test Loss: 1.809 Test Acc: 0.554
Validation loss decreased (-0.527011 --> -0.554036).  Saving model ...
Epoch: 13 cost time: 3.5648608207702637
Epoch: 13, Steps: 10 | Train Loss: 0.046 Vali Loss: 2.088 Vali Acc: 0.486 Test Loss: 2.088 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.539517879486084
Epoch: 14, Steps: 10 | Train Loss: 0.024 Vali Loss: 2.749 Vali Acc: 0.419 Test Loss: 2.749 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.7413811683654785
Epoch: 15, Steps: 10 | Train Loss: 0.032 Vali Loss: 2.162 Vali Acc: 0.473 Test Loss: 2.162 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.4729862213134766
Epoch: 16, Steps: 10 | Train Loss: 0.033 Vali Loss: 2.099 Vali Acc: 0.554 Test Loss: 2.099 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.78875732421875
Epoch: 17, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.954 Vali Acc: 0.541 Test Loss: 1.954 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.135418176651001
Epoch: 18, Steps: 10 | Train Loss: 0.024 Vali Loss: 2.192 Vali Acc: 0.554 Test Loss: 2.192 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.7498130798339844
Epoch: 19, Steps: 10 | Train Loss: 0.038 Vali Loss: 2.549 Vali Acc: 0.514 Test Loss: 2.549 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.0427989959716797
Epoch: 20, Steps: 10 | Train Loss: 0.044 Vali Loss: 2.369 Vali Acc: 0.568 Test Loss: 2.369 Test Acc: 0.568
Validation loss decreased (-0.554036 --> -0.567544).  Saving model ...
Epoch: 21 cost time: 3.101640224456787
Epoch: 21, Steps: 10 | Train Loss: 0.013 Vali Loss: 2.741 Vali Acc: 0.500 Test Loss: 2.741 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.5935122966766357
Epoch: 22, Steps: 10 | Train Loss: 0.018 Vali Loss: 2.334 Vali Acc: 0.514 Test Loss: 2.334 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.3004214763641357
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.591 Vali Acc: 0.419 Test Loss: 2.591 Test Acc: 0.419
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.0838735103607178
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 2.346 Vali Acc: 0.500 Test Loss: 2.346 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.6775243282318115
Epoch: 25, Steps: 10 | Train Loss: 0.007 Vali Loss: 2.487 Vali Acc: 0.527 Test Loss: 2.487 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.158740282058716
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.551 Vali Acc: 0.486 Test Loss: 2.551 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.415210247039795
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.405 Vali Acc: 0.486 Test Loss: 2.405 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.4418959617614746
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.455 Vali Acc: 0.514 Test Loss: 2.455 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.9976963996887207
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.498 Vali Acc: 0.486 Test Loss: 2.498 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.3718373775482178
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.476 Vali Acc: 0.514 Test Loss: 2.476 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 11326004
model size : 48.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.394386529922485
Epoch: 1, Steps: 10 | Train Loss: 1.456 Vali Loss: 1.656 Vali Acc: 0.189 Test Loss: 1.656 Test Acc: 0.189
Validation loss decreased (inf --> -0.189173).  Saving model ...
Epoch: 2 cost time: 3.0647432804107666
Epoch: 2, Steps: 10 | Train Loss: 1.390 Vali Loss: 1.454 Vali Acc: 0.405 Test Loss: 1.454 Test Acc: 0.405
Validation loss decreased (-0.189173 --> -0.405391).  Saving model ...
Epoch: 3 cost time: 3.2100391387939453
Epoch: 3, Steps: 10 | Train Loss: 1.153 Vali Loss: 1.581 Vali Acc: 0.270 Test Loss: 1.581 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.408496141433716
Epoch: 4, Steps: 10 | Train Loss: 1.027 Vali Loss: 1.369 Vali Acc: 0.446 Test Loss: 1.369 Test Acc: 0.446
Validation loss decreased (-0.405391 --> -0.445932).  Saving model ...
Epoch: 5 cost time: 3.0896763801574707
Epoch: 5, Steps: 10 | Train Loss: 0.729 Vali Loss: 1.505 Vali Acc: 0.419 Test Loss: 1.505 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.509885787963867
Epoch: 6, Steps: 10 | Train Loss: 0.480 Vali Loss: 1.173 Vali Acc: 0.527 Test Loss: 1.173 Test Acc: 0.527
Validation loss decreased (-0.445932 --> -0.527015).  Saving model ...
Epoch: 7 cost time: 3.376692056655884
Epoch: 7, Steps: 10 | Train Loss: 0.296 Vali Loss: 1.279 Vali Acc: 0.541 Test Loss: 1.279 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540528).  Saving model ...
Epoch: 8 cost time: 3.1397266387939453
Epoch: 8, Steps: 10 | Train Loss: 0.197 Vali Loss: 1.283 Vali Acc: 0.554 Test Loss: 1.283 Test Acc: 0.554
Validation loss decreased (-0.540528 --> -0.554041).  Saving model ...
Epoch: 9 cost time: 3.2761502265930176
Epoch: 9, Steps: 10 | Train Loss: 0.086 Vali Loss: 1.462 Vali Acc: 0.581 Test Loss: 1.462 Test Acc: 0.581
Validation loss decreased (-0.554041 --> -0.581066).  Saving model ...
Epoch: 10 cost time: 2.4811794757843018
Epoch: 10, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.482 Vali Acc: 0.554 Test Loss: 1.482 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.298166036605835
Epoch: 11, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.629 Vali Acc: 0.554 Test Loss: 1.629 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.0436995029449463
Epoch: 12, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.791 Vali Acc: 0.500 Test Loss: 1.791 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.473001003265381
Epoch: 13, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.744 Vali Acc: 0.554 Test Loss: 1.744 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.8947553634643555
Epoch: 14, Steps: 10 | Train Loss: 0.017 Vali Loss: 2.079 Vali Acc: 0.473 Test Loss: 2.079 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.5809295177459717
Epoch: 15, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.961 Vali Acc: 0.514 Test Loss: 1.961 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.380722761154175
Epoch: 16, Steps: 10 | Train Loss: 0.018 Vali Loss: 2.018 Vali Acc: 0.514 Test Loss: 2.018 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.3867716789245605
Epoch: 17, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.941 Vali Acc: 0.514 Test Loss: 1.941 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.4617555141448975
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.832 Vali Acc: 0.514 Test Loss: 1.832 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.8172569274902344
Epoch: 19, Steps: 10 | Train Loss: 0.012 Vali Loss: 2.786 Vali Acc: 0.486 Test Loss: 2.786 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 11310644
model size : 48.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.912697792053223
Epoch: 1, Steps: 10 | Train Loss: 1.503 Vali Loss: 1.456 Vali Acc: 0.284 Test Loss: 1.456 Test Acc: 0.284
Validation loss decreased (inf --> -0.283769).  Saving model ...
Epoch: 2 cost time: 2.9063310623168945
Epoch: 2, Steps: 10 | Train Loss: 1.445 Vali Loss: 1.680 Vali Acc: 0.230 Test Loss: 1.680 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.9145915508270264
Epoch: 3, Steps: 10 | Train Loss: 1.367 Vali Loss: 1.341 Vali Acc: 0.297 Test Loss: 1.341 Test Acc: 0.297
Validation loss decreased (-0.283769 --> -0.297284).  Saving model ...
Epoch: 4 cost time: 3.3965065479278564
Epoch: 4, Steps: 10 | Train Loss: 1.004 Vali Loss: 1.714 Vali Acc: 0.297 Test Loss: 1.714 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.1902174949645996
Epoch: 5, Steps: 10 | Train Loss: 0.847 Vali Loss: 1.199 Vali Acc: 0.500 Test Loss: 1.199 Test Acc: 0.500
Validation loss decreased (-0.297284 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 3.4577062129974365
Epoch: 6, Steps: 10 | Train Loss: 0.571 Vali Loss: 1.143 Vali Acc: 0.541 Test Loss: 1.143 Test Acc: 0.541
Validation loss decreased (-0.499988 --> -0.540529).  Saving model ...
Epoch: 7 cost time: 3.029176950454712
Epoch: 7, Steps: 10 | Train Loss: 0.352 Vali Loss: 1.350 Vali Acc: 0.446 Test Loss: 1.350 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.839688777923584
Epoch: 8, Steps: 10 | Train Loss: 0.174 Vali Loss: 1.520 Vali Acc: 0.432 Test Loss: 1.520 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.585881233215332
Epoch: 9, Steps: 10 | Train Loss: 0.101 Vali Loss: 1.412 Vali Acc: 0.500 Test Loss: 1.412 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.832782030105591
Epoch: 10, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.459 Vali Acc: 0.514 Test Loss: 1.459 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.262751340866089
Epoch: 11, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.886 Vali Acc: 0.473 Test Loss: 1.886 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.369457721710205
Epoch: 12, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.824 Vali Acc: 0.527 Test Loss: 1.824 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.8462533950805664
Epoch: 13, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.688 Vali Acc: 0.541 Test Loss: 1.688 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.259265422821045
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.877 Vali Acc: 0.541 Test Loss: 1.877 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.078442096710205
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.721 Vali Acc: 0.554 Test Loss: 1.721 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554037).  Saving model ...
Epoch: 16 cost time: 3.358837604522705
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.655 Vali Acc: 0.581 Test Loss: 1.655 Test Acc: 0.581
Validation loss decreased (-0.554037 --> -0.581065).  Saving model ...
Epoch: 17 cost time: 2.813153028488159
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.698 Vali Acc: 0.527 Test Loss: 1.698 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.0273351669311523
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.737 Vali Acc: 0.541 Test Loss: 1.737 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.5603950023651123
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.747 Vali Acc: 0.541 Test Loss: 1.747 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.8862385749816895
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.730 Vali Acc: 0.541 Test Loss: 1.730 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.995384931564331
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.717 Vali Acc: 0.554 Test Loss: 1.717 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.7653486728668213
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.716 Vali Acc: 0.568 Test Loss: 1.716 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.390873670578003
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.729 Vali Acc: 0.554 Test Loss: 1.729 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.7389330863952637
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.744 Vali Acc: 0.541 Test Loss: 1.744 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.7820963859558105
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.756 Vali Acc: 0.541 Test Loss: 1.756 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.9531192779541016
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.752 Vali Acc: 0.554 Test Loss: 1.752 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 11295284
model size : 48.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.279789447784424
Epoch: 1, Steps: 10 | Train Loss: 1.489 Vali Loss: 1.422 Vali Acc: 0.216 Test Loss: 1.422 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 3.2664639949798584
Epoch: 2, Steps: 10 | Train Loss: 1.374 Vali Loss: 1.504 Vali Acc: 0.351 Test Loss: 1.504 Test Acc: 0.351
Validation loss decreased (-0.216202 --> -0.351336).  Saving model ...
Epoch: 3 cost time: 2.765160083770752
Epoch: 3, Steps: 10 | Train Loss: 1.289 Vali Loss: 1.460 Vali Acc: 0.419 Test Loss: 1.460 Test Acc: 0.419
Validation loss decreased (-0.351336 --> -0.418904).  Saving model ...
Epoch: 4 cost time: 3.1967856884002686
Epoch: 4, Steps: 10 | Train Loss: 1.125 Vali Loss: 1.159 Vali Acc: 0.459 Test Loss: 1.159 Test Acc: 0.459
Validation loss decreased (-0.418904 --> -0.459448).  Saving model ...
Epoch: 5 cost time: 2.689206600189209
Epoch: 5, Steps: 10 | Train Loss: 0.839 Vali Loss: 1.435 Vali Acc: 0.392 Test Loss: 1.435 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.493314027786255
Epoch: 6, Steps: 10 | Train Loss: 0.830 Vali Loss: 1.172 Vali Acc: 0.581 Test Loss: 1.172 Test Acc: 0.581
Validation loss decreased (-0.459448 --> -0.581069).  Saving model ...
Epoch: 7 cost time: 2.8943030834198
Epoch: 7, Steps: 10 | Train Loss: 0.496 Vali Loss: 1.287 Vali Acc: 0.581 Test Loss: 1.287 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0816433429718018
Epoch: 8, Steps: 10 | Train Loss: 0.266 Vali Loss: 1.294 Vali Acc: 0.568 Test Loss: 1.294 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.4349441528320312
Epoch: 9, Steps: 10 | Train Loss: 0.141 Vali Loss: 1.256 Vali Acc: 0.554 Test Loss: 1.256 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.9150550365447998
Epoch: 10, Steps: 10 | Train Loss: 0.076 Vali Loss: 1.525 Vali Acc: 0.554 Test Loss: 1.525 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.355189561843872
Epoch: 11, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.670 Vali Acc: 0.486 Test Loss: 1.670 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.801365375518799
Epoch: 12, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.683 Vali Acc: 0.527 Test Loss: 1.683 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.9228074550628662
Epoch: 13, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.604 Vali Acc: 0.514 Test Loss: 1.604 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.430402994155884
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.873 Vali Acc: 0.473 Test Loss: 1.873 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.061899185180664
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.583 Vali Acc: 0.514 Test Loss: 1.583 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.553497314453125
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.673 Vali Acc: 0.568 Test Loss: 1.673 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 11279924
model size : 48.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.189788579940796
Epoch: 1, Steps: 10 | Train Loss: 1.490 Vali Loss: 1.736 Vali Acc: 0.257 Test Loss: 1.736 Test Acc: 0.257
Validation loss decreased (inf --> -0.256739).  Saving model ...
Epoch: 2 cost time: 2.754439115524292
Epoch: 2, Steps: 10 | Train Loss: 1.534 Vali Loss: 1.463 Vali Acc: 0.324 Test Loss: 1.463 Test Acc: 0.324
Validation loss decreased (-0.256739 --> -0.324310).  Saving model ...
Epoch: 3 cost time: 3.5816524028778076
Epoch: 3, Steps: 10 | Train Loss: 1.311 Vali Loss: 1.160 Vali Acc: 0.446 Test Loss: 1.160 Test Acc: 0.446
Validation loss decreased (-0.324310 --> -0.445934).  Saving model ...
Epoch: 4 cost time: 2.6608119010925293
Epoch: 4, Steps: 10 | Train Loss: 0.910 Vali Loss: 1.492 Vali Acc: 0.338 Test Loss: 1.492 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.0777788162231445
Epoch: 5, Steps: 10 | Train Loss: 1.058 Vali Loss: 1.081 Vali Acc: 0.554 Test Loss: 1.081 Test Acc: 0.554
Validation loss decreased (-0.445934 --> -0.554043).  Saving model ...
Epoch: 6 cost time: 3.7003400325775146
Epoch: 6, Steps: 10 | Train Loss: 0.604 Vali Loss: 1.150 Vali Acc: 0.486 Test Loss: 1.150 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.27087664604187
Epoch: 7, Steps: 10 | Train Loss: 0.439 Vali Loss: 1.126 Vali Acc: 0.541 Test Loss: 1.126 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.339015245437622
Epoch: 8, Steps: 10 | Train Loss: 0.243 Vali Loss: 1.398 Vali Acc: 0.514 Test Loss: 1.398 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.089071035385132
Epoch: 9, Steps: 10 | Train Loss: 0.161 Vali Loss: 1.808 Vali Acc: 0.514 Test Loss: 1.808 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.0193145275115967
Epoch: 10, Steps: 10 | Train Loss: 0.079 Vali Loss: 1.758 Vali Acc: 0.473 Test Loss: 1.758 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.839080572128296
Epoch: 11, Steps: 10 | Train Loss: 0.085 Vali Loss: 1.711 Vali Acc: 0.514 Test Loss: 1.711 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.4458987712860107
Epoch: 12, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.728 Vali Acc: 0.541 Test Loss: 1.728 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.5889739990234375
Epoch: 13, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.689 Vali Acc: 0.527 Test Loss: 1.689 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.4976887702941895
Epoch: 14, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.670 Vali Acc: 0.527 Test Loss: 1.670 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.5206265449523926
Epoch: 15, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.788 Vali Acc: 0.581 Test Loss: 1.788 Test Acc: 0.581
Validation loss decreased (-0.554043 --> -0.581063).  Saving model ...
Epoch: 16 cost time: 3.4632561206817627
Epoch: 16, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.943 Vali Acc: 0.527 Test Loss: 1.943 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.1079750061035156
Epoch: 17, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.873 Vali Acc: 0.541 Test Loss: 1.873 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.7667534351348877
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 2.219 Vali Acc: 0.527 Test Loss: 2.219 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.9802331924438477
Epoch: 19, Steps: 10 | Train Loss: 0.030 Vali Loss: 2.367 Vali Acc: 0.554 Test Loss: 2.367 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.7325356006622314
Epoch: 20, Steps: 10 | Train Loss: 0.034 Vali Loss: 2.405 Vali Acc: 0.541 Test Loss: 2.405 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.0575449466705322
Epoch: 21, Steps: 10 | Train Loss: 0.024 Vali Loss: 2.198 Vali Acc: 0.568 Test Loss: 2.198 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.1074981689453125
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.078 Vali Acc: 0.541 Test Loss: 2.078 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.246638298034668
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.252 Vali Acc: 0.568 Test Loss: 2.252 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.000441789627075
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.180 Vali Acc: 0.595 Test Loss: 2.180 Test Acc: 0.595
Validation loss decreased (-0.581063 --> -0.594573).  Saving model ...
Epoch: 25 cost time: 2.7161896228790283
Epoch: 25, Steps: 10 | Train Loss: 0.009 Vali Loss: 2.131 Vali Acc: 0.541 Test Loss: 2.131 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.390594482421875
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.950 Vali Acc: 0.527 Test Loss: 1.950 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.0872466564178467
Epoch: 27, Steps: 10 | Train Loss: 0.013 Vali Loss: 2.165 Vali Acc: 0.541 Test Loss: 2.165 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.7344517707824707
Epoch: 28, Steps: 10 | Train Loss: 0.012 Vali Loss: 2.441 Vali Acc: 0.514 Test Loss: 2.441 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.008580446243286
Epoch: 29, Steps: 10 | Train Loss: 0.029 Vali Loss: 2.515 Vali Acc: 0.541 Test Loss: 2.515 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.8761754035949707
Epoch: 30, Steps: 10 | Train Loss: 0.043 Vali Loss: 2.363 Vali Acc: 0.514 Test Loss: 2.363 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 3.5237019062042236
Epoch: 31, Steps: 10 | Train Loss: 0.032 Vali Loss: 2.929 Vali Acc: 0.527 Test Loss: 2.929 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 3.521759033203125
Epoch: 32, Steps: 10 | Train Loss: 0.015 Vali Loss: 2.725 Vali Acc: 0.500 Test Loss: 2.725 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 3.2915825843811035
Epoch: 33, Steps: 10 | Train Loss: 0.078 Vali Loss: 2.613 Vali Acc: 0.541 Test Loss: 2.613 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 3.1301374435424805
Epoch: 34, Steps: 10 | Train Loss: 0.049 Vali Loss: 2.978 Vali Acc: 0.473 Test Loss: 2.978 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 9487412
model size : 41.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.719108581542969
Epoch: 1, Steps: 10 | Train Loss: 1.588 Vali Loss: 1.694 Vali Acc: 0.230 Test Loss: 1.694 Test Acc: 0.230
Validation loss decreased (inf --> -0.229713).  Saving model ...
Epoch: 2 cost time: 3.4527695178985596
Epoch: 2, Steps: 10 | Train Loss: 1.432 Vali Loss: 1.502 Vali Acc: 0.203 Test Loss: 1.502 Test Acc: 0.203
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.2729439735412598
Epoch: 3, Steps: 10 | Train Loss: 1.240 Vali Loss: 1.943 Vali Acc: 0.216 Test Loss: 1.943 Test Acc: 0.216
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.286952495574951
Epoch: 4, Steps: 10 | Train Loss: 1.129 Vali Loss: 1.375 Vali Acc: 0.324 Test Loss: 1.375 Test Acc: 0.324
Validation loss decreased (-0.229713 --> -0.324311).  Saving model ...
Epoch: 5 cost time: 3.2173967361450195
Epoch: 5, Steps: 10 | Train Loss: 0.743 Vali Loss: 1.535 Vali Acc: 0.392 Test Loss: 1.535 Test Acc: 0.392
Validation loss decreased (-0.324311 --> -0.391877).  Saving model ...
Epoch: 6 cost time: 3.2141036987304688
Epoch: 6, Steps: 10 | Train Loss: 0.523 Vali Loss: 1.191 Vali Acc: 0.500 Test Loss: 1.191 Test Acc: 0.500
Validation loss decreased (-0.391877 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 2.7985503673553467
Epoch: 7, Steps: 10 | Train Loss: 0.396 Vali Loss: 1.172 Vali Acc: 0.595 Test Loss: 1.172 Test Acc: 0.595
Validation loss decreased (-0.499988 --> -0.594583).  Saving model ...
Epoch: 8 cost time: 2.674137830734253
Epoch: 8, Steps: 10 | Train Loss: 0.225 Vali Loss: 1.281 Vali Acc: 0.514 Test Loss: 1.281 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.3779165744781494
Epoch: 9, Steps: 10 | Train Loss: 0.164 Vali Loss: 1.331 Vali Acc: 0.527 Test Loss: 1.331 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.3104093074798584
Epoch: 10, Steps: 10 | Train Loss: 0.086 Vali Loss: 1.568 Vali Acc: 0.541 Test Loss: 1.568 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.961179494857788
Epoch: 11, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.655 Vali Acc: 0.568 Test Loss: 1.655 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.633735179901123
Epoch: 12, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.709 Vali Acc: 0.514 Test Loss: 1.709 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.6016573905944824
Epoch: 13, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.703 Vali Acc: 0.500 Test Loss: 1.703 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.3556067943573
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.928 Vali Acc: 0.500 Test Loss: 1.928 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.4989495277404785
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.845 Vali Acc: 0.514 Test Loss: 1.845 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.695918321609497
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.979 Vali Acc: 0.473 Test Loss: 1.979 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.676254987716675
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.866 Vali Acc: 0.514 Test Loss: 1.866 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 9472052
model size : 41.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.235252141952515
Epoch: 1, Steps: 10 | Train Loss: 1.572 Vali Loss: 1.338 Vali Acc: 0.419 Test Loss: 1.338 Test Acc: 0.419
Validation loss decreased (inf --> -0.418906).  Saving model ...
Epoch: 2 cost time: 2.7997281551361084
Epoch: 2, Steps: 10 | Train Loss: 1.399 Vali Loss: 1.597 Vali Acc: 0.405 Test Loss: 1.597 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.4203522205352783
Epoch: 3, Steps: 10 | Train Loss: 1.510 Vali Loss: 1.610 Vali Acc: 0.284 Test Loss: 1.610 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.5424418449401855
Epoch: 4, Steps: 10 | Train Loss: 1.051 Vali Loss: 1.332 Vali Acc: 0.365 Test Loss: 1.332 Test Acc: 0.365
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.672830104827881
Epoch: 5, Steps: 10 | Train Loss: 0.743 Vali Loss: 1.123 Vali Acc: 0.541 Test Loss: 1.123 Test Acc: 0.541
Validation loss decreased (-0.418906 --> -0.540529).  Saving model ...
Epoch: 6 cost time: 2.8070127964019775
Epoch: 6, Steps: 10 | Train Loss: 0.668 Vali Loss: 1.324 Vali Acc: 0.486 Test Loss: 1.324 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.1217105388641357
Epoch: 7, Steps: 10 | Train Loss: 0.515 Vali Loss: 1.198 Vali Acc: 0.527 Test Loss: 1.198 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.9997456073760986
Epoch: 8, Steps: 10 | Train Loss: 0.339 Vali Loss: 1.218 Vali Acc: 0.568 Test Loss: 1.218 Test Acc: 0.568
Validation loss decreased (-0.540529 --> -0.567555).  Saving model ...
Epoch: 9 cost time: 3.3029956817626953
Epoch: 9, Steps: 10 | Train Loss: 0.284 Vali Loss: 1.763 Vali Acc: 0.473 Test Loss: 1.763 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.9360270500183105
Epoch: 10, Steps: 10 | Train Loss: 0.172 Vali Loss: 1.549 Vali Acc: 0.514 Test Loss: 1.549 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.3204867839813232
Epoch: 11, Steps: 10 | Train Loss: 0.085 Vali Loss: 1.482 Vali Acc: 0.554 Test Loss: 1.482 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.2633914947509766
Epoch: 12, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.566 Vali Acc: 0.554 Test Loss: 1.566 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.661949872970581
Epoch: 13, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.595 Vali Acc: 0.541 Test Loss: 1.595 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.5210423469543457
Epoch: 14, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.912 Vali Acc: 0.568 Test Loss: 1.912 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.640106201171875
Epoch: 15, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.827 Vali Acc: 0.568 Test Loss: 1.827 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.2610881328582764
Epoch: 16, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.804 Vali Acc: 0.608 Test Loss: 1.804 Test Acc: 0.608
Validation loss decreased (-0.567555 --> -0.608090).  Saving model ...
Epoch: 17 cost time: 2.3974249362945557
Epoch: 17, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.987 Vali Acc: 0.568 Test Loss: 1.987 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.8778324127197266
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 2.190 Vali Acc: 0.541 Test Loss: 2.190 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.783722162246704
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.973 Vali Acc: 0.527 Test Loss: 1.973 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.5020534992218018
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.151 Vali Acc: 0.473 Test Loss: 2.151 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.051872730255127
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.988 Vali Acc: 0.500 Test Loss: 1.988 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.9428317546844482
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.947 Vali Acc: 0.527 Test Loss: 1.947 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.7317752838134766
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.966 Vali Acc: 0.541 Test Loss: 1.966 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.756009578704834
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.982 Vali Acc: 0.541 Test Loss: 1.982 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.6351842880249023
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.965 Vali Acc: 0.541 Test Loss: 1.965 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.345139265060425
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.941 Vali Acc: 0.541 Test Loss: 1.941 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 9456692
model size : 41.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.662015199661255
Epoch: 1, Steps: 10 | Train Loss: 1.469 Vali Loss: 1.709 Vali Acc: 0.243 Test Loss: 1.709 Test Acc: 0.243
Validation loss decreased (inf --> -0.243226).  Saving model ...
Epoch: 2 cost time: 2.398078203201294
Epoch: 2, Steps: 10 | Train Loss: 1.535 Vali Loss: 1.270 Vali Acc: 0.446 Test Loss: 1.270 Test Acc: 0.446
Validation loss decreased (-0.243226 --> -0.445933).  Saving model ...
Epoch: 3 cost time: 2.725168228149414
Epoch: 3, Steps: 10 | Train Loss: 1.218 Vali Loss: 1.394 Vali Acc: 0.378 Test Loss: 1.394 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.750581741333008
Epoch: 4, Steps: 10 | Train Loss: 1.078 Vali Loss: 1.387 Vali Acc: 0.419 Test Loss: 1.387 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.780535936355591
Epoch: 5, Steps: 10 | Train Loss: 0.769 Vali Loss: 1.118 Vali Acc: 0.527 Test Loss: 1.118 Test Acc: 0.527
Validation loss decreased (-0.445933 --> -0.527016).  Saving model ...
Epoch: 6 cost time: 3.0928215980529785
Epoch: 6, Steps: 10 | Train Loss: 0.562 Vali Loss: 1.262 Vali Acc: 0.500 Test Loss: 1.262 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.0663788318634033
Epoch: 7, Steps: 10 | Train Loss: 0.356 Vali Loss: 1.496 Vali Acc: 0.432 Test Loss: 1.496 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.3736281394958496
Epoch: 8, Steps: 10 | Train Loss: 0.283 Vali Loss: 1.649 Vali Acc: 0.459 Test Loss: 1.649 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.1728761196136475
Epoch: 9, Steps: 10 | Train Loss: 0.159 Vali Loss: 1.444 Vali Acc: 0.500 Test Loss: 1.444 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.066154718399048
Epoch: 10, Steps: 10 | Train Loss: 0.118 Vali Loss: 1.932 Vali Acc: 0.473 Test Loss: 1.932 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.382294178009033
Epoch: 11, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.716 Vali Acc: 0.541 Test Loss: 1.716 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540523).  Saving model ...
Epoch: 12 cost time: 2.64282488822937
Epoch: 12, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.907 Vali Acc: 0.500 Test Loss: 1.907 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.90509033203125
Epoch: 13, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.937 Vali Acc: 0.500 Test Loss: 1.937 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.7452831268310547
Epoch: 14, Steps: 10 | Train Loss: 0.009 Vali Loss: 2.070 Vali Acc: 0.486 Test Loss: 2.070 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.4760360717773438
Epoch: 15, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.716 Vali Acc: 0.486 Test Loss: 1.716 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.975238084793091
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.894 Vali Acc: 0.541 Test Loss: 1.894 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.9121644496917725
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.818 Vali Acc: 0.554 Test Loss: 1.818 Test Acc: 0.554
Validation loss decreased (-0.540523 --> -0.554036).  Saving model ...
Epoch: 18 cost time: 2.4151840209960938
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.733 Vali Acc: 0.541 Test Loss: 1.733 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.3833281993865967
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.934 Vali Acc: 0.541 Test Loss: 1.934 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.0183300971984863
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.904 Vali Acc: 0.541 Test Loss: 1.904 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.826915979385376
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.822 Vali Acc: 0.554 Test Loss: 1.822 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.92232346534729
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.812 Vali Acc: 0.554 Test Loss: 1.812 Test Acc: 0.554
Validation loss decreased (-0.554036 --> -0.554036).  Saving model ...
Epoch: 23 cost time: 3.0886688232421875
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.828 Vali Acc: 0.554 Test Loss: 1.828 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.2129456996917725
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.845 Vali Acc: 0.554 Test Loss: 1.845 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.719425678253174
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.838 Vali Acc: 0.554 Test Loss: 1.838 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.098832607269287
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.834 Vali Acc: 0.554 Test Loss: 1.834 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.997239351272583
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.845 Vali Acc: 0.568 Test Loss: 1.845 Test Acc: 0.568
Validation loss decreased (-0.554036 --> -0.567549).  Saving model ...
Epoch: 28 cost time: 3.051816463470459
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.853 Vali Acc: 0.568 Test Loss: 1.853 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.908877372741699
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.857 Vali Acc: 0.568 Test Loss: 1.857 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.9679648876190186
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.863 Vali Acc: 0.554 Test Loss: 1.863 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.0369577407836914
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.870 Vali Acc: 0.554 Test Loss: 1.870 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.1786794662475586
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.873 Vali Acc: 0.554 Test Loss: 1.873 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 3.191059112548828
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.873 Vali Acc: 0.568 Test Loss: 1.873 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.630871534347534
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.866 Vali Acc: 0.581 Test Loss: 1.866 Test Acc: 0.581
Validation loss decreased (-0.567549 --> -0.581062).  Saving model ...
Epoch: 35 cost time: 3.137807607650757
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.872 Vali Acc: 0.581 Test Loss: 1.872 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.812621593475342
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.875 Vali Acc: 0.581 Test Loss: 1.875 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.1112687587738037
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.879 Vali Acc: 0.581 Test Loss: 1.879 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.8073441982269287
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.882 Vali Acc: 0.581 Test Loss: 1.882 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 3.109307289123535
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.883 Vali Acc: 0.581 Test Loss: 1.883 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 3.0432989597320557
Epoch: 40, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.886 Vali Acc: 0.581 Test Loss: 1.886 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 3.050572156906128
Epoch: 41, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.896 Vali Acc: 0.568 Test Loss: 1.896 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 3.194728374481201
Epoch: 42, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.897 Vali Acc: 0.568 Test Loss: 1.897 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 2.7805378437042236
Epoch: 43, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.902 Vali Acc: 0.568 Test Loss: 1.902 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 2.836383819580078
Epoch: 44, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.897 Vali Acc: 0.581 Test Loss: 1.897 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 9441332
model size : 41.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.609649419784546
Epoch: 1, Steps: 10 | Train Loss: 1.444 Vali Loss: 1.458 Vali Acc: 0.203 Test Loss: 1.458 Test Acc: 0.203
Validation loss decreased (inf --> -0.202688).  Saving model ...
Epoch: 2 cost time: 2.9148001670837402
Epoch: 2, Steps: 10 | Train Loss: 1.518 Vali Loss: 1.402 Vali Acc: 0.351 Test Loss: 1.402 Test Acc: 0.351
Validation loss decreased (-0.202688 --> -0.351337).  Saving model ...
Epoch: 3 cost time: 2.65982723236084
Epoch: 3, Steps: 10 | Train Loss: 1.153 Vali Loss: 1.698 Vali Acc: 0.284 Test Loss: 1.698 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.2641358375549316
Epoch: 4, Steps: 10 | Train Loss: 1.003 Vali Loss: 1.772 Vali Acc: 0.284 Test Loss: 1.772 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.622774362564087
Epoch: 5, Steps: 10 | Train Loss: 0.914 Vali Loss: 1.395 Vali Acc: 0.473 Test Loss: 1.395 Test Acc: 0.473
Validation loss decreased (-0.351337 --> -0.472959).  Saving model ...
Epoch: 6 cost time: 3.4521751403808594
Epoch: 6, Steps: 10 | Train Loss: 0.570 Vali Loss: 1.454 Vali Acc: 0.419 Test Loss: 1.454 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.604501247406006
Epoch: 7, Steps: 10 | Train Loss: 0.443 Vali Loss: 1.320 Vali Acc: 0.486 Test Loss: 1.320 Test Acc: 0.486
Validation loss decreased (-0.472959 --> -0.486473).  Saving model ...
Epoch: 8 cost time: 3.3220109939575195
Epoch: 8, Steps: 10 | Train Loss: 0.241 Vali Loss: 1.479 Vali Acc: 0.459 Test Loss: 1.479 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.997727870941162
Epoch: 9, Steps: 10 | Train Loss: 0.209 Vali Loss: 1.814 Vali Acc: 0.446 Test Loss: 1.814 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.220865249633789
Epoch: 10, Steps: 10 | Train Loss: 0.120 Vali Loss: 1.483 Vali Acc: 0.554 Test Loss: 1.483 Test Acc: 0.554
Validation loss decreased (-0.486473 --> -0.554039).  Saving model ...
Epoch: 11 cost time: 3.046190023422241
Epoch: 11, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.592 Vali Acc: 0.527 Test Loss: 1.592 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.4646012783050537
Epoch: 12, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.614 Vali Acc: 0.541 Test Loss: 1.614 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.2763733863830566
Epoch: 13, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.690 Vali Acc: 0.541 Test Loss: 1.690 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.801252841949463
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.728 Vali Acc: 0.527 Test Loss: 1.728 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.518127202987671
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.625 Vali Acc: 0.595 Test Loss: 1.625 Test Acc: 0.595
Validation loss decreased (-0.554039 --> -0.594578).  Saving model ...
Epoch: 16 cost time: 3.4755284786224365
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.647 Vali Acc: 0.581 Test Loss: 1.647 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.7883822917938232
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.795 Vali Acc: 0.514 Test Loss: 1.795 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.5226659774780273
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.774 Vali Acc: 0.554 Test Loss: 1.774 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.981736183166504
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.749 Vali Acc: 0.568 Test Loss: 1.749 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.3806581497192383
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.746 Vali Acc: 0.568 Test Loss: 1.746 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.314534902572632
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.755 Vali Acc: 0.568 Test Loss: 1.755 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.635441303253174
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.774 Vali Acc: 0.581 Test Loss: 1.774 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.336256742477417
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.780 Vali Acc: 0.568 Test Loss: 1.780 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.3524727821350098
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.769 Vali Acc: 0.581 Test Loss: 1.769 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.3260788917541504
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.769 Vali Acc: 0.568 Test Loss: 1.769 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 8568116
model size : 37.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.661409139633179
Epoch: 1, Steps: 10 | Train Loss: 1.468 Vali Loss: 1.565 Vali Acc: 0.203 Test Loss: 1.565 Test Acc: 0.203
Validation loss decreased (inf --> -0.202687).  Saving model ...
Epoch: 2 cost time: 2.6821367740631104
Epoch: 2, Steps: 10 | Train Loss: 1.364 Vali Loss: 1.335 Vali Acc: 0.324 Test Loss: 1.335 Test Acc: 0.324
Validation loss decreased (-0.202687 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 2.068657159805298
Epoch: 3, Steps: 10 | Train Loss: 1.150 Vali Loss: 1.343 Vali Acc: 0.405 Test Loss: 1.343 Test Acc: 0.405
Validation loss decreased (-0.324311 --> -0.405392).  Saving model ...
Epoch: 4 cost time: 2.373509168624878
Epoch: 4, Steps: 10 | Train Loss: 0.976 Vali Loss: 1.184 Vali Acc: 0.459 Test Loss: 1.184 Test Acc: 0.459
Validation loss decreased (-0.405392 --> -0.459448).  Saving model ...
Epoch: 5 cost time: 3.2440290451049805
Epoch: 5, Steps: 10 | Train Loss: 0.736 Vali Loss: 1.423 Vali Acc: 0.392 Test Loss: 1.423 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.690197467803955
Epoch: 6, Steps: 10 | Train Loss: 0.560 Vali Loss: 1.276 Vali Acc: 0.527 Test Loss: 1.276 Test Acc: 0.527
Validation loss decreased (-0.459448 --> -0.527014).  Saving model ...
Epoch: 7 cost time: 2.8088138103485107
Epoch: 7, Steps: 10 | Train Loss: 0.399 Vali Loss: 1.254 Vali Acc: 0.473 Test Loss: 1.254 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.568380832672119
Epoch: 8, Steps: 10 | Train Loss: 0.285 Vali Loss: 1.246 Vali Acc: 0.595 Test Loss: 1.246 Test Acc: 0.595
Validation loss decreased (-0.527014 --> -0.594582).  Saving model ...
Epoch: 9 cost time: 1.938082218170166
Epoch: 9, Steps: 10 | Train Loss: 0.154 Vali Loss: 1.255 Vali Acc: 0.608 Test Loss: 1.255 Test Acc: 0.608
Validation loss decreased (-0.594582 --> -0.608096).  Saving model ...
Epoch: 10 cost time: 2.950425386428833
Epoch: 10, Steps: 10 | Train Loss: 0.089 Vali Loss: 1.426 Vali Acc: 0.554 Test Loss: 1.426 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.442366600036621
Epoch: 11, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.501 Vali Acc: 0.568 Test Loss: 1.501 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.0723156929016113
Epoch: 12, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.986 Vali Acc: 0.527 Test Loss: 1.986 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.689804792404175
Epoch: 13, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.865 Vali Acc: 0.568 Test Loss: 1.865 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.6999001502990723
Epoch: 14, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.901 Vali Acc: 0.541 Test Loss: 1.901 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.584961175918579
Epoch: 15, Steps: 10 | Train Loss: 0.015 Vali Loss: 2.011 Vali Acc: 0.554 Test Loss: 2.011 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.075528621673584
Epoch: 16, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.898 Vali Acc: 0.541 Test Loss: 1.898 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.280106544494629
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.990 Vali Acc: 0.541 Test Loss: 1.990 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.7710258960723877
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.987 Vali Acc: 0.514 Test Loss: 1.987 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.5791168212890625
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.977 Vali Acc: 0.514 Test Loss: 1.977 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 8552756
model size : 37.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.039375066757202
Epoch: 1, Steps: 10 | Train Loss: 1.463 Vali Loss: 1.718 Vali Acc: 0.230 Test Loss: 1.718 Test Acc: 0.230
Validation loss decreased (inf --> -0.229713).  Saving model ...
Epoch: 2 cost time: 2.8820230960845947
Epoch: 2, Steps: 10 | Train Loss: 1.589 Vali Loss: 1.545 Vali Acc: 0.203 Test Loss: 1.545 Test Acc: 0.203
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.620059013366699
Epoch: 3, Steps: 10 | Train Loss: 1.346 Vali Loss: 1.272 Vali Acc: 0.351 Test Loss: 1.272 Test Acc: 0.351
Validation loss decreased (-0.229713 --> -0.351339).  Saving model ...
Epoch: 4 cost time: 2.7108473777770996
Epoch: 4, Steps: 10 | Train Loss: 1.176 Vali Loss: 1.444 Vali Acc: 0.270 Test Loss: 1.444 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.1586575508117676
Epoch: 5, Steps: 10 | Train Loss: 0.812 Vali Loss: 1.342 Vali Acc: 0.432 Test Loss: 1.342 Test Acc: 0.432
Validation loss decreased (-0.351339 --> -0.432419).  Saving model ...
Epoch: 6 cost time: 3.0581307411193848
Epoch: 6, Steps: 10 | Train Loss: 0.623 Vali Loss: 1.353 Vali Acc: 0.459 Test Loss: 1.353 Test Acc: 0.459
Validation loss decreased (-0.432419 --> -0.459446).  Saving model ...
Epoch: 7 cost time: 2.8672940731048584
Epoch: 7, Steps: 10 | Train Loss: 0.503 Vali Loss: 1.237 Vali Acc: 0.486 Test Loss: 1.237 Test Acc: 0.486
Validation loss decreased (-0.459446 --> -0.486474).  Saving model ...
Epoch: 8 cost time: 2.7039899826049805
Epoch: 8, Steps: 10 | Train Loss: 0.256 Vali Loss: 1.366 Vali Acc: 0.486 Test Loss: 1.366 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.047985315322876
Epoch: 9, Steps: 10 | Train Loss: 0.152 Vali Loss: 1.203 Vali Acc: 0.541 Test Loss: 1.203 Test Acc: 0.541
Validation loss decreased (-0.486474 --> -0.540529).  Saving model ...
Epoch: 10 cost time: 2.745171070098877
Epoch: 10, Steps: 10 | Train Loss: 0.087 Vali Loss: 1.452 Vali Acc: 0.595 Test Loss: 1.452 Test Acc: 0.595
Validation loss decreased (-0.540529 --> -0.594580).  Saving model ...
Epoch: 11 cost time: 3.6333279609680176
Epoch: 11, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.489 Vali Acc: 0.554 Test Loss: 1.489 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.4866902828216553
Epoch: 12, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.555 Vali Acc: 0.541 Test Loss: 1.555 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.110161304473877
Epoch: 13, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.567 Vali Acc: 0.527 Test Loss: 1.567 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.7909460067749023
Epoch: 14, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.648 Vali Acc: 0.527 Test Loss: 1.648 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.2390801906585693
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.652 Vali Acc: 0.527 Test Loss: 1.652 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.461265802383423
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.709 Vali Acc: 0.554 Test Loss: 1.709 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.5959222316741943
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.764 Vali Acc: 0.527 Test Loss: 1.764 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.941628932952881
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.724 Vali Acc: 0.527 Test Loss: 1.724 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.6918301582336426
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.716 Vali Acc: 0.541 Test Loss: 1.716 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.9064040184020996
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.744 Vali Acc: 0.541 Test Loss: 1.744 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 8537396
model size : 37.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.977532625198364
Epoch: 1, Steps: 10 | Train Loss: 1.511 Vali Loss: 1.384 Vali Acc: 0.257 Test Loss: 1.384 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 2.859632968902588
Epoch: 2, Steps: 10 | Train Loss: 1.451 Vali Loss: 1.305 Vali Acc: 0.432 Test Loss: 1.305 Test Acc: 0.432
Validation loss decreased (-0.256743 --> -0.432419).  Saving model ...
Epoch: 3 cost time: 2.893411874771118
Epoch: 3, Steps: 10 | Train Loss: 1.259 Vali Loss: 1.385 Vali Acc: 0.311 Test Loss: 1.385 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.862945556640625
Epoch: 4, Steps: 10 | Train Loss: 1.058 Vali Loss: 1.605 Vali Acc: 0.311 Test Loss: 1.605 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.1969406604766846
Epoch: 5, Steps: 10 | Train Loss: 1.147 Vali Loss: 1.426 Vali Acc: 0.500 Test Loss: 1.426 Test Acc: 0.500
Validation loss decreased (-0.432419 --> -0.499986).  Saving model ...
Epoch: 6 cost time: 3.143035650253296
Epoch: 6, Steps: 10 | Train Loss: 0.776 Vali Loss: 2.085 Vali Acc: 0.365 Test Loss: 2.085 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.919013500213623
Epoch: 7, Steps: 10 | Train Loss: 0.636 Vali Loss: 1.259 Vali Acc: 0.581 Test Loss: 1.259 Test Acc: 0.581
Validation loss decreased (-0.499986 --> -0.581068).  Saving model ...
Epoch: 8 cost time: 3.251981019973755
Epoch: 8, Steps: 10 | Train Loss: 0.477 Vali Loss: 1.423 Vali Acc: 0.608 Test Loss: 1.423 Test Acc: 0.608
Validation loss decreased (-0.581068 --> -0.608094).  Saving model ...
Epoch: 9 cost time: 3.2791459560394287
Epoch: 9, Steps: 10 | Train Loss: 0.297 Vali Loss: 1.546 Vali Acc: 0.486 Test Loss: 1.546 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.112638235092163
Epoch: 10, Steps: 10 | Train Loss: 0.201 Vali Loss: 1.532 Vali Acc: 0.500 Test Loss: 1.532 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.7469990253448486
Epoch: 11, Steps: 10 | Train Loss: 0.092 Vali Loss: 1.576 Vali Acc: 0.527 Test Loss: 1.576 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.5948989391326904
Epoch: 12, Steps: 10 | Train Loss: 0.073 Vali Loss: 1.678 Vali Acc: 0.514 Test Loss: 1.678 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.791386127471924
Epoch: 13, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.919 Vali Acc: 0.527 Test Loss: 1.919 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.285020351409912
Epoch: 14, Steps: 10 | Train Loss: 0.025 Vali Loss: 2.184 Vali Acc: 0.554 Test Loss: 2.184 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.7003211975097656
Epoch: 15, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.980 Vali Acc: 0.568 Test Loss: 1.980 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.0171725749969482
Epoch: 16, Steps: 10 | Train Loss: 0.016 Vali Loss: 2.506 Vali Acc: 0.459 Test Loss: 2.506 Test Acc: 0.459
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.6459195613861084
Epoch: 17, Steps: 10 | Train Loss: 0.017 Vali Loss: 2.357 Vali Acc: 0.473 Test Loss: 2.357 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.125710964202881
Epoch: 18, Steps: 10 | Train Loss: 0.041 Vali Loss: 2.523 Vali Acc: 0.473 Test Loss: 2.523 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 8522036
model size : 37.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.0677878856658936
Epoch: 1, Steps: 10 | Train Loss: 1.522 Vali Loss: 1.527 Vali Acc: 0.257 Test Loss: 1.527 Test Acc: 0.257
Validation loss decreased (inf --> -0.256741).  Saving model ...
Epoch: 2 cost time: 2.7980217933654785
Epoch: 2, Steps: 10 | Train Loss: 1.569 Vali Loss: 1.436 Vali Acc: 0.203 Test Loss: 1.436 Test Acc: 0.203
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.9801230430603027
Epoch: 3, Steps: 10 | Train Loss: 1.297 Vali Loss: 1.796 Vali Acc: 0.189 Test Loss: 1.796 Test Acc: 0.189
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.663250684738159
Epoch: 4, Steps: 10 | Train Loss: 1.209 Vali Loss: 1.190 Vali Acc: 0.419 Test Loss: 1.190 Test Acc: 0.419
Validation loss decreased (-0.256741 --> -0.418907).  Saving model ...
Epoch: 5 cost time: 2.867429494857788
Epoch: 5, Steps: 10 | Train Loss: 0.900 Vali Loss: 1.515 Vali Acc: 0.405 Test Loss: 1.515 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.899219036102295
Epoch: 6, Steps: 10 | Train Loss: 0.789 Vali Loss: 1.609 Vali Acc: 0.432 Test Loss: 1.609 Test Acc: 0.432
Validation loss decreased (-0.418907 --> -0.432416).  Saving model ...
Epoch: 7 cost time: 3.1487178802490234
Epoch: 7, Steps: 10 | Train Loss: 0.643 Vali Loss: 1.274 Vali Acc: 0.527 Test Loss: 1.274 Test Acc: 0.527
Validation loss decreased (-0.432416 --> -0.527014).  Saving model ...
Epoch: 8 cost time: 3.447803497314453
Epoch: 8, Steps: 10 | Train Loss: 0.423 Vali Loss: 1.429 Vali Acc: 0.554 Test Loss: 1.429 Test Acc: 0.554
Validation loss decreased (-0.527014 --> -0.554040).  Saving model ...
Epoch: 9 cost time: 2.851253032684326
Epoch: 9, Steps: 10 | Train Loss: 0.308 Vali Loss: 1.450 Vali Acc: 0.568 Test Loss: 1.450 Test Acc: 0.568
Validation loss decreased (-0.554040 --> -0.567553).  Saving model ...
Epoch: 10 cost time: 2.9586024284362793
Epoch: 10, Steps: 10 | Train Loss: 0.167 Vali Loss: 1.559 Vali Acc: 0.541 Test Loss: 1.559 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.248138427734375
Epoch: 11, Steps: 10 | Train Loss: 0.100 Vali Loss: 1.438 Vali Acc: 0.541 Test Loss: 1.438 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.376802682876587
Epoch: 12, Steps: 10 | Train Loss: 0.060 Vali Loss: 1.869 Vali Acc: 0.514 Test Loss: 1.869 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.198151111602783
Epoch: 13, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.806 Vali Acc: 0.514 Test Loss: 1.806 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.8833227157592773
Epoch: 14, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.740 Vali Acc: 0.622 Test Loss: 1.740 Test Acc: 0.622
Validation loss decreased (-0.567553 --> -0.621604).  Saving model ...
Epoch: 15 cost time: 3.170292854309082
Epoch: 15, Steps: 10 | Train Loss: 0.025 Vali Loss: 2.019 Vali Acc: 0.500 Test Loss: 2.019 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.983875036239624
Epoch: 16, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.919 Vali Acc: 0.581 Test Loss: 1.919 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.860435724258423
Epoch: 17, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.910 Vali Acc: 0.541 Test Loss: 1.910 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.542876958847046
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.826 Vali Acc: 0.635 Test Loss: 1.826 Test Acc: 0.635
Validation loss decreased (-0.621604 --> -0.635117).  Saving model ...
Epoch: 19 cost time: 3.192946195602417
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.855 Vali Acc: 0.568 Test Loss: 1.855 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.819941282272339
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.816 Vali Acc: 0.554 Test Loss: 1.816 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.9964137077331543
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.768 Vali Acc: 0.622 Test Loss: 1.768 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.269804000854492
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.778 Vali Acc: 0.595 Test Loss: 1.778 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.3722589015960693
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.816 Vali Acc: 0.568 Test Loss: 1.816 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.13852858543396
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.813 Vali Acc: 0.568 Test Loss: 1.813 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.8841471672058105
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.801 Vali Acc: 0.568 Test Loss: 1.801 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.997260808944702
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.797 Vali Acc: 0.568 Test Loss: 1.797 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.1609158515930176
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.804 Vali Acc: 0.568 Test Loss: 1.804 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.9183385372161865
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.814 Vali Acc: 0.568 Test Loss: 1.814 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 8108468
model size : 35.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.377971172332764
Epoch: 1, Steps: 10 | Train Loss: 1.485 Vali Loss: 1.376 Vali Acc: 0.405 Test Loss: 1.376 Test Acc: 0.405
Validation loss decreased (inf --> -0.405392).  Saving model ...
Epoch: 2 cost time: 2.5690629482269287
Epoch: 2, Steps: 10 | Train Loss: 1.460 Vali Loss: 1.524 Vali Acc: 0.243 Test Loss: 1.524 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.700685739517212
Epoch: 3, Steps: 10 | Train Loss: 1.224 Vali Loss: 1.656 Vali Acc: 0.311 Test Loss: 1.656 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.0105366706848145
Epoch: 4, Steps: 10 | Train Loss: 1.139 Vali Loss: 1.166 Vali Acc: 0.514 Test Loss: 1.166 Test Acc: 0.514
Validation loss decreased (-0.405392 --> -0.513502).  Saving model ...
Epoch: 5 cost time: 3.3717195987701416
Epoch: 5, Steps: 10 | Train Loss: 0.975 Vali Loss: 1.382 Vali Acc: 0.527 Test Loss: 1.382 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527013).  Saving model ...
Epoch: 6 cost time: 3.2013540267944336
Epoch: 6, Steps: 10 | Train Loss: 0.741 Vali Loss: 1.357 Vali Acc: 0.568 Test Loss: 1.357 Test Acc: 0.568
Validation loss decreased (-0.527013 --> -0.567554).  Saving model ...
Epoch: 7 cost time: 2.24983811378479
Epoch: 7, Steps: 10 | Train Loss: 0.592 Vali Loss: 1.229 Vali Acc: 0.500 Test Loss: 1.229 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.645746946334839
Epoch: 8, Steps: 10 | Train Loss: 0.274 Vali Loss: 1.213 Vali Acc: 0.554 Test Loss: 1.213 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.6688880920410156
Epoch: 9, Steps: 10 | Train Loss: 0.191 Vali Loss: 1.428 Vali Acc: 0.486 Test Loss: 1.428 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.6592020988464355
Epoch: 10, Steps: 10 | Train Loss: 0.180 Vali Loss: 1.668 Vali Acc: 0.514 Test Loss: 1.668 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.6088950634002686
Epoch: 11, Steps: 10 | Train Loss: 0.062 Vali Loss: 1.405 Vali Acc: 0.568 Test Loss: 1.405 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.655963659286499
Epoch: 12, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.552 Vali Acc: 0.554 Test Loss: 1.552 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.592139720916748
Epoch: 13, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.654 Vali Acc: 0.568 Test Loss: 1.654 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.5197479724884033
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.637 Vali Acc: 0.500 Test Loss: 1.637 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.549161434173584
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.854 Vali Acc: 0.527 Test Loss: 1.854 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.97359561920166
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.683 Vali Acc: 0.554 Test Loss: 1.683 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 8093108
model size : 35.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.793712377548218
Epoch: 1, Steps: 10 | Train Loss: 1.503 Vali Loss: 1.395 Vali Acc: 0.243 Test Loss: 1.395 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 3.280045509338379
Epoch: 2, Steps: 10 | Train Loss: 1.407 Vali Loss: 1.415 Vali Acc: 0.284 Test Loss: 1.415 Test Acc: 0.284
Validation loss decreased (-0.243229 --> -0.283770).  Saving model ...
Epoch: 3 cost time: 3.322935104370117
Epoch: 3, Steps: 10 | Train Loss: 1.242 Vali Loss: 1.433 Vali Acc: 0.324 Test Loss: 1.433 Test Acc: 0.324
Validation loss decreased (-0.283770 --> -0.324310).  Saving model ...
Epoch: 4 cost time: 2.9857523441314697
Epoch: 4, Steps: 10 | Train Loss: 0.969 Vali Loss: 1.314 Vali Acc: 0.405 Test Loss: 1.314 Test Acc: 0.405
Validation loss decreased (-0.324310 --> -0.405392).  Saving model ...
Epoch: 5 cost time: 2.7665982246398926
Epoch: 5, Steps: 10 | Train Loss: 0.825 Vali Loss: 1.047 Vali Acc: 0.581 Test Loss: 1.047 Test Acc: 0.581
Validation loss decreased (-0.405392 --> -0.581071).  Saving model ...
Epoch: 6 cost time: 3.054109573364258
Epoch: 6, Steps: 10 | Train Loss: 0.629 Vali Loss: 1.252 Vali Acc: 0.500 Test Loss: 1.252 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.883857250213623
Epoch: 7, Steps: 10 | Train Loss: 0.385 Vali Loss: 1.123 Vali Acc: 0.500 Test Loss: 1.123 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.3547897338867188
Epoch: 8, Steps: 10 | Train Loss: 0.236 Vali Loss: 1.114 Vali Acc: 0.541 Test Loss: 1.114 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.8037021160125732
Epoch: 9, Steps: 10 | Train Loss: 0.194 Vali Loss: 1.313 Vali Acc: 0.514 Test Loss: 1.313 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.721449851989746
Epoch: 10, Steps: 10 | Train Loss: 0.097 Vali Loss: 1.436 Vali Acc: 0.500 Test Loss: 1.436 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.7501893043518066
Epoch: 11, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.504 Vali Acc: 0.527 Test Loss: 1.504 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.471254587173462
Epoch: 12, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.687 Vali Acc: 0.500 Test Loss: 1.687 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.8741071224212646
Epoch: 13, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.654 Vali Acc: 0.541 Test Loss: 1.654 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.051748037338257
Epoch: 14, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.863 Vali Acc: 0.554 Test Loss: 1.863 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.8819239139556885
Epoch: 15, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.665 Vali Acc: 0.527 Test Loss: 1.665 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 8077748
model size : 35.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.597925901412964
Epoch: 1, Steps: 10 | Train Loss: 1.575 Vali Loss: 1.464 Vali Acc: 0.216 Test Loss: 1.464 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 3.245551586151123
Epoch: 2, Steps: 10 | Train Loss: 1.481 Vali Loss: 1.285 Vali Acc: 0.473 Test Loss: 1.285 Test Acc: 0.473
Validation loss decreased (-0.216202 --> -0.472960).  Saving model ...
Epoch: 3 cost time: 2.9411861896514893
Epoch: 3, Steps: 10 | Train Loss: 1.153 Vali Loss: 1.440 Vali Acc: 0.338 Test Loss: 1.440 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.78729510307312
Epoch: 4, Steps: 10 | Train Loss: 0.952 Vali Loss: 1.389 Vali Acc: 0.365 Test Loss: 1.389 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.7250490188598633
Epoch: 5, Steps: 10 | Train Loss: 0.828 Vali Loss: 1.391 Vali Acc: 0.338 Test Loss: 1.391 Test Acc: 0.338
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.893925666809082
Epoch: 6, Steps: 10 | Train Loss: 0.572 Vali Loss: 1.148 Vali Acc: 0.514 Test Loss: 1.148 Test Acc: 0.514
Validation loss decreased (-0.472960 --> -0.513502).  Saving model ...
Epoch: 7 cost time: 2.5942790508270264
Epoch: 7, Steps: 10 | Train Loss: 0.557 Vali Loss: 1.805 Vali Acc: 0.378 Test Loss: 1.805 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.90022349357605
Epoch: 8, Steps: 10 | Train Loss: 0.426 Vali Loss: 1.504 Vali Acc: 0.459 Test Loss: 1.504 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.1443064212799072
Epoch: 9, Steps: 10 | Train Loss: 0.216 Vali Loss: 1.325 Vali Acc: 0.500 Test Loss: 1.325 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.7244791984558105
Epoch: 10, Steps: 10 | Train Loss: 0.095 Vali Loss: 1.430 Vali Acc: 0.459 Test Loss: 1.430 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.6954150199890137
Epoch: 11, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.440 Vali Acc: 0.568 Test Loss: 1.440 Test Acc: 0.568
Validation loss decreased (-0.513502 --> -0.567553).  Saving model ...
Epoch: 12 cost time: 2.8705055713653564
Epoch: 12, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.572 Vali Acc: 0.541 Test Loss: 1.572 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.483163595199585
Epoch: 13, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.627 Vali Acc: 0.608 Test Loss: 1.627 Test Acc: 0.608
Validation loss decreased (-0.567553 --> -0.608092).  Saving model ...
Epoch: 14 cost time: 2.391099452972412
Epoch: 14, Steps: 10 | Train Loss: 0.017 Vali Loss: 2.219 Vali Acc: 0.500 Test Loss: 2.219 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.3140501976013184
Epoch: 15, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.868 Vali Acc: 0.500 Test Loss: 1.868 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.316520929336548
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.735 Vali Acc: 0.554 Test Loss: 1.735 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.6811740398406982
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.798 Vali Acc: 0.514 Test Loss: 1.798 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.3441879749298096
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.993 Vali Acc: 0.541 Test Loss: 1.993 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.3679306507110596
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.917 Vali Acc: 0.541 Test Loss: 1.917 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.2030203342437744
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.932 Vali Acc: 0.527 Test Loss: 1.932 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.2229955196380615
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.945 Vali Acc: 0.514 Test Loss: 1.945 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.330141067504883
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.950 Vali Acc: 0.527 Test Loss: 1.950 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.8025643825531006
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.956 Vali Acc: 0.541 Test Loss: 1.956 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 8062388
model size : 35.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.462115049362183
Epoch: 1, Steps: 10 | Train Loss: 1.518 Vali Loss: 1.452 Vali Acc: 0.351 Test Loss: 1.452 Test Acc: 0.351
Validation loss decreased (inf --> -0.351337).  Saving model ...
Epoch: 2 cost time: 2.6142654418945312
Epoch: 2, Steps: 10 | Train Loss: 1.482 Vali Loss: 1.514 Vali Acc: 0.230 Test Loss: 1.514 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.235654592514038
Epoch: 3, Steps: 10 | Train Loss: 1.272 Vali Loss: 1.329 Vali Acc: 0.378 Test Loss: 1.329 Test Acc: 0.378
Validation loss decreased (-0.351337 --> -0.378365).  Saving model ...
Epoch: 4 cost time: 2.916124105453491
Epoch: 4, Steps: 10 | Train Loss: 1.115 Vali Loss: 1.287 Vali Acc: 0.473 Test Loss: 1.287 Test Acc: 0.473
Validation loss decreased (-0.378365 --> -0.472960).  Saving model ...
Epoch: 5 cost time: 3.635344982147217
Epoch: 5, Steps: 10 | Train Loss: 0.926 Vali Loss: 1.331 Vali Acc: 0.419 Test Loss: 1.331 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.997302293777466
Epoch: 6, Steps: 10 | Train Loss: 0.725 Vali Loss: 1.140 Vali Acc: 0.541 Test Loss: 1.140 Test Acc: 0.541
Validation loss decreased (-0.472960 --> -0.540529).  Saving model ...
Epoch: 7 cost time: 2.7027056217193604
Epoch: 7, Steps: 10 | Train Loss: 0.659 Vali Loss: 1.228 Vali Acc: 0.527 Test Loss: 1.228 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.1409692764282227
Epoch: 8, Steps: 10 | Train Loss: 0.559 Vali Loss: 1.392 Vali Acc: 0.432 Test Loss: 1.392 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.4323136806488037
Epoch: 9, Steps: 10 | Train Loss: 0.494 Vali Loss: 1.488 Vali Acc: 0.459 Test Loss: 1.488 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.8859434127807617
Epoch: 10, Steps: 10 | Train Loss: 0.321 Vali Loss: 1.166 Vali Acc: 0.608 Test Loss: 1.166 Test Acc: 0.608
Validation loss decreased (-0.540529 --> -0.608096).  Saving model ...
Epoch: 11 cost time: 3.2814202308654785
Epoch: 11, Steps: 10 | Train Loss: 0.195 Vali Loss: 1.354 Vali Acc: 0.514 Test Loss: 1.354 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.9616165161132812
Epoch: 12, Steps: 10 | Train Loss: 0.084 Vali Loss: 1.275 Vali Acc: 0.581 Test Loss: 1.275 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.8643414974212646
Epoch: 13, Steps: 10 | Train Loss: 0.063 Vali Loss: 1.357 Vali Acc: 0.554 Test Loss: 1.357 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.7318153381347656
Epoch: 14, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.320 Vali Acc: 0.608 Test Loss: 1.320 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.9673218727111816
Epoch: 15, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.350 Vali Acc: 0.608 Test Loss: 1.350 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.551382303237915
Epoch: 16, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.371 Vali Acc: 0.568 Test Loss: 1.371 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.3879904747009277
Epoch: 17, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.480 Vali Acc: 0.554 Test Loss: 1.480 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.48960280418396
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.387 Vali Acc: 0.514 Test Loss: 1.387 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.2655534744262695
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.474 Vali Acc: 0.541 Test Loss: 1.474 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.151557207107544
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.428 Vali Acc: 0.541 Test Loss: 1.428 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 3831604
model size : 17.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.869441270828247
Epoch: 1, Steps: 10 | Train Loss: 1.464 Vali Loss: 1.442 Vali Acc: 0.270 Test Loss: 1.442 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 2.1116631031036377
Epoch: 2, Steps: 10 | Train Loss: 1.517 Vali Loss: 1.557 Vali Acc: 0.284 Test Loss: 1.557 Test Acc: 0.284
Validation loss decreased (-0.270256 --> -0.283768).  Saving model ...
Epoch: 3 cost time: 2.313544511795044
Epoch: 3, Steps: 10 | Train Loss: 1.419 Vali Loss: 1.489 Vali Acc: 0.243 Test Loss: 1.489 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.4919040203094482
Epoch: 4, Steps: 10 | Train Loss: 1.193 Vali Loss: 1.445 Vali Acc: 0.243 Test Loss: 1.445 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.6271276473999023
Epoch: 5, Steps: 10 | Train Loss: 1.023 Vali Loss: 1.212 Vali Acc: 0.500 Test Loss: 1.212 Test Acc: 0.500
Validation loss decreased (-0.283768 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 2.678731918334961
Epoch: 6, Steps: 10 | Train Loss: 0.801 Vali Loss: 1.239 Vali Acc: 0.486 Test Loss: 1.239 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.3957273960113525
Epoch: 7, Steps: 10 | Train Loss: 0.684 Vali Loss: 1.292 Vali Acc: 0.500 Test Loss: 1.292 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.565155267715454
Epoch: 8, Steps: 10 | Train Loss: 0.529 Vali Loss: 1.176 Vali Acc: 0.514 Test Loss: 1.176 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 9 cost time: 2.603595733642578
Epoch: 9, Steps: 10 | Train Loss: 0.346 Vali Loss: 1.128 Vali Acc: 0.581 Test Loss: 1.128 Test Acc: 0.581
Validation loss decreased (-0.513502 --> -0.581070).  Saving model ...
Epoch: 10 cost time: 2.753589153289795
Epoch: 10, Steps: 10 | Train Loss: 0.227 Vali Loss: 1.262 Vali Acc: 0.514 Test Loss: 1.262 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.833148956298828
Epoch: 11, Steps: 10 | Train Loss: 0.140 Vali Loss: 1.466 Vali Acc: 0.527 Test Loss: 1.466 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.8853659629821777
Epoch: 12, Steps: 10 | Train Loss: 0.082 Vali Loss: 1.265 Vali Acc: 0.554 Test Loss: 1.265 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.385319232940674
Epoch: 13, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.429 Vali Acc: 0.527 Test Loss: 1.429 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.880612373352051
Epoch: 14, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.450 Vali Acc: 0.554 Test Loss: 1.450 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.6528759002685547
Epoch: 15, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.383 Vali Acc: 0.541 Test Loss: 1.383 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.9228572845458984
Epoch: 16, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.413 Vali Acc: 0.554 Test Loss: 1.413 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.7360482215881348
Epoch: 17, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.511 Vali Acc: 0.554 Test Loss: 1.511 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.616213083267212
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.481 Vali Acc: 0.581 Test Loss: 1.481 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.363008975982666
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.488 Vali Acc: 0.541 Test Loss: 1.488 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 3823924
model size : 17.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.858644962310791
Epoch: 1, Steps: 10 | Train Loss: 1.519 Vali Loss: 1.608 Vali Acc: 0.203 Test Loss: 1.608 Test Acc: 0.203
Validation loss decreased (inf --> -0.202687).  Saving model ...
Epoch: 2 cost time: 2.8471081256866455
Epoch: 2, Steps: 10 | Train Loss: 1.465 Vali Loss: 1.351 Vali Acc: 0.297 Test Loss: 1.351 Test Acc: 0.297
Validation loss decreased (-0.202687 --> -0.297284).  Saving model ...
Epoch: 3 cost time: 3.302602767944336
Epoch: 3, Steps: 10 | Train Loss: 1.355 Vali Loss: 1.289 Vali Acc: 0.392 Test Loss: 1.289 Test Acc: 0.392
Validation loss decreased (-0.297284 --> -0.391879).  Saving model ...
Epoch: 4 cost time: 2.8438165187835693
Epoch: 4, Steps: 10 | Train Loss: 1.284 Vali Loss: 1.684 Vali Acc: 0.243 Test Loss: 1.684 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.796658515930176
Epoch: 5, Steps: 10 | Train Loss: 1.101 Vali Loss: 1.270 Vali Acc: 0.392 Test Loss: 1.270 Test Acc: 0.392
Validation loss decreased (-0.391879 --> -0.391879).  Saving model ...
Epoch: 6 cost time: 2.780186414718628
Epoch: 6, Steps: 10 | Train Loss: 0.836 Vali Loss: 1.491 Vali Acc: 0.392 Test Loss: 1.491 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.5642549991607666
Epoch: 7, Steps: 10 | Train Loss: 0.818 Vali Loss: 1.281 Vali Acc: 0.446 Test Loss: 1.281 Test Acc: 0.446
Validation loss decreased (-0.391879 --> -0.445933).  Saving model ...
Epoch: 8 cost time: 2.5136964321136475
Epoch: 8, Steps: 10 | Train Loss: 0.491 Vali Loss: 1.366 Vali Acc: 0.473 Test Loss: 1.366 Test Acc: 0.473
Validation loss decreased (-0.445933 --> -0.472959).  Saving model ...
Epoch: 9 cost time: 2.63809871673584
Epoch: 9, Steps: 10 | Train Loss: 0.374 Vali Loss: 1.243 Vali Acc: 0.568 Test Loss: 1.243 Test Acc: 0.568
Validation loss decreased (-0.472959 --> -0.567555).  Saving model ...
Epoch: 10 cost time: 2.6093225479125977
Epoch: 10, Steps: 10 | Train Loss: 0.285 Vali Loss: 1.224 Vali Acc: 0.541 Test Loss: 1.224 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.7297868728637695
Epoch: 11, Steps: 10 | Train Loss: 0.192 Vali Loss: 1.520 Vali Acc: 0.514 Test Loss: 1.520 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.663767099380493
Epoch: 12, Steps: 10 | Train Loss: 0.126 Vali Loss: 1.292 Vali Acc: 0.595 Test Loss: 1.292 Test Acc: 0.595
Validation loss decreased (-0.567555 --> -0.594582).  Saving model ...
Epoch: 13 cost time: 2.769984722137451
Epoch: 13, Steps: 10 | Train Loss: 0.066 Vali Loss: 1.473 Vali Acc: 0.541 Test Loss: 1.473 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.4065704345703125
Epoch: 14, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.517 Vali Acc: 0.554 Test Loss: 1.517 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.6201093196868896
Epoch: 15, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.413 Vali Acc: 0.541 Test Loss: 1.413 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.690692186355591
Epoch: 16, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.480 Vali Acc: 0.581 Test Loss: 1.480 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.2091104984283447
Epoch: 17, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.381 Vali Acc: 0.581 Test Loss: 1.381 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.681642532348633
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.379 Vali Acc: 0.595 Test Loss: 1.379 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.957366704940796
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.419 Vali Acc: 0.608 Test Loss: 1.419 Test Acc: 0.608
Validation loss decreased (-0.594582 --> -0.608094).  Saving model ...
Epoch: 20 cost time: 2.694671869277954
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.437 Vali Acc: 0.608 Test Loss: 1.437 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.9628052711486816
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.411 Vali Acc: 0.581 Test Loss: 1.411 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.3674581050872803
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.419 Vali Acc: 0.595 Test Loss: 1.419 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.996556520462036
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.430 Vali Acc: 0.595 Test Loss: 1.430 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.8132762908935547
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.455 Vali Acc: 0.595 Test Loss: 1.455 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.0479953289031982
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.464 Vali Acc: 0.595 Test Loss: 1.464 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.3552167415618896
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.451 Vali Acc: 0.581 Test Loss: 1.451 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.775651454925537
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.455 Vali Acc: 0.581 Test Loss: 1.455 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.6597251892089844
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.475 Vali Acc: 0.608 Test Loss: 1.475 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.6263809204101562
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.487 Vali Acc: 0.608 Test Loss: 1.487 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 3816244
model size : 17.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.541032314300537
Epoch: 1, Steps: 10 | Train Loss: 1.490 Vali Loss: 1.436 Vali Acc: 0.257 Test Loss: 1.436 Test Acc: 0.257
Validation loss decreased (inf --> -0.256742).  Saving model ...
Epoch: 2 cost time: 2.625135660171509
Epoch: 2, Steps: 10 | Train Loss: 1.471 Vali Loss: 1.448 Vali Acc: 0.257 Test Loss: 1.448 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9005062580108643
Epoch: 3, Steps: 10 | Train Loss: 1.339 Vali Loss: 1.435 Vali Acc: 0.378 Test Loss: 1.435 Test Acc: 0.378
Validation loss decreased (-0.256742 --> -0.378364).  Saving model ...
Epoch: 4 cost time: 2.0145950317382812
Epoch: 4, Steps: 10 | Train Loss: 1.298 Vali Loss: 1.335 Vali Acc: 0.419 Test Loss: 1.335 Test Acc: 0.419
Validation loss decreased (-0.378364 --> -0.418906).  Saving model ...
Epoch: 5 cost time: 2.020148277282715
Epoch: 5, Steps: 10 | Train Loss: 1.076 Vali Loss: 1.389 Vali Acc: 0.365 Test Loss: 1.389 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.4529995918273926
Epoch: 6, Steps: 10 | Train Loss: 0.916 Vali Loss: 1.438 Vali Acc: 0.392 Test Loss: 1.438 Test Acc: 0.392
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.950597047805786
Epoch: 7, Steps: 10 | Train Loss: 0.646 Vali Loss: 1.282 Vali Acc: 0.500 Test Loss: 1.282 Test Acc: 0.500
Validation loss decreased (-0.418906 --> -0.499987).  Saving model ...
Epoch: 8 cost time: 2.6032447814941406
Epoch: 8, Steps: 10 | Train Loss: 0.536 Vali Loss: 1.150 Vali Acc: 0.514 Test Loss: 1.150 Test Acc: 0.514
Validation loss decreased (-0.499987 --> -0.513502).  Saving model ...
Epoch: 9 cost time: 2.666649580001831
Epoch: 9, Steps: 10 | Train Loss: 0.353 Vali Loss: 1.227 Vali Acc: 0.500 Test Loss: 1.227 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.5540904998779297
Epoch: 10, Steps: 10 | Train Loss: 0.238 Vali Loss: 1.287 Vali Acc: 0.514 Test Loss: 1.287 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.9285576343536377
Epoch: 11, Steps: 10 | Train Loss: 0.165 Vali Loss: 1.239 Vali Acc: 0.568 Test Loss: 1.239 Test Acc: 0.568
Validation loss decreased (-0.513502 --> -0.567555).  Saving model ...
Epoch: 12 cost time: 2.4726788997650146
Epoch: 12, Steps: 10 | Train Loss: 0.093 Vali Loss: 1.381 Vali Acc: 0.595 Test Loss: 1.381 Test Acc: 0.595
Validation loss decreased (-0.567555 --> -0.594581).  Saving model ...
Epoch: 13 cost time: 2.5184459686279297
Epoch: 13, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.283 Vali Acc: 0.581 Test Loss: 1.283 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.5537562370300293
Epoch: 14, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.454 Vali Acc: 0.500 Test Loss: 1.454 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.5481419563293457
Epoch: 15, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.360 Vali Acc: 0.568 Test Loss: 1.360 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.657865285873413
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.467 Vali Acc: 0.527 Test Loss: 1.467 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.9454333782196045
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.399 Vali Acc: 0.568 Test Loss: 1.399 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.9192564487457275
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.437 Vali Acc: 0.527 Test Loss: 1.437 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.6658685207366943
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.498 Vali Acc: 0.541 Test Loss: 1.498 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.646986722946167
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.473 Vali Acc: 0.568 Test Loss: 1.473 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.7152304649353027
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.484 Vali Acc: 0.554 Test Loss: 1.484 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.57073712348938
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.513 Vali Acc: 0.541 Test Loss: 1.513 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 3808564
model size : 17.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.378295183181763
Epoch: 1, Steps: 10 | Train Loss: 1.450 Vali Loss: 1.361 Vali Acc: 0.392 Test Loss: 1.361 Test Acc: 0.392
Validation loss decreased (inf --> -0.391878).  Saving model ...
Epoch: 2 cost time: 2.816728353500366
Epoch: 2, Steps: 10 | Train Loss: 1.488 Vali Loss: 1.309 Vali Acc: 0.392 Test Loss: 1.309 Test Acc: 0.392
Validation loss decreased (-0.391878 --> -0.391879).  Saving model ...
Epoch: 3 cost time: 2.5903499126434326
Epoch: 3, Steps: 10 | Train Loss: 1.329 Vali Loss: 1.413 Vali Acc: 0.230 Test Loss: 1.413 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.2351741790771484
Epoch: 4, Steps: 10 | Train Loss: 1.153 Vali Loss: 1.427 Vali Acc: 0.392 Test Loss: 1.427 Test Acc: 0.392
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.637559413909912
Epoch: 5, Steps: 10 | Train Loss: 1.075 Vali Loss: 1.170 Vali Acc: 0.486 Test Loss: 1.170 Test Acc: 0.486
Validation loss decreased (-0.391879 --> -0.486475).  Saving model ...
Epoch: 6 cost time: 2.380431890487671
Epoch: 6, Steps: 10 | Train Loss: 0.959 Vali Loss: 1.166 Vali Acc: 0.473 Test Loss: 1.166 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.463339328765869
Epoch: 7, Steps: 10 | Train Loss: 0.673 Vali Loss: 1.227 Vali Acc: 0.446 Test Loss: 1.227 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.690742015838623
Epoch: 8, Steps: 10 | Train Loss: 0.486 Vali Loss: 1.124 Vali Acc: 0.554 Test Loss: 1.124 Test Acc: 0.554
Validation loss decreased (-0.486475 --> -0.554043).  Saving model ...
Epoch: 9 cost time: 2.4052581787109375
Epoch: 9, Steps: 10 | Train Loss: 0.331 Vali Loss: 1.181 Vali Acc: 0.541 Test Loss: 1.181 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.5492541790008545
Epoch: 10, Steps: 10 | Train Loss: 0.232 Vali Loss: 1.203 Vali Acc: 0.527 Test Loss: 1.203 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.6358256340026855
Epoch: 11, Steps: 10 | Train Loss: 0.150 Vali Loss: 1.297 Vali Acc: 0.554 Test Loss: 1.297 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.611929416656494
Epoch: 12, Steps: 10 | Train Loss: 0.133 Vali Loss: 1.413 Vali Acc: 0.527 Test Loss: 1.413 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.782081365585327
Epoch: 13, Steps: 10 | Train Loss: 0.075 Vali Loss: 1.600 Vali Acc: 0.500 Test Loss: 1.600 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.142218828201294
Epoch: 14, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.447 Vali Acc: 0.649 Test Loss: 1.447 Test Acc: 0.649
Validation loss decreased (-0.554043 --> -0.648634).  Saving model ...
Epoch: 15 cost time: 3.0229334831237793
Epoch: 15, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.622 Vali Acc: 0.500 Test Loss: 1.622 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.0079305171966553
Epoch: 16, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.620 Vali Acc: 0.514 Test Loss: 1.620 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.6746463775634766
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.557 Vali Acc: 0.554 Test Loss: 1.557 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.6907765865325928
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.599 Vali Acc: 0.527 Test Loss: 1.599 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.109365701675415
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.656 Vali Acc: 0.527 Test Loss: 1.656 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.955244779586792
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.647 Vali Acc: 0.514 Test Loss: 1.647 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.382085084915161
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.664 Vali Acc: 0.486 Test Loss: 1.664 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.9994349479675293
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.667 Vali Acc: 0.514 Test Loss: 1.667 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.835853338241577
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.673 Vali Acc: 0.500 Test Loss: 1.673 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.439732551574707
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.672 Vali Acc: 0.486 Test Loss: 1.672 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 2910516
model size : 13.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.375950813293457
Epoch: 1, Steps: 10 | Train Loss: 1.573 Vali Loss: 1.420 Vali Acc: 0.324 Test Loss: 1.420 Test Acc: 0.324
Validation loss decreased (inf --> -0.324310).  Saving model ...
Epoch: 2 cost time: 3.590233087539673
Epoch: 2, Steps: 10 | Train Loss: 1.535 Vali Loss: 1.424 Vali Acc: 0.189 Test Loss: 1.424 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.7940073013305664
Epoch: 3, Steps: 10 | Train Loss: 1.430 Vali Loss: 1.485 Vali Acc: 0.203 Test Loss: 1.485 Test Acc: 0.203
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.6330485343933105
Epoch: 4, Steps: 10 | Train Loss: 1.344 Vali Loss: 1.379 Vali Acc: 0.446 Test Loss: 1.379 Test Acc: 0.446
Validation loss decreased (-0.324310 --> -0.445932).  Saving model ...
Epoch: 5 cost time: 3.0761420726776123
Epoch: 5, Steps: 10 | Train Loss: 1.161 Vali Loss: 1.348 Vali Acc: 0.378 Test Loss: 1.348 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.2651827335357666
Epoch: 6, Steps: 10 | Train Loss: 0.987 Vali Loss: 1.193 Vali Acc: 0.473 Test Loss: 1.193 Test Acc: 0.473
Validation loss decreased (-0.445932 --> -0.472961).  Saving model ...
Epoch: 7 cost time: 3.323641300201416
Epoch: 7, Steps: 10 | Train Loss: 0.785 Vali Loss: 1.265 Vali Acc: 0.446 Test Loss: 1.265 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.27960467338562
Epoch: 8, Steps: 10 | Train Loss: 0.657 Vali Loss: 1.154 Vali Acc: 0.446 Test Loss: 1.154 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.200301170349121
Epoch: 9, Steps: 10 | Train Loss: 0.448 Vali Loss: 1.220 Vali Acc: 0.541 Test Loss: 1.220 Test Acc: 0.541
Validation loss decreased (-0.472961 --> -0.540528).  Saving model ...
Epoch: 10 cost time: 3.265927791595459
Epoch: 10, Steps: 10 | Train Loss: 0.305 Vali Loss: 1.318 Vali Acc: 0.500 Test Loss: 1.318 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.6417853832244873
Epoch: 11, Steps: 10 | Train Loss: 0.214 Vali Loss: 1.371 Vali Acc: 0.473 Test Loss: 1.371 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.4972918033599854
Epoch: 12, Steps: 10 | Train Loss: 0.113 Vali Loss: 1.289 Vali Acc: 0.541 Test Loss: 1.289 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.6769449710845947
Epoch: 13, Steps: 10 | Train Loss: 0.062 Vali Loss: 1.361 Vali Acc: 0.500 Test Loss: 1.361 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.776463031768799
Epoch: 14, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.376 Vali Acc: 0.541 Test Loss: 1.376 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.462148427963257
Epoch: 15, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.506 Vali Acc: 0.554 Test Loss: 1.506 Test Acc: 0.554
Validation loss decreased (-0.540528 --> -0.554039).  Saving model ...
Epoch: 16 cost time: 2.703773260116577
Epoch: 16, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.415 Vali Acc: 0.581 Test Loss: 1.415 Test Acc: 0.581
Validation loss decreased (-0.554039 --> -0.581067).  Saving model ...
Epoch: 17 cost time: 2.1747255325317383
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.540 Vali Acc: 0.554 Test Loss: 1.540 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.540661334991455
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.465 Vali Acc: 0.568 Test Loss: 1.465 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.955944776535034
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.523 Vali Acc: 0.554 Test Loss: 1.523 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.469017744064331
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.537 Vali Acc: 0.554 Test Loss: 1.537 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.5750699043273926
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.514 Vali Acc: 0.581 Test Loss: 1.514 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.1274492740631104
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.517 Vali Acc: 0.568 Test Loss: 1.517 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.6414737701416016
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.560 Vali Acc: 0.581 Test Loss: 1.560 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.8370182514190674
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.541 Vali Acc: 0.581 Test Loss: 1.541 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.816866397857666
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.567 Vali Acc: 0.568 Test Loss: 1.567 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.032101631164551
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.586 Vali Acc: 0.568 Test Loss: 1.586 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 2902836
model size : 13.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.316905975341797
Epoch: 1, Steps: 10 | Train Loss: 1.487 Vali Loss: 1.315 Vali Acc: 0.432 Test Loss: 1.315 Test Acc: 0.432
Validation loss decreased (inf --> -0.432419).  Saving model ...
Epoch: 2 cost time: 2.4994938373565674
Epoch: 2, Steps: 10 | Train Loss: 1.430 Vali Loss: 1.378 Vali Acc: 0.297 Test Loss: 1.378 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.830353021621704
Epoch: 3, Steps: 10 | Train Loss: 1.316 Vali Loss: 1.296 Vali Acc: 0.486 Test Loss: 1.296 Test Acc: 0.486
Validation loss decreased (-0.432419 --> -0.486474).  Saving model ...
Epoch: 4 cost time: 2.52781343460083
Epoch: 4, Steps: 10 | Train Loss: 1.256 Vali Loss: 1.238 Vali Acc: 0.446 Test Loss: 1.238 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.8626441955566406
Epoch: 5, Steps: 10 | Train Loss: 1.066 Vali Loss: 1.313 Vali Acc: 0.378 Test Loss: 1.313 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.3502776622772217
Epoch: 6, Steps: 10 | Train Loss: 0.810 Vali Loss: 1.201 Vali Acc: 0.486 Test Loss: 1.201 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486474).  Saving model ...
Epoch: 7 cost time: 2.5755093097686768
Epoch: 7, Steps: 10 | Train Loss: 0.659 Vali Loss: 1.150 Vali Acc: 0.514 Test Loss: 1.150 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513502).  Saving model ...
Epoch: 8 cost time: 2.646392583847046
Epoch: 8, Steps: 10 | Train Loss: 0.502 Vali Loss: 1.085 Vali Acc: 0.581 Test Loss: 1.085 Test Acc: 0.581
Validation loss decreased (-0.513502 --> -0.581070).  Saving model ...
Epoch: 9 cost time: 2.745980978012085
Epoch: 9, Steps: 10 | Train Loss: 0.379 Vali Loss: 1.145 Vali Acc: 0.554 Test Loss: 1.145 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.215752124786377
Epoch: 10, Steps: 10 | Train Loss: 0.301 Vali Loss: 1.292 Vali Acc: 0.514 Test Loss: 1.292 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.7470579147338867
Epoch: 11, Steps: 10 | Train Loss: 0.181 Vali Loss: 1.375 Vali Acc: 0.486 Test Loss: 1.375 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.6659460067749023
Epoch: 12, Steps: 10 | Train Loss: 0.144 Vali Loss: 1.218 Vali Acc: 0.568 Test Loss: 1.218 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.6174697875976562
Epoch: 13, Steps: 10 | Train Loss: 0.063 Vali Loss: 1.379 Vali Acc: 0.514 Test Loss: 1.379 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.7767088413238525
Epoch: 14, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.352 Vali Acc: 0.527 Test Loss: 1.352 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.6859183311462402
Epoch: 15, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.328 Vali Acc: 0.662 Test Loss: 1.328 Test Acc: 0.662
Validation loss decreased (-0.581070 --> -0.662149).  Saving model ...
Epoch: 16 cost time: 2.6656692028045654
Epoch: 16, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.515 Vali Acc: 0.527 Test Loss: 1.515 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.3085880279541016
Epoch: 17, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.452 Vali Acc: 0.595 Test Loss: 1.452 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.5794529914855957
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.498 Vali Acc: 0.554 Test Loss: 1.498 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.666688919067383
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.452 Vali Acc: 0.595 Test Loss: 1.452 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.627284526824951
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.456 Vali Acc: 0.595 Test Loss: 1.456 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.0492827892303467
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.453 Vali Acc: 0.608 Test Loss: 1.453 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.659578561782837
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.452 Vali Acc: 0.608 Test Loss: 1.452 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.573793411254883
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.464 Vali Acc: 0.608 Test Loss: 1.464 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.381542921066284
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.466 Vali Acc: 0.595 Test Loss: 1.466 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.5453498363494873
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.470 Vali Acc: 0.608 Test Loss: 1.470 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6621621621621622
model parameter : 2895156
model size : 13.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.5737245082855225
Epoch: 1, Steps: 10 | Train Loss: 1.529 Vali Loss: 1.402 Vali Acc: 0.216 Test Loss: 1.402 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 2.723850965499878
Epoch: 2, Steps: 10 | Train Loss: 1.432 Vali Loss: 1.354 Vali Acc: 0.338 Test Loss: 1.354 Test Acc: 0.338
Validation loss decreased (-0.216202 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 2.5498526096343994
Epoch: 3, Steps: 10 | Train Loss: 1.283 Vali Loss: 1.287 Vali Acc: 0.365 Test Loss: 1.287 Test Acc: 0.365
Validation loss decreased (-0.337824 --> -0.364852).  Saving model ...
Epoch: 4 cost time: 2.8915042877197266
Epoch: 4, Steps: 10 | Train Loss: 1.141 Vali Loss: 1.167 Vali Acc: 0.514 Test Loss: 1.167 Test Acc: 0.514
Validation loss decreased (-0.364852 --> -0.513502).  Saving model ...
Epoch: 5 cost time: 2.667890787124634
Epoch: 5, Steps: 10 | Train Loss: 1.004 Vali Loss: 1.271 Vali Acc: 0.405 Test Loss: 1.271 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.5816426277160645
Epoch: 6, Steps: 10 | Train Loss: 0.779 Vali Loss: 1.133 Vali Acc: 0.500 Test Loss: 1.133 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.447887420654297
Epoch: 7, Steps: 10 | Train Loss: 0.701 Vali Loss: 1.189 Vali Acc: 0.514 Test Loss: 1.189 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.5966126918792725
Epoch: 8, Steps: 10 | Train Loss: 0.585 Vali Loss: 1.232 Vali Acc: 0.541 Test Loss: 1.232 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540528).  Saving model ...
Epoch: 9 cost time: 2.7075352668762207
Epoch: 9, Steps: 10 | Train Loss: 0.383 Vali Loss: 1.224 Vali Acc: 0.527 Test Loss: 1.224 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.025550603866577
Epoch: 10, Steps: 10 | Train Loss: 0.254 Vali Loss: 1.291 Vali Acc: 0.568 Test Loss: 1.291 Test Acc: 0.568
Validation loss decreased (-0.540528 --> -0.567555).  Saving model ...
Epoch: 11 cost time: 2.9079763889312744
Epoch: 11, Steps: 10 | Train Loss: 0.195 Vali Loss: 1.217 Vali Acc: 0.595 Test Loss: 1.217 Test Acc: 0.595
Validation loss decreased (-0.567555 --> -0.594582).  Saving model ...
Epoch: 12 cost time: 2.991654872894287
Epoch: 12, Steps: 10 | Train Loss: 0.112 Vali Loss: 1.471 Vali Acc: 0.527 Test Loss: 1.471 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.444331407546997
Epoch: 13, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.325 Vali Acc: 0.595 Test Loss: 1.325 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.3269243240356445
Epoch: 14, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.308 Vali Acc: 0.541 Test Loss: 1.308 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.1753008365631104
Epoch: 15, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.660 Vali Acc: 0.500 Test Loss: 1.660 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.431929111480713
Epoch: 16, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.382 Vali Acc: 0.554 Test Loss: 1.382 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.4227375984191895
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.421 Vali Acc: 0.568 Test Loss: 1.421 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.3563201427459717
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.402 Vali Acc: 0.595 Test Loss: 1.402 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.950472593307495
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.401 Vali Acc: 0.595 Test Loss: 1.401 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.6789498329162598
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.447 Vali Acc: 0.581 Test Loss: 1.447 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.876215696334839
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.423 Vali Acc: 0.581 Test Loss: 1.423 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 2887476
model size : 13.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.744356632232666
Epoch: 1, Steps: 10 | Train Loss: 1.376 Vali Loss: 1.333 Vali Acc: 0.459 Test Loss: 1.333 Test Acc: 0.459
Validation loss decreased (inf --> -0.459446).  Saving model ...
Epoch: 2 cost time: 2.7601158618927
Epoch: 2, Steps: 10 | Train Loss: 1.355 Vali Loss: 1.375 Vali Acc: 0.270 Test Loss: 1.375 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.051302671432495
Epoch: 3, Steps: 10 | Train Loss: 1.268 Vali Loss: 1.371 Vali Acc: 0.324 Test Loss: 1.371 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.6170570850372314
Epoch: 4, Steps: 10 | Train Loss: 1.079 Vali Loss: 1.349 Vali Acc: 0.432 Test Loss: 1.349 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.0569303035736084
Epoch: 5, Steps: 10 | Train Loss: 1.009 Vali Loss: 1.171 Vali Acc: 0.392 Test Loss: 1.171 Test Acc: 0.392
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.774080753326416
Epoch: 6, Steps: 10 | Train Loss: 0.799 Vali Loss: 1.104 Vali Acc: 0.554 Test Loss: 1.104 Test Acc: 0.554
Validation loss decreased (-0.459446 --> -0.554043).  Saving model ...
Epoch: 7 cost time: 2.485203266143799
Epoch: 7, Steps: 10 | Train Loss: 0.731 Vali Loss: 1.414 Vali Acc: 0.419 Test Loss: 1.414 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.5599138736724854
Epoch: 8, Steps: 10 | Train Loss: 0.571 Vali Loss: 1.199 Vali Acc: 0.500 Test Loss: 1.199 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.820133924484253
Epoch: 9, Steps: 10 | Train Loss: 0.388 Vali Loss: 1.125 Vali Acc: 0.514 Test Loss: 1.125 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.903905153274536
Epoch: 10, Steps: 10 | Train Loss: 0.307 Vali Loss: 1.277 Vali Acc: 0.554 Test Loss: 1.277 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.984970808029175
Epoch: 11, Steps: 10 | Train Loss: 0.198 Vali Loss: 1.205 Vali Acc: 0.500 Test Loss: 1.205 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.9312148094177246
Epoch: 12, Steps: 10 | Train Loss: 0.142 Vali Loss: 1.340 Vali Acc: 0.554 Test Loss: 1.340 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.681494951248169
Epoch: 13, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.146 Vali Acc: 0.541 Test Loss: 1.146 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.8879623413085938
Epoch: 14, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.252 Vali Acc: 0.568 Test Loss: 1.252 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567555).  Saving model ...
Epoch: 15 cost time: 2.6826748847961426
Epoch: 15, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.294 Vali Acc: 0.568 Test Loss: 1.294 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.734417200088501
Epoch: 16, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.270 Vali Acc: 0.568 Test Loss: 1.270 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.08383846282959
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.355 Vali Acc: 0.595 Test Loss: 1.355 Test Acc: 0.595
Validation loss decreased (-0.567555 --> -0.594581).  Saving model ...
Epoch: 18 cost time: 2.186929702758789
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.322 Vali Acc: 0.554 Test Loss: 1.322 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.4755945205688477
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.335 Vali Acc: 0.554 Test Loss: 1.335 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.9346468448638916
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.390 Vali Acc: 0.581 Test Loss: 1.390 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.1470327377319336
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.357 Vali Acc: 0.568 Test Loss: 1.357 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.639549732208252
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.381 Vali Acc: 0.595 Test Loss: 1.381 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.2500195503234863
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.382 Vali Acc: 0.581 Test Loss: 1.382 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.4254186153411865
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.368 Vali Acc: 0.568 Test Loss: 1.368 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.2662506103515625
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.388 Vali Acc: 0.568 Test Loss: 1.388 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.885012626647949
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.425 Vali Acc: 0.568 Test Loss: 1.425 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.0354673862457275
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.389 Vali Acc: 0.568 Test Loss: 1.389 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 2449972
model size : 11.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.0051305294036865
Epoch: 1, Steps: 10 | Train Loss: 1.500 Vali Loss: 1.506 Vali Acc: 0.230 Test Loss: 1.506 Test Acc: 0.230
Validation loss decreased (inf --> -0.229715).  Saving model ...
Epoch: 2 cost time: 3.093780755996704
Epoch: 2, Steps: 10 | Train Loss: 1.494 Vali Loss: 1.700 Vali Acc: 0.189 Test Loss: 1.700 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.1758573055267334
Epoch: 3, Steps: 10 | Train Loss: 1.358 Vali Loss: 1.290 Vali Acc: 0.405 Test Loss: 1.290 Test Acc: 0.405
Validation loss decreased (-0.229715 --> -0.405393).  Saving model ...
Epoch: 4 cost time: 2.9298648834228516
Epoch: 4, Steps: 10 | Train Loss: 1.243 Vali Loss: 1.383 Vali Acc: 0.392 Test Loss: 1.383 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.6324267387390137
Epoch: 5, Steps: 10 | Train Loss: 1.146 Vali Loss: 1.382 Vali Acc: 0.324 Test Loss: 1.382 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.003984212875366
Epoch: 6, Steps: 10 | Train Loss: 1.011 Vali Loss: 1.468 Vali Acc: 0.405 Test Loss: 1.468 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.567122459411621
Epoch: 7, Steps: 10 | Train Loss: 0.812 Vali Loss: 1.301 Vali Acc: 0.473 Test Loss: 1.301 Test Acc: 0.473
Validation loss decreased (-0.405393 --> -0.472960).  Saving model ...
Epoch: 8 cost time: 2.4623544216156006
Epoch: 8, Steps: 10 | Train Loss: 0.704 Vali Loss: 1.156 Vali Acc: 0.486 Test Loss: 1.156 Test Acc: 0.486
Validation loss decreased (-0.472960 --> -0.486475).  Saving model ...
Epoch: 9 cost time: 3.0191667079925537
Epoch: 9, Steps: 10 | Train Loss: 0.524 Vali Loss: 1.217 Vali Acc: 0.514 Test Loss: 1.217 Test Acc: 0.514
Validation loss decreased (-0.486475 --> -0.513501).  Saving model ...
Epoch: 10 cost time: 2.906048536300659
Epoch: 10, Steps: 10 | Train Loss: 0.388 Vali Loss: 1.411 Vali Acc: 0.500 Test Loss: 1.411 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.8641319274902344
Epoch: 11, Steps: 10 | Train Loss: 0.300 Vali Loss: 1.444 Vali Acc: 0.514 Test Loss: 1.444 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.1201579570770264
Epoch: 12, Steps: 10 | Train Loss: 0.160 Vali Loss: 1.299 Vali Acc: 0.527 Test Loss: 1.299 Test Acc: 0.527
Validation loss decreased (-0.513501 --> -0.527014).  Saving model ...
Epoch: 13 cost time: 2.808917999267578
Epoch: 13, Steps: 10 | Train Loss: 0.105 Vali Loss: 1.320 Vali Acc: 0.581 Test Loss: 1.320 Test Acc: 0.581
Validation loss decreased (-0.527014 --> -0.581068).  Saving model ...
Epoch: 14 cost time: 2.5039050579071045
Epoch: 14, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.429 Vali Acc: 0.500 Test Loss: 1.429 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.8569436073303223
Epoch: 15, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.517 Vali Acc: 0.500 Test Loss: 1.517 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.74818754196167
Epoch: 16, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.420 Vali Acc: 0.568 Test Loss: 1.420 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.4778826236724854
Epoch: 17, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.455 Vali Acc: 0.541 Test Loss: 1.455 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.0273540019989014
Epoch: 18, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.556 Vali Acc: 0.527 Test Loss: 1.556 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.306396722793579
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.519 Vali Acc: 0.527 Test Loss: 1.519 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.007042407989502
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.534 Vali Acc: 0.554 Test Loss: 1.534 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.990921974182129
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.579 Vali Acc: 0.527 Test Loss: 1.579 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.0117311477661133
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.562 Vali Acc: 0.541 Test Loss: 1.562 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.9554476737976074
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.550 Vali Acc: 0.541 Test Loss: 1.550 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 2442292
model size : 11.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.294631004333496
Epoch: 1, Steps: 10 | Train Loss: 1.462 Vali Loss: 1.422 Vali Acc: 0.351 Test Loss: 1.422 Test Acc: 0.351
Validation loss decreased (inf --> -0.351337).  Saving model ...
Epoch: 2 cost time: 2.444892168045044
Epoch: 2, Steps: 10 | Train Loss: 1.461 Vali Loss: 1.355 Vali Acc: 0.311 Test Loss: 1.355 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.6543080806732178
Epoch: 3, Steps: 10 | Train Loss: 1.316 Vali Loss: 1.359 Vali Acc: 0.459 Test Loss: 1.359 Test Acc: 0.459
Validation loss decreased (-0.351337 --> -0.459446).  Saving model ...
Epoch: 4 cost time: 2.403195858001709
Epoch: 4, Steps: 10 | Train Loss: 1.203 Vali Loss: 1.395 Vali Acc: 0.270 Test Loss: 1.395 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.228123188018799
Epoch: 5, Steps: 10 | Train Loss: 1.113 Vali Loss: 1.308 Vali Acc: 0.419 Test Loss: 1.308 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.2715046405792236
Epoch: 6, Steps: 10 | Train Loss: 1.031 Vali Loss: 1.318 Vali Acc: 0.405 Test Loss: 1.318 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.569655179977417
Epoch: 7, Steps: 10 | Train Loss: 0.899 Vali Loss: 1.375 Vali Acc: 0.378 Test Loss: 1.375 Test Acc: 0.378
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.2222015857696533
Epoch: 8, Steps: 10 | Train Loss: 0.728 Vali Loss: 1.301 Vali Acc: 0.486 Test Loss: 1.301 Test Acc: 0.486
Validation loss decreased (-0.459446 --> -0.486473).  Saving model ...
Epoch: 9 cost time: 2.5547311305999756
Epoch: 9, Steps: 10 | Train Loss: 0.665 Vali Loss: 1.418 Vali Acc: 0.486 Test Loss: 1.418 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.8780288696289062
Epoch: 10, Steps: 10 | Train Loss: 0.441 Vali Loss: 1.336 Vali Acc: 0.500 Test Loss: 1.336 Test Acc: 0.500
Validation loss decreased (-0.486473 --> -0.499987).  Saving model ...
Epoch: 11 cost time: 2.925161361694336
Epoch: 11, Steps: 10 | Train Loss: 0.324 Vali Loss: 1.289 Vali Acc: 0.486 Test Loss: 1.289 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.874645709991455
Epoch: 12, Steps: 10 | Train Loss: 0.204 Vali Loss: 1.220 Vali Acc: 0.581 Test Loss: 1.220 Test Acc: 0.581
Validation loss decreased (-0.499987 --> -0.581069).  Saving model ...
Epoch: 13 cost time: 2.6372056007385254
Epoch: 13, Steps: 10 | Train Loss: 0.132 Vali Loss: 1.276 Vali Acc: 0.527 Test Loss: 1.276 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.770775079727173
Epoch: 14, Steps: 10 | Train Loss: 0.073 Vali Loss: 1.314 Vali Acc: 0.608 Test Loss: 1.314 Test Acc: 0.608
Validation loss decreased (-0.581069 --> -0.608095).  Saving model ...
Epoch: 15 cost time: 2.6306097507476807
Epoch: 15, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.489 Vali Acc: 0.554 Test Loss: 1.489 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.7733192443847656
Epoch: 16, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.443 Vali Acc: 0.595 Test Loss: 1.443 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.6967732906341553
Epoch: 17, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.406 Vali Acc: 0.581 Test Loss: 1.406 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.7751455307006836
Epoch: 18, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.536 Vali Acc: 0.527 Test Loss: 1.536 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.1475186347961426
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.604 Vali Acc: 0.541 Test Loss: 1.604 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.962273597717285
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.534 Vali Acc: 0.581 Test Loss: 1.534 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.8119888305664062
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.565 Vali Acc: 0.568 Test Loss: 1.565 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.9184281826019287
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.584 Vali Acc: 0.554 Test Loss: 1.584 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.7311034202575684
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.586 Vali Acc: 0.568 Test Loss: 1.586 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.12249755859375
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.584 Vali Acc: 0.581 Test Loss: 1.584 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 2434612
model size : 11.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.988591432571411
Epoch: 1, Steps: 10 | Train Loss: 1.471 Vali Loss: 1.402 Vali Acc: 0.297 Test Loss: 1.402 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 2.197174072265625
Epoch: 2, Steps: 10 | Train Loss: 1.409 Vali Loss: 1.405 Vali Acc: 0.257 Test Loss: 1.405 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.4196219444274902
Epoch: 3, Steps: 10 | Train Loss: 1.367 Vali Loss: 1.455 Vali Acc: 0.446 Test Loss: 1.455 Test Acc: 0.446
Validation loss decreased (-0.297283 --> -0.445931).  Saving model ...
Epoch: 4 cost time: 1.7412915229797363
Epoch: 4, Steps: 10 | Train Loss: 1.241 Vali Loss: 1.352 Vali Acc: 0.338 Test Loss: 1.352 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.258664846420288
Epoch: 5, Steps: 10 | Train Loss: 1.133 Vali Loss: 1.267 Vali Acc: 0.459 Test Loss: 1.267 Test Acc: 0.459
Validation loss decreased (-0.445931 --> -0.459447).  Saving model ...
Epoch: 6 cost time: 2.0597572326660156
Epoch: 6, Steps: 10 | Train Loss: 1.012 Vali Loss: 1.760 Vali Acc: 0.311 Test Loss: 1.760 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.285653829574585
Epoch: 7, Steps: 10 | Train Loss: 0.888 Vali Loss: 1.179 Vali Acc: 0.459 Test Loss: 1.179 Test Acc: 0.459
Validation loss decreased (-0.459447 --> -0.459448).  Saving model ...
Epoch: 8 cost time: 2.2915000915527344
Epoch: 8, Steps: 10 | Train Loss: 0.616 Vali Loss: 1.130 Vali Acc: 0.527 Test Loss: 1.130 Test Acc: 0.527
Validation loss decreased (-0.459448 --> -0.527016).  Saving model ...
Epoch: 9 cost time: 2.416186571121216
Epoch: 9, Steps: 10 | Train Loss: 0.517 Vali Loss: 1.448 Vali Acc: 0.432 Test Loss: 1.448 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.4295287132263184
Epoch: 10, Steps: 10 | Train Loss: 0.403 Vali Loss: 1.374 Vali Acc: 0.500 Test Loss: 1.374 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.397286891937256
Epoch: 11, Steps: 10 | Train Loss: 0.289 Vali Loss: 1.100 Vali Acc: 0.568 Test Loss: 1.100 Test Acc: 0.568
Validation loss decreased (-0.527016 --> -0.567557).  Saving model ...
Epoch: 12 cost time: 2.866990327835083
Epoch: 12, Steps: 10 | Train Loss: 0.158 Vali Loss: 1.120 Vali Acc: 0.622 Test Loss: 1.120 Test Acc: 0.622
Validation loss decreased (-0.567557 --> -0.621610).  Saving model ...
Epoch: 13 cost time: 2.59940505027771
Epoch: 13, Steps: 10 | Train Loss: 0.111 Vali Loss: 1.307 Vali Acc: 0.581 Test Loss: 1.307 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.48476243019104
Epoch: 14, Steps: 10 | Train Loss: 0.071 Vali Loss: 1.324 Vali Acc: 0.595 Test Loss: 1.324 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8465163707733154
Epoch: 15, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.295 Vali Acc: 0.622 Test Loss: 1.295 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.1078147888183594
Epoch: 16, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.218 Vali Acc: 0.635 Test Loss: 1.218 Test Acc: 0.635
Validation loss decreased (-0.621610 --> -0.635123).  Saving model ...
Epoch: 17 cost time: 2.044079542160034
Epoch: 17, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.341 Vali Acc: 0.635 Test Loss: 1.341 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.2424981594085693
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.349 Vali Acc: 0.635 Test Loss: 1.349 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.554025888442993
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.407 Vali Acc: 0.581 Test Loss: 1.407 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.9650697708129883
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.385 Vali Acc: 0.595 Test Loss: 1.385 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.424705743789673
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.402 Vali Acc: 0.581 Test Loss: 1.402 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.1878697872161865
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.408 Vali Acc: 0.595 Test Loss: 1.408 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.6681861877441406
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.391 Vali Acc: 0.608 Test Loss: 1.391 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.6354031562805176
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.382 Vali Acc: 0.608 Test Loss: 1.382 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.3837108612060547
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.422 Vali Acc: 0.608 Test Loss: 1.422 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.4624547958374023
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.410 Vali Acc: 0.608 Test Loss: 1.410 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 2426932
model size : 11.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.633126258850098
Epoch: 1, Steps: 10 | Train Loss: 1.501 Vali Loss: 1.534 Vali Acc: 0.189 Test Loss: 1.534 Test Acc: 0.189
Validation loss decreased (inf --> -0.189174).  Saving model ...
Epoch: 2 cost time: 2.9398818016052246
Epoch: 2, Steps: 10 | Train Loss: 1.437 Vali Loss: 1.350 Vali Acc: 0.378 Test Loss: 1.350 Test Acc: 0.378
Validation loss decreased (-0.189174 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 3.1291937828063965
Epoch: 3, Steps: 10 | Train Loss: 1.317 Vali Loss: 1.428 Vali Acc: 0.351 Test Loss: 1.428 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.1059727668762207
Epoch: 4, Steps: 10 | Train Loss: 1.193 Vali Loss: 1.431 Vali Acc: 0.284 Test Loss: 1.431 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.793311357498169
Epoch: 5, Steps: 10 | Train Loss: 1.036 Vali Loss: 1.232 Vali Acc: 0.365 Test Loss: 1.232 Test Acc: 0.365
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.119542121887207
Epoch: 6, Steps: 10 | Train Loss: 0.889 Vali Loss: 1.569 Vali Acc: 0.270 Test Loss: 1.569 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.764904737472534
Epoch: 7, Steps: 10 | Train Loss: 0.805 Vali Loss: 1.197 Vali Acc: 0.459 Test Loss: 1.197 Test Acc: 0.459
Validation loss decreased (-0.378365 --> -0.459447).  Saving model ...
Epoch: 8 cost time: 2.861584186553955
Epoch: 8, Steps: 10 | Train Loss: 0.601 Vali Loss: 1.393 Vali Acc: 0.365 Test Loss: 1.393 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.4374947547912598
Epoch: 9, Steps: 10 | Train Loss: 0.536 Vali Loss: 1.232 Vali Acc: 0.486 Test Loss: 1.232 Test Acc: 0.486
Validation loss decreased (-0.459447 --> -0.486474).  Saving model ...
Epoch: 10 cost time: 2.5780789852142334
Epoch: 10, Steps: 10 | Train Loss: 0.357 Vali Loss: 1.328 Vali Acc: 0.554 Test Loss: 1.328 Test Acc: 0.554
Validation loss decreased (-0.486474 --> -0.554041).  Saving model ...
Epoch: 11 cost time: 1.8796815872192383
Epoch: 11, Steps: 10 | Train Loss: 0.275 Vali Loss: 1.254 Vali Acc: 0.473 Test Loss: 1.254 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.920722723007202
Epoch: 12, Steps: 10 | Train Loss: 0.253 Vali Loss: 1.376 Vali Acc: 0.486 Test Loss: 1.376 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.632631540298462
Epoch: 13, Steps: 10 | Train Loss: 0.153 Vali Loss: 1.308 Vali Acc: 0.541 Test Loss: 1.308 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.0441858768463135
Epoch: 14, Steps: 10 | Train Loss: 0.095 Vali Loss: 1.304 Vali Acc: 0.514 Test Loss: 1.304 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.4681601524353027
Epoch: 15, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.430 Vali Acc: 0.554 Test Loss: 1.430 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.856110095977783
Epoch: 16, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.426 Vali Acc: 0.554 Test Loss: 1.426 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.998223066329956
Epoch: 17, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.448 Vali Acc: 0.541 Test Loss: 1.448 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.771693468093872
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.505 Vali Acc: 0.541 Test Loss: 1.505 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.6104178428649902
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.527 Vali Acc: 0.554 Test Loss: 1.527 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.4064674377441406
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.518 Vali Acc: 0.527 Test Loss: 1.518 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 2219700
model size : 11.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.961672067642212
Epoch: 1, Steps: 10 | Train Loss: 1.526 Vali Loss: 1.388 Vali Acc: 0.270 Test Loss: 1.388 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 2.8456029891967773
Epoch: 2, Steps: 10 | Train Loss: 1.421 Vali Loss: 1.306 Vali Acc: 0.378 Test Loss: 1.306 Test Acc: 0.378
Validation loss decreased (-0.270256 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 2.256115436553955
Epoch: 3, Steps: 10 | Train Loss: 1.333 Vali Loss: 1.382 Vali Acc: 0.432 Test Loss: 1.382 Test Acc: 0.432
Validation loss decreased (-0.378365 --> -0.432419).  Saving model ...
Epoch: 4 cost time: 2.651348114013672
Epoch: 4, Steps: 10 | Train Loss: 1.227 Vali Loss: 1.242 Vali Acc: 0.500 Test Loss: 1.242 Test Acc: 0.500
Validation loss decreased (-0.432419 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 2.413705348968506
Epoch: 5, Steps: 10 | Train Loss: 1.037 Vali Loss: 1.253 Vali Acc: 0.514 Test Loss: 1.253 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513501).  Saving model ...
Epoch: 6 cost time: 2.4607834815979004
Epoch: 6, Steps: 10 | Train Loss: 0.948 Vali Loss: 1.135 Vali Acc: 0.527 Test Loss: 1.135 Test Acc: 0.527
Validation loss decreased (-0.513501 --> -0.527016).  Saving model ...
Epoch: 7 cost time: 2.669402599334717
Epoch: 7, Steps: 10 | Train Loss: 0.728 Vali Loss: 1.166 Vali Acc: 0.514 Test Loss: 1.166 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.240548849105835
Epoch: 8, Steps: 10 | Train Loss: 0.617 Vali Loss: 1.150 Vali Acc: 0.527 Test Loss: 1.150 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.383946657180786
Epoch: 9, Steps: 10 | Train Loss: 0.522 Vali Loss: 1.333 Vali Acc: 0.486 Test Loss: 1.333 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.7371580600738525
Epoch: 10, Steps: 10 | Train Loss: 0.340 Vali Loss: 1.166 Vali Acc: 0.541 Test Loss: 1.166 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540529).  Saving model ...
Epoch: 11 cost time: 2.688208818435669
Epoch: 11, Steps: 10 | Train Loss: 0.270 Vali Loss: 1.164 Vali Acc: 0.514 Test Loss: 1.164 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.2064473628997803
Epoch: 12, Steps: 10 | Train Loss: 0.217 Vali Loss: 1.371 Vali Acc: 0.514 Test Loss: 1.371 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.637202262878418
Epoch: 13, Steps: 10 | Train Loss: 0.125 Vali Loss: 1.351 Vali Acc: 0.527 Test Loss: 1.351 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.570190191268921
Epoch: 14, Steps: 10 | Train Loss: 0.080 Vali Loss: 1.315 Vali Acc: 0.514 Test Loss: 1.315 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.8104028701782227
Epoch: 15, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.341 Vali Acc: 0.568 Test Loss: 1.341 Test Acc: 0.568
Validation loss decreased (-0.540529 --> -0.567554).  Saving model ...
Epoch: 16 cost time: 3.028947353363037
Epoch: 16, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.342 Vali Acc: 0.554 Test Loss: 1.342 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.132082462310791
Epoch: 17, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.477 Vali Acc: 0.554 Test Loss: 1.477 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.3504512310028076
Epoch: 18, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.488 Vali Acc: 0.554 Test Loss: 1.488 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.060856342315674
Epoch: 19, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.523 Vali Acc: 0.568 Test Loss: 1.523 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.6275041103363037
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.517 Vali Acc: 0.568 Test Loss: 1.517 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.7791571617126465
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.521 Vali Acc: 0.568 Test Loss: 1.521 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.1996560096740723
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.603 Vali Acc: 0.581 Test Loss: 1.603 Test Acc: 0.581
Validation loss decreased (-0.567554 --> -0.581065).  Saving model ...
Epoch: 23 cost time: 2.6456151008605957
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.568 Vali Acc: 0.581 Test Loss: 1.568 Test Acc: 0.581
Validation loss decreased (-0.581065 --> -0.581065).  Saving model ...
Epoch: 24 cost time: 2.46280574798584
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.535 Vali Acc: 0.554 Test Loss: 1.535 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.0142133235931396
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.567 Vali Acc: 0.568 Test Loss: 1.567 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.8847830295562744
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.564 Vali Acc: 0.581 Test Loss: 1.564 Test Acc: 0.581
Validation loss decreased (-0.581065 --> -0.581065).  Saving model ...
Epoch: 27 cost time: 2.365079164505005
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.567 Vali Acc: 0.595 Test Loss: 1.567 Test Acc: 0.595
Validation loss decreased (-0.581065 --> -0.594579).  Saving model ...
Epoch: 28 cost time: 2.9429938793182373
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.579 Vali Acc: 0.595 Test Loss: 1.579 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.2458386421203613
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.606 Vali Acc: 0.581 Test Loss: 1.606 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.655330181121826
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.600 Vali Acc: 0.568 Test Loss: 1.600 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.445866823196411
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.594 Vali Acc: 0.581 Test Loss: 1.594 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.385814666748047
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.598 Vali Acc: 0.595 Test Loss: 1.598 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.3083958625793457
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.624 Vali Acc: 0.581 Test Loss: 1.624 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.6407063007354736
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.633 Vali Acc: 0.581 Test Loss: 1.633 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 2.350653886795044
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.631 Vali Acc: 0.581 Test Loss: 1.631 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 2.440573215484619
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.646 Vali Acc: 0.581 Test Loss: 1.646 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 2.9470462799072266
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.639 Vali Acc: 0.595 Test Loss: 1.639 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 2212020
model size : 11.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.8782799243927
Epoch: 1, Steps: 10 | Train Loss: 1.492 Vali Loss: 1.320 Vali Acc: 0.392 Test Loss: 1.320 Test Acc: 0.392
Validation loss decreased (inf --> -0.391879).  Saving model ...
Epoch: 2 cost time: 2.377523183822632
Epoch: 2, Steps: 10 | Train Loss: 1.395 Vali Loss: 1.473 Vali Acc: 0.203 Test Loss: 1.473 Test Acc: 0.203
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.879167318344116
Epoch: 3, Steps: 10 | Train Loss: 1.300 Vali Loss: 1.358 Vali Acc: 0.257 Test Loss: 1.358 Test Acc: 0.257
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.634594440460205
Epoch: 4, Steps: 10 | Train Loss: 1.220 Vali Loss: 1.371 Vali Acc: 0.311 Test Loss: 1.371 Test Acc: 0.311
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.6568219661712646
Epoch: 5, Steps: 10 | Train Loss: 1.016 Vali Loss: 1.236 Vali Acc: 0.473 Test Loss: 1.236 Test Acc: 0.473
Validation loss decreased (-0.391879 --> -0.472961).  Saving model ...
Epoch: 6 cost time: 1.8145074844360352
Epoch: 6, Steps: 10 | Train Loss: 1.022 Vali Loss: 1.644 Vali Acc: 0.324 Test Loss: 1.644 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9312231540679932
Epoch: 7, Steps: 10 | Train Loss: 1.011 Vali Loss: 1.266 Vali Acc: 0.473 Test Loss: 1.266 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.44258189201355
Epoch: 8, Steps: 10 | Train Loss: 0.721 Vali Loss: 1.255 Vali Acc: 0.500 Test Loss: 1.255 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499987).  Saving model ...
Epoch: 9 cost time: 2.416921377182007
Epoch: 9, Steps: 10 | Train Loss: 0.618 Vali Loss: 1.140 Vali Acc: 0.527 Test Loss: 1.140 Test Acc: 0.527
Validation loss decreased (-0.499987 --> -0.527016).  Saving model ...
Epoch: 10 cost time: 2.228914260864258
Epoch: 10, Steps: 10 | Train Loss: 0.498 Vali Loss: 1.649 Vali Acc: 0.378 Test Loss: 1.649 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.301694869995117
Epoch: 11, Steps: 10 | Train Loss: 0.446 Vali Loss: 1.106 Vali Acc: 0.568 Test Loss: 1.106 Test Acc: 0.568
Validation loss decreased (-0.527016 --> -0.567557).  Saving model ...
Epoch: 12 cost time: 2.3954594135284424
Epoch: 12, Steps: 10 | Train Loss: 0.273 Vali Loss: 1.214 Vali Acc: 0.554 Test Loss: 1.214 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.4074273109436035
Epoch: 13, Steps: 10 | Train Loss: 0.159 Vali Loss: 1.266 Vali Acc: 0.581 Test Loss: 1.266 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581068).  Saving model ...
Epoch: 14 cost time: 2.766756296157837
Epoch: 14, Steps: 10 | Train Loss: 0.089 Vali Loss: 1.195 Vali Acc: 0.554 Test Loss: 1.195 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.8889057636260986
Epoch: 15, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.329 Vali Acc: 0.581 Test Loss: 1.329 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.380047082901001
Epoch: 16, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.464 Vali Acc: 0.554 Test Loss: 1.464 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.9846041202545166
Epoch: 17, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.296 Vali Acc: 0.554 Test Loss: 1.296 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.757512092590332
Epoch: 18, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.375 Vali Acc: 0.554 Test Loss: 1.375 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.000157356262207
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.371 Vali Acc: 0.581 Test Loss: 1.371 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.077882766723633
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.389 Vali Acc: 0.581 Test Loss: 1.389 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.5545034408569336
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.399 Vali Acc: 0.581 Test Loss: 1.399 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.0935800075531006
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.412 Vali Acc: 0.595 Test Loss: 1.412 Test Acc: 0.595
Validation loss decreased (-0.581068 --> -0.594580).  Saving model ...
Epoch: 23 cost time: 3.0241494178771973
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.438 Vali Acc: 0.581 Test Loss: 1.438 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.0019278526306152
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.432 Vali Acc: 0.581 Test Loss: 1.432 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.8446686267852783
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.457 Vali Acc: 0.581 Test Loss: 1.457 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.5316739082336426
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.467 Vali Acc: 0.581 Test Loss: 1.467 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.955610752105713
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.467 Vali Acc: 0.595 Test Loss: 1.467 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.373124361038208
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.466 Vali Acc: 0.581 Test Loss: 1.466 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.30375599861145
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.487 Vali Acc: 0.595 Test Loss: 1.487 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.7927680015563965
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.485 Vali Acc: 0.581 Test Loss: 1.485 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 3.0742452144622803
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.498 Vali Acc: 0.595 Test Loss: 1.498 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 3.3388025760650635
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.502 Vali Acc: 0.595 Test Loss: 1.502 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 2204340
model size : 11.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.643970012664795
Epoch: 1, Steps: 10 | Train Loss: 1.485 Vali Loss: 1.562 Vali Acc: 0.135 Test Loss: 1.562 Test Acc: 0.135
Validation loss decreased (inf --> -0.135120).  Saving model ...
Epoch: 2 cost time: 2.8943490982055664
Epoch: 2, Steps: 10 | Train Loss: 1.492 Vali Loss: 1.380 Vali Acc: 0.378 Test Loss: 1.380 Test Acc: 0.378
Validation loss decreased (-0.135120 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 2.866452693939209
Epoch: 3, Steps: 10 | Train Loss: 1.389 Vali Loss: 1.584 Vali Acc: 0.203 Test Loss: 1.584 Test Acc: 0.203
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.464374303817749
Epoch: 4, Steps: 10 | Train Loss: 1.304 Vali Loss: 1.278 Vali Acc: 0.405 Test Loss: 1.278 Test Acc: 0.405
Validation loss decreased (-0.378365 --> -0.405393).  Saving model ...
Epoch: 5 cost time: 2.775341272354126
Epoch: 5, Steps: 10 | Train Loss: 1.086 Vali Loss: 1.331 Vali Acc: 0.351 Test Loss: 1.331 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.3534440994262695
Epoch: 6, Steps: 10 | Train Loss: 0.966 Vali Loss: 1.306 Vali Acc: 0.405 Test Loss: 1.306 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.8703854084014893
Epoch: 7, Steps: 10 | Train Loss: 0.820 Vali Loss: 1.309 Vali Acc: 0.419 Test Loss: 1.309 Test Acc: 0.419
Validation loss decreased (-0.405393 --> -0.418906).  Saving model ...
Epoch: 8 cost time: 2.7845492362976074
Epoch: 8, Steps: 10 | Train Loss: 0.689 Vali Loss: 1.241 Vali Acc: 0.432 Test Loss: 1.241 Test Acc: 0.432
Validation loss decreased (-0.418906 --> -0.432420).  Saving model ...
Epoch: 9 cost time: 2.8514318466186523
Epoch: 9, Steps: 10 | Train Loss: 0.638 Vali Loss: 1.108 Vali Acc: 0.446 Test Loss: 1.108 Test Acc: 0.446
Validation loss decreased (-0.432420 --> -0.445935).  Saving model ...
Epoch: 10 cost time: 2.721991539001465
Epoch: 10, Steps: 10 | Train Loss: 0.451 Vali Loss: 1.193 Vali Acc: 0.473 Test Loss: 1.193 Test Acc: 0.473
Validation loss decreased (-0.445935 --> -0.472961).  Saving model ...
Epoch: 11 cost time: 2.608635902404785
Epoch: 11, Steps: 10 | Train Loss: 0.277 Vali Loss: 1.139 Vali Acc: 0.527 Test Loss: 1.139 Test Acc: 0.527
Validation loss decreased (-0.472961 --> -0.527016).  Saving model ...
Epoch: 12 cost time: 2.9686408042907715
Epoch: 12, Steps: 10 | Train Loss: 0.235 Vali Loss: 1.167 Vali Acc: 0.514 Test Loss: 1.167 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.8408243656158447
Epoch: 13, Steps: 10 | Train Loss: 0.152 Vali Loss: 1.253 Vali Acc: 0.554 Test Loss: 1.253 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554042).  Saving model ...
Epoch: 14 cost time: 2.571000099182129
Epoch: 14, Steps: 10 | Train Loss: 0.076 Vali Loss: 1.327 Vali Acc: 0.500 Test Loss: 1.327 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.318317413330078
Epoch: 15, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.500 Vali Acc: 0.500 Test Loss: 1.500 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.870047092437744
Epoch: 16, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.291 Vali Acc: 0.581 Test Loss: 1.291 Test Acc: 0.581
Validation loss decreased (-0.554042 --> -0.581068).  Saving model ...
Epoch: 17 cost time: 2.017191171646118
Epoch: 17, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.407 Vali Acc: 0.541 Test Loss: 1.407 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7169878482818604
Epoch: 18, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.338 Vali Acc: 0.581 Test Loss: 1.338 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.468507766723633
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.405 Vali Acc: 0.568 Test Loss: 1.405 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.400123357772827
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.456 Vali Acc: 0.568 Test Loss: 1.456 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.9193205833435059
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.417 Vali Acc: 0.568 Test Loss: 1.417 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.0616579055786133
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.443 Vali Acc: 0.581 Test Loss: 1.443 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.8279964923858643
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.463 Vali Acc: 0.581 Test Loss: 1.463 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.4940311908721924
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.468 Vali Acc: 0.568 Test Loss: 1.468 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.1475348472595215
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.469 Vali Acc: 0.581 Test Loss: 1.469 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.399073362350464
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.483 Vali Acc: 0.581 Test Loss: 1.483 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 2196660
model size : 10.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.435268878936768
Epoch: 1, Steps: 10 | Train Loss: 1.464 Vali Loss: 1.323 Vali Acc: 0.365 Test Loss: 1.323 Test Acc: 0.365
Validation loss decreased (inf --> -0.364852).  Saving model ...
Epoch: 2 cost time: 3.0534069538116455
Epoch: 2, Steps: 10 | Train Loss: 1.422 Vali Loss: 1.347 Vali Acc: 0.351 Test Loss: 1.347 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.888575553894043
Epoch: 3, Steps: 10 | Train Loss: 1.322 Vali Loss: 1.274 Vali Acc: 0.486 Test Loss: 1.274 Test Acc: 0.486
Validation loss decreased (-0.364852 --> -0.486474).  Saving model ...
Epoch: 4 cost time: 2.5713536739349365
Epoch: 4, Steps: 10 | Train Loss: 1.291 Vali Loss: 1.290 Vali Acc: 0.419 Test Loss: 1.290 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5352349281311035
Epoch: 5, Steps: 10 | Train Loss: 1.136 Vali Loss: 1.275 Vali Acc: 0.338 Test Loss: 1.275 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.2025537490844727
Epoch: 6, Steps: 10 | Train Loss: 0.957 Vali Loss: 1.151 Vali Acc: 0.514 Test Loss: 1.151 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513502).  Saving model ...
Epoch: 7 cost time: 2.0454492568969727
Epoch: 7, Steps: 10 | Train Loss: 0.860 Vali Loss: 1.159 Vali Acc: 0.527 Test Loss: 1.159 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527015).  Saving model ...
Epoch: 8 cost time: 2.8954014778137207
Epoch: 8, Steps: 10 | Train Loss: 0.801 Vali Loss: 1.126 Vali Acc: 0.527 Test Loss: 1.126 Test Acc: 0.527
Validation loss decreased (-0.527015 --> -0.527016).  Saving model ...
Epoch: 9 cost time: 2.106516122817993
Epoch: 9, Steps: 10 | Train Loss: 0.613 Vali Loss: 1.068 Vali Acc: 0.541 Test Loss: 1.068 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540530).  Saving model ...
Epoch: 10 cost time: 3.127340078353882
Epoch: 10, Steps: 10 | Train Loss: 0.454 Vali Loss: 1.097 Vali Acc: 0.554 Test Loss: 1.097 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554043).  Saving model ...
Epoch: 11 cost time: 2.128258466720581
Epoch: 11, Steps: 10 | Train Loss: 0.377 Vali Loss: 1.100 Vali Acc: 0.581 Test Loss: 1.100 Test Acc: 0.581
Validation loss decreased (-0.554043 --> -0.581070).  Saving model ...
Epoch: 12 cost time: 2.209643840789795
Epoch: 12, Steps: 10 | Train Loss: 0.260 Vali Loss: 1.081 Vali Acc: 0.568 Test Loss: 1.081 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.9639580249786377
Epoch: 13, Steps: 10 | Train Loss: 0.211 Vali Loss: 1.200 Vali Acc: 0.541 Test Loss: 1.200 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.7762794494628906
Epoch: 14, Steps: 10 | Train Loss: 0.147 Vali Loss: 1.155 Vali Acc: 0.554 Test Loss: 1.155 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.7846081256866455
Epoch: 15, Steps: 10 | Train Loss: 0.084 Vali Loss: 1.154 Vali Acc: 0.527 Test Loss: 1.154 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.7061917781829834
Epoch: 16, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.310 Vali Acc: 0.500 Test Loss: 1.310 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.252617597579956
Epoch: 17, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.228 Vali Acc: 0.527 Test Loss: 1.228 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.0113940238952637
Epoch: 18, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.313 Vali Acc: 0.500 Test Loss: 1.313 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.136608362197876
Epoch: 19, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.280 Vali Acc: 0.500 Test Loss: 1.280 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.898494005203247
Epoch: 20, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.298 Vali Acc: 0.486 Test Loss: 1.298 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.68392276763916
Epoch: 21, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.328 Vali Acc: 0.500 Test Loss: 1.328 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 1460660
model size : 6.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.534684658050537
Epoch: 1, Steps: 10 | Train Loss: 1.443 Vali Loss: 1.411 Vali Acc: 0.257 Test Loss: 1.411 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 1.951364278793335
Epoch: 2, Steps: 10 | Train Loss: 1.448 Vali Loss: 1.347 Vali Acc: 0.297 Test Loss: 1.347 Test Acc: 0.297
Validation loss decreased (-0.256743 --> -0.297284).  Saving model ...
Epoch: 3 cost time: 2.066622495651245
Epoch: 3, Steps: 10 | Train Loss: 1.409 Vali Loss: 1.280 Vali Acc: 0.378 Test Loss: 1.280 Test Acc: 0.378
Validation loss decreased (-0.297284 --> -0.378366).  Saving model ...
Epoch: 4 cost time: 2.1488800048828125
Epoch: 4, Steps: 10 | Train Loss: 1.227 Vali Loss: 1.350 Vali Acc: 0.351 Test Loss: 1.350 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.11629581451416
Epoch: 5, Steps: 10 | Train Loss: 1.152 Vali Loss: 1.194 Vali Acc: 0.500 Test Loss: 1.194 Test Acc: 0.500
Validation loss decreased (-0.378366 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 2.40299654006958
Epoch: 6, Steps: 10 | Train Loss: 0.991 Vali Loss: 1.106 Vali Acc: 0.527 Test Loss: 1.106 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527016).  Saving model ...
Epoch: 7 cost time: 3.057570695877075
Epoch: 7, Steps: 10 | Train Loss: 0.873 Vali Loss: 1.320 Vali Acc: 0.405 Test Loss: 1.320 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.6921043395996094
Epoch: 8, Steps: 10 | Train Loss: 0.713 Vali Loss: 1.070 Vali Acc: 0.541 Test Loss: 1.070 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540530).  Saving model ...
Epoch: 9 cost time: 2.2817153930664062
Epoch: 9, Steps: 10 | Train Loss: 0.573 Vali Loss: 1.106 Vali Acc: 0.500 Test Loss: 1.106 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.013951063156128
Epoch: 10, Steps: 10 | Train Loss: 0.498 Vali Loss: 1.131 Vali Acc: 0.541 Test Loss: 1.131 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.658845901489258
Epoch: 11, Steps: 10 | Train Loss: 0.382 Vali Loss: 1.096 Vali Acc: 0.568 Test Loss: 1.096 Test Acc: 0.568
Validation loss decreased (-0.540530 --> -0.567557).  Saving model ...
Epoch: 12 cost time: 3.0267326831817627
Epoch: 12, Steps: 10 | Train Loss: 0.300 Vali Loss: 1.084 Vali Acc: 0.581 Test Loss: 1.084 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581070).  Saving model ...
Epoch: 13 cost time: 2.004075050354004
Epoch: 13, Steps: 10 | Train Loss: 0.196 Vali Loss: 1.110 Vali Acc: 0.608 Test Loss: 1.110 Test Acc: 0.608
Validation loss decreased (-0.581070 --> -0.608097).  Saving model ...
Epoch: 14 cost time: 2.8472843170166016
Epoch: 14, Steps: 10 | Train Loss: 0.138 Vali Loss: 1.152 Vali Acc: 0.635 Test Loss: 1.152 Test Acc: 0.635
Validation loss decreased (-0.608097 --> -0.635124).  Saving model ...
Epoch: 15 cost time: 3.031461000442505
Epoch: 15, Steps: 10 | Train Loss: 0.086 Vali Loss: 1.137 Vali Acc: 0.595 Test Loss: 1.137 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.693641185760498
Epoch: 16, Steps: 10 | Train Loss: 0.061 Vali Loss: 1.210 Vali Acc: 0.541 Test Loss: 1.210 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.8734092712402344
Epoch: 17, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.295 Vali Acc: 0.527 Test Loss: 1.295 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.054124593734741
Epoch: 18, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.178 Vali Acc: 0.554 Test Loss: 1.178 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.516035556793213
Epoch: 19, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.275 Vali Acc: 0.541 Test Loss: 1.275 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.911240577697754
Epoch: 20, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.268 Vali Acc: 0.554 Test Loss: 1.268 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.362910032272339
Epoch: 21, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.269 Vali Acc: 0.541 Test Loss: 1.269 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.616598129272461
Epoch: 22, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.298 Vali Acc: 0.541 Test Loss: 1.298 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.003082275390625
Epoch: 23, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.338 Vali Acc: 0.554 Test Loss: 1.338 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.014671802520752
Epoch: 24, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.330 Vali Acc: 0.554 Test Loss: 1.330 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 1456820
model size : 6.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.360556364059448
Epoch: 1, Steps: 10 | Train Loss: 1.413 Vali Loss: 1.340 Vali Acc: 0.405 Test Loss: 1.340 Test Acc: 0.405
Validation loss decreased (inf --> -0.405392).  Saving model ...
Epoch: 2 cost time: 3.4616174697875977
Epoch: 2, Steps: 10 | Train Loss: 1.421 Vali Loss: 1.334 Vali Acc: 0.392 Test Loss: 1.334 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.555673599243164
Epoch: 3, Steps: 10 | Train Loss: 1.338 Vali Loss: 1.350 Vali Acc: 0.378 Test Loss: 1.350 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.99120831489563
Epoch: 4, Steps: 10 | Train Loss: 1.244 Vali Loss: 1.309 Vali Acc: 0.392 Test Loss: 1.309 Test Acc: 0.392
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.443603515625
Epoch: 5, Steps: 10 | Train Loss: 1.154 Vali Loss: 1.261 Vali Acc: 0.459 Test Loss: 1.261 Test Acc: 0.459
Validation loss decreased (-0.405392 --> -0.459447).  Saving model ...
Epoch: 6 cost time: 2.5536134243011475
Epoch: 6, Steps: 10 | Train Loss: 1.005 Vali Loss: 1.181 Vali Acc: 0.514 Test Loss: 1.181 Test Acc: 0.514
Validation loss decreased (-0.459447 --> -0.513502).  Saving model ...
Epoch: 7 cost time: 3.282315969467163
Epoch: 7, Steps: 10 | Train Loss: 0.830 Vali Loss: 1.155 Vali Acc: 0.514 Test Loss: 1.155 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513502).  Saving model ...
Epoch: 8 cost time: 2.8338592052459717
Epoch: 8, Steps: 10 | Train Loss: 0.698 Vali Loss: 1.198 Vali Acc: 0.527 Test Loss: 1.198 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527015).  Saving model ...
Epoch: 9 cost time: 2.1568713188171387
Epoch: 9, Steps: 10 | Train Loss: 0.593 Vali Loss: 1.140 Vali Acc: 0.514 Test Loss: 1.140 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1620004177093506
Epoch: 10, Steps: 10 | Train Loss: 0.496 Vali Loss: 1.182 Vali Acc: 0.554 Test Loss: 1.182 Test Acc: 0.554
Validation loss decreased (-0.527015 --> -0.554042).  Saving model ...
Epoch: 11 cost time: 2.6221911907196045
Epoch: 11, Steps: 10 | Train Loss: 0.403 Vali Loss: 1.316 Vali Acc: 0.446 Test Loss: 1.316 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.602116823196411
Epoch: 12, Steps: 10 | Train Loss: 0.314 Vali Loss: 1.134 Vali Acc: 0.568 Test Loss: 1.134 Test Acc: 0.568
Validation loss decreased (-0.554042 --> -0.567556).  Saving model ...
Epoch: 13 cost time: 2.6824140548706055
Epoch: 13, Steps: 10 | Train Loss: 0.224 Vali Loss: 1.175 Vali Acc: 0.541 Test Loss: 1.175 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.8781063556671143
Epoch: 14, Steps: 10 | Train Loss: 0.154 Vali Loss: 1.193 Vali Acc: 0.514 Test Loss: 1.193 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.1994621753692627
Epoch: 15, Steps: 10 | Train Loss: 0.105 Vali Loss: 1.185 Vali Acc: 0.608 Test Loss: 1.185 Test Acc: 0.608
Validation loss decreased (-0.567556 --> -0.608096).  Saving model ...
Epoch: 16 cost time: 2.032399892807007
Epoch: 16, Steps: 10 | Train Loss: 0.065 Vali Loss: 1.273 Vali Acc: 0.527 Test Loss: 1.273 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.125218391418457
Epoch: 17, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.208 Vali Acc: 0.622 Test Loss: 1.208 Test Acc: 0.622
Validation loss decreased (-0.608096 --> -0.621610).  Saving model ...
Epoch: 18 cost time: 2.388756513595581
Epoch: 18, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.263 Vali Acc: 0.568 Test Loss: 1.263 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.2303106784820557
Epoch: 19, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.231 Vali Acc: 0.649 Test Loss: 1.231 Test Acc: 0.649
Validation loss decreased (-0.621610 --> -0.648636).  Saving model ...
Epoch: 20 cost time: 2.3636977672576904
Epoch: 20, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.309 Vali Acc: 0.608 Test Loss: 1.309 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.7921900749206543
Epoch: 21, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.225 Vali Acc: 0.649 Test Loss: 1.225 Test Acc: 0.649
Validation loss decreased (-0.648636 --> -0.648636).  Saving model ...
Epoch: 22 cost time: 2.9155657291412354
Epoch: 22, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.270 Vali Acc: 0.608 Test Loss: 1.270 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.8859593868255615
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.278 Vali Acc: 0.608 Test Loss: 1.278 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.7824718952178955
Epoch: 24, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.267 Vali Acc: 0.608 Test Loss: 1.267 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.864628314971924
Epoch: 25, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.282 Vali Acc: 0.608 Test Loss: 1.282 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.920093297958374
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.261 Vali Acc: 0.622 Test Loss: 1.261 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.685015916824341
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.301 Vali Acc: 0.608 Test Loss: 1.301 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.526285171508789
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.293 Vali Acc: 0.635 Test Loss: 1.293 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.647719144821167
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.344 Vali Acc: 0.608 Test Loss: 1.344 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.6240806579589844
Epoch: 30, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.310 Vali Acc: 0.608 Test Loss: 1.310 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.6973097324371338
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.315 Vali Acc: 0.608 Test Loss: 1.315 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 1452980
model size : 6.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.8984153270721436
Epoch: 1, Steps: 10 | Train Loss: 1.424 Vali Loss: 1.357 Vali Acc: 0.351 Test Loss: 1.357 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 2.7579469680786133
Epoch: 2, Steps: 10 | Train Loss: 1.431 Vali Loss: 1.418 Vali Acc: 0.189 Test Loss: 1.418 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.546532154083252
Epoch: 3, Steps: 10 | Train Loss: 1.377 Vali Loss: 1.324 Vali Acc: 0.405 Test Loss: 1.324 Test Acc: 0.405
Validation loss decreased (-0.351338 --> -0.405392).  Saving model ...
Epoch: 4 cost time: 2.565833568572998
Epoch: 4, Steps: 10 | Train Loss: 1.286 Vali Loss: 1.405 Vali Acc: 0.338 Test Loss: 1.405 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.618823766708374
Epoch: 5, Steps: 10 | Train Loss: 1.172 Vali Loss: 1.245 Vali Acc: 0.446 Test Loss: 1.245 Test Acc: 0.446
Validation loss decreased (-0.405392 --> -0.445933).  Saving model ...
Epoch: 6 cost time: 2.967015504837036
Epoch: 6, Steps: 10 | Train Loss: 1.053 Vali Loss: 1.312 Vali Acc: 0.392 Test Loss: 1.312 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.3362631797790527
Epoch: 7, Steps: 10 | Train Loss: 0.869 Vali Loss: 1.248 Vali Acc: 0.419 Test Loss: 1.248 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.7921977043151855
Epoch: 8, Steps: 10 | Train Loss: 0.710 Vali Loss: 1.266 Vali Acc: 0.459 Test Loss: 1.266 Test Acc: 0.459
Validation loss decreased (-0.445933 --> -0.459447).  Saving model ...
Epoch: 9 cost time: 2.472125291824341
Epoch: 9, Steps: 10 | Train Loss: 0.670 Vali Loss: 1.234 Vali Acc: 0.486 Test Loss: 1.234 Test Acc: 0.486
Validation loss decreased (-0.459447 --> -0.486474).  Saving model ...
Epoch: 10 cost time: 2.52309250831604
Epoch: 10, Steps: 10 | Train Loss: 0.520 Vali Loss: 1.149 Vali Acc: 0.486 Test Loss: 1.149 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486475).  Saving model ...
Epoch: 11 cost time: 1.9948146343231201
Epoch: 11, Steps: 10 | Train Loss: 0.387 Vali Loss: 1.175 Vali Acc: 0.541 Test Loss: 1.175 Test Acc: 0.541
Validation loss decreased (-0.486475 --> -0.540529).  Saving model ...
Epoch: 12 cost time: 2.3530850410461426
Epoch: 12, Steps: 10 | Train Loss: 0.303 Vali Loss: 1.381 Vali Acc: 0.419 Test Loss: 1.381 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.4363462924957275
Epoch: 13, Steps: 10 | Train Loss: 0.233 Vali Loss: 1.145 Vali Acc: 0.554 Test Loss: 1.145 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554043).  Saving model ...
Epoch: 14 cost time: 2.4075052738189697
Epoch: 14, Steps: 10 | Train Loss: 0.169 Vali Loss: 1.208 Vali Acc: 0.514 Test Loss: 1.208 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.68753981590271
Epoch: 15, Steps: 10 | Train Loss: 0.111 Vali Loss: 1.299 Vali Acc: 0.514 Test Loss: 1.299 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.280348062515259
Epoch: 16, Steps: 10 | Train Loss: 0.074 Vali Loss: 1.267 Vali Acc: 0.500 Test Loss: 1.267 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.8202261924743652
Epoch: 17, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.365 Vali Acc: 0.473 Test Loss: 1.365 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.7382652759552
Epoch: 18, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.259 Vali Acc: 0.527 Test Loss: 1.259 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.1045072078704834
Epoch: 19, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.332 Vali Acc: 0.486 Test Loss: 1.332 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.9082133769989014
Epoch: 20, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.289 Vali Acc: 0.514 Test Loss: 1.289 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.6875882148742676
Epoch: 21, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.354 Vali Acc: 0.527 Test Loss: 1.354 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.7774412631988525
Epoch: 22, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.340 Vali Acc: 0.514 Test Loss: 1.340 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.1638565063476562
Epoch: 23, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.346 Vali Acc: 0.500 Test Loss: 1.346 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 1449140
model size : 6.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.288875579833984
Epoch: 1, Steps: 10 | Train Loss: 1.464 Vali Loss: 1.408 Vali Acc: 0.270 Test Loss: 1.408 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 2.4166979789733887
Epoch: 2, Steps: 10 | Train Loss: 1.462 Vali Loss: 1.334 Vali Acc: 0.419 Test Loss: 1.334 Test Acc: 0.419
Validation loss decreased (-0.270256 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 3.1794703006744385
Epoch: 3, Steps: 10 | Train Loss: 1.364 Vali Loss: 1.328 Vali Acc: 0.446 Test Loss: 1.328 Test Acc: 0.446
Validation loss decreased (-0.418906 --> -0.445933).  Saving model ...
Epoch: 4 cost time: 2.962548017501831
Epoch: 4, Steps: 10 | Train Loss: 1.272 Vali Loss: 1.298 Vali Acc: 0.459 Test Loss: 1.298 Test Acc: 0.459
Validation loss decreased (-0.445933 --> -0.459446).  Saving model ...
Epoch: 5 cost time: 2.5320894718170166
Epoch: 5, Steps: 10 | Train Loss: 1.175 Vali Loss: 1.203 Vali Acc: 0.432 Test Loss: 1.203 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.2658331394195557
Epoch: 6, Steps: 10 | Train Loss: 1.144 Vali Loss: 1.388 Vali Acc: 0.338 Test Loss: 1.388 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.009718894958496
Epoch: 7, Steps: 10 | Train Loss: 1.007 Vali Loss: 1.120 Vali Acc: 0.514 Test Loss: 1.120 Test Acc: 0.514
Validation loss decreased (-0.459446 --> -0.513502).  Saving model ...
Epoch: 8 cost time: 2.833767890930176
Epoch: 8, Steps: 10 | Train Loss: 0.832 Vali Loss: 1.109 Vali Acc: 0.514 Test Loss: 1.109 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513502).  Saving model ...
Epoch: 9 cost time: 2.65344500541687
Epoch: 9, Steps: 10 | Train Loss: 0.694 Vali Loss: 1.066 Vali Acc: 0.568 Test Loss: 1.066 Test Acc: 0.568
Validation loss decreased (-0.513502 --> -0.567557).  Saving model ...
Epoch: 10 cost time: 2.75814151763916
Epoch: 10, Steps: 10 | Train Loss: 0.595 Vali Loss: 1.165 Vali Acc: 0.541 Test Loss: 1.165 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.732579469680786
Epoch: 11, Steps: 10 | Train Loss: 0.489 Vali Loss: 1.061 Vali Acc: 0.581 Test Loss: 1.061 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581070).  Saving model ...
Epoch: 12 cost time: 2.841374635696411
Epoch: 12, Steps: 10 | Train Loss: 0.362 Vali Loss: 1.129 Vali Acc: 0.514 Test Loss: 1.129 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.06701397895813
Epoch: 13, Steps: 10 | Train Loss: 0.302 Vali Loss: 1.095 Vali Acc: 0.568 Test Loss: 1.095 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.737234354019165
Epoch: 14, Steps: 10 | Train Loss: 0.228 Vali Loss: 1.042 Vali Acc: 0.581 Test Loss: 1.042 Test Acc: 0.581
Validation loss decreased (-0.581070 --> -0.581071).  Saving model ...
Epoch: 15 cost time: 2.6901304721832275
Epoch: 15, Steps: 10 | Train Loss: 0.169 Vali Loss: 1.239 Vali Acc: 0.581 Test Loss: 1.239 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.957611560821533
Epoch: 16, Steps: 10 | Train Loss: 0.098 Vali Loss: 1.062 Vali Acc: 0.581 Test Loss: 1.062 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.0164384841918945
Epoch: 17, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.226 Vali Acc: 0.581 Test Loss: 1.226 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.9288136959075928
Epoch: 18, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.136 Vali Acc: 0.581 Test Loss: 1.136 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.1387674808502197
Epoch: 19, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.193 Vali Acc: 0.541 Test Loss: 1.193 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.8913493156433105
Epoch: 20, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.198 Vali Acc: 0.622 Test Loss: 1.198 Test Acc: 0.622
Validation loss decreased (-0.581071 --> -0.621610).  Saving model ...
Epoch: 21 cost time: 2.8960509300231934
Epoch: 21, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.234 Vali Acc: 0.527 Test Loss: 1.234 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.5553903579711914
Epoch: 22, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.222 Vali Acc: 0.608 Test Loss: 1.222 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.2067012786865234
Epoch: 23, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.252 Vali Acc: 0.568 Test Loss: 1.252 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.27038311958313
Epoch: 24, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.267 Vali Acc: 0.581 Test Loss: 1.267 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.9515509605407715
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.298 Vali Acc: 0.568 Test Loss: 1.298 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.9316091537475586
Epoch: 26, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.315 Vali Acc: 0.568 Test Loss: 1.315 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.382707118988037
Epoch: 27, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.328 Vali Acc: 0.568 Test Loss: 1.328 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.837336778640747
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.358 Vali Acc: 0.568 Test Loss: 1.358 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.7205023765563965
Epoch: 29, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.359 Vali Acc: 0.581 Test Loss: 1.359 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.8688130378723145
Epoch: 30, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.367 Vali Acc: 0.581 Test Loss: 1.367 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 998324
model size : 5.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.947821617126465
Epoch: 1, Steps: 10 | Train Loss: 1.421 Vali Loss: 1.385 Vali Acc: 0.351 Test Loss: 1.385 Test Acc: 0.351
Validation loss decreased (inf --> -0.351337).  Saving model ...
Epoch: 2 cost time: 1.3836727142333984
Epoch: 2, Steps: 10 | Train Loss: 1.421 Vali Loss: 1.296 Vali Acc: 0.365 Test Loss: 1.296 Test Acc: 0.365
Validation loss decreased (-0.351337 --> -0.364852).  Saving model ...
Epoch: 3 cost time: 2.976043701171875
Epoch: 3, Steps: 10 | Train Loss: 1.328 Vali Loss: 1.331 Vali Acc: 0.392 Test Loss: 1.331 Test Acc: 0.392
Validation loss decreased (-0.364852 --> -0.391879).  Saving model ...
Epoch: 4 cost time: 2.188523530960083
Epoch: 4, Steps: 10 | Train Loss: 1.319 Vali Loss: 1.228 Vali Acc: 0.392 Test Loss: 1.228 Test Acc: 0.392
Validation loss decreased (-0.391879 --> -0.391880).  Saving model ...
Epoch: 5 cost time: 2.7186543941497803
Epoch: 5, Steps: 10 | Train Loss: 1.179 Vali Loss: 1.278 Vali Acc: 0.365 Test Loss: 1.278 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.5856776237487793
Epoch: 6, Steps: 10 | Train Loss: 0.987 Vali Loss: 1.185 Vali Acc: 0.459 Test Loss: 1.185 Test Acc: 0.459
Validation loss decreased (-0.391880 --> -0.459448).  Saving model ...
Epoch: 7 cost time: 2.0433011054992676
Epoch: 7, Steps: 10 | Train Loss: 0.951 Vali Loss: 1.238 Vali Acc: 0.500 Test Loss: 1.238 Test Acc: 0.500
Validation loss decreased (-0.459448 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 2.614138126373291
Epoch: 8, Steps: 10 | Train Loss: 0.813 Vali Loss: 1.240 Vali Acc: 0.432 Test Loss: 1.240 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.4043619632720947
Epoch: 9, Steps: 10 | Train Loss: 0.720 Vali Loss: 1.149 Vali Acc: 0.473 Test Loss: 1.149 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.6322715282440186
Epoch: 10, Steps: 10 | Train Loss: 0.622 Vali Loss: 1.454 Vali Acc: 0.446 Test Loss: 1.454 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.9269533157348633
Epoch: 11, Steps: 10 | Train Loss: 0.541 Vali Loss: 1.118 Vali Acc: 0.541 Test Loss: 1.118 Test Acc: 0.541
Validation loss decreased (-0.499988 --> -0.540529).  Saving model ...
Epoch: 12 cost time: 3.262197971343994
Epoch: 12, Steps: 10 | Train Loss: 0.372 Vali Loss: 1.175 Vali Acc: 0.527 Test Loss: 1.175 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.781744956970215
Epoch: 13, Steps: 10 | Train Loss: 0.293 Vali Loss: 1.095 Vali Acc: 0.527 Test Loss: 1.095 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.711311101913452
Epoch: 14, Steps: 10 | Train Loss: 0.203 Vali Loss: 1.197 Vali Acc: 0.595 Test Loss: 1.197 Test Acc: 0.595
Validation loss decreased (-0.540529 --> -0.594583).  Saving model ...
Epoch: 15 cost time: 2.840947151184082
Epoch: 15, Steps: 10 | Train Loss: 0.143 Vali Loss: 1.174 Vali Acc: 0.527 Test Loss: 1.174 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.0003228187561035
Epoch: 16, Steps: 10 | Train Loss: 0.092 Vali Loss: 1.243 Vali Acc: 0.527 Test Loss: 1.243 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.7673861980438232
Epoch: 17, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.153 Vali Acc: 0.581 Test Loss: 1.153 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.6228432655334473
Epoch: 18, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.191 Vali Acc: 0.581 Test Loss: 1.191 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.908123254776001
Epoch: 19, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.208 Vali Acc: 0.527 Test Loss: 1.208 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.831827163696289
Epoch: 20, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.268 Vali Acc: 0.568 Test Loss: 1.268 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.9320037364959717
Epoch: 21, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.289 Vali Acc: 0.581 Test Loss: 1.289 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.279816150665283
Epoch: 22, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.290 Vali Acc: 0.595 Test Loss: 1.290 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.1603469848632812
Epoch: 23, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.284 Vali Acc: 0.541 Test Loss: 1.284 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.3618698120117188
Epoch: 24, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.304 Vali Acc: 0.554 Test Loss: 1.304 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 994484
model size : 5.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.723278999328613
Epoch: 1, Steps: 10 | Train Loss: 1.479 Vali Loss: 1.371 Vali Acc: 0.284 Test Loss: 1.371 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 2.1883625984191895
Epoch: 2, Steps: 10 | Train Loss: 1.414 Vali Loss: 1.360 Vali Acc: 0.392 Test Loss: 1.360 Test Acc: 0.392
Validation loss decreased (-0.283770 --> -0.391878).  Saving model ...
Epoch: 3 cost time: 2.095038414001465
Epoch: 3, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.330 Vali Acc: 0.473 Test Loss: 1.330 Test Acc: 0.473
Validation loss decreased (-0.391878 --> -0.472960).  Saving model ...
Epoch: 4 cost time: 2.6800177097320557
Epoch: 4, Steps: 10 | Train Loss: 1.287 Vali Loss: 1.351 Vali Acc: 0.284 Test Loss: 1.351 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.450176954269409
Epoch: 5, Steps: 10 | Train Loss: 1.300 Vali Loss: 1.344 Vali Acc: 0.365 Test Loss: 1.344 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.2438883781433105
Epoch: 6, Steps: 10 | Train Loss: 1.155 Vali Loss: 1.247 Vali Acc: 0.446 Test Loss: 1.247 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.6010403633117676
Epoch: 7, Steps: 10 | Train Loss: 1.061 Vali Loss: 1.220 Vali Acc: 0.500 Test Loss: 1.220 Test Acc: 0.500
Validation loss decreased (-0.472960 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 2.6873981952667236
Epoch: 8, Steps: 10 | Train Loss: 0.853 Vali Loss: 1.223 Vali Acc: 0.486 Test Loss: 1.223 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.3795433044433594
Epoch: 9, Steps: 10 | Train Loss: 0.763 Vali Loss: 1.156 Vali Acc: 0.527 Test Loss: 1.156 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527015).  Saving model ...
Epoch: 10 cost time: 2.4463040828704834
Epoch: 10, Steps: 10 | Train Loss: 0.610 Vali Loss: 1.208 Vali Acc: 0.514 Test Loss: 1.208 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.3633289337158203
Epoch: 11, Steps: 10 | Train Loss: 0.504 Vali Loss: 1.102 Vali Acc: 0.608 Test Loss: 1.102 Test Acc: 0.608
Validation loss decreased (-0.527015 --> -0.608097).  Saving model ...
Epoch: 12 cost time: 2.5525741577148438
Epoch: 12, Steps: 10 | Train Loss: 0.384 Vali Loss: 1.188 Vali Acc: 0.568 Test Loss: 1.188 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.360293388366699
Epoch: 13, Steps: 10 | Train Loss: 0.326 Vali Loss: 1.153 Vali Acc: 0.541 Test Loss: 1.153 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.636655807495117
Epoch: 14, Steps: 10 | Train Loss: 0.223 Vali Loss: 1.146 Vali Acc: 0.581 Test Loss: 1.146 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.7010419368743896
Epoch: 15, Steps: 10 | Train Loss: 0.159 Vali Loss: 1.211 Vali Acc: 0.581 Test Loss: 1.211 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.277202606201172
Epoch: 16, Steps: 10 | Train Loss: 0.109 Vali Loss: 1.207 Vali Acc: 0.568 Test Loss: 1.207 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.835782766342163
Epoch: 17, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.245 Vali Acc: 0.581 Test Loss: 1.245 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.8279402256011963
Epoch: 18, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.320 Vali Acc: 0.568 Test Loss: 1.320 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.9982025623321533
Epoch: 19, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.331 Vali Acc: 0.541 Test Loss: 1.331 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.6148102283477783
Epoch: 20, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.369 Vali Acc: 0.568 Test Loss: 1.369 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.546936273574829
Epoch: 21, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.328 Vali Acc: 0.581 Test Loss: 1.328 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 990644
model size : 5.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.215843915939331
Epoch: 1, Steps: 10 | Train Loss: 1.451 Vali Loss: 1.406 Vali Acc: 0.189 Test Loss: 1.406 Test Acc: 0.189
Validation loss decreased (inf --> -0.189175).  Saving model ...
Epoch: 2 cost time: 2.970212459564209
Epoch: 2, Steps: 10 | Train Loss: 1.377 Vali Loss: 1.361 Vali Acc: 0.419 Test Loss: 1.361 Test Acc: 0.419
Validation loss decreased (-0.189175 --> -0.418905).  Saving model ...
Epoch: 3 cost time: 2.4217231273651123
Epoch: 3, Steps: 10 | Train Loss: 1.299 Vali Loss: 1.358 Vali Acc: 0.338 Test Loss: 1.358 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.537418842315674
Epoch: 4, Steps: 10 | Train Loss: 1.292 Vali Loss: 1.283 Vali Acc: 0.419 Test Loss: 1.283 Test Acc: 0.419
Validation loss decreased (-0.418905 --> -0.418906).  Saving model ...
Epoch: 5 cost time: 2.1054494380950928
Epoch: 5, Steps: 10 | Train Loss: 1.109 Vali Loss: 1.226 Vali Acc: 0.405 Test Loss: 1.226 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.4243223667144775
Epoch: 6, Steps: 10 | Train Loss: 0.998 Vali Loss: 1.153 Vali Acc: 0.500 Test Loss: 1.153 Test Acc: 0.500
Validation loss decreased (-0.418906 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 2.7548210620880127
Epoch: 7, Steps: 10 | Train Loss: 0.859 Vali Loss: 1.233 Vali Acc: 0.432 Test Loss: 1.233 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.1340200901031494
Epoch: 8, Steps: 10 | Train Loss: 0.719 Vali Loss: 1.082 Vali Acc: 0.514 Test Loss: 1.082 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513503).  Saving model ...
Epoch: 9 cost time: 2.6586313247680664
Epoch: 9, Steps: 10 | Train Loss: 0.566 Vali Loss: 1.045 Vali Acc: 0.527 Test Loss: 1.045 Test Acc: 0.527
Validation loss decreased (-0.513503 --> -0.527017).  Saving model ...
Epoch: 10 cost time: 2.4215426445007324
Epoch: 10, Steps: 10 | Train Loss: 0.475 Vali Loss: 1.043 Vali Acc: 0.554 Test Loss: 1.043 Test Acc: 0.554
Validation loss decreased (-0.527017 --> -0.554044).  Saving model ...
Epoch: 11 cost time: 2.728627920150757
Epoch: 11, Steps: 10 | Train Loss: 0.365 Vali Loss: 1.029 Vali Acc: 0.568 Test Loss: 1.029 Test Acc: 0.568
Validation loss decreased (-0.554044 --> -0.567557).  Saving model ...
Epoch: 12 cost time: 2.8186278343200684
Epoch: 12, Steps: 10 | Train Loss: 0.304 Vali Loss: 1.180 Vali Acc: 0.608 Test Loss: 1.180 Test Acc: 0.608
Validation loss decreased (-0.567557 --> -0.608096).  Saving model ...
Epoch: 13 cost time: 2.2864773273468018
Epoch: 13, Steps: 10 | Train Loss: 0.236 Vali Loss: 1.036 Vali Acc: 0.608 Test Loss: 1.036 Test Acc: 0.608
Validation loss decreased (-0.608096 --> -0.608098).  Saving model ...
Epoch: 14 cost time: 2.7973742485046387
Epoch: 14, Steps: 10 | Train Loss: 0.128 Vali Loss: 1.063 Vali Acc: 0.608 Test Loss: 1.063 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.9914827346801758
Epoch: 15, Steps: 10 | Train Loss: 0.091 Vali Loss: 1.066 Vali Acc: 0.635 Test Loss: 1.066 Test Acc: 0.635
Validation loss decreased (-0.608098 --> -0.635124).  Saving model ...
Epoch: 16 cost time: 2.350236654281616
Epoch: 16, Steps: 10 | Train Loss: 0.060 Vali Loss: 1.129 Vali Acc: 0.568 Test Loss: 1.129 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.5404458045959473
Epoch: 17, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.098 Vali Acc: 0.608 Test Loss: 1.098 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.6476800441741943
Epoch: 18, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.130 Vali Acc: 0.595 Test Loss: 1.130 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.097458600997925
Epoch: 19, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.131 Vali Acc: 0.595 Test Loss: 1.131 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.6999850273132324
Epoch: 20, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.151 Vali Acc: 0.581 Test Loss: 1.151 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.2818443775177
Epoch: 21, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.156 Vali Acc: 0.581 Test Loss: 1.156 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.7432379722595215
Epoch: 22, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.162 Vali Acc: 0.581 Test Loss: 1.162 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.6060988903045654
Epoch: 23, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.181 Vali Acc: 0.581 Test Loss: 1.181 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.3633949756622314
Epoch: 24, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.185 Vali Acc: 0.595 Test Loss: 1.185 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.594425916671753
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.181 Vali Acc: 0.595 Test Loss: 1.181 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 986804
model size : 5.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.207047939300537
Epoch: 1, Steps: 10 | Train Loss: 1.464 Vali Loss: 1.376 Vali Acc: 0.324 Test Loss: 1.376 Test Acc: 0.324
Validation loss decreased (inf --> -0.324311).  Saving model ...
Epoch: 2 cost time: 2.679054021835327
Epoch: 2, Steps: 10 | Train Loss: 1.405 Vali Loss: 1.371 Vali Acc: 0.297 Test Loss: 1.371 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.389521837234497
Epoch: 3, Steps: 10 | Train Loss: 1.365 Vali Loss: 1.342 Vali Acc: 0.351 Test Loss: 1.342 Test Acc: 0.351
Validation loss decreased (-0.324311 --> -0.351338).  Saving model ...
Epoch: 4 cost time: 2.502293586730957
Epoch: 4, Steps: 10 | Train Loss: 1.254 Vali Loss: 1.318 Vali Acc: 0.378 Test Loss: 1.318 Test Acc: 0.378
Validation loss decreased (-0.351338 --> -0.378365).  Saving model ...
Epoch: 5 cost time: 2.8944454193115234
Epoch: 5, Steps: 10 | Train Loss: 1.207 Vali Loss: 1.260 Vali Acc: 0.419 Test Loss: 1.260 Test Acc: 0.419
Validation loss decreased (-0.378365 --> -0.418906).  Saving model ...
Epoch: 6 cost time: 2.743112564086914
Epoch: 6, Steps: 10 | Train Loss: 1.125 Vali Loss: 1.286 Vali Acc: 0.432 Test Loss: 1.286 Test Acc: 0.432
Validation loss decreased (-0.418906 --> -0.432420).  Saving model ...
Epoch: 7 cost time: 2.9251856803894043
Epoch: 7, Steps: 10 | Train Loss: 1.005 Vali Loss: 1.226 Vali Acc: 0.459 Test Loss: 1.226 Test Acc: 0.459
Validation loss decreased (-0.432420 --> -0.459447).  Saving model ...
Epoch: 8 cost time: 2.5126445293426514
Epoch: 8, Steps: 10 | Train Loss: 0.890 Vali Loss: 1.246 Vali Acc: 0.459 Test Loss: 1.246 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.042651653289795
Epoch: 9, Steps: 10 | Train Loss: 0.787 Vali Loss: 1.254 Vali Acc: 0.365 Test Loss: 1.254 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.3166115283966064
Epoch: 10, Steps: 10 | Train Loss: 0.696 Vali Loss: 1.197 Vali Acc: 0.527 Test Loss: 1.197 Test Acc: 0.527
Validation loss decreased (-0.459447 --> -0.527015).  Saving model ...
Epoch: 11 cost time: 2.455918550491333
Epoch: 11, Steps: 10 | Train Loss: 0.541 Vali Loss: 1.253 Vali Acc: 0.514 Test Loss: 1.253 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.239388942718506
Epoch: 12, Steps: 10 | Train Loss: 0.467 Vali Loss: 1.169 Vali Acc: 0.500 Test Loss: 1.169 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.037531614303589
Epoch: 13, Steps: 10 | Train Loss: 0.346 Vali Loss: 1.175 Vali Acc: 0.527 Test Loss: 1.175 Test Acc: 0.527
Validation loss decreased (-0.527015 --> -0.527015).  Saving model ...
Epoch: 14 cost time: 2.3003904819488525
Epoch: 14, Steps: 10 | Train Loss: 0.254 Vali Loss: 1.280 Vali Acc: 0.527 Test Loss: 1.280 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.8720273971557617
Epoch: 15, Steps: 10 | Train Loss: 0.193 Vali Loss: 1.224 Vali Acc: 0.514 Test Loss: 1.224 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.3488988876342773
Epoch: 16, Steps: 10 | Train Loss: 0.147 Vali Loss: 1.232 Vali Acc: 0.595 Test Loss: 1.232 Test Acc: 0.595
Validation loss decreased (-0.527015 --> -0.594582).  Saving model ...
Epoch: 17 cost time: 2.311976909637451
Epoch: 17, Steps: 10 | Train Loss: 0.099 Vali Loss: 1.524 Vali Acc: 0.486 Test Loss: 1.524 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.19746732711792
Epoch: 18, Steps: 10 | Train Loss: 0.094 Vali Loss: 1.294 Vali Acc: 0.554 Test Loss: 1.294 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.187502145767212
Epoch: 19, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.528 Vali Acc: 0.527 Test Loss: 1.528 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.9967920780181885
Epoch: 20, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.396 Vali Acc: 0.568 Test Loss: 1.396 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.5016636848449707
Epoch: 21, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.432 Vali Acc: 0.541 Test Loss: 1.432 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.1299471855163574
Epoch: 22, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.371 Vali Acc: 0.568 Test Loss: 1.371 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.5338022708892822
Epoch: 23, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.411 Vali Acc: 0.554 Test Loss: 1.411 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.721853017807007
Epoch: 24, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.411 Vali Acc: 0.568 Test Loss: 1.411 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.4751999378204346
Epoch: 25, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.437 Vali Acc: 0.568 Test Loss: 1.437 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.7052536010742188
Epoch: 26, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.465 Vali Acc: 0.568 Test Loss: 1.465 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 767156
model size : 4.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.831012010574341
Epoch: 1, Steps: 10 | Train Loss: 1.465 Vali Loss: 1.393 Vali Acc: 0.230 Test Loss: 1.393 Test Acc: 0.230
Validation loss decreased (inf --> -0.229716).  Saving model ...
Epoch: 2 cost time: 1.930220127105713
Epoch: 2, Steps: 10 | Train Loss: 1.394 Vali Loss: 1.392 Vali Acc: 0.311 Test Loss: 1.392 Test Acc: 0.311
Validation loss decreased (-0.229716 --> -0.310797).  Saving model ...
Epoch: 3 cost time: 2.374978542327881
Epoch: 3, Steps: 10 | Train Loss: 1.345 Vali Loss: 1.332 Vali Acc: 0.311 Test Loss: 1.332 Test Acc: 0.311
Validation loss decreased (-0.310797 --> -0.310797).  Saving model ...
Epoch: 4 cost time: 1.9248721599578857
Epoch: 4, Steps: 10 | Train Loss: 1.274 Vali Loss: 1.310 Vali Acc: 0.392 Test Loss: 1.310 Test Acc: 0.392
Validation loss decreased (-0.310797 --> -0.391879).  Saving model ...
Epoch: 5 cost time: 2.2200303077697754
Epoch: 5, Steps: 10 | Train Loss: 1.164 Vali Loss: 1.264 Vali Acc: 0.365 Test Loss: 1.264 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.164405584335327
Epoch: 6, Steps: 10 | Train Loss: 1.104 Vali Loss: 1.265 Vali Acc: 0.459 Test Loss: 1.265 Test Acc: 0.459
Validation loss decreased (-0.391879 --> -0.459447).  Saving model ...
Epoch: 7 cost time: 2.196640729904175
Epoch: 7, Steps: 10 | Train Loss: 0.954 Vali Loss: 1.165 Vali Acc: 0.554 Test Loss: 1.165 Test Acc: 0.554
Validation loss decreased (-0.459447 --> -0.554042).  Saving model ...
Epoch: 8 cost time: 2.5674943923950195
Epoch: 8, Steps: 10 | Train Loss: 0.833 Vali Loss: 1.369 Vali Acc: 0.378 Test Loss: 1.369 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.6312458515167236
Epoch: 9, Steps: 10 | Train Loss: 0.762 Vali Loss: 1.112 Vali Acc: 0.527 Test Loss: 1.112 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.013852596282959
Epoch: 10, Steps: 10 | Train Loss: 0.641 Vali Loss: 1.081 Vali Acc: 0.554 Test Loss: 1.081 Test Acc: 0.554
Validation loss decreased (-0.554042 --> -0.554043).  Saving model ...
Epoch: 11 cost time: 2.910085916519165
Epoch: 11, Steps: 10 | Train Loss: 0.555 Vali Loss: 1.168 Vali Acc: 0.514 Test Loss: 1.168 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.7915990352630615
Epoch: 12, Steps: 10 | Train Loss: 0.426 Vali Loss: 1.244 Vali Acc: 0.500 Test Loss: 1.244 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.457293748855591
Epoch: 13, Steps: 10 | Train Loss: 0.361 Vali Loss: 1.071 Vali Acc: 0.581 Test Loss: 1.071 Test Acc: 0.581
Validation loss decreased (-0.554043 --> -0.581070).  Saving model ...
Epoch: 14 cost time: 2.524967908859253
Epoch: 14, Steps: 10 | Train Loss: 0.250 Vali Loss: 1.159 Vali Acc: 0.554 Test Loss: 1.159 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.4433705806732178
Epoch: 15, Steps: 10 | Train Loss: 0.184 Vali Loss: 1.319 Vali Acc: 0.554 Test Loss: 1.319 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.997149705886841
Epoch: 16, Steps: 10 | Train Loss: 0.125 Vali Loss: 1.202 Vali Acc: 0.595 Test Loss: 1.202 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594583).  Saving model ...
Epoch: 17 cost time: 2.568782091140747
Epoch: 17, Steps: 10 | Train Loss: 0.097 Vali Loss: 1.318 Vali Acc: 0.527 Test Loss: 1.318 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.3584506511688232
Epoch: 18, Steps: 10 | Train Loss: 0.062 Vali Loss: 1.271 Vali Acc: 0.581 Test Loss: 1.271 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.730114459991455
Epoch: 19, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.359 Vali Acc: 0.541 Test Loss: 1.359 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.416663646697998
Epoch: 20, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.314 Vali Acc: 0.581 Test Loss: 1.314 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.9890103340148926
Epoch: 21, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.446 Vali Acc: 0.527 Test Loss: 1.446 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.5437471866607666
Epoch: 22, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.358 Vali Acc: 0.622 Test Loss: 1.358 Test Acc: 0.622
Validation loss decreased (-0.594583 --> -0.621608).  Saving model ...
Epoch: 23 cost time: 2.473515272140503
Epoch: 23, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.403 Vali Acc: 0.527 Test Loss: 1.403 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.801194190979004
Epoch: 24, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.418 Vali Acc: 0.581 Test Loss: 1.418 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.2144381999969482
Epoch: 25, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.428 Vali Acc: 0.541 Test Loss: 1.428 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.65759015083313
Epoch: 26, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.455 Vali Acc: 0.554 Test Loss: 1.455 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.81319522857666
Epoch: 27, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.467 Vali Acc: 0.581 Test Loss: 1.467 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.423412799835205
Epoch: 28, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.476 Vali Acc: 0.541 Test Loss: 1.476 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.790370464324951
Epoch: 29, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.501 Vali Acc: 0.608 Test Loss: 1.501 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.5997512340545654
Epoch: 30, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.523 Vali Acc: 0.554 Test Loss: 1.523 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.9215030670166016
Epoch: 31, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.505 Vali Acc: 0.568 Test Loss: 1.505 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.9414072036743164
Epoch: 32, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.526 Vali Acc: 0.554 Test Loss: 1.526 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 763316
model size : 4.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.058629512786865
Epoch: 1, Steps: 10 | Train Loss: 1.549 Vali Loss: 1.424 Vali Acc: 0.257 Test Loss: 1.424 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 2.060854434967041
Epoch: 2, Steps: 10 | Train Loss: 1.446 Vali Loss: 1.379 Vali Acc: 0.351 Test Loss: 1.379 Test Acc: 0.351
Validation loss decreased (-0.256743 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 2.014549732208252
Epoch: 3, Steps: 10 | Train Loss: 1.371 Vali Loss: 1.347 Vali Acc: 0.338 Test Loss: 1.347 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6908340454101562
Epoch: 4, Steps: 10 | Train Loss: 1.316 Vali Loss: 1.294 Vali Acc: 0.432 Test Loss: 1.294 Test Acc: 0.432
Validation loss decreased (-0.351338 --> -0.432419).  Saving model ...
Epoch: 5 cost time: 1.6647639274597168
Epoch: 5, Steps: 10 | Train Loss: 1.193 Vali Loss: 1.315 Vali Acc: 0.365 Test Loss: 1.315 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.663766384124756
Epoch: 6, Steps: 10 | Train Loss: 1.094 Vali Loss: 1.240 Vali Acc: 0.405 Test Loss: 1.240 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7817997932434082
Epoch: 7, Steps: 10 | Train Loss: 1.010 Vali Loss: 1.265 Vali Acc: 0.473 Test Loss: 1.265 Test Acc: 0.473
Validation loss decreased (-0.432419 --> -0.472960).  Saving model ...
Epoch: 8 cost time: 2.0638818740844727
Epoch: 8, Steps: 10 | Train Loss: 0.854 Vali Loss: 1.192 Vali Acc: 0.486 Test Loss: 1.192 Test Acc: 0.486
Validation loss decreased (-0.472960 --> -0.486475).  Saving model ...
Epoch: 9 cost time: 2.545189142227173
Epoch: 9, Steps: 10 | Train Loss: 0.724 Vali Loss: 1.134 Vali Acc: 0.527 Test Loss: 1.134 Test Acc: 0.527
Validation loss decreased (-0.486475 --> -0.527016).  Saving model ...
Epoch: 10 cost time: 2.0230653285980225
Epoch: 10, Steps: 10 | Train Loss: 0.632 Vali Loss: 1.170 Vali Acc: 0.486 Test Loss: 1.170 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.1763246059417725
Epoch: 11, Steps: 10 | Train Loss: 0.553 Vali Loss: 1.348 Vali Acc: 0.473 Test Loss: 1.348 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.1530866622924805
Epoch: 12, Steps: 10 | Train Loss: 0.496 Vali Loss: 1.194 Vali Acc: 0.486 Test Loss: 1.194 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.9768671989440918
Epoch: 13, Steps: 10 | Train Loss: 0.344 Vali Loss: 1.156 Vali Acc: 0.486 Test Loss: 1.156 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.8562026023864746
Epoch: 14, Steps: 10 | Train Loss: 0.287 Vali Loss: 1.295 Vali Acc: 0.514 Test Loss: 1.295 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.606945514678955
Epoch: 15, Steps: 10 | Train Loss: 0.219 Vali Loss: 1.221 Vali Acc: 0.486 Test Loss: 1.221 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.0179271697998047
Epoch: 16, Steps: 10 | Train Loss: 0.146 Vali Loss: 1.375 Vali Acc: 0.473 Test Loss: 1.375 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.1747944355010986
Epoch: 17, Steps: 10 | Train Loss: 0.103 Vali Loss: 1.291 Vali Acc: 0.500 Test Loss: 1.291 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.8382728099822998
Epoch: 18, Steps: 10 | Train Loss: 0.064 Vali Loss: 1.340 Vali Acc: 0.486 Test Loss: 1.340 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.6007564067840576
Epoch: 19, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.321 Vali Acc: 0.514 Test Loss: 1.321 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 759476
model size : 4.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.02402925491333
Epoch: 1, Steps: 10 | Train Loss: 1.491 Vali Loss: 1.422 Vali Acc: 0.311 Test Loss: 1.422 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 1.672814130783081
Epoch: 2, Steps: 10 | Train Loss: 1.399 Vali Loss: 1.427 Vali Acc: 0.243 Test Loss: 1.427 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.142026662826538
Epoch: 3, Steps: 10 | Train Loss: 1.370 Vali Loss: 1.372 Vali Acc: 0.284 Test Loss: 1.372 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.388655424118042
Epoch: 4, Steps: 10 | Train Loss: 1.299 Vali Loss: 1.351 Vali Acc: 0.351 Test Loss: 1.351 Test Acc: 0.351
Validation loss decreased (-0.310797 --> -0.351338).  Saving model ...
Epoch: 5 cost time: 1.6219110488891602
Epoch: 5, Steps: 10 | Train Loss: 1.201 Vali Loss: 1.363 Vali Acc: 0.432 Test Loss: 1.363 Test Acc: 0.432
Validation loss decreased (-0.351338 --> -0.432419).  Saving model ...
Epoch: 6 cost time: 1.9578425884246826
Epoch: 6, Steps: 10 | Train Loss: 1.109 Vali Loss: 1.233 Vali Acc: 0.419 Test Loss: 1.233 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.7610690593719482
Epoch: 7, Steps: 10 | Train Loss: 0.981 Vali Loss: 1.381 Vali Acc: 0.324 Test Loss: 1.381 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.0820536613464355
Epoch: 8, Steps: 10 | Train Loss: 0.895 Vali Loss: 1.220 Vali Acc: 0.432 Test Loss: 1.220 Test Acc: 0.432
Validation loss decreased (-0.432419 --> -0.432420).  Saving model ...
Epoch: 9 cost time: 1.934199333190918
Epoch: 9, Steps: 10 | Train Loss: 0.759 Vali Loss: 1.152 Vali Acc: 0.514 Test Loss: 1.152 Test Acc: 0.514
Validation loss decreased (-0.432420 --> -0.513502).  Saving model ...
Epoch: 10 cost time: 2.1928598880767822
Epoch: 10, Steps: 10 | Train Loss: 0.679 Vali Loss: 1.208 Vali Acc: 0.432 Test Loss: 1.208 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.1320979595184326
Epoch: 11, Steps: 10 | Train Loss: 0.554 Vali Loss: 1.169 Vali Acc: 0.514 Test Loss: 1.169 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.8114943504333496
Epoch: 12, Steps: 10 | Train Loss: 0.478 Vali Loss: 1.100 Vali Acc: 0.581 Test Loss: 1.100 Test Acc: 0.581
Validation loss decreased (-0.513502 --> -0.581070).  Saving model ...
Epoch: 13 cost time: 2.238466739654541
Epoch: 13, Steps: 10 | Train Loss: 0.378 Vali Loss: 1.264 Vali Acc: 0.486 Test Loss: 1.264 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.7136948108673096
Epoch: 14, Steps: 10 | Train Loss: 0.317 Vali Loss: 1.330 Vali Acc: 0.527 Test Loss: 1.330 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.3776438236236572
Epoch: 15, Steps: 10 | Train Loss: 0.250 Vali Loss: 1.149 Vali Acc: 0.554 Test Loss: 1.149 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.3916091918945312
Epoch: 16, Steps: 10 | Train Loss: 0.158 Vali Loss: 1.374 Vali Acc: 0.541 Test Loss: 1.374 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.5920498371124268
Epoch: 17, Steps: 10 | Train Loss: 0.122 Vali Loss: 1.195 Vali Acc: 0.595 Test Loss: 1.195 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594583).  Saving model ...
Epoch: 18 cost time: 2.0720479488372803
Epoch: 18, Steps: 10 | Train Loss: 0.082 Vali Loss: 1.271 Vali Acc: 0.595 Test Loss: 1.271 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.524799346923828
Epoch: 19, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.303 Vali Acc: 0.568 Test Loss: 1.303 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.589315891265869
Epoch: 20, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.301 Vali Acc: 0.541 Test Loss: 1.301 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.551999568939209
Epoch: 21, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.367 Vali Acc: 0.554 Test Loss: 1.367 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.491471290588379
Epoch: 22, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.370 Vali Acc: 0.541 Test Loss: 1.370 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.507642984390259
Epoch: 23, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.433 Vali Acc: 0.554 Test Loss: 1.433 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.2406601905822754
Epoch: 24, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.414 Vali Acc: 0.554 Test Loss: 1.414 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.478105068206787
Epoch: 25, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.412 Vali Acc: 0.554 Test Loss: 1.412 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.1706318855285645
Epoch: 26, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.421 Vali Acc: 0.554 Test Loss: 1.421 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.0277464389801025
Epoch: 27, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.446 Vali Acc: 0.541 Test Loss: 1.446 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 755636
model size : 4.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.425228595733643
Epoch: 1, Steps: 10 | Train Loss: 1.467 Vali Loss: 1.396 Vali Acc: 0.257 Test Loss: 1.396 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 2.2656943798065186
Epoch: 2, Steps: 10 | Train Loss: 1.396 Vali Loss: 1.387 Vali Acc: 0.338 Test Loss: 1.387 Test Acc: 0.338
Validation loss decreased (-0.256743 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 2.798865795135498
Epoch: 3, Steps: 10 | Train Loss: 1.338 Vali Loss: 1.354 Vali Acc: 0.324 Test Loss: 1.354 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.2959280014038086
Epoch: 4, Steps: 10 | Train Loss: 1.262 Vali Loss: 1.296 Vali Acc: 0.378 Test Loss: 1.296 Test Acc: 0.378
Validation loss decreased (-0.337824 --> -0.378365).  Saving model ...
Epoch: 5 cost time: 2.8217520713806152
Epoch: 5, Steps: 10 | Train Loss: 1.166 Vali Loss: 1.304 Vali Acc: 0.284 Test Loss: 1.304 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.525754928588867
Epoch: 6, Steps: 10 | Train Loss: 1.138 Vali Loss: 1.241 Vali Acc: 0.554 Test Loss: 1.241 Test Acc: 0.554
Validation loss decreased (-0.378365 --> -0.554042).  Saving model ...
Epoch: 7 cost time: 2.977482318878174
Epoch: 7, Steps: 10 | Train Loss: 0.984 Vali Loss: 1.317 Vali Acc: 0.419 Test Loss: 1.317 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.6358683109283447
Epoch: 8, Steps: 10 | Train Loss: 0.922 Vali Loss: 1.213 Vali Acc: 0.419 Test Loss: 1.213 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.8971033096313477
Epoch: 9, Steps: 10 | Train Loss: 0.783 Vali Loss: 1.147 Vali Acc: 0.446 Test Loss: 1.147 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.5339670181274414
Epoch: 10, Steps: 10 | Train Loss: 0.705 Vali Loss: 1.192 Vali Acc: 0.432 Test Loss: 1.192 Test Acc: 0.432
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.813795566558838
Epoch: 11, Steps: 10 | Train Loss: 0.554 Vali Loss: 1.161 Vali Acc: 0.473 Test Loss: 1.161 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.6153602600097656
Epoch: 12, Steps: 10 | Train Loss: 0.479 Vali Loss: 1.125 Vali Acc: 0.554 Test Loss: 1.125 Test Acc: 0.554
Validation loss decreased (-0.554042 --> -0.554043).  Saving model ...
Epoch: 13 cost time: 2.272258758544922
Epoch: 13, Steps: 10 | Train Loss: 0.393 Vali Loss: 1.308 Vali Acc: 0.446 Test Loss: 1.308 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.7737560272216797
Epoch: 14, Steps: 10 | Train Loss: 0.312 Vali Loss: 1.168 Vali Acc: 0.554 Test Loss: 1.168 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.3684732913970947
Epoch: 15, Steps: 10 | Train Loss: 0.256 Vali Loss: 1.138 Vali Acc: 0.568 Test Loss: 1.138 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567556).  Saving model ...
Epoch: 16 cost time: 2.183955192565918
Epoch: 16, Steps: 10 | Train Loss: 0.174 Vali Loss: 1.125 Vali Acc: 0.473 Test Loss: 1.125 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.232666015625
Epoch: 17, Steps: 10 | Train Loss: 0.127 Vali Loss: 1.132 Vali Acc: 0.595 Test Loss: 1.132 Test Acc: 0.595
Validation loss decreased (-0.567556 --> -0.594583).  Saving model ...
Epoch: 18 cost time: 2.5638461112976074
Epoch: 18, Steps: 10 | Train Loss: 0.087 Vali Loss: 1.225 Vali Acc: 0.527 Test Loss: 1.225 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.8018150329589844
Epoch: 19, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.278 Vali Acc: 0.527 Test Loss: 1.278 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.033329725265503
Epoch: 20, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.239 Vali Acc: 0.541 Test Loss: 1.239 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.320568799972534
Epoch: 21, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.315 Vali Acc: 0.514 Test Loss: 1.315 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.263681173324585
Epoch: 22, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.343 Vali Acc: 0.514 Test Loss: 1.343 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.2827985286712646
Epoch: 23, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.367 Vali Acc: 0.514 Test Loss: 1.367 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.9135961532592773
Epoch: 24, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.378 Vali Acc: 0.554 Test Loss: 1.378 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.2206978797912598
Epoch: 25, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.412 Vali Acc: 0.527 Test Loss: 1.412 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.5740935802459717
Epoch: 26, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.387 Vali Acc: 0.541 Test Loss: 1.387 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.1263129711151123
Epoch: 27, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.435 Vali Acc: 0.527 Test Loss: 1.435 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 651572
model size : 3.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.157815217971802
Epoch: 1, Steps: 10 | Train Loss: 1.446 Vali Loss: 1.396 Vali Acc: 0.297 Test Loss: 1.396 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 2.804839849472046
Epoch: 2, Steps: 10 | Train Loss: 1.432 Vali Loss: 1.399 Vali Acc: 0.270 Test Loss: 1.399 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.3494210243225098
Epoch: 3, Steps: 10 | Train Loss: 1.375 Vali Loss: 1.377 Vali Acc: 0.243 Test Loss: 1.377 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.1196272373199463
Epoch: 4, Steps: 10 | Train Loss: 1.333 Vali Loss: 1.301 Vali Acc: 0.405 Test Loss: 1.301 Test Acc: 0.405
Validation loss decreased (-0.297283 --> -0.405392).  Saving model ...
Epoch: 5 cost time: 2.4751782417297363
Epoch: 5, Steps: 10 | Train Loss: 1.235 Vali Loss: 1.394 Vali Acc: 0.297 Test Loss: 1.394 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.8168139457702637
Epoch: 6, Steps: 10 | Train Loss: 1.147 Vali Loss: 1.234 Vali Acc: 0.432 Test Loss: 1.234 Test Acc: 0.432
Validation loss decreased (-0.405392 --> -0.432420).  Saving model ...
Epoch: 7 cost time: 2.92634654045105
Epoch: 7, Steps: 10 | Train Loss: 1.049 Vali Loss: 1.204 Vali Acc: 0.432 Test Loss: 1.204 Test Acc: 0.432
Validation loss decreased (-0.432420 --> -0.432420).  Saving model ...
Epoch: 8 cost time: 2.2032246589660645
Epoch: 8, Steps: 10 | Train Loss: 0.908 Vali Loss: 1.301 Vali Acc: 0.446 Test Loss: 1.301 Test Acc: 0.446
Validation loss decreased (-0.432420 --> -0.445933).  Saving model ...
Epoch: 9 cost time: 2.8828349113464355
Epoch: 9, Steps: 10 | Train Loss: 0.761 Vali Loss: 1.225 Vali Acc: 0.473 Test Loss: 1.225 Test Acc: 0.473
Validation loss decreased (-0.445933 --> -0.472961).  Saving model ...
Epoch: 10 cost time: 2.607996702194214
Epoch: 10, Steps: 10 | Train Loss: 0.660 Vali Loss: 1.192 Vali Acc: 0.473 Test Loss: 1.192 Test Acc: 0.473
Validation loss decreased (-0.472961 --> -0.472961).  Saving model ...
Epoch: 11 cost time: 2.8814802169799805
Epoch: 11, Steps: 10 | Train Loss: 0.578 Vali Loss: 1.423 Vali Acc: 0.432 Test Loss: 1.423 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.4496967792510986
Epoch: 12, Steps: 10 | Train Loss: 0.524 Vali Loss: 1.183 Vali Acc: 0.500 Test Loss: 1.183 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499988).  Saving model ...
Epoch: 13 cost time: 2.5563695430755615
Epoch: 13, Steps: 10 | Train Loss: 0.418 Vali Loss: 1.319 Vali Acc: 0.446 Test Loss: 1.319 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.5148818492889404
Epoch: 14, Steps: 10 | Train Loss: 0.322 Vali Loss: 1.350 Vali Acc: 0.500 Test Loss: 1.350 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.2053372859954834
Epoch: 15, Steps: 10 | Train Loss: 0.249 Vali Loss: 1.225 Vali Acc: 0.527 Test Loss: 1.225 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527015).  Saving model ...
Epoch: 16 cost time: 2.578920602798462
Epoch: 16, Steps: 10 | Train Loss: 0.182 Vali Loss: 1.179 Vali Acc: 0.541 Test Loss: 1.179 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540529).  Saving model ...
Epoch: 17 cost time: 2.372419595718384
Epoch: 17, Steps: 10 | Train Loss: 0.113 Vali Loss: 1.270 Vali Acc: 0.541 Test Loss: 1.270 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.5265884399414062
Epoch: 18, Steps: 10 | Train Loss: 0.081 Vali Loss: 1.286 Vali Acc: 0.541 Test Loss: 1.286 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.7770071029663086
Epoch: 19, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.309 Vali Acc: 0.554 Test Loss: 1.309 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554041).  Saving model ...
Epoch: 20 cost time: 2.388000249862671
Epoch: 20, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.345 Vali Acc: 0.527 Test Loss: 1.345 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.7572171688079834
Epoch: 21, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.399 Vali Acc: 0.514 Test Loss: 1.399 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.484912872314453
Epoch: 22, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.369 Vali Acc: 0.527 Test Loss: 1.369 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.7071123123168945
Epoch: 23, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.454 Vali Acc: 0.500 Test Loss: 1.454 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.5963523387908936
Epoch: 24, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.399 Vali Acc: 0.541 Test Loss: 1.399 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.2897439002990723
Epoch: 25, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.442 Vali Acc: 0.514 Test Loss: 1.442 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.3839168548583984
Epoch: 26, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.466 Vali Acc: 0.500 Test Loss: 1.466 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.475802183151245
Epoch: 27, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.482 Vali Acc: 0.514 Test Loss: 1.482 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.4591705799102783
Epoch: 28, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.505 Vali Acc: 0.514 Test Loss: 1.505 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.6776657104492188
Epoch: 29, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.500 Vali Acc: 0.527 Test Loss: 1.500 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 647732
model size : 3.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.34093451499939
Epoch: 1, Steps: 10 | Train Loss: 1.437 Vali Loss: 1.377 Vali Acc: 0.311 Test Loss: 1.377 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 2.094169855117798
Epoch: 2, Steps: 10 | Train Loss: 1.430 Vali Loss: 1.356 Vali Acc: 0.338 Test Loss: 1.356 Test Acc: 0.338
Validation loss decreased (-0.310797 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 2.1395509243011475
Epoch: 3, Steps: 10 | Train Loss: 1.363 Vali Loss: 1.461 Vali Acc: 0.189 Test Loss: 1.461 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.3130202293395996
Epoch: 4, Steps: 10 | Train Loss: 1.279 Vali Loss: 1.354 Vali Acc: 0.257 Test Loss: 1.354 Test Acc: 0.257
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.6017839908599854
Epoch: 5, Steps: 10 | Train Loss: 1.244 Vali Loss: 1.290 Vali Acc: 0.446 Test Loss: 1.290 Test Acc: 0.446
Validation loss decreased (-0.337824 --> -0.445933).  Saving model ...
Epoch: 6 cost time: 2.6036441326141357
Epoch: 6, Steps: 10 | Train Loss: 1.114 Vali Loss: 1.276 Vali Acc: 0.405 Test Loss: 1.276 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.5085432529449463
Epoch: 7, Steps: 10 | Train Loss: 1.019 Vali Loss: 1.243 Vali Acc: 0.405 Test Loss: 1.243 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.5433497428894043
Epoch: 8, Steps: 10 | Train Loss: 0.913 Vali Loss: 1.206 Vali Acc: 0.473 Test Loss: 1.206 Test Acc: 0.473
Validation loss decreased (-0.445933 --> -0.472961).  Saving model ...
Epoch: 9 cost time: 2.374390125274658
Epoch: 9, Steps: 10 | Train Loss: 0.846 Vali Loss: 1.324 Vali Acc: 0.432 Test Loss: 1.324 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.284456968307495
Epoch: 10, Steps: 10 | Train Loss: 0.711 Vali Loss: 1.187 Vali Acc: 0.527 Test Loss: 1.187 Test Acc: 0.527
Validation loss decreased (-0.472961 --> -0.527015).  Saving model ...
Epoch: 11 cost time: 3.008647918701172
Epoch: 11, Steps: 10 | Train Loss: 0.594 Vali Loss: 1.143 Vali Acc: 0.514 Test Loss: 1.143 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.8563365936279297
Epoch: 12, Steps: 10 | Train Loss: 0.524 Vali Loss: 1.323 Vali Acc: 0.446 Test Loss: 1.323 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.550898313522339
Epoch: 13, Steps: 10 | Train Loss: 0.400 Vali Loss: 1.160 Vali Acc: 0.486 Test Loss: 1.160 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.243105173110962
Epoch: 14, Steps: 10 | Train Loss: 0.300 Vali Loss: 1.166 Vali Acc: 0.486 Test Loss: 1.166 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.6575610637664795
Epoch: 15, Steps: 10 | Train Loss: 0.248 Vali Loss: 1.332 Vali Acc: 0.514 Test Loss: 1.332 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.721012592315674
Epoch: 16, Steps: 10 | Train Loss: 0.184 Vali Loss: 1.242 Vali Acc: 0.527 Test Loss: 1.242 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.874584197998047
Epoch: 17, Steps: 10 | Train Loss: 0.124 Vali Loss: 1.512 Vali Acc: 0.500 Test Loss: 1.512 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.8788022994995117
Epoch: 18, Steps: 10 | Train Loss: 0.105 Vali Loss: 1.431 Vali Acc: 0.514 Test Loss: 1.431 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.0261778831481934
Epoch: 19, Steps: 10 | Train Loss: 0.081 Vali Loss: 1.401 Vali Acc: 0.554 Test Loss: 1.401 Test Acc: 0.554
Validation loss decreased (-0.527015 --> -0.554040).  Saving model ...
Epoch: 20 cost time: 2.533498525619507
Epoch: 20, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.490 Vali Acc: 0.527 Test Loss: 1.490 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.24422287940979
Epoch: 21, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.545 Vali Acc: 0.527 Test Loss: 1.545 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.5990140438079834
Epoch: 22, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.557 Vali Acc: 0.514 Test Loss: 1.557 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.106111526489258
Epoch: 23, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.579 Vali Acc: 0.500 Test Loss: 1.579 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.21412992477417
Epoch: 24, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.536 Vali Acc: 0.541 Test Loss: 1.536 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.8169257640838623
Epoch: 25, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.604 Vali Acc: 0.527 Test Loss: 1.604 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.4207706451416016
Epoch: 26, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.544 Vali Acc: 0.568 Test Loss: 1.544 Test Acc: 0.568
Validation loss decreased (-0.554040 --> -0.567552).  Saving model ...
Epoch: 27 cost time: 2.7220098972320557
Epoch: 27, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.562 Vali Acc: 0.568 Test Loss: 1.562 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.952413320541382
Epoch: 28, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.597 Vali Acc: 0.568 Test Loss: 1.597 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.908912181854248
Epoch: 29, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.612 Vali Acc: 0.554 Test Loss: 1.612 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.5592803955078125
Epoch: 30, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.620 Vali Acc: 0.554 Test Loss: 1.620 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.1327950954437256
Epoch: 31, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.639 Vali Acc: 0.541 Test Loss: 1.639 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.5296826362609863
Epoch: 32, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.650 Vali Acc: 0.568 Test Loss: 1.650 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.9786250591278076
Epoch: 33, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.644 Vali Acc: 0.568 Test Loss: 1.644 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 2.4141180515289307
Epoch: 34, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.698 Vali Acc: 0.581 Test Loss: 1.698 Test Acc: 0.581
Validation loss decreased (-0.567552 --> -0.581064).  Saving model ...
Epoch: 35 cost time: 2.368936538696289
Epoch: 35, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.683 Vali Acc: 0.581 Test Loss: 1.683 Test Acc: 0.581
Validation loss decreased (-0.581064 --> -0.581064).  Saving model ...
Epoch: 36 cost time: 2.5274393558502197
Epoch: 36, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.694 Vali Acc: 0.554 Test Loss: 1.694 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.423366069793701
Epoch: 37, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.694 Vali Acc: 0.568 Test Loss: 1.694 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.001932382583618
Epoch: 38, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.720 Vali Acc: 0.554 Test Loss: 1.720 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 2.282536506652832
Epoch: 39, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.721 Vali Acc: 0.568 Test Loss: 1.721 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 3.0706212520599365
Epoch: 40, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.730 Vali Acc: 0.581 Test Loss: 1.730 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 2.452768564224243
Epoch: 41, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.743 Vali Acc: 0.541 Test Loss: 1.743 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 2.6793720722198486
Epoch: 42, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.752 Vali Acc: 0.554 Test Loss: 1.752 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 2.371816873550415
Epoch: 43, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.745 Vali Acc: 0.581 Test Loss: 1.745 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 2.6345419883728027
Epoch: 44, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.772 Vali Acc: 0.554 Test Loss: 1.772 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 2.935615062713623
Epoch: 45, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.758 Vali Acc: 0.541 Test Loss: 1.758 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 643892
model size : 3.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.387629270553589
Epoch: 1, Steps: 10 | Train Loss: 1.480 Vali Loss: 1.486 Vali Acc: 0.284 Test Loss: 1.486 Test Acc: 0.284
Validation loss decreased (inf --> -0.283769).  Saving model ...
Epoch: 2 cost time: 2.8513073921203613
Epoch: 2, Steps: 10 | Train Loss: 1.429 Vali Loss: 1.314 Vali Acc: 0.419 Test Loss: 1.314 Test Acc: 0.419
Validation loss decreased (-0.283769 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 2.728461742401123
Epoch: 3, Steps: 10 | Train Loss: 1.342 Vali Loss: 1.381 Vali Acc: 0.351 Test Loss: 1.381 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.182713747024536
Epoch: 4, Steps: 10 | Train Loss: 1.284 Vali Loss: 1.268 Vali Acc: 0.459 Test Loss: 1.268 Test Acc: 0.459
Validation loss decreased (-0.418906 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 2.6578850746154785
Epoch: 5, Steps: 10 | Train Loss: 1.179 Vali Loss: 1.248 Vali Acc: 0.527 Test Loss: 1.248 Test Acc: 0.527
Validation loss decreased (-0.459447 --> -0.527015).  Saving model ...
Epoch: 6 cost time: 2.548630952835083
Epoch: 6, Steps: 10 | Train Loss: 1.128 Vali Loss: 1.332 Vali Acc: 0.432 Test Loss: 1.332 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.9846012592315674
Epoch: 7, Steps: 10 | Train Loss: 0.998 Vali Loss: 1.171 Vali Acc: 0.486 Test Loss: 1.171 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.662891149520874
Epoch: 8, Steps: 10 | Train Loss: 0.899 Vali Loss: 1.361 Vali Acc: 0.419 Test Loss: 1.361 Test Acc: 0.419
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.842679500579834
Epoch: 9, Steps: 10 | Train Loss: 0.811 Vali Loss: 1.127 Vali Acc: 0.514 Test Loss: 1.127 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.9190621376037598
Epoch: 10, Steps: 10 | Train Loss: 0.654 Vali Loss: 1.166 Vali Acc: 0.459 Test Loss: 1.166 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.939422845840454
Epoch: 11, Steps: 10 | Train Loss: 0.582 Vali Loss: 1.149 Vali Acc: 0.486 Test Loss: 1.149 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.184490442276001
Epoch: 12, Steps: 10 | Train Loss: 0.499 Vali Loss: 1.333 Vali Acc: 0.459 Test Loss: 1.333 Test Acc: 0.459
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.695136070251465
Epoch: 13, Steps: 10 | Train Loss: 0.407 Vali Loss: 1.161 Vali Acc: 0.568 Test Loss: 1.161 Test Acc: 0.568
Validation loss decreased (-0.527015 --> -0.567556).  Saving model ...
Epoch: 14 cost time: 2.3664658069610596
Epoch: 14, Steps: 10 | Train Loss: 0.322 Vali Loss: 1.185 Vali Acc: 0.527 Test Loss: 1.185 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.8908605575561523
Epoch: 15, Steps: 10 | Train Loss: 0.209 Vali Loss: 1.294 Vali Acc: 0.541 Test Loss: 1.294 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.462695837020874
Epoch: 16, Steps: 10 | Train Loss: 0.190 Vali Loss: 1.220 Vali Acc: 0.514 Test Loss: 1.220 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.4898505210876465
Epoch: 17, Steps: 10 | Train Loss: 0.131 Vali Loss: 1.325 Vali Acc: 0.514 Test Loss: 1.325 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.5846619606018066
Epoch: 18, Steps: 10 | Train Loss: 0.097 Vali Loss: 1.516 Vali Acc: 0.500 Test Loss: 1.516 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.8942110538482666
Epoch: 19, Steps: 10 | Train Loss: 0.074 Vali Loss: 1.355 Vali Acc: 0.500 Test Loss: 1.355 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.245622396469116
Epoch: 20, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.544 Vali Acc: 0.514 Test Loss: 1.544 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.675778865814209
Epoch: 21, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.413 Vali Acc: 0.568 Test Loss: 1.413 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.04708194732666
Epoch: 22, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.463 Vali Acc: 0.541 Test Loss: 1.463 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.5241575241088867
Epoch: 23, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.503 Vali Acc: 0.527 Test Loss: 1.503 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 640052
model size : 3.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.364192485809326
Epoch: 1, Steps: 10 | Train Loss: 1.415 Vali Loss: 1.400 Vali Acc: 0.230 Test Loss: 1.400 Test Acc: 0.230
Validation loss decreased (inf --> -0.229716).  Saving model ...
Epoch: 2 cost time: 1.9980878829956055
Epoch: 2, Steps: 10 | Train Loss: 1.425 Vali Loss: 1.363 Vali Acc: 0.216 Test Loss: 1.363 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.182525157928467
Epoch: 3, Steps: 10 | Train Loss: 1.334 Vali Loss: 1.368 Vali Acc: 0.351 Test Loss: 1.368 Test Acc: 0.351
Validation loss decreased (-0.229716 --> -0.351338).  Saving model ...
Epoch: 4 cost time: 1.8780336380004883
Epoch: 4, Steps: 10 | Train Loss: 1.257 Vali Loss: 1.361 Vali Acc: 0.230 Test Loss: 1.361 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.1131842136383057
Epoch: 5, Steps: 10 | Train Loss: 1.194 Vali Loss: 1.283 Vali Acc: 0.432 Test Loss: 1.283 Test Acc: 0.432
Validation loss decreased (-0.351338 --> -0.432420).  Saving model ...
Epoch: 6 cost time: 2.1388468742370605
Epoch: 6, Steps: 10 | Train Loss: 1.109 Vali Loss: 1.300 Vali Acc: 0.297 Test Loss: 1.300 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.203824043273926
Epoch: 7, Steps: 10 | Train Loss: 1.036 Vali Loss: 1.217 Vali Acc: 0.392 Test Loss: 1.217 Test Acc: 0.392
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.157409906387329
Epoch: 8, Steps: 10 | Train Loss: 0.904 Vali Loss: 1.190 Vali Acc: 0.392 Test Loss: 1.190 Test Acc: 0.392
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.4595820903778076
Epoch: 9, Steps: 10 | Train Loss: 0.820 Vali Loss: 1.203 Vali Acc: 0.405 Test Loss: 1.203 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.1103768348693848
Epoch: 10, Steps: 10 | Train Loss: 0.705 Vali Loss: 1.147 Vali Acc: 0.419 Test Loss: 1.147 Test Acc: 0.419
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.074901819229126
Epoch: 11, Steps: 10 | Train Loss: 0.603 Vali Loss: 1.136 Vali Acc: 0.392 Test Loss: 1.136 Test Acc: 0.392
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.375072717666626
Epoch: 12, Steps: 10 | Train Loss: 0.489 Vali Loss: 1.097 Vali Acc: 0.432 Test Loss: 1.097 Test Acc: 0.432
Validation loss decreased (-0.432420 --> -0.432421).  Saving model ...
Epoch: 13 cost time: 2.391063690185547
Epoch: 13, Steps: 10 | Train Loss: 0.444 Vali Loss: 1.116 Vali Acc: 0.446 Test Loss: 1.116 Test Acc: 0.446
Validation loss decreased (-0.432421 --> -0.445935).  Saving model ...
Epoch: 14 cost time: 2.209336757659912
Epoch: 14, Steps: 10 | Train Loss: 0.368 Vali Loss: 1.122 Vali Acc: 0.419 Test Loss: 1.122 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.2506608963012695
Epoch: 15, Steps: 10 | Train Loss: 0.304 Vali Loss: 1.094 Vali Acc: 0.459 Test Loss: 1.094 Test Acc: 0.459
Validation loss decreased (-0.445935 --> -0.459449).  Saving model ...
Epoch: 16 cost time: 1.926694631576538
Epoch: 16, Steps: 10 | Train Loss: 0.237 Vali Loss: 1.148 Vali Acc: 0.419 Test Loss: 1.148 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9197473526000977
Epoch: 17, Steps: 10 | Train Loss: 0.193 Vali Loss: 1.091 Vali Acc: 0.514 Test Loss: 1.091 Test Acc: 0.514
Validation loss decreased (-0.459449 --> -0.513503).  Saving model ...
Epoch: 18 cost time: 2.2198190689086914
Epoch: 18, Steps: 10 | Train Loss: 0.153 Vali Loss: 1.116 Vali Acc: 0.473 Test Loss: 1.116 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.0513784885406494
Epoch: 19, Steps: 10 | Train Loss: 0.120 Vali Loss: 1.185 Vali Acc: 0.432 Test Loss: 1.185 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.0273284912109375
Epoch: 20, Steps: 10 | Train Loss: 0.090 Vali Loss: 1.141 Vali Acc: 0.419 Test Loss: 1.141 Test Acc: 0.419
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.9583220481872559
Epoch: 21, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.157 Vali Acc: 0.459 Test Loss: 1.157 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.16965913772583
Epoch: 22, Steps: 10 | Train Loss: 0.062 Vali Loss: 1.151 Vali Acc: 0.432 Test Loss: 1.151 Test Acc: 0.432
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.058344841003418
Epoch: 23, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.166 Vali Acc: 0.459 Test Loss: 1.166 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.139719009399414
Epoch: 24, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.167 Vali Acc: 0.459 Test Loss: 1.167 Test Acc: 0.459
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.2397899627685547
Epoch: 25, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.231 Vali Acc: 0.446 Test Loss: 1.231 Test Acc: 0.446
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.0150020122528076
Epoch: 26, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.203 Vali Acc: 0.459 Test Loss: 1.203 Test Acc: 0.459
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.2882442474365234
Epoch: 27, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.206 Vali Acc: 0.486 Test Loss: 1.206 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5135135135135135
model parameter : 619252
model size : 3.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.92511248588562
Epoch: 1, Steps: 10 | Train Loss: 1.492 Vali Loss: 1.434 Vali Acc: 0.162 Test Loss: 1.434 Test Acc: 0.162
Validation loss decreased (inf --> -0.162148).  Saving model ...
Epoch: 2 cost time: 2.223402261734009
Epoch: 2, Steps: 10 | Train Loss: 1.454 Vali Loss: 1.438 Vali Acc: 0.203 Test Loss: 1.438 Test Acc: 0.203
Validation loss decreased (-0.162148 --> -0.202688).  Saving model ...
Epoch: 3 cost time: 1.8365037441253662
Epoch: 3, Steps: 10 | Train Loss: 1.436 Vali Loss: 1.417 Vali Acc: 0.203 Test Loss: 1.417 Test Acc: 0.203
Validation loss decreased (-0.202688 --> -0.202689).  Saving model ...
Epoch: 4 cost time: 2.024195909500122
Epoch: 4, Steps: 10 | Train Loss: 1.367 Vali Loss: 1.363 Vali Acc: 0.311 Test Loss: 1.363 Test Acc: 0.311
Validation loss decreased (-0.202689 --> -0.310797).  Saving model ...
Epoch: 5 cost time: 2.3163888454437256
Epoch: 5, Steps: 10 | Train Loss: 1.296 Vali Loss: 1.377 Vali Acc: 0.365 Test Loss: 1.377 Test Acc: 0.365
Validation loss decreased (-0.310797 --> -0.364851).  Saving model ...
Epoch: 6 cost time: 1.5996806621551514
Epoch: 6, Steps: 10 | Train Loss: 1.228 Vali Loss: 1.407 Vali Acc: 0.216 Test Loss: 1.407 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.226351022720337
Epoch: 7, Steps: 10 | Train Loss: 1.186 Vali Loss: 1.362 Vali Acc: 0.378 Test Loss: 1.362 Test Acc: 0.378
Validation loss decreased (-0.364851 --> -0.378365).  Saving model ...
Epoch: 8 cost time: 2.2727718353271484
Epoch: 8, Steps: 10 | Train Loss: 1.072 Vali Loss: 1.345 Vali Acc: 0.378 Test Loss: 1.345 Test Acc: 0.378
Validation loss decreased (-0.378365 --> -0.378365).  Saving model ...
Epoch: 9 cost time: 1.955967903137207
Epoch: 9, Steps: 10 | Train Loss: 0.929 Vali Loss: 1.332 Vali Acc: 0.432 Test Loss: 1.332 Test Acc: 0.432
Validation loss decreased (-0.378365 --> -0.432419).  Saving model ...
Epoch: 10 cost time: 2.1137027740478516
Epoch: 10, Steps: 10 | Train Loss: 0.872 Vali Loss: 1.282 Vali Acc: 0.378 Test Loss: 1.282 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.120548963546753
Epoch: 11, Steps: 10 | Train Loss: 0.782 Vali Loss: 1.317 Vali Acc: 0.419 Test Loss: 1.317 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6589484214782715
Epoch: 12, Steps: 10 | Train Loss: 0.679 Vali Loss: 1.298 Vali Acc: 0.432 Test Loss: 1.298 Test Acc: 0.432
Validation loss decreased (-0.432419 --> -0.432419).  Saving model ...
Epoch: 13 cost time: 2.0598273277282715
Epoch: 13, Steps: 10 | Train Loss: 0.581 Vali Loss: 1.278 Vali Acc: 0.432 Test Loss: 1.278 Test Acc: 0.432
Validation loss decreased (-0.432419 --> -0.432420).  Saving model ...
Epoch: 14 cost time: 2.0716981887817383
Epoch: 14, Steps: 10 | Train Loss: 0.507 Vali Loss: 1.264 Vali Acc: 0.473 Test Loss: 1.264 Test Acc: 0.473
Validation loss decreased (-0.432420 --> -0.472960).  Saving model ...
Epoch: 15 cost time: 2.2086663246154785
Epoch: 15, Steps: 10 | Train Loss: 0.374 Vali Loss: 1.259 Vali Acc: 0.392 Test Loss: 1.259 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.2132818698883057
Epoch: 16, Steps: 10 | Train Loss: 0.342 Vali Loss: 1.268 Vali Acc: 0.432 Test Loss: 1.268 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.769670009613037
Epoch: 17, Steps: 10 | Train Loss: 0.269 Vali Loss: 1.247 Vali Acc: 0.419 Test Loss: 1.247 Test Acc: 0.419
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.9413344860076904
Epoch: 18, Steps: 10 | Train Loss: 0.213 Vali Loss: 1.309 Vali Acc: 0.459 Test Loss: 1.309 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.086167335510254
Epoch: 19, Steps: 10 | Train Loss: 0.175 Vali Loss: 1.340 Vali Acc: 0.459 Test Loss: 1.340 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.1471071243286133
Epoch: 20, Steps: 10 | Train Loss: 0.134 Vali Loss: 1.271 Vali Acc: 0.446 Test Loss: 1.271 Test Acc: 0.446
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.8266348838806152
Epoch: 21, Steps: 10 | Train Loss: 0.105 Vali Loss: 1.416 Vali Acc: 0.419 Test Loss: 1.416 Test Acc: 0.419
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.028151273727417
Epoch: 22, Steps: 10 | Train Loss: 0.086 Vali Loss: 1.346 Vali Acc: 0.419 Test Loss: 1.346 Test Acc: 0.419
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.7169477939605713
Epoch: 23, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.341 Vali Acc: 0.500 Test Loss: 1.341 Test Acc: 0.500
Validation loss decreased (-0.472960 --> -0.499987).  Saving model ...
Epoch: 24 cost time: 1.9710676670074463
Epoch: 24, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.395 Vali Acc: 0.432 Test Loss: 1.395 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.8371293544769287
Epoch: 25, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.437 Vali Acc: 0.459 Test Loss: 1.437 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.7965571880340576
Epoch: 26, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.411 Vali Acc: 0.459 Test Loss: 1.411 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.050825834274292
Epoch: 27, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.418 Vali Acc: 0.459 Test Loss: 1.418 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.956639051437378
Epoch: 28, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.420 Vali Acc: 0.459 Test Loss: 1.420 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.070754289627075
Epoch: 29, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.465 Vali Acc: 0.432 Test Loss: 1.465 Test Acc: 0.432
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.1500892639160156
Epoch: 30, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.458 Vali Acc: 0.459 Test Loss: 1.458 Test Acc: 0.459
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.9853765964508057
Epoch: 31, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.484 Vali Acc: 0.446 Test Loss: 1.484 Test Acc: 0.446
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.9691004753112793
Epoch: 32, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.471 Vali Acc: 0.459 Test Loss: 1.471 Test Acc: 0.459
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.944195032119751
Epoch: 33, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.472 Vali Acc: 0.486 Test Loss: 1.472 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5
model parameter : 617332
model size : 3.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.255955934524536
Epoch: 1, Steps: 10 | Train Loss: 1.465 Vali Loss: 1.437 Vali Acc: 0.203 Test Loss: 1.437 Test Acc: 0.203
Validation loss decreased (inf --> -0.202688).  Saving model ...
Epoch: 2 cost time: 2.3111486434936523
Epoch: 2, Steps: 10 | Train Loss: 1.427 Vali Loss: 1.377 Vali Acc: 0.230 Test Loss: 1.377 Test Acc: 0.230
Validation loss decreased (-0.202688 --> -0.229716).  Saving model ...
Epoch: 3 cost time: 2.1295454502105713
Epoch: 3, Steps: 10 | Train Loss: 1.396 Vali Loss: 1.425 Vali Acc: 0.203 Test Loss: 1.425 Test Acc: 0.203
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.270134210586548
Epoch: 4, Steps: 10 | Train Loss: 1.354 Vali Loss: 1.354 Vali Acc: 0.338 Test Loss: 1.354 Test Acc: 0.338
Validation loss decreased (-0.229716 --> -0.337824).  Saving model ...
Epoch: 5 cost time: 2.2102038860321045
Epoch: 5, Steps: 10 | Train Loss: 1.273 Vali Loss: 1.403 Vali Acc: 0.270 Test Loss: 1.403 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.4698567390441895
Epoch: 6, Steps: 10 | Train Loss: 1.260 Vali Loss: 1.297 Vali Acc: 0.473 Test Loss: 1.297 Test Acc: 0.473
Validation loss decreased (-0.337824 --> -0.472960).  Saving model ...
Epoch: 7 cost time: 2.0558807849884033
Epoch: 7, Steps: 10 | Train Loss: 1.113 Vali Loss: 1.269 Vali Acc: 0.432 Test Loss: 1.269 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.3691904544830322
Epoch: 8, Steps: 10 | Train Loss: 1.063 Vali Loss: 1.347 Vali Acc: 0.405 Test Loss: 1.347 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.1598153114318848
Epoch: 9, Steps: 10 | Train Loss: 0.930 Vali Loss: 1.196 Vali Acc: 0.446 Test Loss: 1.196 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.331092596054077
Epoch: 10, Steps: 10 | Train Loss: 0.889 Vali Loss: 1.214 Vali Acc: 0.486 Test Loss: 1.214 Test Acc: 0.486
Validation loss decreased (-0.472960 --> -0.486474).  Saving model ...
Epoch: 11 cost time: 2.103193998336792
Epoch: 11, Steps: 10 | Train Loss: 0.751 Vali Loss: 1.202 Vali Acc: 0.432 Test Loss: 1.202 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.2961602210998535
Epoch: 12, Steps: 10 | Train Loss: 0.657 Vali Loss: 1.195 Vali Acc: 0.473 Test Loss: 1.195 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.3703832626342773
Epoch: 13, Steps: 10 | Train Loss: 0.544 Vali Loss: 1.239 Vali Acc: 0.446 Test Loss: 1.239 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.2316503524780273
Epoch: 14, Steps: 10 | Train Loss: 0.450 Vali Loss: 1.214 Vali Acc: 0.459 Test Loss: 1.214 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.1863739490509033
Epoch: 15, Steps: 10 | Train Loss: 0.384 Vali Loss: 1.219 Vali Acc: 0.514 Test Loss: 1.219 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513501).  Saving model ...
Epoch: 16 cost time: 2.322047710418701
Epoch: 16, Steps: 10 | Train Loss: 0.310 Vali Loss: 1.285 Vali Acc: 0.486 Test Loss: 1.285 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.4599204063415527
Epoch: 17, Steps: 10 | Train Loss: 0.250 Vali Loss: 1.330 Vali Acc: 0.527 Test Loss: 1.330 Test Acc: 0.527
Validation loss decreased (-0.513501 --> -0.527014).  Saving model ...
Epoch: 18 cost time: 1.9570996761322021
Epoch: 18, Steps: 10 | Train Loss: 0.220 Vali Loss: 1.295 Vali Acc: 0.486 Test Loss: 1.295 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.3712103366851807
Epoch: 19, Steps: 10 | Train Loss: 0.169 Vali Loss: 1.364 Vali Acc: 0.459 Test Loss: 1.364 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.1298060417175293
Epoch: 20, Steps: 10 | Train Loss: 0.138 Vali Loss: 1.337 Vali Acc: 0.527 Test Loss: 1.337 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.017394542694092
Epoch: 21, Steps: 10 | Train Loss: 0.108 Vali Loss: 1.405 Vali Acc: 0.473 Test Loss: 1.405 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.052798271179199
Epoch: 22, Steps: 10 | Train Loss: 0.088 Vali Loss: 1.388 Vali Acc: 0.500 Test Loss: 1.388 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.417748212814331
Epoch: 23, Steps: 10 | Train Loss: 0.076 Vali Loss: 1.463 Vali Acc: 0.419 Test Loss: 1.463 Test Acc: 0.419
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.3023054599761963
Epoch: 24, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.443 Vali Acc: 0.486 Test Loss: 1.443 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.4670426845550537
Epoch: 25, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.456 Vali Acc: 0.432 Test Loss: 1.456 Test Acc: 0.432
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.245142936706543
Epoch: 26, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.474 Vali Acc: 0.459 Test Loss: 1.474 Test Acc: 0.459
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.3726840019226074
Epoch: 27, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.525 Vali Acc: 0.446 Test Loss: 1.525 Test Acc: 0.446
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 615412
model size : 3.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.7292122840881348
Epoch: 1, Steps: 10 | Train Loss: 1.446 Vali Loss: 1.413 Vali Acc: 0.216 Test Loss: 1.413 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 1.850445032119751
Epoch: 2, Steps: 10 | Train Loss: 1.397 Vali Loss: 1.383 Vali Acc: 0.270 Test Loss: 1.383 Test Acc: 0.270
Validation loss decreased (-0.216202 --> -0.270256).  Saving model ...
Epoch: 3 cost time: 2.2556090354919434
Epoch: 3, Steps: 10 | Train Loss: 1.381 Vali Loss: 1.375 Vali Acc: 0.270 Test Loss: 1.375 Test Acc: 0.270
Validation loss decreased (-0.270256 --> -0.270257).  Saving model ...
Epoch: 4 cost time: 1.7229952812194824
Epoch: 4, Steps: 10 | Train Loss: 1.350 Vali Loss: 1.402 Vali Acc: 0.257 Test Loss: 1.402 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.3228161334991455
Epoch: 5, Steps: 10 | Train Loss: 1.282 Vali Loss: 1.325 Vali Acc: 0.405 Test Loss: 1.325 Test Acc: 0.405
Validation loss decreased (-0.270257 --> -0.405392).  Saving model ...
Epoch: 6 cost time: 2.2820284366607666
Epoch: 6, Steps: 10 | Train Loss: 1.209 Vali Loss: 1.347 Vali Acc: 0.297 Test Loss: 1.347 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.1674695014953613
Epoch: 7, Steps: 10 | Train Loss: 1.115 Vali Loss: 1.266 Vali Acc: 0.486 Test Loss: 1.266 Test Acc: 0.486
Validation loss decreased (-0.405392 --> -0.486474).  Saving model ...
Epoch: 8 cost time: 2.19818377494812
Epoch: 8, Steps: 10 | Train Loss: 1.033 Vali Loss: 1.258 Vali Acc: 0.473 Test Loss: 1.258 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1026554107666016
Epoch: 9, Steps: 10 | Train Loss: 0.967 Vali Loss: 1.165 Vali Acc: 0.527 Test Loss: 1.165 Test Acc: 0.527
Validation loss decreased (-0.486474 --> -0.527015).  Saving model ...
Epoch: 10 cost time: 2.1549482345581055
Epoch: 10, Steps: 10 | Train Loss: 0.850 Vali Loss: 1.178 Vali Acc: 0.486 Test Loss: 1.178 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.023854970932007
Epoch: 11, Steps: 10 | Train Loss: 0.755 Vali Loss: 1.157 Vali Acc: 0.527 Test Loss: 1.157 Test Acc: 0.527
Validation loss decreased (-0.527015 --> -0.527015).  Saving model ...
Epoch: 12 cost time: 2.0483145713806152
Epoch: 12, Steps: 10 | Train Loss: 0.656 Vali Loss: 1.170 Vali Acc: 0.473 Test Loss: 1.170 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.03244948387146
Epoch: 13, Steps: 10 | Train Loss: 0.546 Vali Loss: 1.159 Vali Acc: 0.568 Test Loss: 1.159 Test Acc: 0.568
Validation loss decreased (-0.527015 --> -0.567556).  Saving model ...
Epoch: 14 cost time: 2.185271739959717
Epoch: 14, Steps: 10 | Train Loss: 0.464 Vali Loss: 1.195 Vali Acc: 0.527 Test Loss: 1.195 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6699352264404297
Epoch: 15, Steps: 10 | Train Loss: 0.398 Vali Loss: 1.240 Vali Acc: 0.500 Test Loss: 1.240 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.8387937545776367
Epoch: 16, Steps: 10 | Train Loss: 0.327 Vali Loss: 1.187 Vali Acc: 0.527 Test Loss: 1.187 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.014436721801758
Epoch: 17, Steps: 10 | Train Loss: 0.284 Vali Loss: 1.258 Vali Acc: 0.527 Test Loss: 1.258 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.903468132019043
Epoch: 18, Steps: 10 | Train Loss: 0.217 Vali Loss: 1.281 Vali Acc: 0.514 Test Loss: 1.281 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.1144325733184814
Epoch: 19, Steps: 10 | Train Loss: 0.162 Vali Loss: 1.281 Vali Acc: 0.541 Test Loss: 1.281 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.2279653549194336
Epoch: 20, Steps: 10 | Train Loss: 0.122 Vali Loss: 1.292 Vali Acc: 0.541 Test Loss: 1.292 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.7433619499206543
Epoch: 21, Steps: 10 | Train Loss: 0.100 Vali Loss: 1.271 Vali Acc: 0.581 Test Loss: 1.271 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581068).  Saving model ...
Epoch: 22 cost time: 1.6661207675933838
Epoch: 22, Steps: 10 | Train Loss: 0.073 Vali Loss: 1.332 Vali Acc: 0.541 Test Loss: 1.332 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.8542304039001465
Epoch: 23, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.310 Vali Acc: 0.500 Test Loss: 1.310 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.6350650787353516
Epoch: 24, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.336 Vali Acc: 0.568 Test Loss: 1.336 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.8972477912902832
Epoch: 25, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.350 Vali Acc: 0.527 Test Loss: 1.350 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.8117773532867432
Epoch: 26, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.348 Vali Acc: 0.568 Test Loss: 1.348 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.089214563369751
Epoch: 27, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.387 Vali Acc: 0.595 Test Loss: 1.387 Test Acc: 0.595
Validation loss decreased (-0.581068 --> -0.594581).  Saving model ...
Epoch: 28 cost time: 2.2490594387054443
Epoch: 28, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.390 Vali Acc: 0.554 Test Loss: 1.390 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.2975940704345703
Epoch: 29, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.367 Vali Acc: 0.527 Test Loss: 1.367 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.8405609130859375
Epoch: 30, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.420 Vali Acc: 0.568 Test Loss: 1.420 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.250032663345337
Epoch: 31, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.425 Vali Acc: 0.568 Test Loss: 1.425 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.864412546157837
Epoch: 32, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.434 Vali Acc: 0.595 Test Loss: 1.434 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.3648061752319336
Epoch: 33, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.446 Vali Acc: 0.568 Test Loss: 1.446 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.354306221008301
Epoch: 34, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.446 Vali Acc: 0.568 Test Loss: 1.446 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 2.058443069458008
Epoch: 35, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.447 Vali Acc: 0.581 Test Loss: 1.447 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.9291763305664062
Epoch: 36, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.470 Vali Acc: 0.581 Test Loss: 1.470 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 2.0199167728424072
Epoch: 37, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.479 Vali Acc: 0.568 Test Loss: 1.479 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 613492
model size : 3.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.749997854232788
Epoch: 1, Steps: 10 | Train Loss: 1.494 Vali Loss: 1.363 Vali Acc: 0.324 Test Loss: 1.363 Test Acc: 0.324
Validation loss decreased (inf --> -0.324311).  Saving model ...
Epoch: 2 cost time: 2.1460747718811035
Epoch: 2, Steps: 10 | Train Loss: 1.409 Vali Loss: 1.386 Vali Acc: 0.230 Test Loss: 1.386 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0964200496673584
Epoch: 3, Steps: 10 | Train Loss: 1.379 Vali Loss: 1.331 Vali Acc: 0.419 Test Loss: 1.331 Test Acc: 0.419
Validation loss decreased (-0.324311 --> -0.418906).  Saving model ...
Epoch: 4 cost time: 1.77152681350708
Epoch: 4, Steps: 10 | Train Loss: 1.361 Vali Loss: 1.325 Vali Acc: 0.338 Test Loss: 1.325 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.374706745147705
Epoch: 5, Steps: 10 | Train Loss: 1.279 Vali Loss: 1.291 Vali Acc: 0.378 Test Loss: 1.291 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.27435040473938
Epoch: 6, Steps: 10 | Train Loss: 1.244 Vali Loss: 1.284 Vali Acc: 0.378 Test Loss: 1.284 Test Acc: 0.378
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.1523780822753906
Epoch: 7, Steps: 10 | Train Loss: 1.180 Vali Loss: 1.218 Vali Acc: 0.500 Test Loss: 1.218 Test Acc: 0.500
Validation loss decreased (-0.418906 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 2.0150773525238037
Epoch: 8, Steps: 10 | Train Loss: 1.047 Vali Loss: 1.186 Vali Acc: 0.486 Test Loss: 1.186 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.306182384490967
Epoch: 9, Steps: 10 | Train Loss: 1.018 Vali Loss: 1.191 Vali Acc: 0.473 Test Loss: 1.191 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.1678876876831055
Epoch: 10, Steps: 10 | Train Loss: 0.881 Vali Loss: 1.124 Vali Acc: 0.486 Test Loss: 1.124 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.94242525100708
Epoch: 11, Steps: 10 | Train Loss: 0.798 Vali Loss: 1.117 Vali Acc: 0.486 Test Loss: 1.117 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.224588394165039
Epoch: 12, Steps: 10 | Train Loss: 0.696 Vali Loss: 1.114 Vali Acc: 0.568 Test Loss: 1.114 Test Acc: 0.568
Validation loss decreased (-0.499988 --> -0.567556).  Saving model ...
Epoch: 13 cost time: 2.1328227519989014
Epoch: 13, Steps: 10 | Train Loss: 0.605 Vali Loss: 1.086 Vali Acc: 0.500 Test Loss: 1.086 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.228961229324341
Epoch: 14, Steps: 10 | Train Loss: 0.524 Vali Loss: 1.142 Vali Acc: 0.554 Test Loss: 1.142 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.1552345752716064
Epoch: 15, Steps: 10 | Train Loss: 0.437 Vali Loss: 1.080 Vali Acc: 0.527 Test Loss: 1.080 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.3839409351348877
Epoch: 16, Steps: 10 | Train Loss: 0.349 Vali Loss: 1.193 Vali Acc: 0.446 Test Loss: 1.193 Test Acc: 0.446
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.342129945755005
Epoch: 17, Steps: 10 | Train Loss: 0.292 Vali Loss: 1.135 Vali Acc: 0.527 Test Loss: 1.135 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.2541260719299316
Epoch: 18, Steps: 10 | Train Loss: 0.263 Vali Loss: 1.253 Vali Acc: 0.446 Test Loss: 1.253 Test Acc: 0.446
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.3410825729370117
Epoch: 19, Steps: 10 | Train Loss: 0.222 Vali Loss: 1.183 Vali Acc: 0.554 Test Loss: 1.183 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.186220407485962
Epoch: 20, Steps: 10 | Train Loss: 0.155 Vali Loss: 1.135 Vali Acc: 0.473 Test Loss: 1.135 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.033561944961548
Epoch: 21, Steps: 10 | Train Loss: 0.135 Vali Loss: 1.178 Vali Acc: 0.554 Test Loss: 1.178 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.469210386276245
Epoch: 22, Steps: 10 | Train Loss: 0.104 Vali Loss: 1.185 Vali Acc: 0.527 Test Loss: 1.185 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 386292
model size : 2.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.823928117752075
Epoch: 1, Steps: 10 | Train Loss: 1.466 Vali Loss: 1.435 Vali Acc: 0.230 Test Loss: 1.435 Test Acc: 0.230
Validation loss decreased (inf --> -0.229715).  Saving model ...
Epoch: 2 cost time: 2.1542816162109375
Epoch: 2, Steps: 10 | Train Loss: 1.477 Vali Loss: 1.481 Vali Acc: 0.203 Test Loss: 1.481 Test Acc: 0.203
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2781524658203125
Epoch: 3, Steps: 10 | Train Loss: 1.394 Vali Loss: 1.393 Vali Acc: 0.324 Test Loss: 1.393 Test Acc: 0.324
Validation loss decreased (-0.229715 --> -0.324310).  Saving model ...
Epoch: 4 cost time: 1.9757773876190186
Epoch: 4, Steps: 10 | Train Loss: 1.358 Vali Loss: 1.369 Vali Acc: 0.297 Test Loss: 1.369 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.146095037460327
Epoch: 5, Steps: 10 | Train Loss: 1.285 Vali Loss: 1.417 Vali Acc: 0.243 Test Loss: 1.417 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8647651672363281
Epoch: 6, Steps: 10 | Train Loss: 1.268 Vali Loss: 1.330 Vali Acc: 0.351 Test Loss: 1.330 Test Acc: 0.351
Validation loss decreased (-0.324310 --> -0.351338).  Saving model ...
Epoch: 7 cost time: 2.0153133869171143
Epoch: 7, Steps: 10 | Train Loss: 1.180 Vali Loss: 1.328 Vali Acc: 0.297 Test Loss: 1.328 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.347166061401367
Epoch: 8, Steps: 10 | Train Loss: 1.126 Vali Loss: 1.312 Vali Acc: 0.392 Test Loss: 1.312 Test Acc: 0.392
Validation loss decreased (-0.351338 --> -0.391879).  Saving model ...
Epoch: 9 cost time: 2.356651544570923
Epoch: 9, Steps: 10 | Train Loss: 1.026 Vali Loss: 1.305 Vali Acc: 0.338 Test Loss: 1.305 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.456359386444092
Epoch: 10, Steps: 10 | Train Loss: 0.894 Vali Loss: 1.286 Vali Acc: 0.405 Test Loss: 1.286 Test Acc: 0.405
Validation loss decreased (-0.391879 --> -0.405393).  Saving model ...
Epoch: 11 cost time: 2.4660823345184326
Epoch: 11, Steps: 10 | Train Loss: 0.849 Vali Loss: 1.254 Vali Acc: 0.432 Test Loss: 1.254 Test Acc: 0.432
Validation loss decreased (-0.405393 --> -0.432420).  Saving model ...
Epoch: 12 cost time: 2.0489988327026367
Epoch: 12, Steps: 10 | Train Loss: 0.770 Vali Loss: 1.223 Vali Acc: 0.473 Test Loss: 1.223 Test Acc: 0.473
Validation loss decreased (-0.432420 --> -0.472961).  Saving model ...
Epoch: 13 cost time: 2.200063705444336
Epoch: 13, Steps: 10 | Train Loss: 0.666 Vali Loss: 1.201 Vali Acc: 0.514 Test Loss: 1.201 Test Acc: 0.514
Validation loss decreased (-0.472961 --> -0.513502).  Saving model ...
Epoch: 14 cost time: 2.0824062824249268
Epoch: 14, Steps: 10 | Train Loss: 0.595 Vali Loss: 1.167 Vali Acc: 0.514 Test Loss: 1.167 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513502).  Saving model ...
Epoch: 15 cost time: 2.65305757522583
Epoch: 15, Steps: 10 | Train Loss: 0.477 Vali Loss: 1.222 Vali Acc: 0.541 Test Loss: 1.222 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540528).  Saving model ...
Epoch: 16 cost time: 1.9008724689483643
Epoch: 16, Steps: 10 | Train Loss: 0.401 Vali Loss: 1.162 Vali Acc: 0.527 Test Loss: 1.162 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.4450900554656982
Epoch: 17, Steps: 10 | Train Loss: 0.334 Vali Loss: 1.150 Vali Acc: 0.541 Test Loss: 1.150 Test Acc: 0.541
Validation loss decreased (-0.540528 --> -0.540529).  Saving model ...
Epoch: 18 cost time: 2.129293441772461
Epoch: 18, Steps: 10 | Train Loss: 0.271 Vali Loss: 1.202 Vali Acc: 0.500 Test Loss: 1.202 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.1701438426971436
Epoch: 19, Steps: 10 | Train Loss: 0.226 Vali Loss: 1.159 Vali Acc: 0.500 Test Loss: 1.159 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.0956058502197266
Epoch: 20, Steps: 10 | Train Loss: 0.164 Vali Loss: 1.177 Vali Acc: 0.554 Test Loss: 1.177 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554042).  Saving model ...
Epoch: 21 cost time: 2.1961870193481445
Epoch: 21, Steps: 10 | Train Loss: 0.127 Vali Loss: 1.191 Vali Acc: 0.514 Test Loss: 1.191 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.510258674621582
Epoch: 22, Steps: 10 | Train Loss: 0.097 Vali Loss: 1.222 Vali Acc: 0.527 Test Loss: 1.222 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.004016160964966
Epoch: 23, Steps: 10 | Train Loss: 0.082 Vali Loss: 1.233 Vali Acc: 0.527 Test Loss: 1.233 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.8022058010101318
Epoch: 24, Steps: 10 | Train Loss: 0.066 Vali Loss: 1.258 Vali Acc: 0.527 Test Loss: 1.258 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.1013710498809814
Epoch: 25, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.225 Vali Acc: 0.527 Test Loss: 1.225 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.8554489612579346
Epoch: 26, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.271 Vali Acc: 0.500 Test Loss: 1.271 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.022350788116455
Epoch: 27, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.292 Vali Acc: 0.486 Test Loss: 1.292 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.0941503047943115
Epoch: 28, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.303 Vali Acc: 0.514 Test Loss: 1.303 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.873474359512329
Epoch: 29, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.323 Vali Acc: 0.500 Test Loss: 1.323 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.2451889514923096
Epoch: 30, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.302 Vali Acc: 0.527 Test Loss: 1.302 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 384372
model size : 2.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.7235941886901855
Epoch: 1, Steps: 10 | Train Loss: 1.441 Vali Loss: 1.377 Vali Acc: 0.257 Test Loss: 1.377 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 2.05111026763916
Epoch: 2, Steps: 10 | Train Loss: 1.453 Vali Loss: 1.443 Vali Acc: 0.216 Test Loss: 1.443 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0840418338775635
Epoch: 3, Steps: 10 | Train Loss: 1.396 Vali Loss: 1.316 Vali Acc: 0.405 Test Loss: 1.316 Test Acc: 0.405
Validation loss decreased (-0.256743 --> -0.405392).  Saving model ...
Epoch: 4 cost time: 2.0746266841888428
Epoch: 4, Steps: 10 | Train Loss: 1.362 Vali Loss: 1.363 Vali Acc: 0.243 Test Loss: 1.363 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8520081043243408
Epoch: 5, Steps: 10 | Train Loss: 1.344 Vali Loss: 1.330 Vali Acc: 0.365 Test Loss: 1.330 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7529735565185547
Epoch: 6, Steps: 10 | Train Loss: 1.290 Vali Loss: 1.303 Vali Acc: 0.405 Test Loss: 1.303 Test Acc: 0.405
Validation loss decreased (-0.405392 --> -0.405392).  Saving model ...
Epoch: 7 cost time: 1.9540355205535889
Epoch: 7, Steps: 10 | Train Loss: 1.224 Vali Loss: 1.276 Vali Acc: 0.459 Test Loss: 1.276 Test Acc: 0.459
Validation loss decreased (-0.405392 --> -0.459447).  Saving model ...
Epoch: 8 cost time: 2.3520302772521973
Epoch: 8, Steps: 10 | Train Loss: 1.155 Vali Loss: 1.214 Vali Acc: 0.486 Test Loss: 1.214 Test Acc: 0.486
Validation loss decreased (-0.459447 --> -0.486474).  Saving model ...
Epoch: 9 cost time: 2.1791670322418213
Epoch: 9, Steps: 10 | Train Loss: 1.086 Vali Loss: 1.195 Vali Acc: 0.486 Test Loss: 1.195 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486475).  Saving model ...
Epoch: 10 cost time: 2.212639331817627
Epoch: 10, Steps: 10 | Train Loss: 0.951 Vali Loss: 1.109 Vali Acc: 0.568 Test Loss: 1.109 Test Acc: 0.568
Validation loss decreased (-0.486475 --> -0.567556).  Saving model ...
Epoch: 11 cost time: 2.2211644649505615
Epoch: 11, Steps: 10 | Train Loss: 0.844 Vali Loss: 1.176 Vali Acc: 0.527 Test Loss: 1.176 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8900487422943115
Epoch: 12, Steps: 10 | Train Loss: 0.789 Vali Loss: 1.078 Vali Acc: 0.541 Test Loss: 1.078 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.3036983013153076
Epoch: 13, Steps: 10 | Train Loss: 0.692 Vali Loss: 1.103 Vali Acc: 0.527 Test Loss: 1.103 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.36926007270813
Epoch: 14, Steps: 10 | Train Loss: 0.601 Vali Loss: 1.085 Vali Acc: 0.514 Test Loss: 1.085 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.7447397708892822
Epoch: 15, Steps: 10 | Train Loss: 0.537 Vali Loss: 1.084 Vali Acc: 0.581 Test Loss: 1.084 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581070).  Saving model ...
Epoch: 16 cost time: 2.3202412128448486
Epoch: 16, Steps: 10 | Train Loss: 0.451 Vali Loss: 1.058 Vali Acc: 0.554 Test Loss: 1.058 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.185702085494995
Epoch: 17, Steps: 10 | Train Loss: 0.389 Vali Loss: 1.141 Vali Acc: 0.514 Test Loss: 1.141 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.9428894519805908
Epoch: 18, Steps: 10 | Train Loss: 0.297 Vali Loss: 1.107 Vali Acc: 0.514 Test Loss: 1.107 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.017878770828247
Epoch: 19, Steps: 10 | Train Loss: 0.250 Vali Loss: 1.239 Vali Acc: 0.473 Test Loss: 1.239 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.0237362384796143
Epoch: 20, Steps: 10 | Train Loss: 0.208 Vali Loss: 1.132 Vali Acc: 0.581 Test Loss: 1.132 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.8713557720184326
Epoch: 21, Steps: 10 | Train Loss: 0.174 Vali Loss: 1.253 Vali Acc: 0.486 Test Loss: 1.253 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.4392387866973877
Epoch: 22, Steps: 10 | Train Loss: 0.149 Vali Loss: 1.183 Vali Acc: 0.554 Test Loss: 1.183 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.8591926097869873
Epoch: 23, Steps: 10 | Train Loss: 0.106 Vali Loss: 1.232 Vali Acc: 0.514 Test Loss: 1.232 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.11730694770813
Epoch: 24, Steps: 10 | Train Loss: 0.081 Vali Loss: 1.341 Vali Acc: 0.527 Test Loss: 1.341 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.110604763031006
Epoch: 25, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.280 Vali Acc: 0.527 Test Loss: 1.280 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 382452
model size : 2.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.608802080154419
Epoch: 1, Steps: 10 | Train Loss: 1.472 Vali Loss: 1.338 Vali Acc: 0.392 Test Loss: 1.338 Test Acc: 0.392
Validation loss decreased (inf --> -0.391879).  Saving model ...
Epoch: 2 cost time: 1.8563556671142578
Epoch: 2, Steps: 10 | Train Loss: 1.430 Vali Loss: 1.309 Vali Acc: 0.392 Test Loss: 1.309 Test Acc: 0.392
Validation loss decreased (-0.391879 --> -0.391879).  Saving model ...
Epoch: 3 cost time: 2.1618010997772217
Epoch: 3, Steps: 10 | Train Loss: 1.353 Vali Loss: 1.390 Vali Acc: 0.311 Test Loss: 1.390 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.705519437789917
Epoch: 4, Steps: 10 | Train Loss: 1.389 Vali Loss: 1.319 Vali Acc: 0.324 Test Loss: 1.319 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.102358818054199
Epoch: 5, Steps: 10 | Train Loss: 1.322 Vali Loss: 1.287 Vali Acc: 0.351 Test Loss: 1.287 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.248957872390747
Epoch: 6, Steps: 10 | Train Loss: 1.301 Vali Loss: 1.284 Vali Acc: 0.432 Test Loss: 1.284 Test Acc: 0.432
Validation loss decreased (-0.391879 --> -0.432420).  Saving model ...
Epoch: 7 cost time: 2.216299295425415
Epoch: 7, Steps: 10 | Train Loss: 1.227 Vali Loss: 1.220 Vali Acc: 0.486 Test Loss: 1.220 Test Acc: 0.486
Validation loss decreased (-0.432420 --> -0.486474).  Saving model ...
Epoch: 8 cost time: 2.0053751468658447
Epoch: 8, Steps: 10 | Train Loss: 1.133 Vali Loss: 1.251 Vali Acc: 0.459 Test Loss: 1.251 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1204721927642822
Epoch: 9, Steps: 10 | Train Loss: 1.015 Vali Loss: 1.151 Vali Acc: 0.486 Test Loss: 1.151 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486475).  Saving model ...
Epoch: 10 cost time: 2.1063811779022217
Epoch: 10, Steps: 10 | Train Loss: 0.921 Vali Loss: 1.192 Vali Acc: 0.432 Test Loss: 1.192 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.05722975730896
Epoch: 11, Steps: 10 | Train Loss: 0.822 Vali Loss: 1.145 Vali Acc: 0.514 Test Loss: 1.145 Test Acc: 0.514
Validation loss decreased (-0.486475 --> -0.513502).  Saving model ...
Epoch: 12 cost time: 2.072235107421875
Epoch: 12, Steps: 10 | Train Loss: 0.708 Vali Loss: 1.161 Vali Acc: 0.446 Test Loss: 1.161 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9815866947174072
Epoch: 13, Steps: 10 | Train Loss: 0.633 Vali Loss: 1.077 Vali Acc: 0.541 Test Loss: 1.077 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540530).  Saving model ...
Epoch: 14 cost time: 1.9073631763458252
Epoch: 14, Steps: 10 | Train Loss: 0.514 Vali Loss: 1.116 Vali Acc: 0.486 Test Loss: 1.116 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.106743097305298
Epoch: 15, Steps: 10 | Train Loss: 0.439 Vali Loss: 1.121 Vali Acc: 0.473 Test Loss: 1.121 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.043694257736206
Epoch: 16, Steps: 10 | Train Loss: 0.356 Vali Loss: 1.130 Vali Acc: 0.486 Test Loss: 1.130 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.8920626640319824
Epoch: 17, Steps: 10 | Train Loss: 0.310 Vali Loss: 1.133 Vali Acc: 0.527 Test Loss: 1.133 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.831310510635376
Epoch: 18, Steps: 10 | Train Loss: 0.267 Vali Loss: 1.170 Vali Acc: 0.459 Test Loss: 1.170 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.2026865482330322
Epoch: 19, Steps: 10 | Train Loss: 0.210 Vali Loss: 1.151 Vali Acc: 0.486 Test Loss: 1.151 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.2938852310180664
Epoch: 20, Steps: 10 | Train Loss: 0.155 Vali Loss: 1.179 Vali Acc: 0.541 Test Loss: 1.179 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.7706236839294434
Epoch: 21, Steps: 10 | Train Loss: 0.139 Vali Loss: 1.244 Vali Acc: 0.446 Test Loss: 1.244 Test Acc: 0.446
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.8239591121673584
Epoch: 22, Steps: 10 | Train Loss: 0.098 Vali Loss: 1.211 Vali Acc: 0.527 Test Loss: 1.211 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.3282370567321777
Epoch: 23, Steps: 10 | Train Loss: 0.081 Vali Loss: 1.240 Vali Acc: 0.541 Test Loss: 1.240 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 380532
model size : 2.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.195941209793091
Epoch: 1, Steps: 10 | Train Loss: 1.460 Vali Loss: 1.403 Vali Acc: 0.284 Test Loss: 1.403 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 2.5746724605560303
Epoch: 2, Steps: 10 | Train Loss: 1.410 Vali Loss: 1.355 Vali Acc: 0.270 Test Loss: 1.355 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.297816276550293
Epoch: 3, Steps: 10 | Train Loss: 1.353 Vali Loss: 1.375 Vali Acc: 0.351 Test Loss: 1.375 Test Acc: 0.351
Validation loss decreased (-0.283770 --> -0.351338).  Saving model ...
Epoch: 4 cost time: 2.1094701290130615
Epoch: 4, Steps: 10 | Train Loss: 1.333 Vali Loss: 1.322 Vali Acc: 0.365 Test Loss: 1.322 Test Acc: 0.365
Validation loss decreased (-0.351338 --> -0.364852).  Saving model ...
Epoch: 5 cost time: 2.1447741985321045
Epoch: 5, Steps: 10 | Train Loss: 1.259 Vali Loss: 1.310 Vali Acc: 0.378 Test Loss: 1.310 Test Acc: 0.378
Validation loss decreased (-0.364852 --> -0.378365).  Saving model ...
Epoch: 6 cost time: 1.837035894393921
Epoch: 6, Steps: 10 | Train Loss: 1.205 Vali Loss: 1.305 Vali Acc: 0.378 Test Loss: 1.305 Test Acc: 0.378
Validation loss decreased (-0.378365 --> -0.378365).  Saving model ...
Epoch: 7 cost time: 1.780242681503296
Epoch: 7, Steps: 10 | Train Loss: 1.163 Vali Loss: 1.251 Vali Acc: 0.432 Test Loss: 1.251 Test Acc: 0.432
Validation loss decreased (-0.378365 --> -0.432420).  Saving model ...
Epoch: 8 cost time: 2.161712884902954
Epoch: 8, Steps: 10 | Train Loss: 1.074 Vali Loss: 1.209 Vali Acc: 0.432 Test Loss: 1.209 Test Acc: 0.432
Validation loss decreased (-0.432420 --> -0.432420).  Saving model ...
Epoch: 9 cost time: 2.017775535583496
Epoch: 9, Steps: 10 | Train Loss: 1.005 Vali Loss: 1.193 Vali Acc: 0.432 Test Loss: 1.193 Test Acc: 0.432
Validation loss decreased (-0.432420 --> -0.432421).  Saving model ...
Epoch: 10 cost time: 2.4086432456970215
Epoch: 10, Steps: 10 | Train Loss: 0.867 Vali Loss: 1.170 Vali Acc: 0.473 Test Loss: 1.170 Test Acc: 0.473
Validation loss decreased (-0.432421 --> -0.472961).  Saving model ...
Epoch: 11 cost time: 1.9532761573791504
Epoch: 11, Steps: 10 | Train Loss: 0.801 Vali Loss: 1.130 Vali Acc: 0.486 Test Loss: 1.130 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486475).  Saving model ...
Epoch: 12 cost time: 2.0235917568206787
Epoch: 12, Steps: 10 | Train Loss: 0.703 Vali Loss: 1.131 Vali Acc: 0.486 Test Loss: 1.131 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.030604362487793
Epoch: 13, Steps: 10 | Train Loss: 0.658 Vali Loss: 1.067 Vali Acc: 0.581 Test Loss: 1.067 Test Acc: 0.581
Validation loss decreased (-0.486475 --> -0.581070).  Saving model ...
Epoch: 14 cost time: 1.8405864238739014
Epoch: 14, Steps: 10 | Train Loss: 0.568 Vali Loss: 1.093 Vali Acc: 0.514 Test Loss: 1.093 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8778045177459717
Epoch: 15, Steps: 10 | Train Loss: 0.488 Vali Loss: 1.080 Vali Acc: 0.554 Test Loss: 1.080 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.0062782764434814
Epoch: 16, Steps: 10 | Train Loss: 0.417 Vali Loss: 1.087 Vali Acc: 0.541 Test Loss: 1.087 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.0863029956817627
Epoch: 17, Steps: 10 | Train Loss: 0.338 Vali Loss: 1.090 Vali Acc: 0.554 Test Loss: 1.090 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.1619315147399902
Epoch: 18, Steps: 10 | Train Loss: 0.281 Vali Loss: 1.134 Vali Acc: 0.568 Test Loss: 1.134 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.4020674228668213
Epoch: 19, Steps: 10 | Train Loss: 0.224 Vali Loss: 1.136 Vali Acc: 0.554 Test Loss: 1.136 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.497540235519409
Epoch: 20, Steps: 10 | Train Loss: 0.201 Vali Loss: 1.147 Vali Acc: 0.514 Test Loss: 1.147 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.2450737953186035
Epoch: 21, Steps: 10 | Train Loss: 0.154 Vali Loss: 1.185 Vali Acc: 0.527 Test Loss: 1.185 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.4360527992248535
Epoch: 22, Steps: 10 | Train Loss: 0.121 Vali Loss: 1.206 Vali Acc: 0.541 Test Loss: 1.206 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.849097490310669
Epoch: 23, Steps: 10 | Train Loss: 0.094 Vali Loss: 1.265 Vali Acc: 0.486 Test Loss: 1.265 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 269812
model size : 1.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.7500827312469482
Epoch: 1, Steps: 10 | Train Loss: 1.451 Vali Loss: 1.389 Vali Acc: 0.284 Test Loss: 1.389 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 2.1989822387695312
Epoch: 2, Steps: 10 | Train Loss: 1.390 Vali Loss: 1.383 Vali Acc: 0.365 Test Loss: 1.383 Test Acc: 0.365
Validation loss decreased (-0.283770 --> -0.364851).  Saving model ...
Epoch: 3 cost time: 2.0524919033050537
Epoch: 3, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.393 Vali Acc: 0.324 Test Loss: 1.393 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.378566026687622
Epoch: 4, Steps: 10 | Train Loss: 1.359 Vali Loss: 1.375 Vali Acc: 0.243 Test Loss: 1.375 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.37259840965271
Epoch: 5, Steps: 10 | Train Loss: 1.366 Vali Loss: 1.400 Vali Acc: 0.392 Test Loss: 1.400 Test Acc: 0.392
Validation loss decreased (-0.364851 --> -0.391878).  Saving model ...
Epoch: 6 cost time: 1.7913336753845215
Epoch: 6, Steps: 10 | Train Loss: 1.264 Vali Loss: 1.298 Vali Acc: 0.392 Test Loss: 1.298 Test Acc: 0.392
Validation loss decreased (-0.391878 --> -0.391879).  Saving model ...
Epoch: 7 cost time: 1.7401371002197266
Epoch: 7, Steps: 10 | Train Loss: 1.238 Vali Loss: 1.436 Vali Acc: 0.257 Test Loss: 1.436 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8451378345489502
Epoch: 8, Steps: 10 | Train Loss: 1.120 Vali Loss: 1.243 Vali Acc: 0.459 Test Loss: 1.243 Test Acc: 0.459
Validation loss decreased (-0.391879 --> -0.459447).  Saving model ...
Epoch: 9 cost time: 1.8103890419006348
Epoch: 9, Steps: 10 | Train Loss: 1.048 Vali Loss: 1.274 Vali Acc: 0.473 Test Loss: 1.274 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472960).  Saving model ...
Epoch: 10 cost time: 1.842120885848999
Epoch: 10, Steps: 10 | Train Loss: 0.946 Vali Loss: 1.253 Vali Acc: 0.419 Test Loss: 1.253 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8857755661010742
Epoch: 11, Steps: 10 | Train Loss: 0.866 Vali Loss: 1.232 Vali Acc: 0.500 Test Loss: 1.232 Test Acc: 0.500
Validation loss decreased (-0.472960 --> -0.499988).  Saving model ...
Epoch: 12 cost time: 2.1652753353118896
Epoch: 12, Steps: 10 | Train Loss: 0.736 Vali Loss: 1.186 Vali Acc: 0.500 Test Loss: 1.186 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 13 cost time: 1.8812782764434814
Epoch: 13, Steps: 10 | Train Loss: 0.659 Vali Loss: 1.244 Vali Acc: 0.446 Test Loss: 1.244 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.2675089836120605
Epoch: 14, Steps: 10 | Train Loss: 0.580 Vali Loss: 1.187 Vali Acc: 0.459 Test Loss: 1.187 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.339430570602417
Epoch: 15, Steps: 10 | Train Loss: 0.507 Vali Loss: 1.226 Vali Acc: 0.473 Test Loss: 1.226 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.2661240100860596
Epoch: 16, Steps: 10 | Train Loss: 0.461 Vali Loss: 1.197 Vali Acc: 0.459 Test Loss: 1.197 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.951688528060913
Epoch: 17, Steps: 10 | Train Loss: 0.359 Vali Loss: 1.215 Vali Acc: 0.405 Test Loss: 1.215 Test Acc: 0.405
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.1811656951904297
Epoch: 18, Steps: 10 | Train Loss: 0.307 Vali Loss: 1.190 Vali Acc: 0.500 Test Loss: 1.190 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.127354621887207
Epoch: 19, Steps: 10 | Train Loss: 0.240 Vali Loss: 1.218 Vali Acc: 0.446 Test Loss: 1.218 Test Acc: 0.446
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.540834665298462
Epoch: 20, Steps: 10 | Train Loss: 0.195 Vali Loss: 1.233 Vali Acc: 0.514 Test Loss: 1.233 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513501).  Saving model ...
Epoch: 21 cost time: 1.8789942264556885
Epoch: 21, Steps: 10 | Train Loss: 0.159 Vali Loss: 1.299 Vali Acc: 0.459 Test Loss: 1.299 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.165112018585205
Epoch: 22, Steps: 10 | Train Loss: 0.151 Vali Loss: 1.291 Vali Acc: 0.514 Test Loss: 1.291 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.9720797538757324
Epoch: 23, Steps: 10 | Train Loss: 0.107 Vali Loss: 1.315 Vali Acc: 0.500 Test Loss: 1.315 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.429227828979492
Epoch: 24, Steps: 10 | Train Loss: 0.082 Vali Loss: 1.304 Vali Acc: 0.514 Test Loss: 1.304 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.348397970199585
Epoch: 25, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.356 Vali Acc: 0.541 Test Loss: 1.356 Test Acc: 0.541
Validation loss decreased (-0.513501 --> -0.540527).  Saving model ...
Epoch: 26 cost time: 1.45011305809021
Epoch: 26, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.354 Vali Acc: 0.527 Test Loss: 1.354 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.234637498855591
Epoch: 27, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.352 Vali Acc: 0.541 Test Loss: 1.352 Test Acc: 0.541
Validation loss decreased (-0.540527 --> -0.540527).  Saving model ...
Epoch: 28 cost time: 2.0311989784240723
Epoch: 28, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.384 Vali Acc: 0.541 Test Loss: 1.384 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.0327460765838623
Epoch: 29, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.418 Vali Acc: 0.527 Test Loss: 1.418 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.188481092453003
Epoch: 30, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.385 Vali Acc: 0.541 Test Loss: 1.385 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.8390929698944092
Epoch: 31, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.433 Vali Acc: 0.541 Test Loss: 1.433 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.125643491744995
Epoch: 32, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.417 Vali Acc: 0.541 Test Loss: 1.417 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.3444173336029053
Epoch: 33, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.453 Vali Acc: 0.554 Test Loss: 1.453 Test Acc: 0.554
Validation loss decreased (-0.540527 --> -0.554040).  Saving model ...
Epoch: 34 cost time: 1.8995227813720703
Epoch: 34, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.467 Vali Acc: 0.554 Test Loss: 1.467 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.4511911869049072
Epoch: 35, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.477 Vali Acc: 0.554 Test Loss: 1.477 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.3338308334350586
Epoch: 36, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.461 Vali Acc: 0.554 Test Loss: 1.461 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.044755697250366
Epoch: 37, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.482 Vali Acc: 0.568 Test Loss: 1.482 Test Acc: 0.568
Validation loss decreased (-0.554040 --> -0.567553).  Saving model ...
Epoch: 38 cost time: 2.2969491481781006
Epoch: 38, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.488 Vali Acc: 0.554 Test Loss: 1.488 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.3623762130737305
Epoch: 39, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.498 Vali Acc: 0.554 Test Loss: 1.498 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 2.042843818664551
Epoch: 40, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.503 Vali Acc: 0.554 Test Loss: 1.503 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.8980329036712646
Epoch: 41, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.516 Vali Acc: 0.554 Test Loss: 1.516 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 2.3571722507476807
Epoch: 42, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.522 Vali Acc: 0.581 Test Loss: 1.522 Test Acc: 0.581
Validation loss decreased (-0.567553 --> -0.581066).  Saving model ...
Epoch: 43 cost time: 2.388822078704834
Epoch: 43, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.523 Vali Acc: 0.541 Test Loss: 1.523 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.8610100746154785
Epoch: 44, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.535 Vali Acc: 0.568 Test Loss: 1.535 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.8941349983215332
Epoch: 45, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.574 Vali Acc: 0.568 Test Loss: 1.574 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 2.0100255012512207
Epoch: 46, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.559 Vali Acc: 0.541 Test Loss: 1.559 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 2.2881269454956055
Epoch: 47, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.572 Vali Acc: 0.568 Test Loss: 1.572 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 2.1819746494293213
Epoch: 48, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.581 Vali Acc: 0.568 Test Loss: 1.581 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 2.1737618446350098
Epoch: 49, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.591 Vali Acc: 0.541 Test Loss: 1.591 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 2.13397479057312
Epoch: 50, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.585 Vali Acc: 0.541 Test Loss: 1.585 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 2.0850913524627686
Epoch: 51, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.588 Vali Acc: 0.568 Test Loss: 1.588 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 1.9596202373504639
Epoch: 52, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.602 Vali Acc: 0.568 Test Loss: 1.602 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 267892
model size : 1.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.593439817428589
Epoch: 1, Steps: 10 | Train Loss: 1.450 Vali Loss: 1.427 Vali Acc: 0.189 Test Loss: 1.427 Test Acc: 0.189
Validation loss decreased (inf --> -0.189175).  Saving model ...
Epoch: 2 cost time: 1.8976335525512695
Epoch: 2, Steps: 10 | Train Loss: 1.452 Vali Loss: 1.440 Vali Acc: 0.189 Test Loss: 1.440 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.174103021621704
Epoch: 3, Steps: 10 | Train Loss: 1.414 Vali Loss: 1.375 Vali Acc: 0.297 Test Loss: 1.375 Test Acc: 0.297
Validation loss decreased (-0.189175 --> -0.297284).  Saving model ...
Epoch: 4 cost time: 1.9234187602996826
Epoch: 4, Steps: 10 | Train Loss: 1.394 Vali Loss: 1.470 Vali Acc: 0.216 Test Loss: 1.470 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.178422212600708
Epoch: 5, Steps: 10 | Train Loss: 1.321 Vali Loss: 1.336 Vali Acc: 0.378 Test Loss: 1.336 Test Acc: 0.378
Validation loss decreased (-0.297284 --> -0.378365).  Saving model ...
Epoch: 6 cost time: 1.8005101680755615
Epoch: 6, Steps: 10 | Train Loss: 1.277 Vali Loss: 1.372 Vali Acc: 0.284 Test Loss: 1.372 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.2289040088653564
Epoch: 7, Steps: 10 | Train Loss: 1.263 Vali Loss: 1.302 Vali Acc: 0.351 Test Loss: 1.302 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.2518484592437744
Epoch: 8, Steps: 10 | Train Loss: 1.180 Vali Loss: 1.303 Vali Acc: 0.324 Test Loss: 1.303 Test Acc: 0.324
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7831716537475586
Epoch: 9, Steps: 10 | Train Loss: 1.099 Vali Loss: 1.301 Vali Acc: 0.324 Test Loss: 1.301 Test Acc: 0.324
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.8740406036376953
Epoch: 10, Steps: 10 | Train Loss: 0.959 Vali Loss: 1.216 Vali Acc: 0.446 Test Loss: 1.216 Test Acc: 0.446
Validation loss decreased (-0.378365 --> -0.445934).  Saving model ...
Epoch: 11 cost time: 2.0781896114349365
Epoch: 11, Steps: 10 | Train Loss: 0.903 Vali Loss: 1.147 Vali Acc: 0.459 Test Loss: 1.147 Test Acc: 0.459
Validation loss decreased (-0.445934 --> -0.459448).  Saving model ...
Epoch: 12 cost time: 2.4252607822418213
Epoch: 12, Steps: 10 | Train Loss: 0.788 Vali Loss: 1.139 Vali Acc: 0.446 Test Loss: 1.139 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.007746696472168
Epoch: 13, Steps: 10 | Train Loss: 0.718 Vali Loss: 1.090 Vali Acc: 0.500 Test Loss: 1.090 Test Acc: 0.500
Validation loss decreased (-0.459448 --> -0.499989).  Saving model ...
Epoch: 14 cost time: 2.213273286819458
Epoch: 14, Steps: 10 | Train Loss: 0.648 Vali Loss: 1.113 Vali Acc: 0.459 Test Loss: 1.113 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.7380034923553467
Epoch: 15, Steps: 10 | Train Loss: 0.565 Vali Loss: 1.058 Vali Acc: 0.486 Test Loss: 1.058 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.100005626678467
Epoch: 16, Steps: 10 | Train Loss: 0.481 Vali Loss: 1.115 Vali Acc: 0.473 Test Loss: 1.115 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.1836628913879395
Epoch: 17, Steps: 10 | Train Loss: 0.431 Vali Loss: 1.037 Vali Acc: 0.554 Test Loss: 1.037 Test Acc: 0.554
Validation loss decreased (-0.499989 --> -0.554044).  Saving model ...
Epoch: 18 cost time: 2.121995449066162
Epoch: 18, Steps: 10 | Train Loss: 0.352 Vali Loss: 1.069 Vali Acc: 0.500 Test Loss: 1.069 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.034252643585205
Epoch: 19, Steps: 10 | Train Loss: 0.298 Vali Loss: 1.034 Vali Acc: 0.527 Test Loss: 1.034 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.5393259525299072
Epoch: 20, Steps: 10 | Train Loss: 0.232 Vali Loss: 1.056 Vali Acc: 0.527 Test Loss: 1.056 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.4585518836975098
Epoch: 21, Steps: 10 | Train Loss: 0.173 Vali Loss: 1.090 Vali Acc: 0.541 Test Loss: 1.090 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.2700815200805664
Epoch: 22, Steps: 10 | Train Loss: 0.143 Vali Loss: 1.043 Vali Acc: 0.527 Test Loss: 1.043 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.9556231498718262
Epoch: 23, Steps: 10 | Train Loss: 0.118 Vali Loss: 1.131 Vali Acc: 0.527 Test Loss: 1.131 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.371541976928711
Epoch: 24, Steps: 10 | Train Loss: 0.085 Vali Loss: 1.132 Vali Acc: 0.568 Test Loss: 1.132 Test Acc: 0.568
Validation loss decreased (-0.554044 --> -0.567556).  Saving model ...
Epoch: 25 cost time: 2.342372179031372
Epoch: 25, Steps: 10 | Train Loss: 0.073 Vali Loss: 1.120 Vali Acc: 0.554 Test Loss: 1.120 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.1634461879730225
Epoch: 26, Steps: 10 | Train Loss: 0.063 Vali Loss: 1.141 Vali Acc: 0.527 Test Loss: 1.141 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.186790704727173
Epoch: 27, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.169 Vali Acc: 0.527 Test Loss: 1.169 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.1064488887786865
Epoch: 28, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.203 Vali Acc: 0.527 Test Loss: 1.203 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.3273537158966064
Epoch: 29, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.168 Vali Acc: 0.514 Test Loss: 1.168 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.1107027530670166
Epoch: 30, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.184 Vali Acc: 0.541 Test Loss: 1.184 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.1347134113311768
Epoch: 31, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.203 Vali Acc: 0.527 Test Loss: 1.203 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.8218402862548828
Epoch: 32, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.213 Vali Acc: 0.541 Test Loss: 1.213 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.012186288833618
Epoch: 33, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.226 Vali Acc: 0.541 Test Loss: 1.226 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.8815226554870605
Epoch: 34, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.321 Vali Acc: 0.514 Test Loss: 1.321 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 265972
model size : 1.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.473280191421509
Epoch: 1, Steps: 10 | Train Loss: 1.430 Vali Loss: 1.405 Vali Acc: 0.216 Test Loss: 1.405 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 2.1620028018951416
Epoch: 2, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.400 Vali Acc: 0.243 Test Loss: 1.400 Test Acc: 0.243
Validation loss decreased (-0.216202 --> -0.243229).  Saving model ...
Epoch: 3 cost time: 2.504237413406372
Epoch: 3, Steps: 10 | Train Loss: 1.346 Vali Loss: 1.384 Vali Acc: 0.230 Test Loss: 1.384 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.146456003189087
Epoch: 4, Steps: 10 | Train Loss: 1.367 Vali Loss: 1.356 Vali Acc: 0.459 Test Loss: 1.356 Test Acc: 0.459
Validation loss decreased (-0.243229 --> -0.459446).  Saving model ...
Epoch: 5 cost time: 1.8386750221252441
Epoch: 5, Steps: 10 | Train Loss: 1.306 Vali Loss: 1.396 Vali Acc: 0.203 Test Loss: 1.396 Test Acc: 0.203
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.4430363178253174
Epoch: 6, Steps: 10 | Train Loss: 1.259 Vali Loss: 1.338 Vali Acc: 0.500 Test Loss: 1.338 Test Acc: 0.500
Validation loss decreased (-0.459446 --> -0.499987).  Saving model ...
Epoch: 7 cost time: 1.6905014514923096
Epoch: 7, Steps: 10 | Train Loss: 1.198 Vali Loss: 1.324 Vali Acc: 0.338 Test Loss: 1.324 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.070007085800171
Epoch: 8, Steps: 10 | Train Loss: 1.105 Vali Loss: 1.287 Vali Acc: 0.446 Test Loss: 1.287 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.3273627758026123
Epoch: 9, Steps: 10 | Train Loss: 1.011 Vali Loss: 1.278 Vali Acc: 0.419 Test Loss: 1.278 Test Acc: 0.419
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.1408309936523438
Epoch: 10, Steps: 10 | Train Loss: 0.898 Vali Loss: 1.185 Vali Acc: 0.473 Test Loss: 1.185 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.212254047393799
Epoch: 11, Steps: 10 | Train Loss: 0.824 Vali Loss: 1.212 Vali Acc: 0.486 Test Loss: 1.212 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.180760145187378
Epoch: 12, Steps: 10 | Train Loss: 0.706 Vali Loss: 1.141 Vali Acc: 0.486 Test Loss: 1.141 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.2076306343078613
Epoch: 13, Steps: 10 | Train Loss: 0.623 Vali Loss: 1.214 Vali Acc: 0.432 Test Loss: 1.214 Test Acc: 0.432
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.1019678115844727
Epoch: 14, Steps: 10 | Train Loss: 0.584 Vali Loss: 1.133 Vali Acc: 0.473 Test Loss: 1.133 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.059715986251831
Epoch: 15, Steps: 10 | Train Loss: 0.487 Vali Loss: 1.205 Vali Acc: 0.486 Test Loss: 1.205 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.083254098892212
Epoch: 16, Steps: 10 | Train Loss: 0.406 Vali Loss: 1.124 Vali Acc: 0.527 Test Loss: 1.124 Test Acc: 0.527
Validation loss decreased (-0.499987 --> -0.527016).  Saving model ...
Epoch: 17 cost time: 2.016693115234375
Epoch: 17, Steps: 10 | Train Loss: 0.348 Vali Loss: 1.236 Vali Acc: 0.527 Test Loss: 1.236 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.9722862243652344
Epoch: 18, Steps: 10 | Train Loss: 0.316 Vali Loss: 1.199 Vali Acc: 0.500 Test Loss: 1.199 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.5036983489990234
Epoch: 19, Steps: 10 | Train Loss: 0.238 Vali Loss: 1.269 Vali Acc: 0.514 Test Loss: 1.269 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.1382734775543213
Epoch: 20, Steps: 10 | Train Loss: 0.199 Vali Loss: 1.203 Vali Acc: 0.486 Test Loss: 1.203 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.9050164222717285
Epoch: 21, Steps: 10 | Train Loss: 0.160 Vali Loss: 1.270 Vali Acc: 0.486 Test Loss: 1.270 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.1474578380584717
Epoch: 22, Steps: 10 | Train Loss: 0.134 Vali Loss: 1.253 Vali Acc: 0.486 Test Loss: 1.253 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.96671462059021
Epoch: 23, Steps: 10 | Train Loss: 0.102 Vali Loss: 1.277 Vali Acc: 0.514 Test Loss: 1.277 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.0730762481689453
Epoch: 24, Steps: 10 | Train Loss: 0.087 Vali Loss: 1.298 Vali Acc: 0.500 Test Loss: 1.298 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.3697097301483154
Epoch: 25, Steps: 10 | Train Loss: 0.074 Vali Loss: 1.363 Vali Acc: 0.486 Test Loss: 1.363 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.205573320388794
Epoch: 26, Steps: 10 | Train Loss: 0.065 Vali Loss: 1.390 Vali Acc: 0.473 Test Loss: 1.390 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 264052
model size : 1.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.7644400596618652
Epoch: 1, Steps: 10 | Train Loss: 1.458 Vali Loss: 1.385 Vali Acc: 0.351 Test Loss: 1.385 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 1.815218448638916
Epoch: 2, Steps: 10 | Train Loss: 1.475 Vali Loss: 1.352 Vali Acc: 0.405 Test Loss: 1.352 Test Acc: 0.405
Validation loss decreased (-0.351338 --> -0.405392).  Saving model ...
Epoch: 3 cost time: 1.9121615886688232
Epoch: 3, Steps: 10 | Train Loss: 1.391 Vali Loss: 1.367 Vali Acc: 0.270 Test Loss: 1.367 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.892198085784912
Epoch: 4, Steps: 10 | Train Loss: 1.388 Vali Loss: 1.340 Vali Acc: 0.351 Test Loss: 1.340 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.2889904975891113
Epoch: 5, Steps: 10 | Train Loss: 1.372 Vali Loss: 1.320 Vali Acc: 0.432 Test Loss: 1.320 Test Acc: 0.432
Validation loss decreased (-0.405392 --> -0.432419).  Saving model ...
Epoch: 6 cost time: 1.7069263458251953
Epoch: 6, Steps: 10 | Train Loss: 1.371 Vali Loss: 1.294 Vali Acc: 0.378 Test Loss: 1.294 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0505945682525635
Epoch: 7, Steps: 10 | Train Loss: 1.266 Vali Loss: 1.347 Vali Acc: 0.297 Test Loss: 1.347 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.0446465015411377
Epoch: 8, Steps: 10 | Train Loss: 1.171 Vali Loss: 1.225 Vali Acc: 0.473 Test Loss: 1.225 Test Acc: 0.473
Validation loss decreased (-0.432419 --> -0.472961).  Saving model ...
Epoch: 9 cost time: 1.8286375999450684
Epoch: 9, Steps: 10 | Train Loss: 1.145 Vali Loss: 1.248 Vali Acc: 0.459 Test Loss: 1.248 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.2533276081085205
Epoch: 10, Steps: 10 | Train Loss: 1.044 Vali Loss: 1.212 Vali Acc: 0.514 Test Loss: 1.212 Test Acc: 0.514
Validation loss decreased (-0.472961 --> -0.513501).  Saving model ...
Epoch: 11 cost time: 3.0653905868530273
Epoch: 11, Steps: 10 | Train Loss: 0.962 Vali Loss: 1.171 Vali Acc: 0.473 Test Loss: 1.171 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.0144894123077393
Epoch: 12, Steps: 10 | Train Loss: 0.897 Vali Loss: 1.134 Vali Acc: 0.554 Test Loss: 1.134 Test Acc: 0.554
Validation loss decreased (-0.513501 --> -0.554043).  Saving model ...
Epoch: 13 cost time: 2.126943588256836
Epoch: 13, Steps: 10 | Train Loss: 0.819 Vali Loss: 1.089 Vali Acc: 0.527 Test Loss: 1.089 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.353367805480957
Epoch: 14, Steps: 10 | Train Loss: 0.726 Vali Loss: 1.152 Vali Acc: 0.527 Test Loss: 1.152 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.979111909866333
Epoch: 15, Steps: 10 | Train Loss: 0.698 Vali Loss: 1.096 Vali Acc: 0.541 Test Loss: 1.096 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.1363916397094727
Epoch: 16, Steps: 10 | Train Loss: 0.556 Vali Loss: 1.095 Vali Acc: 0.568 Test Loss: 1.095 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567557).  Saving model ...
Epoch: 17 cost time: 1.7582647800445557
Epoch: 17, Steps: 10 | Train Loss: 0.470 Vali Loss: 1.095 Vali Acc: 0.541 Test Loss: 1.095 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.2383267879486084
Epoch: 18, Steps: 10 | Train Loss: 0.402 Vali Loss: 1.138 Vali Acc: 0.541 Test Loss: 1.138 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.0337188243865967
Epoch: 19, Steps: 10 | Train Loss: 0.390 Vali Loss: 1.108 Vali Acc: 0.514 Test Loss: 1.108 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.033665418624878
Epoch: 20, Steps: 10 | Train Loss: 0.282 Vali Loss: 1.072 Vali Acc: 0.527 Test Loss: 1.072 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.9762287139892578
Epoch: 21, Steps: 10 | Train Loss: 0.243 Vali Loss: 1.150 Vali Acc: 0.500 Test Loss: 1.150 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.244061231613159
Epoch: 22, Steps: 10 | Train Loss: 0.190 Vali Loss: 1.102 Vali Acc: 0.541 Test Loss: 1.102 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.0964128971099854
Epoch: 23, Steps: 10 | Train Loss: 0.154 Vali Loss: 1.145 Vali Acc: 0.500 Test Loss: 1.145 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.2141406536102295
Epoch: 24, Steps: 10 | Train Loss: 0.130 Vali Loss: 1.155 Vali Acc: 0.541 Test Loss: 1.155 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.2743659019470215
Epoch: 25, Steps: 10 | Train Loss: 0.100 Vali Loss: 1.166 Vali Acc: 0.514 Test Loss: 1.166 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.94492506980896
Epoch: 26, Steps: 10 | Train Loss: 0.083 Vali Loss: 1.202 Vali Acc: 0.473 Test Loss: 1.202 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 211572
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.636911392211914
Epoch: 1, Steps: 10 | Train Loss: 1.463 Vali Loss: 1.399 Vali Acc: 0.216 Test Loss: 1.399 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 1.9488372802734375
Epoch: 2, Steps: 10 | Train Loss: 1.435 Vali Loss: 1.372 Vali Acc: 0.297 Test Loss: 1.372 Test Acc: 0.297
Validation loss decreased (-0.216202 --> -0.297284).  Saving model ...
Epoch: 3 cost time: 2.046560049057007
Epoch: 3, Steps: 10 | Train Loss: 1.413 Vali Loss: 1.407 Vali Acc: 0.284 Test Loss: 1.407 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.3547377586364746
Epoch: 4, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.371 Vali Acc: 0.311 Test Loss: 1.371 Test Acc: 0.311
Validation loss decreased (-0.297284 --> -0.310797).  Saving model ...
Epoch: 5 cost time: 2.0032434463500977
Epoch: 5, Steps: 10 | Train Loss: 1.328 Vali Loss: 1.348 Vali Acc: 0.365 Test Loss: 1.348 Test Acc: 0.365
Validation loss decreased (-0.310797 --> -0.364851).  Saving model ...
Epoch: 6 cost time: 1.9847419261932373
Epoch: 6, Steps: 10 | Train Loss: 1.267 Vali Loss: 1.349 Vali Acc: 0.378 Test Loss: 1.349 Test Acc: 0.378
Validation loss decreased (-0.364851 --> -0.378365).  Saving model ...
Epoch: 7 cost time: 1.604637861251831
Epoch: 7, Steps: 10 | Train Loss: 1.288 Vali Loss: 1.285 Vali Acc: 0.405 Test Loss: 1.285 Test Acc: 0.405
Validation loss decreased (-0.378365 --> -0.405393).  Saving model ...
Epoch: 8 cost time: 2.4876315593719482
Epoch: 8, Steps: 10 | Train Loss: 1.248 Vali Loss: 1.321 Vali Acc: 0.432 Test Loss: 1.321 Test Acc: 0.432
Validation loss decreased (-0.405393 --> -0.432419).  Saving model ...
Epoch: 9 cost time: 2.046433925628662
Epoch: 9, Steps: 10 | Train Loss: 1.169 Vali Loss: 1.255 Vali Acc: 0.486 Test Loss: 1.255 Test Acc: 0.486
Validation loss decreased (-0.432419 --> -0.486474).  Saving model ...
Epoch: 10 cost time: 2.15714955329895
Epoch: 10, Steps: 10 | Train Loss: 1.081 Vali Loss: 1.260 Vali Acc: 0.473 Test Loss: 1.260 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8394432067871094
Epoch: 11, Steps: 10 | Train Loss: 1.011 Vali Loss: 1.200 Vali Acc: 0.473 Test Loss: 1.200 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.079920530319214
Epoch: 12, Steps: 10 | Train Loss: 0.937 Vali Loss: 1.166 Vali Acc: 0.446 Test Loss: 1.166 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.1379451751708984
Epoch: 13, Steps: 10 | Train Loss: 0.836 Vali Loss: 1.153 Vali Acc: 0.459 Test Loss: 1.153 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.116846799850464
Epoch: 14, Steps: 10 | Train Loss: 0.762 Vali Loss: 1.163 Vali Acc: 0.500 Test Loss: 1.163 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499988).  Saving model ...
Epoch: 15 cost time: 2.2369072437286377
Epoch: 15, Steps: 10 | Train Loss: 0.696 Vali Loss: 1.143 Vali Acc: 0.514 Test Loss: 1.143 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 16 cost time: 2.143282413482666
Epoch: 16, Steps: 10 | Train Loss: 0.597 Vali Loss: 1.138 Vali Acc: 0.500 Test Loss: 1.138 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.3994486331939697
Epoch: 17, Steps: 10 | Train Loss: 0.526 Vali Loss: 1.139 Vali Acc: 0.500 Test Loss: 1.139 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.921971082687378
Epoch: 18, Steps: 10 | Train Loss: 0.458 Vali Loss: 1.084 Vali Acc: 0.514 Test Loss: 1.084 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513503).  Saving model ...
Epoch: 19 cost time: 1.734034776687622
Epoch: 19, Steps: 10 | Train Loss: 0.412 Vali Loss: 1.114 Vali Acc: 0.500 Test Loss: 1.114 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.05902099609375
Epoch: 20, Steps: 10 | Train Loss: 0.330 Vali Loss: 1.092 Vali Acc: 0.514 Test Loss: 1.092 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.934873104095459
Epoch: 21, Steps: 10 | Train Loss: 0.256 Vali Loss: 1.131 Vali Acc: 0.500 Test Loss: 1.131 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.3433709144592285
Epoch: 22, Steps: 10 | Train Loss: 0.214 Vali Loss: 1.114 Vali Acc: 0.541 Test Loss: 1.114 Test Acc: 0.541
Validation loss decreased (-0.513503 --> -0.540529).  Saving model ...
Epoch: 23 cost time: 2.0606236457824707
Epoch: 23, Steps: 10 | Train Loss: 0.169 Vali Loss: 1.112 Vali Acc: 0.541 Test Loss: 1.112 Test Acc: 0.541
Validation loss decreased (-0.540529 --> -0.540529).  Saving model ...
Epoch: 24 cost time: 2.1116995811462402
Epoch: 24, Steps: 10 | Train Loss: 0.138 Vali Loss: 1.194 Vali Acc: 0.486 Test Loss: 1.194 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.080540657043457
Epoch: 25, Steps: 10 | Train Loss: 0.113 Vali Loss: 1.156 Vali Acc: 0.486 Test Loss: 1.156 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.1779422760009766
Epoch: 26, Steps: 10 | Train Loss: 0.097 Vali Loss: 1.216 Vali Acc: 0.486 Test Loss: 1.216 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.7720518112182617
Epoch: 27, Steps: 10 | Train Loss: 0.080 Vali Loss: 1.207 Vali Acc: 0.514 Test Loss: 1.207 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.1575918197631836
Epoch: 28, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.224 Vali Acc: 0.514 Test Loss: 1.224 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.1688995361328125
Epoch: 29, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.222 Vali Acc: 0.514 Test Loss: 1.222 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.9531893730163574
Epoch: 30, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.294 Vali Acc: 0.459 Test Loss: 1.294 Test Acc: 0.459
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.1526424884796143
Epoch: 31, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.265 Vali Acc: 0.527 Test Loss: 1.265 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.3243324756622314
Epoch: 32, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.304 Vali Acc: 0.527 Test Loss: 1.304 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.140510082244873
Epoch: 33, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.278 Vali Acc: 0.514 Test Loss: 1.278 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 209652
model size : 1.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.508241415023804
Epoch: 1, Steps: 10 | Train Loss: 1.504 Vali Loss: 1.463 Vali Acc: 0.095 Test Loss: 1.463 Test Acc: 0.095
Validation loss decreased (inf --> -0.094580).  Saving model ...
Epoch: 2 cost time: 1.999401330947876
Epoch: 2, Steps: 10 | Train Loss: 1.428 Vali Loss: 1.417 Vali Acc: 0.243 Test Loss: 1.417 Test Acc: 0.243
Validation loss decreased (-0.094580 --> -0.243229).  Saving model ...
Epoch: 3 cost time: 2.22548508644104
Epoch: 3, Steps: 10 | Train Loss: 1.411 Vali Loss: 1.424 Vali Acc: 0.122 Test Loss: 1.424 Test Acc: 0.122
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0510969161987305
Epoch: 4, Steps: 10 | Train Loss: 1.355 Vali Loss: 1.394 Vali Acc: 0.243 Test Loss: 1.394 Test Acc: 0.243
Validation loss decreased (-0.243229 --> -0.243229).  Saving model ...
Epoch: 5 cost time: 2.1068105697631836
Epoch: 5, Steps: 10 | Train Loss: 1.320 Vali Loss: 1.426 Vali Acc: 0.216 Test Loss: 1.426 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.03722882270813
Epoch: 6, Steps: 10 | Train Loss: 1.275 Vali Loss: 1.360 Vali Acc: 0.284 Test Loss: 1.360 Test Acc: 0.284
Validation loss decreased (-0.243229 --> -0.283770).  Saving model ...
Epoch: 7 cost time: 2.13509202003479
Epoch: 7, Steps: 10 | Train Loss: 1.235 Vali Loss: 1.334 Vali Acc: 0.311 Test Loss: 1.334 Test Acc: 0.311
Validation loss decreased (-0.283770 --> -0.310797).  Saving model ...
Epoch: 8 cost time: 1.9083504676818848
Epoch: 8, Steps: 10 | Train Loss: 1.227 Vali Loss: 1.396 Vali Acc: 0.338 Test Loss: 1.396 Test Acc: 0.338
Validation loss decreased (-0.310797 --> -0.337824).  Saving model ...
Epoch: 9 cost time: 2.3695969581604004
Epoch: 9, Steps: 10 | Train Loss: 1.093 Vali Loss: 1.226 Vali Acc: 0.554 Test Loss: 1.226 Test Acc: 0.554
Validation loss decreased (-0.337824 --> -0.554042).  Saving model ...
Epoch: 10 cost time: 1.9415483474731445
Epoch: 10, Steps: 10 | Train Loss: 0.993 Vali Loss: 1.333 Vali Acc: 0.419 Test Loss: 1.333 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.1630094051361084
Epoch: 11, Steps: 10 | Train Loss: 0.904 Vali Loss: 1.183 Vali Acc: 0.514 Test Loss: 1.183 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.241701364517212
Epoch: 12, Steps: 10 | Train Loss: 0.857 Vali Loss: 1.182 Vali Acc: 0.486 Test Loss: 1.182 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.0561041831970215
Epoch: 13, Steps: 10 | Train Loss: 0.753 Vali Loss: 1.143 Vali Acc: 0.554 Test Loss: 1.143 Test Acc: 0.554
Validation loss decreased (-0.554042 --> -0.554043).  Saving model ...
Epoch: 14 cost time: 2.134293556213379
Epoch: 14, Steps: 10 | Train Loss: 0.666 Vali Loss: 1.127 Vali Acc: 0.554 Test Loss: 1.127 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554043).  Saving model ...
Epoch: 15 cost time: 1.9715070724487305
Epoch: 15, Steps: 10 | Train Loss: 0.620 Vali Loss: 1.128 Vali Acc: 0.500 Test Loss: 1.128 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.4043235778808594
Epoch: 16, Steps: 10 | Train Loss: 0.524 Vali Loss: 1.121 Vali Acc: 0.541 Test Loss: 1.121 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.029672145843506
Epoch: 17, Steps: 10 | Train Loss: 0.455 Vali Loss: 1.096 Vali Acc: 0.527 Test Loss: 1.096 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.167691707611084
Epoch: 18, Steps: 10 | Train Loss: 0.391 Vali Loss: 1.076 Vali Acc: 0.554 Test Loss: 1.076 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554043).  Saving model ...
Epoch: 19 cost time: 2.4930419921875
Epoch: 19, Steps: 10 | Train Loss: 0.330 Vali Loss: 1.159 Vali Acc: 0.541 Test Loss: 1.159 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.952871561050415
Epoch: 20, Steps: 10 | Train Loss: 0.265 Vali Loss: 1.123 Vali Acc: 0.541 Test Loss: 1.123 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.1014866828918457
Epoch: 21, Steps: 10 | Train Loss: 0.216 Vali Loss: 1.146 Vali Acc: 0.568 Test Loss: 1.146 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567556).  Saving model ...
Epoch: 22 cost time: 2.0347023010253906
Epoch: 22, Steps: 10 | Train Loss: 0.175 Vali Loss: 1.168 Vali Acc: 0.581 Test Loss: 1.168 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581069).  Saving model ...
Epoch: 23 cost time: 2.1431968212127686
Epoch: 23, Steps: 10 | Train Loss: 0.148 Vali Loss: 1.160 Vali Acc: 0.541 Test Loss: 1.160 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.2233633995056152
Epoch: 24, Steps: 10 | Train Loss: 0.118 Vali Loss: 1.155 Vali Acc: 0.568 Test Loss: 1.155 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.3363378047943115
Epoch: 25, Steps: 10 | Train Loss: 0.102 Vali Loss: 1.206 Vali Acc: 0.541 Test Loss: 1.206 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.2187788486480713
Epoch: 26, Steps: 10 | Train Loss: 0.083 Vali Loss: 1.238 Vali Acc: 0.541 Test Loss: 1.238 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.9550750255584717
Epoch: 27, Steps: 10 | Train Loss: 0.071 Vali Loss: 1.260 Vali Acc: 0.554 Test Loss: 1.260 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.3764498233795166
Epoch: 28, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.270 Vali Acc: 0.554 Test Loss: 1.270 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.1952104568481445
Epoch: 29, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.262 Vali Acc: 0.541 Test Loss: 1.262 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.8595194816589355
Epoch: 30, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.283 Vali Acc: 0.554 Test Loss: 1.283 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.860823631286621
Epoch: 31, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.282 Vali Acc: 0.541 Test Loss: 1.282 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.8716850280761719
Epoch: 32, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.308 Vali Acc: 0.527 Test Loss: 1.308 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 207732
model size : 1.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.607135534286499
Epoch: 1, Steps: 10 | Train Loss: 1.419 Vali Loss: 1.401 Vali Acc: 0.270 Test Loss: 1.401 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 2.06821346282959
Epoch: 2, Steps: 10 | Train Loss: 1.446 Vali Loss: 1.381 Vali Acc: 0.324 Test Loss: 1.381 Test Acc: 0.324
Validation loss decreased (-0.270256 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 1.8279447555541992
Epoch: 3, Steps: 10 | Train Loss: 1.374 Vali Loss: 1.336 Vali Acc: 0.324 Test Loss: 1.336 Test Acc: 0.324
Validation loss decreased (-0.324311 --> -0.324311).  Saving model ...
Epoch: 4 cost time: 2.0646562576293945
Epoch: 4, Steps: 10 | Train Loss: 1.447 Vali Loss: 1.330 Vali Acc: 0.351 Test Loss: 1.330 Test Acc: 0.351
Validation loss decreased (-0.324311 --> -0.351338).  Saving model ...
Epoch: 5 cost time: 1.9187040328979492
Epoch: 5, Steps: 10 | Train Loss: 1.337 Vali Loss: 1.364 Vali Acc: 0.311 Test Loss: 1.364 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.2180631160736084
Epoch: 6, Steps: 10 | Train Loss: 1.314 Vali Loss: 1.297 Vali Acc: 0.446 Test Loss: 1.297 Test Acc: 0.446
Validation loss decreased (-0.351338 --> -0.445933).  Saving model ...
Epoch: 7 cost time: 2.491288661956787
Epoch: 7, Steps: 10 | Train Loss: 1.221 Vali Loss: 1.243 Vali Acc: 0.473 Test Loss: 1.243 Test Acc: 0.473
Validation loss decreased (-0.445933 --> -0.472961).  Saving model ...
Epoch: 8 cost time: 1.9024345874786377
Epoch: 8, Steps: 10 | Train Loss: 1.140 Vali Loss: 1.201 Vali Acc: 0.541 Test Loss: 1.201 Test Acc: 0.541
Validation loss decreased (-0.472961 --> -0.540529).  Saving model ...
Epoch: 9 cost time: 2.13265061378479
Epoch: 9, Steps: 10 | Train Loss: 1.087 Vali Loss: 1.161 Vali Acc: 0.541 Test Loss: 1.161 Test Acc: 0.541
Validation loss decreased (-0.540529 --> -0.540529).  Saving model ...
Epoch: 10 cost time: 1.9876229763031006
Epoch: 10, Steps: 10 | Train Loss: 0.979 Vali Loss: 1.145 Vali Acc: 0.527 Test Loss: 1.145 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.037005662918091
Epoch: 11, Steps: 10 | Train Loss: 0.915 Vali Loss: 1.107 Vali Acc: 0.554 Test Loss: 1.107 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554043).  Saving model ...
Epoch: 12 cost time: 1.9137859344482422
Epoch: 12, Steps: 10 | Train Loss: 0.844 Vali Loss: 1.090 Vali Acc: 0.514 Test Loss: 1.090 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.2102112770080566
Epoch: 13, Steps: 10 | Train Loss: 0.741 Vali Loss: 1.057 Vali Acc: 0.514 Test Loss: 1.057 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.0535600185394287
Epoch: 14, Steps: 10 | Train Loss: 0.726 Vali Loss: 1.035 Vali Acc: 0.554 Test Loss: 1.035 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554044).  Saving model ...
Epoch: 15 cost time: 1.7848267555236816
Epoch: 15, Steps: 10 | Train Loss: 0.571 Vali Loss: 1.060 Vali Acc: 0.527 Test Loss: 1.060 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.224762201309204
Epoch: 16, Steps: 10 | Train Loss: 0.501 Vali Loss: 1.011 Vali Acc: 0.554 Test Loss: 1.011 Test Acc: 0.554
Validation loss decreased (-0.554044 --> -0.554044).  Saving model ...
Epoch: 17 cost time: 1.7623929977416992
Epoch: 17, Steps: 10 | Train Loss: 0.468 Vali Loss: 1.007 Vali Acc: 0.541 Test Loss: 1.007 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.9242217540740967
Epoch: 18, Steps: 10 | Train Loss: 0.365 Vali Loss: 1.035 Vali Acc: 0.541 Test Loss: 1.035 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.327688455581665
Epoch: 19, Steps: 10 | Train Loss: 0.336 Vali Loss: 1.012 Vali Acc: 0.554 Test Loss: 1.012 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.0029001235961914
Epoch: 20, Steps: 10 | Train Loss: 0.279 Vali Loss: 1.118 Vali Acc: 0.527 Test Loss: 1.118 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.1077892780303955
Epoch: 21, Steps: 10 | Train Loss: 0.218 Vali Loss: 1.011 Vali Acc: 0.595 Test Loss: 1.011 Test Acc: 0.595
Validation loss decreased (-0.554044 --> -0.594584).  Saving model ...
Epoch: 22 cost time: 1.9725291728973389
Epoch: 22, Steps: 10 | Train Loss: 0.183 Vali Loss: 1.109 Vali Acc: 0.541 Test Loss: 1.109 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.009457588195801
Epoch: 23, Steps: 10 | Train Loss: 0.145 Vali Loss: 1.047 Vali Acc: 0.595 Test Loss: 1.047 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.071974039077759
Epoch: 24, Steps: 10 | Train Loss: 0.106 Vali Loss: 1.137 Vali Acc: 0.568 Test Loss: 1.137 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.50036358833313
Epoch: 25, Steps: 10 | Train Loss: 0.087 Vali Loss: 1.098 Vali Acc: 0.581 Test Loss: 1.098 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.133549213409424
Epoch: 26, Steps: 10 | Train Loss: 0.073 Vali Loss: 1.195 Vali Acc: 0.554 Test Loss: 1.195 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.2364015579223633
Epoch: 27, Steps: 10 | Train Loss: 0.065 Vali Loss: 1.156 Vali Acc: 0.554 Test Loss: 1.156 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.786142349243164
Epoch: 28, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.178 Vali Acc: 0.568 Test Loss: 1.178 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.9577584266662598
Epoch: 29, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.208 Vali Acc: 0.554 Test Loss: 1.208 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.9242515563964844
Epoch: 30, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.209 Vali Acc: 0.568 Test Loss: 1.209 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.9590895175933838
Epoch: 31, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.248 Vali Acc: 0.541 Test Loss: 1.248 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 205812
model size : 1.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.360992670059204
Epoch: 1, Steps: 10 | Train Loss: 1.563 Vali Loss: 1.456 Vali Acc: 0.297 Test Loss: 1.456 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 2.622307538986206
Epoch: 2, Steps: 10 | Train Loss: 1.577 Vali Loss: 1.846 Vali Acc: 0.189 Test Loss: 1.846 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.8203866481781006
Epoch: 3, Steps: 10 | Train Loss: 1.257 Vali Loss: 1.181 Vali Acc: 0.486 Test Loss: 1.181 Test Acc: 0.486
Validation loss decreased (-0.297283 --> -0.486475).  Saving model ...
Epoch: 4 cost time: 2.6695308685302734
Epoch: 4, Steps: 10 | Train Loss: 1.078 Vali Loss: 1.274 Vali Acc: 0.527 Test Loss: 1.274 Test Acc: 0.527
Validation loss decreased (-0.486475 --> -0.527014).  Saving model ...
Epoch: 5 cost time: 2.377471685409546
Epoch: 5, Steps: 10 | Train Loss: 0.858 Vali Loss: 1.302 Vali Acc: 0.514 Test Loss: 1.302 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.963233232498169
Epoch: 6, Steps: 10 | Train Loss: 0.763 Vali Loss: 1.390 Vali Acc: 0.541 Test Loss: 1.390 Test Acc: 0.541
Validation loss decreased (-0.527014 --> -0.540527).  Saving model ...
Epoch: 7 cost time: 2.7714719772338867
Epoch: 7, Steps: 10 | Train Loss: 0.577 Vali Loss: 1.374 Vali Acc: 0.527 Test Loss: 1.374 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.297365665435791
Epoch: 8, Steps: 10 | Train Loss: 0.283 Vali Loss: 1.562 Vali Acc: 0.527 Test Loss: 1.562 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.0704405307769775
Epoch: 9, Steps: 10 | Train Loss: 0.156 Vali Loss: 1.853 Vali Acc: 0.473 Test Loss: 1.853 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.846043825149536
Epoch: 10, Steps: 10 | Train Loss: 0.112 Vali Loss: 1.769 Vali Acc: 0.554 Test Loss: 1.769 Test Acc: 0.554
Validation loss decreased (-0.540527 --> -0.554036).  Saving model ...
Epoch: 11 cost time: 2.41703462600708
Epoch: 11, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.900 Vali Acc: 0.514 Test Loss: 1.900 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.2402117252349854
Epoch: 12, Steps: 10 | Train Loss: 0.041 Vali Loss: 2.416 Vali Acc: 0.459 Test Loss: 2.416 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.83864164352417
Epoch: 13, Steps: 10 | Train Loss: 0.012 Vali Loss: 2.316 Vali Acc: 0.486 Test Loss: 2.316 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.31880784034729
Epoch: 14, Steps: 10 | Train Loss: 0.023 Vali Loss: 2.290 Vali Acc: 0.622 Test Loss: 2.290 Test Acc: 0.622
Validation loss decreased (-0.554036 --> -0.621599).  Saving model ...
Epoch: 15 cost time: 2.7057547569274902
Epoch: 15, Steps: 10 | Train Loss: 0.028 Vali Loss: 2.549 Vali Acc: 0.568 Test Loss: 2.549 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.812060832977295
Epoch: 16, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.101 Vali Acc: 0.527 Test Loss: 3.101 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.3267412185668945
Epoch: 17, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.068 Vali Acc: 0.554 Test Loss: 3.068 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.5546414852142334
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.147 Vali Acc: 0.514 Test Loss: 3.147 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.8860323429107666
Epoch: 19, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.067 Vali Acc: 0.473 Test Loss: 4.067 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.6511318683624268
Epoch: 20, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.979 Vali Acc: 0.459 Test Loss: 3.979 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.159165382385254
Epoch: 21, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.196 Vali Acc: 0.473 Test Loss: 4.196 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.684694290161133
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.212 Vali Acc: 0.459 Test Loss: 3.212 Test Acc: 0.459
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.351496696472168
Epoch: 23, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.877 Vali Acc: 0.473 Test Loss: 3.877 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.893031597137451
Epoch: 24, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.409 Vali Acc: 0.541 Test Loss: 3.409 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 8232744
model size : 36.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.054258108139038
Epoch: 1, Steps: 10 | Train Loss: 1.510 Vali Loss: 1.472 Vali Acc: 0.189 Test Loss: 1.472 Test Acc: 0.189
Validation loss decreased (inf --> -0.189174).  Saving model ...
Epoch: 2 cost time: 2.8707382678985596
Epoch: 2, Steps: 10 | Train Loss: 1.443 Vali Loss: 1.875 Vali Acc: 0.216 Test Loss: 1.875 Test Acc: 0.216
Validation loss decreased (-0.189174 --> -0.216197).  Saving model ...
Epoch: 3 cost time: 3.2425448894500732
Epoch: 3, Steps: 10 | Train Loss: 1.348 Vali Loss: 1.530 Vali Acc: 0.338 Test Loss: 1.530 Test Acc: 0.338
Validation loss decreased (-0.216197 --> -0.337823).  Saving model ...
Epoch: 4 cost time: 2.6670098304748535
Epoch: 4, Steps: 10 | Train Loss: 1.112 Vali Loss: 1.485 Vali Acc: 0.405 Test Loss: 1.485 Test Acc: 0.405
Validation loss decreased (-0.337823 --> -0.405391).  Saving model ...
Epoch: 5 cost time: 2.3971447944641113
Epoch: 5, Steps: 10 | Train Loss: 0.865 Vali Loss: 1.240 Vali Acc: 0.473 Test Loss: 1.240 Test Acc: 0.473
Validation loss decreased (-0.405391 --> -0.472961).  Saving model ...
Epoch: 6 cost time: 2.3704993724823
Epoch: 6, Steps: 10 | Train Loss: 0.548 Vali Loss: 1.510 Vali Acc: 0.500 Test Loss: 1.510 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499985).  Saving model ...
Epoch: 7 cost time: 2.410679817199707
Epoch: 7, Steps: 10 | Train Loss: 0.429 Vali Loss: 1.386 Vali Acc: 0.581 Test Loss: 1.386 Test Acc: 0.581
Validation loss decreased (-0.499985 --> -0.581067).  Saving model ...
Epoch: 8 cost time: 2.4210124015808105
Epoch: 8, Steps: 10 | Train Loss: 0.230 Vali Loss: 1.533 Vali Acc: 0.581 Test Loss: 1.533 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.328173875808716
Epoch: 9, Steps: 10 | Train Loss: 0.174 Vali Loss: 2.161 Vali Acc: 0.541 Test Loss: 2.161 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.1858301162719727
Epoch: 10, Steps: 10 | Train Loss: 0.157 Vali Loss: 2.097 Vali Acc: 0.486 Test Loss: 2.097 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.449118137359619
Epoch: 11, Steps: 10 | Train Loss: 0.100 Vali Loss: 1.973 Vali Acc: 0.581 Test Loss: 1.973 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.8468048572540283
Epoch: 12, Steps: 10 | Train Loss: 0.050 Vali Loss: 2.110 Vali Acc: 0.581 Test Loss: 2.110 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.9065940380096436
Epoch: 13, Steps: 10 | Train Loss: 0.069 Vali Loss: 2.246 Vali Acc: 0.541 Test Loss: 2.246 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.4556429386138916
Epoch: 14, Steps: 10 | Train Loss: 0.042 Vali Loss: 2.566 Vali Acc: 0.514 Test Loss: 2.566 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.713221788406372
Epoch: 15, Steps: 10 | Train Loss: 0.048 Vali Loss: 2.947 Vali Acc: 0.527 Test Loss: 2.947 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.9748566150665283
Epoch: 16, Steps: 10 | Train Loss: 0.028 Vali Loss: 2.986 Vali Acc: 0.541 Test Loss: 2.986 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.105039358139038
Epoch: 17, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.144 Vali Acc: 0.581 Test Loss: 3.144 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 8219688
model size : 36.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.041065454483032
Epoch: 1, Steps: 10 | Train Loss: 1.507 Vali Loss: 1.390 Vali Acc: 0.311 Test Loss: 1.390 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 3.2299630641937256
Epoch: 2, Steps: 10 | Train Loss: 1.360 Vali Loss: 1.237 Vali Acc: 0.473 Test Loss: 1.237 Test Acc: 0.473
Validation loss decreased (-0.310797 --> -0.472961).  Saving model ...
Epoch: 3 cost time: 2.5652942657470703
Epoch: 3, Steps: 10 | Train Loss: 1.075 Vali Loss: 1.237 Vali Acc: 0.419 Test Loss: 1.237 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.3780527114868164
Epoch: 4, Steps: 10 | Train Loss: 0.808 Vali Loss: 1.142 Vali Acc: 0.514 Test Loss: 1.142 Test Acc: 0.514
Validation loss decreased (-0.472961 --> -0.513502).  Saving model ...
Epoch: 5 cost time: 2.1674249172210693
Epoch: 5, Steps: 10 | Train Loss: 0.639 Vali Loss: 1.790 Vali Acc: 0.351 Test Loss: 1.790 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.3268184661865234
Epoch: 6, Steps: 10 | Train Loss: 0.628 Vali Loss: 1.375 Vali Acc: 0.500 Test Loss: 1.375 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.1381118297576904
Epoch: 7, Steps: 10 | Train Loss: 0.530 Vali Loss: 1.177 Vali Acc: 0.622 Test Loss: 1.177 Test Acc: 0.622
Validation loss decreased (-0.513502 --> -0.621610).  Saving model ...
Epoch: 8 cost time: 2.952643871307373
Epoch: 8, Steps: 10 | Train Loss: 0.325 Vali Loss: 1.910 Vali Acc: 0.446 Test Loss: 1.910 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.7740063667297363
Epoch: 9, Steps: 10 | Train Loss: 0.153 Vali Loss: 1.731 Vali Acc: 0.554 Test Loss: 1.731 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.2108418941497803
Epoch: 10, Steps: 10 | Train Loss: 0.097 Vali Loss: 1.619 Vali Acc: 0.527 Test Loss: 1.619 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.8263938426971436
Epoch: 11, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.507 Vali Acc: 0.595 Test Loss: 1.507 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.177180051803589
Epoch: 12, Steps: 10 | Train Loss: 0.070 Vali Loss: 2.312 Vali Acc: 0.500 Test Loss: 2.312 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.375079870223999
Epoch: 13, Steps: 10 | Train Loss: 0.048 Vali Loss: 2.288 Vali Acc: 0.541 Test Loss: 2.288 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.7732090950012207
Epoch: 14, Steps: 10 | Train Loss: 0.036 Vali Loss: 2.832 Vali Acc: 0.500 Test Loss: 2.832 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.218808650970459
Epoch: 15, Steps: 10 | Train Loss: 0.016 Vali Loss: 2.970 Vali Acc: 0.500 Test Loss: 2.970 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.0134599208831787
Epoch: 16, Steps: 10 | Train Loss: 0.019 Vali Loss: 2.751 Vali Acc: 0.541 Test Loss: 2.751 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.042086362838745
Epoch: 17, Steps: 10 | Train Loss: 0.020 Vali Loss: 2.810 Vali Acc: 0.568 Test Loss: 2.810 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 8206632
model size : 36.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.6024210453033447
Epoch: 1, Steps: 10 | Train Loss: 1.456 Vali Loss: 1.706 Vali Acc: 0.189 Test Loss: 1.706 Test Acc: 0.189
Validation loss decreased (inf --> -0.189172).  Saving model ...
Epoch: 2 cost time: 2.554473876953125
Epoch: 2, Steps: 10 | Train Loss: 1.528 Vali Loss: 2.213 Vali Acc: 0.203 Test Loss: 2.213 Test Acc: 0.203
Validation loss decreased (-0.189172 --> -0.202681).  Saving model ...
Epoch: 3 cost time: 2.852158546447754
Epoch: 3, Steps: 10 | Train Loss: 1.286 Vali Loss: 2.000 Vali Acc: 0.216 Test Loss: 2.000 Test Acc: 0.216
Validation loss decreased (-0.202681 --> -0.216196).  Saving model ...
Epoch: 4 cost time: 2.7912819385528564
Epoch: 4, Steps: 10 | Train Loss: 0.975 Vali Loss: 1.953 Vali Acc: 0.378 Test Loss: 1.953 Test Acc: 0.378
Validation loss decreased (-0.216196 --> -0.378359).  Saving model ...
Epoch: 5 cost time: 2.8568718433380127
Epoch: 5, Steps: 10 | Train Loss: 1.028 Vali Loss: 1.826 Vali Acc: 0.378 Test Loss: 1.826 Test Acc: 0.378
Validation loss decreased (-0.378359 --> -0.378360).  Saving model ...
Epoch: 6 cost time: 1.9548275470733643
Epoch: 6, Steps: 10 | Train Loss: 0.787 Vali Loss: 1.409 Vali Acc: 0.527 Test Loss: 1.409 Test Acc: 0.527
Validation loss decreased (-0.378360 --> -0.527013).  Saving model ...
Epoch: 7 cost time: 2.1829397678375244
Epoch: 7, Steps: 10 | Train Loss: 0.394 Vali Loss: 1.613 Vali Acc: 0.541 Test Loss: 1.613 Test Acc: 0.541
Validation loss decreased (-0.527013 --> -0.540524).  Saving model ...
Epoch: 8 cost time: 2.3244729042053223
Epoch: 8, Steps: 10 | Train Loss: 0.490 Vali Loss: 1.422 Vali Acc: 0.608 Test Loss: 1.422 Test Acc: 0.608
Validation loss decreased (-0.540524 --> -0.608094).  Saving model ...
Epoch: 9 cost time: 2.1328513622283936
Epoch: 9, Steps: 10 | Train Loss: 0.229 Vali Loss: 1.651 Vali Acc: 0.514 Test Loss: 1.651 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1254165172576904
Epoch: 10, Steps: 10 | Train Loss: 0.159 Vali Loss: 2.617 Vali Acc: 0.459 Test Loss: 2.617 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.859429121017456
Epoch: 11, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.897 Vali Acc: 0.554 Test Loss: 1.897 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.8825759887695312
Epoch: 12, Steps: 10 | Train Loss: 0.169 Vali Loss: 2.008 Vali Acc: 0.568 Test Loss: 2.008 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.678745746612549
Epoch: 13, Steps: 10 | Train Loss: 0.075 Vali Loss: 2.350 Vali Acc: 0.568 Test Loss: 2.350 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.7947816848754883
Epoch: 14, Steps: 10 | Train Loss: 0.049 Vali Loss: 2.723 Vali Acc: 0.622 Test Loss: 2.723 Test Acc: 0.622
Validation loss decreased (-0.608094 --> -0.621594).  Saving model ...
Epoch: 15 cost time: 2.565455913543701
Epoch: 15, Steps: 10 | Train Loss: 0.083 Vali Loss: 3.184 Vali Acc: 0.432 Test Loss: 3.184 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.7912046909332275
Epoch: 16, Steps: 10 | Train Loss: 0.052 Vali Loss: 2.590 Vali Acc: 0.554 Test Loss: 2.590 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.4866719245910645
Epoch: 17, Steps: 10 | Train Loss: 0.062 Vali Loss: 2.807 Vali Acc: 0.500 Test Loss: 2.807 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.4563677310943604
Epoch: 18, Steps: 10 | Train Loss: 0.049 Vali Loss: 2.880 Vali Acc: 0.527 Test Loss: 2.880 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.9095208644866943
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.648 Vali Acc: 0.541 Test Loss: 2.648 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.90657114982605
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.640 Vali Acc: 0.581 Test Loss: 2.640 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.495722770690918
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.863 Vali Acc: 0.541 Test Loss: 2.863 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.8061575889587402
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.745 Vali Acc: 0.554 Test Loss: 2.745 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.8299927711486816
Epoch: 23, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.356 Vali Acc: 0.527 Test Loss: 3.356 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.366724967956543
Epoch: 24, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.701 Vali Acc: 0.500 Test Loss: 3.701 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 8193576
model size : 36.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.845052003860474
Epoch: 1, Steps: 10 | Train Loss: 1.419 Vali Loss: 1.491 Vali Acc: 0.257 Test Loss: 1.491 Test Acc: 0.257
Validation loss decreased (inf --> -0.256742).  Saving model ...
Epoch: 2 cost time: 3.0482659339904785
Epoch: 2, Steps: 10 | Train Loss: 1.390 Vali Loss: 1.756 Vali Acc: 0.243 Test Loss: 1.756 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.2577900886535645
Epoch: 3, Steps: 10 | Train Loss: 1.193 Vali Loss: 1.485 Vali Acc: 0.351 Test Loss: 1.485 Test Acc: 0.351
Validation loss decreased (-0.256742 --> -0.351337).  Saving model ...
Epoch: 4 cost time: 2.7136731147766113
Epoch: 4, Steps: 10 | Train Loss: 0.881 Vali Loss: 1.226 Vali Acc: 0.541 Test Loss: 1.226 Test Acc: 0.541
Validation loss decreased (-0.351337 --> -0.540528).  Saving model ...
Epoch: 5 cost time: 3.1727042198181152
Epoch: 5, Steps: 10 | Train Loss: 0.885 Vali Loss: 1.333 Vali Acc: 0.568 Test Loss: 1.333 Test Acc: 0.568
Validation loss decreased (-0.540528 --> -0.567554).  Saving model ...
Epoch: 6 cost time: 2.558063507080078
Epoch: 6, Steps: 10 | Train Loss: 0.687 Vali Loss: 1.314 Vali Acc: 0.500 Test Loss: 1.314 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.962442636489868
Epoch: 7, Steps: 10 | Train Loss: 0.371 Vali Loss: 1.286 Vali Acc: 0.541 Test Loss: 1.286 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.8727498054504395
Epoch: 8, Steps: 10 | Train Loss: 0.231 Vali Loss: 1.425 Vali Acc: 0.541 Test Loss: 1.425 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.284893035888672
Epoch: 9, Steps: 10 | Train Loss: 0.120 Vali Loss: 1.402 Vali Acc: 0.486 Test Loss: 1.402 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.2119815349578857
Epoch: 10, Steps: 10 | Train Loss: 0.064 Vali Loss: 1.746 Vali Acc: 0.581 Test Loss: 1.746 Test Acc: 0.581
Validation loss decreased (-0.567554 --> -0.581064).  Saving model ...
Epoch: 11 cost time: 2.203258752822876
Epoch: 11, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.900 Vali Acc: 0.554 Test Loss: 1.900 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.9787025451660156
Epoch: 12, Steps: 10 | Train Loss: 0.039 Vali Loss: 2.574 Vali Acc: 0.486 Test Loss: 2.574 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.818964958190918
Epoch: 13, Steps: 10 | Train Loss: 0.039 Vali Loss: 2.360 Vali Acc: 0.514 Test Loss: 2.360 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.9400413036346436
Epoch: 14, Steps: 10 | Train Loss: 0.017 Vali Loss: 2.537 Vali Acc: 0.514 Test Loss: 2.537 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.706190586090088
Epoch: 15, Steps: 10 | Train Loss: 0.038 Vali Loss: 2.473 Vali Acc: 0.500 Test Loss: 2.473 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.985285997390747
Epoch: 16, Steps: 10 | Train Loss: 0.012 Vali Loss: 2.534 Vali Acc: 0.541 Test Loss: 2.534 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.6837756633758545
Epoch: 17, Steps: 10 | Train Loss: 0.015 Vali Loss: 2.863 Vali Acc: 0.486 Test Loss: 2.863 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.792393684387207
Epoch: 18, Steps: 10 | Train Loss: 0.016 Vali Loss: 2.879 Vali Acc: 0.473 Test Loss: 2.879 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.903294563293457
Epoch: 19, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.090 Vali Acc: 0.473 Test Loss: 3.090 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.228656530380249
Epoch: 20, Steps: 10 | Train Loss: 0.093 Vali Loss: 3.383 Vali Acc: 0.527 Test Loss: 3.383 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 6919464
model size : 31.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.64281153678894
Epoch: 1, Steps: 10 | Train Loss: 1.482 Vali Loss: 1.357 Vali Acc: 0.311 Test Loss: 1.357 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 2.5605804920196533
Epoch: 2, Steps: 10 | Train Loss: 1.392 Vali Loss: 2.114 Vali Acc: 0.203 Test Loss: 2.114 Test Acc: 0.203
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2784199714660645
Epoch: 3, Steps: 10 | Train Loss: 1.229 Vali Loss: 1.356 Vali Acc: 0.378 Test Loss: 1.356 Test Acc: 0.378
Validation loss decreased (-0.310797 --> -0.378365).  Saving model ...
Epoch: 4 cost time: 1.6933653354644775
Epoch: 4, Steps: 10 | Train Loss: 0.748 Vali Loss: 1.299 Vali Acc: 0.419 Test Loss: 1.299 Test Acc: 0.419
Validation loss decreased (-0.378365 --> -0.418906).  Saving model ...
Epoch: 5 cost time: 2.214430093765259
Epoch: 5, Steps: 10 | Train Loss: 0.653 Vali Loss: 1.226 Vali Acc: 0.500 Test Loss: 1.226 Test Acc: 0.500
Validation loss decreased (-0.418906 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 2.7091541290283203
Epoch: 6, Steps: 10 | Train Loss: 0.486 Vali Loss: 1.956 Vali Acc: 0.365 Test Loss: 1.956 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.951143980026245
Epoch: 7, Steps: 10 | Train Loss: 0.439 Vali Loss: 1.699 Vali Acc: 0.473 Test Loss: 1.699 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.5288732051849365
Epoch: 8, Steps: 10 | Train Loss: 0.493 Vali Loss: 1.638 Vali Acc: 0.500 Test Loss: 1.638 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.867370128631592
Epoch: 9, Steps: 10 | Train Loss: 0.316 Vali Loss: 1.824 Vali Acc: 0.486 Test Loss: 1.824 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.806445837020874
Epoch: 10, Steps: 10 | Train Loss: 0.200 Vali Loss: 2.332 Vali Acc: 0.541 Test Loss: 2.332 Test Acc: 0.541
Validation loss decreased (-0.499988 --> -0.540517).  Saving model ...
Epoch: 11 cost time: 2.700593948364258
Epoch: 11, Steps: 10 | Train Loss: 0.057 Vali Loss: 2.220 Vali Acc: 0.446 Test Loss: 2.220 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9878623485565186
Epoch: 12, Steps: 10 | Train Loss: 0.027 Vali Loss: 2.073 Vali Acc: 0.500 Test Loss: 2.073 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.5636842250823975
Epoch: 13, Steps: 10 | Train Loss: 0.048 Vali Loss: 2.058 Vali Acc: 0.541 Test Loss: 2.058 Test Acc: 0.541
Validation loss decreased (-0.540517 --> -0.540520).  Saving model ...
Epoch: 14 cost time: 2.498939275741577
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 2.395 Vali Acc: 0.473 Test Loss: 2.395 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.493837356567383
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.401 Vali Acc: 0.514 Test Loss: 2.401 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.73032808303833
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.434 Vali Acc: 0.527 Test Loss: 2.434 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.722369909286499
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.373 Vali Acc: 0.541 Test Loss: 2.373 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.5796234607696533
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.341 Vali Acc: 0.581 Test Loss: 2.341 Test Acc: 0.581
Validation loss decreased (-0.540520 --> -0.581058).  Saving model ...
Epoch: 19 cost time: 2.2764928340911865
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.334 Vali Acc: 0.568 Test Loss: 2.334 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.1490981578826904
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.365 Vali Acc: 0.541 Test Loss: 2.365 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.1558117866516113
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.373 Vali Acc: 0.541 Test Loss: 2.373 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.553412914276123
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.365 Vali Acc: 0.527 Test Loss: 2.365 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.5300955772399902
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.349 Vali Acc: 0.527 Test Loss: 2.349 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.214653968811035
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.347 Vali Acc: 0.527 Test Loss: 2.347 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.5811569690704346
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.341 Vali Acc: 0.541 Test Loss: 2.341 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.1352298259735107
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.348 Vali Acc: 0.527 Test Loss: 2.348 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.6639275550842285
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.350 Vali Acc: 0.527 Test Loss: 2.350 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.5992298126220703
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.348 Vali Acc: 0.527 Test Loss: 2.348 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 6906408
model size : 31.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.9512691497802734
Epoch: 1, Steps: 10 | Train Loss: 1.481 Vali Loss: 1.625 Vali Acc: 0.243 Test Loss: 1.625 Test Acc: 0.243
Validation loss decreased (inf --> -0.243227).  Saving model ...
Epoch: 2 cost time: 1.5925023555755615
Epoch: 2, Steps: 10 | Train Loss: 1.486 Vali Loss: 1.620 Vali Acc: 0.311 Test Loss: 1.620 Test Acc: 0.311
Validation loss decreased (-0.243227 --> -0.310795).  Saving model ...
Epoch: 3 cost time: 2.14367413520813
Epoch: 3, Steps: 10 | Train Loss: 1.192 Vali Loss: 1.538 Vali Acc: 0.378 Test Loss: 1.538 Test Acc: 0.378
Validation loss decreased (-0.310795 --> -0.378363).  Saving model ...
Epoch: 4 cost time: 1.9329535961151123
Epoch: 4, Steps: 10 | Train Loss: 0.812 Vali Loss: 1.191 Vali Acc: 0.473 Test Loss: 1.191 Test Acc: 0.473
Validation loss decreased (-0.378363 --> -0.472961).  Saving model ...
Epoch: 5 cost time: 1.9511423110961914
Epoch: 5, Steps: 10 | Train Loss: 0.574 Vali Loss: 1.480 Vali Acc: 0.486 Test Loss: 1.480 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486472).  Saving model ...
Epoch: 6 cost time: 1.7522776126861572
Epoch: 6, Steps: 10 | Train Loss: 0.392 Vali Loss: 1.400 Vali Acc: 0.581 Test Loss: 1.400 Test Acc: 0.581
Validation loss decreased (-0.486472 --> -0.581067).  Saving model ...
Epoch: 7 cost time: 1.9743292331695557
Epoch: 7, Steps: 10 | Train Loss: 0.394 Vali Loss: 1.308 Vali Acc: 0.554 Test Loss: 1.308 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.190401077270508
Epoch: 8, Steps: 10 | Train Loss: 0.154 Vali Loss: 1.684 Vali Acc: 0.459 Test Loss: 1.684 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.5110743045806885
Epoch: 9, Steps: 10 | Train Loss: 0.165 Vali Loss: 2.031 Vali Acc: 0.459 Test Loss: 2.031 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.602273464202881
Epoch: 10, Steps: 10 | Train Loss: 0.109 Vali Loss: 1.823 Vali Acc: 0.486 Test Loss: 1.823 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.8071389198303223
Epoch: 11, Steps: 10 | Train Loss: 0.054 Vali Loss: 2.098 Vali Acc: 0.514 Test Loss: 2.098 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.7151546478271484
Epoch: 12, Steps: 10 | Train Loss: 0.076 Vali Loss: 2.527 Vali Acc: 0.568 Test Loss: 2.527 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.745272636413574
Epoch: 13, Steps: 10 | Train Loss: 0.125 Vali Loss: 2.136 Vali Acc: 0.514 Test Loss: 2.136 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.3627214431762695
Epoch: 14, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.228 Vali Acc: 0.446 Test Loss: 3.228 Test Acc: 0.446
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.742892026901245
Epoch: 15, Steps: 10 | Train Loss: 0.040 Vali Loss: 2.521 Vali Acc: 0.500 Test Loss: 2.521 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.7737913131713867
Epoch: 16, Steps: 10 | Train Loss: 0.038 Vali Loss: 2.464 Vali Acc: 0.568 Test Loss: 2.464 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 6893352
model size : 31.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.9885926246643066
Epoch: 1, Steps: 10 | Train Loss: 1.540 Vali Loss: 1.558 Vali Acc: 0.135 Test Loss: 1.558 Test Acc: 0.135
Validation loss decreased (inf --> -0.135120).  Saving model ...
Epoch: 2 cost time: 2.2900829315185547
Epoch: 2, Steps: 10 | Train Loss: 1.424 Vali Loss: 1.277 Vali Acc: 0.392 Test Loss: 1.277 Test Acc: 0.392
Validation loss decreased (-0.135120 --> -0.391879).  Saving model ...
Epoch: 3 cost time: 2.0407555103302
Epoch: 3, Steps: 10 | Train Loss: 1.142 Vali Loss: 1.361 Vali Acc: 0.405 Test Loss: 1.361 Test Acc: 0.405
Validation loss decreased (-0.391879 --> -0.405392).  Saving model ...
Epoch: 4 cost time: 2.015347719192505
Epoch: 4, Steps: 10 | Train Loss: 0.983 Vali Loss: 1.261 Vali Acc: 0.486 Test Loss: 1.261 Test Acc: 0.486
Validation loss decreased (-0.405392 --> -0.486474).  Saving model ...
Epoch: 5 cost time: 2.1827170848846436
Epoch: 5, Steps: 10 | Train Loss: 0.603 Vali Loss: 1.154 Vali Acc: 0.527 Test Loss: 1.154 Test Acc: 0.527
Validation loss decreased (-0.486474 --> -0.527015).  Saving model ...
Epoch: 6 cost time: 2.8189852237701416
Epoch: 6, Steps: 10 | Train Loss: 0.394 Vali Loss: 1.156 Vali Acc: 0.554 Test Loss: 1.156 Test Acc: 0.554
Validation loss decreased (-0.527015 --> -0.554042).  Saving model ...
Epoch: 7 cost time: 2.7100448608398438
Epoch: 7, Steps: 10 | Train Loss: 0.337 Vali Loss: 1.911 Vali Acc: 0.446 Test Loss: 1.911 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.8465921878814697
Epoch: 8, Steps: 10 | Train Loss: 0.196 Vali Loss: 1.505 Vali Acc: 0.486 Test Loss: 1.505 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.6319363117218018
Epoch: 9, Steps: 10 | Train Loss: 0.183 Vali Loss: 2.289 Vali Acc: 0.432 Test Loss: 2.289 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.3632612228393555
Epoch: 10, Steps: 10 | Train Loss: 0.177 Vali Loss: 2.081 Vali Acc: 0.432 Test Loss: 2.081 Test Acc: 0.432
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.9767487049102783
Epoch: 11, Steps: 10 | Train Loss: 0.064 Vali Loss: 1.911 Vali Acc: 0.514 Test Loss: 1.911 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.7133960723876953
Epoch: 12, Steps: 10 | Train Loss: 0.026 Vali Loss: 2.034 Vali Acc: 0.554 Test Loss: 2.034 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.7396559715270996
Epoch: 13, Steps: 10 | Train Loss: 0.009 Vali Loss: 2.037 Vali Acc: 0.500 Test Loss: 2.037 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.2232487201690674
Epoch: 14, Steps: 10 | Train Loss: 0.012 Vali Loss: 2.409 Vali Acc: 0.514 Test Loss: 2.409 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.7812986373901367
Epoch: 15, Steps: 10 | Train Loss: 0.023 Vali Loss: 2.543 Vali Acc: 0.500 Test Loss: 2.543 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.373528242111206
Epoch: 16, Steps: 10 | Train Loss: 0.026 Vali Loss: 2.476 Vali Acc: 0.568 Test Loss: 2.476 Test Acc: 0.568
Validation loss decreased (-0.554042 --> -0.567543).  Saving model ...
Epoch: 17 cost time: 2.1885080337524414
Epoch: 17, Steps: 10 | Train Loss: 0.038 Vali Loss: 2.817 Vali Acc: 0.581 Test Loss: 2.817 Test Acc: 0.581
Validation loss decreased (-0.567543 --> -0.581053).  Saving model ...
Epoch: 18 cost time: 2.5213890075683594
Epoch: 18, Steps: 10 | Train Loss: 0.175 Vali Loss: 2.379 Vali Acc: 0.554 Test Loss: 2.379 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.492966651916504
Epoch: 19, Steps: 10 | Train Loss: 0.071 Vali Loss: 3.896 Vali Acc: 0.514 Test Loss: 3.896 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.6138792037963867
Epoch: 20, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.283 Vali Acc: 0.486 Test Loss: 3.283 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.5660336017608643
Epoch: 21, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.779 Vali Acc: 0.581 Test Loss: 3.779 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.824453830718994
Epoch: 22, Steps: 10 | Train Loss: 0.068 Vali Loss: 4.195 Vali Acc: 0.446 Test Loss: 4.195 Test Acc: 0.446
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.316174030303955
Epoch: 23, Steps: 10 | Train Loss: 0.107 Vali Loss: 3.922 Vali Acc: 0.581 Test Loss: 3.922 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.760298252105713
Epoch: 24, Steps: 10 | Train Loss: 0.059 Vali Loss: 4.772 Vali Acc: 0.473 Test Loss: 4.772 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.6904408931732178
Epoch: 25, Steps: 10 | Train Loss: 0.074 Vali Loss: 4.120 Vali Acc: 0.541 Test Loss: 4.120 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.347409963607788
Epoch: 26, Steps: 10 | Train Loss: 0.130 Vali Loss: 4.764 Vali Acc: 0.486 Test Loss: 4.764 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.485896587371826
Epoch: 27, Steps: 10 | Train Loss: 0.091 Vali Loss: 4.917 Vali Acc: 0.500 Test Loss: 4.917 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 6880296
model size : 31.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.7821619510650635
Epoch: 1, Steps: 10 | Train Loss: 1.464 Vali Loss: 1.348 Vali Acc: 0.311 Test Loss: 1.348 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 2.3380253314971924
Epoch: 2, Steps: 10 | Train Loss: 1.363 Vali Loss: 1.657 Vali Acc: 0.203 Test Loss: 1.657 Test Acc: 0.203
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.386737585067749
Epoch: 3, Steps: 10 | Train Loss: 1.161 Vali Loss: 1.578 Vali Acc: 0.338 Test Loss: 1.578 Test Acc: 0.338
Validation loss decreased (-0.310797 --> -0.337822).  Saving model ...
Epoch: 4 cost time: 2.656763792037964
Epoch: 4, Steps: 10 | Train Loss: 0.898 Vali Loss: 1.461 Vali Acc: 0.419 Test Loss: 1.461 Test Acc: 0.419
Validation loss decreased (-0.337822 --> -0.418904).  Saving model ...
Epoch: 5 cost time: 2.749427318572998
Epoch: 5, Steps: 10 | Train Loss: 0.673 Vali Loss: 1.344 Vali Acc: 0.459 Test Loss: 1.344 Test Acc: 0.459
Validation loss decreased (-0.418904 --> -0.459446).  Saving model ...
Epoch: 6 cost time: 2.440861701965332
Epoch: 6, Steps: 10 | Train Loss: 0.487 Vali Loss: 1.229 Vali Acc: 0.541 Test Loss: 1.229 Test Acc: 0.541
Validation loss decreased (-0.459446 --> -0.540528).  Saving model ...
Epoch: 7 cost time: 2.766768217086792
Epoch: 7, Steps: 10 | Train Loss: 0.364 Vali Loss: 1.428 Vali Acc: 0.568 Test Loss: 1.428 Test Acc: 0.568
Validation loss decreased (-0.540528 --> -0.567553).  Saving model ...
Epoch: 8 cost time: 2.048816442489624
Epoch: 8, Steps: 10 | Train Loss: 0.262 Vali Loss: 2.044 Vali Acc: 0.459 Test Loss: 2.044 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.429300308227539
Epoch: 9, Steps: 10 | Train Loss: 0.164 Vali Loss: 1.876 Vali Acc: 0.486 Test Loss: 1.876 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.3737080097198486
Epoch: 10, Steps: 10 | Train Loss: 0.118 Vali Loss: 2.190 Vali Acc: 0.514 Test Loss: 2.190 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.5575926303863525
Epoch: 11, Steps: 10 | Train Loss: 0.201 Vali Loss: 1.909 Vali Acc: 0.595 Test Loss: 1.909 Test Acc: 0.595
Validation loss decreased (-0.567553 --> -0.594576).  Saving model ...
Epoch: 12 cost time: 1.7879323959350586
Epoch: 12, Steps: 10 | Train Loss: 0.107 Vali Loss: 2.276 Vali Acc: 0.486 Test Loss: 2.276 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.1619749069213867
Epoch: 13, Steps: 10 | Train Loss: 0.030 Vali Loss: 2.110 Vali Acc: 0.527 Test Loss: 2.110 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.0331943035125732
Epoch: 14, Steps: 10 | Train Loss: 0.024 Vali Loss: 2.322 Vali Acc: 0.568 Test Loss: 2.322 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.2748842239379883
Epoch: 15, Steps: 10 | Train Loss: 0.030 Vali Loss: 2.672 Vali Acc: 0.527 Test Loss: 2.672 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.3285000324249268
Epoch: 16, Steps: 10 | Train Loss: 0.014 Vali Loss: 2.915 Vali Acc: 0.541 Test Loss: 2.915 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.336160898208618
Epoch: 17, Steps: 10 | Train Loss: 0.021 Vali Loss: 2.468 Vali Acc: 0.527 Test Loss: 2.468 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.279959201812744
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.246 Vali Acc: 0.527 Test Loss: 2.246 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.0596837997436523
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.794 Vali Acc: 0.500 Test Loss: 2.794 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.563429117202759
Epoch: 20, Steps: 10 | Train Loss: 0.019 Vali Loss: 2.383 Vali Acc: 0.568 Test Loss: 2.383 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.968142509460449
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.457 Vali Acc: 0.541 Test Loss: 2.457 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 6262824
model size : 28.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.158055067062378
Epoch: 1, Steps: 10 | Train Loss: 1.466 Vali Loss: 1.341 Vali Acc: 0.324 Test Loss: 1.341 Test Acc: 0.324
Validation loss decreased (inf --> -0.324311).  Saving model ...
Epoch: 2 cost time: 2.456655502319336
Epoch: 2, Steps: 10 | Train Loss: 1.341 Vali Loss: 1.250 Vali Acc: 0.419 Test Loss: 1.250 Test Acc: 0.419
Validation loss decreased (-0.324311 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 2.0070877075195312
Epoch: 3, Steps: 10 | Train Loss: 1.218 Vali Loss: 1.655 Vali Acc: 0.446 Test Loss: 1.655 Test Acc: 0.446
Validation loss decreased (-0.418906 --> -0.445929).  Saving model ...
Epoch: 4 cost time: 2.202554702758789
Epoch: 4, Steps: 10 | Train Loss: 0.988 Vali Loss: 1.258 Vali Acc: 0.459 Test Loss: 1.258 Test Acc: 0.459
Validation loss decreased (-0.445929 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 2.3944432735443115
Epoch: 5, Steps: 10 | Train Loss: 0.646 Vali Loss: 1.149 Vali Acc: 0.514 Test Loss: 1.149 Test Acc: 0.514
Validation loss decreased (-0.459447 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 2.5601863861083984
Epoch: 6, Steps: 10 | Train Loss: 0.404 Vali Loss: 1.205 Vali Acc: 0.595 Test Loss: 1.205 Test Acc: 0.595
Validation loss decreased (-0.513502 --> -0.594583).  Saving model ...
Epoch: 7 cost time: 2.513272285461426
Epoch: 7, Steps: 10 | Train Loss: 0.358 Vali Loss: 1.267 Vali Acc: 0.581 Test Loss: 1.267 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.9091811180114746
Epoch: 8, Steps: 10 | Train Loss: 0.190 Vali Loss: 1.438 Vali Acc: 0.514 Test Loss: 1.438 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.893638849258423
Epoch: 9, Steps: 10 | Train Loss: 0.142 Vali Loss: 1.579 Vali Acc: 0.554 Test Loss: 1.579 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.5336740016937256
Epoch: 10, Steps: 10 | Train Loss: 0.093 Vali Loss: 1.936 Vali Acc: 0.568 Test Loss: 1.936 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.6689977645874023
Epoch: 11, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.780 Vali Acc: 0.595 Test Loss: 1.780 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.2263693809509277
Epoch: 12, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.870 Vali Acc: 0.527 Test Loss: 1.870 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.6559128761291504
Epoch: 13, Steps: 10 | Train Loss: 0.006 Vali Loss: 2.123 Vali Acc: 0.527 Test Loss: 2.123 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.2897937297821045
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.960 Vali Acc: 0.635 Test Loss: 1.960 Test Acc: 0.635
Validation loss decreased (-0.594583 --> -0.635116).  Saving model ...
Epoch: 15 cost time: 2.6441142559051514
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.040 Vali Acc: 0.527 Test Loss: 2.040 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.5873842239379883
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.928 Vali Acc: 0.568 Test Loss: 1.928 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.1198859214782715
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.059 Vali Acc: 0.541 Test Loss: 2.059 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.659806966781616
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.987 Vali Acc: 0.541 Test Loss: 1.987 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.640205144882202
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.937 Vali Acc: 0.554 Test Loss: 1.937 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.491739273071289
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.930 Vali Acc: 0.554 Test Loss: 1.930 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.3010263442993164
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.959 Vali Acc: 0.554 Test Loss: 1.959 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.6290555000305176
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.968 Vali Acc: 0.541 Test Loss: 1.968 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.694727897644043
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.975 Vali Acc: 0.541 Test Loss: 1.975 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.8999032974243164
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.978 Vali Acc: 0.541 Test Loss: 1.978 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 6249768
model size : 28.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.61970853805542
Epoch: 1, Steps: 10 | Train Loss: 1.484 Vali Loss: 1.475 Vali Acc: 0.284 Test Loss: 1.475 Test Acc: 0.284
Validation loss decreased (inf --> -0.283769).  Saving model ...
Epoch: 2 cost time: 3.172813892364502
Epoch: 2, Steps: 10 | Train Loss: 1.405 Vali Loss: 1.383 Vali Acc: 0.297 Test Loss: 1.383 Test Acc: 0.297
Validation loss decreased (-0.283769 --> -0.297283).  Saving model ...
Epoch: 3 cost time: 2.642970561981201
Epoch: 3, Steps: 10 | Train Loss: 1.282 Vali Loss: 2.321 Vali Acc: 0.338 Test Loss: 2.321 Test Acc: 0.338
Validation loss decreased (-0.297283 --> -0.337815).  Saving model ...
Epoch: 4 cost time: 2.6201133728027344
Epoch: 4, Steps: 10 | Train Loss: 1.078 Vali Loss: 1.274 Vali Acc: 0.446 Test Loss: 1.274 Test Acc: 0.446
Validation loss decreased (-0.337815 --> -0.445933).  Saving model ...
Epoch: 5 cost time: 2.0884883403778076
Epoch: 5, Steps: 10 | Train Loss: 0.797 Vali Loss: 1.313 Vali Acc: 0.486 Test Loss: 1.313 Test Acc: 0.486
Validation loss decreased (-0.445933 --> -0.486473).  Saving model ...
Epoch: 6 cost time: 2.068233013153076
Epoch: 6, Steps: 10 | Train Loss: 0.476 Vali Loss: 1.266 Vali Acc: 0.514 Test Loss: 1.266 Test Acc: 0.514
Validation loss decreased (-0.486473 --> -0.513501).  Saving model ...
Epoch: 7 cost time: 2.068118095397949
Epoch: 7, Steps: 10 | Train Loss: 0.461 Vali Loss: 2.030 Vali Acc: 0.338 Test Loss: 2.030 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9324254989624023
Epoch: 8, Steps: 10 | Train Loss: 0.317 Vali Loss: 1.763 Vali Acc: 0.541 Test Loss: 1.763 Test Acc: 0.541
Validation loss decreased (-0.513501 --> -0.540523).  Saving model ...
Epoch: 9 cost time: 2.2339041233062744
Epoch: 9, Steps: 10 | Train Loss: 0.198 Vali Loss: 1.432 Vali Acc: 0.581 Test Loss: 1.432 Test Acc: 0.581
Validation loss decreased (-0.540523 --> -0.581067).  Saving model ...
Epoch: 10 cost time: 2.7642133235931396
Epoch: 10, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.621 Vali Acc: 0.541 Test Loss: 1.621 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.7370834350585938
Epoch: 11, Steps: 10 | Train Loss: 0.108 Vali Loss: 1.792 Vali Acc: 0.581 Test Loss: 1.792 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.6084728240966797
Epoch: 12, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.911 Vali Acc: 0.568 Test Loss: 1.911 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.691452980041504
Epoch: 13, Steps: 10 | Train Loss: 0.016 Vali Loss: 2.120 Vali Acc: 0.568 Test Loss: 2.120 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.8320794105529785
Epoch: 14, Steps: 10 | Train Loss: 0.018 Vali Loss: 2.348 Vali Acc: 0.527 Test Loss: 2.348 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.7186338901519775
Epoch: 15, Steps: 10 | Train Loss: 0.009 Vali Loss: 2.723 Vali Acc: 0.473 Test Loss: 2.723 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.5311927795410156
Epoch: 16, Steps: 10 | Train Loss: 0.015 Vali Loss: 2.186 Vali Acc: 0.581 Test Loss: 2.186 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.841200590133667
Epoch: 17, Steps: 10 | Train Loss: 0.008 Vali Loss: 2.703 Vali Acc: 0.500 Test Loss: 2.703 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.8195760250091553
Epoch: 18, Steps: 10 | Train Loss: 0.013 Vali Loss: 2.484 Vali Acc: 0.527 Test Loss: 2.484 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.7439236640930176
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 2.685 Vali Acc: 0.541 Test Loss: 2.685 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 6236712
model size : 28.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.694936513900757
Epoch: 1, Steps: 10 | Train Loss: 1.469 Vali Loss: 1.400 Vali Acc: 0.230 Test Loss: 1.400 Test Acc: 0.230
Validation loss decreased (inf --> -0.229716).  Saving model ...
Epoch: 2 cost time: 2.647535800933838
Epoch: 2, Steps: 10 | Train Loss: 1.332 Vali Loss: 1.497 Vali Acc: 0.270 Test Loss: 1.497 Test Acc: 0.270
Validation loss decreased (-0.229716 --> -0.270255).  Saving model ...
Epoch: 3 cost time: 2.499140739440918
Epoch: 3, Steps: 10 | Train Loss: 1.044 Vali Loss: 1.454 Vali Acc: 0.405 Test Loss: 1.454 Test Acc: 0.405
Validation loss decreased (-0.270255 --> -0.405391).  Saving model ...
Epoch: 4 cost time: 2.6104846000671387
Epoch: 4, Steps: 10 | Train Loss: 0.826 Vali Loss: 1.264 Vali Acc: 0.405 Test Loss: 1.264 Test Acc: 0.405
Validation loss decreased (-0.405391 --> -0.405393).  Saving model ...
Epoch: 5 cost time: 2.3529000282287598
Epoch: 5, Steps: 10 | Train Loss: 0.537 Vali Loss: 1.132 Vali Acc: 0.595 Test Loss: 1.132 Test Acc: 0.595
Validation loss decreased (-0.405393 --> -0.594583).  Saving model ...
Epoch: 6 cost time: 2.225484848022461
Epoch: 6, Steps: 10 | Train Loss: 0.415 Vali Loss: 1.222 Vali Acc: 0.486 Test Loss: 1.222 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.64607310295105
Epoch: 7, Steps: 10 | Train Loss: 0.449 Vali Loss: 1.534 Vali Acc: 0.500 Test Loss: 1.534 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.5291645526885986
Epoch: 8, Steps: 10 | Train Loss: 0.282 Vali Loss: 1.593 Vali Acc: 0.568 Test Loss: 1.593 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.2785637378692627
Epoch: 9, Steps: 10 | Train Loss: 0.133 Vali Loss: 1.798 Vali Acc: 0.568 Test Loss: 1.798 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.7022864818573
Epoch: 10, Steps: 10 | Train Loss: 0.085 Vali Loss: 1.732 Vali Acc: 0.554 Test Loss: 1.732 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.2031493186950684
Epoch: 11, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.928 Vali Acc: 0.581 Test Loss: 1.928 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.8328840732574463
Epoch: 12, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.708 Vali Acc: 0.581 Test Loss: 1.708 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.632106065750122
Epoch: 13, Steps: 10 | Train Loss: 0.021 Vali Loss: 2.817 Vali Acc: 0.554 Test Loss: 2.817 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.716187000274658
Epoch: 14, Steps: 10 | Train Loss: 0.066 Vali Loss: 2.629 Vali Acc: 0.514 Test Loss: 2.629 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.4284403324127197
Epoch: 15, Steps: 10 | Train Loss: 0.023 Vali Loss: 2.142 Vali Acc: 0.568 Test Loss: 2.142 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 6223656
model size : 28.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.2727227210998535
Epoch: 1, Steps: 10 | Train Loss: 1.488 Vali Loss: 1.584 Vali Acc: 0.230 Test Loss: 1.584 Test Acc: 0.230
Validation loss decreased (inf --> -0.229714).  Saving model ...
Epoch: 2 cost time: 3.181851387023926
Epoch: 2, Steps: 10 | Train Loss: 1.342 Vali Loss: 1.568 Vali Acc: 0.216 Test Loss: 1.568 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.5692059993743896
Epoch: 3, Steps: 10 | Train Loss: 1.109 Vali Loss: 1.156 Vali Acc: 0.486 Test Loss: 1.156 Test Acc: 0.486
Validation loss decreased (-0.229714 --> -0.486475).  Saving model ...
Epoch: 4 cost time: 2.72222900390625
Epoch: 4, Steps: 10 | Train Loss: 0.816 Vali Loss: 1.213 Vali Acc: 0.473 Test Loss: 1.213 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5387628078460693
Epoch: 5, Steps: 10 | Train Loss: 0.620 Vali Loss: 1.208 Vali Acc: 0.500 Test Loss: 1.208 Test Acc: 0.500
Validation loss decreased (-0.486475 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 2.9667694568634033
Epoch: 6, Steps: 10 | Train Loss: 0.488 Vali Loss: 1.746 Vali Acc: 0.459 Test Loss: 1.746 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.562288284301758
Epoch: 7, Steps: 10 | Train Loss: 0.520 Vali Loss: 2.493 Vali Acc: 0.432 Test Loss: 2.493 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.9155242443084717
Epoch: 8, Steps: 10 | Train Loss: 0.398 Vali Loss: 2.003 Vali Acc: 0.473 Test Loss: 2.003 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.528435468673706
Epoch: 9, Steps: 10 | Train Loss: 0.441 Vali Loss: 1.885 Vali Acc: 0.554 Test Loss: 1.885 Test Acc: 0.554
Validation loss decreased (-0.499988 --> -0.554035).  Saving model ...
Epoch: 10 cost time: 2.6832194328308105
Epoch: 10, Steps: 10 | Train Loss: 0.128 Vali Loss: 1.766 Vali Acc: 0.541 Test Loss: 1.766 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.826897621154785
Epoch: 11, Steps: 10 | Train Loss: 0.079 Vali Loss: 1.784 Vali Acc: 0.568 Test Loss: 1.784 Test Acc: 0.568
Validation loss decreased (-0.554035 --> -0.567550).  Saving model ...
Epoch: 12 cost time: 2.2990000247955322
Epoch: 12, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.980 Vali Acc: 0.554 Test Loss: 1.980 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.719226360321045
Epoch: 13, Steps: 10 | Train Loss: 0.016 Vali Loss: 2.060 Vali Acc: 0.514 Test Loss: 2.060 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.5941696166992188
Epoch: 14, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.267 Vali Acc: 0.554 Test Loss: 2.267 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.2034101486206055
Epoch: 15, Steps: 10 | Train Loss: 0.010 Vali Loss: 2.377 Vali Acc: 0.514 Test Loss: 2.377 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.824916362762451
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 2.857 Vali Acc: 0.500 Test Loss: 2.857 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.9677066802978516
Epoch: 17, Steps: 10 | Train Loss: 0.013 Vali Loss: 2.710 Vali Acc: 0.554 Test Loss: 2.710 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.7600953578948975
Epoch: 18, Steps: 10 | Train Loss: 0.010 Vali Loss: 2.862 Vali Acc: 0.527 Test Loss: 2.862 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.7887909412384033
Epoch: 19, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.818 Vali Acc: 0.473 Test Loss: 4.818 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.9191341400146484
Epoch: 20, Steps: 10 | Train Loss: 0.056 Vali Loss: 3.510 Vali Acc: 0.486 Test Loss: 3.510 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.3327348232269287
Epoch: 21, Steps: 10 | Train Loss: 0.109 Vali Loss: 4.647 Vali Acc: 0.514 Test Loss: 4.647 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 5934504
model size : 27.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.96132493019104
Epoch: 1, Steps: 10 | Train Loss: 1.464 Vali Loss: 1.307 Vali Acc: 0.378 Test Loss: 1.307 Test Acc: 0.378
Validation loss decreased (inf --> -0.378365).  Saving model ...
Epoch: 2 cost time: 2.8483874797821045
Epoch: 2, Steps: 10 | Train Loss: 1.379 Vali Loss: 1.352 Vali Acc: 0.311 Test Loss: 1.352 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.6796116828918457
Epoch: 3, Steps: 10 | Train Loss: 1.097 Vali Loss: 1.382 Vali Acc: 0.378 Test Loss: 1.382 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.885225296020508
Epoch: 4, Steps: 10 | Train Loss: 0.998 Vali Loss: 1.461 Vali Acc: 0.378 Test Loss: 1.461 Test Acc: 0.378
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.200510263442993
Epoch: 5, Steps: 10 | Train Loss: 0.960 Vali Loss: 1.164 Vali Acc: 0.500 Test Loss: 1.164 Test Acc: 0.500
Validation loss decreased (-0.378365 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 1.829216718673706
Epoch: 6, Steps: 10 | Train Loss: 0.615 Vali Loss: 1.332 Vali Acc: 0.595 Test Loss: 1.332 Test Acc: 0.595
Validation loss decreased (-0.499988 --> -0.594581).  Saving model ...
Epoch: 7 cost time: 2.184990167617798
Epoch: 7, Steps: 10 | Train Loss: 0.452 Vali Loss: 1.404 Vali Acc: 0.514 Test Loss: 1.404 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.2529945373535156
Epoch: 8, Steps: 10 | Train Loss: 0.320 Vali Loss: 1.871 Vali Acc: 0.500 Test Loss: 1.871 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.2463746070861816
Epoch: 9, Steps: 10 | Train Loss: 0.288 Vali Loss: 1.766 Vali Acc: 0.541 Test Loss: 1.766 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.5722391605377197
Epoch: 10, Steps: 10 | Train Loss: 0.137 Vali Loss: 1.691 Vali Acc: 0.568 Test Loss: 1.691 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.5463521480560303
Epoch: 11, Steps: 10 | Train Loss: 0.082 Vali Loss: 1.798 Vali Acc: 0.500 Test Loss: 1.798 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.166919231414795
Epoch: 12, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.815 Vali Acc: 0.514 Test Loss: 1.815 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.838921070098877
Epoch: 13, Steps: 10 | Train Loss: 0.091 Vali Loss: 2.068 Vali Acc: 0.500 Test Loss: 2.068 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.5887725353240967
Epoch: 14, Steps: 10 | Train Loss: 0.029 Vali Loss: 2.346 Vali Acc: 0.486 Test Loss: 2.346 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.7398269176483154
Epoch: 15, Steps: 10 | Train Loss: 0.012 Vali Loss: 2.164 Vali Acc: 0.568 Test Loss: 2.164 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.6171987056732178
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 2.026 Vali Acc: 0.541 Test Loss: 2.026 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 5921448
model size : 27.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.73551082611084
Epoch: 1, Steps: 10 | Train Loss: 1.539 Vali Loss: 1.331 Vali Acc: 0.378 Test Loss: 1.331 Test Acc: 0.378
Validation loss decreased (inf --> -0.378365).  Saving model ...
Epoch: 2 cost time: 2.8360745906829834
Epoch: 2, Steps: 10 | Train Loss: 1.327 Vali Loss: 1.276 Vali Acc: 0.432 Test Loss: 1.276 Test Acc: 0.432
Validation loss decreased (-0.378365 --> -0.432420).  Saving model ...
Epoch: 3 cost time: 2.34696364402771
Epoch: 3, Steps: 10 | Train Loss: 1.124 Vali Loss: 1.124 Vali Acc: 0.514 Test Loss: 1.124 Test Acc: 0.514
Validation loss decreased (-0.432420 --> -0.513502).  Saving model ...
Epoch: 4 cost time: 2.7716660499572754
Epoch: 4, Steps: 10 | Train Loss: 0.913 Vali Loss: 1.377 Vali Acc: 0.351 Test Loss: 1.377 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.6543467044830322
Epoch: 5, Steps: 10 | Train Loss: 0.848 Vali Loss: 1.581 Vali Acc: 0.405 Test Loss: 1.581 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.7261221408843994
Epoch: 6, Steps: 10 | Train Loss: 0.753 Vali Loss: 1.385 Vali Acc: 0.514 Test Loss: 1.385 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.8395655155181885
Epoch: 7, Steps: 10 | Train Loss: 0.407 Vali Loss: 1.325 Vali Acc: 0.541 Test Loss: 1.325 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540527).  Saving model ...
Epoch: 8 cost time: 2.419851779937744
Epoch: 8, Steps: 10 | Train Loss: 0.236 Vali Loss: 1.440 Vali Acc: 0.486 Test Loss: 1.440 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.918396234512329
Epoch: 9, Steps: 10 | Train Loss: 0.127 Vali Loss: 1.294 Vali Acc: 0.554 Test Loss: 1.294 Test Acc: 0.554
Validation loss decreased (-0.540527 --> -0.554041).  Saving model ...
Epoch: 10 cost time: 2.1500587463378906
Epoch: 10, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.676 Vali Acc: 0.527 Test Loss: 1.676 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.558051586151123
Epoch: 11, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.817 Vali Acc: 0.486 Test Loss: 1.817 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.539330244064331
Epoch: 12, Steps: 10 | Train Loss: 0.032 Vali Loss: 2.480 Vali Acc: 0.473 Test Loss: 2.480 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.497133255004883
Epoch: 13, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.690 Vali Acc: 0.568 Test Loss: 1.690 Test Acc: 0.568
Validation loss decreased (-0.554041 --> -0.567551).  Saving model ...
Epoch: 14 cost time: 2.222060441970825
Epoch: 14, Steps: 10 | Train Loss: 0.015 Vali Loss: 2.125 Vali Acc: 0.514 Test Loss: 2.125 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.8092126846313477
Epoch: 15, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.978 Vali Acc: 0.635 Test Loss: 1.978 Test Acc: 0.635
Validation loss decreased (-0.567551 --> -0.635115).  Saving model ...
Epoch: 16 cost time: 2.3407840728759766
Epoch: 16, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.979 Vali Acc: 0.581 Test Loss: 1.979 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.8988218307495117
Epoch: 17, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.056 Vali Acc: 0.392 Test Loss: 4.056 Test Acc: 0.392
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.1355066299438477
Epoch: 18, Steps: 10 | Train Loss: 0.074 Vali Loss: 2.968 Vali Acc: 0.541 Test Loss: 2.968 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.5080301761627197
Epoch: 19, Steps: 10 | Train Loss: 0.270 Vali Loss: 3.500 Vali Acc: 0.527 Test Loss: 3.500 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.73456072807312
Epoch: 20, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.256 Vali Acc: 0.527 Test Loss: 3.256 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.3015193939208984
Epoch: 21, Steps: 10 | Train Loss: 0.065 Vali Loss: 3.122 Vali Acc: 0.541 Test Loss: 3.122 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.5744636058807373
Epoch: 22, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.082 Vali Acc: 0.527 Test Loss: 3.082 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.258643388748169
Epoch: 23, Steps: 10 | Train Loss: 0.025 Vali Loss: 2.694 Vali Acc: 0.568 Test Loss: 2.694 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.094066619873047
Epoch: 24, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.460 Vali Acc: 0.486 Test Loss: 3.460 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.908989906311035
Epoch: 25, Steps: 10 | Train Loss: 0.064 Vali Loss: 3.665 Vali Acc: 0.459 Test Loss: 3.665 Test Acc: 0.459
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 5908392
model size : 27.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.06192946434021
Epoch: 1, Steps: 10 | Train Loss: 1.509 Vali Loss: 1.438 Vali Acc: 0.405 Test Loss: 1.438 Test Acc: 0.405
Validation loss decreased (inf --> -0.405391).  Saving model ...
Epoch: 2 cost time: 2.7122418880462646
Epoch: 2, Steps: 10 | Train Loss: 1.519 Vali Loss: 1.202 Vali Acc: 0.514 Test Loss: 1.202 Test Acc: 0.514
Validation loss decreased (-0.405391 --> -0.513501).  Saving model ...
Epoch: 3 cost time: 2.8114466667175293
Epoch: 3, Steps: 10 | Train Loss: 1.106 Vali Loss: 1.425 Vali Acc: 0.432 Test Loss: 1.425 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.803270101547241
Epoch: 4, Steps: 10 | Train Loss: 1.020 Vali Loss: 1.259 Vali Acc: 0.514 Test Loss: 1.259 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.3077776432037354
Epoch: 5, Steps: 10 | Train Loss: 0.656 Vali Loss: 1.360 Vali Acc: 0.446 Test Loss: 1.360 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.4992904663085938
Epoch: 6, Steps: 10 | Train Loss: 0.519 Vali Loss: 1.083 Vali Acc: 0.541 Test Loss: 1.083 Test Acc: 0.541
Validation loss decreased (-0.513501 --> -0.540530).  Saving model ...
Epoch: 7 cost time: 2.230456590652466
Epoch: 7, Steps: 10 | Train Loss: 0.294 Vali Loss: 2.173 Vali Acc: 0.459 Test Loss: 2.173 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.986077070236206
Epoch: 8, Steps: 10 | Train Loss: 0.379 Vali Loss: 1.687 Vali Acc: 0.432 Test Loss: 1.687 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.2847297191619873
Epoch: 9, Steps: 10 | Train Loss: 0.221 Vali Loss: 1.380 Vali Acc: 0.554 Test Loss: 1.380 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554040).  Saving model ...
Epoch: 10 cost time: 2.629920721054077
Epoch: 10, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.652 Vali Acc: 0.500 Test Loss: 1.652 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.6970887184143066
Epoch: 11, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.703 Vali Acc: 0.581 Test Loss: 1.703 Test Acc: 0.581
Validation loss decreased (-0.554040 --> -0.581064).  Saving model ...
Epoch: 12 cost time: 2.629572868347168
Epoch: 12, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.875 Vali Acc: 0.581 Test Loss: 1.875 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.584765672683716
Epoch: 13, Steps: 10 | Train Loss: 0.040 Vali Loss: 2.035 Vali Acc: 0.541 Test Loss: 2.035 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.9708600044250488
Epoch: 14, Steps: 10 | Train Loss: 0.019 Vali Loss: 2.051 Vali Acc: 0.527 Test Loss: 2.051 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.2790606021881104
Epoch: 15, Steps: 10 | Train Loss: 0.008 Vali Loss: 2.196 Vali Acc: 0.514 Test Loss: 2.196 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.736236572265625
Epoch: 16, Steps: 10 | Train Loss: 0.030 Vali Loss: 2.169 Vali Acc: 0.514 Test Loss: 2.169 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.448996067047119
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.743 Vali Acc: 0.541 Test Loss: 2.743 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.826613426208496
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.282 Vali Acc: 0.568 Test Loss: 2.282 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.798598051071167
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.434 Vali Acc: 0.595 Test Loss: 2.434 Test Acc: 0.595
Validation loss decreased (-0.581064 --> -0.594570).  Saving model ...
Epoch: 20 cost time: 2.2429988384246826
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.348 Vali Acc: 0.622 Test Loss: 2.348 Test Acc: 0.622
Validation loss decreased (-0.594570 --> -0.621598).  Saving model ...
Epoch: 21 cost time: 1.6742780208587646
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.593 Vali Acc: 0.541 Test Loss: 2.593 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.8682544231414795
Epoch: 22, Steps: 10 | Train Loss: 0.014 Vali Loss: 2.483 Vali Acc: 0.554 Test Loss: 2.483 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.2600865364074707
Epoch: 23, Steps: 10 | Train Loss: 0.037 Vali Loss: 2.858 Vali Acc: 0.608 Test Loss: 2.858 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.6924078464508057
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 2.871 Vali Acc: 0.527 Test Loss: 2.871 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.152843713760376
Epoch: 25, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.145 Vali Acc: 0.500 Test Loss: 3.145 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.588914394378662
Epoch: 26, Steps: 10 | Train Loss: 0.239 Vali Loss: 3.401 Vali Acc: 0.527 Test Loss: 3.401 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.48848819732666
Epoch: 27, Steps: 10 | Train Loss: 0.174 Vali Loss: 5.534 Vali Acc: 0.486 Test Loss: 5.534 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.72509765625
Epoch: 28, Steps: 10 | Train Loss: 0.190 Vali Loss: 4.026 Vali Acc: 0.486 Test Loss: 4.026 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.470954179763794
Epoch: 29, Steps: 10 | Train Loss: 0.205 Vali Loss: 4.382 Vali Acc: 0.500 Test Loss: 4.382 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.5796642303466797
Epoch: 30, Steps: 10 | Train Loss: 0.078 Vali Loss: 4.790 Vali Acc: 0.514 Test Loss: 4.790 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 5895336
model size : 27.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.215784311294556
Epoch: 1, Steps: 10 | Train Loss: 1.533 Vali Loss: 1.539 Vali Acc: 0.189 Test Loss: 1.539 Test Acc: 0.189
Validation loss decreased (inf --> -0.189174).  Saving model ...
Epoch: 2 cost time: 2.8089191913604736
Epoch: 2, Steps: 10 | Train Loss: 1.444 Vali Loss: 1.542 Vali Acc: 0.243 Test Loss: 1.542 Test Acc: 0.243
Validation loss decreased (-0.189174 --> -0.243228).  Saving model ...
Epoch: 3 cost time: 2.6911048889160156
Epoch: 3, Steps: 10 | Train Loss: 1.391 Vali Loss: 1.625 Vali Acc: 0.270 Test Loss: 1.625 Test Acc: 0.270
Validation loss decreased (-0.243228 --> -0.270254).  Saving model ...
Epoch: 4 cost time: 2.8137869834899902
Epoch: 4, Steps: 10 | Train Loss: 1.199 Vali Loss: 1.217 Vali Acc: 0.446 Test Loss: 1.217 Test Acc: 0.446
Validation loss decreased (-0.270254 --> -0.445934).  Saving model ...
Epoch: 5 cost time: 2.611304759979248
Epoch: 5, Steps: 10 | Train Loss: 0.958 Vali Loss: 1.274 Vali Acc: 0.432 Test Loss: 1.274 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.754150152206421
Epoch: 6, Steps: 10 | Train Loss: 0.698 Vali Loss: 1.442 Vali Acc: 0.338 Test Loss: 1.442 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.975822925567627
Epoch: 7, Steps: 10 | Train Loss: 0.533 Vali Loss: 1.245 Vali Acc: 0.486 Test Loss: 1.245 Test Acc: 0.486
Validation loss decreased (-0.445934 --> -0.486474).  Saving model ...
Epoch: 8 cost time: 2.724879741668701
Epoch: 8, Steps: 10 | Train Loss: 0.391 Vali Loss: 1.354 Vali Acc: 0.446 Test Loss: 1.354 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.5908515453338623
Epoch: 9, Steps: 10 | Train Loss: 0.243 Vali Loss: 1.299 Vali Acc: 0.608 Test Loss: 1.299 Test Acc: 0.608
Validation loss decreased (-0.486474 --> -0.608095).  Saving model ...
Epoch: 10 cost time: 2.371577501296997
Epoch: 10, Steps: 10 | Train Loss: 0.173 Vali Loss: 1.260 Vali Acc: 0.608 Test Loss: 1.260 Test Acc: 0.608
Validation loss decreased (-0.608095 --> -0.608096).  Saving model ...
Epoch: 11 cost time: 2.53558087348938
Epoch: 11, Steps: 10 | Train Loss: 0.144 Vali Loss: 1.893 Vali Acc: 0.459 Test Loss: 1.893 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.099433183670044
Epoch: 12, Steps: 10 | Train Loss: 0.100 Vali Loss: 1.471 Vali Acc: 0.541 Test Loss: 1.471 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.2982006072998047
Epoch: 13, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.675 Vali Acc: 0.568 Test Loss: 1.675 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.9811983108520508
Epoch: 14, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.695 Vali Acc: 0.527 Test Loss: 1.695 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.8520886898040771
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.675 Vali Acc: 0.568 Test Loss: 1.675 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.050581693649292
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.654 Vali Acc: 0.527 Test Loss: 1.654 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.8226943016052246
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.669 Vali Acc: 0.554 Test Loss: 1.669 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.2279648780822754
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.659 Vali Acc: 0.581 Test Loss: 1.659 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.2517142295837402
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.659 Vali Acc: 0.581 Test Loss: 1.659 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.043071746826172
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.680 Vali Acc: 0.581 Test Loss: 1.680 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 2808232
model size : 13.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.113830327987671
Epoch: 1, Steps: 10 | Train Loss: 1.455 Vali Loss: 1.487 Vali Acc: 0.216 Test Loss: 1.487 Test Acc: 0.216
Validation loss decreased (inf --> -0.216201).  Saving model ...
Epoch: 2 cost time: 2.6271812915802
Epoch: 2, Steps: 10 | Train Loss: 1.343 Vali Loss: 1.314 Vali Acc: 0.392 Test Loss: 1.314 Test Acc: 0.392
Validation loss decreased (-0.216201 --> -0.391879).  Saving model ...
Epoch: 3 cost time: 2.1215906143188477
Epoch: 3, Steps: 10 | Train Loss: 1.165 Vali Loss: 1.227 Vali Acc: 0.419 Test Loss: 1.227 Test Acc: 0.419
Validation loss decreased (-0.391879 --> -0.418907).  Saving model ...
Epoch: 4 cost time: 2.359229326248169
Epoch: 4, Steps: 10 | Train Loss: 1.077 Vali Loss: 1.381 Vali Acc: 0.338 Test Loss: 1.381 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.3162519931793213
Epoch: 5, Steps: 10 | Train Loss: 0.916 Vali Loss: 1.151 Vali Acc: 0.486 Test Loss: 1.151 Test Acc: 0.486
Validation loss decreased (-0.418907 --> -0.486475).  Saving model ...
Epoch: 6 cost time: 2.4469125270843506
Epoch: 6, Steps: 10 | Train Loss: 0.678 Vali Loss: 1.164 Vali Acc: 0.486 Test Loss: 1.164 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.983832597732544
Epoch: 7, Steps: 10 | Train Loss: 0.610 Vali Loss: 1.141 Vali Acc: 0.486 Test Loss: 1.141 Test Acc: 0.486
Validation loss decreased (-0.486475 --> -0.486475).  Saving model ...
Epoch: 8 cost time: 2.3061769008636475
Epoch: 8, Steps: 10 | Train Loss: 0.328 Vali Loss: 1.269 Vali Acc: 0.473 Test Loss: 1.269 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.200338125228882
Epoch: 9, Steps: 10 | Train Loss: 0.243 Vali Loss: 1.229 Vali Acc: 0.554 Test Loss: 1.229 Test Acc: 0.554
Validation loss decreased (-0.486475 --> -0.554042).  Saving model ...
Epoch: 10 cost time: 2.609368324279785
Epoch: 10, Steps: 10 | Train Loss: 0.148 Vali Loss: 1.274 Vali Acc: 0.541 Test Loss: 1.274 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.430730104446411
Epoch: 11, Steps: 10 | Train Loss: 0.079 Vali Loss: 1.418 Vali Acc: 0.568 Test Loss: 1.418 Test Acc: 0.568
Validation loss decreased (-0.554042 --> -0.567553).  Saving model ...
Epoch: 12 cost time: 2.6662418842315674
Epoch: 12, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.470 Vali Acc: 0.568 Test Loss: 1.470 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.3534703254699707
Epoch: 13, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.702 Vali Acc: 0.459 Test Loss: 1.702 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.5017917156219482
Epoch: 14, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.492 Vali Acc: 0.541 Test Loss: 1.492 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.283559799194336
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.487 Vali Acc: 0.554 Test Loss: 1.487 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.5813307762145996
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.535 Vali Acc: 0.527 Test Loss: 1.535 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.3551852703094482
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.538 Vali Acc: 0.568 Test Loss: 1.538 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.126295804977417
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.559 Vali Acc: 0.568 Test Loss: 1.559 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.750349760055542
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.577 Vali Acc: 0.541 Test Loss: 1.577 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.8504505157470703
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.594 Vali Acc: 0.541 Test Loss: 1.594 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.6666030883789062
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.618 Vali Acc: 0.554 Test Loss: 1.618 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 2801704
model size : 13.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.711788892745972
Epoch: 1, Steps: 10 | Train Loss: 1.524 Vali Loss: 1.424 Vali Acc: 0.392 Test Loss: 1.424 Test Acc: 0.392
Validation loss decreased (inf --> -0.391878).  Saving model ...
Epoch: 2 cost time: 2.0003268718719482
Epoch: 2, Steps: 10 | Train Loss: 1.497 Vali Loss: 1.413 Vali Acc: 0.392 Test Loss: 1.413 Test Acc: 0.392
Validation loss decreased (-0.391878 --> -0.391878).  Saving model ...
Epoch: 3 cost time: 2.0580296516418457
Epoch: 3, Steps: 10 | Train Loss: 1.409 Vali Loss: 1.721 Vali Acc: 0.216 Test Loss: 1.721 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.115079402923584
Epoch: 4, Steps: 10 | Train Loss: 1.146 Vali Loss: 1.279 Vali Acc: 0.419 Test Loss: 1.279 Test Acc: 0.419
Validation loss decreased (-0.391878 --> -0.418906).  Saving model ...
Epoch: 5 cost time: 1.827171802520752
Epoch: 5, Steps: 10 | Train Loss: 0.876 Vali Loss: 1.233 Vali Acc: 0.500 Test Loss: 1.233 Test Acc: 0.500
Validation loss decreased (-0.418906 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 1.8645408153533936
Epoch: 6, Steps: 10 | Train Loss: 0.631 Vali Loss: 1.233 Vali Acc: 0.486 Test Loss: 1.233 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.411176919937134
Epoch: 7, Steps: 10 | Train Loss: 0.470 Vali Loss: 1.428 Vali Acc: 0.392 Test Loss: 1.428 Test Acc: 0.392
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.880119800567627
Epoch: 8, Steps: 10 | Train Loss: 0.358 Vali Loss: 1.204 Vali Acc: 0.554 Test Loss: 1.204 Test Acc: 0.554
Validation loss decreased (-0.499988 --> -0.554042).  Saving model ...
Epoch: 9 cost time: 2.0467026233673096
Epoch: 9, Steps: 10 | Train Loss: 0.206 Vali Loss: 1.761 Vali Acc: 0.473 Test Loss: 1.761 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1969642639160156
Epoch: 10, Steps: 10 | Train Loss: 0.128 Vali Loss: 1.476 Vali Acc: 0.554 Test Loss: 1.476 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.406651496887207
Epoch: 11, Steps: 10 | Train Loss: 0.081 Vali Loss: 1.295 Vali Acc: 0.568 Test Loss: 1.295 Test Acc: 0.568
Validation loss decreased (-0.554042 --> -0.567555).  Saving model ...
Epoch: 12 cost time: 2.658775806427002
Epoch: 12, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.508 Vali Acc: 0.541 Test Loss: 1.508 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8253593444824219
Epoch: 13, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.713 Vali Acc: 0.541 Test Loss: 1.713 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.319087505340576
Epoch: 14, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.723 Vali Acc: 0.541 Test Loss: 1.723 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.654008388519287
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.729 Vali Acc: 0.527 Test Loss: 1.729 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.8519599437713623
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.655 Vali Acc: 0.581 Test Loss: 1.655 Test Acc: 0.581
Validation loss decreased (-0.567555 --> -0.581065).  Saving model ...
Epoch: 17 cost time: 2.356455087661743
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.666 Vali Acc: 0.541 Test Loss: 1.666 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.449692726135254
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.699 Vali Acc: 0.554 Test Loss: 1.699 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.8162553310394287
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.678 Vali Acc: 0.568 Test Loss: 1.678 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.5074713230133057
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.667 Vali Acc: 0.595 Test Loss: 1.667 Test Acc: 0.595
Validation loss decreased (-0.581065 --> -0.594578).  Saving model ...
Epoch: 21 cost time: 2.7790677547454834
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.695 Vali Acc: 0.581 Test Loss: 1.695 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.637032985687256
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.709 Vali Acc: 0.568 Test Loss: 1.709 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.593961477279663
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.696 Vali Acc: 0.595 Test Loss: 1.696 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.3271408081054688
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.684 Vali Acc: 0.581 Test Loss: 1.684 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.5754106044769287
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.712 Vali Acc: 0.595 Test Loss: 1.712 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.423400640487671
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.713 Vali Acc: 0.595 Test Loss: 1.713 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.7158362865448
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.721 Vali Acc: 0.581 Test Loss: 1.721 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.700568914413452
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.718 Vali Acc: 0.595 Test Loss: 1.718 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.6858861446380615
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.716 Vali Acc: 0.595 Test Loss: 1.716 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.7385268211364746
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.729 Vali Acc: 0.595 Test Loss: 1.729 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 2795176
model size : 13.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.368269920349121
Epoch: 1, Steps: 10 | Train Loss: 1.460 Vali Loss: 1.428 Vali Acc: 0.230 Test Loss: 1.428 Test Acc: 0.230
Validation loss decreased (inf --> -0.229715).  Saving model ...
Epoch: 2 cost time: 2.1549923419952393
Epoch: 2, Steps: 10 | Train Loss: 1.425 Vali Loss: 1.355 Vali Acc: 0.284 Test Loss: 1.355 Test Acc: 0.284
Validation loss decreased (-0.229715 --> -0.283770).  Saving model ...
Epoch: 3 cost time: 2.477428913116455
Epoch: 3, Steps: 10 | Train Loss: 1.252 Vali Loss: 1.406 Vali Acc: 0.324 Test Loss: 1.406 Test Acc: 0.324
Validation loss decreased (-0.283770 --> -0.324310).  Saving model ...
Epoch: 4 cost time: 2.3971850872039795
Epoch: 4, Steps: 10 | Train Loss: 1.045 Vali Loss: 1.222 Vali Acc: 0.405 Test Loss: 1.222 Test Acc: 0.405
Validation loss decreased (-0.324310 --> -0.405393).  Saving model ...
Epoch: 5 cost time: 2.1233327388763428
Epoch: 5, Steps: 10 | Train Loss: 0.850 Vali Loss: 1.289 Vali Acc: 0.514 Test Loss: 1.289 Test Acc: 0.514
Validation loss decreased (-0.405393 --> -0.513501).  Saving model ...
Epoch: 6 cost time: 2.0739057064056396
Epoch: 6, Steps: 10 | Train Loss: 0.641 Vali Loss: 1.196 Vali Acc: 0.500 Test Loss: 1.196 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.706636667251587
Epoch: 7, Steps: 10 | Train Loss: 0.473 Vali Loss: 1.191 Vali Acc: 0.541 Test Loss: 1.191 Test Acc: 0.541
Validation loss decreased (-0.513501 --> -0.540529).  Saving model ...
Epoch: 8 cost time: 2.202522039413452
Epoch: 8, Steps: 10 | Train Loss: 0.320 Vali Loss: 1.126 Vali Acc: 0.554 Test Loss: 1.126 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554043).  Saving model ...
Epoch: 9 cost time: 2.377305507659912
Epoch: 9, Steps: 10 | Train Loss: 0.187 Vali Loss: 1.325 Vali Acc: 0.541 Test Loss: 1.325 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.320136785507202
Epoch: 10, Steps: 10 | Train Loss: 0.103 Vali Loss: 1.209 Vali Acc: 0.622 Test Loss: 1.209 Test Acc: 0.622
Validation loss decreased (-0.554043 --> -0.621610).  Saving model ...
Epoch: 11 cost time: 2.3100903034210205
Epoch: 11, Steps: 10 | Train Loss: 0.073 Vali Loss: 1.288 Vali Acc: 0.608 Test Loss: 1.288 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.68709135055542
Epoch: 12, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.399 Vali Acc: 0.608 Test Loss: 1.399 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.3717923164367676
Epoch: 13, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.985 Vali Acc: 0.459 Test Loss: 1.985 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.4242136478424072
Epoch: 14, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.433 Vali Acc: 0.554 Test Loss: 1.433 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.535555124282837
Epoch: 15, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.582 Vali Acc: 0.527 Test Loss: 1.582 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.454150438308716
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.432 Vali Acc: 0.595 Test Loss: 1.432 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.8676810264587402
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.484 Vali Acc: 0.595 Test Loss: 1.484 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.9312939643859863
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.467 Vali Acc: 0.595 Test Loss: 1.467 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.3531479835510254
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.482 Vali Acc: 0.595 Test Loss: 1.482 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.3025896549224854
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.494 Vali Acc: 0.568 Test Loss: 1.494 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 2788648
model size : 13.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.207457065582275
Epoch: 1, Steps: 10 | Train Loss: 1.468 Vali Loss: 1.363 Vali Acc: 0.324 Test Loss: 1.363 Test Acc: 0.324
Validation loss decreased (inf --> -0.324311).  Saving model ...
Epoch: 2 cost time: 2.1188058853149414
Epoch: 2, Steps: 10 | Train Loss: 1.361 Vali Loss: 1.388 Vali Acc: 0.257 Test Loss: 1.388 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.318974256515503
Epoch: 3, Steps: 10 | Train Loss: 1.391 Vali Loss: 1.210 Vali Acc: 0.486 Test Loss: 1.210 Test Acc: 0.486
Validation loss decreased (-0.324311 --> -0.486474).  Saving model ...
Epoch: 4 cost time: 2.1402173042297363
Epoch: 4, Steps: 10 | Train Loss: 1.026 Vali Loss: 1.168 Vali Acc: 0.473 Test Loss: 1.168 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.6763532161712646
Epoch: 5, Steps: 10 | Train Loss: 1.017 Vali Loss: 1.190 Vali Acc: 0.486 Test Loss: 1.190 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486475).  Saving model ...
Epoch: 6 cost time: 2.3123209476470947
Epoch: 6, Steps: 10 | Train Loss: 0.825 Vali Loss: 1.421 Vali Acc: 0.500 Test Loss: 1.421 Test Acc: 0.500
Validation loss decreased (-0.486475 --> -0.499986).  Saving model ...
Epoch: 7 cost time: 2.4284820556640625
Epoch: 7, Steps: 10 | Train Loss: 0.561 Vali Loss: 1.294 Vali Acc: 0.419 Test Loss: 1.294 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.2682862281799316
Epoch: 8, Steps: 10 | Train Loss: 0.426 Vali Loss: 1.192 Vali Acc: 0.527 Test Loss: 1.192 Test Acc: 0.527
Validation loss decreased (-0.499986 --> -0.527015).  Saving model ...
Epoch: 9 cost time: 2.336725950241089
Epoch: 9, Steps: 10 | Train Loss: 0.292 Vali Loss: 1.274 Vali Acc: 0.554 Test Loss: 1.274 Test Acc: 0.554
Validation loss decreased (-0.527015 --> -0.554041).  Saving model ...
Epoch: 10 cost time: 1.9459583759307861
Epoch: 10, Steps: 10 | Train Loss: 0.178 Vali Loss: 1.271 Vali Acc: 0.486 Test Loss: 1.271 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.2189815044403076
Epoch: 11, Steps: 10 | Train Loss: 0.111 Vali Loss: 1.623 Vali Acc: 0.514 Test Loss: 1.623 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5127732753753662
Epoch: 12, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.392 Vali Acc: 0.554 Test Loss: 1.392 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.139082670211792
Epoch: 13, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.648 Vali Acc: 0.514 Test Loss: 1.648 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.8422937393188477
Epoch: 14, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.592 Vali Acc: 0.514 Test Loss: 1.592 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.1293015480041504
Epoch: 15, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.577 Vali Acc: 0.527 Test Loss: 1.577 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.769408941268921
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.670 Vali Acc: 0.527 Test Loss: 1.670 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.593484878540039
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.633 Vali Acc: 0.568 Test Loss: 1.633 Test Acc: 0.568
Validation loss decreased (-0.554041 --> -0.567551).  Saving model ...
Epoch: 18 cost time: 2.386740207672119
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.764 Vali Acc: 0.527 Test Loss: 1.764 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.8453712463378906
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.681 Vali Acc: 0.554 Test Loss: 1.681 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.072086811065674
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.696 Vali Acc: 0.554 Test Loss: 1.696 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.108041286468506
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.730 Vali Acc: 0.527 Test Loss: 1.730 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.0004496574401855
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.720 Vali Acc: 0.527 Test Loss: 1.720 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.9837186336517334
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.751 Vali Acc: 0.527 Test Loss: 1.751 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.0079314708709717
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.743 Vali Acc: 0.527 Test Loss: 1.743 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.6372509002685547
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.748 Vali Acc: 0.527 Test Loss: 1.748 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.7403597831726074
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.776 Vali Acc: 0.527 Test Loss: 1.776 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.287832498550415
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.786 Vali Acc: 0.514 Test Loss: 1.786 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 2150312
model size : 10.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.674529790878296
Epoch: 1, Steps: 10 | Train Loss: 1.562 Vali Loss: 1.373 Vali Acc: 0.378 Test Loss: 1.373 Test Acc: 0.378
Validation loss decreased (inf --> -0.378365).  Saving model ...
Epoch: 2 cost time: 2.6647000312805176
Epoch: 2, Steps: 10 | Train Loss: 1.409 Vali Loss: 1.455 Vali Acc: 0.284 Test Loss: 1.455 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2511093616485596
Epoch: 3, Steps: 10 | Train Loss: 1.287 Vali Loss: 1.430 Vali Acc: 0.270 Test Loss: 1.430 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.7657582759857178
Epoch: 4, Steps: 10 | Train Loss: 1.193 Vali Loss: 1.411 Vali Acc: 0.243 Test Loss: 1.411 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8635492324829102
Epoch: 5, Steps: 10 | Train Loss: 1.016 Vali Loss: 1.258 Vali Acc: 0.446 Test Loss: 1.258 Test Acc: 0.446
Validation loss decreased (-0.378365 --> -0.445933).  Saving model ...
Epoch: 6 cost time: 2.6393630504608154
Epoch: 6, Steps: 10 | Train Loss: 0.774 Vali Loss: 1.369 Vali Acc: 0.419 Test Loss: 1.369 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9079883098602295
Epoch: 7, Steps: 10 | Train Loss: 0.620 Vali Loss: 1.335 Vali Acc: 0.446 Test Loss: 1.335 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.6629722118377686
Epoch: 8, Steps: 10 | Train Loss: 0.408 Vali Loss: 1.144 Vali Acc: 0.473 Test Loss: 1.144 Test Acc: 0.473
Validation loss decreased (-0.445933 --> -0.472962).  Saving model ...
Epoch: 9 cost time: 2.418593168258667
Epoch: 9, Steps: 10 | Train Loss: 0.329 Vali Loss: 1.351 Vali Acc: 0.527 Test Loss: 1.351 Test Acc: 0.527
Validation loss decreased (-0.472962 --> -0.527014).  Saving model ...
Epoch: 10 cost time: 2.5422823429107666
Epoch: 10, Steps: 10 | Train Loss: 0.249 Vali Loss: 1.442 Vali Acc: 0.514 Test Loss: 1.442 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8347768783569336
Epoch: 11, Steps: 10 | Train Loss: 0.121 Vali Loss: 1.257 Vali Acc: 0.581 Test Loss: 1.257 Test Acc: 0.581
Validation loss decreased (-0.527014 --> -0.581069).  Saving model ...
Epoch: 12 cost time: 2.468210458755493
Epoch: 12, Steps: 10 | Train Loss: 0.107 Vali Loss: 1.523 Vali Acc: 0.514 Test Loss: 1.523 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.264294385910034
Epoch: 13, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.527 Vali Acc: 0.554 Test Loss: 1.527 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7921297550201416
Epoch: 14, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.370 Vali Acc: 0.581 Test Loss: 1.370 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.9691433906555176
Epoch: 15, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.487 Vali Acc: 0.595 Test Loss: 1.487 Test Acc: 0.595
Validation loss decreased (-0.581069 --> -0.594580).  Saving model ...
Epoch: 16 cost time: 1.38169264793396
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.472 Vali Acc: 0.595 Test Loss: 1.472 Test Acc: 0.595
Validation loss decreased (-0.594580 --> -0.594580).  Saving model ...
Epoch: 17 cost time: 1.6051630973815918
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.591 Vali Acc: 0.568 Test Loss: 1.591 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.940269947052002
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.562 Vali Acc: 0.568 Test Loss: 1.562 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.952183723449707
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.551 Vali Acc: 0.581 Test Loss: 1.551 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.022449016571045
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.557 Vali Acc: 0.595 Test Loss: 1.557 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.506133794784546
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.566 Vali Acc: 0.581 Test Loss: 1.566 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.0280144214630127
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.565 Vali Acc: 0.581 Test Loss: 1.565 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.740023136138916
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.577 Vali Acc: 0.581 Test Loss: 1.577 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.515671491622925
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.592 Vali Acc: 0.581 Test Loss: 1.592 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.4566261768341064
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.594 Vali Acc: 0.568 Test Loss: 1.594 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.888624906539917
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.584 Vali Acc: 0.568 Test Loss: 1.584 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 2143784
model size : 10.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.4570882320404053
Epoch: 1, Steps: 10 | Train Loss: 1.484 Vali Loss: 1.425 Vali Acc: 0.243 Test Loss: 1.425 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 1.4813358783721924
Epoch: 2, Steps: 10 | Train Loss: 1.459 Vali Loss: 1.746 Vali Acc: 0.243 Test Loss: 1.746 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.004138708114624
Epoch: 3, Steps: 10 | Train Loss: 1.375 Vali Loss: 1.262 Vali Acc: 0.419 Test Loss: 1.262 Test Acc: 0.419
Validation loss decreased (-0.243229 --> -0.418906).  Saving model ...
Epoch: 4 cost time: 1.7257418632507324
Epoch: 4, Steps: 10 | Train Loss: 1.152 Vali Loss: 1.305 Vali Acc: 0.419 Test Loss: 1.305 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8031246662139893
Epoch: 5, Steps: 10 | Train Loss: 0.963 Vali Loss: 1.348 Vali Acc: 0.351 Test Loss: 1.348 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7047688961029053
Epoch: 6, Steps: 10 | Train Loss: 0.829 Vali Loss: 1.286 Vali Acc: 0.378 Test Loss: 1.286 Test Acc: 0.378
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.572307825088501
Epoch: 7, Steps: 10 | Train Loss: 0.773 Vali Loss: 1.330 Vali Acc: 0.432 Test Loss: 1.330 Test Acc: 0.432
Validation loss decreased (-0.418906 --> -0.432419).  Saving model ...
Epoch: 8 cost time: 1.813598871231079
Epoch: 8, Steps: 10 | Train Loss: 0.577 Vali Loss: 1.321 Vali Acc: 0.459 Test Loss: 1.321 Test Acc: 0.459
Validation loss decreased (-0.432419 --> -0.459446).  Saving model ...
Epoch: 9 cost time: 1.9783852100372314
Epoch: 9, Steps: 10 | Train Loss: 0.445 Vali Loss: 1.991 Vali Acc: 0.432 Test Loss: 1.991 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.7821474075317383
Epoch: 10, Steps: 10 | Train Loss: 0.366 Vali Loss: 1.323 Vali Acc: 0.554 Test Loss: 1.323 Test Acc: 0.554
Validation loss decreased (-0.459446 --> -0.554041).  Saving model ...
Epoch: 11 cost time: 2.3786122798919678
Epoch: 11, Steps: 10 | Train Loss: 0.232 Vali Loss: 1.678 Vali Acc: 0.541 Test Loss: 1.678 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.6251578330993652
Epoch: 12, Steps: 10 | Train Loss: 0.145 Vali Loss: 1.527 Vali Acc: 0.554 Test Loss: 1.527 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.3886547088623047
Epoch: 13, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.687 Vali Acc: 0.500 Test Loss: 1.687 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.3474857807159424
Epoch: 14, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.663 Vali Acc: 0.554 Test Loss: 1.663 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.00886869430542
Epoch: 15, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.669 Vali Acc: 0.541 Test Loss: 1.669 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.1488749980926514
Epoch: 16, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.743 Vali Acc: 0.581 Test Loss: 1.743 Test Acc: 0.581
Validation loss decreased (-0.554041 --> -0.581064).  Saving model ...
Epoch: 17 cost time: 2.5618574619293213
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.764 Vali Acc: 0.568 Test Loss: 1.764 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.7395541667938232
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.963 Vali Acc: 0.527 Test Loss: 1.963 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.594714641571045
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.902 Vali Acc: 0.554 Test Loss: 1.902 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.405763864517212
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.908 Vali Acc: 0.568 Test Loss: 1.908 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.579634666442871
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.924 Vali Acc: 0.568 Test Loss: 1.924 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.5142321586608887
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.911 Vali Acc: 0.568 Test Loss: 1.911 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.056874990463257
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.907 Vali Acc: 0.568 Test Loss: 1.907 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.7683591842651367
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.904 Vali Acc: 0.568 Test Loss: 1.904 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.72900652885437
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.904 Vali Acc: 0.568 Test Loss: 1.904 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.555407762527466
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.910 Vali Acc: 0.568 Test Loss: 1.910 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 2137256
model size : 10.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.849980592727661
Epoch: 1, Steps: 10 | Train Loss: 1.525 Vali Loss: 1.364 Vali Acc: 0.405 Test Loss: 1.364 Test Acc: 0.405
Validation loss decreased (inf --> -0.405392).  Saving model ...
Epoch: 2 cost time: 2.2229015827178955
Epoch: 2, Steps: 10 | Train Loss: 1.454 Vali Loss: 1.369 Vali Acc: 0.257 Test Loss: 1.369 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.4012129306793213
Epoch: 3, Steps: 10 | Train Loss: 1.262 Vali Loss: 1.228 Vali Acc: 0.473 Test Loss: 1.228 Test Acc: 0.473
Validation loss decreased (-0.405392 --> -0.472961).  Saving model ...
Epoch: 4 cost time: 2.2553927898406982
Epoch: 4, Steps: 10 | Train Loss: 1.226 Vali Loss: 1.315 Vali Acc: 0.365 Test Loss: 1.315 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.437159538269043
Epoch: 5, Steps: 10 | Train Loss: 0.968 Vali Loss: 1.146 Vali Acc: 0.500 Test Loss: 1.146 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499989).  Saving model ...
Epoch: 6 cost time: 2.3801348209381104
Epoch: 6, Steps: 10 | Train Loss: 0.805 Vali Loss: 1.144 Vali Acc: 0.514 Test Loss: 1.144 Test Acc: 0.514
Validation loss decreased (-0.499989 --> -0.513502).  Saving model ...
Epoch: 7 cost time: 2.045064687728882
Epoch: 7, Steps: 10 | Train Loss: 0.621 Vali Loss: 1.099 Vali Acc: 0.595 Test Loss: 1.099 Test Acc: 0.595
Validation loss decreased (-0.513502 --> -0.594584).  Saving model ...
Epoch: 8 cost time: 2.228389024734497
Epoch: 8, Steps: 10 | Train Loss: 0.568 Vali Loss: 1.656 Vali Acc: 0.459 Test Loss: 1.656 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.2931389808654785
Epoch: 9, Steps: 10 | Train Loss: 0.361 Vali Loss: 1.327 Vali Acc: 0.473 Test Loss: 1.327 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.6075029373168945
Epoch: 10, Steps: 10 | Train Loss: 0.277 Vali Loss: 1.544 Vali Acc: 0.459 Test Loss: 1.544 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.4781463146209717
Epoch: 11, Steps: 10 | Train Loss: 0.172 Vali Loss: 1.512 Vali Acc: 0.514 Test Loss: 1.512 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.7964985370635986
Epoch: 12, Steps: 10 | Train Loss: 0.096 Vali Loss: 1.497 Vali Acc: 0.514 Test Loss: 1.497 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.423776865005493
Epoch: 13, Steps: 10 | Train Loss: 0.065 Vali Loss: 1.507 Vali Acc: 0.568 Test Loss: 1.507 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.6264209747314453
Epoch: 14, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.507 Vali Acc: 0.581 Test Loss: 1.507 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.583932638168335
Epoch: 15, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.643 Vali Acc: 0.541 Test Loss: 1.643 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.3273231983184814
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.507 Vali Acc: 0.608 Test Loss: 1.507 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608093).  Saving model ...
Epoch: 17 cost time: 2.458836555480957
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.719 Vali Acc: 0.486 Test Loss: 1.719 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.5983457565307617
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.619 Vali Acc: 0.581 Test Loss: 1.619 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.367034912109375
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.667 Vali Acc: 0.581 Test Loss: 1.667 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.5874826908111572
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.712 Vali Acc: 0.554 Test Loss: 1.712 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.0228750705718994
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.703 Vali Acc: 0.568 Test Loss: 1.703 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.140845775604248
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.699 Vali Acc: 0.595 Test Loss: 1.699 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.821683406829834
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.709 Vali Acc: 0.581 Test Loss: 1.709 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.1736035346984863
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.726 Vali Acc: 0.568 Test Loss: 1.726 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.285898447036743
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.721 Vali Acc: 0.568 Test Loss: 1.721 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.2932629585266113
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.718 Vali Acc: 0.581 Test Loss: 1.718 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 2130728
model size : 10.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.718773365020752
Epoch: 1, Steps: 10 | Train Loss: 1.524 Vali Loss: 1.372 Vali Acc: 0.351 Test Loss: 1.372 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 2.8090460300445557
Epoch: 2, Steps: 10 | Train Loss: 1.541 Vali Loss: 1.385 Vali Acc: 0.351 Test Loss: 1.385 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.539825439453125
Epoch: 3, Steps: 10 | Train Loss: 1.468 Vali Loss: 1.530 Vali Acc: 0.257 Test Loss: 1.530 Test Acc: 0.257
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.5543651580810547
Epoch: 4, Steps: 10 | Train Loss: 1.170 Vali Loss: 1.379 Vali Acc: 0.243 Test Loss: 1.379 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.6447718143463135
Epoch: 5, Steps: 10 | Train Loss: 1.025 Vali Loss: 1.224 Vali Acc: 0.446 Test Loss: 1.224 Test Acc: 0.446
Validation loss decreased (-0.351338 --> -0.445934).  Saving model ...
Epoch: 6 cost time: 3.042173147201538
Epoch: 6, Steps: 10 | Train Loss: 0.830 Vali Loss: 1.142 Vali Acc: 0.514 Test Loss: 1.142 Test Acc: 0.514
Validation loss decreased (-0.445934 --> -0.513502).  Saving model ...
Epoch: 7 cost time: 2.5321969985961914
Epoch: 7, Steps: 10 | Train Loss: 0.658 Vali Loss: 1.202 Vali Acc: 0.446 Test Loss: 1.202 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.9352469444274902
Epoch: 8, Steps: 10 | Train Loss: 0.455 Vali Loss: 1.171 Vali Acc: 0.514 Test Loss: 1.171 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.7683193683624268
Epoch: 9, Steps: 10 | Train Loss: 0.352 Vali Loss: 1.289 Vali Acc: 0.473 Test Loss: 1.289 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.9631459712982178
Epoch: 10, Steps: 10 | Train Loss: 0.344 Vali Loss: 1.136 Vali Acc: 0.514 Test Loss: 1.136 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513502).  Saving model ...
Epoch: 11 cost time: 2.968595266342163
Epoch: 11, Steps: 10 | Train Loss: 0.242 Vali Loss: 1.381 Vali Acc: 0.514 Test Loss: 1.381 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.1243302822113037
Epoch: 12, Steps: 10 | Train Loss: 0.133 Vali Loss: 1.561 Vali Acc: 0.514 Test Loss: 1.561 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.6859703063964844
Epoch: 13, Steps: 10 | Train Loss: 0.065 Vali Loss: 1.509 Vali Acc: 0.568 Test Loss: 1.509 Test Acc: 0.568
Validation loss decreased (-0.513502 --> -0.567552).  Saving model ...
Epoch: 14 cost time: 2.6844258308410645
Epoch: 14, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.749 Vali Acc: 0.514 Test Loss: 1.749 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.2919960021972656
Epoch: 15, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.493 Vali Acc: 0.527 Test Loss: 1.493 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.265096664428711
Epoch: 16, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.506 Vali Acc: 0.568 Test Loss: 1.506 Test Acc: 0.568
Validation loss decreased (-0.567552 --> -0.567553).  Saving model ...
Epoch: 17 cost time: 2.990743637084961
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.807 Vali Acc: 0.541 Test Loss: 1.807 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.7865958213806152
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.619 Vali Acc: 0.541 Test Loss: 1.619 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.692288637161255
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.690 Vali Acc: 0.554 Test Loss: 1.690 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.0102243423461914
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.704 Vali Acc: 0.541 Test Loss: 1.704 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.736471652984619
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.691 Vali Acc: 0.554 Test Loss: 1.691 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.8576431274414062
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.697 Vali Acc: 0.554 Test Loss: 1.697 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.3532278537750244
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.719 Vali Acc: 0.554 Test Loss: 1.719 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.9378011226654053
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.714 Vali Acc: 0.554 Test Loss: 1.714 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.4042460918426514
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.715 Vali Acc: 0.554 Test Loss: 1.715 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.5374817848205566
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.736 Vali Acc: 0.554 Test Loss: 1.736 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 1821352
model size : 9.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.811984539031982
Epoch: 1, Steps: 10 | Train Loss: 1.512 Vali Loss: 1.402 Vali Acc: 0.216 Test Loss: 1.402 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 2.6349782943725586
Epoch: 2, Steps: 10 | Train Loss: 1.417 Vali Loss: 1.611 Vali Acc: 0.203 Test Loss: 1.611 Test Acc: 0.203
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.8893332481384277
Epoch: 3, Steps: 10 | Train Loss: 1.257 Vali Loss: 1.299 Vali Acc: 0.419 Test Loss: 1.299 Test Acc: 0.419
Validation loss decreased (-0.216202 --> -0.418906).  Saving model ...
Epoch: 4 cost time: 2.652534246444702
Epoch: 4, Steps: 10 | Train Loss: 1.236 Vali Loss: 1.231 Vali Acc: 0.432 Test Loss: 1.231 Test Acc: 0.432
Validation loss decreased (-0.418906 --> -0.432420).  Saving model ...
Epoch: 5 cost time: 2.746044635772705
Epoch: 5, Steps: 10 | Train Loss: 1.087 Vali Loss: 1.407 Vali Acc: 0.419 Test Loss: 1.407 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.5693089962005615
Epoch: 6, Steps: 10 | Train Loss: 0.820 Vali Loss: 1.190 Vali Acc: 0.459 Test Loss: 1.190 Test Acc: 0.459
Validation loss decreased (-0.432420 --> -0.459448).  Saving model ...
Epoch: 7 cost time: 1.5458705425262451
Epoch: 7, Steps: 10 | Train Loss: 0.667 Vali Loss: 1.412 Vali Acc: 0.365 Test Loss: 1.412 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.6667351722717285
Epoch: 8, Steps: 10 | Train Loss: 0.513 Vali Loss: 1.224 Vali Acc: 0.486 Test Loss: 1.224 Test Acc: 0.486
Validation loss decreased (-0.459448 --> -0.486474).  Saving model ...
Epoch: 9 cost time: 2.253361940383911
Epoch: 9, Steps: 10 | Train Loss: 0.332 Vali Loss: 1.142 Vali Acc: 0.541 Test Loss: 1.142 Test Acc: 0.541
Validation loss decreased (-0.486474 --> -0.540529).  Saving model ...
Epoch: 10 cost time: 2.665855646133423
Epoch: 10, Steps: 10 | Train Loss: 0.208 Vali Loss: 1.319 Vali Acc: 0.500 Test Loss: 1.319 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.665313243865967
Epoch: 11, Steps: 10 | Train Loss: 0.148 Vali Loss: 1.285 Vali Acc: 0.554 Test Loss: 1.285 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554041).  Saving model ...
Epoch: 12 cost time: 2.445070266723633
Epoch: 12, Steps: 10 | Train Loss: 0.112 Vali Loss: 1.550 Vali Acc: 0.500 Test Loss: 1.550 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.8927929401397705
Epoch: 13, Steps: 10 | Train Loss: 0.060 Vali Loss: 1.457 Vali Acc: 0.486 Test Loss: 1.457 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.1438984870910645
Epoch: 14, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.597 Vali Acc: 0.514 Test Loss: 1.597 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.826587438583374
Epoch: 15, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.540 Vali Acc: 0.581 Test Loss: 1.540 Test Acc: 0.581
Validation loss decreased (-0.554041 --> -0.581066).  Saving model ...
Epoch: 16 cost time: 2.765439033508301
Epoch: 16, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.725 Vali Acc: 0.514 Test Loss: 1.725 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.805994987487793
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.564 Vali Acc: 0.527 Test Loss: 1.564 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.2968578338623047
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.609 Vali Acc: 0.541 Test Loss: 1.609 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.6970322132110596
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.699 Vali Acc: 0.500 Test Loss: 1.699 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.528487205505371
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.646 Vali Acc: 0.554 Test Loss: 1.646 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.2473742961883545
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.659 Vali Acc: 0.581 Test Loss: 1.659 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.742795944213867
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.690 Vali Acc: 0.581 Test Loss: 1.690 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.3665714263916016
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.694 Vali Acc: 0.581 Test Loss: 1.694 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.48453688621521
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.708 Vali Acc: 0.568 Test Loss: 1.708 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.4059855937957764
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.722 Vali Acc: 0.568 Test Loss: 1.722 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 1814824
model size : 9.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.731154203414917
Epoch: 1, Steps: 10 | Train Loss: 1.429 Vali Loss: 1.338 Vali Acc: 0.243 Test Loss: 1.338 Test Acc: 0.243
Validation loss decreased (inf --> -0.243230).  Saving model ...
Epoch: 2 cost time: 2.8679404258728027
Epoch: 2, Steps: 10 | Train Loss: 1.409 Vali Loss: 1.494 Vali Acc: 0.257 Test Loss: 1.494 Test Acc: 0.257
Validation loss decreased (-0.243230 --> -0.256742).  Saving model ...
Epoch: 3 cost time: 2.679135322570801
Epoch: 3, Steps: 10 | Train Loss: 1.254 Vali Loss: 1.361 Vali Acc: 0.243 Test Loss: 1.361 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.7962400913238525
Epoch: 4, Steps: 10 | Train Loss: 1.122 Vali Loss: 1.298 Vali Acc: 0.351 Test Loss: 1.298 Test Acc: 0.351
Validation loss decreased (-0.256742 --> -0.351338).  Saving model ...
Epoch: 5 cost time: 2.3313632011413574
Epoch: 5, Steps: 10 | Train Loss: 0.969 Vali Loss: 1.084 Vali Acc: 0.541 Test Loss: 1.084 Test Acc: 0.541
Validation loss decreased (-0.351338 --> -0.540530).  Saving model ...
Epoch: 6 cost time: 2.472834825515747
Epoch: 6, Steps: 10 | Train Loss: 0.713 Vali Loss: 1.157 Vali Acc: 0.459 Test Loss: 1.157 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.4062111377716064
Epoch: 7, Steps: 10 | Train Loss: 0.691 Vali Loss: 1.211 Vali Acc: 0.459 Test Loss: 1.211 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.4692535400390625
Epoch: 8, Steps: 10 | Train Loss: 0.611 Vali Loss: 1.399 Vali Acc: 0.459 Test Loss: 1.399 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.7412796020507812
Epoch: 9, Steps: 10 | Train Loss: 0.419 Vali Loss: 1.505 Vali Acc: 0.459 Test Loss: 1.505 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.2817695140838623
Epoch: 10, Steps: 10 | Train Loss: 0.357 Vali Loss: 1.210 Vali Acc: 0.581 Test Loss: 1.210 Test Acc: 0.581
Validation loss decreased (-0.540530 --> -0.581069).  Saving model ...
Epoch: 11 cost time: 2.581350326538086
Epoch: 11, Steps: 10 | Train Loss: 0.179 Vali Loss: 1.187 Vali Acc: 0.581 Test Loss: 1.187 Test Acc: 0.581
Validation loss decreased (-0.581069 --> -0.581069).  Saving model ...
Epoch: 12 cost time: 2.418121337890625
Epoch: 12, Steps: 10 | Train Loss: 0.176 Vali Loss: 1.458 Vali Acc: 0.595 Test Loss: 1.458 Test Acc: 0.595
Validation loss decreased (-0.581069 --> -0.594580).  Saving model ...
Epoch: 13 cost time: 2.6741816997528076
Epoch: 13, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.322 Vali Acc: 0.541 Test Loss: 1.322 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.4168946743011475
Epoch: 14, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.596 Vali Acc: 0.554 Test Loss: 1.596 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.336615800857544
Epoch: 15, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.485 Vali Acc: 0.568 Test Loss: 1.485 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.2925541400909424
Epoch: 16, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.526 Vali Acc: 0.541 Test Loss: 1.526 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.3221888542175293
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.590 Vali Acc: 0.595 Test Loss: 1.590 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.5480356216430664
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.595 Vali Acc: 0.554 Test Loss: 1.595 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.2037768363952637
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.642 Vali Acc: 0.568 Test Loss: 1.642 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.519763708114624
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.590 Vali Acc: 0.554 Test Loss: 1.590 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.8731555938720703
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.608 Vali Acc: 0.554 Test Loss: 1.608 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.3207178115844727
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.627 Vali Acc: 0.568 Test Loss: 1.627 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 1808296
model size : 9.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.482794761657715
Epoch: 1, Steps: 10 | Train Loss: 1.462 Vali Loss: 1.535 Vali Acc: 0.243 Test Loss: 1.535 Test Acc: 0.243
Validation loss decreased (inf --> -0.243228).  Saving model ...
Epoch: 2 cost time: 2.7731692790985107
Epoch: 2, Steps: 10 | Train Loss: 1.528 Vali Loss: 1.529 Vali Acc: 0.243 Test Loss: 1.529 Test Acc: 0.243
Validation loss decreased (-0.243228 --> -0.243228).  Saving model ...
Epoch: 3 cost time: 2.295825719833374
Epoch: 3, Steps: 10 | Train Loss: 1.341 Vali Loss: 1.620 Vali Acc: 0.203 Test Loss: 1.620 Test Acc: 0.203
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.056020975112915
Epoch: 4, Steps: 10 | Train Loss: 1.274 Vali Loss: 1.236 Vali Acc: 0.378 Test Loss: 1.236 Test Acc: 0.378
Validation loss decreased (-0.243228 --> -0.378366).  Saving model ...
Epoch: 5 cost time: 1.966111421585083
Epoch: 5, Steps: 10 | Train Loss: 1.038 Vali Loss: 1.263 Vali Acc: 0.392 Test Loss: 1.263 Test Acc: 0.392
Validation loss decreased (-0.378366 --> -0.391879).  Saving model ...
Epoch: 6 cost time: 1.988490104675293
Epoch: 6, Steps: 10 | Train Loss: 0.822 Vali Loss: 1.254 Vali Acc: 0.514 Test Loss: 1.254 Test Acc: 0.514
Validation loss decreased (-0.391879 --> -0.513501).  Saving model ...
Epoch: 7 cost time: 2.2218854427337646
Epoch: 7, Steps: 10 | Train Loss: 0.658 Vali Loss: 1.215 Vali Acc: 0.473 Test Loss: 1.215 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9688773155212402
Epoch: 8, Steps: 10 | Train Loss: 0.550 Vali Loss: 1.153 Vali Acc: 0.568 Test Loss: 1.153 Test Acc: 0.568
Validation loss decreased (-0.513501 --> -0.567556).  Saving model ...
Epoch: 9 cost time: 2.244264841079712
Epoch: 9, Steps: 10 | Train Loss: 0.416 Vali Loss: 1.289 Vali Acc: 0.595 Test Loss: 1.289 Test Acc: 0.595
Validation loss decreased (-0.567556 --> -0.594582).  Saving model ...
Epoch: 10 cost time: 1.8219561576843262
Epoch: 10, Steps: 10 | Train Loss: 0.264 Vali Loss: 1.247 Vali Acc: 0.595 Test Loss: 1.247 Test Acc: 0.595
Validation loss decreased (-0.594582 --> -0.594582).  Saving model ...
Epoch: 11 cost time: 2.332728147506714
Epoch: 11, Steps: 10 | Train Loss: 0.154 Vali Loss: 1.262 Vali Acc: 0.568 Test Loss: 1.262 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.50081467628479
Epoch: 12, Steps: 10 | Train Loss: 0.093 Vali Loss: 1.343 Vali Acc: 0.568 Test Loss: 1.343 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.659156322479248
Epoch: 13, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.410 Vali Acc: 0.568 Test Loss: 1.410 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.602583408355713
Epoch: 14, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.576 Vali Acc: 0.541 Test Loss: 1.576 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.131410837173462
Epoch: 15, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.511 Vali Acc: 0.568 Test Loss: 1.511 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.541057586669922
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.778 Vali Acc: 0.581 Test Loss: 1.778 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.6758856773376465
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.553 Vali Acc: 0.568 Test Loss: 1.553 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.381402015686035
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.672 Vali Acc: 0.595 Test Loss: 1.672 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.3327178955078125
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.621 Vali Acc: 0.595 Test Loss: 1.621 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.4861793518066406
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.617 Vali Acc: 0.581 Test Loss: 1.617 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 1801768
model size : 9.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.849100589752197
Epoch: 1, Steps: 10 | Train Loss: 1.443 Vali Loss: 1.317 Vali Acc: 0.392 Test Loss: 1.317 Test Acc: 0.392
Validation loss decreased (inf --> -0.391879).  Saving model ...
Epoch: 2 cost time: 2.9483258724212646
Epoch: 2, Steps: 10 | Train Loss: 1.435 Vali Loss: 1.262 Vali Acc: 0.473 Test Loss: 1.262 Test Acc: 0.473
Validation loss decreased (-0.391879 --> -0.472960).  Saving model ...
Epoch: 3 cost time: 2.6127078533172607
Epoch: 3, Steps: 10 | Train Loss: 1.246 Vali Loss: 1.408 Vali Acc: 0.311 Test Loss: 1.408 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.475266218185425
Epoch: 4, Steps: 10 | Train Loss: 1.150 Vali Loss: 1.326 Vali Acc: 0.338 Test Loss: 1.326 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.4360270500183105
Epoch: 5, Steps: 10 | Train Loss: 0.973 Vali Loss: 1.228 Vali Acc: 0.459 Test Loss: 1.228 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.3190722465515137
Epoch: 6, Steps: 10 | Train Loss: 0.779 Vali Loss: 1.452 Vali Acc: 0.432 Test Loss: 1.452 Test Acc: 0.432
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.1352834701538086
Epoch: 7, Steps: 10 | Train Loss: 0.758 Vali Loss: 1.147 Vali Acc: 0.554 Test Loss: 1.147 Test Acc: 0.554
Validation loss decreased (-0.472960 --> -0.554043).  Saving model ...
Epoch: 8 cost time: 1.7232253551483154
Epoch: 8, Steps: 10 | Train Loss: 0.640 Vali Loss: 1.542 Vali Acc: 0.419 Test Loss: 1.542 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.465991497039795
Epoch: 9, Steps: 10 | Train Loss: 0.348 Vali Loss: 1.170 Vali Acc: 0.527 Test Loss: 1.170 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.7336618900299072
Epoch: 10, Steps: 10 | Train Loss: 0.255 Vali Loss: 1.218 Vali Acc: 0.500 Test Loss: 1.218 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.4797286987304688
Epoch: 11, Steps: 10 | Train Loss: 0.184 Vali Loss: 1.257 Vali Acc: 0.527 Test Loss: 1.257 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.049160957336426
Epoch: 12, Steps: 10 | Train Loss: 0.182 Vali Loss: 1.247 Vali Acc: 0.514 Test Loss: 1.247 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.2071502208709717
Epoch: 13, Steps: 10 | Train Loss: 0.130 Vali Loss: 1.903 Vali Acc: 0.486 Test Loss: 1.903 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.8465683460235596
Epoch: 14, Steps: 10 | Train Loss: 0.095 Vali Loss: 1.559 Vali Acc: 0.500 Test Loss: 1.559 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.3742120265960693
Epoch: 15, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.652 Vali Acc: 0.554 Test Loss: 1.652 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.6635053157806396
Epoch: 16, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.771 Vali Acc: 0.527 Test Loss: 1.771 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.494356632232666
Epoch: 17, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.719 Vali Acc: 0.541 Test Loss: 1.719 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 1656872
model size : 8.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.501504182815552
Epoch: 1, Steps: 10 | Train Loss: 1.490 Vali Loss: 1.515 Vali Acc: 0.216 Test Loss: 1.515 Test Acc: 0.216
Validation loss decreased (inf --> -0.216201).  Saving model ...
Epoch: 2 cost time: 2.325606346130371
Epoch: 2, Steps: 10 | Train Loss: 1.419 Vali Loss: 1.302 Vali Acc: 0.405 Test Loss: 1.302 Test Acc: 0.405
Validation loss decreased (-0.216201 --> -0.405392).  Saving model ...
Epoch: 3 cost time: 2.1345345973968506
Epoch: 3, Steps: 10 | Train Loss: 1.341 Vali Loss: 1.293 Vali Acc: 0.486 Test Loss: 1.293 Test Acc: 0.486
Validation loss decreased (-0.405392 --> -0.486474).  Saving model ...
Epoch: 4 cost time: 2.2781827449798584
Epoch: 4, Steps: 10 | Train Loss: 1.073 Vali Loss: 1.300 Vali Acc: 0.432 Test Loss: 1.300 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.605109930038452
Epoch: 5, Steps: 10 | Train Loss: 1.096 Vali Loss: 1.447 Vali Acc: 0.297 Test Loss: 1.447 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.4422719478607178
Epoch: 6, Steps: 10 | Train Loss: 0.891 Vali Loss: 1.784 Vali Acc: 0.270 Test Loss: 1.784 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.737194538116455
Epoch: 7, Steps: 10 | Train Loss: 0.872 Vali Loss: 1.125 Vali Acc: 0.514 Test Loss: 1.125 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513502).  Saving model ...
Epoch: 8 cost time: 2.657475471496582
Epoch: 8, Steps: 10 | Train Loss: 0.529 Vali Loss: 1.081 Vali Acc: 0.541 Test Loss: 1.081 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540530).  Saving model ...
Epoch: 9 cost time: 2.2272980213165283
Epoch: 9, Steps: 10 | Train Loss: 0.454 Vali Loss: 1.471 Vali Acc: 0.432 Test Loss: 1.471 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.413228988647461
Epoch: 10, Steps: 10 | Train Loss: 0.305 Vali Loss: 1.225 Vali Acc: 0.514 Test Loss: 1.225 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.6513915061950684
Epoch: 11, Steps: 10 | Train Loss: 0.200 Vali Loss: 1.148 Vali Acc: 0.527 Test Loss: 1.148 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.5203676223754883
Epoch: 12, Steps: 10 | Train Loss: 0.107 Vali Loss: 1.406 Vali Acc: 0.527 Test Loss: 1.406 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.7341415882110596
Epoch: 13, Steps: 10 | Train Loss: 0.110 Vali Loss: 1.193 Vali Acc: 0.581 Test Loss: 1.193 Test Acc: 0.581
Validation loss decreased (-0.540530 --> -0.581069).  Saving model ...
Epoch: 14 cost time: 2.854074478149414
Epoch: 14, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.748 Vali Acc: 0.541 Test Loss: 1.748 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.664468288421631
Epoch: 15, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.554 Vali Acc: 0.527 Test Loss: 1.554 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.805602550506592
Epoch: 16, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.702 Vali Acc: 0.527 Test Loss: 1.702 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.5496652126312256
Epoch: 17, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.698 Vali Acc: 0.554 Test Loss: 1.698 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.3790395259857178
Epoch: 18, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.895 Vali Acc: 0.554 Test Loss: 1.895 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.8976917266845703
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.819 Vali Acc: 0.554 Test Loss: 1.819 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.616486072540283
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.805 Vali Acc: 0.568 Test Loss: 1.805 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.8820445537567139
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.746 Vali Acc: 0.554 Test Loss: 1.746 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.6225125789642334
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.769 Vali Acc: 0.541 Test Loss: 1.769 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.484388828277588
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.787 Vali Acc: 0.568 Test Loss: 1.787 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 1650344
model size : 8.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.129520893096924
Epoch: 1, Steps: 10 | Train Loss: 1.540 Vali Loss: 1.328 Vali Acc: 0.392 Test Loss: 1.328 Test Acc: 0.392
Validation loss decreased (inf --> -0.391879).  Saving model ...
Epoch: 2 cost time: 2.4389584064483643
Epoch: 2, Steps: 10 | Train Loss: 1.498 Vali Loss: 1.274 Vali Acc: 0.459 Test Loss: 1.274 Test Acc: 0.459
Validation loss decreased (-0.391879 --> -0.459447).  Saving model ...
Epoch: 3 cost time: 2.0573923587799072
Epoch: 3, Steps: 10 | Train Loss: 1.257 Vali Loss: 1.346 Vali Acc: 0.419 Test Loss: 1.346 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9629547595977783
Epoch: 4, Steps: 10 | Train Loss: 1.163 Vali Loss: 1.189 Vali Acc: 0.500 Test Loss: 1.189 Test Acc: 0.500
Validation loss decreased (-0.459447 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 2.4978456497192383
Epoch: 5, Steps: 10 | Train Loss: 0.871 Vali Loss: 1.131 Vali Acc: 0.554 Test Loss: 1.131 Test Acc: 0.554
Validation loss decreased (-0.499988 --> -0.554043).  Saving model ...
Epoch: 6 cost time: 2.1067981719970703
Epoch: 6, Steps: 10 | Train Loss: 0.676 Vali Loss: 1.253 Vali Acc: 0.486 Test Loss: 1.253 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.8132381439208984
Epoch: 7, Steps: 10 | Train Loss: 0.625 Vali Loss: 1.354 Vali Acc: 0.486 Test Loss: 1.354 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.6089658737182617
Epoch: 8, Steps: 10 | Train Loss: 0.445 Vali Loss: 1.229 Vali Acc: 0.527 Test Loss: 1.229 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.6534857749938965
Epoch: 9, Steps: 10 | Train Loss: 0.315 Vali Loss: 1.303 Vali Acc: 0.527 Test Loss: 1.303 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.868459701538086
Epoch: 10, Steps: 10 | Train Loss: 0.243 Vali Loss: 1.197 Vali Acc: 0.541 Test Loss: 1.197 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.8570094108581543
Epoch: 11, Steps: 10 | Train Loss: 0.150 Vali Loss: 1.261 Vali Acc: 0.554 Test Loss: 1.261 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.714815855026245
Epoch: 12, Steps: 10 | Train Loss: 0.085 Vali Loss: 1.243 Vali Acc: 0.581 Test Loss: 1.243 Test Acc: 0.581
Validation loss decreased (-0.554043 --> -0.581069).  Saving model ...
Epoch: 13 cost time: 2.878843307495117
Epoch: 13, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.488 Vali Acc: 0.541 Test Loss: 1.488 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.899022102355957
Epoch: 14, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.987 Vali Acc: 0.473 Test Loss: 1.987 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.626868724822998
Epoch: 15, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.581 Vali Acc: 0.608 Test Loss: 1.581 Test Acc: 0.608
Validation loss decreased (-0.581069 --> -0.608092).  Saving model ...
Epoch: 16 cost time: 2.1960551738739014
Epoch: 16, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.801 Vali Acc: 0.568 Test Loss: 1.801 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.4405651092529297
Epoch: 17, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.697 Vali Acc: 0.581 Test Loss: 1.697 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.2881698608398438
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.948 Vali Acc: 0.541 Test Loss: 1.948 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.675647258758545
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.730 Vali Acc: 0.554 Test Loss: 1.730 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.4477789402008057
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.721 Vali Acc: 0.568 Test Loss: 1.721 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.667205810546875
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.767 Vali Acc: 0.541 Test Loss: 1.767 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.5702924728393555
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.765 Vali Acc: 0.554 Test Loss: 1.765 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.9383792877197266
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.728 Vali Acc: 0.554 Test Loss: 1.728 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.623765230178833
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.738 Vali Acc: 0.554 Test Loss: 1.738 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.6666018962860107
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.748 Vali Acc: 0.554 Test Loss: 1.748 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 1643816
model size : 8.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.532778978347778
Epoch: 1, Steps: 10 | Train Loss: 1.485 Vali Loss: 1.559 Vali Acc: 0.189 Test Loss: 1.559 Test Acc: 0.189
Validation loss decreased (inf --> -0.189174).  Saving model ...
Epoch: 2 cost time: 2.3742778301239014
Epoch: 2, Steps: 10 | Train Loss: 1.477 Vali Loss: 1.320 Vali Acc: 0.351 Test Loss: 1.320 Test Acc: 0.351
Validation loss decreased (-0.189174 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 2.714277982711792
Epoch: 3, Steps: 10 | Train Loss: 1.318 Vali Loss: 1.562 Vali Acc: 0.203 Test Loss: 1.562 Test Acc: 0.203
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.5096113681793213
Epoch: 4, Steps: 10 | Train Loss: 1.176 Vali Loss: 1.508 Vali Acc: 0.297 Test Loss: 1.508 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.2668046951293945
Epoch: 5, Steps: 10 | Train Loss: 0.913 Vali Loss: 1.261 Vali Acc: 0.473 Test Loss: 1.261 Test Acc: 0.473
Validation loss decreased (-0.351338 --> -0.472960).  Saving model ...
Epoch: 6 cost time: 2.510796070098877
Epoch: 6, Steps: 10 | Train Loss: 0.854 Vali Loss: 1.239 Vali Acc: 0.459 Test Loss: 1.239 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.65151047706604
Epoch: 7, Steps: 10 | Train Loss: 0.594 Vali Loss: 1.125 Vali Acc: 0.500 Test Loss: 1.125 Test Acc: 0.500
Validation loss decreased (-0.472960 --> -0.499989).  Saving model ...
Epoch: 8 cost time: 1.95047926902771
Epoch: 8, Steps: 10 | Train Loss: 0.518 Vali Loss: 1.265 Vali Acc: 0.459 Test Loss: 1.265 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1292614936828613
Epoch: 9, Steps: 10 | Train Loss: 0.429 Vali Loss: 1.210 Vali Acc: 0.459 Test Loss: 1.210 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.338958501815796
Epoch: 10, Steps: 10 | Train Loss: 0.447 Vali Loss: 1.710 Vali Acc: 0.432 Test Loss: 1.710 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.3726847171783447
Epoch: 11, Steps: 10 | Train Loss: 0.416 Vali Loss: 1.262 Vali Acc: 0.568 Test Loss: 1.262 Test Acc: 0.568
Validation loss decreased (-0.499989 --> -0.567555).  Saving model ...
Epoch: 12 cost time: 2.162806272506714
Epoch: 12, Steps: 10 | Train Loss: 0.168 Vali Loss: 1.566 Vali Acc: 0.622 Test Loss: 1.566 Test Acc: 0.622
Validation loss decreased (-0.567555 --> -0.621606).  Saving model ...
Epoch: 13 cost time: 1.9776899814605713
Epoch: 13, Steps: 10 | Train Loss: 0.193 Vali Loss: 2.061 Vali Acc: 0.459 Test Loss: 2.061 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7555210590362549
Epoch: 14, Steps: 10 | Train Loss: 0.071 Vali Loss: 1.450 Vali Acc: 0.554 Test Loss: 1.450 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8958358764648438
Epoch: 15, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.683 Vali Acc: 0.541 Test Loss: 1.683 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.9335923194885254
Epoch: 16, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.476 Vali Acc: 0.595 Test Loss: 1.476 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.350236654281616
Epoch: 17, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.647 Vali Acc: 0.541 Test Loss: 1.647 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.8354032039642334
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.643 Vali Acc: 0.554 Test Loss: 1.643 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.1873204708099365
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.694 Vali Acc: 0.581 Test Loss: 1.694 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.1650853157043457
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.755 Vali Acc: 0.568 Test Loss: 1.755 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.4320173263549805
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.777 Vali Acc: 0.568 Test Loss: 1.777 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.4144349098205566
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.755 Vali Acc: 0.568 Test Loss: 1.755 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 1637288
model size : 8.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.184429168701172
Epoch: 1, Steps: 10 | Train Loss: 1.507 Vali Loss: 1.421 Vali Acc: 0.189 Test Loss: 1.421 Test Acc: 0.189
Validation loss decreased (inf --> -0.189175).  Saving model ...
Epoch: 2 cost time: 2.196321487426758
Epoch: 2, Steps: 10 | Train Loss: 1.439 Vali Loss: 1.398 Vali Acc: 0.351 Test Loss: 1.398 Test Acc: 0.351
Validation loss decreased (-0.189175 --> -0.351337).  Saving model ...
Epoch: 3 cost time: 2.3093433380126953
Epoch: 3, Steps: 10 | Train Loss: 1.297 Vali Loss: 1.339 Vali Acc: 0.297 Test Loss: 1.339 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6846890449523926
Epoch: 4, Steps: 10 | Train Loss: 1.180 Vali Loss: 1.210 Vali Acc: 0.432 Test Loss: 1.210 Test Acc: 0.432
Validation loss decreased (-0.351337 --> -0.432420).  Saving model ...
Epoch: 5 cost time: 2.7182681560516357
Epoch: 5, Steps: 10 | Train Loss: 1.039 Vali Loss: 1.200 Vali Acc: 0.432 Test Loss: 1.200 Test Acc: 0.432
Validation loss decreased (-0.432420 --> -0.432420).  Saving model ...
Epoch: 6 cost time: 2.7698984146118164
Epoch: 6, Steps: 10 | Train Loss: 0.852 Vali Loss: 1.265 Vali Acc: 0.392 Test Loss: 1.265 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.7177507877349854
Epoch: 7, Steps: 10 | Train Loss: 0.706 Vali Loss: 1.065 Vali Acc: 0.541 Test Loss: 1.065 Test Acc: 0.541
Validation loss decreased (-0.432420 --> -0.540530).  Saving model ...
Epoch: 8 cost time: 2.235971212387085
Epoch: 8, Steps: 10 | Train Loss: 0.640 Vali Loss: 1.026 Vali Acc: 0.622 Test Loss: 1.026 Test Acc: 0.622
Validation loss decreased (-0.540530 --> -0.621611).  Saving model ...
Epoch: 9 cost time: 2.7983152866363525
Epoch: 9, Steps: 10 | Train Loss: 0.522 Vali Loss: 1.536 Vali Acc: 0.338 Test Loss: 1.536 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.004786729812622
Epoch: 10, Steps: 10 | Train Loss: 0.466 Vali Loss: 1.132 Vali Acc: 0.500 Test Loss: 1.132 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.6690025329589844
Epoch: 11, Steps: 10 | Train Loss: 0.259 Vali Loss: 1.282 Vali Acc: 0.541 Test Loss: 1.282 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.567952871322632
Epoch: 12, Steps: 10 | Train Loss: 0.228 Vali Loss: 1.146 Vali Acc: 0.595 Test Loss: 1.146 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.5652883052825928
Epoch: 13, Steps: 10 | Train Loss: 0.164 Vali Loss: 1.113 Vali Acc: 0.568 Test Loss: 1.113 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.887791633605957
Epoch: 14, Steps: 10 | Train Loss: 0.095 Vali Loss: 1.345 Vali Acc: 0.554 Test Loss: 1.345 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.509021282196045
Epoch: 15, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.271 Vali Acc: 0.541 Test Loss: 1.271 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.624608278274536
Epoch: 16, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.255 Vali Acc: 0.554 Test Loss: 1.255 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.508533239364624
Epoch: 17, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.372 Vali Acc: 0.554 Test Loss: 1.372 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.377434015274048
Epoch: 18, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.340 Vali Acc: 0.568 Test Loss: 1.340 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 1079016
model size : 5.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.846378803253174
Epoch: 1, Steps: 10 | Train Loss: 1.436 Vali Loss: 1.545 Vali Acc: 0.189 Test Loss: 1.545 Test Acc: 0.189
Validation loss decreased (inf --> -0.189174).  Saving model ...
Epoch: 2 cost time: 2.0128285884857178
Epoch: 2, Steps: 10 | Train Loss: 1.408 Vali Loss: 1.335 Vali Acc: 0.392 Test Loss: 1.335 Test Acc: 0.392
Validation loss decreased (-0.189174 --> -0.391879).  Saving model ...
Epoch: 3 cost time: 2.301679849624634
Epoch: 3, Steps: 10 | Train Loss: 1.245 Vali Loss: 1.408 Vali Acc: 0.270 Test Loss: 1.408 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.1476433277130127
Epoch: 4, Steps: 10 | Train Loss: 1.342 Vali Loss: 1.336 Vali Acc: 0.297 Test Loss: 1.336 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.0292065143585205
Epoch: 5, Steps: 10 | Train Loss: 1.087 Vali Loss: 1.184 Vali Acc: 0.527 Test Loss: 1.184 Test Acc: 0.527
Validation loss decreased (-0.391879 --> -0.527015).  Saving model ...
Epoch: 6 cost time: 2.173168897628784
Epoch: 6, Steps: 10 | Train Loss: 0.928 Vali Loss: 1.252 Vali Acc: 0.473 Test Loss: 1.252 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.1368305683135986
Epoch: 7, Steps: 10 | Train Loss: 0.796 Vali Loss: 1.123 Vali Acc: 0.500 Test Loss: 1.123 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7201390266418457
Epoch: 8, Steps: 10 | Train Loss: 0.606 Vali Loss: 1.219 Vali Acc: 0.554 Test Loss: 1.219 Test Acc: 0.554
Validation loss decreased (-0.527015 --> -0.554042).  Saving model ...
Epoch: 9 cost time: 1.9774603843688965
Epoch: 9, Steps: 10 | Train Loss: 0.481 Vali Loss: 1.168 Vali Acc: 0.500 Test Loss: 1.168 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.942112684249878
Epoch: 10, Steps: 10 | Train Loss: 0.387 Vali Loss: 1.025 Vali Acc: 0.581 Test Loss: 1.025 Test Acc: 0.581
Validation loss decreased (-0.554042 --> -0.581071).  Saving model ...
Epoch: 11 cost time: 1.7825381755828857
Epoch: 11, Steps: 10 | Train Loss: 0.255 Vali Loss: 1.130 Vali Acc: 0.554 Test Loss: 1.130 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.034269332885742
Epoch: 12, Steps: 10 | Train Loss: 0.199 Vali Loss: 1.185 Vali Acc: 0.541 Test Loss: 1.185 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.250838041305542
Epoch: 13, Steps: 10 | Train Loss: 0.113 Vali Loss: 1.200 Vali Acc: 0.554 Test Loss: 1.200 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.3489179611206055
Epoch: 14, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.233 Vali Acc: 0.568 Test Loss: 1.233 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.5309743881225586
Epoch: 15, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.331 Vali Acc: 0.568 Test Loss: 1.331 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.1620240211486816
Epoch: 16, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.281 Vali Acc: 0.541 Test Loss: 1.281 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.6764872074127197
Epoch: 17, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.352 Vali Acc: 0.541 Test Loss: 1.352 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.311817169189453
Epoch: 18, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.325 Vali Acc: 0.527 Test Loss: 1.325 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.1856942176818848
Epoch: 19, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.305 Vali Acc: 0.527 Test Loss: 1.305 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.430069923400879
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.370 Vali Acc: 0.541 Test Loss: 1.370 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 1075752
model size : 5.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.002816915512085
Epoch: 1, Steps: 10 | Train Loss: 1.431 Vali Loss: 1.327 Vali Acc: 0.378 Test Loss: 1.327 Test Acc: 0.378
Validation loss decreased (inf --> -0.378365).  Saving model ...
Epoch: 2 cost time: 1.799464464187622
Epoch: 2, Steps: 10 | Train Loss: 1.428 Vali Loss: 1.388 Vali Acc: 0.297 Test Loss: 1.388 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.400351047515869
Epoch: 3, Steps: 10 | Train Loss: 1.315 Vali Loss: 1.270 Vali Acc: 0.432 Test Loss: 1.270 Test Acc: 0.432
Validation loss decreased (-0.378365 --> -0.432420).  Saving model ...
Epoch: 4 cost time: 1.8402528762817383
Epoch: 4, Steps: 10 | Train Loss: 1.165 Vali Loss: 1.273 Vali Acc: 0.392 Test Loss: 1.273 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0501298904418945
Epoch: 5, Steps: 10 | Train Loss: 1.043 Vali Loss: 1.297 Vali Acc: 0.365 Test Loss: 1.297 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.9219822883605957
Epoch: 6, Steps: 10 | Train Loss: 0.891 Vali Loss: 1.181 Vali Acc: 0.486 Test Loss: 1.181 Test Acc: 0.486
Validation loss decreased (-0.432420 --> -0.486475).  Saving model ...
Epoch: 7 cost time: 2.011504650115967
Epoch: 7, Steps: 10 | Train Loss: 0.704 Vali Loss: 1.065 Vali Acc: 0.554 Test Loss: 1.065 Test Acc: 0.554
Validation loss decreased (-0.486475 --> -0.554043).  Saving model ...
Epoch: 8 cost time: 1.6084740161895752
Epoch: 8, Steps: 10 | Train Loss: 0.556 Vali Loss: 1.103 Vali Acc: 0.541 Test Loss: 1.103 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9052650928497314
Epoch: 9, Steps: 10 | Train Loss: 0.422 Vali Loss: 1.088 Vali Acc: 0.608 Test Loss: 1.088 Test Acc: 0.608
Validation loss decreased (-0.554043 --> -0.608097).  Saving model ...
Epoch: 10 cost time: 2.2751448154449463
Epoch: 10, Steps: 10 | Train Loss: 0.345 Vali Loss: 1.030 Vali Acc: 0.568 Test Loss: 1.030 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.2244648933410645
Epoch: 11, Steps: 10 | Train Loss: 0.282 Vali Loss: 1.413 Vali Acc: 0.527 Test Loss: 1.413 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.1685667037963867
Epoch: 12, Steps: 10 | Train Loss: 0.230 Vali Loss: 1.170 Vali Acc: 0.595 Test Loss: 1.170 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.3170361518859863
Epoch: 13, Steps: 10 | Train Loss: 0.158 Vali Loss: 1.131 Vali Acc: 0.581 Test Loss: 1.131 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.33304762840271
Epoch: 14, Steps: 10 | Train Loss: 0.073 Vali Loss: 1.396 Vali Acc: 0.541 Test Loss: 1.396 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.1485884189605713
Epoch: 15, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.246 Vali Acc: 0.568 Test Loss: 1.246 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.9369263648986816
Epoch: 16, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.345 Vali Acc: 0.581 Test Loss: 1.345 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.9356873035430908
Epoch: 17, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.270 Vali Acc: 0.622 Test Loss: 1.270 Test Acc: 0.622
Validation loss decreased (-0.608097 --> -0.621609).  Saving model ...
Epoch: 18 cost time: 2.2852389812469482
Epoch: 18, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.272 Vali Acc: 0.595 Test Loss: 1.272 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.2548775672912598
Epoch: 19, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.288 Vali Acc: 0.595 Test Loss: 1.288 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.2022902965545654
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.314 Vali Acc: 0.608 Test Loss: 1.314 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.3336403369903564
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.309 Vali Acc: 0.608 Test Loss: 1.309 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.0815834999084473
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.320 Vali Acc: 0.608 Test Loss: 1.320 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.2799854278564453
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.314 Vali Acc: 0.595 Test Loss: 1.314 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.4393317699432373
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.340 Vali Acc: 0.608 Test Loss: 1.340 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.298898935317993
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.352 Vali Acc: 0.622 Test Loss: 1.352 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.9220781326293945
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.346 Vali Acc: 0.595 Test Loss: 1.346 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.4974894523620605
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.366 Vali Acc: 0.608 Test Loss: 1.366 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 1072488
model size : 5.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.8829832077026367
Epoch: 1, Steps: 10 | Train Loss: 1.465 Vali Loss: 1.487 Vali Acc: 0.108 Test Loss: 1.487 Test Acc: 0.108
Validation loss decreased (inf --> -0.108093).  Saving model ...
Epoch: 2 cost time: 1.9403252601623535
Epoch: 2, Steps: 10 | Train Loss: 1.505 Vali Loss: 1.476 Vali Acc: 0.216 Test Loss: 1.476 Test Acc: 0.216
Validation loss decreased (-0.108093 --> -0.216201).  Saving model ...
Epoch: 3 cost time: 1.8319873809814453
Epoch: 3, Steps: 10 | Train Loss: 1.335 Vali Loss: 1.334 Vali Acc: 0.419 Test Loss: 1.334 Test Acc: 0.419
Validation loss decreased (-0.216201 --> -0.418906).  Saving model ...
Epoch: 4 cost time: 2.0524861812591553
Epoch: 4, Steps: 10 | Train Loss: 1.226 Vali Loss: 1.428 Vali Acc: 0.257 Test Loss: 1.428 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0521109104156494
Epoch: 5, Steps: 10 | Train Loss: 1.191 Vali Loss: 1.444 Vali Acc: 0.284 Test Loss: 1.444 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.3523757457733154
Epoch: 6, Steps: 10 | Train Loss: 1.058 Vali Loss: 1.227 Vali Acc: 0.500 Test Loss: 1.227 Test Acc: 0.500
Validation loss decreased (-0.418906 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 2.3928887844085693
Epoch: 7, Steps: 10 | Train Loss: 0.859 Vali Loss: 1.339 Vali Acc: 0.392 Test Loss: 1.339 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9870085716247559
Epoch: 8, Steps: 10 | Train Loss: 0.798 Vali Loss: 1.240 Vali Acc: 0.432 Test Loss: 1.240 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.2483625411987305
Epoch: 9, Steps: 10 | Train Loss: 0.570 Vali Loss: 1.081 Vali Acc: 0.568 Test Loss: 1.081 Test Acc: 0.568
Validation loss decreased (-0.499988 --> -0.567557).  Saving model ...
Epoch: 10 cost time: 1.8025562763214111
Epoch: 10, Steps: 10 | Train Loss: 0.409 Vali Loss: 1.131 Vali Acc: 0.581 Test Loss: 1.131 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581070).  Saving model ...
Epoch: 11 cost time: 2.022066593170166
Epoch: 11, Steps: 10 | Train Loss: 0.281 Vali Loss: 1.191 Vali Acc: 0.554 Test Loss: 1.191 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.1008286476135254
Epoch: 12, Steps: 10 | Train Loss: 0.213 Vali Loss: 1.157 Vali Acc: 0.568 Test Loss: 1.157 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8427512645721436
Epoch: 13, Steps: 10 | Train Loss: 0.125 Vali Loss: 1.190 Vali Acc: 0.595 Test Loss: 1.190 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594583).  Saving model ...
Epoch: 14 cost time: 1.7522478103637695
Epoch: 14, Steps: 10 | Train Loss: 0.080 Vali Loss: 1.232 Vali Acc: 0.568 Test Loss: 1.232 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.075338363647461
Epoch: 15, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.342 Vali Acc: 0.595 Test Loss: 1.342 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.3046319484710693
Epoch: 16, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.280 Vali Acc: 0.581 Test Loss: 1.280 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.2745299339294434
Epoch: 17, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.348 Vali Acc: 0.581 Test Loss: 1.348 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.7804584503173828
Epoch: 18, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.306 Vali Acc: 0.581 Test Loss: 1.306 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.4493603706359863
Epoch: 19, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.325 Vali Acc: 0.581 Test Loss: 1.325 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.2715721130371094
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.328 Vali Acc: 0.568 Test Loss: 1.328 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.1808626651763916
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.336 Vali Acc: 0.581 Test Loss: 1.336 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.0405309200286865
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.366 Vali Acc: 0.581 Test Loss: 1.366 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.1080071926116943
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.341 Vali Acc: 0.595 Test Loss: 1.341 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 1069224
model size : 5.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.431371450424194
Epoch: 1, Steps: 10 | Train Loss: 1.453 Vali Loss: 1.471 Vali Acc: 0.216 Test Loss: 1.471 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 2.749072313308716
Epoch: 2, Steps: 10 | Train Loss: 1.406 Vali Loss: 1.359 Vali Acc: 0.284 Test Loss: 1.359 Test Acc: 0.284
Validation loss decreased (-0.216202 --> -0.283770).  Saving model ...
Epoch: 3 cost time: 1.6481757164001465
Epoch: 3, Steps: 10 | Train Loss: 1.278 Vali Loss: 1.513 Vali Acc: 0.203 Test Loss: 1.513 Test Acc: 0.203
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.6915433406829834
Epoch: 4, Steps: 10 | Train Loss: 1.229 Vali Loss: 1.302 Vali Acc: 0.405 Test Loss: 1.302 Test Acc: 0.405
Validation loss decreased (-0.283770 --> -0.405392).  Saving model ...
Epoch: 5 cost time: 2.4628758430480957
Epoch: 5, Steps: 10 | Train Loss: 1.172 Vali Loss: 1.280 Vali Acc: 0.419 Test Loss: 1.280 Test Acc: 0.419
Validation loss decreased (-0.405392 --> -0.418906).  Saving model ...
Epoch: 6 cost time: 2.4784531593322754
Epoch: 6, Steps: 10 | Train Loss: 1.005 Vali Loss: 1.433 Vali Acc: 0.311 Test Loss: 1.433 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.599761724472046
Epoch: 7, Steps: 10 | Train Loss: 0.882 Vali Loss: 1.088 Vali Acc: 0.541 Test Loss: 1.088 Test Acc: 0.541
Validation loss decreased (-0.418906 --> -0.540530).  Saving model ...
Epoch: 8 cost time: 2.9306488037109375
Epoch: 8, Steps: 10 | Train Loss: 0.701 Vali Loss: 1.207 Vali Acc: 0.473 Test Loss: 1.207 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9329917430877686
Epoch: 9, Steps: 10 | Train Loss: 0.580 Vali Loss: 1.150 Vali Acc: 0.541 Test Loss: 1.150 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.9762775897979736
Epoch: 10, Steps: 10 | Train Loss: 0.477 Vali Loss: 1.322 Vali Acc: 0.432 Test Loss: 1.322 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.133941650390625
Epoch: 11, Steps: 10 | Train Loss: 0.375 Vali Loss: 1.097 Vali Acc: 0.608 Test Loss: 1.097 Test Acc: 0.608
Validation loss decreased (-0.540530 --> -0.608097).  Saving model ...
Epoch: 12 cost time: 2.9315454959869385
Epoch: 12, Steps: 10 | Train Loss: 0.262 Vali Loss: 1.238 Vali Acc: 0.568 Test Loss: 1.238 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.1808509826660156
Epoch: 13, Steps: 10 | Train Loss: 0.155 Vali Loss: 1.314 Vali Acc: 0.568 Test Loss: 1.314 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8931424617767334
Epoch: 14, Steps: 10 | Train Loss: 0.136 Vali Loss: 1.201 Vali Acc: 0.568 Test Loss: 1.201 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5267670154571533
Epoch: 15, Steps: 10 | Train Loss: 0.075 Vali Loss: 1.357 Vali Acc: 0.581 Test Loss: 1.357 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.6353049278259277
Epoch: 16, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.427 Vali Acc: 0.581 Test Loss: 1.427 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.081345558166504
Epoch: 17, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.402 Vali Acc: 0.581 Test Loss: 1.402 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.041226863861084
Epoch: 18, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.357 Vali Acc: 0.581 Test Loss: 1.357 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.986344814300537
Epoch: 19, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.445 Vali Acc: 0.595 Test Loss: 1.445 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.6791584491729736
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.376 Vali Acc: 0.622 Test Loss: 1.376 Test Acc: 0.622
Validation loss decreased (-0.608097 --> -0.621608).  Saving model ...
Epoch: 21 cost time: 2.4373457431793213
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.420 Vali Acc: 0.568 Test Loss: 1.420 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.1271753311157227
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.451 Vali Acc: 0.595 Test Loss: 1.451 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.432016372680664
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.443 Vali Acc: 0.581 Test Loss: 1.443 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.764573335647583
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.442 Vali Acc: 0.554 Test Loss: 1.442 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.7117159366607666
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.461 Vali Acc: 0.568 Test Loss: 1.461 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.5928709506988525
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.485 Vali Acc: 0.581 Test Loss: 1.485 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.540339708328247
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.483 Vali Acc: 0.568 Test Loss: 1.483 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.2499709129333496
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.492 Vali Acc: 0.554 Test Loss: 1.492 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.164168357849121
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.489 Vali Acc: 0.568 Test Loss: 1.489 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.206603765487671
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.494 Vali Acc: 0.581 Test Loss: 1.494 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 748776
model size : 4.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.294051170349121
Epoch: 1, Steps: 10 | Train Loss: 1.435 Vali Loss: 1.389 Vali Acc: 0.230 Test Loss: 1.389 Test Acc: 0.230
Validation loss decreased (inf --> -0.229716).  Saving model ...
Epoch: 2 cost time: 2.50950288772583
Epoch: 2, Steps: 10 | Train Loss: 1.437 Vali Loss: 1.385 Vali Acc: 0.257 Test Loss: 1.385 Test Acc: 0.257
Validation loss decreased (-0.229716 --> -0.256743).  Saving model ...
Epoch: 3 cost time: 2.558938980102539
Epoch: 3, Steps: 10 | Train Loss: 1.343 Vali Loss: 1.405 Vali Acc: 0.392 Test Loss: 1.405 Test Acc: 0.392
Validation loss decreased (-0.256743 --> -0.391878).  Saving model ...
Epoch: 4 cost time: 2.6100940704345703
Epoch: 4, Steps: 10 | Train Loss: 1.198 Vali Loss: 1.268 Vali Acc: 0.446 Test Loss: 1.268 Test Acc: 0.446
Validation loss decreased (-0.391878 --> -0.445933).  Saving model ...
Epoch: 5 cost time: 2.424603223800659
Epoch: 5, Steps: 10 | Train Loss: 1.072 Vali Loss: 1.203 Vali Acc: 0.459 Test Loss: 1.203 Test Acc: 0.459
Validation loss decreased (-0.445933 --> -0.459447).  Saving model ...
Epoch: 6 cost time: 2.743964433670044
Epoch: 6, Steps: 10 | Train Loss: 0.943 Vali Loss: 1.243 Vali Acc: 0.446 Test Loss: 1.243 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.179957389831543
Epoch: 7, Steps: 10 | Train Loss: 0.760 Vali Loss: 1.215 Vali Acc: 0.459 Test Loss: 1.215 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.6798348426818848
Epoch: 8, Steps: 10 | Train Loss: 0.668 Vali Loss: 1.049 Vali Acc: 0.541 Test Loss: 1.049 Test Acc: 0.541
Validation loss decreased (-0.459447 --> -0.540530).  Saving model ...
Epoch: 9 cost time: 1.5672049522399902
Epoch: 9, Steps: 10 | Train Loss: 0.521 Vali Loss: 1.249 Vali Acc: 0.473 Test Loss: 1.249 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.411086082458496
Epoch: 10, Steps: 10 | Train Loss: 0.390 Vali Loss: 1.103 Vali Acc: 0.554 Test Loss: 1.103 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554043).  Saving model ...
Epoch: 11 cost time: 2.290961742401123
Epoch: 11, Steps: 10 | Train Loss: 0.332 Vali Loss: 1.119 Vali Acc: 0.568 Test Loss: 1.119 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567556).  Saving model ...
Epoch: 12 cost time: 2.1144111156463623
Epoch: 12, Steps: 10 | Train Loss: 0.321 Vali Loss: 1.363 Vali Acc: 0.486 Test Loss: 1.363 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.8161842823028564
Epoch: 13, Steps: 10 | Train Loss: 0.156 Vali Loss: 1.243 Vali Acc: 0.514 Test Loss: 1.243 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.571281909942627
Epoch: 14, Steps: 10 | Train Loss: 0.108 Vali Loss: 1.143 Vali Acc: 0.554 Test Loss: 1.143 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.246427297592163
Epoch: 15, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.422 Vali Acc: 0.486 Test Loss: 1.422 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.014930248260498
Epoch: 16, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.289 Vali Acc: 0.568 Test Loss: 1.289 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.233527898788452
Epoch: 17, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.508 Vali Acc: 0.527 Test Loss: 1.508 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.3461380004882812
Epoch: 18, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.356 Vali Acc: 0.554 Test Loss: 1.356 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.3087503910064697
Epoch: 19, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.404 Vali Acc: 0.554 Test Loss: 1.404 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.1270291805267334
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.420 Vali Acc: 0.554 Test Loss: 1.420 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.1683216094970703
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.426 Vali Acc: 0.554 Test Loss: 1.426 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 745512
model size : 4.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.4251556396484375
Epoch: 1, Steps: 10 | Train Loss: 1.454 Vali Loss: 1.346 Vali Acc: 0.365 Test Loss: 1.346 Test Acc: 0.365
Validation loss decreased (inf --> -0.364851).  Saving model ...
Epoch: 2 cost time: 2.737475633621216
Epoch: 2, Steps: 10 | Train Loss: 1.363 Vali Loss: 1.383 Vali Acc: 0.297 Test Loss: 1.383 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.233133554458618
Epoch: 3, Steps: 10 | Train Loss: 1.346 Vali Loss: 1.326 Vali Acc: 0.297 Test Loss: 1.326 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.3868017196655273
Epoch: 4, Steps: 10 | Train Loss: 1.205 Vali Loss: 1.421 Vali Acc: 0.311 Test Loss: 1.421 Test Acc: 0.311
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.721872329711914
Epoch: 5, Steps: 10 | Train Loss: 1.062 Vali Loss: 1.240 Vali Acc: 0.500 Test Loss: 1.240 Test Acc: 0.500
Validation loss decreased (-0.364851 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 2.3318123817443848
Epoch: 6, Steps: 10 | Train Loss: 0.941 Vali Loss: 1.214 Vali Acc: 0.432 Test Loss: 1.214 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.1404008865356445
Epoch: 7, Steps: 10 | Train Loss: 0.836 Vali Loss: 1.400 Vali Acc: 0.365 Test Loss: 1.400 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.150561571121216
Epoch: 8, Steps: 10 | Train Loss: 0.688 Vali Loss: 1.144 Vali Acc: 0.486 Test Loss: 1.144 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.1946051120758057
Epoch: 9, Steps: 10 | Train Loss: 0.584 Vali Loss: 1.298 Vali Acc: 0.473 Test Loss: 1.298 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.3289287090301514
Epoch: 10, Steps: 10 | Train Loss: 0.484 Vali Loss: 1.356 Vali Acc: 0.446 Test Loss: 1.356 Test Acc: 0.446
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.416022300720215
Epoch: 11, Steps: 10 | Train Loss: 0.338 Vali Loss: 1.138 Vali Acc: 0.554 Test Loss: 1.138 Test Acc: 0.554
Validation loss decreased (-0.499988 --> -0.554043).  Saving model ...
Epoch: 12 cost time: 1.9142930507659912
Epoch: 12, Steps: 10 | Train Loss: 0.251 Vali Loss: 1.118 Vali Acc: 0.514 Test Loss: 1.118 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.509111166000366
Epoch: 13, Steps: 10 | Train Loss: 0.147 Vali Loss: 1.166 Vali Acc: 0.554 Test Loss: 1.166 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.2349741458892822
Epoch: 14, Steps: 10 | Train Loss: 0.115 Vali Loss: 1.239 Vali Acc: 0.554 Test Loss: 1.239 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.4973232746124268
Epoch: 15, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.245 Vali Acc: 0.581 Test Loss: 1.245 Test Acc: 0.581
Validation loss decreased (-0.554043 --> -0.581069).  Saving model ...
Epoch: 16 cost time: 2.531726121902466
Epoch: 16, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.547 Vali Acc: 0.486 Test Loss: 1.547 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.388366222381592
Epoch: 17, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.353 Vali Acc: 0.608 Test Loss: 1.353 Test Acc: 0.608
Validation loss decreased (-0.581069 --> -0.608095).  Saving model ...
Epoch: 18 cost time: 2.6243863105773926
Epoch: 18, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.554 Vali Acc: 0.514 Test Loss: 1.554 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8829646110534668
Epoch: 19, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.430 Vali Acc: 0.568 Test Loss: 1.430 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.922344446182251
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.492 Vali Acc: 0.541 Test Loss: 1.492 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.862882375717163
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.484 Vali Acc: 0.568 Test Loss: 1.484 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.6807904243469238
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.485 Vali Acc: 0.568 Test Loss: 1.485 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.8868985176086426
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.517 Vali Acc: 0.554 Test Loss: 1.517 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.3701603412628174
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.515 Vali Acc: 0.554 Test Loss: 1.515 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.515080451965332
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.528 Vali Acc: 0.568 Test Loss: 1.528 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.7436282634735107
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.539 Vali Acc: 0.568 Test Loss: 1.539 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.3767309188842773
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.534 Vali Acc: 0.568 Test Loss: 1.534 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 742248
model size : 4.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.135442733764648
Epoch: 1, Steps: 10 | Train Loss: 1.557 Vali Loss: 1.438 Vali Acc: 0.203 Test Loss: 1.438 Test Acc: 0.203
Validation loss decreased (inf --> -0.202688).  Saving model ...
Epoch: 2 cost time: 2.136509418487549
Epoch: 2, Steps: 10 | Train Loss: 1.446 Vali Loss: 1.423 Vali Acc: 0.365 Test Loss: 1.423 Test Acc: 0.365
Validation loss decreased (-0.202688 --> -0.364851).  Saving model ...
Epoch: 3 cost time: 2.2571940422058105
Epoch: 3, Steps: 10 | Train Loss: 1.290 Vali Loss: 1.327 Vali Acc: 0.284 Test Loss: 1.327 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.337449073791504
Epoch: 4, Steps: 10 | Train Loss: 1.193 Vali Loss: 1.220 Vali Acc: 0.527 Test Loss: 1.220 Test Acc: 0.527
Validation loss decreased (-0.364851 --> -0.527015).  Saving model ...
Epoch: 5 cost time: 2.131706953048706
Epoch: 5, Steps: 10 | Train Loss: 1.155 Vali Loss: 1.190 Vali Acc: 0.554 Test Loss: 1.190 Test Acc: 0.554
Validation loss decreased (-0.527015 --> -0.554042).  Saving model ...
Epoch: 6 cost time: 2.157912015914917
Epoch: 6, Steps: 10 | Train Loss: 0.982 Vali Loss: 1.313 Vali Acc: 0.405 Test Loss: 1.313 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.2538161277770996
Epoch: 7, Steps: 10 | Train Loss: 0.813 Vali Loss: 1.115 Vali Acc: 0.554 Test Loss: 1.115 Test Acc: 0.554
Validation loss decreased (-0.554042 --> -0.554043).  Saving model ...
Epoch: 8 cost time: 1.7989516258239746
Epoch: 8, Steps: 10 | Train Loss: 0.639 Vali Loss: 1.104 Vali Acc: 0.554 Test Loss: 1.104 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554043).  Saving model ...
Epoch: 9 cost time: 1.855165958404541
Epoch: 9, Steps: 10 | Train Loss: 0.517 Vali Loss: 1.147 Vali Acc: 0.527 Test Loss: 1.147 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1192426681518555
Epoch: 10, Steps: 10 | Train Loss: 0.362 Vali Loss: 1.029 Vali Acc: 0.568 Test Loss: 1.029 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567557).  Saving model ...
Epoch: 11 cost time: 2.320051431655884
Epoch: 11, Steps: 10 | Train Loss: 0.287 Vali Loss: 1.095 Vali Acc: 0.581 Test Loss: 1.095 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581070).  Saving model ...
Epoch: 12 cost time: 2.469622850418091
Epoch: 12, Steps: 10 | Train Loss: 0.188 Vali Loss: 1.020 Vali Acc: 0.649 Test Loss: 1.020 Test Acc: 0.649
Validation loss decreased (-0.581070 --> -0.648638).  Saving model ...
Epoch: 13 cost time: 2.4399220943450928
Epoch: 13, Steps: 10 | Train Loss: 0.121 Vali Loss: 1.146 Vali Acc: 0.622 Test Loss: 1.146 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.2462048530578613
Epoch: 14, Steps: 10 | Train Loss: 0.088 Vali Loss: 1.225 Vali Acc: 0.622 Test Loss: 1.225 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.4452924728393555
Epoch: 15, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.218 Vali Acc: 0.622 Test Loss: 1.218 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.4368438720703125
Epoch: 16, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.231 Vali Acc: 0.635 Test Loss: 1.231 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.4830322265625
Epoch: 17, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.259 Vali Acc: 0.662 Test Loss: 1.259 Test Acc: 0.662
Validation loss decreased (-0.648638 --> -0.662150).  Saving model ...
Epoch: 18 cost time: 2.059595823287964
Epoch: 18, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.283 Vali Acc: 0.622 Test Loss: 1.283 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8087825775146484
Epoch: 19, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.302 Vali Acc: 0.635 Test Loss: 1.302 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.27850604057312
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.301 Vali Acc: 0.662 Test Loss: 1.301 Test Acc: 0.662
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.9424622058868408
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.368 Vali Acc: 0.649 Test Loss: 1.368 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.8933024406433105
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.330 Vali Acc: 0.662 Test Loss: 1.330 Test Acc: 0.662
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.867269515991211
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.345 Vali Acc: 0.649 Test Loss: 1.345 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.616746425628662
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.376 Vali Acc: 0.662 Test Loss: 1.376 Test Acc: 0.662
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.249098062515259
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.346 Vali Acc: 0.622 Test Loss: 1.346 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.404812812805176
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.378 Vali Acc: 0.662 Test Loss: 1.378 Test Acc: 0.662
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.205693483352661
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.400 Vali Acc: 0.649 Test Loss: 1.400 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6621621621621622
model parameter : 738984
model size : 4.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.830312967300415
Epoch: 1, Steps: 10 | Train Loss: 1.430 Vali Loss: 1.360 Vali Acc: 0.311 Test Loss: 1.360 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 2.653351068496704
Epoch: 2, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.326 Vali Acc: 0.378 Test Loss: 1.326 Test Acc: 0.378
Validation loss decreased (-0.310797 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 2.4707248210906982
Epoch: 3, Steps: 10 | Train Loss: 1.347 Vali Loss: 1.306 Vali Acc: 0.324 Test Loss: 1.306 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.35624098777771
Epoch: 4, Steps: 10 | Train Loss: 1.164 Vali Loss: 1.304 Vali Acc: 0.432 Test Loss: 1.304 Test Acc: 0.432
Validation loss decreased (-0.378365 --> -0.432419).  Saving model ...
Epoch: 5 cost time: 2.012195587158203
Epoch: 5, Steps: 10 | Train Loss: 1.114 Vali Loss: 1.307 Vali Acc: 0.351 Test Loss: 1.307 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.3740172386169434
Epoch: 6, Steps: 10 | Train Loss: 0.950 Vali Loss: 1.179 Vali Acc: 0.459 Test Loss: 1.179 Test Acc: 0.459
Validation loss decreased (-0.432419 --> -0.459448).  Saving model ...
Epoch: 7 cost time: 2.3812639713287354
Epoch: 7, Steps: 10 | Train Loss: 0.797 Vali Loss: 1.256 Vali Acc: 0.486 Test Loss: 1.256 Test Acc: 0.486
Validation loss decreased (-0.459448 --> -0.486474).  Saving model ...
Epoch: 8 cost time: 2.4036898612976074
Epoch: 8, Steps: 10 | Train Loss: 0.714 Vali Loss: 1.070 Vali Acc: 0.554 Test Loss: 1.070 Test Acc: 0.554
Validation loss decreased (-0.486474 --> -0.554043).  Saving model ...
Epoch: 9 cost time: 2.308168888092041
Epoch: 9, Steps: 10 | Train Loss: 0.546 Vali Loss: 1.138 Vali Acc: 0.541 Test Loss: 1.138 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.3244314193725586
Epoch: 10, Steps: 10 | Train Loss: 0.431 Vali Loss: 1.106 Vali Acc: 0.541 Test Loss: 1.106 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.263869047164917
Epoch: 11, Steps: 10 | Train Loss: 0.374 Vali Loss: 1.420 Vali Acc: 0.446 Test Loss: 1.420 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.2092487812042236
Epoch: 12, Steps: 10 | Train Loss: 0.320 Vali Loss: 1.219 Vali Acc: 0.581 Test Loss: 1.219 Test Acc: 0.581
Validation loss decreased (-0.554043 --> -0.581069).  Saving model ...
Epoch: 13 cost time: 2.0772104263305664
Epoch: 13, Steps: 10 | Train Loss: 0.237 Vali Loss: 1.237 Vali Acc: 0.486 Test Loss: 1.237 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7082107067108154
Epoch: 14, Steps: 10 | Train Loss: 0.172 Vali Loss: 1.388 Vali Acc: 0.554 Test Loss: 1.388 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.0443992614746094
Epoch: 15, Steps: 10 | Train Loss: 0.106 Vali Loss: 1.361 Vali Acc: 0.554 Test Loss: 1.361 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.2553212642669678
Epoch: 16, Steps: 10 | Train Loss: 0.065 Vali Loss: 1.286 Vali Acc: 0.554 Test Loss: 1.286 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.2471230030059814
Epoch: 17, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.425 Vali Acc: 0.568 Test Loss: 1.425 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.465592384338379
Epoch: 18, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.414 Vali Acc: 0.527 Test Loss: 1.414 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.2160696983337402
Epoch: 19, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.427 Vali Acc: 0.541 Test Loss: 1.427 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.4167232513427734
Epoch: 20, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.462 Vali Acc: 0.541 Test Loss: 1.462 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.409318447113037
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.523 Vali Acc: 0.541 Test Loss: 1.523 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.6883649826049805
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.531 Vali Acc: 0.554 Test Loss: 1.531 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 583656
model size : 3.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.315472841262817
Epoch: 1, Steps: 10 | Train Loss: 1.466 Vali Loss: 1.456 Vali Acc: 0.162 Test Loss: 1.456 Test Acc: 0.162
Validation loss decreased (inf --> -0.162148).  Saving model ...
Epoch: 2 cost time: 2.10526180267334
Epoch: 2, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.366 Vali Acc: 0.270 Test Loss: 1.366 Test Acc: 0.270
Validation loss decreased (-0.162148 --> -0.270257).  Saving model ...
Epoch: 3 cost time: 2.061473846435547
Epoch: 3, Steps: 10 | Train Loss: 1.312 Vali Loss: 1.367 Vali Acc: 0.311 Test Loss: 1.367 Test Acc: 0.311
Validation loss decreased (-0.270257 --> -0.310797).  Saving model ...
Epoch: 4 cost time: 1.896498680114746
Epoch: 4, Steps: 10 | Train Loss: 1.220 Vali Loss: 1.382 Vali Acc: 0.324 Test Loss: 1.382 Test Acc: 0.324
Validation loss decreased (-0.310797 --> -0.324311).  Saving model ...
Epoch: 5 cost time: 1.8083257675170898
Epoch: 5, Steps: 10 | Train Loss: 1.068 Vali Loss: 1.259 Vali Acc: 0.446 Test Loss: 1.259 Test Acc: 0.446
Validation loss decreased (-0.324311 --> -0.445933).  Saving model ...
Epoch: 6 cost time: 2.1758437156677246
Epoch: 6, Steps: 10 | Train Loss: 0.959 Vali Loss: 1.242 Vali Acc: 0.446 Test Loss: 1.242 Test Acc: 0.446
Validation loss decreased (-0.445933 --> -0.445934).  Saving model ...
Epoch: 7 cost time: 2.0511505603790283
Epoch: 7, Steps: 10 | Train Loss: 0.826 Vali Loss: 1.276 Vali Acc: 0.459 Test Loss: 1.276 Test Acc: 0.459
Validation loss decreased (-0.445934 --> -0.459447).  Saving model ...
Epoch: 8 cost time: 1.7215979099273682
Epoch: 8, Steps: 10 | Train Loss: 0.659 Vali Loss: 1.067 Vali Acc: 0.514 Test Loss: 1.067 Test Acc: 0.514
Validation loss decreased (-0.459447 --> -0.513503).  Saving model ...
Epoch: 9 cost time: 2.1434566974639893
Epoch: 9, Steps: 10 | Train Loss: 0.568 Vali Loss: 1.095 Vali Acc: 0.514 Test Loss: 1.095 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0295708179473877
Epoch: 10, Steps: 10 | Train Loss: 0.460 Vali Loss: 1.239 Vali Acc: 0.514 Test Loss: 1.239 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9798917770385742
Epoch: 11, Steps: 10 | Train Loss: 0.387 Vali Loss: 1.142 Vali Acc: 0.554 Test Loss: 1.142 Test Acc: 0.554
Validation loss decreased (-0.513503 --> -0.554043).  Saving model ...
Epoch: 12 cost time: 1.6327712535858154
Epoch: 12, Steps: 10 | Train Loss: 0.293 Vali Loss: 1.199 Vali Acc: 0.541 Test Loss: 1.199 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.0868842601776123
Epoch: 13, Steps: 10 | Train Loss: 0.210 Vali Loss: 1.467 Vali Acc: 0.486 Test Loss: 1.467 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.9986939430236816
Epoch: 14, Steps: 10 | Train Loss: 0.154 Vali Loss: 1.161 Vali Acc: 0.581 Test Loss: 1.161 Test Acc: 0.581
Validation loss decreased (-0.554043 --> -0.581069).  Saving model ...
Epoch: 15 cost time: 2.4423391819000244
Epoch: 15, Steps: 10 | Train Loss: 0.107 Vali Loss: 1.242 Vali Acc: 0.568 Test Loss: 1.242 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.2527594566345215
Epoch: 16, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.452 Vali Acc: 0.554 Test Loss: 1.452 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.27284574508667
Epoch: 17, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.354 Vali Acc: 0.568 Test Loss: 1.354 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.087174654006958
Epoch: 18, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.480 Vali Acc: 0.541 Test Loss: 1.480 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.5250837802886963
Epoch: 19, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.429 Vali Acc: 0.568 Test Loss: 1.429 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.9890847206115723
Epoch: 20, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.584 Vali Acc: 0.541 Test Loss: 1.584 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.089658260345459
Epoch: 21, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.480 Vali Acc: 0.568 Test Loss: 1.480 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.2463912963867188
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.518 Vali Acc: 0.541 Test Loss: 1.518 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.067884922027588
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.554 Vali Acc: 0.541 Test Loss: 1.554 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.1620540618896484
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.503 Vali Acc: 0.568 Test Loss: 1.503 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 580392
model size : 3.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.024045705795288
Epoch: 1, Steps: 10 | Train Loss: 1.450 Vali Loss: 1.498 Vali Acc: 0.176 Test Loss: 1.498 Test Acc: 0.176
Validation loss decreased (inf --> -0.175661).  Saving model ...
Epoch: 2 cost time: 2.129307985305786
Epoch: 2, Steps: 10 | Train Loss: 1.407 Vali Loss: 1.364 Vali Acc: 0.311 Test Loss: 1.364 Test Acc: 0.311
Validation loss decreased (-0.175661 --> -0.310797).  Saving model ...
Epoch: 3 cost time: 1.7382001876831055
Epoch: 3, Steps: 10 | Train Loss: 1.354 Vali Loss: 1.414 Vali Acc: 0.230 Test Loss: 1.414 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.1315317153930664
Epoch: 4, Steps: 10 | Train Loss: 1.249 Vali Loss: 1.323 Vali Acc: 0.419 Test Loss: 1.323 Test Acc: 0.419
Validation loss decreased (-0.310797 --> -0.418906).  Saving model ...
Epoch: 5 cost time: 2.237290620803833
Epoch: 5, Steps: 10 | Train Loss: 1.122 Vali Loss: 1.263 Vali Acc: 0.405 Test Loss: 1.263 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.144181251525879
Epoch: 6, Steps: 10 | Train Loss: 0.979 Vali Loss: 1.339 Vali Acc: 0.365 Test Loss: 1.339 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.4692001342773438
Epoch: 7, Steps: 10 | Train Loss: 0.848 Vali Loss: 1.257 Vali Acc: 0.351 Test Loss: 1.257 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.643871784210205
Epoch: 8, Steps: 10 | Train Loss: 0.714 Vali Loss: 1.260 Vali Acc: 0.392 Test Loss: 1.260 Test Acc: 0.392
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.888371706008911
Epoch: 9, Steps: 10 | Train Loss: 0.599 Vali Loss: 1.189 Vali Acc: 0.432 Test Loss: 1.189 Test Acc: 0.432
Validation loss decreased (-0.418906 --> -0.432421).  Saving model ...
Epoch: 10 cost time: 2.274580955505371
Epoch: 10, Steps: 10 | Train Loss: 0.474 Vali Loss: 1.233 Vali Acc: 0.527 Test Loss: 1.233 Test Acc: 0.527
Validation loss decreased (-0.432421 --> -0.527015).  Saving model ...
Epoch: 11 cost time: 2.462099552154541
Epoch: 11, Steps: 10 | Train Loss: 0.346 Vali Loss: 1.238 Vali Acc: 0.500 Test Loss: 1.238 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.5570361614227295
Epoch: 12, Steps: 10 | Train Loss: 0.261 Vali Loss: 1.231 Vali Acc: 0.514 Test Loss: 1.231 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.028226613998413
Epoch: 13, Steps: 10 | Train Loss: 0.192 Vali Loss: 1.289 Vali Acc: 0.527 Test Loss: 1.289 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.0107924938201904
Epoch: 14, Steps: 10 | Train Loss: 0.147 Vali Loss: 1.359 Vali Acc: 0.554 Test Loss: 1.359 Test Acc: 0.554
Validation loss decreased (-0.527015 --> -0.554040).  Saving model ...
Epoch: 15 cost time: 1.9521563053131104
Epoch: 15, Steps: 10 | Train Loss: 0.117 Vali Loss: 1.423 Vali Acc: 0.527 Test Loss: 1.423 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4976773262023926
Epoch: 16, Steps: 10 | Train Loss: 0.063 Vali Loss: 1.422 Vali Acc: 0.486 Test Loss: 1.422 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.0167298316955566
Epoch: 17, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.453 Vali Acc: 0.527 Test Loss: 1.453 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.0271120071411133
Epoch: 18, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.553 Vali Acc: 0.541 Test Loss: 1.553 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.6896069049835205
Epoch: 19, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.544 Vali Acc: 0.514 Test Loss: 1.544 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.0999977588653564
Epoch: 20, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.572 Vali Acc: 0.514 Test Loss: 1.572 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.1482131481170654
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.599 Vali Acc: 0.527 Test Loss: 1.599 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.55525803565979
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.608 Vali Acc: 0.527 Test Loss: 1.608 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.509206771850586
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.634 Vali Acc: 0.514 Test Loss: 1.634 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.167597532272339
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.619 Vali Acc: 0.527 Test Loss: 1.619 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 577128
model size : 3.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.803947925567627
Epoch: 1, Steps: 10 | Train Loss: 1.453 Vali Loss: 1.477 Vali Acc: 0.216 Test Loss: 1.477 Test Acc: 0.216
Validation loss decreased (inf --> -0.216201).  Saving model ...
Epoch: 2 cost time: 2.1041512489318848
Epoch: 2, Steps: 10 | Train Loss: 1.474 Vali Loss: 1.345 Vali Acc: 0.365 Test Loss: 1.345 Test Acc: 0.365
Validation loss decreased (-0.216201 --> -0.364851).  Saving model ...
Epoch: 3 cost time: 2.1436941623687744
Epoch: 3, Steps: 10 | Train Loss: 1.420 Vali Loss: 1.348 Vali Acc: 0.338 Test Loss: 1.348 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.67848539352417
Epoch: 4, Steps: 10 | Train Loss: 1.246 Vali Loss: 1.490 Vali Acc: 0.284 Test Loss: 1.490 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9572570323944092
Epoch: 5, Steps: 10 | Train Loss: 1.148 Vali Loss: 1.317 Vali Acc: 0.405 Test Loss: 1.317 Test Acc: 0.405
Validation loss decreased (-0.364851 --> -0.405392).  Saving model ...
Epoch: 6 cost time: 1.6534974575042725
Epoch: 6, Steps: 10 | Train Loss: 0.945 Vali Loss: 1.260 Vali Acc: 0.486 Test Loss: 1.260 Test Acc: 0.486
Validation loss decreased (-0.405392 --> -0.486474).  Saving model ...
Epoch: 7 cost time: 2.1334471702575684
Epoch: 7, Steps: 10 | Train Loss: 0.802 Vali Loss: 1.198 Vali Acc: 0.446 Test Loss: 1.198 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0738725662231445
Epoch: 8, Steps: 10 | Train Loss: 0.664 Vali Loss: 1.149 Vali Acc: 0.500 Test Loss: 1.149 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499989).  Saving model ...
Epoch: 9 cost time: 2.3848671913146973
Epoch: 9, Steps: 10 | Train Loss: 0.559 Vali Loss: 1.257 Vali Acc: 0.432 Test Loss: 1.257 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8578505516052246
Epoch: 10, Steps: 10 | Train Loss: 0.437 Vali Loss: 1.154 Vali Acc: 0.514 Test Loss: 1.154 Test Acc: 0.514
Validation loss decreased (-0.499989 --> -0.513502).  Saving model ...
Epoch: 11 cost time: 2.1726722717285156
Epoch: 11, Steps: 10 | Train Loss: 0.349 Vali Loss: 1.168 Vali Acc: 0.500 Test Loss: 1.168 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.918114185333252
Epoch: 12, Steps: 10 | Train Loss: 0.232 Vali Loss: 1.204 Vali Acc: 0.473 Test Loss: 1.204 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.43859601020813
Epoch: 13, Steps: 10 | Train Loss: 0.186 Vali Loss: 1.562 Vali Acc: 0.500 Test Loss: 1.562 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.4695041179656982
Epoch: 14, Steps: 10 | Train Loss: 0.135 Vali Loss: 1.341 Vali Acc: 0.514 Test Loss: 1.341 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.7487266063690186
Epoch: 15, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.303 Vali Acc: 0.527 Test Loss: 1.303 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527014).  Saving model ...
Epoch: 16 cost time: 2.3471298217773438
Epoch: 16, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.415 Vali Acc: 0.527 Test Loss: 1.415 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8798236846923828
Epoch: 17, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.434 Vali Acc: 0.514 Test Loss: 1.434 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.8475544452667236
Epoch: 18, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.411 Vali Acc: 0.527 Test Loss: 1.411 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.5786688327789307
Epoch: 19, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.506 Vali Acc: 0.514 Test Loss: 1.506 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.70235013961792
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.519 Vali Acc: 0.514 Test Loss: 1.519 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.565138816833496
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.517 Vali Acc: 0.527 Test Loss: 1.517 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.9265167713165283
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.535 Vali Acc: 0.527 Test Loss: 1.535 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.6376876831054688
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.546 Vali Acc: 0.527 Test Loss: 1.546 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.0869531631469727
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.570 Vali Acc: 0.514 Test Loss: 1.570 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.1746060848236084
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.565 Vali Acc: 0.527 Test Loss: 1.565 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 573864
model size : 3.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.366642713546753
Epoch: 1, Steps: 10 | Train Loss: 1.452 Vali Loss: 1.397 Vali Acc: 0.311 Test Loss: 1.397 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 2.8159375190734863
Epoch: 2, Steps: 10 | Train Loss: 1.379 Vali Loss: 1.359 Vali Acc: 0.338 Test Loss: 1.359 Test Acc: 0.338
Validation loss decreased (-0.310797 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 2.4972083568573
Epoch: 3, Steps: 10 | Train Loss: 1.337 Vali Loss: 1.474 Vali Acc: 0.230 Test Loss: 1.474 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9207170009613037
Epoch: 4, Steps: 10 | Train Loss: 1.235 Vali Loss: 1.486 Vali Acc: 0.230 Test Loss: 1.486 Test Acc: 0.230
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.201390027999878
Epoch: 5, Steps: 10 | Train Loss: 1.139 Vali Loss: 1.182 Vali Acc: 0.500 Test Loss: 1.182 Test Acc: 0.500
Validation loss decreased (-0.337824 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 1.9096524715423584
Epoch: 6, Steps: 10 | Train Loss: 0.993 Vali Loss: 1.213 Vali Acc: 0.392 Test Loss: 1.213 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.090424060821533
Epoch: 7, Steps: 10 | Train Loss: 0.869 Vali Loss: 1.163 Vali Acc: 0.473 Test Loss: 1.163 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8911817073822021
Epoch: 8, Steps: 10 | Train Loss: 0.791 Vali Loss: 1.104 Vali Acc: 0.473 Test Loss: 1.104 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.115813732147217
Epoch: 9, Steps: 10 | Train Loss: 0.700 Vali Loss: 1.331 Vali Acc: 0.459 Test Loss: 1.331 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.0017473697662354
Epoch: 10, Steps: 10 | Train Loss: 0.586 Vali Loss: 1.130 Vali Acc: 0.581 Test Loss: 1.130 Test Acc: 0.581
Validation loss decreased (-0.499988 --> -0.581070).  Saving model ...
Epoch: 11 cost time: 2.2698588371276855
Epoch: 11, Steps: 10 | Train Loss: 0.455 Vali Loss: 1.280 Vali Acc: 0.473 Test Loss: 1.280 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.1886439323425293
Epoch: 12, Steps: 10 | Train Loss: 0.359 Vali Loss: 1.085 Vali Acc: 0.541 Test Loss: 1.085 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.542832136154175
Epoch: 13, Steps: 10 | Train Loss: 0.282 Vali Loss: 1.089 Vali Acc: 0.622 Test Loss: 1.089 Test Acc: 0.622
Validation loss decreased (-0.581070 --> -0.621611).  Saving model ...
Epoch: 14 cost time: 1.7685599327087402
Epoch: 14, Steps: 10 | Train Loss: 0.179 Vali Loss: 1.070 Vali Acc: 0.595 Test Loss: 1.070 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.5151476860046387
Epoch: 15, Steps: 10 | Train Loss: 0.115 Vali Loss: 1.182 Vali Acc: 0.554 Test Loss: 1.182 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.605098009109497
Epoch: 16, Steps: 10 | Train Loss: 0.074 Vali Loss: 1.268 Vali Acc: 0.527 Test Loss: 1.268 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.1712024211883545
Epoch: 17, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.282 Vali Acc: 0.568 Test Loss: 1.282 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.292292356491089
Epoch: 18, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.370 Vali Acc: 0.527 Test Loss: 1.370 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.8762941360473633
Epoch: 19, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.373 Vali Acc: 0.527 Test Loss: 1.373 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.40236234664917
Epoch: 20, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.455 Vali Acc: 0.568 Test Loss: 1.455 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.118147373199463
Epoch: 21, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.447 Vali Acc: 0.541 Test Loss: 1.447 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.271632671356201
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.490 Vali Acc: 0.541 Test Loss: 1.490 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.1107406616210938
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.473 Vali Acc: 0.568 Test Loss: 1.473 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 501096
model size : 3.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.060873985290527
Epoch: 1, Steps: 10 | Train Loss: 1.502 Vali Loss: 1.374 Vali Acc: 0.284 Test Loss: 1.374 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 1.935689926147461
Epoch: 2, Steps: 10 | Train Loss: 1.454 Vali Loss: 1.374 Vali Acc: 0.378 Test Loss: 1.374 Test Acc: 0.378
Validation loss decreased (-0.283770 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 1.8991503715515137
Epoch: 3, Steps: 10 | Train Loss: 1.349 Vali Loss: 1.459 Vali Acc: 0.216 Test Loss: 1.459 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.228879451751709
Epoch: 4, Steps: 10 | Train Loss: 1.342 Vali Loss: 1.316 Vali Acc: 0.446 Test Loss: 1.316 Test Acc: 0.446
Validation loss decreased (-0.378365 --> -0.445933).  Saving model ...
Epoch: 5 cost time: 1.7555127143859863
Epoch: 5, Steps: 10 | Train Loss: 1.151 Vali Loss: 1.244 Vali Acc: 0.459 Test Loss: 1.244 Test Acc: 0.459
Validation loss decreased (-0.445933 --> -0.459447).  Saving model ...
Epoch: 6 cost time: 2.1413233280181885
Epoch: 6, Steps: 10 | Train Loss: 1.053 Vali Loss: 1.211 Vali Acc: 0.365 Test Loss: 1.211 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0996625423431396
Epoch: 7, Steps: 10 | Train Loss: 1.020 Vali Loss: 1.430 Vali Acc: 0.365 Test Loss: 1.430 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.0253098011016846
Epoch: 8, Steps: 10 | Train Loss: 0.868 Vali Loss: 1.374 Vali Acc: 0.365 Test Loss: 1.374 Test Acc: 0.365
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.1750857830047607
Epoch: 9, Steps: 10 | Train Loss: 0.735 Vali Loss: 1.182 Vali Acc: 0.419 Test Loss: 1.182 Test Acc: 0.419
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.020177125930786
Epoch: 10, Steps: 10 | Train Loss: 0.623 Vali Loss: 1.035 Vali Acc: 0.500 Test Loss: 1.035 Test Acc: 0.500
Validation loss decreased (-0.459447 --> -0.499990).  Saving model ...
Epoch: 11 cost time: 2.1718578338623047
Epoch: 11, Steps: 10 | Train Loss: 0.520 Vali Loss: 1.236 Vali Acc: 0.486 Test Loss: 1.236 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.3685736656188965
Epoch: 12, Steps: 10 | Train Loss: 0.388 Vali Loss: 1.173 Vali Acc: 0.541 Test Loss: 1.173 Test Acc: 0.541
Validation loss decreased (-0.499990 --> -0.540529).  Saving model ...
Epoch: 13 cost time: 2.3903627395629883
Epoch: 13, Steps: 10 | Train Loss: 0.257 Vali Loss: 1.068 Vali Acc: 0.541 Test Loss: 1.068 Test Acc: 0.541
Validation loss decreased (-0.540529 --> -0.540530).  Saving model ...
Epoch: 14 cost time: 2.4282479286193848
Epoch: 14, Steps: 10 | Train Loss: 0.241 Vali Loss: 1.198 Vali Acc: 0.514 Test Loss: 1.198 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.48038911819458
Epoch: 15, Steps: 10 | Train Loss: 0.173 Vali Loss: 1.493 Vali Acc: 0.527 Test Loss: 1.493 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.3418502807617188
Epoch: 16, Steps: 10 | Train Loss: 0.163 Vali Loss: 1.280 Vali Acc: 0.595 Test Loss: 1.280 Test Acc: 0.595
Validation loss decreased (-0.540530 --> -0.594582).  Saving model ...
Epoch: 17 cost time: 2.1990790367126465
Epoch: 17, Steps: 10 | Train Loss: 0.102 Vali Loss: 1.246 Vali Acc: 0.635 Test Loss: 1.246 Test Acc: 0.635
Validation loss decreased (-0.594582 --> -0.635123).  Saving model ...
Epoch: 18 cost time: 2.023306369781494
Epoch: 18, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.179 Vali Acc: 0.568 Test Loss: 1.179 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.9118671417236328
Epoch: 19, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.415 Vali Acc: 0.568 Test Loss: 1.415 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.865128755569458
Epoch: 20, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.370 Vali Acc: 0.568 Test Loss: 1.370 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.0691258907318115
Epoch: 21, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.467 Vali Acc: 0.541 Test Loss: 1.467 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.235567331314087
Epoch: 22, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.400 Vali Acc: 0.595 Test Loss: 1.400 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.4719326496124268
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.370 Vali Acc: 0.581 Test Loss: 1.370 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.4859321117401123
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.399 Vali Acc: 0.581 Test Loss: 1.399 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.40104079246521
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.374 Vali Acc: 0.595 Test Loss: 1.374 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.8187122344970703
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.339 Vali Acc: 0.581 Test Loss: 1.339 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.0350987911224365
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.347 Vali Acc: 0.608 Test Loss: 1.347 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 497832
model size : 3.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.293168544769287
Epoch: 1, Steps: 10 | Train Loss: 1.462 Vali Loss: 1.351 Vali Acc: 0.324 Test Loss: 1.351 Test Acc: 0.324
Validation loss decreased (inf --> -0.324311).  Saving model ...
Epoch: 2 cost time: 1.8434100151062012
Epoch: 2, Steps: 10 | Train Loss: 1.400 Vali Loss: 1.419 Vali Acc: 0.338 Test Loss: 1.419 Test Acc: 0.338
Validation loss decreased (-0.324311 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 1.949188232421875
Epoch: 3, Steps: 10 | Train Loss: 1.348 Vali Loss: 1.373 Vali Acc: 0.284 Test Loss: 1.373 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8353557586669922
Epoch: 4, Steps: 10 | Train Loss: 1.270 Vali Loss: 1.305 Vali Acc: 0.500 Test Loss: 1.305 Test Acc: 0.500
Validation loss decreased (-0.337824 --> -0.499987).  Saving model ...
Epoch: 5 cost time: 1.9082391262054443
Epoch: 5, Steps: 10 | Train Loss: 1.177 Vali Loss: 1.280 Vali Acc: 0.351 Test Loss: 1.280 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8890717029571533
Epoch: 6, Steps: 10 | Train Loss: 1.072 Vali Loss: 1.317 Vali Acc: 0.419 Test Loss: 1.317 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.695918321609497
Epoch: 7, Steps: 10 | Train Loss: 0.907 Vali Loss: 1.237 Vali Acc: 0.446 Test Loss: 1.237 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.9642107486724854
Epoch: 8, Steps: 10 | Train Loss: 0.790 Vali Loss: 1.182 Vali Acc: 0.459 Test Loss: 1.182 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.0859639644622803
Epoch: 9, Steps: 10 | Train Loss: 0.620 Vali Loss: 1.104 Vali Acc: 0.541 Test Loss: 1.104 Test Acc: 0.541
Validation loss decreased (-0.499987 --> -0.540530).  Saving model ...
Epoch: 10 cost time: 2.1090166568756104
Epoch: 10, Steps: 10 | Train Loss: 0.596 Vali Loss: 1.256 Vali Acc: 0.527 Test Loss: 1.256 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.2741730213165283
Epoch: 11, Steps: 10 | Train Loss: 0.468 Vali Loss: 1.086 Vali Acc: 0.554 Test Loss: 1.086 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554043).  Saving model ...
Epoch: 12 cost time: 1.8616347312927246
Epoch: 12, Steps: 10 | Train Loss: 0.333 Vali Loss: 1.202 Vali Acc: 0.568 Test Loss: 1.202 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567556).  Saving model ...
Epoch: 13 cost time: 1.7451417446136475
Epoch: 13, Steps: 10 | Train Loss: 0.274 Vali Loss: 1.410 Vali Acc: 0.581 Test Loss: 1.410 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581067).  Saving model ...
Epoch: 14 cost time: 1.687856912612915
Epoch: 14, Steps: 10 | Train Loss: 0.205 Vali Loss: 1.176 Vali Acc: 0.514 Test Loss: 1.176 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.0262324810028076
Epoch: 15, Steps: 10 | Train Loss: 0.129 Vali Loss: 1.339 Vali Acc: 0.581 Test Loss: 1.339 Test Acc: 0.581
Validation loss decreased (-0.581067 --> -0.581068).  Saving model ...
Epoch: 16 cost time: 1.826028823852539
Epoch: 16, Steps: 10 | Train Loss: 0.115 Vali Loss: 1.405 Vali Acc: 0.541 Test Loss: 1.405 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9895641803741455
Epoch: 17, Steps: 10 | Train Loss: 0.075 Vali Loss: 1.618 Vali Acc: 0.486 Test Loss: 1.618 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.9660193920135498
Epoch: 18, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.461 Vali Acc: 0.581 Test Loss: 1.461 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.3158061504364014
Epoch: 19, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.442 Vali Acc: 0.608 Test Loss: 1.442 Test Acc: 0.608
Validation loss decreased (-0.581068 --> -0.608094).  Saving model ...
Epoch: 20 cost time: 2.2084290981292725
Epoch: 20, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.506 Vali Acc: 0.608 Test Loss: 1.506 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.364548683166504
Epoch: 21, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.540 Vali Acc: 0.622 Test Loss: 1.540 Test Acc: 0.622
Validation loss decreased (-0.608094 --> -0.621606).  Saving model ...
Epoch: 22 cost time: 2.12148380279541
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.524 Vali Acc: 0.608 Test Loss: 1.524 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.6325287818908691
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.538 Vali Acc: 0.635 Test Loss: 1.538 Test Acc: 0.635
Validation loss decreased (-0.621606 --> -0.635120).  Saving model ...
Epoch: 24 cost time: 2.1856608390808105
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.558 Vali Acc: 0.622 Test Loss: 1.558 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.2134947776794434
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.585 Vali Acc: 0.635 Test Loss: 1.585 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.0458106994628906
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.574 Vali Acc: 0.608 Test Loss: 1.574 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.7699196338653564
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.581 Vali Acc: 0.635 Test Loss: 1.581 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.249915599822998
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.618 Vali Acc: 0.622 Test Loss: 1.618 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.209866762161255
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.627 Vali Acc: 0.622 Test Loss: 1.627 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.4558565616607666
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.634 Vali Acc: 0.622 Test Loss: 1.634 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.7370665073394775
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.631 Vali Acc: 0.635 Test Loss: 1.631 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.2980165481567383
Epoch: 32, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.645 Vali Acc: 0.608 Test Loss: 1.645 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.7988665103912354
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.646 Vali Acc: 0.622 Test Loss: 1.646 Test Acc: 0.622
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 494568
model size : 3.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.5752971172332764
Epoch: 1, Steps: 10 | Train Loss: 1.415 Vali Loss: 1.410 Vali Acc: 0.176 Test Loss: 1.410 Test Acc: 0.176
Validation loss decreased (inf --> -0.175662).  Saving model ...
Epoch: 2 cost time: 2.2418227195739746
Epoch: 2, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.335 Vali Acc: 0.338 Test Loss: 1.335 Test Acc: 0.338
Validation loss decreased (-0.175662 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 1.967418909072876
Epoch: 3, Steps: 10 | Train Loss: 1.309 Vali Loss: 1.330 Vali Acc: 0.338 Test Loss: 1.330 Test Acc: 0.338
Validation loss decreased (-0.337824 --> -0.337825).  Saving model ...
Epoch: 4 cost time: 1.9019968509674072
Epoch: 4, Steps: 10 | Train Loss: 1.201 Vali Loss: 1.249 Vali Acc: 0.419 Test Loss: 1.249 Test Acc: 0.419
Validation loss decreased (-0.337825 --> -0.418906).  Saving model ...
Epoch: 5 cost time: 2.129702091217041
Epoch: 5, Steps: 10 | Train Loss: 1.098 Vali Loss: 1.229 Vali Acc: 0.432 Test Loss: 1.229 Test Acc: 0.432
Validation loss decreased (-0.418906 --> -0.432420).  Saving model ...
Epoch: 6 cost time: 2.3472814559936523
Epoch: 6, Steps: 10 | Train Loss: 0.987 Vali Loss: 1.159 Vali Acc: 0.527 Test Loss: 1.159 Test Acc: 0.527
Validation loss decreased (-0.432420 --> -0.527015).  Saving model ...
Epoch: 7 cost time: 2.0398073196411133
Epoch: 7, Steps: 10 | Train Loss: 0.843 Vali Loss: 1.144 Vali Acc: 0.527 Test Loss: 1.144 Test Acc: 0.527
Validation loss decreased (-0.527015 --> -0.527016).  Saving model ...
Epoch: 8 cost time: 1.8825082778930664
Epoch: 8, Steps: 10 | Train Loss: 0.722 Vali Loss: 1.270 Vali Acc: 0.459 Test Loss: 1.270 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.197416067123413
Epoch: 9, Steps: 10 | Train Loss: 0.601 Vali Loss: 1.208 Vali Acc: 0.527 Test Loss: 1.208 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8966619968414307
Epoch: 10, Steps: 10 | Train Loss: 0.582 Vali Loss: 1.076 Vali Acc: 0.581 Test Loss: 1.076 Test Acc: 0.581
Validation loss decreased (-0.527016 --> -0.581070).  Saving model ...
Epoch: 11 cost time: 1.955251693725586
Epoch: 11, Steps: 10 | Train Loss: 0.378 Vali Loss: 1.264 Vali Acc: 0.554 Test Loss: 1.264 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.282081127166748
Epoch: 12, Steps: 10 | Train Loss: 0.364 Vali Loss: 1.334 Vali Acc: 0.541 Test Loss: 1.334 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.0398406982421875
Epoch: 13, Steps: 10 | Train Loss: 0.235 Vali Loss: 1.254 Vali Acc: 0.541 Test Loss: 1.254 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.9596447944641113
Epoch: 14, Steps: 10 | Train Loss: 0.164 Vali Loss: 1.211 Vali Acc: 0.622 Test Loss: 1.211 Test Acc: 0.622
Validation loss decreased (-0.581070 --> -0.621610).  Saving model ...
Epoch: 15 cost time: 2.227396011352539
Epoch: 15, Steps: 10 | Train Loss: 0.102 Vali Loss: 1.171 Vali Acc: 0.622 Test Loss: 1.171 Test Acc: 0.622
Validation loss decreased (-0.621610 --> -0.621610).  Saving model ...
Epoch: 16 cost time: 1.7188279628753662
Epoch: 16, Steps: 10 | Train Loss: 0.061 Vali Loss: 1.312 Vali Acc: 0.608 Test Loss: 1.312 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.619753360748291
Epoch: 17, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.380 Vali Acc: 0.554 Test Loss: 1.380 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.749436616897583
Epoch: 18, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.391 Vali Acc: 0.581 Test Loss: 1.391 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.7946751117706299
Epoch: 19, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.428 Vali Acc: 0.568 Test Loss: 1.428 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.511338710784912
Epoch: 20, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.563 Vali Acc: 0.554 Test Loss: 1.563 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.977079153060913
Epoch: 21, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.497 Vali Acc: 0.568 Test Loss: 1.497 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.547497272491455
Epoch: 22, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.493 Vali Acc: 0.554 Test Loss: 1.493 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.7592990398406982
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.523 Vali Acc: 0.581 Test Loss: 1.523 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.052034616470337
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.505 Vali Acc: 0.568 Test Loss: 1.505 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.308011770248413
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.542 Vali Acc: 0.581 Test Loss: 1.542 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 491304
model size : 3.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.02405858039856
Epoch: 1, Steps: 10 | Train Loss: 1.445 Vali Loss: 1.418 Vali Acc: 0.311 Test Loss: 1.418 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 2.0734941959381104
Epoch: 2, Steps: 10 | Train Loss: 1.426 Vali Loss: 1.373 Vali Acc: 0.297 Test Loss: 1.373 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4931037425994873
Epoch: 3, Steps: 10 | Train Loss: 1.355 Vali Loss: 1.348 Vali Acc: 0.311 Test Loss: 1.348 Test Acc: 0.311
Validation loss decreased (-0.310797 --> -0.310797).  Saving model ...
Epoch: 4 cost time: 1.663844347000122
Epoch: 4, Steps: 10 | Train Loss: 1.281 Vali Loss: 1.278 Vali Acc: 0.486 Test Loss: 1.278 Test Acc: 0.486
Validation loss decreased (-0.310797 --> -0.486474).  Saving model ...
Epoch: 5 cost time: 1.906799077987671
Epoch: 5, Steps: 10 | Train Loss: 1.200 Vali Loss: 1.321 Vali Acc: 0.405 Test Loss: 1.321 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8156120777130127
Epoch: 6, Steps: 10 | Train Loss: 1.068 Vali Loss: 1.203 Vali Acc: 0.486 Test Loss: 1.203 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486474).  Saving model ...
Epoch: 7 cost time: 1.674957036972046
Epoch: 7, Steps: 10 | Train Loss: 0.990 Vali Loss: 1.192 Vali Acc: 0.500 Test Loss: 1.192 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 1.5692977905273438
Epoch: 8, Steps: 10 | Train Loss: 0.852 Vali Loss: 1.154 Vali Acc: 0.473 Test Loss: 1.154 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8959064483642578
Epoch: 9, Steps: 10 | Train Loss: 0.719 Vali Loss: 1.148 Vali Acc: 0.527 Test Loss: 1.148 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527016).  Saving model ...
Epoch: 10 cost time: 1.802483081817627
Epoch: 10, Steps: 10 | Train Loss: 0.604 Vali Loss: 1.100 Vali Acc: 0.527 Test Loss: 1.100 Test Acc: 0.527
Validation loss decreased (-0.527016 --> -0.527016).  Saving model ...
Epoch: 11 cost time: 1.8266921043395996
Epoch: 11, Steps: 10 | Train Loss: 0.513 Vali Loss: 1.150 Vali Acc: 0.514 Test Loss: 1.150 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8778645992279053
Epoch: 12, Steps: 10 | Train Loss: 0.420 Vali Loss: 1.182 Vali Acc: 0.419 Test Loss: 1.182 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.9799554347991943
Epoch: 13, Steps: 10 | Train Loss: 0.318 Vali Loss: 1.161 Vali Acc: 0.486 Test Loss: 1.161 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.475374460220337
Epoch: 14, Steps: 10 | Train Loss: 0.250 Vali Loss: 1.132 Vali Acc: 0.554 Test Loss: 1.132 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554043).  Saving model ...
Epoch: 15 cost time: 1.7175843715667725
Epoch: 15, Steps: 10 | Train Loss: 0.181 Vali Loss: 1.165 Vali Acc: 0.500 Test Loss: 1.165 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.689873456954956
Epoch: 16, Steps: 10 | Train Loss: 0.128 Vali Loss: 1.229 Vali Acc: 0.473 Test Loss: 1.229 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.8155548572540283
Epoch: 17, Steps: 10 | Train Loss: 0.091 Vali Loss: 1.232 Vali Acc: 0.527 Test Loss: 1.232 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.111799716949463
Epoch: 18, Steps: 10 | Train Loss: 0.060 Vali Loss: 1.270 Vali Acc: 0.486 Test Loss: 1.270 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.6161069869995117
Epoch: 19, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.325 Vali Acc: 0.473 Test Loss: 1.325 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.7456798553466797
Epoch: 20, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.291 Vali Acc: 0.554 Test Loss: 1.291 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.73838472366333
Epoch: 21, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.410 Vali Acc: 0.500 Test Loss: 1.410 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.6539132595062256
Epoch: 22, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.339 Vali Acc: 0.486 Test Loss: 1.339 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.6498584747314453
Epoch: 23, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.370 Vali Acc: 0.473 Test Loss: 1.370 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.6149752140045166
Epoch: 24, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.396 Vali Acc: 0.459 Test Loss: 1.396 Test Acc: 0.459
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 460168
model size : 2.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.559015989303589
Epoch: 1, Steps: 10 | Train Loss: 1.491 Vali Loss: 1.423 Vali Acc: 0.203 Test Loss: 1.423 Test Acc: 0.203
Validation loss decreased (inf --> -0.202688).  Saving model ...
Epoch: 2 cost time: 1.9187490940093994
Epoch: 2, Steps: 10 | Train Loss: 1.421 Vali Loss: 1.440 Vali Acc: 0.284 Test Loss: 1.440 Test Acc: 0.284
Validation loss decreased (-0.202688 --> -0.283769).  Saving model ...
Epoch: 3 cost time: 1.734199047088623
Epoch: 3, Steps: 10 | Train Loss: 1.362 Vali Loss: 1.356 Vali Acc: 0.365 Test Loss: 1.356 Test Acc: 0.365
Validation loss decreased (-0.283769 --> -0.364851).  Saving model ...
Epoch: 4 cost time: 1.4629402160644531
Epoch: 4, Steps: 10 | Train Loss: 1.309 Vali Loss: 1.332 Vali Acc: 0.351 Test Loss: 1.332 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.023937940597534
Epoch: 5, Steps: 10 | Train Loss: 1.202 Vali Loss: 1.347 Vali Acc: 0.405 Test Loss: 1.347 Test Acc: 0.405
Validation loss decreased (-0.364851 --> -0.405392).  Saving model ...
Epoch: 6 cost time: 2.042436122894287
Epoch: 6, Steps: 10 | Train Loss: 1.111 Vali Loss: 1.337 Vali Acc: 0.365 Test Loss: 1.337 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.994469165802002
Epoch: 7, Steps: 10 | Train Loss: 0.989 Vali Loss: 1.272 Vali Acc: 0.446 Test Loss: 1.272 Test Acc: 0.446
Validation loss decreased (-0.405392 --> -0.445933).  Saving model ...
Epoch: 8 cost time: 1.9873263835906982
Epoch: 8, Steps: 10 | Train Loss: 0.900 Vali Loss: 1.190 Vali Acc: 0.500 Test Loss: 1.190 Test Acc: 0.500
Validation loss decreased (-0.445933 --> -0.499988).  Saving model ...
Epoch: 9 cost time: 1.832183599472046
Epoch: 9, Steps: 10 | Train Loss: 0.745 Vali Loss: 1.268 Vali Acc: 0.432 Test Loss: 1.268 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8998472690582275
Epoch: 10, Steps: 10 | Train Loss: 0.674 Vali Loss: 1.121 Vali Acc: 0.527 Test Loss: 1.121 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527016).  Saving model ...
Epoch: 11 cost time: 1.5525658130645752
Epoch: 11, Steps: 10 | Train Loss: 0.526 Vali Loss: 1.152 Vali Acc: 0.459 Test Loss: 1.152 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5638453960418701
Epoch: 12, Steps: 10 | Train Loss: 0.438 Vali Loss: 1.100 Vali Acc: 0.473 Test Loss: 1.100 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6385340690612793
Epoch: 13, Steps: 10 | Train Loss: 0.366 Vali Loss: 1.099 Vali Acc: 0.473 Test Loss: 1.099 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.6419363021850586
Epoch: 14, Steps: 10 | Train Loss: 0.270 Vali Loss: 1.152 Vali Acc: 0.514 Test Loss: 1.152 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.5467839241027832
Epoch: 15, Steps: 10 | Train Loss: 0.195 Vali Loss: 1.141 Vali Acc: 0.473 Test Loss: 1.141 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.8587045669555664
Epoch: 16, Steps: 10 | Train Loss: 0.143 Vali Loss: 1.188 Vali Acc: 0.500 Test Loss: 1.188 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.6875150203704834
Epoch: 17, Steps: 10 | Train Loss: 0.101 Vali Loss: 1.221 Vali Acc: 0.486 Test Loss: 1.221 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.957223653793335
Epoch: 18, Steps: 10 | Train Loss: 0.077 Vali Loss: 1.290 Vali Acc: 0.446 Test Loss: 1.290 Test Acc: 0.446
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.6128513813018799
Epoch: 19, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.305 Vali Acc: 0.500 Test Loss: 1.305 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.9716317653656006
Epoch: 20, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.314 Vali Acc: 0.459 Test Loss: 1.314 Test Acc: 0.459
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 458536
model size : 2.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.080528020858765
Epoch: 1, Steps: 10 | Train Loss: 1.402 Vali Loss: 1.404 Vali Acc: 0.203 Test Loss: 1.404 Test Acc: 0.203
Validation loss decreased (inf --> -0.202689).  Saving model ...
Epoch: 2 cost time: 1.684311866760254
Epoch: 2, Steps: 10 | Train Loss: 1.391 Vali Loss: 1.371 Vali Acc: 0.257 Test Loss: 1.371 Test Acc: 0.257
Validation loss decreased (-0.202689 --> -0.256743).  Saving model ...
Epoch: 3 cost time: 1.5170249938964844
Epoch: 3, Steps: 10 | Train Loss: 1.341 Vali Loss: 1.361 Vali Acc: 0.284 Test Loss: 1.361 Test Acc: 0.284
Validation loss decreased (-0.256743 --> -0.283770).  Saving model ...
Epoch: 4 cost time: 1.884223222732544
Epoch: 4, Steps: 10 | Train Loss: 1.255 Vali Loss: 1.324 Vali Acc: 0.338 Test Loss: 1.324 Test Acc: 0.338
Validation loss decreased (-0.283770 --> -0.337825).  Saving model ...
Epoch: 5 cost time: 1.9213380813598633
Epoch: 5, Steps: 10 | Train Loss: 1.172 Vali Loss: 1.371 Vali Acc: 0.338 Test Loss: 1.371 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.658264398574829
Epoch: 6, Steps: 10 | Train Loss: 1.120 Vali Loss: 1.207 Vali Acc: 0.486 Test Loss: 1.207 Test Acc: 0.486
Validation loss decreased (-0.337825 --> -0.486474).  Saving model ...
Epoch: 7 cost time: 1.8859562873840332
Epoch: 7, Steps: 10 | Train Loss: 0.976 Vali Loss: 1.181 Vali Acc: 0.500 Test Loss: 1.181 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 1.6200566291809082
Epoch: 8, Steps: 10 | Train Loss: 0.840 Vali Loss: 1.150 Vali Acc: 0.514 Test Loss: 1.150 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 9 cost time: 1.62925386428833
Epoch: 9, Steps: 10 | Train Loss: 0.719 Vali Loss: 1.138 Vali Acc: 0.527 Test Loss: 1.138 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 10 cost time: 1.6759779453277588
Epoch: 10, Steps: 10 | Train Loss: 0.602 Vali Loss: 1.136 Vali Acc: 0.500 Test Loss: 1.136 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.01680850982666
Epoch: 11, Steps: 10 | Train Loss: 0.504 Vali Loss: 1.101 Vali Acc: 0.568 Test Loss: 1.101 Test Acc: 0.568
Validation loss decreased (-0.527016 --> -0.567557).  Saving model ...
Epoch: 12 cost time: 1.5854787826538086
Epoch: 12, Steps: 10 | Train Loss: 0.435 Vali Loss: 1.142 Vali Acc: 0.527 Test Loss: 1.142 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6583423614501953
Epoch: 13, Steps: 10 | Train Loss: 0.336 Vali Loss: 1.179 Vali Acc: 0.486 Test Loss: 1.179 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.467864990234375
Epoch: 14, Steps: 10 | Train Loss: 0.244 Vali Loss: 1.164 Vali Acc: 0.486 Test Loss: 1.164 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3981690406799316
Epoch: 15, Steps: 10 | Train Loss: 0.179 Vali Loss: 1.121 Vali Acc: 0.554 Test Loss: 1.121 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.683980941772461
Epoch: 16, Steps: 10 | Train Loss: 0.135 Vali Loss: 1.162 Vali Acc: 0.514 Test Loss: 1.162 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.4706146717071533
Epoch: 17, Steps: 10 | Train Loss: 0.096 Vali Loss: 1.204 Vali Acc: 0.527 Test Loss: 1.204 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.686687707901001
Epoch: 18, Steps: 10 | Train Loss: 0.074 Vali Loss: 1.229 Vali Acc: 0.527 Test Loss: 1.229 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.6102676391601562
Epoch: 19, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.314 Vali Acc: 0.486 Test Loss: 1.314 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.7346906661987305
Epoch: 20, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.340 Vali Acc: 0.514 Test Loss: 1.340 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.460824966430664
Epoch: 21, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.267 Vali Acc: 0.541 Test Loss: 1.267 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 456904
model size : 2.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.6592202186584473
Epoch: 1, Steps: 10 | Train Loss: 1.464 Vali Loss: 1.400 Vali Acc: 0.257 Test Loss: 1.400 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 1.6445012092590332
Epoch: 2, Steps: 10 | Train Loss: 1.424 Vali Loss: 1.350 Vali Acc: 0.419 Test Loss: 1.350 Test Acc: 0.419
Validation loss decreased (-0.256743 --> -0.418905).  Saving model ...
Epoch: 3 cost time: 1.6846504211425781
Epoch: 3, Steps: 10 | Train Loss: 1.388 Vali Loss: 1.379 Vali Acc: 0.230 Test Loss: 1.379 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.979013204574585
Epoch: 4, Steps: 10 | Train Loss: 1.347 Vali Loss: 1.322 Vali Acc: 0.432 Test Loss: 1.322 Test Acc: 0.432
Validation loss decreased (-0.418905 --> -0.432419).  Saving model ...
Epoch: 5 cost time: 1.8469898700714111
Epoch: 5, Steps: 10 | Train Loss: 1.317 Vali Loss: 1.280 Vali Acc: 0.419 Test Loss: 1.280 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5521833896636963
Epoch: 6, Steps: 10 | Train Loss: 1.180 Vali Loss: 1.194 Vali Acc: 0.459 Test Loss: 1.194 Test Acc: 0.459
Validation loss decreased (-0.432419 --> -0.459448).  Saving model ...
Epoch: 7 cost time: 1.395658016204834
Epoch: 7, Steps: 10 | Train Loss: 1.082 Vali Loss: 1.182 Vali Acc: 0.514 Test Loss: 1.182 Test Acc: 0.514
Validation loss decreased (-0.459448 --> -0.513502).  Saving model ...
Epoch: 8 cost time: 1.638519287109375
Epoch: 8, Steps: 10 | Train Loss: 0.942 Vali Loss: 1.139 Vali Acc: 0.500 Test Loss: 1.139 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6878132820129395
Epoch: 9, Steps: 10 | Train Loss: 0.845 Vali Loss: 1.186 Vali Acc: 0.541 Test Loss: 1.186 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540529).  Saving model ...
Epoch: 10 cost time: 1.815011978149414
Epoch: 10, Steps: 10 | Train Loss: 0.706 Vali Loss: 1.063 Vali Acc: 0.527 Test Loss: 1.063 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8422136306762695
Epoch: 11, Steps: 10 | Train Loss: 0.635 Vali Loss: 1.125 Vali Acc: 0.514 Test Loss: 1.125 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.0518529415130615
Epoch: 12, Steps: 10 | Train Loss: 0.479 Vali Loss: 1.077 Vali Acc: 0.541 Test Loss: 1.077 Test Acc: 0.541
Validation loss decreased (-0.540529 --> -0.540530).  Saving model ...
Epoch: 13 cost time: 1.8245437145233154
Epoch: 13, Steps: 10 | Train Loss: 0.383 Vali Loss: 1.051 Vali Acc: 0.581 Test Loss: 1.051 Test Acc: 0.581
Validation loss decreased (-0.540530 --> -0.581071).  Saving model ...
Epoch: 14 cost time: 1.6451890468597412
Epoch: 14, Steps: 10 | Train Loss: 0.364 Vali Loss: 1.172 Vali Acc: 0.514 Test Loss: 1.172 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.644568920135498
Epoch: 15, Steps: 10 | Train Loss: 0.232 Vali Loss: 1.110 Vali Acc: 0.581 Test Loss: 1.110 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.9971237182617188
Epoch: 16, Steps: 10 | Train Loss: 0.188 Vali Loss: 1.314 Vali Acc: 0.486 Test Loss: 1.314 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.698577880859375
Epoch: 17, Steps: 10 | Train Loss: 0.136 Vali Loss: 1.148 Vali Acc: 0.595 Test Loss: 1.148 Test Acc: 0.595
Validation loss decreased (-0.581071 --> -0.594583).  Saving model ...
Epoch: 18 cost time: 1.8842315673828125
Epoch: 18, Steps: 10 | Train Loss: 0.093 Vali Loss: 1.287 Vali Acc: 0.514 Test Loss: 1.287 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8564445972442627
Epoch: 19, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.247 Vali Acc: 0.568 Test Loss: 1.247 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.8663156032562256
Epoch: 20, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.327 Vali Acc: 0.527 Test Loss: 1.327 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.859508991241455
Epoch: 21, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.323 Vali Acc: 0.527 Test Loss: 1.323 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.6977837085723877
Epoch: 22, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.309 Vali Acc: 0.486 Test Loss: 1.309 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.944791316986084
Epoch: 23, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.372 Vali Acc: 0.514 Test Loss: 1.372 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.4273533821105957
Epoch: 24, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.333 Vali Acc: 0.527 Test Loss: 1.333 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.5970861911773682
Epoch: 25, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.369 Vali Acc: 0.486 Test Loss: 1.369 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.5287976264953613
Epoch: 26, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.398 Vali Acc: 0.514 Test Loss: 1.398 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.5627565383911133
Epoch: 27, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.398 Vali Acc: 0.500 Test Loss: 1.398 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 455272
model size : 2.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.8977315425872803
Epoch: 1, Steps: 10 | Train Loss: 1.438 Vali Loss: 1.405 Vali Acc: 0.284 Test Loss: 1.405 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 1.9847314357757568
Epoch: 2, Steps: 10 | Train Loss: 1.374 Vali Loss: 1.388 Vali Acc: 0.243 Test Loss: 1.388 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9302599430084229
Epoch: 3, Steps: 10 | Train Loss: 1.363 Vali Loss: 1.330 Vali Acc: 0.324 Test Loss: 1.330 Test Acc: 0.324
Validation loss decreased (-0.283770 --> -0.324311).  Saving model ...
Epoch: 4 cost time: 2.0142111778259277
Epoch: 4, Steps: 10 | Train Loss: 1.289 Vali Loss: 1.309 Vali Acc: 0.392 Test Loss: 1.309 Test Acc: 0.392
Validation loss decreased (-0.324311 --> -0.391879).  Saving model ...
Epoch: 5 cost time: 1.610933542251587
Epoch: 5, Steps: 10 | Train Loss: 1.165 Vali Loss: 1.307 Vali Acc: 0.378 Test Loss: 1.307 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.35066819190979
Epoch: 6, Steps: 10 | Train Loss: 1.097 Vali Loss: 1.218 Vali Acc: 0.446 Test Loss: 1.218 Test Acc: 0.446
Validation loss decreased (-0.391879 --> -0.445934).  Saving model ...
Epoch: 7 cost time: 1.4546446800231934
Epoch: 7, Steps: 10 | Train Loss: 0.996 Vali Loss: 1.353 Vali Acc: 0.365 Test Loss: 1.353 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5825343132019043
Epoch: 8, Steps: 10 | Train Loss: 0.902 Vali Loss: 1.200 Vali Acc: 0.446 Test Loss: 1.200 Test Acc: 0.446
Validation loss decreased (-0.445934 --> -0.445934).  Saving model ...
Epoch: 9 cost time: 1.7821340560913086
Epoch: 9, Steps: 10 | Train Loss: 0.757 Vali Loss: 1.132 Vali Acc: 0.500 Test Loss: 1.132 Test Acc: 0.500
Validation loss decreased (-0.445934 --> -0.499989).  Saving model ...
Epoch: 10 cost time: 1.6576063632965088
Epoch: 10, Steps: 10 | Train Loss: 0.649 Vali Loss: 1.138 Vali Acc: 0.473 Test Loss: 1.138 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.097339630126953
Epoch: 11, Steps: 10 | Train Loss: 0.556 Vali Loss: 1.139 Vali Acc: 0.486 Test Loss: 1.139 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.0187859535217285
Epoch: 12, Steps: 10 | Train Loss: 0.491 Vali Loss: 1.157 Vali Acc: 0.500 Test Loss: 1.157 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.07594633102417
Epoch: 13, Steps: 10 | Train Loss: 0.424 Vali Loss: 1.149 Vali Acc: 0.459 Test Loss: 1.149 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.796546459197998
Epoch: 14, Steps: 10 | Train Loss: 0.307 Vali Loss: 1.127 Vali Acc: 0.514 Test Loss: 1.127 Test Acc: 0.514
Validation loss decreased (-0.499989 --> -0.513502).  Saving model ...
Epoch: 15 cost time: 1.7526969909667969
Epoch: 15, Steps: 10 | Train Loss: 0.249 Vali Loss: 1.127 Vali Acc: 0.514 Test Loss: 1.127 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9799456596374512
Epoch: 16, Steps: 10 | Train Loss: 0.196 Vali Loss: 1.146 Vali Acc: 0.541 Test Loss: 1.146 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540529).  Saving model ...
Epoch: 17 cost time: 2.016632318496704
Epoch: 17, Steps: 10 | Train Loss: 0.138 Vali Loss: 1.133 Vali Acc: 0.527 Test Loss: 1.133 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7808611392974854
Epoch: 18, Steps: 10 | Train Loss: 0.110 Vali Loss: 1.208 Vali Acc: 0.514 Test Loss: 1.208 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.163180112838745
Epoch: 19, Steps: 10 | Train Loss: 0.086 Vali Loss: 1.209 Vali Acc: 0.527 Test Loss: 1.209 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.8875136375427246
Epoch: 20, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.227 Vali Acc: 0.554 Test Loss: 1.227 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554042).  Saving model ...
Epoch: 21 cost time: 1.5891227722167969
Epoch: 21, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.231 Vali Acc: 0.541 Test Loss: 1.231 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.8870058059692383
Epoch: 22, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.248 Vali Acc: 0.527 Test Loss: 1.248 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.8517208099365234
Epoch: 23, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.281 Vali Acc: 0.541 Test Loss: 1.281 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.8397605419158936
Epoch: 24, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.273 Vali Acc: 0.554 Test Loss: 1.273 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.8402817249298096
Epoch: 25, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.312 Vali Acc: 0.514 Test Loss: 1.312 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.763702154159546
Epoch: 26, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.333 Vali Acc: 0.514 Test Loss: 1.333 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.7495546340942383
Epoch: 27, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.324 Vali Acc: 0.541 Test Loss: 1.324 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.7445082664489746
Epoch: 28, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.369 Vali Acc: 0.500 Test Loss: 1.369 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.839270830154419
Epoch: 29, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.369 Vali Acc: 0.514 Test Loss: 1.369 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.6950860023498535
Epoch: 30, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.347 Vali Acc: 0.527 Test Loss: 1.347 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 293768
model size : 1.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.889282464981079
Epoch: 1, Steps: 10 | Train Loss: 1.480 Vali Loss: 1.388 Vali Acc: 0.378 Test Loss: 1.388 Test Acc: 0.378
Validation loss decreased (inf --> -0.378364).  Saving model ...
Epoch: 2 cost time: 1.975529670715332
Epoch: 2, Steps: 10 | Train Loss: 1.411 Vali Loss: 1.394 Vali Acc: 0.243 Test Loss: 1.394 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7532422542572021
Epoch: 3, Steps: 10 | Train Loss: 1.372 Vali Loss: 1.368 Vali Acc: 0.324 Test Loss: 1.368 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5464048385620117
Epoch: 4, Steps: 10 | Train Loss: 1.331 Vali Loss: 1.385 Vali Acc: 0.351 Test Loss: 1.385 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.0167713165283203
Epoch: 5, Steps: 10 | Train Loss: 1.252 Vali Loss: 1.299 Vali Acc: 0.405 Test Loss: 1.299 Test Acc: 0.405
Validation loss decreased (-0.378364 --> -0.405392).  Saving model ...
Epoch: 6 cost time: 1.8762922286987305
Epoch: 6, Steps: 10 | Train Loss: 1.165 Vali Loss: 1.329 Vali Acc: 0.432 Test Loss: 1.329 Test Acc: 0.432
Validation loss decreased (-0.405392 --> -0.432419).  Saving model ...
Epoch: 7 cost time: 1.8317539691925049
Epoch: 7, Steps: 10 | Train Loss: 1.063 Vali Loss: 1.295 Vali Acc: 0.338 Test Loss: 1.295 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7710669040679932
Epoch: 8, Steps: 10 | Train Loss: 0.967 Vali Loss: 1.187 Vali Acc: 0.473 Test Loss: 1.187 Test Acc: 0.473
Validation loss decreased (-0.432419 --> -0.472961).  Saving model ...
Epoch: 9 cost time: 1.7125678062438965
Epoch: 9, Steps: 10 | Train Loss: 0.824 Vali Loss: 1.208 Vali Acc: 0.446 Test Loss: 1.208 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8516719341278076
Epoch: 10, Steps: 10 | Train Loss: 0.763 Vali Loss: 1.173 Vali Acc: 0.500 Test Loss: 1.173 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499988).  Saving model ...
Epoch: 11 cost time: 1.5884058475494385
Epoch: 11, Steps: 10 | Train Loss: 0.619 Vali Loss: 1.130 Vali Acc: 0.527 Test Loss: 1.130 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527016).  Saving model ...
Epoch: 12 cost time: 1.8334970474243164
Epoch: 12, Steps: 10 | Train Loss: 0.550 Vali Loss: 1.194 Vali Acc: 0.541 Test Loss: 1.194 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540529).  Saving model ...
Epoch: 13 cost time: 1.773061990737915
Epoch: 13, Steps: 10 | Train Loss: 0.405 Vali Loss: 1.126 Vali Acc: 0.514 Test Loss: 1.126 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.470989465713501
Epoch: 14, Steps: 10 | Train Loss: 0.321 Vali Loss: 1.111 Vali Acc: 0.541 Test Loss: 1.111 Test Acc: 0.541
Validation loss decreased (-0.540529 --> -0.540529).  Saving model ...
Epoch: 15 cost time: 1.3297619819641113
Epoch: 15, Steps: 10 | Train Loss: 0.247 Vali Loss: 1.115 Vali Acc: 0.541 Test Loss: 1.115 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5072236061096191
Epoch: 16, Steps: 10 | Train Loss: 0.186 Vali Loss: 1.267 Vali Acc: 0.486 Test Loss: 1.267 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.6243646144866943
Epoch: 17, Steps: 10 | Train Loss: 0.139 Vali Loss: 1.180 Vali Acc: 0.554 Test Loss: 1.180 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554042).  Saving model ...
Epoch: 18 cost time: 1.9275221824645996
Epoch: 18, Steps: 10 | Train Loss: 0.104 Vali Loss: 1.240 Vali Acc: 0.527 Test Loss: 1.240 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.856508731842041
Epoch: 19, Steps: 10 | Train Loss: 0.073 Vali Loss: 1.250 Vali Acc: 0.541 Test Loss: 1.250 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.887932300567627
Epoch: 20, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.304 Vali Acc: 0.527 Test Loss: 1.304 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.8707013130187988
Epoch: 21, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.287 Vali Acc: 0.541 Test Loss: 1.287 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.7269251346588135
Epoch: 22, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.326 Vali Acc: 0.514 Test Loss: 1.326 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.6015782356262207
Epoch: 23, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.300 Vali Acc: 0.554 Test Loss: 1.300 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.9236633777618408
Epoch: 24, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.332 Vali Acc: 0.541 Test Loss: 1.332 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.9689147472381592
Epoch: 25, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.349 Vali Acc: 0.554 Test Loss: 1.349 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.8840594291687012
Epoch: 26, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.361 Vali Acc: 0.554 Test Loss: 1.361 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.63187837600708
Epoch: 27, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.381 Vali Acc: 0.527 Test Loss: 1.381 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 292136
model size : 1.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.4849679470062256
Epoch: 1, Steps: 10 | Train Loss: 1.475 Vali Loss: 1.467 Vali Acc: 0.189 Test Loss: 1.467 Test Acc: 0.189
Validation loss decreased (inf --> -0.189175).  Saving model ...
Epoch: 2 cost time: 1.9341750144958496
Epoch: 2, Steps: 10 | Train Loss: 1.445 Vali Loss: 1.403 Vali Acc: 0.230 Test Loss: 1.403 Test Acc: 0.230
Validation loss decreased (-0.189175 --> -0.229716).  Saving model ...
Epoch: 3 cost time: 1.746755599975586
Epoch: 3, Steps: 10 | Train Loss: 1.371 Vali Loss: 1.447 Vali Acc: 0.203 Test Loss: 1.447 Test Acc: 0.203
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4981119632720947
Epoch: 4, Steps: 10 | Train Loss: 1.353 Vali Loss: 1.362 Vali Acc: 0.351 Test Loss: 1.362 Test Acc: 0.351
Validation loss decreased (-0.229716 --> -0.351338).  Saving model ...
Epoch: 5 cost time: 1.858976125717163
Epoch: 5, Steps: 10 | Train Loss: 1.288 Vali Loss: 1.345 Vali Acc: 0.270 Test Loss: 1.345 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6159582138061523
Epoch: 6, Steps: 10 | Train Loss: 1.213 Vali Loss: 1.387 Vali Acc: 0.324 Test Loss: 1.387 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7971124649047852
Epoch: 7, Steps: 10 | Train Loss: 1.144 Vali Loss: 1.249 Vali Acc: 0.419 Test Loss: 1.249 Test Acc: 0.419
Validation loss decreased (-0.351338 --> -0.418906).  Saving model ...
Epoch: 8 cost time: 1.8427789211273193
Epoch: 8, Steps: 10 | Train Loss: 1.031 Vali Loss: 1.325 Vali Acc: 0.351 Test Loss: 1.325 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6439411640167236
Epoch: 9, Steps: 10 | Train Loss: 0.901 Vali Loss: 1.183 Vali Acc: 0.473 Test Loss: 1.183 Test Acc: 0.473
Validation loss decreased (-0.418906 --> -0.472961).  Saving model ...
Epoch: 10 cost time: 1.7372784614562988
Epoch: 10, Steps: 10 | Train Loss: 0.783 Vali Loss: 1.153 Vali Acc: 0.473 Test Loss: 1.153 Test Acc: 0.473
Validation loss decreased (-0.472961 --> -0.472961).  Saving model ...
Epoch: 11 cost time: 1.4285457134246826
Epoch: 11, Steps: 10 | Train Loss: 0.642 Vali Loss: 1.149 Vali Acc: 0.500 Test Loss: 1.149 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499989).  Saving model ...
Epoch: 12 cost time: 2.204331874847412
Epoch: 12, Steps: 10 | Train Loss: 0.556 Vali Loss: 1.138 Vali Acc: 0.473 Test Loss: 1.138 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.493234634399414
Epoch: 13, Steps: 10 | Train Loss: 0.448 Vali Loss: 1.237 Vali Acc: 0.514 Test Loss: 1.237 Test Acc: 0.514
Validation loss decreased (-0.499989 --> -0.513501).  Saving model ...
Epoch: 14 cost time: 1.3978841304779053
Epoch: 14, Steps: 10 | Train Loss: 0.347 Vali Loss: 1.096 Vali Acc: 0.541 Test Loss: 1.096 Test Acc: 0.541
Validation loss decreased (-0.513501 --> -0.540530).  Saving model ...
Epoch: 15 cost time: 1.647329568862915
Epoch: 15, Steps: 10 | Train Loss: 0.275 Vali Loss: 1.172 Vali Acc: 0.486 Test Loss: 1.172 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.697235345840454
Epoch: 16, Steps: 10 | Train Loss: 0.207 Vali Loss: 1.177 Vali Acc: 0.514 Test Loss: 1.177 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.5707345008850098
Epoch: 17, Steps: 10 | Train Loss: 0.153 Vali Loss: 1.252 Vali Acc: 0.486 Test Loss: 1.252 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.5933401584625244
Epoch: 18, Steps: 10 | Train Loss: 0.114 Vali Loss: 1.212 Vali Acc: 0.527 Test Loss: 1.212 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.608128309249878
Epoch: 19, Steps: 10 | Train Loss: 0.079 Vali Loss: 1.231 Vali Acc: 0.500 Test Loss: 1.231 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.6992180347442627
Epoch: 20, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.309 Vali Acc: 0.500 Test Loss: 1.309 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.555708646774292
Epoch: 21, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.283 Vali Acc: 0.514 Test Loss: 1.283 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.6977770328521729
Epoch: 22, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.302 Vali Acc: 0.486 Test Loss: 1.302 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.7528986930847168
Epoch: 23, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.345 Vali Acc: 0.500 Test Loss: 1.345 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.685781478881836
Epoch: 24, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.343 Vali Acc: 0.514 Test Loss: 1.343 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 290504
model size : 1.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.568549633026123
Epoch: 1, Steps: 10 | Train Loss: 1.438 Vali Loss: 1.328 Vali Acc: 0.365 Test Loss: 1.328 Test Acc: 0.365
Validation loss decreased (inf --> -0.364852).  Saving model ...
Epoch: 2 cost time: 1.7821791172027588
Epoch: 2, Steps: 10 | Train Loss: 1.420 Vali Loss: 1.378 Vali Acc: 0.257 Test Loss: 1.378 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.643794059753418
Epoch: 3, Steps: 10 | Train Loss: 1.412 Vali Loss: 1.279 Vali Acc: 0.432 Test Loss: 1.279 Test Acc: 0.432
Validation loss decreased (-0.364852 --> -0.432420).  Saving model ...
Epoch: 4 cost time: 1.446042537689209
Epoch: 4, Steps: 10 | Train Loss: 1.308 Vali Loss: 1.311 Vali Acc: 0.392 Test Loss: 1.311 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3689732551574707
Epoch: 5, Steps: 10 | Train Loss: 1.218 Vali Loss: 1.231 Vali Acc: 0.527 Test Loss: 1.231 Test Acc: 0.527
Validation loss decreased (-0.432420 --> -0.527015).  Saving model ...
Epoch: 6 cost time: 1.7872843742370605
Epoch: 6, Steps: 10 | Train Loss: 1.133 Vali Loss: 1.272 Vali Acc: 0.432 Test Loss: 1.272 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7319722175598145
Epoch: 7, Steps: 10 | Train Loss: 1.044 Vali Loss: 1.169 Vali Acc: 0.446 Test Loss: 1.169 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5675950050354004
Epoch: 8, Steps: 10 | Train Loss: 0.887 Vali Loss: 1.123 Vali Acc: 0.554 Test Loss: 1.123 Test Acc: 0.554
Validation loss decreased (-0.527015 --> -0.554043).  Saving model ...
Epoch: 9 cost time: 1.8135840892791748
Epoch: 9, Steps: 10 | Train Loss: 0.782 Vali Loss: 1.082 Vali Acc: 0.541 Test Loss: 1.082 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4626948833465576
Epoch: 10, Steps: 10 | Train Loss: 0.675 Vali Loss: 1.140 Vali Acc: 0.554 Test Loss: 1.140 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.906358242034912
Epoch: 11, Steps: 10 | Train Loss: 0.581 Vali Loss: 1.084 Vali Acc: 0.527 Test Loss: 1.084 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.9282574653625488
Epoch: 12, Steps: 10 | Train Loss: 0.482 Vali Loss: 1.139 Vali Acc: 0.527 Test Loss: 1.139 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.8802518844604492
Epoch: 13, Steps: 10 | Train Loss: 0.402 Vali Loss: 1.073 Vali Acc: 0.514 Test Loss: 1.073 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.7400641441345215
Epoch: 14, Steps: 10 | Train Loss: 0.296 Vali Loss: 1.091 Vali Acc: 0.568 Test Loss: 1.091 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567557).  Saving model ...
Epoch: 15 cost time: 1.738168478012085
Epoch: 15, Steps: 10 | Train Loss: 0.236 Vali Loss: 1.092 Vali Acc: 0.541 Test Loss: 1.092 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9621717929840088
Epoch: 16, Steps: 10 | Train Loss: 0.177 Vali Loss: 1.138 Vali Acc: 0.527 Test Loss: 1.138 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7290663719177246
Epoch: 17, Steps: 10 | Train Loss: 0.133 Vali Loss: 1.205 Vali Acc: 0.554 Test Loss: 1.205 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.6312224864959717
Epoch: 18, Steps: 10 | Train Loss: 0.105 Vali Loss: 1.269 Vali Acc: 0.554 Test Loss: 1.269 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.7753310203552246
Epoch: 19, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.255 Vali Acc: 0.554 Test Loss: 1.255 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.8226165771484375
Epoch: 20, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.327 Vali Acc: 0.514 Test Loss: 1.327 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.659210443496704
Epoch: 21, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.292 Vali Acc: 0.554 Test Loss: 1.292 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.5709655284881592
Epoch: 22, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.419 Vali Acc: 0.473 Test Loss: 1.419 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.4501173496246338
Epoch: 23, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.349 Vali Acc: 0.527 Test Loss: 1.349 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.7900006771087646
Epoch: 24, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.403 Vali Acc: 0.514 Test Loss: 1.403 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 288872
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.8944334983825684
Epoch: 1, Steps: 10 | Train Loss: 1.554 Vali Loss: 1.391 Vali Acc: 0.270 Test Loss: 1.391 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 1.724259376525879
Epoch: 2, Steps: 10 | Train Loss: 1.412 Vali Loss: 1.361 Vali Acc: 0.392 Test Loss: 1.361 Test Acc: 0.392
Validation loss decreased (-0.270256 --> -0.391878).  Saving model ...
Epoch: 3 cost time: 1.753694772720337
Epoch: 3, Steps: 10 | Train Loss: 1.334 Vali Loss: 1.327 Vali Acc: 0.365 Test Loss: 1.327 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5477731227874756
Epoch: 4, Steps: 10 | Train Loss: 1.327 Vali Loss: 1.342 Vali Acc: 0.324 Test Loss: 1.342 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.644484281539917
Epoch: 5, Steps: 10 | Train Loss: 1.274 Vali Loss: 1.255 Vali Acc: 0.473 Test Loss: 1.255 Test Acc: 0.473
Validation loss decreased (-0.391878 --> -0.472960).  Saving model ...
Epoch: 6 cost time: 1.8324222564697266
Epoch: 6, Steps: 10 | Train Loss: 1.161 Vali Loss: 1.248 Vali Acc: 0.473 Test Loss: 1.248 Test Acc: 0.473
Validation loss decreased (-0.472960 --> -0.472960).  Saving model ...
Epoch: 7 cost time: 1.7344810962677002
Epoch: 7, Steps: 10 | Train Loss: 1.036 Vali Loss: 1.192 Vali Acc: 0.473 Test Loss: 1.192 Test Acc: 0.473
Validation loss decreased (-0.472960 --> -0.472961).  Saving model ...
Epoch: 8 cost time: 1.685084342956543
Epoch: 8, Steps: 10 | Train Loss: 0.984 Vali Loss: 1.211 Vali Acc: 0.446 Test Loss: 1.211 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9771313667297363
Epoch: 9, Steps: 10 | Train Loss: 0.839 Vali Loss: 1.149 Vali Acc: 0.486 Test Loss: 1.149 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486475).  Saving model ...
Epoch: 10 cost time: 1.7659912109375
Epoch: 10, Steps: 10 | Train Loss: 0.770 Vali Loss: 1.035 Vali Acc: 0.514 Test Loss: 1.035 Test Acc: 0.514
Validation loss decreased (-0.486475 --> -0.513503).  Saving model ...
Epoch: 11 cost time: 1.9556105136871338
Epoch: 11, Steps: 10 | Train Loss: 0.649 Vali Loss: 1.108 Vali Acc: 0.568 Test Loss: 1.108 Test Acc: 0.568
Validation loss decreased (-0.513503 --> -0.567556).  Saving model ...
Epoch: 12 cost time: 1.8989405632019043
Epoch: 12, Steps: 10 | Train Loss: 0.544 Vali Loss: 1.001 Vali Acc: 0.608 Test Loss: 1.001 Test Acc: 0.608
Validation loss decreased (-0.567556 --> -0.608098).  Saving model ...
Epoch: 13 cost time: 1.69124174118042
Epoch: 13, Steps: 10 | Train Loss: 0.446 Vali Loss: 1.070 Vali Acc: 0.514 Test Loss: 1.070 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9778611660003662
Epoch: 14, Steps: 10 | Train Loss: 0.391 Vali Loss: 1.053 Vali Acc: 0.541 Test Loss: 1.053 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.595505714416504
Epoch: 15, Steps: 10 | Train Loss: 0.337 Vali Loss: 1.056 Vali Acc: 0.568 Test Loss: 1.056 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.6218540668487549
Epoch: 16, Steps: 10 | Train Loss: 0.270 Vali Loss: 1.040 Vali Acc: 0.581 Test Loss: 1.040 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.666919231414795
Epoch: 17, Steps: 10 | Train Loss: 0.207 Vali Loss: 1.070 Vali Acc: 0.554 Test Loss: 1.070 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.606658935546875
Epoch: 18, Steps: 10 | Train Loss: 0.143 Vali Loss: 1.110 Vali Acc: 0.541 Test Loss: 1.110 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.7242887020111084
Epoch: 19, Steps: 10 | Train Loss: 0.103 Vali Loss: 1.092 Vali Acc: 0.608 Test Loss: 1.092 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.6403467655181885
Epoch: 20, Steps: 10 | Train Loss: 0.076 Vali Loss: 1.167 Vali Acc: 0.568 Test Loss: 1.167 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.8225839138031006
Epoch: 21, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.156 Vali Acc: 0.568 Test Loss: 1.156 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.8384056091308594
Epoch: 22, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.221 Vali Acc: 0.595 Test Loss: 1.221 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 210568
model size : 1.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.5119407176971436
Epoch: 1, Steps: 10 | Train Loss: 1.466 Vali Loss: 1.402 Vali Acc: 0.189 Test Loss: 1.402 Test Acc: 0.189
Validation loss decreased (inf --> -0.189175).  Saving model ...
Epoch: 2 cost time: 1.7197718620300293
Epoch: 2, Steps: 10 | Train Loss: 1.421 Vali Loss: 1.392 Vali Acc: 0.324 Test Loss: 1.392 Test Acc: 0.324
Validation loss decreased (-0.189175 --> -0.324310).  Saving model ...
Epoch: 3 cost time: 1.7408158779144287
Epoch: 3, Steps: 10 | Train Loss: 1.377 Vali Loss: 1.394 Vali Acc: 0.162 Test Loss: 1.394 Test Acc: 0.162
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9311678409576416
Epoch: 4, Steps: 10 | Train Loss: 1.359 Vali Loss: 1.391 Vali Acc: 0.284 Test Loss: 1.391 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.144958019256592
Epoch: 5, Steps: 10 | Train Loss: 1.308 Vali Loss: 1.350 Vali Acc: 0.324 Test Loss: 1.350 Test Acc: 0.324
Validation loss decreased (-0.324310 --> -0.324311).  Saving model ...
Epoch: 6 cost time: 1.8395888805389404
Epoch: 6, Steps: 10 | Train Loss: 1.240 Vali Loss: 1.324 Vali Acc: 0.311 Test Loss: 1.324 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5140907764434814
Epoch: 7, Steps: 10 | Train Loss: 1.156 Vali Loss: 1.440 Vali Acc: 0.270 Test Loss: 1.440 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.634723424911499
Epoch: 8, Steps: 10 | Train Loss: 1.095 Vali Loss: 1.269 Vali Acc: 0.392 Test Loss: 1.269 Test Acc: 0.392
Validation loss decreased (-0.324311 --> -0.391879).  Saving model ...
Epoch: 9 cost time: 1.8001935482025146
Epoch: 9, Steps: 10 | Train Loss: 1.074 Vali Loss: 1.328 Vali Acc: 0.378 Test Loss: 1.328 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5138628482818604
Epoch: 10, Steps: 10 | Train Loss: 0.906 Vali Loss: 1.263 Vali Acc: 0.392 Test Loss: 1.263 Test Acc: 0.392
Validation loss decreased (-0.391879 --> -0.391879).  Saving model ...
Epoch: 11 cost time: 1.5836405754089355
Epoch: 11, Steps: 10 | Train Loss: 0.825 Vali Loss: 1.182 Vali Acc: 0.514 Test Loss: 1.182 Test Acc: 0.514
Validation loss decreased (-0.391879 --> -0.513502).  Saving model ...
Epoch: 12 cost time: 1.6415860652923584
Epoch: 12, Steps: 10 | Train Loss: 0.729 Vali Loss: 1.240 Vali Acc: 0.432 Test Loss: 1.240 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.788276195526123
Epoch: 13, Steps: 10 | Train Loss: 0.587 Vali Loss: 1.195 Vali Acc: 0.486 Test Loss: 1.195 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.9556729793548584
Epoch: 14, Steps: 10 | Train Loss: 0.471 Vali Loss: 1.178 Vali Acc: 0.459 Test Loss: 1.178 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6684014797210693
Epoch: 15, Steps: 10 | Train Loss: 0.402 Vali Loss: 1.174 Vali Acc: 0.473 Test Loss: 1.174 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.7018465995788574
Epoch: 16, Steps: 10 | Train Loss: 0.327 Vali Loss: 1.161 Vali Acc: 0.527 Test Loss: 1.161 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527015).  Saving model ...
Epoch: 17 cost time: 1.724336862564087
Epoch: 17, Steps: 10 | Train Loss: 0.240 Vali Loss: 1.235 Vali Acc: 0.459 Test Loss: 1.235 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8856019973754883
Epoch: 18, Steps: 10 | Train Loss: 0.193 Vali Loss: 1.161 Vali Acc: 0.514 Test Loss: 1.161 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.921588659286499
Epoch: 19, Steps: 10 | Train Loss: 0.158 Vali Loss: 1.278 Vali Acc: 0.527 Test Loss: 1.278 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.5879979133605957
Epoch: 20, Steps: 10 | Train Loss: 0.096 Vali Loss: 1.226 Vali Acc: 0.541 Test Loss: 1.226 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540528).  Saving model ...
Epoch: 21 cost time: 1.6462199687957764
Epoch: 21, Steps: 10 | Train Loss: 0.086 Vali Loss: 1.304 Vali Acc: 0.486 Test Loss: 1.304 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.915449619293213
Epoch: 22, Steps: 10 | Train Loss: 0.066 Vali Loss: 1.322 Vali Acc: 0.541 Test Loss: 1.322 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.6554841995239258
Epoch: 23, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.369 Vali Acc: 0.486 Test Loss: 1.369 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.6713886260986328
Epoch: 24, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.352 Vali Acc: 0.514 Test Loss: 1.352 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.6352753639221191
Epoch: 25, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.352 Vali Acc: 0.541 Test Loss: 1.352 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.071455478668213
Epoch: 26, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.393 Vali Acc: 0.486 Test Loss: 1.393 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.7019736766815186
Epoch: 27, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.406 Vali Acc: 0.486 Test Loss: 1.406 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.5638809204101562
Epoch: 28, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.412 Vali Acc: 0.486 Test Loss: 1.412 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.7640259265899658
Epoch: 29, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.432 Vali Acc: 0.473 Test Loss: 1.432 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.5839686393737793
Epoch: 30, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.425 Vali Acc: 0.514 Test Loss: 1.425 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 208936
model size : 1.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.1684625148773193
Epoch: 1, Steps: 10 | Train Loss: 1.459 Vali Loss: 1.367 Vali Acc: 0.297 Test Loss: 1.367 Test Acc: 0.297
Validation loss decreased (inf --> -0.297284).  Saving model ...
Epoch: 2 cost time: 1.6162724494934082
Epoch: 2, Steps: 10 | Train Loss: 1.400 Vali Loss: 1.395 Vali Acc: 0.243 Test Loss: 1.395 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.842048168182373
Epoch: 3, Steps: 10 | Train Loss: 1.416 Vali Loss: 1.319 Vali Acc: 0.432 Test Loss: 1.319 Test Acc: 0.432
Validation loss decreased (-0.297284 --> -0.432419).  Saving model ...
Epoch: 4 cost time: 1.5619723796844482
Epoch: 4, Steps: 10 | Train Loss: 1.329 Vali Loss: 1.369 Vali Acc: 0.243 Test Loss: 1.369 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5199687480926514
Epoch: 5, Steps: 10 | Train Loss: 1.284 Vali Loss: 1.360 Vali Acc: 0.324 Test Loss: 1.360 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7184233665466309
Epoch: 6, Steps: 10 | Train Loss: 1.219 Vali Loss: 1.233 Vali Acc: 0.486 Test Loss: 1.233 Test Acc: 0.486
Validation loss decreased (-0.432419 --> -0.486474).  Saving model ...
Epoch: 7 cost time: 1.5962679386138916
Epoch: 7, Steps: 10 | Train Loss: 1.139 Vali Loss: 1.353 Vali Acc: 0.324 Test Loss: 1.353 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6409223079681396
Epoch: 8, Steps: 10 | Train Loss: 1.020 Vali Loss: 1.156 Vali Acc: 0.568 Test Loss: 1.156 Test Acc: 0.568
Validation loss decreased (-0.486474 --> -0.567556).  Saving model ...
Epoch: 9 cost time: 1.4924681186676025
Epoch: 9, Steps: 10 | Train Loss: 0.954 Vali Loss: 1.211 Vali Acc: 0.486 Test Loss: 1.211 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6838123798370361
Epoch: 10, Steps: 10 | Train Loss: 0.867 Vali Loss: 1.134 Vali Acc: 0.514 Test Loss: 1.134 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.604349136352539
Epoch: 11, Steps: 10 | Train Loss: 0.743 Vali Loss: 1.077 Vali Acc: 0.541 Test Loss: 1.077 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.6219563484191895
Epoch: 12, Steps: 10 | Train Loss: 0.637 Vali Loss: 1.082 Vali Acc: 0.514 Test Loss: 1.082 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.5101313591003418
Epoch: 13, Steps: 10 | Train Loss: 0.519 Vali Loss: 1.023 Vali Acc: 0.554 Test Loss: 1.023 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.708244800567627
Epoch: 14, Steps: 10 | Train Loss: 0.433 Vali Loss: 1.035 Vali Acc: 0.527 Test Loss: 1.035 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.8107678890228271
Epoch: 15, Steps: 10 | Train Loss: 0.341 Vali Loss: 1.097 Vali Acc: 0.541 Test Loss: 1.097 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.7372918128967285
Epoch: 16, Steps: 10 | Train Loss: 0.254 Vali Loss: 1.040 Vali Acc: 0.554 Test Loss: 1.040 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.3583695888519287
Epoch: 17, Steps: 10 | Train Loss: 0.186 Vali Loss: 1.068 Vali Acc: 0.554 Test Loss: 1.068 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.2653143405914307
Epoch: 18, Steps: 10 | Train Loss: 0.144 Vali Loss: 1.107 Vali Acc: 0.554 Test Loss: 1.107 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 207304
model size : 1.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.680361270904541
Epoch: 1, Steps: 10 | Train Loss: 1.522 Vali Loss: 1.385 Vali Acc: 0.311 Test Loss: 1.385 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 1.4816856384277344
Epoch: 2, Steps: 10 | Train Loss: 1.444 Vali Loss: 1.389 Vali Acc: 0.243 Test Loss: 1.389 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.727555751800537
Epoch: 3, Steps: 10 | Train Loss: 1.376 Vali Loss: 1.403 Vali Acc: 0.338 Test Loss: 1.403 Test Acc: 0.338
Validation loss decreased (-0.310797 --> -0.337824).  Saving model ...
Epoch: 4 cost time: 1.5063962936401367
Epoch: 4, Steps: 10 | Train Loss: 1.352 Vali Loss: 1.349 Vali Acc: 0.365 Test Loss: 1.349 Test Acc: 0.365
Validation loss decreased (-0.337824 --> -0.364851).  Saving model ...
Epoch: 5 cost time: 1.5798616409301758
Epoch: 5, Steps: 10 | Train Loss: 1.297 Vali Loss: 1.372 Vali Acc: 0.338 Test Loss: 1.372 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.600795030593872
Epoch: 6, Steps: 10 | Train Loss: 1.204 Vali Loss: 1.308 Vali Acc: 0.338 Test Loss: 1.308 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8206143379211426
Epoch: 7, Steps: 10 | Train Loss: 1.091 Vali Loss: 1.264 Vali Acc: 0.419 Test Loss: 1.264 Test Acc: 0.419
Validation loss decreased (-0.364851 --> -0.418906).  Saving model ...
Epoch: 8 cost time: 1.8159842491149902
Epoch: 8, Steps: 10 | Train Loss: 0.955 Vali Loss: 1.195 Vali Acc: 0.446 Test Loss: 1.195 Test Acc: 0.446
Validation loss decreased (-0.418906 --> -0.445934).  Saving model ...
Epoch: 9 cost time: 1.5235960483551025
Epoch: 9, Steps: 10 | Train Loss: 0.871 Vali Loss: 1.226 Vali Acc: 0.473 Test Loss: 1.226 Test Acc: 0.473
Validation loss decreased (-0.445934 --> -0.472961).  Saving model ...
Epoch: 10 cost time: 1.4130346775054932
Epoch: 10, Steps: 10 | Train Loss: 0.805 Vali Loss: 1.164 Vali Acc: 0.486 Test Loss: 1.164 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486475).  Saving model ...
Epoch: 11 cost time: 1.5148661136627197
Epoch: 11, Steps: 10 | Train Loss: 0.654 Vali Loss: 1.255 Vali Acc: 0.473 Test Loss: 1.255 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6929240226745605
Epoch: 12, Steps: 10 | Train Loss: 0.588 Vali Loss: 1.118 Vali Acc: 0.541 Test Loss: 1.118 Test Acc: 0.541
Validation loss decreased (-0.486475 --> -0.540529).  Saving model ...
Epoch: 13 cost time: 1.8047716617584229
Epoch: 13, Steps: 10 | Train Loss: 0.465 Vali Loss: 1.213 Vali Acc: 0.473 Test Loss: 1.213 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6131360530853271
Epoch: 14, Steps: 10 | Train Loss: 0.382 Vali Loss: 1.111 Vali Acc: 0.568 Test Loss: 1.111 Test Acc: 0.568
Validation loss decreased (-0.540529 --> -0.567556).  Saving model ...
Epoch: 15 cost time: 1.6616477966308594
Epoch: 15, Steps: 10 | Train Loss: 0.286 Vali Loss: 1.263 Vali Acc: 0.500 Test Loss: 1.263 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8352413177490234
Epoch: 16, Steps: 10 | Train Loss: 0.242 Vali Loss: 1.172 Vali Acc: 0.486 Test Loss: 1.172 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.6580803394317627
Epoch: 17, Steps: 10 | Train Loss: 0.180 Vali Loss: 1.197 Vali Acc: 0.527 Test Loss: 1.197 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.8408927917480469
Epoch: 18, Steps: 10 | Train Loss: 0.126 Vali Loss: 1.334 Vali Acc: 0.527 Test Loss: 1.334 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.8762602806091309
Epoch: 19, Steps: 10 | Train Loss: 0.101 Vali Loss: 1.271 Vali Acc: 0.554 Test Loss: 1.271 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.6991450786590576
Epoch: 20, Steps: 10 | Train Loss: 0.072 Vali Loss: 1.454 Vali Acc: 0.514 Test Loss: 1.454 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.5200066566467285
Epoch: 21, Steps: 10 | Train Loss: 0.064 Vali Loss: 1.332 Vali Acc: 0.514 Test Loss: 1.332 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.7962651252746582
Epoch: 22, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.436 Vali Acc: 0.486 Test Loss: 1.436 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.6709058284759521
Epoch: 23, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.540 Vali Acc: 0.514 Test Loss: 1.540 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.6311333179473877
Epoch: 24, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.426 Vali Acc: 0.527 Test Loss: 1.426 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 205672
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.5105583667755127
Epoch: 1, Steps: 10 | Train Loss: 1.472 Vali Loss: 1.438 Vali Acc: 0.257 Test Loss: 1.438 Test Acc: 0.257
Validation loss decreased (inf --> -0.256742).  Saving model ...
Epoch: 2 cost time: 1.7134909629821777
Epoch: 2, Steps: 10 | Train Loss: 1.423 Vali Loss: 1.381 Vali Acc: 0.270 Test Loss: 1.381 Test Acc: 0.270
Validation loss decreased (-0.256742 --> -0.270256).  Saving model ...
Epoch: 3 cost time: 1.8214726448059082
Epoch: 3, Steps: 10 | Train Loss: 1.395 Vali Loss: 1.415 Vali Acc: 0.284 Test Loss: 1.415 Test Acc: 0.284
Validation loss decreased (-0.270256 --> -0.283770).  Saving model ...
Epoch: 4 cost time: 2.0206515789031982
Epoch: 4, Steps: 10 | Train Loss: 1.407 Vali Loss: 1.433 Vali Acc: 0.230 Test Loss: 1.433 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7386584281921387
Epoch: 5, Steps: 10 | Train Loss: 1.265 Vali Loss: 1.361 Vali Acc: 0.338 Test Loss: 1.361 Test Acc: 0.338
Validation loss decreased (-0.283770 --> -0.337824).  Saving model ...
Epoch: 6 cost time: 1.878849744796753
Epoch: 6, Steps: 10 | Train Loss: 1.219 Vali Loss: 1.362 Vali Acc: 0.257 Test Loss: 1.362 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.772320032119751
Epoch: 7, Steps: 10 | Train Loss: 1.145 Vali Loss: 1.298 Vali Acc: 0.446 Test Loss: 1.298 Test Acc: 0.446
Validation loss decreased (-0.337824 --> -0.445933).  Saving model ...
Epoch: 8 cost time: 1.6401259899139404
Epoch: 8, Steps: 10 | Train Loss: 1.086 Vali Loss: 1.227 Vali Acc: 0.486 Test Loss: 1.227 Test Acc: 0.486
Validation loss decreased (-0.445933 --> -0.486474).  Saving model ...
Epoch: 9 cost time: 1.5502641201019287
Epoch: 9, Steps: 10 | Train Loss: 1.016 Vali Loss: 1.311 Vali Acc: 0.338 Test Loss: 1.311 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.120772123336792
Epoch: 10, Steps: 10 | Train Loss: 0.889 Vali Loss: 1.212 Vali Acc: 0.486 Test Loss: 1.212 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486474).  Saving model ...
Epoch: 11 cost time: 1.5982615947723389
Epoch: 11, Steps: 10 | Train Loss: 0.769 Vali Loss: 1.144 Vali Acc: 0.473 Test Loss: 1.144 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7097282409667969
Epoch: 12, Steps: 10 | Train Loss: 0.678 Vali Loss: 1.189 Vali Acc: 0.514 Test Loss: 1.189 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513502).  Saving model ...
Epoch: 13 cost time: 1.693826675415039
Epoch: 13, Steps: 10 | Train Loss: 0.571 Vali Loss: 1.134 Vali Acc: 0.514 Test Loss: 1.134 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513502).  Saving model ...
Epoch: 14 cost time: 1.6652717590332031
Epoch: 14, Steps: 10 | Train Loss: 0.548 Vali Loss: 1.294 Vali Acc: 0.459 Test Loss: 1.294 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8084406852722168
Epoch: 15, Steps: 10 | Train Loss: 0.494 Vali Loss: 1.178 Vali Acc: 0.500 Test Loss: 1.178 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.809215784072876
Epoch: 16, Steps: 10 | Train Loss: 0.363 Vali Loss: 1.197 Vali Acc: 0.527 Test Loss: 1.197 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527015).  Saving model ...
Epoch: 17 cost time: 1.3940269947052002
Epoch: 17, Steps: 10 | Train Loss: 0.266 Vali Loss: 1.157 Vali Acc: 0.581 Test Loss: 1.157 Test Acc: 0.581
Validation loss decreased (-0.527015 --> -0.581070).  Saving model ...
Epoch: 18 cost time: 1.7914094924926758
Epoch: 18, Steps: 10 | Train Loss: 0.223 Vali Loss: 1.165 Vali Acc: 0.568 Test Loss: 1.165 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7542695999145508
Epoch: 19, Steps: 10 | Train Loss: 0.171 Vali Loss: 1.205 Vali Acc: 0.541 Test Loss: 1.205 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.4720802307128906
Epoch: 20, Steps: 10 | Train Loss: 0.124 Vali Loss: 1.242 Vali Acc: 0.581 Test Loss: 1.242 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.53836989402771
Epoch: 21, Steps: 10 | Train Loss: 0.090 Vali Loss: 1.187 Vali Acc: 0.554 Test Loss: 1.187 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.5216946601867676
Epoch: 22, Steps: 10 | Train Loss: 0.064 Vali Loss: 1.322 Vali Acc: 0.554 Test Loss: 1.322 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.7812409400939941
Epoch: 23, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.265 Vali Acc: 0.554 Test Loss: 1.265 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.420259714126587
Epoch: 24, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.314 Vali Acc: 0.554 Test Loss: 1.314 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.6752879619598389
Epoch: 25, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.307 Vali Acc: 0.568 Test Loss: 1.307 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.8617067337036133
Epoch: 26, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.349 Vali Acc: 0.568 Test Loss: 1.349 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.6560478210449219
Epoch: 27, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.297 Vali Acc: 0.595 Test Loss: 1.297 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594582).  Saving model ...
Epoch: 28 cost time: 1.7048728466033936
Epoch: 28, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.346 Vali Acc: 0.581 Test Loss: 1.346 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.7255146503448486
Epoch: 29, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.363 Vali Acc: 0.581 Test Loss: 1.363 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.7679657936096191
Epoch: 30, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.338 Vali Acc: 0.595 Test Loss: 1.338 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.6092512607574463
Epoch: 31, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.400 Vali Acc: 0.568 Test Loss: 1.400 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.8307514190673828
Epoch: 32, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.381 Vali Acc: 0.595 Test Loss: 1.381 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.7846050262451172
Epoch: 33, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.388 Vali Acc: 0.581 Test Loss: 1.388 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.8451387882232666
Epoch: 34, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.409 Vali Acc: 0.581 Test Loss: 1.409 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.759681224822998
Epoch: 35, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.418 Vali Acc: 0.568 Test Loss: 1.418 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.5815277099609375
Epoch: 36, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.404 Vali Acc: 0.595 Test Loss: 1.404 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.8645150661468506
Epoch: 37, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.426 Vali Acc: 0.595 Test Loss: 1.426 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 168968
model size : 1.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.2722690105438232
Epoch: 1, Steps: 10 | Train Loss: 1.478 Vali Loss: 1.406 Vali Acc: 0.189 Test Loss: 1.406 Test Acc: 0.189
Validation loss decreased (inf --> -0.189175).  Saving model ...
Epoch: 2 cost time: 1.4025077819824219
Epoch: 2, Steps: 10 | Train Loss: 1.428 Vali Loss: 1.403 Vali Acc: 0.257 Test Loss: 1.403 Test Acc: 0.257
Validation loss decreased (-0.189175 --> -0.256743).  Saving model ...
Epoch: 3 cost time: 1.8085386753082275
Epoch: 3, Steps: 10 | Train Loss: 1.403 Vali Loss: 1.412 Vali Acc: 0.176 Test Loss: 1.412 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.763227939605713
Epoch: 4, Steps: 10 | Train Loss: 1.366 Vali Loss: 1.359 Vali Acc: 0.405 Test Loss: 1.359 Test Acc: 0.405
Validation loss decreased (-0.256743 --> -0.405392).  Saving model ...
Epoch: 5 cost time: 1.6394236087799072
Epoch: 5, Steps: 10 | Train Loss: 1.327 Vali Loss: 1.465 Vali Acc: 0.203 Test Loss: 1.465 Test Acc: 0.203
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9424879550933838
Epoch: 6, Steps: 10 | Train Loss: 1.301 Vali Loss: 1.296 Vali Acc: 0.446 Test Loss: 1.296 Test Acc: 0.446
Validation loss decreased (-0.405392 --> -0.445933).  Saving model ...
Epoch: 7 cost time: 1.2072138786315918
Epoch: 7, Steps: 10 | Train Loss: 1.215 Vali Loss: 1.410 Vali Acc: 0.297 Test Loss: 1.410 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5761384963989258
Epoch: 8, Steps: 10 | Train Loss: 1.155 Vali Loss: 1.269 Vali Acc: 0.446 Test Loss: 1.269 Test Acc: 0.446
Validation loss decreased (-0.445933 --> -0.445933).  Saving model ...
Epoch: 9 cost time: 1.6596603393554688
Epoch: 9, Steps: 10 | Train Loss: 1.052 Vali Loss: 1.252 Vali Acc: 0.446 Test Loss: 1.252 Test Acc: 0.446
Validation loss decreased (-0.445933 --> -0.445933).  Saving model ...
Epoch: 10 cost time: 1.643850564956665
Epoch: 10, Steps: 10 | Train Loss: 0.963 Vali Loss: 1.323 Vali Acc: 0.378 Test Loss: 1.323 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6889991760253906
Epoch: 11, Steps: 10 | Train Loss: 0.864 Vali Loss: 1.176 Vali Acc: 0.446 Test Loss: 1.176 Test Acc: 0.446
Validation loss decreased (-0.445933 --> -0.445934).  Saving model ...
Epoch: 12 cost time: 1.8399500846862793
Epoch: 12, Steps: 10 | Train Loss: 0.743 Vali Loss: 1.201 Vali Acc: 0.473 Test Loss: 1.201 Test Acc: 0.473
Validation loss decreased (-0.445934 --> -0.472961).  Saving model ...
Epoch: 13 cost time: 1.5375721454620361
Epoch: 13, Steps: 10 | Train Loss: 0.656 Vali Loss: 1.235 Vali Acc: 0.486 Test Loss: 1.235 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486474).  Saving model ...
Epoch: 14 cost time: 1.6997270584106445
Epoch: 14, Steps: 10 | Train Loss: 0.579 Vali Loss: 1.142 Vali Acc: 0.554 Test Loss: 1.142 Test Acc: 0.554
Validation loss decreased (-0.486474 --> -0.554043).  Saving model ...
Epoch: 15 cost time: 1.6118230819702148
Epoch: 15, Steps: 10 | Train Loss: 0.511 Vali Loss: 1.286 Vali Acc: 0.419 Test Loss: 1.286 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.488006353378296
Epoch: 16, Steps: 10 | Train Loss: 0.399 Vali Loss: 1.081 Vali Acc: 0.541 Test Loss: 1.081 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.809880256652832
Epoch: 17, Steps: 10 | Train Loss: 0.327 Vali Loss: 1.221 Vali Acc: 0.541 Test Loss: 1.221 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.9024722576141357
Epoch: 18, Steps: 10 | Train Loss: 0.239 Vali Loss: 1.092 Vali Acc: 0.595 Test Loss: 1.092 Test Acc: 0.595
Validation loss decreased (-0.554043 --> -0.594584).  Saving model ...
Epoch: 19 cost time: 1.851585865020752
Epoch: 19, Steps: 10 | Train Loss: 0.180 Vali Loss: 1.201 Vali Acc: 0.527 Test Loss: 1.201 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6601464748382568
Epoch: 20, Steps: 10 | Train Loss: 0.118 Vali Loss: 1.102 Vali Acc: 0.541 Test Loss: 1.102 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.7898287773132324
Epoch: 21, Steps: 10 | Train Loss: 0.097 Vali Loss: 1.199 Vali Acc: 0.541 Test Loss: 1.199 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.429196834564209
Epoch: 22, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.207 Vali Acc: 0.581 Test Loss: 1.207 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.3965733051300049
Epoch: 23, Steps: 10 | Train Loss: 0.060 Vali Loss: 1.199 Vali Acc: 0.568 Test Loss: 1.199 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.355567216873169
Epoch: 24, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.250 Vali Acc: 0.554 Test Loss: 1.250 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.4544548988342285
Epoch: 25, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.207 Vali Acc: 0.595 Test Loss: 1.207 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.5371034145355225
Epoch: 26, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.288 Vali Acc: 0.568 Test Loss: 1.288 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.3601551055908203
Epoch: 27, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.255 Vali Acc: 0.581 Test Loss: 1.255 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.515906572341919
Epoch: 28, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.305 Vali Acc: 0.581 Test Loss: 1.305 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 167336
model size : 1.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.6775097846984863
Epoch: 1, Steps: 10 | Train Loss: 1.480 Vali Loss: 1.415 Vali Acc: 0.189 Test Loss: 1.415 Test Acc: 0.189
Validation loss decreased (inf --> -0.189175).  Saving model ...
Epoch: 2 cost time: 1.753819465637207
Epoch: 2, Steps: 10 | Train Loss: 1.470 Vali Loss: 1.360 Vali Acc: 0.432 Test Loss: 1.360 Test Acc: 0.432
Validation loss decreased (-0.189175 --> -0.432419).  Saving model ...
Epoch: 3 cost time: 1.632117509841919
Epoch: 3, Steps: 10 | Train Loss: 1.375 Vali Loss: 1.448 Vali Acc: 0.270 Test Loss: 1.448 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4339048862457275
Epoch: 4, Steps: 10 | Train Loss: 1.342 Vali Loss: 1.345 Vali Acc: 0.338 Test Loss: 1.345 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7084097862243652
Epoch: 5, Steps: 10 | Train Loss: 1.249 Vali Loss: 1.328 Vali Acc: 0.351 Test Loss: 1.328 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7840046882629395
Epoch: 6, Steps: 10 | Train Loss: 1.170 Vali Loss: 1.290 Vali Acc: 0.365 Test Loss: 1.290 Test Acc: 0.365
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.488234043121338
Epoch: 7, Steps: 10 | Train Loss: 1.138 Vali Loss: 1.348 Vali Acc: 0.284 Test Loss: 1.348 Test Acc: 0.284
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.554673433303833
Epoch: 8, Steps: 10 | Train Loss: 1.019 Vali Loss: 1.237 Vali Acc: 0.432 Test Loss: 1.237 Test Acc: 0.432
Validation loss decreased (-0.432419 --> -0.432420).  Saving model ...
Epoch: 9 cost time: 1.3603436946868896
Epoch: 9, Steps: 10 | Train Loss: 0.918 Vali Loss: 1.208 Vali Acc: 0.473 Test Loss: 1.208 Test Acc: 0.473
Validation loss decreased (-0.432420 --> -0.472961).  Saving model ...
Epoch: 10 cost time: 1.1026842594146729
Epoch: 10, Steps: 10 | Train Loss: 0.817 Vali Loss: 1.213 Vali Acc: 0.446 Test Loss: 1.213 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3389196395874023
Epoch: 11, Steps: 10 | Train Loss: 0.697 Vali Loss: 1.180 Vali Acc: 0.486 Test Loss: 1.180 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486475).  Saving model ...
Epoch: 12 cost time: 1.5177946090698242
Epoch: 12, Steps: 10 | Train Loss: 0.594 Vali Loss: 1.144 Vali Acc: 0.541 Test Loss: 1.144 Test Acc: 0.541
Validation loss decreased (-0.486475 --> -0.540529).  Saving model ...
Epoch: 13 cost time: 1.32167649269104
Epoch: 13, Steps: 10 | Train Loss: 0.515 Vali Loss: 1.104 Vali Acc: 0.541 Test Loss: 1.104 Test Acc: 0.541
Validation loss decreased (-0.540529 --> -0.540529).  Saving model ...
Epoch: 14 cost time: 1.5948517322540283
Epoch: 14, Steps: 10 | Train Loss: 0.430 Vali Loss: 1.186 Vali Acc: 0.527 Test Loss: 1.186 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6758699417114258
Epoch: 15, Steps: 10 | Train Loss: 0.368 Vali Loss: 1.081 Vali Acc: 0.595 Test Loss: 1.081 Test Acc: 0.595
Validation loss decreased (-0.540529 --> -0.594584).  Saving model ...
Epoch: 16 cost time: 1.3982369899749756
Epoch: 16, Steps: 10 | Train Loss: 0.281 Vali Loss: 1.160 Vali Acc: 0.514 Test Loss: 1.160 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6993017196655273
Epoch: 17, Steps: 10 | Train Loss: 0.220 Vali Loss: 1.172 Vali Acc: 0.554 Test Loss: 1.172 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.6603984832763672
Epoch: 18, Steps: 10 | Train Loss: 0.166 Vali Loss: 1.212 Vali Acc: 0.568 Test Loss: 1.212 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.5647244453430176
Epoch: 19, Steps: 10 | Train Loss: 0.125 Vali Loss: 1.218 Vali Acc: 0.554 Test Loss: 1.218 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.077012777328491
Epoch: 20, Steps: 10 | Train Loss: 0.087 Vali Loss: 1.237 Vali Acc: 0.554 Test Loss: 1.237 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.793320655822754
Epoch: 21, Steps: 10 | Train Loss: 0.077 Vali Loss: 1.360 Vali Acc: 0.527 Test Loss: 1.360 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.4941132068634033
Epoch: 22, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.309 Vali Acc: 0.541 Test Loss: 1.309 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.626124382019043
Epoch: 23, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.336 Vali Acc: 0.541 Test Loss: 1.336 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.405937910079956
Epoch: 24, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.353 Vali Acc: 0.527 Test Loss: 1.353 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.7466673851013184
Epoch: 25, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.358 Vali Acc: 0.541 Test Loss: 1.358 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 165704
model size : 1.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.8921258449554443
Epoch: 1, Steps: 10 | Train Loss: 1.540 Vali Loss: 1.400 Vali Acc: 0.257 Test Loss: 1.400 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 1.5325407981872559
Epoch: 2, Steps: 10 | Train Loss: 1.431 Vali Loss: 1.422 Vali Acc: 0.243 Test Loss: 1.422 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7315819263458252
Epoch: 3, Steps: 10 | Train Loss: 1.420 Vali Loss: 1.336 Vali Acc: 0.405 Test Loss: 1.336 Test Acc: 0.405
Validation loss decreased (-0.256743 --> -0.405392).  Saving model ...
Epoch: 4 cost time: 1.5694808959960938
Epoch: 4, Steps: 10 | Train Loss: 1.442 Vali Loss: 1.342 Vali Acc: 0.378 Test Loss: 1.342 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5480210781097412
Epoch: 5, Steps: 10 | Train Loss: 1.342 Vali Loss: 1.314 Vali Acc: 0.419 Test Loss: 1.314 Test Acc: 0.419
Validation loss decreased (-0.405392 --> -0.418906).  Saving model ...
Epoch: 6 cost time: 1.475146770477295
Epoch: 6, Steps: 10 | Train Loss: 1.277 Vali Loss: 1.274 Vali Acc: 0.378 Test Loss: 1.274 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.597318172454834
Epoch: 7, Steps: 10 | Train Loss: 1.188 Vali Loss: 1.320 Vali Acc: 0.432 Test Loss: 1.320 Test Acc: 0.432
Validation loss decreased (-0.418906 --> -0.432419).  Saving model ...
Epoch: 8 cost time: 1.4886949062347412
Epoch: 8, Steps: 10 | Train Loss: 1.100 Vali Loss: 1.184 Vali Acc: 0.473 Test Loss: 1.184 Test Acc: 0.473
Validation loss decreased (-0.432419 --> -0.472961).  Saving model ...
Epoch: 9 cost time: 1.8591337203979492
Epoch: 9, Steps: 10 | Train Loss: 0.972 Vali Loss: 1.238 Vali Acc: 0.459 Test Loss: 1.238 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4121668338775635
Epoch: 10, Steps: 10 | Train Loss: 0.931 Vali Loss: 1.145 Vali Acc: 0.473 Test Loss: 1.145 Test Acc: 0.473
Validation loss decreased (-0.472961 --> -0.472962).  Saving model ...
Epoch: 11 cost time: 1.5482230186462402
Epoch: 11, Steps: 10 | Train Loss: 0.773 Vali Loss: 1.148 Vali Acc: 0.500 Test Loss: 1.148 Test Acc: 0.500
Validation loss decreased (-0.472962 --> -0.499989).  Saving model ...
Epoch: 12 cost time: 1.703927755355835
Epoch: 12, Steps: 10 | Train Loss: 0.689 Vali Loss: 1.164 Vali Acc: 0.500 Test Loss: 1.164 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7677063941955566
Epoch: 13, Steps: 10 | Train Loss: 0.587 Vali Loss: 1.103 Vali Acc: 0.527 Test Loss: 1.103 Test Acc: 0.527
Validation loss decreased (-0.499989 --> -0.527016).  Saving model ...
Epoch: 14 cost time: 1.628046989440918
Epoch: 14, Steps: 10 | Train Loss: 0.491 Vali Loss: 1.100 Vali Acc: 0.514 Test Loss: 1.100 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6993448734283447
Epoch: 15, Steps: 10 | Train Loss: 0.392 Vali Loss: 1.063 Vali Acc: 0.568 Test Loss: 1.063 Test Acc: 0.568
Validation loss decreased (-0.527016 --> -0.567557).  Saving model ...
Epoch: 16 cost time: 1.6406276226043701
Epoch: 16, Steps: 10 | Train Loss: 0.333 Vali Loss: 1.143 Vali Acc: 0.500 Test Loss: 1.143 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.0713560581207275
Epoch: 17, Steps: 10 | Train Loss: 0.276 Vali Loss: 1.163 Vali Acc: 0.527 Test Loss: 1.163 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.5895533561706543
Epoch: 18, Steps: 10 | Train Loss: 0.190 Vali Loss: 1.097 Vali Acc: 0.554 Test Loss: 1.097 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.9521539211273193
Epoch: 19, Steps: 10 | Train Loss: 0.147 Vali Loss: 1.208 Vali Acc: 0.514 Test Loss: 1.208 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.6848936080932617
Epoch: 20, Steps: 10 | Train Loss: 0.109 Vali Loss: 1.169 Vali Acc: 0.541 Test Loss: 1.169 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.677370309829712
Epoch: 21, Steps: 10 | Train Loss: 0.072 Vali Loss: 1.264 Vali Acc: 0.500 Test Loss: 1.264 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.6993036270141602
Epoch: 22, Steps: 10 | Train Loss: 0.062 Vali Loss: 1.221 Vali Acc: 0.581 Test Loss: 1.221 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581069).  Saving model ...
Epoch: 23 cost time: 1.7178435325622559
Epoch: 23, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.255 Vali Acc: 0.527 Test Loss: 1.255 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.796877384185791
Epoch: 24, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.302 Vali Acc: 0.527 Test Loss: 1.302 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.9993643760681152
Epoch: 25, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.279 Vali Acc: 0.554 Test Loss: 1.279 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.705310583114624
Epoch: 26, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.333 Vali Acc: 0.527 Test Loss: 1.333 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.742701768875122
Epoch: 27, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.341 Vali Acc: 0.581 Test Loss: 1.341 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.8028924465179443
Epoch: 28, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.335 Vali Acc: 0.541 Test Loss: 1.335 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.7951240539550781
Epoch: 29, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.386 Vali Acc: 0.568 Test Loss: 1.386 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.647850513458252
Epoch: 30, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.369 Vali Acc: 0.554 Test Loss: 1.369 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.5244574546813965
Epoch: 31, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.373 Vali Acc: 0.541 Test Loss: 1.373 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.9096100330352783
Epoch: 32, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.436 Vali Acc: 0.581 Test Loss: 1.436 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 164072
model size : 1.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.75557017326355
Epoch: 1, Steps: 10 | Train Loss: 1.656 Vali Loss: 1.625 Vali Acc: 0.338 Test Loss: 1.625 Test Acc: 0.338
Validation loss decreased (inf --> -0.337822).  Saving model ...
Epoch: 2 cost time: 1.4186091423034668
Epoch: 2, Steps: 10 | Train Loss: 1.684 Vali Loss: 1.865 Vali Acc: 0.257 Test Loss: 1.865 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4595584869384766
Epoch: 3, Steps: 10 | Train Loss: 1.402 Vali Loss: 1.568 Vali Acc: 0.257 Test Loss: 1.568 Test Acc: 0.257
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.489091157913208
Epoch: 4, Steps: 10 | Train Loss: 0.871 Vali Loss: 1.991 Vali Acc: 0.432 Test Loss: 1.991 Test Acc: 0.432
Validation loss decreased (-0.337822 --> -0.432413).  Saving model ...
Epoch: 5 cost time: 1.8239336013793945
Epoch: 5, Steps: 10 | Train Loss: 1.261 Vali Loss: 3.041 Vali Acc: 0.270 Test Loss: 3.041 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.335134506225586
Epoch: 6, Steps: 10 | Train Loss: 0.702 Vali Loss: 1.264 Vali Acc: 0.527 Test Loss: 1.264 Test Acc: 0.527
Validation loss decreased (-0.432413 --> -0.527014).  Saving model ...
Epoch: 7 cost time: 1.5429143905639648
Epoch: 7, Steps: 10 | Train Loss: 0.258 Vali Loss: 1.633 Vali Acc: 0.554 Test Loss: 1.633 Test Acc: 0.554
Validation loss decreased (-0.527014 --> -0.554038).  Saving model ...
Epoch: 8 cost time: 1.7240374088287354
Epoch: 8, Steps: 10 | Train Loss: 0.425 Vali Loss: 1.689 Vali Acc: 0.514 Test Loss: 1.689 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6252427101135254
Epoch: 9, Steps: 10 | Train Loss: 0.284 Vali Loss: 2.118 Vali Acc: 0.500 Test Loss: 2.118 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.742945671081543
Epoch: 10, Steps: 10 | Train Loss: 0.161 Vali Loss: 3.440 Vali Acc: 0.392 Test Loss: 3.440 Test Acc: 0.392
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.6918182373046875
Epoch: 11, Steps: 10 | Train Loss: 0.244 Vali Loss: 2.514 Vali Acc: 0.541 Test Loss: 2.514 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3136239051818848
Epoch: 12, Steps: 10 | Train Loss: 0.153 Vali Loss: 2.775 Vali Acc: 0.514 Test Loss: 2.775 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.6387460231781006
Epoch: 13, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.136 Vali Acc: 0.432 Test Loss: 4.136 Test Acc: 0.432
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.9306228160858154
Epoch: 14, Steps: 10 | Train Loss: 0.158 Vali Loss: 3.649 Vali Acc: 0.541 Test Loss: 3.649 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.5546860694885254
Epoch: 15, Steps: 10 | Train Loss: 0.144 Vali Loss: 3.683 Vali Acc: 0.541 Test Loss: 3.683 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.065579414367676
Epoch: 16, Steps: 10 | Train Loss: 0.215 Vali Loss: 4.428 Vali Acc: 0.541 Test Loss: 4.428 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.8297314643859863
Epoch: 17, Steps: 10 | Train Loss: 0.239 Vali Loss: 4.270 Vali Acc: 0.608 Test Loss: 4.270 Test Acc: 0.608
Validation loss decreased (-0.554038 --> -0.608065).  Saving model ...
Epoch: 18 cost time: 1.5738754272460938
Epoch: 18, Steps: 10 | Train Loss: 0.470 Vali Loss: 5.388 Vali Acc: 0.514 Test Loss: 5.388 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.471431016921997
Epoch: 19, Steps: 10 | Train Loss: 0.111 Vali Loss: 5.398 Vali Acc: 0.527 Test Loss: 5.398 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.8186075687408447
Epoch: 20, Steps: 10 | Train Loss: 0.054 Vali Loss: 5.073 Vali Acc: 0.568 Test Loss: 5.073 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.765023946762085
Epoch: 21, Steps: 10 | Train Loss: 0.062 Vali Loss: 4.776 Vali Acc: 0.514 Test Loss: 4.776 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.6889996528625488
Epoch: 22, Steps: 10 | Train Loss: 0.058 Vali Loss: 4.775 Vali Acc: 0.595 Test Loss: 4.775 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.5682029724121094
Epoch: 23, Steps: 10 | Train Loss: 0.025 Vali Loss: 5.201 Vali Acc: 0.608 Test Loss: 5.201 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.149832248687744
Epoch: 24, Steps: 10 | Train Loss: 0.012 Vali Loss: 5.419 Vali Acc: 0.608 Test Loss: 5.419 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.5603857040405273
Epoch: 25, Steps: 10 | Train Loss: 0.060 Vali Loss: 6.960 Vali Acc: 0.514 Test Loss: 6.960 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.7720882892608643
Epoch: 26, Steps: 10 | Train Loss: 0.015 Vali Loss: 6.382 Vali Acc: 0.554 Test Loss: 6.382 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.7709879875183105
Epoch: 27, Steps: 10 | Train Loss: 0.074 Vali Loss: 6.466 Vali Acc: 0.514 Test Loss: 6.466 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 5223452
model size : 24.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.43253755569458
Epoch: 1, Steps: 10 | Train Loss: 1.580 Vali Loss: 1.667 Vali Acc: 0.392 Test Loss: 1.667 Test Acc: 0.392
Validation loss decreased (inf --> -0.391875).  Saving model ...
Epoch: 2 cost time: 1.71108078956604
Epoch: 2, Steps: 10 | Train Loss: 1.945 Vali Loss: 1.455 Vali Acc: 0.419 Test Loss: 1.455 Test Acc: 0.419
Validation loss decreased (-0.391875 --> -0.418904).  Saving model ...
Epoch: 3 cost time: 1.5968317985534668
Epoch: 3, Steps: 10 | Train Loss: 1.304 Vali Loss: 1.506 Vali Acc: 0.419 Test Loss: 1.506 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7685582637786865
Epoch: 4, Steps: 10 | Train Loss: 1.058 Vali Loss: 1.258 Vali Acc: 0.473 Test Loss: 1.258 Test Acc: 0.473
Validation loss decreased (-0.418904 --> -0.472960).  Saving model ...
Epoch: 5 cost time: 1.5973320007324219
Epoch: 5, Steps: 10 | Train Loss: 0.744 Vali Loss: 2.466 Vali Acc: 0.243 Test Loss: 2.466 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.618844747543335
Epoch: 6, Steps: 10 | Train Loss: 0.611 Vali Loss: 1.125 Vali Acc: 0.541 Test Loss: 1.125 Test Acc: 0.541
Validation loss decreased (-0.472960 --> -0.540529).  Saving model ...
Epoch: 7 cost time: 1.3812453746795654
Epoch: 7, Steps: 10 | Train Loss: 0.340 Vali Loss: 1.304 Vali Acc: 0.568 Test Loss: 1.304 Test Acc: 0.568
Validation loss decreased (-0.540529 --> -0.567555).  Saving model ...
Epoch: 8 cost time: 1.76511812210083
Epoch: 8, Steps: 10 | Train Loss: 0.171 Vali Loss: 1.527 Vali Acc: 0.527 Test Loss: 1.527 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3788065910339355
Epoch: 9, Steps: 10 | Train Loss: 0.239 Vali Loss: 1.857 Vali Acc: 0.486 Test Loss: 1.857 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6697161197662354
Epoch: 10, Steps: 10 | Train Loss: 0.093 Vali Loss: 2.726 Vali Acc: 0.459 Test Loss: 2.726 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.5124917030334473
Epoch: 11, Steps: 10 | Train Loss: 0.067 Vali Loss: 2.960 Vali Acc: 0.500 Test Loss: 2.960 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.5400259494781494
Epoch: 12, Steps: 10 | Train Loss: 0.185 Vali Loss: 4.398 Vali Acc: 0.432 Test Loss: 4.398 Test Acc: 0.432
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.836927890777588
Epoch: 13, Steps: 10 | Train Loss: 0.170 Vali Loss: 4.128 Vali Acc: 0.459 Test Loss: 4.128 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.5828285217285156
Epoch: 14, Steps: 10 | Train Loss: 0.083 Vali Loss: 3.975 Vali Acc: 0.486 Test Loss: 3.975 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.4440522193908691
Epoch: 15, Steps: 10 | Train Loss: 0.080 Vali Loss: 3.828 Vali Acc: 0.527 Test Loss: 3.828 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.8397612571716309
Epoch: 16, Steps: 10 | Train Loss: 0.059 Vali Loss: 4.075 Vali Acc: 0.459 Test Loss: 4.075 Test Acc: 0.459
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.7216715812683105
Epoch: 17, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.985 Vali Acc: 0.514 Test Loss: 3.985 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 5214748
model size : 24.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.090265512466431
Epoch: 1, Steps: 10 | Train Loss: 1.646 Vali Loss: 1.596 Vali Acc: 0.216 Test Loss: 1.596 Test Acc: 0.216
Validation loss decreased (inf --> -0.216200).  Saving model ...
Epoch: 2 cost time: 1.7821626663208008
Epoch: 2, Steps: 10 | Train Loss: 1.618 Vali Loss: 2.079 Vali Acc: 0.189 Test Loss: 2.079 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.00715708732605
Epoch: 3, Steps: 10 | Train Loss: 1.304 Vali Loss: 1.971 Vali Acc: 0.284 Test Loss: 1.971 Test Acc: 0.284
Validation loss decreased (-0.216200 --> -0.283764).  Saving model ...
Epoch: 4 cost time: 1.4663043022155762
Epoch: 4, Steps: 10 | Train Loss: 0.933 Vali Loss: 1.290 Vali Acc: 0.473 Test Loss: 1.290 Test Acc: 0.473
Validation loss decreased (-0.283764 --> -0.472960).  Saving model ...
Epoch: 5 cost time: 1.6961865425109863
Epoch: 5, Steps: 10 | Train Loss: 0.753 Vali Loss: 1.805 Vali Acc: 0.514 Test Loss: 1.805 Test Acc: 0.514
Validation loss decreased (-0.472960 --> -0.513495).  Saving model ...
Epoch: 6 cost time: 1.7763566970825195
Epoch: 6, Steps: 10 | Train Loss: 0.558 Vali Loss: 1.848 Vali Acc: 0.392 Test Loss: 1.848 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8964250087738037
Epoch: 7, Steps: 10 | Train Loss: 0.384 Vali Loss: 2.328 Vali Acc: 0.378 Test Loss: 2.328 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8501231670379639
Epoch: 8, Steps: 10 | Train Loss: 0.258 Vali Loss: 1.499 Vali Acc: 0.541 Test Loss: 1.499 Test Acc: 0.541
Validation loss decreased (-0.513495 --> -0.540526).  Saving model ...
Epoch: 9 cost time: 1.8072192668914795
Epoch: 9, Steps: 10 | Train Loss: 0.112 Vali Loss: 2.032 Vali Acc: 0.432 Test Loss: 2.032 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6280851364135742
Epoch: 10, Steps: 10 | Train Loss: 0.151 Vali Loss: 2.228 Vali Acc: 0.500 Test Loss: 2.228 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6457428932189941
Epoch: 11, Steps: 10 | Train Loss: 0.127 Vali Loss: 3.444 Vali Acc: 0.446 Test Loss: 3.444 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.7913987636566162
Epoch: 12, Steps: 10 | Train Loss: 0.282 Vali Loss: 3.293 Vali Acc: 0.473 Test Loss: 3.293 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.8916888236999512
Epoch: 13, Steps: 10 | Train Loss: 0.126 Vali Loss: 3.413 Vali Acc: 0.568 Test Loss: 3.413 Test Acc: 0.568
Validation loss decreased (-0.540526 --> -0.567533).  Saving model ...
Epoch: 14 cost time: 1.8362808227539062
Epoch: 14, Steps: 10 | Train Loss: 0.074 Vali Loss: 4.218 Vali Acc: 0.527 Test Loss: 4.218 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7310376167297363
Epoch: 15, Steps: 10 | Train Loss: 0.083 Vali Loss: 5.131 Vali Acc: 0.378 Test Loss: 5.131 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.8306667804718018
Epoch: 16, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.843 Vali Acc: 0.446 Test Loss: 3.843 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.6947579383850098
Epoch: 17, Steps: 10 | Train Loss: 0.160 Vali Loss: 5.651 Vali Acc: 0.486 Test Loss: 5.651 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.8669798374176025
Epoch: 18, Steps: 10 | Train Loss: 0.138 Vali Loss: 5.209 Vali Acc: 0.446 Test Loss: 5.209 Test Acc: 0.446
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.8117320537567139
Epoch: 19, Steps: 10 | Train Loss: 0.238 Vali Loss: 6.910 Vali Acc: 0.446 Test Loss: 6.910 Test Acc: 0.446
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.790419340133667
Epoch: 20, Steps: 10 | Train Loss: 0.210 Vali Loss: 7.259 Vali Acc: 0.446 Test Loss: 7.259 Test Acc: 0.446
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.5933635234832764
Epoch: 21, Steps: 10 | Train Loss: 0.115 Vali Loss: 5.152 Vali Acc: 0.568 Test Loss: 5.152 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.5821740627288818
Epoch: 22, Steps: 10 | Train Loss: 0.151 Vali Loss: 6.870 Vali Acc: 0.486 Test Loss: 6.870 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.4606375694274902
Epoch: 23, Steps: 10 | Train Loss: 0.089 Vali Loss: 7.970 Vali Acc: 0.446 Test Loss: 7.970 Test Acc: 0.446
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 5206044
model size : 24.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.9970688819885254
Epoch: 1, Steps: 10 | Train Loss: 1.651 Vali Loss: 1.910 Vali Acc: 0.203 Test Loss: 1.910 Test Acc: 0.203
Validation loss decreased (inf --> -0.202684).  Saving model ...
Epoch: 2 cost time: 1.2418198585510254
Epoch: 2, Steps: 10 | Train Loss: 1.461 Vali Loss: 1.376 Vali Acc: 0.338 Test Loss: 1.376 Test Acc: 0.338
Validation loss decreased (-0.202684 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 1.3352150917053223
Epoch: 3, Steps: 10 | Train Loss: 1.136 Vali Loss: 1.338 Vali Acc: 0.419 Test Loss: 1.338 Test Acc: 0.419
Validation loss decreased (-0.337824 --> -0.418906).  Saving model ...
Epoch: 4 cost time: 1.5286734104156494
Epoch: 4, Steps: 10 | Train Loss: 1.139 Vali Loss: 2.413 Vali Acc: 0.257 Test Loss: 2.413 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3834178447723389
Epoch: 5, Steps: 10 | Train Loss: 1.175 Vali Loss: 1.884 Vali Acc: 0.378 Test Loss: 1.884 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5897319316864014
Epoch: 6, Steps: 10 | Train Loss: 0.587 Vali Loss: 1.465 Vali Acc: 0.473 Test Loss: 1.465 Test Acc: 0.473
Validation loss decreased (-0.418906 --> -0.472958).  Saving model ...
Epoch: 7 cost time: 1.5086023807525635
Epoch: 7, Steps: 10 | Train Loss: 0.279 Vali Loss: 1.636 Vali Acc: 0.446 Test Loss: 1.636 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7017407417297363
Epoch: 8, Steps: 10 | Train Loss: 0.282 Vali Loss: 3.235 Vali Acc: 0.378 Test Loss: 3.235 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6042664051055908
Epoch: 9, Steps: 10 | Train Loss: 0.188 Vali Loss: 2.013 Vali Acc: 0.541 Test Loss: 2.013 Test Acc: 0.541
Validation loss decreased (-0.472958 --> -0.540520).  Saving model ...
Epoch: 10 cost time: 1.5784101486206055
Epoch: 10, Steps: 10 | Train Loss: 0.115 Vali Loss: 2.727 Vali Acc: 0.432 Test Loss: 2.727 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.57515549659729
Epoch: 11, Steps: 10 | Train Loss: 0.143 Vali Loss: 2.516 Vali Acc: 0.541 Test Loss: 2.516 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.398831844329834
Epoch: 12, Steps: 10 | Train Loss: 0.143 Vali Loss: 3.178 Vali Acc: 0.568 Test Loss: 3.178 Test Acc: 0.568
Validation loss decreased (-0.540520 --> -0.567536).  Saving model ...
Epoch: 13 cost time: 1.411947250366211
Epoch: 13, Steps: 10 | Train Loss: 0.101 Vali Loss: 2.978 Vali Acc: 0.568 Test Loss: 2.978 Test Acc: 0.568
Validation loss decreased (-0.567536 --> -0.567538).  Saving model ...
Epoch: 14 cost time: 1.5167889595031738
Epoch: 14, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.456 Vali Acc: 0.554 Test Loss: 3.456 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6208610534667969
Epoch: 15, Steps: 10 | Train Loss: 0.213 Vali Loss: 4.480 Vali Acc: 0.473 Test Loss: 4.480 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4436023235321045
Epoch: 16, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.859 Vali Acc: 0.581 Test Loss: 3.859 Test Acc: 0.581
Validation loss decreased (-0.567538 --> -0.581042).  Saving model ...
Epoch: 17 cost time: 1.520073413848877
Epoch: 17, Steps: 10 | Train Loss: 0.127 Vali Loss: 4.428 Vali Acc: 0.554 Test Loss: 4.428 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6152586936950684
Epoch: 18, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.944 Vali Acc: 0.486 Test Loss: 4.944 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.5278921127319336
Epoch: 19, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.713 Vali Acc: 0.500 Test Loss: 4.713 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2364418506622314
Epoch: 20, Steps: 10 | Train Loss: 0.031 Vali Loss: 5.213 Vali Acc: 0.473 Test Loss: 5.213 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.529524326324463
Epoch: 21, Steps: 10 | Train Loss: 0.062 Vali Loss: 5.663 Vali Acc: 0.459 Test Loss: 5.663 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.2351536750793457
Epoch: 22, Steps: 10 | Train Loss: 0.123 Vali Loss: 5.882 Vali Acc: 0.500 Test Loss: 5.882 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.6543018817901611
Epoch: 23, Steps: 10 | Train Loss: 0.199 Vali Loss: 6.854 Vali Acc: 0.486 Test Loss: 6.854 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.7431273460388184
Epoch: 24, Steps: 10 | Train Loss: 0.088 Vali Loss: 6.541 Vali Acc: 0.459 Test Loss: 6.541 Test Acc: 0.459
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.407331943511963
Epoch: 25, Steps: 10 | Train Loss: 0.075 Vali Loss: 7.826 Vali Acc: 0.459 Test Loss: 7.826 Test Acc: 0.459
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.5012171268463135
Epoch: 26, Steps: 10 | Train Loss: 0.018 Vali Loss: 8.646 Vali Acc: 0.473 Test Loss: 8.646 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 5197340
model size : 24.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.7367939949035645
Epoch: 1, Steps: 10 | Train Loss: 1.584 Vali Loss: 1.584 Vali Acc: 0.216 Test Loss: 1.584 Test Acc: 0.216
Validation loss decreased (inf --> -0.216200).  Saving model ...
Epoch: 2 cost time: 2.042417526245117
Epoch: 2, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.498 Vali Acc: 0.324 Test Loss: 1.498 Test Acc: 0.324
Validation loss decreased (-0.216200 --> -0.324309).  Saving model ...
Epoch: 3 cost time: 1.7251615524291992
Epoch: 3, Steps: 10 | Train Loss: 1.279 Vali Loss: 1.380 Vali Acc: 0.338 Test Loss: 1.380 Test Acc: 0.338
Validation loss decreased (-0.324309 --> -0.337824).  Saving model ...
Epoch: 4 cost time: 1.6234827041625977
Epoch: 4, Steps: 10 | Train Loss: 1.280 Vali Loss: 1.920 Vali Acc: 0.338 Test Loss: 1.920 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7159409523010254
Epoch: 5, Steps: 10 | Train Loss: 0.744 Vali Loss: 1.311 Vali Acc: 0.486 Test Loss: 1.311 Test Acc: 0.486
Validation loss decreased (-0.337824 --> -0.486473).  Saving model ...
Epoch: 6 cost time: 1.800673484802246
Epoch: 6, Steps: 10 | Train Loss: 0.467 Vali Loss: 2.436 Vali Acc: 0.392 Test Loss: 2.436 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0629467964172363
Epoch: 7, Steps: 10 | Train Loss: 0.668 Vali Loss: 2.011 Vali Acc: 0.514 Test Loss: 2.011 Test Acc: 0.514
Validation loss decreased (-0.486473 --> -0.513493).  Saving model ...
Epoch: 8 cost time: 2.1636178493499756
Epoch: 8, Steps: 10 | Train Loss: 0.221 Vali Loss: 1.752 Vali Acc: 0.446 Test Loss: 1.752 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9581782817840576
Epoch: 9, Steps: 10 | Train Loss: 0.411 Vali Loss: 1.903 Vali Acc: 0.473 Test Loss: 1.903 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5587871074676514
Epoch: 10, Steps: 10 | Train Loss: 0.110 Vali Loss: 2.273 Vali Acc: 0.459 Test Loss: 2.273 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.6080081462860107
Epoch: 11, Steps: 10 | Train Loss: 0.126 Vali Loss: 2.496 Vali Acc: 0.459 Test Loss: 2.496 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.560621738433838
Epoch: 12, Steps: 10 | Train Loss: 0.289 Vali Loss: 3.160 Vali Acc: 0.486 Test Loss: 3.160 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.6657865047454834
Epoch: 13, Steps: 10 | Train Loss: 0.147 Vali Loss: 4.713 Vali Acc: 0.432 Test Loss: 4.713 Test Acc: 0.432
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.4171392917633057
Epoch: 14, Steps: 10 | Train Loss: 0.129 Vali Loss: 3.217 Vali Acc: 0.459 Test Loss: 3.217 Test Acc: 0.459
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.936014175415039
Epoch: 15, Steps: 10 | Train Loss: 0.101 Vali Loss: 3.418 Vali Acc: 0.527 Test Loss: 3.418 Test Acc: 0.527
Validation loss decreased (-0.513493 --> -0.526993).  Saving model ...
Epoch: 16 cost time: 1.4533469676971436
Epoch: 16, Steps: 10 | Train Loss: 0.151 Vali Loss: 4.155 Vali Acc: 0.568 Test Loss: 4.155 Test Acc: 0.568
Validation loss decreased (-0.526993 --> -0.567526).  Saving model ...
Epoch: 17 cost time: 1.91605544090271
Epoch: 17, Steps: 10 | Train Loss: 0.134 Vali Loss: 4.818 Vali Acc: 0.392 Test Loss: 4.818 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5695815086364746
Epoch: 18, Steps: 10 | Train Loss: 0.107 Vali Loss: 5.328 Vali Acc: 0.486 Test Loss: 5.328 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.664614200592041
Epoch: 19, Steps: 10 | Train Loss: 0.108 Vali Loss: 4.082 Vali Acc: 0.608 Test Loss: 4.082 Test Acc: 0.608
Validation loss decreased (-0.567526 --> -0.608067).  Saving model ...
Epoch: 20 cost time: 1.3677849769592285
Epoch: 20, Steps: 10 | Train Loss: 0.081 Vali Loss: 4.696 Vali Acc: 0.554 Test Loss: 4.696 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.7807095050811768
Epoch: 21, Steps: 10 | Train Loss: 0.027 Vali Loss: 5.147 Vali Acc: 0.581 Test Loss: 5.147 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.808624029159546
Epoch: 22, Steps: 10 | Train Loss: 0.095 Vali Loss: 6.090 Vali Acc: 0.541 Test Loss: 6.090 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.765639066696167
Epoch: 23, Steps: 10 | Train Loss: 0.123 Vali Loss: 5.879 Vali Acc: 0.500 Test Loss: 5.879 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.5795588493347168
Epoch: 24, Steps: 10 | Train Loss: 0.059 Vali Loss: 6.135 Vali Acc: 0.541 Test Loss: 6.135 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.8065381050109863
Epoch: 25, Steps: 10 | Train Loss: 0.160 Vali Loss: 5.779 Vali Acc: 0.595 Test Loss: 5.779 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.8107829093933105
Epoch: 26, Steps: 10 | Train Loss: 0.085 Vali Loss: 6.339 Vali Acc: 0.527 Test Loss: 6.339 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.1007394790649414
Epoch: 27, Steps: 10 | Train Loss: 0.057 Vali Loss: 7.463 Vali Acc: 0.554 Test Loss: 7.463 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.823814868927002
Epoch: 28, Steps: 10 | Train Loss: 0.112 Vali Loss: 8.626 Vali Acc: 0.473 Test Loss: 8.626 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.1104400157928467
Epoch: 29, Steps: 10 | Train Loss: 0.123 Vali Loss: 7.325 Vali Acc: 0.595 Test Loss: 7.325 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 4435484
model size : 21.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.9741668701171875
Epoch: 1, Steps: 10 | Train Loss: 1.572 Vali Loss: 1.519 Vali Acc: 0.405 Test Loss: 1.519 Test Acc: 0.405
Validation loss decreased (inf --> -0.405390).  Saving model ...
Epoch: 2 cost time: 1.9768269062042236
Epoch: 2, Steps: 10 | Train Loss: 1.574 Vali Loss: 1.829 Vali Acc: 0.405 Test Loss: 1.829 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9430816173553467
Epoch: 3, Steps: 10 | Train Loss: 1.497 Vali Loss: 1.810 Vali Acc: 0.378 Test Loss: 1.810 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9238905906677246
Epoch: 4, Steps: 10 | Train Loss: 1.172 Vali Loss: 1.350 Vali Acc: 0.514 Test Loss: 1.350 Test Acc: 0.514
Validation loss decreased (-0.405390 --> -0.513500).  Saving model ...
Epoch: 5 cost time: 1.5186703205108643
Epoch: 5, Steps: 10 | Train Loss: 0.705 Vali Loss: 1.500 Vali Acc: 0.473 Test Loss: 1.500 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1702866554260254
Epoch: 6, Steps: 10 | Train Loss: 0.528 Vali Loss: 1.659 Vali Acc: 0.405 Test Loss: 1.659 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8594274520874023
Epoch: 7, Steps: 10 | Train Loss: 0.356 Vali Loss: 1.510 Vali Acc: 0.541 Test Loss: 1.510 Test Acc: 0.541
Validation loss decreased (-0.513500 --> -0.540525).  Saving model ...
Epoch: 8 cost time: 1.6952431201934814
Epoch: 8, Steps: 10 | Train Loss: 0.235 Vali Loss: 1.573 Vali Acc: 0.486 Test Loss: 1.573 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8355357646942139
Epoch: 9, Steps: 10 | Train Loss: 0.444 Vali Loss: 1.751 Vali Acc: 0.554 Test Loss: 1.751 Test Acc: 0.554
Validation loss decreased (-0.540525 --> -0.554037).  Saving model ...
Epoch: 10 cost time: 1.4042351245880127
Epoch: 10, Steps: 10 | Train Loss: 0.190 Vali Loss: 1.752 Vali Acc: 0.527 Test Loss: 1.752 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7597565650939941
Epoch: 11, Steps: 10 | Train Loss: 0.117 Vali Loss: 2.891 Vali Acc: 0.473 Test Loss: 2.891 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.919132947921753
Epoch: 12, Steps: 10 | Train Loss: 0.210 Vali Loss: 2.231 Vali Acc: 0.527 Test Loss: 2.231 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7910127639770508
Epoch: 13, Steps: 10 | Train Loss: 0.080 Vali Loss: 2.996 Vali Acc: 0.432 Test Loss: 2.996 Test Acc: 0.432
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.0324184894561768
Epoch: 14, Steps: 10 | Train Loss: 0.076 Vali Loss: 3.095 Vali Acc: 0.500 Test Loss: 3.095 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.6250128746032715
Epoch: 15, Steps: 10 | Train Loss: 0.070 Vali Loss: 3.217 Vali Acc: 0.527 Test Loss: 3.217 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.110126256942749
Epoch: 16, Steps: 10 | Train Loss: 0.131 Vali Loss: 3.693 Vali Acc: 0.473 Test Loss: 3.693 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.023308753967285
Epoch: 17, Steps: 10 | Train Loss: 0.082 Vali Loss: 4.137 Vali Acc: 0.473 Test Loss: 4.137 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.6927640438079834
Epoch: 18, Steps: 10 | Train Loss: 0.089 Vali Loss: 4.606 Vali Acc: 0.473 Test Loss: 4.606 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.9727287292480469
Epoch: 19, Steps: 10 | Train Loss: 0.058 Vali Loss: 4.741 Vali Acc: 0.432 Test Loss: 4.741 Test Acc: 0.432
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 4426780
model size : 21.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.231921672821045
Epoch: 1, Steps: 10 | Train Loss: 1.596 Vali Loss: 1.596 Vali Acc: 0.230 Test Loss: 1.596 Test Acc: 0.230
Validation loss decreased (inf --> -0.229714).  Saving model ...
Epoch: 2 cost time: 1.6240429878234863
Epoch: 2, Steps: 10 | Train Loss: 1.404 Vali Loss: 1.355 Vali Acc: 0.419 Test Loss: 1.355 Test Acc: 0.419
Validation loss decreased (-0.229714 --> -0.418905).  Saving model ...
Epoch: 3 cost time: 1.5435426235198975
Epoch: 3, Steps: 10 | Train Loss: 1.061 Vali Loss: 1.508 Vali Acc: 0.419 Test Loss: 1.508 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.860872745513916
Epoch: 4, Steps: 10 | Train Loss: 0.969 Vali Loss: 2.330 Vali Acc: 0.270 Test Loss: 2.330 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8002676963806152
Epoch: 5, Steps: 10 | Train Loss: 0.725 Vali Loss: 1.149 Vali Acc: 0.500 Test Loss: 1.149 Test Acc: 0.500
Validation loss decreased (-0.418905 --> -0.499989).  Saving model ...
Epoch: 6 cost time: 1.5388951301574707
Epoch: 6, Steps: 10 | Train Loss: 0.458 Vali Loss: 1.862 Vali Acc: 0.405 Test Loss: 1.862 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.667987585067749
Epoch: 7, Steps: 10 | Train Loss: 0.463 Vali Loss: 1.716 Vali Acc: 0.446 Test Loss: 1.716 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7799804210662842
Epoch: 8, Steps: 10 | Train Loss: 0.490 Vali Loss: 1.796 Vali Acc: 0.459 Test Loss: 1.796 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7628023624420166
Epoch: 9, Steps: 10 | Train Loss: 0.123 Vali Loss: 1.691 Vali Acc: 0.541 Test Loss: 1.691 Test Acc: 0.541
Validation loss decreased (-0.499989 --> -0.540524).  Saving model ...
Epoch: 10 cost time: 1.7146337032318115
Epoch: 10, Steps: 10 | Train Loss: 0.164 Vali Loss: 3.023 Vali Acc: 0.365 Test Loss: 3.023 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6699211597442627
Epoch: 11, Steps: 10 | Train Loss: 0.117 Vali Loss: 1.889 Vali Acc: 0.595 Test Loss: 1.889 Test Acc: 0.595
Validation loss decreased (-0.540524 --> -0.594576).  Saving model ...
Epoch: 12 cost time: 1.6818406581878662
Epoch: 12, Steps: 10 | Train Loss: 0.068 Vali Loss: 2.084 Vali Acc: 0.541 Test Loss: 2.084 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7267553806304932
Epoch: 13, Steps: 10 | Train Loss: 0.127 Vali Loss: 2.829 Vali Acc: 0.541 Test Loss: 2.829 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.6525957584381104
Epoch: 14, Steps: 10 | Train Loss: 0.471 Vali Loss: 3.334 Vali Acc: 0.446 Test Loss: 3.334 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.857715368270874
Epoch: 15, Steps: 10 | Train Loss: 0.258 Vali Loss: 6.735 Vali Acc: 0.432 Test Loss: 6.735 Test Acc: 0.432
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.822983741760254
Epoch: 16, Steps: 10 | Train Loss: 0.204 Vali Loss: 4.033 Vali Acc: 0.486 Test Loss: 4.033 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.7668752670288086
Epoch: 17, Steps: 10 | Train Loss: 0.160 Vali Loss: 4.271 Vali Acc: 0.514 Test Loss: 4.271 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.815917730331421
Epoch: 18, Steps: 10 | Train Loss: 0.163 Vali Loss: 4.644 Vali Acc: 0.541 Test Loss: 4.644 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.8981595039367676
Epoch: 19, Steps: 10 | Train Loss: 0.219 Vali Loss: 6.045 Vali Acc: 0.514 Test Loss: 6.045 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.741133213043213
Epoch: 20, Steps: 10 | Train Loss: 0.218 Vali Loss: 4.977 Vali Acc: 0.527 Test Loss: 4.977 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.6184117794036865
Epoch: 21, Steps: 10 | Train Loss: 0.403 Vali Loss: 5.069 Vali Acc: 0.473 Test Loss: 5.069 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 4418076
model size : 21.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.3390698432922363
Epoch: 1, Steps: 10 | Train Loss: 1.546 Vali Loss: 1.311 Vali Acc: 0.419 Test Loss: 1.311 Test Acc: 0.419
Validation loss decreased (inf --> -0.418906).  Saving model ...
Epoch: 2 cost time: 1.4335129261016846
Epoch: 2, Steps: 10 | Train Loss: 1.191 Vali Loss: 1.174 Vali Acc: 0.432 Test Loss: 1.174 Test Acc: 0.432
Validation loss decreased (-0.418906 --> -0.432421).  Saving model ...
Epoch: 3 cost time: 1.3864891529083252
Epoch: 3, Steps: 10 | Train Loss: 0.847 Vali Loss: 1.172 Vali Acc: 0.473 Test Loss: 1.172 Test Acc: 0.473
Validation loss decreased (-0.432421 --> -0.472961).  Saving model ...
Epoch: 4 cost time: 1.751328945159912
Epoch: 4, Steps: 10 | Train Loss: 0.754 Vali Loss: 2.266 Vali Acc: 0.297 Test Loss: 2.266 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4656453132629395
Epoch: 5, Steps: 10 | Train Loss: 0.651 Vali Loss: 1.487 Vali Acc: 0.486 Test Loss: 1.487 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486472).  Saving model ...
Epoch: 6 cost time: 1.4654839038848877
Epoch: 6, Steps: 10 | Train Loss: 0.427 Vali Loss: 1.594 Vali Acc: 0.500 Test Loss: 1.594 Test Acc: 0.500
Validation loss decreased (-0.486472 --> -0.499984).  Saving model ...
Epoch: 7 cost time: 1.3735342025756836
Epoch: 7, Steps: 10 | Train Loss: 0.782 Vali Loss: 3.697 Vali Acc: 0.392 Test Loss: 3.697 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.732931137084961
Epoch: 8, Steps: 10 | Train Loss: 0.585 Vali Loss: 1.660 Vali Acc: 0.541 Test Loss: 1.660 Test Acc: 0.541
Validation loss decreased (-0.499984 --> -0.540524).  Saving model ...
Epoch: 9 cost time: 1.666771411895752
Epoch: 9, Steps: 10 | Train Loss: 0.342 Vali Loss: 1.871 Vali Acc: 0.541 Test Loss: 1.871 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.877486228942871
Epoch: 10, Steps: 10 | Train Loss: 0.148 Vali Loss: 2.714 Vali Acc: 0.500 Test Loss: 2.714 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.608933448791504
Epoch: 11, Steps: 10 | Train Loss: 0.195 Vali Loss: 2.933 Vali Acc: 0.568 Test Loss: 2.933 Test Acc: 0.568
Validation loss decreased (-0.540524 --> -0.567538).  Saving model ...
Epoch: 12 cost time: 1.4905445575714111
Epoch: 12, Steps: 10 | Train Loss: 0.227 Vali Loss: 2.972 Vali Acc: 0.568 Test Loss: 2.972 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6787431240081787
Epoch: 13, Steps: 10 | Train Loss: 0.100 Vali Loss: 3.063 Vali Acc: 0.554 Test Loss: 3.063 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5778226852416992
Epoch: 14, Steps: 10 | Train Loss: 0.112 Vali Loss: 4.868 Vali Acc: 0.514 Test Loss: 4.868 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5583829879760742
Epoch: 15, Steps: 10 | Train Loss: 0.064 Vali Loss: 3.781 Vali Acc: 0.500 Test Loss: 3.781 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.6744906902313232
Epoch: 16, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.141 Vali Acc: 0.500 Test Loss: 4.141 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.6808247566223145
Epoch: 17, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.288 Vali Acc: 0.500 Test Loss: 4.288 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.8014881610870361
Epoch: 18, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.594 Vali Acc: 0.486 Test Loss: 4.594 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.4789016246795654
Epoch: 19, Steps: 10 | Train Loss: 0.050 Vali Loss: 4.473 Vali Acc: 0.459 Test Loss: 4.473 Test Acc: 0.459
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.7240252494812012
Epoch: 20, Steps: 10 | Train Loss: 0.055 Vali Loss: 4.933 Vali Acc: 0.419 Test Loss: 4.933 Test Acc: 0.419
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.6361119747161865
Epoch: 21, Steps: 10 | Train Loss: 0.145 Vali Loss: 5.725 Vali Acc: 0.459 Test Loss: 5.725 Test Acc: 0.459
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 4409372
model size : 21.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.3747494220733643
Epoch: 1, Steps: 10 | Train Loss: 1.574 Vali Loss: 1.468 Vali Acc: 0.324 Test Loss: 1.468 Test Acc: 0.324
Validation loss decreased (inf --> -0.324310).  Saving model ...
Epoch: 2 cost time: 1.6585838794708252
Epoch: 2, Steps: 10 | Train Loss: 1.583 Vali Loss: 1.537 Vali Acc: 0.432 Test Loss: 1.537 Test Acc: 0.432
Validation loss decreased (-0.324310 --> -0.432417).  Saving model ...
Epoch: 3 cost time: 1.6750035285949707
Epoch: 3, Steps: 10 | Train Loss: 1.221 Vali Loss: 1.469 Vali Acc: 0.459 Test Loss: 1.469 Test Acc: 0.459
Validation loss decreased (-0.432417 --> -0.459445).  Saving model ...
Epoch: 4 cost time: 1.6909871101379395
Epoch: 4, Steps: 10 | Train Loss: 0.990 Vali Loss: 1.472 Vali Acc: 0.432 Test Loss: 1.472 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5733764171600342
Epoch: 5, Steps: 10 | Train Loss: 0.758 Vali Loss: 1.842 Vali Acc: 0.351 Test Loss: 1.842 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8136231899261475
Epoch: 6, Steps: 10 | Train Loss: 0.790 Vali Loss: 1.759 Vali Acc: 0.419 Test Loss: 1.759 Test Acc: 0.419
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5686864852905273
Epoch: 7, Steps: 10 | Train Loss: 0.437 Vali Loss: 2.003 Vali Acc: 0.459 Test Loss: 2.003 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.7634060382843018
Epoch: 8, Steps: 10 | Train Loss: 0.412 Vali Loss: 1.591 Vali Acc: 0.500 Test Loss: 1.591 Test Acc: 0.500
Validation loss decreased (-0.459445 --> -0.499984).  Saving model ...
Epoch: 9 cost time: 1.3959414958953857
Epoch: 9, Steps: 10 | Train Loss: 0.202 Vali Loss: 1.539 Vali Acc: 0.568 Test Loss: 1.539 Test Acc: 0.568
Validation loss decreased (-0.499984 --> -0.567552).  Saving model ...
Epoch: 10 cost time: 1.7697999477386475
Epoch: 10, Steps: 10 | Train Loss: 0.326 Vali Loss: 2.852 Vali Acc: 0.419 Test Loss: 2.852 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5465757846832275
Epoch: 11, Steps: 10 | Train Loss: 0.211 Vali Loss: 2.162 Vali Acc: 0.581 Test Loss: 2.162 Test Acc: 0.581
Validation loss decreased (-0.567552 --> -0.581059).  Saving model ...
Epoch: 12 cost time: 1.7103397846221924
Epoch: 12, Steps: 10 | Train Loss: 0.118 Vali Loss: 2.794 Vali Acc: 0.554 Test Loss: 2.794 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4059810638427734
Epoch: 13, Steps: 10 | Train Loss: 0.105 Vali Loss: 2.729 Vali Acc: 0.473 Test Loss: 2.729 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8604860305786133
Epoch: 14, Steps: 10 | Train Loss: 0.054 Vali Loss: 2.714 Vali Acc: 0.608 Test Loss: 2.714 Test Acc: 0.608
Validation loss decreased (-0.581059 --> -0.608081).  Saving model ...
Epoch: 15 cost time: 0.9752249717712402
Epoch: 15, Steps: 10 | Train Loss: 0.166 Vali Loss: 3.117 Vali Acc: 0.527 Test Loss: 3.117 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7730541229248047
Epoch: 16, Steps: 10 | Train Loss: 0.252 Vali Loss: 4.314 Vali Acc: 0.541 Test Loss: 4.314 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4968721866607666
Epoch: 17, Steps: 10 | Train Loss: 0.250 Vali Loss: 2.977 Vali Acc: 0.581 Test Loss: 2.977 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.4295880794525146
Epoch: 18, Steps: 10 | Train Loss: 0.130 Vali Loss: 3.128 Vali Acc: 0.568 Test Loss: 3.128 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.637474536895752
Epoch: 19, Steps: 10 | Train Loss: 0.218 Vali Loss: 4.283 Vali Acc: 0.676 Test Loss: 4.283 Test Acc: 0.676
Validation loss decreased (-0.608081 --> -0.675633).  Saving model ...
Epoch: 20 cost time: 1.4840977191925049
Epoch: 20, Steps: 10 | Train Loss: 0.234 Vali Loss: 5.215 Vali Acc: 0.527 Test Loss: 5.215 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4210643768310547
Epoch: 21, Steps: 10 | Train Loss: 0.257 Vali Loss: 5.320 Vali Acc: 0.541 Test Loss: 5.320 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.426081895828247
Epoch: 22, Steps: 10 | Train Loss: 0.269 Vali Loss: 5.680 Vali Acc: 0.554 Test Loss: 5.680 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.5156736373901367
Epoch: 23, Steps: 10 | Train Loss: 0.060 Vali Loss: 6.873 Vali Acc: 0.514 Test Loss: 6.873 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.4344470500946045
Epoch: 24, Steps: 10 | Train Loss: 0.113 Vali Loss: 6.820 Vali Acc: 0.527 Test Loss: 6.820 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.5132458209991455
Epoch: 25, Steps: 10 | Train Loss: 0.036 Vali Loss: 6.822 Vali Acc: 0.473 Test Loss: 6.822 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.3888487815856934
Epoch: 26, Steps: 10 | Train Loss: 0.060 Vali Loss: 6.566 Vali Acc: 0.500 Test Loss: 6.566 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.3849906921386719
Epoch: 27, Steps: 10 | Train Loss: 0.033 Vali Loss: 6.441 Vali Acc: 0.527 Test Loss: 6.441 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.5701682567596436
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.480 Vali Acc: 0.541 Test Loss: 6.480 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.6131863594055176
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 6.645 Vali Acc: 0.514 Test Loss: 6.645 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6756756756756757
model parameter : 4041500
model size : 20.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.1707630157470703
Epoch: 1, Steps: 10 | Train Loss: 1.514 Vali Loss: 1.586 Vali Acc: 0.311 Test Loss: 1.586 Test Acc: 0.311
Validation loss decreased (inf --> -0.310795).  Saving model ...
Epoch: 2 cost time: 1.8021914958953857
Epoch: 2, Steps: 10 | Train Loss: 1.868 Vali Loss: 1.670 Vali Acc: 0.243 Test Loss: 1.670 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7515549659729004
Epoch: 3, Steps: 10 | Train Loss: 1.292 Vali Loss: 1.996 Vali Acc: 0.405 Test Loss: 1.996 Test Acc: 0.405
Validation loss decreased (-0.310795 --> -0.405385).  Saving model ...
Epoch: 4 cost time: 1.769258737564087
Epoch: 4, Steps: 10 | Train Loss: 1.259 Vali Loss: 1.528 Vali Acc: 0.527 Test Loss: 1.528 Test Acc: 0.527
Validation loss decreased (-0.405385 --> -0.527012).  Saving model ...
Epoch: 5 cost time: 1.7851908206939697
Epoch: 5, Steps: 10 | Train Loss: 0.634 Vali Loss: 1.440 Vali Acc: 0.432 Test Loss: 1.440 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5968832969665527
Epoch: 6, Steps: 10 | Train Loss: 0.716 Vali Loss: 1.585 Vali Acc: 0.419 Test Loss: 1.585 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2564914226531982
Epoch: 7, Steps: 10 | Train Loss: 0.577 Vali Loss: 1.502 Vali Acc: 0.514 Test Loss: 1.502 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5644829273223877
Epoch: 8, Steps: 10 | Train Loss: 0.215 Vali Loss: 1.839 Vali Acc: 0.514 Test Loss: 1.839 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.8856582641601562
Epoch: 9, Steps: 10 | Train Loss: 0.401 Vali Loss: 2.792 Vali Acc: 0.500 Test Loss: 2.792 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.828078269958496
Epoch: 10, Steps: 10 | Train Loss: 0.413 Vali Loss: 3.046 Vali Acc: 0.527 Test Loss: 3.046 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.7818727493286133
Epoch: 11, Steps: 10 | Train Loss: 0.402 Vali Loss: 2.388 Vali Acc: 0.541 Test Loss: 2.388 Test Acc: 0.541
Validation loss decreased (-0.527012 --> -0.540517).  Saving model ...
Epoch: 12 cost time: 1.8127777576446533
Epoch: 12, Steps: 10 | Train Loss: 0.560 Vali Loss: 5.801 Vali Acc: 0.432 Test Loss: 5.801 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.968442678451538
Epoch: 13, Steps: 10 | Train Loss: 0.404 Vali Loss: 3.696 Vali Acc: 0.554 Test Loss: 3.696 Test Acc: 0.554
Validation loss decreased (-0.540517 --> -0.554017).  Saving model ...
Epoch: 14 cost time: 1.62738037109375
Epoch: 14, Steps: 10 | Train Loss: 0.518 Vali Loss: 4.341 Vali Acc: 0.527 Test Loss: 4.341 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6111962795257568
Epoch: 15, Steps: 10 | Train Loss: 0.325 Vali Loss: 5.429 Vali Acc: 0.446 Test Loss: 5.429 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6194934844970703
Epoch: 16, Steps: 10 | Train Loss: 0.215 Vali Loss: 4.641 Vali Acc: 0.568 Test Loss: 4.641 Test Acc: 0.568
Validation loss decreased (-0.554017 --> -0.567521).  Saving model ...
Epoch: 17 cost time: 1.35444974899292
Epoch: 17, Steps: 10 | Train Loss: 0.068 Vali Loss: 4.847 Vali Acc: 0.514 Test Loss: 4.847 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3459994792938232
Epoch: 18, Steps: 10 | Train Loss: 0.128 Vali Loss: 4.654 Vali Acc: 0.473 Test Loss: 4.654 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.428898811340332
Epoch: 19, Steps: 10 | Train Loss: 0.014 Vali Loss: 6.234 Vali Acc: 0.514 Test Loss: 6.234 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2918832302093506
Epoch: 20, Steps: 10 | Train Loss: 0.012 Vali Loss: 6.509 Vali Acc: 0.486 Test Loss: 6.509 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.555734634399414
Epoch: 21, Steps: 10 | Train Loss: 0.063 Vali Loss: 7.135 Vali Acc: 0.527 Test Loss: 7.135 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.7613754272460938
Epoch: 22, Steps: 10 | Train Loss: 0.261 Vali Loss: 4.651 Vali Acc: 0.473 Test Loss: 4.651 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.7589795589447021
Epoch: 23, Steps: 10 | Train Loss: 0.114 Vali Loss: 4.824 Vali Acc: 0.527 Test Loss: 4.824 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.5873081684112549
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 5.178 Vali Acc: 0.541 Test Loss: 5.178 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.5262212753295898
Epoch: 25, Steps: 10 | Train Loss: 0.025 Vali Loss: 5.398 Vali Acc: 0.568 Test Loss: 5.398 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.489884853363037
Epoch: 26, Steps: 10 | Train Loss: 0.057 Vali Loss: 6.797 Vali Acc: 0.500 Test Loss: 6.797 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 4032796
model size : 20.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.579451322555542
Epoch: 1, Steps: 10 | Train Loss: 1.583 Vali Loss: 1.776 Vali Acc: 0.203 Test Loss: 1.776 Test Acc: 0.203
Validation loss decreased (inf --> -0.202685).  Saving model ...
Epoch: 2 cost time: 1.4785895347595215
Epoch: 2, Steps: 10 | Train Loss: 1.689 Vali Loss: 1.596 Vali Acc: 0.324 Test Loss: 1.596 Test Acc: 0.324
Validation loss decreased (-0.202685 --> -0.324308).  Saving model ...
Epoch: 3 cost time: 1.491680383682251
Epoch: 3, Steps: 10 | Train Loss: 1.268 Vali Loss: 1.335 Vali Acc: 0.324 Test Loss: 1.335 Test Acc: 0.324
Validation loss decreased (-0.324308 --> -0.324311).  Saving model ...
Epoch: 4 cost time: 1.6617152690887451
Epoch: 4, Steps: 10 | Train Loss: 0.896 Vali Loss: 1.771 Vali Acc: 0.419 Test Loss: 1.771 Test Acc: 0.419
Validation loss decreased (-0.324311 --> -0.418901).  Saving model ...
Epoch: 5 cost time: 1.4688787460327148
Epoch: 5, Steps: 10 | Train Loss: 0.756 Vali Loss: 1.301 Vali Acc: 0.514 Test Loss: 1.301 Test Acc: 0.514
Validation loss decreased (-0.418901 --> -0.513501).  Saving model ...
Epoch: 6 cost time: 1.3756766319274902
Epoch: 6, Steps: 10 | Train Loss: 0.439 Vali Loss: 1.879 Vali Acc: 0.419 Test Loss: 1.879 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7426245212554932
Epoch: 7, Steps: 10 | Train Loss: 0.576 Vali Loss: 2.640 Vali Acc: 0.324 Test Loss: 2.640 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5326738357543945
Epoch: 8, Steps: 10 | Train Loss: 0.644 Vali Loss: 2.961 Vali Acc: 0.473 Test Loss: 2.961 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.5593523979187012
Epoch: 9, Steps: 10 | Train Loss: 0.617 Vali Loss: 2.055 Vali Acc: 0.527 Test Loss: 2.055 Test Acc: 0.527
Validation loss decreased (-0.513501 --> -0.527006).  Saving model ...
Epoch: 10 cost time: 1.218543291091919
Epoch: 10, Steps: 10 | Train Loss: 0.217 Vali Loss: 2.981 Vali Acc: 0.432 Test Loss: 2.981 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8091583251953125
Epoch: 11, Steps: 10 | Train Loss: 0.136 Vali Loss: 2.180 Vali Acc: 0.568 Test Loss: 2.180 Test Acc: 0.568
Validation loss decreased (-0.527006 --> -0.567546).  Saving model ...
Epoch: 12 cost time: 1.6505646705627441
Epoch: 12, Steps: 10 | Train Loss: 0.096 Vali Loss: 2.671 Vali Acc: 0.473 Test Loss: 2.671 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5391454696655273
Epoch: 13, Steps: 10 | Train Loss: 0.036 Vali Loss: 2.720 Vali Acc: 0.514 Test Loss: 2.720 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.562943458557129
Epoch: 14, Steps: 10 | Train Loss: 0.076 Vali Loss: 2.566 Vali Acc: 0.514 Test Loss: 2.566 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.4555320739746094
Epoch: 15, Steps: 10 | Train Loss: 0.110 Vali Loss: 2.988 Vali Acc: 0.514 Test Loss: 2.988 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.5380818843841553
Epoch: 16, Steps: 10 | Train Loss: 0.310 Vali Loss: 4.774 Vali Acc: 0.419 Test Loss: 4.774 Test Acc: 0.419
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.8637702465057373
Epoch: 17, Steps: 10 | Train Loss: 0.166 Vali Loss: 4.165 Vali Acc: 0.541 Test Loss: 4.165 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.6927828788757324
Epoch: 18, Steps: 10 | Train Loss: 0.326 Vali Loss: 4.859 Vali Acc: 0.419 Test Loss: 4.859 Test Acc: 0.419
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.5180697441101074
Epoch: 19, Steps: 10 | Train Loss: 0.071 Vali Loss: 3.664 Vali Acc: 0.568 Test Loss: 3.664 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.9659264087677002
Epoch: 20, Steps: 10 | Train Loss: 0.070 Vali Loss: 4.013 Vali Acc: 0.581 Test Loss: 4.013 Test Acc: 0.581
Validation loss decreased (-0.567546 --> -0.581041).  Saving model ...
Epoch: 21 cost time: 1.5679049491882324
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.523 Vali Acc: 0.554 Test Loss: 4.523 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4295835494995117
Epoch: 22, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.881 Vali Acc: 0.541 Test Loss: 4.881 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.6361184120178223
Epoch: 23, Steps: 10 | Train Loss: 0.064 Vali Loss: 5.812 Vali Acc: 0.527 Test Loss: 5.812 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.6768224239349365
Epoch: 24, Steps: 10 | Train Loss: 0.024 Vali Loss: 7.105 Vali Acc: 0.473 Test Loss: 7.105 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.8997528553009033
Epoch: 25, Steps: 10 | Train Loss: 0.087 Vali Loss: 6.951 Vali Acc: 0.486 Test Loss: 6.951 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.8096961975097656
Epoch: 26, Steps: 10 | Train Loss: 0.071 Vali Loss: 6.634 Vali Acc: 0.500 Test Loss: 6.634 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.8225901126861572
Epoch: 27, Steps: 10 | Train Loss: 0.109 Vali Loss: 8.193 Vali Acc: 0.486 Test Loss: 8.193 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.0301878452301025
Epoch: 28, Steps: 10 | Train Loss: 0.067 Vali Loss: 6.518 Vali Acc: 0.568 Test Loss: 6.518 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.7044975757598877
Epoch: 29, Steps: 10 | Train Loss: 0.056 Vali Loss: 8.413 Vali Acc: 0.459 Test Loss: 8.413 Test Acc: 0.459
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.7523720264434814
Epoch: 30, Steps: 10 | Train Loss: 0.155 Vali Loss: 6.558 Vali Acc: 0.486 Test Loss: 6.558 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 4024092
model size : 20.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.867107629776001
Epoch: 1, Steps: 10 | Train Loss: 1.592 Vali Loss: 1.427 Vali Acc: 0.216 Test Loss: 1.427 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 1.8520629405975342
Epoch: 2, Steps: 10 | Train Loss: 1.530 Vali Loss: 1.910 Vali Acc: 0.392 Test Loss: 1.910 Test Acc: 0.392
Validation loss decreased (-0.216202 --> -0.391873).  Saving model ...
Epoch: 3 cost time: 1.9629762172698975
Epoch: 3, Steps: 10 | Train Loss: 1.390 Vali Loss: 1.141 Vali Acc: 0.514 Test Loss: 1.141 Test Acc: 0.514
Validation loss decreased (-0.391873 --> -0.513502).  Saving model ...
Epoch: 4 cost time: 1.6562979221343994
Epoch: 4, Steps: 10 | Train Loss: 1.029 Vali Loss: 1.561 Vali Acc: 0.446 Test Loss: 1.561 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7383742332458496
Epoch: 5, Steps: 10 | Train Loss: 0.690 Vali Loss: 1.146 Vali Acc: 0.554 Test Loss: 1.146 Test Acc: 0.554
Validation loss decreased (-0.513502 --> -0.554043).  Saving model ...
Epoch: 6 cost time: 1.7554945945739746
Epoch: 6, Steps: 10 | Train Loss: 0.565 Vali Loss: 1.143 Vali Acc: 0.554 Test Loss: 1.143 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554043).  Saving model ...
Epoch: 7 cost time: 1.61610746383667
Epoch: 7, Steps: 10 | Train Loss: 0.316 Vali Loss: 2.371 Vali Acc: 0.405 Test Loss: 2.371 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8000726699829102
Epoch: 8, Steps: 10 | Train Loss: 0.268 Vali Loss: 1.510 Vali Acc: 0.514 Test Loss: 1.510 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8700382709503174
Epoch: 9, Steps: 10 | Train Loss: 0.233 Vali Loss: 1.648 Vali Acc: 0.568 Test Loss: 1.648 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567551).  Saving model ...
Epoch: 10 cost time: 1.8925957679748535
Epoch: 10, Steps: 10 | Train Loss: 0.318 Vali Loss: 2.776 Vali Acc: 0.473 Test Loss: 2.776 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4870471954345703
Epoch: 11, Steps: 10 | Train Loss: 0.156 Vali Loss: 3.167 Vali Acc: 0.459 Test Loss: 3.167 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7727570533752441
Epoch: 12, Steps: 10 | Train Loss: 0.166 Vali Loss: 4.465 Vali Acc: 0.405 Test Loss: 4.465 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.959810733795166
Epoch: 13, Steps: 10 | Train Loss: 0.158 Vali Loss: 2.782 Vali Acc: 0.514 Test Loss: 2.782 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.5120506286621094
Epoch: 14, Steps: 10 | Train Loss: 0.095 Vali Loss: 2.975 Vali Acc: 0.500 Test Loss: 2.975 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.1795895099639893
Epoch: 15, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.173 Vali Acc: 0.527 Test Loss: 3.173 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.9195561408996582
Epoch: 16, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.180 Vali Acc: 0.527 Test Loss: 3.180 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.068942070007324
Epoch: 17, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.089 Vali Acc: 0.500 Test Loss: 4.089 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.9658854007720947
Epoch: 18, Steps: 10 | Train Loss: 0.100 Vali Loss: 4.305 Vali Acc: 0.514 Test Loss: 4.305 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.9464471340179443
Epoch: 19, Steps: 10 | Train Loss: 0.071 Vali Loss: 5.345 Vali Acc: 0.459 Test Loss: 5.345 Test Acc: 0.459
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 4015388
model size : 20.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.168889284133911
Epoch: 1, Steps: 10 | Train Loss: 1.651 Vali Loss: 1.344 Vali Acc: 0.446 Test Loss: 1.344 Test Acc: 0.446
Validation loss decreased (inf --> -0.445933).  Saving model ...
Epoch: 2 cost time: 2.167870044708252
Epoch: 2, Steps: 10 | Train Loss: 1.764 Vali Loss: 1.400 Vali Acc: 0.378 Test Loss: 1.400 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.1536600589752197
Epoch: 3, Steps: 10 | Train Loss: 1.417 Vali Loss: 1.388 Vali Acc: 0.446 Test Loss: 1.388 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4594695568084717
Epoch: 4, Steps: 10 | Train Loss: 0.895 Vali Loss: 1.093 Vali Acc: 0.514 Test Loss: 1.093 Test Acc: 0.514
Validation loss decreased (-0.445933 --> -0.513503).  Saving model ...
Epoch: 5 cost time: 1.7041857242584229
Epoch: 5, Steps: 10 | Train Loss: 0.557 Vali Loss: 1.373 Vali Acc: 0.473 Test Loss: 1.373 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2212612628936768
Epoch: 6, Steps: 10 | Train Loss: 0.608 Vali Loss: 1.477 Vali Acc: 0.527 Test Loss: 1.477 Test Acc: 0.527
Validation loss decreased (-0.513503 --> -0.527012).  Saving model ...
Epoch: 7 cost time: 1.580054521560669
Epoch: 7, Steps: 10 | Train Loss: 0.334 Vali Loss: 1.780 Vali Acc: 0.500 Test Loss: 1.780 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.488905668258667
Epoch: 8, Steps: 10 | Train Loss: 0.345 Vali Loss: 1.640 Vali Acc: 0.459 Test Loss: 1.640 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.286283254623413
Epoch: 9, Steps: 10 | Train Loss: 0.511 Vali Loss: 3.301 Vali Acc: 0.311 Test Loss: 3.301 Test Acc: 0.311
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.6116282939910889
Epoch: 10, Steps: 10 | Train Loss: 0.228 Vali Loss: 2.225 Vali Acc: 0.554 Test Loss: 2.225 Test Acc: 0.554
Validation loss decreased (-0.527012 --> -0.554032).  Saving model ...
Epoch: 11 cost time: 1.2517635822296143
Epoch: 11, Steps: 10 | Train Loss: 0.117 Vali Loss: 2.508 Vali Acc: 0.527 Test Loss: 2.508 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2588307857513428
Epoch: 12, Steps: 10 | Train Loss: 0.410 Vali Loss: 2.438 Vali Acc: 0.554 Test Loss: 2.438 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.318589210510254
Epoch: 13, Steps: 10 | Train Loss: 0.155 Vali Loss: 2.782 Vali Acc: 0.622 Test Loss: 2.782 Test Acc: 0.622
Validation loss decreased (-0.554032 --> -0.621594).  Saving model ...
Epoch: 14 cost time: 1.4003632068634033
Epoch: 14, Steps: 10 | Train Loss: 0.491 Vali Loss: 3.010 Vali Acc: 0.514 Test Loss: 3.010 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6066827774047852
Epoch: 15, Steps: 10 | Train Loss: 0.283 Vali Loss: 5.052 Vali Acc: 0.459 Test Loss: 5.052 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5586647987365723
Epoch: 16, Steps: 10 | Train Loss: 0.195 Vali Loss: 3.922 Vali Acc: 0.541 Test Loss: 3.922 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.7217230796813965
Epoch: 17, Steps: 10 | Train Loss: 0.127 Vali Loss: 4.862 Vali Acc: 0.514 Test Loss: 4.862 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.9747488498687744
Epoch: 18, Steps: 10 | Train Loss: 0.325 Vali Loss: 6.459 Vali Acc: 0.419 Test Loss: 6.459 Test Acc: 0.419
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.0612077713012695
Epoch: 19, Steps: 10 | Train Loss: 0.148 Vali Loss: 4.902 Vali Acc: 0.554 Test Loss: 4.902 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.3977243900299072
Epoch: 20, Steps: 10 | Train Loss: 0.090 Vali Loss: 6.592 Vali Acc: 0.500 Test Loss: 6.592 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.9828987121582031
Epoch: 21, Steps: 10 | Train Loss: 0.160 Vali Loss: 4.373 Vali Acc: 0.554 Test Loss: 4.373 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.143383026123047
Epoch: 22, Steps: 10 | Train Loss: 0.127 Vali Loss: 5.967 Vali Acc: 0.500 Test Loss: 5.967 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.5434205532073975
Epoch: 23, Steps: 10 | Train Loss: 0.057 Vali Loss: 4.959 Vali Acc: 0.486 Test Loss: 4.959 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 3844508
model size : 19.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.237799167633057
Epoch: 1, Steps: 10 | Train Loss: 1.468 Vali Loss: 1.444 Vali Acc: 0.243 Test Loss: 1.444 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 1.6740598678588867
Epoch: 2, Steps: 10 | Train Loss: 1.393 Vali Loss: 1.582 Vali Acc: 0.324 Test Loss: 1.582 Test Acc: 0.324
Validation loss decreased (-0.243229 --> -0.324309).  Saving model ...
Epoch: 3 cost time: 1.4010584354400635
Epoch: 3, Steps: 10 | Train Loss: 0.993 Vali Loss: 1.417 Vali Acc: 0.351 Test Loss: 1.417 Test Acc: 0.351
Validation loss decreased (-0.324309 --> -0.351337).  Saving model ...
Epoch: 4 cost time: 1.7753427028656006
Epoch: 4, Steps: 10 | Train Loss: 0.840 Vali Loss: 1.244 Vali Acc: 0.473 Test Loss: 1.244 Test Acc: 0.473
Validation loss decreased (-0.351337 --> -0.472961).  Saving model ...
Epoch: 5 cost time: 1.6735146045684814
Epoch: 5, Steps: 10 | Train Loss: 0.614 Vali Loss: 1.209 Vali Acc: 0.500 Test Loss: 1.209 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 1.576864242553711
Epoch: 6, Steps: 10 | Train Loss: 0.491 Vali Loss: 1.926 Vali Acc: 0.446 Test Loss: 1.926 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8359601497650146
Epoch: 7, Steps: 10 | Train Loss: 0.610 Vali Loss: 1.709 Vali Acc: 0.473 Test Loss: 1.709 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8013088703155518
Epoch: 8, Steps: 10 | Train Loss: 0.320 Vali Loss: 1.472 Vali Acc: 0.554 Test Loss: 1.472 Test Acc: 0.554
Validation loss decreased (-0.499988 --> -0.554039).  Saving model ...
Epoch: 9 cost time: 1.8065733909606934
Epoch: 9, Steps: 10 | Train Loss: 0.255 Vali Loss: 2.257 Vali Acc: 0.500 Test Loss: 2.257 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.933283805847168
Epoch: 10, Steps: 10 | Train Loss: 0.336 Vali Loss: 2.144 Vali Acc: 0.459 Test Loss: 2.144 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6197540760040283
Epoch: 11, Steps: 10 | Train Loss: 0.124 Vali Loss: 2.489 Vali Acc: 0.500 Test Loss: 2.489 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.6452479362487793
Epoch: 12, Steps: 10 | Train Loss: 0.155 Vali Loss: 3.060 Vali Acc: 0.500 Test Loss: 3.060 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.828681468963623
Epoch: 13, Steps: 10 | Train Loss: 0.213 Vali Loss: 3.353 Vali Acc: 0.473 Test Loss: 3.353 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.125462055206299
Epoch: 14, Steps: 10 | Train Loss: 0.406 Vali Loss: 3.066 Vali Acc: 0.554 Test Loss: 3.066 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2359998226165771
Epoch: 15, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.468 Vali Acc: 0.486 Test Loss: 3.468 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.9538211822509766
Epoch: 16, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.027 Vali Acc: 0.500 Test Loss: 4.027 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.045745849609375
Epoch: 17, Steps: 10 | Train Loss: 0.124 Vali Loss: 4.318 Vali Acc: 0.514 Test Loss: 4.318 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.0041606426239014
Epoch: 18, Steps: 10 | Train Loss: 0.123 Vali Loss: 4.309 Vali Acc: 0.568 Test Loss: 4.309 Test Acc: 0.568
Validation loss decreased (-0.554039 --> -0.567524).  Saving model ...
Epoch: 19 cost time: 2.054957866668701
Epoch: 19, Steps: 10 | Train Loss: 0.156 Vali Loss: 3.918 Vali Acc: 0.500 Test Loss: 3.918 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.0374763011932373
Epoch: 20, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.783 Vali Acc: 0.486 Test Loss: 4.783 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.6429510116577148
Epoch: 21, Steps: 10 | Train Loss: 0.073 Vali Loss: 4.229 Vali Acc: 0.554 Test Loss: 4.229 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.154827117919922
Epoch: 22, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.655 Vali Acc: 0.554 Test Loss: 3.655 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.8104524612426758
Epoch: 23, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.365 Vali Acc: 0.486 Test Loss: 4.365 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.859006643295288
Epoch: 24, Steps: 10 | Train Loss: 0.054 Vali Loss: 4.352 Vali Acc: 0.486 Test Loss: 4.352 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.2038862705230713
Epoch: 25, Steps: 10 | Train Loss: 0.125 Vali Loss: 5.589 Vali Acc: 0.541 Test Loss: 5.589 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.808049201965332
Epoch: 26, Steps: 10 | Train Loss: 0.037 Vali Loss: 6.034 Vali Acc: 0.473 Test Loss: 6.034 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.4642951488494873
Epoch: 27, Steps: 10 | Train Loss: 0.254 Vali Loss: 5.629 Vali Acc: 0.500 Test Loss: 5.629 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.4487228393554688
Epoch: 28, Steps: 10 | Train Loss: 0.057 Vali Loss: 5.686 Vali Acc: 0.500 Test Loss: 5.686 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 3835804
model size : 19.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.390192747116089
Epoch: 1, Steps: 10 | Train Loss: 1.610 Vali Loss: 1.348 Vali Acc: 0.432 Test Loss: 1.348 Test Acc: 0.432
Validation loss decreased (inf --> -0.432419).  Saving model ...
Epoch: 2 cost time: 1.9692237377166748
Epoch: 2, Steps: 10 | Train Loss: 1.490 Vali Loss: 1.691 Vali Acc: 0.297 Test Loss: 1.691 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9276554584503174
Epoch: 3, Steps: 10 | Train Loss: 1.232 Vali Loss: 1.630 Vali Acc: 0.270 Test Loss: 1.630 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7942328453063965
Epoch: 4, Steps: 10 | Train Loss: 0.896 Vali Loss: 2.444 Vali Acc: 0.284 Test Loss: 2.444 Test Acc: 0.284
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.0526442527770996
Epoch: 5, Steps: 10 | Train Loss: 0.874 Vali Loss: 1.594 Vali Acc: 0.446 Test Loss: 1.594 Test Acc: 0.446
Validation loss decreased (-0.432419 --> -0.445930).  Saving model ...
Epoch: 6 cost time: 1.7592990398406982
Epoch: 6, Steps: 10 | Train Loss: 0.494 Vali Loss: 1.520 Vali Acc: 0.527 Test Loss: 1.520 Test Acc: 0.527
Validation loss decreased (-0.445930 --> -0.527012).  Saving model ...
Epoch: 7 cost time: 1.5674107074737549
Epoch: 7, Steps: 10 | Train Loss: 0.445 Vali Loss: 2.546 Vali Acc: 0.419 Test Loss: 2.546 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7872545719146729
Epoch: 8, Steps: 10 | Train Loss: 0.721 Vali Loss: 2.416 Vali Acc: 0.500 Test Loss: 2.416 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.791618824005127
Epoch: 9, Steps: 10 | Train Loss: 0.445 Vali Loss: 2.070 Vali Acc: 0.527 Test Loss: 2.070 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5706226825714111
Epoch: 10, Steps: 10 | Train Loss: 0.207 Vali Loss: 2.132 Vali Acc: 0.486 Test Loss: 2.132 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.8598897457122803
Epoch: 11, Steps: 10 | Train Loss: 0.385 Vali Loss: 3.136 Vali Acc: 0.459 Test Loss: 3.136 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.835050106048584
Epoch: 12, Steps: 10 | Train Loss: 0.420 Vali Loss: 2.364 Vali Acc: 0.541 Test Loss: 2.364 Test Acc: 0.541
Validation loss decreased (-0.527012 --> -0.540517).  Saving model ...
Epoch: 13 cost time: 1.7258639335632324
Epoch: 13, Steps: 10 | Train Loss: 0.108 Vali Loss: 3.116 Vali Acc: 0.568 Test Loss: 3.116 Test Acc: 0.568
Validation loss decreased (-0.540517 --> -0.567536).  Saving model ...
Epoch: 14 cost time: 1.4919095039367676
Epoch: 14, Steps: 10 | Train Loss: 0.246 Vali Loss: 3.468 Vali Acc: 0.541 Test Loss: 3.468 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.0022106170654297
Epoch: 15, Steps: 10 | Train Loss: 0.136 Vali Loss: 3.128 Vali Acc: 0.554 Test Loss: 3.128 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.8271207809448242
Epoch: 16, Steps: 10 | Train Loss: 0.132 Vali Loss: 3.586 Vali Acc: 0.500 Test Loss: 3.586 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.1829209327697754
Epoch: 17, Steps: 10 | Train Loss: 0.106 Vali Loss: 3.960 Vali Acc: 0.514 Test Loss: 3.960 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.5926332473754883
Epoch: 18, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.612 Vali Acc: 0.459 Test Loss: 4.612 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.023799180984497
Epoch: 19, Steps: 10 | Train Loss: 0.144 Vali Loss: 4.474 Vali Acc: 0.527 Test Loss: 4.474 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.9742884635925293
Epoch: 20, Steps: 10 | Train Loss: 0.106 Vali Loss: 4.065 Vali Acc: 0.568 Test Loss: 4.065 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.5623528957366943
Epoch: 21, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.543 Vali Acc: 0.514 Test Loss: 4.543 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.7881669998168945
Epoch: 22, Steps: 10 | Train Loss: 0.149 Vali Loss: 5.984 Vali Acc: 0.473 Test Loss: 5.984 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.00890851020813
Epoch: 23, Steps: 10 | Train Loss: 0.219 Vali Loss: 8.782 Vali Acc: 0.405 Test Loss: 8.782 Test Acc: 0.405
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 3827100
model size : 19.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.099995851516724
Epoch: 1, Steps: 10 | Train Loss: 1.631 Vali Loss: 1.458 Vali Acc: 0.311 Test Loss: 1.458 Test Acc: 0.311
Validation loss decreased (inf --> -0.310796).  Saving model ...
Epoch: 2 cost time: 1.6462748050689697
Epoch: 2, Steps: 10 | Train Loss: 1.495 Vali Loss: 1.680 Vali Acc: 0.311 Test Loss: 1.680 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.108156681060791
Epoch: 3, Steps: 10 | Train Loss: 1.173 Vali Loss: 1.341 Vali Acc: 0.514 Test Loss: 1.341 Test Acc: 0.514
Validation loss decreased (-0.310796 --> -0.513500).  Saving model ...
Epoch: 4 cost time: 1.2225978374481201
Epoch: 4, Steps: 10 | Train Loss: 0.768 Vali Loss: 1.790 Vali Acc: 0.324 Test Loss: 1.790 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6519238948822021
Epoch: 5, Steps: 10 | Train Loss: 0.690 Vali Loss: 1.411 Vali Acc: 0.500 Test Loss: 1.411 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5068895816802979
Epoch: 6, Steps: 10 | Train Loss: 0.412 Vali Loss: 2.021 Vali Acc: 0.405 Test Loss: 2.021 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3536858558654785
Epoch: 7, Steps: 10 | Train Loss: 0.398 Vali Loss: 1.238 Vali Acc: 0.595 Test Loss: 1.238 Test Acc: 0.595
Validation loss decreased (-0.513500 --> -0.594582).  Saving model ...
Epoch: 8 cost time: 1.6935925483703613
Epoch: 8, Steps: 10 | Train Loss: 0.369 Vali Loss: 1.717 Vali Acc: 0.514 Test Loss: 1.717 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6341040134429932
Epoch: 9, Steps: 10 | Train Loss: 0.194 Vali Loss: 1.772 Vali Acc: 0.568 Test Loss: 1.772 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6670451164245605
Epoch: 10, Steps: 10 | Train Loss: 0.123 Vali Loss: 2.278 Vali Acc: 0.486 Test Loss: 2.278 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.5889654159545898
Epoch: 11, Steps: 10 | Train Loss: 0.251 Vali Loss: 2.344 Vali Acc: 0.514 Test Loss: 2.344 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.6819970607757568
Epoch: 12, Steps: 10 | Train Loss: 0.284 Vali Loss: 4.915 Vali Acc: 0.351 Test Loss: 4.915 Test Acc: 0.351
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.6879608631134033
Epoch: 13, Steps: 10 | Train Loss: 0.315 Vali Loss: 3.242 Vali Acc: 0.473 Test Loss: 3.242 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.9241011142730713
Epoch: 14, Steps: 10 | Train Loss: 0.083 Vali Loss: 2.942 Vali Acc: 0.500 Test Loss: 2.942 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.5219426155090332
Epoch: 15, Steps: 10 | Train Loss: 0.216 Vali Loss: 2.747 Vali Acc: 0.527 Test Loss: 2.747 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.3593580722808838
Epoch: 16, Steps: 10 | Train Loss: 0.025 Vali Loss: 5.097 Vali Acc: 0.446 Test Loss: 5.097 Test Acc: 0.446
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.7080025672912598
Epoch: 17, Steps: 10 | Train Loss: 0.147 Vali Loss: 3.537 Vali Acc: 0.554 Test Loss: 3.537 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 3818396
model size : 19.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.073241710662842
Epoch: 1, Steps: 10 | Train Loss: 1.426 Vali Loss: 1.560 Vali Acc: 0.203 Test Loss: 1.560 Test Acc: 0.203
Validation loss decreased (inf --> -0.202687).  Saving model ...
Epoch: 2 cost time: 1.9062974452972412
Epoch: 2, Steps: 10 | Train Loss: 1.455 Vali Loss: 1.425 Vali Acc: 0.257 Test Loss: 1.425 Test Acc: 0.257
Validation loss decreased (-0.202687 --> -0.256743).  Saving model ...
Epoch: 3 cost time: 1.5436608791351318
Epoch: 3, Steps: 10 | Train Loss: 1.303 Vali Loss: 1.572 Vali Acc: 0.203 Test Loss: 1.572 Test Acc: 0.203
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4767107963562012
Epoch: 4, Steps: 10 | Train Loss: 0.953 Vali Loss: 1.254 Vali Acc: 0.446 Test Loss: 1.254 Test Acc: 0.446
Validation loss decreased (-0.256743 --> -0.445933).  Saving model ...
Epoch: 5 cost time: 2.063488483428955
Epoch: 5, Steps: 10 | Train Loss: 0.845 Vali Loss: 1.148 Vali Acc: 0.500 Test Loss: 1.148 Test Acc: 0.500
Validation loss decreased (-0.445933 --> -0.499989).  Saving model ...
Epoch: 6 cost time: 1.578413724899292
Epoch: 6, Steps: 10 | Train Loss: 0.709 Vali Loss: 1.492 Vali Acc: 0.392 Test Loss: 1.492 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5442163944244385
Epoch: 7, Steps: 10 | Train Loss: 0.565 Vali Loss: 1.274 Vali Acc: 0.595 Test Loss: 1.274 Test Acc: 0.595
Validation loss decreased (-0.499989 --> -0.594582).  Saving model ...
Epoch: 8 cost time: 2.164884328842163
Epoch: 8, Steps: 10 | Train Loss: 0.376 Vali Loss: 1.256 Vali Acc: 0.486 Test Loss: 1.256 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.96075439453125
Epoch: 9, Steps: 10 | Train Loss: 0.211 Vali Loss: 1.334 Vali Acc: 0.500 Test Loss: 1.334 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8753399848937988
Epoch: 10, Steps: 10 | Train Loss: 0.143 Vali Loss: 1.780 Vali Acc: 0.486 Test Loss: 1.780 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.014676094055176
Epoch: 11, Steps: 10 | Train Loss: 0.093 Vali Loss: 2.260 Vali Acc: 0.459 Test Loss: 2.260 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.6665382385253906
Epoch: 12, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.856 Vali Acc: 0.554 Test Loss: 1.856 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.518364667892456
Epoch: 13, Steps: 10 | Train Loss: 0.044 Vali Loss: 2.508 Vali Acc: 0.527 Test Loss: 2.508 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.140613317489624
Epoch: 14, Steps: 10 | Train Loss: 0.059 Vali Loss: 2.574 Vali Acc: 0.500 Test Loss: 2.574 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.4389359951019287
Epoch: 15, Steps: 10 | Train Loss: 0.072 Vali Loss: 2.298 Vali Acc: 0.554 Test Loss: 2.298 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.310279607772827
Epoch: 16, Steps: 10 | Train Loss: 0.113 Vali Loss: 2.837 Vali Acc: 0.459 Test Loss: 2.837 Test Acc: 0.459
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.0018301010131836
Epoch: 17, Steps: 10 | Train Loss: 0.017 Vali Loss: 2.700 Vali Acc: 0.527 Test Loss: 2.700 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 1826844
model size : 9.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.4473557472229
Epoch: 1, Steps: 10 | Train Loss: 1.464 Vali Loss: 1.465 Vali Acc: 0.297 Test Loss: 1.465 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 2.033573627471924
Epoch: 2, Steps: 10 | Train Loss: 1.279 Vali Loss: 1.981 Vali Acc: 0.270 Test Loss: 1.981 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8149316310882568
Epoch: 3, Steps: 10 | Train Loss: 1.301 Vali Loss: 1.479 Vali Acc: 0.338 Test Loss: 1.479 Test Acc: 0.338
Validation loss decreased (-0.297283 --> -0.337823).  Saving model ...
Epoch: 4 cost time: 1.5216238498687744
Epoch: 4, Steps: 10 | Train Loss: 0.943 Vali Loss: 1.140 Vali Acc: 0.514 Test Loss: 1.140 Test Acc: 0.514
Validation loss decreased (-0.337823 --> -0.513502).  Saving model ...
Epoch: 5 cost time: 1.855032205581665
Epoch: 5, Steps: 10 | Train Loss: 0.837 Vali Loss: 1.135 Vali Acc: 0.500 Test Loss: 1.135 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7219502925872803
Epoch: 6, Steps: 10 | Train Loss: 0.572 Vali Loss: 1.248 Vali Acc: 0.446 Test Loss: 1.248 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.1800386905670166
Epoch: 7, Steps: 10 | Train Loss: 0.354 Vali Loss: 1.500 Vali Acc: 0.419 Test Loss: 1.500 Test Acc: 0.419
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.094456672668457
Epoch: 8, Steps: 10 | Train Loss: 0.247 Vali Loss: 1.280 Vali Acc: 0.527 Test Loss: 1.280 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527014).  Saving model ...
Epoch: 9 cost time: 1.7148866653442383
Epoch: 9, Steps: 10 | Train Loss: 0.144 Vali Loss: 1.326 Vali Acc: 0.527 Test Loss: 1.326 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.2910542488098145
Epoch: 10, Steps: 10 | Train Loss: 0.198 Vali Loss: 1.285 Vali Acc: 0.541 Test Loss: 1.285 Test Acc: 0.541
Validation loss decreased (-0.527014 --> -0.540528).  Saving model ...
Epoch: 11 cost time: 1.8940098285675049
Epoch: 11, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.946 Vali Acc: 0.554 Test Loss: 1.946 Test Acc: 0.554
Validation loss decreased (-0.540528 --> -0.554035).  Saving model ...
Epoch: 12 cost time: 1.6105337142944336
Epoch: 12, Steps: 10 | Train Loss: 0.104 Vali Loss: 2.171 Vali Acc: 0.473 Test Loss: 2.171 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9323210716247559
Epoch: 13, Steps: 10 | Train Loss: 0.067 Vali Loss: 2.016 Vali Acc: 0.500 Test Loss: 2.016 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.235743761062622
Epoch: 14, Steps: 10 | Train Loss: 0.024 Vali Loss: 2.452 Vali Acc: 0.514 Test Loss: 2.452 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6047534942626953
Epoch: 15, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.972 Vali Acc: 0.541 Test Loss: 1.972 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.5276124477386475
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 2.091 Vali Acc: 0.527 Test Loss: 2.091 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.54823899269104
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.034 Vali Acc: 0.608 Test Loss: 2.034 Test Acc: 0.608
Validation loss decreased (-0.554035 --> -0.608088).  Saving model ...
Epoch: 18 cost time: 1.5997369289398193
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.022 Vali Acc: 0.595 Test Loss: 2.022 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7108068466186523
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.981 Vali Acc: 0.541 Test Loss: 1.981 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.707066297531128
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.026 Vali Acc: 0.608 Test Loss: 2.026 Test Acc: 0.608
Validation loss decreased (-0.608088 --> -0.608088).  Saving model ...
Epoch: 21 cost time: 1.3749446868896484
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.128 Vali Acc: 0.608 Test Loss: 2.128 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.1365957260131836
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.019 Vali Acc: 0.568 Test Loss: 2.019 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.3435544967651367
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.973 Vali Acc: 0.581 Test Loss: 1.973 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.3973338603973389
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.979 Vali Acc: 0.608 Test Loss: 1.979 Test Acc: 0.608
Validation loss decreased (-0.608088 --> -0.608088).  Saving model ...
Epoch: 25 cost time: 2.040501356124878
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.003 Vali Acc: 0.622 Test Loss: 2.003 Test Acc: 0.622
Validation loss decreased (-0.608088 --> -0.621602).  Saving model ...
Epoch: 26 cost time: 1.7721459865570068
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.022 Vali Acc: 0.622 Test Loss: 2.022 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.9548001289367676
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.012 Vali Acc: 0.595 Test Loss: 2.012 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.4013526439666748
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.001 Vali Acc: 0.608 Test Loss: 2.001 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.729766607284546
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.996 Vali Acc: 0.622 Test Loss: 1.996 Test Acc: 0.622
Validation loss decreased (-0.621602 --> -0.621602).  Saving model ...
Epoch: 30 cost time: 1.7509887218475342
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.007 Vali Acc: 0.608 Test Loss: 2.007 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.9496357440948486
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.018 Vali Acc: 0.608 Test Loss: 2.018 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.074489116668701
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.024 Vali Acc: 0.581 Test Loss: 2.024 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.2864840030670166
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.021 Vali Acc: 0.595 Test Loss: 2.021 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.7903997898101807
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.015 Vali Acc: 0.595 Test Loss: 2.015 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.8724141120910645
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.015 Vali Acc: 0.608 Test Loss: 2.015 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 2.0582611560821533
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.023 Vali Acc: 0.595 Test Loss: 2.023 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.4214262962341309
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.025 Vali Acc: 0.581 Test Loss: 2.025 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 2.033517360687256
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.030 Vali Acc: 0.581 Test Loss: 2.030 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.775343418121338
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.032 Vali Acc: 0.581 Test Loss: 2.032 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 1822492
model size : 9.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.7142202854156494
Epoch: 1, Steps: 10 | Train Loss: 1.450 Vali Loss: 1.444 Vali Acc: 0.311 Test Loss: 1.444 Test Acc: 0.311
Validation loss decreased (inf --> -0.310796).  Saving model ...
Epoch: 2 cost time: 1.8751966953277588
Epoch: 2, Steps: 10 | Train Loss: 1.319 Vali Loss: 1.277 Vali Acc: 0.432 Test Loss: 1.277 Test Acc: 0.432
Validation loss decreased (-0.310796 --> -0.432420).  Saving model ...
Epoch: 3 cost time: 1.6948981285095215
Epoch: 3, Steps: 10 | Train Loss: 1.089 Vali Loss: 1.563 Vali Acc: 0.243 Test Loss: 1.563 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7371909618377686
Epoch: 4, Steps: 10 | Train Loss: 0.887 Vali Loss: 1.662 Vali Acc: 0.284 Test Loss: 1.662 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9220983982086182
Epoch: 5, Steps: 10 | Train Loss: 0.674 Vali Loss: 1.200 Vali Acc: 0.486 Test Loss: 1.200 Test Acc: 0.486
Validation loss decreased (-0.432420 --> -0.486474).  Saving model ...
Epoch: 6 cost time: 1.3394901752471924
Epoch: 6, Steps: 10 | Train Loss: 0.517 Vali Loss: 1.151 Vali Acc: 0.527 Test Loss: 1.151 Test Acc: 0.527
Validation loss decreased (-0.486474 --> -0.527016).  Saving model ...
Epoch: 7 cost time: 1.6600837707519531
Epoch: 7, Steps: 10 | Train Loss: 0.420 Vali Loss: 1.326 Vali Acc: 0.500 Test Loss: 1.326 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0867433547973633
Epoch: 8, Steps: 10 | Train Loss: 0.253 Vali Loss: 1.301 Vali Acc: 0.581 Test Loss: 1.301 Test Acc: 0.581
Validation loss decreased (-0.527016 --> -0.581068).  Saving model ...
Epoch: 9 cost time: 1.3815979957580566
Epoch: 9, Steps: 10 | Train Loss: 0.160 Vali Loss: 1.743 Vali Acc: 0.446 Test Loss: 1.743 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7653944492340088
Epoch: 10, Steps: 10 | Train Loss: 0.226 Vali Loss: 1.535 Vali Acc: 0.527 Test Loss: 1.535 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8584785461425781
Epoch: 11, Steps: 10 | Train Loss: 0.310 Vali Loss: 1.566 Vali Acc: 0.514 Test Loss: 1.566 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.6029255390167236
Epoch: 12, Steps: 10 | Train Loss: 0.077 Vali Loss: 1.809 Vali Acc: 0.541 Test Loss: 1.809 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.6686725616455078
Epoch: 13, Steps: 10 | Train Loss: 0.046 Vali Loss: 2.202 Vali Acc: 0.527 Test Loss: 2.202 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.8101189136505127
Epoch: 14, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.925 Vali Acc: 0.581 Test Loss: 1.925 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.871220350265503
Epoch: 15, Steps: 10 | Train Loss: 0.024 Vali Loss: 2.068 Vali Acc: 0.595 Test Loss: 2.068 Test Acc: 0.595
Validation loss decreased (-0.581068 --> -0.594574).  Saving model ...
Epoch: 16 cost time: 1.593069076538086
Epoch: 16, Steps: 10 | Train Loss: 0.011 Vali Loss: 2.646 Vali Acc: 0.541 Test Loss: 2.646 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8007934093475342
Epoch: 17, Steps: 10 | Train Loss: 0.034 Vali Loss: 2.674 Vali Acc: 0.595 Test Loss: 2.674 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4123926162719727
Epoch: 18, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.321 Vali Acc: 0.541 Test Loss: 3.321 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.4288568496704102
Epoch: 19, Steps: 10 | Train Loss: 0.038 Vali Loss: 2.863 Vali Acc: 0.554 Test Loss: 2.863 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.9250257015228271
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.059 Vali Acc: 0.541 Test Loss: 3.059 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.8578505516052246
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.999 Vali Acc: 0.541 Test Loss: 2.999 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.8421671390533447
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.029 Vali Acc: 0.595 Test Loss: 3.029 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.0317893028259277
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.784 Vali Acc: 0.595 Test Loss: 2.784 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.6148772239685059
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.467 Vali Acc: 0.554 Test Loss: 3.467 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.5699436664581299
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.040 Vali Acc: 0.541 Test Loss: 3.040 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 1818140
model size : 9.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.8124935626983643
Epoch: 1, Steps: 10 | Train Loss: 1.455 Vali Loss: 1.507 Vali Acc: 0.203 Test Loss: 1.507 Test Acc: 0.203
Validation loss decreased (inf --> -0.202688).  Saving model ...
Epoch: 2 cost time: 1.7562787532806396
Epoch: 2, Steps: 10 | Train Loss: 1.390 Vali Loss: 1.493 Vali Acc: 0.270 Test Loss: 1.493 Test Acc: 0.270
Validation loss decreased (-0.202688 --> -0.270255).  Saving model ...
Epoch: 3 cost time: 1.5754585266113281
Epoch: 3, Steps: 10 | Train Loss: 1.131 Vali Loss: 1.165 Vali Acc: 0.486 Test Loss: 1.165 Test Acc: 0.486
Validation loss decreased (-0.270255 --> -0.486475).  Saving model ...
Epoch: 4 cost time: 1.5539796352386475
Epoch: 4, Steps: 10 | Train Loss: 0.839 Vali Loss: 1.285 Vali Acc: 0.392 Test Loss: 1.285 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9215106964111328
Epoch: 5, Steps: 10 | Train Loss: 0.672 Vali Loss: 1.105 Vali Acc: 0.514 Test Loss: 1.105 Test Acc: 0.514
Validation loss decreased (-0.486475 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 1.7277724742889404
Epoch: 6, Steps: 10 | Train Loss: 0.477 Vali Loss: 1.368 Vali Acc: 0.473 Test Loss: 1.368 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7157232761383057
Epoch: 7, Steps: 10 | Train Loss: 0.434 Vali Loss: 1.752 Vali Acc: 0.338 Test Loss: 1.752 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8514900207519531
Epoch: 8, Steps: 10 | Train Loss: 0.234 Vali Loss: 1.354 Vali Acc: 0.527 Test Loss: 1.354 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527013).  Saving model ...
Epoch: 9 cost time: 1.5484039783477783
Epoch: 9, Steps: 10 | Train Loss: 0.213 Vali Loss: 1.428 Vali Acc: 0.595 Test Loss: 1.428 Test Acc: 0.595
Validation loss decreased (-0.527013 --> -0.594580).  Saving model ...
Epoch: 10 cost time: 1.7434978485107422
Epoch: 10, Steps: 10 | Train Loss: 0.241 Vali Loss: 1.763 Vali Acc: 0.581 Test Loss: 1.763 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.679527759552002
Epoch: 11, Steps: 10 | Train Loss: 0.106 Vali Loss: 2.003 Vali Acc: 0.527 Test Loss: 2.003 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7585391998291016
Epoch: 12, Steps: 10 | Train Loss: 0.226 Vali Loss: 1.635 Vali Acc: 0.514 Test Loss: 1.635 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7629823684692383
Epoch: 13, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.900 Vali Acc: 0.514 Test Loss: 1.900 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.6087303161621094
Epoch: 14, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.962 Vali Acc: 0.554 Test Loss: 1.962 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.5246398448944092
Epoch: 15, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.913 Vali Acc: 0.527 Test Loss: 1.913 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.4230163097381592
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.165 Vali Acc: 0.500 Test Loss: 2.165 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.5711920261383057
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.004 Vali Acc: 0.541 Test Loss: 2.004 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.5472948551177979
Epoch: 18, Steps: 10 | Train Loss: 0.021 Vali Loss: 2.986 Vali Acc: 0.473 Test Loss: 2.986 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.2835168838500977
Epoch: 19, Steps: 10 | Train Loss: 0.038 Vali Loss: 2.145 Vali Acc: 0.527 Test Loss: 2.145 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 1813788
model size : 9.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.63608455657959
Epoch: 1, Steps: 10 | Train Loss: 1.583 Vali Loss: 1.474 Vali Acc: 0.419 Test Loss: 1.474 Test Acc: 0.419
Validation loss decreased (inf --> -0.418904).  Saving model ...
Epoch: 2 cost time: 1.893993616104126
Epoch: 2, Steps: 10 | Train Loss: 1.447 Vali Loss: 1.539 Vali Acc: 0.405 Test Loss: 1.539 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.926239252090454
Epoch: 3, Steps: 10 | Train Loss: 1.413 Vali Loss: 1.582 Vali Acc: 0.351 Test Loss: 1.582 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5705981254577637
Epoch: 4, Steps: 10 | Train Loss: 1.059 Vali Loss: 1.342 Vali Acc: 0.446 Test Loss: 1.342 Test Acc: 0.446
Validation loss decreased (-0.418904 --> -0.445933).  Saving model ...
Epoch: 5 cost time: 1.8306288719177246
Epoch: 5, Steps: 10 | Train Loss: 0.782 Vali Loss: 1.319 Vali Acc: 0.527 Test Loss: 1.319 Test Acc: 0.527
Validation loss decreased (-0.445933 --> -0.527014).  Saving model ...
Epoch: 6 cost time: 1.7417380809783936
Epoch: 6, Steps: 10 | Train Loss: 0.780 Vali Loss: 1.818 Vali Acc: 0.486 Test Loss: 1.818 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0919106006622314
Epoch: 7, Steps: 10 | Train Loss: 0.752 Vali Loss: 1.290 Vali Acc: 0.500 Test Loss: 1.290 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.040036678314209
Epoch: 8, Steps: 10 | Train Loss: 0.398 Vali Loss: 1.307 Vali Acc: 0.500 Test Loss: 1.307 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7810051441192627
Epoch: 9, Steps: 10 | Train Loss: 0.250 Vali Loss: 1.334 Vali Acc: 0.554 Test Loss: 1.334 Test Acc: 0.554
Validation loss decreased (-0.527014 --> -0.554041).  Saving model ...
Epoch: 10 cost time: 1.444467544555664
Epoch: 10, Steps: 10 | Train Loss: 0.142 Vali Loss: 1.228 Vali Acc: 0.581 Test Loss: 1.228 Test Acc: 0.581
Validation loss decreased (-0.554041 --> -0.581069).  Saving model ...
Epoch: 11 cost time: 1.6513562202453613
Epoch: 11, Steps: 10 | Train Loss: 0.092 Vali Loss: 1.436 Vali Acc: 0.554 Test Loss: 1.436 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4402425289154053
Epoch: 12, Steps: 10 | Train Loss: 0.063 Vali Loss: 1.770 Vali Acc: 0.568 Test Loss: 1.770 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.862492561340332
Epoch: 13, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.703 Vali Acc: 0.568 Test Loss: 1.703 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.0756194591522217
Epoch: 14, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.812 Vali Acc: 0.581 Test Loss: 1.812 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.4192700386047363
Epoch: 15, Steps: 10 | Train Loss: 0.018 Vali Loss: 2.128 Vali Acc: 0.527 Test Loss: 2.128 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.033510208129883
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 2.105 Vali Acc: 0.500 Test Loss: 2.105 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.852266550064087
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.989 Vali Acc: 0.554 Test Loss: 1.989 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.502824306488037
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 2.215 Vali Acc: 0.527 Test Loss: 2.215 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.6608045101165771
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 2.350 Vali Acc: 0.527 Test Loss: 2.350 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.819383144378662
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 2.646 Vali Acc: 0.527 Test Loss: 2.646 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 1432092
model size : 7.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.539806365966797
Epoch: 1, Steps: 10 | Train Loss: 1.507 Vali Loss: 1.412 Vali Acc: 0.216 Test Loss: 1.412 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 1.9088716506958008
Epoch: 2, Steps: 10 | Train Loss: 1.429 Vali Loss: 1.424 Vali Acc: 0.216 Test Loss: 1.424 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.1749374866485596
Epoch: 3, Steps: 10 | Train Loss: 1.295 Vali Loss: 1.324 Vali Acc: 0.514 Test Loss: 1.324 Test Acc: 0.514
Validation loss decreased (-0.216202 --> -0.513500).  Saving model ...
Epoch: 4 cost time: 1.9350666999816895
Epoch: 4, Steps: 10 | Train Loss: 1.064 Vali Loss: 1.174 Vali Acc: 0.486 Test Loss: 1.174 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5903551578521729
Epoch: 5, Steps: 10 | Train Loss: 0.858 Vali Loss: 1.820 Vali Acc: 0.324 Test Loss: 1.820 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.0135130882263184
Epoch: 6, Steps: 10 | Train Loss: 0.774 Vali Loss: 1.547 Vali Acc: 0.392 Test Loss: 1.547 Test Acc: 0.392
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.8066015243530273
Epoch: 7, Steps: 10 | Train Loss: 0.604 Vali Loss: 1.721 Vali Acc: 0.419 Test Loss: 1.721 Test Acc: 0.419
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.3451542854309082
Epoch: 8, Steps: 10 | Train Loss: 0.381 Vali Loss: 1.270 Vali Acc: 0.527 Test Loss: 1.270 Test Acc: 0.527
Validation loss decreased (-0.513500 --> -0.527014).  Saving model ...
Epoch: 9 cost time: 1.7651517391204834
Epoch: 9, Steps: 10 | Train Loss: 0.276 Vali Loss: 1.385 Vali Acc: 0.541 Test Loss: 1.385 Test Acc: 0.541
Validation loss decreased (-0.527014 --> -0.540527).  Saving model ...
Epoch: 10 cost time: 1.4470000267028809
Epoch: 10, Steps: 10 | Train Loss: 0.243 Vali Loss: 1.355 Vali Acc: 0.500 Test Loss: 1.355 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5436618328094482
Epoch: 11, Steps: 10 | Train Loss: 0.109 Vali Loss: 1.493 Vali Acc: 0.527 Test Loss: 1.493 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3518829345703125
Epoch: 12, Steps: 10 | Train Loss: 0.095 Vali Loss: 2.017 Vali Acc: 0.473 Test Loss: 2.017 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.5614845752716064
Epoch: 13, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.901 Vali Acc: 0.486 Test Loss: 1.901 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.8540937900543213
Epoch: 14, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.790 Vali Acc: 0.527 Test Loss: 1.790 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.001329183578491
Epoch: 15, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.673 Vali Acc: 0.608 Test Loss: 1.673 Test Acc: 0.608
Validation loss decreased (-0.540527 --> -0.608091).  Saving model ...
Epoch: 16 cost time: 1.6049561500549316
Epoch: 16, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.927 Vali Acc: 0.541 Test Loss: 1.927 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.1111013889312744
Epoch: 17, Steps: 10 | Train Loss: 0.021 Vali Loss: 2.066 Vali Acc: 0.486 Test Loss: 2.066 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.6951401233673096
Epoch: 18, Steps: 10 | Train Loss: 0.022 Vali Loss: 2.019 Vali Acc: 0.541 Test Loss: 2.019 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.694676399230957
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 2.147 Vali Acc: 0.514 Test Loss: 2.147 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.912400484085083
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 2.824 Vali Acc: 0.459 Test Loss: 2.824 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.137878894805908
Epoch: 21, Steps: 10 | Train Loss: 0.033 Vali Loss: 2.469 Vali Acc: 0.568 Test Loss: 2.469 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.509469985961914
Epoch: 22, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.442 Vali Acc: 0.405 Test Loss: 3.442 Test Acc: 0.405
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.6174967288970947
Epoch: 23, Steps: 10 | Train Loss: 0.015 Vali Loss: 2.509 Vali Acc: 0.581 Test Loss: 2.509 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.4041671752929688
Epoch: 24, Steps: 10 | Train Loss: 0.034 Vali Loss: 2.554 Vali Acc: 0.581 Test Loss: 2.554 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.8372504711151123
Epoch: 25, Steps: 10 | Train Loss: 0.018 Vali Loss: 2.872 Vali Acc: 0.581 Test Loss: 2.872 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 1427740
model size : 7.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.9639205932617188
Epoch: 1, Steps: 10 | Train Loss: 1.514 Vali Loss: 1.431 Vali Acc: 0.405 Test Loss: 1.431 Test Acc: 0.405
Validation loss decreased (inf --> -0.405391).  Saving model ...
Epoch: 2 cost time: 1.9172000885009766
Epoch: 2, Steps: 10 | Train Loss: 1.542 Vali Loss: 1.536 Vali Acc: 0.243 Test Loss: 1.536 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8824841976165771
Epoch: 3, Steps: 10 | Train Loss: 1.165 Vali Loss: 1.277 Vali Acc: 0.432 Test Loss: 1.277 Test Acc: 0.432
Validation loss decreased (-0.405391 --> -0.432420).  Saving model ...
Epoch: 4 cost time: 1.5348572731018066
Epoch: 4, Steps: 10 | Train Loss: 0.889 Vali Loss: 1.330 Vali Acc: 0.500 Test Loss: 1.330 Test Acc: 0.500
Validation loss decreased (-0.432420 --> -0.499987).  Saving model ...
Epoch: 5 cost time: 1.7733607292175293
Epoch: 5, Steps: 10 | Train Loss: 0.859 Vali Loss: 1.914 Vali Acc: 0.419 Test Loss: 1.914 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.227478265762329
Epoch: 6, Steps: 10 | Train Loss: 0.871 Vali Loss: 1.157 Vali Acc: 0.473 Test Loss: 1.157 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5164518356323242
Epoch: 7, Steps: 10 | Train Loss: 0.576 Vali Loss: 1.296 Vali Acc: 0.500 Test Loss: 1.296 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 8 cost time: 1.7230210304260254
Epoch: 8, Steps: 10 | Train Loss: 0.398 Vali Loss: 1.255 Vali Acc: 0.554 Test Loss: 1.255 Test Acc: 0.554
Validation loss decreased (-0.499987 --> -0.554042).  Saving model ...
Epoch: 9 cost time: 1.6510257720947266
Epoch: 9, Steps: 10 | Train Loss: 0.276 Vali Loss: 1.278 Vali Acc: 0.527 Test Loss: 1.278 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8051819801330566
Epoch: 10, Steps: 10 | Train Loss: 0.217 Vali Loss: 1.597 Vali Acc: 0.568 Test Loss: 1.597 Test Acc: 0.568
Validation loss decreased (-0.554042 --> -0.567552).  Saving model ...
Epoch: 11 cost time: 1.3748524188995361
Epoch: 11, Steps: 10 | Train Loss: 0.136 Vali Loss: 2.056 Vali Acc: 0.473 Test Loss: 2.056 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5605928897857666
Epoch: 12, Steps: 10 | Train Loss: 0.093 Vali Loss: 1.701 Vali Acc: 0.581 Test Loss: 1.701 Test Acc: 0.581
Validation loss decreased (-0.567552 --> -0.581064).  Saving model ...
Epoch: 13 cost time: 1.910161018371582
Epoch: 13, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.741 Vali Acc: 0.514 Test Loss: 1.741 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5834524631500244
Epoch: 14, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.977 Vali Acc: 0.514 Test Loss: 1.977 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.9327588081359863
Epoch: 15, Steps: 10 | Train Loss: 0.049 Vali Loss: 2.253 Vali Acc: 0.541 Test Loss: 2.253 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.8745603561401367
Epoch: 16, Steps: 10 | Train Loss: 0.020 Vali Loss: 2.147 Vali Acc: 0.486 Test Loss: 2.147 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.5315616130828857
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.692 Vali Acc: 0.446 Test Loss: 2.692 Test Acc: 0.446
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.7700610160827637
Epoch: 18, Steps: 10 | Train Loss: 0.011 Vali Loss: 2.645 Vali Acc: 0.473 Test Loss: 2.645 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.7262840270996094
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 2.387 Vali Acc: 0.500 Test Loss: 2.387 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.8313841819763184
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.401 Vali Acc: 0.595 Test Loss: 2.401 Test Acc: 0.595
Validation loss decreased (-0.581064 --> -0.594571).  Saving model ...
Epoch: 21 cost time: 1.5028941631317139
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.996 Vali Acc: 0.459 Test Loss: 2.996 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.8427274227142334
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.614 Vali Acc: 0.500 Test Loss: 2.614 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.9283645153045654
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.438 Vali Acc: 0.581 Test Loss: 2.438 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.4852938652038574
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.470 Vali Acc: 0.541 Test Loss: 2.470 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.9333596229553223
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.528 Vali Acc: 0.514 Test Loss: 2.528 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.803750991821289
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.545 Vali Acc: 0.514 Test Loss: 2.545 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.7309966087341309
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.538 Vali Acc: 0.514 Test Loss: 2.538 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.759247064590454
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.516 Vali Acc: 0.514 Test Loss: 2.516 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.7393033504486084
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.499 Vali Acc: 0.527 Test Loss: 2.499 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.5791540145874023
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.495 Vali Acc: 0.527 Test Loss: 2.495 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 1423388
model size : 7.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.047327756881714
Epoch: 1, Steps: 10 | Train Loss: 1.490 Vali Loss: 1.344 Vali Acc: 0.284 Test Loss: 1.344 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 1.156069040298462
Epoch: 2, Steps: 10 | Train Loss: 1.474 Vali Loss: 1.710 Vali Acc: 0.203 Test Loss: 1.710 Test Acc: 0.203
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3261563777923584
Epoch: 3, Steps: 10 | Train Loss: 1.395 Vali Loss: 1.797 Vali Acc: 0.203 Test Loss: 1.797 Test Acc: 0.203
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.741584300994873
Epoch: 4, Steps: 10 | Train Loss: 1.295 Vali Loss: 1.399 Vali Acc: 0.365 Test Loss: 1.399 Test Acc: 0.365
Validation loss decreased (-0.283770 --> -0.364851).  Saving model ...
Epoch: 5 cost time: 1.2390918731689453
Epoch: 5, Steps: 10 | Train Loss: 1.007 Vali Loss: 1.467 Vali Acc: 0.351 Test Loss: 1.467 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1446495056152344
Epoch: 6, Steps: 10 | Train Loss: 0.703 Vali Loss: 1.486 Vali Acc: 0.365 Test Loss: 1.486 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7118730545043945
Epoch: 7, Steps: 10 | Train Loss: 0.705 Vali Loss: 1.728 Vali Acc: 0.392 Test Loss: 1.728 Test Acc: 0.392
Validation loss decreased (-0.364851 --> -0.391875).  Saving model ...
Epoch: 8 cost time: 1.4657280445098877
Epoch: 8, Steps: 10 | Train Loss: 0.465 Vali Loss: 1.265 Vali Acc: 0.459 Test Loss: 1.265 Test Acc: 0.459
Validation loss decreased (-0.391875 --> -0.459447).  Saving model ...
Epoch: 9 cost time: 1.1980056762695312
Epoch: 9, Steps: 10 | Train Loss: 0.274 Vali Loss: 1.491 Vali Acc: 0.554 Test Loss: 1.491 Test Acc: 0.554
Validation loss decreased (-0.459447 --> -0.554039).  Saving model ...
Epoch: 10 cost time: 1.491814136505127
Epoch: 10, Steps: 10 | Train Loss: 0.282 Vali Loss: 1.540 Vali Acc: 0.541 Test Loss: 1.540 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.753589153289795
Epoch: 11, Steps: 10 | Train Loss: 0.221 Vali Loss: 1.571 Vali Acc: 0.568 Test Loss: 1.571 Test Acc: 0.568
Validation loss decreased (-0.554039 --> -0.567552).  Saving model ...
Epoch: 12 cost time: 1.4182100296020508
Epoch: 12, Steps: 10 | Train Loss: 0.101 Vali Loss: 1.543 Vali Acc: 0.554 Test Loss: 1.543 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6683573722839355
Epoch: 13, Steps: 10 | Train Loss: 0.073 Vali Loss: 2.026 Vali Acc: 0.486 Test Loss: 2.026 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4995453357696533
Epoch: 14, Steps: 10 | Train Loss: 0.065 Vali Loss: 2.187 Vali Acc: 0.527 Test Loss: 2.187 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0611469745635986
Epoch: 15, Steps: 10 | Train Loss: 0.014 Vali Loss: 2.032 Vali Acc: 0.568 Test Loss: 2.032 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.475590705871582
Epoch: 16, Steps: 10 | Train Loss: 0.008 Vali Loss: 2.209 Vali Acc: 0.541 Test Loss: 2.209 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.6722276210784912
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 2.155 Vali Acc: 0.514 Test Loss: 2.155 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.6348292827606201
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 2.210 Vali Acc: 0.595 Test Loss: 2.210 Test Acc: 0.595
Validation loss decreased (-0.567552 --> -0.594572).  Saving model ...
Epoch: 19 cost time: 1.4493646621704102
Epoch: 19, Steps: 10 | Train Loss: 0.019 Vali Loss: 2.885 Vali Acc: 0.486 Test Loss: 2.885 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5558545589447021
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.218 Vali Acc: 0.635 Test Loss: 2.218 Test Acc: 0.635
Validation loss decreased (-0.594572 --> -0.635113).  Saving model ...
Epoch: 21 cost time: 1.5785412788391113
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 2.510 Vali Acc: 0.554 Test Loss: 2.510 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5944418907165527
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.451 Vali Acc: 0.554 Test Loss: 2.451 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0510227680206299
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.746 Vali Acc: 0.595 Test Loss: 2.746 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.268622875213623
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.494 Vali Acc: 0.595 Test Loss: 2.494 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.1460740566253662
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.511 Vali Acc: 0.554 Test Loss: 2.511 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.351729154586792
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.527 Vali Acc: 0.581 Test Loss: 2.527 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.229832649230957
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.522 Vali Acc: 0.595 Test Loss: 2.522 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.1032500267028809
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.515 Vali Acc: 0.608 Test Loss: 2.515 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.2188055515289307
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.508 Vali Acc: 0.608 Test Loss: 2.508 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.2235863208770752
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.494 Vali Acc: 0.595 Test Loss: 2.494 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 1419036
model size : 7.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.1459221839904785
Epoch: 1, Steps: 10 | Train Loss: 1.501 Vali Loss: 1.544 Vali Acc: 0.189 Test Loss: 1.544 Test Acc: 0.189
Validation loss decreased (inf --> -0.189174).  Saving model ...
Epoch: 2 cost time: 1.8957021236419678
Epoch: 2, Steps: 10 | Train Loss: 1.491 Vali Loss: 1.322 Vali Acc: 0.432 Test Loss: 1.322 Test Acc: 0.432
Validation loss decreased (-0.189174 --> -0.432419).  Saving model ...
Epoch: 3 cost time: 1.5087318420410156
Epoch: 3, Steps: 10 | Train Loss: 1.374 Vali Loss: 1.278 Vali Acc: 0.432 Test Loss: 1.278 Test Acc: 0.432
Validation loss decreased (-0.432419 --> -0.432420).  Saving model ...
Epoch: 4 cost time: 1.3159780502319336
Epoch: 4, Steps: 10 | Train Loss: 1.058 Vali Loss: 1.770 Vali Acc: 0.486 Test Loss: 1.770 Test Acc: 0.486
Validation loss decreased (-0.432420 --> -0.486469).  Saving model ...
Epoch: 5 cost time: 1.7562496662139893
Epoch: 5, Steps: 10 | Train Loss: 1.211 Vali Loss: 1.375 Vali Acc: 0.500 Test Loss: 1.375 Test Acc: 0.500
Validation loss decreased (-0.486469 --> -0.499986).  Saving model ...
Epoch: 6 cost time: 1.674335241317749
Epoch: 6, Steps: 10 | Train Loss: 0.895 Vali Loss: 1.293 Vali Acc: 0.500 Test Loss: 1.293 Test Acc: 0.500
Validation loss decreased (-0.499986 --> -0.499987).  Saving model ...
Epoch: 7 cost time: 1.3976874351501465
Epoch: 7, Steps: 10 | Train Loss: 0.671 Vali Loss: 1.217 Vali Acc: 0.486 Test Loss: 1.217 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9765880107879639
Epoch: 8, Steps: 10 | Train Loss: 0.543 Vali Loss: 1.258 Vali Acc: 0.541 Test Loss: 1.258 Test Acc: 0.541
Validation loss decreased (-0.499987 --> -0.540528).  Saving model ...
Epoch: 9 cost time: 1.4811058044433594
Epoch: 9, Steps: 10 | Train Loss: 0.340 Vali Loss: 1.499 Vali Acc: 0.514 Test Loss: 1.499 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6470434665679932
Epoch: 10, Steps: 10 | Train Loss: 0.217 Vali Loss: 1.353 Vali Acc: 0.541 Test Loss: 1.353 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8847792148590088
Epoch: 11, Steps: 10 | Train Loss: 0.188 Vali Loss: 1.844 Vali Acc: 0.432 Test Loss: 1.844 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.7322351932525635
Epoch: 12, Steps: 10 | Train Loss: 0.106 Vali Loss: 1.512 Vali Acc: 0.554 Test Loss: 1.512 Test Acc: 0.554
Validation loss decreased (-0.540528 --> -0.554039).  Saving model ...
Epoch: 13 cost time: 1.5754504203796387
Epoch: 13, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.537 Vali Acc: 0.541 Test Loss: 1.537 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9716987609863281
Epoch: 14, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.834 Vali Acc: 0.527 Test Loss: 1.834 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.7129878997802734
Epoch: 15, Steps: 10 | Train Loss: 0.054 Vali Loss: 2.301 Vali Acc: 0.527 Test Loss: 2.301 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.6950056552886963
Epoch: 16, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.900 Vali Acc: 0.514 Test Loss: 1.900 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.8653388023376465
Epoch: 17, Steps: 10 | Train Loss: 0.023 Vali Loss: 2.330 Vali Acc: 0.514 Test Loss: 2.330 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.9236030578613281
Epoch: 18, Steps: 10 | Train Loss: 0.033 Vali Loss: 2.840 Vali Acc: 0.486 Test Loss: 2.840 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.7031385898590088
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 2.257 Vali Acc: 0.554 Test Loss: 2.257 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.9277138710021973
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.318 Vali Acc: 0.608 Test Loss: 2.318 Test Acc: 0.608
Validation loss decreased (-0.554039 --> -0.608085).  Saving model ...
Epoch: 21 cost time: 1.8984651565551758
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.775 Vali Acc: 0.500 Test Loss: 2.775 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.8437371253967285
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.569 Vali Acc: 0.541 Test Loss: 2.569 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.9883944988250732
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.603 Vali Acc: 0.568 Test Loss: 2.603 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.6732301712036133
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.490 Vali Acc: 0.527 Test Loss: 2.490 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.7712953090667725
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.590 Vali Acc: 0.541 Test Loss: 2.590 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.8047523498535156
Epoch: 26, Steps: 10 | Train Loss: 0.015 Vali Loss: 2.711 Vali Acc: 0.514 Test Loss: 2.711 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.5250873565673828
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.952 Vali Acc: 0.500 Test Loss: 2.952 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.744269847869873
Epoch: 28, Steps: 10 | Train Loss: 0.018 Vali Loss: 2.900 Vali Acc: 0.568 Test Loss: 2.900 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.8808350563049316
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.301 Vali Acc: 0.541 Test Loss: 3.301 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.4433393478393555
Epoch: 30, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.289 Vali Acc: 0.514 Test Loss: 3.289 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 1234716
model size : 7.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.813889741897583
Epoch: 1, Steps: 10 | Train Loss: 1.489 Vali Loss: 1.509 Vali Acc: 0.189 Test Loss: 1.509 Test Acc: 0.189
Validation loss decreased (inf --> -0.189174).  Saving model ...
Epoch: 2 cost time: 1.674590826034546
Epoch: 2, Steps: 10 | Train Loss: 1.448 Vali Loss: 1.327 Vali Acc: 0.284 Test Loss: 1.327 Test Acc: 0.284
Validation loss decreased (-0.189174 --> -0.283771).  Saving model ...
Epoch: 3 cost time: 1.908642053604126
Epoch: 3, Steps: 10 | Train Loss: 1.344 Vali Loss: 1.645 Vali Acc: 0.392 Test Loss: 1.645 Test Acc: 0.392
Validation loss decreased (-0.283771 --> -0.391875).  Saving model ...
Epoch: 4 cost time: 1.6284260749816895
Epoch: 4, Steps: 10 | Train Loss: 1.145 Vali Loss: 1.761 Vali Acc: 0.230 Test Loss: 1.761 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7168545722961426
Epoch: 5, Steps: 10 | Train Loss: 0.959 Vali Loss: 1.443 Vali Acc: 0.338 Test Loss: 1.443 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7400832176208496
Epoch: 6, Steps: 10 | Train Loss: 0.865 Vali Loss: 1.318 Vali Acc: 0.459 Test Loss: 1.318 Test Acc: 0.459
Validation loss decreased (-0.391875 --> -0.459446).  Saving model ...
Epoch: 7 cost time: 1.5771944522857666
Epoch: 7, Steps: 10 | Train Loss: 0.589 Vali Loss: 1.347 Vali Acc: 0.473 Test Loss: 1.347 Test Acc: 0.473
Validation loss decreased (-0.459446 --> -0.472960).  Saving model ...
Epoch: 8 cost time: 1.6897227764129639
Epoch: 8, Steps: 10 | Train Loss: 0.400 Vali Loss: 2.141 Vali Acc: 0.405 Test Loss: 2.141 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6921286582946777
Epoch: 9, Steps: 10 | Train Loss: 0.340 Vali Loss: 1.332 Vali Acc: 0.541 Test Loss: 1.332 Test Acc: 0.541
Validation loss decreased (-0.472960 --> -0.540527).  Saving model ...
Epoch: 10 cost time: 1.8496522903442383
Epoch: 10, Steps: 10 | Train Loss: 0.349 Vali Loss: 1.429 Vali Acc: 0.459 Test Loss: 1.429 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.32427978515625
Epoch: 11, Steps: 10 | Train Loss: 0.212 Vali Loss: 1.429 Vali Acc: 0.527 Test Loss: 1.429 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5917601585388184
Epoch: 12, Steps: 10 | Train Loss: 0.085 Vali Loss: 1.446 Vali Acc: 0.554 Test Loss: 1.446 Test Acc: 0.554
Validation loss decreased (-0.540527 --> -0.554040).  Saving model ...
Epoch: 13 cost time: 1.6336472034454346
Epoch: 13, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.720 Vali Acc: 0.500 Test Loss: 1.720 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6462666988372803
Epoch: 14, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.733 Vali Acc: 0.527 Test Loss: 1.733 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3971846103668213
Epoch: 15, Steps: 10 | Train Loss: 0.064 Vali Loss: 2.049 Vali Acc: 0.500 Test Loss: 2.049 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.8598103523254395
Epoch: 16, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.112 Vali Acc: 0.486 Test Loss: 3.112 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.445915699005127
Epoch: 17, Steps: 10 | Train Loss: 0.059 Vali Loss: 2.446 Vali Acc: 0.527 Test Loss: 2.446 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.3941295146942139
Epoch: 18, Steps: 10 | Train Loss: 0.013 Vali Loss: 2.165 Vali Acc: 0.568 Test Loss: 2.165 Test Acc: 0.568
Validation loss decreased (-0.554040 --> -0.567546).  Saving model ...
Epoch: 19 cost time: 1.896052598953247
Epoch: 19, Steps: 10 | Train Loss: 0.022 Vali Loss: 2.664 Vali Acc: 0.568 Test Loss: 2.664 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.510706901550293
Epoch: 20, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.038 Vali Acc: 0.514 Test Loss: 3.038 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.601402997970581
Epoch: 21, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.288 Vali Acc: 0.486 Test Loss: 3.288 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.5049424171447754
Epoch: 22, Steps: 10 | Train Loss: 0.021 Vali Loss: 2.642 Vali Acc: 0.541 Test Loss: 2.642 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.7241036891937256
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.360 Vali Acc: 0.527 Test Loss: 3.360 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.4628255367279053
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.270 Vali Acc: 0.500 Test Loss: 3.270 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.557619571685791
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 3.163 Vali Acc: 0.514 Test Loss: 3.163 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.6425328254699707
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 3.147 Vali Acc: 0.527 Test Loss: 3.147 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.704491138458252
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 3.166 Vali Acc: 0.514 Test Loss: 3.166 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.507488489151001
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 3.171 Vali Acc: 0.500 Test Loss: 3.171 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 1230364
model size : 7.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.600569248199463
Epoch: 1, Steps: 10 | Train Loss: 1.629 Vali Loss: 1.971 Vali Acc: 0.243 Test Loss: 1.971 Test Acc: 0.243
Validation loss decreased (inf --> -0.243224).  Saving model ...
Epoch: 2 cost time: 1.7770135402679443
Epoch: 2, Steps: 10 | Train Loss: 1.479 Vali Loss: 1.514 Vali Acc: 0.297 Test Loss: 1.514 Test Acc: 0.297
Validation loss decreased (-0.243224 --> -0.297282).  Saving model ...
Epoch: 3 cost time: 1.6463615894317627
Epoch: 3, Steps: 10 | Train Loss: 1.199 Vali Loss: 1.927 Vali Acc: 0.203 Test Loss: 1.927 Test Acc: 0.203
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5612680912017822
Epoch: 4, Steps: 10 | Train Loss: 1.181 Vali Loss: 1.250 Vali Acc: 0.446 Test Loss: 1.250 Test Acc: 0.446
Validation loss decreased (-0.297282 --> -0.445933).  Saving model ...
Epoch: 5 cost time: 1.8444862365722656
Epoch: 5, Steps: 10 | Train Loss: 0.775 Vali Loss: 1.678 Vali Acc: 0.297 Test Loss: 1.678 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.0096418857574463
Epoch: 6, Steps: 10 | Train Loss: 0.656 Vali Loss: 1.260 Vali Acc: 0.473 Test Loss: 1.260 Test Acc: 0.473
Validation loss decreased (-0.445933 --> -0.472960).  Saving model ...
Epoch: 7 cost time: 2.2063004970550537
Epoch: 7, Steps: 10 | Train Loss: 0.563 Vali Loss: 1.197 Vali Acc: 0.541 Test Loss: 1.197 Test Acc: 0.541
Validation loss decreased (-0.472960 --> -0.540529).  Saving model ...
Epoch: 8 cost time: 1.761103630065918
Epoch: 8, Steps: 10 | Train Loss: 0.329 Vali Loss: 1.133 Vali Acc: 0.554 Test Loss: 1.133 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554043).  Saving model ...
Epoch: 9 cost time: 1.4151387214660645
Epoch: 9, Steps: 10 | Train Loss: 0.289 Vali Loss: 1.352 Vali Acc: 0.568 Test Loss: 1.352 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567554).  Saving model ...
Epoch: 10 cost time: 1.8927545547485352
Epoch: 10, Steps: 10 | Train Loss: 0.247 Vali Loss: 1.226 Vali Acc: 0.608 Test Loss: 1.226 Test Acc: 0.608
Validation loss decreased (-0.567554 --> -0.608096).  Saving model ...
Epoch: 11 cost time: 1.8245882987976074
Epoch: 11, Steps: 10 | Train Loss: 0.160 Vali Loss: 1.772 Vali Acc: 0.500 Test Loss: 1.772 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8902277946472168
Epoch: 12, Steps: 10 | Train Loss: 0.112 Vali Loss: 2.150 Vali Acc: 0.459 Test Loss: 2.150 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.969069004058838
Epoch: 13, Steps: 10 | Train Loss: 0.068 Vali Loss: 2.032 Vali Acc: 0.473 Test Loss: 2.032 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.7927842140197754
Epoch: 14, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.877 Vali Acc: 0.527 Test Loss: 1.877 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.7047080993652344
Epoch: 15, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.952 Vali Acc: 0.527 Test Loss: 1.952 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.563739538192749
Epoch: 16, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.970 Vali Acc: 0.527 Test Loss: 1.970 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.052790641784668
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 2.100 Vali Acc: 0.541 Test Loss: 2.100 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.8991038799285889
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.142 Vali Acc: 0.595 Test Loss: 2.142 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.8829059600830078
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.169 Vali Acc: 0.554 Test Loss: 2.169 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.1488654613494873
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.286 Vali Acc: 0.554 Test Loss: 2.286 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 1226012
model size : 7.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.6181907653808594
Epoch: 1, Steps: 10 | Train Loss: 1.581 Vali Loss: 1.464 Vali Acc: 0.176 Test Loss: 1.464 Test Acc: 0.176
Validation loss decreased (inf --> -0.175661).  Saving model ...
Epoch: 2 cost time: 1.2789287567138672
Epoch: 2, Steps: 10 | Train Loss: 1.400 Vali Loss: 1.798 Vali Acc: 0.270 Test Loss: 1.798 Test Acc: 0.270
Validation loss decreased (-0.175661 --> -0.270252).  Saving model ...
Epoch: 3 cost time: 1.1004056930541992
Epoch: 3, Steps: 10 | Train Loss: 1.367 Vali Loss: 1.667 Vali Acc: 0.270 Test Loss: 1.667 Test Acc: 0.270
Validation loss decreased (-0.270252 --> -0.270254).  Saving model ...
Epoch: 4 cost time: 1.241553544998169
Epoch: 4, Steps: 10 | Train Loss: 1.163 Vali Loss: 1.617 Vali Acc: 0.432 Test Loss: 1.617 Test Acc: 0.432
Validation loss decreased (-0.270254 --> -0.432416).  Saving model ...
Epoch: 5 cost time: 1.22430419921875
Epoch: 5, Steps: 10 | Train Loss: 0.943 Vali Loss: 1.789 Vali Acc: 0.378 Test Loss: 1.789 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3425190448760986
Epoch: 6, Steps: 10 | Train Loss: 0.874 Vali Loss: 1.220 Vali Acc: 0.486 Test Loss: 1.220 Test Acc: 0.486
Validation loss decreased (-0.432416 --> -0.486474).  Saving model ...
Epoch: 7 cost time: 1.2075533866882324
Epoch: 7, Steps: 10 | Train Loss: 0.551 Vali Loss: 1.472 Vali Acc: 0.486 Test Loss: 1.472 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.491694450378418
Epoch: 8, Steps: 10 | Train Loss: 0.686 Vali Loss: 1.276 Vali Acc: 0.541 Test Loss: 1.276 Test Acc: 0.541
Validation loss decreased (-0.486474 --> -0.540528).  Saving model ...
Epoch: 9 cost time: 1.4031555652618408
Epoch: 9, Steps: 10 | Train Loss: 0.519 Vali Loss: 1.324 Vali Acc: 0.541 Test Loss: 1.324 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.516716480255127
Epoch: 10, Steps: 10 | Train Loss: 0.280 Vali Loss: 1.327 Vali Acc: 0.595 Test Loss: 1.327 Test Acc: 0.595
Validation loss decreased (-0.540528 --> -0.594581).  Saving model ...
Epoch: 11 cost time: 1.6715219020843506
Epoch: 11, Steps: 10 | Train Loss: 0.124 Vali Loss: 1.492 Vali Acc: 0.500 Test Loss: 1.492 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3957407474517822
Epoch: 12, Steps: 10 | Train Loss: 0.121 Vali Loss: 1.724 Vali Acc: 0.514 Test Loss: 1.724 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.529761552810669
Epoch: 13, Steps: 10 | Train Loss: 0.111 Vali Loss: 1.392 Vali Acc: 0.500 Test Loss: 1.392 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.075927972793579
Epoch: 14, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.806 Vali Acc: 0.500 Test Loss: 1.806 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.8820950984954834
Epoch: 15, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.866 Vali Acc: 0.568 Test Loss: 1.866 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.8721365928649902
Epoch: 16, Steps: 10 | Train Loss: 0.008 Vali Loss: 2.063 Vali Acc: 0.514 Test Loss: 2.063 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.4420621395111084
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.942 Vali Acc: 0.514 Test Loss: 1.942 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.6104497909545898
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.988 Vali Acc: 0.527 Test Loss: 1.988 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.6188359260559082
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.941 Vali Acc: 0.541 Test Loss: 1.941 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.2845580577850342
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.919 Vali Acc: 0.581 Test Loss: 1.919 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 1221660
model size : 7.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.55615234375
Epoch: 1, Steps: 10 | Train Loss: 1.516 Vali Loss: 1.394 Vali Acc: 0.311 Test Loss: 1.394 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 1.2834973335266113
Epoch: 2, Steps: 10 | Train Loss: 1.406 Vali Loss: 1.268 Vali Acc: 0.338 Test Loss: 1.268 Test Acc: 0.338
Validation loss decreased (-0.310797 --> -0.337825).  Saving model ...
Epoch: 3 cost time: 1.7656238079071045
Epoch: 3, Steps: 10 | Train Loss: 1.276 Vali Loss: 1.438 Vali Acc: 0.297 Test Loss: 1.438 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6987321376800537
Epoch: 4, Steps: 10 | Train Loss: 1.105 Vali Loss: 1.375 Vali Acc: 0.365 Test Loss: 1.375 Test Acc: 0.365
Validation loss decreased (-0.337825 --> -0.364851).  Saving model ...
Epoch: 5 cost time: 1.6826143264770508
Epoch: 5, Steps: 10 | Train Loss: 0.796 Vali Loss: 1.239 Vali Acc: 0.459 Test Loss: 1.239 Test Acc: 0.459
Validation loss decreased (-0.364851 --> -0.459447).  Saving model ...
Epoch: 6 cost time: 1.6898295879364014
Epoch: 6, Steps: 10 | Train Loss: 0.710 Vali Loss: 1.215 Vali Acc: 0.527 Test Loss: 1.215 Test Acc: 0.527
Validation loss decreased (-0.459447 --> -0.527015).  Saving model ...
Epoch: 7 cost time: 1.343045949935913
Epoch: 7, Steps: 10 | Train Loss: 0.535 Vali Loss: 1.262 Vali Acc: 0.514 Test Loss: 1.262 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5811538696289062
Epoch: 8, Steps: 10 | Train Loss: 0.334 Vali Loss: 1.172 Vali Acc: 0.527 Test Loss: 1.172 Test Acc: 0.527
Validation loss decreased (-0.527015 --> -0.527015).  Saving model ...
Epoch: 9 cost time: 1.7521259784698486
Epoch: 9, Steps: 10 | Train Loss: 0.234 Vali Loss: 1.292 Vali Acc: 0.459 Test Loss: 1.292 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7850337028503418
Epoch: 10, Steps: 10 | Train Loss: 0.209 Vali Loss: 1.423 Vali Acc: 0.527 Test Loss: 1.423 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.674727439880371
Epoch: 11, Steps: 10 | Train Loss: 0.108 Vali Loss: 1.219 Vali Acc: 0.527 Test Loss: 1.219 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.134833812713623
Epoch: 12, Steps: 10 | Train Loss: 0.071 Vali Loss: 1.513 Vali Acc: 0.541 Test Loss: 1.513 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540525).  Saving model ...
Epoch: 13 cost time: 1.1252069473266602
Epoch: 13, Steps: 10 | Train Loss: 0.080 Vali Loss: 1.816 Vali Acc: 0.541 Test Loss: 1.816 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2565867900848389
Epoch: 14, Steps: 10 | Train Loss: 0.149 Vali Loss: 2.157 Vali Acc: 0.541 Test Loss: 2.157 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5486798286437988
Epoch: 15, Steps: 10 | Train Loss: 0.133 Vali Loss: 2.354 Vali Acc: 0.500 Test Loss: 2.354 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.5155866146087646
Epoch: 16, Steps: 10 | Train Loss: 0.036 Vali Loss: 2.064 Vali Acc: 0.541 Test Loss: 2.064 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.6244585514068604
Epoch: 17, Steps: 10 | Train Loss: 0.019 Vali Loss: 2.011 Vali Acc: 0.568 Test Loss: 2.011 Test Acc: 0.568
Validation loss decreased (-0.540525 --> -0.567547).  Saving model ...
Epoch: 18 cost time: 1.3269360065460205
Epoch: 18, Steps: 10 | Train Loss: 0.018 Vali Loss: 2.883 Vali Acc: 0.473 Test Loss: 2.883 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.388535737991333
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 2.320 Vali Acc: 0.581 Test Loss: 2.320 Test Acc: 0.581
Validation loss decreased (-0.567547 --> -0.581058).  Saving model ...
Epoch: 20 cost time: 1.5911595821380615
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.568 Vali Acc: 0.527 Test Loss: 2.568 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.985867977142334
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.546 Vali Acc: 0.527 Test Loss: 2.546 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.641204833984375
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.573 Vali Acc: 0.527 Test Loss: 2.573 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.0017502307891846
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.548 Vali Acc: 0.527 Test Loss: 2.548 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.5512535572052002
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.499 Vali Acc: 0.527 Test Loss: 2.499 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.626011848449707
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.460 Vali Acc: 0.554 Test Loss: 2.460 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.7601027488708496
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.460 Vali Acc: 0.554 Test Loss: 2.460 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.6574957370758057
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.483 Vali Acc: 0.527 Test Loss: 2.483 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.9151906967163086
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.497 Vali Acc: 0.527 Test Loss: 2.497 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.4039280414581299
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.499 Vali Acc: 0.527 Test Loss: 2.499 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 1136028
model size : 6.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.005141258239746
Epoch: 1, Steps: 10 | Train Loss: 1.535 Vali Loss: 1.551 Vali Acc: 0.216 Test Loss: 1.551 Test Acc: 0.216
Validation loss decreased (inf --> -0.216201).  Saving model ...
Epoch: 2 cost time: 1.687279224395752
Epoch: 2, Steps: 10 | Train Loss: 1.478 Vali Loss: 1.598 Vali Acc: 0.203 Test Loss: 1.598 Test Acc: 0.203
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.472761631011963
Epoch: 3, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.797 Vali Acc: 0.324 Test Loss: 1.797 Test Acc: 0.324
Validation loss decreased (-0.216201 --> -0.324306).  Saving model ...
Epoch: 4 cost time: 1.496652364730835
Epoch: 4, Steps: 10 | Train Loss: 1.337 Vali Loss: 1.263 Vali Acc: 0.500 Test Loss: 1.263 Test Acc: 0.500
Validation loss decreased (-0.324306 --> -0.499987).  Saving model ...
Epoch: 5 cost time: 1.5136449337005615
Epoch: 5, Steps: 10 | Train Loss: 0.903 Vali Loss: 1.259 Vali Acc: 0.432 Test Loss: 1.259 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.697052001953125
Epoch: 6, Steps: 10 | Train Loss: 0.747 Vali Loss: 1.970 Vali Acc: 0.338 Test Loss: 1.970 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6686930656433105
Epoch: 7, Steps: 10 | Train Loss: 0.767 Vali Loss: 1.621 Vali Acc: 0.405 Test Loss: 1.621 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.6285820007324219
Epoch: 8, Steps: 10 | Train Loss: 0.495 Vali Loss: 1.141 Vali Acc: 0.581 Test Loss: 1.141 Test Acc: 0.581
Validation loss decreased (-0.499987 --> -0.581070).  Saving model ...
Epoch: 9 cost time: 1.6253674030303955
Epoch: 9, Steps: 10 | Train Loss: 0.277 Vali Loss: 1.350 Vali Acc: 0.554 Test Loss: 1.350 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6911392211914062
Epoch: 10, Steps: 10 | Train Loss: 0.208 Vali Loss: 1.316 Vali Acc: 0.541 Test Loss: 1.316 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7137939929962158
Epoch: 11, Steps: 10 | Train Loss: 0.173 Vali Loss: 1.371 Vali Acc: 0.541 Test Loss: 1.371 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.6560602188110352
Epoch: 12, Steps: 10 | Train Loss: 0.084 Vali Loss: 1.303 Vali Acc: 0.595 Test Loss: 1.303 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594582).  Saving model ...
Epoch: 13 cost time: 2.116133451461792
Epoch: 13, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.367 Vali Acc: 0.581 Test Loss: 1.367 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6758630275726318
Epoch: 14, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.573 Vali Acc: 0.500 Test Loss: 1.573 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.7693634033203125
Epoch: 15, Steps: 10 | Train Loss: 0.041 Vali Loss: 2.076 Vali Acc: 0.459 Test Loss: 2.076 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.1823923587799072
Epoch: 16, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.861 Vali Acc: 0.541 Test Loss: 1.861 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.9411287307739258
Epoch: 17, Steps: 10 | Train Loss: 0.058 Vali Loss: 2.347 Vali Acc: 0.527 Test Loss: 2.347 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.5101399421691895
Epoch: 18, Steps: 10 | Train Loss: 0.022 Vali Loss: 2.614 Vali Acc: 0.459 Test Loss: 2.614 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.7132151126861572
Epoch: 19, Steps: 10 | Train Loss: 0.127 Vali Loss: 2.186 Vali Acc: 0.622 Test Loss: 2.186 Test Acc: 0.622
Validation loss decreased (-0.594582 --> -0.621600).  Saving model ...
Epoch: 20 cost time: 1.8185594081878662
Epoch: 20, Steps: 10 | Train Loss: 0.025 Vali Loss: 2.486 Vali Acc: 0.568 Test Loss: 2.486 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6456639766693115
Epoch: 21, Steps: 10 | Train Loss: 0.023 Vali Loss: 2.641 Vali Acc: 0.527 Test Loss: 2.641 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.7932977676391602
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.510 Vali Acc: 0.595 Test Loss: 2.510 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.598604440689087
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.756 Vali Acc: 0.527 Test Loss: 2.756 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.907020092010498
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.569 Vali Acc: 0.608 Test Loss: 2.569 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.7543411254882812
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.462 Vali Acc: 0.473 Test Loss: 3.462 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.1886584758758545
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.758 Vali Acc: 0.568 Test Loss: 2.758 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.2988500595092773
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.582 Vali Acc: 0.581 Test Loss: 2.582 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.5802769660949707
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.731 Vali Acc: 0.514 Test Loss: 2.731 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.379443883895874
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.767 Vali Acc: 0.527 Test Loss: 2.767 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 1131676
model size : 6.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.6512749195098877
Epoch: 1, Steps: 10 | Train Loss: 1.503 Vali Loss: 1.450 Vali Acc: 0.257 Test Loss: 1.450 Test Acc: 0.257
Validation loss decreased (inf --> -0.256742).  Saving model ...
Epoch: 2 cost time: 1.2189273834228516
Epoch: 2, Steps: 10 | Train Loss: 1.369 Vali Loss: 1.608 Vali Acc: 0.243 Test Loss: 1.608 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.486161231994629
Epoch: 3, Steps: 10 | Train Loss: 1.305 Vali Loss: 1.211 Vali Acc: 0.419 Test Loss: 1.211 Test Acc: 0.419
Validation loss decreased (-0.256742 --> -0.418907).  Saving model ...
Epoch: 4 cost time: 2.021247386932373
Epoch: 4, Steps: 10 | Train Loss: 1.082 Vali Loss: 1.171 Vali Acc: 0.514 Test Loss: 1.171 Test Acc: 0.514
Validation loss decreased (-0.418907 --> -0.513502).  Saving model ...
Epoch: 5 cost time: 1.950521469116211
Epoch: 5, Steps: 10 | Train Loss: 1.312 Vali Loss: 2.306 Vali Acc: 0.459 Test Loss: 2.306 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.0956931114196777
Epoch: 6, Steps: 10 | Train Loss: 1.052 Vali Loss: 1.315 Vali Acc: 0.473 Test Loss: 1.315 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.036074638366699
Epoch: 7, Steps: 10 | Train Loss: 0.719 Vali Loss: 1.410 Vali Acc: 0.392 Test Loss: 1.410 Test Acc: 0.392
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.941638469696045
Epoch: 8, Steps: 10 | Train Loss: 0.724 Vali Loss: 1.260 Vali Acc: 0.514 Test Loss: 1.260 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.0345654487609863
Epoch: 9, Steps: 10 | Train Loss: 0.422 Vali Loss: 1.481 Vali Acc: 0.568 Test Loss: 1.481 Test Acc: 0.568
Validation loss decreased (-0.513502 --> -0.567553).  Saving model ...
Epoch: 10 cost time: 1.9128227233886719
Epoch: 10, Steps: 10 | Train Loss: 0.258 Vali Loss: 1.555 Vali Acc: 0.500 Test Loss: 1.555 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.2041943073272705
Epoch: 11, Steps: 10 | Train Loss: 0.320 Vali Loss: 1.497 Vali Acc: 0.541 Test Loss: 1.497 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.418978214263916
Epoch: 12, Steps: 10 | Train Loss: 0.178 Vali Loss: 1.421 Vali Acc: 0.568 Test Loss: 1.421 Test Acc: 0.568
Validation loss decreased (-0.567553 --> -0.567553).  Saving model ...
Epoch: 13 cost time: 1.645535945892334
Epoch: 13, Steps: 10 | Train Loss: 0.079 Vali Loss: 1.474 Vali Acc: 0.568 Test Loss: 1.474 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7451097965240479
Epoch: 14, Steps: 10 | Train Loss: 0.082 Vali Loss: 1.481 Vali Acc: 0.554 Test Loss: 1.481 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.879612684249878
Epoch: 15, Steps: 10 | Train Loss: 0.097 Vali Loss: 1.954 Vali Acc: 0.568 Test Loss: 1.954 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3305387496948242
Epoch: 16, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.804 Vali Acc: 0.595 Test Loss: 1.804 Test Acc: 0.595
Validation loss decreased (-0.567553 --> -0.594577).  Saving model ...
Epoch: 17 cost time: 1.9411182403564453
Epoch: 17, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.963 Vali Acc: 0.500 Test Loss: 1.963 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5145442485809326
Epoch: 18, Steps: 10 | Train Loss: 0.058 Vali Loss: 2.948 Vali Acc: 0.459 Test Loss: 2.948 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.036062002182007
Epoch: 19, Steps: 10 | Train Loss: 0.019 Vali Loss: 2.127 Vali Acc: 0.622 Test Loss: 2.127 Test Acc: 0.622
Validation loss decreased (-0.594577 --> -0.621600).  Saving model ...
Epoch: 20 cost time: 1.8748233318328857
Epoch: 20, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.024 Vali Acc: 0.486 Test Loss: 3.024 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.781097412109375
Epoch: 21, Steps: 10 | Train Loss: 0.021 Vali Loss: 2.773 Vali Acc: 0.527 Test Loss: 2.773 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.9493613243103027
Epoch: 22, Steps: 10 | Train Loss: 0.024 Vali Loss: 2.395 Vali Acc: 0.595 Test Loss: 2.395 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.8783912658691406
Epoch: 23, Steps: 10 | Train Loss: 0.030 Vali Loss: 2.995 Vali Acc: 0.527 Test Loss: 2.995 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.9903466701507568
Epoch: 24, Steps: 10 | Train Loss: 0.023 Vali Loss: 2.942 Vali Acc: 0.554 Test Loss: 2.942 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.700230598449707
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 2.812 Vali Acc: 0.581 Test Loss: 2.812 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.4015836715698242
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.877 Vali Acc: 0.595 Test Loss: 2.877 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.7630565166473389
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.785 Vali Acc: 0.568 Test Loss: 2.785 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.5798025131225586
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.824 Vali Acc: 0.568 Test Loss: 2.824 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.865126609802246
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.786 Vali Acc: 0.568 Test Loss: 2.786 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 1127324
model size : 6.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.417917251586914
Epoch: 1, Steps: 10 | Train Loss: 1.493 Vali Loss: 1.469 Vali Acc: 0.500 Test Loss: 1.469 Test Acc: 0.500
Validation loss decreased (inf --> -0.499985).  Saving model ...
Epoch: 2 cost time: 1.5718894004821777
Epoch: 2, Steps: 10 | Train Loss: 1.481 Vali Loss: 1.682 Vali Acc: 0.257 Test Loss: 1.682 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4176411628723145
Epoch: 3, Steps: 10 | Train Loss: 1.291 Vali Loss: 1.774 Vali Acc: 0.203 Test Loss: 1.774 Test Acc: 0.203
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4378807544708252
Epoch: 4, Steps: 10 | Train Loss: 1.101 Vali Loss: 1.610 Vali Acc: 0.297 Test Loss: 1.610 Test Acc: 0.297
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.4635088443756104
Epoch: 5, Steps: 10 | Train Loss: 0.948 Vali Loss: 1.425 Vali Acc: 0.365 Test Loss: 1.425 Test Acc: 0.365
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.4272089004516602
Epoch: 6, Steps: 10 | Train Loss: 0.654 Vali Loss: 1.251 Vali Acc: 0.473 Test Loss: 1.251 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.4341380596160889
Epoch: 7, Steps: 10 | Train Loss: 0.779 Vali Loss: 1.259 Vali Acc: 0.527 Test Loss: 1.259 Test Acc: 0.527
Validation loss decreased (-0.499985 --> -0.527014).  Saving model ...
Epoch: 8 cost time: 1.4223127365112305
Epoch: 8, Steps: 10 | Train Loss: 0.408 Vali Loss: 1.215 Vali Acc: 0.527 Test Loss: 1.215 Test Acc: 0.527
Validation loss decreased (-0.527014 --> -0.527015).  Saving model ...
Epoch: 9 cost time: 1.4185609817504883
Epoch: 9, Steps: 10 | Train Loss: 0.299 Vali Loss: 2.244 Vali Acc: 0.365 Test Loss: 2.244 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4812514781951904
Epoch: 10, Steps: 10 | Train Loss: 0.340 Vali Loss: 1.511 Vali Acc: 0.514 Test Loss: 1.511 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.684133768081665
Epoch: 11, Steps: 10 | Train Loss: 0.177 Vali Loss: 1.431 Vali Acc: 0.500 Test Loss: 1.431 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4058573246002197
Epoch: 12, Steps: 10 | Train Loss: 0.172 Vali Loss: 1.691 Vali Acc: 0.514 Test Loss: 1.691 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.6516385078430176
Epoch: 13, Steps: 10 | Train Loss: 0.280 Vali Loss: 2.372 Vali Acc: 0.432 Test Loss: 2.372 Test Acc: 0.432
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.6838915348052979
Epoch: 14, Steps: 10 | Train Loss: 0.091 Vali Loss: 1.573 Vali Acc: 0.541 Test Loss: 1.573 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540525).  Saving model ...
Epoch: 15 cost time: 1.2924981117248535
Epoch: 15, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.773 Vali Acc: 0.514 Test Loss: 1.773 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8101038932800293
Epoch: 16, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.507 Vali Acc: 0.581 Test Loss: 1.507 Test Acc: 0.581
Validation loss decreased (-0.540525 --> -0.581066).  Saving model ...
Epoch: 17 cost time: 1.6745078563690186
Epoch: 17, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.947 Vali Acc: 0.527 Test Loss: 1.947 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6672983169555664
Epoch: 18, Steps: 10 | Train Loss: 0.017 Vali Loss: 2.255 Vali Acc: 0.527 Test Loss: 2.255 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.6864662170410156
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 2.035 Vali Acc: 0.541 Test Loss: 2.035 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.50514554977417
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 2.629 Vali Acc: 0.459 Test Loss: 2.629 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.4933605194091797
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 2.310 Vali Acc: 0.554 Test Loss: 2.310 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.8613252639770508
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.269 Vali Acc: 0.500 Test Loss: 2.269 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.1209375858306885
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.259 Vali Acc: 0.527 Test Loss: 2.259 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.3875892162322998
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.254 Vali Acc: 0.554 Test Loss: 2.254 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.5389800071716309
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.243 Vali Acc: 0.527 Test Loss: 2.243 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.3441245555877686
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.232 Vali Acc: 0.527 Test Loss: 2.232 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 1122972
model size : 6.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.9550538063049316
Epoch: 1, Steps: 10 | Train Loss: 1.472 Vali Loss: 1.497 Vali Acc: 0.243 Test Loss: 1.497 Test Acc: 0.243
Validation loss decreased (inf --> -0.243228).  Saving model ...
Epoch: 2 cost time: 1.8393237590789795
Epoch: 2, Steps: 10 | Train Loss: 1.403 Vali Loss: 1.450 Vali Acc: 0.270 Test Loss: 1.450 Test Acc: 0.270
Validation loss decreased (-0.243228 --> -0.270256).  Saving model ...
Epoch: 3 cost time: 1.8461565971374512
Epoch: 3, Steps: 10 | Train Loss: 1.378 Vali Loss: 1.412 Vali Acc: 0.459 Test Loss: 1.412 Test Acc: 0.459
Validation loss decreased (-0.270256 --> -0.459445).  Saving model ...
Epoch: 4 cost time: 1.8715474605560303
Epoch: 4, Steps: 10 | Train Loss: 1.320 Vali Loss: 1.446 Vali Acc: 0.446 Test Loss: 1.446 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6830790042877197
Epoch: 5, Steps: 10 | Train Loss: 1.132 Vali Loss: 1.448 Vali Acc: 0.365 Test Loss: 1.448 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.0378479957580566
Epoch: 6, Steps: 10 | Train Loss: 0.813 Vali Loss: 1.141 Vali Acc: 0.486 Test Loss: 1.141 Test Acc: 0.486
Validation loss decreased (-0.459445 --> -0.486475).  Saving model ...
Epoch: 7 cost time: 1.7459008693695068
Epoch: 7, Steps: 10 | Train Loss: 0.628 Vali Loss: 1.103 Vali Acc: 0.541 Test Loss: 1.103 Test Acc: 0.541
Validation loss decreased (-0.486475 --> -0.540530).  Saving model ...
Epoch: 8 cost time: 1.5108158588409424
Epoch: 8, Steps: 10 | Train Loss: 0.453 Vali Loss: 1.116 Vali Acc: 0.568 Test Loss: 1.116 Test Acc: 0.568
Validation loss decreased (-0.540530 --> -0.567556).  Saving model ...
Epoch: 9 cost time: 1.7695162296295166
Epoch: 9, Steps: 10 | Train Loss: 0.341 Vali Loss: 1.054 Vali Acc: 0.581 Test Loss: 1.054 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581071).  Saving model ...
Epoch: 10 cost time: 1.4168548583984375
Epoch: 10, Steps: 10 | Train Loss: 0.239 Vali Loss: 1.147 Vali Acc: 0.568 Test Loss: 1.147 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.1480302810668945
Epoch: 11, Steps: 10 | Train Loss: 0.137 Vali Loss: 1.263 Vali Acc: 0.554 Test Loss: 1.263 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.1386239528656006
Epoch: 12, Steps: 10 | Train Loss: 0.083 Vali Loss: 1.308 Vali Acc: 0.581 Test Loss: 1.308 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.8420612812042236
Epoch: 13, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.384 Vali Acc: 0.581 Test Loss: 1.384 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.982851505279541
Epoch: 14, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.528 Vali Acc: 0.554 Test Loss: 1.528 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.3991367816925049
Epoch: 15, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.391 Vali Acc: 0.581 Test Loss: 1.391 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.7372310161590576
Epoch: 16, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.435 Vali Acc: 0.622 Test Loss: 1.435 Test Acc: 0.622
Validation loss decreased (-0.581071 --> -0.621607).  Saving model ...
Epoch: 17 cost time: 1.7427117824554443
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.451 Vali Acc: 0.608 Test Loss: 1.451 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.547755241394043
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.490 Vali Acc: 0.581 Test Loss: 1.490 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.6690952777862549
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.501 Vali Acc: 0.595 Test Loss: 1.501 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.3197317123413086
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.502 Vali Acc: 0.608 Test Loss: 1.502 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.578819751739502
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.514 Vali Acc: 0.608 Test Loss: 1.514 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.8141121864318848
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.531 Vali Acc: 0.622 Test Loss: 1.531 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.5832335948944092
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.526 Vali Acc: 0.608 Test Loss: 1.526 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.8170299530029297
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.543 Vali Acc: 0.608 Test Loss: 1.543 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.0573105812072754
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.556 Vali Acc: 0.622 Test Loss: 1.556 Test Acc: 0.622
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.3027911186218262
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.565 Vali Acc: 0.608 Test Loss: 1.565 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 718364
model size : 4.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.8153557777404785
Epoch: 1, Steps: 10 | Train Loss: 1.458 Vali Loss: 1.585 Vali Acc: 0.189 Test Loss: 1.585 Test Acc: 0.189
Validation loss decreased (inf --> -0.189173).  Saving model ...
Epoch: 2 cost time: 1.525409460067749
Epoch: 2, Steps: 10 | Train Loss: 1.460 Vali Loss: 1.419 Vali Acc: 0.365 Test Loss: 1.419 Test Acc: 0.365
Validation loss decreased (-0.189173 --> -0.364851).  Saving model ...
Epoch: 3 cost time: 1.1629877090454102
Epoch: 3, Steps: 10 | Train Loss: 1.375 Vali Loss: 1.963 Vali Acc: 0.189 Test Loss: 1.963 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7798080444335938
Epoch: 4, Steps: 10 | Train Loss: 1.221 Vali Loss: 1.250 Vali Acc: 0.459 Test Loss: 1.250 Test Acc: 0.459
Validation loss decreased (-0.364851 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 1.297290563583374
Epoch: 5, Steps: 10 | Train Loss: 1.074 Vali Loss: 1.310 Vali Acc: 0.392 Test Loss: 1.310 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7360084056854248
Epoch: 6, Steps: 10 | Train Loss: 0.833 Vali Loss: 1.448 Vali Acc: 0.311 Test Loss: 1.448 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6073923110961914
Epoch: 7, Steps: 10 | Train Loss: 0.637 Vali Loss: 1.127 Vali Acc: 0.486 Test Loss: 1.127 Test Acc: 0.486
Validation loss decreased (-0.459447 --> -0.486475).  Saving model ...
Epoch: 8 cost time: 1.238961935043335
Epoch: 8, Steps: 10 | Train Loss: 0.500 Vali Loss: 1.347 Vali Acc: 0.378 Test Loss: 1.347 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7391915321350098
Epoch: 9, Steps: 10 | Train Loss: 0.418 Vali Loss: 1.132 Vali Acc: 0.514 Test Loss: 1.132 Test Acc: 0.514
Validation loss decreased (-0.486475 --> -0.513502).  Saving model ...
Epoch: 10 cost time: 1.2925035953521729
Epoch: 10, Steps: 10 | Train Loss: 0.228 Vali Loss: 1.190 Vali Acc: 0.541 Test Loss: 1.190 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540529).  Saving model ...
Epoch: 11 cost time: 1.1670141220092773
Epoch: 11, Steps: 10 | Train Loss: 0.138 Vali Loss: 1.212 Vali Acc: 0.541 Test Loss: 1.212 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5492987632751465
Epoch: 12, Steps: 10 | Train Loss: 0.065 Vali Loss: 1.256 Vali Acc: 0.541 Test Loss: 1.256 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3412725925445557
Epoch: 13, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.346 Vali Acc: 0.568 Test Loss: 1.346 Test Acc: 0.568
Validation loss decreased (-0.540529 --> -0.567554).  Saving model ...
Epoch: 14 cost time: 1.198516607284546
Epoch: 14, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.434 Vali Acc: 0.581 Test Loss: 1.434 Test Acc: 0.581
Validation loss decreased (-0.567554 --> -0.581067).  Saving model ...
Epoch: 15 cost time: 1.5315005779266357
Epoch: 15, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.489 Vali Acc: 0.581 Test Loss: 1.489 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4985644817352295
Epoch: 16, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.504 Vali Acc: 0.595 Test Loss: 1.504 Test Acc: 0.595
Validation loss decreased (-0.581067 --> -0.594580).  Saving model ...
Epoch: 17 cost time: 1.344329595565796
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.489 Vali Acc: 0.568 Test Loss: 1.489 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.586646556854248
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.488 Vali Acc: 0.554 Test Loss: 1.488 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.56461763381958
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.550 Vali Acc: 0.608 Test Loss: 1.550 Test Acc: 0.608
Validation loss decreased (-0.594580 --> -0.608093).  Saving model ...
Epoch: 20 cost time: 1.3308308124542236
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.532 Vali Acc: 0.568 Test Loss: 1.532 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6751794815063477
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.537 Vali Acc: 0.568 Test Loss: 1.537 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.555171251296997
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.586 Vali Acc: 0.595 Test Loss: 1.586 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.706982135772705
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.594 Vali Acc: 0.595 Test Loss: 1.594 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.6109287738800049
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.595 Vali Acc: 0.581 Test Loss: 1.595 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.4323315620422363
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.603 Vali Acc: 0.581 Test Loss: 1.603 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.763608455657959
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.619 Vali Acc: 0.581 Test Loss: 1.619 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.1919398307800293
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.625 Vali Acc: 0.581 Test Loss: 1.625 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.4168081283569336
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.638 Vali Acc: 0.581 Test Loss: 1.638 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.8442776203155518
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.639 Vali Acc: 0.581 Test Loss: 1.639 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 716188
model size : 4.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.6712591648101807
Epoch: 1, Steps: 10 | Train Loss: 1.508 Vali Loss: 1.421 Vali Acc: 0.189 Test Loss: 1.421 Test Acc: 0.189
Validation loss decreased (inf --> -0.189175).  Saving model ...
Epoch: 2 cost time: 1.7275593280792236
Epoch: 2, Steps: 10 | Train Loss: 1.417 Vali Loss: 1.400 Vali Acc: 0.324 Test Loss: 1.400 Test Acc: 0.324
Validation loss decreased (-0.189175 --> -0.324310).  Saving model ...
Epoch: 3 cost time: 1.7144429683685303
Epoch: 3, Steps: 10 | Train Loss: 1.237 Vali Loss: 1.560 Vali Acc: 0.257 Test Loss: 1.560 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3933346271514893
Epoch: 4, Steps: 10 | Train Loss: 1.188 Vali Loss: 1.213 Vali Acc: 0.459 Test Loss: 1.213 Test Acc: 0.459
Validation loss decreased (-0.324310 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 1.2612669467926025
Epoch: 5, Steps: 10 | Train Loss: 0.954 Vali Loss: 1.135 Vali Acc: 0.514 Test Loss: 1.135 Test Acc: 0.514
Validation loss decreased (-0.459447 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 1.307520866394043
Epoch: 6, Steps: 10 | Train Loss: 0.808 Vali Loss: 1.124 Vali Acc: 0.541 Test Loss: 1.124 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540529).  Saving model ...
Epoch: 7 cost time: 1.0327026844024658
Epoch: 7, Steps: 10 | Train Loss: 0.621 Vali Loss: 1.142 Vali Acc: 0.581 Test Loss: 1.142 Test Acc: 0.581
Validation loss decreased (-0.540529 --> -0.581070).  Saving model ...
Epoch: 8 cost time: 1.4086973667144775
Epoch: 8, Steps: 10 | Train Loss: 0.490 Vali Loss: 1.169 Vali Acc: 0.473 Test Loss: 1.169 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5226902961730957
Epoch: 9, Steps: 10 | Train Loss: 0.361 Vali Loss: 1.078 Vali Acc: 0.608 Test Loss: 1.078 Test Acc: 0.608
Validation loss decreased (-0.581070 --> -0.608097).  Saving model ...
Epoch: 10 cost time: 1.0488941669464111
Epoch: 10, Steps: 10 | Train Loss: 0.258 Vali Loss: 1.095 Vali Acc: 0.541 Test Loss: 1.095 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1902110576629639
Epoch: 11, Steps: 10 | Train Loss: 0.174 Vali Loss: 1.437 Vali Acc: 0.500 Test Loss: 1.437 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.460641622543335
Epoch: 12, Steps: 10 | Train Loss: 0.122 Vali Loss: 1.546 Vali Acc: 0.568 Test Loss: 1.546 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2636761665344238
Epoch: 13, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.406 Vali Acc: 0.581 Test Loss: 1.406 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.6315233707427979
Epoch: 14, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.420 Vali Acc: 0.568 Test Loss: 1.420 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.3905739784240723
Epoch: 15, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.432 Vali Acc: 0.541 Test Loss: 1.432 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.243478536605835
Epoch: 16, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.446 Vali Acc: 0.568 Test Loss: 1.446 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.4211387634277344
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.512 Vali Acc: 0.541 Test Loss: 1.512 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.509537935256958
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.561 Vali Acc: 0.527 Test Loss: 1.561 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.5323808193206787
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.577 Vali Acc: 0.581 Test Loss: 1.577 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 714012
model size : 4.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.2107298374176025
Epoch: 1, Steps: 10 | Train Loss: 1.517 Vali Loss: 1.453 Vali Acc: 0.203 Test Loss: 1.453 Test Acc: 0.203
Validation loss decreased (inf --> -0.202688).  Saving model ...
Epoch: 2 cost time: 1.4210240840911865
Epoch: 2, Steps: 10 | Train Loss: 1.478 Vali Loss: 1.415 Vali Acc: 0.270 Test Loss: 1.415 Test Acc: 0.270
Validation loss decreased (-0.202688 --> -0.270256).  Saving model ...
Epoch: 3 cost time: 1.3367319107055664
Epoch: 3, Steps: 10 | Train Loss: 1.315 Vali Loss: 1.449 Vali Acc: 0.378 Test Loss: 1.449 Test Acc: 0.378
Validation loss decreased (-0.270256 --> -0.378364).  Saving model ...
Epoch: 4 cost time: 1.4312825202941895
Epoch: 4, Steps: 10 | Train Loss: 1.121 Vali Loss: 1.490 Vali Acc: 0.324 Test Loss: 1.490 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6123719215393066
Epoch: 5, Steps: 10 | Train Loss: 1.014 Vali Loss: 1.205 Vali Acc: 0.446 Test Loss: 1.205 Test Acc: 0.446
Validation loss decreased (-0.378364 --> -0.445934).  Saving model ...
Epoch: 6 cost time: 1.284147024154663
Epoch: 6, Steps: 10 | Train Loss: 0.882 Vali Loss: 1.361 Vali Acc: 0.419 Test Loss: 1.361 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.570622444152832
Epoch: 7, Steps: 10 | Train Loss: 0.657 Vali Loss: 1.194 Vali Acc: 0.500 Test Loss: 1.194 Test Acc: 0.500
Validation loss decreased (-0.445934 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 1.668651819229126
Epoch: 8, Steps: 10 | Train Loss: 0.522 Vali Loss: 1.388 Vali Acc: 0.500 Test Loss: 1.388 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6763763427734375
Epoch: 9, Steps: 10 | Train Loss: 0.535 Vali Loss: 1.246 Vali Acc: 0.554 Test Loss: 1.246 Test Acc: 0.554
Validation loss decreased (-0.499988 --> -0.554042).  Saving model ...
Epoch: 10 cost time: 1.1880688667297363
Epoch: 10, Steps: 10 | Train Loss: 0.308 Vali Loss: 1.275 Vali Acc: 0.486 Test Loss: 1.275 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6994800567626953
Epoch: 11, Steps: 10 | Train Loss: 0.199 Vali Loss: 1.420 Vali Acc: 0.541 Test Loss: 1.420 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2929432392120361
Epoch: 12, Steps: 10 | Train Loss: 0.150 Vali Loss: 1.271 Vali Acc: 0.581 Test Loss: 1.271 Test Acc: 0.581
Validation loss decreased (-0.554042 --> -0.581068).  Saving model ...
Epoch: 13 cost time: 1.2590744495391846
Epoch: 13, Steps: 10 | Train Loss: 0.100 Vali Loss: 1.386 Vali Acc: 0.527 Test Loss: 1.386 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6258769035339355
Epoch: 14, Steps: 10 | Train Loss: 0.065 Vali Loss: 1.404 Vali Acc: 0.581 Test Loss: 1.404 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3408234119415283
Epoch: 15, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.556 Vali Acc: 0.527 Test Loss: 1.556 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.4190094470977783
Epoch: 16, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.803 Vali Acc: 0.595 Test Loss: 1.803 Test Acc: 0.595
Validation loss decreased (-0.581068 --> -0.594577).  Saving model ...
Epoch: 17 cost time: 1.7187249660491943
Epoch: 17, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.580 Vali Acc: 0.541 Test Loss: 1.580 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6417090892791748
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.687 Vali Acc: 0.568 Test Loss: 1.687 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.594984769821167
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.599 Vali Acc: 0.608 Test Loss: 1.599 Test Acc: 0.608
Validation loss decreased (-0.594577 --> -0.608092).  Saving model ...
Epoch: 20 cost time: 1.465174913406372
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.682 Vali Acc: 0.581 Test Loss: 1.682 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3564391136169434
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.715 Vali Acc: 0.581 Test Loss: 1.715 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.4474663734436035
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.693 Vali Acc: 0.608 Test Loss: 1.693 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.5063023567199707
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.661 Vali Acc: 0.608 Test Loss: 1.661 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.4306857585906982
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.676 Vali Acc: 0.595 Test Loss: 1.676 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.423168659210205
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.694 Vali Acc: 0.608 Test Loss: 1.694 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.3994474411010742
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.698 Vali Acc: 0.608 Test Loss: 1.698 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.6095764636993408
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.684 Vali Acc: 0.595 Test Loss: 1.684 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.695279598236084
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.689 Vali Acc: 0.595 Test Loss: 1.689 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.257425308227539
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.699 Vali Acc: 0.595 Test Loss: 1.699 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 711836
model size : 4.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.075563907623291
Epoch: 1, Steps: 10 | Train Loss: 1.542 Vali Loss: 1.523 Vali Acc: 0.189 Test Loss: 1.523 Test Acc: 0.189
Validation loss decreased (inf --> -0.189174).  Saving model ...
Epoch: 2 cost time: 1.3563692569732666
Epoch: 2, Steps: 10 | Train Loss: 1.428 Vali Loss: 1.336 Vali Acc: 0.351 Test Loss: 1.336 Test Acc: 0.351
Validation loss decreased (-0.189174 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 1.731966257095337
Epoch: 3, Steps: 10 | Train Loss: 1.247 Vali Loss: 1.499 Vali Acc: 0.365 Test Loss: 1.499 Test Acc: 0.365
Validation loss decreased (-0.351338 --> -0.364850).  Saving model ...
Epoch: 4 cost time: 2.022570848464966
Epoch: 4, Steps: 10 | Train Loss: 1.054 Vali Loss: 1.234 Vali Acc: 0.486 Test Loss: 1.234 Test Acc: 0.486
Validation loss decreased (-0.364850 --> -0.486474).  Saving model ...
Epoch: 5 cost time: 1.7390034198760986
Epoch: 5, Steps: 10 | Train Loss: 0.888 Vali Loss: 1.336 Vali Acc: 0.378 Test Loss: 1.336 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6995294094085693
Epoch: 6, Steps: 10 | Train Loss: 0.767 Vali Loss: 1.229 Vali Acc: 0.486 Test Loss: 1.229 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486474).  Saving model ...
Epoch: 7 cost time: 1.731158971786499
Epoch: 7, Steps: 10 | Train Loss: 0.623 Vali Loss: 1.739 Vali Acc: 0.338 Test Loss: 1.739 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4797627925872803
Epoch: 8, Steps: 10 | Train Loss: 0.571 Vali Loss: 1.321 Vali Acc: 0.514 Test Loss: 1.321 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513500).  Saving model ...
Epoch: 9 cost time: 1.610062837600708
Epoch: 9, Steps: 10 | Train Loss: 0.372 Vali Loss: 1.150 Vali Acc: 0.486 Test Loss: 1.150 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7041349411010742
Epoch: 10, Steps: 10 | Train Loss: 0.277 Vali Loss: 1.343 Vali Acc: 0.500 Test Loss: 1.343 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5011770725250244
Epoch: 11, Steps: 10 | Train Loss: 0.178 Vali Loss: 1.429 Vali Acc: 0.527 Test Loss: 1.429 Test Acc: 0.527
Validation loss decreased (-0.513500 --> -0.527013).  Saving model ...
Epoch: 12 cost time: 1.910417079925537
Epoch: 12, Steps: 10 | Train Loss: 0.128 Vali Loss: 1.306 Vali Acc: 0.541 Test Loss: 1.306 Test Acc: 0.541
Validation loss decreased (-0.527013 --> -0.540527).  Saving model ...
Epoch: 13 cost time: 1.426534652709961
Epoch: 13, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.343 Vali Acc: 0.527 Test Loss: 1.343 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.432995080947876
Epoch: 14, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.361 Vali Acc: 0.581 Test Loss: 1.361 Test Acc: 0.581
Validation loss decreased (-0.540527 --> -0.581067).  Saving model ...
Epoch: 15 cost time: 1.5706050395965576
Epoch: 15, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.532 Vali Acc: 0.581 Test Loss: 1.532 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.680274248123169
Epoch: 16, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.402 Vali Acc: 0.581 Test Loss: 1.402 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.8792009353637695
Epoch: 17, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.568 Vali Acc: 0.568 Test Loss: 1.568 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.8991165161132812
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.502 Vali Acc: 0.554 Test Loss: 1.502 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.7632646560668945
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.560 Vali Acc: 0.595 Test Loss: 1.560 Test Acc: 0.595
Validation loss decreased (-0.581067 --> -0.594579).  Saving model ...
Epoch: 20 cost time: 1.7939579486846924
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.590 Vali Acc: 0.568 Test Loss: 1.590 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.547888994216919
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.570 Vali Acc: 0.595 Test Loss: 1.570 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1982810497283936
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.576 Vali Acc: 0.541 Test Loss: 1.576 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.9211955070495605
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.621 Vali Acc: 0.568 Test Loss: 1.621 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.9461872577667236
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.604 Vali Acc: 0.568 Test Loss: 1.604 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.1731925010681152
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.633 Vali Acc: 0.554 Test Loss: 1.633 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.2760465145111084
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.654 Vali Acc: 0.554 Test Loss: 1.654 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.7102086544036865
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.649 Vali Acc: 0.554 Test Loss: 1.649 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.8043458461761475
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.662 Vali Acc: 0.554 Test Loss: 1.662 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.8068673610687256
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.684 Vali Acc: 0.568 Test Loss: 1.684 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 520220
model size : 3.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.22533917427063
Epoch: 1, Steps: 10 | Train Loss: 1.527 Vali Loss: 1.445 Vali Acc: 0.216 Test Loss: 1.445 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 1.8025553226470947
Epoch: 2, Steps: 10 | Train Loss: 1.365 Vali Loss: 1.598 Vali Acc: 0.203 Test Loss: 1.598 Test Acc: 0.203
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7953436374664307
Epoch: 3, Steps: 10 | Train Loss: 1.254 Vali Loss: 1.401 Vali Acc: 0.459 Test Loss: 1.401 Test Acc: 0.459
Validation loss decreased (-0.216202 --> -0.459445).  Saving model ...
Epoch: 4 cost time: 1.2380478382110596
Epoch: 4, Steps: 10 | Train Loss: 1.124 Vali Loss: 1.560 Vali Acc: 0.284 Test Loss: 1.560 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.346585750579834
Epoch: 5, Steps: 10 | Train Loss: 0.979 Vali Loss: 1.173 Vali Acc: 0.486 Test Loss: 1.173 Test Acc: 0.486
Validation loss decreased (-0.459445 --> -0.486475).  Saving model ...
Epoch: 6 cost time: 1.509763240814209
Epoch: 6, Steps: 10 | Train Loss: 0.843 Vali Loss: 1.132 Vali Acc: 0.527 Test Loss: 1.132 Test Acc: 0.527
Validation loss decreased (-0.486475 --> -0.527016).  Saving model ...
Epoch: 7 cost time: 1.3961622714996338
Epoch: 7, Steps: 10 | Train Loss: 0.615 Vali Loss: 1.380 Vali Acc: 0.392 Test Loss: 1.380 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3721532821655273
Epoch: 8, Steps: 10 | Train Loss: 0.536 Vali Loss: 1.125 Vali Acc: 0.500 Test Loss: 1.125 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6722450256347656
Epoch: 9, Steps: 10 | Train Loss: 0.363 Vali Loss: 1.262 Vali Acc: 0.554 Test Loss: 1.262 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554041).  Saving model ...
Epoch: 10 cost time: 1.5629303455352783
Epoch: 10, Steps: 10 | Train Loss: 0.264 Vali Loss: 1.156 Vali Acc: 0.554 Test Loss: 1.156 Test Acc: 0.554
Validation loss decreased (-0.554041 --> -0.554042).  Saving model ...
Epoch: 11 cost time: 1.5510468482971191
Epoch: 11, Steps: 10 | Train Loss: 0.194 Vali Loss: 1.236 Vali Acc: 0.595 Test Loss: 1.236 Test Acc: 0.595
Validation loss decreased (-0.554042 --> -0.594582).  Saving model ...
Epoch: 12 cost time: 1.4231505393981934
Epoch: 12, Steps: 10 | Train Loss: 0.139 Vali Loss: 1.495 Vali Acc: 0.459 Test Loss: 1.495 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2946219444274902
Epoch: 13, Steps: 10 | Train Loss: 0.100 Vali Loss: 1.310 Vali Acc: 0.554 Test Loss: 1.310 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2914917469024658
Epoch: 14, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.354 Vali Acc: 0.554 Test Loss: 1.354 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3260600566864014
Epoch: 15, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.366 Vali Acc: 0.527 Test Loss: 1.366 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.348026990890503
Epoch: 16, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.626 Vali Acc: 0.541 Test Loss: 1.626 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.3253705501556396
Epoch: 17, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.466 Vali Acc: 0.514 Test Loss: 1.466 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.2915210723876953
Epoch: 18, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.534 Vali Acc: 0.527 Test Loss: 1.534 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.349874496459961
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.523 Vali Acc: 0.568 Test Loss: 1.523 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.690323829650879
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.759 Vali Acc: 0.568 Test Loss: 1.759 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.3453938961029053
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.598 Vali Acc: 0.595 Test Loss: 1.598 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 518044
model size : 3.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.2769370079040527
Epoch: 1, Steps: 10 | Train Loss: 1.446 Vali Loss: 1.345 Vali Acc: 0.419 Test Loss: 1.345 Test Acc: 0.419
Validation loss decreased (inf --> -0.418905).  Saving model ...
Epoch: 2 cost time: 1.1856601238250732
Epoch: 2, Steps: 10 | Train Loss: 1.429 Vali Loss: 1.389 Vali Acc: 0.378 Test Loss: 1.389 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.739563226699829
Epoch: 3, Steps: 10 | Train Loss: 1.234 Vali Loss: 1.277 Vali Acc: 0.473 Test Loss: 1.277 Test Acc: 0.473
Validation loss decreased (-0.418905 --> -0.472960).  Saving model ...
Epoch: 4 cost time: 1.463233470916748
Epoch: 4, Steps: 10 | Train Loss: 1.100 Vali Loss: 1.228 Vali Acc: 0.419 Test Loss: 1.228 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6386325359344482
Epoch: 5, Steps: 10 | Train Loss: 0.882 Vali Loss: 1.112 Vali Acc: 0.541 Test Loss: 1.112 Test Acc: 0.541
Validation loss decreased (-0.472960 --> -0.540529).  Saving model ...
Epoch: 6 cost time: 1.2879674434661865
Epoch: 6, Steps: 10 | Train Loss: 0.885 Vali Loss: 1.636 Vali Acc: 0.257 Test Loss: 1.636 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6192004680633545
Epoch: 7, Steps: 10 | Train Loss: 0.760 Vali Loss: 1.325 Vali Acc: 0.419 Test Loss: 1.325 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.612621545791626
Epoch: 8, Steps: 10 | Train Loss: 0.584 Vali Loss: 1.090 Vali Acc: 0.554 Test Loss: 1.090 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554043).  Saving model ...
Epoch: 9 cost time: 1.5694637298583984
Epoch: 9, Steps: 10 | Train Loss: 0.427 Vali Loss: 1.096 Vali Acc: 0.554 Test Loss: 1.096 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5223052501678467
Epoch: 10, Steps: 10 | Train Loss: 0.341 Vali Loss: 1.076 Vali Acc: 0.554 Test Loss: 1.076 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554043).  Saving model ...
Epoch: 11 cost time: 1.4090745449066162
Epoch: 11, Steps: 10 | Train Loss: 0.230 Vali Loss: 1.226 Vali Acc: 0.568 Test Loss: 1.226 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567555).  Saving model ...
Epoch: 12 cost time: 1.3054406642913818
Epoch: 12, Steps: 10 | Train Loss: 0.178 Vali Loss: 1.419 Vali Acc: 0.568 Test Loss: 1.419 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5137062072753906
Epoch: 13, Steps: 10 | Train Loss: 0.120 Vali Loss: 1.415 Vali Acc: 0.514 Test Loss: 1.415 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.6225438117980957
Epoch: 14, Steps: 10 | Train Loss: 0.085 Vali Loss: 1.620 Vali Acc: 0.514 Test Loss: 1.620 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6474418640136719
Epoch: 15, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.560 Vali Acc: 0.541 Test Loss: 1.560 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.6254239082336426
Epoch: 16, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.633 Vali Acc: 0.514 Test Loss: 1.633 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.6494510173797607
Epoch: 17, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.688 Vali Acc: 0.554 Test Loss: 1.688 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.3867216110229492
Epoch: 18, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.715 Vali Acc: 0.527 Test Loss: 1.715 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.9992926120758057
Epoch: 19, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.636 Vali Acc: 0.500 Test Loss: 1.636 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.4246673583984375
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.642 Vali Acc: 0.527 Test Loss: 1.642 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.204531192779541
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.787 Vali Acc: 0.554 Test Loss: 1.787 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 515868
model size : 3.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.305842161178589
Epoch: 1, Steps: 10 | Train Loss: 1.441 Vali Loss: 1.374 Vali Acc: 0.365 Test Loss: 1.374 Test Acc: 0.365
Validation loss decreased (inf --> -0.364851).  Saving model ...
Epoch: 2 cost time: 1.4812757968902588
Epoch: 2, Steps: 10 | Train Loss: 1.354 Vali Loss: 1.336 Vali Acc: 0.297 Test Loss: 1.336 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6236519813537598
Epoch: 3, Steps: 10 | Train Loss: 1.269 Vali Loss: 1.262 Vali Acc: 0.378 Test Loss: 1.262 Test Acc: 0.378
Validation loss decreased (-0.364851 --> -0.378366).  Saving model ...
Epoch: 4 cost time: 1.2439000606536865
Epoch: 4, Steps: 10 | Train Loss: 1.184 Vali Loss: 1.250 Vali Acc: 0.486 Test Loss: 1.250 Test Acc: 0.486
Validation loss decreased (-0.378366 --> -0.486474).  Saving model ...
Epoch: 5 cost time: 1.0705633163452148
Epoch: 5, Steps: 10 | Train Loss: 0.959 Vali Loss: 1.298 Vali Acc: 0.446 Test Loss: 1.298 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.499098777770996
Epoch: 6, Steps: 10 | Train Loss: 0.809 Vali Loss: 1.156 Vali Acc: 0.486 Test Loss: 1.156 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486475).  Saving model ...
Epoch: 7 cost time: 1.4363572597503662
Epoch: 7, Steps: 10 | Train Loss: 0.630 Vali Loss: 1.233 Vali Acc: 0.486 Test Loss: 1.233 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7963433265686035
Epoch: 8, Steps: 10 | Train Loss: 0.534 Vali Loss: 1.224 Vali Acc: 0.514 Test Loss: 1.224 Test Acc: 0.514
Validation loss decreased (-0.486475 --> -0.513501).  Saving model ...
Epoch: 9 cost time: 1.3680777549743652
Epoch: 9, Steps: 10 | Train Loss: 0.403 Vali Loss: 1.184 Vali Acc: 0.473 Test Loss: 1.184 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5376567840576172
Epoch: 10, Steps: 10 | Train Loss: 0.264 Vali Loss: 1.263 Vali Acc: 0.514 Test Loss: 1.263 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2125895023345947
Epoch: 11, Steps: 10 | Train Loss: 0.209 Vali Loss: 1.310 Vali Acc: 0.486 Test Loss: 1.310 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1487245559692383
Epoch: 12, Steps: 10 | Train Loss: 0.134 Vali Loss: 1.529 Vali Acc: 0.473 Test Loss: 1.529 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.5117814540863037
Epoch: 13, Steps: 10 | Train Loss: 0.077 Vali Loss: 1.714 Vali Acc: 0.527 Test Loss: 1.714 Test Acc: 0.527
Validation loss decreased (-0.513501 --> -0.527010).  Saving model ...
Epoch: 14 cost time: 1.4098215103149414
Epoch: 14, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.485 Vali Acc: 0.541 Test Loss: 1.485 Test Acc: 0.541
Validation loss decreased (-0.527010 --> -0.540526).  Saving model ...
Epoch: 15 cost time: 1.1560750007629395
Epoch: 15, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.495 Vali Acc: 0.581 Test Loss: 1.495 Test Acc: 0.581
Validation loss decreased (-0.540526 --> -0.581066).  Saving model ...
Epoch: 16 cost time: 1.397150993347168
Epoch: 16, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.528 Vali Acc: 0.595 Test Loss: 1.528 Test Acc: 0.595
Validation loss decreased (-0.581066 --> -0.594579).  Saving model ...
Epoch: 17 cost time: 1.474677562713623
Epoch: 17, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.638 Vali Acc: 0.581 Test Loss: 1.638 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8975613117218018
Epoch: 18, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.505 Vali Acc: 0.568 Test Loss: 1.505 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.0877437591552734
Epoch: 19, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.610 Vali Acc: 0.554 Test Loss: 1.610 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.621246099472046
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.873 Vali Acc: 0.527 Test Loss: 1.873 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.651735544204712
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.646 Vali Acc: 0.527 Test Loss: 1.646 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.8735857009887695
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.736 Vali Acc: 0.527 Test Loss: 1.736 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.7434720993041992
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.823 Vali Acc: 0.527 Test Loss: 1.823 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.0666332244873047
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.806 Vali Acc: 0.514 Test Loss: 1.806 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.201693058013916
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.781 Vali Acc: 0.527 Test Loss: 1.781 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.487943410873413
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.766 Vali Acc: 0.514 Test Loss: 1.766 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 513692
model size : 3.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.471498966217041
Epoch: 1, Steps: 10 | Train Loss: 1.492 Vali Loss: 1.452 Vali Acc: 0.189 Test Loss: 1.452 Test Acc: 0.189
Validation loss decreased (inf --> -0.189175).  Saving model ...
Epoch: 2 cost time: 2.075438976287842
Epoch: 2, Steps: 10 | Train Loss: 1.490 Vali Loss: 1.292 Vali Acc: 0.473 Test Loss: 1.292 Test Acc: 0.473
Validation loss decreased (-0.189175 --> -0.472960).  Saving model ...
Epoch: 3 cost time: 1.1073150634765625
Epoch: 3, Steps: 10 | Train Loss: 1.317 Vali Loss: 1.239 Vali Acc: 0.514 Test Loss: 1.239 Test Acc: 0.514
Validation loss decreased (-0.472960 --> -0.513501).  Saving model ...
Epoch: 4 cost time: 1.8485362529754639
Epoch: 4, Steps: 10 | Train Loss: 1.137 Vali Loss: 1.202 Vali Acc: 0.446 Test Loss: 1.202 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7361822128295898
Epoch: 5, Steps: 10 | Train Loss: 1.088 Vali Loss: 1.535 Vali Acc: 0.311 Test Loss: 1.535 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.570220947265625
Epoch: 6, Steps: 10 | Train Loss: 0.857 Vali Loss: 1.162 Vali Acc: 0.473 Test Loss: 1.162 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5719175338745117
Epoch: 7, Steps: 10 | Train Loss: 0.787 Vali Loss: 1.359 Vali Acc: 0.351 Test Loss: 1.359 Test Acc: 0.351
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.6788272857666016
Epoch: 8, Steps: 10 | Train Loss: 0.620 Vali Loss: 1.431 Vali Acc: 0.392 Test Loss: 1.431 Test Acc: 0.392
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.3889100551605225
Epoch: 9, Steps: 10 | Train Loss: 0.560 Vali Loss: 1.138 Vali Acc: 0.446 Test Loss: 1.138 Test Acc: 0.446
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.11525559425354
Epoch: 10, Steps: 10 | Train Loss: 0.408 Vali Loss: 1.042 Vali Acc: 0.541 Test Loss: 1.042 Test Acc: 0.541
Validation loss decreased (-0.513501 --> -0.540530).  Saving model ...
Epoch: 11 cost time: 1.8615927696228027
Epoch: 11, Steps: 10 | Train Loss: 0.265 Vali Loss: 1.149 Vali Acc: 0.554 Test Loss: 1.149 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554043).  Saving model ...
Epoch: 12 cost time: 1.4763681888580322
Epoch: 12, Steps: 10 | Train Loss: 0.193 Vali Loss: 1.129 Vali Acc: 0.581 Test Loss: 1.129 Test Acc: 0.581
Validation loss decreased (-0.554043 --> -0.581070).  Saving model ...
Epoch: 13 cost time: 1.7642436027526855
Epoch: 13, Steps: 10 | Train Loss: 0.160 Vali Loss: 1.329 Vali Acc: 0.527 Test Loss: 1.329 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1443912982940674
Epoch: 14, Steps: 10 | Train Loss: 0.100 Vali Loss: 1.343 Vali Acc: 0.581 Test Loss: 1.343 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.50532865524292
Epoch: 15, Steps: 10 | Train Loss: 0.072 Vali Loss: 1.229 Vali Acc: 0.581 Test Loss: 1.229 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.7339189052581787
Epoch: 16, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.331 Vali Acc: 0.581 Test Loss: 1.331 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.4064412117004395
Epoch: 17, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.442 Vali Acc: 0.622 Test Loss: 1.442 Test Acc: 0.622
Validation loss decreased (-0.581070 --> -0.621607).  Saving model ...
Epoch: 18 cost time: 1.649960994720459
Epoch: 18, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.413 Vali Acc: 0.554 Test Loss: 1.413 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.640627145767212
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.588 Vali Acc: 0.581 Test Loss: 1.588 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2776637077331543
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.461 Vali Acc: 0.595 Test Loss: 1.461 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.0418732166290283
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.535 Vali Acc: 0.595 Test Loss: 1.535 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.7351810932159424
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.532 Vali Acc: 0.595 Test Loss: 1.532 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.4523670673370361
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.519 Vali Acc: 0.595 Test Loss: 1.519 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.8177571296691895
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.548 Vali Acc: 0.595 Test Loss: 1.548 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.5568149089813232
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.543 Vali Acc: 0.595 Test Loss: 1.543 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.5392603874206543
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.546 Vali Acc: 0.595 Test Loss: 1.546 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.630958080291748
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.561 Vali Acc: 0.595 Test Loss: 1.561 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 421148
model size : 2.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.1790008544921875
Epoch: 1, Steps: 10 | Train Loss: 1.537 Vali Loss: 1.562 Vali Acc: 0.216 Test Loss: 1.562 Test Acc: 0.216
Validation loss decreased (inf --> -0.216201).  Saving model ...
Epoch: 2 cost time: 1.6365022659301758
Epoch: 2, Steps: 10 | Train Loss: 1.490 Vali Loss: 1.348 Vali Acc: 0.378 Test Loss: 1.348 Test Acc: 0.378
Validation loss decreased (-0.216201 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 1.692244291305542
Epoch: 3, Steps: 10 | Train Loss: 1.270 Vali Loss: 1.376 Vali Acc: 0.324 Test Loss: 1.376 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3232700824737549
Epoch: 4, Steps: 10 | Train Loss: 1.094 Vali Loss: 1.218 Vali Acc: 0.514 Test Loss: 1.218 Test Acc: 0.514
Validation loss decreased (-0.378365 --> -0.513501).  Saving model ...
Epoch: 5 cost time: 1.6435644626617432
Epoch: 5, Steps: 10 | Train Loss: 1.035 Vali Loss: 1.316 Vali Acc: 0.500 Test Loss: 1.316 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2444219589233398
Epoch: 6, Steps: 10 | Train Loss: 0.785 Vali Loss: 1.212 Vali Acc: 0.459 Test Loss: 1.212 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.592237949371338
Epoch: 7, Steps: 10 | Train Loss: 0.716 Vali Loss: 1.277 Vali Acc: 0.419 Test Loss: 1.277 Test Acc: 0.419
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3543589115142822
Epoch: 8, Steps: 10 | Train Loss: 0.533 Vali Loss: 1.213 Vali Acc: 0.486 Test Loss: 1.213 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.3514196872711182
Epoch: 9, Steps: 10 | Train Loss: 0.491 Vali Loss: 1.310 Vali Acc: 0.500 Test Loss: 1.310 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.315727710723877
Epoch: 10, Steps: 10 | Train Loss: 0.405 Vali Loss: 1.329 Vali Acc: 0.473 Test Loss: 1.329 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.2208251953125
Epoch: 11, Steps: 10 | Train Loss: 0.256 Vali Loss: 1.198 Vali Acc: 0.554 Test Loss: 1.198 Test Acc: 0.554
Validation loss decreased (-0.513501 --> -0.554042).  Saving model ...
Epoch: 12 cost time: 1.1735107898712158
Epoch: 12, Steps: 10 | Train Loss: 0.156 Vali Loss: 1.063 Vali Acc: 0.581 Test Loss: 1.063 Test Acc: 0.581
Validation loss decreased (-0.554042 --> -0.581070).  Saving model ...
Epoch: 13 cost time: 1.5732731819152832
Epoch: 13, Steps: 10 | Train Loss: 0.109 Vali Loss: 1.283 Vali Acc: 0.527 Test Loss: 1.283 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7433862686157227
Epoch: 14, Steps: 10 | Train Loss: 0.086 Vali Loss: 1.456 Vali Acc: 0.541 Test Loss: 1.456 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1229846477508545
Epoch: 15, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.491 Vali Acc: 0.568 Test Loss: 1.491 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.509831190109253
Epoch: 16, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.344 Vali Acc: 0.595 Test Loss: 1.344 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594581).  Saving model ...
Epoch: 17 cost time: 1.3963909149169922
Epoch: 17, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.458 Vali Acc: 0.595 Test Loss: 1.458 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4905438423156738
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.412 Vali Acc: 0.608 Test Loss: 1.412 Test Acc: 0.608
Validation loss decreased (-0.594581 --> -0.608094).  Saving model ...
Epoch: 19 cost time: 1.6961214542388916
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.518 Vali Acc: 0.608 Test Loss: 1.518 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.208303451538086
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.478 Vali Acc: 0.595 Test Loss: 1.478 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5595355033874512
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.506 Vali Acc: 0.622 Test Loss: 1.506 Test Acc: 0.622
Validation loss decreased (-0.608094 --> -0.621607).  Saving model ...
Epoch: 22 cost time: 1.265399694442749
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.511 Vali Acc: 0.608 Test Loss: 1.511 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.685981035232544
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.545 Vali Acc: 0.622 Test Loss: 1.545 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.2475340366363525
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.522 Vali Acc: 0.608 Test Loss: 1.522 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0605406761169434
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.539 Vali Acc: 0.622 Test Loss: 1.539 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.662583827972412
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.577 Vali Acc: 0.608 Test Loss: 1.577 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.5912294387817383
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.563 Vali Acc: 0.622 Test Loss: 1.563 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.7781872749328613
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.593 Vali Acc: 0.608 Test Loss: 1.593 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.7755358219146729
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.583 Vali Acc: 0.622 Test Loss: 1.583 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.3919148445129395
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.581 Vali Acc: 0.622 Test Loss: 1.581 Test Acc: 0.622
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.3882193565368652
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.618 Vali Acc: 0.608 Test Loss: 1.618 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 418972
model size : 2.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.481658935546875
Epoch: 1, Steps: 10 | Train Loss: 1.563 Vali Loss: 1.497 Vali Acc: 0.203 Test Loss: 1.497 Test Acc: 0.203
Validation loss decreased (inf --> -0.202688).  Saving model ...
Epoch: 2 cost time: 1.7390425205230713
Epoch: 2, Steps: 10 | Train Loss: 1.426 Vali Loss: 1.349 Vali Acc: 0.432 Test Loss: 1.349 Test Acc: 0.432
Validation loss decreased (-0.202688 --> -0.432419).  Saving model ...
Epoch: 3 cost time: 1.2305121421813965
Epoch: 3, Steps: 10 | Train Loss: 1.278 Vali Loss: 1.530 Vali Acc: 0.243 Test Loss: 1.530 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5743725299835205
Epoch: 4, Steps: 10 | Train Loss: 1.102 Vali Loss: 1.225 Vali Acc: 0.473 Test Loss: 1.225 Test Acc: 0.473
Validation loss decreased (-0.432419 --> -0.472961).  Saving model ...
Epoch: 5 cost time: 1.4488472938537598
Epoch: 5, Steps: 10 | Train Loss: 1.093 Vali Loss: 1.463 Vali Acc: 0.365 Test Loss: 1.463 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.505100965499878
Epoch: 6, Steps: 10 | Train Loss: 0.923 Vali Loss: 1.163 Vali Acc: 0.527 Test Loss: 1.163 Test Acc: 0.527
Validation loss decreased (-0.472961 --> -0.527015).  Saving model ...
Epoch: 7 cost time: 1.7898004055023193
Epoch: 7, Steps: 10 | Train Loss: 0.660 Vali Loss: 1.086 Vali Acc: 0.541 Test Loss: 1.086 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540530).  Saving model ...
Epoch: 8 cost time: 1.5956885814666748
Epoch: 8, Steps: 10 | Train Loss: 0.559 Vali Loss: 1.226 Vali Acc: 0.514 Test Loss: 1.226 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7048554420471191
Epoch: 9, Steps: 10 | Train Loss: 0.472 Vali Loss: 1.191 Vali Acc: 0.554 Test Loss: 1.191 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554042).  Saving model ...
Epoch: 10 cost time: 1.5061445236206055
Epoch: 10, Steps: 10 | Train Loss: 0.369 Vali Loss: 1.228 Vali Acc: 0.541 Test Loss: 1.228 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6449780464172363
Epoch: 11, Steps: 10 | Train Loss: 0.240 Vali Loss: 1.107 Vali Acc: 0.608 Test Loss: 1.107 Test Acc: 0.608
Validation loss decreased (-0.554042 --> -0.608097).  Saving model ...
Epoch: 12 cost time: 1.3975682258605957
Epoch: 12, Steps: 10 | Train Loss: 0.169 Vali Loss: 1.175 Vali Acc: 0.568 Test Loss: 1.175 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.589989423751831
Epoch: 13, Steps: 10 | Train Loss: 0.102 Vali Loss: 1.296 Vali Acc: 0.486 Test Loss: 1.296 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5694043636322021
Epoch: 14, Steps: 10 | Train Loss: 0.083 Vali Loss: 1.402 Vali Acc: 0.514 Test Loss: 1.402 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5721442699432373
Epoch: 15, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.325 Vali Acc: 0.568 Test Loss: 1.325 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.3952174186706543
Epoch: 16, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.568 Vali Acc: 0.541 Test Loss: 1.568 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.3306386470794678
Epoch: 17, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.482 Vali Acc: 0.568 Test Loss: 1.482 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.9981439113616943
Epoch: 18, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.515 Vali Acc: 0.581 Test Loss: 1.515 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.7260332107543945
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.509 Vali Acc: 0.554 Test Loss: 1.509 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.2566497325897217
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.543 Vali Acc: 0.554 Test Loss: 1.543 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.52005934715271
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.573 Vali Acc: 0.554 Test Loss: 1.573 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 416796
model size : 2.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.492745876312256
Epoch: 1, Steps: 10 | Train Loss: 1.487 Vali Loss: 1.392 Vali Acc: 0.338 Test Loss: 1.392 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 1.3968021869659424
Epoch: 2, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.361 Vali Acc: 0.338 Test Loss: 1.361 Test Acc: 0.338
Validation loss decreased (-0.337824 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 1.633018970489502
Epoch: 3, Steps: 10 | Train Loss: 1.281 Vali Loss: 1.557 Vali Acc: 0.230 Test Loss: 1.557 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8389179706573486
Epoch: 4, Steps: 10 | Train Loss: 1.134 Vali Loss: 1.160 Vali Acc: 0.486 Test Loss: 1.160 Test Acc: 0.486
Validation loss decreased (-0.337824 --> -0.486475).  Saving model ...
Epoch: 5 cost time: 1.1802513599395752
Epoch: 5, Steps: 10 | Train Loss: 1.076 Vali Loss: 1.238 Vali Acc: 0.459 Test Loss: 1.238 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3644311428070068
Epoch: 6, Steps: 10 | Train Loss: 0.841 Vali Loss: 1.230 Vali Acc: 0.514 Test Loss: 1.230 Test Acc: 0.514
Validation loss decreased (-0.486475 --> -0.513501).  Saving model ...
Epoch: 7 cost time: 1.6062262058258057
Epoch: 7, Steps: 10 | Train Loss: 0.804 Vali Loss: 1.105 Vali Acc: 0.486 Test Loss: 1.105 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3343040943145752
Epoch: 8, Steps: 10 | Train Loss: 0.611 Vali Loss: 1.274 Vali Acc: 0.405 Test Loss: 1.274 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4749910831451416
Epoch: 9, Steps: 10 | Train Loss: 0.547 Vali Loss: 1.211 Vali Acc: 0.473 Test Loss: 1.211 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4555511474609375
Epoch: 10, Steps: 10 | Train Loss: 0.402 Vali Loss: 1.149 Vali Acc: 0.473 Test Loss: 1.149 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1198017597198486
Epoch: 11, Steps: 10 | Train Loss: 0.343 Vali Loss: 1.152 Vali Acc: 0.581 Test Loss: 1.152 Test Acc: 0.581
Validation loss decreased (-0.513501 --> -0.581070).  Saving model ...
Epoch: 12 cost time: 1.5919511318206787
Epoch: 12, Steps: 10 | Train Loss: 0.248 Vali Loss: 1.308 Vali Acc: 0.541 Test Loss: 1.308 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.568145513534546
Epoch: 13, Steps: 10 | Train Loss: 0.146 Vali Loss: 1.216 Vali Acc: 0.554 Test Loss: 1.216 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3663396835327148
Epoch: 14, Steps: 10 | Train Loss: 0.090 Vali Loss: 1.279 Vali Acc: 0.541 Test Loss: 1.279 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3496804237365723
Epoch: 15, Steps: 10 | Train Loss: 0.066 Vali Loss: 1.217 Vali Acc: 0.608 Test Loss: 1.217 Test Acc: 0.608
Validation loss decreased (-0.581070 --> -0.608096).  Saving model ...
Epoch: 16 cost time: 1.5088977813720703
Epoch: 16, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.453 Vali Acc: 0.554 Test Loss: 1.453 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4928457736968994
Epoch: 17, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.736 Vali Acc: 0.527 Test Loss: 1.736 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.6154260635375977
Epoch: 18, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.446 Vali Acc: 0.514 Test Loss: 1.446 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.5743000507354736
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.482 Vali Acc: 0.541 Test Loss: 1.482 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.5019891262054443
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.502 Vali Acc: 0.568 Test Loss: 1.502 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.784898281097412
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.579 Vali Acc: 0.541 Test Loss: 1.579 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.6966562271118164
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.544 Vali Acc: 0.568 Test Loss: 1.544 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.467651605606079
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.539 Vali Acc: 0.581 Test Loss: 1.539 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.866206169128418
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.574 Vali Acc: 0.554 Test Loss: 1.574 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.550788402557373
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.568 Vali Acc: 0.554 Test Loss: 1.568 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 414620
model size : 2.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.4699857234954834
Epoch: 1, Steps: 10 | Train Loss: 1.443 Vali Loss: 1.454 Vali Acc: 0.203 Test Loss: 1.454 Test Acc: 0.203
Validation loss decreased (inf --> -0.202688).  Saving model ...
Epoch: 2 cost time: 1.6123168468475342
Epoch: 2, Steps: 10 | Train Loss: 1.341 Vali Loss: 1.303 Vali Acc: 0.392 Test Loss: 1.303 Test Acc: 0.392
Validation loss decreased (-0.202688 --> -0.391879).  Saving model ...
Epoch: 3 cost time: 1.7901973724365234
Epoch: 3, Steps: 10 | Train Loss: 1.230 Vali Loss: 1.545 Vali Acc: 0.203 Test Loss: 1.545 Test Acc: 0.203
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3416380882263184
Epoch: 4, Steps: 10 | Train Loss: 1.264 Vali Loss: 1.436 Vali Acc: 0.459 Test Loss: 1.436 Test Acc: 0.459
Validation loss decreased (-0.391879 --> -0.459445).  Saving model ...
Epoch: 5 cost time: 1.605672836303711
Epoch: 5, Steps: 10 | Train Loss: 1.156 Vali Loss: 1.424 Vali Acc: 0.284 Test Loss: 1.424 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.768996238708496
Epoch: 6, Steps: 10 | Train Loss: 0.999 Vali Loss: 1.891 Vali Acc: 0.351 Test Loss: 1.891 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4465734958648682
Epoch: 7, Steps: 10 | Train Loss: 0.955 Vali Loss: 1.265 Vali Acc: 0.514 Test Loss: 1.265 Test Acc: 0.514
Validation loss decreased (-0.459445 --> -0.513501).  Saving model ...
Epoch: 8 cost time: 1.6118228435516357
Epoch: 8, Steps: 10 | Train Loss: 0.739 Vali Loss: 1.168 Vali Acc: 0.514 Test Loss: 1.168 Test Acc: 0.514
Validation loss decreased (-0.513501 --> -0.513502).  Saving model ...
Epoch: 9 cost time: 1.5012662410736084
Epoch: 9, Steps: 10 | Train Loss: 0.506 Vali Loss: 1.362 Vali Acc: 0.432 Test Loss: 1.362 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1875596046447754
Epoch: 10, Steps: 10 | Train Loss: 0.418 Vali Loss: 1.183 Vali Acc: 0.514 Test Loss: 1.183 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8211708068847656
Epoch: 11, Steps: 10 | Train Loss: 0.309 Vali Loss: 1.323 Vali Acc: 0.419 Test Loss: 1.323 Test Acc: 0.419
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3236083984375
Epoch: 12, Steps: 10 | Train Loss: 0.212 Vali Loss: 1.169 Vali Acc: 0.541 Test Loss: 1.169 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540529).  Saving model ...
Epoch: 13 cost time: 1.2485854625701904
Epoch: 13, Steps: 10 | Train Loss: 0.139 Vali Loss: 1.295 Vali Acc: 0.595 Test Loss: 1.295 Test Acc: 0.595
Validation loss decreased (-0.540529 --> -0.594582).  Saving model ...
Epoch: 14 cost time: 1.6267917156219482
Epoch: 14, Steps: 10 | Train Loss: 0.109 Vali Loss: 1.676 Vali Acc: 0.473 Test Loss: 1.676 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5997951030731201
Epoch: 15, Steps: 10 | Train Loss: 0.108 Vali Loss: 1.410 Vali Acc: 0.541 Test Loss: 1.410 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.76475191116333
Epoch: 16, Steps: 10 | Train Loss: 0.076 Vali Loss: 1.363 Vali Acc: 0.635 Test Loss: 1.363 Test Acc: 0.635
Validation loss decreased (-0.594582 --> -0.635122).  Saving model ...
Epoch: 17 cost time: 1.4645931720733643
Epoch: 17, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.471 Vali Acc: 0.527 Test Loss: 1.471 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6371302604675293
Epoch: 18, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.485 Vali Acc: 0.554 Test Loss: 1.485 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.741145372390747
Epoch: 19, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.555 Vali Acc: 0.568 Test Loss: 1.555 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.710780143737793
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.525 Vali Acc: 0.595 Test Loss: 1.525 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.7698802947998047
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.641 Vali Acc: 0.568 Test Loss: 1.641 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.6255950927734375
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.595 Vali Acc: 0.581 Test Loss: 1.595 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.4874064922332764
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.587 Vali Acc: 0.595 Test Loss: 1.587 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.5877506732940674
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.602 Vali Acc: 0.595 Test Loss: 1.602 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.6403734683990479
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.623 Vali Acc: 0.568 Test Loss: 1.623 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.6520724296569824
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.619 Vali Acc: 0.581 Test Loss: 1.619 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 371612
model size : 2.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.3373920917510986
Epoch: 1, Steps: 10 | Train Loss: 1.476 Vali Loss: 1.478 Vali Acc: 0.162 Test Loss: 1.478 Test Acc: 0.162
Validation loss decreased (inf --> -0.162147).  Saving model ...
Epoch: 2 cost time: 1.149165153503418
Epoch: 2, Steps: 10 | Train Loss: 1.374 Vali Loss: 1.350 Vali Acc: 0.324 Test Loss: 1.350 Test Acc: 0.324
Validation loss decreased (-0.162147 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 1.3315832614898682
Epoch: 3, Steps: 10 | Train Loss: 1.279 Vali Loss: 1.777 Vali Acc: 0.230 Test Loss: 1.777 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.388956069946289
Epoch: 4, Steps: 10 | Train Loss: 1.201 Vali Loss: 1.429 Vali Acc: 0.432 Test Loss: 1.429 Test Acc: 0.432
Validation loss decreased (-0.324311 --> -0.432418).  Saving model ...
Epoch: 5 cost time: 1.012080430984497
Epoch: 5, Steps: 10 | Train Loss: 1.079 Vali Loss: 1.295 Vali Acc: 0.486 Test Loss: 1.295 Test Acc: 0.486
Validation loss decreased (-0.432418 --> -0.486474).  Saving model ...
Epoch: 6 cost time: 1.2710402011871338
Epoch: 6, Steps: 10 | Train Loss: 0.897 Vali Loss: 1.153 Vali Acc: 0.473 Test Loss: 1.153 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5562841892242432
Epoch: 7, Steps: 10 | Train Loss: 0.762 Vali Loss: 1.178 Vali Acc: 0.446 Test Loss: 1.178 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.464700698852539
Epoch: 8, Steps: 10 | Train Loss: 0.709 Vali Loss: 1.195 Vali Acc: 0.486 Test Loss: 1.195 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486475).  Saving model ...
Epoch: 9 cost time: 1.73915433883667
Epoch: 9, Steps: 10 | Train Loss: 0.666 Vali Loss: 1.124 Vali Acc: 0.527 Test Loss: 1.124 Test Acc: 0.527
Validation loss decreased (-0.486475 --> -0.527016).  Saving model ...
Epoch: 10 cost time: 1.5756397247314453
Epoch: 10, Steps: 10 | Train Loss: 0.466 Vali Loss: 1.091 Vali Acc: 0.568 Test Loss: 1.091 Test Acc: 0.568
Validation loss decreased (-0.527016 --> -0.567557).  Saving model ...
Epoch: 11 cost time: 1.5525150299072266
Epoch: 11, Steps: 10 | Train Loss: 0.334 Vali Loss: 1.244 Vali Acc: 0.514 Test Loss: 1.244 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7407801151275635
Epoch: 12, Steps: 10 | Train Loss: 0.253 Vali Loss: 1.483 Vali Acc: 0.473 Test Loss: 1.483 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3884170055389404
Epoch: 13, Steps: 10 | Train Loss: 0.206 Vali Loss: 1.376 Vali Acc: 0.500 Test Loss: 1.376 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.6734282970428467
Epoch: 14, Steps: 10 | Train Loss: 0.166 Vali Loss: 1.496 Vali Acc: 0.446 Test Loss: 1.496 Test Acc: 0.446
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2886836528778076
Epoch: 15, Steps: 10 | Train Loss: 0.093 Vali Loss: 1.220 Vali Acc: 0.608 Test Loss: 1.220 Test Acc: 0.608
Validation loss decreased (-0.567557 --> -0.608096).  Saving model ...
Epoch: 16 cost time: 1.1908338069915771
Epoch: 16, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.366 Vali Acc: 0.527 Test Loss: 1.366 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2655055522918701
Epoch: 17, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.259 Vali Acc: 0.527 Test Loss: 1.259 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1489546298980713
Epoch: 18, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.332 Vali Acc: 0.581 Test Loss: 1.332 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.6500740051269531
Epoch: 19, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.365 Vali Acc: 0.581 Test Loss: 1.365 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.4274277687072754
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.496 Vali Acc: 0.608 Test Loss: 1.496 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.0555391311645508
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.370 Vali Acc: 0.581 Test Loss: 1.370 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.5834202766418457
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.426 Vali Acc: 0.595 Test Loss: 1.426 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.3097422122955322
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.460 Vali Acc: 0.581 Test Loss: 1.460 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.5309536457061768
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.434 Vali Acc: 0.608 Test Loss: 1.434 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.5693159103393555
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.526 Vali Acc: 0.581 Test Loss: 1.526 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 369436
model size : 2.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.3466227054595947
Epoch: 1, Steps: 10 | Train Loss: 1.474 Vali Loss: 1.571 Vali Acc: 0.203 Test Loss: 1.571 Test Acc: 0.203
Validation loss decreased (inf --> -0.202687).  Saving model ...
Epoch: 2 cost time: 1.2041833400726318
Epoch: 2, Steps: 10 | Train Loss: 1.380 Vali Loss: 1.343 Vali Acc: 0.378 Test Loss: 1.343 Test Acc: 0.378
Validation loss decreased (-0.202687 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 1.4560768604278564
Epoch: 3, Steps: 10 | Train Loss: 1.236 Vali Loss: 1.359 Vali Acc: 0.284 Test Loss: 1.359 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7327055931091309
Epoch: 4, Steps: 10 | Train Loss: 1.066 Vali Loss: 1.236 Vali Acc: 0.378 Test Loss: 1.236 Test Acc: 0.378
Validation loss decreased (-0.378365 --> -0.378366).  Saving model ...
Epoch: 5 cost time: 1.5069851875305176
Epoch: 5, Steps: 10 | Train Loss: 1.017 Vali Loss: 1.526 Vali Acc: 0.338 Test Loss: 1.526 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5431203842163086
Epoch: 6, Steps: 10 | Train Loss: 0.891 Vali Loss: 1.236 Vali Acc: 0.500 Test Loss: 1.236 Test Acc: 0.500
Validation loss decreased (-0.378366 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 1.5565712451934814
Epoch: 7, Steps: 10 | Train Loss: 0.694 Vali Loss: 1.101 Vali Acc: 0.541 Test Loss: 1.101 Test Acc: 0.541
Validation loss decreased (-0.499988 --> -0.540530).  Saving model ...
Epoch: 8 cost time: 1.2941484451293945
Epoch: 8, Steps: 10 | Train Loss: 0.573 Vali Loss: 1.090 Vali Acc: 0.554 Test Loss: 1.090 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554043).  Saving model ...
Epoch: 9 cost time: 1.5498316287994385
Epoch: 9, Steps: 10 | Train Loss: 0.486 Vali Loss: 1.154 Vali Acc: 0.500 Test Loss: 1.154 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4509773254394531
Epoch: 10, Steps: 10 | Train Loss: 0.386 Vali Loss: 1.092 Vali Acc: 0.581 Test Loss: 1.092 Test Acc: 0.581
Validation loss decreased (-0.554043 --> -0.581070).  Saving model ...
Epoch: 11 cost time: 1.225466251373291
Epoch: 11, Steps: 10 | Train Loss: 0.337 Vali Loss: 1.140 Vali Acc: 0.568 Test Loss: 1.140 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7673497200012207
Epoch: 12, Steps: 10 | Train Loss: 0.199 Vali Loss: 1.314 Vali Acc: 0.500 Test Loss: 1.314 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3175580501556396
Epoch: 13, Steps: 10 | Train Loss: 0.178 Vali Loss: 1.213 Vali Acc: 0.608 Test Loss: 1.213 Test Acc: 0.608
Validation loss decreased (-0.581070 --> -0.608096).  Saving model ...
Epoch: 14 cost time: 1.5292794704437256
Epoch: 14, Steps: 10 | Train Loss: 0.113 Vali Loss: 1.196 Vali Acc: 0.568 Test Loss: 1.196 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6921074390411377
Epoch: 15, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.242 Vali Acc: 0.568 Test Loss: 1.242 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6986043453216553
Epoch: 16, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.361 Vali Acc: 0.554 Test Loss: 1.361 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.269974946975708
Epoch: 17, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.407 Vali Acc: 0.554 Test Loss: 1.407 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.3830742835998535
Epoch: 18, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.513 Vali Acc: 0.554 Test Loss: 1.513 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.3686118125915527
Epoch: 19, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.417 Vali Acc: 0.581 Test Loss: 1.417 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.4039790630340576
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.580 Vali Acc: 0.568 Test Loss: 1.580 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.5861809253692627
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.481 Vali Acc: 0.581 Test Loss: 1.481 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.4734718799591064
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.574 Vali Acc: 0.608 Test Loss: 1.574 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.1698622703552246
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.589 Vali Acc: 0.635 Test Loss: 1.589 Test Acc: 0.635
Validation loss decreased (-0.608096 --> -0.635119).  Saving model ...
Epoch: 24 cost time: 1.712437391281128
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.526 Vali Acc: 0.595 Test Loss: 1.526 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3403642177581787
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.644 Vali Acc: 0.595 Test Loss: 1.644 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.7197933197021484
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.558 Vali Acc: 0.595 Test Loss: 1.558 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.653770923614502
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.623 Vali Acc: 0.622 Test Loss: 1.623 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.3026351928710938
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.616 Vali Acc: 0.635 Test Loss: 1.616 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.5320734977722168
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.620 Vali Acc: 0.622 Test Loss: 1.620 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.7578208446502686
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.638 Vali Acc: 0.608 Test Loss: 1.638 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.6672756671905518
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.664 Vali Acc: 0.608 Test Loss: 1.664 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.4549062252044678
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.641 Vali Acc: 0.568 Test Loss: 1.641 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.5186166763305664
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.654 Vali Acc: 0.622 Test Loss: 1.654 Test Acc: 0.622
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 367260
model size : 2.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.794447898864746
Epoch: 1, Steps: 10 | Train Loss: 1.438 Vali Loss: 1.603 Vali Acc: 0.189 Test Loss: 1.603 Test Acc: 0.189
Validation loss decreased (inf --> -0.189173).  Saving model ...
Epoch: 2 cost time: 1.4682483673095703
Epoch: 2, Steps: 10 | Train Loss: 1.455 Vali Loss: 1.361 Vali Acc: 0.270 Test Loss: 1.361 Test Acc: 0.270
Validation loss decreased (-0.189173 --> -0.270257).  Saving model ...
Epoch: 3 cost time: 1.344139575958252
Epoch: 3, Steps: 10 | Train Loss: 1.340 Vali Loss: 1.510 Vali Acc: 0.230 Test Loss: 1.510 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5946424007415771
Epoch: 4, Steps: 10 | Train Loss: 1.150 Vali Loss: 1.229 Vali Acc: 0.446 Test Loss: 1.229 Test Acc: 0.446
Validation loss decreased (-0.270257 --> -0.445934).  Saving model ...
Epoch: 5 cost time: 1.3382234573364258
Epoch: 5, Steps: 10 | Train Loss: 1.046 Vali Loss: 1.502 Vali Acc: 0.432 Test Loss: 1.502 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6137466430664062
Epoch: 6, Steps: 10 | Train Loss: 1.033 Vali Loss: 1.491 Vali Acc: 0.378 Test Loss: 1.491 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.506490707397461
Epoch: 7, Steps: 10 | Train Loss: 0.741 Vali Loss: 1.392 Vali Acc: 0.419 Test Loss: 1.392 Test Acc: 0.419
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5610382556915283
Epoch: 8, Steps: 10 | Train Loss: 0.735 Vali Loss: 1.217 Vali Acc: 0.473 Test Loss: 1.217 Test Acc: 0.473
Validation loss decreased (-0.445934 --> -0.472961).  Saving model ...
Epoch: 9 cost time: 1.7861673831939697
Epoch: 9, Steps: 10 | Train Loss: 0.535 Vali Loss: 1.145 Vali Acc: 0.514 Test Loss: 1.145 Test Acc: 0.514
Validation loss decreased (-0.472961 --> -0.513502).  Saving model ...
Epoch: 10 cost time: 1.6775002479553223
Epoch: 10, Steps: 10 | Train Loss: 0.451 Vali Loss: 1.118 Vali Acc: 0.541 Test Loss: 1.118 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540529).  Saving model ...
Epoch: 11 cost time: 1.7527351379394531
Epoch: 11, Steps: 10 | Train Loss: 0.291 Vali Loss: 1.234 Vali Acc: 0.514 Test Loss: 1.234 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3847274780273438
Epoch: 12, Steps: 10 | Train Loss: 0.269 Vali Loss: 1.137 Vali Acc: 0.527 Test Loss: 1.137 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4611353874206543
Epoch: 13, Steps: 10 | Train Loss: 0.201 Vali Loss: 1.412 Vali Acc: 0.459 Test Loss: 1.412 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.7610116004943848
Epoch: 14, Steps: 10 | Train Loss: 0.166 Vali Loss: 1.335 Vali Acc: 0.514 Test Loss: 1.335 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.8057036399841309
Epoch: 15, Steps: 10 | Train Loss: 0.064 Vali Loss: 1.376 Vali Acc: 0.568 Test Loss: 1.376 Test Acc: 0.568
Validation loss decreased (-0.540529 --> -0.567554).  Saving model ...
Epoch: 16 cost time: 1.2375805377960205
Epoch: 16, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.403 Vali Acc: 0.568 Test Loss: 1.403 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7274572849273682
Epoch: 17, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.380 Vali Acc: 0.595 Test Loss: 1.380 Test Acc: 0.595
Validation loss decreased (-0.567554 --> -0.594581).  Saving model ...
Epoch: 18 cost time: 1.4771380424499512
Epoch: 18, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.328 Vali Acc: 0.581 Test Loss: 1.328 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8079793453216553
Epoch: 19, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.432 Vali Acc: 0.595 Test Loss: 1.432 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.7338993549346924
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.474 Vali Acc: 0.595 Test Loss: 1.474 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.3833248615264893
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.435 Vali Acc: 0.568 Test Loss: 1.435 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.7429792881011963
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.540 Vali Acc: 0.581 Test Loss: 1.540 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.2976105213165283
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.510 Vali Acc: 0.595 Test Loss: 1.510 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.8560905456542969
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.537 Vali Acc: 0.581 Test Loss: 1.537 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.3664450645446777
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.551 Vali Acc: 0.581 Test Loss: 1.551 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.4408326148986816
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.543 Vali Acc: 0.568 Test Loss: 1.543 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.8765013217926025
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.579 Vali Acc: 0.581 Test Loss: 1.579 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 365084
model size : 2.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.4852497577667236
Epoch: 1, Steps: 10 | Train Loss: 1.465 Vali Loss: 1.370 Vali Acc: 0.297 Test Loss: 1.370 Test Acc: 0.297
Validation loss decreased (inf --> -0.297284).  Saving model ...
Epoch: 2 cost time: 1.2430033683776855
Epoch: 2, Steps: 10 | Train Loss: 1.407 Vali Loss: 1.384 Vali Acc: 0.311 Test Loss: 1.384 Test Acc: 0.311
Validation loss decreased (-0.297284 --> -0.310797).  Saving model ...
Epoch: 3 cost time: 1.247483730316162
Epoch: 3, Steps: 10 | Train Loss: 1.336 Vali Loss: 1.414 Vali Acc: 0.338 Test Loss: 1.414 Test Acc: 0.338
Validation loss decreased (-0.310797 --> -0.337824).  Saving model ...
Epoch: 4 cost time: 1.3797731399536133
Epoch: 4, Steps: 10 | Train Loss: 1.201 Vali Loss: 1.261 Vali Acc: 0.378 Test Loss: 1.261 Test Acc: 0.378
Validation loss decreased (-0.337824 --> -0.378366).  Saving model ...
Epoch: 5 cost time: 1.227799654006958
Epoch: 5, Steps: 10 | Train Loss: 1.123 Vali Loss: 1.229 Vali Acc: 0.527 Test Loss: 1.229 Test Acc: 0.527
Validation loss decreased (-0.378366 --> -0.527015).  Saving model ...
Epoch: 6 cost time: 1.3807039260864258
Epoch: 6, Steps: 10 | Train Loss: 0.976 Vali Loss: 1.298 Vali Acc: 0.365 Test Loss: 1.298 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5992257595062256
Epoch: 7, Steps: 10 | Train Loss: 0.858 Vali Loss: 1.150 Vali Acc: 0.486 Test Loss: 1.150 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1023402214050293
Epoch: 8, Steps: 10 | Train Loss: 0.676 Vali Loss: 1.111 Vali Acc: 0.568 Test Loss: 1.111 Test Acc: 0.568
Validation loss decreased (-0.527015 --> -0.567556).  Saving model ...
Epoch: 9 cost time: 1.2244465351104736
Epoch: 9, Steps: 10 | Train Loss: 0.558 Vali Loss: 1.105 Vali Acc: 0.554 Test Loss: 1.105 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3640940189361572
Epoch: 10, Steps: 10 | Train Loss: 0.403 Vali Loss: 1.032 Vali Acc: 0.554 Test Loss: 1.032 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.399355411529541
Epoch: 11, Steps: 10 | Train Loss: 0.319 Vali Loss: 1.173 Vali Acc: 0.527 Test Loss: 1.173 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4234442710876465
Epoch: 12, Steps: 10 | Train Loss: 0.216 Vali Loss: 1.145 Vali Acc: 0.554 Test Loss: 1.145 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.3107147216796875
Epoch: 13, Steps: 10 | Train Loss: 0.150 Vali Loss: 1.162 Vali Acc: 0.541 Test Loss: 1.162 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.559572458267212
Epoch: 14, Steps: 10 | Train Loss: 0.103 Vali Loss: 1.495 Vali Acc: 0.527 Test Loss: 1.495 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.5866811275482178
Epoch: 15, Steps: 10 | Train Loss: 0.074 Vali Loss: 1.338 Vali Acc: 0.514 Test Loss: 1.338 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.451756238937378
Epoch: 16, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.330 Vali Acc: 0.541 Test Loss: 1.330 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.6549079418182373
Epoch: 17, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.537 Vali Acc: 0.473 Test Loss: 1.537 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.5766842365264893
Epoch: 18, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.428 Vali Acc: 0.514 Test Loss: 1.428 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 311580
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.8411948680877686
Epoch: 1, Steps: 10 | Train Loss: 1.502 Vali Loss: 1.363 Vali Acc: 0.405 Test Loss: 1.363 Test Acc: 0.405
Validation loss decreased (inf --> -0.405392).  Saving model ...
Epoch: 2 cost time: 1.7770113945007324
Epoch: 2, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.370 Vali Acc: 0.257 Test Loss: 1.370 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.582991600036621
Epoch: 3, Steps: 10 | Train Loss: 1.312 Vali Loss: 1.273 Vali Acc: 0.419 Test Loss: 1.273 Test Acc: 0.419
Validation loss decreased (-0.405392 --> -0.418906).  Saving model ...
Epoch: 4 cost time: 1.556450366973877
Epoch: 4, Steps: 10 | Train Loss: 1.236 Vali Loss: 1.354 Vali Acc: 0.365 Test Loss: 1.354 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.647296667098999
Epoch: 5, Steps: 10 | Train Loss: 1.175 Vali Loss: 1.361 Vali Acc: 0.243 Test Loss: 1.361 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5892744064331055
Epoch: 6, Steps: 10 | Train Loss: 1.010 Vali Loss: 1.273 Vali Acc: 0.419 Test Loss: 1.273 Test Acc: 0.419
Validation loss decreased (-0.418906 --> -0.418906).  Saving model ...
Epoch: 7 cost time: 1.5061395168304443
Epoch: 7, Steps: 10 | Train Loss: 0.924 Vali Loss: 1.487 Vali Acc: 0.257 Test Loss: 1.487 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6881842613220215
Epoch: 8, Steps: 10 | Train Loss: 0.821 Vali Loss: 1.095 Vali Acc: 0.527 Test Loss: 1.095 Test Acc: 0.527
Validation loss decreased (-0.418906 --> -0.527016).  Saving model ...
Epoch: 9 cost time: 1.444795846939087
Epoch: 9, Steps: 10 | Train Loss: 0.645 Vali Loss: 1.193 Vali Acc: 0.486 Test Loss: 1.193 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7681884765625
Epoch: 10, Steps: 10 | Train Loss: 0.551 Vali Loss: 1.278 Vali Acc: 0.459 Test Loss: 1.278 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9576432704925537
Epoch: 11, Steps: 10 | Train Loss: 0.419 Vali Loss: 1.114 Vali Acc: 0.514 Test Loss: 1.114 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2529661655426025
Epoch: 12, Steps: 10 | Train Loss: 0.330 Vali Loss: 1.155 Vali Acc: 0.514 Test Loss: 1.155 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.4182722568511963
Epoch: 13, Steps: 10 | Train Loss: 0.237 Vali Loss: 1.117 Vali Acc: 0.527 Test Loss: 1.117 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.3162508010864258
Epoch: 14, Steps: 10 | Train Loss: 0.143 Vali Loss: 1.290 Vali Acc: 0.541 Test Loss: 1.290 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540528).  Saving model ...
Epoch: 15 cost time: 1.420140027999878
Epoch: 15, Steps: 10 | Train Loss: 0.107 Vali Loss: 1.254 Vali Acc: 0.500 Test Loss: 1.254 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3527300357818604
Epoch: 16, Steps: 10 | Train Loss: 0.079 Vali Loss: 1.233 Vali Acc: 0.514 Test Loss: 1.233 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.396066427230835
Epoch: 17, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.375 Vali Acc: 0.486 Test Loss: 1.375 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.5854196548461914
Epoch: 18, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.418 Vali Acc: 0.514 Test Loss: 1.418 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.1846835613250732
Epoch: 19, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.498 Vali Acc: 0.473 Test Loss: 1.498 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.8116719722747803
Epoch: 20, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.414 Vali Acc: 0.459 Test Loss: 1.414 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.5683624744415283
Epoch: 21, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.557 Vali Acc: 0.500 Test Loss: 1.557 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.563450813293457
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.547 Vali Acc: 0.486 Test Loss: 1.547 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.7308707237243652
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.525 Vali Acc: 0.459 Test Loss: 1.525 Test Acc: 0.459
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.7311367988586426
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.532 Vali Acc: 0.473 Test Loss: 1.532 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 310492
model size : 1.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.2597122192382812
Epoch: 1, Steps: 10 | Train Loss: 1.469 Vali Loss: 1.356 Vali Acc: 0.297 Test Loss: 1.356 Test Acc: 0.297
Validation loss decreased (inf --> -0.297284).  Saving model ...
Epoch: 2 cost time: 1.3604226112365723
Epoch: 2, Steps: 10 | Train Loss: 1.418 Vali Loss: 1.364 Vali Acc: 0.432 Test Loss: 1.364 Test Acc: 0.432
Validation loss decreased (-0.297284 --> -0.432419).  Saving model ...
Epoch: 3 cost time: 1.7048759460449219
Epoch: 3, Steps: 10 | Train Loss: 1.340 Vali Loss: 1.484 Vali Acc: 0.270 Test Loss: 1.484 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7805125713348389
Epoch: 4, Steps: 10 | Train Loss: 1.276 Vali Loss: 1.229 Vali Acc: 0.432 Test Loss: 1.229 Test Acc: 0.432
Validation loss decreased (-0.432419 --> -0.432420).  Saving model ...
Epoch: 5 cost time: 1.5950994491577148
Epoch: 5, Steps: 10 | Train Loss: 1.107 Vali Loss: 1.214 Vali Acc: 0.500 Test Loss: 1.214 Test Acc: 0.500
Validation loss decreased (-0.432420 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 1.4818546772003174
Epoch: 6, Steps: 10 | Train Loss: 1.013 Vali Loss: 1.284 Vali Acc: 0.405 Test Loss: 1.284 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.765058994293213
Epoch: 7, Steps: 10 | Train Loss: 0.836 Vali Loss: 1.234 Vali Acc: 0.541 Test Loss: 1.234 Test Acc: 0.541
Validation loss decreased (-0.499988 --> -0.540528).  Saving model ...
Epoch: 8 cost time: 1.6486868858337402
Epoch: 8, Steps: 10 | Train Loss: 0.799 Vali Loss: 1.220 Vali Acc: 0.459 Test Loss: 1.220 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2184643745422363
Epoch: 9, Steps: 10 | Train Loss: 0.631 Vali Loss: 1.184 Vali Acc: 0.541 Test Loss: 1.184 Test Acc: 0.541
Validation loss decreased (-0.540528 --> -0.540529).  Saving model ...
Epoch: 10 cost time: 1.5419318675994873
Epoch: 10, Steps: 10 | Train Loss: 0.508 Vali Loss: 1.118 Vali Acc: 0.500 Test Loss: 1.118 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6105148792266846
Epoch: 11, Steps: 10 | Train Loss: 0.406 Vali Loss: 1.145 Vali Acc: 0.473 Test Loss: 1.145 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.81846284866333
Epoch: 12, Steps: 10 | Train Loss: 0.305 Vali Loss: 1.168 Vali Acc: 0.486 Test Loss: 1.168 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.616840124130249
Epoch: 13, Steps: 10 | Train Loss: 0.204 Vali Loss: 1.195 Vali Acc: 0.541 Test Loss: 1.195 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.7183609008789062
Epoch: 14, Steps: 10 | Train Loss: 0.140 Vali Loss: 1.163 Vali Acc: 0.554 Test Loss: 1.163 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554042).  Saving model ...
Epoch: 15 cost time: 1.5037267208099365
Epoch: 15, Steps: 10 | Train Loss: 0.099 Vali Loss: 1.407 Vali Acc: 0.500 Test Loss: 1.407 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8005375862121582
Epoch: 16, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.375 Vali Acc: 0.486 Test Loss: 1.375 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7147440910339355
Epoch: 17, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.371 Vali Acc: 0.527 Test Loss: 1.371 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.674145221710205
Epoch: 18, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.515 Vali Acc: 0.500 Test Loss: 1.515 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.6242780685424805
Epoch: 19, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.497 Vali Acc: 0.527 Test Loss: 1.497 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.515291452407837
Epoch: 20, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.473 Vali Acc: 0.527 Test Loss: 1.473 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.8338027000427246
Epoch: 21, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.551 Vali Acc: 0.473 Test Loss: 1.551 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.0445821285247803
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.518 Vali Acc: 0.514 Test Loss: 1.518 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.5771863460540771
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.538 Vali Acc: 0.500 Test Loss: 1.538 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.4145042896270752
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.566 Vali Acc: 0.500 Test Loss: 1.566 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 309404
model size : 1.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.3456642627716064
Epoch: 1, Steps: 10 | Train Loss: 1.512 Vali Loss: 1.406 Vali Acc: 0.284 Test Loss: 1.406 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 1.3422541618347168
Epoch: 2, Steps: 10 | Train Loss: 1.453 Vali Loss: 1.347 Vali Acc: 0.311 Test Loss: 1.347 Test Acc: 0.311
Validation loss decreased (-0.283770 --> -0.310797).  Saving model ...
Epoch: 3 cost time: 1.4160044193267822
Epoch: 3, Steps: 10 | Train Loss: 1.342 Vali Loss: 1.330 Vali Acc: 0.351 Test Loss: 1.330 Test Acc: 0.351
Validation loss decreased (-0.310797 --> -0.351338).  Saving model ...
Epoch: 4 cost time: 1.1415941715240479
Epoch: 4, Steps: 10 | Train Loss: 1.253 Vali Loss: 1.282 Vali Acc: 0.405 Test Loss: 1.282 Test Acc: 0.405
Validation loss decreased (-0.351338 --> -0.405393).  Saving model ...
Epoch: 5 cost time: 1.2907195091247559
Epoch: 5, Steps: 10 | Train Loss: 1.174 Vali Loss: 1.251 Vali Acc: 0.514 Test Loss: 1.251 Test Acc: 0.514
Validation loss decreased (-0.405393 --> -0.513501).  Saving model ...
Epoch: 6 cost time: 1.2631936073303223
Epoch: 6, Steps: 10 | Train Loss: 1.146 Vali Loss: 1.293 Vali Acc: 0.324 Test Loss: 1.293 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.576035976409912
Epoch: 7, Steps: 10 | Train Loss: 0.975 Vali Loss: 1.164 Vali Acc: 0.500 Test Loss: 1.164 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5157837867736816
Epoch: 8, Steps: 10 | Train Loss: 0.835 Vali Loss: 1.126 Vali Acc: 0.473 Test Loss: 1.126 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.6562156677246094
Epoch: 9, Steps: 10 | Train Loss: 0.676 Vali Loss: 1.106 Vali Acc: 0.527 Test Loss: 1.106 Test Acc: 0.527
Validation loss decreased (-0.513501 --> -0.527016).  Saving model ...
Epoch: 10 cost time: 1.715381383895874
Epoch: 10, Steps: 10 | Train Loss: 0.528 Vali Loss: 1.228 Vali Acc: 0.473 Test Loss: 1.228 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.406576156616211
Epoch: 11, Steps: 10 | Train Loss: 0.414 Vali Loss: 1.114 Vali Acc: 0.554 Test Loss: 1.114 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554043).  Saving model ...
Epoch: 12 cost time: 1.4052181243896484
Epoch: 12, Steps: 10 | Train Loss: 0.331 Vali Loss: 1.415 Vali Acc: 0.459 Test Loss: 1.415 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5568673610687256
Epoch: 13, Steps: 10 | Train Loss: 0.253 Vali Loss: 1.180 Vali Acc: 0.486 Test Loss: 1.180 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7669897079467773
Epoch: 14, Steps: 10 | Train Loss: 0.152 Vali Loss: 1.176 Vali Acc: 0.554 Test Loss: 1.176 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5685551166534424
Epoch: 15, Steps: 10 | Train Loss: 0.103 Vali Loss: 1.262 Vali Acc: 0.568 Test Loss: 1.262 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567555).  Saving model ...
Epoch: 16 cost time: 1.272190809249878
Epoch: 16, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.357 Vali Acc: 0.514 Test Loss: 1.357 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0527141094207764
Epoch: 17, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.381 Vali Acc: 0.541 Test Loss: 1.381 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.7309744358062744
Epoch: 18, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.412 Vali Acc: 0.541 Test Loss: 1.412 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.4420084953308105
Epoch: 19, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.494 Vali Acc: 0.554 Test Loss: 1.494 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.5286753177642822
Epoch: 20, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.479 Vali Acc: 0.527 Test Loss: 1.479 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.8209047317504883
Epoch: 21, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.520 Vali Acc: 0.541 Test Loss: 1.520 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.7585194110870361
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.566 Vali Acc: 0.514 Test Loss: 1.566 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.4744415283203125
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.570 Vali Acc: 0.514 Test Loss: 1.570 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.2119638919830322
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.543 Vali Acc: 0.554 Test Loss: 1.543 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.9572062492370605
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.597 Vali Acc: 0.514 Test Loss: 1.597 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 308316
model size : 1.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.9560165405273438
Epoch: 1, Steps: 10 | Train Loss: 1.441 Vali Loss: 1.433 Vali Acc: 0.189 Test Loss: 1.433 Test Acc: 0.189
Validation loss decreased (inf --> -0.189175).  Saving model ...
Epoch: 2 cost time: 1.4888033866882324
Epoch: 2, Steps: 10 | Train Loss: 1.406 Vali Loss: 1.438 Vali Acc: 0.189 Test Loss: 1.438 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4321045875549316
Epoch: 3, Steps: 10 | Train Loss: 1.340 Vali Loss: 1.354 Vali Acc: 0.419 Test Loss: 1.354 Test Acc: 0.419
Validation loss decreased (-0.189175 --> -0.418905).  Saving model ...
Epoch: 4 cost time: 1.3081765174865723
Epoch: 4, Steps: 10 | Train Loss: 1.208 Vali Loss: 1.390 Vali Acc: 0.311 Test Loss: 1.390 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8944828510284424
Epoch: 5, Steps: 10 | Train Loss: 1.102 Vali Loss: 1.288 Vali Acc: 0.365 Test Loss: 1.288 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3268046379089355
Epoch: 6, Steps: 10 | Train Loss: 1.022 Vali Loss: 1.232 Vali Acc: 0.392 Test Loss: 1.232 Test Acc: 0.392
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2006580829620361
Epoch: 7, Steps: 10 | Train Loss: 0.920 Vali Loss: 1.254 Vali Acc: 0.378 Test Loss: 1.254 Test Acc: 0.378
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.279780387878418
Epoch: 8, Steps: 10 | Train Loss: 0.802 Vali Loss: 1.271 Vali Acc: 0.405 Test Loss: 1.271 Test Acc: 0.405
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.302196741104126
Epoch: 9, Steps: 10 | Train Loss: 0.674 Vali Loss: 1.193 Vali Acc: 0.486 Test Loss: 1.193 Test Acc: 0.486
Validation loss decreased (-0.418905 --> -0.486475).  Saving model ...
Epoch: 10 cost time: 1.3837847709655762
Epoch: 10, Steps: 10 | Train Loss: 0.548 Vali Loss: 1.264 Vali Acc: 0.432 Test Loss: 1.264 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4523258209228516
Epoch: 11, Steps: 10 | Train Loss: 0.438 Vali Loss: 1.219 Vali Acc: 0.459 Test Loss: 1.219 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6197211742401123
Epoch: 12, Steps: 10 | Train Loss: 0.357 Vali Loss: 1.174 Vali Acc: 0.554 Test Loss: 1.174 Test Acc: 0.554
Validation loss decreased (-0.486475 --> -0.554042).  Saving model ...
Epoch: 13 cost time: 1.1944880485534668
Epoch: 13, Steps: 10 | Train Loss: 0.263 Vali Loss: 1.146 Vali Acc: 0.500 Test Loss: 1.146 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3580989837646484
Epoch: 14, Steps: 10 | Train Loss: 0.177 Vali Loss: 1.166 Vali Acc: 0.541 Test Loss: 1.166 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0928947925567627
Epoch: 15, Steps: 10 | Train Loss: 0.120 Vali Loss: 1.296 Vali Acc: 0.486 Test Loss: 1.296 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3737719058990479
Epoch: 16, Steps: 10 | Train Loss: 0.076 Vali Loss: 1.269 Vali Acc: 0.486 Test Loss: 1.269 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2404284477233887
Epoch: 17, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.303 Vali Acc: 0.446 Test Loss: 1.303 Test Acc: 0.446
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.6377010345458984
Epoch: 18, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.380 Vali Acc: 0.486 Test Loss: 1.380 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.4303147792816162
Epoch: 19, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.448 Vali Acc: 0.486 Test Loss: 1.448 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.1070613861083984
Epoch: 20, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.464 Vali Acc: 0.500 Test Loss: 1.464 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.8277833461761475
Epoch: 21, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.518 Vali Acc: 0.486 Test Loss: 1.518 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.102186679840088
Epoch: 22, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.502 Vali Acc: 0.446 Test Loss: 1.502 Test Acc: 0.446
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 211740
model size : 1.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.5460195541381836
Epoch: 1, Steps: 10 | Train Loss: 1.442 Vali Loss: 1.460 Vali Acc: 0.176 Test Loss: 1.460 Test Acc: 0.176
Validation loss decreased (inf --> -0.175661).  Saving model ...
Epoch: 2 cost time: 1.4602537155151367
Epoch: 2, Steps: 10 | Train Loss: 1.404 Vali Loss: 1.462 Vali Acc: 0.270 Test Loss: 1.462 Test Acc: 0.270
Validation loss decreased (-0.175661 --> -0.270256).  Saving model ...
Epoch: 3 cost time: 1.2427082061767578
Epoch: 3, Steps: 10 | Train Loss: 1.321 Vali Loss: 1.335 Vali Acc: 0.338 Test Loss: 1.335 Test Acc: 0.338
Validation loss decreased (-0.270256 --> -0.337824).  Saving model ...
Epoch: 4 cost time: 1.490178108215332
Epoch: 4, Steps: 10 | Train Loss: 1.184 Vali Loss: 1.344 Vali Acc: 0.311 Test Loss: 1.344 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.469421625137329
Epoch: 5, Steps: 10 | Train Loss: 1.081 Vali Loss: 1.257 Vali Acc: 0.338 Test Loss: 1.257 Test Acc: 0.338
Validation loss decreased (-0.337824 --> -0.337825).  Saving model ...
Epoch: 6 cost time: 1.5376386642456055
Epoch: 6, Steps: 10 | Train Loss: 0.989 Vali Loss: 1.270 Vali Acc: 0.378 Test Loss: 1.270 Test Acc: 0.378
Validation loss decreased (-0.337825 --> -0.378366).  Saving model ...
Epoch: 7 cost time: 1.4246273040771484
Epoch: 7, Steps: 10 | Train Loss: 0.883 Vali Loss: 1.313 Vali Acc: 0.405 Test Loss: 1.313 Test Acc: 0.405
Validation loss decreased (-0.378366 --> -0.405392).  Saving model ...
Epoch: 8 cost time: 1.5820660591125488
Epoch: 8, Steps: 10 | Train Loss: 0.728 Vali Loss: 1.250 Vali Acc: 0.405 Test Loss: 1.250 Test Acc: 0.405
Validation loss decreased (-0.405392 --> -0.405393).  Saving model ...
Epoch: 9 cost time: 1.401827096939087
Epoch: 9, Steps: 10 | Train Loss: 0.623 Vali Loss: 1.196 Vali Acc: 0.473 Test Loss: 1.196 Test Acc: 0.473
Validation loss decreased (-0.405393 --> -0.472961).  Saving model ...
Epoch: 10 cost time: 1.567035436630249
Epoch: 10, Steps: 10 | Train Loss: 0.571 Vali Loss: 1.279 Vali Acc: 0.446 Test Loss: 1.279 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7250351905822754
Epoch: 11, Steps: 10 | Train Loss: 0.463 Vali Loss: 1.252 Vali Acc: 0.473 Test Loss: 1.252 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.351992130279541
Epoch: 12, Steps: 10 | Train Loss: 0.348 Vali Loss: 1.267 Vali Acc: 0.500 Test Loss: 1.267 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499987).  Saving model ...
Epoch: 13 cost time: 1.635460615158081
Epoch: 13, Steps: 10 | Train Loss: 0.263 Vali Loss: 1.210 Vali Acc: 0.527 Test Loss: 1.210 Test Acc: 0.527
Validation loss decreased (-0.499987 --> -0.527015).  Saving model ...
Epoch: 14 cost time: 1.3455324172973633
Epoch: 14, Steps: 10 | Train Loss: 0.191 Vali Loss: 1.214 Vali Acc: 0.527 Test Loss: 1.214 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.708139181137085
Epoch: 15, Steps: 10 | Train Loss: 0.148 Vali Loss: 1.445 Vali Acc: 0.541 Test Loss: 1.445 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540526).  Saving model ...
Epoch: 16 cost time: 1.4454121589660645
Epoch: 16, Steps: 10 | Train Loss: 0.112 Vali Loss: 1.254 Vali Acc: 0.554 Test Loss: 1.254 Test Acc: 0.554
Validation loss decreased (-0.540526 --> -0.554042).  Saving model ...
Epoch: 17 cost time: 1.9882142543792725
Epoch: 17, Steps: 10 | Train Loss: 0.063 Vali Loss: 1.302 Vali Acc: 0.554 Test Loss: 1.302 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.462723970413208
Epoch: 18, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.598 Vali Acc: 0.473 Test Loss: 1.598 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.66156005859375
Epoch: 19, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.412 Vali Acc: 0.514 Test Loss: 1.412 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.4051785469055176
Epoch: 20, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.505 Vali Acc: 0.500 Test Loss: 1.505 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.5002574920654297
Epoch: 21, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.478 Vali Acc: 0.486 Test Loss: 1.478 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.776604175567627
Epoch: 22, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.552 Vali Acc: 0.500 Test Loss: 1.552 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.3024747371673584
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.574 Vali Acc: 0.473 Test Loss: 1.574 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.678191900253296
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.553 Vali Acc: 0.500 Test Loss: 1.553 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.578437328338623
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.612 Vali Acc: 0.500 Test Loss: 1.612 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.4769315719604492
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.621 Vali Acc: 0.500 Test Loss: 1.621 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 210652
model size : 1.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.9140844345092773
Epoch: 1, Steps: 10 | Train Loss: 1.485 Vali Loss: 1.527 Vali Acc: 0.176 Test Loss: 1.527 Test Acc: 0.176
Validation loss decreased (inf --> -0.175660).  Saving model ...
Epoch: 2 cost time: 1.542647123336792
Epoch: 2, Steps: 10 | Train Loss: 1.437 Vali Loss: 1.354 Vali Acc: 0.257 Test Loss: 1.354 Test Acc: 0.257
Validation loss decreased (-0.175660 --> -0.256743).  Saving model ...
Epoch: 3 cost time: 1.2488071918487549
Epoch: 3, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.498 Vali Acc: 0.230 Test Loss: 1.498 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4227402210235596
Epoch: 4, Steps: 10 | Train Loss: 1.313 Vali Loss: 1.270 Vali Acc: 0.392 Test Loss: 1.270 Test Acc: 0.392
Validation loss decreased (-0.256743 --> -0.391879).  Saving model ...
Epoch: 5 cost time: 1.582601547241211
Epoch: 5, Steps: 10 | Train Loss: 1.176 Vali Loss: 1.497 Vali Acc: 0.270 Test Loss: 1.497 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5248470306396484
Epoch: 6, Steps: 10 | Train Loss: 1.097 Vali Loss: 1.419 Vali Acc: 0.378 Test Loss: 1.419 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.432690143585205
Epoch: 7, Steps: 10 | Train Loss: 1.107 Vali Loss: 1.219 Vali Acc: 0.446 Test Loss: 1.219 Test Acc: 0.446
Validation loss decreased (-0.391879 --> -0.445934).  Saving model ...
Epoch: 8 cost time: 1.2227187156677246
Epoch: 8, Steps: 10 | Train Loss: 0.932 Vali Loss: 1.710 Vali Acc: 0.243 Test Loss: 1.710 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5610296726226807
Epoch: 9, Steps: 10 | Train Loss: 0.866 Vali Loss: 1.193 Vali Acc: 0.446 Test Loss: 1.193 Test Acc: 0.446
Validation loss decreased (-0.445934 --> -0.445934).  Saving model ...
Epoch: 10 cost time: 1.3283801078796387
Epoch: 10, Steps: 10 | Train Loss: 0.640 Vali Loss: 1.112 Vali Acc: 0.500 Test Loss: 1.112 Test Acc: 0.500
Validation loss decreased (-0.445934 --> -0.499989).  Saving model ...
Epoch: 11 cost time: 1.0788218975067139
Epoch: 11, Steps: 10 | Train Loss: 0.502 Vali Loss: 1.188 Vali Acc: 0.514 Test Loss: 1.188 Test Acc: 0.514
Validation loss decreased (-0.499989 --> -0.513502).  Saving model ...
Epoch: 12 cost time: 1.448606252670288
Epoch: 12, Steps: 10 | Train Loss: 0.413 Vali Loss: 1.183 Vali Acc: 0.473 Test Loss: 1.183 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.271273136138916
Epoch: 13, Steps: 10 | Train Loss: 0.332 Vali Loss: 1.134 Vali Acc: 0.581 Test Loss: 1.134 Test Acc: 0.581
Validation loss decreased (-0.513502 --> -0.581070).  Saving model ...
Epoch: 14 cost time: 1.0970540046691895
Epoch: 14, Steps: 10 | Train Loss: 0.257 Vali Loss: 1.376 Vali Acc: 0.473 Test Loss: 1.376 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2407102584838867
Epoch: 15, Steps: 10 | Train Loss: 0.200 Vali Loss: 1.268 Vali Acc: 0.541 Test Loss: 1.268 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1739466190338135
Epoch: 16, Steps: 10 | Train Loss: 0.150 Vali Loss: 1.312 Vali Acc: 0.500 Test Loss: 1.312 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.5547940731048584
Epoch: 17, Steps: 10 | Train Loss: 0.093 Vali Loss: 1.404 Vali Acc: 0.500 Test Loss: 1.404 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.4711103439331055
Epoch: 18, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.320 Vali Acc: 0.541 Test Loss: 1.320 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9897840023040771
Epoch: 19, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.442 Vali Acc: 0.473 Test Loss: 1.442 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.4261584281921387
Epoch: 20, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.471 Vali Acc: 0.500 Test Loss: 1.471 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.999159574508667
Epoch: 21, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.508 Vali Acc: 0.514 Test Loss: 1.508 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.9705305099487305
Epoch: 22, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.504 Vali Acc: 0.500 Test Loss: 1.504 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.3234145641326904
Epoch: 23, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.611 Vali Acc: 0.514 Test Loss: 1.611 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 209564
model size : 1.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.329803943634033
Epoch: 1, Steps: 10 | Train Loss: 1.469 Vali Loss: 1.398 Vali Acc: 0.297 Test Loss: 1.398 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 1.3531153202056885
Epoch: 2, Steps: 10 | Train Loss: 1.411 Vali Loss: 1.388 Vali Acc: 0.324 Test Loss: 1.388 Test Acc: 0.324
Validation loss decreased (-0.297283 --> -0.324310).  Saving model ...
Epoch: 3 cost time: 1.3089816570281982
Epoch: 3, Steps: 10 | Train Loss: 1.343 Vali Loss: 1.372 Vali Acc: 0.284 Test Loss: 1.372 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4273402690887451
Epoch: 4, Steps: 10 | Train Loss: 1.291 Vali Loss: 1.300 Vali Acc: 0.324 Test Loss: 1.300 Test Acc: 0.324
Validation loss decreased (-0.324310 --> -0.324311).  Saving model ...
Epoch: 5 cost time: 1.0498740673065186
Epoch: 5, Steps: 10 | Train Loss: 1.190 Vali Loss: 1.479 Vali Acc: 0.338 Test Loss: 1.479 Test Acc: 0.338
Validation loss decreased (-0.324311 --> -0.337823).  Saving model ...
Epoch: 6 cost time: 1.000070333480835
Epoch: 6, Steps: 10 | Train Loss: 1.070 Vali Loss: 1.227 Vali Acc: 0.459 Test Loss: 1.227 Test Acc: 0.459
Validation loss decreased (-0.337823 --> -0.459447).  Saving model ...
Epoch: 7 cost time: 1.0950398445129395
Epoch: 7, Steps: 10 | Train Loss: 0.960 Vali Loss: 1.201 Vali Acc: 0.486 Test Loss: 1.201 Test Acc: 0.486
Validation loss decreased (-0.459447 --> -0.486474).  Saving model ...
Epoch: 8 cost time: 1.2022502422332764
Epoch: 8, Steps: 10 | Train Loss: 0.823 Vali Loss: 1.362 Vali Acc: 0.338 Test Loss: 1.362 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2603557109832764
Epoch: 9, Steps: 10 | Train Loss: 0.728 Vali Loss: 1.172 Vali Acc: 0.527 Test Loss: 1.172 Test Acc: 0.527
Validation loss decreased (-0.486474 --> -0.527015).  Saving model ...
Epoch: 10 cost time: 1.0092096328735352
Epoch: 10, Steps: 10 | Train Loss: 0.588 Vali Loss: 1.141 Vali Acc: 0.473 Test Loss: 1.141 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.18534517288208
Epoch: 11, Steps: 10 | Train Loss: 0.524 Vali Loss: 1.107 Vali Acc: 0.514 Test Loss: 1.107 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0585417747497559
Epoch: 12, Steps: 10 | Train Loss: 0.366 Vali Loss: 1.063 Vali Acc: 0.595 Test Loss: 1.063 Test Acc: 0.595
Validation loss decreased (-0.527015 --> -0.594584).  Saving model ...
Epoch: 13 cost time: 1.4908843040466309
Epoch: 13, Steps: 10 | Train Loss: 0.329 Vali Loss: 1.111 Vali Acc: 0.554 Test Loss: 1.111 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5927734375
Epoch: 14, Steps: 10 | Train Loss: 0.270 Vali Loss: 1.165 Vali Acc: 0.527 Test Loss: 1.165 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4195325374603271
Epoch: 15, Steps: 10 | Train Loss: 0.171 Vali Loss: 1.206 Vali Acc: 0.554 Test Loss: 1.206 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2859208583831787
Epoch: 16, Steps: 10 | Train Loss: 0.138 Vali Loss: 1.303 Vali Acc: 0.473 Test Loss: 1.303 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.3078334331512451
Epoch: 17, Steps: 10 | Train Loss: 0.105 Vali Loss: 1.625 Vali Acc: 0.459 Test Loss: 1.625 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.4176814556121826
Epoch: 18, Steps: 10 | Train Loss: 0.074 Vali Loss: 1.335 Vali Acc: 0.541 Test Loss: 1.335 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.430835247039795
Epoch: 19, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.443 Vali Acc: 0.514 Test Loss: 1.443 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.6348435878753662
Epoch: 20, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.364 Vali Acc: 0.514 Test Loss: 1.364 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.4843459129333496
Epoch: 21, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.431 Vali Acc: 0.500 Test Loss: 1.431 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.2931327819824219
Epoch: 22, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.448 Vali Acc: 0.527 Test Loss: 1.448 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 208476
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.5528440475463867
Epoch: 1, Steps: 10 | Train Loss: 1.459 Vali Loss: 1.439 Vali Acc: 0.230 Test Loss: 1.439 Test Acc: 0.230
Validation loss decreased (inf --> -0.229715).  Saving model ...
Epoch: 2 cost time: 1.3733742237091064
Epoch: 2, Steps: 10 | Train Loss: 1.426 Vali Loss: 1.303 Vali Acc: 0.432 Test Loss: 1.303 Test Acc: 0.432
Validation loss decreased (-0.229715 --> -0.432419).  Saving model ...
Epoch: 3 cost time: 1.3717694282531738
Epoch: 3, Steps: 10 | Train Loss: 1.307 Vali Loss: 1.372 Vali Acc: 0.270 Test Loss: 1.372 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.395557165145874
Epoch: 4, Steps: 10 | Train Loss: 1.225 Vali Loss: 1.469 Vali Acc: 0.324 Test Loss: 1.469 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7136878967285156
Epoch: 5, Steps: 10 | Train Loss: 1.172 Vali Loss: 1.197 Vali Acc: 0.486 Test Loss: 1.197 Test Acc: 0.486
Validation loss decreased (-0.432419 --> -0.486475).  Saving model ...
Epoch: 6 cost time: 1.498183250427246
Epoch: 6, Steps: 10 | Train Loss: 1.048 Vali Loss: 1.242 Vali Acc: 0.405 Test Loss: 1.242 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4416394233703613
Epoch: 7, Steps: 10 | Train Loss: 0.961 Vali Loss: 1.199 Vali Acc: 0.419 Test Loss: 1.199 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2699072360992432
Epoch: 8, Steps: 10 | Train Loss: 0.855 Vali Loss: 1.263 Vali Acc: 0.473 Test Loss: 1.263 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.5340244770050049
Epoch: 9, Steps: 10 | Train Loss: 0.744 Vali Loss: 1.223 Vali Acc: 0.432 Test Loss: 1.223 Test Acc: 0.432
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.456131935119629
Epoch: 10, Steps: 10 | Train Loss: 0.684 Vali Loss: 1.097 Vali Acc: 0.500 Test Loss: 1.097 Test Acc: 0.500
Validation loss decreased (-0.486475 --> -0.499989).  Saving model ...
Epoch: 11 cost time: 1.2719991207122803
Epoch: 11, Steps: 10 | Train Loss: 0.520 Vali Loss: 1.131 Vali Acc: 0.500 Test Loss: 1.131 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4783308506011963
Epoch: 12, Steps: 10 | Train Loss: 0.418 Vali Loss: 1.035 Vali Acc: 0.568 Test Loss: 1.035 Test Acc: 0.568
Validation loss decreased (-0.499989 --> -0.567557).  Saving model ...
Epoch: 13 cost time: 1.2644798755645752
Epoch: 13, Steps: 10 | Train Loss: 0.318 Vali Loss: 1.136 Vali Acc: 0.500 Test Loss: 1.136 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.297553539276123
Epoch: 14, Steps: 10 | Train Loss: 0.259 Vali Loss: 1.078 Vali Acc: 0.541 Test Loss: 1.078 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2634072303771973
Epoch: 15, Steps: 10 | Train Loss: 0.170 Vali Loss: 1.196 Vali Acc: 0.568 Test Loss: 1.196 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.5030412673950195
Epoch: 16, Steps: 10 | Train Loss: 0.220 Vali Loss: 1.531 Vali Acc: 0.486 Test Loss: 1.531 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2703189849853516
Epoch: 17, Steps: 10 | Train Loss: 0.113 Vali Loss: 1.268 Vali Acc: 0.541 Test Loss: 1.268 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.2074086666107178
Epoch: 18, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.216 Vali Acc: 0.581 Test Loss: 1.216 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581069).  Saving model ...
Epoch: 19 cost time: 1.380819320678711
Epoch: 19, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.436 Vali Acc: 0.554 Test Loss: 1.436 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1836931705474854
Epoch: 20, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.322 Vali Acc: 0.568 Test Loss: 1.322 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1177306175231934
Epoch: 21, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.444 Vali Acc: 0.554 Test Loss: 1.444 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.3118538856506348
Epoch: 22, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.399 Vali Acc: 0.554 Test Loss: 1.399 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.315096139907837
Epoch: 23, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.455 Vali Acc: 0.514 Test Loss: 1.455 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.1503078937530518
Epoch: 24, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.448 Vali Acc: 0.541 Test Loss: 1.448 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.0755360126495361
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.502 Vali Acc: 0.527 Test Loss: 1.502 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.1884102821350098
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.490 Vali Acc: 0.527 Test Loss: 1.490 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.9987950325012207
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.510 Vali Acc: 0.527 Test Loss: 1.510 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.5058531761169434
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.532 Vali Acc: 0.527 Test Loss: 1.532 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 161820
model size : 1.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.8029274940490723
Epoch: 1, Steps: 10 | Train Loss: 1.436 Vali Loss: 1.447 Vali Acc: 0.243 Test Loss: 1.447 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 1.4058010578155518
Epoch: 2, Steps: 10 | Train Loss: 1.395 Vali Loss: 1.397 Vali Acc: 0.270 Test Loss: 1.397 Test Acc: 0.270
Validation loss decreased (-0.243229 --> -0.270256).  Saving model ...
Epoch: 3 cost time: 1.6245687007904053
Epoch: 3, Steps: 10 | Train Loss: 1.408 Vali Loss: 1.346 Vali Acc: 0.446 Test Loss: 1.346 Test Acc: 0.446
Validation loss decreased (-0.270256 --> -0.445932).  Saving model ...
Epoch: 4 cost time: 1.514223575592041
Epoch: 4, Steps: 10 | Train Loss: 1.281 Vali Loss: 1.318 Vali Acc: 0.419 Test Loss: 1.318 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5536811351776123
Epoch: 5, Steps: 10 | Train Loss: 1.129 Vali Loss: 1.339 Vali Acc: 0.514 Test Loss: 1.339 Test Acc: 0.514
Validation loss decreased (-0.445932 --> -0.513500).  Saving model ...
Epoch: 6 cost time: 1.6233336925506592
Epoch: 6, Steps: 10 | Train Loss: 1.030 Vali Loss: 1.242 Vali Acc: 0.392 Test Loss: 1.242 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4042797088623047
Epoch: 7, Steps: 10 | Train Loss: 0.908 Vali Loss: 1.240 Vali Acc: 0.459 Test Loss: 1.240 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.348114013671875
Epoch: 8, Steps: 10 | Train Loss: 0.810 Vali Loss: 1.202 Vali Acc: 0.500 Test Loss: 1.202 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4777233600616455
Epoch: 9, Steps: 10 | Train Loss: 0.727 Vali Loss: 1.221 Vali Acc: 0.500 Test Loss: 1.221 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.6116306781768799
Epoch: 10, Steps: 10 | Train Loss: 0.594 Vali Loss: 1.204 Vali Acc: 0.527 Test Loss: 1.204 Test Acc: 0.527
Validation loss decreased (-0.513500 --> -0.527015).  Saving model ...
Epoch: 11 cost time: 1.0665931701660156
Epoch: 11, Steps: 10 | Train Loss: 0.519 Vali Loss: 1.313 Vali Acc: 0.459 Test Loss: 1.313 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8594255447387695
Epoch: 12, Steps: 10 | Train Loss: 0.416 Vali Loss: 1.181 Vali Acc: 0.459 Test Loss: 1.181 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1754367351531982
Epoch: 13, Steps: 10 | Train Loss: 0.396 Vali Loss: 1.256 Vali Acc: 0.527 Test Loss: 1.256 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.4768712520599365
Epoch: 14, Steps: 10 | Train Loss: 0.314 Vali Loss: 1.102 Vali Acc: 0.514 Test Loss: 1.102 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.461949110031128
Epoch: 15, Steps: 10 | Train Loss: 0.179 Vali Loss: 1.482 Vali Acc: 0.486 Test Loss: 1.482 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.267498254776001
Epoch: 16, Steps: 10 | Train Loss: 0.172 Vali Loss: 1.350 Vali Acc: 0.473 Test Loss: 1.350 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.2835719585418701
Epoch: 17, Steps: 10 | Train Loss: 0.138 Vali Loss: 1.215 Vali Acc: 0.554 Test Loss: 1.215 Test Acc: 0.554
Validation loss decreased (-0.527015 --> -0.554042).  Saving model ...
Epoch: 18 cost time: 1.4109036922454834
Epoch: 18, Steps: 10 | Train Loss: 0.074 Vali Loss: 1.289 Vali Acc: 0.500 Test Loss: 1.289 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.503404140472412
Epoch: 19, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.360 Vali Acc: 0.514 Test Loss: 1.360 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2661316394805908
Epoch: 20, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.596 Vali Acc: 0.473 Test Loss: 1.596 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.5164682865142822
Epoch: 21, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.399 Vali Acc: 0.514 Test Loss: 1.399 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.4657070636749268
Epoch: 22, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.575 Vali Acc: 0.500 Test Loss: 1.575 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.2224187850952148
Epoch: 23, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.539 Vali Acc: 0.514 Test Loss: 1.539 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.4729347229003906
Epoch: 24, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.537 Vali Acc: 0.527 Test Loss: 1.537 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.3142507076263428
Epoch: 25, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.562 Vali Acc: 0.500 Test Loss: 1.562 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.3744821548461914
Epoch: 26, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.561 Vali Acc: 0.514 Test Loss: 1.561 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.5897040367126465
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.591 Vali Acc: 0.486 Test Loss: 1.591 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 160732
model size : 1.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.489717483520508
Epoch: 1, Steps: 10 | Train Loss: 1.471 Vali Loss: 1.388 Vali Acc: 0.257 Test Loss: 1.388 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 1.3828799724578857
Epoch: 2, Steps: 10 | Train Loss: 1.433 Vali Loss: 1.340 Vali Acc: 0.365 Test Loss: 1.340 Test Acc: 0.365
Validation loss decreased (-0.256743 --> -0.364851).  Saving model ...
Epoch: 3 cost time: 1.4570205211639404
Epoch: 3, Steps: 10 | Train Loss: 1.326 Vali Loss: 1.307 Vali Acc: 0.378 Test Loss: 1.307 Test Acc: 0.378
Validation loss decreased (-0.364851 --> -0.378365).  Saving model ...
Epoch: 4 cost time: 1.0731358528137207
Epoch: 4, Steps: 10 | Train Loss: 1.270 Vali Loss: 1.310 Vali Acc: 0.378 Test Loss: 1.310 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4082694053649902
Epoch: 5, Steps: 10 | Train Loss: 1.106 Vali Loss: 1.251 Vali Acc: 0.486 Test Loss: 1.251 Test Acc: 0.486
Validation loss decreased (-0.378365 --> -0.486474).  Saving model ...
Epoch: 6 cost time: 1.3056013584136963
Epoch: 6, Steps: 10 | Train Loss: 1.026 Vali Loss: 1.232 Vali Acc: 0.514 Test Loss: 1.232 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513501).  Saving model ...
Epoch: 7 cost time: 1.2776076793670654
Epoch: 7, Steps: 10 | Train Loss: 0.973 Vali Loss: 1.136 Vali Acc: 0.514 Test Loss: 1.136 Test Acc: 0.514
Validation loss decreased (-0.513501 --> -0.513502).  Saving model ...
Epoch: 8 cost time: 1.1777307987213135
Epoch: 8, Steps: 10 | Train Loss: 0.827 Vali Loss: 1.348 Vali Acc: 0.338 Test Loss: 1.348 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1148183345794678
Epoch: 9, Steps: 10 | Train Loss: 0.732 Vali Loss: 1.148 Vali Acc: 0.486 Test Loss: 1.148 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3075783252716064
Epoch: 10, Steps: 10 | Train Loss: 0.603 Vali Loss: 1.192 Vali Acc: 0.541 Test Loss: 1.192 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540529).  Saving model ...
Epoch: 11 cost time: 1.363532543182373
Epoch: 11, Steps: 10 | Train Loss: 0.493 Vali Loss: 1.097 Vali Acc: 0.473 Test Loss: 1.097 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1731836795806885
Epoch: 12, Steps: 10 | Train Loss: 0.416 Vali Loss: 1.286 Vali Acc: 0.473 Test Loss: 1.286 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2246012687683105
Epoch: 13, Steps: 10 | Train Loss: 0.348 Vali Loss: 1.226 Vali Acc: 0.514 Test Loss: 1.226 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2884385585784912
Epoch: 14, Steps: 10 | Train Loss: 0.290 Vali Loss: 1.120 Vali Acc: 0.541 Test Loss: 1.120 Test Acc: 0.541
Validation loss decreased (-0.540529 --> -0.540529).  Saving model ...
Epoch: 15 cost time: 1.2564284801483154
Epoch: 15, Steps: 10 | Train Loss: 0.234 Vali Loss: 1.153 Vali Acc: 0.541 Test Loss: 1.153 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4440371990203857
Epoch: 16, Steps: 10 | Train Loss: 0.133 Vali Loss: 1.290 Vali Acc: 0.541 Test Loss: 1.290 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.271186351776123
Epoch: 17, Steps: 10 | Train Loss: 0.112 Vali Loss: 1.216 Vali Acc: 0.541 Test Loss: 1.216 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.2679412364959717
Epoch: 18, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.266 Vali Acc: 0.541 Test Loss: 1.266 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.3004989624023438
Epoch: 19, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.419 Vali Acc: 0.514 Test Loss: 1.419 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.5024499893188477
Epoch: 20, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.391 Vali Acc: 0.514 Test Loss: 1.391 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.6440961360931396
Epoch: 21, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.435 Vali Acc: 0.514 Test Loss: 1.435 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.1544678211212158
Epoch: 22, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.477 Vali Acc: 0.500 Test Loss: 1.477 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.5509634017944336
Epoch: 23, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.523 Vali Acc: 0.500 Test Loss: 1.523 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.456552267074585
Epoch: 24, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.535 Vali Acc: 0.486 Test Loss: 1.535 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 159644
model size : 1.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.670504331588745
Epoch: 1, Steps: 10 | Train Loss: 1.527 Vali Loss: 1.440 Vali Acc: 0.162 Test Loss: 1.440 Test Acc: 0.162
Validation loss decreased (inf --> -0.162148).  Saving model ...
Epoch: 2 cost time: 1.0246813297271729
Epoch: 2, Steps: 10 | Train Loss: 1.458 Vali Loss: 1.350 Vali Acc: 0.365 Test Loss: 1.350 Test Acc: 0.365
Validation loss decreased (-0.162148 --> -0.364851).  Saving model ...
Epoch: 3 cost time: 1.1471245288848877
Epoch: 3, Steps: 10 | Train Loss: 1.396 Vali Loss: 1.337 Vali Acc: 0.378 Test Loss: 1.337 Test Acc: 0.378
Validation loss decreased (-0.364851 --> -0.378365).  Saving model ...
Epoch: 4 cost time: 1.4147906303405762
Epoch: 4, Steps: 10 | Train Loss: 1.258 Vali Loss: 1.416 Vali Acc: 0.297 Test Loss: 1.416 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.534350872039795
Epoch: 5, Steps: 10 | Train Loss: 1.169 Vali Loss: 1.319 Vali Acc: 0.365 Test Loss: 1.319 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5287294387817383
Epoch: 6, Steps: 10 | Train Loss: 1.012 Vali Loss: 1.194 Vali Acc: 0.500 Test Loss: 1.194 Test Acc: 0.500
Validation loss decreased (-0.378365 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 1.6012380123138428
Epoch: 7, Steps: 10 | Train Loss: 0.891 Vali Loss: 1.142 Vali Acc: 0.568 Test Loss: 1.142 Test Acc: 0.568
Validation loss decreased (-0.499988 --> -0.567556).  Saving model ...
Epoch: 8 cost time: 1.195253610610962
Epoch: 8, Steps: 10 | Train Loss: 0.780 Vali Loss: 1.164 Vali Acc: 0.541 Test Loss: 1.164 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.749391794204712
Epoch: 9, Steps: 10 | Train Loss: 0.667 Vali Loss: 1.136 Vali Acc: 0.527 Test Loss: 1.136 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1923789978027344
Epoch: 10, Steps: 10 | Train Loss: 0.598 Vali Loss: 1.120 Vali Acc: 0.514 Test Loss: 1.120 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.396836519241333
Epoch: 11, Steps: 10 | Train Loss: 0.510 Vali Loss: 1.187 Vali Acc: 0.500 Test Loss: 1.187 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.330794095993042
Epoch: 12, Steps: 10 | Train Loss: 0.362 Vali Loss: 1.175 Vali Acc: 0.527 Test Loss: 1.175 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.2998735904693604
Epoch: 13, Steps: 10 | Train Loss: 0.306 Vali Loss: 1.093 Vali Acc: 0.541 Test Loss: 1.093 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.4960880279541016
Epoch: 14, Steps: 10 | Train Loss: 0.200 Vali Loss: 1.248 Vali Acc: 0.486 Test Loss: 1.248 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.2130053043365479
Epoch: 15, Steps: 10 | Train Loss: 0.147 Vali Loss: 1.130 Vali Acc: 0.527 Test Loss: 1.130 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.5588266849517822
Epoch: 16, Steps: 10 | Train Loss: 0.112 Vali Loss: 1.173 Vali Acc: 0.554 Test Loss: 1.173 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.526989221572876
Epoch: 17, Steps: 10 | Train Loss: 0.077 Vali Loss: 1.369 Vali Acc: 0.486 Test Loss: 1.369 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 158556
model size : 1.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.4088594913482666
Epoch: 1, Steps: 10 | Train Loss: 1.455 Vali Loss: 1.399 Vali Acc: 0.243 Test Loss: 1.399 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 1.146655559539795
Epoch: 2, Steps: 10 | Train Loss: 1.421 Vali Loss: 1.388 Vali Acc: 0.311 Test Loss: 1.388 Test Acc: 0.311
Validation loss decreased (-0.243229 --> -0.310797).  Saving model ...
Epoch: 3 cost time: 1.4505717754364014
Epoch: 3, Steps: 10 | Train Loss: 1.380 Vali Loss: 1.291 Vali Acc: 0.419 Test Loss: 1.291 Test Acc: 0.419
Validation loss decreased (-0.310797 --> -0.418906).  Saving model ...
Epoch: 4 cost time: 1.6048598289489746
Epoch: 4, Steps: 10 | Train Loss: 1.266 Vali Loss: 1.369 Vali Acc: 0.311 Test Loss: 1.369 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8899812698364258
Epoch: 5, Steps: 10 | Train Loss: 1.216 Vali Loss: 1.235 Vali Acc: 0.473 Test Loss: 1.235 Test Acc: 0.473
Validation loss decreased (-0.418906 --> -0.472961).  Saving model ...
Epoch: 6 cost time: 1.3765041828155518
Epoch: 6, Steps: 10 | Train Loss: 1.068 Vali Loss: 1.358 Vali Acc: 0.230 Test Loss: 1.358 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6039068698883057
Epoch: 7, Steps: 10 | Train Loss: 1.065 Vali Loss: 1.213 Vali Acc: 0.486 Test Loss: 1.213 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486474).  Saving model ...
Epoch: 8 cost time: 1.1922013759613037
Epoch: 8, Steps: 10 | Train Loss: 0.850 Vali Loss: 1.244 Vali Acc: 0.514 Test Loss: 1.244 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513501).  Saving model ...
Epoch: 9 cost time: 1.504990577697754
Epoch: 9, Steps: 10 | Train Loss: 0.770 Vali Loss: 1.174 Vali Acc: 0.500 Test Loss: 1.174 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4432098865509033
Epoch: 10, Steps: 10 | Train Loss: 0.660 Vali Loss: 1.210 Vali Acc: 0.514 Test Loss: 1.210 Test Acc: 0.514
Validation loss decreased (-0.513501 --> -0.513501).  Saving model ...
Epoch: 11 cost time: 1.4878478050231934
Epoch: 11, Steps: 10 | Train Loss: 0.563 Vali Loss: 1.390 Vali Acc: 0.473 Test Loss: 1.390 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6250813007354736
Epoch: 12, Steps: 10 | Train Loss: 0.484 Vali Loss: 1.076 Vali Acc: 0.554 Test Loss: 1.076 Test Acc: 0.554
Validation loss decreased (-0.513501 --> -0.554043).  Saving model ...
Epoch: 13 cost time: 0.9952948093414307
Epoch: 13, Steps: 10 | Train Loss: 0.403 Vali Loss: 1.364 Vali Acc: 0.405 Test Loss: 1.364 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4940145015716553
Epoch: 14, Steps: 10 | Train Loss: 0.331 Vali Loss: 1.107 Vali Acc: 0.527 Test Loss: 1.107 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6369335651397705
Epoch: 15, Steps: 10 | Train Loss: 0.278 Vali Loss: 1.218 Vali Acc: 0.527 Test Loss: 1.218 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.166003942489624
Epoch: 16, Steps: 10 | Train Loss: 0.210 Vali Loss: 1.577 Vali Acc: 0.500 Test Loss: 1.577 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.8875091075897217
Epoch: 17, Steps: 10 | Train Loss: 0.192 Vali Loss: 1.272 Vali Acc: 0.514 Test Loss: 1.272 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.7042591571807861
Epoch: 18, Steps: 10 | Train Loss: 0.131 Vali Loss: 1.212 Vali Acc: 0.541 Test Loss: 1.212 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.4130768775939941
Epoch: 19, Steps: 10 | Train Loss: 0.087 Vali Loss: 1.299 Vali Acc: 0.527 Test Loss: 1.299 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.4326229095458984
Epoch: 20, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.396 Vali Acc: 0.527 Test Loss: 1.396 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.6205880641937256
Epoch: 21, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.371 Vali Acc: 0.527 Test Loss: 1.371 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.2798984050750732
Epoch: 22, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.452 Vali Acc: 0.527 Test Loss: 1.452 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 136860
model size : 1.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.5008552074432373
Epoch: 1, Steps: 10 | Train Loss: 1.489 Vali Loss: 1.361 Vali Acc: 0.378 Test Loss: 1.361 Test Acc: 0.378
Validation loss decreased (inf --> -0.378365).  Saving model ...
Epoch: 2 cost time: 1.2062783241271973
Epoch: 2, Steps: 10 | Train Loss: 1.488 Vali Loss: 1.373 Vali Acc: 0.297 Test Loss: 1.373 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6954765319824219
Epoch: 3, Steps: 10 | Train Loss: 1.390 Vali Loss: 1.375 Vali Acc: 0.257 Test Loss: 1.375 Test Acc: 0.257
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2487924098968506
Epoch: 4, Steps: 10 | Train Loss: 1.301 Vali Loss: 1.368 Vali Acc: 0.324 Test Loss: 1.368 Test Acc: 0.324
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.6399750709533691
Epoch: 5, Steps: 10 | Train Loss: 1.205 Vali Loss: 1.443 Vali Acc: 0.338 Test Loss: 1.443 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5888035297393799
Epoch: 6, Steps: 10 | Train Loss: 1.204 Vali Loss: 1.358 Vali Acc: 0.311 Test Loss: 1.358 Test Acc: 0.311
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.6765916347503662
Epoch: 7, Steps: 10 | Train Loss: 0.972 Vali Loss: 1.213 Vali Acc: 0.486 Test Loss: 1.213 Test Acc: 0.486
Validation loss decreased (-0.378365 --> -0.486474).  Saving model ...
Epoch: 8 cost time: 1.155552864074707
Epoch: 8, Steps: 10 | Train Loss: 0.907 Vali Loss: 1.291 Vali Acc: 0.419 Test Loss: 1.291 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.255021095275879
Epoch: 9, Steps: 10 | Train Loss: 0.822 Vali Loss: 1.289 Vali Acc: 0.324 Test Loss: 1.289 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.385993480682373
Epoch: 10, Steps: 10 | Train Loss: 0.773 Vali Loss: 1.253 Vali Acc: 0.527 Test Loss: 1.253 Test Acc: 0.527
Validation loss decreased (-0.486474 --> -0.527014).  Saving model ...
Epoch: 11 cost time: 1.570549726486206
Epoch: 11, Steps: 10 | Train Loss: 0.674 Vali Loss: 1.267 Vali Acc: 0.486 Test Loss: 1.267 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4775888919830322
Epoch: 12, Steps: 10 | Train Loss: 0.563 Vali Loss: 1.132 Vali Acc: 0.541 Test Loss: 1.132 Test Acc: 0.541
Validation loss decreased (-0.527014 --> -0.540529).  Saving model ...
Epoch: 13 cost time: 1.365370750427246
Epoch: 13, Steps: 10 | Train Loss: 0.431 Vali Loss: 1.222 Vali Acc: 0.541 Test Loss: 1.222 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4052703380584717
Epoch: 14, Steps: 10 | Train Loss: 0.383 Vali Loss: 1.107 Vali Acc: 0.514 Test Loss: 1.107 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4714243412017822
Epoch: 15, Steps: 10 | Train Loss: 0.307 Vali Loss: 1.211 Vali Acc: 0.486 Test Loss: 1.211 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.395068883895874
Epoch: 16, Steps: 10 | Train Loss: 0.301 Vali Loss: 1.224 Vali Acc: 0.541 Test Loss: 1.224 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.4532890319824219
Epoch: 17, Steps: 10 | Train Loss: 0.210 Vali Loss: 1.618 Vali Acc: 0.486 Test Loss: 1.618 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.3649332523345947
Epoch: 18, Steps: 10 | Train Loss: 0.171 Vali Loss: 1.268 Vali Acc: 0.554 Test Loss: 1.268 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554041).  Saving model ...
Epoch: 19 cost time: 1.2220454216003418
Epoch: 19, Steps: 10 | Train Loss: 0.111 Vali Loss: 1.283 Vali Acc: 0.500 Test Loss: 1.283 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.295222282409668
Epoch: 20, Steps: 10 | Train Loss: 0.072 Vali Loss: 1.249 Vali Acc: 0.527 Test Loss: 1.249 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.4533348083496094
Epoch: 21, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.542 Vali Acc: 0.486 Test Loss: 1.542 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.8753135204315186
Epoch: 22, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.351 Vali Acc: 0.514 Test Loss: 1.351 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.2375926971435547
Epoch: 23, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.453 Vali Acc: 0.514 Test Loss: 1.453 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.6414127349853516
Epoch: 24, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.397 Vali Acc: 0.527 Test Loss: 1.397 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.2965526580810547
Epoch: 25, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.451 Vali Acc: 0.500 Test Loss: 1.451 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.7948830127716064
Epoch: 26, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.463 Vali Acc: 0.527 Test Loss: 1.463 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.6622607707977295
Epoch: 27, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.455 Vali Acc: 0.500 Test Loss: 1.455 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.7104263305664062
Epoch: 28, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.509 Vali Acc: 0.514 Test Loss: 1.509 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 135772
model size : 1.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.870718002319336
Epoch: 1, Steps: 10 | Train Loss: 1.462 Vali Loss: 1.384 Vali Acc: 0.257 Test Loss: 1.384 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 1.2455661296844482
Epoch: 2, Steps: 10 | Train Loss: 1.429 Vali Loss: 1.373 Vali Acc: 0.365 Test Loss: 1.373 Test Acc: 0.365
Validation loss decreased (-0.256743 --> -0.364851).  Saving model ...
Epoch: 3 cost time: 1.0753426551818848
Epoch: 3, Steps: 10 | Train Loss: 1.313 Vali Loss: 1.317 Vali Acc: 0.392 Test Loss: 1.317 Test Acc: 0.392
Validation loss decreased (-0.364851 --> -0.391879).  Saving model ...
Epoch: 4 cost time: 1.7302742004394531
Epoch: 4, Steps: 10 | Train Loss: 1.271 Vali Loss: 1.260 Vali Acc: 0.378 Test Loss: 1.260 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.117262601852417
Epoch: 5, Steps: 10 | Train Loss: 1.164 Vali Loss: 1.329 Vali Acc: 0.392 Test Loss: 1.329 Test Acc: 0.392
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.258244276046753
Epoch: 6, Steps: 10 | Train Loss: 1.108 Vali Loss: 1.218 Vali Acc: 0.486 Test Loss: 1.218 Test Acc: 0.486
Validation loss decreased (-0.391879 --> -0.486474).  Saving model ...
Epoch: 7 cost time: 1.4461073875427246
Epoch: 7, Steps: 10 | Train Loss: 0.935 Vali Loss: 1.197 Vali Acc: 0.405 Test Loss: 1.197 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.153320550918579
Epoch: 8, Steps: 10 | Train Loss: 0.857 Vali Loss: 1.409 Vali Acc: 0.365 Test Loss: 1.409 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.402907371520996
Epoch: 9, Steps: 10 | Train Loss: 0.755 Vali Loss: 1.099 Vali Acc: 0.500 Test Loss: 1.099 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499989).  Saving model ...
Epoch: 10 cost time: 1.2273280620574951
Epoch: 10, Steps: 10 | Train Loss: 0.685 Vali Loss: 1.133 Vali Acc: 0.500 Test Loss: 1.133 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4921236038208008
Epoch: 11, Steps: 10 | Train Loss: 0.503 Vali Loss: 1.094 Vali Acc: 0.514 Test Loss: 1.094 Test Acc: 0.514
Validation loss decreased (-0.499989 --> -0.513503).  Saving model ...
Epoch: 12 cost time: 1.1169140338897705
Epoch: 12, Steps: 10 | Train Loss: 0.409 Vali Loss: 1.274 Vali Acc: 0.486 Test Loss: 1.274 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3902671337127686
Epoch: 13, Steps: 10 | Train Loss: 0.326 Vali Loss: 1.260 Vali Acc: 0.500 Test Loss: 1.260 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2221474647521973
Epoch: 14, Steps: 10 | Train Loss: 0.281 Vali Loss: 1.143 Vali Acc: 0.514 Test Loss: 1.143 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3944127559661865
Epoch: 15, Steps: 10 | Train Loss: 0.227 Vali Loss: 1.184 Vali Acc: 0.514 Test Loss: 1.184 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.4584269523620605
Epoch: 16, Steps: 10 | Train Loss: 0.158 Vali Loss: 1.213 Vali Acc: 0.514 Test Loss: 1.213 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.3302958011627197
Epoch: 17, Steps: 10 | Train Loss: 0.124 Vali Loss: 1.372 Vali Acc: 0.541 Test Loss: 1.372 Test Acc: 0.541
Validation loss decreased (-0.513503 --> -0.540527).  Saving model ...
Epoch: 18 cost time: 1.2179341316223145
Epoch: 18, Steps: 10 | Train Loss: 0.072 Vali Loss: 1.210 Vali Acc: 0.554 Test Loss: 1.210 Test Acc: 0.554
Validation loss decreased (-0.540527 --> -0.554042).  Saving model ...
Epoch: 19 cost time: 1.384857177734375
Epoch: 19, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.248 Vali Acc: 0.581 Test Loss: 1.248 Test Acc: 0.581
Validation loss decreased (-0.554042 --> -0.581069).  Saving model ...
Epoch: 20 cost time: 1.3111412525177002
Epoch: 20, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.394 Vali Acc: 0.541 Test Loss: 1.394 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4456448554992676
Epoch: 21, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.357 Vali Acc: 0.527 Test Loss: 1.357 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.608987808227539
Epoch: 22, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.401 Vali Acc: 0.554 Test Loss: 1.401 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.3536417484283447
Epoch: 23, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.463 Vali Acc: 0.527 Test Loss: 1.463 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.232238531112671
Epoch: 24, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.493 Vali Acc: 0.527 Test Loss: 1.493 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.4180126190185547
Epoch: 25, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.440 Vali Acc: 0.568 Test Loss: 1.440 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.4874465465545654
Epoch: 26, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.538 Vali Acc: 0.514 Test Loss: 1.538 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.323603868484497
Epoch: 27, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.486 Vali Acc: 0.568 Test Loss: 1.486 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.1470820903778076
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.543 Vali Acc: 0.541 Test Loss: 1.543 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.6581921577453613
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.526 Vali Acc: 0.568 Test Loss: 1.526 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 134684
model size : 1.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.2646636962890625
Epoch: 1, Steps: 10 | Train Loss: 1.506 Vali Loss: 1.346 Vali Acc: 0.338 Test Loss: 1.346 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 1.4933788776397705
Epoch: 2, Steps: 10 | Train Loss: 1.527 Vali Loss: 1.465 Vali Acc: 0.230 Test Loss: 1.465 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4757916927337646
Epoch: 3, Steps: 10 | Train Loss: 1.407 Vali Loss: 1.312 Vali Acc: 0.378 Test Loss: 1.312 Test Acc: 0.378
Validation loss decreased (-0.337824 --> -0.378365).  Saving model ...
Epoch: 4 cost time: 1.4543383121490479
Epoch: 4, Steps: 10 | Train Loss: 1.266 Vali Loss: 1.404 Vali Acc: 0.284 Test Loss: 1.404 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0988385677337646
Epoch: 5, Steps: 10 | Train Loss: 1.226 Vali Loss: 1.362 Vali Acc: 0.270 Test Loss: 1.362 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.483027458190918
Epoch: 6, Steps: 10 | Train Loss: 1.104 Vali Loss: 1.316 Vali Acc: 0.432 Test Loss: 1.316 Test Acc: 0.432
Validation loss decreased (-0.378365 --> -0.432419).  Saving model ...
Epoch: 7 cost time: 1.229865312576294
Epoch: 7, Steps: 10 | Train Loss: 1.039 Vali Loss: 1.224 Vali Acc: 0.405 Test Loss: 1.224 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.482050895690918
Epoch: 8, Steps: 10 | Train Loss: 0.864 Vali Loss: 1.198 Vali Acc: 0.459 Test Loss: 1.198 Test Acc: 0.459
Validation loss decreased (-0.432419 --> -0.459447).  Saving model ...
Epoch: 9 cost time: 1.3948981761932373
Epoch: 9, Steps: 10 | Train Loss: 0.768 Vali Loss: 1.225 Vali Acc: 0.432 Test Loss: 1.225 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2999911308288574
Epoch: 10, Steps: 10 | Train Loss: 0.719 Vali Loss: 1.190 Vali Acc: 0.500 Test Loss: 1.190 Test Acc: 0.500
Validation loss decreased (-0.459447 --> -0.499988).  Saving model ...
Epoch: 11 cost time: 1.5819685459136963
Epoch: 11, Steps: 10 | Train Loss: 0.656 Vali Loss: 1.327 Vali Acc: 0.527 Test Loss: 1.327 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527014).  Saving model ...
Epoch: 12 cost time: 1.394150972366333
Epoch: 12, Steps: 10 | Train Loss: 0.546 Vali Loss: 1.254 Vali Acc: 0.446 Test Loss: 1.254 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2534396648406982
Epoch: 13, Steps: 10 | Train Loss: 0.414 Vali Loss: 1.193 Vali Acc: 0.459 Test Loss: 1.193 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3963205814361572
Epoch: 14, Steps: 10 | Train Loss: 0.318 Vali Loss: 1.077 Vali Acc: 0.581 Test Loss: 1.077 Test Acc: 0.581
Validation loss decreased (-0.527014 --> -0.581070).  Saving model ...
Epoch: 15 cost time: 1.4007372856140137
Epoch: 15, Steps: 10 | Train Loss: 0.257 Vali Loss: 1.304 Vali Acc: 0.473 Test Loss: 1.304 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0698542594909668
Epoch: 16, Steps: 10 | Train Loss: 0.165 Vali Loss: 1.209 Vali Acc: 0.541 Test Loss: 1.209 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4211311340332031
Epoch: 17, Steps: 10 | Train Loss: 0.142 Vali Loss: 1.249 Vali Acc: 0.568 Test Loss: 1.249 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3773534297943115
Epoch: 18, Steps: 10 | Train Loss: 0.093 Vali Loss: 1.182 Vali Acc: 0.581 Test Loss: 1.182 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.5933740139007568
Epoch: 19, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.252 Vali Acc: 0.554 Test Loss: 1.252 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.3389582633972168
Epoch: 20, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.371 Vali Acc: 0.514 Test Loss: 1.371 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.2926321029663086
Epoch: 21, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.288 Vali Acc: 0.554 Test Loss: 1.288 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.143831491470337
Epoch: 22, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.373 Vali Acc: 0.554 Test Loss: 1.373 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.196108341217041
Epoch: 23, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.336 Vali Acc: 0.568 Test Loss: 1.336 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.3225245475769043
Epoch: 24, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.407 Vali Acc: 0.568 Test Loss: 1.407 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_Crossformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 133596
model size : 1.19MB
