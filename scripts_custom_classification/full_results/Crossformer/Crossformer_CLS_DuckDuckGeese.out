Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 8.210418462753296
Epoch: 1, Steps: 13 | Train Loss: 5.583 Vali Loss: 17.051 Vali Acc: 0.200 Test Loss: 17.051 Test Acc: 0.200
Validation loss decreased (inf --> -0.199829).  Saving model ...
Epoch: 2 cost time: 6.608196973800659
Epoch: 2, Steps: 13 | Train Loss: 20.554 Vali Loss: 30.003 Vali Acc: 0.180 Test Loss: 30.003 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.585787534713745
Epoch: 3, Steps: 13 | Train Loss: 16.551 Vali Loss: 17.512 Vali Acc: 0.400 Test Loss: 17.512 Test Acc: 0.400
Validation loss decreased (-0.199829 --> -0.399825).  Saving model ...
Epoch: 4 cost time: 6.6988844871521
Epoch: 4, Steps: 13 | Train Loss: 19.230 Vali Loss: 36.029 Vali Acc: 0.240 Test Loss: 36.029 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.639470338821411
Epoch: 5, Steps: 13 | Train Loss: 21.368 Vali Loss: 24.183 Vali Acc: 0.460 Test Loss: 24.183 Test Acc: 0.460
Validation loss decreased (-0.399825 --> -0.459758).  Saving model ...
Epoch: 6 cost time: 6.735320091247559
Epoch: 6, Steps: 13 | Train Loss: 14.346 Vali Loss: 26.754 Vali Acc: 0.400 Test Loss: 26.754 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.716989755630493
Epoch: 7, Steps: 13 | Train Loss: 18.962 Vali Loss: 29.099 Vali Acc: 0.460 Test Loss: 29.099 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.901325225830078
Epoch: 8, Steps: 13 | Train Loss: 14.622 Vali Loss: 64.069 Vali Acc: 0.360 Test Loss: 64.069 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.676316976547241
Epoch: 9, Steps: 13 | Train Loss: 11.849 Vali Loss: 36.635 Vali Acc: 0.540 Test Loss: 36.635 Test Acc: 0.540
Validation loss decreased (-0.459758 --> -0.539634).  Saving model ...
Epoch: 10 cost time: 6.819512128829956
Epoch: 10, Steps: 13 | Train Loss: 19.964 Vali Loss: 36.536 Vali Acc: 0.560 Test Loss: 36.536 Test Acc: 0.560
Validation loss decreased (-0.539634 --> -0.559635).  Saving model ...
Epoch: 11 cost time: 6.903540849685669
Epoch: 11, Steps: 13 | Train Loss: 20.712 Vali Loss: 63.852 Vali Acc: 0.220 Test Loss: 63.852 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.062901258468628
Epoch: 12, Steps: 13 | Train Loss: 17.322 Vali Loss: 43.054 Vali Acc: 0.500 Test Loss: 43.054 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 7.038586378097534
Epoch: 13, Steps: 13 | Train Loss: 10.135 Vali Loss: 59.813 Vali Acc: 0.360 Test Loss: 59.813 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 7.024811744689941
Epoch: 14, Steps: 13 | Train Loss: 6.430 Vali Loss: 29.593 Vali Acc: 0.540 Test Loss: 29.593 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.772294521331787
Epoch: 15, Steps: 13 | Train Loss: 6.486 Vali Loss: 48.267 Vali Acc: 0.480 Test Loss: 48.267 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 6.832575798034668
Epoch: 16, Steps: 13 | Train Loss: 2.213 Vali Loss: 55.672 Vali Acc: 0.540 Test Loss: 55.672 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 6.957775354385376
Epoch: 17, Steps: 13 | Train Loss: 17.193 Vali Loss: 37.395 Vali Acc: 0.580 Test Loss: 37.395 Test Acc: 0.580
Validation loss decreased (-0.559635 --> -0.579626).  Saving model ...
Epoch: 18 cost time: 6.879652261734009
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 34.541 Vali Acc: 0.600 Test Loss: 34.541 Test Acc: 0.600
Validation loss decreased (-0.579626 --> -0.599655).  Saving model ...
Epoch: 19 cost time: 7.127374172210693
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 37.833 Vali Acc: 0.580 Test Loss: 37.833 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.975172996520996
Epoch: 20, Steps: 13 | Train Loss: 1.051 Vali Loss: 38.311 Vali Acc: 0.580 Test Loss: 38.311 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 7.108096361160278
Epoch: 21, Steps: 13 | Train Loss: 2.362 Vali Loss: 37.860 Vali Acc: 0.560 Test Loss: 37.860 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 7.307164430618286
Epoch: 22, Steps: 13 | Train Loss: 0.397 Vali Loss: 36.925 Vali Acc: 0.540 Test Loss: 36.925 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 6.9764564037323
Epoch: 23, Steps: 13 | Train Loss: 0.561 Vali Loss: 47.891 Vali Acc: 0.520 Test Loss: 47.891 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 7.124611139297485
Epoch: 24, Steps: 13 | Train Loss: 1.091 Vali Loss: 45.717 Vali Acc: 0.560 Test Loss: 45.717 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 7.023247957229614
Epoch: 25, Steps: 13 | Train Loss: 0.689 Vali Loss: 46.712 Vali Acc: 0.480 Test Loss: 46.712 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 6.961986780166626
Epoch: 26, Steps: 13 | Train Loss: 8.431 Vali Loss: 42.593 Vali Acc: 0.560 Test Loss: 42.593 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 6.8224310874938965
Epoch: 27, Steps: 13 | Train Loss: 5.759 Vali Loss: 94.662 Vali Acc: 0.400 Test Loss: 94.662 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 7.026942491531372
Epoch: 28, Steps: 13 | Train Loss: 24.125 Vali Loss: 43.569 Vali Acc: 0.520 Test Loss: 43.569 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 27380545
model size : 109.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 8.760629415512085
Epoch: 1, Steps: 13 | Train Loss: 5.707 Vali Loss: 16.884 Vali Acc: 0.200 Test Loss: 16.884 Test Acc: 0.200
Validation loss decreased (inf --> -0.199831).  Saving model ...
Epoch: 2 cost time: 6.7720324993133545
Epoch: 2, Steps: 13 | Train Loss: 16.890 Vali Loss: 33.084 Vali Acc: 0.200 Test Loss: 33.084 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.817518949508667
Epoch: 3, Steps: 13 | Train Loss: 22.204 Vali Loss: 28.144 Vali Acc: 0.260 Test Loss: 28.144 Test Acc: 0.260
Validation loss decreased (-0.199831 --> -0.259719).  Saving model ...
Epoch: 4 cost time: 6.789615869522095
Epoch: 4, Steps: 13 | Train Loss: 13.099 Vali Loss: 32.658 Vali Acc: 0.480 Test Loss: 32.658 Test Acc: 0.480
Validation loss decreased (-0.259719 --> -0.479673).  Saving model ...
Epoch: 5 cost time: 6.875049352645874
Epoch: 5, Steps: 13 | Train Loss: 20.850 Vali Loss: 33.684 Vali Acc: 0.380 Test Loss: 33.684 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.939239501953125
Epoch: 6, Steps: 13 | Train Loss: 16.998 Vali Loss: 18.414 Vali Acc: 0.500 Test Loss: 18.414 Test Acc: 0.500
Validation loss decreased (-0.479673 --> -0.499816).  Saving model ...
Epoch: 7 cost time: 6.884452819824219
Epoch: 7, Steps: 13 | Train Loss: 14.770 Vali Loss: 34.597 Vali Acc: 0.460 Test Loss: 34.597 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.87281346321106
Epoch: 8, Steps: 13 | Train Loss: 13.984 Vali Loss: 44.538 Vali Acc: 0.380 Test Loss: 44.538 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.129607200622559
Epoch: 9, Steps: 13 | Train Loss: 11.240 Vali Loss: 73.248 Vali Acc: 0.340 Test Loss: 73.248 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 7.076088190078735
Epoch: 10, Steps: 13 | Train Loss: 22.955 Vali Loss: 69.406 Vali Acc: 0.420 Test Loss: 69.406 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.826854228973389
Epoch: 11, Steps: 13 | Train Loss: 27.170 Vali Loss: 56.067 Vali Acc: 0.480 Test Loss: 56.067 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 7.027934551239014
Epoch: 12, Steps: 13 | Train Loss: 15.383 Vali Loss: 44.933 Vali Acc: 0.540 Test Loss: 44.933 Test Acc: 0.540
Validation loss decreased (-0.499816 --> -0.539551).  Saving model ...
Epoch: 13 cost time: 6.8630454540252686
Epoch: 13, Steps: 13 | Train Loss: 16.305 Vali Loss: 35.956 Vali Acc: 0.520 Test Loss: 35.956 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 7.0215301513671875
Epoch: 14, Steps: 13 | Train Loss: 15.097 Vali Loss: 43.627 Vali Acc: 0.500 Test Loss: 43.627 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.8255228996276855
Epoch: 15, Steps: 13 | Train Loss: 6.685 Vali Loss: 37.870 Vali Acc: 0.620 Test Loss: 37.870 Test Acc: 0.620
Validation loss decreased (-0.539551 --> -0.619621).  Saving model ...
Epoch: 16 cost time: 6.829482078552246
Epoch: 16, Steps: 13 | Train Loss: 4.056 Vali Loss: 32.499 Vali Acc: 0.600 Test Loss: 32.499 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.943036079406738
Epoch: 17, Steps: 13 | Train Loss: 2.735 Vali Loss: 81.299 Vali Acc: 0.460 Test Loss: 81.299 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 7.030459642410278
Epoch: 18, Steps: 13 | Train Loss: 6.829 Vali Loss: 60.147 Vali Acc: 0.380 Test Loss: 60.147 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 6.9056150913238525
Epoch: 19, Steps: 13 | Train Loss: 9.999 Vali Loss: 44.651 Vali Acc: 0.560 Test Loss: 44.651 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 7.193450450897217
Epoch: 20, Steps: 13 | Train Loss: 7.772 Vali Loss: 30.123 Vali Acc: 0.700 Test Loss: 30.123 Test Acc: 0.700
Validation loss decreased (-0.619621 --> -0.699699).  Saving model ...
Epoch: 21 cost time: 6.955420970916748
Epoch: 21, Steps: 13 | Train Loss: 2.123 Vali Loss: 42.745 Vali Acc: 0.600 Test Loss: 42.745 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 7.17753005027771
Epoch: 22, Steps: 13 | Train Loss: 10.545 Vali Loss: 44.826 Vali Acc: 0.620 Test Loss: 44.826 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 6.988425254821777
Epoch: 23, Steps: 13 | Train Loss: 23.078 Vali Loss: 42.973 Vali Acc: 0.620 Test Loss: 42.973 Test Acc: 0.620
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 6.819352388381958
Epoch: 24, Steps: 13 | Train Loss: 1.020 Vali Loss: 57.279 Vali Acc: 0.500 Test Loss: 57.279 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 7.028219699859619
Epoch: 25, Steps: 13 | Train Loss: 3.670 Vali Loss: 63.494 Vali Acc: 0.520 Test Loss: 63.494 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 7.001166343688965
Epoch: 26, Steps: 13 | Train Loss: 4.625 Vali Loss: 63.895 Vali Acc: 0.620 Test Loss: 63.895 Test Acc: 0.620
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 6.902891397476196
Epoch: 27, Steps: 13 | Train Loss: 17.093 Vali Loss: 59.546 Vali Acc: 0.580 Test Loss: 59.546 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 6.892799377441406
Epoch: 28, Steps: 13 | Train Loss: 13.036 Vali Loss: 64.707 Vali Acc: 0.580 Test Loss: 64.707 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 7.1657960414886475
Epoch: 29, Steps: 13 | Train Loss: 7.698 Vali Loss: 98.527 Vali Acc: 0.560 Test Loss: 98.527 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 6.844269037246704
Epoch: 30, Steps: 13 | Train Loss: 15.520 Vali Loss: 82.733 Vali Acc: 0.540 Test Loss: 82.733 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.7
model parameter : 27369281
model size : 109.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 8.355477333068848
Epoch: 1, Steps: 13 | Train Loss: 7.809 Vali Loss: 10.815 Vali Acc: 0.200 Test Loss: 10.815 Test Acc: 0.200
Validation loss decreased (inf --> -0.199892).  Saving model ...
Epoch: 2 cost time: 6.916822910308838
Epoch: 2, Steps: 13 | Train Loss: 16.134 Vali Loss: 25.277 Vali Acc: 0.160 Test Loss: 25.277 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.7522382736206055
Epoch: 3, Steps: 13 | Train Loss: 14.554 Vali Loss: 10.555 Vali Acc: 0.440 Test Loss: 10.555 Test Acc: 0.440
Validation loss decreased (-0.199892 --> -0.439894).  Saving model ...
Epoch: 4 cost time: 6.994894504547119
Epoch: 4, Steps: 13 | Train Loss: 9.846 Vali Loss: 21.608 Vali Acc: 0.260 Test Loss: 21.608 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.866347312927246
Epoch: 5, Steps: 13 | Train Loss: 16.991 Vali Loss: 33.093 Vali Acc: 0.420 Test Loss: 33.093 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.923680305480957
Epoch: 6, Steps: 13 | Train Loss: 15.454 Vali Loss: 39.298 Vali Acc: 0.360 Test Loss: 39.298 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.876145362854004
Epoch: 7, Steps: 13 | Train Loss: 17.799 Vali Loss: 57.029 Vali Acc: 0.340 Test Loss: 57.029 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 6.7198569774627686
Epoch: 8, Steps: 13 | Train Loss: 20.448 Vali Loss: 27.309 Vali Acc: 0.420 Test Loss: 27.309 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 6.9780895709991455
Epoch: 9, Steps: 13 | Train Loss: 31.322 Vali Loss: 17.189 Vali Acc: 0.620 Test Loss: 17.189 Test Acc: 0.620
Validation loss decreased (-0.439894 --> -0.619828).  Saving model ...
Epoch: 10 cost time: 6.985852241516113
Epoch: 10, Steps: 13 | Train Loss: 13.576 Vali Loss: 41.949 Vali Acc: 0.440 Test Loss: 41.949 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.88474702835083
Epoch: 11, Steps: 13 | Train Loss: 11.774 Vali Loss: 32.021 Vali Acc: 0.500 Test Loss: 32.021 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 7.008766412734985
Epoch: 12, Steps: 13 | Train Loss: 19.114 Vali Loss: 31.195 Vali Acc: 0.500 Test Loss: 31.195 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.798503160476685
Epoch: 13, Steps: 13 | Train Loss: 9.386 Vali Loss: 22.669 Vali Acc: 0.620 Test Loss: 22.669 Test Acc: 0.620
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.926379919052124
Epoch: 14, Steps: 13 | Train Loss: 3.340 Vali Loss: 23.334 Vali Acc: 0.620 Test Loss: 23.334 Test Acc: 0.620
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 6.981235980987549
Epoch: 15, Steps: 13 | Train Loss: 0.403 Vali Loss: 26.510 Vali Acc: 0.520 Test Loss: 26.510 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.874408483505249
Epoch: 16, Steps: 13 | Train Loss: 2.085 Vali Loss: 29.444 Vali Acc: 0.380 Test Loss: 29.444 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 7.062443017959595
Epoch: 17, Steps: 13 | Train Loss: 10.771 Vali Loss: 53.461 Vali Acc: 0.420 Test Loss: 53.461 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 6.985737323760986
Epoch: 18, Steps: 13 | Train Loss: 10.093 Vali Loss: 57.475 Vali Acc: 0.520 Test Loss: 57.475 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 6.830971717834473
Epoch: 19, Steps: 13 | Train Loss: 4.154 Vali Loss: 37.144 Vali Acc: 0.580 Test Loss: 37.144 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 27358017
model size : 109.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 8.69614052772522
Epoch: 1, Steps: 13 | Train Loss: 14.823 Vali Loss: 22.768 Vali Acc: 0.180 Test Loss: 22.768 Test Acc: 0.180
Validation loss decreased (inf --> -0.179772).  Saving model ...
Epoch: 2 cost time: 6.849250793457031
Epoch: 2, Steps: 13 | Train Loss: 17.592 Vali Loss: 28.850 Vali Acc: 0.240 Test Loss: 28.850 Test Acc: 0.240
Validation loss decreased (-0.179772 --> -0.239711).  Saving model ...
Epoch: 3 cost time: 6.883265018463135
Epoch: 3, Steps: 13 | Train Loss: 33.945 Vali Loss: 43.768 Vali Acc: 0.200 Test Loss: 43.768 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.132462501525879
Epoch: 4, Steps: 13 | Train Loss: 28.989 Vali Loss: 52.641 Vali Acc: 0.380 Test Loss: 52.641 Test Acc: 0.380
Validation loss decreased (-0.239711 --> -0.379474).  Saving model ...
Epoch: 5 cost time: 6.913163423538208
Epoch: 5, Steps: 13 | Train Loss: 41.789 Vali Loss: 41.205 Vali Acc: 0.420 Test Loss: 41.205 Test Acc: 0.420
Validation loss decreased (-0.379474 --> -0.419588).  Saving model ...
Epoch: 6 cost time: 6.708898544311523
Epoch: 6, Steps: 13 | Train Loss: 23.796 Vali Loss: 38.189 Vali Acc: 0.400 Test Loss: 38.189 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.98646879196167
Epoch: 7, Steps: 13 | Train Loss: 30.097 Vali Loss: 63.758 Vali Acc: 0.420 Test Loss: 63.758 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.771129131317139
Epoch: 8, Steps: 13 | Train Loss: 31.132 Vali Loss: 57.362 Vali Acc: 0.460 Test Loss: 57.362 Test Acc: 0.460
Validation loss decreased (-0.419588 --> -0.459426).  Saving model ...
Epoch: 9 cost time: 6.761981964111328
Epoch: 9, Steps: 13 | Train Loss: 22.467 Vali Loss: 42.780 Vali Acc: 0.400 Test Loss: 42.780 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.15288782119751
Epoch: 10, Steps: 13 | Train Loss: 19.092 Vali Loss: 41.946 Vali Acc: 0.440 Test Loss: 41.946 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.746066331863403
Epoch: 11, Steps: 13 | Train Loss: 10.546 Vali Loss: 47.372 Vali Acc: 0.480 Test Loss: 47.372 Test Acc: 0.480
Validation loss decreased (-0.459426 --> -0.479526).  Saving model ...
Epoch: 12 cost time: 6.706428527832031
Epoch: 12, Steps: 13 | Train Loss: 6.496 Vali Loss: 41.007 Vali Acc: 0.460 Test Loss: 41.007 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.808517932891846
Epoch: 13, Steps: 13 | Train Loss: 0.822 Vali Loss: 63.012 Vali Acc: 0.420 Test Loss: 63.012 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.736216068267822
Epoch: 14, Steps: 13 | Train Loss: 2.241 Vali Loss: 62.846 Vali Acc: 0.400 Test Loss: 62.846 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.935170888900757
Epoch: 15, Steps: 13 | Train Loss: 9.045 Vali Loss: 58.078 Vali Acc: 0.460 Test Loss: 58.078 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 6.730603218078613
Epoch: 16, Steps: 13 | Train Loss: 7.795 Vali Loss: 72.367 Vali Acc: 0.340 Test Loss: 72.367 Test Acc: 0.340
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 6.752317190170288
Epoch: 17, Steps: 13 | Train Loss: 0.474 Vali Loss: 85.357 Vali Acc: 0.480 Test Loss: 85.357 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 7.098729610443115
Epoch: 18, Steps: 13 | Train Loss: 9.167 Vali Loss: 64.934 Vali Acc: 0.500 Test Loss: 64.934 Test Acc: 0.500
Validation loss decreased (-0.479526 --> -0.499351).  Saving model ...
Epoch: 19 cost time: 6.816782474517822
Epoch: 19, Steps: 13 | Train Loss: 12.399 Vali Loss: 66.569 Vali Acc: 0.500 Test Loss: 66.569 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.9530792236328125
Epoch: 20, Steps: 13 | Train Loss: 14.394 Vali Loss: 49.761 Vali Acc: 0.580 Test Loss: 49.761 Test Acc: 0.580
Validation loss decreased (-0.499351 --> -0.579502).  Saving model ...
Epoch: 21 cost time: 6.683605909347534
Epoch: 21, Steps: 13 | Train Loss: 6.798 Vali Loss: 57.873 Vali Acc: 0.600 Test Loss: 57.873 Test Acc: 0.600
Validation loss decreased (-0.579502 --> -0.599421).  Saving model ...
Epoch: 22 cost time: 6.890081167221069
Epoch: 22, Steps: 13 | Train Loss: 3.968 Vali Loss: 73.233 Vali Acc: 0.460 Test Loss: 73.233 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 6.794630527496338
Epoch: 23, Steps: 13 | Train Loss: 10.460 Vali Loss: 87.304 Vali Acc: 0.460 Test Loss: 87.304 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 6.62744140625
Epoch: 24, Steps: 13 | Train Loss: 19.125 Vali Loss: 62.875 Vali Acc: 0.560 Test Loss: 62.875 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 6.875859260559082
Epoch: 25, Steps: 13 | Train Loss: 3.934 Vali Loss: 61.778 Vali Acc: 0.500 Test Loss: 61.778 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 6.775920152664185
Epoch: 26, Steps: 13 | Train Loss: 13.874 Vali Loss: 56.531 Vali Acc: 0.540 Test Loss: 56.531 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 6.797032594680786
Epoch: 27, Steps: 13 | Train Loss: 8.091 Vali Loss: 98.669 Vali Acc: 0.480 Test Loss: 98.669 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 6.663997173309326
Epoch: 28, Steps: 13 | Train Loss: 25.657 Vali Loss: 71.569 Vali Acc: 0.440 Test Loss: 71.569 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 6.873057842254639
Epoch: 29, Steps: 13 | Train Loss: 30.089 Vali Loss: 41.696 Vali Acc: 0.320 Test Loss: 41.696 Test Acc: 0.320
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 6.853626489639282
Epoch: 30, Steps: 13 | Train Loss: 36.386 Vali Loss: 11.677 Vali Acc: 0.360 Test Loss: 11.677 Test Acc: 0.360
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 6.893953800201416
Epoch: 31, Steps: 13 | Train Loss: 18.687 Vali Loss: 52.005 Vali Acc: 0.540 Test Loss: 52.005 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 27346753
model size : 109.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 8.124068975448608
Epoch: 1, Steps: 13 | Train Loss: 7.299 Vali Loss: 21.721 Vali Acc: 0.200 Test Loss: 21.721 Test Acc: 0.200
Validation loss decreased (inf --> -0.199783).  Saving model ...
Epoch: 2 cost time: 6.580040216445923
Epoch: 2, Steps: 13 | Train Loss: 20.910 Vali Loss: 24.458 Vali Acc: 0.320 Test Loss: 24.458 Test Acc: 0.320
Validation loss decreased (-0.199783 --> -0.319755).  Saving model ...
Epoch: 3 cost time: 6.301382780075073
Epoch: 3, Steps: 13 | Train Loss: 17.499 Vali Loss: 39.209 Vali Acc: 0.320 Test Loss: 39.209 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.158186912536621
Epoch: 4, Steps: 13 | Train Loss: 19.443 Vali Loss: 46.346 Vali Acc: 0.320 Test Loss: 46.346 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.194345235824585
Epoch: 5, Steps: 13 | Train Loss: 26.290 Vali Loss: 63.161 Vali Acc: 0.280 Test Loss: 63.161 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.12669825553894
Epoch: 6, Steps: 13 | Train Loss: 22.478 Vali Loss: 41.804 Vali Acc: 0.360 Test Loss: 41.804 Test Acc: 0.360
Validation loss decreased (-0.319755 --> -0.359582).  Saving model ...
Epoch: 7 cost time: 6.200993061065674
Epoch: 7, Steps: 13 | Train Loss: 24.608 Vali Loss: 31.895 Vali Acc: 0.400 Test Loss: 31.895 Test Acc: 0.400
Validation loss decreased (-0.359582 --> -0.399681).  Saving model ...
Epoch: 8 cost time: 6.172978639602661
Epoch: 8, Steps: 13 | Train Loss: 7.846 Vali Loss: 39.348 Vali Acc: 0.360 Test Loss: 39.348 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.456533908843994
Epoch: 9, Steps: 13 | Train Loss: 12.264 Vali Loss: 39.792 Vali Acc: 0.460 Test Loss: 39.792 Test Acc: 0.460
Validation loss decreased (-0.399681 --> -0.459602).  Saving model ...
Epoch: 10 cost time: 6.316598176956177
Epoch: 10, Steps: 13 | Train Loss: 7.702 Vali Loss: 23.510 Vali Acc: 0.500 Test Loss: 23.510 Test Acc: 0.500
Validation loss decreased (-0.459602 --> -0.499765).  Saving model ...
Epoch: 11 cost time: 6.414275407791138
Epoch: 11, Steps: 13 | Train Loss: 4.512 Vali Loss: 43.472 Vali Acc: 0.420 Test Loss: 43.472 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.595450162887573
Epoch: 12, Steps: 13 | Train Loss: 8.675 Vali Loss: 61.324 Vali Acc: 0.380 Test Loss: 61.324 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.60150933265686
Epoch: 13, Steps: 13 | Train Loss: 9.560 Vali Loss: 43.016 Vali Acc: 0.460 Test Loss: 43.016 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.3278725147247314
Epoch: 14, Steps: 13 | Train Loss: 6.216 Vali Loss: 49.278 Vali Acc: 0.420 Test Loss: 49.278 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.455155849456787
Epoch: 15, Steps: 13 | Train Loss: 5.528 Vali Loss: 40.979 Vali Acc: 0.460 Test Loss: 40.979 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 6.139655351638794
Epoch: 16, Steps: 13 | Train Loss: 4.109 Vali Loss: 75.868 Vali Acc: 0.400 Test Loss: 75.868 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 6.3447699546813965
Epoch: 17, Steps: 13 | Train Loss: 18.329 Vali Loss: 35.080 Vali Acc: 0.500 Test Loss: 35.080 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 6.1546759605407715
Epoch: 18, Steps: 13 | Train Loss: 13.900 Vali Loss: 43.286 Vali Acc: 0.440 Test Loss: 43.286 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 6.223806381225586
Epoch: 19, Steps: 13 | Train Loss: 1.963 Vali Loss: 63.623 Vali Acc: 0.480 Test Loss: 63.623 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 6.189398288726807
Epoch: 20, Steps: 13 | Train Loss: 6.034 Vali Loss: 49.786 Vali Acc: 0.480 Test Loss: 49.786 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 25016641
model size : 100.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 8.289855241775513
Epoch: 1, Steps: 13 | Train Loss: 6.508 Vali Loss: 9.223 Vali Acc: 0.240 Test Loss: 9.223 Test Acc: 0.240
Validation loss decreased (inf --> -0.239908).  Saving model ...
Epoch: 2 cost time: 6.04451584815979
Epoch: 2, Steps: 13 | Train Loss: 20.037 Vali Loss: 27.367 Vali Acc: 0.280 Test Loss: 27.367 Test Acc: 0.280
Validation loss decreased (-0.239908 --> -0.279726).  Saving model ...
Epoch: 3 cost time: 6.527738094329834
Epoch: 3, Steps: 13 | Train Loss: 19.813 Vali Loss: 19.534 Vali Acc: 0.360 Test Loss: 19.534 Test Acc: 0.360
Validation loss decreased (-0.279726 --> -0.359805).  Saving model ...
Epoch: 4 cost time: 6.231010437011719
Epoch: 4, Steps: 13 | Train Loss: 26.927 Vali Loss: 23.508 Vali Acc: 0.420 Test Loss: 23.508 Test Acc: 0.420
Validation loss decreased (-0.359805 --> -0.419765).  Saving model ...
Epoch: 5 cost time: 6.179378986358643
Epoch: 5, Steps: 13 | Train Loss: 27.006 Vali Loss: 51.264 Vali Acc: 0.340 Test Loss: 51.264 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.102829456329346
Epoch: 6, Steps: 13 | Train Loss: 26.140 Vali Loss: 35.695 Vali Acc: 0.540 Test Loss: 35.695 Test Acc: 0.540
Validation loss decreased (-0.419765 --> -0.539643).  Saving model ...
Epoch: 7 cost time: 6.2211525440216064
Epoch: 7, Steps: 13 | Train Loss: 14.270 Vali Loss: 62.136 Vali Acc: 0.240 Test Loss: 62.136 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.030352830886841
Epoch: 8, Steps: 13 | Train Loss: 20.903 Vali Loss: 44.285 Vali Acc: 0.520 Test Loss: 44.285 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.033529281616211
Epoch: 9, Steps: 13 | Train Loss: 22.631 Vali Loss: 35.233 Vali Acc: 0.480 Test Loss: 35.233 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.163828372955322
Epoch: 10, Steps: 13 | Train Loss: 16.013 Vali Loss: 68.718 Vali Acc: 0.400 Test Loss: 68.718 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.11543607711792
Epoch: 11, Steps: 13 | Train Loss: 14.979 Vali Loss: 29.324 Vali Acc: 0.600 Test Loss: 29.324 Test Acc: 0.600
Validation loss decreased (-0.539643 --> -0.599707).  Saving model ...
Epoch: 12 cost time: 6.164609670639038
Epoch: 12, Steps: 13 | Train Loss: 16.526 Vali Loss: 42.665 Vali Acc: 0.480 Test Loss: 42.665 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.318349838256836
Epoch: 13, Steps: 13 | Train Loss: 5.062 Vali Loss: 34.092 Vali Acc: 0.580 Test Loss: 34.092 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.24665379524231
Epoch: 14, Steps: 13 | Train Loss: 4.552 Vali Loss: 45.503 Vali Acc: 0.480 Test Loss: 45.503 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.262857675552368
Epoch: 15, Steps: 13 | Train Loss: 4.220 Vali Loss: 48.771 Vali Acc: 0.580 Test Loss: 48.771 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 6.5098183155059814
Epoch: 16, Steps: 13 | Train Loss: 3.255 Vali Loss: 47.324 Vali Acc: 0.580 Test Loss: 47.324 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 6.0709803104400635
Epoch: 17, Steps: 13 | Train Loss: 1.850 Vali Loss: 34.975 Vali Acc: 0.620 Test Loss: 34.975 Test Acc: 0.620
Validation loss decreased (-0.599707 --> -0.619650).  Saving model ...
Epoch: 18 cost time: 6.217970609664917
Epoch: 18, Steps: 13 | Train Loss: 1.097 Vali Loss: 40.012 Vali Acc: 0.540 Test Loss: 40.012 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.372649431228638
Epoch: 19, Steps: 13 | Train Loss: 0.987 Vali Loss: 52.025 Vali Acc: 0.560 Test Loss: 52.025 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 6.158910512924194
Epoch: 20, Steps: 13 | Train Loss: 0.808 Vali Loss: 53.802 Vali Acc: 0.420 Test Loss: 53.802 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 6.270062685012817
Epoch: 21, Steps: 13 | Train Loss: 3.032 Vali Loss: 75.406 Vali Acc: 0.520 Test Loss: 75.406 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 6.141778469085693
Epoch: 22, Steps: 13 | Train Loss: 4.862 Vali Loss: 54.030 Vali Acc: 0.520 Test Loss: 54.030 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 6.112219333648682
Epoch: 23, Steps: 13 | Train Loss: 8.818 Vali Loss: 46.103 Vali Acc: 0.520 Test Loss: 46.103 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 6.280939340591431
Epoch: 24, Steps: 13 | Train Loss: 2.109 Vali Loss: 52.682 Vali Acc: 0.560 Test Loss: 52.682 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 6.037088632583618
Epoch: 25, Steps: 13 | Train Loss: 4.451 Vali Loss: 41.385 Vali Acc: 0.620 Test Loss: 41.385 Test Acc: 0.620
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 6.047196626663208
Epoch: 26, Steps: 13 | Train Loss: 7.261 Vali Loss: 74.543 Vali Acc: 0.480 Test Loss: 74.543 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 6.356774568557739
Epoch: 27, Steps: 13 | Train Loss: 3.863 Vali Loss: 56.332 Vali Acc: 0.560 Test Loss: 56.332 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 25005377
model size : 100.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 8.207627534866333
Epoch: 1, Steps: 13 | Train Loss: 6.821 Vali Loss: 5.191 Vali Acc: 0.220 Test Loss: 5.191 Test Acc: 0.220
Validation loss decreased (inf --> -0.219948).  Saving model ...
Epoch: 2 cost time: 6.3630335330963135
Epoch: 2, Steps: 13 | Train Loss: 8.199 Vali Loss: 24.332 Vali Acc: 0.220 Test Loss: 24.332 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.415281534194946
Epoch: 3, Steps: 13 | Train Loss: 22.594 Vali Loss: 34.968 Vali Acc: 0.360 Test Loss: 34.968 Test Acc: 0.360
Validation loss decreased (-0.219948 --> -0.359650).  Saving model ...
Epoch: 4 cost time: 6.313812732696533
Epoch: 4, Steps: 13 | Train Loss: 25.149 Vali Loss: 25.591 Vali Acc: 0.500 Test Loss: 25.591 Test Acc: 0.500
Validation loss decreased (-0.359650 --> -0.499744).  Saving model ...
Epoch: 5 cost time: 6.250756502151489
Epoch: 5, Steps: 13 | Train Loss: 35.310 Vali Loss: 33.969 Vali Acc: 0.500 Test Loss: 33.969 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.245652198791504
Epoch: 6, Steps: 13 | Train Loss: 14.094 Vali Loss: 41.028 Vali Acc: 0.380 Test Loss: 41.028 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.30504846572876
Epoch: 7, Steps: 13 | Train Loss: 18.094 Vali Loss: 46.728 Vali Acc: 0.340 Test Loss: 46.728 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.133325099945068
Epoch: 8, Steps: 13 | Train Loss: 15.594 Vali Loss: 39.107 Vali Acc: 0.340 Test Loss: 39.107 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.324207305908203
Epoch: 9, Steps: 13 | Train Loss: 13.454 Vali Loss: 58.090 Vali Acc: 0.420 Test Loss: 58.090 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 6.312160015106201
Epoch: 10, Steps: 13 | Train Loss: 18.096 Vali Loss: 45.895 Vali Acc: 0.440 Test Loss: 45.895 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 6.2515950202941895
Epoch: 11, Steps: 13 | Train Loss: 8.958 Vali Loss: 30.778 Vali Acc: 0.540 Test Loss: 30.778 Test Acc: 0.540
Validation loss decreased (-0.499744 --> -0.539692).  Saving model ...
Epoch: 12 cost time: 6.345008134841919
Epoch: 12, Steps: 13 | Train Loss: 6.148 Vali Loss: 38.939 Vali Acc: 0.440 Test Loss: 38.939 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.379399299621582
Epoch: 13, Steps: 13 | Train Loss: 1.808 Vali Loss: 60.026 Vali Acc: 0.460 Test Loss: 60.026 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.3725340366363525
Epoch: 14, Steps: 13 | Train Loss: 12.915 Vali Loss: 58.512 Vali Acc: 0.540 Test Loss: 58.512 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.480855226516724
Epoch: 15, Steps: 13 | Train Loss: 18.713 Vali Loss: 47.253 Vali Acc: 0.600 Test Loss: 47.253 Test Acc: 0.600
Validation loss decreased (-0.539692 --> -0.599527).  Saving model ...
Epoch: 16 cost time: 6.120834827423096
Epoch: 16, Steps: 13 | Train Loss: 15.338 Vali Loss: 36.273 Vali Acc: 0.540 Test Loss: 36.273 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.480485916137695
Epoch: 17, Steps: 13 | Train Loss: 1.295 Vali Loss: 28.499 Vali Acc: 0.520 Test Loss: 28.499 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.263751745223999
Epoch: 18, Steps: 13 | Train Loss: 4.282 Vali Loss: 39.511 Vali Acc: 0.520 Test Loss: 39.511 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 6.179030656814575
Epoch: 19, Steps: 13 | Train Loss: 2.381 Vali Loss: 49.606 Vali Acc: 0.440 Test Loss: 49.606 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 6.246418714523315
Epoch: 20, Steps: 13 | Train Loss: 9.593 Vali Loss: 60.569 Vali Acc: 0.520 Test Loss: 60.569 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 6.420777320861816
Epoch: 21, Steps: 13 | Train Loss: 3.398 Vali Loss: 47.608 Vali Acc: 0.480 Test Loss: 47.608 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 6.299833297729492
Epoch: 22, Steps: 13 | Train Loss: 5.691 Vali Loss: 51.522 Vali Acc: 0.520 Test Loss: 51.522 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 6.310576915740967
Epoch: 23, Steps: 13 | Train Loss: 9.861 Vali Loss: 69.623 Vali Acc: 0.480 Test Loss: 69.623 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 6.154355764389038
Epoch: 24, Steps: 13 | Train Loss: 8.149 Vali Loss: 60.685 Vali Acc: 0.440 Test Loss: 60.685 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 6.3314597606658936
Epoch: 25, Steps: 13 | Train Loss: 5.101 Vali Loss: 163.953 Vali Acc: 0.300 Test Loss: 163.953 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 24994113
model size : 100.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 8.633882522583008
Epoch: 1, Steps: 13 | Train Loss: 5.926 Vali Loss: 13.615 Vali Acc: 0.280 Test Loss: 13.615 Test Acc: 0.280
Validation loss decreased (inf --> -0.279864).  Saving model ...
Epoch: 2 cost time: 6.315897226333618
Epoch: 2, Steps: 13 | Train Loss: 10.795 Vali Loss: 11.361 Vali Acc: 0.200 Test Loss: 11.361 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.264080047607422
Epoch: 3, Steps: 13 | Train Loss: 9.901 Vali Loss: 13.381 Vali Acc: 0.300 Test Loss: 13.381 Test Acc: 0.300
Validation loss decreased (-0.279864 --> -0.299866).  Saving model ...
Epoch: 4 cost time: 6.39448618888855
Epoch: 4, Steps: 13 | Train Loss: 17.450 Vali Loss: 31.605 Vali Acc: 0.280 Test Loss: 31.605 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.148796558380127
Epoch: 5, Steps: 13 | Train Loss: 27.676 Vali Loss: 59.883 Vali Acc: 0.380 Test Loss: 59.883 Test Acc: 0.380
Validation loss decreased (-0.299866 --> -0.379401).  Saving model ...
Epoch: 6 cost time: 6.296958684921265
Epoch: 6, Steps: 13 | Train Loss: 35.027 Vali Loss: 33.927 Vali Acc: 0.400 Test Loss: 33.927 Test Acc: 0.400
Validation loss decreased (-0.379401 --> -0.399661).  Saving model ...
Epoch: 7 cost time: 6.154188394546509
Epoch: 7, Steps: 13 | Train Loss: 22.570 Vali Loss: 37.074 Vali Acc: 0.460 Test Loss: 37.074 Test Acc: 0.460
Validation loss decreased (-0.399661 --> -0.459629).  Saving model ...
Epoch: 8 cost time: 6.323667526245117
Epoch: 8, Steps: 13 | Train Loss: 20.335 Vali Loss: 45.825 Vali Acc: 0.400 Test Loss: 45.825 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.242428779602051
Epoch: 9, Steps: 13 | Train Loss: 10.295 Vali Loss: 32.941 Vali Acc: 0.600 Test Loss: 32.941 Test Acc: 0.600
Validation loss decreased (-0.459629 --> -0.599671).  Saving model ...
Epoch: 10 cost time: 6.142200946807861
Epoch: 10, Steps: 13 | Train Loss: 11.619 Vali Loss: 34.299 Vali Acc: 0.440 Test Loss: 34.299 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.23881983757019
Epoch: 11, Steps: 13 | Train Loss: 9.591 Vali Loss: 34.826 Vali Acc: 0.600 Test Loss: 34.826 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.419224262237549
Epoch: 12, Steps: 13 | Train Loss: 10.501 Vali Loss: 35.206 Vali Acc: 0.460 Test Loss: 35.206 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.108041524887085
Epoch: 13, Steps: 13 | Train Loss: 5.229 Vali Loss: 50.945 Vali Acc: 0.420 Test Loss: 50.945 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.43908953666687
Epoch: 14, Steps: 13 | Train Loss: 6.334 Vali Loss: 38.597 Vali Acc: 0.440 Test Loss: 38.597 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 6.0175940990448
Epoch: 15, Steps: 13 | Train Loss: 7.196 Vali Loss: 61.189 Vali Acc: 0.440 Test Loss: 61.189 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.407871723175049
Epoch: 16, Steps: 13 | Train Loss: 12.059 Vali Loss: 59.145 Vali Acc: 0.500 Test Loss: 59.145 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 6.281270503997803
Epoch: 17, Steps: 13 | Train Loss: 8.923 Vali Loss: 65.786 Vali Acc: 0.400 Test Loss: 65.786 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 6.213135242462158
Epoch: 18, Steps: 13 | Train Loss: 14.767 Vali Loss: 72.157 Vali Acc: 0.440 Test Loss: 72.157 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 6.413460969924927
Epoch: 19, Steps: 13 | Train Loss: 9.974 Vali Loss: 86.430 Vali Acc: 0.440 Test Loss: 86.430 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 24982849
model size : 100.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 8.985277891159058
Epoch: 1, Steps: 13 | Train Loss: 6.517 Vali Loss: 10.875 Vali Acc: 0.200 Test Loss: 10.875 Test Acc: 0.200
Validation loss decreased (inf --> -0.199891).  Saving model ...
Epoch: 2 cost time: 6.260376691818237
Epoch: 2, Steps: 13 | Train Loss: 18.699 Vali Loss: 19.941 Vali Acc: 0.320 Test Loss: 19.941 Test Acc: 0.320
Validation loss decreased (-0.199891 --> -0.319801).  Saving model ...
Epoch: 3 cost time: 6.270657300949097
Epoch: 3, Steps: 13 | Train Loss: 20.227 Vali Loss: 21.825 Vali Acc: 0.320 Test Loss: 21.825 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.292558670043945
Epoch: 4, Steps: 13 | Train Loss: 12.539 Vali Loss: 25.021 Vali Acc: 0.520 Test Loss: 25.021 Test Acc: 0.520
Validation loss decreased (-0.319801 --> -0.519750).  Saving model ...
Epoch: 5 cost time: 6.118842840194702
Epoch: 5, Steps: 13 | Train Loss: 20.486 Vali Loss: 57.104 Vali Acc: 0.280 Test Loss: 57.104 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.228452205657959
Epoch: 6, Steps: 13 | Train Loss: 21.876 Vali Loss: 49.405 Vali Acc: 0.440 Test Loss: 49.405 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.280665397644043
Epoch: 7, Steps: 13 | Train Loss: 37.539 Vali Loss: 81.445 Vali Acc: 0.380 Test Loss: 81.445 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.383559226989746
Epoch: 8, Steps: 13 | Train Loss: 23.518 Vali Loss: 66.329 Vali Acc: 0.300 Test Loss: 66.329 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.264812707901001
Epoch: 9, Steps: 13 | Train Loss: 13.481 Vali Loss: 62.676 Vali Acc: 0.520 Test Loss: 62.676 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 6.388142108917236
Epoch: 10, Steps: 13 | Train Loss: 33.802 Vali Loss: 37.065 Vali Acc: 0.560 Test Loss: 37.065 Test Acc: 0.560
Validation loss decreased (-0.519750 --> -0.559629).  Saving model ...
Epoch: 11 cost time: 6.440107345581055
Epoch: 11, Steps: 13 | Train Loss: 2.803 Vali Loss: 50.565 Vali Acc: 0.440 Test Loss: 50.565 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.307100057601929
Epoch: 12, Steps: 13 | Train Loss: 8.936 Vali Loss: 60.028 Vali Acc: 0.520 Test Loss: 60.028 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.2755818367004395
Epoch: 13, Steps: 13 | Train Loss: 6.668 Vali Loss: 64.496 Vali Acc: 0.520 Test Loss: 64.496 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.294816493988037
Epoch: 14, Steps: 13 | Train Loss: 9.701 Vali Loss: 80.894 Vali Acc: 0.460 Test Loss: 80.894 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.06595778465271
Epoch: 15, Steps: 13 | Train Loss: 6.396 Vali Loss: 54.826 Vali Acc: 0.620 Test Loss: 54.826 Test Acc: 0.620
Validation loss decreased (-0.559629 --> -0.619452).  Saving model ...
Epoch: 16 cost time: 6.234143018722534
Epoch: 16, Steps: 13 | Train Loss: 14.930 Vali Loss: 62.199 Vali Acc: 0.520 Test Loss: 62.199 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.110585927963257
Epoch: 17, Steps: 13 | Train Loss: 4.382 Vali Loss: 56.498 Vali Acc: 0.540 Test Loss: 56.498 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.391083002090454
Epoch: 18, Steps: 13 | Train Loss: 9.480 Vali Loss: 63.257 Vali Acc: 0.520 Test Loss: 63.257 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 6.356300354003906
Epoch: 19, Steps: 13 | Train Loss: 7.616 Vali Loss: 68.181 Vali Acc: 0.520 Test Loss: 68.181 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 6.181410074234009
Epoch: 20, Steps: 13 | Train Loss: 21.328 Vali Loss: 48.163 Vali Acc: 0.640 Test Loss: 48.163 Test Acc: 0.640
Validation loss decreased (-0.619452 --> -0.639518).  Saving model ...
Epoch: 21 cost time: 6.12646222114563
Epoch: 21, Steps: 13 | Train Loss: 5.316 Vali Loss: 62.684 Vali Acc: 0.540 Test Loss: 62.684 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.073331356048584
Epoch: 22, Steps: 13 | Train Loss: 5.245 Vali Loss: 78.649 Vali Acc: 0.400 Test Loss: 78.649 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 6.1874024868011475
Epoch: 23, Steps: 13 | Train Loss: 4.595 Vali Loss: 65.298 Vali Acc: 0.620 Test Loss: 65.298 Test Acc: 0.620
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 6.039857625961304
Epoch: 24, Steps: 13 | Train Loss: 2.210 Vali Loss: 67.728 Vali Acc: 0.600 Test Loss: 67.728 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 6.186303615570068
Epoch: 25, Steps: 13 | Train Loss: 3.492 Vali Loss: 63.495 Vali Acc: 0.580 Test Loss: 63.495 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 6.075894355773926
Epoch: 26, Steps: 13 | Train Loss: 8.442 Vali Loss: 66.481 Vali Acc: 0.500 Test Loss: 66.481 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 6.2297608852386475
Epoch: 27, Steps: 13 | Train Loss: 8.162 Vali Loss: 72.702 Vali Acc: 0.640 Test Loss: 72.702 Test Acc: 0.640
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 6.169640302658081
Epoch: 28, Steps: 13 | Train Loss: 12.338 Vali Loss: 86.527 Vali Acc: 0.480 Test Loss: 86.527 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 6.025132417678833
Epoch: 29, Steps: 13 | Train Loss: 8.782 Vali Loss: 45.560 Vali Acc: 0.600 Test Loss: 45.560 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 6.080367088317871
Epoch: 30, Steps: 13 | Train Loss: 7.930 Vali Loss: 67.503 Vali Acc: 0.500 Test Loss: 67.503 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.64
model parameter : 23834689
model size : 96.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 7.750490665435791
Epoch: 1, Steps: 13 | Train Loss: 5.433 Vali Loss: 6.220 Vali Acc: 0.240 Test Loss: 6.220 Test Acc: 0.240
Validation loss decreased (inf --> -0.239938).  Saving model ...
Epoch: 2 cost time: 6.057237863540649
Epoch: 2, Steps: 13 | Train Loss: 16.096 Vali Loss: 16.439 Vali Acc: 0.240 Test Loss: 16.439 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.012494802474976
Epoch: 3, Steps: 13 | Train Loss: 19.473 Vali Loss: 22.950 Vali Acc: 0.360 Test Loss: 22.950 Test Acc: 0.360
Validation loss decreased (-0.239938 --> -0.359771).  Saving model ...
Epoch: 4 cost time: 6.107306718826294
Epoch: 4, Steps: 13 | Train Loss: 20.589 Vali Loss: 30.237 Vali Acc: 0.380 Test Loss: 30.237 Test Acc: 0.380
Validation loss decreased (-0.359771 --> -0.379698).  Saving model ...
Epoch: 5 cost time: 5.855490207672119
Epoch: 5, Steps: 13 | Train Loss: 15.851 Vali Loss: 49.964 Vali Acc: 0.320 Test Loss: 49.964 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.063465118408203
Epoch: 6, Steps: 13 | Train Loss: 47.755 Vali Loss: 43.175 Vali Acc: 0.420 Test Loss: 43.175 Test Acc: 0.420
Validation loss decreased (-0.379698 --> -0.419568).  Saving model ...
Epoch: 7 cost time: 5.959258079528809
Epoch: 7, Steps: 13 | Train Loss: 37.632 Vali Loss: 33.764 Vali Acc: 0.360 Test Loss: 33.764 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.065518617630005
Epoch: 8, Steps: 13 | Train Loss: 15.460 Vali Loss: 56.861 Vali Acc: 0.420 Test Loss: 56.861 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.865084886550903
Epoch: 9, Steps: 13 | Train Loss: 20.972 Vali Loss: 66.916 Vali Acc: 0.480 Test Loss: 66.916 Test Acc: 0.480
Validation loss decreased (-0.419568 --> -0.479331).  Saving model ...
Epoch: 10 cost time: 5.8634960651397705
Epoch: 10, Steps: 13 | Train Loss: 30.244 Vali Loss: 68.264 Vali Acc: 0.420 Test Loss: 68.264 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.91780686378479
Epoch: 11, Steps: 13 | Train Loss: 14.787 Vali Loss: 45.135 Vali Acc: 0.460 Test Loss: 45.135 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.924622535705566
Epoch: 12, Steps: 13 | Train Loss: 7.146 Vali Loss: 41.620 Vali Acc: 0.460 Test Loss: 41.620 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.923139333724976
Epoch: 13, Steps: 13 | Train Loss: 9.336 Vali Loss: 45.907 Vali Acc: 0.460 Test Loss: 45.907 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.94089150428772
Epoch: 14, Steps: 13 | Train Loss: 2.412 Vali Loss: 67.434 Vali Acc: 0.460 Test Loss: 67.434 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.89904260635376
Epoch: 15, Steps: 13 | Train Loss: 13.922 Vali Loss: 83.144 Vali Acc: 0.360 Test Loss: 83.144 Test Acc: 0.360
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.06667685508728
Epoch: 16, Steps: 13 | Train Loss: 6.562 Vali Loss: 67.780 Vali Acc: 0.400 Test Loss: 67.780 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.8940653800964355
Epoch: 17, Steps: 13 | Train Loss: 5.964 Vali Loss: 66.660 Vali Acc: 0.460 Test Loss: 66.660 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.924912452697754
Epoch: 18, Steps: 13 | Train Loss: 3.043 Vali Loss: 44.014 Vali Acc: 0.420 Test Loss: 44.014 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 5.823615074157715
Epoch: 19, Steps: 13 | Train Loss: 1.547 Vali Loss: 51.987 Vali Acc: 0.540 Test Loss: 51.987 Test Acc: 0.540
Validation loss decreased (-0.479331 --> -0.539480).  Saving model ...
Epoch: 20 cost time: 5.95913290977478
Epoch: 20, Steps: 13 | Train Loss: 5.423 Vali Loss: 60.490 Vali Acc: 0.600 Test Loss: 60.490 Test Acc: 0.600
Validation loss decreased (-0.539480 --> -0.599395).  Saving model ...
Epoch: 21 cost time: 5.872156381607056
Epoch: 21, Steps: 13 | Train Loss: 0.289 Vali Loss: 48.720 Vali Acc: 0.600 Test Loss: 48.720 Test Acc: 0.600
Validation loss decreased (-0.599395 --> -0.599513).  Saving model ...
Epoch: 22 cost time: 6.056506872177124
Epoch: 22, Steps: 13 | Train Loss: 0.000 Vali Loss: 57.989 Vali Acc: 0.420 Test Loss: 57.989 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 6.117629528045654
Epoch: 23, Steps: 13 | Train Loss: 1.729 Vali Loss: 56.988 Vali Acc: 0.500 Test Loss: 56.988 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 6.082263469696045
Epoch: 24, Steps: 13 | Train Loss: 1.410 Vali Loss: 48.258 Vali Acc: 0.560 Test Loss: 48.258 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 5.99245810508728
Epoch: 25, Steps: 13 | Train Loss: 1.377 Vali Loss: 61.597 Vali Acc: 0.460 Test Loss: 61.597 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 6.017273187637329
Epoch: 26, Steps: 13 | Train Loss: 1.421 Vali Loss: 75.439 Vali Acc: 0.540 Test Loss: 75.439 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 6.062769412994385
Epoch: 27, Steps: 13 | Train Loss: 1.593 Vali Loss: 65.305 Vali Acc: 0.500 Test Loss: 65.305 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 5.9969189167022705
Epoch: 28, Steps: 13 | Train Loss: 1.815 Vali Loss: 65.843 Vali Acc: 0.580 Test Loss: 65.843 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 5.958203315734863
Epoch: 29, Steps: 13 | Train Loss: 7.661 Vali Loss: 77.927 Vali Acc: 0.440 Test Loss: 77.927 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 6.033053398132324
Epoch: 30, Steps: 13 | Train Loss: 13.708 Vali Loss: 69.142 Vali Acc: 0.520 Test Loss: 69.142 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 5.946682929992676
Epoch: 31, Steps: 13 | Train Loss: 24.393 Vali Loss: 64.125 Vali Acc: 0.580 Test Loss: 64.125 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 23823425
model size : 95.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 7.589808940887451
Epoch: 1, Steps: 13 | Train Loss: 4.954 Vali Loss: 13.307 Vali Acc: 0.220 Test Loss: 13.307 Test Acc: 0.220
Validation loss decreased (inf --> -0.219867).  Saving model ...
Epoch: 2 cost time: 5.967055797576904
Epoch: 2, Steps: 13 | Train Loss: 11.751 Vali Loss: 20.864 Vali Acc: 0.280 Test Loss: 20.864 Test Acc: 0.280
Validation loss decreased (-0.219867 --> -0.279791).  Saving model ...
Epoch: 3 cost time: 5.911585330963135
Epoch: 3, Steps: 13 | Train Loss: 17.263 Vali Loss: 20.410 Vali Acc: 0.320 Test Loss: 20.410 Test Acc: 0.320
Validation loss decreased (-0.279791 --> -0.319796).  Saving model ...
Epoch: 4 cost time: 6.00722861289978
Epoch: 4, Steps: 13 | Train Loss: 24.154 Vali Loss: 28.106 Vali Acc: 0.420 Test Loss: 28.106 Test Acc: 0.420
Validation loss decreased (-0.319796 --> -0.419719).  Saving model ...
Epoch: 5 cost time: 5.87988018989563
Epoch: 5, Steps: 13 | Train Loss: 16.708 Vali Loss: 43.788 Vali Acc: 0.360 Test Loss: 43.788 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.2334959506988525
Epoch: 6, Steps: 13 | Train Loss: 19.759 Vali Loss: 50.051 Vali Acc: 0.400 Test Loss: 50.051 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.004751682281494
Epoch: 7, Steps: 13 | Train Loss: 19.287 Vali Loss: 51.470 Vali Acc: 0.460 Test Loss: 51.470 Test Acc: 0.460
Validation loss decreased (-0.419719 --> -0.459485).  Saving model ...
Epoch: 8 cost time: 5.931636333465576
Epoch: 8, Steps: 13 | Train Loss: 15.612 Vali Loss: 25.565 Vali Acc: 0.480 Test Loss: 25.565 Test Acc: 0.480
Validation loss decreased (-0.459485 --> -0.479744).  Saving model ...
Epoch: 9 cost time: 6.279538869857788
Epoch: 9, Steps: 13 | Train Loss: 8.393 Vali Loss: 47.459 Vali Acc: 0.400 Test Loss: 47.459 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.025599718093872
Epoch: 10, Steps: 13 | Train Loss: 11.726 Vali Loss: 40.079 Vali Acc: 0.420 Test Loss: 40.079 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.119347333908081
Epoch: 11, Steps: 13 | Train Loss: 5.351 Vali Loss: 51.854 Vali Acc: 0.500 Test Loss: 51.854 Test Acc: 0.500
Validation loss decreased (-0.479744 --> -0.499481).  Saving model ...
Epoch: 12 cost time: 6.667294979095459
Epoch: 12, Steps: 13 | Train Loss: 8.481 Vali Loss: 39.043 Vali Acc: 0.420 Test Loss: 39.043 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.912310361862183
Epoch: 13, Steps: 13 | Train Loss: 3.687 Vali Loss: 53.345 Vali Acc: 0.480 Test Loss: 53.345 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.442591667175293
Epoch: 14, Steps: 13 | Train Loss: 5.352 Vali Loss: 51.670 Vali Acc: 0.500 Test Loss: 51.670 Test Acc: 0.500
Validation loss decreased (-0.499481 --> -0.499483).  Saving model ...
Epoch: 15 cost time: 5.9682252407073975
Epoch: 15, Steps: 13 | Train Loss: 6.322 Vali Loss: 51.708 Vali Acc: 0.500 Test Loss: 51.708 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.05633020401001
Epoch: 16, Steps: 13 | Train Loss: 7.669 Vali Loss: 64.888 Vali Acc: 0.440 Test Loss: 64.888 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.2118980884552
Epoch: 17, Steps: 13 | Train Loss: 10.816 Vali Loss: 63.353 Vali Acc: 0.460 Test Loss: 63.353 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.936076641082764
Epoch: 18, Steps: 13 | Train Loss: 10.212 Vali Loss: 51.530 Vali Acc: 0.520 Test Loss: 51.530 Test Acc: 0.520
Validation loss decreased (-0.499483 --> -0.519485).  Saving model ...
Epoch: 19 cost time: 6.262243032455444
Epoch: 19, Steps: 13 | Train Loss: 4.824 Vali Loss: 54.788 Vali Acc: 0.400 Test Loss: 54.788 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.986865997314453
Epoch: 20, Steps: 13 | Train Loss: 0.000 Vali Loss: 72.299 Vali Acc: 0.440 Test Loss: 72.299 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.996398687362671
Epoch: 21, Steps: 13 | Train Loss: 2.011 Vali Loss: 61.274 Vali Acc: 0.500 Test Loss: 61.274 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 5.891131401062012
Epoch: 22, Steps: 13 | Train Loss: 2.589 Vali Loss: 63.442 Vali Acc: 0.540 Test Loss: 63.442 Test Acc: 0.540
Validation loss decreased (-0.519485 --> -0.539366).  Saving model ...
Epoch: 23 cost time: 5.851684808731079
Epoch: 23, Steps: 13 | Train Loss: 0.068 Vali Loss: 65.949 Vali Acc: 0.500 Test Loss: 65.949 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 6.107077598571777
Epoch: 24, Steps: 13 | Train Loss: 2.068 Vali Loss: 73.126 Vali Acc: 0.440 Test Loss: 73.126 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 6.103559494018555
Epoch: 25, Steps: 13 | Train Loss: 5.615 Vali Loss: 80.800 Vali Acc: 0.460 Test Loss: 80.800 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 6.003190994262695
Epoch: 26, Steps: 13 | Train Loss: 4.544 Vali Loss: 59.330 Vali Acc: 0.580 Test Loss: 59.330 Test Acc: 0.580
Validation loss decreased (-0.539366 --> -0.579407).  Saving model ...
Epoch: 27 cost time: 6.294413089752197
Epoch: 27, Steps: 13 | Train Loss: 12.510 Vali Loss: 59.145 Vali Acc: 0.500 Test Loss: 59.145 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 5.88524866104126
Epoch: 28, Steps: 13 | Train Loss: 26.396 Vali Loss: 105.610 Vali Acc: 0.320 Test Loss: 105.610 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 6.179453372955322
Epoch: 29, Steps: 13 | Train Loss: 18.075 Vali Loss: 54.120 Vali Acc: 0.520 Test Loss: 54.120 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 6.100871562957764
Epoch: 30, Steps: 13 | Train Loss: 77.328 Vali Loss: 39.715 Vali Acc: 0.220 Test Loss: 39.715 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 6.146753787994385
Epoch: 31, Steps: 13 | Train Loss: 76.041 Vali Loss: 73.202 Vali Acc: 0.200 Test Loss: 73.202 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 5.972424507141113
Epoch: 32, Steps: 13 | Train Loss: 71.953 Vali Loss: 131.390 Vali Acc: 0.200 Test Loss: 131.390 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 6.199414014816284
Epoch: 33, Steps: 13 | Train Loss: 64.759 Vali Loss: 83.554 Vali Acc: 0.440 Test Loss: 83.554 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 6.123239040374756
Epoch: 34, Steps: 13 | Train Loss: 21.737 Vali Loss: 60.688 Vali Acc: 0.500 Test Loss: 60.688 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 5.910966157913208
Epoch: 35, Steps: 13 | Train Loss: 13.111 Vali Loss: 91.242 Vali Acc: 0.340 Test Loss: 91.242 Test Acc: 0.340
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 6.094169616699219
Epoch: 36, Steps: 13 | Train Loss: 6.706 Vali Loss: 67.691 Vali Acc: 0.520 Test Loss: 67.691 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 23812161
model size : 95.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 8.234071493148804
Epoch: 1, Steps: 13 | Train Loss: 6.505 Vali Loss: 8.841 Vali Acc: 0.240 Test Loss: 8.841 Test Acc: 0.240
Validation loss decreased (inf --> -0.239912).  Saving model ...
Epoch: 2 cost time: 5.933597564697266
Epoch: 2, Steps: 13 | Train Loss: 9.919 Vali Loss: 20.833 Vali Acc: 0.200 Test Loss: 20.833 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.955959320068359
Epoch: 3, Steps: 13 | Train Loss: 17.838 Vali Loss: 20.036 Vali Acc: 0.380 Test Loss: 20.036 Test Acc: 0.380
Validation loss decreased (-0.239912 --> -0.379800).  Saving model ...
Epoch: 4 cost time: 6.179152965545654
Epoch: 4, Steps: 13 | Train Loss: 20.642 Vali Loss: 23.177 Vali Acc: 0.360 Test Loss: 23.177 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.202930212020874
Epoch: 5, Steps: 13 | Train Loss: 21.991 Vali Loss: 40.069 Vali Acc: 0.340 Test Loss: 40.069 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.933969497680664
Epoch: 6, Steps: 13 | Train Loss: 42.285 Vali Loss: 29.497 Vali Acc: 0.440 Test Loss: 29.497 Test Acc: 0.440
Validation loss decreased (-0.379800 --> -0.439705).  Saving model ...
Epoch: 7 cost time: 5.940496206283569
Epoch: 7, Steps: 13 | Train Loss: 16.355 Vali Loss: 36.822 Vali Acc: 0.500 Test Loss: 36.822 Test Acc: 0.500
Validation loss decreased (-0.439705 --> -0.499632).  Saving model ...
Epoch: 8 cost time: 5.88943338394165
Epoch: 8, Steps: 13 | Train Loss: 27.720 Vali Loss: 73.570 Vali Acc: 0.220 Test Loss: 73.570 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.2179481983184814
Epoch: 9, Steps: 13 | Train Loss: 85.839 Vali Loss: 121.890 Vali Acc: 0.200 Test Loss: 121.890 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.864435195922852
Epoch: 10, Steps: 13 | Train Loss: 93.727 Vali Loss: 65.758 Vali Acc: 0.400 Test Loss: 65.758 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.0913801193237305
Epoch: 11, Steps: 13 | Train Loss: 14.812 Vali Loss: 34.973 Vali Acc: 0.540 Test Loss: 34.973 Test Acc: 0.540
Validation loss decreased (-0.499632 --> -0.539650).  Saving model ...
Epoch: 12 cost time: 5.791437387466431
Epoch: 12, Steps: 13 | Train Loss: 25.388 Vali Loss: 58.864 Vali Acc: 0.420 Test Loss: 58.864 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.831042051315308
Epoch: 13, Steps: 13 | Train Loss: 18.154 Vali Loss: 33.106 Vali Acc: 0.600 Test Loss: 33.106 Test Acc: 0.600
Validation loss decreased (-0.539650 --> -0.599669).  Saving model ...
Epoch: 14 cost time: 5.97523832321167
Epoch: 14, Steps: 13 | Train Loss: 12.974 Vali Loss: 31.276 Vali Acc: 0.660 Test Loss: 31.276 Test Acc: 0.660
Validation loss decreased (-0.599669 --> -0.659687).  Saving model ...
Epoch: 15 cost time: 6.002916097640991
Epoch: 15, Steps: 13 | Train Loss: 11.143 Vali Loss: 45.734 Vali Acc: 0.560 Test Loss: 45.734 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.922097682952881
Epoch: 16, Steps: 13 | Train Loss: 4.936 Vali Loss: 22.835 Vali Acc: 0.640 Test Loss: 22.835 Test Acc: 0.640
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.978610992431641
Epoch: 17, Steps: 13 | Train Loss: 10.036 Vali Loss: 33.611 Vali Acc: 0.660 Test Loss: 33.611 Test Acc: 0.660
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 6.050340175628662
Epoch: 18, Steps: 13 | Train Loss: 7.447 Vali Loss: 47.815 Vali Acc: 0.480 Test Loss: 47.815 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 5.926013469696045
Epoch: 19, Steps: 13 | Train Loss: 5.383 Vali Loss: 48.039 Vali Acc: 0.520 Test Loss: 48.039 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 5.900515556335449
Epoch: 20, Steps: 13 | Train Loss: 10.205 Vali Loss: 39.215 Vali Acc: 0.560 Test Loss: 39.215 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 5.986030101776123
Epoch: 21, Steps: 13 | Train Loss: 5.003 Vali Loss: 45.062 Vali Acc: 0.520 Test Loss: 45.062 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 5.981152296066284
Epoch: 22, Steps: 13 | Train Loss: 0.730 Vali Loss: 65.900 Vali Acc: 0.460 Test Loss: 65.900 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 5.902613878250122
Epoch: 23, Steps: 13 | Train Loss: 6.669 Vali Loss: 45.377 Vali Acc: 0.440 Test Loss: 45.377 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 5.8900299072265625
Epoch: 24, Steps: 13 | Train Loss: 4.483 Vali Loss: 41.170 Vali Acc: 0.620 Test Loss: 41.170 Test Acc: 0.620
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.66
model parameter : 23800897
model size : 95.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 7.542609930038452
Epoch: 1, Steps: 13 | Train Loss: 10.620 Vali Loss: 17.531 Vali Acc: 0.200 Test Loss: 17.531 Test Acc: 0.200
Validation loss decreased (inf --> -0.199825).  Saving model ...
Epoch: 2 cost time: 5.864088773727417
Epoch: 2, Steps: 13 | Train Loss: 18.305 Vali Loss: 23.395 Vali Acc: 0.220 Test Loss: 23.395 Test Acc: 0.220
Validation loss decreased (-0.199825 --> -0.219766).  Saving model ...
Epoch: 3 cost time: 5.874724626541138
Epoch: 3, Steps: 13 | Train Loss: 20.733 Vali Loss: 26.398 Vali Acc: 0.260 Test Loss: 26.398 Test Acc: 0.260
Validation loss decreased (-0.219766 --> -0.259736).  Saving model ...
Epoch: 4 cost time: 5.854057550430298
Epoch: 4, Steps: 13 | Train Loss: 20.980 Vali Loss: 28.372 Vali Acc: 0.360 Test Loss: 28.372 Test Acc: 0.360
Validation loss decreased (-0.259736 --> -0.359716).  Saving model ...
Epoch: 5 cost time: 6.052548170089722
Epoch: 5, Steps: 13 | Train Loss: 21.346 Vali Loss: 26.886 Vali Acc: 0.380 Test Loss: 26.886 Test Acc: 0.380
Validation loss decreased (-0.359716 --> -0.379731).  Saving model ...
Epoch: 6 cost time: 6.239683628082275
Epoch: 6, Steps: 13 | Train Loss: 20.236 Vali Loss: 39.046 Vali Acc: 0.480 Test Loss: 39.046 Test Acc: 0.480
Validation loss decreased (-0.379731 --> -0.479610).  Saving model ...
Epoch: 7 cost time: 6.053988695144653
Epoch: 7, Steps: 13 | Train Loss: 17.158 Vali Loss: 41.689 Vali Acc: 0.440 Test Loss: 41.689 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.97803521156311
Epoch: 8, Steps: 13 | Train Loss: 17.499 Vali Loss: 37.990 Vali Acc: 0.480 Test Loss: 37.990 Test Acc: 0.480
Validation loss decreased (-0.479610 --> -0.479620).  Saving model ...
Epoch: 9 cost time: 6.101627349853516
Epoch: 9, Steps: 13 | Train Loss: 10.744 Vali Loss: 40.353 Vali Acc: 0.440 Test Loss: 40.353 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.199136018753052
Epoch: 10, Steps: 13 | Train Loss: 8.395 Vali Loss: 26.366 Vali Acc: 0.520 Test Loss: 26.366 Test Acc: 0.520
Validation loss decreased (-0.479620 --> -0.519736).  Saving model ...
Epoch: 11 cost time: 6.083168268203735
Epoch: 11, Steps: 13 | Train Loss: 5.993 Vali Loss: 26.878 Vali Acc: 0.500 Test Loss: 26.878 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.02550745010376
Epoch: 12, Steps: 13 | Train Loss: 6.633 Vali Loss: 45.024 Vali Acc: 0.440 Test Loss: 45.024 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.111915111541748
Epoch: 13, Steps: 13 | Train Loss: 4.763 Vali Loss: 23.659 Vali Acc: 0.660 Test Loss: 23.659 Test Acc: 0.660
Validation loss decreased (-0.519736 --> -0.659763).  Saving model ...
Epoch: 14 cost time: 6.0287275314331055
Epoch: 14, Steps: 13 | Train Loss: 8.814 Vali Loss: 44.642 Vali Acc: 0.500 Test Loss: 44.642 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.772606134414673
Epoch: 15, Steps: 13 | Train Loss: 6.292 Vali Loss: 54.688 Vali Acc: 0.400 Test Loss: 54.688 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.910359144210815
Epoch: 16, Steps: 13 | Train Loss: 5.136 Vali Loss: 60.044 Vali Acc: 0.480 Test Loss: 60.044 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.999046564102173
Epoch: 17, Steps: 13 | Train Loss: 2.956 Vali Loss: 52.978 Vali Acc: 0.520 Test Loss: 52.978 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 6.016791820526123
Epoch: 18, Steps: 13 | Train Loss: 4.498 Vali Loss: 40.940 Vali Acc: 0.640 Test Loss: 40.940 Test Acc: 0.640
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 5.912330627441406
Epoch: 19, Steps: 13 | Train Loss: 0.964 Vali Loss: 56.266 Vali Acc: 0.520 Test Loss: 56.266 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 5.882063627243042
Epoch: 20, Steps: 13 | Train Loss: 2.848 Vali Loss: 60.101 Vali Acc: 0.580 Test Loss: 60.101 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 6.016303062438965
Epoch: 21, Steps: 13 | Train Loss: 5.440 Vali Loss: 54.312 Vali Acc: 0.520 Test Loss: 54.312 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 6.07947039604187
Epoch: 22, Steps: 13 | Train Loss: 6.094 Vali Loss: 44.136 Vali Acc: 0.520 Test Loss: 44.136 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 5.982330083847046
Epoch: 23, Steps: 13 | Train Loss: 1.468 Vali Loss: 46.924 Vali Acc: 0.520 Test Loss: 46.924 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.66
model parameter : 23243713
model size : 93.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 8.216849565505981
Epoch: 1, Steps: 13 | Train Loss: 7.538 Vali Loss: 29.166 Vali Acc: 0.200 Test Loss: 29.166 Test Acc: 0.200
Validation loss decreased (inf --> -0.199708).  Saving model ...
Epoch: 2 cost time: 6.525110483169556
Epoch: 2, Steps: 13 | Train Loss: 26.985 Vali Loss: 30.770 Vali Acc: 0.320 Test Loss: 30.770 Test Acc: 0.320
Validation loss decreased (-0.199708 --> -0.319692).  Saving model ...
Epoch: 3 cost time: 5.883360385894775
Epoch: 3, Steps: 13 | Train Loss: 27.950 Vali Loss: 26.405 Vali Acc: 0.360 Test Loss: 26.405 Test Acc: 0.360
Validation loss decreased (-0.319692 --> -0.359736).  Saving model ...
Epoch: 4 cost time: 6.357198715209961
Epoch: 4, Steps: 13 | Train Loss: 25.702 Vali Loss: 37.440 Vali Acc: 0.300 Test Loss: 37.440 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.113989591598511
Epoch: 5, Steps: 13 | Train Loss: 29.177 Vali Loss: 47.466 Vali Acc: 0.360 Test Loss: 47.466 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.412257671356201
Epoch: 6, Steps: 13 | Train Loss: 37.557 Vali Loss: 43.917 Vali Acc: 0.520 Test Loss: 43.917 Test Acc: 0.520
Validation loss decreased (-0.359736 --> -0.519561).  Saving model ...
Epoch: 7 cost time: 6.20012903213501
Epoch: 7, Steps: 13 | Train Loss: 22.957 Vali Loss: 58.417 Vali Acc: 0.440 Test Loss: 58.417 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.0423760414123535
Epoch: 8, Steps: 13 | Train Loss: 39.937 Vali Loss: 52.607 Vali Acc: 0.540 Test Loss: 52.607 Test Acc: 0.540
Validation loss decreased (-0.519561 --> -0.539474).  Saving model ...
Epoch: 9 cost time: 6.418443441390991
Epoch: 9, Steps: 13 | Train Loss: 30.266 Vali Loss: 55.762 Vali Acc: 0.420 Test Loss: 55.762 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.196568250656128
Epoch: 10, Steps: 13 | Train Loss: 13.527 Vali Loss: 42.565 Vali Acc: 0.420 Test Loss: 42.565 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.087434530258179
Epoch: 11, Steps: 13 | Train Loss: 6.262 Vali Loss: 45.148 Vali Acc: 0.460 Test Loss: 45.148 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.227858066558838
Epoch: 12, Steps: 13 | Train Loss: 7.058 Vali Loss: 46.612 Vali Acc: 0.520 Test Loss: 46.612 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.352244853973389
Epoch: 13, Steps: 13 | Train Loss: 3.160 Vali Loss: 41.831 Vali Acc: 0.460 Test Loss: 41.831 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.383143901824951
Epoch: 14, Steps: 13 | Train Loss: 7.741 Vali Loss: 70.906 Vali Acc: 0.420 Test Loss: 70.906 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 6.5319983959198
Epoch: 15, Steps: 13 | Train Loss: 10.109 Vali Loss: 55.932 Vali Acc: 0.480 Test Loss: 55.932 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 6.205004930496216
Epoch: 16, Steps: 13 | Train Loss: 7.295 Vali Loss: 82.454 Vali Acc: 0.460 Test Loss: 82.454 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 6.352447271347046
Epoch: 17, Steps: 13 | Train Loss: 10.531 Vali Loss: 49.790 Vali Acc: 0.540 Test Loss: 49.790 Test Acc: 0.540
Validation loss decreased (-0.539474 --> -0.539502).  Saving model ...
Epoch: 18 cost time: 6.287139415740967
Epoch: 18, Steps: 13 | Train Loss: 5.891 Vali Loss: 60.073 Vali Acc: 0.600 Test Loss: 60.073 Test Acc: 0.600
Validation loss decreased (-0.539502 --> -0.599399).  Saving model ...
Epoch: 19 cost time: 6.28171443939209
Epoch: 19, Steps: 13 | Train Loss: 5.336 Vali Loss: 63.956 Vali Acc: 0.420 Test Loss: 63.956 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.446887731552124
Epoch: 20, Steps: 13 | Train Loss: 2.055 Vali Loss: 84.705 Vali Acc: 0.480 Test Loss: 84.705 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 6.25855827331543
Epoch: 21, Steps: 13 | Train Loss: 1.426 Vali Loss: 75.877 Vali Acc: 0.520 Test Loss: 75.877 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 6.255476713180542
Epoch: 22, Steps: 13 | Train Loss: 3.499 Vali Loss: 57.006 Vali Acc: 0.540 Test Loss: 57.006 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 6.461594104766846
Epoch: 23, Steps: 13 | Train Loss: 6.849 Vali Loss: 55.432 Vali Acc: 0.520 Test Loss: 55.432 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 6.431795835494995
Epoch: 24, Steps: 13 | Train Loss: 2.937 Vali Loss: 64.851 Vali Acc: 0.480 Test Loss: 64.851 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 6.098083734512329
Epoch: 25, Steps: 13 | Train Loss: 1.322 Vali Loss: 69.431 Vali Acc: 0.540 Test Loss: 69.431 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 6.524335861206055
Epoch: 26, Steps: 13 | Train Loss: 5.506 Vali Loss: 72.314 Vali Acc: 0.540 Test Loss: 72.314 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 6.316688776016235
Epoch: 27, Steps: 13 | Train Loss: 4.078 Vali Loss: 57.908 Vali Acc: 0.640 Test Loss: 57.908 Test Acc: 0.640
Validation loss decreased (-0.599399 --> -0.639421).  Saving model ...
Epoch: 28 cost time: 6.265848636627197
Epoch: 28, Steps: 13 | Train Loss: 5.060 Vali Loss: 58.426 Vali Acc: 0.540 Test Loss: 58.426 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 6.58290433883667
Epoch: 29, Steps: 13 | Train Loss: 1.771 Vali Loss: 66.914 Vali Acc: 0.560 Test Loss: 66.914 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 6.462542295455933
Epoch: 30, Steps: 13 | Train Loss: 11.073 Vali Loss: 61.047 Vali Acc: 0.440 Test Loss: 61.047 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 6.168587684631348
Epoch: 31, Steps: 13 | Train Loss: 10.113 Vali Loss: 62.042 Vali Acc: 0.420 Test Loss: 62.042 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 6.365129232406616
Epoch: 32, Steps: 13 | Train Loss: 5.875 Vali Loss: 64.454 Vali Acc: 0.460 Test Loss: 64.454 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 5.958576440811157
Epoch: 33, Steps: 13 | Train Loss: 3.233 Vali Loss: 61.132 Vali Acc: 0.560 Test Loss: 61.132 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 6.642371654510498
Epoch: 34, Steps: 13 | Train Loss: 10.717 Vali Loss: 86.324 Vali Acc: 0.500 Test Loss: 86.324 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 6.3659279346466064
Epoch: 35, Steps: 13 | Train Loss: 1.496 Vali Loss: 69.985 Vali Acc: 0.460 Test Loss: 69.985 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 6.305951356887817
Epoch: 36, Steps: 13 | Train Loss: 9.736 Vali Loss: 98.510 Vali Acc: 0.500 Test Loss: 98.510 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 6.323472738265991
Epoch: 37, Steps: 13 | Train Loss: 53.581 Vali Loss: 72.647 Vali Acc: 0.520 Test Loss: 72.647 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.64
model parameter : 23232449
model size : 93.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 9.00446105003357
Epoch: 1, Steps: 13 | Train Loss: 7.733 Vali Loss: 18.861 Vali Acc: 0.220 Test Loss: 18.861 Test Acc: 0.220
Validation loss decreased (inf --> -0.219811).  Saving model ...
Epoch: 2 cost time: 6.2533509731292725
Epoch: 2, Steps: 13 | Train Loss: 17.827 Vali Loss: 16.815 Vali Acc: 0.320 Test Loss: 16.815 Test Acc: 0.320
Validation loss decreased (-0.219811 --> -0.319832).  Saving model ...
Epoch: 3 cost time: 6.122790575027466
Epoch: 3, Steps: 13 | Train Loss: 12.186 Vali Loss: 29.938 Vali Acc: 0.360 Test Loss: 29.938 Test Acc: 0.360
Validation loss decreased (-0.319832 --> -0.359701).  Saving model ...
Epoch: 4 cost time: 6.236100673675537
Epoch: 4, Steps: 13 | Train Loss: 25.238 Vali Loss: 27.364 Vali Acc: 0.380 Test Loss: 27.364 Test Acc: 0.380
Validation loss decreased (-0.359701 --> -0.379726).  Saving model ...
Epoch: 5 cost time: 6.1260881423950195
Epoch: 5, Steps: 13 | Train Loss: 27.995 Vali Loss: 26.446 Vali Acc: 0.420 Test Loss: 26.446 Test Acc: 0.420
Validation loss decreased (-0.379726 --> -0.419736).  Saving model ...
Epoch: 6 cost time: 6.301538705825806
Epoch: 6, Steps: 13 | Train Loss: 29.456 Vali Loss: 49.419 Vali Acc: 0.380 Test Loss: 49.419 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.331860780715942
Epoch: 7, Steps: 13 | Train Loss: 29.165 Vali Loss: 95.204 Vali Acc: 0.320 Test Loss: 95.204 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.080384969711304
Epoch: 8, Steps: 13 | Train Loss: 40.267 Vali Loss: 80.410 Vali Acc: 0.420 Test Loss: 80.410 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.331355333328247
Epoch: 9, Steps: 13 | Train Loss: 21.455 Vali Loss: 56.233 Vali Acc: 0.440 Test Loss: 56.233 Test Acc: 0.440
Validation loss decreased (-0.419736 --> -0.439438).  Saving model ...
Epoch: 10 cost time: 6.310928106307983
Epoch: 10, Steps: 13 | Train Loss: 30.539 Vali Loss: 58.771 Vali Acc: 0.380 Test Loss: 58.771 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.156019449234009
Epoch: 11, Steps: 13 | Train Loss: 24.587 Vali Loss: 64.724 Vali Acc: 0.460 Test Loss: 64.724 Test Acc: 0.460
Validation loss decreased (-0.439438 --> -0.459353).  Saving model ...
Epoch: 12 cost time: 5.938297271728516
Epoch: 12, Steps: 13 | Train Loss: 3.468 Vali Loss: 54.916 Vali Acc: 0.540 Test Loss: 54.916 Test Acc: 0.540
Validation loss decreased (-0.459353 --> -0.539451).  Saving model ...
Epoch: 13 cost time: 6.066432476043701
Epoch: 13, Steps: 13 | Train Loss: 35.460 Vali Loss: 69.523 Vali Acc: 0.480 Test Loss: 69.523 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.98340368270874
Epoch: 14, Steps: 13 | Train Loss: 6.177 Vali Loss: 67.265 Vali Acc: 0.500 Test Loss: 67.265 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.85386061668396
Epoch: 15, Steps: 13 | Train Loss: 18.349 Vali Loss: 61.437 Vali Acc: 0.400 Test Loss: 61.437 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.2272093296051025
Epoch: 16, Steps: 13 | Train Loss: 7.679 Vali Loss: 75.686 Vali Acc: 0.440 Test Loss: 75.686 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 6.480232238769531
Epoch: 17, Steps: 13 | Train Loss: 18.846 Vali Loss: 76.741 Vali Acc: 0.440 Test Loss: 76.741 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 6.173946142196655
Epoch: 18, Steps: 13 | Train Loss: 12.519 Vali Loss: 86.106 Vali Acc: 0.440 Test Loss: 86.106 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 6.34754204750061
Epoch: 19, Steps: 13 | Train Loss: 2.834 Vali Loss: 69.205 Vali Acc: 0.560 Test Loss: 69.205 Test Acc: 0.560
Validation loss decreased (-0.539451 --> -0.559308).  Saving model ...
Epoch: 20 cost time: 6.173284292221069
Epoch: 20, Steps: 13 | Train Loss: 8.436 Vali Loss: 92.255 Vali Acc: 0.460 Test Loss: 92.255 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 6.205576419830322
Epoch: 21, Steps: 13 | Train Loss: 14.927 Vali Loss: 56.443 Vali Acc: 0.580 Test Loss: 56.443 Test Acc: 0.580
Validation loss decreased (-0.559308 --> -0.579436).  Saving model ...
Epoch: 22 cost time: 6.200932264328003
Epoch: 22, Steps: 13 | Train Loss: 7.078 Vali Loss: 119.350 Vali Acc: 0.360 Test Loss: 119.350 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 6.310437440872192
Epoch: 23, Steps: 13 | Train Loss: 13.882 Vali Loss: 142.092 Vali Acc: 0.440 Test Loss: 142.092 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 6.507850646972656
Epoch: 24, Steps: 13 | Train Loss: 31.568 Vali Loss: 88.791 Vali Acc: 0.560 Test Loss: 88.791 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 6.046540260314941
Epoch: 25, Steps: 13 | Train Loss: 11.786 Vali Loss: 67.746 Vali Acc: 0.480 Test Loss: 67.746 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 6.203145742416382
Epoch: 26, Steps: 13 | Train Loss: 3.284 Vali Loss: 69.248 Vali Acc: 0.560 Test Loss: 69.248 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 6.376371145248413
Epoch: 27, Steps: 13 | Train Loss: 1.479 Vali Loss: 88.275 Vali Acc: 0.480 Test Loss: 88.275 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 6.119141578674316
Epoch: 28, Steps: 13 | Train Loss: 12.543 Vali Loss: 104.619 Vali Acc: 0.460 Test Loss: 104.619 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 6.088539361953735
Epoch: 29, Steps: 13 | Train Loss: 22.336 Vali Loss: 123.717 Vali Acc: 0.460 Test Loss: 123.717 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 6.057771921157837
Epoch: 30, Steps: 13 | Train Loss: 3.416 Vali Loss: 134.132 Vali Acc: 0.460 Test Loss: 134.132 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 6.240340709686279
Epoch: 31, Steps: 13 | Train Loss: 16.180 Vali Loss: 77.426 Vali Acc: 0.540 Test Loss: 77.426 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 23221185
model size : 93.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 9.625424861907959
Epoch: 1, Steps: 13 | Train Loss: 6.706 Vali Loss: 10.796 Vali Acc: 0.200 Test Loss: 10.796 Test Acc: 0.200
Validation loss decreased (inf --> -0.199892).  Saving model ...
Epoch: 2 cost time: 6.502957582473755
Epoch: 2, Steps: 13 | Train Loss: 16.054 Vali Loss: 23.463 Vali Acc: 0.340 Test Loss: 23.463 Test Acc: 0.340
Validation loss decreased (-0.199892 --> -0.339765).  Saving model ...
Epoch: 3 cost time: 6.37892746925354
Epoch: 3, Steps: 13 | Train Loss: 12.220 Vali Loss: 24.551 Vali Acc: 0.240 Test Loss: 24.551 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.244792461395264
Epoch: 4, Steps: 13 | Train Loss: 24.633 Vali Loss: 37.908 Vali Acc: 0.340 Test Loss: 37.908 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.283308267593384
Epoch: 5, Steps: 13 | Train Loss: 23.624 Vali Loss: 42.453 Vali Acc: 0.380 Test Loss: 42.453 Test Acc: 0.380
Validation loss decreased (-0.339765 --> -0.379575).  Saving model ...
Epoch: 6 cost time: 6.323485612869263
Epoch: 6, Steps: 13 | Train Loss: 30.631 Vali Loss: 29.115 Vali Acc: 0.460 Test Loss: 29.115 Test Acc: 0.460
Validation loss decreased (-0.379575 --> -0.459709).  Saving model ...
Epoch: 7 cost time: 6.196428537368774
Epoch: 7, Steps: 13 | Train Loss: 10.103 Vali Loss: 60.478 Vali Acc: 0.480 Test Loss: 60.478 Test Acc: 0.480
Validation loss decreased (-0.459709 --> -0.479395).  Saving model ...
Epoch: 8 cost time: 6.179599761962891
Epoch: 8, Steps: 13 | Train Loss: 27.410 Vali Loss: 38.349 Vali Acc: 0.480 Test Loss: 38.349 Test Acc: 0.480
Validation loss decreased (-0.479395 --> -0.479617).  Saving model ...
Epoch: 9 cost time: 6.357447624206543
Epoch: 9, Steps: 13 | Train Loss: 14.498 Vali Loss: 68.042 Vali Acc: 0.420 Test Loss: 68.042 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.345429420471191
Epoch: 10, Steps: 13 | Train Loss: 14.955 Vali Loss: 43.485 Vali Acc: 0.580 Test Loss: 43.485 Test Acc: 0.580
Validation loss decreased (-0.479617 --> -0.579565).  Saving model ...
Epoch: 11 cost time: 6.172789573669434
Epoch: 11, Steps: 13 | Train Loss: 8.911 Vali Loss: 37.655 Vali Acc: 0.500 Test Loss: 37.655 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.368602514266968
Epoch: 12, Steps: 13 | Train Loss: 4.559 Vali Loss: 69.955 Vali Acc: 0.460 Test Loss: 69.955 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.031169414520264
Epoch: 13, Steps: 13 | Train Loss: 12.308 Vali Loss: 66.763 Vali Acc: 0.360 Test Loss: 66.763 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.341706991195679
Epoch: 14, Steps: 13 | Train Loss: 11.627 Vali Loss: 54.722 Vali Acc: 0.460 Test Loss: 54.722 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.342167377471924
Epoch: 15, Steps: 13 | Train Loss: 8.071 Vali Loss: 53.042 Vali Acc: 0.440 Test Loss: 53.042 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 6.136075735092163
Epoch: 16, Steps: 13 | Train Loss: 2.993 Vali Loss: 59.937 Vali Acc: 0.480 Test Loss: 59.937 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 6.21065092086792
Epoch: 17, Steps: 13 | Train Loss: 6.445 Vali Loss: 51.930 Vali Acc: 0.380 Test Loss: 51.930 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 6.608595848083496
Epoch: 18, Steps: 13 | Train Loss: 19.150 Vali Loss: 50.178 Vali Acc: 0.440 Test Loss: 50.178 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 6.186047554016113
Epoch: 19, Steps: 13 | Train Loss: 14.503 Vali Loss: 92.422 Vali Acc: 0.460 Test Loss: 92.422 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 6.299318075180054
Epoch: 20, Steps: 13 | Train Loss: 19.729 Vali Loss: 51.777 Vali Acc: 0.560 Test Loss: 51.777 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 23209921
model size : 93.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 8.112736463546753
Epoch: 1, Steps: 13 | Train Loss: 6.196 Vali Loss: 18.102 Vali Acc: 0.200 Test Loss: 18.102 Test Acc: 0.200
Validation loss decreased (inf --> -0.199819).  Saving model ...
Epoch: 2 cost time: 5.2351109981536865
Epoch: 2, Steps: 13 | Train Loss: 12.530 Vali Loss: 6.704 Vali Acc: 0.240 Test Loss: 6.704 Test Acc: 0.240
Validation loss decreased (-0.199819 --> -0.239933).  Saving model ...
Epoch: 3 cost time: 5.846464157104492
Epoch: 3, Steps: 13 | Train Loss: 6.840 Vali Loss: 13.954 Vali Acc: 0.240 Test Loss: 13.954 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.102649927139282
Epoch: 4, Steps: 13 | Train Loss: 10.145 Vali Loss: 10.984 Vali Acc: 0.440 Test Loss: 10.984 Test Acc: 0.440
Validation loss decreased (-0.239933 --> -0.439890).  Saving model ...
Epoch: 5 cost time: 4.955735921859741
Epoch: 5, Steps: 13 | Train Loss: 10.858 Vali Loss: 16.540 Vali Acc: 0.320 Test Loss: 16.540 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.331551790237427
Epoch: 6, Steps: 13 | Train Loss: 15.966 Vali Loss: 21.950 Vali Acc: 0.380 Test Loss: 21.950 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.05238151550293
Epoch: 7, Steps: 13 | Train Loss: 9.641 Vali Loss: 25.496 Vali Acc: 0.320 Test Loss: 25.496 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.373466968536377
Epoch: 8, Steps: 13 | Train Loss: 17.311 Vali Loss: 25.236 Vali Acc: 0.500 Test Loss: 25.236 Test Acc: 0.500
Validation loss decreased (-0.439890 --> -0.499748).  Saving model ...
Epoch: 9 cost time: 5.187416315078735
Epoch: 9, Steps: 13 | Train Loss: 11.966 Vali Loss: 28.722 Vali Acc: 0.400 Test Loss: 28.722 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.083839416503906
Epoch: 10, Steps: 13 | Train Loss: 7.531 Vali Loss: 32.213 Vali Acc: 0.440 Test Loss: 32.213 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.409687757492065
Epoch: 11, Steps: 13 | Train Loss: 10.665 Vali Loss: 26.088 Vali Acc: 0.460 Test Loss: 26.088 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.3114049434661865
Epoch: 12, Steps: 13 | Train Loss: 8.062 Vali Loss: 32.746 Vali Acc: 0.340 Test Loss: 32.746 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.0515100955963135
Epoch: 13, Steps: 13 | Train Loss: 10.295 Vali Loss: 32.345 Vali Acc: 0.460 Test Loss: 32.345 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.6544883251190186
Epoch: 14, Steps: 13 | Train Loss: 7.714 Vali Loss: 41.050 Vali Acc: 0.360 Test Loss: 41.050 Test Acc: 0.360
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.14790415763855
Epoch: 15, Steps: 13 | Train Loss: 11.487 Vali Loss: 27.190 Vali Acc: 0.520 Test Loss: 27.190 Test Acc: 0.520
Validation loss decreased (-0.499748 --> -0.519728).  Saving model ...
Epoch: 16 cost time: 5.368818759918213
Epoch: 16, Steps: 13 | Train Loss: 5.321 Vali Loss: 31.438 Vali Acc: 0.520 Test Loss: 31.438 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.449290990829468
Epoch: 17, Steps: 13 | Train Loss: 7.864 Vali Loss: 37.125 Vali Acc: 0.480 Test Loss: 37.125 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.395895719528198
Epoch: 18, Steps: 13 | Train Loss: 3.672 Vali Loss: 25.785 Vali Acc: 0.560 Test Loss: 25.785 Test Acc: 0.560
Validation loss decreased (-0.519728 --> -0.559742).  Saving model ...
Epoch: 19 cost time: 5.506249189376831
Epoch: 19, Steps: 13 | Train Loss: 1.611 Vali Loss: 19.293 Vali Acc: 0.680 Test Loss: 19.293 Test Acc: 0.680
Validation loss decreased (-0.559742 --> -0.679807).  Saving model ...
Epoch: 20 cost time: 5.390560150146484
Epoch: 20, Steps: 13 | Train Loss: 0.034 Vali Loss: 20.966 Vali Acc: 0.600 Test Loss: 20.966 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.364901781082153
Epoch: 21, Steps: 13 | Train Loss: 0.001 Vali Loss: 22.667 Vali Acc: 0.540 Test Loss: 22.667 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.288311004638672
Epoch: 22, Steps: 13 | Train Loss: 0.571 Vali Loss: 30.151 Vali Acc: 0.560 Test Loss: 30.151 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 5.4910502433776855
Epoch: 23, Steps: 13 | Train Loss: 1.279 Vali Loss: 21.815 Vali Acc: 0.600 Test Loss: 21.815 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 4.9856085777282715
Epoch: 24, Steps: 13 | Train Loss: 0.000 Vali Loss: 28.657 Vali Acc: 0.560 Test Loss: 28.657 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 5.228800058364868
Epoch: 25, Steps: 13 | Train Loss: 0.378 Vali Loss: 26.876 Vali Acc: 0.580 Test Loss: 26.876 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 5.336045980453491
Epoch: 26, Steps: 13 | Train Loss: 1.921 Vali Loss: 28.618 Vali Acc: 0.520 Test Loss: 28.618 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 5.570857286453247
Epoch: 27, Steps: 13 | Train Loss: 0.000 Vali Loss: 32.461 Vali Acc: 0.500 Test Loss: 32.461 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 5.275033473968506
Epoch: 28, Steps: 13 | Train Loss: 1.869 Vali Loss: 31.205 Vali Acc: 0.600 Test Loss: 31.205 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 4.955563306808472
Epoch: 29, Steps: 13 | Train Loss: 0.210 Vali Loss: 45.399 Vali Acc: 0.420 Test Loss: 45.399 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.68
model parameter : 11335617
model size : 45.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 7.611609697341919
Epoch: 1, Steps: 13 | Train Loss: 6.738 Vali Loss: 9.153 Vali Acc: 0.240 Test Loss: 9.153 Test Acc: 0.240
Validation loss decreased (inf --> -0.239908).  Saving model ...
Epoch: 2 cost time: 5.48230242729187
Epoch: 2, Steps: 13 | Train Loss: 15.443 Vali Loss: 25.142 Vali Acc: 0.220 Test Loss: 25.142 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.240634918212891
Epoch: 3, Steps: 13 | Train Loss: 21.573 Vali Loss: 25.987 Vali Acc: 0.200 Test Loss: 25.987 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.301513671875
Epoch: 4, Steps: 13 | Train Loss: 10.217 Vali Loss: 18.672 Vali Acc: 0.320 Test Loss: 18.672 Test Acc: 0.320
Validation loss decreased (-0.239908 --> -0.319813).  Saving model ...
Epoch: 5 cost time: 5.550307035446167
Epoch: 5, Steps: 13 | Train Loss: 11.921 Vali Loss: 22.300 Vali Acc: 0.340 Test Loss: 22.300 Test Acc: 0.340
Validation loss decreased (-0.319813 --> -0.339777).  Saving model ...
Epoch: 6 cost time: 5.394648313522339
Epoch: 6, Steps: 13 | Train Loss: 17.341 Vali Loss: 15.470 Vali Acc: 0.460 Test Loss: 15.470 Test Acc: 0.460
Validation loss decreased (-0.339777 --> -0.459845).  Saving model ...
Epoch: 7 cost time: 5.373194932937622
Epoch: 7, Steps: 13 | Train Loss: 7.312 Vali Loss: 22.764 Vali Acc: 0.360 Test Loss: 22.764 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.27298903465271
Epoch: 8, Steps: 13 | Train Loss: 6.210 Vali Loss: 23.611 Vali Acc: 0.460 Test Loss: 23.611 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.128130674362183
Epoch: 9, Steps: 13 | Train Loss: 18.665 Vali Loss: 43.299 Vali Acc: 0.400 Test Loss: 43.299 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.271834135055542
Epoch: 10, Steps: 13 | Train Loss: 17.605 Vali Loss: 32.400 Vali Acc: 0.380 Test Loss: 32.400 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.454800844192505
Epoch: 11, Steps: 13 | Train Loss: 14.103 Vali Loss: 38.679 Vali Acc: 0.380 Test Loss: 38.679 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.418494701385498
Epoch: 12, Steps: 13 | Train Loss: 3.985 Vali Loss: 24.370 Vali Acc: 0.460 Test Loss: 24.370 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.0933191776275635
Epoch: 13, Steps: 13 | Train Loss: 5.746 Vali Loss: 26.391 Vali Acc: 0.460 Test Loss: 26.391 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.0417211055755615
Epoch: 14, Steps: 13 | Train Loss: 4.714 Vali Loss: 29.268 Vali Acc: 0.400 Test Loss: 29.268 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.383862495422363
Epoch: 15, Steps: 13 | Train Loss: 4.367 Vali Loss: 43.735 Vali Acc: 0.360 Test Loss: 43.735 Test Acc: 0.360
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.245955228805542
Epoch: 16, Steps: 13 | Train Loss: 6.514 Vali Loss: 22.827 Vali Acc: 0.520 Test Loss: 22.827 Test Acc: 0.520
Validation loss decreased (-0.459845 --> -0.519772).  Saving model ...
Epoch: 17 cost time: 5.322385311126709
Epoch: 17, Steps: 13 | Train Loss: 1.204 Vali Loss: 30.313 Vali Acc: 0.440 Test Loss: 30.313 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.301331520080566
Epoch: 18, Steps: 13 | Train Loss: 1.203 Vali Loss: 26.622 Vali Acc: 0.480 Test Loss: 26.622 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.349990606307983
Epoch: 19, Steps: 13 | Train Loss: 0.001 Vali Loss: 26.424 Vali Acc: 0.540 Test Loss: 26.424 Test Acc: 0.540
Validation loss decreased (-0.519772 --> -0.539736).  Saving model ...
Epoch: 20 cost time: 5.496500253677368
Epoch: 20, Steps: 13 | Train Loss: 4.538 Vali Loss: 25.739 Vali Acc: 0.560 Test Loss: 25.739 Test Acc: 0.560
Validation loss decreased (-0.539736 --> -0.559743).  Saving model ...
Epoch: 21 cost time: 5.355986833572388
Epoch: 21, Steps: 13 | Train Loss: 0.255 Vali Loss: 42.598 Vali Acc: 0.440 Test Loss: 42.598 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.456579208374023
Epoch: 22, Steps: 13 | Train Loss: 1.562 Vali Loss: 53.382 Vali Acc: 0.440 Test Loss: 53.382 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.30626654624939
Epoch: 23, Steps: 13 | Train Loss: 10.115 Vali Loss: 33.165 Vali Acc: 0.500 Test Loss: 33.165 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 5.3283421993255615
Epoch: 24, Steps: 13 | Train Loss: 0.400 Vali Loss: 39.110 Vali Acc: 0.480 Test Loss: 39.110 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 5.200785875320435
Epoch: 25, Steps: 13 | Train Loss: 1.517 Vali Loss: 37.542 Vali Acc: 0.500 Test Loss: 37.542 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 5.192760467529297
Epoch: 26, Steps: 13 | Train Loss: 2.561 Vali Loss: 43.684 Vali Acc: 0.380 Test Loss: 43.684 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 5.272262811660767
Epoch: 27, Steps: 13 | Train Loss: 1.350 Vali Loss: 32.326 Vali Acc: 0.520 Test Loss: 32.326 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 5.017794847488403
Epoch: 28, Steps: 13 | Train Loss: 0.138 Vali Loss: 45.560 Vali Acc: 0.500 Test Loss: 45.560 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 5.335965633392334
Epoch: 29, Steps: 13 | Train Loss: 1.854 Vali Loss: 36.835 Vali Acc: 0.480 Test Loss: 36.835 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 5.270511627197266
Epoch: 30, Steps: 13 | Train Loss: 0.924 Vali Loss: 28.949 Vali Acc: 0.540 Test Loss: 28.949 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 11329985
model size : 45.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 7.289401054382324
Epoch: 1, Steps: 13 | Train Loss: 4.152 Vali Loss: 4.474 Vali Acc: 0.180 Test Loss: 4.474 Test Acc: 0.180
Validation loss decreased (inf --> -0.179955).  Saving model ...
Epoch: 2 cost time: 5.5548694133758545
Epoch: 2, Steps: 13 | Train Loss: 5.402 Vali Loss: 12.005 Vali Acc: 0.220 Test Loss: 12.005 Test Acc: 0.220
Validation loss decreased (-0.179955 --> -0.219880).  Saving model ...
Epoch: 3 cost time: 5.632149934768677
Epoch: 3, Steps: 13 | Train Loss: 10.891 Vali Loss: 13.901 Vali Acc: 0.180 Test Loss: 13.901 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.303203105926514
Epoch: 4, Steps: 13 | Train Loss: 11.507 Vali Loss: 12.467 Vali Acc: 0.300 Test Loss: 12.467 Test Acc: 0.300
Validation loss decreased (-0.219880 --> -0.299875).  Saving model ...
Epoch: 5 cost time: 5.107687473297119
Epoch: 5, Steps: 13 | Train Loss: 7.682 Vali Loss: 10.977 Vali Acc: 0.360 Test Loss: 10.977 Test Acc: 0.360
Validation loss decreased (-0.299875 --> -0.359890).  Saving model ...
Epoch: 6 cost time: 5.400451898574829
Epoch: 6, Steps: 13 | Train Loss: 5.098 Vali Loss: 20.155 Vali Acc: 0.440 Test Loss: 20.155 Test Acc: 0.440
Validation loss decreased (-0.359890 --> -0.439798).  Saving model ...
Epoch: 7 cost time: 5.0494256019592285
Epoch: 7, Steps: 13 | Train Loss: 5.623 Vali Loss: 21.134 Vali Acc: 0.520 Test Loss: 21.134 Test Acc: 0.520
Validation loss decreased (-0.439798 --> -0.519789).  Saving model ...
Epoch: 8 cost time: 5.429643630981445
Epoch: 8, Steps: 13 | Train Loss: 7.278 Vali Loss: 22.778 Vali Acc: 0.360 Test Loss: 22.778 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.9841108322143555
Epoch: 9, Steps: 13 | Train Loss: 12.431 Vali Loss: 18.255 Vali Acc: 0.420 Test Loss: 18.255 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.096888542175293
Epoch: 10, Steps: 13 | Train Loss: 6.590 Vali Loss: 20.359 Vali Acc: 0.520 Test Loss: 20.359 Test Acc: 0.520
Validation loss decreased (-0.519789 --> -0.519796).  Saving model ...
Epoch: 11 cost time: 5.0241992473602295
Epoch: 11, Steps: 13 | Train Loss: 5.992 Vali Loss: 22.251 Vali Acc: 0.380 Test Loss: 22.251 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.385887622833252
Epoch: 12, Steps: 13 | Train Loss: 7.999 Vali Loss: 20.121 Vali Acc: 0.440 Test Loss: 20.121 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.252243995666504
Epoch: 13, Steps: 13 | Train Loss: 5.790 Vali Loss: 28.464 Vali Acc: 0.380 Test Loss: 28.464 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.406676292419434
Epoch: 14, Steps: 13 | Train Loss: 1.224 Vali Loss: 17.479 Vali Acc: 0.460 Test Loss: 17.479 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.147014141082764
Epoch: 15, Steps: 13 | Train Loss: 1.477 Vali Loss: 46.063 Vali Acc: 0.360 Test Loss: 46.063 Test Acc: 0.360
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.483079195022583
Epoch: 16, Steps: 13 | Train Loss: 8.964 Vali Loss: 33.133 Vali Acc: 0.400 Test Loss: 33.133 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 5.032514572143555
Epoch: 17, Steps: 13 | Train Loss: 4.682 Vali Loss: 28.866 Vali Acc: 0.420 Test Loss: 28.866 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 5.386043071746826
Epoch: 18, Steps: 13 | Train Loss: 2.013 Vali Loss: 36.950 Vali Acc: 0.400 Test Loss: 36.950 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 5.233072996139526
Epoch: 19, Steps: 13 | Train Loss: 3.136 Vali Loss: 34.907 Vali Acc: 0.460 Test Loss: 34.907 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 5.17126989364624
Epoch: 20, Steps: 13 | Train Loss: 2.608 Vali Loss: 60.966 Vali Acc: 0.260 Test Loss: 60.966 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 11324353
model size : 45.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 7.882779598236084
Epoch: 1, Steps: 13 | Train Loss: 4.942 Vali Loss: 15.642 Vali Acc: 0.200 Test Loss: 15.642 Test Acc: 0.200
Validation loss decreased (inf --> -0.199844).  Saving model ...
Epoch: 2 cost time: 5.021286964416504
Epoch: 2, Steps: 13 | Train Loss: 12.548 Vali Loss: 9.232 Vali Acc: 0.300 Test Loss: 9.232 Test Acc: 0.300
Validation loss decreased (-0.199844 --> -0.299908).  Saving model ...
Epoch: 3 cost time: 5.087786436080933
Epoch: 3, Steps: 13 | Train Loss: 14.282 Vali Loss: 23.812 Vali Acc: 0.220 Test Loss: 23.812 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.144178152084351
Epoch: 4, Steps: 13 | Train Loss: 12.127 Vali Loss: 26.214 Vali Acc: 0.340 Test Loss: 26.214 Test Acc: 0.340
Validation loss decreased (-0.299908 --> -0.339738).  Saving model ...
Epoch: 5 cost time: 4.823678255081177
Epoch: 5, Steps: 13 | Train Loss: 21.508 Vali Loss: 42.499 Vali Acc: 0.420 Test Loss: 42.499 Test Acc: 0.420
Validation loss decreased (-0.339738 --> -0.419575).  Saving model ...
Epoch: 6 cost time: 4.78331732749939
Epoch: 6, Steps: 13 | Train Loss: 20.263 Vali Loss: 26.532 Vali Acc: 0.440 Test Loss: 26.532 Test Acc: 0.440
Validation loss decreased (-0.419575 --> -0.439735).  Saving model ...
Epoch: 7 cost time: 5.105891227722168
Epoch: 7, Steps: 13 | Train Loss: 13.716 Vali Loss: 18.491 Vali Acc: 0.360 Test Loss: 18.491 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.997157096862793
Epoch: 8, Steps: 13 | Train Loss: 11.489 Vali Loss: 19.564 Vali Acc: 0.520 Test Loss: 19.564 Test Acc: 0.520
Validation loss decreased (-0.439735 --> -0.519804).  Saving model ...
Epoch: 9 cost time: 5.118593692779541
Epoch: 9, Steps: 13 | Train Loss: 6.664 Vali Loss: 21.203 Vali Acc: 0.480 Test Loss: 21.203 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.381514549255371
Epoch: 10, Steps: 13 | Train Loss: 4.664 Vali Loss: 21.531 Vali Acc: 0.500 Test Loss: 21.531 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.075470209121704
Epoch: 11, Steps: 13 | Train Loss: 2.861 Vali Loss: 21.942 Vali Acc: 0.460 Test Loss: 21.942 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.033798456192017
Epoch: 12, Steps: 13 | Train Loss: 9.241 Vali Loss: 25.773 Vali Acc: 0.400 Test Loss: 25.773 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.08521032333374
Epoch: 13, Steps: 13 | Train Loss: 2.803 Vali Loss: 27.656 Vali Acc: 0.400 Test Loss: 27.656 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.996586322784424
Epoch: 14, Steps: 13 | Train Loss: 1.822 Vali Loss: 22.043 Vali Acc: 0.480 Test Loss: 22.043 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.174935579299927
Epoch: 15, Steps: 13 | Train Loss: 1.443 Vali Loss: 19.071 Vali Acc: 0.500 Test Loss: 19.071 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.781017065048218
Epoch: 16, Steps: 13 | Train Loss: 0.675 Vali Loss: 21.192 Vali Acc: 0.520 Test Loss: 21.192 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.946460962295532
Epoch: 17, Steps: 13 | Train Loss: 1.202 Vali Loss: 36.107 Vali Acc: 0.440 Test Loss: 36.107 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.950708627700806
Epoch: 18, Steps: 13 | Train Loss: 2.740 Vali Loss: 20.839 Vali Acc: 0.460 Test Loss: 20.839 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 11318721
model size : 45.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 7.6372082233428955
Epoch: 1, Steps: 13 | Train Loss: 3.796 Vali Loss: 4.672 Vali Acc: 0.220 Test Loss: 4.672 Test Acc: 0.220
Validation loss decreased (inf --> -0.219953).  Saving model ...
Epoch: 2 cost time: 4.723715782165527
Epoch: 2, Steps: 13 | Train Loss: 7.952 Vali Loss: 10.265 Vali Acc: 0.220 Test Loss: 10.265 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.874986171722412
Epoch: 3, Steps: 13 | Train Loss: 9.082 Vali Loss: 11.380 Vali Acc: 0.340 Test Loss: 11.380 Test Acc: 0.340
Validation loss decreased (-0.219953 --> -0.339886).  Saving model ...
Epoch: 4 cost time: 4.763112306594849
Epoch: 4, Steps: 13 | Train Loss: 8.884 Vali Loss: 21.411 Vali Acc: 0.300 Test Loss: 21.411 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.368584632873535
Epoch: 5, Steps: 13 | Train Loss: 13.267 Vali Loss: 20.504 Vali Acc: 0.340 Test Loss: 20.504 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.992095708847046
Epoch: 6, Steps: 13 | Train Loss: 11.820 Vali Loss: 13.807 Vali Acc: 0.500 Test Loss: 13.807 Test Acc: 0.500
Validation loss decreased (-0.339886 --> -0.499862).  Saving model ...
Epoch: 7 cost time: 5.254823207855225
Epoch: 7, Steps: 13 | Train Loss: 7.467 Vali Loss: 16.713 Vali Acc: 0.520 Test Loss: 16.713 Test Acc: 0.520
Validation loss decreased (-0.499862 --> -0.519833).  Saving model ...
Epoch: 8 cost time: 4.978307247161865
Epoch: 8, Steps: 13 | Train Loss: 11.933 Vali Loss: 18.003 Vali Acc: 0.460 Test Loss: 18.003 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.101861953735352
Epoch: 9, Steps: 13 | Train Loss: 15.779 Vali Loss: 35.112 Vali Acc: 0.440 Test Loss: 35.112 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.1265788078308105
Epoch: 10, Steps: 13 | Train Loss: 8.710 Vali Loss: 36.985 Vali Acc: 0.380 Test Loss: 36.985 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.1415770053863525
Epoch: 11, Steps: 13 | Train Loss: 5.429 Vali Loss: 28.546 Vali Acc: 0.460 Test Loss: 28.546 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.086731910705566
Epoch: 12, Steps: 13 | Train Loss: 2.282 Vali Loss: 24.435 Vali Acc: 0.600 Test Loss: 24.435 Test Acc: 0.600
Validation loss decreased (-0.519833 --> -0.599756).  Saving model ...
Epoch: 13 cost time: 5.025516033172607
Epoch: 13, Steps: 13 | Train Loss: 3.746 Vali Loss: 25.451 Vali Acc: 0.440 Test Loss: 25.451 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.629483461380005
Epoch: 14, Steps: 13 | Train Loss: 1.426 Vali Loss: 59.633 Vali Acc: 0.280 Test Loss: 59.633 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.065234661102295
Epoch: 15, Steps: 13 | Train Loss: 9.883 Vali Loss: 39.683 Vali Acc: 0.500 Test Loss: 39.683 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.053375482559204
Epoch: 16, Steps: 13 | Train Loss: 8.808 Vali Loss: 32.349 Vali Acc: 0.540 Test Loss: 32.349 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.1532323360443115
Epoch: 17, Steps: 13 | Train Loss: 6.018 Vali Loss: 31.891 Vali Acc: 0.520 Test Loss: 31.891 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.321678400039673
Epoch: 18, Steps: 13 | Train Loss: 5.007 Vali Loss: 35.122 Vali Acc: 0.380 Test Loss: 35.122 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.903655767440796
Epoch: 19, Steps: 13 | Train Loss: 0.672 Vali Loss: 36.357 Vali Acc: 0.480 Test Loss: 36.357 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 5.00788950920105
Epoch: 20, Steps: 13 | Train Loss: 2.750 Vali Loss: 33.997 Vali Acc: 0.480 Test Loss: 33.997 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.889997720718384
Epoch: 21, Steps: 13 | Train Loss: 5.265 Vali Loss: 35.917 Vali Acc: 0.540 Test Loss: 35.917 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 5.14180326461792
Epoch: 22, Steps: 13 | Train Loss: 9.561 Vali Loss: 61.426 Vali Acc: 0.420 Test Loss: 61.426 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 10151361
model size : 41.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 7.461703062057495
Epoch: 1, Steps: 13 | Train Loss: 4.476 Vali Loss: 6.286 Vali Acc: 0.300 Test Loss: 6.286 Test Acc: 0.300
Validation loss decreased (inf --> -0.299937).  Saving model ...
Epoch: 2 cost time: 4.796055316925049
Epoch: 2, Steps: 13 | Train Loss: 8.023 Vali Loss: 9.452 Vali Acc: 0.280 Test Loss: 9.452 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.018709659576416
Epoch: 3, Steps: 13 | Train Loss: 8.605 Vali Loss: 12.873 Vali Acc: 0.300 Test Loss: 12.873 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.7659337520599365
Epoch: 4, Steps: 13 | Train Loss: 14.816 Vali Loss: 18.800 Vali Acc: 0.340 Test Loss: 18.800 Test Acc: 0.340
Validation loss decreased (-0.299937 --> -0.339812).  Saving model ...
Epoch: 5 cost time: 4.851385831832886
Epoch: 5, Steps: 13 | Train Loss: 12.914 Vali Loss: 20.037 Vali Acc: 0.480 Test Loss: 20.037 Test Acc: 0.480
Validation loss decreased (-0.339812 --> -0.479800).  Saving model ...
Epoch: 6 cost time: 5.1026341915130615
Epoch: 6, Steps: 13 | Train Loss: 6.063 Vali Loss: 10.580 Vali Acc: 0.460 Test Loss: 10.580 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.938530206680298
Epoch: 7, Steps: 13 | Train Loss: 5.146 Vali Loss: 18.902 Vali Acc: 0.440 Test Loss: 18.902 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.9192955493927
Epoch: 8, Steps: 13 | Train Loss: 6.565 Vali Loss: 21.037 Vali Acc: 0.560 Test Loss: 21.037 Test Acc: 0.560
Validation loss decreased (-0.479800 --> -0.559790).  Saving model ...
Epoch: 9 cost time: 5.137745141983032
Epoch: 9, Steps: 13 | Train Loss: 5.582 Vali Loss: 20.128 Vali Acc: 0.400 Test Loss: 20.128 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.903342247009277
Epoch: 10, Steps: 13 | Train Loss: 11.201 Vali Loss: 35.795 Vali Acc: 0.500 Test Loss: 35.795 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.959568738937378
Epoch: 11, Steps: 13 | Train Loss: 8.278 Vali Loss: 44.349 Vali Acc: 0.360 Test Loss: 44.349 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.121610879898071
Epoch: 12, Steps: 13 | Train Loss: 18.765 Vali Loss: 35.013 Vali Acc: 0.320 Test Loss: 35.013 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.986471176147461
Epoch: 13, Steps: 13 | Train Loss: 6.355 Vali Loss: 24.804 Vali Acc: 0.480 Test Loss: 24.804 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.848850727081299
Epoch: 14, Steps: 13 | Train Loss: 7.006 Vali Loss: 22.602 Vali Acc: 0.560 Test Loss: 22.602 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.0433430671691895
Epoch: 15, Steps: 13 | Train Loss: 4.966 Vali Loss: 21.925 Vali Acc: 0.480 Test Loss: 21.925 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.849245309829712
Epoch: 16, Steps: 13 | Train Loss: 3.087 Vali Loss: 26.891 Vali Acc: 0.500 Test Loss: 26.891 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.934105157852173
Epoch: 17, Steps: 13 | Train Loss: 2.147 Vali Loss: 27.977 Vali Acc: 0.520 Test Loss: 27.977 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 5.0606303215026855
Epoch: 18, Steps: 13 | Train Loss: 1.485 Vali Loss: 51.957 Vali Acc: 0.400 Test Loss: 51.957 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 10145729
model size : 41.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 6.843770742416382
Epoch: 1, Steps: 13 | Train Loss: 6.329 Vali Loss: 10.192 Vali Acc: 0.200 Test Loss: 10.192 Test Acc: 0.200
Validation loss decreased (inf --> -0.199898).  Saving model ...
Epoch: 2 cost time: 4.7323291301727295
Epoch: 2, Steps: 13 | Train Loss: 9.210 Vali Loss: 25.125 Vali Acc: 0.220 Test Loss: 25.125 Test Acc: 0.220
Validation loss decreased (-0.199898 --> -0.219749).  Saving model ...
Epoch: 3 cost time: 5.107437610626221
Epoch: 3, Steps: 13 | Train Loss: 12.087 Vali Loss: 7.549 Vali Acc: 0.380 Test Loss: 7.549 Test Acc: 0.380
Validation loss decreased (-0.219749 --> -0.379925).  Saving model ...
Epoch: 4 cost time: 4.893897533416748
Epoch: 4, Steps: 13 | Train Loss: 7.595 Vali Loss: 23.600 Vali Acc: 0.300 Test Loss: 23.600 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.119233846664429
Epoch: 5, Steps: 13 | Train Loss: 14.055 Vali Loss: 16.694 Vali Acc: 0.440 Test Loss: 16.694 Test Acc: 0.440
Validation loss decreased (-0.379925 --> -0.439833).  Saving model ...
Epoch: 6 cost time: 4.719487905502319
Epoch: 6, Steps: 13 | Train Loss: 8.453 Vali Loss: 23.663 Vali Acc: 0.380 Test Loss: 23.663 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.157686948776245
Epoch: 7, Steps: 13 | Train Loss: 13.794 Vali Loss: 28.202 Vali Acc: 0.280 Test Loss: 28.202 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.089226722717285
Epoch: 8, Steps: 13 | Train Loss: 7.269 Vali Loss: 26.685 Vali Acc: 0.460 Test Loss: 26.685 Test Acc: 0.460
Validation loss decreased (-0.439833 --> -0.459733).  Saving model ...
Epoch: 9 cost time: 4.967525243759155
Epoch: 9, Steps: 13 | Train Loss: 8.505 Vali Loss: 32.185 Vali Acc: 0.360 Test Loss: 32.185 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.908596754074097
Epoch: 10, Steps: 13 | Train Loss: 13.074 Vali Loss: 17.867 Vali Acc: 0.420 Test Loss: 17.867 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.943098306655884
Epoch: 11, Steps: 13 | Train Loss: 8.246 Vali Loss: 17.024 Vali Acc: 0.520 Test Loss: 17.024 Test Acc: 0.520
Validation loss decreased (-0.459733 --> -0.519830).  Saving model ...
Epoch: 12 cost time: 4.909879207611084
Epoch: 12, Steps: 13 | Train Loss: 2.612 Vali Loss: 28.230 Vali Acc: 0.480 Test Loss: 28.230 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.814913272857666
Epoch: 13, Steps: 13 | Train Loss: 9.572 Vali Loss: 40.171 Vali Acc: 0.440 Test Loss: 40.171 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.00935173034668
Epoch: 14, Steps: 13 | Train Loss: 4.987 Vali Loss: 21.121 Vali Acc: 0.580 Test Loss: 21.121 Test Acc: 0.580
Validation loss decreased (-0.519830 --> -0.579789).  Saving model ...
Epoch: 15 cost time: 4.777228355407715
Epoch: 15, Steps: 13 | Train Loss: 3.456 Vali Loss: 21.609 Vali Acc: 0.440 Test Loss: 21.609 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.707304954528809
Epoch: 16, Steps: 13 | Train Loss: 0.632 Vali Loss: 31.873 Vali Acc: 0.340 Test Loss: 31.873 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.8940653800964355
Epoch: 17, Steps: 13 | Train Loss: 1.398 Vali Loss: 24.774 Vali Acc: 0.520 Test Loss: 24.774 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.8581249713897705
Epoch: 18, Steps: 13 | Train Loss: 0.707 Vali Loss: 21.872 Vali Acc: 0.560 Test Loss: 21.872 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.881005525588989
Epoch: 19, Steps: 13 | Train Loss: 0.837 Vali Loss: 29.500 Vali Acc: 0.540 Test Loss: 29.500 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 5.0385003089904785
Epoch: 20, Steps: 13 | Train Loss: 4.618 Vali Loss: 30.552 Vali Acc: 0.480 Test Loss: 30.552 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 5.055492162704468
Epoch: 21, Steps: 13 | Train Loss: 1.586 Vali Loss: 18.999 Vali Acc: 0.480 Test Loss: 18.999 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.746136903762817
Epoch: 22, Steps: 13 | Train Loss: 0.690 Vali Loss: 26.174 Vali Acc: 0.500 Test Loss: 26.174 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 5.090199708938599
Epoch: 23, Steps: 13 | Train Loss: 1.423 Vali Loss: 26.819 Vali Acc: 0.480 Test Loss: 26.819 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 5.160151720046997
Epoch: 24, Steps: 13 | Train Loss: 3.974 Vali Loss: 52.594 Vali Acc: 0.400 Test Loss: 52.594 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 10140097
model size : 41.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 7.386446714401245
Epoch: 1, Steps: 13 | Train Loss: 3.098 Vali Loss: 4.121 Vali Acc: 0.200 Test Loss: 4.121 Test Acc: 0.200
Validation loss decreased (inf --> -0.199959).  Saving model ...
Epoch: 2 cost time: 4.484938144683838
Epoch: 2, Steps: 13 | Train Loss: 6.365 Vali Loss: 14.138 Vali Acc: 0.200 Test Loss: 14.138 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.549575567245483
Epoch: 3, Steps: 13 | Train Loss: 17.410 Vali Loss: 18.157 Vali Acc: 0.200 Test Loss: 18.157 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.848141670227051
Epoch: 4, Steps: 13 | Train Loss: 12.607 Vali Loss: 18.007 Vali Acc: 0.300 Test Loss: 18.007 Test Acc: 0.300
Validation loss decreased (-0.199959 --> -0.299820).  Saving model ...
Epoch: 5 cost time: 4.612578868865967
Epoch: 5, Steps: 13 | Train Loss: 7.105 Vali Loss: 16.583 Vali Acc: 0.380 Test Loss: 16.583 Test Acc: 0.380
Validation loss decreased (-0.299820 --> -0.379834).  Saving model ...
Epoch: 6 cost time: 4.589945077896118
Epoch: 6, Steps: 13 | Train Loss: 6.737 Vali Loss: 26.973 Vali Acc: 0.280 Test Loss: 26.973 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.7984395027160645
Epoch: 7, Steps: 13 | Train Loss: 14.610 Vali Loss: 18.979 Vali Acc: 0.460 Test Loss: 18.979 Test Acc: 0.460
Validation loss decreased (-0.379834 --> -0.459810).  Saving model ...
Epoch: 8 cost time: 4.864871501922607
Epoch: 8, Steps: 13 | Train Loss: 20.092 Vali Loss: 38.724 Vali Acc: 0.440 Test Loss: 38.724 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.667558670043945
Epoch: 9, Steps: 13 | Train Loss: 18.017 Vali Loss: 29.681 Vali Acc: 0.480 Test Loss: 29.681 Test Acc: 0.480
Validation loss decreased (-0.459810 --> -0.479703).  Saving model ...
Epoch: 10 cost time: 4.735154151916504
Epoch: 10, Steps: 13 | Train Loss: 12.128 Vali Loss: 36.950 Vali Acc: 0.380 Test Loss: 36.950 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.616083860397339
Epoch: 11, Steps: 13 | Train Loss: 12.097 Vali Loss: 42.310 Vali Acc: 0.400 Test Loss: 42.310 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.068308353424072
Epoch: 12, Steps: 13 | Train Loss: 22.879 Vali Loss: 66.270 Vali Acc: 0.360 Test Loss: 66.270 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.7201759815216064
Epoch: 13, Steps: 13 | Train Loss: 12.795 Vali Loss: 32.220 Vali Acc: 0.580 Test Loss: 32.220 Test Acc: 0.580
Validation loss decreased (-0.479703 --> -0.579678).  Saving model ...
Epoch: 14 cost time: 4.6781721115112305
Epoch: 14, Steps: 13 | Train Loss: 4.368 Vali Loss: 28.646 Vali Acc: 0.580 Test Loss: 28.646 Test Acc: 0.580
Validation loss decreased (-0.579678 --> -0.579714).  Saving model ...
Epoch: 15 cost time: 4.886483430862427
Epoch: 15, Steps: 13 | Train Loss: 1.276 Vali Loss: 33.159 Vali Acc: 0.580 Test Loss: 33.159 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.781057357788086
Epoch: 16, Steps: 13 | Train Loss: 1.669 Vali Loss: 37.455 Vali Acc: 0.380 Test Loss: 37.455 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.902724504470825
Epoch: 17, Steps: 13 | Train Loss: 2.089 Vali Loss: 38.097 Vali Acc: 0.460 Test Loss: 38.097 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.842498064041138
Epoch: 18, Steps: 13 | Train Loss: 3.334 Vali Loss: 54.615 Vali Acc: 0.400 Test Loss: 54.615 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.8398473262786865
Epoch: 19, Steps: 13 | Train Loss: 3.085 Vali Loss: 55.279 Vali Acc: 0.400 Test Loss: 55.279 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.56194543838501
Epoch: 20, Steps: 13 | Train Loss: 2.334 Vali Loss: 44.791 Vali Acc: 0.440 Test Loss: 44.791 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.534888029098511
Epoch: 21, Steps: 13 | Train Loss: 0.150 Vali Loss: 40.539 Vali Acc: 0.520 Test Loss: 40.539 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.698779821395874
Epoch: 22, Steps: 13 | Train Loss: 0.472 Vali Loss: 49.306 Vali Acc: 0.520 Test Loss: 49.306 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.654672145843506
Epoch: 23, Steps: 13 | Train Loss: 0.933 Vali Loss: 41.430 Vali Acc: 0.520 Test Loss: 41.430 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 4.511010408401489
Epoch: 24, Steps: 13 | Train Loss: 1.586 Vali Loss: 57.137 Vali Acc: 0.500 Test Loss: 57.137 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 10134465
model size : 41.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 7.365202903747559
Epoch: 1, Steps: 13 | Train Loss: 4.172 Vali Loss: 3.752 Vali Acc: 0.220 Test Loss: 3.752 Test Acc: 0.220
Validation loss decreased (inf --> -0.219962).  Saving model ...
Epoch: 2 cost time: 4.274834394454956
Epoch: 2, Steps: 13 | Train Loss: 4.902 Vali Loss: 6.351 Vali Acc: 0.240 Test Loss: 6.351 Test Acc: 0.240
Validation loss decreased (-0.219962 --> -0.239936).  Saving model ...
Epoch: 3 cost time: 4.471351146697998
Epoch: 3, Steps: 13 | Train Loss: 9.771 Vali Loss: 13.704 Vali Acc: 0.320 Test Loss: 13.704 Test Acc: 0.320
Validation loss decreased (-0.239936 --> -0.319863).  Saving model ...
Epoch: 4 cost time: 4.4859092235565186
Epoch: 4, Steps: 13 | Train Loss: 5.315 Vali Loss: 17.573 Vali Acc: 0.420 Test Loss: 17.573 Test Acc: 0.420
Validation loss decreased (-0.319863 --> -0.419824).  Saving model ...
Epoch: 5 cost time: 4.6706156730651855
Epoch: 5, Steps: 13 | Train Loss: 10.217 Vali Loss: 16.227 Vali Acc: 0.360 Test Loss: 16.227 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.753180027008057
Epoch: 6, Steps: 13 | Train Loss: 5.997 Vali Loss: 10.618 Vali Acc: 0.580 Test Loss: 10.618 Test Acc: 0.580
Validation loss decreased (-0.419824 --> -0.579894).  Saving model ...
Epoch: 7 cost time: 4.671524286270142
Epoch: 7, Steps: 13 | Train Loss: 9.428 Vali Loss: 38.644 Vali Acc: 0.360 Test Loss: 38.644 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.182366371154785
Epoch: 8, Steps: 13 | Train Loss: 9.210 Vali Loss: 48.979 Vali Acc: 0.320 Test Loss: 48.979 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.797985076904297
Epoch: 9, Steps: 13 | Train Loss: 11.009 Vali Loss: 15.141 Vali Acc: 0.620 Test Loss: 15.141 Test Acc: 0.620
Validation loss decreased (-0.579894 --> -0.619849).  Saving model ...
Epoch: 10 cost time: 4.831640243530273
Epoch: 10, Steps: 13 | Train Loss: 7.210 Vali Loss: 40.974 Vali Acc: 0.440 Test Loss: 40.974 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.9545300006866455
Epoch: 11, Steps: 13 | Train Loss: 9.357 Vali Loss: 40.357 Vali Acc: 0.380 Test Loss: 40.357 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.669123888015747
Epoch: 12, Steps: 13 | Train Loss: 7.534 Vali Loss: 44.321 Vali Acc: 0.380 Test Loss: 44.321 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.977451801300049
Epoch: 13, Steps: 13 | Train Loss: 9.711 Vali Loss: 33.769 Vali Acc: 0.460 Test Loss: 33.769 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.827489137649536
Epoch: 14, Steps: 13 | Train Loss: 4.838 Vali Loss: 35.943 Vali Acc: 0.460 Test Loss: 35.943 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.825598239898682
Epoch: 15, Steps: 13 | Train Loss: 2.714 Vali Loss: 35.585 Vali Acc: 0.420 Test Loss: 35.585 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.483387231826782
Epoch: 16, Steps: 13 | Train Loss: 4.026 Vali Loss: 23.303 Vali Acc: 0.580 Test Loss: 23.303 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.7964911460876465
Epoch: 17, Steps: 13 | Train Loss: 2.870 Vali Loss: 21.158 Vali Acc: 0.540 Test Loss: 21.158 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.622276067733765
Epoch: 18, Steps: 13 | Train Loss: 1.661 Vali Loss: 20.431 Vali Acc: 0.480 Test Loss: 20.431 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.486758708953857
Epoch: 19, Steps: 13 | Train Loss: 2.035 Vali Loss: 29.839 Vali Acc: 0.380 Test Loss: 29.839 Test Acc: 0.380
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 9559233
model size : 39.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 7.330513000488281
Epoch: 1, Steps: 13 | Train Loss: 4.855 Vali Loss: 21.334 Vali Acc: 0.200 Test Loss: 21.334 Test Acc: 0.200
Validation loss decreased (inf --> -0.199787).  Saving model ...
Epoch: 2 cost time: 4.5630717277526855
Epoch: 2, Steps: 13 | Train Loss: 10.745 Vali Loss: 5.766 Vali Acc: 0.280 Test Loss: 5.766 Test Acc: 0.280
Validation loss decreased (-0.199787 --> -0.279942).  Saving model ...
Epoch: 3 cost time: 4.571330308914185
Epoch: 3, Steps: 13 | Train Loss: 5.556 Vali Loss: 13.183 Vali Acc: 0.260 Test Loss: 13.183 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.6798317432403564
Epoch: 4, Steps: 13 | Train Loss: 15.943 Vali Loss: 17.323 Vali Acc: 0.300 Test Loss: 17.323 Test Acc: 0.300
Validation loss decreased (-0.279942 --> -0.299827).  Saving model ...
Epoch: 5 cost time: 4.656100511550903
Epoch: 5, Steps: 13 | Train Loss: 14.142 Vali Loss: 28.288 Vali Acc: 0.360 Test Loss: 28.288 Test Acc: 0.360
Validation loss decreased (-0.299827 --> -0.359717).  Saving model ...
Epoch: 6 cost time: 4.678291320800781
Epoch: 6, Steps: 13 | Train Loss: 17.019 Vali Loss: 23.257 Vali Acc: 0.440 Test Loss: 23.257 Test Acc: 0.440
Validation loss decreased (-0.359717 --> -0.439767).  Saving model ...
Epoch: 7 cost time: 4.7506256103515625
Epoch: 7, Steps: 13 | Train Loss: 15.470 Vali Loss: 38.038 Vali Acc: 0.400 Test Loss: 38.038 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.444870471954346
Epoch: 8, Steps: 13 | Train Loss: 10.325 Vali Loss: 21.616 Vali Acc: 0.480 Test Loss: 21.616 Test Acc: 0.480
Validation loss decreased (-0.439767 --> -0.479784).  Saving model ...
Epoch: 9 cost time: 4.812761545181274
Epoch: 9, Steps: 13 | Train Loss: 6.835 Vali Loss: 32.009 Vali Acc: 0.400 Test Loss: 32.009 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.841418027877808
Epoch: 10, Steps: 13 | Train Loss: 16.210 Vali Loss: 27.419 Vali Acc: 0.380 Test Loss: 27.419 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.474439859390259
Epoch: 11, Steps: 13 | Train Loss: 1.417 Vali Loss: 24.268 Vali Acc: 0.500 Test Loss: 24.268 Test Acc: 0.500
Validation loss decreased (-0.479784 --> -0.499757).  Saving model ...
Epoch: 12 cost time: 4.55985689163208
Epoch: 12, Steps: 13 | Train Loss: 4.368 Vali Loss: 21.833 Vali Acc: 0.520 Test Loss: 21.833 Test Acc: 0.520
Validation loss decreased (-0.499757 --> -0.519782).  Saving model ...
Epoch: 13 cost time: 4.818242073059082
Epoch: 13, Steps: 13 | Train Loss: 5.857 Vali Loss: 22.010 Vali Acc: 0.500 Test Loss: 22.010 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.8435959815979
Epoch: 14, Steps: 13 | Train Loss: 2.492 Vali Loss: 34.330 Vali Acc: 0.440 Test Loss: 34.330 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.665476083755493
Epoch: 15, Steps: 13 | Train Loss: 6.913 Vali Loss: 17.983 Vali Acc: 0.540 Test Loss: 17.983 Test Acc: 0.540
Validation loss decreased (-0.519782 --> -0.539820).  Saving model ...
Epoch: 16 cost time: 4.808946371078491
Epoch: 16, Steps: 13 | Train Loss: 3.988 Vali Loss: 13.905 Vali Acc: 0.560 Test Loss: 13.905 Test Acc: 0.560
Validation loss decreased (-0.539820 --> -0.559861).  Saving model ...
Epoch: 17 cost time: 4.385974168777466
Epoch: 17, Steps: 13 | Train Loss: 4.321 Vali Loss: 22.408 Vali Acc: 0.420 Test Loss: 22.408 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.832587003707886
Epoch: 18, Steps: 13 | Train Loss: 0.548 Vali Loss: 20.413 Vali Acc: 0.540 Test Loss: 20.413 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.536432266235352
Epoch: 19, Steps: 13 | Train Loss: 1.268 Vali Loss: 32.262 Vali Acc: 0.480 Test Loss: 32.262 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.623034715652466
Epoch: 20, Steps: 13 | Train Loss: 2.949 Vali Loss: 23.864 Vali Acc: 0.500 Test Loss: 23.864 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 4.620187997817993
Epoch: 21, Steps: 13 | Train Loss: 0.351 Vali Loss: 36.575 Vali Acc: 0.480 Test Loss: 36.575 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 4.999121904373169
Epoch: 22, Steps: 13 | Train Loss: 2.385 Vali Loss: 28.657 Vali Acc: 0.520 Test Loss: 28.657 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 4.762654781341553
Epoch: 23, Steps: 13 | Train Loss: 0.570 Vali Loss: 25.644 Vali Acc: 0.580 Test Loss: 25.644 Test Acc: 0.580
Validation loss decreased (-0.559861 --> -0.579744).  Saving model ...
Epoch: 24 cost time: 4.721873760223389
Epoch: 24, Steps: 13 | Train Loss: 0.012 Vali Loss: 33.431 Vali Acc: 0.540 Test Loss: 33.431 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 5.194643020629883
Epoch: 25, Steps: 13 | Train Loss: 0.939 Vali Loss: 36.196 Vali Acc: 0.460 Test Loss: 36.196 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 4.657152414321899
Epoch: 26, Steps: 13 | Train Loss: 0.204 Vali Loss: 29.321 Vali Acc: 0.520 Test Loss: 29.321 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 4.76795768737793
Epoch: 27, Steps: 13 | Train Loss: 0.237 Vali Loss: 29.404 Vali Acc: 0.620 Test Loss: 29.404 Test Acc: 0.620
Validation loss decreased (-0.579744 --> -0.619706).  Saving model ...
Epoch: 28 cost time: 4.489894390106201
Epoch: 28, Steps: 13 | Train Loss: 0.003 Vali Loss: 39.681 Vali Acc: 0.500 Test Loss: 39.681 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 5.0166261196136475
Epoch: 29, Steps: 13 | Train Loss: 0.921 Vali Loss: 34.969 Vali Acc: 0.500 Test Loss: 34.969 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 4.773711204528809
Epoch: 30, Steps: 13 | Train Loss: 0.886 Vali Loss: 40.496 Vali Acc: 0.520 Test Loss: 40.496 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 4.869211196899414
Epoch: 31, Steps: 13 | Train Loss: 0.374 Vali Loss: 31.999 Vali Acc: 0.540 Test Loss: 31.999 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 5.093312978744507
Epoch: 32, Steps: 13 | Train Loss: 0.331 Vali Loss: 26.055 Vali Acc: 0.560 Test Loss: 26.055 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 4.7641801834106445
Epoch: 33, Steps: 13 | Train Loss: 0.090 Vali Loss: 28.143 Vali Acc: 0.500 Test Loss: 28.143 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 4.790133237838745
Epoch: 34, Steps: 13 | Train Loss: 0.295 Vali Loss: 40.080 Vali Acc: 0.480 Test Loss: 40.080 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 4.7657575607299805
Epoch: 35, Steps: 13 | Train Loss: 0.929 Vali Loss: 29.318 Vali Acc: 0.580 Test Loss: 29.318 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 4.719868421554565
Epoch: 36, Steps: 13 | Train Loss: 0.350 Vali Loss: 28.989 Vali Acc: 0.580 Test Loss: 28.989 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 4.750407695770264
Epoch: 37, Steps: 13 | Train Loss: 0.000 Vali Loss: 26.696 Vali Acc: 0.620 Test Loss: 26.696 Test Acc: 0.620
Validation loss decreased (-0.619706 --> -0.619733).  Saving model ...
Epoch: 38 cost time: 4.572290897369385
Epoch: 38, Steps: 13 | Train Loss: 0.000 Vali Loss: 25.467 Vali Acc: 0.660 Test Loss: 25.467 Test Acc: 0.660
Validation loss decreased (-0.619733 --> -0.659745).  Saving model ...
Epoch: 39 cost time: 4.548649549484253
Epoch: 39, Steps: 13 | Train Loss: 0.000 Vali Loss: 24.836 Vali Acc: 0.660 Test Loss: 24.836 Test Acc: 0.660
Validation loss decreased (-0.659745 --> -0.659752).  Saving model ...
Epoch: 40 cost time: 4.650523662567139
Epoch: 40, Steps: 13 | Train Loss: 0.000 Vali Loss: 24.563 Vali Acc: 0.660 Test Loss: 24.563 Test Acc: 0.660
Validation loss decreased (-0.659752 --> -0.659754).  Saving model ...
Epoch: 41 cost time: 4.728999137878418
Epoch: 41, Steps: 13 | Train Loss: 0.000 Vali Loss: 24.491 Vali Acc: 0.660 Test Loss: 24.491 Test Acc: 0.660
Validation loss decreased (-0.659754 --> -0.659755).  Saving model ...
Epoch: 42 cost time: 5.030095815658569
Epoch: 42, Steps: 13 | Train Loss: 0.000 Vali Loss: 24.472 Vali Acc: 0.660 Test Loss: 24.472 Test Acc: 0.660
Validation loss decreased (-0.659755 --> -0.659755).  Saving model ...
Epoch: 43 cost time: 5.269394397735596
Epoch: 43, Steps: 13 | Train Loss: 0.000 Vali Loss: 24.467 Vali Acc: 0.660 Test Loss: 24.467 Test Acc: 0.660
Validation loss decreased (-0.659755 --> -0.659755).  Saving model ...
Epoch: 44 cost time: 4.778437614440918
Epoch: 44, Steps: 13 | Train Loss: 0.000 Vali Loss: 24.466 Vali Acc: 0.660 Test Loss: 24.466 Test Acc: 0.660
Validation loss decreased (-0.659755 --> -0.659755).  Saving model ...
Epoch: 45 cost time: 4.897124528884888
Epoch: 45, Steps: 13 | Train Loss: 0.000 Vali Loss: 24.466 Vali Acc: 0.660 Test Loss: 24.466 Test Acc: 0.660
Validation loss decreased (-0.659755 --> -0.659755).  Saving model ...
Epoch: 46 cost time: 5.12000584602356
Epoch: 46, Steps: 13 | Train Loss: 0.000 Vali Loss: 24.466 Vali Acc: 0.660 Test Loss: 24.466 Test Acc: 0.660
Validation loss decreased (-0.659755 --> -0.659755).  Saving model ...
Epoch: 47 cost time: 5.050585508346558
Epoch: 47, Steps: 13 | Train Loss: 0.000 Vali Loss: 24.466 Vali Acc: 0.660 Test Loss: 24.466 Test Acc: 0.660
Validation loss decreased (-0.659755 --> -0.659755).  Saving model ...
Epoch: 48 cost time: 5.3431947231292725
Epoch: 48, Steps: 13 | Train Loss: 0.000 Vali Loss: 24.466 Vali Acc: 0.660 Test Loss: 24.466 Test Acc: 0.660
Validation loss decreased (-0.659755 --> -0.659755).  Saving model ...
Epoch: 49 cost time: 5.083406686782837
Epoch: 49, Steps: 13 | Train Loss: 0.000 Vali Loss: 24.466 Vali Acc: 0.660 Test Loss: 24.466 Test Acc: 0.660
Validation loss decreased (-0.659755 --> -0.659755).  Saving model ...
Epoch: 50 cost time: 4.704278469085693
Epoch: 50, Steps: 13 | Train Loss: 0.000 Vali Loss: 24.466 Vali Acc: 0.660 Test Loss: 24.466 Test Acc: 0.660
Validation loss decreased (-0.659755 --> -0.659755).  Saving model ...
Epoch: 51 cost time: 4.572190284729004
Epoch: 51, Steps: 13 | Train Loss: 0.000 Vali Loss: 24.466 Vali Acc: 0.660 Test Loss: 24.466 Test Acc: 0.660
Validation loss decreased (-0.659755 --> -0.659755).  Saving model ...
Epoch: 52 cost time: 4.978664398193359
Epoch: 52, Steps: 13 | Train Loss: 0.000 Vali Loss: 24.466 Vali Acc: 0.660 Test Loss: 24.466 Test Acc: 0.660
Validation loss decreased (-0.659755 --> -0.659755).  Saving model ...
Epoch: 53 cost time: 4.868361949920654
Epoch: 53, Steps: 13 | Train Loss: 0.000 Vali Loss: 24.466 Vali Acc: 0.660 Test Loss: 24.466 Test Acc: 0.660
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 4.63470983505249
Epoch: 54, Steps: 13 | Train Loss: 0.000 Vali Loss: 24.466 Vali Acc: 0.660 Test Loss: 24.466 Test Acc: 0.660
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 4.821838140487671
Epoch: 55, Steps: 13 | Train Loss: 0.000 Vali Loss: 24.466 Vali Acc: 0.660 Test Loss: 24.466 Test Acc: 0.660
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 4.760864019393921
Epoch: 56, Steps: 13 | Train Loss: 0.000 Vali Loss: 24.466 Vali Acc: 0.660 Test Loss: 24.466 Test Acc: 0.660
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 4.887303352355957
Epoch: 57, Steps: 13 | Train Loss: 0.000 Vali Loss: 24.466 Vali Acc: 0.660 Test Loss: 24.466 Test Acc: 0.660
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 4.593098402023315
Epoch: 58, Steps: 13 | Train Loss: 0.000 Vali Loss: 24.466 Vali Acc: 0.660 Test Loss: 24.466 Test Acc: 0.660
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 4.79528546333313
Epoch: 59, Steps: 13 | Train Loss: 0.000 Vali Loss: 24.466 Vali Acc: 0.660 Test Loss: 24.466 Test Acc: 0.660
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 4.521681070327759
Epoch: 60, Steps: 13 | Train Loss: 0.000 Vali Loss: 24.466 Vali Acc: 0.660 Test Loss: 24.466 Test Acc: 0.660
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 4.796537399291992
Epoch: 61, Steps: 13 | Train Loss: 0.000 Vali Loss: 24.466 Vali Acc: 0.660 Test Loss: 24.466 Test Acc: 0.660
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 4.998879909515381
Epoch: 62, Steps: 13 | Train Loss: 0.000 Vali Loss: 24.466 Vali Acc: 0.660 Test Loss: 24.466 Test Acc: 0.660
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.66
model parameter : 9553601
model size : 39.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 6.856658697128296
Epoch: 1, Steps: 13 | Train Loss: 3.784 Vali Loss: 6.561 Vali Acc: 0.200 Test Loss: 6.561 Test Acc: 0.200
Validation loss decreased (inf --> -0.199934).  Saving model ...
Epoch: 2 cost time: 4.507731199264526
Epoch: 2, Steps: 13 | Train Loss: 10.376 Vali Loss: 10.153 Vali Acc: 0.240 Test Loss: 10.153 Test Acc: 0.240
Validation loss decreased (-0.199934 --> -0.239898).  Saving model ...
Epoch: 3 cost time: 4.747782230377197
Epoch: 3, Steps: 13 | Train Loss: 5.418 Vali Loss: 12.773 Vali Acc: 0.320 Test Loss: 12.773 Test Acc: 0.320
Validation loss decreased (-0.239898 --> -0.319872).  Saving model ...
Epoch: 4 cost time: 4.407012701034546
Epoch: 4, Steps: 13 | Train Loss: 10.055 Vali Loss: 12.931 Vali Acc: 0.480 Test Loss: 12.931 Test Acc: 0.480
Validation loss decreased (-0.319872 --> -0.479871).  Saving model ...
Epoch: 5 cost time: 4.456265687942505
Epoch: 5, Steps: 13 | Train Loss: 16.178 Vali Loss: 9.728 Vali Acc: 0.420 Test Loss: 9.728 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.84432053565979
Epoch: 6, Steps: 13 | Train Loss: 11.935 Vali Loss: 12.796 Vali Acc: 0.400 Test Loss: 12.796 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.7302069664001465
Epoch: 7, Steps: 13 | Train Loss: 8.254 Vali Loss: 14.190 Vali Acc: 0.440 Test Loss: 14.190 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.840387344360352
Epoch: 8, Steps: 13 | Train Loss: 7.724 Vali Loss: 24.150 Vali Acc: 0.500 Test Loss: 24.150 Test Acc: 0.500
Validation loss decreased (-0.479871 --> -0.499759).  Saving model ...
Epoch: 9 cost time: 4.517374038696289
Epoch: 9, Steps: 13 | Train Loss: 13.112 Vali Loss: 22.139 Vali Acc: 0.520 Test Loss: 22.139 Test Acc: 0.520
Validation loss decreased (-0.499759 --> -0.519779).  Saving model ...
Epoch: 10 cost time: 4.670422792434692
Epoch: 10, Steps: 13 | Train Loss: 10.567 Vali Loss: 30.456 Vali Acc: 0.500 Test Loss: 30.456 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.703014135360718
Epoch: 11, Steps: 13 | Train Loss: 8.541 Vali Loss: 26.944 Vali Acc: 0.460 Test Loss: 26.944 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.6914825439453125
Epoch: 12, Steps: 13 | Train Loss: 7.165 Vali Loss: 29.388 Vali Acc: 0.380 Test Loss: 29.388 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.468633651733398
Epoch: 13, Steps: 13 | Train Loss: 6.995 Vali Loss: 25.978 Vali Acc: 0.420 Test Loss: 25.978 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.821411609649658
Epoch: 14, Steps: 13 | Train Loss: 3.727 Vali Loss: 29.821 Vali Acc: 0.480 Test Loss: 29.821 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.739209175109863
Epoch: 15, Steps: 13 | Train Loss: 1.642 Vali Loss: 25.809 Vali Acc: 0.520 Test Loss: 25.809 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.868818044662476
Epoch: 16, Steps: 13 | Train Loss: 6.180 Vali Loss: 42.076 Vali Acc: 0.500 Test Loss: 42.076 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.7290239334106445
Epoch: 17, Steps: 13 | Train Loss: 12.663 Vali Loss: 32.408 Vali Acc: 0.560 Test Loss: 32.408 Test Acc: 0.560
Validation loss decreased (-0.519779 --> -0.559676).  Saving model ...
Epoch: 18 cost time: 4.866165399551392
Epoch: 18, Steps: 13 | Train Loss: 1.705 Vali Loss: 27.763 Vali Acc: 0.540 Test Loss: 27.763 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.793963670730591
Epoch: 19, Steps: 13 | Train Loss: 7.142 Vali Loss: 23.779 Vali Acc: 0.580 Test Loss: 23.779 Test Acc: 0.580
Validation loss decreased (-0.559676 --> -0.579762).  Saving model ...
Epoch: 20 cost time: 4.5536863803863525
Epoch: 20, Steps: 13 | Train Loss: 1.313 Vali Loss: 37.197 Vali Acc: 0.400 Test Loss: 37.197 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.5559680461883545
Epoch: 21, Steps: 13 | Train Loss: 2.773 Vali Loss: 27.697 Vali Acc: 0.580 Test Loss: 27.697 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.4846765995025635
Epoch: 22, Steps: 13 | Train Loss: 5.521 Vali Loss: 40.893 Vali Acc: 0.500 Test Loss: 40.893 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.750531435012817
Epoch: 23, Steps: 13 | Train Loss: 4.107 Vali Loss: 47.177 Vali Acc: 0.440 Test Loss: 47.177 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 4.560251474380493
Epoch: 24, Steps: 13 | Train Loss: 3.773 Vali Loss: 51.485 Vali Acc: 0.360 Test Loss: 51.485 Test Acc: 0.360
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 4.449332237243652
Epoch: 25, Steps: 13 | Train Loss: 10.910 Vali Loss: 42.126 Vali Acc: 0.460 Test Loss: 42.126 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 4.634117126464844
Epoch: 26, Steps: 13 | Train Loss: 1.359 Vali Loss: 45.002 Vali Acc: 0.540 Test Loss: 45.002 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 4.552121162414551
Epoch: 27, Steps: 13 | Train Loss: 1.719 Vali Loss: 33.854 Vali Acc: 0.600 Test Loss: 33.854 Test Acc: 0.600
Validation loss decreased (-0.579762 --> -0.599661).  Saving model ...
Epoch: 28 cost time: 4.422396898269653
Epoch: 28, Steps: 13 | Train Loss: 2.059 Vali Loss: 37.050 Vali Acc: 0.600 Test Loss: 37.050 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 4.757614850997925
Epoch: 29, Steps: 13 | Train Loss: 0.708 Vali Loss: 30.284 Vali Acc: 0.580 Test Loss: 30.284 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 4.476713180541992
Epoch: 30, Steps: 13 | Train Loss: 1.906 Vali Loss: 37.627 Vali Acc: 0.580 Test Loss: 37.627 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 4.876617431640625
Epoch: 31, Steps: 13 | Train Loss: 1.186 Vali Loss: 40.470 Vali Acc: 0.520 Test Loss: 40.470 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 4.6425557136535645
Epoch: 32, Steps: 13 | Train Loss: 0.738 Vali Loss: 43.942 Vali Acc: 0.440 Test Loss: 43.942 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 5.084774732589722
Epoch: 33, Steps: 13 | Train Loss: 0.000 Vali Loss: 50.504 Vali Acc: 0.460 Test Loss: 50.504 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 4.841449022293091
Epoch: 34, Steps: 13 | Train Loss: 0.081 Vali Loss: 48.172 Vali Acc: 0.520 Test Loss: 48.172 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 4.505905866622925
Epoch: 35, Steps: 13 | Train Loss: 0.088 Vali Loss: 33.284 Vali Acc: 0.600 Test Loss: 33.284 Test Acc: 0.600
Validation loss decreased (-0.599661 --> -0.599667).  Saving model ...
Epoch: 36 cost time: 4.379271745681763
Epoch: 36, Steps: 13 | Train Loss: 0.000 Vali Loss: 34.889 Vali Acc: 0.560 Test Loss: 34.889 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 4.676777124404907
Epoch: 37, Steps: 13 | Train Loss: 0.000 Vali Loss: 35.710 Vali Acc: 0.560 Test Loss: 35.710 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 5.015510082244873
Epoch: 38, Steps: 13 | Train Loss: 0.000 Vali Loss: 35.954 Vali Acc: 0.560 Test Loss: 35.954 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 4.743479490280151
Epoch: 39, Steps: 13 | Train Loss: 0.000 Vali Loss: 36.019 Vali Acc: 0.560 Test Loss: 36.019 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 4.513798236846924
Epoch: 40, Steps: 13 | Train Loss: 0.000 Vali Loss: 36.036 Vali Acc: 0.560 Test Loss: 36.036 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 4.629897356033325
Epoch: 41, Steps: 13 | Train Loss: 0.000 Vali Loss: 36.041 Vali Acc: 0.560 Test Loss: 36.041 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 4.736907005310059
Epoch: 42, Steps: 13 | Train Loss: 0.000 Vali Loss: 36.042 Vali Acc: 0.560 Test Loss: 36.042 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 4.71418309211731
Epoch: 43, Steps: 13 | Train Loss: 0.000 Vali Loss: 36.042 Vali Acc: 0.560 Test Loss: 36.042 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 4.372620344161987
Epoch: 44, Steps: 13 | Train Loss: 0.000 Vali Loss: 36.042 Vali Acc: 0.560 Test Loss: 36.042 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 4.712507009506226
Epoch: 45, Steps: 13 | Train Loss: 0.000 Vali Loss: 36.042 Vali Acc: 0.560 Test Loss: 36.042 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 9547969
model size : 39.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 7.4449450969696045
Epoch: 1, Steps: 13 | Train Loss: 4.250 Vali Loss: 5.081 Vali Acc: 0.360 Test Loss: 5.081 Test Acc: 0.360
Validation loss decreased (inf --> -0.359949).  Saving model ...
Epoch: 2 cost time: 4.486019134521484
Epoch: 2, Steps: 13 | Train Loss: 6.166 Vali Loss: 10.069 Vali Acc: 0.200 Test Loss: 10.069 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.653521299362183
Epoch: 3, Steps: 13 | Train Loss: 7.127 Vali Loss: 7.493 Vali Acc: 0.340 Test Loss: 7.493 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.684884786605835
Epoch: 4, Steps: 13 | Train Loss: 8.446 Vali Loss: 14.104 Vali Acc: 0.300 Test Loss: 14.104 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.061618328094482
Epoch: 5, Steps: 13 | Train Loss: 10.849 Vali Loss: 12.634 Vali Acc: 0.440 Test Loss: 12.634 Test Acc: 0.440
Validation loss decreased (-0.359949 --> -0.439874).  Saving model ...
Epoch: 6 cost time: 4.635638952255249
Epoch: 6, Steps: 13 | Train Loss: 13.652 Vali Loss: 18.319 Vali Acc: 0.400 Test Loss: 18.319 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.828949451446533
Epoch: 7, Steps: 13 | Train Loss: 6.868 Vali Loss: 13.238 Vali Acc: 0.500 Test Loss: 13.238 Test Acc: 0.500
Validation loss decreased (-0.439874 --> -0.499868).  Saving model ...
Epoch: 8 cost time: 4.821774005889893
Epoch: 8, Steps: 13 | Train Loss: 9.482 Vali Loss: 31.124 Vali Acc: 0.440 Test Loss: 31.124 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.712013006210327
Epoch: 9, Steps: 13 | Train Loss: 11.826 Vali Loss: 13.095 Vali Acc: 0.440 Test Loss: 13.095 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.544011354446411
Epoch: 10, Steps: 13 | Train Loss: 8.921 Vali Loss: 33.711 Vali Acc: 0.380 Test Loss: 33.711 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.850090503692627
Epoch: 11, Steps: 13 | Train Loss: 6.966 Vali Loss: 35.545 Vali Acc: 0.440 Test Loss: 35.545 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.948426246643066
Epoch: 12, Steps: 13 | Train Loss: 4.407 Vali Loss: 29.788 Vali Acc: 0.520 Test Loss: 29.788 Test Acc: 0.520
Validation loss decreased (-0.499868 --> -0.519702).  Saving model ...
Epoch: 13 cost time: 5.016166925430298
Epoch: 13, Steps: 13 | Train Loss: 3.334 Vali Loss: 23.846 Vali Acc: 0.500 Test Loss: 23.846 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.809504747390747
Epoch: 14, Steps: 13 | Train Loss: 2.312 Vali Loss: 40.400 Vali Acc: 0.460 Test Loss: 40.400 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.575445890426636
Epoch: 15, Steps: 13 | Train Loss: 7.880 Vali Loss: 39.815 Vali Acc: 0.460 Test Loss: 39.815 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.665063142776489
Epoch: 16, Steps: 13 | Train Loss: 4.522 Vali Loss: 40.429 Vali Acc: 0.420 Test Loss: 40.429 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.677890300750732
Epoch: 17, Steps: 13 | Train Loss: 5.388 Vali Loss: 36.613 Vali Acc: 0.460 Test Loss: 36.613 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.390508651733398
Epoch: 18, Steps: 13 | Train Loss: 8.385 Vali Loss: 29.618 Vali Acc: 0.340 Test Loss: 29.618 Test Acc: 0.340
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.428577661514282
Epoch: 19, Steps: 13 | Train Loss: 4.358 Vali Loss: 34.113 Vali Acc: 0.400 Test Loss: 34.113 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.451274394989014
Epoch: 20, Steps: 13 | Train Loss: 0.967 Vali Loss: 41.700 Vali Acc: 0.480 Test Loss: 41.700 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.42491340637207
Epoch: 21, Steps: 13 | Train Loss: 3.350 Vali Loss: 31.055 Vali Acc: 0.500 Test Loss: 31.055 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.612105846405029
Epoch: 22, Steps: 13 | Train Loss: 1.927 Vali Loss: 32.849 Vali Acc: 0.460 Test Loss: 32.849 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 9542337
model size : 39.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 6.8794872760772705
Epoch: 1, Steps: 13 | Train Loss: 4.165 Vali Loss: 8.633 Vali Acc: 0.180 Test Loss: 8.633 Test Acc: 0.180
Validation loss decreased (inf --> -0.179914).  Saving model ...
Epoch: 2 cost time: 4.44678521156311
Epoch: 2, Steps: 13 | Train Loss: 8.210 Vali Loss: 16.515 Vali Acc: 0.200 Test Loss: 16.515 Test Acc: 0.200
Validation loss decreased (-0.179914 --> -0.199835).  Saving model ...
Epoch: 3 cost time: 4.659898042678833
Epoch: 3, Steps: 13 | Train Loss: 11.793 Vali Loss: 9.105 Vali Acc: 0.360 Test Loss: 9.105 Test Acc: 0.360
Validation loss decreased (-0.199835 --> -0.359909).  Saving model ...
Epoch: 4 cost time: 4.552416801452637
Epoch: 4, Steps: 13 | Train Loss: 9.497 Vali Loss: 26.337 Vali Acc: 0.200 Test Loss: 26.337 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.334400177001953
Epoch: 5, Steps: 13 | Train Loss: 11.383 Vali Loss: 22.025 Vali Acc: 0.300 Test Loss: 22.025 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.914478063583374
Epoch: 6, Steps: 13 | Train Loss: 14.093 Vali Loss: 28.641 Vali Acc: 0.420 Test Loss: 28.641 Test Acc: 0.420
Validation loss decreased (-0.359909 --> -0.419714).  Saving model ...
Epoch: 7 cost time: 4.677974700927734
Epoch: 7, Steps: 13 | Train Loss: 11.869 Vali Loss: 24.978 Vali Acc: 0.400 Test Loss: 24.978 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.395142316818237
Epoch: 8, Steps: 13 | Train Loss: 13.230 Vali Loss: 20.613 Vali Acc: 0.460 Test Loss: 20.613 Test Acc: 0.460
Validation loss decreased (-0.419714 --> -0.459794).  Saving model ...
Epoch: 9 cost time: 4.474674463272095
Epoch: 9, Steps: 13 | Train Loss: 12.614 Vali Loss: 35.719 Vali Acc: 0.440 Test Loss: 35.719 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.601749897003174
Epoch: 10, Steps: 13 | Train Loss: 10.111 Vali Loss: 27.307 Vali Acc: 0.420 Test Loss: 27.307 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.518381118774414
Epoch: 11, Steps: 13 | Train Loss: 6.860 Vali Loss: 28.784 Vali Acc: 0.460 Test Loss: 28.784 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.487138032913208
Epoch: 12, Steps: 13 | Train Loss: 5.196 Vali Loss: 37.155 Vali Acc: 0.460 Test Loss: 37.155 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.295945882797241
Epoch: 13, Steps: 13 | Train Loss: 6.940 Vali Loss: 45.660 Vali Acc: 0.400 Test Loss: 45.660 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.365522146224976
Epoch: 14, Steps: 13 | Train Loss: 5.158 Vali Loss: 31.716 Vali Acc: 0.380 Test Loss: 31.716 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.684302806854248
Epoch: 15, Steps: 13 | Train Loss: 3.188 Vali Loss: 33.037 Vali Acc: 0.480 Test Loss: 33.037 Test Acc: 0.480
Validation loss decreased (-0.459794 --> -0.479670).  Saving model ...
Epoch: 16 cost time: 4.545161485671997
Epoch: 16, Steps: 13 | Train Loss: 10.093 Vali Loss: 41.538 Vali Acc: 0.460 Test Loss: 41.538 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.405653953552246
Epoch: 17, Steps: 13 | Train Loss: 12.790 Vali Loss: 42.687 Vali Acc: 0.440 Test Loss: 42.687 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.5685930252075195
Epoch: 18, Steps: 13 | Train Loss: 4.191 Vali Loss: 23.198 Vali Acc: 0.560 Test Loss: 23.198 Test Acc: 0.560
Validation loss decreased (-0.479670 --> -0.559768).  Saving model ...
Epoch: 19 cost time: 4.276068449020386
Epoch: 19, Steps: 13 | Train Loss: 4.699 Vali Loss: 42.785 Vali Acc: 0.480 Test Loss: 42.785 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.562352180480957
Epoch: 20, Steps: 13 | Train Loss: 2.944 Vali Loss: 38.650 Vali Acc: 0.580 Test Loss: 38.650 Test Acc: 0.580
Validation loss decreased (-0.559768 --> -0.579614).  Saving model ...
Epoch: 21 cost time: 4.372836589813232
Epoch: 21, Steps: 13 | Train Loss: 1.071 Vali Loss: 41.920 Vali Acc: 0.500 Test Loss: 41.920 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.220216989517212
Epoch: 22, Steps: 13 | Train Loss: 3.344 Vali Loss: 25.103 Vali Acc: 0.660 Test Loss: 25.103 Test Acc: 0.660
Validation loss decreased (-0.579614 --> -0.659749).  Saving model ...
Epoch: 23 cost time: 4.290507555007935
Epoch: 23, Steps: 13 | Train Loss: 1.073 Vali Loss: 46.559 Vali Acc: 0.560 Test Loss: 46.559 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.447197437286377
Epoch: 24, Steps: 13 | Train Loss: 1.399 Vali Loss: 49.768 Vali Acc: 0.500 Test Loss: 49.768 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.689565420150757
Epoch: 25, Steps: 13 | Train Loss: 3.448 Vali Loss: 48.765 Vali Acc: 0.480 Test Loss: 48.765 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 4.5401928424835205
Epoch: 26, Steps: 13 | Train Loss: 2.746 Vali Loss: 42.771 Vali Acc: 0.580 Test Loss: 42.771 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 4.184752941131592
Epoch: 27, Steps: 13 | Train Loss: 1.577 Vali Loss: 63.874 Vali Acc: 0.540 Test Loss: 63.874 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 4.592352390289307
Epoch: 28, Steps: 13 | Train Loss: 0.799 Vali Loss: 45.364 Vali Acc: 0.620 Test Loss: 45.364 Test Acc: 0.620
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 4.557816505432129
Epoch: 29, Steps: 13 | Train Loss: 1.486 Vali Loss: 51.943 Vali Acc: 0.520 Test Loss: 51.943 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 4.40132999420166
Epoch: 30, Steps: 13 | Train Loss: 4.360 Vali Loss: 35.887 Vali Acc: 0.560 Test Loss: 35.887 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 4.687544822692871
Epoch: 31, Steps: 13 | Train Loss: 2.847 Vali Loss: 52.041 Vali Acc: 0.480 Test Loss: 52.041 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 4.470505714416504
Epoch: 32, Steps: 13 | Train Loss: 0.646 Vali Loss: 48.380 Vali Acc: 0.480 Test Loss: 48.380 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.66
model parameter : 9263169
model size : 37.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 7.571941137313843
Epoch: 1, Steps: 13 | Train Loss: 6.091 Vali Loss: 13.496 Vali Acc: 0.200 Test Loss: 13.496 Test Acc: 0.200
Validation loss decreased (inf --> -0.199865).  Saving model ...
Epoch: 2 cost time: 4.826080799102783
Epoch: 2, Steps: 13 | Train Loss: 11.654 Vali Loss: 7.003 Vali Acc: 0.340 Test Loss: 7.003 Test Acc: 0.340
Validation loss decreased (-0.199865 --> -0.339930).  Saving model ...
Epoch: 3 cost time: 5.067131996154785
Epoch: 3, Steps: 13 | Train Loss: 11.207 Vali Loss: 7.446 Vali Acc: 0.420 Test Loss: 7.446 Test Acc: 0.420
Validation loss decreased (-0.339930 --> -0.419926).  Saving model ...
Epoch: 4 cost time: 4.582172155380249
Epoch: 4, Steps: 13 | Train Loss: 7.453 Vali Loss: 13.240 Vali Acc: 0.400 Test Loss: 13.240 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.566918134689331
Epoch: 5, Steps: 13 | Train Loss: 17.395 Vali Loss: 13.842 Vali Acc: 0.420 Test Loss: 13.842 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.068774223327637
Epoch: 6, Steps: 13 | Train Loss: 15.579 Vali Loss: 21.053 Vali Acc: 0.340 Test Loss: 21.053 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.90086030960083
Epoch: 7, Steps: 13 | Train Loss: 12.634 Vali Loss: 21.278 Vali Acc: 0.380 Test Loss: 21.278 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.724073886871338
Epoch: 8, Steps: 13 | Train Loss: 5.539 Vali Loss: 14.641 Vali Acc: 0.560 Test Loss: 14.641 Test Acc: 0.560
Validation loss decreased (-0.419926 --> -0.559854).  Saving model ...
Epoch: 9 cost time: 4.758831977844238
Epoch: 9, Steps: 13 | Train Loss: 6.022 Vali Loss: 16.106 Vali Acc: 0.540 Test Loss: 16.106 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.80796217918396
Epoch: 10, Steps: 13 | Train Loss: 3.279 Vali Loss: 21.274 Vali Acc: 0.400 Test Loss: 21.274 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.707864761352539
Epoch: 11, Steps: 13 | Train Loss: 3.571 Vali Loss: 30.307 Vali Acc: 0.440 Test Loss: 30.307 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.807482004165649
Epoch: 12, Steps: 13 | Train Loss: 4.831 Vali Loss: 44.540 Vali Acc: 0.300 Test Loss: 44.540 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.928483247756958
Epoch: 13, Steps: 13 | Train Loss: 10.696 Vali Loss: 36.778 Vali Acc: 0.400 Test Loss: 36.778 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.756333351135254
Epoch: 14, Steps: 13 | Train Loss: 5.863 Vali Loss: 32.575 Vali Acc: 0.460 Test Loss: 32.575 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.517267465591431
Epoch: 15, Steps: 13 | Train Loss: 5.753 Vali Loss: 55.828 Vali Acc: 0.480 Test Loss: 55.828 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.148351669311523
Epoch: 16, Steps: 13 | Train Loss: 7.911 Vali Loss: 30.708 Vali Acc: 0.420 Test Loss: 30.708 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.523658752441406
Epoch: 17, Steps: 13 | Train Loss: 0.302 Vali Loss: 39.242 Vali Acc: 0.420 Test Loss: 39.242 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.743361711502075
Epoch: 18, Steps: 13 | Train Loss: 0.669 Vali Loss: 37.586 Vali Acc: 0.500 Test Loss: 37.586 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 9257537
model size : 37.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 6.926364898681641
Epoch: 1, Steps: 13 | Train Loss: 3.050 Vali Loss: 10.267 Vali Acc: 0.300 Test Loss: 10.267 Test Acc: 0.300
Validation loss decreased (inf --> -0.299897).  Saving model ...
Epoch: 2 cost time: 4.24053430557251
Epoch: 2, Steps: 13 | Train Loss: 14.781 Vali Loss: 13.710 Vali Acc: 0.320 Test Loss: 13.710 Test Acc: 0.320
Validation loss decreased (-0.299897 --> -0.319863).  Saving model ...
Epoch: 3 cost time: 4.33876633644104
Epoch: 3, Steps: 13 | Train Loss: 15.141 Vali Loss: 23.203 Vali Acc: 0.300 Test Loss: 23.203 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.3626344203948975
Epoch: 4, Steps: 13 | Train Loss: 16.368 Vali Loss: 15.065 Vali Acc: 0.360 Test Loss: 15.065 Test Acc: 0.360
Validation loss decreased (-0.319863 --> -0.359849).  Saving model ...
Epoch: 5 cost time: 4.467116117477417
Epoch: 5, Steps: 13 | Train Loss: 9.223 Vali Loss: 12.317 Vali Acc: 0.420 Test Loss: 12.317 Test Acc: 0.420
Validation loss decreased (-0.359849 --> -0.419877).  Saving model ...
Epoch: 6 cost time: 4.319019556045532
Epoch: 6, Steps: 13 | Train Loss: 7.187 Vali Loss: 13.957 Vali Acc: 0.380 Test Loss: 13.957 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.250619411468506
Epoch: 7, Steps: 13 | Train Loss: 9.492 Vali Loss: 20.322 Vali Acc: 0.440 Test Loss: 20.322 Test Acc: 0.440
Validation loss decreased (-0.419877 --> -0.439797).  Saving model ...
Epoch: 8 cost time: 4.448853492736816
Epoch: 8, Steps: 13 | Train Loss: 13.262 Vali Loss: 42.247 Vali Acc: 0.380 Test Loss: 42.247 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.226303577423096
Epoch: 9, Steps: 13 | Train Loss: 8.627 Vali Loss: 29.822 Vali Acc: 0.380 Test Loss: 29.822 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.456345319747925
Epoch: 10, Steps: 13 | Train Loss: 12.000 Vali Loss: 27.580 Vali Acc: 0.540 Test Loss: 27.580 Test Acc: 0.540
Validation loss decreased (-0.439797 --> -0.539724).  Saving model ...
Epoch: 11 cost time: 4.132664918899536
Epoch: 11, Steps: 13 | Train Loss: 8.641 Vali Loss: 27.064 Vali Acc: 0.480 Test Loss: 27.064 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.277698993682861
Epoch: 12, Steps: 13 | Train Loss: 10.308 Vali Loss: 33.126 Vali Acc: 0.460 Test Loss: 33.126 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.233901023864746
Epoch: 13, Steps: 13 | Train Loss: 12.871 Vali Loss: 22.500 Vali Acc: 0.520 Test Loss: 22.500 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.373258590698242
Epoch: 14, Steps: 13 | Train Loss: 2.304 Vali Loss: 29.182 Vali Acc: 0.500 Test Loss: 29.182 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.273418188095093
Epoch: 15, Steps: 13 | Train Loss: 5.014 Vali Loss: 31.131 Vali Acc: 0.500 Test Loss: 31.131 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.543132781982422
Epoch: 16, Steps: 13 | Train Loss: 3.253 Vali Loss: 39.460 Vali Acc: 0.500 Test Loss: 39.460 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.314877033233643
Epoch: 17, Steps: 13 | Train Loss: 5.103 Vali Loss: 39.583 Vali Acc: 0.400 Test Loss: 39.583 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.4135401248931885
Epoch: 18, Steps: 13 | Train Loss: 4.672 Vali Loss: 43.088 Vali Acc: 0.500 Test Loss: 43.088 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.263597726821899
Epoch: 19, Steps: 13 | Train Loss: 3.606 Vali Loss: 34.939 Vali Acc: 0.520 Test Loss: 34.939 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.312300682067871
Epoch: 20, Steps: 13 | Train Loss: 4.986 Vali Loss: 33.803 Vali Acc: 0.520 Test Loss: 33.803 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 9251905
model size : 37.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 7.389451265335083
Epoch: 1, Steps: 13 | Train Loss: 5.358 Vali Loss: 9.522 Vali Acc: 0.200 Test Loss: 9.522 Test Acc: 0.200
Validation loss decreased (inf --> -0.199905).  Saving model ...
Epoch: 2 cost time: 4.4320032596588135
Epoch: 2, Steps: 13 | Train Loss: 8.693 Vali Loss: 16.106 Vali Acc: 0.240 Test Loss: 16.106 Test Acc: 0.240
Validation loss decreased (-0.199905 --> -0.239839).  Saving model ...
Epoch: 3 cost time: 4.3883583545684814
Epoch: 3, Steps: 13 | Train Loss: 14.201 Vali Loss: 20.640 Vali Acc: 0.200 Test Loss: 20.640 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.829150676727295
Epoch: 4, Steps: 13 | Train Loss: 13.602 Vali Loss: 15.967 Vali Acc: 0.360 Test Loss: 15.967 Test Acc: 0.360
Validation loss decreased (-0.239839 --> -0.359840).  Saving model ...
Epoch: 5 cost time: 4.361272811889648
Epoch: 5, Steps: 13 | Train Loss: 8.410 Vali Loss: 14.004 Vali Acc: 0.440 Test Loss: 14.004 Test Acc: 0.440
Validation loss decreased (-0.359840 --> -0.439860).  Saving model ...
Epoch: 6 cost time: 4.572810888290405
Epoch: 6, Steps: 13 | Train Loss: 10.331 Vali Loss: 32.704 Vali Acc: 0.320 Test Loss: 32.704 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.317187547683716
Epoch: 7, Steps: 13 | Train Loss: 9.413 Vali Loss: 37.133 Vali Acc: 0.300 Test Loss: 37.133 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.491427421569824
Epoch: 8, Steps: 13 | Train Loss: 15.997 Vali Loss: 17.929 Vali Acc: 0.440 Test Loss: 17.929 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.521508693695068
Epoch: 9, Steps: 13 | Train Loss: 11.718 Vali Loss: 19.012 Vali Acc: 0.520 Test Loss: 19.012 Test Acc: 0.520
Validation loss decreased (-0.439860 --> -0.519810).  Saving model ...
Epoch: 10 cost time: 4.685703992843628
Epoch: 10, Steps: 13 | Train Loss: 5.065 Vali Loss: 16.740 Vali Acc: 0.520 Test Loss: 16.740 Test Acc: 0.520
Validation loss decreased (-0.519810 --> -0.519833).  Saving model ...
Epoch: 11 cost time: 4.449742794036865
Epoch: 11, Steps: 13 | Train Loss: 5.374 Vali Loss: 37.582 Vali Acc: 0.380 Test Loss: 37.582 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.455753326416016
Epoch: 12, Steps: 13 | Train Loss: 5.747 Vali Loss: 23.372 Vali Acc: 0.460 Test Loss: 23.372 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.6052916049957275
Epoch: 13, Steps: 13 | Train Loss: 4.685 Vali Loss: 35.504 Vali Acc: 0.440 Test Loss: 35.504 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.635900974273682
Epoch: 14, Steps: 13 | Train Loss: 6.755 Vali Loss: 42.204 Vali Acc: 0.420 Test Loss: 42.204 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.2476842403411865
Epoch: 15, Steps: 13 | Train Loss: 4.373 Vali Loss: 24.160 Vali Acc: 0.480 Test Loss: 24.160 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.4956138134002686
Epoch: 16, Steps: 13 | Train Loss: 2.405 Vali Loss: 37.816 Vali Acc: 0.440 Test Loss: 37.816 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.339264869689941
Epoch: 17, Steps: 13 | Train Loss: 3.822 Vali Loss: 40.406 Vali Acc: 0.440 Test Loss: 40.406 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.287289381027222
Epoch: 18, Steps: 13 | Train Loss: 6.742 Vali Loss: 25.714 Vali Acc: 0.540 Test Loss: 25.714 Test Acc: 0.540
Validation loss decreased (-0.519833 --> -0.539743).  Saving model ...
Epoch: 19 cost time: 4.304339647293091
Epoch: 19, Steps: 13 | Train Loss: 8.252 Vali Loss: 23.577 Vali Acc: 0.540 Test Loss: 23.577 Test Acc: 0.540
Validation loss decreased (-0.539743 --> -0.539764).  Saving model ...
Epoch: 20 cost time: 4.6078197956085205
Epoch: 20, Steps: 13 | Train Loss: 1.890 Vali Loss: 30.204 Vali Acc: 0.480 Test Loss: 30.204 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.365648508071899
Epoch: 21, Steps: 13 | Train Loss: 4.569 Vali Loss: 26.394 Vali Acc: 0.520 Test Loss: 26.394 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.411296844482422
Epoch: 22, Steps: 13 | Train Loss: 2.094 Vali Loss: 29.369 Vali Acc: 0.460 Test Loss: 29.369 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.681514024734497
Epoch: 23, Steps: 13 | Train Loss: 1.139 Vali Loss: 33.242 Vali Acc: 0.460 Test Loss: 33.242 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 4.4525251388549805
Epoch: 24, Steps: 13 | Train Loss: 1.595 Vali Loss: 44.248 Vali Acc: 0.420 Test Loss: 44.248 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 4.308784246444702
Epoch: 25, Steps: 13 | Train Loss: 0.681 Vali Loss: 34.953 Vali Acc: 0.600 Test Loss: 34.953 Test Acc: 0.600
Validation loss decreased (-0.539764 --> -0.599650).  Saving model ...
Epoch: 26 cost time: 4.587163925170898
Epoch: 26, Steps: 13 | Train Loss: 2.356 Vali Loss: 29.888 Vali Acc: 0.560 Test Loss: 29.888 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.581347942352295
Epoch: 27, Steps: 13 | Train Loss: 2.105 Vali Loss: 32.774 Vali Acc: 0.540 Test Loss: 32.774 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 4.157212257385254
Epoch: 28, Steps: 13 | Train Loss: 7.912 Vali Loss: 28.158 Vali Acc: 0.440 Test Loss: 28.158 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 4.331402063369751
Epoch: 29, Steps: 13 | Train Loss: 0.120 Vali Loss: 32.446 Vali Acc: 0.560 Test Loss: 32.446 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 4.626974821090698
Epoch: 30, Steps: 13 | Train Loss: 2.627 Vali Loss: 28.919 Vali Acc: 0.560 Test Loss: 28.919 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 4.4915900230407715
Epoch: 31, Steps: 13 | Train Loss: 0.573 Vali Loss: 23.281 Vali Acc: 0.600 Test Loss: 23.281 Test Acc: 0.600
Validation loss decreased (-0.599650 --> -0.599767).  Saving model ...
Epoch: 32 cost time: 4.30612850189209
Epoch: 32, Steps: 13 | Train Loss: 3.017 Vali Loss: 41.688 Vali Acc: 0.540 Test Loss: 41.688 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 4.643738746643066
Epoch: 33, Steps: 13 | Train Loss: 8.261 Vali Loss: 38.126 Vali Acc: 0.500 Test Loss: 38.126 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 4.4527857303619385
Epoch: 34, Steps: 13 | Train Loss: 9.796 Vali Loss: 38.062 Vali Acc: 0.580 Test Loss: 38.062 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 4.246766805648804
Epoch: 35, Steps: 13 | Train Loss: 0.450 Vali Loss: 40.078 Vali Acc: 0.640 Test Loss: 40.078 Test Acc: 0.640
Validation loss decreased (-0.599767 --> -0.639599).  Saving model ...
Epoch: 36 cost time: 4.352854013442993
Epoch: 36, Steps: 13 | Train Loss: 0.000 Vali Loss: 45.924 Vali Acc: 0.580 Test Loss: 45.924 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 4.482106447219849
Epoch: 37, Steps: 13 | Train Loss: 1.728 Vali Loss: 43.087 Vali Acc: 0.560 Test Loss: 43.087 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 4.332008361816406
Epoch: 38, Steps: 13 | Train Loss: 0.975 Vali Loss: 64.486 Vali Acc: 0.480 Test Loss: 64.486 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 4.521513938903809
Epoch: 39, Steps: 13 | Train Loss: 1.977 Vali Loss: 52.246 Vali Acc: 0.540 Test Loss: 52.246 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 4.701201677322388
Epoch: 40, Steps: 13 | Train Loss: 0.769 Vali Loss: 41.608 Vali Acc: 0.520 Test Loss: 41.608 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 4.73534893989563
Epoch: 41, Steps: 13 | Train Loss: 0.000 Vali Loss: 40.967 Vali Acc: 0.520 Test Loss: 40.967 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 4.767115116119385
Epoch: 42, Steps: 13 | Train Loss: 1.073 Vali Loss: 44.993 Vali Acc: 0.500 Test Loss: 44.993 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 4.462493658065796
Epoch: 43, Steps: 13 | Train Loss: 0.863 Vali Loss: 59.427 Vali Acc: 0.480 Test Loss: 59.427 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 4.429603338241577
Epoch: 44, Steps: 13 | Train Loss: 0.161 Vali Loss: 61.076 Vali Acc: 0.440 Test Loss: 61.076 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 4.6081976890563965
Epoch: 45, Steps: 13 | Train Loss: 1.575 Vali Loss: 29.381 Vali Acc: 0.680 Test Loss: 29.381 Test Acc: 0.680
Validation loss decreased (-0.639599 --> -0.679706).  Saving model ...
Epoch: 46 cost time: 4.497404098510742
Epoch: 46, Steps: 13 | Train Loss: 2.497 Vali Loss: 34.002 Vali Acc: 0.580 Test Loss: 34.002 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 4.428710460662842
Epoch: 47, Steps: 13 | Train Loss: 7.775 Vali Loss: 47.526 Vali Acc: 0.520 Test Loss: 47.526 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 4.326025009155273
Epoch: 48, Steps: 13 | Train Loss: 1.551 Vali Loss: 49.193 Vali Acc: 0.500 Test Loss: 49.193 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 4.441033840179443
Epoch: 49, Steps: 13 | Train Loss: 3.107 Vali Loss: 76.061 Vali Acc: 0.400 Test Loss: 76.061 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 4.38827657699585
Epoch: 50, Steps: 13 | Train Loss: 4.788 Vali Loss: 45.344 Vali Acc: 0.520 Test Loss: 45.344 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 4.606979608535767
Epoch: 51, Steps: 13 | Train Loss: 0.580 Vali Loss: 48.364 Vali Acc: 0.540 Test Loss: 48.364 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 4.461822032928467
Epoch: 52, Steps: 13 | Train Loss: 0.000 Vali Loss: 55.102 Vali Acc: 0.580 Test Loss: 55.102 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 4.3095862865448
Epoch: 53, Steps: 13 | Train Loss: 0.000 Vali Loss: 55.422 Vali Acc: 0.540 Test Loss: 55.422 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 4.521815299987793
Epoch: 54, Steps: 13 | Train Loss: 7.107 Vali Loss: 45.548 Vali Acc: 0.620 Test Loss: 45.548 Test Acc: 0.620
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 4.466630220413208
Epoch: 55, Steps: 13 | Train Loss: 1.867 Vali Loss: 41.080 Vali Acc: 0.560 Test Loss: 41.080 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.68
model parameter : 9246273
model size : 37.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 6.187244892120361
Epoch: 1, Steps: 13 | Train Loss: 3.166 Vali Loss: 4.607 Vali Acc: 0.200 Test Loss: 4.607 Test Acc: 0.200
Validation loss decreased (inf --> -0.199954).  Saving model ...
Epoch: 2 cost time: 3.996732234954834
Epoch: 2, Steps: 13 | Train Loss: 2.929 Vali Loss: 5.598 Vali Acc: 0.260 Test Loss: 5.598 Test Acc: 0.260
Validation loss decreased (-0.199954 --> -0.259944).  Saving model ...
Epoch: 3 cost time: 4.077373266220093
Epoch: 3, Steps: 13 | Train Loss: 5.402 Vali Loss: 5.793 Vali Acc: 0.420 Test Loss: 5.793 Test Acc: 0.420
Validation loss decreased (-0.259944 --> -0.419942).  Saving model ...
Epoch: 4 cost time: 4.163074970245361
Epoch: 4, Steps: 13 | Train Loss: 4.648 Vali Loss: 4.776 Vali Acc: 0.540 Test Loss: 4.776 Test Acc: 0.540
Validation loss decreased (-0.419942 --> -0.539952).  Saving model ...
Epoch: 5 cost time: 4.100705862045288
Epoch: 5, Steps: 13 | Train Loss: 2.979 Vali Loss: 6.774 Vali Acc: 0.500 Test Loss: 6.774 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.065573692321777
Epoch: 6, Steps: 13 | Train Loss: 4.087 Vali Loss: 16.162 Vali Acc: 0.360 Test Loss: 16.162 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.086104393005371
Epoch: 7, Steps: 13 | Train Loss: 4.555 Vali Loss: 15.172 Vali Acc: 0.420 Test Loss: 15.172 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.6981072425842285
Epoch: 8, Steps: 13 | Train Loss: 8.245 Vali Loss: 22.177 Vali Acc: 0.440 Test Loss: 22.177 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.9053406715393066
Epoch: 9, Steps: 13 | Train Loss: 7.728 Vali Loss: 11.164 Vali Acc: 0.520 Test Loss: 11.164 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.8733034133911133
Epoch: 10, Steps: 13 | Train Loss: 1.958 Vali Loss: 16.057 Vali Acc: 0.380 Test Loss: 16.057 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.098153114318848
Epoch: 11, Steps: 13 | Train Loss: 3.174 Vali Loss: 13.944 Vali Acc: 0.540 Test Loss: 13.944 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.750281810760498
Epoch: 12, Steps: 13 | Train Loss: 5.036 Vali Loss: 17.957 Vali Acc: 0.420 Test Loss: 17.957 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.197438478469849
Epoch: 13, Steps: 13 | Train Loss: 1.860 Vali Loss: 12.223 Vali Acc: 0.460 Test Loss: 12.223 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.115305185317993
Epoch: 14, Steps: 13 | Train Loss: 1.456 Vali Loss: 17.638 Vali Acc: 0.340 Test Loss: 17.638 Test Acc: 0.340
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 5082625
model size : 20.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 6.508054256439209
Epoch: 1, Steps: 13 | Train Loss: 2.159 Vali Loss: 3.819 Vali Acc: 0.320 Test Loss: 3.819 Test Acc: 0.320
Validation loss decreased (inf --> -0.319962).  Saving model ...
Epoch: 2 cost time: 4.028272390365601
Epoch: 2, Steps: 13 | Train Loss: 5.846 Vali Loss: 10.721 Vali Acc: 0.200 Test Loss: 10.721 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.0525853633880615
Epoch: 3, Steps: 13 | Train Loss: 7.070 Vali Loss: 7.439 Vali Acc: 0.320 Test Loss: 7.439 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.042923927307129
Epoch: 4, Steps: 13 | Train Loss: 3.299 Vali Loss: 4.946 Vali Acc: 0.520 Test Loss: 4.946 Test Acc: 0.520
Validation loss decreased (-0.319962 --> -0.519951).  Saving model ...
Epoch: 5 cost time: 4.0877439975738525
Epoch: 5, Steps: 13 | Train Loss: 2.345 Vali Loss: 6.677 Vali Acc: 0.480 Test Loss: 6.677 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.9642364978790283
Epoch: 6, Steps: 13 | Train Loss: 2.045 Vali Loss: 5.116 Vali Acc: 0.540 Test Loss: 5.116 Test Acc: 0.540
Validation loss decreased (-0.519951 --> -0.539949).  Saving model ...
Epoch: 7 cost time: 4.02974796295166
Epoch: 7, Steps: 13 | Train Loss: 6.225 Vali Loss: 9.380 Vali Acc: 0.520 Test Loss: 9.380 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.474602222442627
Epoch: 8, Steps: 13 | Train Loss: 3.395 Vali Loss: 7.228 Vali Acc: 0.460 Test Loss: 7.228 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.128380537033081
Epoch: 9, Steps: 13 | Train Loss: 2.556 Vali Loss: 11.649 Vali Acc: 0.420 Test Loss: 11.649 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.460339069366455
Epoch: 10, Steps: 13 | Train Loss: 3.173 Vali Loss: 9.392 Vali Acc: 0.520 Test Loss: 9.392 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.082402944564819
Epoch: 11, Steps: 13 | Train Loss: 2.656 Vali Loss: 25.741 Vali Acc: 0.380 Test Loss: 25.741 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.180807828903198
Epoch: 12, Steps: 13 | Train Loss: 5.165 Vali Loss: 9.948 Vali Acc: 0.360 Test Loss: 9.948 Test Acc: 0.360
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.8893020153045654
Epoch: 13, Steps: 13 | Train Loss: 3.003 Vali Loss: 13.547 Vali Acc: 0.300 Test Loss: 13.547 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.994727611541748
Epoch: 14, Steps: 13 | Train Loss: 2.644 Vali Loss: 13.518 Vali Acc: 0.500 Test Loss: 13.518 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.831947088241577
Epoch: 15, Steps: 13 | Train Loss: 1.913 Vali Loss: 21.155 Vali Acc: 0.500 Test Loss: 21.155 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.0157928466796875
Epoch: 16, Steps: 13 | Train Loss: 1.044 Vali Loss: 13.515 Vali Acc: 0.540 Test Loss: 13.515 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 5079809
model size : 20.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 6.087385654449463
Epoch: 1, Steps: 13 | Train Loss: 3.072 Vali Loss: 2.676 Vali Acc: 0.200 Test Loss: 2.676 Test Acc: 0.200
Validation loss decreased (inf --> -0.199973).  Saving model ...
Epoch: 2 cost time: 4.036181688308716
Epoch: 2, Steps: 13 | Train Loss: 3.599 Vali Loss: 5.774 Vali Acc: 0.280 Test Loss: 5.774 Test Acc: 0.280
Validation loss decreased (-0.199973 --> -0.279942).  Saving model ...
Epoch: 3 cost time: 3.8636138439178467
Epoch: 3, Steps: 13 | Train Loss: 5.244 Vali Loss: 5.581 Vali Acc: 0.300 Test Loss: 5.581 Test Acc: 0.300
Validation loss decreased (-0.279942 --> -0.299944).  Saving model ...
Epoch: 4 cost time: 4.116270065307617
Epoch: 4, Steps: 13 | Train Loss: 4.065 Vali Loss: 7.919 Vali Acc: 0.460 Test Loss: 7.919 Test Acc: 0.460
Validation loss decreased (-0.299944 --> -0.459921).  Saving model ...
Epoch: 5 cost time: 4.2933197021484375
Epoch: 5, Steps: 13 | Train Loss: 5.779 Vali Loss: 9.483 Vali Acc: 0.320 Test Loss: 9.483 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.066044092178345
Epoch: 6, Steps: 13 | Train Loss: 10.779 Vali Loss: 9.087 Vali Acc: 0.480 Test Loss: 9.087 Test Acc: 0.480
Validation loss decreased (-0.459921 --> -0.479909).  Saving model ...
Epoch: 7 cost time: 4.179509162902832
Epoch: 7, Steps: 13 | Train Loss: 8.362 Vali Loss: 10.228 Vali Acc: 0.420 Test Loss: 10.228 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.131760835647583
Epoch: 8, Steps: 13 | Train Loss: 3.967 Vali Loss: 13.313 Vali Acc: 0.400 Test Loss: 13.313 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.230118274688721
Epoch: 9, Steps: 13 | Train Loss: 7.625 Vali Loss: 9.664 Vali Acc: 0.520 Test Loss: 9.664 Test Acc: 0.520
Validation loss decreased (-0.479909 --> -0.519903).  Saving model ...
Epoch: 10 cost time: 3.699071168899536
Epoch: 10, Steps: 13 | Train Loss: 1.875 Vali Loss: 12.306 Vali Acc: 0.560 Test Loss: 12.306 Test Acc: 0.560
Validation loss decreased (-0.519903 --> -0.559877).  Saving model ...
Epoch: 11 cost time: 3.9361650943756104
Epoch: 11, Steps: 13 | Train Loss: 3.500 Vali Loss: 19.775 Vali Acc: 0.320 Test Loss: 19.775 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.002305269241333
Epoch: 12, Steps: 13 | Train Loss: 3.043 Vali Loss: 16.911 Vali Acc: 0.400 Test Loss: 16.911 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.015641212463379
Epoch: 13, Steps: 13 | Train Loss: 2.709 Vali Loss: 17.250 Vali Acc: 0.520 Test Loss: 17.250 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.028356075286865
Epoch: 14, Steps: 13 | Train Loss: 3.236 Vali Loss: 23.193 Vali Acc: 0.400 Test Loss: 23.193 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.94453763961792
Epoch: 15, Steps: 13 | Train Loss: 1.168 Vali Loss: 16.429 Vali Acc: 0.440 Test Loss: 16.429 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.8612639904022217
Epoch: 16, Steps: 13 | Train Loss: 0.798 Vali Loss: 16.139 Vali Acc: 0.500 Test Loss: 16.139 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.084192752838135
Epoch: 17, Steps: 13 | Train Loss: 0.462 Vali Loss: 19.924 Vali Acc: 0.480 Test Loss: 19.924 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.993159055709839
Epoch: 18, Steps: 13 | Train Loss: 0.802 Vali Loss: 17.292 Vali Acc: 0.480 Test Loss: 17.292 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.870265483856201
Epoch: 19, Steps: 13 | Train Loss: 0.860 Vali Loss: 22.618 Vali Acc: 0.420 Test Loss: 22.618 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.094369173049927
Epoch: 20, Steps: 13 | Train Loss: 0.740 Vali Loss: 19.577 Vali Acc: 0.480 Test Loss: 19.577 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 5076993
model size : 20.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 6.765949249267578
Epoch: 1, Steps: 13 | Train Loss: 2.436 Vali Loss: 2.884 Vali Acc: 0.300 Test Loss: 2.884 Test Acc: 0.300
Validation loss decreased (inf --> -0.299971).  Saving model ...
Epoch: 2 cost time: 4.223623514175415
Epoch: 2, Steps: 13 | Train Loss: 4.407 Vali Loss: 5.260 Vali Acc: 0.320 Test Loss: 5.260 Test Acc: 0.320
Validation loss decreased (-0.299971 --> -0.319947).  Saving model ...
Epoch: 3 cost time: 4.030524969100952
Epoch: 3, Steps: 13 | Train Loss: 4.379 Vali Loss: 7.595 Vali Acc: 0.340 Test Loss: 7.595 Test Acc: 0.340
Validation loss decreased (-0.319947 --> -0.339924).  Saving model ...
Epoch: 4 cost time: 4.30397367477417
Epoch: 4, Steps: 13 | Train Loss: 5.593 Vali Loss: 12.677 Vali Acc: 0.420 Test Loss: 12.677 Test Acc: 0.420
Validation loss decreased (-0.339924 --> -0.419873).  Saving model ...
Epoch: 5 cost time: 3.838536024093628
Epoch: 5, Steps: 13 | Train Loss: 4.634 Vali Loss: 8.059 Vali Acc: 0.460 Test Loss: 8.059 Test Acc: 0.460
Validation loss decreased (-0.419873 --> -0.459919).  Saving model ...
Epoch: 6 cost time: 4.304227828979492
Epoch: 6, Steps: 13 | Train Loss: 4.191 Vali Loss: 9.550 Vali Acc: 0.440 Test Loss: 9.550 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.910160541534424
Epoch: 7, Steps: 13 | Train Loss: 7.848 Vali Loss: 15.728 Vali Acc: 0.440 Test Loss: 15.728 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.9546310901641846
Epoch: 8, Steps: 13 | Train Loss: 8.929 Vali Loss: 17.883 Vali Acc: 0.320 Test Loss: 17.883 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.031697750091553
Epoch: 9, Steps: 13 | Train Loss: 9.810 Vali Loss: 9.526 Vali Acc: 0.480 Test Loss: 9.526 Test Acc: 0.480
Validation loss decreased (-0.459919 --> -0.479905).  Saving model ...
Epoch: 10 cost time: 3.9506072998046875
Epoch: 10, Steps: 13 | Train Loss: 2.461 Vali Loss: 22.833 Vali Acc: 0.420 Test Loss: 22.833 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.052858114242554
Epoch: 11, Steps: 13 | Train Loss: 3.488 Vali Loss: 21.748 Vali Acc: 0.400 Test Loss: 21.748 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.192287445068359
Epoch: 12, Steps: 13 | Train Loss: 4.902 Vali Loss: 13.932 Vali Acc: 0.540 Test Loss: 13.932 Test Acc: 0.540
Validation loss decreased (-0.479905 --> -0.539861).  Saving model ...
Epoch: 13 cost time: 4.0441060066223145
Epoch: 13, Steps: 13 | Train Loss: 2.388 Vali Loss: 12.412 Vali Acc: 0.480 Test Loss: 12.412 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.824312448501587
Epoch: 14, Steps: 13 | Train Loss: 1.835 Vali Loss: 15.672 Vali Acc: 0.480 Test Loss: 15.672 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.0346081256866455
Epoch: 15, Steps: 13 | Train Loss: 2.548 Vali Loss: 11.008 Vali Acc: 0.540 Test Loss: 11.008 Test Acc: 0.540
Validation loss decreased (-0.539861 --> -0.539890).  Saving model ...
Epoch: 16 cost time: 3.9660651683807373
Epoch: 16, Steps: 13 | Train Loss: 0.963 Vali Loss: 17.796 Vali Acc: 0.420 Test Loss: 17.796 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.144175052642822
Epoch: 17, Steps: 13 | Train Loss: 0.208 Vali Loss: 15.610 Vali Acc: 0.500 Test Loss: 15.610 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.110525131225586
Epoch: 18, Steps: 13 | Train Loss: 0.931 Vali Loss: 13.235 Vali Acc: 0.520 Test Loss: 13.235 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.9396519660949707
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 14.465 Vali Acc: 0.500 Test Loss: 14.465 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.013131618499756
Epoch: 20, Steps: 13 | Train Loss: 0.013 Vali Loss: 15.915 Vali Acc: 0.500 Test Loss: 15.915 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.07471776008606
Epoch: 21, Steps: 13 | Train Loss: 0.328 Vali Loss: 20.948 Vali Acc: 0.480 Test Loss: 20.948 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.0385801792144775
Epoch: 22, Steps: 13 | Train Loss: 0.327 Vali Loss: 18.690 Vali Acc: 0.540 Test Loss: 18.690 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 4.353302001953125
Epoch: 23, Steps: 13 | Train Loss: 1.721 Vali Loss: 13.024 Vali Acc: 0.520 Test Loss: 13.024 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.061819791793823
Epoch: 24, Steps: 13 | Train Loss: 0.123 Vali Loss: 15.346 Vali Acc: 0.580 Test Loss: 15.346 Test Acc: 0.580
Validation loss decreased (-0.539890 --> -0.579847).  Saving model ...
Epoch: 25 cost time: 3.8853535652160645
Epoch: 25, Steps: 13 | Train Loss: 0.102 Vali Loss: 16.091 Vali Acc: 0.560 Test Loss: 16.091 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.147320032119751
Epoch: 26, Steps: 13 | Train Loss: 0.647 Vali Loss: 16.445 Vali Acc: 0.560 Test Loss: 16.445 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.9600822925567627
Epoch: 27, Steps: 13 | Train Loss: 0.383 Vali Loss: 15.985 Vali Acc: 0.600 Test Loss: 15.985 Test Acc: 0.600
Validation loss decreased (-0.579847 --> -0.599840).  Saving model ...
Epoch: 28 cost time: 3.8682467937469482
Epoch: 28, Steps: 13 | Train Loss: 1.692 Vali Loss: 14.449 Vali Acc: 0.520 Test Loss: 14.449 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.910123348236084
Epoch: 29, Steps: 13 | Train Loss: 0.000 Vali Loss: 20.158 Vali Acc: 0.580 Test Loss: 20.158 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 4.146102666854858
Epoch: 30, Steps: 13 | Train Loss: 0.357 Vali Loss: 17.008 Vali Acc: 0.540 Test Loss: 17.008 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 4.00289249420166
Epoch: 31, Steps: 13 | Train Loss: 1.226 Vali Loss: 17.291 Vali Acc: 0.540 Test Loss: 17.291 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 4.344804048538208
Epoch: 32, Steps: 13 | Train Loss: 0.627 Vali Loss: 20.371 Vali Acc: 0.480 Test Loss: 20.371 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 3.905423402786255
Epoch: 33, Steps: 13 | Train Loss: 1.745 Vali Loss: 32.333 Vali Acc: 0.480 Test Loss: 32.333 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 4.007934808731079
Epoch: 34, Steps: 13 | Train Loss: 2.059 Vali Loss: 24.242 Vali Acc: 0.420 Test Loss: 24.242 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 4.097019672393799
Epoch: 35, Steps: 13 | Train Loss: 0.044 Vali Loss: 33.347 Vali Acc: 0.400 Test Loss: 33.347 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 4.127408742904663
Epoch: 36, Steps: 13 | Train Loss: 1.570 Vali Loss: 31.150 Vali Acc: 0.460 Test Loss: 31.150 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 4.3257036209106445
Epoch: 37, Steps: 13 | Train Loss: 3.055 Vali Loss: 18.236 Vali Acc: 0.560 Test Loss: 18.236 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 5074177
model size : 20.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 7.426165819168091
Epoch: 1, Steps: 13 | Train Loss: 2.568 Vali Loss: 3.095 Vali Acc: 0.220 Test Loss: 3.095 Test Acc: 0.220
Validation loss decreased (inf --> -0.219969).  Saving model ...
Epoch: 2 cost time: 4.167894124984741
Epoch: 2, Steps: 13 | Train Loss: 3.516 Vali Loss: 5.050 Vali Acc: 0.220 Test Loss: 5.050 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.9320755004882812
Epoch: 3, Steps: 13 | Train Loss: 5.902 Vali Loss: 13.087 Vali Acc: 0.200 Test Loss: 13.087 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.16734766960144
Epoch: 4, Steps: 13 | Train Loss: 6.461 Vali Loss: 5.992 Vali Acc: 0.380 Test Loss: 5.992 Test Acc: 0.380
Validation loss decreased (-0.219969 --> -0.379940).  Saving model ...
Epoch: 5 cost time: 3.6663777828216553
Epoch: 5, Steps: 13 | Train Loss: 4.700 Vali Loss: 11.329 Vali Acc: 0.300 Test Loss: 11.329 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.028351545333862
Epoch: 6, Steps: 13 | Train Loss: 4.178 Vali Loss: 9.553 Vali Acc: 0.360 Test Loss: 9.553 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.9356257915496826
Epoch: 7, Steps: 13 | Train Loss: 2.471 Vali Loss: 9.416 Vali Acc: 0.560 Test Loss: 9.416 Test Acc: 0.560
Validation loss decreased (-0.379940 --> -0.559906).  Saving model ...
Epoch: 8 cost time: 3.6128594875335693
Epoch: 8, Steps: 13 | Train Loss: 3.855 Vali Loss: 15.209 Vali Acc: 0.480 Test Loss: 15.209 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.762503147125244
Epoch: 9, Steps: 13 | Train Loss: 5.094 Vali Loss: 9.072 Vali Acc: 0.500 Test Loss: 9.072 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.702031373977661
Epoch: 10, Steps: 13 | Train Loss: 3.299 Vali Loss: 14.533 Vali Acc: 0.540 Test Loss: 14.533 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.7093350887298584
Epoch: 11, Steps: 13 | Train Loss: 5.201 Vali Loss: 16.191 Vali Acc: 0.440 Test Loss: 16.191 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.6843438148498535
Epoch: 12, Steps: 13 | Train Loss: 5.299 Vali Loss: 21.813 Vali Acc: 0.440 Test Loss: 21.813 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.886563777923584
Epoch: 13, Steps: 13 | Train Loss: 3.341 Vali Loss: 15.222 Vali Acc: 0.460 Test Loss: 15.222 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.031569719314575
Epoch: 14, Steps: 13 | Train Loss: 5.755 Vali Loss: 17.391 Vali Acc: 0.560 Test Loss: 17.391 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.88801908493042
Epoch: 15, Steps: 13 | Train Loss: 4.724 Vali Loss: 27.783 Vali Acc: 0.400 Test Loss: 27.783 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.032705783843994
Epoch: 16, Steps: 13 | Train Loss: 8.773 Vali Loss: 23.795 Vali Acc: 0.380 Test Loss: 23.795 Test Acc: 0.380
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.423425912857056
Epoch: 17, Steps: 13 | Train Loss: 1.845 Vali Loss: 18.575 Vali Acc: 0.440 Test Loss: 18.575 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 4488193
model size : 18.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 6.567578315734863
Epoch: 1, Steps: 13 | Train Loss: 3.091 Vali Loss: 4.726 Vali Acc: 0.240 Test Loss: 4.726 Test Acc: 0.240
Validation loss decreased (inf --> -0.239953).  Saving model ...
Epoch: 2 cost time: 4.029573678970337
Epoch: 2, Steps: 13 | Train Loss: 8.107 Vali Loss: 5.671 Vali Acc: 0.240 Test Loss: 5.671 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.781144380569458
Epoch: 3, Steps: 13 | Train Loss: 4.174 Vali Loss: 2.513 Vali Acc: 0.460 Test Loss: 2.513 Test Acc: 0.460
Validation loss decreased (-0.239953 --> -0.459975).  Saving model ...
Epoch: 4 cost time: 3.882903575897217
Epoch: 4, Steps: 13 | Train Loss: 3.345 Vali Loss: 9.264 Vali Acc: 0.260 Test Loss: 9.264 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.185791730880737
Epoch: 5, Steps: 13 | Train Loss: 2.936 Vali Loss: 11.041 Vali Acc: 0.300 Test Loss: 11.041 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.13856840133667
Epoch: 6, Steps: 13 | Train Loss: 7.492 Vali Loss: 11.859 Vali Acc: 0.420 Test Loss: 11.859 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.906456708908081
Epoch: 7, Steps: 13 | Train Loss: 4.076 Vali Loss: 16.641 Vali Acc: 0.460 Test Loss: 16.641 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.9573798179626465
Epoch: 8, Steps: 13 | Train Loss: 10.330 Vali Loss: 16.643 Vali Acc: 0.520 Test Loss: 16.643 Test Acc: 0.520
Validation loss decreased (-0.459975 --> -0.519834).  Saving model ...
Epoch: 9 cost time: 4.016220569610596
Epoch: 9, Steps: 13 | Train Loss: 7.591 Vali Loss: 17.800 Vali Acc: 0.480 Test Loss: 17.800 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.987337827682495
Epoch: 10, Steps: 13 | Train Loss: 4.496 Vali Loss: 9.973 Vali Acc: 0.520 Test Loss: 9.973 Test Acc: 0.520
Validation loss decreased (-0.519834 --> -0.519900).  Saving model ...
Epoch: 11 cost time: 4.2033514976501465
Epoch: 11, Steps: 13 | Train Loss: 3.235 Vali Loss: 21.205 Vali Acc: 0.400 Test Loss: 21.205 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.070340394973755
Epoch: 12, Steps: 13 | Train Loss: 4.935 Vali Loss: 24.032 Vali Acc: 0.500 Test Loss: 24.032 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.938443183898926
Epoch: 13, Steps: 13 | Train Loss: 3.780 Vali Loss: 30.534 Vali Acc: 0.340 Test Loss: 30.534 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.988304853439331
Epoch: 14, Steps: 13 | Train Loss: 1.439 Vali Loss: 19.487 Vali Acc: 0.440 Test Loss: 19.487 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.194196939468384
Epoch: 15, Steps: 13 | Train Loss: 2.171 Vali Loss: 22.631 Vali Acc: 0.400 Test Loss: 22.631 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.751323699951172
Epoch: 16, Steps: 13 | Train Loss: 2.563 Vali Loss: 18.019 Vali Acc: 0.500 Test Loss: 18.019 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.9793431758880615
Epoch: 17, Steps: 13 | Train Loss: 0.163 Vali Loss: 28.749 Vali Acc: 0.460 Test Loss: 28.749 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.9603750705718994
Epoch: 18, Steps: 13 | Train Loss: 1.444 Vali Loss: 15.526 Vali Acc: 0.520 Test Loss: 15.526 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.96998929977417
Epoch: 19, Steps: 13 | Train Loss: 0.808 Vali Loss: 18.737 Vali Acc: 0.460 Test Loss: 18.737 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.148764133453369
Epoch: 20, Steps: 13 | Train Loss: 0.720 Vali Loss: 14.192 Vali Acc: 0.500 Test Loss: 14.192 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 4485377
model size : 18.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 6.327634811401367
Epoch: 1, Steps: 13 | Train Loss: 2.933 Vali Loss: 4.595 Vali Acc: 0.240 Test Loss: 4.595 Test Acc: 0.240
Validation loss decreased (inf --> -0.239954).  Saving model ...
Epoch: 2 cost time: 3.7521274089813232
Epoch: 2, Steps: 13 | Train Loss: 5.054 Vali Loss: 6.303 Vali Acc: 0.360 Test Loss: 6.303 Test Acc: 0.360
Validation loss decreased (-0.239954 --> -0.359937).  Saving model ...
Epoch: 3 cost time: 3.8670847415924072
Epoch: 3, Steps: 13 | Train Loss: 7.390 Vali Loss: 12.921 Vali Acc: 0.200 Test Loss: 12.921 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.7487311363220215
Epoch: 4, Steps: 13 | Train Loss: 9.282 Vali Loss: 5.953 Vali Acc: 0.340 Test Loss: 5.953 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.7737512588500977
Epoch: 5, Steps: 13 | Train Loss: 4.374 Vali Loss: 11.242 Vali Acc: 0.460 Test Loss: 11.242 Test Acc: 0.460
Validation loss decreased (-0.359937 --> -0.459888).  Saving model ...
Epoch: 6 cost time: 3.647348642349243
Epoch: 6, Steps: 13 | Train Loss: 7.814 Vali Loss: 18.073 Vali Acc: 0.380 Test Loss: 18.073 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.765050172805786
Epoch: 7, Steps: 13 | Train Loss: 10.512 Vali Loss: 18.527 Vali Acc: 0.320 Test Loss: 18.527 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.6835601329803467
Epoch: 8, Steps: 13 | Train Loss: 5.635 Vali Loss: 7.847 Vali Acc: 0.520 Test Loss: 7.847 Test Acc: 0.520
Validation loss decreased (-0.459888 --> -0.519922).  Saving model ...
Epoch: 9 cost time: 3.732330322265625
Epoch: 9, Steps: 13 | Train Loss: 4.245 Vali Loss: 10.223 Vali Acc: 0.540 Test Loss: 10.223 Test Acc: 0.540
Validation loss decreased (-0.519922 --> -0.539898).  Saving model ...
Epoch: 10 cost time: 3.7240452766418457
Epoch: 10, Steps: 13 | Train Loss: 3.176 Vali Loss: 10.591 Vali Acc: 0.480 Test Loss: 10.591 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.7714157104492188
Epoch: 11, Steps: 13 | Train Loss: 2.694 Vali Loss: 24.221 Vali Acc: 0.360 Test Loss: 24.221 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.6066102981567383
Epoch: 12, Steps: 13 | Train Loss: 4.557 Vali Loss: 29.878 Vali Acc: 0.400 Test Loss: 29.878 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.802091360092163
Epoch: 13, Steps: 13 | Train Loss: 1.515 Vali Loss: 19.814 Vali Acc: 0.420 Test Loss: 19.814 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.725428819656372
Epoch: 14, Steps: 13 | Train Loss: 0.463 Vali Loss: 14.094 Vali Acc: 0.520 Test Loss: 14.094 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.6524949073791504
Epoch: 15, Steps: 13 | Train Loss: 2.814 Vali Loss: 21.353 Vali Acc: 0.480 Test Loss: 21.353 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.835040330886841
Epoch: 16, Steps: 13 | Train Loss: 2.534 Vali Loss: 21.009 Vali Acc: 0.400 Test Loss: 21.009 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.192373514175415
Epoch: 17, Steps: 13 | Train Loss: 1.554 Vali Loss: 23.283 Vali Acc: 0.500 Test Loss: 23.283 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.8574559688568115
Epoch: 18, Steps: 13 | Train Loss: 1.148 Vali Loss: 20.844 Vali Acc: 0.520 Test Loss: 20.844 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.048309803009033
Epoch: 19, Steps: 13 | Train Loss: 2.564 Vali Loss: 20.928 Vali Acc: 0.440 Test Loss: 20.928 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 4482561
model size : 18.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.921648263931274
Epoch: 1, Steps: 13 | Train Loss: 5.509 Vali Loss: 7.710 Vali Acc: 0.180 Test Loss: 7.710 Test Acc: 0.180
Validation loss decreased (inf --> -0.179923).  Saving model ...
Epoch: 2 cost time: 3.633697032928467
Epoch: 2, Steps: 13 | Train Loss: 5.447 Vali Loss: 4.309 Vali Acc: 0.220 Test Loss: 4.309 Test Acc: 0.220
Validation loss decreased (-0.179923 --> -0.219957).  Saving model ...
Epoch: 3 cost time: 3.9456584453582764
Epoch: 3, Steps: 13 | Train Loss: 2.781 Vali Loss: 7.122 Vali Acc: 0.300 Test Loss: 7.122 Test Acc: 0.300
Validation loss decreased (-0.219957 --> -0.299929).  Saving model ...
Epoch: 4 cost time: 3.570106267929077
Epoch: 4, Steps: 13 | Train Loss: 6.335 Vali Loss: 15.332 Vali Acc: 0.340 Test Loss: 15.332 Test Acc: 0.340
Validation loss decreased (-0.299929 --> -0.339847).  Saving model ...
Epoch: 5 cost time: 3.5449037551879883
Epoch: 5, Steps: 13 | Train Loss: 8.348 Vali Loss: 9.824 Vali Acc: 0.440 Test Loss: 9.824 Test Acc: 0.440
Validation loss decreased (-0.339847 --> -0.439902).  Saving model ...
Epoch: 6 cost time: 3.7201473712921143
Epoch: 6, Steps: 13 | Train Loss: 7.733 Vali Loss: 9.349 Vali Acc: 0.400 Test Loss: 9.349 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.819403886795044
Epoch: 7, Steps: 13 | Train Loss: 4.960 Vali Loss: 13.705 Vali Acc: 0.380 Test Loss: 13.705 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.707392692565918
Epoch: 8, Steps: 13 | Train Loss: 4.366 Vali Loss: 16.772 Vali Acc: 0.360 Test Loss: 16.772 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.9224512577056885
Epoch: 9, Steps: 13 | Train Loss: 11.317 Vali Loss: 21.885 Vali Acc: 0.400 Test Loss: 21.885 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.859293222427368
Epoch: 10, Steps: 13 | Train Loss: 6.982 Vali Loss: 19.479 Vali Acc: 0.380 Test Loss: 19.479 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.8004255294799805
Epoch: 11, Steps: 13 | Train Loss: 10.038 Vali Loss: 30.413 Vali Acc: 0.380 Test Loss: 30.413 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.893057107925415
Epoch: 12, Steps: 13 | Train Loss: 3.338 Vali Loss: 26.735 Vali Acc: 0.500 Test Loss: 26.735 Test Acc: 0.500
Validation loss decreased (-0.439902 --> -0.499733).  Saving model ...
Epoch: 13 cost time: 4.020100116729736
Epoch: 13, Steps: 13 | Train Loss: 5.717 Vali Loss: 36.474 Vali Acc: 0.420 Test Loss: 36.474 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.653203248977661
Epoch: 14, Steps: 13 | Train Loss: 6.610 Vali Loss: 19.644 Vali Acc: 0.520 Test Loss: 19.644 Test Acc: 0.520
Validation loss decreased (-0.499733 --> -0.519804).  Saving model ...
Epoch: 15 cost time: 4.226499557495117
Epoch: 15, Steps: 13 | Train Loss: 5.617 Vali Loss: 13.153 Vali Acc: 0.600 Test Loss: 13.153 Test Acc: 0.600
Validation loss decreased (-0.519804 --> -0.599868).  Saving model ...
Epoch: 16 cost time: 3.9707040786743164
Epoch: 16, Steps: 13 | Train Loss: 2.098 Vali Loss: 22.920 Vali Acc: 0.420 Test Loss: 22.920 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.074238061904907
Epoch: 17, Steps: 13 | Train Loss: 3.616 Vali Loss: 20.038 Vali Acc: 0.540 Test Loss: 20.038 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.256031274795532
Epoch: 18, Steps: 13 | Train Loss: 0.993 Vali Loss: 22.269 Vali Acc: 0.440 Test Loss: 22.269 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.088975191116333
Epoch: 19, Steps: 13 | Train Loss: 0.941 Vali Loss: 19.913 Vali Acc: 0.560 Test Loss: 19.913 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.0264623165130615
Epoch: 20, Steps: 13 | Train Loss: 0.862 Vali Loss: 26.796 Vali Acc: 0.540 Test Loss: 26.796 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.926774501800537
Epoch: 21, Steps: 13 | Train Loss: 1.774 Vali Loss: 20.558 Vali Acc: 0.620 Test Loss: 20.558 Test Acc: 0.620
Validation loss decreased (-0.599868 --> -0.619794).  Saving model ...
Epoch: 22 cost time: 4.114717483520508
Epoch: 22, Steps: 13 | Train Loss: 1.097 Vali Loss: 16.989 Vali Acc: 0.540 Test Loss: 16.989 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.9872593879699707
Epoch: 23, Steps: 13 | Train Loss: 0.340 Vali Loss: 40.503 Vali Acc: 0.380 Test Loss: 40.503 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.8384218215942383
Epoch: 24, Steps: 13 | Train Loss: 2.404 Vali Loss: 18.299 Vali Acc: 0.520 Test Loss: 18.299 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.5195870399475098
Epoch: 25, Steps: 13 | Train Loss: 1.124 Vali Loss: 16.524 Vali Acc: 0.560 Test Loss: 16.524 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.6853439807891846
Epoch: 26, Steps: 13 | Train Loss: 0.149 Vali Loss: 30.464 Vali Acc: 0.420 Test Loss: 30.464 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.766336679458618
Epoch: 27, Steps: 13 | Train Loss: 0.009 Vali Loss: 32.397 Vali Acc: 0.540 Test Loss: 32.397 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.665865659713745
Epoch: 28, Steps: 13 | Train Loss: 0.782 Vali Loss: 26.276 Vali Acc: 0.600 Test Loss: 26.276 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.69053316116333
Epoch: 29, Steps: 13 | Train Loss: 0.551 Vali Loss: 33.229 Vali Acc: 0.460 Test Loss: 33.229 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.6114091873168945
Epoch: 30, Steps: 13 | Train Loss: 1.304 Vali Loss: 35.398 Vali Acc: 0.440 Test Loss: 35.398 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 3.6447598934173584
Epoch: 31, Steps: 13 | Train Loss: 0.463 Vali Loss: 19.806 Vali Acc: 0.560 Test Loss: 19.806 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 4479745
model size : 18.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.932003736495972
Epoch: 1, Steps: 13 | Train Loss: 2.450 Vali Loss: 10.498 Vali Acc: 0.200 Test Loss: 10.498 Test Acc: 0.200
Validation loss decreased (inf --> -0.199895).  Saving model ...
Epoch: 2 cost time: 3.9003746509552
Epoch: 2, Steps: 13 | Train Loss: 7.643 Vali Loss: 3.150 Vali Acc: 0.340 Test Loss: 3.150 Test Acc: 0.340
Validation loss decreased (-0.199895 --> -0.339969).  Saving model ...
Epoch: 3 cost time: 3.5663516521453857
Epoch: 3, Steps: 13 | Train Loss: 4.635 Vali Loss: 5.380 Vali Acc: 0.200 Test Loss: 5.380 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.6874117851257324
Epoch: 4, Steps: 13 | Train Loss: 3.714 Vali Loss: 5.592 Vali Acc: 0.380 Test Loss: 5.592 Test Acc: 0.380
Validation loss decreased (-0.339969 --> -0.379944).  Saving model ...
Epoch: 5 cost time: 3.8630809783935547
Epoch: 5, Steps: 13 | Train Loss: 5.082 Vali Loss: 6.402 Vali Acc: 0.460 Test Loss: 6.402 Test Acc: 0.460
Validation loss decreased (-0.379944 --> -0.459936).  Saving model ...
Epoch: 6 cost time: 3.8471286296844482
Epoch: 6, Steps: 13 | Train Loss: 4.592 Vali Loss: 28.037 Vali Acc: 0.400 Test Loss: 28.037 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.599308490753174
Epoch: 7, Steps: 13 | Train Loss: 14.043 Vali Loss: 15.675 Vali Acc: 0.280 Test Loss: 15.675 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.785449266433716
Epoch: 8, Steps: 13 | Train Loss: 8.029 Vali Loss: 14.842 Vali Acc: 0.360 Test Loss: 14.842 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.738293409347534
Epoch: 9, Steps: 13 | Train Loss: 4.489 Vali Loss: 11.380 Vali Acc: 0.440 Test Loss: 11.380 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.724606513977051
Epoch: 10, Steps: 13 | Train Loss: 3.306 Vali Loss: 15.822 Vali Acc: 0.460 Test Loss: 15.822 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.5916531085968018
Epoch: 11, Steps: 13 | Train Loss: 4.794 Vali Loss: 16.094 Vali Acc: 0.440 Test Loss: 16.094 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.768354654312134
Epoch: 12, Steps: 13 | Train Loss: 6.438 Vali Loss: 12.450 Vali Acc: 0.420 Test Loss: 12.450 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.8276684284210205
Epoch: 13, Steps: 13 | Train Loss: 3.565 Vali Loss: 27.023 Vali Acc: 0.520 Test Loss: 27.023 Test Acc: 0.520
Validation loss decreased (-0.459936 --> -0.519730).  Saving model ...
Epoch: 14 cost time: 3.686673164367676
Epoch: 14, Steps: 13 | Train Loss: 10.445 Vali Loss: 19.121 Vali Acc: 0.440 Test Loss: 19.121 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.3374266624450684
Epoch: 15, Steps: 13 | Train Loss: 3.775 Vali Loss: 18.916 Vali Acc: 0.400 Test Loss: 18.916 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.9073078632354736
Epoch: 16, Steps: 13 | Train Loss: 2.209 Vali Loss: 17.131 Vali Acc: 0.460 Test Loss: 17.131 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.125509738922119
Epoch: 17, Steps: 13 | Train Loss: 2.103 Vali Loss: 22.181 Vali Acc: 0.500 Test Loss: 22.181 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.4593913555145264
Epoch: 18, Steps: 13 | Train Loss: 0.794 Vali Loss: 23.741 Vali Acc: 0.520 Test Loss: 23.741 Test Acc: 0.520
Validation loss decreased (-0.519730 --> -0.519763).  Saving model ...
Epoch: 19 cost time: 3.9609031677246094
Epoch: 19, Steps: 13 | Train Loss: 0.801 Vali Loss: 19.184 Vali Acc: 0.380 Test Loss: 19.184 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.078052282333374
Epoch: 20, Steps: 13 | Train Loss: 1.886 Vali Loss: 19.700 Vali Acc: 0.460 Test Loss: 19.700 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.5375165939331055
Epoch: 21, Steps: 13 | Train Loss: 0.281 Vali Loss: 17.225 Vali Acc: 0.520 Test Loss: 17.225 Test Acc: 0.520
Validation loss decreased (-0.519763 --> -0.519828).  Saving model ...
Epoch: 22 cost time: 3.9900197982788086
Epoch: 22, Steps: 13 | Train Loss: 1.857 Vali Loss: 21.191 Vali Acc: 0.480 Test Loss: 21.191 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.731308698654175
Epoch: 23, Steps: 13 | Train Loss: 0.000 Vali Loss: 23.928 Vali Acc: 0.440 Test Loss: 23.928 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.8928465843200684
Epoch: 24, Steps: 13 | Train Loss: 0.187 Vali Loss: 24.769 Vali Acc: 0.480 Test Loss: 24.769 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 4.002024412155151
Epoch: 25, Steps: 13 | Train Loss: 0.319 Vali Loss: 14.413 Vali Acc: 0.520 Test Loss: 14.413 Test Acc: 0.520
Validation loss decreased (-0.519828 --> -0.519856).  Saving model ...
Epoch: 26 cost time: 3.83168625831604
Epoch: 26, Steps: 13 | Train Loss: 0.554 Vali Loss: 21.615 Vali Acc: 0.560 Test Loss: 21.615 Test Acc: 0.560
Validation loss decreased (-0.519856 --> -0.559784).  Saving model ...
Epoch: 27 cost time: 3.915618419647217
Epoch: 27, Steps: 13 | Train Loss: 0.293 Vali Loss: 25.375 Vali Acc: 0.440 Test Loss: 25.375 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.7966346740722656
Epoch: 28, Steps: 13 | Train Loss: 1.504 Vali Loss: 14.061 Vali Acc: 0.540 Test Loss: 14.061 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.8643229007720947
Epoch: 29, Steps: 13 | Train Loss: 0.189 Vali Loss: 14.619 Vali Acc: 0.560 Test Loss: 14.619 Test Acc: 0.560
Validation loss decreased (-0.559784 --> -0.559854).  Saving model ...
Epoch: 30 cost time: 3.736402988433838
Epoch: 30, Steps: 13 | Train Loss: 0.000 Vali Loss: 22.931 Vali Acc: 0.460 Test Loss: 22.931 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 4.299915790557861
Epoch: 31, Steps: 13 | Train Loss: 0.328 Vali Loss: 15.328 Vali Acc: 0.520 Test Loss: 15.328 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 4.355068922042847
Epoch: 32, Steps: 13 | Train Loss: 0.484 Vali Loss: 23.243 Vali Acc: 0.460 Test Loss: 23.243 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 4.10361909866333
Epoch: 33, Steps: 13 | Train Loss: 0.992 Vali Loss: 25.362 Vali Acc: 0.480 Test Loss: 25.362 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.876161813735962
Epoch: 34, Steps: 13 | Train Loss: 0.796 Vali Loss: 26.403 Vali Acc: 0.500 Test Loss: 26.403 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 3.8752388954162598
Epoch: 35, Steps: 13 | Train Loss: 2.447 Vali Loss: 32.059 Vali Acc: 0.420 Test Loss: 32.059 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 4.109050273895264
Epoch: 36, Steps: 13 | Train Loss: 3.055 Vali Loss: 29.813 Vali Acc: 0.380 Test Loss: 29.813 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 3.882780075073242
Epoch: 37, Steps: 13 | Train Loss: 3.320 Vali Loss: 19.458 Vali Acc: 0.500 Test Loss: 19.458 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 3.7929537296295166
Epoch: 38, Steps: 13 | Train Loss: 0.593 Vali Loss: 26.158 Vali Acc: 0.500 Test Loss: 26.158 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 3.7729640007019043
Epoch: 39, Steps: 13 | Train Loss: 1.639 Vali Loss: 34.134 Vali Acc: 0.520 Test Loss: 34.134 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 4190977
model size : 17.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.556796073913574
Epoch: 1, Steps: 13 | Train Loss: 2.456 Vali Loss: 4.590 Vali Acc: 0.200 Test Loss: 4.590 Test Acc: 0.200
Validation loss decreased (inf --> -0.199954).  Saving model ...
Epoch: 2 cost time: 3.4665708541870117
Epoch: 2, Steps: 13 | Train Loss: 3.510 Vali Loss: 8.279 Vali Acc: 0.200 Test Loss: 8.279 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.3959054946899414
Epoch: 3, Steps: 13 | Train Loss: 6.306 Vali Loss: 5.610 Vali Acc: 0.280 Test Loss: 5.610 Test Acc: 0.280
Validation loss decreased (-0.199954 --> -0.279944).  Saving model ...
Epoch: 4 cost time: 3.76755428314209
Epoch: 4, Steps: 13 | Train Loss: 3.683 Vali Loss: 5.761 Vali Acc: 0.360 Test Loss: 5.761 Test Acc: 0.360
Validation loss decreased (-0.279944 --> -0.359942).  Saving model ...
Epoch: 5 cost time: 3.5247411727905273
Epoch: 5, Steps: 13 | Train Loss: 5.806 Vali Loss: 7.889 Vali Acc: 0.220 Test Loss: 7.889 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.3052704334259033
Epoch: 6, Steps: 13 | Train Loss: 5.455 Vali Loss: 14.821 Vali Acc: 0.360 Test Loss: 14.821 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.659339666366577
Epoch: 7, Steps: 13 | Train Loss: 5.945 Vali Loss: 14.381 Vali Acc: 0.400 Test Loss: 14.381 Test Acc: 0.400
Validation loss decreased (-0.359942 --> -0.399856).  Saving model ...
Epoch: 8 cost time: 3.8243422508239746
Epoch: 8, Steps: 13 | Train Loss: 4.765 Vali Loss: 20.443 Vali Acc: 0.500 Test Loss: 20.443 Test Acc: 0.500
Validation loss decreased (-0.399856 --> -0.499796).  Saving model ...
Epoch: 9 cost time: 3.6068882942199707
Epoch: 9, Steps: 13 | Train Loss: 11.120 Vali Loss: 16.561 Vali Acc: 0.400 Test Loss: 16.561 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.6918129920959473
Epoch: 10, Steps: 13 | Train Loss: 6.267 Vali Loss: 24.866 Vali Acc: 0.380 Test Loss: 24.866 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.7605981826782227
Epoch: 11, Steps: 13 | Train Loss: 6.684 Vali Loss: 14.654 Vali Acc: 0.520 Test Loss: 14.654 Test Acc: 0.520
Validation loss decreased (-0.499796 --> -0.519853).  Saving model ...
Epoch: 12 cost time: 3.6407077312469482
Epoch: 12, Steps: 13 | Train Loss: 5.750 Vali Loss: 19.315 Vali Acc: 0.420 Test Loss: 19.315 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.200441360473633
Epoch: 13, Steps: 13 | Train Loss: 7.302 Vali Loss: 18.469 Vali Acc: 0.520 Test Loss: 18.469 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.4142651557922363
Epoch: 14, Steps: 13 | Train Loss: 2.675 Vali Loss: 21.494 Vali Acc: 0.480 Test Loss: 21.494 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.520249605178833
Epoch: 15, Steps: 13 | Train Loss: 2.528 Vali Loss: 23.569 Vali Acc: 0.420 Test Loss: 23.569 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.7513232231140137
Epoch: 16, Steps: 13 | Train Loss: 3.255 Vali Loss: 20.520 Vali Acc: 0.500 Test Loss: 20.520 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.588017225265503
Epoch: 17, Steps: 13 | Train Loss: 1.823 Vali Loss: 32.359 Vali Acc: 0.420 Test Loss: 32.359 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.491777181625366
Epoch: 18, Steps: 13 | Train Loss: 2.927 Vali Loss: 22.763 Vali Acc: 0.480 Test Loss: 22.763 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.809260606765747
Epoch: 19, Steps: 13 | Train Loss: 1.155 Vali Loss: 21.936 Vali Acc: 0.380 Test Loss: 21.936 Test Acc: 0.380
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.5582804679870605
Epoch: 20, Steps: 13 | Train Loss: 2.672 Vali Loss: 24.170 Vali Acc: 0.480 Test Loss: 24.170 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.4425482749938965
Epoch: 21, Steps: 13 | Train Loss: 0.013 Vali Loss: 23.645 Vali Acc: 0.560 Test Loss: 23.645 Test Acc: 0.560
Validation loss decreased (-0.519853 --> -0.559764).  Saving model ...
Epoch: 22 cost time: 3.374110460281372
Epoch: 22, Steps: 13 | Train Loss: 2.737 Vali Loss: 23.919 Vali Acc: 0.520 Test Loss: 23.919 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.3823862075805664
Epoch: 23, Steps: 13 | Train Loss: 0.000 Vali Loss: 23.043 Vali Acc: 0.480 Test Loss: 23.043 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.441387891769409
Epoch: 24, Steps: 13 | Train Loss: 0.278 Vali Loss: 23.130 Vali Acc: 0.460 Test Loss: 23.130 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.649522304534912
Epoch: 25, Steps: 13 | Train Loss: 0.123 Vali Loss: 17.998 Vali Acc: 0.480 Test Loss: 17.998 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.6442973613739014
Epoch: 26, Steps: 13 | Train Loss: 0.192 Vali Loss: 20.773 Vali Acc: 0.520 Test Loss: 20.773 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.4941604137420654
Epoch: 27, Steps: 13 | Train Loss: 0.005 Vali Loss: 21.187 Vali Acc: 0.560 Test Loss: 21.187 Test Acc: 0.560
Validation loss decreased (-0.559764 --> -0.559788).  Saving model ...
Epoch: 28 cost time: 3.6116440296173096
Epoch: 28, Steps: 13 | Train Loss: 0.000 Vali Loss: 21.392 Vali Acc: 0.480 Test Loss: 21.392 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.7419915199279785
Epoch: 29, Steps: 13 | Train Loss: 0.168 Vali Loss: 21.781 Vali Acc: 0.520 Test Loss: 21.781 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.4455912113189697
Epoch: 30, Steps: 13 | Train Loss: 0.638 Vali Loss: 24.600 Vali Acc: 0.560 Test Loss: 24.600 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.5088672637939453
Epoch: 31, Steps: 13 | Train Loss: 0.045 Vali Loss: 21.506 Vali Acc: 0.480 Test Loss: 21.506 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.5902602672576904
Epoch: 32, Steps: 13 | Train Loss: 0.650 Vali Loss: 20.871 Vali Acc: 0.560 Test Loss: 20.871 Test Acc: 0.560
Validation loss decreased (-0.559788 --> -0.559791).  Saving model ...
Epoch: 33 cost time: 3.332233190536499
Epoch: 33, Steps: 13 | Train Loss: 0.112 Vali Loss: 26.960 Vali Acc: 0.480 Test Loss: 26.960 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.4479830265045166
Epoch: 34, Steps: 13 | Train Loss: 0.002 Vali Loss: 21.795 Vali Acc: 0.520 Test Loss: 21.795 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.786820411682129
Epoch: 35, Steps: 13 | Train Loss: 0.370 Vali Loss: 22.827 Vali Acc: 0.460 Test Loss: 22.827 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 3.548426389694214
Epoch: 36, Steps: 13 | Train Loss: 0.482 Vali Loss: 30.229 Vali Acc: 0.440 Test Loss: 30.229 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 3.8670387268066406
Epoch: 37, Steps: 13 | Train Loss: 6.330 Vali Loss: 29.535 Vali Acc: 0.480 Test Loss: 29.535 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 3.630523443222046
Epoch: 38, Steps: 13 | Train Loss: 3.597 Vali Loss: 39.079 Vali Acc: 0.420 Test Loss: 39.079 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 3.4710323810577393
Epoch: 39, Steps: 13 | Train Loss: 2.389 Vali Loss: 41.161 Vali Acc: 0.440 Test Loss: 41.161 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 3.9073195457458496
Epoch: 40, Steps: 13 | Train Loss: 0.805 Vali Loss: 38.491 Vali Acc: 0.520 Test Loss: 38.491 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 3.881084680557251
Epoch: 41, Steps: 13 | Train Loss: 0.150 Vali Loss: 46.273 Vali Acc: 0.320 Test Loss: 46.273 Test Acc: 0.320
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 3.493072271347046
Epoch: 42, Steps: 13 | Train Loss: 3.483 Vali Loss: 64.893 Vali Acc: 0.380 Test Loss: 64.893 Test Acc: 0.380
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 4188161
model size : 17.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.376699686050415
Epoch: 1, Steps: 13 | Train Loss: 2.435 Vali Loss: 4.501 Vali Acc: 0.220 Test Loss: 4.501 Test Acc: 0.220
Validation loss decreased (inf --> -0.219955).  Saving model ...
Epoch: 2 cost time: 3.6195170879364014
Epoch: 2, Steps: 13 | Train Loss: 6.276 Vali Loss: 4.940 Vali Acc: 0.260 Test Loss: 4.940 Test Acc: 0.260
Validation loss decreased (-0.219955 --> -0.259951).  Saving model ...
Epoch: 3 cost time: 3.908214807510376
Epoch: 3, Steps: 13 | Train Loss: 3.516 Vali Loss: 5.470 Vali Acc: 0.420 Test Loss: 5.470 Test Acc: 0.420
Validation loss decreased (-0.259951 --> -0.419945).  Saving model ...
Epoch: 4 cost time: 3.6667559146881104
Epoch: 4, Steps: 13 | Train Loss: 6.257 Vali Loss: 13.003 Vali Acc: 0.220 Test Loss: 13.003 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.060252904891968
Epoch: 5, Steps: 13 | Train Loss: 8.906 Vali Loss: 12.811 Vali Acc: 0.240 Test Loss: 12.811 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.712609052658081
Epoch: 6, Steps: 13 | Train Loss: 9.972 Vali Loss: 13.408 Vali Acc: 0.360 Test Loss: 13.408 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.5192108154296875
Epoch: 7, Steps: 13 | Train Loss: 2.712 Vali Loss: 10.915 Vali Acc: 0.360 Test Loss: 10.915 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.944209098815918
Epoch: 8, Steps: 13 | Train Loss: 3.933 Vali Loss: 12.054 Vali Acc: 0.380 Test Loss: 12.054 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.7527897357940674
Epoch: 9, Steps: 13 | Train Loss: 5.846 Vali Loss: 17.193 Vali Acc: 0.500 Test Loss: 17.193 Test Acc: 0.500
Validation loss decreased (-0.419945 --> -0.499828).  Saving model ...
Epoch: 10 cost time: 3.8045079708099365
Epoch: 10, Steps: 13 | Train Loss: 2.953 Vali Loss: 15.900 Vali Acc: 0.400 Test Loss: 15.900 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.8298237323760986
Epoch: 11, Steps: 13 | Train Loss: 2.267 Vali Loss: 13.580 Vali Acc: 0.440 Test Loss: 13.580 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.027142286300659
Epoch: 12, Steps: 13 | Train Loss: 2.486 Vali Loss: 29.568 Vali Acc: 0.440 Test Loss: 29.568 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.8405063152313232
Epoch: 13, Steps: 13 | Train Loss: 3.710 Vali Loss: 21.927 Vali Acc: 0.420 Test Loss: 21.927 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.667869806289673
Epoch: 14, Steps: 13 | Train Loss: 3.153 Vali Loss: 21.716 Vali Acc: 0.400 Test Loss: 21.716 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.674132823944092
Epoch: 15, Steps: 13 | Train Loss: 5.245 Vali Loss: 18.247 Vali Acc: 0.460 Test Loss: 18.247 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.8353271484375
Epoch: 16, Steps: 13 | Train Loss: 3.404 Vali Loss: 18.350 Vali Acc: 0.480 Test Loss: 18.350 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.7267234325408936
Epoch: 17, Steps: 13 | Train Loss: 0.821 Vali Loss: 20.964 Vali Acc: 0.420 Test Loss: 20.964 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.339295864105225
Epoch: 18, Steps: 13 | Train Loss: 1.722 Vali Loss: 15.636 Vali Acc: 0.460 Test Loss: 15.636 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.702255964279175
Epoch: 19, Steps: 13 | Train Loss: 0.423 Vali Loss: 17.583 Vali Acc: 0.540 Test Loss: 17.583 Test Acc: 0.540
Validation loss decreased (-0.499828 --> -0.539824).  Saving model ...
Epoch: 20 cost time: 3.645601987838745
Epoch: 20, Steps: 13 | Train Loss: 0.038 Vali Loss: 22.114 Vali Acc: 0.500 Test Loss: 22.114 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.191454887390137
Epoch: 21, Steps: 13 | Train Loss: 2.059 Vali Loss: 23.104 Vali Acc: 0.460 Test Loss: 23.104 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.220470666885376
Epoch: 22, Steps: 13 | Train Loss: 2.408 Vali Loss: 19.439 Vali Acc: 0.520 Test Loss: 19.439 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.432949066162109
Epoch: 23, Steps: 13 | Train Loss: 2.320 Vali Loss: 26.226 Vali Acc: 0.480 Test Loss: 26.226 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.523402452468872
Epoch: 24, Steps: 13 | Train Loss: 0.906 Vali Loss: 19.647 Vali Acc: 0.620 Test Loss: 19.647 Test Acc: 0.620
Validation loss decreased (-0.539824 --> -0.619804).  Saving model ...
Epoch: 25 cost time: 3.7228331565856934
Epoch: 25, Steps: 13 | Train Loss: 1.120 Vali Loss: 19.731 Vali Acc: 0.500 Test Loss: 19.731 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.223326683044434
Epoch: 26, Steps: 13 | Train Loss: 0.001 Vali Loss: 19.523 Vali Acc: 0.560 Test Loss: 19.523 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.8606834411621094
Epoch: 27, Steps: 13 | Train Loss: 0.000 Vali Loss: 26.939 Vali Acc: 0.460 Test Loss: 26.939 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 4.056114673614502
Epoch: 28, Steps: 13 | Train Loss: 0.256 Vali Loss: 26.436 Vali Acc: 0.520 Test Loss: 26.436 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.729151487350464
Epoch: 29, Steps: 13 | Train Loss: 0.651 Vali Loss: 20.539 Vali Acc: 0.600 Test Loss: 20.539 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.6947145462036133
Epoch: 30, Steps: 13 | Train Loss: 0.180 Vali Loss: 27.705 Vali Acc: 0.540 Test Loss: 27.705 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 3.726076364517212
Epoch: 31, Steps: 13 | Train Loss: 0.042 Vali Loss: 26.240 Vali Acc: 0.540 Test Loss: 26.240 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 4.265862464904785
Epoch: 32, Steps: 13 | Train Loss: 0.000 Vali Loss: 25.425 Vali Acc: 0.540 Test Loss: 25.425 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 3.9926953315734863
Epoch: 33, Steps: 13 | Train Loss: 0.000 Vali Loss: 25.172 Vali Acc: 0.540 Test Loss: 25.172 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 3.8497555255889893
Epoch: 34, Steps: 13 | Train Loss: 0.000 Vali Loss: 25.101 Vali Acc: 0.540 Test Loss: 25.101 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 4185345
model size : 17.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.34721827507019
Epoch: 1, Steps: 13 | Train Loss: 3.345 Vali Loss: 3.195 Vali Acc: 0.200 Test Loss: 3.195 Test Acc: 0.200
Validation loss decreased (inf --> -0.199968).  Saving model ...
Epoch: 2 cost time: 3.418959379196167
Epoch: 2, Steps: 13 | Train Loss: 4.502 Vali Loss: 5.190 Vali Acc: 0.280 Test Loss: 5.190 Test Acc: 0.280
Validation loss decreased (-0.199968 --> -0.279948).  Saving model ...
Epoch: 3 cost time: 3.7774410247802734
Epoch: 3, Steps: 13 | Train Loss: 2.182 Vali Loss: 8.768 Vali Acc: 0.260 Test Loss: 8.768 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.7257418632507324
Epoch: 4, Steps: 13 | Train Loss: 6.222 Vali Loss: 10.400 Vali Acc: 0.420 Test Loss: 10.400 Test Acc: 0.420
Validation loss decreased (-0.279948 --> -0.419896).  Saving model ...
Epoch: 5 cost time: 3.563960075378418
Epoch: 5, Steps: 13 | Train Loss: 4.822 Vali Loss: 12.808 Vali Acc: 0.320 Test Loss: 12.808 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.6411125659942627
Epoch: 6, Steps: 13 | Train Loss: 6.023 Vali Loss: 6.306 Vali Acc: 0.400 Test Loss: 6.306 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.3580081462860107
Epoch: 7, Steps: 13 | Train Loss: 3.528 Vali Loss: 9.204 Vali Acc: 0.480 Test Loss: 9.204 Test Acc: 0.480
Validation loss decreased (-0.419896 --> -0.479908).  Saving model ...
Epoch: 8 cost time: 3.4864494800567627
Epoch: 8, Steps: 13 | Train Loss: 9.713 Vali Loss: 9.504 Vali Acc: 0.540 Test Loss: 9.504 Test Acc: 0.540
Validation loss decreased (-0.479908 --> -0.539905).  Saving model ...
Epoch: 9 cost time: 3.30249285697937
Epoch: 9, Steps: 13 | Train Loss: 5.257 Vali Loss: 15.959 Vali Acc: 0.440 Test Loss: 15.959 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.4650638103485107
Epoch: 10, Steps: 13 | Train Loss: 6.410 Vali Loss: 25.087 Vali Acc: 0.400 Test Loss: 25.087 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.5593111515045166
Epoch: 11, Steps: 13 | Train Loss: 12.179 Vali Loss: 16.028 Vali Acc: 0.560 Test Loss: 16.028 Test Acc: 0.560
Validation loss decreased (-0.539905 --> -0.559840).  Saving model ...
Epoch: 12 cost time: 3.5954842567443848
Epoch: 12, Steps: 13 | Train Loss: 4.423 Vali Loss: 19.563 Vali Acc: 0.420 Test Loss: 19.563 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.931766986846924
Epoch: 13, Steps: 13 | Train Loss: 1.953 Vali Loss: 15.241 Vali Acc: 0.580 Test Loss: 15.241 Test Acc: 0.580
Validation loss decreased (-0.559840 --> -0.579848).  Saving model ...
Epoch: 14 cost time: 3.208406925201416
Epoch: 14, Steps: 13 | Train Loss: 4.872 Vali Loss: 22.788 Vali Acc: 0.460 Test Loss: 22.788 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.35976243019104
Epoch: 15, Steps: 13 | Train Loss: 4.330 Vali Loss: 12.017 Vali Acc: 0.440 Test Loss: 12.017 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.66929030418396
Epoch: 16, Steps: 13 | Train Loss: 1.194 Vali Loss: 17.595 Vali Acc: 0.500 Test Loss: 17.595 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.5714163780212402
Epoch: 17, Steps: 13 | Train Loss: 0.191 Vali Loss: 17.865 Vali Acc: 0.540 Test Loss: 17.865 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.391174554824829
Epoch: 18, Steps: 13 | Train Loss: 0.421 Vali Loss: 17.699 Vali Acc: 0.560 Test Loss: 17.699 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.086145401000977
Epoch: 19, Steps: 13 | Train Loss: 0.601 Vali Loss: 24.324 Vali Acc: 0.400 Test Loss: 24.324 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.285517692565918
Epoch: 20, Steps: 13 | Train Loss: 1.717 Vali Loss: 25.586 Vali Acc: 0.500 Test Loss: 25.586 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.459569215774536
Epoch: 21, Steps: 13 | Train Loss: 2.083 Vali Loss: 18.396 Vali Acc: 0.400 Test Loss: 18.396 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.5352261066436768
Epoch: 22, Steps: 13 | Train Loss: 2.267 Vali Loss: 26.143 Vali Acc: 0.420 Test Loss: 26.143 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.508554458618164
Epoch: 23, Steps: 13 | Train Loss: 2.780 Vali Loss: 23.879 Vali Acc: 0.500 Test Loss: 23.879 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 4182529
model size : 17.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.747517108917236
Epoch: 1, Steps: 13 | Train Loss: 3.122 Vali Loss: 6.123 Vali Acc: 0.200 Test Loss: 6.123 Test Acc: 0.200
Validation loss decreased (inf --> -0.199939).  Saving model ...
Epoch: 2 cost time: 3.991652727127075
Epoch: 2, Steps: 13 | Train Loss: 4.174 Vali Loss: 7.677 Vali Acc: 0.200 Test Loss: 7.677 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.220163345336914
Epoch: 3, Steps: 13 | Train Loss: 5.684 Vali Loss: 15.112 Vali Acc: 0.220 Test Loss: 15.112 Test Acc: 0.220
Validation loss decreased (-0.199939 --> -0.219849).  Saving model ...
Epoch: 4 cost time: 3.785930633544922
Epoch: 4, Steps: 13 | Train Loss: 7.209 Vali Loss: 5.618 Vali Acc: 0.340 Test Loss: 5.618 Test Acc: 0.340
Validation loss decreased (-0.219849 --> -0.339944).  Saving model ...
Epoch: 5 cost time: 3.646109104156494
Epoch: 5, Steps: 13 | Train Loss: 3.353 Vali Loss: 14.339 Vali Acc: 0.320 Test Loss: 14.339 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.7217423915863037
Epoch: 6, Steps: 13 | Train Loss: 7.000 Vali Loss: 13.080 Vali Acc: 0.280 Test Loss: 13.080 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.58748459815979
Epoch: 7, Steps: 13 | Train Loss: 7.743 Vali Loss: 26.269 Vali Acc: 0.240 Test Loss: 26.269 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.73612642288208
Epoch: 8, Steps: 13 | Train Loss: 7.478 Vali Loss: 22.946 Vali Acc: 0.400 Test Loss: 22.946 Test Acc: 0.400
Validation loss decreased (-0.339944 --> -0.399771).  Saving model ...
Epoch: 9 cost time: 3.9600114822387695
Epoch: 9, Steps: 13 | Train Loss: 12.911 Vali Loss: 23.759 Vali Acc: 0.420 Test Loss: 23.759 Test Acc: 0.420
Validation loss decreased (-0.399771 --> -0.419762).  Saving model ...
Epoch: 10 cost time: 3.6125433444976807
Epoch: 10, Steps: 13 | Train Loss: 6.187 Vali Loss: 19.329 Vali Acc: 0.520 Test Loss: 19.329 Test Acc: 0.520
Validation loss decreased (-0.419762 --> -0.519807).  Saving model ...
Epoch: 11 cost time: 3.5290632247924805
Epoch: 11, Steps: 13 | Train Loss: 6.231 Vali Loss: 17.457 Vali Acc: 0.420 Test Loss: 17.457 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.974897623062134
Epoch: 12, Steps: 13 | Train Loss: 5.292 Vali Loss: 26.170 Vali Acc: 0.460 Test Loss: 26.170 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.6577885150909424
Epoch: 13, Steps: 13 | Train Loss: 8.125 Vali Loss: 19.131 Vali Acc: 0.440 Test Loss: 19.131 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.751528263092041
Epoch: 14, Steps: 13 | Train Loss: 4.423 Vali Loss: 16.041 Vali Acc: 0.500 Test Loss: 16.041 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.7619688510894775
Epoch: 15, Steps: 13 | Train Loss: 2.850 Vali Loss: 18.194 Vali Acc: 0.480 Test Loss: 18.194 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.7130353450775146
Epoch: 16, Steps: 13 | Train Loss: 1.795 Vali Loss: 25.226 Vali Acc: 0.540 Test Loss: 25.226 Test Acc: 0.540
Validation loss decreased (-0.519807 --> -0.539748).  Saving model ...
Epoch: 17 cost time: 3.591458559036255
Epoch: 17, Steps: 13 | Train Loss: 2.365 Vali Loss: 21.653 Vali Acc: 0.480 Test Loss: 21.653 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.614433765411377
Epoch: 18, Steps: 13 | Train Loss: 1.739 Vali Loss: 19.948 Vali Acc: 0.500 Test Loss: 19.948 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.3636839389801025
Epoch: 19, Steps: 13 | Train Loss: 2.088 Vali Loss: 25.514 Vali Acc: 0.500 Test Loss: 25.514 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.404758930206299
Epoch: 20, Steps: 13 | Train Loss: 2.402 Vali Loss: 20.692 Vali Acc: 0.500 Test Loss: 20.692 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.465407371520996
Epoch: 21, Steps: 13 | Train Loss: 0.003 Vali Loss: 22.611 Vali Acc: 0.520 Test Loss: 22.611 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.7196662425994873
Epoch: 22, Steps: 13 | Train Loss: 2.968 Vali Loss: 22.438 Vali Acc: 0.440 Test Loss: 22.438 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 4.470020055770874
Epoch: 23, Steps: 13 | Train Loss: 1.266 Vali Loss: 27.006 Vali Acc: 0.500 Test Loss: 27.006 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.7726497650146484
Epoch: 24, Steps: 13 | Train Loss: 4.034 Vali Loss: 28.130 Vali Acc: 0.460 Test Loss: 28.130 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.735269784927368
Epoch: 25, Steps: 13 | Train Loss: 0.961 Vali Loss: 29.635 Vali Acc: 0.420 Test Loss: 29.635 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.463501214981079
Epoch: 26, Steps: 13 | Train Loss: 0.072 Vali Loss: 23.466 Vali Acc: 0.440 Test Loss: 23.466 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 4042369
model size : 16.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 6.158930063247681
Epoch: 1, Steps: 13 | Train Loss: 3.131 Vali Loss: 3.016 Vali Acc: 0.220 Test Loss: 3.016 Test Acc: 0.220
Validation loss decreased (inf --> -0.219970).  Saving model ...
Epoch: 2 cost time: 3.6094014644622803
Epoch: 2, Steps: 13 | Train Loss: 5.744 Vali Loss: 5.938 Vali Acc: 0.200 Test Loss: 5.938 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.6927125453948975
Epoch: 3, Steps: 13 | Train Loss: 4.344 Vali Loss: 8.025 Vali Acc: 0.240 Test Loss: 8.025 Test Acc: 0.240
Validation loss decreased (-0.219970 --> -0.239920).  Saving model ...
Epoch: 4 cost time: 3.61389422416687
Epoch: 4, Steps: 13 | Train Loss: 8.697 Vali Loss: 11.466 Vali Acc: 0.280 Test Loss: 11.466 Test Acc: 0.280
Validation loss decreased (-0.239920 --> -0.279885).  Saving model ...
Epoch: 5 cost time: 3.6456074714660645
Epoch: 5, Steps: 13 | Train Loss: 5.069 Vali Loss: 9.073 Vali Acc: 0.340 Test Loss: 9.073 Test Acc: 0.340
Validation loss decreased (-0.279885 --> -0.339909).  Saving model ...
Epoch: 6 cost time: 3.646876096725464
Epoch: 6, Steps: 13 | Train Loss: 6.060 Vali Loss: 7.319 Vali Acc: 0.400 Test Loss: 7.319 Test Acc: 0.400
Validation loss decreased (-0.339909 --> -0.399927).  Saving model ...
Epoch: 7 cost time: 3.6629886627197266
Epoch: 7, Steps: 13 | Train Loss: 7.480 Vali Loss: 10.379 Vali Acc: 0.320 Test Loss: 10.379 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.7361080646514893
Epoch: 8, Steps: 13 | Train Loss: 6.891 Vali Loss: 24.701 Vali Acc: 0.220 Test Loss: 24.701 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.8217217922210693
Epoch: 9, Steps: 13 | Train Loss: 9.710 Vali Loss: 14.484 Vali Acc: 0.460 Test Loss: 14.484 Test Acc: 0.460
Validation loss decreased (-0.399927 --> -0.459855).  Saving model ...
Epoch: 10 cost time: 3.406824827194214
Epoch: 10, Steps: 13 | Train Loss: 6.375 Vali Loss: 20.951 Vali Acc: 0.300 Test Loss: 20.951 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.7842705249786377
Epoch: 11, Steps: 13 | Train Loss: 7.896 Vali Loss: 19.931 Vali Acc: 0.440 Test Loss: 19.931 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.576263427734375
Epoch: 12, Steps: 13 | Train Loss: 4.241 Vali Loss: 14.636 Vali Acc: 0.460 Test Loss: 14.636 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.843205213546753
Epoch: 13, Steps: 13 | Train Loss: 2.141 Vali Loss: 14.817 Vali Acc: 0.400 Test Loss: 14.817 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.8898963928222656
Epoch: 14, Steps: 13 | Train Loss: 0.481 Vali Loss: 20.729 Vali Acc: 0.400 Test Loss: 20.729 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.814582109451294
Epoch: 15, Steps: 13 | Train Loss: 3.343 Vali Loss: 24.655 Vali Acc: 0.440 Test Loss: 24.655 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.6327874660491943
Epoch: 16, Steps: 13 | Train Loss: 3.057 Vali Loss: 17.313 Vali Acc: 0.420 Test Loss: 17.313 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.735241413116455
Epoch: 17, Steps: 13 | Train Loss: 4.948 Vali Loss: 23.989 Vali Acc: 0.460 Test Loss: 23.989 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.589686155319214
Epoch: 18, Steps: 13 | Train Loss: 3.827 Vali Loss: 22.096 Vali Acc: 0.540 Test Loss: 22.096 Test Acc: 0.540
Validation loss decreased (-0.459855 --> -0.539779).  Saving model ...
Epoch: 19 cost time: 3.4761898517608643
Epoch: 19, Steps: 13 | Train Loss: 5.515 Vali Loss: 29.430 Vali Acc: 0.380 Test Loss: 29.430 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.935434579849243
Epoch: 20, Steps: 13 | Train Loss: 2.759 Vali Loss: 34.232 Vali Acc: 0.420 Test Loss: 34.232 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.6492884159088135
Epoch: 21, Steps: 13 | Train Loss: 2.585 Vali Loss: 26.901 Vali Acc: 0.480 Test Loss: 26.901 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.7005841732025146
Epoch: 22, Steps: 13 | Train Loss: 1.790 Vali Loss: 37.831 Vali Acc: 0.440 Test Loss: 37.831 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.6368868350982666
Epoch: 23, Steps: 13 | Train Loss: 2.646 Vali Loss: 19.217 Vali Acc: 0.540 Test Loss: 19.217 Test Acc: 0.540
Validation loss decreased (-0.539779 --> -0.539808).  Saving model ...
Epoch: 24 cost time: 3.6340601444244385
Epoch: 24, Steps: 13 | Train Loss: 3.482 Vali Loss: 19.502 Vali Acc: 0.580 Test Loss: 19.502 Test Acc: 0.580
Validation loss decreased (-0.539808 --> -0.579805).  Saving model ...
Epoch: 25 cost time: 3.719184398651123
Epoch: 25, Steps: 13 | Train Loss: 1.290 Vali Loss: 20.464 Vali Acc: 0.520 Test Loss: 20.464 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.5408875942230225
Epoch: 26, Steps: 13 | Train Loss: 0.224 Vali Loss: 31.699 Vali Acc: 0.460 Test Loss: 31.699 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.5141162872314453
Epoch: 27, Steps: 13 | Train Loss: 1.484 Vali Loss: 26.143 Vali Acc: 0.480 Test Loss: 26.143 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.4730846881866455
Epoch: 28, Steps: 13 | Train Loss: 0.716 Vali Loss: 36.022 Vali Acc: 0.500 Test Loss: 36.022 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.8627126216888428
Epoch: 29, Steps: 13 | Train Loss: 2.693 Vali Loss: 26.415 Vali Acc: 0.460 Test Loss: 26.415 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.5694992542266846
Epoch: 30, Steps: 13 | Train Loss: 0.692 Vali Loss: 28.673 Vali Acc: 0.540 Test Loss: 28.673 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 3.4259965419769287
Epoch: 31, Steps: 13 | Train Loss: 2.243 Vali Loss: 54.059 Vali Acc: 0.460 Test Loss: 54.059 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 3.6594464778900146
Epoch: 32, Steps: 13 | Train Loss: 2.225 Vali Loss: 30.070 Vali Acc: 0.520 Test Loss: 30.070 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 3.5354907512664795
Epoch: 33, Steps: 13 | Train Loss: 2.612 Vali Loss: 43.861 Vali Acc: 0.380 Test Loss: 43.861 Test Acc: 0.380
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 3.6779778003692627
Epoch: 34, Steps: 13 | Train Loss: 1.858 Vali Loss: 41.722 Vali Acc: 0.440 Test Loss: 41.722 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 4039553
model size : 16.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.481123208999634
Epoch: 1, Steps: 13 | Train Loss: 2.109 Vali Loss: 4.504 Vali Acc: 0.200 Test Loss: 4.504 Test Acc: 0.200
Validation loss decreased (inf --> -0.199955).  Saving model ...
Epoch: 2 cost time: 3.689164876937866
Epoch: 2, Steps: 13 | Train Loss: 5.381 Vali Loss: 8.398 Vali Acc: 0.240 Test Loss: 8.398 Test Acc: 0.240
Validation loss decreased (-0.199955 --> -0.239916).  Saving model ...
Epoch: 3 cost time: 3.799736261367798
Epoch: 3, Steps: 13 | Train Loss: 9.160 Vali Loss: 7.189 Vali Acc: 0.240 Test Loss: 7.189 Test Acc: 0.240
Validation loss decreased (-0.239916 --> -0.239928).  Saving model ...
Epoch: 4 cost time: 3.715524673461914
Epoch: 4, Steps: 13 | Train Loss: 3.748 Vali Loss: 10.027 Vali Acc: 0.460 Test Loss: 10.027 Test Acc: 0.460
Validation loss decreased (-0.239928 --> -0.459900).  Saving model ...
Epoch: 5 cost time: 3.5991997718811035
Epoch: 5, Steps: 13 | Train Loss: 7.916 Vali Loss: 14.098 Vali Acc: 0.260 Test Loss: 14.098 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.422607898712158
Epoch: 6, Steps: 13 | Train Loss: 6.222 Vali Loss: 8.984 Vali Acc: 0.440 Test Loss: 8.984 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.3493785858154297
Epoch: 7, Steps: 13 | Train Loss: 4.367 Vali Loss: 22.349 Vali Acc: 0.300 Test Loss: 22.349 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.430954694747925
Epoch: 8, Steps: 13 | Train Loss: 15.743 Vali Loss: 27.814 Vali Acc: 0.360 Test Loss: 27.814 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.295057535171509
Epoch: 9, Steps: 13 | Train Loss: 5.074 Vali Loss: 9.551 Vali Acc: 0.360 Test Loss: 9.551 Test Acc: 0.360
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.3876328468322754
Epoch: 10, Steps: 13 | Train Loss: 4.015 Vali Loss: 12.839 Vali Acc: 0.440 Test Loss: 12.839 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.333390474319458
Epoch: 11, Steps: 13 | Train Loss: 3.493 Vali Loss: 13.866 Vali Acc: 0.480 Test Loss: 13.866 Test Acc: 0.480
Validation loss decreased (-0.459900 --> -0.479861).  Saving model ...
Epoch: 12 cost time: 3.5111336708068848
Epoch: 12, Steps: 13 | Train Loss: 3.116 Vali Loss: 17.394 Vali Acc: 0.460 Test Loss: 17.394 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.54424786567688
Epoch: 13, Steps: 13 | Train Loss: 2.671 Vali Loss: 20.302 Vali Acc: 0.500 Test Loss: 20.302 Test Acc: 0.500
Validation loss decreased (-0.479861 --> -0.499797).  Saving model ...
Epoch: 14 cost time: 3.6632189750671387
Epoch: 14, Steps: 13 | Train Loss: 2.253 Vali Loss: 15.547 Vali Acc: 0.500 Test Loss: 15.547 Test Acc: 0.500
Validation loss decreased (-0.499797 --> -0.499845).  Saving model ...
Epoch: 15 cost time: 3.7312495708465576
Epoch: 15, Steps: 13 | Train Loss: 2.399 Vali Loss: 10.652 Vali Acc: 0.480 Test Loss: 10.652 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.435776710510254
Epoch: 16, Steps: 13 | Train Loss: 4.334 Vali Loss: 20.946 Vali Acc: 0.520 Test Loss: 20.946 Test Acc: 0.520
Validation loss decreased (-0.499845 --> -0.519791).  Saving model ...
Epoch: 17 cost time: 3.5585813522338867
Epoch: 17, Steps: 13 | Train Loss: 8.333 Vali Loss: 28.237 Vali Acc: 0.480 Test Loss: 28.237 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.880221366882324
Epoch: 18, Steps: 13 | Train Loss: 6.202 Vali Loss: 25.570 Vali Acc: 0.380 Test Loss: 25.570 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.5908799171447754
Epoch: 19, Steps: 13 | Train Loss: 3.562 Vali Loss: 17.380 Vali Acc: 0.420 Test Loss: 17.380 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.4554731845855713
Epoch: 20, Steps: 13 | Train Loss: 1.978 Vali Loss: 15.647 Vali Acc: 0.480 Test Loss: 15.647 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.5598058700561523
Epoch: 21, Steps: 13 | Train Loss: 3.717 Vali Loss: 16.315 Vali Acc: 0.500 Test Loss: 16.315 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.493924379348755
Epoch: 22, Steps: 13 | Train Loss: 0.909 Vali Loss: 35.193 Vali Acc: 0.440 Test Loss: 35.193 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.4365832805633545
Epoch: 23, Steps: 13 | Train Loss: 1.788 Vali Loss: 22.683 Vali Acc: 0.520 Test Loss: 22.683 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.3837332725524902
Epoch: 24, Steps: 13 | Train Loss: 1.789 Vali Loss: 27.030 Vali Acc: 0.460 Test Loss: 27.030 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.956813097000122
Epoch: 25, Steps: 13 | Train Loss: 1.207 Vali Loss: 24.309 Vali Acc: 0.480 Test Loss: 24.309 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.6457879543304443
Epoch: 26, Steps: 13 | Train Loss: 0.001 Vali Loss: 26.081 Vali Acc: 0.540 Test Loss: 26.081 Test Acc: 0.540
Validation loss decreased (-0.519791 --> -0.539739).  Saving model ...
Epoch: 27 cost time: 3.3615195751190186
Epoch: 27, Steps: 13 | Train Loss: 2.039 Vali Loss: 24.771 Vali Acc: 0.460 Test Loss: 24.771 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.51107120513916
Epoch: 28, Steps: 13 | Train Loss: 0.523 Vali Loss: 33.144 Vali Acc: 0.400 Test Loss: 33.144 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.360720634460449
Epoch: 29, Steps: 13 | Train Loss: 3.342 Vali Loss: 31.332 Vali Acc: 0.420 Test Loss: 31.332 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.4339754581451416
Epoch: 30, Steps: 13 | Train Loss: 0.928 Vali Loss: 32.223 Vali Acc: 0.440 Test Loss: 32.223 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.6746599674224854
Epoch: 31, Steps: 13 | Train Loss: 1.540 Vali Loss: 29.149 Vali Acc: 0.500 Test Loss: 29.149 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 3.4143245220184326
Epoch: 32, Steps: 13 | Train Loss: 1.353 Vali Loss: 27.652 Vali Acc: 0.500 Test Loss: 27.652 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 3.451720714569092
Epoch: 33, Steps: 13 | Train Loss: 0.226 Vali Loss: 29.408 Vali Acc: 0.480 Test Loss: 29.408 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 3.565669059753418
Epoch: 34, Steps: 13 | Train Loss: 0.296 Vali Loss: 26.271 Vali Acc: 0.500 Test Loss: 26.271 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 3.524853229522705
Epoch: 35, Steps: 13 | Train Loss: 0.361 Vali Loss: 29.230 Vali Acc: 0.480 Test Loss: 29.230 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 3.785313844680786
Epoch: 36, Steps: 13 | Train Loss: 1.286 Vali Loss: 22.558 Vali Acc: 0.520 Test Loss: 22.558 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 4036737
model size : 16.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 6.348455429077148
Epoch: 1, Steps: 13 | Train Loss: 2.794 Vali Loss: 2.139 Vali Acc: 0.260 Test Loss: 2.139 Test Acc: 0.260
Validation loss decreased (inf --> -0.259979).  Saving model ...
Epoch: 2 cost time: 3.454833745956421
Epoch: 2, Steps: 13 | Train Loss: 2.308 Vali Loss: 4.252 Vali Acc: 0.260 Test Loss: 4.252 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.461691379547119
Epoch: 3, Steps: 13 | Train Loss: 3.213 Vali Loss: 6.660 Vali Acc: 0.300 Test Loss: 6.660 Test Acc: 0.300
Validation loss decreased (-0.259979 --> -0.299933).  Saving model ...
Epoch: 4 cost time: 3.8037922382354736
Epoch: 4, Steps: 13 | Train Loss: 5.803 Vali Loss: 7.661 Vali Acc: 0.320 Test Loss: 7.661 Test Acc: 0.320
Validation loss decreased (-0.299933 --> -0.319923).  Saving model ...
Epoch: 5 cost time: 3.6654226779937744
Epoch: 5, Steps: 13 | Train Loss: 4.647 Vali Loss: 7.445 Vali Acc: 0.480 Test Loss: 7.445 Test Acc: 0.480
Validation loss decreased (-0.319923 --> -0.479926).  Saving model ...
Epoch: 6 cost time: 3.662703514099121
Epoch: 6, Steps: 13 | Train Loss: 5.162 Vali Loss: 8.684 Vali Acc: 0.260 Test Loss: 8.684 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.64211368560791
Epoch: 7, Steps: 13 | Train Loss: 7.188 Vali Loss: 8.293 Vali Acc: 0.320 Test Loss: 8.293 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.357668161392212
Epoch: 8, Steps: 13 | Train Loss: 5.738 Vali Loss: 14.876 Vali Acc: 0.400 Test Loss: 14.876 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.7829999923706055
Epoch: 9, Steps: 13 | Train Loss: 6.179 Vali Loss: 8.381 Vali Acc: 0.540 Test Loss: 8.381 Test Acc: 0.540
Validation loss decreased (-0.479926 --> -0.539916).  Saving model ...
Epoch: 10 cost time: 3.628159761428833
Epoch: 10, Steps: 13 | Train Loss: 2.122 Vali Loss: 17.232 Vali Acc: 0.480 Test Loss: 17.232 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.3862526416778564
Epoch: 11, Steps: 13 | Train Loss: 6.281 Vali Loss: 22.209 Vali Acc: 0.500 Test Loss: 22.209 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.6017954349517822
Epoch: 12, Steps: 13 | Train Loss: 10.888 Vali Loss: 15.263 Vali Acc: 0.460 Test Loss: 15.263 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.733992576599121
Epoch: 13, Steps: 13 | Train Loss: 3.172 Vali Loss: 14.015 Vali Acc: 0.520 Test Loss: 14.015 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.4184277057647705
Epoch: 14, Steps: 13 | Train Loss: 3.445 Vali Loss: 16.232 Vali Acc: 0.420 Test Loss: 16.232 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.5143847465515137
Epoch: 15, Steps: 13 | Train Loss: 3.334 Vali Loss: 29.721 Vali Acc: 0.460 Test Loss: 29.721 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.4891815185546875
Epoch: 16, Steps: 13 | Train Loss: 13.582 Vali Loss: 38.948 Vali Acc: 0.400 Test Loss: 38.948 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.081793308258057
Epoch: 17, Steps: 13 | Train Loss: 7.121 Vali Loss: 32.367 Vali Acc: 0.440 Test Loss: 32.367 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.7608187198638916
Epoch: 18, Steps: 13 | Train Loss: 1.346 Vali Loss: 25.601 Vali Acc: 0.480 Test Loss: 25.601 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.9490818977355957
Epoch: 19, Steps: 13 | Train Loss: 3.429 Vali Loss: 31.667 Vali Acc: 0.460 Test Loss: 31.667 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 4033921
model size : 16.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 6.075432777404785
Epoch: 1, Steps: 13 | Train Loss: 1.916 Vali Loss: 2.141 Vali Acc: 0.200 Test Loss: 2.141 Test Acc: 0.200
Validation loss decreased (inf --> -0.199979).  Saving model ...
Epoch: 2 cost time: 3.8074822425842285
Epoch: 2, Steps: 13 | Train Loss: 2.408 Vali Loss: 1.657 Vali Acc: 0.340 Test Loss: 1.657 Test Acc: 0.340
Validation loss decreased (-0.199979 --> -0.339983).  Saving model ...
Epoch: 3 cost time: 3.6865904331207275
Epoch: 3, Steps: 13 | Train Loss: 1.548 Vali Loss: 4.921 Vali Acc: 0.300 Test Loss: 4.921 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.7892422676086426
Epoch: 4, Steps: 13 | Train Loss: 4.307 Vali Loss: 4.376 Vali Acc: 0.320 Test Loss: 4.376 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.733933210372925
Epoch: 5, Steps: 13 | Train Loss: 2.783 Vali Loss: 3.547 Vali Acc: 0.320 Test Loss: 3.547 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.3922743797302246
Epoch: 6, Steps: 13 | Train Loss: 4.956 Vali Loss: 6.998 Vali Acc: 0.340 Test Loss: 6.998 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.513831853866577
Epoch: 7, Steps: 13 | Train Loss: 4.741 Vali Loss: 8.386 Vali Acc: 0.360 Test Loss: 8.386 Test Acc: 0.360
Validation loss decreased (-0.339983 --> -0.359916).  Saving model ...
Epoch: 8 cost time: 3.6776366233825684
Epoch: 8, Steps: 13 | Train Loss: 3.971 Vali Loss: 8.487 Vali Acc: 0.360 Test Loss: 8.487 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.503952980041504
Epoch: 9, Steps: 13 | Train Loss: 3.645 Vali Loss: 7.281 Vali Acc: 0.380 Test Loss: 7.281 Test Acc: 0.380
Validation loss decreased (-0.359916 --> -0.379927).  Saving model ...
Epoch: 10 cost time: 3.63918137550354
Epoch: 10, Steps: 13 | Train Loss: 5.122 Vali Loss: 6.902 Vali Acc: 0.480 Test Loss: 6.902 Test Acc: 0.480
Validation loss decreased (-0.379927 --> -0.479931).  Saving model ...
Epoch: 11 cost time: 3.557866334915161
Epoch: 11, Steps: 13 | Train Loss: 2.188 Vali Loss: 6.171 Vali Acc: 0.480 Test Loss: 6.171 Test Acc: 0.480
Validation loss decreased (-0.479931 --> -0.479938).  Saving model ...
Epoch: 12 cost time: 3.4800844192504883
Epoch: 12, Steps: 13 | Train Loss: 0.770 Vali Loss: 6.101 Vali Acc: 0.500 Test Loss: 6.101 Test Acc: 0.500
Validation loss decreased (-0.479938 --> -0.499939).  Saving model ...
Epoch: 13 cost time: 3.4927821159362793
Epoch: 13, Steps: 13 | Train Loss: 0.954 Vali Loss: 6.322 Vali Acc: 0.500 Test Loss: 6.322 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.620777130126953
Epoch: 14, Steps: 13 | Train Loss: 0.977 Vali Loss: 5.802 Vali Acc: 0.460 Test Loss: 5.802 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.80790114402771
Epoch: 15, Steps: 13 | Train Loss: 1.331 Vali Loss: 7.513 Vali Acc: 0.460 Test Loss: 7.513 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.7214818000793457
Epoch: 16, Steps: 13 | Train Loss: 0.653 Vali Loss: 7.561 Vali Acc: 0.540 Test Loss: 7.561 Test Acc: 0.540
Validation loss decreased (-0.499939 --> -0.539924).  Saving model ...
Epoch: 17 cost time: 3.4356815814971924
Epoch: 17, Steps: 13 | Train Loss: 0.548 Vali Loss: 6.798 Vali Acc: 0.460 Test Loss: 6.798 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.5233681201934814
Epoch: 18, Steps: 13 | Train Loss: 0.896 Vali Loss: 5.619 Vali Acc: 0.440 Test Loss: 5.619 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.929602861404419
Epoch: 19, Steps: 13 | Train Loss: 0.260 Vali Loss: 6.107 Vali Acc: 0.520 Test Loss: 6.107 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.382951259613037
Epoch: 20, Steps: 13 | Train Loss: 0.044 Vali Loss: 7.211 Vali Acc: 0.400 Test Loss: 7.211 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.6729419231414795
Epoch: 21, Steps: 13 | Train Loss: 0.056 Vali Loss: 8.689 Vali Acc: 0.440 Test Loss: 8.689 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 4.039783954620361
Epoch: 22, Steps: 13 | Train Loss: 0.355 Vali Loss: 9.006 Vali Acc: 0.460 Test Loss: 9.006 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.7257542610168457
Epoch: 23, Steps: 13 | Train Loss: 0.001 Vali Loss: 12.181 Vali Acc: 0.420 Test Loss: 12.181 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.6784043312072754
Epoch: 24, Steps: 13 | Train Loss: 0.026 Vali Loss: 8.896 Vali Acc: 0.480 Test Loss: 8.896 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.560831069946289
Epoch: 25, Steps: 13 | Train Loss: 0.663 Vali Loss: 6.782 Vali Acc: 0.540 Test Loss: 6.782 Test Acc: 0.540
Validation loss decreased (-0.539924 --> -0.539932).  Saving model ...
Epoch: 26 cost time: 4.092103481292725
Epoch: 26, Steps: 13 | Train Loss: 1.448 Vali Loss: 11.152 Vali Acc: 0.460 Test Loss: 11.152 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.726269245147705
Epoch: 27, Steps: 13 | Train Loss: 0.110 Vali Loss: 9.441 Vali Acc: 0.420 Test Loss: 9.441 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.409156084060669
Epoch: 28, Steps: 13 | Train Loss: 0.277 Vali Loss: 10.115 Vali Acc: 0.500 Test Loss: 10.115 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.7073724269866943
Epoch: 29, Steps: 13 | Train Loss: 0.100 Vali Loss: 7.963 Vali Acc: 0.520 Test Loss: 7.963 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.6802942752838135
Epoch: 30, Steps: 13 | Train Loss: 0.000 Vali Loss: 13.071 Vali Acc: 0.480 Test Loss: 13.071 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.893758773803711
Epoch: 31, Steps: 13 | Train Loss: 0.099 Vali Loss: 8.482 Vali Acc: 0.560 Test Loss: 8.482 Test Acc: 0.560
Validation loss decreased (-0.539932 --> -0.559915).  Saving model ...
Epoch: 32 cost time: 3.8796048164367676
Epoch: 32, Steps: 13 | Train Loss: 0.004 Vali Loss: 11.997 Vali Acc: 0.460 Test Loss: 11.997 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.6212704181671143
Epoch: 33, Steps: 13 | Train Loss: 0.176 Vali Loss: 9.477 Vali Acc: 0.540 Test Loss: 9.477 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.7761247158050537
Epoch: 34, Steps: 13 | Train Loss: 0.057 Vali Loss: 9.891 Vali Acc: 0.460 Test Loss: 9.891 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.6483302116394043
Epoch: 35, Steps: 13 | Train Loss: 0.004 Vali Loss: 9.487 Vali Acc: 0.480 Test Loss: 9.487 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 3.5386993885040283
Epoch: 36, Steps: 13 | Train Loss: 0.000 Vali Loss: 9.438 Vali Acc: 0.480 Test Loss: 9.438 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 3.765655517578125
Epoch: 37, Steps: 13 | Train Loss: 0.007 Vali Loss: 7.690 Vali Acc: 0.520 Test Loss: 7.690 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 3.8082022666931152
Epoch: 38, Steps: 13 | Train Loss: 0.276 Vali Loss: 7.176 Vali Acc: 0.580 Test Loss: 7.176 Test Acc: 0.580
Validation loss decreased (-0.559915 --> -0.579928).  Saving model ...
Epoch: 39 cost time: 3.7943906784057617
Epoch: 39, Steps: 13 | Train Loss: 0.085 Vali Loss: 9.568 Vali Acc: 0.480 Test Loss: 9.568 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.848968029022217
Epoch: 40, Steps: 13 | Train Loss: 0.000 Vali Loss: 9.798 Vali Acc: 0.500 Test Loss: 9.798 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.637202262878418
Epoch: 41, Steps: 13 | Train Loss: 1.290 Vali Loss: 17.885 Vali Acc: 0.420 Test Loss: 17.885 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 3.4107561111450195
Epoch: 42, Steps: 13 | Train Loss: 0.243 Vali Loss: 13.168 Vali Acc: 0.380 Test Loss: 13.168 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 3.404325485229492
Epoch: 43, Steps: 13 | Train Loss: 1.419 Vali Loss: 13.646 Vali Acc: 0.520 Test Loss: 13.646 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 3.308922290802002
Epoch: 44, Steps: 13 | Train Loss: 0.084 Vali Loss: 11.659 Vali Acc: 0.500 Test Loss: 11.659 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 3.6507747173309326
Epoch: 45, Steps: 13 | Train Loss: 0.245 Vali Loss: 15.048 Vali Acc: 0.480 Test Loss: 15.048 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 3.377107858657837
Epoch: 46, Steps: 13 | Train Loss: 0.735 Vali Loss: 15.061 Vali Acc: 0.440 Test Loss: 15.061 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 3.4794678688049316
Epoch: 47, Steps: 13 | Train Loss: 1.500 Vali Loss: 17.443 Vali Acc: 0.460 Test Loss: 17.443 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 3.5653226375579834
Epoch: 48, Steps: 13 | Train Loss: 1.099 Vali Loss: 16.753 Vali Acc: 0.360 Test Loss: 16.753 Test Acc: 0.360
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 2398497
model size : 9.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.6291749477386475
Epoch: 1, Steps: 13 | Train Loss: 2.538 Vali Loss: 3.732 Vali Acc: 0.260 Test Loss: 3.732 Test Acc: 0.260
Validation loss decreased (inf --> -0.259963).  Saving model ...
Epoch: 2 cost time: 3.649604320526123
Epoch: 2, Steps: 13 | Train Loss: 3.186 Vali Loss: 1.994 Vali Acc: 0.340 Test Loss: 1.994 Test Acc: 0.340
Validation loss decreased (-0.259963 --> -0.339980).  Saving model ...
Epoch: 3 cost time: 3.3557112216949463
Epoch: 3, Steps: 13 | Train Loss: 2.110 Vali Loss: 2.752 Vali Acc: 0.400 Test Loss: 2.752 Test Acc: 0.400
Validation loss decreased (-0.339980 --> -0.399972).  Saving model ...
Epoch: 4 cost time: 3.44919753074646
Epoch: 4, Steps: 13 | Train Loss: 2.463 Vali Loss: 2.327 Vali Acc: 0.460 Test Loss: 2.327 Test Acc: 0.460
Validation loss decreased (-0.399972 --> -0.459977).  Saving model ...
Epoch: 5 cost time: 3.584211587905884
Epoch: 5, Steps: 13 | Train Loss: 1.972 Vali Loss: 4.206 Vali Acc: 0.440 Test Loss: 4.206 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.309598684310913
Epoch: 6, Steps: 13 | Train Loss: 2.972 Vali Loss: 3.363 Vali Acc: 0.580 Test Loss: 3.363 Test Acc: 0.580
Validation loss decreased (-0.459977 --> -0.579966).  Saving model ...
Epoch: 7 cost time: 3.4295380115509033
Epoch: 7, Steps: 13 | Train Loss: 2.820 Vali Loss: 6.590 Vali Acc: 0.380 Test Loss: 6.590 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.556349277496338
Epoch: 8, Steps: 13 | Train Loss: 1.886 Vali Loss: 5.391 Vali Acc: 0.420 Test Loss: 5.391 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.341336965560913
Epoch: 9, Steps: 13 | Train Loss: 1.416 Vali Loss: 5.897 Vali Acc: 0.520 Test Loss: 5.897 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.430062770843506
Epoch: 10, Steps: 13 | Train Loss: 1.365 Vali Loss: 12.237 Vali Acc: 0.400 Test Loss: 12.237 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.3621528148651123
Epoch: 11, Steps: 13 | Train Loss: 2.714 Vali Loss: 7.298 Vali Acc: 0.400 Test Loss: 7.298 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.3042542934417725
Epoch: 12, Steps: 13 | Train Loss: 1.774 Vali Loss: 5.410 Vali Acc: 0.480 Test Loss: 5.410 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.4689042568206787
Epoch: 13, Steps: 13 | Train Loss: 0.871 Vali Loss: 8.949 Vali Acc: 0.500 Test Loss: 8.949 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.7015814781188965
Epoch: 14, Steps: 13 | Train Loss: 1.667 Vali Loss: 10.703 Vali Acc: 0.420 Test Loss: 10.703 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.9359676837921143
Epoch: 15, Steps: 13 | Train Loss: 3.034 Vali Loss: 5.470 Vali Acc: 0.580 Test Loss: 5.470 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.3791556358337402
Epoch: 16, Steps: 13 | Train Loss: 2.216 Vali Loss: 8.959 Vali Acc: 0.500 Test Loss: 8.959 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 2397089
model size : 9.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 6.601534605026245
Epoch: 1, Steps: 13 | Train Loss: 1.970 Vali Loss: 2.208 Vali Acc: 0.220 Test Loss: 2.208 Test Acc: 0.220
Validation loss decreased (inf --> -0.219978).  Saving model ...
Epoch: 2 cost time: 3.3411052227020264
Epoch: 2, Steps: 13 | Train Loss: 2.222 Vali Loss: 3.011 Vali Acc: 0.240 Test Loss: 3.011 Test Acc: 0.240
Validation loss decreased (-0.219978 --> -0.239970).  Saving model ...
Epoch: 3 cost time: 3.517616033554077
Epoch: 3, Steps: 13 | Train Loss: 2.307 Vali Loss: 2.371 Vali Acc: 0.520 Test Loss: 2.371 Test Acc: 0.520
Validation loss decreased (-0.239970 --> -0.519976).  Saving model ...
Epoch: 4 cost time: 3.661106824874878
Epoch: 4, Steps: 13 | Train Loss: 1.429 Vali Loss: 2.272 Vali Acc: 0.480 Test Loss: 2.272 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.595402717590332
Epoch: 5, Steps: 13 | Train Loss: 2.196 Vali Loss: 5.287 Vali Acc: 0.360 Test Loss: 5.287 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.5292656421661377
Epoch: 6, Steps: 13 | Train Loss: 1.803 Vali Loss: 7.126 Vali Acc: 0.380 Test Loss: 7.126 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.6672685146331787
Epoch: 7, Steps: 13 | Train Loss: 3.100 Vali Loss: 6.704 Vali Acc: 0.440 Test Loss: 6.704 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.4562456607818604
Epoch: 8, Steps: 13 | Train Loss: 2.555 Vali Loss: 6.790 Vali Acc: 0.300 Test Loss: 6.790 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.3083837032318115
Epoch: 9, Steps: 13 | Train Loss: 2.136 Vali Loss: 5.426 Vali Acc: 0.500 Test Loss: 5.426 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.4105310440063477
Epoch: 10, Steps: 13 | Train Loss: 1.376 Vali Loss: 8.452 Vali Acc: 0.360 Test Loss: 8.452 Test Acc: 0.360
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.6203858852386475
Epoch: 11, Steps: 13 | Train Loss: 6.170 Vali Loss: 12.478 Vali Acc: 0.400 Test Loss: 12.478 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.552593946456909
Epoch: 12, Steps: 13 | Train Loss: 2.716 Vali Loss: 10.472 Vali Acc: 0.380 Test Loss: 10.472 Test Acc: 0.380
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.3001089096069336
Epoch: 13, Steps: 13 | Train Loss: 2.042 Vali Loss: 9.756 Vali Acc: 0.500 Test Loss: 9.756 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 2395681
model size : 9.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.413858413696289
Epoch: 1, Steps: 13 | Train Loss: 2.120 Vali Loss: 3.104 Vali Acc: 0.200 Test Loss: 3.104 Test Acc: 0.200
Validation loss decreased (inf --> -0.199969).  Saving model ...
Epoch: 2 cost time: 3.425161123275757
Epoch: 2, Steps: 13 | Train Loss: 2.320 Vali Loss: 2.332 Vali Acc: 0.320 Test Loss: 2.332 Test Acc: 0.320
Validation loss decreased (-0.199969 --> -0.319977).  Saving model ...
Epoch: 3 cost time: 3.2599117755889893
Epoch: 3, Steps: 13 | Train Loss: 2.337 Vali Loss: 4.985 Vali Acc: 0.240 Test Loss: 4.985 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.574803113937378
Epoch: 4, Steps: 13 | Train Loss: 3.664 Vali Loss: 6.865 Vali Acc: 0.320 Test Loss: 6.865 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.1851024627685547
Epoch: 5, Steps: 13 | Train Loss: 5.058 Vali Loss: 3.727 Vali Acc: 0.320 Test Loss: 3.727 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.5199031829833984
Epoch: 6, Steps: 13 | Train Loss: 3.269 Vali Loss: 3.503 Vali Acc: 0.440 Test Loss: 3.503 Test Acc: 0.440
Validation loss decreased (-0.319977 --> -0.439965).  Saving model ...
Epoch: 7 cost time: 3.2709271907806396
Epoch: 7, Steps: 13 | Train Loss: 5.038 Vali Loss: 4.413 Vali Acc: 0.500 Test Loss: 4.413 Test Acc: 0.500
Validation loss decreased (-0.439965 --> -0.499956).  Saving model ...
Epoch: 8 cost time: 3.2871806621551514
Epoch: 8, Steps: 13 | Train Loss: 2.502 Vali Loss: 5.238 Vali Acc: 0.500 Test Loss: 5.238 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.588824510574341
Epoch: 9, Steps: 13 | Train Loss: 4.061 Vali Loss: 6.683 Vali Acc: 0.540 Test Loss: 6.683 Test Acc: 0.540
Validation loss decreased (-0.499956 --> -0.539933).  Saving model ...
Epoch: 10 cost time: 3.270787000656128
Epoch: 10, Steps: 13 | Train Loss: 5.476 Vali Loss: 9.395 Vali Acc: 0.440 Test Loss: 9.395 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.35459303855896
Epoch: 11, Steps: 13 | Train Loss: 2.084 Vali Loss: 14.022 Vali Acc: 0.320 Test Loss: 14.022 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.2873170375823975
Epoch: 12, Steps: 13 | Train Loss: 0.962 Vali Loss: 9.646 Vali Acc: 0.500 Test Loss: 9.646 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.353811740875244
Epoch: 13, Steps: 13 | Train Loss: 3.914 Vali Loss: 12.376 Vali Acc: 0.440 Test Loss: 12.376 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.3636698722839355
Epoch: 14, Steps: 13 | Train Loss: 2.555 Vali Loss: 10.329 Vali Acc: 0.380 Test Loss: 10.329 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.2994680404663086
Epoch: 15, Steps: 13 | Train Loss: 1.716 Vali Loss: 9.219 Vali Acc: 0.420 Test Loss: 9.219 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.4044089317321777
Epoch: 16, Steps: 13 | Train Loss: 1.240 Vali Loss: 9.741 Vali Acc: 0.500 Test Loss: 9.741 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.213711738586426
Epoch: 17, Steps: 13 | Train Loss: 1.156 Vali Loss: 9.027 Vali Acc: 0.500 Test Loss: 9.027 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.140981912612915
Epoch: 18, Steps: 13 | Train Loss: 0.658 Vali Loss: 14.807 Vali Acc: 0.420 Test Loss: 14.807 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.133965253829956
Epoch: 19, Steps: 13 | Train Loss: 1.638 Vali Loss: 8.723 Vali Acc: 0.580 Test Loss: 8.723 Test Acc: 0.580
Validation loss decreased (-0.539933 --> -0.579913).  Saving model ...
Epoch: 20 cost time: 3.3078110218048096
Epoch: 20, Steps: 13 | Train Loss: 2.241 Vali Loss: 14.025 Vali Acc: 0.340 Test Loss: 14.025 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.600571393966675
Epoch: 21, Steps: 13 | Train Loss: 0.012 Vali Loss: 9.054 Vali Acc: 0.440 Test Loss: 9.054 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.1707797050476074
Epoch: 22, Steps: 13 | Train Loss: 0.139 Vali Loss: 10.549 Vali Acc: 0.440 Test Loss: 10.549 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.1410892009735107
Epoch: 23, Steps: 13 | Train Loss: 0.369 Vali Loss: 9.323 Vali Acc: 0.420 Test Loss: 9.323 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.1901562213897705
Epoch: 24, Steps: 13 | Train Loss: 0.116 Vali Loss: 10.364 Vali Acc: 0.440 Test Loss: 10.364 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.375098466873169
Epoch: 25, Steps: 13 | Train Loss: 0.730 Vali Loss: 11.389 Vali Acc: 0.500 Test Loss: 11.389 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.262690782546997
Epoch: 26, Steps: 13 | Train Loss: 0.971 Vali Loss: 17.078 Vali Acc: 0.400 Test Loss: 17.078 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.630197763442993
Epoch: 27, Steps: 13 | Train Loss: 10.200 Vali Loss: 16.082 Vali Acc: 0.400 Test Loss: 16.082 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.710811138153076
Epoch: 28, Steps: 13 | Train Loss: 1.442 Vali Loss: 11.799 Vali Acc: 0.460 Test Loss: 11.799 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.201220989227295
Epoch: 29, Steps: 13 | Train Loss: 1.758 Vali Loss: 13.405 Vali Acc: 0.380 Test Loss: 13.405 Test Acc: 0.380
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 2394273
model size : 9.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.297851085662842
Epoch: 1, Steps: 13 | Train Loss: 2.170 Vali Loss: 4.508 Vali Acc: 0.200 Test Loss: 4.508 Test Acc: 0.200
Validation loss decreased (inf --> -0.199955).  Saving model ...
Epoch: 2 cost time: 2.983997106552124
Epoch: 2, Steps: 13 | Train Loss: 3.728 Vali Loss: 2.468 Vali Acc: 0.220 Test Loss: 2.468 Test Acc: 0.220
Validation loss decreased (-0.199955 --> -0.219975).  Saving model ...
Epoch: 3 cost time: 2.9449689388275146
Epoch: 3, Steps: 13 | Train Loss: 1.757 Vali Loss: 2.896 Vali Acc: 0.260 Test Loss: 2.896 Test Acc: 0.260
Validation loss decreased (-0.219975 --> -0.259971).  Saving model ...
Epoch: 4 cost time: 3.062753915786743
Epoch: 4, Steps: 13 | Train Loss: 3.208 Vali Loss: 3.372 Vali Acc: 0.220 Test Loss: 3.372 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.141782522201538
Epoch: 5, Steps: 13 | Train Loss: 4.171 Vali Loss: 10.526 Vali Acc: 0.200 Test Loss: 10.526 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.07424259185791
Epoch: 6, Steps: 13 | Train Loss: 5.195 Vali Loss: 7.501 Vali Acc: 0.300 Test Loss: 7.501 Test Acc: 0.300
Validation loss decreased (-0.259971 --> -0.299925).  Saving model ...
Epoch: 7 cost time: 2.8270983695983887
Epoch: 7, Steps: 13 | Train Loss: 6.214 Vali Loss: 12.256 Vali Acc: 0.260 Test Loss: 12.256 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.1882216930389404
Epoch: 8, Steps: 13 | Train Loss: 6.604 Vali Loss: 14.639 Vali Acc: 0.240 Test Loss: 14.639 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.6801044940948486
Epoch: 9, Steps: 13 | Train Loss: 3.139 Vali Loss: 7.736 Vali Acc: 0.400 Test Loss: 7.736 Test Acc: 0.400
Validation loss decreased (-0.299925 --> -0.399923).  Saving model ...
Epoch: 10 cost time: 2.8163797855377197
Epoch: 10, Steps: 13 | Train Loss: 4.654 Vali Loss: 9.480 Vali Acc: 0.320 Test Loss: 9.480 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.012042284011841
Epoch: 11, Steps: 13 | Train Loss: 2.897 Vali Loss: 11.522 Vali Acc: 0.320 Test Loss: 11.522 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.9114325046539307
Epoch: 12, Steps: 13 | Train Loss: 3.875 Vali Loss: 11.948 Vali Acc: 0.500 Test Loss: 11.948 Test Acc: 0.500
Validation loss decreased (-0.399923 --> -0.499881).  Saving model ...
Epoch: 13 cost time: 2.857292652130127
Epoch: 13, Steps: 13 | Train Loss: 6.302 Vali Loss: 10.523 Vali Acc: 0.340 Test Loss: 10.523 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.9270737171173096
Epoch: 14, Steps: 13 | Train Loss: 1.571 Vali Loss: 9.390 Vali Acc: 0.420 Test Loss: 9.390 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.1198041439056396
Epoch: 15, Steps: 13 | Train Loss: 1.964 Vali Loss: 19.462 Vali Acc: 0.380 Test Loss: 19.462 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.260436534881592
Epoch: 16, Steps: 13 | Train Loss: 3.346 Vali Loss: 10.557 Vali Acc: 0.420 Test Loss: 10.557 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.31745982170105
Epoch: 17, Steps: 13 | Train Loss: 1.289 Vali Loss: 10.140 Vali Acc: 0.480 Test Loss: 10.140 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.0918922424316406
Epoch: 18, Steps: 13 | Train Loss: 1.730 Vali Loss: 8.848 Vali Acc: 0.480 Test Loss: 8.848 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.309448719024658
Epoch: 19, Steps: 13 | Train Loss: 0.695 Vali Loss: 8.051 Vali Acc: 0.500 Test Loss: 8.051 Test Acc: 0.500
Validation loss decreased (-0.499881 --> -0.499919).  Saving model ...
Epoch: 20 cost time: 2.911161422729492
Epoch: 20, Steps: 13 | Train Loss: 0.770 Vali Loss: 7.861 Vali Acc: 0.520 Test Loss: 7.861 Test Acc: 0.520
Validation loss decreased (-0.499919 --> -0.519921).  Saving model ...
Epoch: 21 cost time: 3.183732032775879
Epoch: 21, Steps: 13 | Train Loss: 0.088 Vali Loss: 10.736 Vali Acc: 0.500 Test Loss: 10.736 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.0694406032562256
Epoch: 22, Steps: 13 | Train Loss: 0.534 Vali Loss: 11.259 Vali Acc: 0.540 Test Loss: 11.259 Test Acc: 0.540
Validation loss decreased (-0.519921 --> -0.539887).  Saving model ...
Epoch: 23 cost time: 2.936981439590454
Epoch: 23, Steps: 13 | Train Loss: 0.190 Vali Loss: 10.589 Vali Acc: 0.460 Test Loss: 10.589 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.9039478302001953
Epoch: 24, Steps: 13 | Train Loss: 0.165 Vali Loss: 6.750 Vali Acc: 0.540 Test Loss: 6.750 Test Acc: 0.540
Validation loss decreased (-0.539887 --> -0.539933).  Saving model ...
Epoch: 25 cost time: 2.8024985790252686
Epoch: 25, Steps: 13 | Train Loss: 0.219 Vali Loss: 6.902 Vali Acc: 0.520 Test Loss: 6.902 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.914160966873169
Epoch: 26, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.621 Vali Acc: 0.500 Test Loss: 7.621 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.29837703704834
Epoch: 27, Steps: 13 | Train Loss: 0.032 Vali Loss: 8.042 Vali Acc: 0.500 Test Loss: 8.042 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.0668795108795166
Epoch: 28, Steps: 13 | Train Loss: 0.002 Vali Loss: 9.193 Vali Acc: 0.520 Test Loss: 9.193 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.1588029861450195
Epoch: 29, Steps: 13 | Train Loss: 0.336 Vali Loss: 10.051 Vali Acc: 0.460 Test Loss: 10.051 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.205354928970337
Epoch: 30, Steps: 13 | Train Loss: 0.054 Vali Loss: 10.296 Vali Acc: 0.420 Test Loss: 10.296 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 3.0080015659332275
Epoch: 31, Steps: 13 | Train Loss: 0.156 Vali Loss: 12.691 Vali Acc: 0.420 Test Loss: 12.691 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 3.145042896270752
Epoch: 32, Steps: 13 | Train Loss: 0.406 Vali Loss: 8.230 Vali Acc: 0.560 Test Loss: 8.230 Test Acc: 0.560
Validation loss decreased (-0.539933 --> -0.559918).  Saving model ...
Epoch: 33 cost time: 3.0857553482055664
Epoch: 33, Steps: 13 | Train Loss: 0.349 Vali Loss: 9.249 Vali Acc: 0.520 Test Loss: 9.249 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.8744382858276367
Epoch: 34, Steps: 13 | Train Loss: 0.882 Vali Loss: 15.963 Vali Acc: 0.380 Test Loss: 15.963 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.976396322250366
Epoch: 35, Steps: 13 | Train Loss: 0.612 Vali Loss: 14.900 Vali Acc: 0.420 Test Loss: 14.900 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 3.186317205429077
Epoch: 36, Steps: 13 | Train Loss: 0.629 Vali Loss: 22.977 Vali Acc: 0.360 Test Loss: 22.977 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 2.9335379600524902
Epoch: 37, Steps: 13 | Train Loss: 0.090 Vali Loss: 15.663 Vali Acc: 0.400 Test Loss: 15.663 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 3.128713607788086
Epoch: 38, Steps: 13 | Train Loss: 0.001 Vali Loss: 16.539 Vali Acc: 0.580 Test Loss: 16.539 Test Acc: 0.580
Validation loss decreased (-0.559918 --> -0.579835).  Saving model ...
Epoch: 39 cost time: 3.2000393867492676
Epoch: 39, Steps: 13 | Train Loss: 0.735 Vali Loss: 13.227 Vali Acc: 0.480 Test Loss: 13.227 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.0492873191833496
Epoch: 40, Steps: 13 | Train Loss: 1.418 Vali Loss: 16.664 Vali Acc: 0.420 Test Loss: 16.664 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.071582555770874
Epoch: 41, Steps: 13 | Train Loss: 0.100 Vali Loss: 18.565 Vali Acc: 0.440 Test Loss: 18.565 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 2.968149423599243
Epoch: 42, Steps: 13 | Train Loss: 1.862 Vali Loss: 32.223 Vali Acc: 0.280 Test Loss: 32.223 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 2.9655838012695312
Epoch: 43, Steps: 13 | Train Loss: 0.060 Vali Loss: 24.127 Vali Acc: 0.400 Test Loss: 24.127 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 3.3039658069610596
Epoch: 44, Steps: 13 | Train Loss: 1.284 Vali Loss: 25.022 Vali Acc: 0.380 Test Loss: 25.022 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 3.0713319778442383
Epoch: 45, Steps: 13 | Train Loss: 0.899 Vali Loss: 18.141 Vali Acc: 0.440 Test Loss: 18.141 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 3.1506521701812744
Epoch: 46, Steps: 13 | Train Loss: 0.001 Vali Loss: 15.402 Vali Acc: 0.540 Test Loss: 15.402 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 3.1007397174835205
Epoch: 47, Steps: 13 | Train Loss: 0.002 Vali Loss: 16.306 Vali Acc: 0.420 Test Loss: 16.306 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 2.937285900115967
Epoch: 48, Steps: 13 | Train Loss: 0.738 Vali Loss: 17.052 Vali Acc: 0.440 Test Loss: 17.052 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 2098977
model size : 8.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 6.379338026046753
Epoch: 1, Steps: 13 | Train Loss: 2.694 Vali Loss: 3.855 Vali Acc: 0.200 Test Loss: 3.855 Test Acc: 0.200
Validation loss decreased (inf --> -0.199961).  Saving model ...
Epoch: 2 cost time: 3.5710067749023438
Epoch: 2, Steps: 13 | Train Loss: 3.200 Vali Loss: 4.923 Vali Acc: 0.240 Test Loss: 4.923 Test Acc: 0.240
Validation loss decreased (-0.199961 --> -0.239951).  Saving model ...
Epoch: 3 cost time: 3.356004476547241
Epoch: 3, Steps: 13 | Train Loss: 3.921 Vali Loss: 4.962 Vali Acc: 0.220 Test Loss: 4.962 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.3446624279022217
Epoch: 4, Steps: 13 | Train Loss: 4.430 Vali Loss: 5.100 Vali Acc: 0.280 Test Loss: 5.100 Test Acc: 0.280
Validation loss decreased (-0.239951 --> -0.279949).  Saving model ...
Epoch: 5 cost time: 3.328467607498169
Epoch: 5, Steps: 13 | Train Loss: 2.893 Vali Loss: 6.134 Vali Acc: 0.300 Test Loss: 6.134 Test Acc: 0.300
Validation loss decreased (-0.279949 --> -0.299939).  Saving model ...
Epoch: 6 cost time: 3.4627435207366943
Epoch: 6, Steps: 13 | Train Loss: 4.460 Vali Loss: 3.354 Vali Acc: 0.340 Test Loss: 3.354 Test Acc: 0.340
Validation loss decreased (-0.299939 --> -0.339966).  Saving model ...
Epoch: 7 cost time: 3.270174741744995
Epoch: 7, Steps: 13 | Train Loss: 2.036 Vali Loss: 8.999 Vali Acc: 0.280 Test Loss: 8.999 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.3598902225494385
Epoch: 8, Steps: 13 | Train Loss: 4.799 Vali Loss: 3.444 Vali Acc: 0.480 Test Loss: 3.444 Test Acc: 0.480
Validation loss decreased (-0.339966 --> -0.479966).  Saving model ...
Epoch: 9 cost time: 3.383666753768921
Epoch: 9, Steps: 13 | Train Loss: 1.835 Vali Loss: 3.552 Vali Acc: 0.560 Test Loss: 3.552 Test Acc: 0.560
Validation loss decreased (-0.479966 --> -0.559964).  Saving model ...
Epoch: 10 cost time: 3.7264010906219482
Epoch: 10, Steps: 13 | Train Loss: 1.569 Vali Loss: 10.395 Vali Acc: 0.400 Test Loss: 10.395 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.337224245071411
Epoch: 11, Steps: 13 | Train Loss: 4.322 Vali Loss: 5.341 Vali Acc: 0.480 Test Loss: 5.341 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.099759578704834
Epoch: 12, Steps: 13 | Train Loss: 2.480 Vali Loss: 5.757 Vali Acc: 0.500 Test Loss: 5.757 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.444445848464966
Epoch: 13, Steps: 13 | Train Loss: 1.733 Vali Loss: 7.575 Vali Acc: 0.540 Test Loss: 7.575 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.2369637489318848
Epoch: 14, Steps: 13 | Train Loss: 1.778 Vali Loss: 6.350 Vali Acc: 0.500 Test Loss: 6.350 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.2519121170043945
Epoch: 15, Steps: 13 | Train Loss: 0.798 Vali Loss: 11.211 Vali Acc: 0.500 Test Loss: 11.211 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.2806406021118164
Epoch: 16, Steps: 13 | Train Loss: 1.505 Vali Loss: 6.069 Vali Acc: 0.500 Test Loss: 6.069 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.297842502593994
Epoch: 17, Steps: 13 | Train Loss: 3.037 Vali Loss: 13.231 Vali Acc: 0.420 Test Loss: 13.231 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.0681731700897217
Epoch: 18, Steps: 13 | Train Loss: 1.635 Vali Loss: 12.993 Vali Acc: 0.400 Test Loss: 12.993 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.1614723205566406
Epoch: 19, Steps: 13 | Train Loss: 0.719 Vali Loss: 8.728 Vali Acc: 0.480 Test Loss: 8.728 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 2097569
model size : 8.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.684710502624512
Epoch: 1, Steps: 13 | Train Loss: 2.174 Vali Loss: 3.172 Vali Acc: 0.200 Test Loss: 3.172 Test Acc: 0.200
Validation loss decreased (inf --> -0.199968).  Saving model ...
Epoch: 2 cost time: 3.1631882190704346
Epoch: 2, Steps: 13 | Train Loss: 2.901 Vali Loss: 4.662 Vali Acc: 0.240 Test Loss: 4.662 Test Acc: 0.240
Validation loss decreased (-0.199968 --> -0.239953).  Saving model ...
Epoch: 3 cost time: 3.752739906311035
Epoch: 3, Steps: 13 | Train Loss: 3.234 Vali Loss: 3.932 Vali Acc: 0.200 Test Loss: 3.932 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.4600112438201904
Epoch: 4, Steps: 13 | Train Loss: 2.003 Vali Loss: 4.143 Vali Acc: 0.200 Test Loss: 4.143 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.1997785568237305
Epoch: 5, Steps: 13 | Train Loss: 2.250 Vali Loss: 6.399 Vali Acc: 0.240 Test Loss: 6.399 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.099787473678589
Epoch: 6, Steps: 13 | Train Loss: 3.059 Vali Loss: 8.795 Vali Acc: 0.260 Test Loss: 8.795 Test Acc: 0.260
Validation loss decreased (-0.239953 --> -0.259912).  Saving model ...
Epoch: 7 cost time: 3.020096778869629
Epoch: 7, Steps: 13 | Train Loss: 3.533 Vali Loss: 3.038 Vali Acc: 0.420 Test Loss: 3.038 Test Acc: 0.420
Validation loss decreased (-0.259912 --> -0.419970).  Saving model ...
Epoch: 8 cost time: 3.1751646995544434
Epoch: 8, Steps: 13 | Train Loss: 2.286 Vali Loss: 9.284 Vali Acc: 0.360 Test Loss: 9.284 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.068427562713623
Epoch: 9, Steps: 13 | Train Loss: 1.825 Vali Loss: 8.223 Vali Acc: 0.400 Test Loss: 8.223 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.0273327827453613
Epoch: 10, Steps: 13 | Train Loss: 1.997 Vali Loss: 8.597 Vali Acc: 0.400 Test Loss: 8.597 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.2703843116760254
Epoch: 11, Steps: 13 | Train Loss: 1.734 Vali Loss: 8.564 Vali Acc: 0.460 Test Loss: 8.564 Test Acc: 0.460
Validation loss decreased (-0.419970 --> -0.459914).  Saving model ...
Epoch: 12 cost time: 3.177276849746704
Epoch: 12, Steps: 13 | Train Loss: 1.260 Vali Loss: 8.352 Vali Acc: 0.480 Test Loss: 8.352 Test Acc: 0.480
Validation loss decreased (-0.459914 --> -0.479916).  Saving model ...
Epoch: 13 cost time: 3.0343055725097656
Epoch: 13, Steps: 13 | Train Loss: 1.868 Vali Loss: 10.454 Vali Acc: 0.360 Test Loss: 10.454 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.4220869541168213
Epoch: 14, Steps: 13 | Train Loss: 1.587 Vali Loss: 11.882 Vali Acc: 0.360 Test Loss: 11.882 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.255514144897461
Epoch: 15, Steps: 13 | Train Loss: 1.123 Vali Loss: 7.564 Vali Acc: 0.420 Test Loss: 7.564 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.878632068634033
Epoch: 16, Steps: 13 | Train Loss: 2.732 Vali Loss: 12.912 Vali Acc: 0.400 Test Loss: 12.912 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.4349775314331055
Epoch: 17, Steps: 13 | Train Loss: 1.254 Vali Loss: 14.920 Vali Acc: 0.440 Test Loss: 14.920 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.4648871421813965
Epoch: 18, Steps: 13 | Train Loss: 2.876 Vali Loss: 8.534 Vali Acc: 0.500 Test Loss: 8.534 Test Acc: 0.500
Validation loss decreased (-0.479916 --> -0.499915).  Saving model ...
Epoch: 19 cost time: 3.2138001918792725
Epoch: 19, Steps: 13 | Train Loss: 1.077 Vali Loss: 11.163 Vali Acc: 0.420 Test Loss: 11.163 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.465085506439209
Epoch: 20, Steps: 13 | Train Loss: 1.021 Vali Loss: 12.050 Vali Acc: 0.420 Test Loss: 12.050 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.3644537925720215
Epoch: 21, Steps: 13 | Train Loss: 1.374 Vali Loss: 12.582 Vali Acc: 0.360 Test Loss: 12.582 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.5293195247650146
Epoch: 22, Steps: 13 | Train Loss: 0.533 Vali Loss: 8.872 Vali Acc: 0.520 Test Loss: 8.872 Test Acc: 0.520
Validation loss decreased (-0.499915 --> -0.519911).  Saving model ...
Epoch: 23 cost time: 3.44195556640625
Epoch: 23, Steps: 13 | Train Loss: 0.000 Vali Loss: 9.340 Vali Acc: 0.480 Test Loss: 9.340 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.45007586479187
Epoch: 24, Steps: 13 | Train Loss: 0.185 Vali Loss: 11.790 Vali Acc: 0.440 Test Loss: 11.790 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.453540086746216
Epoch: 25, Steps: 13 | Train Loss: 0.106 Vali Loss: 11.123 Vali Acc: 0.520 Test Loss: 11.123 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.326822280883789
Epoch: 26, Steps: 13 | Train Loss: 0.684 Vali Loss: 10.321 Vali Acc: 0.440 Test Loss: 10.321 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.4914298057556152
Epoch: 27, Steps: 13 | Train Loss: 0.001 Vali Loss: 12.178 Vali Acc: 0.540 Test Loss: 12.178 Test Acc: 0.540
Validation loss decreased (-0.519911 --> -0.539878).  Saving model ...
Epoch: 28 cost time: 3.44052791595459
Epoch: 28, Steps: 13 | Train Loss: 0.657 Vali Loss: 12.414 Vali Acc: 0.460 Test Loss: 12.414 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.4094505310058594
Epoch: 29, Steps: 13 | Train Loss: 0.071 Vali Loss: 12.574 Vali Acc: 0.460 Test Loss: 12.574 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.234238862991333
Epoch: 30, Steps: 13 | Train Loss: 0.779 Vali Loss: 13.958 Vali Acc: 0.440 Test Loss: 13.958 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.2848243713378906
Epoch: 31, Steps: 13 | Train Loss: 0.516 Vali Loss: 15.085 Vali Acc: 0.500 Test Loss: 15.085 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.2613470554351807
Epoch: 32, Steps: 13 | Train Loss: 0.617 Vali Loss: 12.928 Vali Acc: 0.520 Test Loss: 12.928 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 3.335387945175171
Epoch: 33, Steps: 13 | Train Loss: 0.288 Vali Loss: 19.048 Vali Acc: 0.380 Test Loss: 19.048 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 3.0198686122894287
Epoch: 34, Steps: 13 | Train Loss: 0.471 Vali Loss: 14.724 Vali Acc: 0.460 Test Loss: 14.724 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 3.696307420730591
Epoch: 35, Steps: 13 | Train Loss: 0.004 Vali Loss: 15.063 Vali Acc: 0.440 Test Loss: 15.063 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 3.3253817558288574
Epoch: 36, Steps: 13 | Train Loss: 0.001 Vali Loss: 14.141 Vali Acc: 0.520 Test Loss: 14.141 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 3.1643869876861572
Epoch: 37, Steps: 13 | Train Loss: 0.026 Vali Loss: 18.656 Vali Acc: 0.460 Test Loss: 18.656 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 2096161
model size : 8.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.4389588832855225
Epoch: 1, Steps: 13 | Train Loss: 2.546 Vali Loss: 1.961 Vali Acc: 0.220 Test Loss: 1.961 Test Acc: 0.220
Validation loss decreased (inf --> -0.219980).  Saving model ...
Epoch: 2 cost time: 2.861477851867676
Epoch: 2, Steps: 13 | Train Loss: 2.994 Vali Loss: 6.219 Vali Acc: 0.200 Test Loss: 6.219 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.0554399490356445
Epoch: 3, Steps: 13 | Train Loss: 4.746 Vali Loss: 6.029 Vali Acc: 0.200 Test Loss: 6.029 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.2606630325317383
Epoch: 4, Steps: 13 | Train Loss: 2.562 Vali Loss: 4.587 Vali Acc: 0.380 Test Loss: 4.587 Test Acc: 0.380
Validation loss decreased (-0.219980 --> -0.379954).  Saving model ...
Epoch: 5 cost time: 2.8786685466766357
Epoch: 5, Steps: 13 | Train Loss: 1.994 Vali Loss: 5.452 Vali Acc: 0.260 Test Loss: 5.452 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.027569532394409
Epoch: 6, Steps: 13 | Train Loss: 2.537 Vali Loss: 4.261 Vali Acc: 0.440 Test Loss: 4.261 Test Acc: 0.440
Validation loss decreased (-0.379954 --> -0.439957).  Saving model ...
Epoch: 7 cost time: 3.0560054779052734
Epoch: 7, Steps: 13 | Train Loss: 4.591 Vali Loss: 7.610 Vali Acc: 0.420 Test Loss: 7.610 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.9782896041870117
Epoch: 8, Steps: 13 | Train Loss: 2.806 Vali Loss: 8.564 Vali Acc: 0.320 Test Loss: 8.564 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.0073113441467285
Epoch: 9, Steps: 13 | Train Loss: 4.093 Vali Loss: 8.145 Vali Acc: 0.440 Test Loss: 8.145 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.201450824737549
Epoch: 10, Steps: 13 | Train Loss: 3.770 Vali Loss: 11.996 Vali Acc: 0.380 Test Loss: 11.996 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.966533660888672
Epoch: 11, Steps: 13 | Train Loss: 4.271 Vali Loss: 8.174 Vali Acc: 0.480 Test Loss: 8.174 Test Acc: 0.480
Validation loss decreased (-0.439957 --> -0.479918).  Saving model ...
Epoch: 12 cost time: 3.015699863433838
Epoch: 12, Steps: 13 | Train Loss: 2.646 Vali Loss: 11.576 Vali Acc: 0.480 Test Loss: 11.576 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.902998208999634
Epoch: 13, Steps: 13 | Train Loss: 2.992 Vali Loss: 9.482 Vali Acc: 0.560 Test Loss: 9.482 Test Acc: 0.560
Validation loss decreased (-0.479918 --> -0.559905).  Saving model ...
Epoch: 14 cost time: 2.9221863746643066
Epoch: 14, Steps: 13 | Train Loss: 4.107 Vali Loss: 12.704 Vali Acc: 0.420 Test Loss: 12.704 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.9916703701019287
Epoch: 15, Steps: 13 | Train Loss: 4.020 Vali Loss: 26.757 Vali Acc: 0.360 Test Loss: 26.757 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.6034324169158936
Epoch: 16, Steps: 13 | Train Loss: 3.193 Vali Loss: 11.688 Vali Acc: 0.560 Test Loss: 11.688 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.933682918548584
Epoch: 17, Steps: 13 | Train Loss: 2.666 Vali Loss: 12.129 Vali Acc: 0.460 Test Loss: 12.129 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.77083420753479
Epoch: 18, Steps: 13 | Train Loss: 0.983 Vali Loss: 12.178 Vali Acc: 0.560 Test Loss: 12.178 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.9200809001922607
Epoch: 19, Steps: 13 | Train Loss: 0.424 Vali Loss: 8.988 Vali Acc: 0.560 Test Loss: 8.988 Test Acc: 0.560
Validation loss decreased (-0.559905 --> -0.559910).  Saving model ...
Epoch: 20 cost time: 2.743950605392456
Epoch: 20, Steps: 13 | Train Loss: 0.203 Vali Loss: 11.076 Vali Acc: 0.460 Test Loss: 11.076 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.7605676651000977
Epoch: 21, Steps: 13 | Train Loss: 0.020 Vali Loss: 8.913 Vali Acc: 0.520 Test Loss: 8.913 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.781954050064087
Epoch: 22, Steps: 13 | Train Loss: 0.047 Vali Loss: 10.680 Vali Acc: 0.480 Test Loss: 10.680 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.735562801361084
Epoch: 23, Steps: 13 | Train Loss: 0.414 Vali Loss: 11.272 Vali Acc: 0.420 Test Loss: 11.272 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.696937084197998
Epoch: 24, Steps: 13 | Train Loss: 0.153 Vali Loss: 12.460 Vali Acc: 0.440 Test Loss: 12.460 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.7878153324127197
Epoch: 25, Steps: 13 | Train Loss: 0.237 Vali Loss: 15.945 Vali Acc: 0.440 Test Loss: 15.945 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.8731396198272705
Epoch: 26, Steps: 13 | Train Loss: 0.636 Vali Loss: 12.127 Vali Acc: 0.460 Test Loss: 12.127 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.8205647468566895
Epoch: 27, Steps: 13 | Train Loss: 0.008 Vali Loss: 14.097 Vali Acc: 0.420 Test Loss: 14.097 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.7878193855285645
Epoch: 28, Steps: 13 | Train Loss: 0.005 Vali Loss: 10.427 Vali Acc: 0.480 Test Loss: 10.427 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.6422770023345947
Epoch: 29, Steps: 13 | Train Loss: 0.004 Vali Loss: 12.816 Vali Acc: 0.520 Test Loss: 12.816 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 2094753
model size : 8.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.087845087051392
Epoch: 1, Steps: 13 | Train Loss: 2.762 Vali Loss: 3.340 Vali Acc: 0.200 Test Loss: 3.340 Test Acc: 0.200
Validation loss decreased (inf --> -0.199967).  Saving model ...
Epoch: 2 cost time: 3.0441110134124756
Epoch: 2, Steps: 13 | Train Loss: 3.728 Vali Loss: 2.659 Vali Acc: 0.240 Test Loss: 2.659 Test Acc: 0.240
Validation loss decreased (-0.199967 --> -0.239973).  Saving model ...
Epoch: 3 cost time: 2.8571629524230957
Epoch: 3, Steps: 13 | Train Loss: 2.102 Vali Loss: 3.959 Vali Acc: 0.360 Test Loss: 3.959 Test Acc: 0.360
Validation loss decreased (-0.239973 --> -0.359960).  Saving model ...
Epoch: 4 cost time: 2.7808148860931396
Epoch: 4, Steps: 13 | Train Loss: 6.528 Vali Loss: 6.963 Vali Acc: 0.220 Test Loss: 6.963 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.8964884281158447
Epoch: 5, Steps: 13 | Train Loss: 3.045 Vali Loss: 2.677 Vali Acc: 0.400 Test Loss: 2.677 Test Acc: 0.400
Validation loss decreased (-0.359960 --> -0.399973).  Saving model ...
Epoch: 6 cost time: 3.606746196746826
Epoch: 6, Steps: 13 | Train Loss: 1.961 Vali Loss: 4.283 Vali Acc: 0.320 Test Loss: 4.283 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.7407290935516357
Epoch: 7, Steps: 13 | Train Loss: 1.656 Vali Loss: 4.265 Vali Acc: 0.420 Test Loss: 4.265 Test Acc: 0.420
Validation loss decreased (-0.399973 --> -0.419957).  Saving model ...
Epoch: 8 cost time: 2.8196144104003906
Epoch: 8, Steps: 13 | Train Loss: 1.401 Vali Loss: 8.193 Vali Acc: 0.380 Test Loss: 8.193 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.8767616748809814
Epoch: 9, Steps: 13 | Train Loss: 3.137 Vali Loss: 12.146 Vali Acc: 0.340 Test Loss: 12.146 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.7832629680633545
Epoch: 10, Steps: 13 | Train Loss: 2.326 Vali Loss: 6.375 Vali Acc: 0.580 Test Loss: 6.375 Test Acc: 0.580
Validation loss decreased (-0.419957 --> -0.579936).  Saving model ...
Epoch: 11 cost time: 2.713433265686035
Epoch: 11, Steps: 13 | Train Loss: 0.895 Vali Loss: 9.717 Vali Acc: 0.440 Test Loss: 9.717 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.712444305419922
Epoch: 12, Steps: 13 | Train Loss: 3.799 Vali Loss: 8.098 Vali Acc: 0.440 Test Loss: 8.098 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.7896032333374023
Epoch: 13, Steps: 13 | Train Loss: 3.762 Vali Loss: 9.851 Vali Acc: 0.400 Test Loss: 9.851 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.7509102821350098
Epoch: 14, Steps: 13 | Train Loss: 1.353 Vali Loss: 8.448 Vali Acc: 0.520 Test Loss: 8.448 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.671133279800415
Epoch: 15, Steps: 13 | Train Loss: 1.066 Vali Loss: 6.766 Vali Acc: 0.540 Test Loss: 6.766 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.9366674423217773
Epoch: 16, Steps: 13 | Train Loss: 2.057 Vali Loss: 12.959 Vali Acc: 0.520 Test Loss: 12.959 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.7732255458831787
Epoch: 17, Steps: 13 | Train Loss: 3.540 Vali Loss: 9.863 Vali Acc: 0.420 Test Loss: 9.863 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.580918312072754
Epoch: 18, Steps: 13 | Train Loss: 0.817 Vali Loss: 10.304 Vali Acc: 0.500 Test Loss: 10.304 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.872343063354492
Epoch: 19, Steps: 13 | Train Loss: 0.817 Vali Loss: 14.346 Vali Acc: 0.400 Test Loss: 14.346 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.826451063156128
Epoch: 20, Steps: 13 | Train Loss: 2.356 Vali Loss: 13.399 Vali Acc: 0.500 Test Loss: 13.399 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 1949217
model size : 8.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.966529846191406
Epoch: 1, Steps: 13 | Train Loss: 2.257 Vali Loss: 3.223 Vali Acc: 0.200 Test Loss: 3.223 Test Acc: 0.200
Validation loss decreased (inf --> -0.199968).  Saving model ...
Epoch: 2 cost time: 3.238395929336548
Epoch: 2, Steps: 13 | Train Loss: 2.921 Vali Loss: 1.757 Vali Acc: 0.380 Test Loss: 1.757 Test Acc: 0.380
Validation loss decreased (-0.199968 --> -0.379982).  Saving model ...
Epoch: 3 cost time: 2.9813694953918457
Epoch: 3, Steps: 13 | Train Loss: 2.711 Vali Loss: 7.930 Vali Acc: 0.180 Test Loss: 7.930 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.2448537349700928
Epoch: 4, Steps: 13 | Train Loss: 2.566 Vali Loss: 7.990 Vali Acc: 0.200 Test Loss: 7.990 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.606797933578491
Epoch: 5, Steps: 13 | Train Loss: 2.055 Vali Loss: 6.373 Vali Acc: 0.380 Test Loss: 6.373 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.86645245552063
Epoch: 6, Steps: 13 | Train Loss: 1.757 Vali Loss: 4.333 Vali Acc: 0.420 Test Loss: 4.333 Test Acc: 0.420
Validation loss decreased (-0.379982 --> -0.419957).  Saving model ...
Epoch: 7 cost time: 3.067440986633301
Epoch: 7, Steps: 13 | Train Loss: 2.576 Vali Loss: 3.947 Vali Acc: 0.540 Test Loss: 3.947 Test Acc: 0.540
Validation loss decreased (-0.419957 --> -0.539961).  Saving model ...
Epoch: 8 cost time: 3.665400981903076
Epoch: 8, Steps: 13 | Train Loss: 3.484 Vali Loss: 5.705 Vali Acc: 0.440 Test Loss: 5.705 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.157083034515381
Epoch: 9, Steps: 13 | Train Loss: 2.211 Vali Loss: 6.322 Vali Acc: 0.400 Test Loss: 6.322 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.12904691696167
Epoch: 10, Steps: 13 | Train Loss: 2.601 Vali Loss: 8.466 Vali Acc: 0.520 Test Loss: 8.466 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.2295572757720947
Epoch: 11, Steps: 13 | Train Loss: 1.515 Vali Loss: 8.065 Vali Acc: 0.480 Test Loss: 8.065 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.985658645629883
Epoch: 12, Steps: 13 | Train Loss: 0.896 Vali Loss: 8.183 Vali Acc: 0.500 Test Loss: 8.183 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.242220401763916
Epoch: 13, Steps: 13 | Train Loss: 2.341 Vali Loss: 13.481 Vali Acc: 0.480 Test Loss: 13.481 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.2579634189605713
Epoch: 14, Steps: 13 | Train Loss: 1.424 Vali Loss: 7.520 Vali Acc: 0.540 Test Loss: 7.520 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.304964065551758
Epoch: 15, Steps: 13 | Train Loss: 1.447 Vali Loss: 9.108 Vali Acc: 0.540 Test Loss: 9.108 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.02232027053833
Epoch: 16, Steps: 13 | Train Loss: 0.364 Vali Loss: 6.644 Vali Acc: 0.500 Test Loss: 6.644 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.9648587703704834
Epoch: 17, Steps: 13 | Train Loss: 0.530 Vali Loss: 15.287 Vali Acc: 0.480 Test Loss: 15.287 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 1947809
model size : 8.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.8708336353302
Epoch: 1, Steps: 13 | Train Loss: 1.837 Vali Loss: 2.281 Vali Acc: 0.200 Test Loss: 2.281 Test Acc: 0.200
Validation loss decreased (inf --> -0.199977).  Saving model ...
Epoch: 2 cost time: 2.9865705966949463
Epoch: 2, Steps: 13 | Train Loss: 2.826 Vali Loss: 1.775 Vali Acc: 0.220 Test Loss: 1.775 Test Acc: 0.220
Validation loss decreased (-0.199977 --> -0.219982).  Saving model ...
Epoch: 3 cost time: 2.9842586517333984
Epoch: 3, Steps: 13 | Train Loss: 3.087 Vali Loss: 6.553 Vali Acc: 0.180 Test Loss: 6.553 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.92387056350708
Epoch: 4, Steps: 13 | Train Loss: 2.798 Vali Loss: 2.641 Vali Acc: 0.420 Test Loss: 2.641 Test Acc: 0.420
Validation loss decreased (-0.219982 --> -0.419974).  Saving model ...
Epoch: 5 cost time: 2.5715887546539307
Epoch: 5, Steps: 13 | Train Loss: 0.930 Vali Loss: 3.966 Vali Acc: 0.400 Test Loss: 3.966 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.02705454826355
Epoch: 6, Steps: 13 | Train Loss: 1.868 Vali Loss: 7.258 Vali Acc: 0.340 Test Loss: 7.258 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.846822500228882
Epoch: 7, Steps: 13 | Train Loss: 4.305 Vali Loss: 5.969 Vali Acc: 0.340 Test Loss: 5.969 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.547407865524292
Epoch: 8, Steps: 13 | Train Loss: 2.279 Vali Loss: 6.345 Vali Acc: 0.380 Test Loss: 6.345 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.17907452583313
Epoch: 9, Steps: 13 | Train Loss: 1.675 Vali Loss: 4.982 Vali Acc: 0.500 Test Loss: 4.982 Test Acc: 0.500
Validation loss decreased (-0.419974 --> -0.499950).  Saving model ...
Epoch: 10 cost time: 3.007547616958618
Epoch: 10, Steps: 13 | Train Loss: 1.622 Vali Loss: 6.991 Vali Acc: 0.480 Test Loss: 6.991 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.887266159057617
Epoch: 11, Steps: 13 | Train Loss: 2.412 Vali Loss: 7.327 Vali Acc: 0.440 Test Loss: 7.327 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.968437433242798
Epoch: 12, Steps: 13 | Train Loss: 0.915 Vali Loss: 6.489 Vali Acc: 0.440 Test Loss: 6.489 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.813326358795166
Epoch: 13, Steps: 13 | Train Loss: 1.862 Vali Loss: 16.077 Vali Acc: 0.420 Test Loss: 16.077 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.947517156600952
Epoch: 14, Steps: 13 | Train Loss: 2.197 Vali Loss: 8.626 Vali Acc: 0.460 Test Loss: 8.626 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.00131893157959
Epoch: 15, Steps: 13 | Train Loss: 0.392 Vali Loss: 14.093 Vali Acc: 0.460 Test Loss: 14.093 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.954681396484375
Epoch: 16, Steps: 13 | Train Loss: 1.833 Vali Loss: 9.864 Vali Acc: 0.520 Test Loss: 9.864 Test Acc: 0.520
Validation loss decreased (-0.499950 --> -0.519901).  Saving model ...
Epoch: 17 cost time: 2.790273427963257
Epoch: 17, Steps: 13 | Train Loss: 2.846 Vali Loss: 9.716 Vali Acc: 0.500 Test Loss: 9.716 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.891475200653076
Epoch: 18, Steps: 13 | Train Loss: 1.358 Vali Loss: 11.229 Vali Acc: 0.400 Test Loss: 11.229 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.834137439727783
Epoch: 19, Steps: 13 | Train Loss: 1.425 Vali Loss: 10.385 Vali Acc: 0.420 Test Loss: 10.385 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.1509146690368652
Epoch: 20, Steps: 13 | Train Loss: 2.008 Vali Loss: 16.677 Vali Acc: 0.440 Test Loss: 16.677 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.1844282150268555
Epoch: 21, Steps: 13 | Train Loss: 3.905 Vali Loss: 23.038 Vali Acc: 0.400 Test Loss: 23.038 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.9572787284851074
Epoch: 22, Steps: 13 | Train Loss: 3.257 Vali Loss: 15.894 Vali Acc: 0.320 Test Loss: 15.894 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.150932788848877
Epoch: 23, Steps: 13 | Train Loss: 1.242 Vali Loss: 15.482 Vali Acc: 0.420 Test Loss: 15.482 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.876636028289795
Epoch: 24, Steps: 13 | Train Loss: 2.657 Vali Loss: 17.967 Vali Acc: 0.540 Test Loss: 17.967 Test Acc: 0.540
Validation loss decreased (-0.519901 --> -0.539820).  Saving model ...
Epoch: 25 cost time: 3.3358612060546875
Epoch: 25, Steps: 13 | Train Loss: 1.224 Vali Loss: 11.575 Vali Acc: 0.520 Test Loss: 11.575 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.7794482707977295
Epoch: 26, Steps: 13 | Train Loss: 0.902 Vali Loss: 14.096 Vali Acc: 0.480 Test Loss: 14.096 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.395362615585327
Epoch: 27, Steps: 13 | Train Loss: 1.092 Vali Loss: 20.098 Vali Acc: 0.420 Test Loss: 20.098 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.0795750617980957
Epoch: 28, Steps: 13 | Train Loss: 1.034 Vali Loss: 15.923 Vali Acc: 0.520 Test Loss: 15.923 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.992386817932129
Epoch: 29, Steps: 13 | Train Loss: 0.797 Vali Loss: 17.277 Vali Acc: 0.440 Test Loss: 17.277 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.09912109375
Epoch: 30, Steps: 13 | Train Loss: 0.871 Vali Loss: 18.780 Vali Acc: 0.480 Test Loss: 18.780 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 3.147341251373291
Epoch: 31, Steps: 13 | Train Loss: 0.153 Vali Loss: 17.663 Vali Acc: 0.460 Test Loss: 17.663 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.963606119155884
Epoch: 32, Steps: 13 | Train Loss: 0.080 Vali Loss: 18.006 Vali Acc: 0.520 Test Loss: 18.006 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 3.140306234359741
Epoch: 33, Steps: 13 | Train Loss: 0.160 Vali Loss: 24.940 Vali Acc: 0.400 Test Loss: 24.940 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.8086178302764893
Epoch: 34, Steps: 13 | Train Loss: 0.227 Vali Loss: 16.976 Vali Acc: 0.460 Test Loss: 16.976 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 1946401
model size : 8.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.302781343460083
Epoch: 1, Steps: 13 | Train Loss: 2.476 Vali Loss: 2.336 Vali Acc: 0.280 Test Loss: 2.336 Test Acc: 0.280
Validation loss decreased (inf --> -0.279977).  Saving model ...
Epoch: 2 cost time: 3.076563596725464
Epoch: 2, Steps: 13 | Train Loss: 1.971 Vali Loss: 5.172 Vali Acc: 0.220 Test Loss: 5.172 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.962249994277954
Epoch: 3, Steps: 13 | Train Loss: 3.458 Vali Loss: 4.360 Vali Acc: 0.200 Test Loss: 4.360 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.951855421066284
Epoch: 4, Steps: 13 | Train Loss: 2.119 Vali Loss: 3.931 Vali Acc: 0.320 Test Loss: 3.931 Test Acc: 0.320
Validation loss decreased (-0.279977 --> -0.319961).  Saving model ...
Epoch: 5 cost time: 3.3492953777313232
Epoch: 5, Steps: 13 | Train Loss: 2.768 Vali Loss: 6.950 Vali Acc: 0.320 Test Loss: 6.950 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.0473828315734863
Epoch: 6, Steps: 13 | Train Loss: 2.845 Vali Loss: 5.409 Vali Acc: 0.380 Test Loss: 5.409 Test Acc: 0.380
Validation loss decreased (-0.319961 --> -0.379946).  Saving model ...
Epoch: 7 cost time: 3.0176267623901367
Epoch: 7, Steps: 13 | Train Loss: 4.533 Vali Loss: 4.805 Vali Acc: 0.440 Test Loss: 4.805 Test Acc: 0.440
Validation loss decreased (-0.379946 --> -0.439952).  Saving model ...
Epoch: 8 cost time: 3.1393954753875732
Epoch: 8, Steps: 13 | Train Loss: 4.122 Vali Loss: 7.310 Vali Acc: 0.440 Test Loss: 7.310 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.9681050777435303
Epoch: 9, Steps: 13 | Train Loss: 2.141 Vali Loss: 7.278 Vali Acc: 0.420 Test Loss: 7.278 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.7423837184906006
Epoch: 10, Steps: 13 | Train Loss: 2.300 Vali Loss: 6.033 Vali Acc: 0.500 Test Loss: 6.033 Test Acc: 0.500
Validation loss decreased (-0.439952 --> -0.499940).  Saving model ...
Epoch: 11 cost time: 2.7207913398742676
Epoch: 11, Steps: 13 | Train Loss: 1.595 Vali Loss: 9.146 Vali Acc: 0.460 Test Loss: 9.146 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.076474666595459
Epoch: 12, Steps: 13 | Train Loss: 1.868 Vali Loss: 12.477 Vali Acc: 0.360 Test Loss: 12.477 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.2589149475097656
Epoch: 13, Steps: 13 | Train Loss: 5.266 Vali Loss: 10.353 Vali Acc: 0.500 Test Loss: 10.353 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.7508904933929443
Epoch: 14, Steps: 13 | Train Loss: 4.738 Vali Loss: 12.175 Vali Acc: 0.540 Test Loss: 12.175 Test Acc: 0.540
Validation loss decreased (-0.499940 --> -0.539878).  Saving model ...
Epoch: 15 cost time: 2.658518075942993
Epoch: 15, Steps: 13 | Train Loss: 4.319 Vali Loss: 12.186 Vali Acc: 0.400 Test Loss: 12.186 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.989358901977539
Epoch: 16, Steps: 13 | Train Loss: 1.465 Vali Loss: 18.271 Vali Acc: 0.420 Test Loss: 18.271 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.9208438396453857
Epoch: 17, Steps: 13 | Train Loss: 2.492 Vali Loss: 9.115 Vali Acc: 0.500 Test Loss: 9.115 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.777224540710449
Epoch: 18, Steps: 13 | Train Loss: 1.389 Vali Loss: 11.139 Vali Acc: 0.440 Test Loss: 11.139 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.817403793334961
Epoch: 19, Steps: 13 | Train Loss: 0.267 Vali Loss: 11.640 Vali Acc: 0.480 Test Loss: 11.640 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.3439056873321533
Epoch: 20, Steps: 13 | Train Loss: 0.436 Vali Loss: 11.913 Vali Acc: 0.460 Test Loss: 11.913 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.939086675643921
Epoch: 21, Steps: 13 | Train Loss: 0.319 Vali Loss: 9.202 Vali Acc: 0.500 Test Loss: 9.202 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.9164347648620605
Epoch: 22, Steps: 13 | Train Loss: 0.301 Vali Loss: 15.415 Vali Acc: 0.480 Test Loss: 15.415 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.32785964012146
Epoch: 23, Steps: 13 | Train Loss: 0.557 Vali Loss: 18.289 Vali Acc: 0.380 Test Loss: 18.289 Test Acc: 0.380
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.6816530227661133
Epoch: 24, Steps: 13 | Train Loss: 0.605 Vali Loss: 15.220 Vali Acc: 0.480 Test Loss: 15.220 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 1944993
model size : 8.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.832212448120117
Epoch: 1, Steps: 13 | Train Loss: 2.378 Vali Loss: 2.451 Vali Acc: 0.180 Test Loss: 2.451 Test Acc: 0.180
Validation loss decreased (inf --> -0.179975).  Saving model ...
Epoch: 2 cost time: 2.8543691635131836
Epoch: 2, Steps: 13 | Train Loss: 1.986 Vali Loss: 4.570 Vali Acc: 0.200 Test Loss: 4.570 Test Acc: 0.200
Validation loss decreased (-0.179975 --> -0.199954).  Saving model ...
Epoch: 3 cost time: 3.7181105613708496
Epoch: 3, Steps: 13 | Train Loss: 3.473 Vali Loss: 4.029 Vali Acc: 0.200 Test Loss: 4.029 Test Acc: 0.200
Validation loss decreased (-0.199954 --> -0.199960).  Saving model ...
Epoch: 4 cost time: 3.0557827949523926
Epoch: 4, Steps: 13 | Train Loss: 2.343 Vali Loss: 7.201 Vali Acc: 0.200 Test Loss: 7.201 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.040067195892334
Epoch: 5, Steps: 13 | Train Loss: 3.648 Vali Loss: 6.700 Vali Acc: 0.260 Test Loss: 6.700 Test Acc: 0.260
Validation loss decreased (-0.199960 --> -0.259933).  Saving model ...
Epoch: 6 cost time: 2.8369929790496826
Epoch: 6, Steps: 13 | Train Loss: 2.801 Vali Loss: 6.261 Vali Acc: 0.260 Test Loss: 6.261 Test Acc: 0.260
Validation loss decreased (-0.259933 --> -0.259937).  Saving model ...
Epoch: 7 cost time: 2.9602980613708496
Epoch: 7, Steps: 13 | Train Loss: 2.833 Vali Loss: 2.945 Vali Acc: 0.400 Test Loss: 2.945 Test Acc: 0.400
Validation loss decreased (-0.259937 --> -0.399971).  Saving model ...
Epoch: 8 cost time: 2.9003469944000244
Epoch: 8, Steps: 13 | Train Loss: 2.612 Vali Loss: 7.581 Vali Acc: 0.460 Test Loss: 7.581 Test Acc: 0.460
Validation loss decreased (-0.399971 --> -0.459924).  Saving model ...
Epoch: 9 cost time: 3.15842866897583
Epoch: 9, Steps: 13 | Train Loss: 1.897 Vali Loss: 8.479 Vali Acc: 0.420 Test Loss: 8.479 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.9925882816314697
Epoch: 10, Steps: 13 | Train Loss: 1.285 Vali Loss: 7.173 Vali Acc: 0.460 Test Loss: 7.173 Test Acc: 0.460
Validation loss decreased (-0.459924 --> -0.459928).  Saving model ...
Epoch: 11 cost time: 3.16522479057312
Epoch: 11, Steps: 13 | Train Loss: 1.634 Vali Loss: 10.992 Vali Acc: 0.420 Test Loss: 10.992 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.2725095748901367
Epoch: 12, Steps: 13 | Train Loss: 2.862 Vali Loss: 11.657 Vali Acc: 0.400 Test Loss: 11.657 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.9843084812164307
Epoch: 13, Steps: 13 | Train Loss: 1.932 Vali Loss: 19.164 Vali Acc: 0.340 Test Loss: 19.164 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.7649149894714355
Epoch: 14, Steps: 13 | Train Loss: 5.382 Vali Loss: 6.955 Vali Acc: 0.500 Test Loss: 6.955 Test Acc: 0.500
Validation loss decreased (-0.459928 --> -0.499930).  Saving model ...
Epoch: 15 cost time: 2.823125123977661
Epoch: 15, Steps: 13 | Train Loss: 0.919 Vali Loss: 9.309 Vali Acc: 0.380 Test Loss: 9.309 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.0128862857818604
Epoch: 16, Steps: 13 | Train Loss: 1.111 Vali Loss: 15.744 Vali Acc: 0.320 Test Loss: 15.744 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.9394493103027344
Epoch: 17, Steps: 13 | Train Loss: 2.669 Vali Loss: 11.658 Vali Acc: 0.540 Test Loss: 11.658 Test Acc: 0.540
Validation loss decreased (-0.499930 --> -0.539883).  Saving model ...
Epoch: 18 cost time: 3.112520933151245
Epoch: 18, Steps: 13 | Train Loss: 0.587 Vali Loss: 13.066 Vali Acc: 0.420 Test Loss: 13.066 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.9023892879486084
Epoch: 19, Steps: 13 | Train Loss: 1.972 Vali Loss: 10.330 Vali Acc: 0.540 Test Loss: 10.330 Test Acc: 0.540
Validation loss decreased (-0.539883 --> -0.539897).  Saving model ...
Epoch: 20 cost time: 2.8051013946533203
Epoch: 20, Steps: 13 | Train Loss: 0.298 Vali Loss: 18.217 Vali Acc: 0.420 Test Loss: 18.217 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.9068827629089355
Epoch: 21, Steps: 13 | Train Loss: 1.312 Vali Loss: 13.207 Vali Acc: 0.480 Test Loss: 13.207 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.9932801723480225
Epoch: 22, Steps: 13 | Train Loss: 1.206 Vali Loss: 12.428 Vali Acc: 0.480 Test Loss: 12.428 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.255476713180542
Epoch: 23, Steps: 13 | Train Loss: 4.271 Vali Loss: 18.130 Vali Acc: 0.480 Test Loss: 18.130 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.9706621170043945
Epoch: 24, Steps: 13 | Train Loss: 1.177 Vali Loss: 12.792 Vali Acc: 0.520 Test Loss: 12.792 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.7756028175354004
Epoch: 25, Steps: 13 | Train Loss: 2.212 Vali Loss: 13.203 Vali Acc: 0.520 Test Loss: 13.203 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.9714181423187256
Epoch: 26, Steps: 13 | Train Loss: 0.800 Vali Loss: 23.031 Vali Acc: 0.500 Test Loss: 23.031 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.062788248062134
Epoch: 27, Steps: 13 | Train Loss: 1.883 Vali Loss: 14.797 Vali Acc: 0.440 Test Loss: 14.797 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.1788768768310547
Epoch: 28, Steps: 13 | Train Loss: 0.484 Vali Loss: 24.777 Vali Acc: 0.460 Test Loss: 24.777 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.2088279724121094
Epoch: 29, Steps: 13 | Train Loss: 0.754 Vali Loss: 14.819 Vali Acc: 0.440 Test Loss: 14.819 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 1874337
model size : 7.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.923985004425049
Epoch: 1, Steps: 13 | Train Loss: 2.662 Vali Loss: 2.453 Vali Acc: 0.200 Test Loss: 2.453 Test Acc: 0.200
Validation loss decreased (inf --> -0.199975).  Saving model ...
Epoch: 2 cost time: 2.923506259918213
Epoch: 2, Steps: 13 | Train Loss: 2.683 Vali Loss: 3.357 Vali Acc: 0.200 Test Loss: 3.357 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.0352537631988525
Epoch: 3, Steps: 13 | Train Loss: 2.242 Vali Loss: 3.874 Vali Acc: 0.260 Test Loss: 3.874 Test Acc: 0.260
Validation loss decreased (-0.199975 --> -0.259961).  Saving model ...
Epoch: 4 cost time: 2.799168586730957
Epoch: 4, Steps: 13 | Train Loss: 2.524 Vali Loss: 3.326 Vali Acc: 0.280 Test Loss: 3.326 Test Acc: 0.280
Validation loss decreased (-0.259961 --> -0.279967).  Saving model ...
Epoch: 5 cost time: 3.17138409614563
Epoch: 5, Steps: 13 | Train Loss: 2.651 Vali Loss: 2.657 Vali Acc: 0.340 Test Loss: 2.657 Test Acc: 0.340
Validation loss decreased (-0.279967 --> -0.339973).  Saving model ...
Epoch: 6 cost time: 2.9439799785614014
Epoch: 6, Steps: 13 | Train Loss: 1.655 Vali Loss: 4.116 Vali Acc: 0.440 Test Loss: 4.116 Test Acc: 0.440
Validation loss decreased (-0.339973 --> -0.439959).  Saving model ...
Epoch: 7 cost time: 3.4633963108062744
Epoch: 7, Steps: 13 | Train Loss: 2.610 Vali Loss: 4.366 Vali Acc: 0.360 Test Loss: 4.366 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.022213935852051
Epoch: 8, Steps: 13 | Train Loss: 2.880 Vali Loss: 7.877 Vali Acc: 0.300 Test Loss: 7.877 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.156141519546509
Epoch: 9, Steps: 13 | Train Loss: 2.933 Vali Loss: 10.004 Vali Acc: 0.380 Test Loss: 10.004 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.9859564304351807
Epoch: 10, Steps: 13 | Train Loss: 3.329 Vali Loss: 12.874 Vali Acc: 0.340 Test Loss: 12.874 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.9791064262390137
Epoch: 11, Steps: 13 | Train Loss: 3.899 Vali Loss: 6.902 Vali Acc: 0.460 Test Loss: 6.902 Test Acc: 0.460
Validation loss decreased (-0.439959 --> -0.459931).  Saving model ...
Epoch: 12 cost time: 2.9396636486053467
Epoch: 12, Steps: 13 | Train Loss: 2.164 Vali Loss: 10.719 Vali Acc: 0.380 Test Loss: 10.719 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.7752645015716553
Epoch: 13, Steps: 13 | Train Loss: 2.615 Vali Loss: 5.525 Vali Acc: 0.560 Test Loss: 5.525 Test Acc: 0.560
Validation loss decreased (-0.459931 --> -0.559945).  Saving model ...
Epoch: 14 cost time: 3.092973232269287
Epoch: 14, Steps: 13 | Train Loss: 1.807 Vali Loss: 7.580 Vali Acc: 0.480 Test Loss: 7.580 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.0371782779693604
Epoch: 15, Steps: 13 | Train Loss: 1.345 Vali Loss: 8.295 Vali Acc: 0.460 Test Loss: 8.295 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.871493101119995
Epoch: 16, Steps: 13 | Train Loss: 1.727 Vali Loss: 11.055 Vali Acc: 0.480 Test Loss: 11.055 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.0160627365112305
Epoch: 17, Steps: 13 | Train Loss: 1.380 Vali Loss: 7.899 Vali Acc: 0.500 Test Loss: 7.899 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.1170814037323
Epoch: 18, Steps: 13 | Train Loss: 1.359 Vali Loss: 7.774 Vali Acc: 0.480 Test Loss: 7.774 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.388014793395996
Epoch: 19, Steps: 13 | Train Loss: 0.855 Vali Loss: 11.396 Vali Acc: 0.480 Test Loss: 11.396 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.031782627105713
Epoch: 20, Steps: 13 | Train Loss: 0.480 Vali Loss: 11.502 Vali Acc: 0.520 Test Loss: 11.502 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.0982487201690674
Epoch: 21, Steps: 13 | Train Loss: 0.304 Vali Loss: 6.303 Vali Acc: 0.560 Test Loss: 6.303 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.045118808746338
Epoch: 22, Steps: 13 | Train Loss: 0.263 Vali Loss: 11.713 Vali Acc: 0.520 Test Loss: 11.713 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.0400307178497314
Epoch: 23, Steps: 13 | Train Loss: 0.993 Vali Loss: 12.852 Vali Acc: 0.440 Test Loss: 12.852 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 1872929
model size : 7.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.450647830963135
Epoch: 1, Steps: 13 | Train Loss: 2.160 Vali Loss: 2.589 Vali Acc: 0.200 Test Loss: 2.589 Test Acc: 0.200
Validation loss decreased (inf --> -0.199974).  Saving model ...
Epoch: 2 cost time: 3.1431691646575928
Epoch: 2, Steps: 13 | Train Loss: 2.328 Vali Loss: 5.364 Vali Acc: 0.200 Test Loss: 5.364 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.0467031002044678
Epoch: 3, Steps: 13 | Train Loss: 3.231 Vali Loss: 4.828 Vali Acc: 0.220 Test Loss: 4.828 Test Acc: 0.220
Validation loss decreased (-0.199974 --> -0.219952).  Saving model ...
Epoch: 4 cost time: 2.9659860134124756
Epoch: 4, Steps: 13 | Train Loss: 2.544 Vali Loss: 8.307 Vali Acc: 0.220 Test Loss: 8.307 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.647059679031372
Epoch: 5, Steps: 13 | Train Loss: 2.890 Vali Loss: 4.608 Vali Acc: 0.400 Test Loss: 4.608 Test Acc: 0.400
Validation loss decreased (-0.219952 --> -0.399954).  Saving model ...
Epoch: 6 cost time: 2.931277275085449
Epoch: 6, Steps: 13 | Train Loss: 3.578 Vali Loss: 9.120 Vali Acc: 0.360 Test Loss: 9.120 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.0077757835388184
Epoch: 7, Steps: 13 | Train Loss: 2.675 Vali Loss: 9.620 Vali Acc: 0.340 Test Loss: 9.620 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.793672800064087
Epoch: 8, Steps: 13 | Train Loss: 3.426 Vali Loss: 8.412 Vali Acc: 0.460 Test Loss: 8.412 Test Acc: 0.460
Validation loss decreased (-0.399954 --> -0.459916).  Saving model ...
Epoch: 9 cost time: 2.7811806201934814
Epoch: 9, Steps: 13 | Train Loss: 3.700 Vali Loss: 11.601 Vali Acc: 0.360 Test Loss: 11.601 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.754437208175659
Epoch: 10, Steps: 13 | Train Loss: 2.393 Vali Loss: 7.318 Vali Acc: 0.460 Test Loss: 7.318 Test Acc: 0.460
Validation loss decreased (-0.459916 --> -0.459927).  Saving model ...
Epoch: 11 cost time: 2.6621925830841064
Epoch: 11, Steps: 13 | Train Loss: 0.967 Vali Loss: 5.863 Vali Acc: 0.480 Test Loss: 5.863 Test Acc: 0.480
Validation loss decreased (-0.459927 --> -0.479941).  Saving model ...
Epoch: 12 cost time: 2.644592761993408
Epoch: 12, Steps: 13 | Train Loss: 1.413 Vali Loss: 9.630 Vali Acc: 0.460 Test Loss: 9.630 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.7316064834594727
Epoch: 13, Steps: 13 | Train Loss: 4.324 Vali Loss: 12.855 Vali Acc: 0.400 Test Loss: 12.855 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.752530097961426
Epoch: 14, Steps: 13 | Train Loss: 2.572 Vali Loss: 12.503 Vali Acc: 0.380 Test Loss: 12.503 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.7240896224975586
Epoch: 15, Steps: 13 | Train Loss: 3.704 Vali Loss: 11.115 Vali Acc: 0.440 Test Loss: 11.115 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.8135592937469482
Epoch: 16, Steps: 13 | Train Loss: 2.396 Vali Loss: 15.364 Vali Acc: 0.500 Test Loss: 15.364 Test Acc: 0.500
Validation loss decreased (-0.479941 --> -0.499846).  Saving model ...
Epoch: 17 cost time: 2.983025312423706
Epoch: 17, Steps: 13 | Train Loss: 0.941 Vali Loss: 14.532 Vali Acc: 0.500 Test Loss: 14.532 Test Acc: 0.500
Validation loss decreased (-0.499846 --> -0.499855).  Saving model ...
Epoch: 18 cost time: 3.3086190223693848
Epoch: 18, Steps: 13 | Train Loss: 0.251 Vali Loss: 12.173 Vali Acc: 0.520 Test Loss: 12.173 Test Acc: 0.520
Validation loss decreased (-0.499855 --> -0.519878).  Saving model ...
Epoch: 19 cost time: 2.821911573410034
Epoch: 19, Steps: 13 | Train Loss: 0.268 Vali Loss: 11.197 Vali Acc: 0.540 Test Loss: 11.197 Test Acc: 0.540
Validation loss decreased (-0.519878 --> -0.539888).  Saving model ...
Epoch: 20 cost time: 3.0563888549804688
Epoch: 20, Steps: 13 | Train Loss: 0.588 Vali Loss: 8.929 Vali Acc: 0.560 Test Loss: 8.929 Test Acc: 0.560
Validation loss decreased (-0.539888 --> -0.559911).  Saving model ...
Epoch: 21 cost time: 3.1142425537109375
Epoch: 21, Steps: 13 | Train Loss: 0.555 Vali Loss: 12.419 Vali Acc: 0.560 Test Loss: 12.419 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.0635573863983154
Epoch: 22, Steps: 13 | Train Loss: 1.096 Vali Loss: 13.186 Vali Acc: 0.460 Test Loss: 13.186 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.2557289600372314
Epoch: 23, Steps: 13 | Train Loss: 1.056 Vali Loss: 19.502 Vali Acc: 0.400 Test Loss: 19.502 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.8100390434265137
Epoch: 24, Steps: 13 | Train Loss: 1.618 Vali Loss: 13.854 Vali Acc: 0.480 Test Loss: 13.854 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.6615312099456787
Epoch: 25, Steps: 13 | Train Loss: 0.267 Vali Loss: 19.780 Vali Acc: 0.420 Test Loss: 19.780 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.9148566722869873
Epoch: 26, Steps: 13 | Train Loss: 0.601 Vali Loss: 11.535 Vali Acc: 0.540 Test Loss: 11.535 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.7779691219329834
Epoch: 27, Steps: 13 | Train Loss: 0.024 Vali Loss: 14.660 Vali Acc: 0.500 Test Loss: 14.660 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.985776424407959
Epoch: 28, Steps: 13 | Train Loss: 0.486 Vali Loss: 13.016 Vali Acc: 0.480 Test Loss: 13.016 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.9682929515838623
Epoch: 29, Steps: 13 | Train Loss: 0.141 Vali Loss: 22.153 Vali Acc: 0.360 Test Loss: 22.153 Test Acc: 0.360
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.824256181716919
Epoch: 30, Steps: 13 | Train Loss: 0.444 Vali Loss: 19.787 Vali Acc: 0.420 Test Loss: 19.787 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 1871521
model size : 7.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.888638734817505
Epoch: 1, Steps: 13 | Train Loss: 2.740 Vali Loss: 2.890 Vali Acc: 0.200 Test Loss: 2.890 Test Acc: 0.200
Validation loss decreased (inf --> -0.199971).  Saving model ...
Epoch: 2 cost time: 3.01937198638916
Epoch: 2, Steps: 13 | Train Loss: 2.918 Vali Loss: 4.011 Vali Acc: 0.240 Test Loss: 4.011 Test Acc: 0.240
Validation loss decreased (-0.199971 --> -0.239960).  Saving model ...
Epoch: 3 cost time: 2.649989128112793
Epoch: 3, Steps: 13 | Train Loss: 2.844 Vali Loss: 1.748 Vali Acc: 0.460 Test Loss: 1.748 Test Acc: 0.460
Validation loss decreased (-0.239960 --> -0.459983).  Saving model ...
Epoch: 4 cost time: 2.571730375289917
Epoch: 4, Steps: 13 | Train Loss: 2.905 Vali Loss: 2.936 Vali Acc: 0.380 Test Loss: 2.936 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.804689884185791
Epoch: 5, Steps: 13 | Train Loss: 5.697 Vali Loss: 6.662 Vali Acc: 0.380 Test Loss: 6.662 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.15944766998291
Epoch: 6, Steps: 13 | Train Loss: 2.917 Vali Loss: 7.008 Vali Acc: 0.320 Test Loss: 7.008 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.09236741065979
Epoch: 7, Steps: 13 | Train Loss: 3.362 Vali Loss: 6.004 Vali Acc: 0.420 Test Loss: 6.004 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.803312063217163
Epoch: 8, Steps: 13 | Train Loss: 2.707 Vali Loss: 7.385 Vali Acc: 0.360 Test Loss: 7.385 Test Acc: 0.360
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.8681411743164062
Epoch: 9, Steps: 13 | Train Loss: 1.722 Vali Loss: 6.887 Vali Acc: 0.480 Test Loss: 6.887 Test Acc: 0.480
Validation loss decreased (-0.459983 --> -0.479931).  Saving model ...
Epoch: 10 cost time: 3.4882590770721436
Epoch: 10, Steps: 13 | Train Loss: 1.677 Vali Loss: 5.833 Vali Acc: 0.560 Test Loss: 5.833 Test Acc: 0.560
Validation loss decreased (-0.479931 --> -0.559942).  Saving model ...
Epoch: 11 cost time: 2.981121778488159
Epoch: 11, Steps: 13 | Train Loss: 1.584 Vali Loss: 6.447 Vali Acc: 0.540 Test Loss: 6.447 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.876556396484375
Epoch: 12, Steps: 13 | Train Loss: 2.567 Vali Loss: 10.935 Vali Acc: 0.460 Test Loss: 10.935 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.003805160522461
Epoch: 13, Steps: 13 | Train Loss: 2.787 Vali Loss: 7.963 Vali Acc: 0.540 Test Loss: 7.963 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.8161866664886475
Epoch: 14, Steps: 13 | Train Loss: 1.707 Vali Loss: 11.649 Vali Acc: 0.400 Test Loss: 11.649 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.010986328125
Epoch: 15, Steps: 13 | Train Loss: 0.913 Vali Loss: 9.089 Vali Acc: 0.520 Test Loss: 9.089 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.901460886001587
Epoch: 16, Steps: 13 | Train Loss: 2.234 Vali Loss: 17.807 Vali Acc: 0.440 Test Loss: 17.807 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.8224446773529053
Epoch: 17, Steps: 13 | Train Loss: 2.422 Vali Loss: 9.218 Vali Acc: 0.380 Test Loss: 9.218 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.1775875091552734
Epoch: 18, Steps: 13 | Train Loss: 0.547 Vali Loss: 9.153 Vali Acc: 0.540 Test Loss: 9.153 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.9274911880493164
Epoch: 19, Steps: 13 | Train Loss: 0.770 Vali Loss: 13.630 Vali Acc: 0.440 Test Loss: 13.630 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.7485525608062744
Epoch: 20, Steps: 13 | Train Loss: 0.105 Vali Loss: 16.765 Vali Acc: 0.400 Test Loss: 16.765 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 1870113
model size : 7.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 8.79242992401123
Epoch: 1, Steps: 13 | Train Loss: 14.261 Vali Loss: 24.819 Vali Acc: 0.220 Test Loss: 24.819 Test Acc: 0.220
Validation loss decreased (inf --> -0.219752).  Saving model ...
Epoch: 2 cost time: 6.548475742340088
Epoch: 2, Steps: 13 | Train Loss: 19.008 Vali Loss: 85.904 Vali Acc: 0.200 Test Loss: 85.904 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.688210964202881
Epoch: 3, Steps: 13 | Train Loss: 54.318 Vali Loss: 19.524 Vali Acc: 0.340 Test Loss: 19.524 Test Acc: 0.340
Validation loss decreased (-0.219752 --> -0.339805).  Saving model ...
Epoch: 4 cost time: 6.504230737686157
Epoch: 4, Steps: 13 | Train Loss: 27.217 Vali Loss: 31.998 Vali Acc: 0.400 Test Loss: 31.998 Test Acc: 0.400
Validation loss decreased (-0.339805 --> -0.399680).  Saving model ...
Epoch: 5 cost time: 6.67851996421814
Epoch: 5, Steps: 13 | Train Loss: 21.927 Vali Loss: 79.504 Vali Acc: 0.340 Test Loss: 79.504 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.419679880142212
Epoch: 6, Steps: 13 | Train Loss: 53.301 Vali Loss: 88.323 Vali Acc: 0.500 Test Loss: 88.323 Test Acc: 0.500
Validation loss decreased (-0.399680 --> -0.499117).  Saving model ...
Epoch: 7 cost time: 6.722323894500732
Epoch: 7, Steps: 13 | Train Loss: 44.528 Vali Loss: 85.131 Vali Acc: 0.420 Test Loss: 85.131 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.669388771057129
Epoch: 8, Steps: 13 | Train Loss: 39.398 Vali Loss: 160.729 Vali Acc: 0.320 Test Loss: 160.729 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.705182790756226
Epoch: 9, Steps: 13 | Train Loss: 23.564 Vali Loss: 60.823 Vali Acc: 0.460 Test Loss: 60.823 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.616349458694458
Epoch: 10, Steps: 13 | Train Loss: 26.299 Vali Loss: 113.031 Vali Acc: 0.400 Test Loss: 113.031 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.969793319702148
Epoch: 11, Steps: 13 | Train Loss: 49.876 Vali Loss: 167.428 Vali Acc: 0.440 Test Loss: 167.428 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 6.572723627090454
Epoch: 12, Steps: 13 | Train Loss: 34.033 Vali Loss: 63.246 Vali Acc: 0.460 Test Loss: 63.246 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 6.6889002323150635
Epoch: 13, Steps: 13 | Train Loss: 8.914 Vali Loss: 72.076 Vali Acc: 0.600 Test Loss: 72.076 Test Acc: 0.600
Validation loss decreased (-0.499117 --> -0.599279).  Saving model ...
Epoch: 14 cost time: 6.951932907104492
Epoch: 14, Steps: 13 | Train Loss: 10.442 Vali Loss: 82.399 Vali Acc: 0.580 Test Loss: 82.399 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.694091081619263
Epoch: 15, Steps: 13 | Train Loss: 13.706 Vali Loss: 69.719 Vali Acc: 0.620 Test Loss: 69.719 Test Acc: 0.620
Validation loss decreased (-0.599279 --> -0.619303).  Saving model ...
Epoch: 16 cost time: 6.844967365264893
Epoch: 16, Steps: 13 | Train Loss: 3.870 Vali Loss: 86.893 Vali Acc: 0.520 Test Loss: 86.893 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.571880102157593
Epoch: 17, Steps: 13 | Train Loss: 8.795 Vali Loss: 83.956 Vali Acc: 0.460 Test Loss: 83.956 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.4443488121032715
Epoch: 18, Steps: 13 | Train Loss: 0.472 Vali Loss: 86.613 Vali Acc: 0.580 Test Loss: 86.613 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 6.619625806808472
Epoch: 19, Steps: 13 | Train Loss: 1.926 Vali Loss: 99.170 Vali Acc: 0.540 Test Loss: 99.170 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 6.551991939544678
Epoch: 20, Steps: 13 | Train Loss: 2.677 Vali Loss: 102.692 Vali Acc: 0.400 Test Loss: 102.692 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 6.485445976257324
Epoch: 21, Steps: 13 | Train Loss: 7.748 Vali Loss: 130.442 Vali Acc: 0.440 Test Loss: 130.442 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 6.481708288192749
Epoch: 22, Steps: 13 | Train Loss: 6.393 Vali Loss: 105.994 Vali Acc: 0.520 Test Loss: 105.994 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 6.691311359405518
Epoch: 23, Steps: 13 | Train Loss: 21.979 Vali Loss: 81.801 Vali Acc: 0.480 Test Loss: 81.801 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 6.634023189544678
Epoch: 24, Steps: 13 | Train Loss: 0.317 Vali Loss: 122.549 Vali Acc: 0.480 Test Loss: 122.549 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 6.757056713104248
Epoch: 25, Steps: 13 | Train Loss: 5.796 Vali Loss: 87.673 Vali Acc: 0.480 Test Loss: 87.673 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 29376309
model size : 117.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 9.099705219268799
Epoch: 1, Steps: 13 | Train Loss: 15.107 Vali Loss: 34.886 Vali Acc: 0.200 Test Loss: 34.886 Test Acc: 0.200
Validation loss decreased (inf --> -0.199651).  Saving model ...
Epoch: 2 cost time: 6.646299123764038
Epoch: 2, Steps: 13 | Train Loss: 24.973 Vali Loss: 41.674 Vali Acc: 0.300 Test Loss: 41.674 Test Acc: 0.300
Validation loss decreased (-0.199651 --> -0.299583).  Saving model ...
Epoch: 3 cost time: 6.716646671295166
Epoch: 3, Steps: 13 | Train Loss: 59.032 Vali Loss: 80.542 Vali Acc: 0.320 Test Loss: 80.542 Test Acc: 0.320
Validation loss decreased (-0.299583 --> -0.319195).  Saving model ...
Epoch: 4 cost time: 6.917237997055054
Epoch: 4, Steps: 13 | Train Loss: 59.192 Vali Loss: 87.328 Vali Acc: 0.420 Test Loss: 87.328 Test Acc: 0.420
Validation loss decreased (-0.319195 --> -0.419127).  Saving model ...
Epoch: 5 cost time: 6.763132810592651
Epoch: 5, Steps: 13 | Train Loss: 47.369 Vali Loss: 93.584 Vali Acc: 0.340 Test Loss: 93.584 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.738535642623901
Epoch: 6, Steps: 13 | Train Loss: 29.502 Vali Loss: 78.493 Vali Acc: 0.400 Test Loss: 78.493 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.669982671737671
Epoch: 7, Steps: 13 | Train Loss: 33.829 Vali Loss: 103.944 Vali Acc: 0.320 Test Loss: 103.944 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.723176002502441
Epoch: 8, Steps: 13 | Train Loss: 18.251 Vali Loss: 152.084 Vali Acc: 0.420 Test Loss: 152.084 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.788242340087891
Epoch: 9, Steps: 13 | Train Loss: 58.951 Vali Loss: 96.597 Vali Acc: 0.480 Test Loss: 96.597 Test Acc: 0.480
Validation loss decreased (-0.419127 --> -0.479034).  Saving model ...
Epoch: 10 cost time: 6.560520648956299
Epoch: 10, Steps: 13 | Train Loss: 35.567 Vali Loss: 104.628 Vali Acc: 0.420 Test Loss: 104.628 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.584140300750732
Epoch: 11, Steps: 13 | Train Loss: 14.045 Vali Loss: 73.591 Vali Acc: 0.560 Test Loss: 73.591 Test Acc: 0.560
Validation loss decreased (-0.479034 --> -0.559264).  Saving model ...
Epoch: 12 cost time: 6.60780143737793
Epoch: 12, Steps: 13 | Train Loss: 15.248 Vali Loss: 93.552 Vali Acc: 0.480 Test Loss: 93.552 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.777890205383301
Epoch: 13, Steps: 13 | Train Loss: 17.588 Vali Loss: 71.759 Vali Acc: 0.620 Test Loss: 71.759 Test Acc: 0.620
Validation loss decreased (-0.559264 --> -0.619282).  Saving model ...
Epoch: 14 cost time: 6.562621831893921
Epoch: 14, Steps: 13 | Train Loss: 18.573 Vali Loss: 86.222 Vali Acc: 0.640 Test Loss: 86.222 Test Acc: 0.640
Validation loss decreased (-0.619282 --> -0.639138).  Saving model ...
Epoch: 15 cost time: 6.6715028285980225
Epoch: 15, Steps: 13 | Train Loss: 6.047 Vali Loss: 105.252 Vali Acc: 0.500 Test Loss: 105.252 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.685140132904053
Epoch: 16, Steps: 13 | Train Loss: 9.446 Vali Loss: 119.487 Vali Acc: 0.460 Test Loss: 119.487 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.598775148391724
Epoch: 17, Steps: 13 | Train Loss: 47.688 Vali Loss: 176.877 Vali Acc: 0.360 Test Loss: 176.877 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 6.602980852127075
Epoch: 18, Steps: 13 | Train Loss: 63.421 Vali Loss: 88.041 Vali Acc: 0.500 Test Loss: 88.041 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 6.911620378494263
Epoch: 19, Steps: 13 | Train Loss: 23.909 Vali Loss: 57.834 Vali Acc: 0.640 Test Loss: 57.834 Test Acc: 0.640
Validation loss decreased (-0.639138 --> -0.639422).  Saving model ...
Epoch: 20 cost time: 6.694924592971802
Epoch: 20, Steps: 13 | Train Loss: 9.366 Vali Loss: 88.937 Vali Acc: 0.580 Test Loss: 88.937 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 6.871288537979126
Epoch: 21, Steps: 13 | Train Loss: 18.260 Vali Loss: 61.803 Vali Acc: 0.560 Test Loss: 61.803 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 6.673779487609863
Epoch: 22, Steps: 13 | Train Loss: 16.613 Vali Loss: 82.804 Vali Acc: 0.540 Test Loss: 82.804 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 6.8034210205078125
Epoch: 23, Steps: 13 | Train Loss: 9.502 Vali Loss: 104.508 Vali Acc: 0.520 Test Loss: 104.508 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 6.750012636184692
Epoch: 24, Steps: 13 | Train Loss: 14.268 Vali Loss: 83.056 Vali Acc: 0.600 Test Loss: 83.056 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 6.714217662811279
Epoch: 25, Steps: 13 | Train Loss: 5.512 Vali Loss: 87.428 Vali Acc: 0.520 Test Loss: 87.428 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 6.64841103553772
Epoch: 26, Steps: 13 | Train Loss: 9.756 Vali Loss: 72.310 Vali Acc: 0.600 Test Loss: 72.310 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 6.702855110168457
Epoch: 27, Steps: 13 | Train Loss: 5.147 Vali Loss: 40.333 Vali Acc: 0.700 Test Loss: 40.333 Test Acc: 0.700
Validation loss decreased (-0.639422 --> -0.699597).  Saving model ...
Epoch: 28 cost time: 6.7160937786102295
Epoch: 28, Steps: 13 | Train Loss: 0.000 Vali Loss: 48.495 Vali Acc: 0.660 Test Loss: 48.495 Test Acc: 0.660
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 6.527894735336304
Epoch: 29, Steps: 13 | Train Loss: 0.000 Vali Loss: 51.496 Vali Acc: 0.680 Test Loss: 51.496 Test Acc: 0.680
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 6.552776575088501
Epoch: 30, Steps: 13 | Train Loss: 0.000 Vali Loss: 52.541 Vali Acc: 0.680 Test Loss: 52.541 Test Acc: 0.680
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 6.814633131027222
Epoch: 31, Steps: 13 | Train Loss: 0.000 Vali Loss: 52.715 Vali Acc: 0.680 Test Loss: 52.715 Test Acc: 0.680
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 6.6174845695495605
Epoch: 32, Steps: 13 | Train Loss: 0.000 Vali Loss: 52.685 Vali Acc: 0.680 Test Loss: 52.685 Test Acc: 0.680
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 7.162950038909912
Epoch: 33, Steps: 13 | Train Loss: 0.000 Vali Loss: 52.667 Vali Acc: 0.680 Test Loss: 52.667 Test Acc: 0.680
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 6.616198778152466
Epoch: 34, Steps: 13 | Train Loss: 0.000 Vali Loss: 52.664 Vali Acc: 0.680 Test Loss: 52.664 Test Acc: 0.680
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 6.701522588729858
Epoch: 35, Steps: 13 | Train Loss: 0.000 Vali Loss: 52.664 Vali Acc: 0.680 Test Loss: 52.664 Test Acc: 0.680
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 6.659288167953491
Epoch: 36, Steps: 13 | Train Loss: 0.000 Vali Loss: 52.664 Vali Acc: 0.680 Test Loss: 52.664 Test Acc: 0.680
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 6.643902778625488
Epoch: 37, Steps: 13 | Train Loss: 0.000 Vali Loss: 52.664 Vali Acc: 0.680 Test Loss: 52.664 Test Acc: 0.680
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.7
model parameter : 29365813
model size : 117.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 8.811105966567993
Epoch: 1, Steps: 13 | Train Loss: 18.622 Vali Loss: 45.914 Vali Acc: 0.180 Test Loss: 45.914 Test Acc: 0.180
Validation loss decreased (inf --> -0.179541).  Saving model ...
Epoch: 2 cost time: 6.663636207580566
Epoch: 2, Steps: 13 | Train Loss: 38.620 Vali Loss: 44.108 Vali Acc: 0.320 Test Loss: 44.108 Test Acc: 0.320
Validation loss decreased (-0.179541 --> -0.319559).  Saving model ...
Epoch: 3 cost time: 6.663092851638794
Epoch: 3, Steps: 13 | Train Loss: 35.699 Vali Loss: 50.529 Vali Acc: 0.280 Test Loss: 50.529 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.602275848388672
Epoch: 4, Steps: 13 | Train Loss: 40.798 Vali Loss: 40.502 Vali Acc: 0.440 Test Loss: 40.502 Test Acc: 0.440
Validation loss decreased (-0.319559 --> -0.439595).  Saving model ...
Epoch: 5 cost time: 6.561538457870483
Epoch: 5, Steps: 13 | Train Loss: 49.788 Vali Loss: 79.166 Vali Acc: 0.420 Test Loss: 79.166 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.6891162395477295
Epoch: 6, Steps: 13 | Train Loss: 53.237 Vali Loss: 115.450 Vali Acc: 0.400 Test Loss: 115.450 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.806092977523804
Epoch: 7, Steps: 13 | Train Loss: 34.444 Vali Loss: 65.280 Vali Acc: 0.500 Test Loss: 65.280 Test Acc: 0.500
Validation loss decreased (-0.439595 --> -0.499347).  Saving model ...
Epoch: 8 cost time: 6.5283567905426025
Epoch: 8, Steps: 13 | Train Loss: 32.148 Vali Loss: 85.538 Vali Acc: 0.440 Test Loss: 85.538 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.76760196685791
Epoch: 9, Steps: 13 | Train Loss: 50.949 Vali Loss: 104.260 Vali Acc: 0.300 Test Loss: 104.260 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.652285814285278
Epoch: 10, Steps: 13 | Train Loss: 11.112 Vali Loss: 98.403 Vali Acc: 0.520 Test Loss: 98.403 Test Acc: 0.520
Validation loss decreased (-0.499347 --> -0.519016).  Saving model ...
Epoch: 11 cost time: 6.63289737701416
Epoch: 11, Steps: 13 | Train Loss: 13.479 Vali Loss: 158.424 Vali Acc: 0.420 Test Loss: 158.424 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.700301885604858
Epoch: 12, Steps: 13 | Train Loss: 25.041 Vali Loss: 80.235 Vali Acc: 0.480 Test Loss: 80.235 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.733698606491089
Epoch: 13, Steps: 13 | Train Loss: 3.296 Vali Loss: 89.820 Vali Acc: 0.460 Test Loss: 89.820 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.784949064254761
Epoch: 14, Steps: 13 | Train Loss: 16.938 Vali Loss: 98.157 Vali Acc: 0.460 Test Loss: 98.157 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.875781774520874
Epoch: 15, Steps: 13 | Train Loss: 13.535 Vali Loss: 92.487 Vali Acc: 0.480 Test Loss: 92.487 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 6.717286586761475
Epoch: 16, Steps: 13 | Train Loss: 18.593 Vali Loss: 121.316 Vali Acc: 0.500 Test Loss: 121.316 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 6.900346994400024
Epoch: 17, Steps: 13 | Train Loss: 5.421 Vali Loss: 79.393 Vali Acc: 0.520 Test Loss: 79.393 Test Acc: 0.520
Validation loss decreased (-0.519016 --> -0.519206).  Saving model ...
Epoch: 18 cost time: 6.5259246826171875
Epoch: 18, Steps: 13 | Train Loss: 16.389 Vali Loss: 145.552 Vali Acc: 0.440 Test Loss: 145.552 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.734639406204224
Epoch: 19, Steps: 13 | Train Loss: 12.709 Vali Loss: 132.596 Vali Acc: 0.500 Test Loss: 132.596 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 6.6731555461883545
Epoch: 20, Steps: 13 | Train Loss: 5.995 Vali Loss: 125.027 Vali Acc: 0.500 Test Loss: 125.027 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 6.923052072525024
Epoch: 21, Steps: 13 | Train Loss: 6.127 Vali Loss: 120.160 Vali Acc: 0.420 Test Loss: 120.160 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 6.52790904045105
Epoch: 22, Steps: 13 | Train Loss: 8.535 Vali Loss: 122.877 Vali Acc: 0.380 Test Loss: 122.877 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 6.92116904258728
Epoch: 23, Steps: 13 | Train Loss: 1.558 Vali Loss: 120.428 Vali Acc: 0.440 Test Loss: 120.428 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 6.816298484802246
Epoch: 24, Steps: 13 | Train Loss: 0.000 Vali Loss: 131.625 Vali Acc: 0.420 Test Loss: 131.625 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 6.845278739929199
Epoch: 25, Steps: 13 | Train Loss: 0.005 Vali Loss: 132.490 Vali Acc: 0.440 Test Loss: 132.490 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 6.784517049789429
Epoch: 26, Steps: 13 | Train Loss: 0.546 Vali Loss: 142.192 Vali Acc: 0.420 Test Loss: 142.192 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 6.910590410232544
Epoch: 27, Steps: 13 | Train Loss: 3.998 Vali Loss: 172.512 Vali Acc: 0.400 Test Loss: 172.512 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 29355317
model size : 117.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 8.786344766616821
Epoch: 1, Steps: 13 | Train Loss: 22.853 Vali Loss: 46.116 Vali Acc: 0.200 Test Loss: 46.116 Test Acc: 0.200
Validation loss decreased (inf --> -0.199539).  Saving model ...
Epoch: 2 cost time: 6.496125221252441
Epoch: 2, Steps: 13 | Train Loss: 40.813 Vali Loss: 63.600 Vali Acc: 0.260 Test Loss: 63.600 Test Acc: 0.260
Validation loss decreased (-0.199539 --> -0.259364).  Saving model ...
Epoch: 3 cost time: 6.813829660415649
Epoch: 3, Steps: 13 | Train Loss: 29.472 Vali Loss: 34.831 Vali Acc: 0.460 Test Loss: 34.831 Test Acc: 0.460
Validation loss decreased (-0.259364 --> -0.459652).  Saving model ...
Epoch: 4 cost time: 6.60295844078064
Epoch: 4, Steps: 13 | Train Loss: 26.409 Vali Loss: 37.043 Vali Acc: 0.300 Test Loss: 37.043 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.633305311203003
Epoch: 5, Steps: 13 | Train Loss: 28.883 Vali Loss: 58.740 Vali Acc: 0.340 Test Loss: 58.740 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.5511767864227295
Epoch: 6, Steps: 13 | Train Loss: 42.077 Vali Loss: 29.817 Vali Acc: 0.480 Test Loss: 29.817 Test Acc: 0.480
Validation loss decreased (-0.459652 --> -0.479702).  Saving model ...
Epoch: 7 cost time: 7.019218444824219
Epoch: 7, Steps: 13 | Train Loss: 58.839 Vali Loss: 85.161 Vali Acc: 0.420 Test Loss: 85.161 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.5000646114349365
Epoch: 8, Steps: 13 | Train Loss: 38.512 Vali Loss: 131.836 Vali Acc: 0.360 Test Loss: 131.836 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.689486503601074
Epoch: 9, Steps: 13 | Train Loss: 54.785 Vali Loss: 82.825 Vali Acc: 0.480 Test Loss: 82.825 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.5129828453063965
Epoch: 10, Steps: 13 | Train Loss: 15.164 Vali Loss: 96.662 Vali Acc: 0.400 Test Loss: 96.662 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.692221164703369
Epoch: 11, Steps: 13 | Train Loss: 21.964 Vali Loss: 59.809 Vali Acc: 0.440 Test Loss: 59.809 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 6.829549551010132
Epoch: 12, Steps: 13 | Train Loss: 6.531 Vali Loss: 69.607 Vali Acc: 0.460 Test Loss: 69.607 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 6.847591400146484
Epoch: 13, Steps: 13 | Train Loss: 5.657 Vali Loss: 79.584 Vali Acc: 0.420 Test Loss: 79.584 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 6.526384353637695
Epoch: 14, Steps: 13 | Train Loss: 2.986 Vali Loss: 87.975 Vali Acc: 0.540 Test Loss: 87.975 Test Acc: 0.540
Validation loss decreased (-0.479702 --> -0.539120).  Saving model ...
Epoch: 15 cost time: 6.5638062953948975
Epoch: 15, Steps: 13 | Train Loss: 10.197 Vali Loss: 148.201 Vali Acc: 0.440 Test Loss: 148.201 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.977945327758789
Epoch: 16, Steps: 13 | Train Loss: 28.812 Vali Loss: 134.146 Vali Acc: 0.460 Test Loss: 134.146 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.455649137496948
Epoch: 17, Steps: 13 | Train Loss: 84.262 Vali Loss: 165.060 Vali Acc: 0.400 Test Loss: 165.060 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 6.722803831100464
Epoch: 18, Steps: 13 | Train Loss: 40.410 Vali Loss: 212.707 Vali Acc: 0.380 Test Loss: 212.707 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 6.689879655838013
Epoch: 19, Steps: 13 | Train Loss: 12.911 Vali Loss: 131.967 Vali Acc: 0.440 Test Loss: 131.967 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 6.538201332092285
Epoch: 20, Steps: 13 | Train Loss: 66.064 Vali Loss: 261.260 Vali Acc: 0.320 Test Loss: 261.260 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 6.942936658859253
Epoch: 21, Steps: 13 | Train Loss: 10.300 Vali Loss: 165.284 Vali Acc: 0.420 Test Loss: 165.284 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 6.453579664230347
Epoch: 22, Steps: 13 | Train Loss: 20.558 Vali Loss: 146.480 Vali Acc: 0.460 Test Loss: 146.480 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 6.5313756465911865
Epoch: 23, Steps: 13 | Train Loss: 6.110 Vali Loss: 157.096 Vali Acc: 0.360 Test Loss: 157.096 Test Acc: 0.360
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 6.5867390632629395
Epoch: 24, Steps: 13 | Train Loss: 1.318 Vali Loss: 173.052 Vali Acc: 0.460 Test Loss: 173.052 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 29344821
model size : 116.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 8.483757495880127
Epoch: 1, Steps: 13 | Train Loss: 15.461 Vali Loss: 58.441 Vali Acc: 0.200 Test Loss: 58.441 Test Acc: 0.200
Validation loss decreased (inf --> -0.199416).  Saving model ...
Epoch: 2 cost time: 6.193639755249023
Epoch: 2, Steps: 13 | Train Loss: 29.652 Vali Loss: 77.899 Vali Acc: 0.280 Test Loss: 77.899 Test Acc: 0.280
Validation loss decreased (-0.199416 --> -0.279221).  Saving model ...
Epoch: 3 cost time: 5.9942216873168945
Epoch: 3, Steps: 13 | Train Loss: 38.700 Vali Loss: 39.191 Vali Acc: 0.260 Test Loss: 39.191 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.051978349685669
Epoch: 4, Steps: 13 | Train Loss: 46.157 Vali Loss: 73.043 Vali Acc: 0.360 Test Loss: 73.043 Test Acc: 0.360
Validation loss decreased (-0.279221 --> -0.359270).  Saving model ...
Epoch: 5 cost time: 6.293544054031372
Epoch: 5, Steps: 13 | Train Loss: 73.769 Vali Loss: 81.466 Vali Acc: 0.360 Test Loss: 81.466 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.050142526626587
Epoch: 6, Steps: 13 | Train Loss: 49.039 Vali Loss: 79.783 Vali Acc: 0.200 Test Loss: 79.783 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.422969818115234
Epoch: 7, Steps: 13 | Train Loss: 60.685 Vali Loss: 123.548 Vali Acc: 0.380 Test Loss: 123.548 Test Acc: 0.380
Validation loss decreased (-0.359270 --> -0.378765).  Saving model ...
Epoch: 8 cost time: 6.142136812210083
Epoch: 8, Steps: 13 | Train Loss: 44.914 Vali Loss: 51.838 Vali Acc: 0.480 Test Loss: 51.838 Test Acc: 0.480
Validation loss decreased (-0.378765 --> -0.479482).  Saving model ...
Epoch: 9 cost time: 6.101942777633667
Epoch: 9, Steps: 13 | Train Loss: 28.461 Vali Loss: 69.613 Vali Acc: 0.440 Test Loss: 69.613 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.163648843765259
Epoch: 10, Steps: 13 | Train Loss: 23.204 Vali Loss: 95.662 Vali Acc: 0.520 Test Loss: 95.662 Test Acc: 0.520
Validation loss decreased (-0.479482 --> -0.519043).  Saving model ...
Epoch: 11 cost time: 6.2697837352752686
Epoch: 11, Steps: 13 | Train Loss: 18.273 Vali Loss: 58.159 Vali Acc: 0.560 Test Loss: 58.159 Test Acc: 0.560
Validation loss decreased (-0.519043 --> -0.559418).  Saving model ...
Epoch: 12 cost time: 6.600424528121948
Epoch: 12, Steps: 13 | Train Loss: 9.362 Vali Loss: 113.371 Vali Acc: 0.380 Test Loss: 113.371 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.106747388839722
Epoch: 13, Steps: 13 | Train Loss: 7.299 Vali Loss: 88.593 Vali Acc: 0.480 Test Loss: 88.593 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.265758514404297
Epoch: 14, Steps: 13 | Train Loss: 9.957 Vali Loss: 112.427 Vali Acc: 0.420 Test Loss: 112.427 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.140526533126831
Epoch: 15, Steps: 13 | Train Loss: 9.786 Vali Loss: 112.530 Vali Acc: 0.540 Test Loss: 112.530 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 6.113455772399902
Epoch: 16, Steps: 13 | Train Loss: 21.958 Vali Loss: 94.740 Vali Acc: 0.540 Test Loss: 94.740 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 6.412755727767944
Epoch: 17, Steps: 13 | Train Loss: 4.633 Vali Loss: 119.690 Vali Acc: 0.440 Test Loss: 119.690 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 6.0983803272247314
Epoch: 18, Steps: 13 | Train Loss: 10.623 Vali Loss: 100.315 Vali Acc: 0.540 Test Loss: 100.315 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 6.240729093551636
Epoch: 19, Steps: 13 | Train Loss: 0.610 Vali Loss: 139.546 Vali Acc: 0.500 Test Loss: 139.546 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 6.021358966827393
Epoch: 20, Steps: 13 | Train Loss: 3.708 Vali Loss: 141.425 Vali Acc: 0.420 Test Loss: 141.425 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 6.076916694641113
Epoch: 21, Steps: 13 | Train Loss: 7.603 Vali Loss: 174.017 Vali Acc: 0.400 Test Loss: 174.017 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 27537717
model size : 110.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 8.366416692733765
Epoch: 1, Steps: 13 | Train Loss: 13.974 Vali Loss: 37.381 Vali Acc: 0.260 Test Loss: 37.381 Test Acc: 0.260
Validation loss decreased (inf --> -0.259626).  Saving model ...
Epoch: 2 cost time: 6.184020519256592
Epoch: 2, Steps: 13 | Train Loss: 47.607 Vali Loss: 23.733 Vali Acc: 0.340 Test Loss: 23.733 Test Acc: 0.340
Validation loss decreased (-0.259626 --> -0.339763).  Saving model ...
Epoch: 3 cost time: 6.2341344356536865
Epoch: 3, Steps: 13 | Train Loss: 39.199 Vali Loss: 84.028 Vali Acc: 0.260 Test Loss: 84.028 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.153517007827759
Epoch: 4, Steps: 13 | Train Loss: 42.297 Vali Loss: 52.248 Vali Acc: 0.400 Test Loss: 52.248 Test Acc: 0.400
Validation loss decreased (-0.339763 --> -0.399478).  Saving model ...
Epoch: 5 cost time: 6.23769736289978
Epoch: 5, Steps: 13 | Train Loss: 31.168 Vali Loss: 80.442 Vali Acc: 0.460 Test Loss: 80.442 Test Acc: 0.460
Validation loss decreased (-0.399478 --> -0.459196).  Saving model ...
Epoch: 6 cost time: 6.289886713027954
Epoch: 6, Steps: 13 | Train Loss: 41.519 Vali Loss: 75.057 Vali Acc: 0.460 Test Loss: 75.057 Test Acc: 0.460
Validation loss decreased (-0.459196 --> -0.459249).  Saving model ...
Epoch: 7 cost time: 6.266140699386597
Epoch: 7, Steps: 13 | Train Loss: 32.691 Vali Loss: 59.037 Vali Acc: 0.460 Test Loss: 59.037 Test Acc: 0.460
Validation loss decreased (-0.459249 --> -0.459410).  Saving model ...
Epoch: 8 cost time: 6.09058141708374
Epoch: 8, Steps: 13 | Train Loss: 15.559 Vali Loss: 82.687 Vali Acc: 0.580 Test Loss: 82.687 Test Acc: 0.580
Validation loss decreased (-0.459410 --> -0.579173).  Saving model ...
Epoch: 9 cost time: 6.044852018356323
Epoch: 9, Steps: 13 | Train Loss: 14.186 Vali Loss: 62.882 Vali Acc: 0.480 Test Loss: 62.882 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.223872184753418
Epoch: 10, Steps: 13 | Train Loss: 30.150 Vali Loss: 59.339 Vali Acc: 0.380 Test Loss: 59.339 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.376067399978638
Epoch: 11, Steps: 13 | Train Loss: 29.563 Vali Loss: 84.632 Vali Acc: 0.460 Test Loss: 84.632 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.3716139793396
Epoch: 12, Steps: 13 | Train Loss: 16.990 Vali Loss: 86.294 Vali Acc: 0.440 Test Loss: 86.294 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.0772106647491455
Epoch: 13, Steps: 13 | Train Loss: 15.680 Vali Loss: 110.907 Vali Acc: 0.300 Test Loss: 110.907 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.338186025619507
Epoch: 14, Steps: 13 | Train Loss: 26.013 Vali Loss: 97.649 Vali Acc: 0.340 Test Loss: 97.649 Test Acc: 0.340
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.987268447875977
Epoch: 15, Steps: 13 | Train Loss: 11.737 Vali Loss: 78.571 Vali Acc: 0.580 Test Loss: 78.571 Test Acc: 0.580
Validation loss decreased (-0.579173 --> -0.579214).  Saving model ...
Epoch: 16 cost time: 5.838484048843384
Epoch: 16, Steps: 13 | Train Loss: 8.458 Vali Loss: 87.493 Vali Acc: 0.440 Test Loss: 87.493 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.003516912460327
Epoch: 17, Steps: 13 | Train Loss: 18.828 Vali Loss: 107.405 Vali Acc: 0.480 Test Loss: 107.405 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.157727479934692
Epoch: 18, Steps: 13 | Train Loss: 9.346 Vali Loss: 93.924 Vali Acc: 0.420 Test Loss: 93.924 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 6.018391847610474
Epoch: 19, Steps: 13 | Train Loss: 8.471 Vali Loss: 97.461 Vali Acc: 0.540 Test Loss: 97.461 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 5.975101470947266
Epoch: 20, Steps: 13 | Train Loss: 8.394 Vali Loss: 89.704 Vali Acc: 0.520 Test Loss: 89.704 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 6.104901552200317
Epoch: 21, Steps: 13 | Train Loss: 9.880 Vali Loss: 87.449 Vali Acc: 0.480 Test Loss: 87.449 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 5.928167819976807
Epoch: 22, Steps: 13 | Train Loss: 14.007 Vali Loss: 63.206 Vali Acc: 0.580 Test Loss: 63.206 Test Acc: 0.580
Validation loss decreased (-0.579214 --> -0.579368).  Saving model ...
Epoch: 23 cost time: 6.009384870529175
Epoch: 23, Steps: 13 | Train Loss: 0.000 Vali Loss: 82.824 Vali Acc: 0.580 Test Loss: 82.824 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 6.089986562728882
Epoch: 24, Steps: 13 | Train Loss: 2.347 Vali Loss: 77.164 Vali Acc: 0.540 Test Loss: 77.164 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 6.063563346862793
Epoch: 25, Steps: 13 | Train Loss: 0.721 Vali Loss: 76.999 Vali Acc: 0.580 Test Loss: 76.999 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 5.9832775592803955
Epoch: 26, Steps: 13 | Train Loss: 2.508 Vali Loss: 88.078 Vali Acc: 0.480 Test Loss: 88.078 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 6.154386520385742
Epoch: 27, Steps: 13 | Train Loss: 3.162 Vali Loss: 105.241 Vali Acc: 0.520 Test Loss: 105.241 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 6.1808226108551025
Epoch: 28, Steps: 13 | Train Loss: 1.998 Vali Loss: 72.994 Vali Acc: 0.540 Test Loss: 72.994 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 6.13122296333313
Epoch: 29, Steps: 13 | Train Loss: 0.186 Vali Loss: 101.418 Vali Acc: 0.460 Test Loss: 101.418 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 6.185461521148682
Epoch: 30, Steps: 13 | Train Loss: 11.184 Vali Loss: 120.160 Vali Acc: 0.480 Test Loss: 120.160 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 6.199009656906128
Epoch: 31, Steps: 13 | Train Loss: 5.908 Vali Loss: 105.084 Vali Acc: 0.520 Test Loss: 105.084 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 6.160314559936523
Epoch: 32, Steps: 13 | Train Loss: 3.190 Vali Loss: 99.957 Vali Acc: 0.560 Test Loss: 99.957 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 27527221
model size : 110.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 8.559279203414917
Epoch: 1, Steps: 13 | Train Loss: 11.782 Vali Loss: 19.703 Vali Acc: 0.260 Test Loss: 19.703 Test Acc: 0.260
Validation loss decreased (inf --> -0.259803).  Saving model ...
Epoch: 2 cost time: 5.989166736602783
Epoch: 2, Steps: 13 | Train Loss: 31.516 Vali Loss: 16.574 Vali Acc: 0.260 Test Loss: 16.574 Test Acc: 0.260
Validation loss decreased (-0.259803 --> -0.259834).  Saving model ...
Epoch: 3 cost time: 6.109060764312744
Epoch: 3, Steps: 13 | Train Loss: 26.745 Vali Loss: 75.301 Vali Acc: 0.280 Test Loss: 75.301 Test Acc: 0.280
Validation loss decreased (-0.259834 --> -0.279247).  Saving model ...
Epoch: 4 cost time: 5.9610021114349365
Epoch: 4, Steps: 13 | Train Loss: 49.782 Vali Loss: 53.480 Vali Acc: 0.360 Test Loss: 53.480 Test Acc: 0.360
Validation loss decreased (-0.279247 --> -0.359465).  Saving model ...
Epoch: 5 cost time: 5.964311599731445
Epoch: 5, Steps: 13 | Train Loss: 18.925 Vali Loss: 74.311 Vali Acc: 0.420 Test Loss: 74.311 Test Acc: 0.420
Validation loss decreased (-0.359465 --> -0.419257).  Saving model ...
Epoch: 6 cost time: 6.080078363418579
Epoch: 6, Steps: 13 | Train Loss: 47.018 Vali Loss: 71.682 Vali Acc: 0.360 Test Loss: 71.682 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.018522024154663
Epoch: 7, Steps: 13 | Train Loss: 32.291 Vali Loss: 77.444 Vali Acc: 0.460 Test Loss: 77.444 Test Acc: 0.460
Validation loss decreased (-0.419257 --> -0.459226).  Saving model ...
Epoch: 8 cost time: 6.129865646362305
Epoch: 8, Steps: 13 | Train Loss: 38.333 Vali Loss: 49.773 Vali Acc: 0.500 Test Loss: 49.773 Test Acc: 0.500
Validation loss decreased (-0.459226 --> -0.499502).  Saving model ...
Epoch: 9 cost time: 6.118382453918457
Epoch: 9, Steps: 13 | Train Loss: 18.187 Vali Loss: 70.391 Vali Acc: 0.540 Test Loss: 70.391 Test Acc: 0.540
Validation loss decreased (-0.499502 --> -0.539296).  Saving model ...
Epoch: 10 cost time: 6.045372247695923
Epoch: 10, Steps: 13 | Train Loss: 15.244 Vali Loss: 54.085 Vali Acc: 0.460 Test Loss: 54.085 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.040244102478027
Epoch: 11, Steps: 13 | Train Loss: 12.114 Vali Loss: 95.756 Vali Acc: 0.380 Test Loss: 95.756 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.08113694190979
Epoch: 12, Steps: 13 | Train Loss: 23.565 Vali Loss: 73.482 Vali Acc: 0.580 Test Loss: 73.482 Test Acc: 0.580
Validation loss decreased (-0.539296 --> -0.579265).  Saving model ...
Epoch: 13 cost time: 5.892198801040649
Epoch: 13, Steps: 13 | Train Loss: 25.531 Vali Loss: 73.533 Vali Acc: 0.540 Test Loss: 73.533 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.14954137802124
Epoch: 14, Steps: 13 | Train Loss: 58.305 Vali Loss: 212.798 Vali Acc: 0.260 Test Loss: 212.798 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.81291651725769
Epoch: 15, Steps: 13 | Train Loss: 48.436 Vali Loss: 60.690 Vali Acc: 0.600 Test Loss: 60.690 Test Acc: 0.600
Validation loss decreased (-0.579265 --> -0.599393).  Saving model ...
Epoch: 16 cost time: 5.991747856140137
Epoch: 16, Steps: 13 | Train Loss: 33.362 Vali Loss: 117.677 Vali Acc: 0.480 Test Loss: 117.677 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.951076507568359
Epoch: 17, Steps: 13 | Train Loss: 24.127 Vali Loss: 76.957 Vali Acc: 0.540 Test Loss: 76.957 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.926202297210693
Epoch: 18, Steps: 13 | Train Loss: 7.609 Vali Loss: 108.696 Vali Acc: 0.480 Test Loss: 108.696 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.8642661571502686
Epoch: 19, Steps: 13 | Train Loss: 15.921 Vali Loss: 110.086 Vali Acc: 0.500 Test Loss: 110.086 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 6.155897617340088
Epoch: 20, Steps: 13 | Train Loss: 5.045 Vali Loss: 106.373 Vali Acc: 0.520 Test Loss: 106.373 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 6.0405802726745605
Epoch: 21, Steps: 13 | Train Loss: 2.976 Vali Loss: 81.716 Vali Acc: 0.600 Test Loss: 81.716 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 6.0800464153289795
Epoch: 22, Steps: 13 | Train Loss: 7.838 Vali Loss: 104.913 Vali Acc: 0.600 Test Loss: 104.913 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 6.110440015792847
Epoch: 23, Steps: 13 | Train Loss: 4.568 Vali Loss: 108.450 Vali Acc: 0.540 Test Loss: 108.450 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 5.968567609786987
Epoch: 24, Steps: 13 | Train Loss: 10.769 Vali Loss: 164.648 Vali Acc: 0.500 Test Loss: 164.648 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 6.092322587966919
Epoch: 25, Steps: 13 | Train Loss: 18.827 Vali Loss: 78.447 Vali Acc: 0.500 Test Loss: 78.447 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 27516725
model size : 110.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 8.448433637619019
Epoch: 1, Steps: 13 | Train Loss: 18.809 Vali Loss: 37.254 Vali Acc: 0.200 Test Loss: 37.254 Test Acc: 0.200
Validation loss decreased (inf --> -0.199627).  Saving model ...
Epoch: 2 cost time: 6.211089134216309
Epoch: 2, Steps: 13 | Train Loss: 33.042 Vali Loss: 45.422 Vali Acc: 0.240 Test Loss: 45.422 Test Acc: 0.240
Validation loss decreased (-0.199627 --> -0.239546).  Saving model ...
Epoch: 3 cost time: 6.048093557357788
Epoch: 3, Steps: 13 | Train Loss: 23.725 Vali Loss: 22.125 Vali Acc: 0.340 Test Loss: 22.125 Test Acc: 0.340
Validation loss decreased (-0.239546 --> -0.339779).  Saving model ...
Epoch: 4 cost time: 5.951815843582153
Epoch: 4, Steps: 13 | Train Loss: 23.202 Vali Loss: 31.611 Vali Acc: 0.340 Test Loss: 31.611 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.045736312866211
Epoch: 5, Steps: 13 | Train Loss: 47.384 Vali Loss: 105.223 Vali Acc: 0.300 Test Loss: 105.223 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.964077472686768
Epoch: 6, Steps: 13 | Train Loss: 30.515 Vali Loss: 50.124 Vali Acc: 0.400 Test Loss: 50.124 Test Acc: 0.400
Validation loss decreased (-0.339779 --> -0.399499).  Saving model ...
Epoch: 7 cost time: 5.9717628955841064
Epoch: 7, Steps: 13 | Train Loss: 49.794 Vali Loss: 61.508 Vali Acc: 0.540 Test Loss: 61.508 Test Acc: 0.540
Validation loss decreased (-0.399499 --> -0.539385).  Saving model ...
Epoch: 8 cost time: 5.968953371047974
Epoch: 8, Steps: 13 | Train Loss: 30.299 Vali Loss: 111.700 Vali Acc: 0.440 Test Loss: 111.700 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.139324188232422
Epoch: 9, Steps: 13 | Train Loss: 28.427 Vali Loss: 93.424 Vali Acc: 0.580 Test Loss: 93.424 Test Acc: 0.580
Validation loss decreased (-0.539385 --> -0.579066).  Saving model ...
Epoch: 10 cost time: 6.094187021255493
Epoch: 10, Steps: 13 | Train Loss: 66.181 Vali Loss: 115.774 Vali Acc: 0.400 Test Loss: 115.774 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.085364580154419
Epoch: 11, Steps: 13 | Train Loss: 32.760 Vali Loss: 98.484 Vali Acc: 0.540 Test Loss: 98.484 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.007104396820068
Epoch: 12, Steps: 13 | Train Loss: 23.524 Vali Loss: 111.071 Vali Acc: 0.420 Test Loss: 111.071 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.004713535308838
Epoch: 13, Steps: 13 | Train Loss: 46.552 Vali Loss: 115.074 Vali Acc: 0.500 Test Loss: 115.074 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.169140100479126
Epoch: 14, Steps: 13 | Train Loss: 20.086 Vali Loss: 85.259 Vali Acc: 0.500 Test Loss: 85.259 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 6.201562404632568
Epoch: 15, Steps: 13 | Train Loss: 18.728 Vali Loss: 132.253 Vali Acc: 0.540 Test Loss: 132.253 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.9015703201293945
Epoch: 16, Steps: 13 | Train Loss: 21.546 Vali Loss: 83.306 Vali Acc: 0.480 Test Loss: 83.306 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 6.469929456710815
Epoch: 17, Steps: 13 | Train Loss: 9.904 Vali Loss: 49.752 Vali Acc: 0.620 Test Loss: 49.752 Test Acc: 0.620
Validation loss decreased (-0.579066 --> -0.619502).  Saving model ...
Epoch: 18 cost time: 5.920238971710205
Epoch: 18, Steps: 13 | Train Loss: 1.186 Vali Loss: 63.211 Vali Acc: 0.540 Test Loss: 63.211 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.927809238433838
Epoch: 19, Steps: 13 | Train Loss: 1.012 Vali Loss: 151.374 Vali Acc: 0.440 Test Loss: 151.374 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 6.147392511367798
Epoch: 20, Steps: 13 | Train Loss: 8.145 Vali Loss: 109.614 Vali Acc: 0.520 Test Loss: 109.614 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.934861898422241
Epoch: 21, Steps: 13 | Train Loss: 11.796 Vali Loss: 111.440 Vali Acc: 0.520 Test Loss: 111.440 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 6.180490732192993
Epoch: 22, Steps: 13 | Train Loss: 13.287 Vali Loss: 91.677 Vali Acc: 0.580 Test Loss: 91.677 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 5.944936513900757
Epoch: 23, Steps: 13 | Train Loss: 7.274 Vali Loss: 191.406 Vali Acc: 0.440 Test Loss: 191.406 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 5.907231569290161
Epoch: 24, Steps: 13 | Train Loss: 25.763 Vali Loss: 142.619 Vali Acc: 0.540 Test Loss: 142.619 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 5.825382471084595
Epoch: 25, Steps: 13 | Train Loss: 24.726 Vali Loss: 136.843 Vali Acc: 0.460 Test Loss: 136.843 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 6.238767862319946
Epoch: 26, Steps: 13 | Train Loss: 10.499 Vali Loss: 143.365 Vali Acc: 0.380 Test Loss: 143.365 Test Acc: 0.380
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 6.0025434494018555
Epoch: 27, Steps: 13 | Train Loss: 11.228 Vali Loss: 99.304 Vali Acc: 0.500 Test Loss: 99.304 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 27506229
model size : 109.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 8.314144134521484
Epoch: 1, Steps: 13 | Train Loss: 13.502 Vali Loss: 41.042 Vali Acc: 0.200 Test Loss: 41.042 Test Acc: 0.200
Validation loss decreased (inf --> -0.199590).  Saving model ...
Epoch: 2 cost time: 5.919035911560059
Epoch: 2, Steps: 13 | Train Loss: 24.283 Vali Loss: 29.527 Vali Acc: 0.320 Test Loss: 29.527 Test Acc: 0.320
Validation loss decreased (-0.199590 --> -0.319705).  Saving model ...
Epoch: 3 cost time: 6.002424955368042
Epoch: 3, Steps: 13 | Train Loss: 49.156 Vali Loss: 51.294 Vali Acc: 0.320 Test Loss: 51.294 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.008973598480225
Epoch: 4, Steps: 13 | Train Loss: 42.572 Vali Loss: 59.976 Vali Acc: 0.380 Test Loss: 59.976 Test Acc: 0.380
Validation loss decreased (-0.319705 --> -0.379400).  Saving model ...
Epoch: 5 cost time: 5.972449541091919
Epoch: 5, Steps: 13 | Train Loss: 34.838 Vali Loss: 49.250 Vali Acc: 0.460 Test Loss: 49.250 Test Acc: 0.460
Validation loss decreased (-0.379400 --> -0.459507).  Saving model ...
Epoch: 6 cost time: 5.894383907318115
Epoch: 6, Steps: 13 | Train Loss: 33.291 Vali Loss: 121.992 Vali Acc: 0.400 Test Loss: 121.992 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.068492412567139
Epoch: 7, Steps: 13 | Train Loss: 55.948 Vali Loss: 132.189 Vali Acc: 0.340 Test Loss: 132.189 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.895134210586548
Epoch: 8, Steps: 13 | Train Loss: 63.379 Vali Loss: 64.382 Vali Acc: 0.460 Test Loss: 64.382 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.014487981796265
Epoch: 9, Steps: 13 | Train Loss: 26.680 Vali Loss: 143.684 Vali Acc: 0.380 Test Loss: 143.684 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.025952100753784
Epoch: 10, Steps: 13 | Train Loss: 47.614 Vali Loss: 80.930 Vali Acc: 0.500 Test Loss: 80.930 Test Acc: 0.500
Validation loss decreased (-0.459507 --> -0.499191).  Saving model ...
Epoch: 11 cost time: 5.7989256381988525
Epoch: 11, Steps: 13 | Train Loss: 17.617 Vali Loss: 94.197 Vali Acc: 0.520 Test Loss: 94.197 Test Acc: 0.520
Validation loss decreased (-0.499191 --> -0.519058).  Saving model ...
Epoch: 12 cost time: 5.868024110794067
Epoch: 12, Steps: 13 | Train Loss: 5.995 Vali Loss: 78.247 Vali Acc: 0.480 Test Loss: 78.247 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.99518609046936
Epoch: 13, Steps: 13 | Train Loss: 4.145 Vali Loss: 97.311 Vali Acc: 0.520 Test Loss: 97.311 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.764648199081421
Epoch: 14, Steps: 13 | Train Loss: 4.031 Vali Loss: 105.888 Vali Acc: 0.500 Test Loss: 105.888 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.852573871612549
Epoch: 15, Steps: 13 | Train Loss: 6.412 Vali Loss: 79.656 Vali Acc: 0.520 Test Loss: 79.656 Test Acc: 0.520
Validation loss decreased (-0.519058 --> -0.519203).  Saving model ...
Epoch: 16 cost time: 5.83765983581543
Epoch: 16, Steps: 13 | Train Loss: 1.458 Vali Loss: 91.800 Vali Acc: 0.500 Test Loss: 91.800 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.925438165664673
Epoch: 17, Steps: 13 | Train Loss: 3.198 Vali Loss: 111.745 Vali Acc: 0.500 Test Loss: 111.745 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.912384033203125
Epoch: 18, Steps: 13 | Train Loss: 15.676 Vali Loss: 79.276 Vali Acc: 0.520 Test Loss: 79.276 Test Acc: 0.520
Validation loss decreased (-0.519203 --> -0.519207).  Saving model ...
Epoch: 19 cost time: 5.815467119216919
Epoch: 19, Steps: 13 | Train Loss: 12.008 Vali Loss: 123.847 Vali Acc: 0.380 Test Loss: 123.847 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.966748952865601
Epoch: 20, Steps: 13 | Train Loss: 10.163 Vali Loss: 142.882 Vali Acc: 0.480 Test Loss: 142.882 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 6.152287006378174
Epoch: 21, Steps: 13 | Train Loss: 12.796 Vali Loss: 119.434 Vali Acc: 0.420 Test Loss: 119.434 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 5.843617916107178
Epoch: 22, Steps: 13 | Train Loss: 7.236 Vali Loss: 115.197 Vali Acc: 0.520 Test Loss: 115.197 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 5.9406397342681885
Epoch: 23, Steps: 13 | Train Loss: 1.471 Vali Loss: 134.849 Vali Acc: 0.540 Test Loss: 134.849 Test Acc: 0.540
Validation loss decreased (-0.519207 --> -0.538652).  Saving model ...
Epoch: 24 cost time: 5.921622276306152
Epoch: 24, Steps: 13 | Train Loss: 18.383 Vali Loss: 93.615 Vali Acc: 0.640 Test Loss: 93.615 Test Acc: 0.640
Validation loss decreased (-0.538652 --> -0.639064).  Saving model ...
Epoch: 25 cost time: 6.070541143417358
Epoch: 25, Steps: 13 | Train Loss: 2.202 Vali Loss: 201.846 Vali Acc: 0.420 Test Loss: 201.846 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 6.069767475128174
Epoch: 26, Steps: 13 | Train Loss: 12.071 Vali Loss: 123.864 Vali Acc: 0.460 Test Loss: 123.864 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 5.911510229110718
Epoch: 27, Steps: 13 | Train Loss: 35.302 Vali Loss: 153.959 Vali Acc: 0.500 Test Loss: 153.959 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 5.895793199539185
Epoch: 28, Steps: 13 | Train Loss: 6.581 Vali Loss: 152.283 Vali Acc: 0.460 Test Loss: 152.283 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 5.963304042816162
Epoch: 29, Steps: 13 | Train Loss: 8.437 Vali Loss: 226.120 Vali Acc: 0.400 Test Loss: 226.120 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 6.002899408340454
Epoch: 30, Steps: 13 | Train Loss: 46.695 Vali Loss: 218.368 Vali Acc: 0.440 Test Loss: 218.368 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 5.930694341659546
Epoch: 31, Steps: 13 | Train Loss: 156.045 Vali Loss: 139.124 Vali Acc: 0.480 Test Loss: 139.124 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 6.166138410568237
Epoch: 32, Steps: 13 | Train Loss: 42.167 Vali Loss: 201.320 Vali Acc: 0.500 Test Loss: 201.320 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 5.842774868011475
Epoch: 33, Steps: 13 | Train Loss: 35.951 Vali Loss: 163.417 Vali Acc: 0.500 Test Loss: 163.417 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 5.922350883483887
Epoch: 34, Steps: 13 | Train Loss: 4.462 Vali Loss: 190.145 Vali Acc: 0.460 Test Loss: 190.145 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.64
model parameter : 26618421
model size : 106.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 8.415114879608154
Epoch: 1, Steps: 13 | Train Loss: 9.286 Vali Loss: 20.409 Vali Acc: 0.280 Test Loss: 20.409 Test Acc: 0.280
Validation loss decreased (inf --> -0.279796).  Saving model ...
Epoch: 2 cost time: 5.734278202056885
Epoch: 2, Steps: 13 | Train Loss: 23.925 Vali Loss: 36.324 Vali Acc: 0.240 Test Loss: 36.324 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.8973119258880615
Epoch: 3, Steps: 13 | Train Loss: 44.729 Vali Loss: 32.511 Vali Acc: 0.200 Test Loss: 32.511 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.640071868896484
Epoch: 4, Steps: 13 | Train Loss: 24.568 Vali Loss: 29.015 Vali Acc: 0.520 Test Loss: 29.015 Test Acc: 0.520
Validation loss decreased (-0.279796 --> -0.519710).  Saving model ...
Epoch: 5 cost time: 5.726778745651245
Epoch: 5, Steps: 13 | Train Loss: 45.531 Vali Loss: 49.678 Vali Acc: 0.400 Test Loss: 49.678 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.70806622505188
Epoch: 6, Steps: 13 | Train Loss: 56.037 Vali Loss: 68.156 Vali Acc: 0.380 Test Loss: 68.156 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.904390811920166
Epoch: 7, Steps: 13 | Train Loss: 25.658 Vali Loss: 52.927 Vali Acc: 0.420 Test Loss: 52.927 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.91551661491394
Epoch: 8, Steps: 13 | Train Loss: 23.495 Vali Loss: 112.354 Vali Acc: 0.420 Test Loss: 112.354 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.727226257324219
Epoch: 9, Steps: 13 | Train Loss: 33.486 Vali Loss: 131.834 Vali Acc: 0.340 Test Loss: 131.834 Test Acc: 0.340
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.703001022338867
Epoch: 10, Steps: 13 | Train Loss: 45.141 Vali Loss: 105.748 Vali Acc: 0.420 Test Loss: 105.748 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.789767742156982
Epoch: 11, Steps: 13 | Train Loss: 27.375 Vali Loss: 183.242 Vali Acc: 0.440 Test Loss: 183.242 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.8202879428863525
Epoch: 12, Steps: 13 | Train Loss: 30.403 Vali Loss: 86.387 Vali Acc: 0.520 Test Loss: 86.387 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 5.772400617599487
Epoch: 13, Steps: 13 | Train Loss: 37.953 Vali Loss: 212.330 Vali Acc: 0.340 Test Loss: 212.330 Test Acc: 0.340
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 5.571731090545654
Epoch: 14, Steps: 13 | Train Loss: 43.719 Vali Loss: 151.876 Vali Acc: 0.200 Test Loss: 151.876 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 26607925
model size : 106.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 8.03049373626709
Epoch: 1, Steps: 13 | Train Loss: 8.631 Vali Loss: 28.912 Vali Acc: 0.200 Test Loss: 28.912 Test Acc: 0.200
Validation loss decreased (inf --> -0.199711).  Saving model ...
Epoch: 2 cost time: 5.764575004577637
Epoch: 2, Steps: 13 | Train Loss: 19.862 Vali Loss: 29.799 Vali Acc: 0.220 Test Loss: 29.799 Test Acc: 0.220
Validation loss decreased (-0.199711 --> -0.219702).  Saving model ...
Epoch: 3 cost time: 5.782339334487915
Epoch: 3, Steps: 13 | Train Loss: 48.519 Vali Loss: 56.853 Vali Acc: 0.320 Test Loss: 56.853 Test Acc: 0.320
Validation loss decreased (-0.219702 --> -0.319431).  Saving model ...
Epoch: 4 cost time: 5.904619932174683
Epoch: 4, Steps: 13 | Train Loss: 28.561 Vali Loss: 109.268 Vali Acc: 0.340 Test Loss: 109.268 Test Acc: 0.340
Validation loss decreased (-0.319431 --> -0.338907).  Saving model ...
Epoch: 5 cost time: 5.689971685409546
Epoch: 5, Steps: 13 | Train Loss: 47.138 Vali Loss: 51.402 Vali Acc: 0.420 Test Loss: 51.402 Test Acc: 0.420
Validation loss decreased (-0.338907 --> -0.419486).  Saving model ...
Epoch: 6 cost time: 5.720159292221069
Epoch: 6, Steps: 13 | Train Loss: 47.860 Vali Loss: 76.008 Vali Acc: 0.420 Test Loss: 76.008 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.765143394470215
Epoch: 7, Steps: 13 | Train Loss: 50.627 Vali Loss: 136.741 Vali Acc: 0.340 Test Loss: 136.741 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.838747024536133
Epoch: 8, Steps: 13 | Train Loss: 63.758 Vali Loss: 80.310 Vali Acc: 0.480 Test Loss: 80.310 Test Acc: 0.480
Validation loss decreased (-0.419486 --> -0.479197).  Saving model ...
Epoch: 9 cost time: 5.9930877685546875
Epoch: 9, Steps: 13 | Train Loss: 26.204 Vali Loss: 93.353 Vali Acc: 0.420 Test Loss: 93.353 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.797064542770386
Epoch: 10, Steps: 13 | Train Loss: 8.394 Vali Loss: 127.614 Vali Acc: 0.400 Test Loss: 127.614 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.900651931762695
Epoch: 11, Steps: 13 | Train Loss: 43.446 Vali Loss: 131.251 Vali Acc: 0.400 Test Loss: 131.251 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.085079193115234
Epoch: 12, Steps: 13 | Train Loss: 36.771 Vali Loss: 83.843 Vali Acc: 0.520 Test Loss: 83.843 Test Acc: 0.520
Validation loss decreased (-0.479197 --> -0.519162).  Saving model ...
Epoch: 13 cost time: 5.834444761276245
Epoch: 13, Steps: 13 | Train Loss: 8.889 Vali Loss: 96.952 Vali Acc: 0.520 Test Loss: 96.952 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.8955748081207275
Epoch: 14, Steps: 13 | Train Loss: 20.783 Vali Loss: 138.803 Vali Acc: 0.540 Test Loss: 138.803 Test Acc: 0.540
Validation loss decreased (-0.519162 --> -0.538612).  Saving model ...
Epoch: 15 cost time: 6.2746193408966064
Epoch: 15, Steps: 13 | Train Loss: 32.377 Vali Loss: 125.574 Vali Acc: 0.580 Test Loss: 125.574 Test Acc: 0.580
Validation loss decreased (-0.538612 --> -0.578744).  Saving model ...
Epoch: 16 cost time: 5.869773626327515
Epoch: 16, Steps: 13 | Train Loss: 7.972 Vali Loss: 88.923 Vali Acc: 0.540 Test Loss: 88.923 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.220662593841553
Epoch: 17, Steps: 13 | Train Loss: 14.666 Vali Loss: 97.869 Vali Acc: 0.500 Test Loss: 97.869 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.739619493484497
Epoch: 18, Steps: 13 | Train Loss: 13.433 Vali Loss: 109.235 Vali Acc: 0.400 Test Loss: 109.235 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 6.01897668838501
Epoch: 19, Steps: 13 | Train Loss: 3.252 Vali Loss: 147.581 Vali Acc: 0.440 Test Loss: 147.581 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 5.782732009887695
Epoch: 20, Steps: 13 | Train Loss: 5.532 Vali Loss: 139.229 Vali Acc: 0.400 Test Loss: 139.229 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 6.015315294265747
Epoch: 21, Steps: 13 | Train Loss: 15.460 Vali Loss: 151.058 Vali Acc: 0.420 Test Loss: 151.058 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 5.798526287078857
Epoch: 22, Steps: 13 | Train Loss: 10.568 Vali Loss: 96.886 Vali Acc: 0.380 Test Loss: 96.886 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 5.835189580917358
Epoch: 23, Steps: 13 | Train Loss: 0.652 Vali Loss: 110.932 Vali Acc: 0.480 Test Loss: 110.932 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 5.939034461975098
Epoch: 24, Steps: 13 | Train Loss: 12.745 Vali Loss: 134.812 Vali Acc: 0.460 Test Loss: 134.812 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 6.070685625076294
Epoch: 25, Steps: 13 | Train Loss: 19.057 Vali Loss: 144.592 Vali Acc: 0.460 Test Loss: 144.592 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 26597429
model size : 106.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 7.922400712966919
Epoch: 1, Steps: 13 | Train Loss: 15.694 Vali Loss: 62.973 Vali Acc: 0.200 Test Loss: 62.973 Test Acc: 0.200
Validation loss decreased (inf --> -0.199370).  Saving model ...
Epoch: 2 cost time: 5.739407300949097
Epoch: 2, Steps: 13 | Train Loss: 48.012 Vali Loss: 40.324 Vali Acc: 0.240 Test Loss: 40.324 Test Acc: 0.240
Validation loss decreased (-0.199370 --> -0.239597).  Saving model ...
Epoch: 3 cost time: 5.892505407333374
Epoch: 3, Steps: 13 | Train Loss: 42.007 Vali Loss: 48.387 Vali Acc: 0.280 Test Loss: 48.387 Test Acc: 0.280
Validation loss decreased (-0.239597 --> -0.279516).  Saving model ...
Epoch: 4 cost time: 5.903525114059448
Epoch: 4, Steps: 13 | Train Loss: 47.680 Vali Loss: 69.423 Vali Acc: 0.320 Test Loss: 69.423 Test Acc: 0.320
Validation loss decreased (-0.279516 --> -0.319306).  Saving model ...
Epoch: 5 cost time: 5.730992555618286
Epoch: 5, Steps: 13 | Train Loss: 36.345 Vali Loss: 49.284 Vali Acc: 0.360 Test Loss: 49.284 Test Acc: 0.360
Validation loss decreased (-0.319306 --> -0.359507).  Saving model ...
Epoch: 6 cost time: 5.731188535690308
Epoch: 6, Steps: 13 | Train Loss: 28.563 Vali Loss: 51.734 Vali Acc: 0.540 Test Loss: 51.734 Test Acc: 0.540
Validation loss decreased (-0.359507 --> -0.539483).  Saving model ...
Epoch: 7 cost time: 5.840473890304565
Epoch: 7, Steps: 13 | Train Loss: 40.436 Vali Loss: 70.100 Vali Acc: 0.460 Test Loss: 70.100 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.997457981109619
Epoch: 8, Steps: 13 | Train Loss: 50.504 Vali Loss: 102.598 Vali Acc: 0.420 Test Loss: 102.598 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.787670135498047
Epoch: 9, Steps: 13 | Train Loss: 34.896 Vali Loss: 74.755 Vali Acc: 0.480 Test Loss: 74.755 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.943557262420654
Epoch: 10, Steps: 13 | Train Loss: 27.198 Vali Loss: 133.782 Vali Acc: 0.340 Test Loss: 133.782 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.801849842071533
Epoch: 11, Steps: 13 | Train Loss: 24.436 Vali Loss: 72.647 Vali Acc: 0.520 Test Loss: 72.647 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.694681406021118
Epoch: 12, Steps: 13 | Train Loss: 8.464 Vali Loss: 86.923 Vali Acc: 0.540 Test Loss: 86.923 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.894347190856934
Epoch: 13, Steps: 13 | Train Loss: 27.618 Vali Loss: 64.780 Vali Acc: 0.560 Test Loss: 64.780 Test Acc: 0.560
Validation loss decreased (-0.539483 --> -0.559352).  Saving model ...
Epoch: 14 cost time: 6.028643608093262
Epoch: 14, Steps: 13 | Train Loss: 3.488 Vali Loss: 58.807 Vali Acc: 0.600 Test Loss: 58.807 Test Acc: 0.600
Validation loss decreased (-0.559352 --> -0.599412).  Saving model ...
Epoch: 15 cost time: 5.825703144073486
Epoch: 15, Steps: 13 | Train Loss: 2.918 Vali Loss: 150.992 Vali Acc: 0.320 Test Loss: 150.992 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.872650384902954
Epoch: 16, Steps: 13 | Train Loss: 23.004 Vali Loss: 77.086 Vali Acc: 0.660 Test Loss: 77.086 Test Acc: 0.660
Validation loss decreased (-0.599412 --> -0.659229).  Saving model ...
Epoch: 17 cost time: 5.837643384933472
Epoch: 17, Steps: 13 | Train Loss: 4.161 Vali Loss: 61.744 Vali Acc: 0.600 Test Loss: 61.744 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.777753114700317
Epoch: 18, Steps: 13 | Train Loss: 0.094 Vali Loss: 74.722 Vali Acc: 0.480 Test Loss: 74.722 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.8751935958862305
Epoch: 19, Steps: 13 | Train Loss: 5.167 Vali Loss: 94.792 Vali Acc: 0.540 Test Loss: 94.792 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.809236526489258
Epoch: 20, Steps: 13 | Train Loss: 14.568 Vali Loss: 92.435 Vali Acc: 0.620 Test Loss: 92.435 Test Acc: 0.620
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 5.803884983062744
Epoch: 21, Steps: 13 | Train Loss: 4.058 Vali Loss: 114.645 Vali Acc: 0.600 Test Loss: 114.645 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 5.820830583572388
Epoch: 22, Steps: 13 | Train Loss: 12.686 Vali Loss: 87.919 Vali Acc: 0.580 Test Loss: 87.919 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 5.718320608139038
Epoch: 23, Steps: 13 | Train Loss: 13.923 Vali Loss: 87.555 Vali Acc: 0.520 Test Loss: 87.555 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 5.70620059967041
Epoch: 24, Steps: 13 | Train Loss: 11.950 Vali Loss: 107.155 Vali Acc: 0.600 Test Loss: 107.155 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 5.942593574523926
Epoch: 25, Steps: 13 | Train Loss: 6.094 Vali Loss: 117.955 Vali Acc: 0.520 Test Loss: 117.955 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 5.792649030685425
Epoch: 26, Steps: 13 | Train Loss: 18.068 Vali Loss: 140.621 Vali Acc: 0.500 Test Loss: 140.621 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.66
model parameter : 26586933
model size : 106.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 8.156896352767944
Epoch: 1, Steps: 13 | Train Loss: 14.631 Vali Loss: 10.814 Vali Acc: 0.320 Test Loss: 10.814 Test Acc: 0.320
Validation loss decreased (inf --> -0.319892).  Saving model ...
Epoch: 2 cost time: 5.928390264511108
Epoch: 2, Steps: 13 | Train Loss: 26.649 Vali Loss: 46.528 Vali Acc: 0.280 Test Loss: 46.528 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.698223829269409
Epoch: 3, Steps: 13 | Train Loss: 27.151 Vali Loss: 24.966 Vali Acc: 0.280 Test Loss: 24.966 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.954748153686523
Epoch: 4, Steps: 13 | Train Loss: 21.985 Vali Loss: 70.675 Vali Acc: 0.300 Test Loss: 70.675 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.725085020065308
Epoch: 5, Steps: 13 | Train Loss: 38.212 Vali Loss: 65.283 Vali Acc: 0.380 Test Loss: 65.283 Test Acc: 0.380
Validation loss decreased (-0.319892 --> -0.379347).  Saving model ...
Epoch: 6 cost time: 6.054646968841553
Epoch: 6, Steps: 13 | Train Loss: 20.970 Vali Loss: 75.839 Vali Acc: 0.420 Test Loss: 75.839 Test Acc: 0.420
Validation loss decreased (-0.379347 --> -0.419242).  Saving model ...
Epoch: 7 cost time: 5.82069993019104
Epoch: 7, Steps: 13 | Train Loss: 43.370 Vali Loss: 106.694 Vali Acc: 0.380 Test Loss: 106.694 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.028638124465942
Epoch: 8, Steps: 13 | Train Loss: 30.818 Vali Loss: 104.551 Vali Acc: 0.420 Test Loss: 104.551 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.901635646820068
Epoch: 9, Steps: 13 | Train Loss: 42.301 Vali Loss: 132.367 Vali Acc: 0.460 Test Loss: 132.367 Test Acc: 0.460
Validation loss decreased (-0.419242 --> -0.458676).  Saving model ...
Epoch: 10 cost time: 5.932705402374268
Epoch: 10, Steps: 13 | Train Loss: 90.183 Vali Loss: 138.921 Vali Acc: 0.400 Test Loss: 138.921 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.923959255218506
Epoch: 11, Steps: 13 | Train Loss: 25.291 Vali Loss: 119.845 Vali Acc: 0.500 Test Loss: 119.845 Test Acc: 0.500
Validation loss decreased (-0.458676 --> -0.498802).  Saving model ...
Epoch: 12 cost time: 5.910401821136475
Epoch: 12, Steps: 13 | Train Loss: 32.298 Vali Loss: 172.014 Vali Acc: 0.360 Test Loss: 172.014 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.647058963775635
Epoch: 13, Steps: 13 | Train Loss: 28.054 Vali Loss: 114.145 Vali Acc: 0.560 Test Loss: 114.145 Test Acc: 0.560
Validation loss decreased (-0.498802 --> -0.558859).  Saving model ...
Epoch: 14 cost time: 5.839173078536987
Epoch: 14, Steps: 13 | Train Loss: 23.717 Vali Loss: 140.459 Vali Acc: 0.500 Test Loss: 140.459 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.901895999908447
Epoch: 15, Steps: 13 | Train Loss: 37.916 Vali Loss: 104.174 Vali Acc: 0.500 Test Loss: 104.174 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.7656166553497314
Epoch: 16, Steps: 13 | Train Loss: 3.407 Vali Loss: 97.423 Vali Acc: 0.480 Test Loss: 97.423 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.744826078414917
Epoch: 17, Steps: 13 | Train Loss: 7.402 Vali Loss: 154.544 Vali Acc: 0.500 Test Loss: 154.544 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 5.678865194320679
Epoch: 18, Steps: 13 | Train Loss: 6.609 Vali Loss: 99.574 Vali Acc: 0.540 Test Loss: 99.574 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 5.79150915145874
Epoch: 19, Steps: 13 | Train Loss: 7.452 Vali Loss: 114.221 Vali Acc: 0.620 Test Loss: 114.221 Test Acc: 0.620
Validation loss decreased (-0.558859 --> -0.618858).  Saving model ...
Epoch: 20 cost time: 5.852532863616943
Epoch: 20, Steps: 13 | Train Loss: 8.766 Vali Loss: 132.903 Vali Acc: 0.460 Test Loss: 132.903 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.958294868469238
Epoch: 21, Steps: 13 | Train Loss: 7.443 Vali Loss: 139.858 Vali Acc: 0.480 Test Loss: 139.858 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.993737459182739
Epoch: 22, Steps: 13 | Train Loss: 9.562 Vali Loss: 144.018 Vali Acc: 0.520 Test Loss: 144.018 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 5.943622350692749
Epoch: 23, Steps: 13 | Train Loss: 3.092 Vali Loss: 140.971 Vali Acc: 0.520 Test Loss: 140.971 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 5.799535274505615
Epoch: 24, Steps: 13 | Train Loss: 3.063 Vali Loss: 120.578 Vali Acc: 0.540 Test Loss: 120.578 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 5.741068601608276
Epoch: 25, Steps: 13 | Train Loss: 23.654 Vali Loss: 121.649 Vali Acc: 0.580 Test Loss: 121.649 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 6.144992828369141
Epoch: 26, Steps: 13 | Train Loss: 15.952 Vali Loss: 158.253 Vali Acc: 0.500 Test Loss: 158.253 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 5.736205577850342
Epoch: 27, Steps: 13 | Train Loss: 5.422 Vali Loss: 101.648 Vali Acc: 0.540 Test Loss: 101.648 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 5.937214374542236
Epoch: 28, Steps: 13 | Train Loss: 3.481 Vali Loss: 126.327 Vali Acc: 0.640 Test Loss: 126.327 Test Acc: 0.640
Validation loss decreased (-0.618858 --> -0.638737).  Saving model ...
Epoch: 29 cost time: 6.105608940124512
Epoch: 29, Steps: 13 | Train Loss: 6.916 Vali Loss: 155.750 Vali Acc: 0.560 Test Loss: 155.750 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 5.708677053451538
Epoch: 30, Steps: 13 | Train Loss: 6.023 Vali Loss: 109.299 Vali Acc: 0.600 Test Loss: 109.299 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 5.761167764663696
Epoch: 31, Steps: 13 | Train Loss: 4.493 Vali Loss: 124.794 Vali Acc: 0.500 Test Loss: 124.794 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 5.7631847858428955
Epoch: 32, Steps: 13 | Train Loss: 12.406 Vali Loss: 79.679 Vali Acc: 0.680 Test Loss: 79.679 Test Acc: 0.680
Validation loss decreased (-0.638737 --> -0.679203).  Saving model ...
Epoch: 33 cost time: 5.687062501907349
Epoch: 33, Steps: 13 | Train Loss: 4.593 Vali Loss: 84.576 Vali Acc: 0.660 Test Loss: 84.576 Test Acc: 0.660
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 5.631872177124023
Epoch: 34, Steps: 13 | Train Loss: 0.000 Vali Loss: 156.614 Vali Acc: 0.500 Test Loss: 156.614 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 5.974713563919067
Epoch: 35, Steps: 13 | Train Loss: 3.248 Vali Loss: 173.977 Vali Acc: 0.620 Test Loss: 173.977 Test Acc: 0.620
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 5.9400413036346436
Epoch: 36, Steps: 13 | Train Loss: 9.192 Vali Loss: 150.523 Vali Acc: 0.600 Test Loss: 150.523 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 5.648714303970337
Epoch: 37, Steps: 13 | Train Loss: 6.859 Vali Loss: 123.471 Vali Acc: 0.520 Test Loss: 123.471 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 5.934856176376343
Epoch: 38, Steps: 13 | Train Loss: 4.260 Vali Loss: 146.342 Vali Acc: 0.540 Test Loss: 146.342 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 5.88484001159668
Epoch: 39, Steps: 13 | Train Loss: 7.045 Vali Loss: 200.062 Vali Acc: 0.480 Test Loss: 200.062 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 6.092722415924072
Epoch: 40, Steps: 13 | Train Loss: 15.426 Vali Loss: 271.001 Vali Acc: 0.500 Test Loss: 271.001 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 5.757756948471069
Epoch: 41, Steps: 13 | Train Loss: 20.359 Vali Loss: 229.248 Vali Acc: 0.500 Test Loss: 229.248 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 5.817271947860718
Epoch: 42, Steps: 13 | Train Loss: 5.026 Vali Loss: 128.736 Vali Acc: 0.560 Test Loss: 128.736 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.68
model parameter : 26158773
model size : 104.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 7.775144815444946
Epoch: 1, Steps: 13 | Train Loss: 15.075 Vali Loss: 41.604 Vali Acc: 0.280 Test Loss: 41.604 Test Acc: 0.280
Validation loss decreased (inf --> -0.279584).  Saving model ...
Epoch: 2 cost time: 5.7983903884887695
Epoch: 2, Steps: 13 | Train Loss: 44.225 Vali Loss: 35.525 Vali Acc: 0.200 Test Loss: 35.525 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.488251447677612
Epoch: 3, Steps: 13 | Train Loss: 25.949 Vali Loss: 31.734 Vali Acc: 0.280 Test Loss: 31.734 Test Acc: 0.280
Validation loss decreased (-0.279584 --> -0.279683).  Saving model ...
Epoch: 4 cost time: 5.557754278182983
Epoch: 4, Steps: 13 | Train Loss: 24.149 Vali Loss: 51.999 Vali Acc: 0.360 Test Loss: 51.999 Test Acc: 0.360
Validation loss decreased (-0.279683 --> -0.359480).  Saving model ...
Epoch: 5 cost time: 5.644608497619629
Epoch: 5, Steps: 13 | Train Loss: 65.625 Vali Loss: 110.459 Vali Acc: 0.300 Test Loss: 110.459 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.8764731884002686
Epoch: 6, Steps: 13 | Train Loss: 44.869 Vali Loss: 79.522 Vali Acc: 0.460 Test Loss: 79.522 Test Acc: 0.460
Validation loss decreased (-0.359480 --> -0.459205).  Saving model ...
Epoch: 7 cost time: 5.7301342487335205
Epoch: 7, Steps: 13 | Train Loss: 36.407 Vali Loss: 77.660 Vali Acc: 0.460 Test Loss: 77.660 Test Acc: 0.460
Validation loss decreased (-0.459205 --> -0.459223).  Saving model ...
Epoch: 8 cost time: 5.926833868026733
Epoch: 8, Steps: 13 | Train Loss: 41.540 Vali Loss: 129.652 Vali Acc: 0.460 Test Loss: 129.652 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.75078010559082
Epoch: 9, Steps: 13 | Train Loss: 30.729 Vali Loss: 49.107 Vali Acc: 0.540 Test Loss: 49.107 Test Acc: 0.540
Validation loss decreased (-0.459223 --> -0.539509).  Saving model ...
Epoch: 10 cost time: 5.721400260925293
Epoch: 10, Steps: 13 | Train Loss: 24.130 Vali Loss: 70.829 Vali Acc: 0.480 Test Loss: 70.829 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.730793714523315
Epoch: 11, Steps: 13 | Train Loss: 13.921 Vali Loss: 77.456 Vali Acc: 0.480 Test Loss: 77.456 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.537101984024048
Epoch: 12, Steps: 13 | Train Loss: 23.205 Vali Loss: 98.948 Vali Acc: 0.440 Test Loss: 98.948 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.977420091629028
Epoch: 13, Steps: 13 | Train Loss: 15.436 Vali Loss: 191.203 Vali Acc: 0.420 Test Loss: 191.203 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.703561305999756
Epoch: 14, Steps: 13 | Train Loss: 15.610 Vali Loss: 104.761 Vali Acc: 0.480 Test Loss: 104.761 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.8382251262664795
Epoch: 15, Steps: 13 | Train Loss: 6.350 Vali Loss: 128.543 Vali Acc: 0.460 Test Loss: 128.543 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.55225944519043
Epoch: 16, Steps: 13 | Train Loss: 24.652 Vali Loss: 96.842 Vali Acc: 0.420 Test Loss: 96.842 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.7962327003479
Epoch: 17, Steps: 13 | Train Loss: 4.838 Vali Loss: 93.552 Vali Acc: 0.600 Test Loss: 93.552 Test Acc: 0.600
Validation loss decreased (-0.539509 --> -0.599064).  Saving model ...
Epoch: 18 cost time: 5.805030107498169
Epoch: 18, Steps: 13 | Train Loss: 4.692 Vali Loss: 82.894 Vali Acc: 0.560 Test Loss: 82.894 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.868360757827759
Epoch: 19, Steps: 13 | Train Loss: 13.181 Vali Loss: 114.547 Vali Acc: 0.460 Test Loss: 114.547 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.650787115097046
Epoch: 20, Steps: 13 | Train Loss: 7.595 Vali Loss: 88.064 Vali Acc: 0.480 Test Loss: 88.064 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.758164405822754
Epoch: 21, Steps: 13 | Train Loss: 12.624 Vali Loss: 99.541 Vali Acc: 0.540 Test Loss: 99.541 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 5.857917785644531
Epoch: 22, Steps: 13 | Train Loss: 3.158 Vali Loss: 103.340 Vali Acc: 0.500 Test Loss: 103.340 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 5.954941987991333
Epoch: 23, Steps: 13 | Train Loss: 3.079 Vali Loss: 117.551 Vali Acc: 0.460 Test Loss: 117.551 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 5.760550022125244
Epoch: 24, Steps: 13 | Train Loss: 4.410 Vali Loss: 141.591 Vali Acc: 0.460 Test Loss: 141.591 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 5.877694129943848
Epoch: 25, Steps: 13 | Train Loss: 14.767 Vali Loss: 98.926 Vali Acc: 0.500 Test Loss: 98.926 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 5.781725883483887
Epoch: 26, Steps: 13 | Train Loss: 6.449 Vali Loss: 95.309 Vali Acc: 0.480 Test Loss: 95.309 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 5.625705242156982
Epoch: 27, Steps: 13 | Train Loss: 1.199 Vali Loss: 126.795 Vali Acc: 0.480 Test Loss: 126.795 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 26148277
model size : 104.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 6.9151694774627686
Epoch: 1, Steps: 13 | Train Loss: 19.404 Vali Loss: 23.187 Vali Acc: 0.320 Test Loss: 23.187 Test Acc: 0.320
Validation loss decreased (inf --> -0.319768).  Saving model ...
Epoch: 2 cost time: 5.57858419418335
Epoch: 2, Steps: 13 | Train Loss: 19.612 Vali Loss: 37.598 Vali Acc: 0.220 Test Loss: 37.598 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.686784029006958
Epoch: 3, Steps: 13 | Train Loss: 55.644 Vali Loss: 90.874 Vali Acc: 0.200 Test Loss: 90.874 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.728874444961548
Epoch: 4, Steps: 13 | Train Loss: 89.374 Vali Loss: 66.604 Vali Acc: 0.260 Test Loss: 66.604 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.946967840194702
Epoch: 5, Steps: 13 | Train Loss: 47.012 Vali Loss: 145.590 Vali Acc: 0.240 Test Loss: 145.590 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.725702285766602
Epoch: 6, Steps: 13 | Train Loss: 56.487 Vali Loss: 96.299 Vali Acc: 0.420 Test Loss: 96.299 Test Acc: 0.420
Validation loss decreased (-0.319768 --> -0.419037).  Saving model ...
Epoch: 7 cost time: 5.752696514129639
Epoch: 7, Steps: 13 | Train Loss: 29.043 Vali Loss: 160.736 Vali Acc: 0.460 Test Loss: 160.736 Test Acc: 0.460
Validation loss decreased (-0.419037 --> -0.458393).  Saving model ...
Epoch: 8 cost time: 5.727981328964233
Epoch: 8, Steps: 13 | Train Loss: 71.454 Vali Loss: 85.213 Vali Acc: 0.380 Test Loss: 85.213 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.617951154708862
Epoch: 9, Steps: 13 | Train Loss: 57.990 Vali Loss: 86.929 Vali Acc: 0.460 Test Loss: 86.929 Test Acc: 0.460
Validation loss decreased (-0.458393 --> -0.459131).  Saving model ...
Epoch: 10 cost time: 5.68021297454834
Epoch: 10, Steps: 13 | Train Loss: 27.017 Vali Loss: 80.135 Vali Acc: 0.480 Test Loss: 80.135 Test Acc: 0.480
Validation loss decreased (-0.459131 --> -0.479199).  Saving model ...
Epoch: 11 cost time: 5.782273769378662
Epoch: 11, Steps: 13 | Train Loss: 30.973 Vali Loss: 93.733 Vali Acc: 0.460 Test Loss: 93.733 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.704745292663574
Epoch: 12, Steps: 13 | Train Loss: 24.156 Vali Loss: 81.405 Vali Acc: 0.440 Test Loss: 81.405 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.655386924743652
Epoch: 13, Steps: 13 | Train Loss: 12.302 Vali Loss: 86.714 Vali Acc: 0.520 Test Loss: 86.714 Test Acc: 0.520
Validation loss decreased (-0.479199 --> -0.519133).  Saving model ...
Epoch: 14 cost time: 5.715653657913208
Epoch: 14, Steps: 13 | Train Loss: 11.051 Vali Loss: 72.760 Vali Acc: 0.500 Test Loss: 72.760 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.525454998016357
Epoch: 15, Steps: 13 | Train Loss: 6.170 Vali Loss: 66.720 Vali Acc: 0.580 Test Loss: 66.720 Test Acc: 0.580
Validation loss decreased (-0.519133 --> -0.579333).  Saving model ...
Epoch: 16 cost time: 5.606879949569702
Epoch: 16, Steps: 13 | Train Loss: 5.953 Vali Loss: 71.674 Vali Acc: 0.460 Test Loss: 71.674 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.567467927932739
Epoch: 17, Steps: 13 | Train Loss: 1.737 Vali Loss: 74.580 Vali Acc: 0.520 Test Loss: 74.580 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.579321622848511
Epoch: 18, Steps: 13 | Train Loss: 13.802 Vali Loss: 80.532 Vali Acc: 0.480 Test Loss: 80.532 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.844348907470703
Epoch: 19, Steps: 13 | Train Loss: 7.381 Vali Loss: 105.216 Vali Acc: 0.560 Test Loss: 105.216 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 5.655573129653931
Epoch: 20, Steps: 13 | Train Loss: 5.969 Vali Loss: 94.860 Vali Acc: 0.600 Test Loss: 94.860 Test Acc: 0.600
Validation loss decreased (-0.579333 --> -0.599051).  Saving model ...
Epoch: 21 cost time: 5.903223991394043
Epoch: 21, Steps: 13 | Train Loss: 6.549 Vali Loss: 75.882 Vali Acc: 0.600 Test Loss: 75.882 Test Acc: 0.600
Validation loss decreased (-0.599051 --> -0.599241).  Saving model ...
Epoch: 22 cost time: 5.765655279159546
Epoch: 22, Steps: 13 | Train Loss: 6.152 Vali Loss: 94.060 Vali Acc: 0.600 Test Loss: 94.060 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.780604839324951
Epoch: 23, Steps: 13 | Train Loss: 1.092 Vali Loss: 84.142 Vali Acc: 0.640 Test Loss: 84.142 Test Acc: 0.640
Validation loss decreased (-0.599241 --> -0.639159).  Saving model ...
Epoch: 24 cost time: 5.638146162033081
Epoch: 24, Steps: 13 | Train Loss: 1.349 Vali Loss: 111.925 Vali Acc: 0.580 Test Loss: 111.925 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 5.883893251419067
Epoch: 25, Steps: 13 | Train Loss: 2.641 Vali Loss: 102.722 Vali Acc: 0.540 Test Loss: 102.722 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 5.769385576248169
Epoch: 26, Steps: 13 | Train Loss: 2.479 Vali Loss: 96.008 Vali Acc: 0.620 Test Loss: 96.008 Test Acc: 0.620
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 5.939313650131226
Epoch: 27, Steps: 13 | Train Loss: 0.000 Vali Loss: 151.552 Vali Acc: 0.520 Test Loss: 151.552 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 5.752894639968872
Epoch: 28, Steps: 13 | Train Loss: 2.585 Vali Loss: 157.612 Vali Acc: 0.520 Test Loss: 157.612 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 5.543211460113525
Epoch: 29, Steps: 13 | Train Loss: 14.425 Vali Loss: 63.877 Vali Acc: 0.600 Test Loss: 63.877 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 5.816317796707153
Epoch: 30, Steps: 13 | Train Loss: 0.000 Vali Loss: 106.218 Vali Acc: 0.600 Test Loss: 106.218 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 5.697840452194214
Epoch: 31, Steps: 13 | Train Loss: 3.110 Vali Loss: 109.288 Vali Acc: 0.580 Test Loss: 109.288 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 5.71863317489624
Epoch: 32, Steps: 13 | Train Loss: 0.472 Vali Loss: 165.624 Vali Acc: 0.580 Test Loss: 165.624 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 5.668949842453003
Epoch: 33, Steps: 13 | Train Loss: 7.365 Vali Loss: 190.105 Vali Acc: 0.420 Test Loss: 190.105 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.64
model parameter : 26137781
model size : 104.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 8.022098064422607
Epoch: 1, Steps: 13 | Train Loss: 15.275 Vali Loss: 47.159 Vali Acc: 0.200 Test Loss: 47.159 Test Acc: 0.200
Validation loss decreased (inf --> -0.199528).  Saving model ...
Epoch: 2 cost time: 5.900544166564941
Epoch: 2, Steps: 13 | Train Loss: 43.296 Vali Loss: 41.732 Vali Acc: 0.280 Test Loss: 41.732 Test Acc: 0.280
Validation loss decreased (-0.199528 --> -0.279583).  Saving model ...
Epoch: 3 cost time: 5.838904142379761
Epoch: 3, Steps: 13 | Train Loss: 36.977 Vali Loss: 50.304 Vali Acc: 0.400 Test Loss: 50.304 Test Acc: 0.400
Validation loss decreased (-0.279583 --> -0.399497).  Saving model ...
Epoch: 4 cost time: 5.798169851303101
Epoch: 4, Steps: 13 | Train Loss: 53.740 Vali Loss: 86.563 Vali Acc: 0.400 Test Loss: 86.563 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.9289915561676025
Epoch: 5, Steps: 13 | Train Loss: 43.266 Vali Loss: 82.351 Vali Acc: 0.380 Test Loss: 82.351 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.993367433547974
Epoch: 6, Steps: 13 | Train Loss: 52.648 Vali Loss: 114.900 Vali Acc: 0.440 Test Loss: 114.900 Test Acc: 0.440
Validation loss decreased (-0.399497 --> -0.438851).  Saving model ...
Epoch: 7 cost time: 5.755523920059204
Epoch: 7, Steps: 13 | Train Loss: 30.592 Vali Loss: 62.700 Vali Acc: 0.440 Test Loss: 62.700 Test Acc: 0.440
Validation loss decreased (-0.438851 --> -0.439373).  Saving model ...
Epoch: 8 cost time: 5.8575193881988525
Epoch: 8, Steps: 13 | Train Loss: 29.497 Vali Loss: 86.249 Vali Acc: 0.400 Test Loss: 86.249 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.878297805786133
Epoch: 9, Steps: 13 | Train Loss: 60.651 Vali Loss: 123.827 Vali Acc: 0.480 Test Loss: 123.827 Test Acc: 0.480
Validation loss decreased (-0.439373 --> -0.478762).  Saving model ...
Epoch: 10 cost time: 5.823186874389648
Epoch: 10, Steps: 13 | Train Loss: 37.895 Vali Loss: 117.480 Vali Acc: 0.420 Test Loss: 117.480 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.787573575973511
Epoch: 11, Steps: 13 | Train Loss: 22.090 Vali Loss: 122.942 Vali Acc: 0.420 Test Loss: 122.942 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.736685752868652
Epoch: 12, Steps: 13 | Train Loss: 18.279 Vali Loss: 76.253 Vali Acc: 0.420 Test Loss: 76.253 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.644058465957642
Epoch: 13, Steps: 13 | Train Loss: 19.046 Vali Loss: 151.004 Vali Acc: 0.400 Test Loss: 151.004 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.693092584609985
Epoch: 14, Steps: 13 | Train Loss: 37.108 Vali Loss: 154.289 Vali Acc: 0.460 Test Loss: 154.289 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.6835713386535645
Epoch: 15, Steps: 13 | Train Loss: 38.911 Vali Loss: 92.715 Vali Acc: 0.620 Test Loss: 92.715 Test Acc: 0.620
Validation loss decreased (-0.478762 --> -0.619073).  Saving model ...
Epoch: 16 cost time: 5.696525812149048
Epoch: 16, Steps: 13 | Train Loss: 7.365 Vali Loss: 96.537 Vali Acc: 0.600 Test Loss: 96.537 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.011278867721558
Epoch: 17, Steps: 13 | Train Loss: 24.419 Vali Loss: 94.830 Vali Acc: 0.540 Test Loss: 94.830 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.717976808547974
Epoch: 18, Steps: 13 | Train Loss: 12.987 Vali Loss: 92.522 Vali Acc: 0.520 Test Loss: 92.522 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.9472033977508545
Epoch: 19, Steps: 13 | Train Loss: 0.130 Vali Loss: 104.008 Vali Acc: 0.580 Test Loss: 104.008 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 5.627897262573242
Epoch: 20, Steps: 13 | Train Loss: 11.547 Vali Loss: 122.774 Vali Acc: 0.540 Test Loss: 122.774 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 5.705118417739868
Epoch: 21, Steps: 13 | Train Loss: 2.241 Vali Loss: 153.389 Vali Acc: 0.520 Test Loss: 153.389 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 5.56998085975647
Epoch: 22, Steps: 13 | Train Loss: 11.051 Vali Loss: 99.059 Vali Acc: 0.600 Test Loss: 99.059 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 5.918041944503784
Epoch: 23, Steps: 13 | Train Loss: 23.984 Vali Loss: 187.032 Vali Acc: 0.500 Test Loss: 187.032 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 5.564944744110107
Epoch: 24, Steps: 13 | Train Loss: 20.760 Vali Loss: 165.620 Vali Acc: 0.500 Test Loss: 165.620 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 5.620197296142578
Epoch: 25, Steps: 13 | Train Loss: 11.805 Vali Loss: 121.687 Vali Acc: 0.620 Test Loss: 121.687 Test Acc: 0.620
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 26127285
model size : 104.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 7.299085855484009
Epoch: 1, Steps: 13 | Train Loss: 8.082 Vali Loss: 18.277 Vali Acc: 0.240 Test Loss: 18.277 Test Acc: 0.240
Validation loss decreased (inf --> -0.239817).  Saving model ...
Epoch: 2 cost time: 4.650765895843506
Epoch: 2, Steps: 13 | Train Loss: 24.557 Vali Loss: 42.191 Vali Acc: 0.200 Test Loss: 42.191 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.5317888259887695
Epoch: 3, Steps: 13 | Train Loss: 23.290 Vali Loss: 47.654 Vali Acc: 0.200 Test Loss: 47.654 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.702465534210205
Epoch: 4, Steps: 13 | Train Loss: 25.480 Vali Loss: 22.143 Vali Acc: 0.360 Test Loss: 22.143 Test Acc: 0.360
Validation loss decreased (-0.239817 --> -0.359779).  Saving model ...
Epoch: 5 cost time: 4.599230051040649
Epoch: 5, Steps: 13 | Train Loss: 11.755 Vali Loss: 18.594 Vali Acc: 0.540 Test Loss: 18.594 Test Acc: 0.540
Validation loss decreased (-0.359779 --> -0.539814).  Saving model ...
Epoch: 6 cost time: 4.642618894577026
Epoch: 6, Steps: 13 | Train Loss: 10.953 Vali Loss: 46.194 Vali Acc: 0.300 Test Loss: 46.194 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.495168447494507
Epoch: 7, Steps: 13 | Train Loss: 16.426 Vali Loss: 67.547 Vali Acc: 0.340 Test Loss: 67.547 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.812846660614014
Epoch: 8, Steps: 13 | Train Loss: 19.941 Vali Loss: 27.971 Vali Acc: 0.480 Test Loss: 27.971 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.66065526008606
Epoch: 9, Steps: 13 | Train Loss: 10.676 Vali Loss: 90.552 Vali Acc: 0.280 Test Loss: 90.552 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.6650941371917725
Epoch: 10, Steps: 13 | Train Loss: 12.188 Vali Loss: 34.089 Vali Acc: 0.580 Test Loss: 34.089 Test Acc: 0.580
Validation loss decreased (-0.539814 --> -0.579659).  Saving model ...
Epoch: 11 cost time: 4.70360255241394
Epoch: 11, Steps: 13 | Train Loss: 9.048 Vali Loss: 54.762 Vali Acc: 0.460 Test Loss: 54.762 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.972789764404297
Epoch: 12, Steps: 13 | Train Loss: 18.197 Vali Loss: 76.126 Vali Acc: 0.380 Test Loss: 76.126 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.577603340148926
Epoch: 13, Steps: 13 | Train Loss: 11.543 Vali Loss: 102.749 Vali Acc: 0.380 Test Loss: 102.749 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.779888868331909
Epoch: 14, Steps: 13 | Train Loss: 15.037 Vali Loss: 84.002 Vali Acc: 0.460 Test Loss: 84.002 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.699716329574585
Epoch: 15, Steps: 13 | Train Loss: 70.608 Vali Loss: 118.426 Vali Acc: 0.260 Test Loss: 118.426 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.571291923522949
Epoch: 16, Steps: 13 | Train Loss: 25.627 Vali Loss: 68.986 Vali Acc: 0.420 Test Loss: 68.986 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.7899274826049805
Epoch: 17, Steps: 13 | Train Loss: 13.729 Vali Loss: 51.869 Vali Acc: 0.540 Test Loss: 51.869 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.67333197593689
Epoch: 18, Steps: 13 | Train Loss: 13.335 Vali Loss: 57.667 Vali Acc: 0.520 Test Loss: 57.667 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.844300746917725
Epoch: 19, Steps: 13 | Train Loss: 10.135 Vali Loss: 48.054 Vali Acc: 0.440 Test Loss: 48.054 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.834954261779785
Epoch: 20, Steps: 13 | Train Loss: 2.719 Vali Loss: 46.426 Vali Acc: 0.520 Test Loss: 46.426 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 12856757
model size : 51.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 7.064810752868652
Epoch: 1, Steps: 13 | Train Loss: 8.335 Vali Loss: 17.680 Vali Acc: 0.240 Test Loss: 17.680 Test Acc: 0.240
Validation loss decreased (inf --> -0.239823).  Saving model ...
Epoch: 2 cost time: 4.861215591430664
Epoch: 2, Steps: 13 | Train Loss: 22.321 Vali Loss: 30.814 Vali Acc: 0.240 Test Loss: 30.814 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.7306506633758545
Epoch: 3, Steps: 13 | Train Loss: 14.128 Vali Loss: 16.808 Vali Acc: 0.260 Test Loss: 16.808 Test Acc: 0.260
Validation loss decreased (-0.239823 --> -0.259832).  Saving model ...
Epoch: 4 cost time: 4.811555862426758
Epoch: 4, Steps: 13 | Train Loss: 17.183 Vali Loss: 29.016 Vali Acc: 0.280 Test Loss: 29.016 Test Acc: 0.280
Validation loss decreased (-0.259832 --> -0.279710).  Saving model ...
Epoch: 5 cost time: 4.7425618171691895
Epoch: 5, Steps: 13 | Train Loss: 34.127 Vali Loss: 58.354 Vali Acc: 0.360 Test Loss: 58.354 Test Acc: 0.360
Validation loss decreased (-0.279710 --> -0.359416).  Saving model ...
Epoch: 6 cost time: 5.030522346496582
Epoch: 6, Steps: 13 | Train Loss: 26.567 Vali Loss: 18.274 Vali Acc: 0.560 Test Loss: 18.274 Test Acc: 0.560
Validation loss decreased (-0.359416 --> -0.559817).  Saving model ...
Epoch: 7 cost time: 4.750808954238892
Epoch: 7, Steps: 13 | Train Loss: 19.719 Vali Loss: 58.292 Vali Acc: 0.420 Test Loss: 58.292 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.875463008880615
Epoch: 8, Steps: 13 | Train Loss: 33.974 Vali Loss: 49.505 Vali Acc: 0.460 Test Loss: 49.505 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.7494494915008545
Epoch: 9, Steps: 13 | Train Loss: 17.790 Vali Loss: 45.811 Vali Acc: 0.380 Test Loss: 45.811 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.724647283554077
Epoch: 10, Steps: 13 | Train Loss: 14.922 Vali Loss: 55.520 Vali Acc: 0.540 Test Loss: 55.520 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.834974765777588
Epoch: 11, Steps: 13 | Train Loss: 21.432 Vali Loss: 68.521 Vali Acc: 0.340 Test Loss: 68.521 Test Acc: 0.340
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.8545050621032715
Epoch: 12, Steps: 13 | Train Loss: 9.323 Vali Loss: 39.503 Vali Acc: 0.420 Test Loss: 39.503 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.867718935012817
Epoch: 13, Steps: 13 | Train Loss: 7.471 Vali Loss: 40.180 Vali Acc: 0.480 Test Loss: 40.180 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.709496736526489
Epoch: 14, Steps: 13 | Train Loss: 6.248 Vali Loss: 79.213 Vali Acc: 0.480 Test Loss: 79.213 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.642911672592163
Epoch: 15, Steps: 13 | Train Loss: 6.303 Vali Loss: 47.853 Vali Acc: 0.480 Test Loss: 47.853 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.048031806945801
Epoch: 16, Steps: 13 | Train Loss: 2.899 Vali Loss: 49.217 Vali Acc: 0.500 Test Loss: 49.217 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 12851509
model size : 51.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 6.698017597198486
Epoch: 1, Steps: 13 | Train Loss: 9.193 Vali Loss: 23.572 Vali Acc: 0.200 Test Loss: 23.572 Test Acc: 0.200
Validation loss decreased (inf --> -0.199764).  Saving model ...
Epoch: 2 cost time: 4.806797504425049
Epoch: 2, Steps: 13 | Train Loss: 17.533 Vali Loss: 30.783 Vali Acc: 0.220 Test Loss: 30.783 Test Acc: 0.220
Validation loss decreased (-0.199764 --> -0.219692).  Saving model ...
Epoch: 3 cost time: 4.553369522094727
Epoch: 3, Steps: 13 | Train Loss: 17.576 Vali Loss: 32.343 Vali Acc: 0.200 Test Loss: 32.343 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.7410643100738525
Epoch: 4, Steps: 13 | Train Loss: 21.645 Vali Loss: 33.070 Vali Acc: 0.320 Test Loss: 33.070 Test Acc: 0.320
Validation loss decreased (-0.219692 --> -0.319669).  Saving model ...
Epoch: 5 cost time: 4.762449502944946
Epoch: 5, Steps: 13 | Train Loss: 24.483 Vali Loss: 46.376 Vali Acc: 0.240 Test Loss: 46.376 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.77554178237915
Epoch: 6, Steps: 13 | Train Loss: 16.337 Vali Loss: 61.445 Vali Acc: 0.280 Test Loss: 61.445 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.803736448287964
Epoch: 7, Steps: 13 | Train Loss: 19.982 Vali Loss: 34.422 Vali Acc: 0.460 Test Loss: 34.422 Test Acc: 0.460
Validation loss decreased (-0.319669 --> -0.459656).  Saving model ...
Epoch: 8 cost time: 4.582413911819458
Epoch: 8, Steps: 13 | Train Loss: 7.948 Vali Loss: 37.405 Vali Acc: 0.420 Test Loss: 37.405 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.690549850463867
Epoch: 9, Steps: 13 | Train Loss: 5.781 Vali Loss: 33.573 Vali Acc: 0.440 Test Loss: 33.573 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.591252565383911
Epoch: 10, Steps: 13 | Train Loss: 10.228 Vali Loss: 45.168 Vali Acc: 0.420 Test Loss: 45.168 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.77671217918396
Epoch: 11, Steps: 13 | Train Loss: 4.588 Vali Loss: 38.167 Vali Acc: 0.480 Test Loss: 38.167 Test Acc: 0.480
Validation loss decreased (-0.459656 --> -0.479618).  Saving model ...
Epoch: 12 cost time: 4.591863632202148
Epoch: 12, Steps: 13 | Train Loss: 12.994 Vali Loss: 40.839 Vali Acc: 0.340 Test Loss: 40.839 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.747897624969482
Epoch: 13, Steps: 13 | Train Loss: 11.937 Vali Loss: 40.314 Vali Acc: 0.340 Test Loss: 40.314 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.873906850814819
Epoch: 14, Steps: 13 | Train Loss: 5.074 Vali Loss: 68.704 Vali Acc: 0.360 Test Loss: 68.704 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.745232105255127
Epoch: 15, Steps: 13 | Train Loss: 2.702 Vali Loss: 52.287 Vali Acc: 0.420 Test Loss: 52.287 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.778561592102051
Epoch: 16, Steps: 13 | Train Loss: 1.279 Vali Loss: 46.431 Vali Acc: 0.440 Test Loss: 46.431 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.590868949890137
Epoch: 17, Steps: 13 | Train Loss: 1.412 Vali Loss: 50.673 Vali Acc: 0.420 Test Loss: 50.673 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.718472480773926
Epoch: 18, Steps: 13 | Train Loss: 4.007 Vali Loss: 38.355 Vali Acc: 0.500 Test Loss: 38.355 Test Acc: 0.500
Validation loss decreased (-0.479618 --> -0.499616).  Saving model ...
Epoch: 19 cost time: 4.761139392852783
Epoch: 19, Steps: 13 | Train Loss: 3.453 Vali Loss: 49.582 Vali Acc: 0.460 Test Loss: 49.582 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.694946765899658
Epoch: 20, Steps: 13 | Train Loss: 5.457 Vali Loss: 52.990 Vali Acc: 0.380 Test Loss: 52.990 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.979604721069336
Epoch: 21, Steps: 13 | Train Loss: 5.181 Vali Loss: 64.841 Vali Acc: 0.460 Test Loss: 64.841 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.711820125579834
Epoch: 22, Steps: 13 | Train Loss: 3.320 Vali Loss: 35.827 Vali Acc: 0.480 Test Loss: 35.827 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.550853967666626
Epoch: 23, Steps: 13 | Train Loss: 1.575 Vali Loss: 52.939 Vali Acc: 0.500 Test Loss: 52.939 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 4.808120489120483
Epoch: 24, Steps: 13 | Train Loss: 2.373 Vali Loss: 58.577 Vali Acc: 0.440 Test Loss: 58.577 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 4.642483711242676
Epoch: 25, Steps: 13 | Train Loss: 2.809 Vali Loss: 50.354 Vali Acc: 0.480 Test Loss: 50.354 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 4.735215425491333
Epoch: 26, Steps: 13 | Train Loss: 0.000 Vali Loss: 47.259 Vali Acc: 0.420 Test Loss: 47.259 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 4.805380344390869
Epoch: 27, Steps: 13 | Train Loss: 0.000 Vali Loss: 48.751 Vali Acc: 0.440 Test Loss: 48.751 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 4.663744688034058
Epoch: 28, Steps: 13 | Train Loss: 0.000 Vali Loss: 49.220 Vali Acc: 0.440 Test Loss: 49.220 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 12846261
model size : 51.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 6.409455060958862
Epoch: 1, Steps: 13 | Train Loss: 9.740 Vali Loss: 13.861 Vali Acc: 0.320 Test Loss: 13.861 Test Acc: 0.320
Validation loss decreased (inf --> -0.319861).  Saving model ...
Epoch: 2 cost time: 4.578399181365967
Epoch: 2, Steps: 13 | Train Loss: 12.224 Vali Loss: 4.816 Vali Acc: 0.380 Test Loss: 4.816 Test Acc: 0.380
Validation loss decreased (-0.319861 --> -0.379952).  Saving model ...
Epoch: 3 cost time: 4.577597141265869
Epoch: 3, Steps: 13 | Train Loss: 11.316 Vali Loss: 14.663 Vali Acc: 0.320 Test Loss: 14.663 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.489768743515015
Epoch: 4, Steps: 13 | Train Loss: 14.617 Vali Loss: 22.258 Vali Acc: 0.320 Test Loss: 22.258 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.450839996337891
Epoch: 5, Steps: 13 | Train Loss: 21.665 Vali Loss: 61.679 Vali Acc: 0.280 Test Loss: 61.679 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.434571743011475
Epoch: 6, Steps: 13 | Train Loss: 19.550 Vali Loss: 45.784 Vali Acc: 0.400 Test Loss: 45.784 Test Acc: 0.400
Validation loss decreased (-0.379952 --> -0.399542).  Saving model ...
Epoch: 7 cost time: 4.553432464599609
Epoch: 7, Steps: 13 | Train Loss: 14.346 Vali Loss: 35.334 Vali Acc: 0.360 Test Loss: 35.334 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.5493364334106445
Epoch: 8, Steps: 13 | Train Loss: 11.445 Vali Loss: 45.805 Vali Acc: 0.320 Test Loss: 45.805 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.6699957847595215
Epoch: 9, Steps: 13 | Train Loss: 16.483 Vali Loss: 65.711 Vali Acc: 0.380 Test Loss: 65.711 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.7634501457214355
Epoch: 10, Steps: 13 | Train Loss: 31.659 Vali Loss: 50.355 Vali Acc: 0.460 Test Loss: 50.355 Test Acc: 0.460
Validation loss decreased (-0.399542 --> -0.459496).  Saving model ...
Epoch: 11 cost time: 4.458508014678955
Epoch: 11, Steps: 13 | Train Loss: 8.469 Vali Loss: 74.417 Vali Acc: 0.480 Test Loss: 74.417 Test Acc: 0.480
Validation loss decreased (-0.459496 --> -0.479256).  Saving model ...
Epoch: 12 cost time: 4.614851951599121
Epoch: 12, Steps: 13 | Train Loss: 26.715 Vali Loss: 97.811 Vali Acc: 0.340 Test Loss: 97.811 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.465210676193237
Epoch: 13, Steps: 13 | Train Loss: 16.436 Vali Loss: 65.347 Vali Acc: 0.480 Test Loss: 65.347 Test Acc: 0.480
Validation loss decreased (-0.479256 --> -0.479347).  Saving model ...
Epoch: 14 cost time: 4.489464521408081
Epoch: 14, Steps: 13 | Train Loss: 2.423 Vali Loss: 61.233 Vali Acc: 0.460 Test Loss: 61.233 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.660132169723511
Epoch: 15, Steps: 13 | Train Loss: 8.964 Vali Loss: 57.568 Vali Acc: 0.500 Test Loss: 57.568 Test Acc: 0.500
Validation loss decreased (-0.479347 --> -0.499424).  Saving model ...
Epoch: 16 cost time: 4.621553897857666
Epoch: 16, Steps: 13 | Train Loss: 2.889 Vali Loss: 58.493 Vali Acc: 0.480 Test Loss: 58.493 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.544579982757568
Epoch: 17, Steps: 13 | Train Loss: 6.726 Vali Loss: 85.119 Vali Acc: 0.480 Test Loss: 85.119 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.678868770599365
Epoch: 18, Steps: 13 | Train Loss: 15.323 Vali Loss: 62.598 Vali Acc: 0.520 Test Loss: 62.598 Test Acc: 0.520
Validation loss decreased (-0.499424 --> -0.519374).  Saving model ...
Epoch: 19 cost time: 4.470165967941284
Epoch: 19, Steps: 13 | Train Loss: 3.643 Vali Loss: 60.649 Vali Acc: 0.500 Test Loss: 60.649 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.475318431854248
Epoch: 20, Steps: 13 | Train Loss: 4.039 Vali Loss: 51.337 Vali Acc: 0.600 Test Loss: 51.337 Test Acc: 0.600
Validation loss decreased (-0.519374 --> -0.599487).  Saving model ...
Epoch: 21 cost time: 4.474539756774902
Epoch: 21, Steps: 13 | Train Loss: 0.000 Vali Loss: 67.818 Vali Acc: 0.620 Test Loss: 67.818 Test Acc: 0.620
Validation loss decreased (-0.599487 --> -0.619322).  Saving model ...
Epoch: 22 cost time: 4.477263689041138
Epoch: 22, Steps: 13 | Train Loss: 3.945 Vali Loss: 57.758 Vali Acc: 0.620 Test Loss: 57.758 Test Acc: 0.620
Validation loss decreased (-0.619322 --> -0.619422).  Saving model ...
Epoch: 23 cost time: 4.778923749923706
Epoch: 23, Steps: 13 | Train Loss: 3.900 Vali Loss: 32.565 Vali Acc: 0.620 Test Loss: 32.565 Test Acc: 0.620
Validation loss decreased (-0.619422 --> -0.619674).  Saving model ...
Epoch: 24 cost time: 4.468958139419556
Epoch: 24, Steps: 13 | Train Loss: 5.418 Vali Loss: 43.267 Vali Acc: 0.560 Test Loss: 43.267 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.606201171875
Epoch: 25, Steps: 13 | Train Loss: 0.520 Vali Loss: 33.731 Vali Acc: 0.520 Test Loss: 33.731 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 4.698647975921631
Epoch: 26, Steps: 13 | Train Loss: 0.000 Vali Loss: 32.837 Vali Acc: 0.600 Test Loss: 32.837 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 4.584144115447998
Epoch: 27, Steps: 13 | Train Loss: 0.000 Vali Loss: 33.811 Vali Acc: 0.560 Test Loss: 33.811 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 4.649273633956909
Epoch: 28, Steps: 13 | Train Loss: 0.000 Vali Loss: 34.287 Vali Acc: 0.580 Test Loss: 34.287 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 4.50279974937439
Epoch: 29, Steps: 13 | Train Loss: 0.000 Vali Loss: 34.431 Vali Acc: 0.580 Test Loss: 34.431 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 4.508734703063965
Epoch: 30, Steps: 13 | Train Loss: 0.000 Vali Loss: 34.469 Vali Acc: 0.580 Test Loss: 34.469 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 4.6592323780059814
Epoch: 31, Steps: 13 | Train Loss: 0.000 Vali Loss: 34.480 Vali Acc: 0.580 Test Loss: 34.480 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 4.481881380081177
Epoch: 32, Steps: 13 | Train Loss: 0.000 Vali Loss: 34.482 Vali Acc: 0.580 Test Loss: 34.482 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 4.615468740463257
Epoch: 33, Steps: 13 | Train Loss: 0.000 Vali Loss: 34.483 Vali Acc: 0.580 Test Loss: 34.483 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 12841013
model size : 51.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 6.642449378967285
Epoch: 1, Steps: 13 | Train Loss: 9.236 Vali Loss: 6.201 Vali Acc: 0.280 Test Loss: 6.201 Test Acc: 0.280
Validation loss decreased (inf --> -0.279938).  Saving model ...
Epoch: 2 cost time: 4.70706582069397
Epoch: 2, Steps: 13 | Train Loss: 13.281 Vali Loss: 15.074 Vali Acc: 0.220 Test Loss: 15.074 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.334387540817261
Epoch: 3, Steps: 13 | Train Loss: 9.748 Vali Loss: 24.234 Vali Acc: 0.420 Test Loss: 24.234 Test Acc: 0.420
Validation loss decreased (-0.279938 --> -0.419758).  Saving model ...
Epoch: 4 cost time: 4.435527801513672
Epoch: 4, Steps: 13 | Train Loss: 14.131 Vali Loss: 24.994 Vali Acc: 0.360 Test Loss: 24.994 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.425130605697632
Epoch: 5, Steps: 13 | Train Loss: 13.251 Vali Loss: 26.116 Vali Acc: 0.440 Test Loss: 26.116 Test Acc: 0.440
Validation loss decreased (-0.419758 --> -0.439739).  Saving model ...
Epoch: 6 cost time: 4.350563049316406
Epoch: 6, Steps: 13 | Train Loss: 19.512 Vali Loss: 45.420 Vali Acc: 0.420 Test Loss: 45.420 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.677619695663452
Epoch: 7, Steps: 13 | Train Loss: 19.381 Vali Loss: 27.246 Vali Acc: 0.480 Test Loss: 27.246 Test Acc: 0.480
Validation loss decreased (-0.439739 --> -0.479728).  Saving model ...
Epoch: 8 cost time: 4.451390743255615
Epoch: 8, Steps: 13 | Train Loss: 20.703 Vali Loss: 47.541 Vali Acc: 0.400 Test Loss: 47.541 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.2607574462890625
Epoch: 9, Steps: 13 | Train Loss: 6.751 Vali Loss: 38.561 Vali Acc: 0.460 Test Loss: 38.561 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.526402473449707
Epoch: 10, Steps: 13 | Train Loss: 9.964 Vali Loss: 42.396 Vali Acc: 0.480 Test Loss: 42.396 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.238894462585449
Epoch: 11, Steps: 13 | Train Loss: 11.233 Vali Loss: 43.284 Vali Acc: 0.420 Test Loss: 43.284 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.471216201782227
Epoch: 12, Steps: 13 | Train Loss: 25.953 Vali Loss: 46.842 Vali Acc: 0.500 Test Loss: 46.842 Test Acc: 0.500
Validation loss decreased (-0.479728 --> -0.499532).  Saving model ...
Epoch: 13 cost time: 4.420789003372192
Epoch: 13, Steps: 13 | Train Loss: 16.148 Vali Loss: 73.321 Vali Acc: 0.460 Test Loss: 73.321 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.405293703079224
Epoch: 14, Steps: 13 | Train Loss: 6.958 Vali Loss: 65.542 Vali Acc: 0.480 Test Loss: 65.542 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.164005756378174
Epoch: 15, Steps: 13 | Train Loss: 3.983 Vali Loss: 69.712 Vali Acc: 0.440 Test Loss: 69.712 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.475613594055176
Epoch: 16, Steps: 13 | Train Loss: 10.056 Vali Loss: 91.718 Vali Acc: 0.400 Test Loss: 91.718 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.394641160964966
Epoch: 17, Steps: 13 | Train Loss: 15.899 Vali Loss: 46.682 Vali Acc: 0.520 Test Loss: 46.682 Test Acc: 0.520
Validation loss decreased (-0.499532 --> -0.519533).  Saving model ...
Epoch: 18 cost time: 4.464398384094238
Epoch: 18, Steps: 13 | Train Loss: 7.166 Vali Loss: 37.973 Vali Acc: 0.520 Test Loss: 37.973 Test Acc: 0.520
Validation loss decreased (-0.519533 --> -0.519620).  Saving model ...
Epoch: 19 cost time: 4.30513334274292
Epoch: 19, Steps: 13 | Train Loss: 1.419 Vali Loss: 79.938 Vali Acc: 0.480 Test Loss: 79.938 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.798379898071289
Epoch: 20, Steps: 13 | Train Loss: 4.547 Vali Loss: 64.338 Vali Acc: 0.560 Test Loss: 64.338 Test Acc: 0.560
Validation loss decreased (-0.519620 --> -0.559357).  Saving model ...
Epoch: 21 cost time: 4.469966173171997
Epoch: 21, Steps: 13 | Train Loss: 0.045 Vali Loss: 98.881 Vali Acc: 0.420 Test Loss: 98.881 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.522998332977295
Epoch: 22, Steps: 13 | Train Loss: 9.331 Vali Loss: 67.110 Vali Acc: 0.540 Test Loss: 67.110 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.788349151611328
Epoch: 23, Steps: 13 | Train Loss: 0.319 Vali Loss: 59.806 Vali Acc: 0.520 Test Loss: 59.806 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.345183610916138
Epoch: 24, Steps: 13 | Train Loss: 4.338 Vali Loss: 57.777 Vali Acc: 0.520 Test Loss: 57.777 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 4.398655891418457
Epoch: 25, Steps: 13 | Train Loss: 1.384 Vali Loss: 48.655 Vali Acc: 0.580 Test Loss: 48.655 Test Acc: 0.580
Validation loss decreased (-0.559357 --> -0.579513).  Saving model ...
Epoch: 26 cost time: 4.5467705726623535
Epoch: 26, Steps: 13 | Train Loss: 0.202 Vali Loss: 66.817 Vali Acc: 0.500 Test Loss: 66.817 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.528354167938232
Epoch: 27, Steps: 13 | Train Loss: 4.444 Vali Loss: 83.845 Vali Acc: 0.440 Test Loss: 83.845 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 4.353724718093872
Epoch: 28, Steps: 13 | Train Loss: 18.870 Vali Loss: 94.196 Vali Acc: 0.460 Test Loss: 94.196 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 4.486494779586792
Epoch: 29, Steps: 13 | Train Loss: 0.591 Vali Loss: 77.886 Vali Acc: 0.460 Test Loss: 77.886 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 4.278961420059204
Epoch: 30, Steps: 13 | Train Loss: 2.045 Vali Loss: 61.285 Vali Acc: 0.520 Test Loss: 61.285 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 4.4570472240448
Epoch: 31, Steps: 13 | Train Loss: 2.708 Vali Loss: 56.557 Vali Acc: 0.520 Test Loss: 56.557 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 4.551962375640869
Epoch: 32, Steps: 13 | Train Loss: 3.067 Vali Loss: 80.897 Vali Acc: 0.520 Test Loss: 80.897 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 4.338834762573242
Epoch: 33, Steps: 13 | Train Loss: 3.988 Vali Loss: 68.270 Vali Acc: 0.560 Test Loss: 68.270 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 4.7757182121276855
Epoch: 34, Steps: 13 | Train Loss: 6.666 Vali Loss: 66.420 Vali Acc: 0.460 Test Loss: 66.420 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 4.721292734146118
Epoch: 35, Steps: 13 | Train Loss: 2.217 Vali Loss: 59.051 Vali Acc: 0.460 Test Loss: 59.051 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 11935669
model size : 48.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 6.107940673828125
Epoch: 1, Steps: 13 | Train Loss: 5.529 Vali Loss: 12.727 Vali Acc: 0.320 Test Loss: 12.727 Test Acc: 0.320
Validation loss decreased (inf --> -0.319873).  Saving model ...
Epoch: 2 cost time: 4.3952858448028564
Epoch: 2, Steps: 13 | Train Loss: 12.905 Vali Loss: 21.053 Vali Acc: 0.320 Test Loss: 21.053 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.3547446727752686
Epoch: 3, Steps: 13 | Train Loss: 18.677 Vali Loss: 7.776 Vali Acc: 0.380 Test Loss: 7.776 Test Acc: 0.380
Validation loss decreased (-0.319873 --> -0.379922).  Saving model ...
Epoch: 4 cost time: 4.4318482875823975
Epoch: 4, Steps: 13 | Train Loss: 7.535 Vali Loss: 24.027 Vali Acc: 0.340 Test Loss: 24.027 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.400582790374756
Epoch: 5, Steps: 13 | Train Loss: 24.087 Vali Loss: 36.943 Vali Acc: 0.320 Test Loss: 36.943 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.36988377571106
Epoch: 6, Steps: 13 | Train Loss: 13.639 Vali Loss: 17.127 Vali Acc: 0.480 Test Loss: 17.127 Test Acc: 0.480
Validation loss decreased (-0.379922 --> -0.479829).  Saving model ...
Epoch: 7 cost time: 4.3284385204315186
Epoch: 7, Steps: 13 | Train Loss: 14.079 Vali Loss: 18.507 Vali Acc: 0.500 Test Loss: 18.507 Test Acc: 0.500
Validation loss decreased (-0.479829 --> -0.499815).  Saving model ...
Epoch: 8 cost time: 4.2581892013549805
Epoch: 8, Steps: 13 | Train Loss: 16.822 Vali Loss: 51.966 Vali Acc: 0.420 Test Loss: 51.966 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.534870147705078
Epoch: 9, Steps: 13 | Train Loss: 25.706 Vali Loss: 25.848 Vali Acc: 0.520 Test Loss: 25.848 Test Acc: 0.520
Validation loss decreased (-0.499815 --> -0.519742).  Saving model ...
Epoch: 10 cost time: 4.3883960247039795
Epoch: 10, Steps: 13 | Train Loss: 21.637 Vali Loss: 90.389 Vali Acc: 0.400 Test Loss: 90.389 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.499801397323608
Epoch: 11, Steps: 13 | Train Loss: 20.419 Vali Loss: 73.700 Vali Acc: 0.420 Test Loss: 73.700 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.245076417922974
Epoch: 12, Steps: 13 | Train Loss: 18.594 Vali Loss: 61.319 Vali Acc: 0.520 Test Loss: 61.319 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.333028793334961
Epoch: 13, Steps: 13 | Train Loss: 9.492 Vali Loss: 52.115 Vali Acc: 0.440 Test Loss: 52.115 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.558554410934448
Epoch: 14, Steps: 13 | Train Loss: 4.111 Vali Loss: 79.919 Vali Acc: 0.360 Test Loss: 79.919 Test Acc: 0.360
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.458357810974121
Epoch: 15, Steps: 13 | Train Loss: 13.755 Vali Loss: 73.486 Vali Acc: 0.340 Test Loss: 73.486 Test Acc: 0.340
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.263325452804565
Epoch: 16, Steps: 13 | Train Loss: 7.341 Vali Loss: 97.444 Vali Acc: 0.360 Test Loss: 97.444 Test Acc: 0.360
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.425435781478882
Epoch: 17, Steps: 13 | Train Loss: 20.996 Vali Loss: 52.701 Vali Acc: 0.580 Test Loss: 52.701 Test Acc: 0.580
Validation loss decreased (-0.519742 --> -0.579473).  Saving model ...
Epoch: 18 cost time: 4.430670976638794
Epoch: 18, Steps: 13 | Train Loss: 4.161 Vali Loss: 75.347 Vali Acc: 0.500 Test Loss: 75.347 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.404658555984497
Epoch: 19, Steps: 13 | Train Loss: 4.648 Vali Loss: 51.154 Vali Acc: 0.560 Test Loss: 51.154 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.280462741851807
Epoch: 20, Steps: 13 | Train Loss: 6.238 Vali Loss: 47.311 Vali Acc: 0.640 Test Loss: 47.311 Test Acc: 0.640
Validation loss decreased (-0.579473 --> -0.639527).  Saving model ...
Epoch: 21 cost time: 4.353904485702515
Epoch: 21, Steps: 13 | Train Loss: 5.800 Vali Loss: 77.653 Vali Acc: 0.380 Test Loss: 77.653 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.464967727661133
Epoch: 22, Steps: 13 | Train Loss: 4.277 Vali Loss: 49.013 Vali Acc: 0.480 Test Loss: 49.013 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.48432183265686
Epoch: 23, Steps: 13 | Train Loss: 2.975 Vali Loss: 50.356 Vali Acc: 0.520 Test Loss: 50.356 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.299420356750488
Epoch: 24, Steps: 13 | Train Loss: 4.449 Vali Loss: 51.037 Vali Acc: 0.600 Test Loss: 51.037 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 4.382884740829468
Epoch: 25, Steps: 13 | Train Loss: 0.000 Vali Loss: 53.253 Vali Acc: 0.560 Test Loss: 53.253 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.405717611312866
Epoch: 26, Steps: 13 | Train Loss: 0.711 Vali Loss: 58.118 Vali Acc: 0.580 Test Loss: 58.118 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 4.569352865219116
Epoch: 27, Steps: 13 | Train Loss: 0.014 Vali Loss: 51.691 Vali Acc: 0.620 Test Loss: 51.691 Test Acc: 0.620
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 4.396075010299683
Epoch: 28, Steps: 13 | Train Loss: 0.365 Vali Loss: 50.757 Vali Acc: 0.440 Test Loss: 50.757 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 4.381552457809448
Epoch: 29, Steps: 13 | Train Loss: 1.571 Vali Loss: 52.937 Vali Acc: 0.480 Test Loss: 52.937 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 4.498708009719849
Epoch: 30, Steps: 13 | Train Loss: 0.000 Vali Loss: 50.719 Vali Acc: 0.540 Test Loss: 50.719 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.64
model parameter : 11930421
model size : 48.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 6.349479913711548
Epoch: 1, Steps: 13 | Train Loss: 16.019 Vali Loss: 18.308 Vali Acc: 0.260 Test Loss: 18.308 Test Acc: 0.260
Validation loss decreased (inf --> -0.259817).  Saving model ...
Epoch: 2 cost time: 4.275716781616211
Epoch: 2, Steps: 13 | Train Loss: 10.935 Vali Loss: 28.264 Vali Acc: 0.200 Test Loss: 28.264 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.4071574211120605
Epoch: 3, Steps: 13 | Train Loss: 15.137 Vali Loss: 16.615 Vali Acc: 0.280 Test Loss: 16.615 Test Acc: 0.280
Validation loss decreased (-0.259817 --> -0.279834).  Saving model ...
Epoch: 4 cost time: 4.239593982696533
Epoch: 4, Steps: 13 | Train Loss: 16.588 Vali Loss: 24.435 Vali Acc: 0.320 Test Loss: 24.435 Test Acc: 0.320
Validation loss decreased (-0.279834 --> -0.319756).  Saving model ...
Epoch: 5 cost time: 4.485849142074585
Epoch: 5, Steps: 13 | Train Loss: 12.554 Vali Loss: 32.815 Vali Acc: 0.240 Test Loss: 32.815 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.3727991580963135
Epoch: 6, Steps: 13 | Train Loss: 12.946 Vali Loss: 69.546 Vali Acc: 0.200 Test Loss: 69.546 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.309010982513428
Epoch: 7, Steps: 13 | Train Loss: 18.372 Vali Loss: 24.814 Vali Acc: 0.520 Test Loss: 24.814 Test Acc: 0.520
Validation loss decreased (-0.319756 --> -0.519752).  Saving model ...
Epoch: 8 cost time: 4.539499759674072
Epoch: 8, Steps: 13 | Train Loss: 12.848 Vali Loss: 72.863 Vali Acc: 0.340 Test Loss: 72.863 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.359707355499268
Epoch: 9, Steps: 13 | Train Loss: 24.162 Vali Loss: 42.715 Vali Acc: 0.460 Test Loss: 42.715 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.29296088218689
Epoch: 10, Steps: 13 | Train Loss: 13.875 Vali Loss: 53.376 Vali Acc: 0.440 Test Loss: 53.376 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.20560884475708
Epoch: 11, Steps: 13 | Train Loss: 18.550 Vali Loss: 51.321 Vali Acc: 0.480 Test Loss: 51.321 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.310672283172607
Epoch: 12, Steps: 13 | Train Loss: 15.662 Vali Loss: 92.834 Vali Acc: 0.460 Test Loss: 92.834 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.386082649230957
Epoch: 13, Steps: 13 | Train Loss: 38.353 Vali Loss: 45.316 Vali Acc: 0.440 Test Loss: 45.316 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.55685830116272
Epoch: 14, Steps: 13 | Train Loss: 8.326 Vali Loss: 54.949 Vali Acc: 0.520 Test Loss: 54.949 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.133954763412476
Epoch: 15, Steps: 13 | Train Loss: 42.434 Vali Loss: 140.447 Vali Acc: 0.260 Test Loss: 140.447 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.438776969909668
Epoch: 16, Steps: 13 | Train Loss: 17.763 Vali Loss: 118.147 Vali Acc: 0.380 Test Loss: 118.147 Test Acc: 0.380
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.293724536895752
Epoch: 17, Steps: 13 | Train Loss: 50.835 Vali Loss: 126.641 Vali Acc: 0.460 Test Loss: 126.641 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 11925173
model size : 48.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 6.557215452194214
Epoch: 1, Steps: 13 | Train Loss: 5.414 Vali Loss: 22.516 Vali Acc: 0.200 Test Loss: 22.516 Test Acc: 0.200
Validation loss decreased (inf --> -0.199775).  Saving model ...
Epoch: 2 cost time: 4.539201736450195
Epoch: 2, Steps: 13 | Train Loss: 26.770 Vali Loss: 28.741 Vali Acc: 0.240 Test Loss: 28.741 Test Acc: 0.240
Validation loss decreased (-0.199775 --> -0.239713).  Saving model ...
Epoch: 3 cost time: 4.409991025924683
Epoch: 3, Steps: 13 | Train Loss: 26.993 Vali Loss: 49.761 Vali Acc: 0.220 Test Loss: 49.761 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.351627349853516
Epoch: 4, Steps: 13 | Train Loss: 20.312 Vali Loss: 30.759 Vali Acc: 0.280 Test Loss: 30.759 Test Acc: 0.280
Validation loss decreased (-0.239713 --> -0.279692).  Saving model ...
Epoch: 5 cost time: 4.332724571228027
Epoch: 5, Steps: 13 | Train Loss: 22.434 Vali Loss: 44.078 Vali Acc: 0.400 Test Loss: 44.078 Test Acc: 0.400
Validation loss decreased (-0.279692 --> -0.399559).  Saving model ...
Epoch: 6 cost time: 4.4023051261901855
Epoch: 6, Steps: 13 | Train Loss: 23.151 Vali Loss: 29.858 Vali Acc: 0.440 Test Loss: 29.858 Test Acc: 0.440
Validation loss decreased (-0.399559 --> -0.439701).  Saving model ...
Epoch: 7 cost time: 4.387437105178833
Epoch: 7, Steps: 13 | Train Loss: 24.900 Vali Loss: 52.047 Vali Acc: 0.360 Test Loss: 52.047 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.228059530258179
Epoch: 8, Steps: 13 | Train Loss: 20.301 Vali Loss: 36.242 Vali Acc: 0.420 Test Loss: 36.242 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.271607160568237
Epoch: 9, Steps: 13 | Train Loss: 10.834 Vali Loss: 46.263 Vali Acc: 0.460 Test Loss: 46.263 Test Acc: 0.460
Validation loss decreased (-0.439701 --> -0.459537).  Saving model ...
Epoch: 10 cost time: 4.578117847442627
Epoch: 10, Steps: 13 | Train Loss: 15.607 Vali Loss: 55.746 Vali Acc: 0.480 Test Loss: 55.746 Test Acc: 0.480
Validation loss decreased (-0.459537 --> -0.479443).  Saving model ...
Epoch: 11 cost time: 4.315760850906372
Epoch: 11, Steps: 13 | Train Loss: 13.863 Vali Loss: 47.274 Vali Acc: 0.380 Test Loss: 47.274 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.3105549812316895
Epoch: 12, Steps: 13 | Train Loss: 20.972 Vali Loss: 53.122 Vali Acc: 0.440 Test Loss: 53.122 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.2402544021606445
Epoch: 13, Steps: 13 | Train Loss: 12.573 Vali Loss: 71.324 Vali Acc: 0.360 Test Loss: 71.324 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.569747447967529
Epoch: 14, Steps: 13 | Train Loss: 1.215 Vali Loss: 51.292 Vali Acc: 0.460 Test Loss: 51.292 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.466496706008911
Epoch: 15, Steps: 13 | Train Loss: 3.568 Vali Loss: 56.277 Vali Acc: 0.480 Test Loss: 56.277 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.816987037658691
Epoch: 16, Steps: 13 | Train Loss: 0.003 Vali Loss: 73.371 Vali Acc: 0.340 Test Loss: 73.371 Test Acc: 0.340
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.58478045463562
Epoch: 17, Steps: 13 | Train Loss: 3.125 Vali Loss: 61.193 Vali Acc: 0.440 Test Loss: 61.193 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.372463941574097
Epoch: 18, Steps: 13 | Train Loss: 0.392 Vali Loss: 75.514 Vali Acc: 0.480 Test Loss: 75.514 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.5305633544921875
Epoch: 19, Steps: 13 | Train Loss: 7.962 Vali Loss: 96.358 Vali Acc: 0.480 Test Loss: 96.358 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.43317723274231
Epoch: 20, Steps: 13 | Train Loss: 9.516 Vali Loss: 58.770 Vali Acc: 0.520 Test Loss: 58.770 Test Acc: 0.520
Validation loss decreased (-0.479443 --> -0.519412).  Saving model ...
Epoch: 21 cost time: 4.450361013412476
Epoch: 21, Steps: 13 | Train Loss: 0.000 Vali Loss: 59.011 Vali Acc: 0.620 Test Loss: 59.011 Test Acc: 0.620
Validation loss decreased (-0.519412 --> -0.619410).  Saving model ...
Epoch: 22 cost time: 4.412500858306885
Epoch: 22, Steps: 13 | Train Loss: 0.197 Vali Loss: 67.013 Vali Acc: 0.460 Test Loss: 67.013 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.425880432128906
Epoch: 23, Steps: 13 | Train Loss: 1.894 Vali Loss: 69.592 Vali Acc: 0.480 Test Loss: 69.592 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.39513373374939
Epoch: 24, Steps: 13 | Train Loss: 27.160 Vali Loss: 100.433 Vali Acc: 0.480 Test Loss: 100.433 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 4.473064422607422
Epoch: 25, Steps: 13 | Train Loss: 34.448 Vali Loss: 47.705 Vali Acc: 0.520 Test Loss: 47.705 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 4.39047908782959
Epoch: 26, Steps: 13 | Train Loss: 28.049 Vali Loss: 161.450 Vali Acc: 0.400 Test Loss: 161.450 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 4.474679231643677
Epoch: 27, Steps: 13 | Train Loss: 31.488 Vali Loss: 89.577 Vali Acc: 0.460 Test Loss: 89.577 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 4.64028263092041
Epoch: 28, Steps: 13 | Train Loss: 15.847 Vali Loss: 96.508 Vali Acc: 0.460 Test Loss: 96.508 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 4.373121976852417
Epoch: 29, Steps: 13 | Train Loss: 12.411 Vali Loss: 84.447 Vali Acc: 0.580 Test Loss: 84.447 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 4.16701602935791
Epoch: 30, Steps: 13 | Train Loss: 11.573 Vali Loss: 78.646 Vali Acc: 0.540 Test Loss: 78.646 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 4.207092523574829
Epoch: 31, Steps: 13 | Train Loss: 1.511 Vali Loss: 74.688 Vali Acc: 0.560 Test Loss: 74.688 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 11919925
model size : 48.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 6.4669029712677
Epoch: 1, Steps: 13 | Train Loss: 9.292 Vali Loss: 26.972 Vali Acc: 0.200 Test Loss: 26.972 Test Acc: 0.200
Validation loss decreased (inf --> -0.199730).  Saving model ...
Epoch: 2 cost time: 4.609092950820923
Epoch: 2, Steps: 13 | Train Loss: 19.585 Vali Loss: 13.428 Vali Acc: 0.240 Test Loss: 13.428 Test Acc: 0.240
Validation loss decreased (-0.199730 --> -0.239866).  Saving model ...
Epoch: 3 cost time: 4.522731065750122
Epoch: 3, Steps: 13 | Train Loss: 11.619 Vali Loss: 45.768 Vali Acc: 0.300 Test Loss: 45.768 Test Acc: 0.300
Validation loss decreased (-0.239866 --> -0.299542).  Saving model ...
Epoch: 4 cost time: 4.297634601593018
Epoch: 4, Steps: 13 | Train Loss: 15.149 Vali Loss: 23.469 Vali Acc: 0.420 Test Loss: 23.469 Test Acc: 0.420
Validation loss decreased (-0.299542 --> -0.419765).  Saving model ...
Epoch: 5 cost time: 4.389966249465942
Epoch: 5, Steps: 13 | Train Loss: 14.903 Vali Loss: 48.175 Vali Acc: 0.300 Test Loss: 48.175 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.35921311378479
Epoch: 6, Steps: 13 | Train Loss: 17.144 Vali Loss: 59.516 Vali Acc: 0.420 Test Loss: 59.516 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.667672872543335
Epoch: 7, Steps: 13 | Train Loss: 38.443 Vali Loss: 55.666 Vali Acc: 0.360 Test Loss: 55.666 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.384812593460083
Epoch: 8, Steps: 13 | Train Loss: 31.278 Vali Loss: 151.726 Vali Acc: 0.320 Test Loss: 151.726 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.1813294887542725
Epoch: 9, Steps: 13 | Train Loss: 39.823 Vali Loss: 69.145 Vali Acc: 0.280 Test Loss: 69.145 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.67875075340271
Epoch: 10, Steps: 13 | Train Loss: 31.320 Vali Loss: 57.309 Vali Acc: 0.480 Test Loss: 57.309 Test Acc: 0.480
Validation loss decreased (-0.419765 --> -0.479427).  Saving model ...
Epoch: 11 cost time: 4.251868486404419
Epoch: 11, Steps: 13 | Train Loss: 21.544 Vali Loss: 75.235 Vali Acc: 0.520 Test Loss: 75.235 Test Acc: 0.520
Validation loss decreased (-0.479427 --> -0.519248).  Saving model ...
Epoch: 12 cost time: 4.278594017028809
Epoch: 12, Steps: 13 | Train Loss: 24.878 Vali Loss: 60.331 Vali Acc: 0.400 Test Loss: 60.331 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.637279272079468
Epoch: 13, Steps: 13 | Train Loss: 13.200 Vali Loss: 64.044 Vali Acc: 0.460 Test Loss: 64.044 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.290109872817993
Epoch: 14, Steps: 13 | Train Loss: 6.970 Vali Loss: 70.998 Vali Acc: 0.480 Test Loss: 70.998 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.446314573287964
Epoch: 15, Steps: 13 | Train Loss: 6.636 Vali Loss: 84.776 Vali Acc: 0.340 Test Loss: 84.776 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.356604814529419
Epoch: 16, Steps: 13 | Train Loss: 1.647 Vali Loss: 58.294 Vali Acc: 0.520 Test Loss: 58.294 Test Acc: 0.520
Validation loss decreased (-0.519248 --> -0.519417).  Saving model ...
Epoch: 17 cost time: 4.267215967178345
Epoch: 17, Steps: 13 | Train Loss: 6.012 Vali Loss: 60.013 Vali Acc: 0.500 Test Loss: 60.013 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.34740948677063
Epoch: 18, Steps: 13 | Train Loss: 17.878 Vali Loss: 69.453 Vali Acc: 0.520 Test Loss: 69.453 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.396454572677612
Epoch: 19, Steps: 13 | Train Loss: 7.084 Vali Loss: 81.237 Vali Acc: 0.440 Test Loss: 81.237 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.280217170715332
Epoch: 20, Steps: 13 | Train Loss: 9.260 Vali Loss: 73.362 Vali Acc: 0.500 Test Loss: 73.362 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 4.410261869430542
Epoch: 21, Steps: 13 | Train Loss: 7.967 Vali Loss: 99.774 Vali Acc: 0.500 Test Loss: 99.774 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 4.636829376220703
Epoch: 22, Steps: 13 | Train Loss: 2.664 Vali Loss: 76.505 Vali Acc: 0.460 Test Loss: 76.505 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 4.542344808578491
Epoch: 23, Steps: 13 | Train Loss: 21.754 Vali Loss: 118.800 Vali Acc: 0.420 Test Loss: 118.800 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 4.673969984054565
Epoch: 24, Steps: 13 | Train Loss: 8.536 Vali Loss: 96.465 Vali Acc: 0.500 Test Loss: 96.465 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 4.467493295669556
Epoch: 25, Steps: 13 | Train Loss: 1.562 Vali Loss: 123.671 Vali Acc: 0.420 Test Loss: 123.671 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 4.609236717224121
Epoch: 26, Steps: 13 | Train Loss: 15.368 Vali Loss: 89.044 Vali Acc: 0.560 Test Loss: 89.044 Test Acc: 0.560
Validation loss decreased (-0.519417 --> -0.559110).  Saving model ...
Epoch: 27 cost time: 4.422640562057495
Epoch: 27, Steps: 13 | Train Loss: 19.820 Vali Loss: 90.949 Vali Acc: 0.400 Test Loss: 90.949 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.412643194198608
Epoch: 28, Steps: 13 | Train Loss: 4.705 Vali Loss: 87.465 Vali Acc: 0.500 Test Loss: 87.465 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 4.515467643737793
Epoch: 29, Steps: 13 | Train Loss: 7.534 Vali Loss: 108.075 Vali Acc: 0.480 Test Loss: 108.075 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 4.466807126998901
Epoch: 30, Steps: 13 | Train Loss: 16.942 Vali Loss: 122.302 Vali Acc: 0.480 Test Loss: 122.302 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 4.458288908004761
Epoch: 31, Steps: 13 | Train Loss: 17.979 Vali Loss: 80.171 Vali Acc: 0.460 Test Loss: 80.171 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 4.222830772399902
Epoch: 32, Steps: 13 | Train Loss: 10.036 Vali Loss: 129.077 Vali Acc: 0.340 Test Loss: 129.077 Test Acc: 0.340
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 4.174493789672852
Epoch: 33, Steps: 13 | Train Loss: 9.444 Vali Loss: 92.957 Vali Acc: 0.460 Test Loss: 92.957 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 4.2926483154296875
Epoch: 34, Steps: 13 | Train Loss: 5.572 Vali Loss: 104.860 Vali Acc: 0.520 Test Loss: 104.860 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 4.2934510707855225
Epoch: 35, Steps: 13 | Train Loss: 10.021 Vali Loss: 117.165 Vali Acc: 0.500 Test Loss: 117.165 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 4.727548122406006
Epoch: 36, Steps: 13 | Train Loss: 6.617 Vali Loss: 117.710 Vali Acc: 0.440 Test Loss: 117.710 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 11475125
model size : 46.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 7.274243354797363
Epoch: 1, Steps: 13 | Train Loss: 9.477 Vali Loss: 15.066 Vali Acc: 0.200 Test Loss: 15.066 Test Acc: 0.200
Validation loss decreased (inf --> -0.199849).  Saving model ...
Epoch: 2 cost time: 4.473550081253052
Epoch: 2, Steps: 13 | Train Loss: 23.245 Vali Loss: 28.765 Vali Acc: 0.220 Test Loss: 28.765 Test Acc: 0.220
Validation loss decreased (-0.199849 --> -0.219712).  Saving model ...
Epoch: 3 cost time: 4.1710429191589355
Epoch: 3, Steps: 13 | Train Loss: 12.997 Vali Loss: 23.475 Vali Acc: 0.240 Test Loss: 23.475 Test Acc: 0.240
Validation loss decreased (-0.219712 --> -0.239765).  Saving model ...
Epoch: 4 cost time: 4.157486200332642
Epoch: 4, Steps: 13 | Train Loss: 25.317 Vali Loss: 36.351 Vali Acc: 0.280 Test Loss: 36.351 Test Acc: 0.280
Validation loss decreased (-0.239765 --> -0.279636).  Saving model ...
Epoch: 5 cost time: 4.25410008430481
Epoch: 5, Steps: 13 | Train Loss: 17.005 Vali Loss: 29.493 Vali Acc: 0.380 Test Loss: 29.493 Test Acc: 0.380
Validation loss decreased (-0.279636 --> -0.379705).  Saving model ...
Epoch: 6 cost time: 4.354200601577759
Epoch: 6, Steps: 13 | Train Loss: 20.182 Vali Loss: 25.222 Vali Acc: 0.420 Test Loss: 25.222 Test Acc: 0.420
Validation loss decreased (-0.379705 --> -0.419748).  Saving model ...
Epoch: 7 cost time: 4.2361602783203125
Epoch: 7, Steps: 13 | Train Loss: 34.325 Vali Loss: 118.617 Vali Acc: 0.260 Test Loss: 118.617 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.484580755233765
Epoch: 8, Steps: 13 | Train Loss: 75.836 Vali Loss: 59.681 Vali Acc: 0.400 Test Loss: 59.681 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.578540325164795
Epoch: 9, Steps: 13 | Train Loss: 52.894 Vali Loss: 112.999 Vali Acc: 0.400 Test Loss: 112.999 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.43699836730957
Epoch: 10, Steps: 13 | Train Loss: 43.020 Vali Loss: 58.274 Vali Acc: 0.460 Test Loss: 58.274 Test Acc: 0.460
Validation loss decreased (-0.419748 --> -0.459417).  Saving model ...
Epoch: 11 cost time: 4.366704225540161
Epoch: 11, Steps: 13 | Train Loss: 16.602 Vali Loss: 42.887 Vali Acc: 0.480 Test Loss: 42.887 Test Acc: 0.480
Validation loss decreased (-0.459417 --> -0.479571).  Saving model ...
Epoch: 12 cost time: 4.120365858078003
Epoch: 12, Steps: 13 | Train Loss: 3.506 Vali Loss: 67.436 Vali Acc: 0.400 Test Loss: 67.436 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.3287084102630615
Epoch: 13, Steps: 13 | Train Loss: 11.760 Vali Loss: 77.061 Vali Acc: 0.420 Test Loss: 77.061 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.014930725097656
Epoch: 14, Steps: 13 | Train Loss: 11.172 Vali Loss: 69.764 Vali Acc: 0.500 Test Loss: 69.764 Test Acc: 0.500
Validation loss decreased (-0.479571 --> -0.499302).  Saving model ...
Epoch: 15 cost time: 4.336735486984253
Epoch: 15, Steps: 13 | Train Loss: 11.484 Vali Loss: 91.889 Vali Acc: 0.400 Test Loss: 91.889 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.308423757553101
Epoch: 16, Steps: 13 | Train Loss: 9.758 Vali Loss: 96.390 Vali Acc: 0.400 Test Loss: 96.390 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.318807363510132
Epoch: 17, Steps: 13 | Train Loss: 12.565 Vali Loss: 75.619 Vali Acc: 0.460 Test Loss: 75.619 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.3465752601623535
Epoch: 18, Steps: 13 | Train Loss: 10.130 Vali Loss: 76.859 Vali Acc: 0.460 Test Loss: 76.859 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.212753772735596
Epoch: 19, Steps: 13 | Train Loss: 8.702 Vali Loss: 79.992 Vali Acc: 0.420 Test Loss: 79.992 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.324028491973877
Epoch: 20, Steps: 13 | Train Loss: 5.860 Vali Loss: 90.735 Vali Acc: 0.380 Test Loss: 90.735 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.31699800491333
Epoch: 21, Steps: 13 | Train Loss: 6.688 Vali Loss: 79.390 Vali Acc: 0.540 Test Loss: 79.390 Test Acc: 0.540
Validation loss decreased (-0.499302 --> -0.539206).  Saving model ...
Epoch: 22 cost time: 4.19148588180542
Epoch: 22, Steps: 13 | Train Loss: 2.868 Vali Loss: 80.795 Vali Acc: 0.440 Test Loss: 80.795 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.5880842208862305
Epoch: 23, Steps: 13 | Train Loss: 5.378 Vali Loss: 67.636 Vali Acc: 0.560 Test Loss: 67.636 Test Acc: 0.560
Validation loss decreased (-0.539206 --> -0.559324).  Saving model ...
Epoch: 24 cost time: 4.245951414108276
Epoch: 24, Steps: 13 | Train Loss: 7.579 Vali Loss: 69.160 Vali Acc: 0.580 Test Loss: 69.160 Test Acc: 0.580
Validation loss decreased (-0.559324 --> -0.579308).  Saving model ...
Epoch: 25 cost time: 4.417004585266113
Epoch: 25, Steps: 13 | Train Loss: 10.376 Vali Loss: 60.578 Vali Acc: 0.540 Test Loss: 60.578 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.238354921340942
Epoch: 26, Steps: 13 | Train Loss: 22.074 Vali Loss: 119.691 Vali Acc: 0.420 Test Loss: 119.691 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 4.199192047119141
Epoch: 27, Steps: 13 | Train Loss: 6.247 Vali Loss: 49.940 Vali Acc: 0.580 Test Loss: 49.940 Test Acc: 0.580
Validation loss decreased (-0.579308 --> -0.579501).  Saving model ...
Epoch: 28 cost time: 4.386003732681274
Epoch: 28, Steps: 13 | Train Loss: 2.380 Vali Loss: 105.713 Vali Acc: 0.360 Test Loss: 105.713 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 4.266891717910767
Epoch: 29, Steps: 13 | Train Loss: 1.711 Vali Loss: 70.770 Vali Acc: 0.500 Test Loss: 70.770 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 4.200798749923706
Epoch: 30, Steps: 13 | Train Loss: 0.817 Vali Loss: 74.301 Vali Acc: 0.480 Test Loss: 74.301 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 4.129460573196411
Epoch: 31, Steps: 13 | Train Loss: 0.251 Vali Loss: 116.644 Vali Acc: 0.440 Test Loss: 116.644 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 4.270816087722778
Epoch: 32, Steps: 13 | Train Loss: 7.802 Vali Loss: 78.390 Vali Acc: 0.540 Test Loss: 78.390 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 4.478615760803223
Epoch: 33, Steps: 13 | Train Loss: 1.172 Vali Loss: 87.123 Vali Acc: 0.480 Test Loss: 87.123 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 4.298290967941284
Epoch: 34, Steps: 13 | Train Loss: 0.000 Vali Loss: 113.123 Vali Acc: 0.420 Test Loss: 113.123 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 4.445111274719238
Epoch: 35, Steps: 13 | Train Loss: 0.000 Vali Loss: 119.434 Vali Acc: 0.420 Test Loss: 119.434 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 4.242570638656616
Epoch: 36, Steps: 13 | Train Loss: 0.024 Vali Loss: 84.406 Vali Acc: 0.480 Test Loss: 84.406 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 4.3615562915802
Epoch: 37, Steps: 13 | Train Loss: 3.355 Vali Loss: 122.387 Vali Acc: 0.380 Test Loss: 122.387 Test Acc: 0.380
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 11469877
model size : 46.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 6.611665725708008
Epoch: 1, Steps: 13 | Train Loss: 6.634 Vali Loss: 16.300 Vali Acc: 0.200 Test Loss: 16.300 Test Acc: 0.200
Validation loss decreased (inf --> -0.199837).  Saving model ...
Epoch: 2 cost time: 4.268020391464233
Epoch: 2, Steps: 13 | Train Loss: 14.260 Vali Loss: 22.031 Vali Acc: 0.320 Test Loss: 22.031 Test Acc: 0.320
Validation loss decreased (-0.199837 --> -0.319780).  Saving model ...
Epoch: 3 cost time: 4.334136486053467
Epoch: 3, Steps: 13 | Train Loss: 20.779 Vali Loss: 22.141 Vali Acc: 0.220 Test Loss: 22.141 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.517343044281006
Epoch: 4, Steps: 13 | Train Loss: 24.446 Vali Loss: 24.775 Vali Acc: 0.360 Test Loss: 24.775 Test Acc: 0.360
Validation loss decreased (-0.319780 --> -0.359752).  Saving model ...
Epoch: 5 cost time: 4.296415328979492
Epoch: 5, Steps: 13 | Train Loss: 20.152 Vali Loss: 33.779 Vali Acc: 0.380 Test Loss: 33.779 Test Acc: 0.380
Validation loss decreased (-0.359752 --> -0.379662).  Saving model ...
Epoch: 6 cost time: 4.415949106216431
Epoch: 6, Steps: 13 | Train Loss: 17.152 Vali Loss: 38.875 Vali Acc: 0.420 Test Loss: 38.875 Test Acc: 0.420
Validation loss decreased (-0.379662 --> -0.419611).  Saving model ...
Epoch: 7 cost time: 4.519465208053589
Epoch: 7, Steps: 13 | Train Loss: 29.981 Vali Loss: 92.543 Vali Acc: 0.360 Test Loss: 92.543 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.3371665477752686
Epoch: 8, Steps: 13 | Train Loss: 21.664 Vali Loss: 56.951 Vali Acc: 0.440 Test Loss: 56.951 Test Acc: 0.440
Validation loss decreased (-0.419611 --> -0.439430).  Saving model ...
Epoch: 9 cost time: 4.620485782623291
Epoch: 9, Steps: 13 | Train Loss: 23.448 Vali Loss: 49.942 Vali Acc: 0.560 Test Loss: 49.942 Test Acc: 0.560
Validation loss decreased (-0.439430 --> -0.559501).  Saving model ...
Epoch: 10 cost time: 4.465269327163696
Epoch: 10, Steps: 13 | Train Loss: 17.897 Vali Loss: 61.223 Vali Acc: 0.460 Test Loss: 61.223 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.4249427318573
Epoch: 11, Steps: 13 | Train Loss: 8.688 Vali Loss: 44.099 Vali Acc: 0.460 Test Loss: 44.099 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.523741006851196
Epoch: 12, Steps: 13 | Train Loss: 4.924 Vali Loss: 54.218 Vali Acc: 0.440 Test Loss: 54.218 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.40937876701355
Epoch: 13, Steps: 13 | Train Loss: 12.986 Vali Loss: 67.408 Vali Acc: 0.400 Test Loss: 67.408 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.35248327255249
Epoch: 14, Steps: 13 | Train Loss: 3.139 Vali Loss: 39.285 Vali Acc: 0.480 Test Loss: 39.285 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.48356556892395
Epoch: 15, Steps: 13 | Train Loss: 2.068 Vali Loss: 51.472 Vali Acc: 0.400 Test Loss: 51.472 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.7700581550598145
Epoch: 16, Steps: 13 | Train Loss: 6.003 Vali Loss: 51.737 Vali Acc: 0.380 Test Loss: 51.737 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.673645734786987
Epoch: 17, Steps: 13 | Train Loss: 1.403 Vali Loss: 71.112 Vali Acc: 0.440 Test Loss: 71.112 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.572791337966919
Epoch: 18, Steps: 13 | Train Loss: 6.505 Vali Loss: 55.078 Vali Acc: 0.520 Test Loss: 55.078 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.559051752090454
Epoch: 19, Steps: 13 | Train Loss: 2.301 Vali Loss: 56.261 Vali Acc: 0.560 Test Loss: 56.261 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 11464629
model size : 46.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 6.022740602493286
Epoch: 1, Steps: 13 | Train Loss: 11.353 Vali Loss: 20.907 Vali Acc: 0.240 Test Loss: 20.907 Test Acc: 0.240
Validation loss decreased (inf --> -0.239791).  Saving model ...
Epoch: 2 cost time: 4.252147197723389
Epoch: 2, Steps: 13 | Train Loss: 26.448 Vali Loss: 32.649 Vali Acc: 0.200 Test Loss: 32.649 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.28937292098999
Epoch: 3, Steps: 13 | Train Loss: 14.006 Vali Loss: 23.262 Vali Acc: 0.240 Test Loss: 23.262 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.1357102394104
Epoch: 4, Steps: 13 | Train Loss: 17.181 Vali Loss: 25.946 Vali Acc: 0.380 Test Loss: 25.946 Test Acc: 0.380
Validation loss decreased (-0.239791 --> -0.379741).  Saving model ...
Epoch: 5 cost time: 4.175167798995972
Epoch: 5, Steps: 13 | Train Loss: 24.344 Vali Loss: 50.009 Vali Acc: 0.280 Test Loss: 50.009 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.180704832077026
Epoch: 6, Steps: 13 | Train Loss: 34.294 Vali Loss: 77.737 Vali Acc: 0.260 Test Loss: 77.737 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.305251121520996
Epoch: 7, Steps: 13 | Train Loss: 16.770 Vali Loss: 59.557 Vali Acc: 0.460 Test Loss: 59.557 Test Acc: 0.460
Validation loss decreased (-0.379741 --> -0.459404).  Saving model ...
Epoch: 8 cost time: 4.058557510375977
Epoch: 8, Steps: 13 | Train Loss: 25.965 Vali Loss: 50.114 Vali Acc: 0.420 Test Loss: 50.114 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.306270122528076
Epoch: 9, Steps: 13 | Train Loss: 14.073 Vali Loss: 68.122 Vali Acc: 0.420 Test Loss: 68.122 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.272180795669556
Epoch: 10, Steps: 13 | Train Loss: 21.919 Vali Loss: 63.098 Vali Acc: 0.440 Test Loss: 63.098 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.231512069702148
Epoch: 11, Steps: 13 | Train Loss: 17.576 Vali Loss: 79.417 Vali Acc: 0.420 Test Loss: 79.417 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.157934904098511
Epoch: 12, Steps: 13 | Train Loss: 21.499 Vali Loss: 46.827 Vali Acc: 0.560 Test Loss: 46.827 Test Acc: 0.560
Validation loss decreased (-0.459404 --> -0.559532).  Saving model ...
Epoch: 13 cost time: 4.128937721252441
Epoch: 13, Steps: 13 | Train Loss: 17.619 Vali Loss: 47.497 Vali Acc: 0.500 Test Loss: 47.497 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.286211252212524
Epoch: 14, Steps: 13 | Train Loss: 16.748 Vali Loss: 43.167 Vali Acc: 0.580 Test Loss: 43.167 Test Acc: 0.580
Validation loss decreased (-0.559532 --> -0.579568).  Saving model ...
Epoch: 15 cost time: 4.218425512313843
Epoch: 15, Steps: 13 | Train Loss: 5.255 Vali Loss: 54.764 Vali Acc: 0.540 Test Loss: 54.764 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.9991989135742188
Epoch: 16, Steps: 13 | Train Loss: 1.779 Vali Loss: 67.790 Vali Acc: 0.520 Test Loss: 67.790 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.121299505233765
Epoch: 17, Steps: 13 | Train Loss: 4.112 Vali Loss: 65.597 Vali Acc: 0.440 Test Loss: 65.597 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.120378255844116
Epoch: 18, Steps: 13 | Train Loss: 4.104 Vali Loss: 52.343 Vali Acc: 0.540 Test Loss: 52.343 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.177199602127075
Epoch: 19, Steps: 13 | Train Loss: 0.017 Vali Loss: 47.546 Vali Acc: 0.580 Test Loss: 47.546 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.123146057128906
Epoch: 20, Steps: 13 | Train Loss: 1.954 Vali Loss: 89.271 Vali Acc: 0.460 Test Loss: 89.271 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.247488498687744
Epoch: 21, Steps: 13 | Train Loss: 14.024 Vali Loss: 83.320 Vali Acc: 0.520 Test Loss: 83.320 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.135745048522949
Epoch: 22, Steps: 13 | Train Loss: 8.667 Vali Loss: 86.955 Vali Acc: 0.380 Test Loss: 86.955 Test Acc: 0.380
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.311560869216919
Epoch: 23, Steps: 13 | Train Loss: 5.994 Vali Loss: 84.491 Vali Acc: 0.500 Test Loss: 84.491 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 4.459269762039185
Epoch: 24, Steps: 13 | Train Loss: 10.533 Vali Loss: 93.192 Vali Acc: 0.520 Test Loss: 93.192 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 11459381
model size : 46.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.949743986129761
Epoch: 1, Steps: 13 | Train Loss: 13.411 Vali Loss: 32.499 Vali Acc: 0.200 Test Loss: 32.499 Test Acc: 0.200
Validation loss decreased (inf --> -0.199675).  Saving model ...
Epoch: 2 cost time: 3.9947869777679443
Epoch: 2, Steps: 13 | Train Loss: 23.448 Vali Loss: 36.320 Vali Acc: 0.260 Test Loss: 36.320 Test Acc: 0.260
Validation loss decreased (-0.199675 --> -0.259637).  Saving model ...
Epoch: 3 cost time: 4.145502090454102
Epoch: 3, Steps: 13 | Train Loss: 29.952 Vali Loss: 41.637 Vali Acc: 0.200 Test Loss: 41.637 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.200588703155518
Epoch: 4, Steps: 13 | Train Loss: 33.921 Vali Loss: 52.122 Vali Acc: 0.400 Test Loss: 52.122 Test Acc: 0.400
Validation loss decreased (-0.259637 --> -0.399479).  Saving model ...
Epoch: 5 cost time: 3.9907164573669434
Epoch: 5, Steps: 13 | Train Loss: 36.746 Vali Loss: 38.865 Vali Acc: 0.300 Test Loss: 38.865 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.417667865753174
Epoch: 6, Steps: 13 | Train Loss: 31.018 Vali Loss: 55.387 Vali Acc: 0.420 Test Loss: 55.387 Test Acc: 0.420
Validation loss decreased (-0.399479 --> -0.419446).  Saving model ...
Epoch: 7 cost time: 4.016749143600464
Epoch: 7, Steps: 13 | Train Loss: 24.466 Vali Loss: 104.077 Vali Acc: 0.300 Test Loss: 104.077 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.252594947814941
Epoch: 8, Steps: 13 | Train Loss: 46.532 Vali Loss: 81.921 Vali Acc: 0.440 Test Loss: 81.921 Test Acc: 0.440
Validation loss decreased (-0.419446 --> -0.439181).  Saving model ...
Epoch: 9 cost time: 4.212758541107178
Epoch: 9, Steps: 13 | Train Loss: 20.604 Vali Loss: 48.996 Vali Acc: 0.420 Test Loss: 48.996 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.135947942733765
Epoch: 10, Steps: 13 | Train Loss: 9.915 Vali Loss: 92.069 Vali Acc: 0.440 Test Loss: 92.069 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.09644627571106
Epoch: 11, Steps: 13 | Train Loss: 22.468 Vali Loss: 90.575 Vali Acc: 0.440 Test Loss: 90.575 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.0622878074646
Epoch: 12, Steps: 13 | Train Loss: 34.568 Vali Loss: 60.220 Vali Acc: 0.500 Test Loss: 60.220 Test Acc: 0.500
Validation loss decreased (-0.439181 --> -0.499398).  Saving model ...
Epoch: 13 cost time: 4.265058279037476
Epoch: 13, Steps: 13 | Train Loss: 11.184 Vali Loss: 62.655 Vali Acc: 0.440 Test Loss: 62.655 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.051619529724121
Epoch: 14, Steps: 13 | Train Loss: 17.549 Vali Loss: 71.466 Vali Acc: 0.420 Test Loss: 71.466 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.888631820678711
Epoch: 15, Steps: 13 | Train Loss: 7.293 Vali Loss: 51.636 Vali Acc: 0.560 Test Loss: 51.636 Test Acc: 0.560
Validation loss decreased (-0.499398 --> -0.559484).  Saving model ...
Epoch: 16 cost time: 4.0817694664001465
Epoch: 16, Steps: 13 | Train Loss: 6.333 Vali Loss: 94.420 Vali Acc: 0.420 Test Loss: 94.420 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.9850234985351562
Epoch: 17, Steps: 13 | Train Loss: 10.974 Vali Loss: 64.529 Vali Acc: 0.500 Test Loss: 64.529 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.016265869140625
Epoch: 18, Steps: 13 | Train Loss: 20.981 Vali Loss: 91.069 Vali Acc: 0.480 Test Loss: 91.069 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.2131187915802
Epoch: 19, Steps: 13 | Train Loss: 6.329 Vali Loss: 78.615 Vali Acc: 0.340 Test Loss: 78.615 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.13040566444397
Epoch: 20, Steps: 13 | Train Loss: 10.000 Vali Loss: 71.307 Vali Acc: 0.420 Test Loss: 71.307 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.027468919754028
Epoch: 21, Steps: 13 | Train Loss: 3.317 Vali Loss: 74.726 Vali Acc: 0.460 Test Loss: 74.726 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.142606258392334
Epoch: 22, Steps: 13 | Train Loss: 3.382 Vali Loss: 81.727 Vali Acc: 0.460 Test Loss: 81.727 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 4.16563868522644
Epoch: 23, Steps: 13 | Train Loss: 0.421 Vali Loss: 95.280 Vali Acc: 0.400 Test Loss: 95.280 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.38879132270813
Epoch: 24, Steps: 13 | Train Loss: 4.831 Vali Loss: 88.980 Vali Acc: 0.480 Test Loss: 88.980 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 4.038975238800049
Epoch: 25, Steps: 13 | Train Loss: 2.159 Vali Loss: 80.447 Vali Acc: 0.480 Test Loss: 80.447 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 11244853
model size : 45.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.779881715774536
Epoch: 1, Steps: 13 | Train Loss: 7.271 Vali Loss: 28.972 Vali Acc: 0.200 Test Loss: 28.972 Test Acc: 0.200
Validation loss decreased (inf --> -0.199710).  Saving model ...
Epoch: 2 cost time: 3.961247682571411
Epoch: 2, Steps: 13 | Train Loss: 20.674 Vali Loss: 20.928 Vali Acc: 0.220 Test Loss: 20.928 Test Acc: 0.220
Validation loss decreased (-0.199710 --> -0.219791).  Saving model ...
Epoch: 3 cost time: 4.172152280807495
Epoch: 3, Steps: 13 | Train Loss: 19.051 Vali Loss: 34.368 Vali Acc: 0.240 Test Loss: 34.368 Test Acc: 0.240
Validation loss decreased (-0.219791 --> -0.239656).  Saving model ...
Epoch: 4 cost time: 4.18928337097168
Epoch: 4, Steps: 13 | Train Loss: 26.458 Vali Loss: 35.135 Vali Acc: 0.240 Test Loss: 35.135 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.2578349113464355
Epoch: 5, Steps: 13 | Train Loss: 30.421 Vali Loss: 52.157 Vali Acc: 0.360 Test Loss: 52.157 Test Acc: 0.360
Validation loss decreased (-0.239656 --> -0.359478).  Saving model ...
Epoch: 6 cost time: 4.149998664855957
Epoch: 6, Steps: 13 | Train Loss: 24.793 Vali Loss: 39.371 Vali Acc: 0.460 Test Loss: 39.371 Test Acc: 0.460
Validation loss decreased (-0.359478 --> -0.459606).  Saving model ...
Epoch: 7 cost time: 4.367982387542725
Epoch: 7, Steps: 13 | Train Loss: 32.950 Vali Loss: 79.134 Vali Acc: 0.240 Test Loss: 79.134 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.404502868652344
Epoch: 8, Steps: 13 | Train Loss: 47.323 Vali Loss: 87.029 Vali Acc: 0.280 Test Loss: 87.029 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.929056406021118
Epoch: 9, Steps: 13 | Train Loss: 22.394 Vali Loss: 65.309 Vali Acc: 0.500 Test Loss: 65.309 Test Acc: 0.500
Validation loss decreased (-0.459606 --> -0.499347).  Saving model ...
Epoch: 10 cost time: 4.646638631820679
Epoch: 10, Steps: 13 | Train Loss: 34.467 Vali Loss: 50.631 Vali Acc: 0.580 Test Loss: 50.631 Test Acc: 0.580
Validation loss decreased (-0.499347 --> -0.579494).  Saving model ...
Epoch: 11 cost time: 4.629733085632324
Epoch: 11, Steps: 13 | Train Loss: 10.358 Vali Loss: 75.912 Vali Acc: 0.400 Test Loss: 75.912 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.4078590869903564
Epoch: 12, Steps: 13 | Train Loss: 29.526 Vali Loss: 53.819 Vali Acc: 0.480 Test Loss: 53.819 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.274415969848633
Epoch: 13, Steps: 13 | Train Loss: 11.709 Vali Loss: 65.985 Vali Acc: 0.420 Test Loss: 65.985 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.401738405227661
Epoch: 14, Steps: 13 | Train Loss: 5.749 Vali Loss: 69.040 Vali Acc: 0.400 Test Loss: 69.040 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.458331823348999
Epoch: 15, Steps: 13 | Train Loss: 9.096 Vali Loss: 87.252 Vali Acc: 0.320 Test Loss: 87.252 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.311303615570068
Epoch: 16, Steps: 13 | Train Loss: 21.435 Vali Loss: 70.871 Vali Acc: 0.640 Test Loss: 70.871 Test Acc: 0.640
Validation loss decreased (-0.579494 --> -0.639291).  Saving model ...
Epoch: 17 cost time: 4.66816258430481
Epoch: 17, Steps: 13 | Train Loss: 9.179 Vali Loss: 44.233 Vali Acc: 0.520 Test Loss: 44.233 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.651798963546753
Epoch: 18, Steps: 13 | Train Loss: 16.624 Vali Loss: 43.572 Vali Acc: 0.520 Test Loss: 43.572 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.341485500335693
Epoch: 19, Steps: 13 | Train Loss: 6.022 Vali Loss: 83.879 Vali Acc: 0.460 Test Loss: 83.879 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.672478437423706
Epoch: 20, Steps: 13 | Train Loss: 5.249 Vali Loss: 113.749 Vali Acc: 0.340 Test Loss: 113.749 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 4.632278919219971
Epoch: 21, Steps: 13 | Train Loss: 11.392 Vali Loss: 78.619 Vali Acc: 0.460 Test Loss: 78.619 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 4.524730920791626
Epoch: 22, Steps: 13 | Train Loss: 1.755 Vali Loss: 60.323 Vali Acc: 0.440 Test Loss: 60.323 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 4.405119180679321
Epoch: 23, Steps: 13 | Train Loss: 1.807 Vali Loss: 80.727 Vali Acc: 0.540 Test Loss: 80.727 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 4.62975287437439
Epoch: 24, Steps: 13 | Train Loss: 3.046 Vali Loss: 67.573 Vali Acc: 0.500 Test Loss: 67.573 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 4.476352214813232
Epoch: 25, Steps: 13 | Train Loss: 3.522 Vali Loss: 89.061 Vali Acc: 0.520 Test Loss: 89.061 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 4.474347352981567
Epoch: 26, Steps: 13 | Train Loss: 12.790 Vali Loss: 102.529 Vali Acc: 0.460 Test Loss: 102.529 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.64
model parameter : 11239605
model size : 45.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 6.566052198410034
Epoch: 1, Steps: 13 | Train Loss: 6.967 Vali Loss: 20.425 Vali Acc: 0.180 Test Loss: 20.425 Test Acc: 0.180
Validation loss decreased (inf --> -0.179796).  Saving model ...
Epoch: 2 cost time: 4.21782922744751
Epoch: 2, Steps: 13 | Train Loss: 20.185 Vali Loss: 23.741 Vali Acc: 0.300 Test Loss: 23.741 Test Acc: 0.300
Validation loss decreased (-0.179796 --> -0.299763).  Saving model ...
Epoch: 3 cost time: 4.107733964920044
Epoch: 3, Steps: 13 | Train Loss: 24.951 Vali Loss: 17.250 Vali Acc: 0.280 Test Loss: 17.250 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.9385969638824463
Epoch: 4, Steps: 13 | Train Loss: 19.896 Vali Loss: 43.665 Vali Acc: 0.320 Test Loss: 43.665 Test Acc: 0.320
Validation loss decreased (-0.299763 --> -0.319563).  Saving model ...
Epoch: 5 cost time: 3.9603168964385986
Epoch: 5, Steps: 13 | Train Loss: 20.666 Vali Loss: 33.039 Vali Acc: 0.260 Test Loss: 33.039 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.129197359085083
Epoch: 6, Steps: 13 | Train Loss: 12.974 Vali Loss: 63.823 Vali Acc: 0.280 Test Loss: 63.823 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.206409931182861
Epoch: 7, Steps: 13 | Train Loss: 26.958 Vali Loss: 39.102 Vali Acc: 0.580 Test Loss: 39.102 Test Acc: 0.580
Validation loss decreased (-0.319563 --> -0.579609).  Saving model ...
Epoch: 8 cost time: 4.004091024398804
Epoch: 8, Steps: 13 | Train Loss: 35.304 Vali Loss: 90.439 Vali Acc: 0.420 Test Loss: 90.439 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.992811679840088
Epoch: 9, Steps: 13 | Train Loss: 35.048 Vali Loss: 40.998 Vali Acc: 0.520 Test Loss: 40.998 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.274268865585327
Epoch: 10, Steps: 13 | Train Loss: 10.478 Vali Loss: 30.205 Vali Acc: 0.620 Test Loss: 30.205 Test Acc: 0.620
Validation loss decreased (-0.579609 --> -0.619698).  Saving model ...
Epoch: 11 cost time: 3.940932512283325
Epoch: 11, Steps: 13 | Train Loss: 9.664 Vali Loss: 52.381 Vali Acc: 0.480 Test Loss: 52.381 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.3351686000823975
Epoch: 12, Steps: 13 | Train Loss: 4.366 Vali Loss: 34.200 Vali Acc: 0.500 Test Loss: 34.200 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.9504904747009277
Epoch: 13, Steps: 13 | Train Loss: 14.083 Vali Loss: 72.815 Vali Acc: 0.420 Test Loss: 72.815 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.360314846038818
Epoch: 14, Steps: 13 | Train Loss: 14.264 Vali Loss: 102.956 Vali Acc: 0.300 Test Loss: 102.956 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.087945222854614
Epoch: 15, Steps: 13 | Train Loss: 26.321 Vali Loss: 92.986 Vali Acc: 0.400 Test Loss: 92.986 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.210216760635376
Epoch: 16, Steps: 13 | Train Loss: 17.876 Vali Loss: 49.535 Vali Acc: 0.560 Test Loss: 49.535 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.185193777084351
Epoch: 17, Steps: 13 | Train Loss: 9.778 Vali Loss: 84.742 Vali Acc: 0.480 Test Loss: 84.742 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.16343355178833
Epoch: 18, Steps: 13 | Train Loss: 17.924 Vali Loss: 75.932 Vali Acc: 0.380 Test Loss: 75.932 Test Acc: 0.380
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.214240550994873
Epoch: 19, Steps: 13 | Train Loss: 6.079 Vali Loss: 69.047 Vali Acc: 0.460 Test Loss: 69.047 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.406560182571411
Epoch: 20, Steps: 13 | Train Loss: 3.162 Vali Loss: 110.232 Vali Acc: 0.500 Test Loss: 110.232 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 11234357
model size : 45.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.774009466171265
Epoch: 1, Steps: 13 | Train Loss: 7.305 Vali Loss: 21.525 Vali Acc: 0.200 Test Loss: 21.525 Test Acc: 0.200
Validation loss decreased (inf --> -0.199785).  Saving model ...
Epoch: 2 cost time: 3.9032368659973145
Epoch: 2, Steps: 13 | Train Loss: 28.129 Vali Loss: 31.618 Vali Acc: 0.200 Test Loss: 31.618 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.086981534957886
Epoch: 3, Steps: 13 | Train Loss: 17.996 Vali Loss: 29.126 Vali Acc: 0.300 Test Loss: 29.126 Test Acc: 0.300
Validation loss decreased (-0.199785 --> -0.299709).  Saving model ...
Epoch: 4 cost time: 4.162464618682861
Epoch: 4, Steps: 13 | Train Loss: 17.990 Vali Loss: 28.138 Vali Acc: 0.400 Test Loss: 28.138 Test Acc: 0.400
Validation loss decreased (-0.299709 --> -0.399719).  Saving model ...
Epoch: 5 cost time: 4.135448932647705
Epoch: 5, Steps: 13 | Train Loss: 15.546 Vali Loss: 21.429 Vali Acc: 0.380 Test Loss: 21.429 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.0504233837127686
Epoch: 6, Steps: 13 | Train Loss: 17.506 Vali Loss: 67.008 Vali Acc: 0.400 Test Loss: 67.008 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.125502347946167
Epoch: 7, Steps: 13 | Train Loss: 18.634 Vali Loss: 27.223 Vali Acc: 0.540 Test Loss: 27.223 Test Acc: 0.540
Validation loss decreased (-0.399719 --> -0.539728).  Saving model ...
Epoch: 8 cost time: 4.102275371551514
Epoch: 8, Steps: 13 | Train Loss: 12.621 Vali Loss: 48.279 Vali Acc: 0.400 Test Loss: 48.279 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.077138185501099
Epoch: 9, Steps: 13 | Train Loss: 17.137 Vali Loss: 81.135 Vali Acc: 0.380 Test Loss: 81.135 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.041668891906738
Epoch: 10, Steps: 13 | Train Loss: 15.973 Vali Loss: 51.574 Vali Acc: 0.440 Test Loss: 51.574 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.134658098220825
Epoch: 11, Steps: 13 | Train Loss: 39.484 Vali Loss: 72.394 Vali Acc: 0.460 Test Loss: 72.394 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.195616722106934
Epoch: 12, Steps: 13 | Train Loss: 26.945 Vali Loss: 70.458 Vali Acc: 0.440 Test Loss: 70.458 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.160060405731201
Epoch: 13, Steps: 13 | Train Loss: 13.321 Vali Loss: 60.762 Vali Acc: 0.320 Test Loss: 60.762 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.38555908203125
Epoch: 14, Steps: 13 | Train Loss: 20.475 Vali Loss: 74.919 Vali Acc: 0.380 Test Loss: 74.919 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.050050973892212
Epoch: 15, Steps: 13 | Train Loss: 11.024 Vali Loss: 87.945 Vali Acc: 0.460 Test Loss: 87.945 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.375524997711182
Epoch: 16, Steps: 13 | Train Loss: 17.013 Vali Loss: 52.415 Vali Acc: 0.540 Test Loss: 52.415 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.177774429321289
Epoch: 17, Steps: 13 | Train Loss: 9.165 Vali Loss: 97.720 Vali Acc: 0.440 Test Loss: 97.720 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 11229109
model size : 45.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.708465814590454
Epoch: 1, Steps: 13 | Train Loss: 4.340 Vali Loss: 5.676 Vali Acc: 0.220 Test Loss: 5.676 Test Acc: 0.220
Validation loss decreased (inf --> -0.219943).  Saving model ...
Epoch: 2 cost time: 3.7694501876831055
Epoch: 2, Steps: 13 | Train Loss: 5.981 Vali Loss: 5.331 Vali Acc: 0.340 Test Loss: 5.331 Test Acc: 0.340
Validation loss decreased (-0.219943 --> -0.339947).  Saving model ...
Epoch: 3 cost time: 3.7354321479797363
Epoch: 3, Steps: 13 | Train Loss: 7.265 Vali Loss: 7.092 Vali Acc: 0.460 Test Loss: 7.092 Test Acc: 0.460
Validation loss decreased (-0.339947 --> -0.459929).  Saving model ...
Epoch: 4 cost time: 3.5543947219848633
Epoch: 4, Steps: 13 | Train Loss: 6.477 Vali Loss: 9.555 Vali Acc: 0.460 Test Loss: 9.555 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.728036403656006
Epoch: 5, Steps: 13 | Train Loss: 5.450 Vali Loss: 15.544 Vali Acc: 0.480 Test Loss: 15.544 Test Acc: 0.480
Validation loss decreased (-0.459929 --> -0.479845).  Saving model ...
Epoch: 6 cost time: 4.065057992935181
Epoch: 6, Steps: 13 | Train Loss: 11.201 Vali Loss: 17.689 Vali Acc: 0.320 Test Loss: 17.689 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.074861288070679
Epoch: 7, Steps: 13 | Train Loss: 4.754 Vali Loss: 16.078 Vali Acc: 0.440 Test Loss: 16.078 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.577197790145874
Epoch: 8, Steps: 13 | Train Loss: 7.266 Vali Loss: 38.686 Vali Acc: 0.400 Test Loss: 38.686 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.727917432785034
Epoch: 9, Steps: 13 | Train Loss: 16.459 Vali Loss: 27.777 Vali Acc: 0.380 Test Loss: 27.777 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.0171918869018555
Epoch: 10, Steps: 13 | Train Loss: 10.683 Vali Loss: 52.166 Vali Acc: 0.360 Test Loss: 52.166 Test Acc: 0.360
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.7243103981018066
Epoch: 11, Steps: 13 | Train Loss: 13.613 Vali Loss: 42.215 Vali Acc: 0.480 Test Loss: 42.215 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.8333919048309326
Epoch: 12, Steps: 13 | Train Loss: 16.194 Vali Loss: 33.097 Vali Acc: 0.400 Test Loss: 33.097 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.746583938598633
Epoch: 13, Steps: 13 | Train Loss: 5.685 Vali Loss: 51.732 Vali Acc: 0.440 Test Loss: 51.732 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.7472193241119385
Epoch: 14, Steps: 13 | Train Loss: 12.570 Vali Loss: 26.071 Vali Acc: 0.540 Test Loss: 26.071 Test Acc: 0.540
Validation loss decreased (-0.479845 --> -0.539739).  Saving model ...
Epoch: 15 cost time: 3.7664337158203125
Epoch: 15, Steps: 13 | Train Loss: 2.699 Vali Loss: 17.924 Vali Acc: 0.600 Test Loss: 17.924 Test Acc: 0.600
Validation loss decreased (-0.539739 --> -0.599821).  Saving model ...
Epoch: 16 cost time: 3.7885963916778564
Epoch: 16, Steps: 13 | Train Loss: 0.831 Vali Loss: 23.686 Vali Acc: 0.480 Test Loss: 23.686 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.9591541290283203
Epoch: 17, Steps: 13 | Train Loss: 1.223 Vali Loss: 32.114 Vali Acc: 0.480 Test Loss: 32.114 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.9355618953704834
Epoch: 18, Steps: 13 | Train Loss: 3.705 Vali Loss: 19.739 Vali Acc: 0.500 Test Loss: 19.739 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.8952693939208984
Epoch: 19, Steps: 13 | Train Loss: 2.420 Vali Loss: 26.548 Vali Acc: 0.460 Test Loss: 26.548 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.6564126014709473
Epoch: 20, Steps: 13 | Train Loss: 0.044 Vali Loss: 35.365 Vali Acc: 0.500 Test Loss: 35.365 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.6303651332855225
Epoch: 21, Steps: 13 | Train Loss: 1.404 Vali Loss: 38.585 Vali Acc: 0.460 Test Loss: 38.585 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.748425006866455
Epoch: 22, Steps: 13 | Train Loss: 0.032 Vali Loss: 41.684 Vali Acc: 0.500 Test Loss: 41.684 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.6608705520629883
Epoch: 23, Steps: 13 | Train Loss: 3.438 Vali Loss: 50.713 Vali Acc: 0.360 Test Loss: 50.713 Test Acc: 0.360
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.7058613300323486
Epoch: 24, Steps: 13 | Train Loss: 0.409 Vali Loss: 28.116 Vali Acc: 0.480 Test Loss: 28.116 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.65757155418396
Epoch: 25, Steps: 13 | Train Loss: 0.000 Vali Loss: 26.796 Vali Acc: 0.500 Test Loss: 26.796 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 5973237
model size : 24.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 6.1491923332214355
Epoch: 1, Steps: 13 | Train Loss: 3.763 Vali Loss: 3.805 Vali Acc: 0.240 Test Loss: 3.805 Test Acc: 0.240
Validation loss decreased (inf --> -0.239962).  Saving model ...
Epoch: 2 cost time: 3.633430242538452
Epoch: 2, Steps: 13 | Train Loss: 4.254 Vali Loss: 11.604 Vali Acc: 0.380 Test Loss: 11.604 Test Acc: 0.380
Validation loss decreased (-0.239962 --> -0.379884).  Saving model ...
Epoch: 3 cost time: 3.763016700744629
Epoch: 3, Steps: 13 | Train Loss: 5.370 Vali Loss: 8.165 Vali Acc: 0.340 Test Loss: 8.165 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.7331924438476562
Epoch: 4, Steps: 13 | Train Loss: 10.193 Vali Loss: 35.544 Vali Acc: 0.260 Test Loss: 35.544 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.645500898361206
Epoch: 5, Steps: 13 | Train Loss: 25.946 Vali Loss: 24.707 Vali Acc: 0.380 Test Loss: 24.707 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.5649611949920654
Epoch: 6, Steps: 13 | Train Loss: 9.693 Vali Loss: 35.145 Vali Acc: 0.300 Test Loss: 35.145 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.8293800354003906
Epoch: 7, Steps: 13 | Train Loss: 14.960 Vali Loss: 26.966 Vali Acc: 0.320 Test Loss: 26.966 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.989339828491211
Epoch: 8, Steps: 13 | Train Loss: 9.644 Vali Loss: 23.858 Vali Acc: 0.400 Test Loss: 23.858 Test Acc: 0.400
Validation loss decreased (-0.379884 --> -0.399761).  Saving model ...
Epoch: 9 cost time: 3.560336112976074
Epoch: 9, Steps: 13 | Train Loss: 7.823 Vali Loss: 17.989 Vali Acc: 0.520 Test Loss: 17.989 Test Acc: 0.520
Validation loss decreased (-0.399761 --> -0.519820).  Saving model ...
Epoch: 10 cost time: 3.7646422386169434
Epoch: 10, Steps: 13 | Train Loss: 6.839 Vali Loss: 26.630 Vali Acc: 0.380 Test Loss: 26.630 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.9982078075408936
Epoch: 11, Steps: 13 | Train Loss: 3.137 Vali Loss: 22.821 Vali Acc: 0.420 Test Loss: 22.821 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.878126621246338
Epoch: 12, Steps: 13 | Train Loss: 11.546 Vali Loss: 20.607 Vali Acc: 0.440 Test Loss: 20.607 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.841235876083374
Epoch: 13, Steps: 13 | Train Loss: 3.241 Vali Loss: 15.143 Vali Acc: 0.480 Test Loss: 15.143 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.691847801208496
Epoch: 14, Steps: 13 | Train Loss: 2.649 Vali Loss: 23.124 Vali Acc: 0.540 Test Loss: 23.124 Test Acc: 0.540
Validation loss decreased (-0.519820 --> -0.539769).  Saving model ...
Epoch: 15 cost time: 3.577150583267212
Epoch: 15, Steps: 13 | Train Loss: 4.918 Vali Loss: 22.911 Vali Acc: 0.520 Test Loss: 22.911 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.655910015106201
Epoch: 16, Steps: 13 | Train Loss: 1.310 Vali Loss: 18.904 Vali Acc: 0.520 Test Loss: 18.904 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.7257332801818848
Epoch: 17, Steps: 13 | Train Loss: 3.325 Vali Loss: 35.235 Vali Acc: 0.460 Test Loss: 35.235 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.7100062370300293
Epoch: 18, Steps: 13 | Train Loss: 5.095 Vali Loss: 22.474 Vali Acc: 0.460 Test Loss: 22.474 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.5872962474823
Epoch: 19, Steps: 13 | Train Loss: 1.087 Vali Loss: 14.593 Vali Acc: 0.580 Test Loss: 14.593 Test Acc: 0.580
Validation loss decreased (-0.539769 --> -0.579854).  Saving model ...
Epoch: 20 cost time: 3.8521432876586914
Epoch: 20, Steps: 13 | Train Loss: 1.214 Vali Loss: 20.524 Vali Acc: 0.560 Test Loss: 20.524 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.9615705013275146
Epoch: 21, Steps: 13 | Train Loss: 0.630 Vali Loss: 32.551 Vali Acc: 0.460 Test Loss: 32.551 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.8174939155578613
Epoch: 22, Steps: 13 | Train Loss: 0.423 Vali Loss: 17.185 Vali Acc: 0.500 Test Loss: 17.185 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.8025379180908203
Epoch: 23, Steps: 13 | Train Loss: 3.740 Vali Loss: 29.208 Vali Acc: 0.460 Test Loss: 29.208 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.913065195083618
Epoch: 24, Steps: 13 | Train Loss: 0.469 Vali Loss: 29.657 Vali Acc: 0.560 Test Loss: 29.657 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.8118269443511963
Epoch: 25, Steps: 13 | Train Loss: 0.000 Vali Loss: 34.089 Vali Acc: 0.540 Test Loss: 34.089 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.8828999996185303
Epoch: 26, Steps: 13 | Train Loss: 0.960 Vali Loss: 27.714 Vali Acc: 0.500 Test Loss: 27.714 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.98142147064209
Epoch: 27, Steps: 13 | Train Loss: 0.000 Vali Loss: 22.694 Vali Acc: 0.560 Test Loss: 22.694 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.775928020477295
Epoch: 28, Steps: 13 | Train Loss: 0.000 Vali Loss: 23.263 Vali Acc: 0.580 Test Loss: 23.263 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.577641010284424
Epoch: 29, Steps: 13 | Train Loss: 0.000 Vali Loss: 24.036 Vali Acc: 0.580 Test Loss: 24.036 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 5970613
model size : 24.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 6.16379451751709
Epoch: 1, Steps: 13 | Train Loss: 3.703 Vali Loss: 8.421 Vali Acc: 0.200 Test Loss: 8.421 Test Acc: 0.200
Validation loss decreased (inf --> -0.199916).  Saving model ...
Epoch: 2 cost time: 3.923618793487549
Epoch: 2, Steps: 13 | Train Loss: 10.113 Vali Loss: 15.408 Vali Acc: 0.220 Test Loss: 15.408 Test Acc: 0.220
Validation loss decreased (-0.199916 --> -0.219846).  Saving model ...
Epoch: 3 cost time: 3.6766302585601807
Epoch: 3, Steps: 13 | Train Loss: 13.544 Vali Loss: 12.764 Vali Acc: 0.260 Test Loss: 12.764 Test Acc: 0.260
Validation loss decreased (-0.219846 --> -0.259872).  Saving model ...
Epoch: 4 cost time: 3.8591935634613037
Epoch: 4, Steps: 13 | Train Loss: 9.492 Vali Loss: 13.690 Vali Acc: 0.320 Test Loss: 13.690 Test Acc: 0.320
Validation loss decreased (-0.259872 --> -0.319863).  Saving model ...
Epoch: 5 cost time: 3.659658908843994
Epoch: 5, Steps: 13 | Train Loss: 10.171 Vali Loss: 32.730 Vali Acc: 0.300 Test Loss: 32.730 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.6610336303710938
Epoch: 6, Steps: 13 | Train Loss: 22.464 Vali Loss: 51.460 Vali Acc: 0.280 Test Loss: 51.460 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.837495803833008
Epoch: 7, Steps: 13 | Train Loss: 15.931 Vali Loss: 27.859 Vali Acc: 0.400 Test Loss: 27.859 Test Acc: 0.400
Validation loss decreased (-0.319863 --> -0.399721).  Saving model ...
Epoch: 8 cost time: 3.639746904373169
Epoch: 8, Steps: 13 | Train Loss: 11.143 Vali Loss: 23.670 Vali Acc: 0.400 Test Loss: 23.670 Test Acc: 0.400
Validation loss decreased (-0.399721 --> -0.399763).  Saving model ...
Epoch: 9 cost time: 3.76237416267395
Epoch: 9, Steps: 13 | Train Loss: 7.890 Vali Loss: 35.456 Vali Acc: 0.380 Test Loss: 35.456 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.67250394821167
Epoch: 10, Steps: 13 | Train Loss: 7.760 Vali Loss: 29.196 Vali Acc: 0.420 Test Loss: 29.196 Test Acc: 0.420
Validation loss decreased (-0.399763 --> -0.419708).  Saving model ...
Epoch: 11 cost time: 4.109102010726929
Epoch: 11, Steps: 13 | Train Loss: 11.806 Vali Loss: 45.614 Vali Acc: 0.460 Test Loss: 45.614 Test Acc: 0.460
Validation loss decreased (-0.419708 --> -0.459544).  Saving model ...
Epoch: 12 cost time: 3.615595579147339
Epoch: 12, Steps: 13 | Train Loss: 13.601 Vali Loss: 20.520 Vali Acc: 0.500 Test Loss: 20.520 Test Acc: 0.500
Validation loss decreased (-0.459544 --> -0.499795).  Saving model ...
Epoch: 13 cost time: 3.860205888748169
Epoch: 13, Steps: 13 | Train Loss: 5.874 Vali Loss: 36.843 Vali Acc: 0.440 Test Loss: 36.843 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.7242934703826904
Epoch: 14, Steps: 13 | Train Loss: 5.743 Vali Loss: 34.226 Vali Acc: 0.340 Test Loss: 34.226 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.8544301986694336
Epoch: 15, Steps: 13 | Train Loss: 3.358 Vali Loss: 33.646 Vali Acc: 0.420 Test Loss: 33.646 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.6285791397094727
Epoch: 16, Steps: 13 | Train Loss: 5.423 Vali Loss: 25.498 Vali Acc: 0.540 Test Loss: 25.498 Test Acc: 0.540
Validation loss decreased (-0.499795 --> -0.539745).  Saving model ...
Epoch: 17 cost time: 3.8173019886016846
Epoch: 17, Steps: 13 | Train Loss: 4.140 Vali Loss: 27.678 Vali Acc: 0.440 Test Loss: 27.678 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.8431386947631836
Epoch: 18, Steps: 13 | Train Loss: 0.635 Vali Loss: 33.851 Vali Acc: 0.480 Test Loss: 33.851 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.6785213947296143
Epoch: 19, Steps: 13 | Train Loss: 0.344 Vali Loss: 27.767 Vali Acc: 0.460 Test Loss: 27.767 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.9179141521453857
Epoch: 20, Steps: 13 | Train Loss: 0.132 Vali Loss: 31.072 Vali Acc: 0.520 Test Loss: 31.072 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.9095661640167236
Epoch: 21, Steps: 13 | Train Loss: 3.564 Vali Loss: 31.100 Vali Acc: 0.500 Test Loss: 31.100 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.7570886611938477
Epoch: 22, Steps: 13 | Train Loss: 0.381 Vali Loss: 67.145 Vali Acc: 0.340 Test Loss: 67.145 Test Acc: 0.340
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.755117893218994
Epoch: 23, Steps: 13 | Train Loss: 4.821 Vali Loss: 36.766 Vali Acc: 0.380 Test Loss: 36.766 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.6478471755981445
Epoch: 24, Steps: 13 | Train Loss: 1.773 Vali Loss: 28.099 Vali Acc: 0.460 Test Loss: 28.099 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.7895278930664062
Epoch: 25, Steps: 13 | Train Loss: 1.294 Vali Loss: 38.853 Vali Acc: 0.400 Test Loss: 38.853 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.986206531524658
Epoch: 26, Steps: 13 | Train Loss: 0.042 Vali Loss: 41.953 Vali Acc: 0.540 Test Loss: 41.953 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 5967989
model size : 24.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 6.92613410949707
Epoch: 1, Steps: 13 | Train Loss: 4.311 Vali Loss: 5.258 Vali Acc: 0.200 Test Loss: 5.258 Test Acc: 0.200
Validation loss decreased (inf --> -0.199947).  Saving model ...
Epoch: 2 cost time: 3.721590995788574
Epoch: 2, Steps: 13 | Train Loss: 6.240 Vali Loss: 11.706 Vali Acc: 0.300 Test Loss: 11.706 Test Acc: 0.300
Validation loss decreased (-0.199947 --> -0.299883).  Saving model ...
Epoch: 3 cost time: 4.059309720993042
Epoch: 3, Steps: 13 | Train Loss: 13.952 Vali Loss: 7.181 Vali Acc: 0.360 Test Loss: 7.181 Test Acc: 0.360
Validation loss decreased (-0.299883 --> -0.359928).  Saving model ...
Epoch: 4 cost time: 3.8702585697174072
Epoch: 4, Steps: 13 | Train Loss: 10.611 Vali Loss: 6.162 Vali Acc: 0.420 Test Loss: 6.162 Test Acc: 0.420
Validation loss decreased (-0.359928 --> -0.419938).  Saving model ...
Epoch: 5 cost time: 3.7030508518218994
Epoch: 5, Steps: 13 | Train Loss: 10.504 Vali Loss: 16.579 Vali Acc: 0.360 Test Loss: 16.579 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.9938161373138428
Epoch: 6, Steps: 13 | Train Loss: 18.098 Vali Loss: 45.320 Vali Acc: 0.260 Test Loss: 45.320 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.123345136642456
Epoch: 7, Steps: 13 | Train Loss: 20.158 Vali Loss: 23.952 Vali Acc: 0.360 Test Loss: 23.952 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.7273120880126953
Epoch: 8, Steps: 13 | Train Loss: 14.282 Vali Loss: 21.962 Vali Acc: 0.540 Test Loss: 21.962 Test Acc: 0.540
Validation loss decreased (-0.419938 --> -0.539780).  Saving model ...
Epoch: 9 cost time: 3.836728811264038
Epoch: 9, Steps: 13 | Train Loss: 10.841 Vali Loss: 32.543 Vali Acc: 0.500 Test Loss: 32.543 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.8790323734283447
Epoch: 10, Steps: 13 | Train Loss: 13.054 Vali Loss: 45.683 Vali Acc: 0.440 Test Loss: 45.683 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.769340753555298
Epoch: 11, Steps: 13 | Train Loss: 16.612 Vali Loss: 36.142 Vali Acc: 0.440 Test Loss: 36.142 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.777496337890625
Epoch: 12, Steps: 13 | Train Loss: 8.403 Vali Loss: 25.983 Vali Acc: 0.440 Test Loss: 25.983 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.9717438220977783
Epoch: 13, Steps: 13 | Train Loss: 5.198 Vali Loss: 29.365 Vali Acc: 0.500 Test Loss: 29.365 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.603850841522217
Epoch: 14, Steps: 13 | Train Loss: 3.102 Vali Loss: 29.209 Vali Acc: 0.540 Test Loss: 29.209 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.7249019145965576
Epoch: 15, Steps: 13 | Train Loss: 2.086 Vali Loss: 25.310 Vali Acc: 0.420 Test Loss: 25.310 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.059924364089966
Epoch: 16, Steps: 13 | Train Loss: 0.501 Vali Loss: 30.046 Vali Acc: 0.460 Test Loss: 30.046 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.5830891132354736
Epoch: 17, Steps: 13 | Train Loss: 0.729 Vali Loss: 47.485 Vali Acc: 0.360 Test Loss: 47.485 Test Acc: 0.360
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.689444065093994
Epoch: 18, Steps: 13 | Train Loss: 3.817 Vali Loss: 36.486 Vali Acc: 0.420 Test Loss: 36.486 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 5965365
model size : 24.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.8125059604644775
Epoch: 1, Steps: 13 | Train Loss: 4.132 Vali Loss: 8.242 Vali Acc: 0.240 Test Loss: 8.242 Test Acc: 0.240
Validation loss decreased (inf --> -0.239918).  Saving model ...
Epoch: 2 cost time: 3.3792309761047363
Epoch: 2, Steps: 13 | Train Loss: 9.111 Vali Loss: 4.509 Vali Acc: 0.360 Test Loss: 4.509 Test Acc: 0.360
Validation loss decreased (-0.239918 --> -0.359955).  Saving model ...
Epoch: 3 cost time: 3.6569299697875977
Epoch: 3, Steps: 13 | Train Loss: 8.345 Vali Loss: 13.021 Vali Acc: 0.280 Test Loss: 13.021 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.32063889503479
Epoch: 4, Steps: 13 | Train Loss: 12.328 Vali Loss: 19.895 Vali Acc: 0.380 Test Loss: 19.895 Test Acc: 0.380
Validation loss decreased (-0.359955 --> -0.379801).  Saving model ...
Epoch: 5 cost time: 3.5038950443267822
Epoch: 5, Steps: 13 | Train Loss: 14.200 Vali Loss: 20.769 Vali Acc: 0.340 Test Loss: 20.769 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.5119683742523193
Epoch: 6, Steps: 13 | Train Loss: 12.704 Vali Loss: 46.100 Vali Acc: 0.260 Test Loss: 46.100 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.494741916656494
Epoch: 7, Steps: 13 | Train Loss: 12.889 Vali Loss: 22.274 Vali Acc: 0.360 Test Loss: 22.274 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.7625486850738525
Epoch: 8, Steps: 13 | Train Loss: 8.934 Vali Loss: 28.331 Vali Acc: 0.360 Test Loss: 28.331 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.5980565547943115
Epoch: 9, Steps: 13 | Train Loss: 17.314 Vali Loss: 17.619 Vali Acc: 0.520 Test Loss: 17.619 Test Acc: 0.520
Validation loss decreased (-0.379801 --> -0.519824).  Saving model ...
Epoch: 10 cost time: 3.550126075744629
Epoch: 10, Steps: 13 | Train Loss: 10.649 Vali Loss: 46.858 Vali Acc: 0.300 Test Loss: 46.858 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.808316230773926
Epoch: 11, Steps: 13 | Train Loss: 13.556 Vali Loss: 35.196 Vali Acc: 0.420 Test Loss: 35.196 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.635694980621338
Epoch: 12, Steps: 13 | Train Loss: 7.368 Vali Loss: 37.986 Vali Acc: 0.420 Test Loss: 37.986 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.4382364749908447
Epoch: 13, Steps: 13 | Train Loss: 14.891 Vali Loss: 35.637 Vali Acc: 0.420 Test Loss: 35.637 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.4798853397369385
Epoch: 14, Steps: 13 | Train Loss: 10.820 Vali Loss: 44.433 Vali Acc: 0.460 Test Loss: 44.433 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.3398687839508057
Epoch: 15, Steps: 13 | Train Loss: 3.071 Vali Loss: 30.067 Vali Acc: 0.460 Test Loss: 30.067 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.669433355331421
Epoch: 16, Steps: 13 | Train Loss: 5.132 Vali Loss: 24.507 Vali Acc: 0.460 Test Loss: 24.507 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.614501953125
Epoch: 17, Steps: 13 | Train Loss: 2.695 Vali Loss: 33.775 Vali Acc: 0.460 Test Loss: 33.775 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.574873685836792
Epoch: 18, Steps: 13 | Train Loss: 4.977 Vali Loss: 38.212 Vali Acc: 0.580 Test Loss: 38.212 Test Acc: 0.580
Validation loss decreased (-0.519824 --> -0.579618).  Saving model ...
Epoch: 19 cost time: 3.517760992050171
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 39.172 Vali Acc: 0.460 Test Loss: 39.172 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.449180841445923
Epoch: 20, Steps: 13 | Train Loss: 0.719 Vali Loss: 42.793 Vali Acc: 0.460 Test Loss: 42.793 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.474595069885254
Epoch: 21, Steps: 13 | Train Loss: 1.650 Vali Loss: 36.277 Vali Acc: 0.460 Test Loss: 36.277 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.7746620178222656
Epoch: 22, Steps: 13 | Train Loss: 0.742 Vali Loss: 50.432 Vali Acc: 0.440 Test Loss: 50.432 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.815600633621216
Epoch: 23, Steps: 13 | Train Loss: 1.538 Vali Loss: 42.269 Vali Acc: 0.380 Test Loss: 42.269 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.295964241027832
Epoch: 24, Steps: 13 | Train Loss: 0.093 Vali Loss: 42.149 Vali Acc: 0.460 Test Loss: 42.149 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.5143826007843018
Epoch: 25, Steps: 13 | Train Loss: 1.271 Vali Loss: 38.061 Vali Acc: 0.420 Test Loss: 38.061 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.457205057144165
Epoch: 26, Steps: 13 | Train Loss: 1.089 Vali Loss: 41.124 Vali Acc: 0.480 Test Loss: 41.124 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.7256381511688232
Epoch: 27, Steps: 13 | Train Loss: 0.528 Vali Loss: 41.147 Vali Acc: 0.540 Test Loss: 41.147 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 3.487499952316284
Epoch: 28, Steps: 13 | Train Loss: 3.766 Vali Loss: 46.426 Vali Acc: 0.520 Test Loss: 46.426 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 5510901
model size : 22.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.694357633590698
Epoch: 1, Steps: 13 | Train Loss: 3.570 Vali Loss: 8.517 Vali Acc: 0.220 Test Loss: 8.517 Test Acc: 0.220
Validation loss decreased (inf --> -0.219915).  Saving model ...
Epoch: 2 cost time: 3.4113597869873047
Epoch: 2, Steps: 13 | Train Loss: 9.003 Vali Loss: 13.217 Vali Acc: 0.260 Test Loss: 13.217 Test Acc: 0.260
Validation loss decreased (-0.219915 --> -0.259868).  Saving model ...
Epoch: 3 cost time: 3.4966719150543213
Epoch: 3, Steps: 13 | Train Loss: 11.357 Vali Loss: 14.692 Vali Acc: 0.280 Test Loss: 14.692 Test Acc: 0.280
Validation loss decreased (-0.259868 --> -0.279853).  Saving model ...
Epoch: 4 cost time: 3.550553798675537
Epoch: 4, Steps: 13 | Train Loss: 8.547 Vali Loss: 12.231 Vali Acc: 0.300 Test Loss: 12.231 Test Acc: 0.300
Validation loss decreased (-0.279853 --> -0.299878).  Saving model ...
Epoch: 5 cost time: 3.6260907649993896
Epoch: 5, Steps: 13 | Train Loss: 15.292 Vali Loss: 28.374 Vali Acc: 0.360 Test Loss: 28.374 Test Acc: 0.360
Validation loss decreased (-0.299878 --> -0.359716).  Saving model ...
Epoch: 6 cost time: 3.5955615043640137
Epoch: 6, Steps: 13 | Train Loss: 11.546 Vali Loss: 16.105 Vali Acc: 0.340 Test Loss: 16.105 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.571749687194824
Epoch: 7, Steps: 13 | Train Loss: 4.036 Vali Loss: 19.940 Vali Acc: 0.420 Test Loss: 19.940 Test Acc: 0.420
Validation loss decreased (-0.359716 --> -0.419801).  Saving model ...
Epoch: 8 cost time: 3.6133017539978027
Epoch: 8, Steps: 13 | Train Loss: 13.749 Vali Loss: 25.466 Vali Acc: 0.360 Test Loss: 25.466 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.541123628616333
Epoch: 9, Steps: 13 | Train Loss: 17.595 Vali Loss: 36.178 Vali Acc: 0.480 Test Loss: 36.178 Test Acc: 0.480
Validation loss decreased (-0.419801 --> -0.479638).  Saving model ...
Epoch: 10 cost time: 3.6241660118103027
Epoch: 10, Steps: 13 | Train Loss: 12.088 Vali Loss: 45.883 Vali Acc: 0.440 Test Loss: 45.883 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.3622994422912598
Epoch: 11, Steps: 13 | Train Loss: 12.188 Vali Loss: 34.722 Vali Acc: 0.480 Test Loss: 34.722 Test Acc: 0.480
Validation loss decreased (-0.479638 --> -0.479653).  Saving model ...
Epoch: 12 cost time: 3.9066476821899414
Epoch: 12, Steps: 13 | Train Loss: 4.952 Vali Loss: 63.750 Vali Acc: 0.400 Test Loss: 63.750 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.5767860412597656
Epoch: 13, Steps: 13 | Train Loss: 10.301 Vali Loss: 45.740 Vali Acc: 0.460 Test Loss: 45.740 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.8796310424804688
Epoch: 14, Steps: 13 | Train Loss: 6.702 Vali Loss: 51.274 Vali Acc: 0.400 Test Loss: 51.274 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.796739101409912
Epoch: 15, Steps: 13 | Train Loss: 3.758 Vali Loss: 31.509 Vali Acc: 0.520 Test Loss: 31.509 Test Acc: 0.520
Validation loss decreased (-0.479653 --> -0.519685).  Saving model ...
Epoch: 16 cost time: 3.6516571044921875
Epoch: 16, Steps: 13 | Train Loss: 0.884 Vali Loss: 37.292 Vali Acc: 0.480 Test Loss: 37.292 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.6060359477996826
Epoch: 17, Steps: 13 | Train Loss: 1.423 Vali Loss: 49.088 Vali Acc: 0.420 Test Loss: 49.088 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.9739270210266113
Epoch: 18, Steps: 13 | Train Loss: 4.406 Vali Loss: 39.883 Vali Acc: 0.440 Test Loss: 39.883 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.465911865234375
Epoch: 19, Steps: 13 | Train Loss: 1.352 Vali Loss: 28.817 Vali Acc: 0.540 Test Loss: 28.817 Test Acc: 0.540
Validation loss decreased (-0.519685 --> -0.539712).  Saving model ...
Epoch: 20 cost time: 3.583955764770508
Epoch: 20, Steps: 13 | Train Loss: 6.701 Vali Loss: 36.987 Vali Acc: 0.520 Test Loss: 36.987 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.7398245334625244
Epoch: 21, Steps: 13 | Train Loss: 2.228 Vali Loss: 36.065 Vali Acc: 0.460 Test Loss: 36.065 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.668059825897217
Epoch: 22, Steps: 13 | Train Loss: 0.572 Vali Loss: 33.279 Vali Acc: 0.520 Test Loss: 33.279 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.5375924110412598
Epoch: 23, Steps: 13 | Train Loss: 2.541 Vali Loss: 43.500 Vali Acc: 0.540 Test Loss: 43.500 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.3696799278259277
Epoch: 24, Steps: 13 | Train Loss: 3.004 Vali Loss: 42.138 Vali Acc: 0.500 Test Loss: 42.138 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.514101266860962
Epoch: 25, Steps: 13 | Train Loss: 2.769 Vali Loss: 42.066 Vali Acc: 0.460 Test Loss: 42.066 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.660142660140991
Epoch: 26, Steps: 13 | Train Loss: 2.724 Vali Loss: 57.583 Vali Acc: 0.480 Test Loss: 57.583 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.539909839630127
Epoch: 27, Steps: 13 | Train Loss: 0.755 Vali Loss: 43.938 Vali Acc: 0.500 Test Loss: 43.938 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.624856948852539
Epoch: 28, Steps: 13 | Train Loss: 1.720 Vali Loss: 42.800 Vali Acc: 0.580 Test Loss: 42.800 Test Acc: 0.580
Validation loss decreased (-0.539712 --> -0.579572).  Saving model ...
Epoch: 29 cost time: 3.3179776668548584
Epoch: 29, Steps: 13 | Train Loss: 1.069 Vali Loss: 43.632 Vali Acc: 0.440 Test Loss: 43.632 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.395754098892212
Epoch: 30, Steps: 13 | Train Loss: 0.305 Vali Loss: 45.641 Vali Acc: 0.440 Test Loss: 45.641 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.4817185401916504
Epoch: 31, Steps: 13 | Train Loss: 0.902 Vali Loss: 50.252 Vali Acc: 0.420 Test Loss: 50.252 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.7490649223327637
Epoch: 32, Steps: 13 | Train Loss: 0.001 Vali Loss: 57.294 Vali Acc: 0.420 Test Loss: 57.294 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.5836920738220215
Epoch: 33, Steps: 13 | Train Loss: 0.576 Vali Loss: 53.055 Vali Acc: 0.480 Test Loss: 53.055 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 3.4628772735595703
Epoch: 34, Steps: 13 | Train Loss: 0.001 Vali Loss: 59.056 Vali Acc: 0.460 Test Loss: 59.056 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 3.657522201538086
Epoch: 35, Steps: 13 | Train Loss: 0.009 Vali Loss: 44.233 Vali Acc: 0.500 Test Loss: 44.233 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 3.648167848587036
Epoch: 36, Steps: 13 | Train Loss: 0.665 Vali Loss: 50.503 Vali Acc: 0.440 Test Loss: 50.503 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 3.869884729385376
Epoch: 37, Steps: 13 | Train Loss: 0.358 Vali Loss: 51.777 Vali Acc: 0.520 Test Loss: 51.777 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 3.506805181503296
Epoch: 38, Steps: 13 | Train Loss: 1.361 Vali Loss: 48.076 Vali Acc: 0.520 Test Loss: 48.076 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 5508277
model size : 22.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.417547941207886
Epoch: 1, Steps: 13 | Train Loss: 3.639 Vali Loss: 18.971 Vali Acc: 0.200 Test Loss: 18.971 Test Acc: 0.200
Validation loss decreased (inf --> -0.199810).  Saving model ...
Epoch: 2 cost time: 3.8335018157958984
Epoch: 2, Steps: 13 | Train Loss: 12.059 Vali Loss: 10.286 Vali Acc: 0.260 Test Loss: 10.286 Test Acc: 0.260
Validation loss decreased (-0.199810 --> -0.259897).  Saving model ...
Epoch: 3 cost time: 3.741724967956543
Epoch: 3, Steps: 13 | Train Loss: 8.242 Vali Loss: 13.254 Vali Acc: 0.360 Test Loss: 13.254 Test Acc: 0.360
Validation loss decreased (-0.259897 --> -0.359867).  Saving model ...
Epoch: 4 cost time: 3.696481227874756
Epoch: 4, Steps: 13 | Train Loss: 10.384 Vali Loss: 16.506 Vali Acc: 0.280 Test Loss: 16.506 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.546354293823242
Epoch: 5, Steps: 13 | Train Loss: 6.657 Vali Loss: 15.662 Vali Acc: 0.400 Test Loss: 15.662 Test Acc: 0.400
Validation loss decreased (-0.359867 --> -0.399843).  Saving model ...
Epoch: 6 cost time: 3.5419156551361084
Epoch: 6, Steps: 13 | Train Loss: 10.374 Vali Loss: 22.423 Vali Acc: 0.340 Test Loss: 22.423 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.588158130645752
Epoch: 7, Steps: 13 | Train Loss: 7.937 Vali Loss: 34.796 Vali Acc: 0.440 Test Loss: 34.796 Test Acc: 0.440
Validation loss decreased (-0.399843 --> -0.439652).  Saving model ...
Epoch: 8 cost time: 3.5026626586914062
Epoch: 8, Steps: 13 | Train Loss: 20.984 Vali Loss: 34.202 Vali Acc: 0.440 Test Loss: 34.202 Test Acc: 0.440
Validation loss decreased (-0.439652 --> -0.439658).  Saving model ...
Epoch: 9 cost time: 3.526646137237549
Epoch: 9, Steps: 13 | Train Loss: 16.535 Vali Loss: 36.041 Vali Acc: 0.400 Test Loss: 36.041 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.838848352432251
Epoch: 10, Steps: 13 | Train Loss: 7.876 Vali Loss: 22.852 Vali Acc: 0.520 Test Loss: 22.852 Test Acc: 0.520
Validation loss decreased (-0.439658 --> -0.519771).  Saving model ...
Epoch: 11 cost time: 3.6600279808044434
Epoch: 11, Steps: 13 | Train Loss: 7.706 Vali Loss: 24.525 Vali Acc: 0.460 Test Loss: 24.525 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.150533676147461
Epoch: 12, Steps: 13 | Train Loss: 6.441 Vali Loss: 30.136 Vali Acc: 0.540 Test Loss: 30.136 Test Acc: 0.540
Validation loss decreased (-0.519771 --> -0.539699).  Saving model ...
Epoch: 13 cost time: 3.973283290863037
Epoch: 13, Steps: 13 | Train Loss: 3.650 Vali Loss: 25.810 Vali Acc: 0.380 Test Loss: 25.810 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.703701972961426
Epoch: 14, Steps: 13 | Train Loss: 2.388 Vali Loss: 42.467 Vali Acc: 0.400 Test Loss: 42.467 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.7737693786621094
Epoch: 15, Steps: 13 | Train Loss: 2.211 Vali Loss: 25.493 Vali Acc: 0.560 Test Loss: 25.493 Test Acc: 0.560
Validation loss decreased (-0.539699 --> -0.559745).  Saving model ...
Epoch: 16 cost time: 3.614849328994751
Epoch: 16, Steps: 13 | Train Loss: 1.572 Vali Loss: 35.371 Vali Acc: 0.480 Test Loss: 35.371 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.7663958072662354
Epoch: 17, Steps: 13 | Train Loss: 2.894 Vali Loss: 28.391 Vali Acc: 0.520 Test Loss: 28.391 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.7776241302490234
Epoch: 18, Steps: 13 | Train Loss: 3.120 Vali Loss: 63.242 Vali Acc: 0.400 Test Loss: 63.242 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.9235634803771973
Epoch: 19, Steps: 13 | Train Loss: 6.603 Vali Loss: 44.183 Vali Acc: 0.460 Test Loss: 44.183 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.7113354206085205
Epoch: 20, Steps: 13 | Train Loss: 3.544 Vali Loss: 46.902 Vali Acc: 0.480 Test Loss: 46.902 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.4906768798828125
Epoch: 21, Steps: 13 | Train Loss: 0.507 Vali Loss: 55.545 Vali Acc: 0.440 Test Loss: 55.545 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.671128988265991
Epoch: 22, Steps: 13 | Train Loss: 2.463 Vali Loss: 38.097 Vali Acc: 0.500 Test Loss: 38.097 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.9633450508117676
Epoch: 23, Steps: 13 | Train Loss: 2.874 Vali Loss: 35.411 Vali Acc: 0.440 Test Loss: 35.411 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.792346477508545
Epoch: 24, Steps: 13 | Train Loss: 1.290 Vali Loss: 71.127 Vali Acc: 0.320 Test Loss: 71.127 Test Acc: 0.320
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.7214481830596924
Epoch: 25, Steps: 13 | Train Loss: 3.772 Vali Loss: 42.694 Vali Acc: 0.460 Test Loss: 42.694 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 5505653
model size : 22.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 6.521486282348633
Epoch: 1, Steps: 13 | Train Loss: 4.254 Vali Loss: 15.660 Vali Acc: 0.200 Test Loss: 15.660 Test Acc: 0.200
Validation loss decreased (inf --> -0.199843).  Saving model ...
Epoch: 2 cost time: 3.421586275100708
Epoch: 2, Steps: 13 | Train Loss: 11.132 Vali Loss: 22.518 Vali Acc: 0.200 Test Loss: 22.518 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.428264856338501
Epoch: 3, Steps: 13 | Train Loss: 10.872 Vali Loss: 21.231 Vali Acc: 0.220 Test Loss: 21.231 Test Acc: 0.220
Validation loss decreased (-0.199843 --> -0.219788).  Saving model ...
Epoch: 4 cost time: 3.8262217044830322
Epoch: 4, Steps: 13 | Train Loss: 10.066 Vali Loss: 20.445 Vali Acc: 0.240 Test Loss: 20.445 Test Acc: 0.240
Validation loss decreased (-0.219788 --> -0.239796).  Saving model ...
Epoch: 5 cost time: 3.4796955585479736
Epoch: 5, Steps: 13 | Train Loss: 9.688 Vali Loss: 25.718 Vali Acc: 0.260 Test Loss: 25.718 Test Acc: 0.260
Validation loss decreased (-0.239796 --> -0.259743).  Saving model ...
Epoch: 6 cost time: 3.4173974990844727
Epoch: 6, Steps: 13 | Train Loss: 12.452 Vali Loss: 15.973 Vali Acc: 0.420 Test Loss: 15.973 Test Acc: 0.420
Validation loss decreased (-0.259743 --> -0.419840).  Saving model ...
Epoch: 7 cost time: 3.6908962726593018
Epoch: 7, Steps: 13 | Train Loss: 6.521 Vali Loss: 14.346 Vali Acc: 0.480 Test Loss: 14.346 Test Acc: 0.480
Validation loss decreased (-0.419840 --> -0.479857).  Saving model ...
Epoch: 8 cost time: 3.472048759460449
Epoch: 8, Steps: 13 | Train Loss: 4.752 Vali Loss: 22.598 Vali Acc: 0.400 Test Loss: 22.598 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.4151456356048584
Epoch: 9, Steps: 13 | Train Loss: 16.574 Vali Loss: 36.359 Vali Acc: 0.400 Test Loss: 36.359 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.788221597671509
Epoch: 10, Steps: 13 | Train Loss: 30.113 Vali Loss: 46.533 Vali Acc: 0.380 Test Loss: 46.533 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.613123655319214
Epoch: 11, Steps: 13 | Train Loss: 14.764 Vali Loss: 36.942 Vali Acc: 0.480 Test Loss: 36.942 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.5211875438690186
Epoch: 12, Steps: 13 | Train Loss: 12.689 Vali Loss: 62.134 Vali Acc: 0.340 Test Loss: 62.134 Test Acc: 0.340
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.7387824058532715
Epoch: 13, Steps: 13 | Train Loss: 8.791 Vali Loss: 45.304 Vali Acc: 0.380 Test Loss: 45.304 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.458254337310791
Epoch: 14, Steps: 13 | Train Loss: 10.913 Vali Loss: 52.731 Vali Acc: 0.400 Test Loss: 52.731 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.648737668991089
Epoch: 15, Steps: 13 | Train Loss: 3.586 Vali Loss: 29.835 Vali Acc: 0.420 Test Loss: 29.835 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.3945815563201904
Epoch: 16, Steps: 13 | Train Loss: 3.710 Vali Loss: 76.203 Vali Acc: 0.360 Test Loss: 76.203 Test Acc: 0.360
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.5637054443359375
Epoch: 17, Steps: 13 | Train Loss: 5.758 Vali Loss: 39.417 Vali Acc: 0.400 Test Loss: 39.417 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 5503029
model size : 22.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 6.421054840087891
Epoch: 1, Steps: 13 | Train Loss: 4.396 Vali Loss: 20.253 Vali Acc: 0.200 Test Loss: 20.253 Test Acc: 0.200
Validation loss decreased (inf --> -0.199797).  Saving model ...
Epoch: 2 cost time: 3.4453182220458984
Epoch: 2, Steps: 13 | Train Loss: 12.746 Vali Loss: 13.784 Vali Acc: 0.200 Test Loss: 13.784 Test Acc: 0.200
Validation loss decreased (-0.199797 --> -0.199862).  Saving model ...
Epoch: 3 cost time: 3.611673593521118
Epoch: 3, Steps: 13 | Train Loss: 7.859 Vali Loss: 16.082 Vali Acc: 0.220 Test Loss: 16.082 Test Acc: 0.220
Validation loss decreased (-0.199862 --> -0.219839).  Saving model ...
Epoch: 4 cost time: 3.3182716369628906
Epoch: 4, Steps: 13 | Train Loss: 10.660 Vali Loss: 9.438 Vali Acc: 0.420 Test Loss: 9.438 Test Acc: 0.420
Validation loss decreased (-0.219839 --> -0.419906).  Saving model ...
Epoch: 5 cost time: 3.322972536087036
Epoch: 5, Steps: 13 | Train Loss: 12.722 Vali Loss: 24.378 Vali Acc: 0.300 Test Loss: 24.378 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.2301836013793945
Epoch: 6, Steps: 13 | Train Loss: 18.805 Vali Loss: 19.326 Vali Acc: 0.480 Test Loss: 19.326 Test Acc: 0.480
Validation loss decreased (-0.419906 --> -0.479807).  Saving model ...
Epoch: 7 cost time: 3.318209648132324
Epoch: 7, Steps: 13 | Train Loss: 12.504 Vali Loss: 23.257 Vali Acc: 0.480 Test Loss: 23.257 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.523754835128784
Epoch: 8, Steps: 13 | Train Loss: 9.295 Vali Loss: 17.558 Vali Acc: 0.480 Test Loss: 17.558 Test Acc: 0.480
Validation loss decreased (-0.479807 --> -0.479824).  Saving model ...
Epoch: 9 cost time: 3.261134386062622
Epoch: 9, Steps: 13 | Train Loss: 4.795 Vali Loss: 25.048 Vali Acc: 0.400 Test Loss: 25.048 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.553872585296631
Epoch: 10, Steps: 13 | Train Loss: 11.058 Vali Loss: 21.469 Vali Acc: 0.460 Test Loss: 21.469 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.743978500366211
Epoch: 11, Steps: 13 | Train Loss: 24.164 Vali Loss: 58.372 Vali Acc: 0.360 Test Loss: 58.372 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.3933677673339844
Epoch: 12, Steps: 13 | Train Loss: 18.490 Vali Loss: 54.601 Vali Acc: 0.360 Test Loss: 54.601 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.2031033039093018
Epoch: 13, Steps: 13 | Train Loss: 18.572 Vali Loss: 31.209 Vali Acc: 0.440 Test Loss: 31.209 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.414703130722046
Epoch: 14, Steps: 13 | Train Loss: 8.435 Vali Loss: 33.576 Vali Acc: 0.500 Test Loss: 33.576 Test Acc: 0.500
Validation loss decreased (-0.479824 --> -0.499664).  Saving model ...
Epoch: 15 cost time: 3.357534646987915
Epoch: 15, Steps: 13 | Train Loss: 7.781 Vali Loss: 27.006 Vali Acc: 0.540 Test Loss: 27.006 Test Acc: 0.540
Validation loss decreased (-0.499664 --> -0.539730).  Saving model ...
Epoch: 16 cost time: 3.527589797973633
Epoch: 16, Steps: 13 | Train Loss: 0.669 Vali Loss: 28.864 Vali Acc: 0.500 Test Loss: 28.864 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.4231464862823486
Epoch: 17, Steps: 13 | Train Loss: 1.767 Vali Loss: 48.168 Vali Acc: 0.360 Test Loss: 48.168 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.190586566925049
Epoch: 18, Steps: 13 | Train Loss: 7.468 Vali Loss: 32.633 Vali Acc: 0.480 Test Loss: 32.633 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.329446315765381
Epoch: 19, Steps: 13 | Train Loss: 2.105 Vali Loss: 38.639 Vali Acc: 0.520 Test Loss: 38.639 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.1862621307373047
Epoch: 20, Steps: 13 | Train Loss: 4.638 Vali Loss: 32.181 Vali Acc: 0.420 Test Loss: 32.181 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.26813006401062
Epoch: 21, Steps: 13 | Train Loss: 1.114 Vali Loss: 35.803 Vali Acc: 0.400 Test Loss: 35.803 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.4039957523345947
Epoch: 22, Steps: 13 | Train Loss: 1.669 Vali Loss: 33.420 Vali Acc: 0.480 Test Loss: 33.420 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.2195160388946533
Epoch: 23, Steps: 13 | Train Loss: 0.106 Vali Loss: 31.298 Vali Acc: 0.500 Test Loss: 31.298 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.2883403301239014
Epoch: 24, Steps: 13 | Train Loss: 0.237 Vali Loss: 32.127 Vali Acc: 0.560 Test Loss: 32.127 Test Acc: 0.560
Validation loss decreased (-0.539730 --> -0.559679).  Saving model ...
Epoch: 25 cost time: 3.3808624744415283
Epoch: 25, Steps: 13 | Train Loss: 0.223 Vali Loss: 39.161 Vali Acc: 0.560 Test Loss: 39.161 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.2297592163085938
Epoch: 26, Steps: 13 | Train Loss: 1.039 Vali Loss: 36.062 Vali Acc: 0.480 Test Loss: 36.062 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.2714273929595947
Epoch: 27, Steps: 13 | Train Loss: 0.011 Vali Loss: 36.980 Vali Acc: 0.500 Test Loss: 36.980 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.3590691089630127
Epoch: 28, Steps: 13 | Train Loss: 1.000 Vali Loss: 37.046 Vali Acc: 0.480 Test Loss: 37.046 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.5102806091308594
Epoch: 29, Steps: 13 | Train Loss: 0.044 Vali Loss: 31.074 Vali Acc: 0.540 Test Loss: 31.074 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.3694100379943848
Epoch: 30, Steps: 13 | Train Loss: 0.698 Vali Loss: 38.565 Vali Acc: 0.560 Test Loss: 38.565 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 3.475254774093628
Epoch: 31, Steps: 13 | Train Loss: 0.352 Vali Loss: 35.346 Vali Acc: 0.540 Test Loss: 35.346 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 3.311156749725342
Epoch: 32, Steps: 13 | Train Loss: 2.308 Vali Loss: 31.904 Vali Acc: 0.560 Test Loss: 31.904 Test Acc: 0.560
Validation loss decreased (-0.559679 --> -0.559681).  Saving model ...
Epoch: 33 cost time: 3.306884288787842
Epoch: 33, Steps: 13 | Train Loss: 0.000 Vali Loss: 42.910 Vali Acc: 0.460 Test Loss: 42.910 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.3923919200897217
Epoch: 34, Steps: 13 | Train Loss: 0.021 Vali Loss: 42.308 Vali Acc: 0.540 Test Loss: 42.308 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.416311740875244
Epoch: 35, Steps: 13 | Train Loss: 1.563 Vali Loss: 38.203 Vali Acc: 0.560 Test Loss: 38.203 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 3.616838216781616
Epoch: 36, Steps: 13 | Train Loss: 1.545 Vali Loss: 40.907 Vali Acc: 0.500 Test Loss: 40.907 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 3.335461139678955
Epoch: 37, Steps: 13 | Train Loss: 0.016 Vali Loss: 46.439 Vali Acc: 0.440 Test Loss: 46.439 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 3.330449342727661
Epoch: 38, Steps: 13 | Train Loss: 0.106 Vali Loss: 57.624 Vali Acc: 0.460 Test Loss: 57.624 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 3.5702545642852783
Epoch: 39, Steps: 13 | Train Loss: 1.461 Vali Loss: 84.071 Vali Acc: 0.500 Test Loss: 84.071 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 3.178612470626831
Epoch: 40, Steps: 13 | Train Loss: 19.737 Vali Loss: 44.390 Vali Acc: 0.480 Test Loss: 44.390 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 3.386644124984741
Epoch: 41, Steps: 13 | Train Loss: 14.890 Vali Loss: 32.936 Vali Acc: 0.560 Test Loss: 32.936 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 3.3949854373931885
Epoch: 42, Steps: 13 | Train Loss: 0.000 Vali Loss: 35.295 Vali Acc: 0.520 Test Loss: 35.295 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 5279733
model size : 21.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.703628301620483
Epoch: 1, Steps: 13 | Train Loss: 4.120 Vali Loss: 3.476 Vali Acc: 0.200 Test Loss: 3.476 Test Acc: 0.200
Validation loss decreased (inf --> -0.199965).  Saving model ...
Epoch: 2 cost time: 3.653336763381958
Epoch: 2, Steps: 13 | Train Loss: 8.405 Vali Loss: 11.030 Vali Acc: 0.200 Test Loss: 11.030 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.6104791164398193
Epoch: 3, Steps: 13 | Train Loss: 6.481 Vali Loss: 10.275 Vali Acc: 0.240 Test Loss: 10.275 Test Acc: 0.240
Validation loss decreased (-0.199965 --> -0.239897).  Saving model ...
Epoch: 4 cost time: 3.870790958404541
Epoch: 4, Steps: 13 | Train Loss: 5.469 Vali Loss: 14.074 Vali Acc: 0.400 Test Loss: 14.074 Test Acc: 0.400
Validation loss decreased (-0.239897 --> -0.399859).  Saving model ...
Epoch: 5 cost time: 3.5574445724487305
Epoch: 5, Steps: 13 | Train Loss: 8.589 Vali Loss: 12.421 Vali Acc: 0.380 Test Loss: 12.421 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.357956886291504
Epoch: 6, Steps: 13 | Train Loss: 11.495 Vali Loss: 17.546 Vali Acc: 0.300 Test Loss: 17.546 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.384425163269043
Epoch: 7, Steps: 13 | Train Loss: 11.654 Vali Loss: 24.395 Vali Acc: 0.440 Test Loss: 24.395 Test Acc: 0.440
Validation loss decreased (-0.399859 --> -0.439756).  Saving model ...
Epoch: 8 cost time: 3.4937541484832764
Epoch: 8, Steps: 13 | Train Loss: 18.188 Vali Loss: 18.057 Vali Acc: 0.440 Test Loss: 18.057 Test Acc: 0.440
Validation loss decreased (-0.439756 --> -0.439819).  Saving model ...
Epoch: 9 cost time: 3.3978652954101562
Epoch: 9, Steps: 13 | Train Loss: 10.075 Vali Loss: 31.060 Vali Acc: 0.340 Test Loss: 31.060 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.520712375640869
Epoch: 10, Steps: 13 | Train Loss: 8.287 Vali Loss: 17.936 Vali Acc: 0.460 Test Loss: 17.936 Test Acc: 0.460
Validation loss decreased (-0.439819 --> -0.459821).  Saving model ...
Epoch: 11 cost time: 3.377140522003174
Epoch: 11, Steps: 13 | Train Loss: 10.914 Vali Loss: 25.801 Vali Acc: 0.500 Test Loss: 25.801 Test Acc: 0.500
Validation loss decreased (-0.459821 --> -0.499742).  Saving model ...
Epoch: 12 cost time: 3.494384288787842
Epoch: 12, Steps: 13 | Train Loss: 3.115 Vali Loss: 22.051 Vali Acc: 0.500 Test Loss: 22.051 Test Acc: 0.500
Validation loss decreased (-0.499742 --> -0.499779).  Saving model ...
Epoch: 13 cost time: 3.390312433242798
Epoch: 13, Steps: 13 | Train Loss: 4.329 Vali Loss: 32.517 Vali Acc: 0.520 Test Loss: 32.517 Test Acc: 0.520
Validation loss decreased (-0.499779 --> -0.519675).  Saving model ...
Epoch: 14 cost time: 3.4805703163146973
Epoch: 14, Steps: 13 | Train Loss: 1.576 Vali Loss: 40.666 Vali Acc: 0.420 Test Loss: 40.666 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.3712406158447266
Epoch: 15, Steps: 13 | Train Loss: 6.697 Vali Loss: 30.005 Vali Acc: 0.540 Test Loss: 30.005 Test Acc: 0.540
Validation loss decreased (-0.519675 --> -0.539700).  Saving model ...
Epoch: 16 cost time: 3.5272738933563232
Epoch: 16, Steps: 13 | Train Loss: 2.831 Vali Loss: 17.422 Vali Acc: 0.440 Test Loss: 17.422 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.351762056350708
Epoch: 17, Steps: 13 | Train Loss: 2.928 Vali Loss: 26.973 Vali Acc: 0.460 Test Loss: 26.973 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.896773099899292
Epoch: 18, Steps: 13 | Train Loss: 7.170 Vali Loss: 31.562 Vali Acc: 0.540 Test Loss: 31.562 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.3716533184051514
Epoch: 19, Steps: 13 | Train Loss: 11.415 Vali Loss: 35.467 Vali Acc: 0.480 Test Loss: 35.467 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.413473129272461
Epoch: 20, Steps: 13 | Train Loss: 1.938 Vali Loss: 38.042 Vali Acc: 0.560 Test Loss: 38.042 Test Acc: 0.560
Validation loss decreased (-0.539700 --> -0.559620).  Saving model ...
Epoch: 21 cost time: 3.164264440536499
Epoch: 21, Steps: 13 | Train Loss: 2.546 Vali Loss: 34.112 Vali Acc: 0.560 Test Loss: 34.112 Test Acc: 0.560
Validation loss decreased (-0.559620 --> -0.559659).  Saving model ...
Epoch: 22 cost time: 3.3204731941223145
Epoch: 22, Steps: 13 | Train Loss: 5.252 Vali Loss: 38.174 Vali Acc: 0.540 Test Loss: 38.174 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.4342918395996094
Epoch: 23, Steps: 13 | Train Loss: 0.158 Vali Loss: 32.577 Vali Acc: 0.540 Test Loss: 32.577 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.3504228591918945
Epoch: 24, Steps: 13 | Train Loss: 2.655 Vali Loss: 40.478 Vali Acc: 0.540 Test Loss: 40.478 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 4.015926837921143
Epoch: 25, Steps: 13 | Train Loss: 1.330 Vali Loss: 40.851 Vali Acc: 0.400 Test Loss: 40.851 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.633936643600464
Epoch: 26, Steps: 13 | Train Loss: 2.973 Vali Loss: 51.703 Vali Acc: 0.580 Test Loss: 51.703 Test Acc: 0.580
Validation loss decreased (-0.559659 --> -0.579483).  Saving model ...
Epoch: 27 cost time: 3.4283204078674316
Epoch: 27, Steps: 13 | Train Loss: 6.732 Vali Loss: 53.884 Vali Acc: 0.400 Test Loss: 53.884 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.842449188232422
Epoch: 28, Steps: 13 | Train Loss: 1.125 Vali Loss: 42.122 Vali Acc: 0.420 Test Loss: 42.122 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.738762617111206
Epoch: 29, Steps: 13 | Train Loss: 0.751 Vali Loss: 30.277 Vali Acc: 0.520 Test Loss: 30.277 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.502142906188965
Epoch: 30, Steps: 13 | Train Loss: 0.635 Vali Loss: 35.797 Vali Acc: 0.540 Test Loss: 35.797 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.38362979888916
Epoch: 31, Steps: 13 | Train Loss: 1.104 Vali Loss: 39.786 Vali Acc: 0.440 Test Loss: 39.786 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 3.7599058151245117
Epoch: 32, Steps: 13 | Train Loss: 0.002 Vali Loss: 36.005 Vali Acc: 0.440 Test Loss: 36.005 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 3.555046796798706
Epoch: 33, Steps: 13 | Train Loss: 0.000 Vali Loss: 48.914 Vali Acc: 0.420 Test Loss: 48.914 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 3.571650505065918
Epoch: 34, Steps: 13 | Train Loss: 0.536 Vali Loss: 31.560 Vali Acc: 0.500 Test Loss: 31.560 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 3.757916212081909
Epoch: 35, Steps: 13 | Train Loss: 0.000 Vali Loss: 35.047 Vali Acc: 0.480 Test Loss: 35.047 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 3.5887229442596436
Epoch: 36, Steps: 13 | Train Loss: 0.289 Vali Loss: 34.244 Vali Acc: 0.500 Test Loss: 34.244 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 5277109
model size : 21.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.704911947250366
Epoch: 1, Steps: 13 | Train Loss: 3.192 Vali Loss: 7.450 Vali Acc: 0.240 Test Loss: 7.450 Test Acc: 0.240
Validation loss decreased (inf --> -0.239925).  Saving model ...
Epoch: 2 cost time: 3.558293581008911
Epoch: 2, Steps: 13 | Train Loss: 5.420 Vali Loss: 5.510 Vali Acc: 0.320 Test Loss: 5.510 Test Acc: 0.320
Validation loss decreased (-0.239925 --> -0.319945).  Saving model ...
Epoch: 3 cost time: 3.5548036098480225
Epoch: 3, Steps: 13 | Train Loss: 4.121 Vali Loss: 9.964 Vali Acc: 0.320 Test Loss: 9.964 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.6034984588623047
Epoch: 4, Steps: 13 | Train Loss: 5.341 Vali Loss: 6.367 Vali Acc: 0.460 Test Loss: 6.367 Test Acc: 0.460
Validation loss decreased (-0.319945 --> -0.459936).  Saving model ...
Epoch: 5 cost time: 3.9600744247436523
Epoch: 5, Steps: 13 | Train Loss: 9.137 Vali Loss: 9.611 Vali Acc: 0.360 Test Loss: 9.611 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.5041441917419434
Epoch: 6, Steps: 13 | Train Loss: 13.236 Vali Loss: 17.128 Vali Acc: 0.320 Test Loss: 17.128 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.5190062522888184
Epoch: 7, Steps: 13 | Train Loss: 4.957 Vali Loss: 17.857 Vali Acc: 0.480 Test Loss: 17.857 Test Acc: 0.480
Validation loss decreased (-0.459936 --> -0.479821).  Saving model ...
Epoch: 8 cost time: 3.6890363693237305
Epoch: 8, Steps: 13 | Train Loss: 2.836 Vali Loss: 12.079 Vali Acc: 0.420 Test Loss: 12.079 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.057575941085815
Epoch: 9, Steps: 13 | Train Loss: 4.822 Vali Loss: 18.813 Vali Acc: 0.440 Test Loss: 18.813 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.171249866485596
Epoch: 10, Steps: 13 | Train Loss: 7.638 Vali Loss: 16.687 Vali Acc: 0.520 Test Loss: 16.687 Test Acc: 0.520
Validation loss decreased (-0.479821 --> -0.519833).  Saving model ...
Epoch: 11 cost time: 3.678776979446411
Epoch: 11, Steps: 13 | Train Loss: 18.211 Vali Loss: 20.748 Vali Acc: 0.480 Test Loss: 20.748 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.6899290084838867
Epoch: 12, Steps: 13 | Train Loss: 16.429 Vali Loss: 25.345 Vali Acc: 0.500 Test Loss: 25.345 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.6728291511535645
Epoch: 13, Steps: 13 | Train Loss: 8.603 Vali Loss: 26.444 Vali Acc: 0.460 Test Loss: 26.444 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.774456024169922
Epoch: 14, Steps: 13 | Train Loss: 6.943 Vali Loss: 51.582 Vali Acc: 0.500 Test Loss: 51.582 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.963751792907715
Epoch: 15, Steps: 13 | Train Loss: 9.355 Vali Loss: 50.641 Vali Acc: 0.440 Test Loss: 50.641 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.6377763748168945
Epoch: 16, Steps: 13 | Train Loss: 12.503 Vali Loss: 39.808 Vali Acc: 0.500 Test Loss: 39.808 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.4784672260284424
Epoch: 17, Steps: 13 | Train Loss: 2.431 Vali Loss: 39.067 Vali Acc: 0.480 Test Loss: 39.067 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.858454704284668
Epoch: 18, Steps: 13 | Train Loss: 4.730 Vali Loss: 43.417 Vali Acc: 0.480 Test Loss: 43.417 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.8174822330474854
Epoch: 19, Steps: 13 | Train Loss: 1.348 Vali Loss: 67.125 Vali Acc: 0.400 Test Loss: 67.125 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.468829870223999
Epoch: 20, Steps: 13 | Train Loss: 11.284 Vali Loss: 69.626 Vali Acc: 0.340 Test Loss: 69.626 Test Acc: 0.340
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 5274485
model size : 21.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.685905933380127
Epoch: 1, Steps: 13 | Train Loss: 3.349 Vali Loss: 4.199 Vali Acc: 0.240 Test Loss: 4.199 Test Acc: 0.240
Validation loss decreased (inf --> -0.239958).  Saving model ...
Epoch: 2 cost time: 3.327056407928467
Epoch: 2, Steps: 13 | Train Loss: 11.072 Vali Loss: 13.082 Vali Acc: 0.280 Test Loss: 13.082 Test Acc: 0.280
Validation loss decreased (-0.239958 --> -0.279869).  Saving model ...
Epoch: 3 cost time: 3.382930040359497
Epoch: 3, Steps: 13 | Train Loss: 7.455 Vali Loss: 6.005 Vali Acc: 0.440 Test Loss: 6.005 Test Acc: 0.440
Validation loss decreased (-0.279869 --> -0.439940).  Saving model ...
Epoch: 4 cost time: 3.5638060569763184
Epoch: 4, Steps: 13 | Train Loss: 7.193 Vali Loss: 10.368 Vali Acc: 0.340 Test Loss: 10.368 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.211346387863159
Epoch: 5, Steps: 13 | Train Loss: 9.677 Vali Loss: 21.415 Vali Acc: 0.260 Test Loss: 21.415 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.295550584793091
Epoch: 6, Steps: 13 | Train Loss: 6.582 Vali Loss: 12.855 Vali Acc: 0.460 Test Loss: 12.855 Test Acc: 0.460
Validation loss decreased (-0.439940 --> -0.459871).  Saving model ...
Epoch: 7 cost time: 3.1152865886688232
Epoch: 7, Steps: 13 | Train Loss: 8.045 Vali Loss: 22.978 Vali Acc: 0.320 Test Loss: 22.978 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.3331661224365234
Epoch: 8, Steps: 13 | Train Loss: 8.961 Vali Loss: 20.107 Vali Acc: 0.360 Test Loss: 20.107 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.4087963104248047
Epoch: 9, Steps: 13 | Train Loss: 9.311 Vali Loss: 15.516 Vali Acc: 0.460 Test Loss: 15.516 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.6397409439086914
Epoch: 10, Steps: 13 | Train Loss: 0.765 Vali Loss: 22.160 Vali Acc: 0.560 Test Loss: 22.160 Test Acc: 0.560
Validation loss decreased (-0.459871 --> -0.559778).  Saving model ...
Epoch: 11 cost time: 3.3858044147491455
Epoch: 11, Steps: 13 | Train Loss: 7.353 Vali Loss: 31.867 Vali Acc: 0.360 Test Loss: 31.867 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.2942147254943848
Epoch: 12, Steps: 13 | Train Loss: 6.823 Vali Loss: 23.841 Vali Acc: 0.460 Test Loss: 23.841 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.3066134452819824
Epoch: 13, Steps: 13 | Train Loss: 6.573 Vali Loss: 25.739 Vali Acc: 0.400 Test Loss: 25.739 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.548508882522583
Epoch: 14, Steps: 13 | Train Loss: 4.904 Vali Loss: 27.109 Vali Acc: 0.420 Test Loss: 27.109 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.535823106765747
Epoch: 15, Steps: 13 | Train Loss: 15.465 Vali Loss: 82.608 Vali Acc: 0.380 Test Loss: 82.608 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.5011699199676514
Epoch: 16, Steps: 13 | Train Loss: 26.101 Vali Loss: 53.370 Vali Acc: 0.460 Test Loss: 53.370 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.4900412559509277
Epoch: 17, Steps: 13 | Train Loss: 14.574 Vali Loss: 65.685 Vali Acc: 0.460 Test Loss: 65.685 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.235727548599243
Epoch: 18, Steps: 13 | Train Loss: 9.102 Vali Loss: 34.309 Vali Acc: 0.520 Test Loss: 34.309 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.4836928844451904
Epoch: 19, Steps: 13 | Train Loss: 10.805 Vali Loss: 72.851 Vali Acc: 0.440 Test Loss: 72.851 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.2510933876037598
Epoch: 20, Steps: 13 | Train Loss: 7.850 Vali Loss: 39.849 Vali Acc: 0.440 Test Loss: 39.849 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 5271861
model size : 21.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.385518312454224
Epoch: 1, Steps: 13 | Train Loss: 3.545 Vali Loss: 9.568 Vali Acc: 0.200 Test Loss: 9.568 Test Acc: 0.200
Validation loss decreased (inf --> -0.199904).  Saving model ...
Epoch: 2 cost time: 3.3658838272094727
Epoch: 2, Steps: 13 | Train Loss: 4.009 Vali Loss: 4.472 Vali Acc: 0.320 Test Loss: 4.472 Test Acc: 0.320
Validation loss decreased (-0.199904 --> -0.319955).  Saving model ...
Epoch: 3 cost time: 3.543971538543701
Epoch: 3, Steps: 13 | Train Loss: 4.894 Vali Loss: 8.360 Vali Acc: 0.240 Test Loss: 8.360 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.1106133460998535
Epoch: 4, Steps: 13 | Train Loss: 4.097 Vali Loss: 11.987 Vali Acc: 0.380 Test Loss: 11.987 Test Acc: 0.380
Validation loss decreased (-0.319955 --> -0.379880).  Saving model ...
Epoch: 5 cost time: 3.0889527797698975
Epoch: 5, Steps: 13 | Train Loss: 11.254 Vali Loss: 24.211 Vali Acc: 0.400 Test Loss: 24.211 Test Acc: 0.400
Validation loss decreased (-0.379880 --> -0.399758).  Saving model ...
Epoch: 6 cost time: 3.1964235305786133
Epoch: 6, Steps: 13 | Train Loss: 17.358 Vali Loss: 30.957 Vali Acc: 0.300 Test Loss: 30.957 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.27980899810791
Epoch: 7, Steps: 13 | Train Loss: 16.268 Vali Loss: 14.671 Vali Acc: 0.500 Test Loss: 14.671 Test Acc: 0.500
Validation loss decreased (-0.399758 --> -0.499853).  Saving model ...
Epoch: 8 cost time: 3.0984673500061035
Epoch: 8, Steps: 13 | Train Loss: 10.244 Vali Loss: 25.278 Vali Acc: 0.280 Test Loss: 25.278 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.2105119228363037
Epoch: 9, Steps: 13 | Train Loss: 9.719 Vali Loss: 29.732 Vali Acc: 0.300 Test Loss: 29.732 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.1388392448425293
Epoch: 10, Steps: 13 | Train Loss: 9.341 Vali Loss: 31.377 Vali Acc: 0.480 Test Loss: 31.377 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.379986524581909
Epoch: 11, Steps: 13 | Train Loss: 10.466 Vali Loss: 47.048 Vali Acc: 0.420 Test Loss: 47.048 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.3479995727539062
Epoch: 12, Steps: 13 | Train Loss: 11.192 Vali Loss: 31.459 Vali Acc: 0.560 Test Loss: 31.459 Test Acc: 0.560
Validation loss decreased (-0.499853 --> -0.559685).  Saving model ...
Epoch: 13 cost time: 3.1410815715789795
Epoch: 13, Steps: 13 | Train Loss: 8.320 Vali Loss: 33.545 Vali Acc: 0.420 Test Loss: 33.545 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.22249698638916
Epoch: 14, Steps: 13 | Train Loss: 7.841 Vali Loss: 40.750 Vali Acc: 0.460 Test Loss: 40.750 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.336765766143799
Epoch: 15, Steps: 13 | Train Loss: 3.845 Vali Loss: 32.977 Vali Acc: 0.460 Test Loss: 32.977 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.3077595233917236
Epoch: 16, Steps: 13 | Train Loss: 10.349 Vali Loss: 46.067 Vali Acc: 0.540 Test Loss: 46.067 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.3069193363189697
Epoch: 17, Steps: 13 | Train Loss: 10.751 Vali Loss: 42.146 Vali Acc: 0.480 Test Loss: 42.146 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.1487293243408203
Epoch: 18, Steps: 13 | Train Loss: 3.862 Vali Loss: 34.869 Vali Acc: 0.460 Test Loss: 34.869 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.499283790588379
Epoch: 19, Steps: 13 | Train Loss: 1.637 Vali Loss: 37.064 Vali Acc: 0.460 Test Loss: 37.064 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.276972532272339
Epoch: 20, Steps: 13 | Train Loss: 1.185 Vali Loss: 37.750 Vali Acc: 0.500 Test Loss: 37.750 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.5267629623413086
Epoch: 21, Steps: 13 | Train Loss: 8.706 Vali Loss: 34.171 Vali Acc: 0.520 Test Loss: 34.171 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.4342234134674072
Epoch: 22, Steps: 13 | Train Loss: 2.905 Vali Loss: 56.229 Vali Acc: 0.520 Test Loss: 56.229 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 5164149
model size : 21.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.300854682922363
Epoch: 1, Steps: 13 | Train Loss: 2.963 Vali Loss: 7.381 Vali Acc: 0.320 Test Loss: 7.381 Test Acc: 0.320
Validation loss decreased (inf --> -0.319926).  Saving model ...
Epoch: 2 cost time: 3.5425472259521484
Epoch: 2, Steps: 13 | Train Loss: 7.962 Vali Loss: 21.973 Vali Acc: 0.180 Test Loss: 21.973 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.407256841659546
Epoch: 3, Steps: 13 | Train Loss: 12.145 Vali Loss: 15.125 Vali Acc: 0.360 Test Loss: 15.125 Test Acc: 0.360
Validation loss decreased (-0.319926 --> -0.359849).  Saving model ...
Epoch: 4 cost time: 3.2537357807159424
Epoch: 4, Steps: 13 | Train Loss: 15.958 Vali Loss: 38.584 Vali Acc: 0.220 Test Loss: 38.584 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.4913041591644287
Epoch: 5, Steps: 13 | Train Loss: 18.050 Vali Loss: 15.490 Vali Acc: 0.260 Test Loss: 15.490 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.624929904937744
Epoch: 6, Steps: 13 | Train Loss: 12.755 Vali Loss: 30.146 Vali Acc: 0.260 Test Loss: 30.146 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.4308512210845947
Epoch: 7, Steps: 13 | Train Loss: 21.294 Vali Loss: 35.262 Vali Acc: 0.360 Test Loss: 35.262 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.6024649143218994
Epoch: 8, Steps: 13 | Train Loss: 17.727 Vali Loss: 32.846 Vali Acc: 0.380 Test Loss: 32.846 Test Acc: 0.380
Validation loss decreased (-0.359849 --> -0.379672).  Saving model ...
Epoch: 9 cost time: 3.3664910793304443
Epoch: 9, Steps: 13 | Train Loss: 13.724 Vali Loss: 27.883 Vali Acc: 0.400 Test Loss: 27.883 Test Acc: 0.400
Validation loss decreased (-0.379672 --> -0.399721).  Saving model ...
Epoch: 10 cost time: 3.433471918106079
Epoch: 10, Steps: 13 | Train Loss: 11.408 Vali Loss: 28.682 Vali Acc: 0.520 Test Loss: 28.682 Test Acc: 0.520
Validation loss decreased (-0.399721 --> -0.519713).  Saving model ...
Epoch: 11 cost time: 3.3991663455963135
Epoch: 11, Steps: 13 | Train Loss: 10.309 Vali Loss: 35.595 Vali Acc: 0.420 Test Loss: 35.595 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.6746914386749268
Epoch: 12, Steps: 13 | Train Loss: 8.474 Vali Loss: 32.746 Vali Acc: 0.500 Test Loss: 32.746 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.3976476192474365
Epoch: 13, Steps: 13 | Train Loss: 7.167 Vali Loss: 27.768 Vali Acc: 0.580 Test Loss: 27.768 Test Acc: 0.580
Validation loss decreased (-0.519713 --> -0.579722).  Saving model ...
Epoch: 14 cost time: 3.418078899383545
Epoch: 14, Steps: 13 | Train Loss: 4.726 Vali Loss: 21.411 Vali Acc: 0.600 Test Loss: 21.411 Test Acc: 0.600
Validation loss decreased (-0.579722 --> -0.599786).  Saving model ...
Epoch: 15 cost time: 3.869063377380371
Epoch: 15, Steps: 13 | Train Loss: 4.502 Vali Loss: 29.017 Vali Acc: 0.460 Test Loss: 29.017 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.575815200805664
Epoch: 16, Steps: 13 | Train Loss: 5.553 Vali Loss: 41.327 Vali Acc: 0.440 Test Loss: 41.327 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.3681344985961914
Epoch: 17, Steps: 13 | Train Loss: 1.548 Vali Loss: 34.535 Vali Acc: 0.460 Test Loss: 34.535 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.1989500522613525
Epoch: 18, Steps: 13 | Train Loss: 6.416 Vali Loss: 41.031 Vali Acc: 0.400 Test Loss: 41.031 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.5879640579223633
Epoch: 19, Steps: 13 | Train Loss: 5.121 Vali Loss: 36.037 Vali Acc: 0.460 Test Loss: 36.037 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.2668070793151855
Epoch: 20, Steps: 13 | Train Loss: 2.047 Vali Loss: 49.982 Vali Acc: 0.480 Test Loss: 49.982 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.480220079421997
Epoch: 21, Steps: 13 | Train Loss: 13.497 Vali Loss: 59.213 Vali Acc: 0.440 Test Loss: 59.213 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.111344814300537
Epoch: 22, Steps: 13 | Train Loss: 13.142 Vali Loss: 48.824 Vali Acc: 0.480 Test Loss: 48.824 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.266526460647583
Epoch: 23, Steps: 13 | Train Loss: 7.566 Vali Loss: 47.231 Vali Acc: 0.480 Test Loss: 47.231 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.059009313583374
Epoch: 24, Steps: 13 | Train Loss: 5.101 Vali Loss: 48.808 Vali Acc: 0.460 Test Loss: 48.808 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 5161525
model size : 21.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.878231525421143
Epoch: 1, Steps: 13 | Train Loss: 3.580 Vali Loss: 4.017 Vali Acc: 0.240 Test Loss: 4.017 Test Acc: 0.240
Validation loss decreased (inf --> -0.239960).  Saving model ...
Epoch: 2 cost time: 3.3076682090759277
Epoch: 2, Steps: 13 | Train Loss: 5.274 Vali Loss: 13.603 Vali Acc: 0.240 Test Loss: 13.603 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.3860795497894287
Epoch: 3, Steps: 13 | Train Loss: 17.791 Vali Loss: 11.404 Vali Acc: 0.360 Test Loss: 11.404 Test Acc: 0.360
Validation loss decreased (-0.239960 --> -0.359886).  Saving model ...
Epoch: 4 cost time: 3.3781328201293945
Epoch: 4, Steps: 13 | Train Loss: 13.675 Vali Loss: 24.004 Vali Acc: 0.200 Test Loss: 24.004 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.4153289794921875
Epoch: 5, Steps: 13 | Train Loss: 17.178 Vali Loss: 17.726 Vali Acc: 0.300 Test Loss: 17.726 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.7983195781707764
Epoch: 6, Steps: 13 | Train Loss: 10.170 Vali Loss: 25.130 Vali Acc: 0.460 Test Loss: 25.130 Test Acc: 0.460
Validation loss decreased (-0.359886 --> -0.459749).  Saving model ...
Epoch: 7 cost time: 3.4557104110717773
Epoch: 7, Steps: 13 | Train Loss: 8.285 Vali Loss: 27.123 Vali Acc: 0.300 Test Loss: 27.123 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.630866765975952
Epoch: 8, Steps: 13 | Train Loss: 9.975 Vali Loss: 54.808 Vali Acc: 0.260 Test Loss: 54.808 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.7534847259521484
Epoch: 9, Steps: 13 | Train Loss: 6.822 Vali Loss: 23.234 Vali Acc: 0.420 Test Loss: 23.234 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.4163570404052734
Epoch: 10, Steps: 13 | Train Loss: 11.398 Vali Loss: 27.371 Vali Acc: 0.460 Test Loss: 27.371 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.5005922317504883
Epoch: 11, Steps: 13 | Train Loss: 8.240 Vali Loss: 26.400 Vali Acc: 0.460 Test Loss: 26.400 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.4193649291992188
Epoch: 12, Steps: 13 | Train Loss: 4.128 Vali Loss: 27.458 Vali Acc: 0.420 Test Loss: 27.458 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.7125349044799805
Epoch: 13, Steps: 13 | Train Loss: 7.561 Vali Loss: 31.465 Vali Acc: 0.480 Test Loss: 31.465 Test Acc: 0.480
Validation loss decreased (-0.459749 --> -0.479685).  Saving model ...
Epoch: 14 cost time: 3.3769662380218506
Epoch: 14, Steps: 13 | Train Loss: 13.039 Vali Loss: 24.952 Vali Acc: 0.540 Test Loss: 24.952 Test Acc: 0.540
Validation loss decreased (-0.479685 --> -0.539750).  Saving model ...
Epoch: 15 cost time: 3.336054801940918
Epoch: 15, Steps: 13 | Train Loss: 4.023 Vali Loss: 89.819 Vali Acc: 0.340 Test Loss: 89.819 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.6547012329101562
Epoch: 16, Steps: 13 | Train Loss: 21.634 Vali Loss: 46.455 Vali Acc: 0.500 Test Loss: 46.455 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.2546980381011963
Epoch: 17, Steps: 13 | Train Loss: 10.933 Vali Loss: 46.907 Vali Acc: 0.480 Test Loss: 46.907 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.3566596508026123
Epoch: 18, Steps: 13 | Train Loss: 6.341 Vali Loss: 58.975 Vali Acc: 0.500 Test Loss: 58.975 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.5098352432250977
Epoch: 19, Steps: 13 | Train Loss: 4.803 Vali Loss: 36.561 Vali Acc: 0.440 Test Loss: 36.561 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.481809377670288
Epoch: 20, Steps: 13 | Train Loss: 3.700 Vali Loss: 48.899 Vali Acc: 0.480 Test Loss: 48.899 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.1662285327911377
Epoch: 21, Steps: 13 | Train Loss: 5.682 Vali Loss: 44.682 Vali Acc: 0.540 Test Loss: 44.682 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.310798168182373
Epoch: 22, Steps: 13 | Train Loss: 1.034 Vali Loss: 53.127 Vali Acc: 0.460 Test Loss: 53.127 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.266206741333008
Epoch: 23, Steps: 13 | Train Loss: 3.205 Vali Loss: 56.334 Vali Acc: 0.480 Test Loss: 56.334 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.1681883335113525
Epoch: 24, Steps: 13 | Train Loss: 4.137 Vali Loss: 49.858 Vali Acc: 0.440 Test Loss: 49.858 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 5158901
model size : 21.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.720221757888794
Epoch: 1, Steps: 13 | Train Loss: 3.888 Vali Loss: 5.934 Vali Acc: 0.180 Test Loss: 5.934 Test Acc: 0.180
Validation loss decreased (inf --> -0.179941).  Saving model ...
Epoch: 2 cost time: 3.0208053588867188
Epoch: 2, Steps: 13 | Train Loss: 8.422 Vali Loss: 26.096 Vali Acc: 0.200 Test Loss: 26.096 Test Acc: 0.200
Validation loss decreased (-0.179941 --> -0.199739).  Saving model ...
Epoch: 3 cost time: 3.403367280960083
Epoch: 3, Steps: 13 | Train Loss: 16.855 Vali Loss: 12.440 Vali Acc: 0.360 Test Loss: 12.440 Test Acc: 0.360
Validation loss decreased (-0.199739 --> -0.359876).  Saving model ...
Epoch: 4 cost time: 3.2149553298950195
Epoch: 4, Steps: 13 | Train Loss: 11.539 Vali Loss: 18.192 Vali Acc: 0.300 Test Loss: 18.192 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.345120429992676
Epoch: 5, Steps: 13 | Train Loss: 7.663 Vali Loss: 21.023 Vali Acc: 0.400 Test Loss: 21.023 Test Acc: 0.400
Validation loss decreased (-0.359876 --> -0.399790).  Saving model ...
Epoch: 6 cost time: 3.0909409523010254
Epoch: 6, Steps: 13 | Train Loss: 12.015 Vali Loss: 21.924 Vali Acc: 0.320 Test Loss: 21.924 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.133382797241211
Epoch: 7, Steps: 13 | Train Loss: 11.193 Vali Loss: 14.131 Vali Acc: 0.560 Test Loss: 14.131 Test Acc: 0.560
Validation loss decreased (-0.399790 --> -0.559859).  Saving model ...
Epoch: 8 cost time: 3.4737966060638428
Epoch: 8, Steps: 13 | Train Loss: 11.602 Vali Loss: 45.530 Vali Acc: 0.260 Test Loss: 45.530 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.3322153091430664
Epoch: 9, Steps: 13 | Train Loss: 11.056 Vali Loss: 36.042 Vali Acc: 0.500 Test Loss: 36.042 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.3558707237243652
Epoch: 10, Steps: 13 | Train Loss: 31.716 Vali Loss: 73.866 Vali Acc: 0.340 Test Loss: 73.866 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.4277045726776123
Epoch: 11, Steps: 13 | Train Loss: 24.283 Vali Loss: 34.093 Vali Acc: 0.400 Test Loss: 34.093 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.364746570587158
Epoch: 12, Steps: 13 | Train Loss: 11.419 Vali Loss: 38.651 Vali Acc: 0.460 Test Loss: 38.651 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.3526206016540527
Epoch: 13, Steps: 13 | Train Loss: 12.568 Vali Loss: 32.021 Vali Acc: 0.400 Test Loss: 32.021 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.27622389793396
Epoch: 14, Steps: 13 | Train Loss: 4.309 Vali Loss: 23.076 Vali Acc: 0.520 Test Loss: 23.076 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.655362367630005
Epoch: 15, Steps: 13 | Train Loss: 3.898 Vali Loss: 36.605 Vali Acc: 0.460 Test Loss: 36.605 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.430074453353882
Epoch: 16, Steps: 13 | Train Loss: 7.281 Vali Loss: 41.904 Vali Acc: 0.460 Test Loss: 41.904 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.1205384731292725
Epoch: 17, Steps: 13 | Train Loss: 7.380 Vali Loss: 41.606 Vali Acc: 0.440 Test Loss: 41.606 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 5156277
model size : 21.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.200809717178345
Epoch: 1, Steps: 13 | Train Loss: 2.207 Vali Loss: 3.842 Vali Acc: 0.240 Test Loss: 3.842 Test Acc: 0.240
Validation loss decreased (inf --> -0.239962).  Saving model ...
Epoch: 2 cost time: 3.488668203353882
Epoch: 2, Steps: 13 | Train Loss: 5.325 Vali Loss: 4.356 Vali Acc: 0.240 Test Loss: 4.356 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.157167673110962
Epoch: 3, Steps: 13 | Train Loss: 4.055 Vali Loss: 14.784 Vali Acc: 0.240 Test Loss: 14.784 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.1642611026763916
Epoch: 4, Steps: 13 | Train Loss: 12.469 Vali Loss: 8.196 Vali Acc: 0.420 Test Loss: 8.196 Test Acc: 0.420
Validation loss decreased (-0.239962 --> -0.419918).  Saving model ...
Epoch: 5 cost time: 3.087554693222046
Epoch: 5, Steps: 13 | Train Loss: 6.208 Vali Loss: 11.465 Vali Acc: 0.360 Test Loss: 11.465 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.2746834754943848
Epoch: 6, Steps: 13 | Train Loss: 13.602 Vali Loss: 12.099 Vali Acc: 0.320 Test Loss: 12.099 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.294159412384033
Epoch: 7, Steps: 13 | Train Loss: 3.138 Vali Loss: 16.458 Vali Acc: 0.340 Test Loss: 16.458 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.1036860942840576
Epoch: 8, Steps: 13 | Train Loss: 6.993 Vali Loss: 4.872 Vali Acc: 0.540 Test Loss: 4.872 Test Acc: 0.540
Validation loss decreased (-0.419918 --> -0.539951).  Saving model ...
Epoch: 9 cost time: 3.2314677238464355
Epoch: 9, Steps: 13 | Train Loss: 2.382 Vali Loss: 8.166 Vali Acc: 0.500 Test Loss: 8.166 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.4536383152008057
Epoch: 10, Steps: 13 | Train Loss: 3.967 Vali Loss: 17.414 Vali Acc: 0.440 Test Loss: 17.414 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.3699939250946045
Epoch: 11, Steps: 13 | Train Loss: 4.953 Vali Loss: 18.491 Vali Acc: 0.440 Test Loss: 18.491 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.729898452758789
Epoch: 12, Steps: 13 | Train Loss: 3.874 Vali Loss: 12.435 Vali Acc: 0.500 Test Loss: 12.435 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.5513904094696045
Epoch: 13, Steps: 13 | Train Loss: 1.482 Vali Loss: 11.123 Vali Acc: 0.520 Test Loss: 11.123 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.4011576175689697
Epoch: 14, Steps: 13 | Train Loss: 0.002 Vali Loss: 18.622 Vali Acc: 0.440 Test Loss: 18.622 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.758216381072998
Epoch: 15, Steps: 13 | Train Loss: 3.647 Vali Loss: 17.937 Vali Acc: 0.420 Test Loss: 17.937 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.444370746612549
Epoch: 16, Steps: 13 | Train Loss: 1.989 Vali Loss: 17.928 Vali Acc: 0.500 Test Loss: 17.928 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.2680721282958984
Epoch: 17, Steps: 13 | Train Loss: 2.027 Vali Loss: 16.809 Vali Acc: 0.460 Test Loss: 16.809 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.2077882289886475
Epoch: 18, Steps: 13 | Train Loss: 1.771 Vali Loss: 16.837 Vali Acc: 0.500 Test Loss: 16.837 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 2875541
model size : 11.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.58196759223938
Epoch: 1, Steps: 13 | Train Loss: 3.038 Vali Loss: 3.343 Vali Acc: 0.200 Test Loss: 3.343 Test Acc: 0.200
Validation loss decreased (inf --> -0.199967).  Saving model ...
Epoch: 2 cost time: 3.256789445877075
Epoch: 2, Steps: 13 | Train Loss: 3.028 Vali Loss: 1.732 Vali Acc: 0.360 Test Loss: 1.732 Test Acc: 0.360
Validation loss decreased (-0.199967 --> -0.359983).  Saving model ...
Epoch: 3 cost time: 3.2064945697784424
Epoch: 3, Steps: 13 | Train Loss: 6.195 Vali Loss: 7.926 Vali Acc: 0.300 Test Loss: 7.926 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.2783291339874268
Epoch: 4, Steps: 13 | Train Loss: 6.652 Vali Loss: 4.785 Vali Acc: 0.340 Test Loss: 4.785 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.1606967449188232
Epoch: 5, Steps: 13 | Train Loss: 3.446 Vali Loss: 9.128 Vali Acc: 0.280 Test Loss: 9.128 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.3030827045440674
Epoch: 6, Steps: 13 | Train Loss: 3.743 Vali Loss: 7.363 Vali Acc: 0.420 Test Loss: 7.363 Test Acc: 0.420
Validation loss decreased (-0.359983 --> -0.419926).  Saving model ...
Epoch: 7 cost time: 3.303349256515503
Epoch: 7, Steps: 13 | Train Loss: 3.225 Vali Loss: 11.993 Vali Acc: 0.400 Test Loss: 11.993 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.3167855739593506
Epoch: 8, Steps: 13 | Train Loss: 4.722 Vali Loss: 14.387 Vali Acc: 0.340 Test Loss: 14.387 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.4704198837280273
Epoch: 9, Steps: 13 | Train Loss: 4.458 Vali Loss: 16.003 Vali Acc: 0.400 Test Loss: 16.003 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.1951324939727783
Epoch: 10, Steps: 13 | Train Loss: 3.023 Vali Loss: 16.030 Vali Acc: 0.460 Test Loss: 16.030 Test Acc: 0.460
Validation loss decreased (-0.419926 --> -0.459840).  Saving model ...
Epoch: 11 cost time: 3.3821821212768555
Epoch: 11, Steps: 13 | Train Loss: 5.306 Vali Loss: 8.519 Vali Acc: 0.460 Test Loss: 8.519 Test Acc: 0.460
Validation loss decreased (-0.459840 --> -0.459915).  Saving model ...
Epoch: 12 cost time: 3.302135944366455
Epoch: 12, Steps: 13 | Train Loss: 2.230 Vali Loss: 9.273 Vali Acc: 0.460 Test Loss: 9.273 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.4865119457244873
Epoch: 13, Steps: 13 | Train Loss: 3.653 Vali Loss: 17.246 Vali Acc: 0.400 Test Loss: 17.246 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.5818827152252197
Epoch: 14, Steps: 13 | Train Loss: 1.064 Vali Loss: 12.563 Vali Acc: 0.480 Test Loss: 12.563 Test Acc: 0.480
Validation loss decreased (-0.459915 --> -0.479874).  Saving model ...
Epoch: 15 cost time: 3.7669010162353516
Epoch: 15, Steps: 13 | Train Loss: 0.880 Vali Loss: 10.724 Vali Acc: 0.480 Test Loss: 10.724 Test Acc: 0.480
Validation loss decreased (-0.479874 --> -0.479893).  Saving model ...
Epoch: 16 cost time: 3.4182677268981934
Epoch: 16, Steps: 13 | Train Loss: 0.177 Vali Loss: 11.221 Vali Acc: 0.540 Test Loss: 11.221 Test Acc: 0.540
Validation loss decreased (-0.479893 --> -0.539888).  Saving model ...
Epoch: 17 cost time: 3.493168830871582
Epoch: 17, Steps: 13 | Train Loss: 0.929 Vali Loss: 21.013 Vali Acc: 0.520 Test Loss: 21.013 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.2769320011138916
Epoch: 18, Steps: 13 | Train Loss: 1.199 Vali Loss: 16.645 Vali Acc: 0.440 Test Loss: 16.645 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.3264448642730713
Epoch: 19, Steps: 13 | Train Loss: 2.237 Vali Loss: 22.488 Vali Acc: 0.400 Test Loss: 22.488 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.3810932636260986
Epoch: 20, Steps: 13 | Train Loss: 4.861 Vali Loss: 17.886 Vali Acc: 0.440 Test Loss: 17.886 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.165148973464966
Epoch: 21, Steps: 13 | Train Loss: 5.176 Vali Loss: 24.333 Vali Acc: 0.460 Test Loss: 24.333 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.3327200412750244
Epoch: 22, Steps: 13 | Train Loss: 1.651 Vali Loss: 14.694 Vali Acc: 0.500 Test Loss: 14.694 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.124105453491211
Epoch: 23, Steps: 13 | Train Loss: 0.403 Vali Loss: 18.862 Vali Acc: 0.460 Test Loss: 18.862 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.1170499324798584
Epoch: 24, Steps: 13 | Train Loss: 1.112 Vali Loss: 13.139 Vali Acc: 0.480 Test Loss: 13.139 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.4230268001556396
Epoch: 25, Steps: 13 | Train Loss: 0.020 Vali Loss: 12.619 Vali Acc: 0.580 Test Loss: 12.619 Test Acc: 0.580
Validation loss decreased (-0.539888 --> -0.579874).  Saving model ...
Epoch: 26 cost time: 3.207092761993408
Epoch: 26, Steps: 13 | Train Loss: 1.792 Vali Loss: 13.951 Vali Acc: 0.460 Test Loss: 13.951 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.371342897415161
Epoch: 27, Steps: 13 | Train Loss: 0.000 Vali Loss: 16.615 Vali Acc: 0.420 Test Loss: 16.615 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.099968671798706
Epoch: 28, Steps: 13 | Train Loss: 0.000 Vali Loss: 17.710 Vali Acc: 0.420 Test Loss: 17.710 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.4263620376586914
Epoch: 29, Steps: 13 | Train Loss: 0.000 Vali Loss: 18.010 Vali Acc: 0.440 Test Loss: 18.010 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.673278331756592
Epoch: 30, Steps: 13 | Train Loss: 0.000 Vali Loss: 18.073 Vali Acc: 0.440 Test Loss: 18.073 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.2333984375
Epoch: 31, Steps: 13 | Train Loss: 0.000 Vali Loss: 18.072 Vali Acc: 0.440 Test Loss: 18.072 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 3.9606823921203613
Epoch: 32, Steps: 13 | Train Loss: 0.000 Vali Loss: 18.068 Vali Acc: 0.440 Test Loss: 18.068 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 3.3455705642700195
Epoch: 33, Steps: 13 | Train Loss: 0.000 Vali Loss: 18.012 Vali Acc: 0.440 Test Loss: 18.012 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 3.372068166732788
Epoch: 34, Steps: 13 | Train Loss: 0.000 Vali Loss: 17.836 Vali Acc: 0.460 Test Loss: 17.836 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 3.6234331130981445
Epoch: 35, Steps: 13 | Train Loss: 0.000 Vali Loss: 17.750 Vali Acc: 0.460 Test Loss: 17.750 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 2874229
model size : 11.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.4346840381622314
Epoch: 1, Steps: 13 | Train Loss: 2.918 Vali Loss: 3.502 Vali Acc: 0.240 Test Loss: 3.502 Test Acc: 0.240
Validation loss decreased (inf --> -0.239965).  Saving model ...
Epoch: 2 cost time: 3.1000633239746094
Epoch: 2, Steps: 13 | Train Loss: 2.735 Vali Loss: 3.895 Vali Acc: 0.400 Test Loss: 3.895 Test Acc: 0.400
Validation loss decreased (-0.239965 --> -0.399961).  Saving model ...
Epoch: 3 cost time: 3.1288442611694336
Epoch: 3, Steps: 13 | Train Loss: 5.024 Vali Loss: 3.425 Vali Acc: 0.300 Test Loss: 3.425 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.2677810192108154
Epoch: 4, Steps: 13 | Train Loss: 3.373 Vali Loss: 9.522 Vali Acc: 0.420 Test Loss: 9.522 Test Acc: 0.420
Validation loss decreased (-0.399961 --> -0.419905).  Saving model ...
Epoch: 5 cost time: 3.216341733932495
Epoch: 5, Steps: 13 | Train Loss: 3.077 Vali Loss: 8.122 Vali Acc: 0.320 Test Loss: 8.122 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.0021417140960693
Epoch: 6, Steps: 13 | Train Loss: 9.630 Vali Loss: 18.137 Vali Acc: 0.240 Test Loss: 18.137 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.365527868270874
Epoch: 7, Steps: 13 | Train Loss: 6.257 Vali Loss: 8.495 Vali Acc: 0.420 Test Loss: 8.495 Test Acc: 0.420
Validation loss decreased (-0.419905 --> -0.419915).  Saving model ...
Epoch: 8 cost time: 3.4574244022369385
Epoch: 8, Steps: 13 | Train Loss: 3.969 Vali Loss: 15.217 Vali Acc: 0.400 Test Loss: 15.217 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.4036996364593506
Epoch: 9, Steps: 13 | Train Loss: 3.258 Vali Loss: 14.225 Vali Acc: 0.460 Test Loss: 14.225 Test Acc: 0.460
Validation loss decreased (-0.419915 --> -0.459858).  Saving model ...
Epoch: 10 cost time: 2.9804108142852783
Epoch: 10, Steps: 13 | Train Loss: 4.908 Vali Loss: 11.986 Vali Acc: 0.380 Test Loss: 11.986 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.2646329402923584
Epoch: 11, Steps: 13 | Train Loss: 2.870 Vali Loss: 12.606 Vali Acc: 0.500 Test Loss: 12.606 Test Acc: 0.500
Validation loss decreased (-0.459858 --> -0.499874).  Saving model ...
Epoch: 12 cost time: 3.5144009590148926
Epoch: 12, Steps: 13 | Train Loss: 3.633 Vali Loss: 13.803 Vali Acc: 0.480 Test Loss: 13.803 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.0580766201019287
Epoch: 13, Steps: 13 | Train Loss: 1.578 Vali Loss: 9.404 Vali Acc: 0.500 Test Loss: 9.404 Test Acc: 0.500
Validation loss decreased (-0.499874 --> -0.499906).  Saving model ...
Epoch: 14 cost time: 3.208620071411133
Epoch: 14, Steps: 13 | Train Loss: 1.248 Vali Loss: 10.737 Vali Acc: 0.540 Test Loss: 10.737 Test Acc: 0.540
Validation loss decreased (-0.499906 --> -0.539893).  Saving model ...
Epoch: 15 cost time: 3.330017566680908
Epoch: 15, Steps: 13 | Train Loss: 0.689 Vali Loss: 13.268 Vali Acc: 0.560 Test Loss: 13.268 Test Acc: 0.560
Validation loss decreased (-0.539893 --> -0.559867).  Saving model ...
Epoch: 16 cost time: 3.0209858417510986
Epoch: 16, Steps: 13 | Train Loss: 3.189 Vali Loss: 39.417 Vali Acc: 0.360 Test Loss: 39.417 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.0948383808135986
Epoch: 17, Steps: 13 | Train Loss: 6.732 Vali Loss: 12.156 Vali Acc: 0.420 Test Loss: 12.156 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.330641508102417
Epoch: 18, Steps: 13 | Train Loss: 1.996 Vali Loss: 14.794 Vali Acc: 0.600 Test Loss: 14.794 Test Acc: 0.600
Validation loss decreased (-0.559867 --> -0.599852).  Saving model ...
Epoch: 19 cost time: 3.3038206100463867
Epoch: 19, Steps: 13 | Train Loss: 2.220 Vali Loss: 27.846 Vali Acc: 0.520 Test Loss: 27.846 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.9676296710968018
Epoch: 20, Steps: 13 | Train Loss: 0.882 Vali Loss: 20.609 Vali Acc: 0.480 Test Loss: 20.609 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.22045636177063
Epoch: 21, Steps: 13 | Train Loss: 0.662 Vali Loss: 17.487 Vali Acc: 0.400 Test Loss: 17.487 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.2536098957061768
Epoch: 22, Steps: 13 | Train Loss: 0.751 Vali Loss: 27.262 Vali Acc: 0.400 Test Loss: 27.262 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.0916996002197266
Epoch: 23, Steps: 13 | Train Loss: 1.363 Vali Loss: 17.025 Vali Acc: 0.440 Test Loss: 17.025 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.1043760776519775
Epoch: 24, Steps: 13 | Train Loss: 0.045 Vali Loss: 15.218 Vali Acc: 0.520 Test Loss: 15.218 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.1388113498687744
Epoch: 25, Steps: 13 | Train Loss: 0.128 Vali Loss: 23.328 Vali Acc: 0.460 Test Loss: 23.328 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.0822393894195557
Epoch: 26, Steps: 13 | Train Loss: 1.153 Vali Loss: 30.063 Vali Acc: 0.360 Test Loss: 30.063 Test Acc: 0.360
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.931674003601074
Epoch: 27, Steps: 13 | Train Loss: 0.061 Vali Loss: 24.739 Vali Acc: 0.440 Test Loss: 24.739 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 3.0638530254364014
Epoch: 28, Steps: 13 | Train Loss: 0.192 Vali Loss: 31.391 Vali Acc: 0.400 Test Loss: 31.391 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 2872917
model size : 11.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.720278978347778
Epoch: 1, Steps: 13 | Train Loss: 2.771 Vali Loss: 4.034 Vali Acc: 0.200 Test Loss: 4.034 Test Acc: 0.200
Validation loss decreased (inf --> -0.199960).  Saving model ...
Epoch: 2 cost time: 3.19140625
Epoch: 2, Steps: 13 | Train Loss: 5.076 Vali Loss: 7.532 Vali Acc: 0.200 Test Loss: 7.532 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.8858280181884766
Epoch: 3, Steps: 13 | Train Loss: 6.475 Vali Loss: 8.823 Vali Acc: 0.320 Test Loss: 8.823 Test Acc: 0.320
Validation loss decreased (-0.199960 --> -0.319912).  Saving model ...
Epoch: 4 cost time: 3.390481948852539
Epoch: 4, Steps: 13 | Train Loss: 5.534 Vali Loss: 4.365 Vali Acc: 0.320 Test Loss: 4.365 Test Acc: 0.320
Validation loss decreased (-0.319912 --> -0.319956).  Saving model ...
Epoch: 5 cost time: 3.0802979469299316
Epoch: 5, Steps: 13 | Train Loss: 4.300 Vali Loss: 8.036 Vali Acc: 0.220 Test Loss: 8.036 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.4722297191619873
Epoch: 6, Steps: 13 | Train Loss: 4.878 Vali Loss: 8.928 Vali Acc: 0.320 Test Loss: 8.928 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.287459135055542
Epoch: 7, Steps: 13 | Train Loss: 2.802 Vali Loss: 16.819 Vali Acc: 0.340 Test Loss: 16.819 Test Acc: 0.340
Validation loss decreased (-0.319956 --> -0.339832).  Saving model ...
Epoch: 8 cost time: 3.124695062637329
Epoch: 8, Steps: 13 | Train Loss: 7.541 Vali Loss: 11.240 Vali Acc: 0.400 Test Loss: 11.240 Test Acc: 0.400
Validation loss decreased (-0.339832 --> -0.399888).  Saving model ...
Epoch: 9 cost time: 3.125839948654175
Epoch: 9, Steps: 13 | Train Loss: 1.805 Vali Loss: 7.011 Vali Acc: 0.480 Test Loss: 7.011 Test Acc: 0.480
Validation loss decreased (-0.399888 --> -0.479930).  Saving model ...
Epoch: 10 cost time: 3.3056678771972656
Epoch: 10, Steps: 13 | Train Loss: 2.649 Vali Loss: 17.252 Vali Acc: 0.340 Test Loss: 17.252 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.107185125350952
Epoch: 11, Steps: 13 | Train Loss: 5.686 Vali Loss: 17.146 Vali Acc: 0.440 Test Loss: 17.146 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.407731771469116
Epoch: 12, Steps: 13 | Train Loss: 5.848 Vali Loss: 20.328 Vali Acc: 0.320 Test Loss: 20.328 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.0158960819244385
Epoch: 13, Steps: 13 | Train Loss: 6.723 Vali Loss: 27.835 Vali Acc: 0.380 Test Loss: 27.835 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.298111915588379
Epoch: 14, Steps: 13 | Train Loss: 7.178 Vali Loss: 12.095 Vali Acc: 0.360 Test Loss: 12.095 Test Acc: 0.360
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.3556811809539795
Epoch: 15, Steps: 13 | Train Loss: 3.597 Vali Loss: 11.749 Vali Acc: 0.460 Test Loss: 11.749 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.5696091651916504
Epoch: 16, Steps: 13 | Train Loss: 1.015 Vali Loss: 14.078 Vali Acc: 0.420 Test Loss: 14.078 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.1171905994415283
Epoch: 17, Steps: 13 | Train Loss: 0.352 Vali Loss: 17.468 Vali Acc: 0.460 Test Loss: 17.468 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.893557071685791
Epoch: 18, Steps: 13 | Train Loss: 0.328 Vali Loss: 11.994 Vali Acc: 0.460 Test Loss: 11.994 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.3080406188964844
Epoch: 19, Steps: 13 | Train Loss: 0.242 Vali Loss: 17.287 Vali Acc: 0.380 Test Loss: 17.287 Test Acc: 0.380
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 2871605
model size : 11.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.960994005203247
Epoch: 1, Steps: 13 | Train Loss: 3.327 Vali Loss: 3.625 Vali Acc: 0.200 Test Loss: 3.625 Test Acc: 0.200
Validation loss decreased (inf --> -0.199964).  Saving model ...
Epoch: 2 cost time: 2.9242100715637207
Epoch: 2, Steps: 13 | Train Loss: 2.685 Vali Loss: 4.827 Vali Acc: 0.240 Test Loss: 4.827 Test Acc: 0.240
Validation loss decreased (-0.199964 --> -0.239952).  Saving model ...
Epoch: 3 cost time: 2.7366044521331787
Epoch: 3, Steps: 13 | Train Loss: 3.969 Vali Loss: 5.790 Vali Acc: 0.200 Test Loss: 5.790 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.972119092941284
Epoch: 4, Steps: 13 | Train Loss: 4.773 Vali Loss: 6.496 Vali Acc: 0.360 Test Loss: 6.496 Test Acc: 0.360
Validation loss decreased (-0.239952 --> -0.359935).  Saving model ...
Epoch: 5 cost time: 3.3318724632263184
Epoch: 5, Steps: 13 | Train Loss: 3.935 Vali Loss: 6.360 Vali Acc: 0.340 Test Loss: 6.360 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.110175609588623
Epoch: 6, Steps: 13 | Train Loss: 5.996 Vali Loss: 10.663 Vali Acc: 0.380 Test Loss: 10.663 Test Acc: 0.380
Validation loss decreased (-0.359935 --> -0.379893).  Saving model ...
Epoch: 7 cost time: 3.0818169116973877
Epoch: 7, Steps: 13 | Train Loss: 4.705 Vali Loss: 12.995 Vali Acc: 0.300 Test Loss: 12.995 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.2384119033813477
Epoch: 8, Steps: 13 | Train Loss: 5.799 Vali Loss: 12.099 Vali Acc: 0.380 Test Loss: 12.099 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.0199811458587646
Epoch: 9, Steps: 13 | Train Loss: 2.925 Vali Loss: 9.129 Vali Acc: 0.500 Test Loss: 9.129 Test Acc: 0.500
Validation loss decreased (-0.379893 --> -0.499909).  Saving model ...
Epoch: 10 cost time: 3.0152170658111572
Epoch: 10, Steps: 13 | Train Loss: 3.875 Vali Loss: 16.583 Vali Acc: 0.460 Test Loss: 16.583 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.826961040496826
Epoch: 11, Steps: 13 | Train Loss: 4.640 Vali Loss: 22.722 Vali Acc: 0.380 Test Loss: 22.722 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.035794734954834
Epoch: 12, Steps: 13 | Train Loss: 6.389 Vali Loss: 11.568 Vali Acc: 0.460 Test Loss: 11.568 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.2837603092193604
Epoch: 13, Steps: 13 | Train Loss: 5.887 Vali Loss: 15.892 Vali Acc: 0.360 Test Loss: 15.892 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.286821126937866
Epoch: 14, Steps: 13 | Train Loss: 6.910 Vali Loss: 18.560 Vali Acc: 0.560 Test Loss: 18.560 Test Acc: 0.560
Validation loss decreased (-0.499909 --> -0.559814).  Saving model ...
Epoch: 15 cost time: 3.227001190185547
Epoch: 15, Steps: 13 | Train Loss: 3.497 Vali Loss: 10.177 Vali Acc: 0.500 Test Loss: 10.177 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.184433698654175
Epoch: 16, Steps: 13 | Train Loss: 2.615 Vali Loss: 15.780 Vali Acc: 0.460 Test Loss: 15.780 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.3642287254333496
Epoch: 17, Steps: 13 | Train Loss: 2.412 Vali Loss: 36.706 Vali Acc: 0.400 Test Loss: 36.706 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.019132137298584
Epoch: 18, Steps: 13 | Train Loss: 2.136 Vali Loss: 24.443 Vali Acc: 0.460 Test Loss: 24.443 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.833034038543701
Epoch: 19, Steps: 13 | Train Loss: 2.284 Vali Loss: 19.364 Vali Acc: 0.520 Test Loss: 19.364 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.946420907974243
Epoch: 20, Steps: 13 | Train Loss: 2.538 Vali Loss: 23.821 Vali Acc: 0.440 Test Loss: 23.821 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.423740863800049
Epoch: 21, Steps: 13 | Train Loss: 1.081 Vali Loss: 18.359 Vali Acc: 0.540 Test Loss: 18.359 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.132655620574951
Epoch: 22, Steps: 13 | Train Loss: 0.924 Vali Loss: 24.141 Vali Acc: 0.440 Test Loss: 24.141 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.9292314052581787
Epoch: 23, Steps: 13 | Train Loss: 1.425 Vali Loss: 22.329 Vali Acc: 0.440 Test Loss: 22.329 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.858304023742676
Epoch: 24, Steps: 13 | Train Loss: 1.401 Vali Loss: 21.643 Vali Acc: 0.400 Test Loss: 21.643 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 2642581
model size : 10.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.315229892730713
Epoch: 1, Steps: 13 | Train Loss: 2.786 Vali Loss: 3.265 Vali Acc: 0.220 Test Loss: 3.265 Test Acc: 0.220
Validation loss decreased (inf --> -0.219967).  Saving model ...
Epoch: 2 cost time: 2.71880841255188
Epoch: 2, Steps: 13 | Train Loss: 4.570 Vali Loss: 3.646 Vali Acc: 0.240 Test Loss: 3.646 Test Acc: 0.240
Validation loss decreased (-0.219967 --> -0.239964).  Saving model ...
Epoch: 3 cost time: 2.8306984901428223
Epoch: 3, Steps: 13 | Train Loss: 4.501 Vali Loss: 7.894 Vali Acc: 0.200 Test Loss: 7.894 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.2394490242004395
Epoch: 4, Steps: 13 | Train Loss: 6.021 Vali Loss: 13.031 Vali Acc: 0.220 Test Loss: 13.031 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.0537776947021484
Epoch: 5, Steps: 13 | Train Loss: 9.517 Vali Loss: 8.918 Vali Acc: 0.400 Test Loss: 8.918 Test Acc: 0.400
Validation loss decreased (-0.239964 --> -0.399911).  Saving model ...
Epoch: 6 cost time: 3.11200213432312
Epoch: 6, Steps: 13 | Train Loss: 4.384 Vali Loss: 9.638 Vali Acc: 0.460 Test Loss: 9.638 Test Acc: 0.460
Validation loss decreased (-0.399911 --> -0.459904).  Saving model ...
Epoch: 7 cost time: 3.1521072387695312
Epoch: 7, Steps: 13 | Train Loss: 8.536 Vali Loss: 14.076 Vali Acc: 0.300 Test Loss: 14.076 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.1829137802124023
Epoch: 8, Steps: 13 | Train Loss: 4.691 Vali Loss: 13.115 Vali Acc: 0.460 Test Loss: 13.115 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.8706462383270264
Epoch: 9, Steps: 13 | Train Loss: 4.331 Vali Loss: 12.646 Vali Acc: 0.460 Test Loss: 12.646 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.7366251945495605
Epoch: 10, Steps: 13 | Train Loss: 3.993 Vali Loss: 12.451 Vali Acc: 0.480 Test Loss: 12.451 Test Acc: 0.480
Validation loss decreased (-0.459904 --> -0.479875).  Saving model ...
Epoch: 11 cost time: 3.1874959468841553
Epoch: 11, Steps: 13 | Train Loss: 2.677 Vali Loss: 15.640 Vali Acc: 0.580 Test Loss: 15.640 Test Acc: 0.580
Validation loss decreased (-0.479875 --> -0.579844).  Saving model ...
Epoch: 12 cost time: 3.240049123764038
Epoch: 12, Steps: 13 | Train Loss: 2.192 Vali Loss: 9.969 Vali Acc: 0.620 Test Loss: 9.969 Test Acc: 0.620
Validation loss decreased (-0.579844 --> -0.619900).  Saving model ...
Epoch: 13 cost time: 3.0181915760040283
Epoch: 13, Steps: 13 | Train Loss: 2.589 Vali Loss: 16.638 Vali Acc: 0.460 Test Loss: 16.638 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.755946397781372
Epoch: 14, Steps: 13 | Train Loss: 6.995 Vali Loss: 28.259 Vali Acc: 0.480 Test Loss: 28.259 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.1336703300476074
Epoch: 15, Steps: 13 | Train Loss: 5.740 Vali Loss: 16.450 Vali Acc: 0.480 Test Loss: 16.450 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.9855763912200928
Epoch: 16, Steps: 13 | Train Loss: 1.497 Vali Loss: 18.543 Vali Acc: 0.500 Test Loss: 18.543 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.1456291675567627
Epoch: 17, Steps: 13 | Train Loss: 0.876 Vali Loss: 16.673 Vali Acc: 0.400 Test Loss: 16.673 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.275282144546509
Epoch: 18, Steps: 13 | Train Loss: 0.855 Vali Loss: 16.887 Vali Acc: 0.420 Test Loss: 16.887 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.8177003860473633
Epoch: 19, Steps: 13 | Train Loss: 0.097 Vali Loss: 18.487 Vali Acc: 0.400 Test Loss: 18.487 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.358240842819214
Epoch: 20, Steps: 13 | Train Loss: 0.573 Vali Loss: 24.470 Vali Acc: 0.480 Test Loss: 24.470 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.939138412475586
Epoch: 21, Steps: 13 | Train Loss: 1.734 Vali Loss: 29.144 Vali Acc: 0.460 Test Loss: 29.144 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.0875155925750732
Epoch: 22, Steps: 13 | Train Loss: 3.219 Vali Loss: 25.416 Vali Acc: 0.380 Test Loss: 25.416 Test Acc: 0.380
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 2641269
model size : 10.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.63163423538208
Epoch: 1, Steps: 13 | Train Loss: 3.185 Vali Loss: 3.418 Vali Acc: 0.200 Test Loss: 3.418 Test Acc: 0.200
Validation loss decreased (inf --> -0.199966).  Saving model ...
Epoch: 2 cost time: 2.566859006881714
Epoch: 2, Steps: 13 | Train Loss: 5.053 Vali Loss: 5.140 Vali Acc: 0.260 Test Loss: 5.140 Test Acc: 0.260
Validation loss decreased (-0.199966 --> -0.259949).  Saving model ...
Epoch: 3 cost time: 2.5821099281311035
Epoch: 3, Steps: 13 | Train Loss: 5.112 Vali Loss: 8.782 Vali Acc: 0.320 Test Loss: 8.782 Test Acc: 0.320
Validation loss decreased (-0.259949 --> -0.319912).  Saving model ...
Epoch: 4 cost time: 2.717708110809326
Epoch: 4, Steps: 13 | Train Loss: 5.834 Vali Loss: 9.451 Vali Acc: 0.220 Test Loss: 9.451 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.8089921474456787
Epoch: 5, Steps: 13 | Train Loss: 6.394 Vali Loss: 11.569 Vali Acc: 0.360 Test Loss: 11.569 Test Acc: 0.360
Validation loss decreased (-0.319912 --> -0.359884).  Saving model ...
Epoch: 6 cost time: 2.7286064624786377
Epoch: 6, Steps: 13 | Train Loss: 9.205 Vali Loss: 12.539 Vali Acc: 0.200 Test Loss: 12.539 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.048441171646118
Epoch: 7, Steps: 13 | Train Loss: 8.629 Vali Loss: 7.858 Vali Acc: 0.400 Test Loss: 7.858 Test Acc: 0.400
Validation loss decreased (-0.359884 --> -0.399921).  Saving model ...
Epoch: 8 cost time: 2.904719352722168
Epoch: 8, Steps: 13 | Train Loss: 2.405 Vali Loss: 7.743 Vali Acc: 0.420 Test Loss: 7.743 Test Acc: 0.420
Validation loss decreased (-0.399921 --> -0.419923).  Saving model ...
Epoch: 9 cost time: 2.638073205947876
Epoch: 9, Steps: 13 | Train Loss: 4.867 Vali Loss: 19.905 Vali Acc: 0.360 Test Loss: 19.905 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.0454444885253906
Epoch: 10, Steps: 13 | Train Loss: 5.294 Vali Loss: 11.853 Vali Acc: 0.520 Test Loss: 11.853 Test Acc: 0.520
Validation loss decreased (-0.419923 --> -0.519881).  Saving model ...
Epoch: 11 cost time: 2.7076191902160645
Epoch: 11, Steps: 13 | Train Loss: 5.889 Vali Loss: 11.938 Vali Acc: 0.520 Test Loss: 11.938 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.827594041824341
Epoch: 12, Steps: 13 | Train Loss: 2.501 Vali Loss: 15.662 Vali Acc: 0.460 Test Loss: 15.662 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.632075548171997
Epoch: 13, Steps: 13 | Train Loss: 3.643 Vali Loss: 23.894 Vali Acc: 0.400 Test Loss: 23.894 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.9630510807037354
Epoch: 14, Steps: 13 | Train Loss: 4.457 Vali Loss: 19.422 Vali Acc: 0.480 Test Loss: 19.422 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.911565065383911
Epoch: 15, Steps: 13 | Train Loss: 7.311 Vali Loss: 20.877 Vali Acc: 0.380 Test Loss: 20.877 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.6875979900360107
Epoch: 16, Steps: 13 | Train Loss: 6.487 Vali Loss: 12.759 Vali Acc: 0.440 Test Loss: 12.759 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.870229482650757
Epoch: 17, Steps: 13 | Train Loss: 0.136 Vali Loss: 11.378 Vali Acc: 0.580 Test Loss: 11.378 Test Acc: 0.580
Validation loss decreased (-0.519881 --> -0.579886).  Saving model ...
Epoch: 18 cost time: 2.7620787620544434
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 13.211 Vali Acc: 0.540 Test Loss: 13.211 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.724360704421997
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 13.494 Vali Acc: 0.540 Test Loss: 13.494 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.8211007118225098
Epoch: 20, Steps: 13 | Train Loss: 0.000 Vali Loss: 12.873 Vali Acc: 0.560 Test Loss: 12.873 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.8741495609283447
Epoch: 21, Steps: 13 | Train Loss: 0.000 Vali Loss: 12.089 Vali Acc: 0.560 Test Loss: 12.089 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.7959463596343994
Epoch: 22, Steps: 13 | Train Loss: 0.000 Vali Loss: 11.873 Vali Acc: 0.580 Test Loss: 11.873 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.7657971382141113
Epoch: 23, Steps: 13 | Train Loss: 0.000 Vali Loss: 11.819 Vali Acc: 0.580 Test Loss: 11.819 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.690108060836792
Epoch: 24, Steps: 13 | Train Loss: 0.000 Vali Loss: 11.805 Vali Acc: 0.580 Test Loss: 11.805 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.886303424835205
Epoch: 25, Steps: 13 | Train Loss: 0.000 Vali Loss: 11.798 Vali Acc: 0.580 Test Loss: 11.798 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.7842743396759033
Epoch: 26, Steps: 13 | Train Loss: 0.000 Vali Loss: 11.790 Vali Acc: 0.580 Test Loss: 11.790 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.8240365982055664
Epoch: 27, Steps: 13 | Train Loss: 0.000 Vali Loss: 11.785 Vali Acc: 0.580 Test Loss: 11.785 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 2639957
model size : 10.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.478084325790405
Epoch: 1, Steps: 13 | Train Loss: 3.228 Vali Loss: 11.785 Vali Acc: 0.200 Test Loss: 11.785 Test Acc: 0.200
Validation loss decreased (inf --> -0.199882).  Saving model ...
Epoch: 2 cost time: 2.493955135345459
Epoch: 2, Steps: 13 | Train Loss: 9.052 Vali Loss: 7.070 Vali Acc: 0.200 Test Loss: 7.070 Test Acc: 0.200
Validation loss decreased (-0.199882 --> -0.199929).  Saving model ...
Epoch: 3 cost time: 2.7673733234405518
Epoch: 3, Steps: 13 | Train Loss: 5.989 Vali Loss: 11.183 Vali Acc: 0.200 Test Loss: 11.183 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.800908088684082
Epoch: 4, Steps: 13 | Train Loss: 8.512 Vali Loss: 21.004 Vali Acc: 0.200 Test Loss: 21.004 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.825758457183838
Epoch: 5, Steps: 13 | Train Loss: 9.971 Vali Loss: 15.919 Vali Acc: 0.340 Test Loss: 15.919 Test Acc: 0.340
Validation loss decreased (-0.199929 --> -0.339841).  Saving model ...
Epoch: 6 cost time: 2.8478713035583496
Epoch: 6, Steps: 13 | Train Loss: 8.328 Vali Loss: 11.636 Vali Acc: 0.380 Test Loss: 11.636 Test Acc: 0.380
Validation loss decreased (-0.339841 --> -0.379884).  Saving model ...
Epoch: 7 cost time: 2.8036348819732666
Epoch: 7, Steps: 13 | Train Loss: 5.167 Vali Loss: 14.756 Vali Acc: 0.320 Test Loss: 14.756 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.606926679611206
Epoch: 8, Steps: 13 | Train Loss: 7.669 Vali Loss: 12.517 Vali Acc: 0.320 Test Loss: 12.517 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.892026901245117
Epoch: 9, Steps: 13 | Train Loss: 4.488 Vali Loss: 12.693 Vali Acc: 0.460 Test Loss: 12.693 Test Acc: 0.460
Validation loss decreased (-0.379884 --> -0.459873).  Saving model ...
Epoch: 10 cost time: 2.710251808166504
Epoch: 10, Steps: 13 | Train Loss: 2.819 Vali Loss: 11.236 Vali Acc: 0.400 Test Loss: 11.236 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.555309295654297
Epoch: 11, Steps: 13 | Train Loss: 4.537 Vali Loss: 13.798 Vali Acc: 0.440 Test Loss: 13.798 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.7384092807769775
Epoch: 12, Steps: 13 | Train Loss: 2.024 Vali Loss: 15.933 Vali Acc: 0.400 Test Loss: 15.933 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.6662697792053223
Epoch: 13, Steps: 13 | Train Loss: 4.101 Vali Loss: 21.936 Vali Acc: 0.340 Test Loss: 21.936 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.6226537227630615
Epoch: 14, Steps: 13 | Train Loss: 1.781 Vali Loss: 13.469 Vali Acc: 0.420 Test Loss: 13.469 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.575133800506592
Epoch: 15, Steps: 13 | Train Loss: 3.331 Vali Loss: 15.279 Vali Acc: 0.440 Test Loss: 15.279 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.776238203048706
Epoch: 16, Steps: 13 | Train Loss: 0.373 Vali Loss: 17.828 Vali Acc: 0.440 Test Loss: 17.828 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.62440824508667
Epoch: 17, Steps: 13 | Train Loss: 0.703 Vali Loss: 14.655 Vali Acc: 0.440 Test Loss: 14.655 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.665106773376465
Epoch: 18, Steps: 13 | Train Loss: 0.374 Vali Loss: 16.770 Vali Acc: 0.400 Test Loss: 16.770 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.4750783443450928
Epoch: 19, Steps: 13 | Train Loss: 0.873 Vali Loss: 21.849 Vali Acc: 0.420 Test Loss: 21.849 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.46
model parameter : 2638645
model size : 10.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.694696426391602
Epoch: 1, Steps: 13 | Train Loss: 2.619 Vali Loss: 4.738 Vali Acc: 0.200 Test Loss: 4.738 Test Acc: 0.200
Validation loss decreased (inf --> -0.199953).  Saving model ...
Epoch: 2 cost time: 2.70361065864563
Epoch: 2, Steps: 13 | Train Loss: 3.077 Vali Loss: 4.975 Vali Acc: 0.200 Test Loss: 4.975 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.46791934967041
Epoch: 3, Steps: 13 | Train Loss: 7.777 Vali Loss: 11.060 Vali Acc: 0.220 Test Loss: 11.060 Test Acc: 0.220
Validation loss decreased (-0.199953 --> -0.219889).  Saving model ...
Epoch: 4 cost time: 2.4016215801239014
Epoch: 4, Steps: 13 | Train Loss: 5.936 Vali Loss: 13.134 Vali Acc: 0.240 Test Loss: 13.134 Test Acc: 0.240
Validation loss decreased (-0.219889 --> -0.239869).  Saving model ...
Epoch: 5 cost time: 2.5065793991088867
Epoch: 5, Steps: 13 | Train Loss: 6.265 Vali Loss: 14.914 Vali Acc: 0.300 Test Loss: 14.914 Test Acc: 0.300
Validation loss decreased (-0.239869 --> -0.299851).  Saving model ...
Epoch: 6 cost time: 2.8646702766418457
Epoch: 6, Steps: 13 | Train Loss: 6.471 Vali Loss: 11.949 Vali Acc: 0.240 Test Loss: 11.949 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.5225789546966553
Epoch: 7, Steps: 13 | Train Loss: 4.099 Vali Loss: 10.120 Vali Acc: 0.280 Test Loss: 10.120 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.7618649005889893
Epoch: 8, Steps: 13 | Train Loss: 3.688 Vali Loss: 11.343 Vali Acc: 0.440 Test Loss: 11.343 Test Acc: 0.440
Validation loss decreased (-0.299851 --> -0.439887).  Saving model ...
Epoch: 9 cost time: 2.7828941345214844
Epoch: 9, Steps: 13 | Train Loss: 4.824 Vali Loss: 8.224 Vali Acc: 0.420 Test Loss: 8.224 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.9533097743988037
Epoch: 10, Steps: 13 | Train Loss: 0.946 Vali Loss: 9.484 Vali Acc: 0.380 Test Loss: 9.484 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.7287323474884033
Epoch: 11, Steps: 13 | Train Loss: 2.678 Vali Loss: 14.467 Vali Acc: 0.340 Test Loss: 14.467 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.7698187828063965
Epoch: 12, Steps: 13 | Train Loss: 3.749 Vali Loss: 16.225 Vali Acc: 0.480 Test Loss: 16.225 Test Acc: 0.480
Validation loss decreased (-0.439887 --> -0.479838).  Saving model ...
Epoch: 13 cost time: 2.5910801887512207
Epoch: 13, Steps: 13 | Train Loss: 5.688 Vali Loss: 17.011 Vali Acc: 0.440 Test Loss: 17.011 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.818220615386963
Epoch: 14, Steps: 13 | Train Loss: 1.929 Vali Loss: 13.078 Vali Acc: 0.520 Test Loss: 13.078 Test Acc: 0.520
Validation loss decreased (-0.479838 --> -0.519869).  Saving model ...
Epoch: 15 cost time: 2.4789977073669434
Epoch: 15, Steps: 13 | Train Loss: 5.053 Vali Loss: 22.397 Vali Acc: 0.540 Test Loss: 22.397 Test Acc: 0.540
Validation loss decreased (-0.519869 --> -0.539776).  Saving model ...
Epoch: 16 cost time: 2.5169363021850586
Epoch: 16, Steps: 13 | Train Loss: 8.834 Vali Loss: 20.502 Vali Acc: 0.460 Test Loss: 20.502 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.6403300762176514
Epoch: 17, Steps: 13 | Train Loss: 4.490 Vali Loss: 20.672 Vali Acc: 0.540 Test Loss: 20.672 Test Acc: 0.540
Validation loss decreased (-0.539776 --> -0.539793).  Saving model ...
Epoch: 18 cost time: 2.618145704269409
Epoch: 18, Steps: 13 | Train Loss: 2.918 Vali Loss: 24.764 Vali Acc: 0.500 Test Loss: 24.764 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.57023286819458
Epoch: 19, Steps: 13 | Train Loss: 4.173 Vali Loss: 15.578 Vali Acc: 0.560 Test Loss: 15.578 Test Acc: 0.560
Validation loss decreased (-0.539793 --> -0.559844).  Saving model ...
Epoch: 20 cost time: 2.488304376602173
Epoch: 20, Steps: 13 | Train Loss: 6.965 Vali Loss: 33.438 Vali Acc: 0.480 Test Loss: 33.438 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.4073731899261475
Epoch: 21, Steps: 13 | Train Loss: 12.423 Vali Loss: 24.555 Vali Acc: 0.480 Test Loss: 24.555 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.5842349529266357
Epoch: 22, Steps: 13 | Train Loss: 0.770 Vali Loss: 29.228 Vali Acc: 0.520 Test Loss: 29.228 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.5272138118743896
Epoch: 23, Steps: 13 | Train Loss: 3.209 Vali Loss: 20.961 Vali Acc: 0.400 Test Loss: 20.961 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.3734781742095947
Epoch: 24, Steps: 13 | Train Loss: 2.222 Vali Loss: 29.561 Vali Acc: 0.400 Test Loss: 29.561 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.5327696800231934
Epoch: 25, Steps: 13 | Train Loss: 0.572 Vali Loss: 32.775 Vali Acc: 0.340 Test Loss: 32.775 Test Acc: 0.340
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.821472406387329
Epoch: 26, Steps: 13 | Train Loss: 0.758 Vali Loss: 27.745 Vali Acc: 0.520 Test Loss: 27.745 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.5528626441955566
Epoch: 27, Steps: 13 | Train Loss: 0.026 Vali Loss: 20.262 Vali Acc: 0.580 Test Loss: 20.262 Test Acc: 0.580
Validation loss decreased (-0.559844 --> -0.579797).  Saving model ...
Epoch: 28 cost time: 2.5170600414276123
Epoch: 28, Steps: 13 | Train Loss: 0.000 Vali Loss: 17.626 Vali Acc: 0.540 Test Loss: 17.626 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.7707226276397705
Epoch: 29, Steps: 13 | Train Loss: 0.000 Vali Loss: 17.527 Vali Acc: 0.520 Test Loss: 17.527 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.676546096801758
Epoch: 30, Steps: 13 | Train Loss: 0.000 Vali Loss: 17.630 Vali Acc: 0.520 Test Loss: 17.630 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.4487464427948
Epoch: 31, Steps: 13 | Train Loss: 0.000 Vali Loss: 17.660 Vali Acc: 0.520 Test Loss: 17.660 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.493152379989624
Epoch: 32, Steps: 13 | Train Loss: 0.000 Vali Loss: 17.668 Vali Acc: 0.520 Test Loss: 17.668 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.708733320236206
Epoch: 33, Steps: 13 | Train Loss: 0.000 Vali Loss: 17.670 Vali Acc: 0.520 Test Loss: 17.670 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.8217926025390625
Epoch: 34, Steps: 13 | Train Loss: 0.000 Vali Loss: 17.671 Vali Acc: 0.520 Test Loss: 17.671 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 2.7004966735839844
Epoch: 35, Steps: 13 | Train Loss: 0.000 Vali Loss: 17.671 Vali Acc: 0.520 Test Loss: 17.671 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 2.6081883907318115
Epoch: 36, Steps: 13 | Train Loss: 0.000 Vali Loss: 17.671 Vali Acc: 0.520 Test Loss: 17.671 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 2.7394661903381348
Epoch: 37, Steps: 13 | Train Loss: 0.000 Vali Loss: 17.671 Vali Acc: 0.520 Test Loss: 17.671 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 2526101
model size : 10.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.059683561325073
Epoch: 1, Steps: 13 | Train Loss: 2.503 Vali Loss: 3.510 Vali Acc: 0.200 Test Loss: 3.510 Test Acc: 0.200
Validation loss decreased (inf --> -0.199965).  Saving model ...
Epoch: 2 cost time: 2.9140090942382812
Epoch: 2, Steps: 13 | Train Loss: 3.240 Vali Loss: 7.483 Vali Acc: 0.200 Test Loss: 7.483 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.3103718757629395
Epoch: 3, Steps: 13 | Train Loss: 6.204 Vali Loss: 8.823 Vali Acc: 0.240 Test Loss: 8.823 Test Acc: 0.240
Validation loss decreased (-0.199965 --> -0.239912).  Saving model ...
Epoch: 4 cost time: 2.8643860816955566
Epoch: 4, Steps: 13 | Train Loss: 9.081 Vali Loss: 2.761 Vali Acc: 0.420 Test Loss: 2.761 Test Acc: 0.420
Validation loss decreased (-0.239912 --> -0.419972).  Saving model ...
Epoch: 5 cost time: 2.9263103008270264
Epoch: 5, Steps: 13 | Train Loss: 8.087 Vali Loss: 15.139 Vali Acc: 0.300 Test Loss: 15.139 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.163942337036133
Epoch: 6, Steps: 13 | Train Loss: 8.224 Vali Loss: 22.692 Vali Acc: 0.260 Test Loss: 22.692 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.0966386795043945
Epoch: 7, Steps: 13 | Train Loss: 8.839 Vali Loss: 12.728 Vali Acc: 0.360 Test Loss: 12.728 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.6522469520568848
Epoch: 8, Steps: 13 | Train Loss: 5.225 Vali Loss: 17.454 Vali Acc: 0.360 Test Loss: 17.454 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.7188379764556885
Epoch: 9, Steps: 13 | Train Loss: 7.572 Vali Loss: 28.505 Vali Acc: 0.360 Test Loss: 28.505 Test Acc: 0.360
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.766663074493408
Epoch: 10, Steps: 13 | Train Loss: 9.664 Vali Loss: 19.081 Vali Acc: 0.380 Test Loss: 19.081 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.747943162918091
Epoch: 11, Steps: 13 | Train Loss: 4.553 Vali Loss: 14.079 Vali Acc: 0.460 Test Loss: 14.079 Test Acc: 0.460
Validation loss decreased (-0.419972 --> -0.459859).  Saving model ...
Epoch: 12 cost time: 2.718719244003296
Epoch: 12, Steps: 13 | Train Loss: 3.620 Vali Loss: 23.078 Vali Acc: 0.400 Test Loss: 23.078 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.5613720417022705
Epoch: 13, Steps: 13 | Train Loss: 6.600 Vali Loss: 26.900 Vali Acc: 0.440 Test Loss: 26.900 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.8113632202148438
Epoch: 14, Steps: 13 | Train Loss: 4.985 Vali Loss: 18.239 Vali Acc: 0.420 Test Loss: 18.239 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.87379789352417
Epoch: 15, Steps: 13 | Train Loss: 3.275 Vali Loss: 18.269 Vali Acc: 0.500 Test Loss: 18.269 Test Acc: 0.500
Validation loss decreased (-0.459859 --> -0.499817).  Saving model ...
Epoch: 16 cost time: 2.8123559951782227
Epoch: 16, Steps: 13 | Train Loss: 2.657 Vali Loss: 22.094 Vali Acc: 0.420 Test Loss: 22.094 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.8658604621887207
Epoch: 17, Steps: 13 | Train Loss: 0.564 Vali Loss: 25.838 Vali Acc: 0.400 Test Loss: 25.838 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.9224822521209717
Epoch: 18, Steps: 13 | Train Loss: 4.146 Vali Loss: 30.365 Vali Acc: 0.420 Test Loss: 30.365 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.685213804244995
Epoch: 19, Steps: 13 | Train Loss: 2.227 Vali Loss: 23.408 Vali Acc: 0.420 Test Loss: 23.408 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.5557401180267334
Epoch: 20, Steps: 13 | Train Loss: 0.984 Vali Loss: 34.145 Vali Acc: 0.420 Test Loss: 34.145 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.866621494293213
Epoch: 21, Steps: 13 | Train Loss: 3.829 Vali Loss: 26.958 Vali Acc: 0.500 Test Loss: 26.958 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.8188185691833496
Epoch: 22, Steps: 13 | Train Loss: 3.520 Vali Loss: 24.250 Vali Acc: 0.460 Test Loss: 24.250 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.8723905086517334
Epoch: 23, Steps: 13 | Train Loss: 2.607 Vali Loss: 23.064 Vali Acc: 0.520 Test Loss: 23.064 Test Acc: 0.520
Validation loss decreased (-0.499817 --> -0.519769).  Saving model ...
Epoch: 24 cost time: 3.1130294799804688
Epoch: 24, Steps: 13 | Train Loss: 1.696 Vali Loss: 23.933 Vali Acc: 0.420 Test Loss: 23.933 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.937718629837036
Epoch: 25, Steps: 13 | Train Loss: 0.276 Vali Loss: 27.639 Vali Acc: 0.400 Test Loss: 27.639 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.2786407470703125
Epoch: 26, Steps: 13 | Train Loss: 0.946 Vali Loss: 27.549 Vali Acc: 0.520 Test Loss: 27.549 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.696415901184082
Epoch: 27, Steps: 13 | Train Loss: 0.689 Vali Loss: 20.397 Vali Acc: 0.460 Test Loss: 20.397 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.1504814624786377
Epoch: 28, Steps: 13 | Train Loss: 0.397 Vali Loss: 26.954 Vali Acc: 0.460 Test Loss: 26.954 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.0876054763793945
Epoch: 29, Steps: 13 | Train Loss: 1.571 Vali Loss: 20.497 Vali Acc: 0.500 Test Loss: 20.497 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.971317768096924
Epoch: 30, Steps: 13 | Train Loss: 0.084 Vali Loss: 17.739 Vali Acc: 0.540 Test Loss: 17.739 Test Acc: 0.540
Validation loss decreased (-0.519769 --> -0.539823).  Saving model ...
Epoch: 31 cost time: 3.1692850589752197
Epoch: 31, Steps: 13 | Train Loss: 0.667 Vali Loss: 25.355 Vali Acc: 0.500 Test Loss: 25.355 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.931591749191284
Epoch: 32, Steps: 13 | Train Loss: 1.996 Vali Loss: 21.175 Vali Acc: 0.540 Test Loss: 21.175 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.7978007793426514
Epoch: 33, Steps: 13 | Train Loss: 0.603 Vali Loss: 33.054 Vali Acc: 0.460 Test Loss: 33.054 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.7383971214294434
Epoch: 34, Steps: 13 | Train Loss: 2.277 Vali Loss: 27.463 Vali Acc: 0.500 Test Loss: 27.463 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 3.0718491077423096
Epoch: 35, Steps: 13 | Train Loss: 0.168 Vali Loss: 27.284 Vali Acc: 0.500 Test Loss: 27.284 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 2.866368293762207
Epoch: 36, Steps: 13 | Train Loss: 0.299 Vali Loss: 31.968 Vali Acc: 0.400 Test Loss: 31.968 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 2.7761037349700928
Epoch: 37, Steps: 13 | Train Loss: 0.271 Vali Loss: 26.549 Vali Acc: 0.520 Test Loss: 26.549 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 2.602620840072632
Epoch: 38, Steps: 13 | Train Loss: 0.000 Vali Loss: 35.208 Vali Acc: 0.400 Test Loss: 35.208 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 2.8098106384277344
Epoch: 39, Steps: 13 | Train Loss: 0.017 Vali Loss: 33.987 Vali Acc: 0.460 Test Loss: 33.987 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 2.81207275390625
Epoch: 40, Steps: 13 | Train Loss: 0.870 Vali Loss: 32.190 Vali Acc: 0.480 Test Loss: 32.190 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 2524789
model size : 10.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.914313793182373
Epoch: 1, Steps: 13 | Train Loss: 3.327 Vali Loss: 4.478 Vali Acc: 0.200 Test Loss: 4.478 Test Acc: 0.200
Validation loss decreased (inf --> -0.199955).  Saving model ...
Epoch: 2 cost time: 2.8634586334228516
Epoch: 2, Steps: 13 | Train Loss: 3.542 Vali Loss: 4.677 Vali Acc: 0.180 Test Loss: 4.677 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.561877965927124
Epoch: 3, Steps: 13 | Train Loss: 4.643 Vali Loss: 4.678 Vali Acc: 0.320 Test Loss: 4.678 Test Acc: 0.320
Validation loss decreased (-0.199955 --> -0.319953).  Saving model ...
Epoch: 4 cost time: 2.5467729568481445
Epoch: 4, Steps: 13 | Train Loss: 3.222 Vali Loss: 5.738 Vali Acc: 0.280 Test Loss: 5.738 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.844534397125244
Epoch: 5, Steps: 13 | Train Loss: 4.674 Vali Loss: 12.451 Vali Acc: 0.260 Test Loss: 12.451 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.558746337890625
Epoch: 6, Steps: 13 | Train Loss: 7.882 Vali Loss: 9.722 Vali Acc: 0.220 Test Loss: 9.722 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.4932048320770264
Epoch: 7, Steps: 13 | Train Loss: 6.691 Vali Loss: 10.054 Vali Acc: 0.240 Test Loss: 10.054 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.622626304626465
Epoch: 8, Steps: 13 | Train Loss: 6.346 Vali Loss: 14.913 Vali Acc: 0.320 Test Loss: 14.913 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.6629157066345215
Epoch: 9, Steps: 13 | Train Loss: 12.892 Vali Loss: 15.043 Vali Acc: 0.380 Test Loss: 15.043 Test Acc: 0.380
Validation loss decreased (-0.319953 --> -0.379850).  Saving model ...
Epoch: 10 cost time: 2.588982582092285
Epoch: 10, Steps: 13 | Train Loss: 3.590 Vali Loss: 10.940 Vali Acc: 0.400 Test Loss: 10.940 Test Acc: 0.400
Validation loss decreased (-0.379850 --> -0.399891).  Saving model ...
Epoch: 11 cost time: 2.5996034145355225
Epoch: 11, Steps: 13 | Train Loss: 3.139 Vali Loss: 15.155 Vali Acc: 0.380 Test Loss: 15.155 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.6739373207092285
Epoch: 12, Steps: 13 | Train Loss: 3.686 Vali Loss: 15.395 Vali Acc: 0.380 Test Loss: 15.395 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.6259994506835938
Epoch: 13, Steps: 13 | Train Loss: 2.295 Vali Loss: 17.116 Vali Acc: 0.400 Test Loss: 17.116 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.5100724697113037
Epoch: 14, Steps: 13 | Train Loss: 3.835 Vali Loss: 22.984 Vali Acc: 0.360 Test Loss: 22.984 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.556082248687744
Epoch: 15, Steps: 13 | Train Loss: 12.656 Vali Loss: 22.200 Vali Acc: 0.340 Test Loss: 22.200 Test Acc: 0.340
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.5087201595306396
Epoch: 16, Steps: 13 | Train Loss: 3.845 Vali Loss: 18.250 Vali Acc: 0.420 Test Loss: 18.250 Test Acc: 0.420
Validation loss decreased (-0.399891 --> -0.419817).  Saving model ...
Epoch: 17 cost time: 2.8872931003570557
Epoch: 17, Steps: 13 | Train Loss: 5.737 Vali Loss: 13.863 Vali Acc: 0.500 Test Loss: 13.863 Test Acc: 0.500
Validation loss decreased (-0.419817 --> -0.499861).  Saving model ...
Epoch: 18 cost time: 2.488250494003296
Epoch: 18, Steps: 13 | Train Loss: 2.319 Vali Loss: 39.758 Vali Acc: 0.380 Test Loss: 39.758 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.4214928150177
Epoch: 19, Steps: 13 | Train Loss: 11.057 Vali Loss: 32.628 Vali Acc: 0.360 Test Loss: 32.628 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.646895170211792
Epoch: 20, Steps: 13 | Train Loss: 5.240 Vali Loss: 24.135 Vali Acc: 0.540 Test Loss: 24.135 Test Acc: 0.540
Validation loss decreased (-0.499861 --> -0.539759).  Saving model ...
Epoch: 21 cost time: 2.640723943710327
Epoch: 21, Steps: 13 | Train Loss: 2.060 Vali Loss: 22.350 Vali Acc: 0.480 Test Loss: 22.350 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.589747428894043
Epoch: 22, Steps: 13 | Train Loss: 0.232 Vali Loss: 34.685 Vali Acc: 0.380 Test Loss: 34.685 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.954122304916382
Epoch: 23, Steps: 13 | Train Loss: 1.122 Vali Loss: 27.147 Vali Acc: 0.400 Test Loss: 27.147 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.043560266494751
Epoch: 24, Steps: 13 | Train Loss: 1.507 Vali Loss: 21.529 Vali Acc: 0.460 Test Loss: 21.529 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.6771724224090576
Epoch: 25, Steps: 13 | Train Loss: 0.678 Vali Loss: 21.989 Vali Acc: 0.440 Test Loss: 21.989 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.688066244125366
Epoch: 26, Steps: 13 | Train Loss: 0.547 Vali Loss: 27.474 Vali Acc: 0.360 Test Loss: 27.474 Test Acc: 0.360
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.813451051712036
Epoch: 27, Steps: 13 | Train Loss: 0.272 Vali Loss: 23.803 Vali Acc: 0.400 Test Loss: 23.803 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.7295286655426025
Epoch: 28, Steps: 13 | Train Loss: 0.424 Vali Loss: 18.877 Vali Acc: 0.500 Test Loss: 18.877 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.4943408966064453
Epoch: 29, Steps: 13 | Train Loss: 1.151 Vali Loss: 17.132 Vali Acc: 0.540 Test Loss: 17.132 Test Acc: 0.540
Validation loss decreased (-0.539759 --> -0.539829).  Saving model ...
Epoch: 30 cost time: 2.6105973720550537
Epoch: 30, Steps: 13 | Train Loss: 0.000 Vali Loss: 30.474 Vali Acc: 0.500 Test Loss: 30.474 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.6661033630371094
Epoch: 31, Steps: 13 | Train Loss: 0.307 Vali Loss: 17.240 Vali Acc: 0.520 Test Loss: 17.240 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.6273550987243652
Epoch: 32, Steps: 13 | Train Loss: 0.137 Vali Loss: 23.582 Vali Acc: 0.480 Test Loss: 23.582 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.9128801822662354
Epoch: 33, Steps: 13 | Train Loss: 0.907 Vali Loss: 40.502 Vali Acc: 0.440 Test Loss: 40.502 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.8434898853302
Epoch: 34, Steps: 13 | Train Loss: 1.092 Vali Loss: 70.335 Vali Acc: 0.300 Test Loss: 70.335 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 3.0148332118988037
Epoch: 35, Steps: 13 | Train Loss: 2.716 Vali Loss: 35.861 Vali Acc: 0.460 Test Loss: 35.861 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 2.7512831687927246
Epoch: 36, Steps: 13 | Train Loss: 1.394 Vali Loss: 48.929 Vali Acc: 0.400 Test Loss: 48.929 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 2.7481472492218018
Epoch: 37, Steps: 13 | Train Loss: 0.749 Vali Loss: 38.030 Vali Acc: 0.380 Test Loss: 38.030 Test Acc: 0.380
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 2.51922607421875
Epoch: 38, Steps: 13 | Train Loss: 0.004 Vali Loss: 53.162 Vali Acc: 0.380 Test Loss: 53.162 Test Acc: 0.380
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 2.7407076358795166
Epoch: 39, Steps: 13 | Train Loss: 0.031 Vali Loss: 34.763 Vali Acc: 0.440 Test Loss: 34.763 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 2523477
model size : 10.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.995107889175415
Epoch: 1, Steps: 13 | Train Loss: 2.367 Vali Loss: 6.470 Vali Acc: 0.200 Test Loss: 6.470 Test Acc: 0.200
Validation loss decreased (inf --> -0.199935).  Saving model ...
Epoch: 2 cost time: 2.4403913021087646
Epoch: 2, Steps: 13 | Train Loss: 4.905 Vali Loss: 3.909 Vali Acc: 0.220 Test Loss: 3.909 Test Acc: 0.220
Validation loss decreased (-0.199935 --> -0.219961).  Saving model ...
Epoch: 3 cost time: 2.3433423042297363
Epoch: 3, Steps: 13 | Train Loss: 3.396 Vali Loss: 4.058 Vali Acc: 0.300 Test Loss: 4.058 Test Acc: 0.300
Validation loss decreased (-0.219961 --> -0.299959).  Saving model ...
Epoch: 4 cost time: 2.366299629211426
Epoch: 4, Steps: 13 | Train Loss: 2.516 Vali Loss: 7.043 Vali Acc: 0.360 Test Loss: 7.043 Test Acc: 0.360
Validation loss decreased (-0.299959 --> -0.359930).  Saving model ...
Epoch: 5 cost time: 2.4387941360473633
Epoch: 5, Steps: 13 | Train Loss: 5.139 Vali Loss: 4.322 Vali Acc: 0.340 Test Loss: 4.322 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.434903144836426
Epoch: 6, Steps: 13 | Train Loss: 3.764 Vali Loss: 5.765 Vali Acc: 0.360 Test Loss: 5.765 Test Acc: 0.360
Validation loss decreased (-0.359930 --> -0.359942).  Saving model ...
Epoch: 7 cost time: 2.4019784927368164
Epoch: 7, Steps: 13 | Train Loss: 2.542 Vali Loss: 7.077 Vali Acc: 0.360 Test Loss: 7.077 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.459597110748291
Epoch: 8, Steps: 13 | Train Loss: 2.173 Vali Loss: 7.865 Vali Acc: 0.420 Test Loss: 7.865 Test Acc: 0.420
Validation loss decreased (-0.359942 --> -0.419921).  Saving model ...
Epoch: 9 cost time: 2.576173782348633
Epoch: 9, Steps: 13 | Train Loss: 7.132 Vali Loss: 8.566 Vali Acc: 0.480 Test Loss: 8.566 Test Acc: 0.480
Validation loss decreased (-0.419921 --> -0.479914).  Saving model ...
Epoch: 10 cost time: 2.52760910987854
Epoch: 10, Steps: 13 | Train Loss: 5.025 Vali Loss: 20.487 Vali Acc: 0.380 Test Loss: 20.487 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.611466646194458
Epoch: 11, Steps: 13 | Train Loss: 12.168 Vali Loss: 11.502 Vali Acc: 0.500 Test Loss: 11.502 Test Acc: 0.500
Validation loss decreased (-0.479914 --> -0.499885).  Saving model ...
Epoch: 12 cost time: 2.7209150791168213
Epoch: 12, Steps: 13 | Train Loss: 5.407 Vali Loss: 17.377 Vali Acc: 0.380 Test Loss: 17.377 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.471562623977661
Epoch: 13, Steps: 13 | Train Loss: 4.923 Vali Loss: 19.871 Vali Acc: 0.440 Test Loss: 19.871 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.523085594177246
Epoch: 14, Steps: 13 | Train Loss: 3.699 Vali Loss: 21.187 Vali Acc: 0.420 Test Loss: 21.187 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.527665615081787
Epoch: 15, Steps: 13 | Train Loss: 2.018 Vali Loss: 17.334 Vali Acc: 0.460 Test Loss: 17.334 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.4933385848999023
Epoch: 16, Steps: 13 | Train Loss: 3.775 Vali Loss: 11.892 Vali Acc: 0.540 Test Loss: 11.892 Test Acc: 0.540
Validation loss decreased (-0.499885 --> -0.539881).  Saving model ...
Epoch: 17 cost time: 2.401082754135132
Epoch: 17, Steps: 13 | Train Loss: 4.396 Vali Loss: 20.541 Vali Acc: 0.520 Test Loss: 20.541 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.3518738746643066
Epoch: 18, Steps: 13 | Train Loss: 0.592 Vali Loss: 28.075 Vali Acc: 0.500 Test Loss: 28.075 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.4935474395751953
Epoch: 19, Steps: 13 | Train Loss: 3.430 Vali Loss: 19.619 Vali Acc: 0.500 Test Loss: 19.619 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.553079605102539
Epoch: 20, Steps: 13 | Train Loss: 1.591 Vali Loss: 18.464 Vali Acc: 0.580 Test Loss: 18.464 Test Acc: 0.580
Validation loss decreased (-0.539881 --> -0.579815).  Saving model ...
Epoch: 21 cost time: 2.423973560333252
Epoch: 21, Steps: 13 | Train Loss: 2.329 Vali Loss: 14.907 Vali Acc: 0.600 Test Loss: 14.907 Test Acc: 0.600
Validation loss decreased (-0.579815 --> -0.599851).  Saving model ...
Epoch: 22 cost time: 2.5746259689331055
Epoch: 22, Steps: 13 | Train Loss: 3.049 Vali Loss: 20.239 Vali Acc: 0.520 Test Loss: 20.239 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.437974214553833
Epoch: 23, Steps: 13 | Train Loss: 0.307 Vali Loss: 21.550 Vali Acc: 0.500 Test Loss: 21.550 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.524250030517578
Epoch: 24, Steps: 13 | Train Loss: 0.315 Vali Loss: 15.508 Vali Acc: 0.540 Test Loss: 15.508 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.7242016792297363
Epoch: 25, Steps: 13 | Train Loss: 0.000 Vali Loss: 20.554 Vali Acc: 0.480 Test Loss: 20.554 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.7239396572113037
Epoch: 26, Steps: 13 | Train Loss: 0.591 Vali Loss: 19.577 Vali Acc: 0.500 Test Loss: 19.577 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.527719259262085
Epoch: 27, Steps: 13 | Train Loss: 1.256 Vali Loss: 16.253 Vali Acc: 0.480 Test Loss: 16.253 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.427436351776123
Epoch: 28, Steps: 13 | Train Loss: 0.605 Vali Loss: 22.756 Vali Acc: 0.640 Test Loss: 22.756 Test Acc: 0.640
Validation loss decreased (-0.599851 --> -0.639772).  Saving model ...
Epoch: 29 cost time: 2.7407519817352295
Epoch: 29, Steps: 13 | Train Loss: 0.725 Vali Loss: 19.180 Vali Acc: 0.560 Test Loss: 19.180 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.4557173252105713
Epoch: 30, Steps: 13 | Train Loss: 0.566 Vali Loss: 16.767 Vali Acc: 0.600 Test Loss: 16.767 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.4347846508026123
Epoch: 31, Steps: 13 | Train Loss: 0.125 Vali Loss: 20.664 Vali Acc: 0.540 Test Loss: 20.664 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.427541494369507
Epoch: 32, Steps: 13 | Train Loss: 0.568 Vali Loss: 36.328 Vali Acc: 0.380 Test Loss: 36.328 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 2.4791131019592285
Epoch: 33, Steps: 13 | Train Loss: 2.167 Vali Loss: 28.259 Vali Acc: 0.480 Test Loss: 28.259 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 2.3203723430633545
Epoch: 34, Steps: 13 | Train Loss: 1.693 Vali Loss: 22.579 Vali Acc: 0.480 Test Loss: 22.579 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 2.4252889156341553
Epoch: 35, Steps: 13 | Train Loss: 0.116 Vali Loss: 24.929 Vali Acc: 0.420 Test Loss: 24.929 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 2.6398801803588867
Epoch: 36, Steps: 13 | Train Loss: 0.312 Vali Loss: 34.355 Vali Acc: 0.460 Test Loss: 34.355 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 2.411064863204956
Epoch: 37, Steps: 13 | Train Loss: 4.023 Vali Loss: 34.835 Vali Acc: 0.520 Test Loss: 34.835 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 2.4789440631866455
Epoch: 38, Steps: 13 | Train Loss: 2.375 Vali Loss: 29.836 Vali Acc: 0.460 Test Loss: 29.836 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.64
model parameter : 2522165
model size : 10.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.244393587112427
Epoch: 1, Steps: 13 | Train Loss: 2.198 Vali Loss: 3.819 Vali Acc: 0.200 Test Loss: 3.819 Test Acc: 0.200
Validation loss decreased (inf --> -0.199962).  Saving model ...
Epoch: 2 cost time: 2.4723691940307617
Epoch: 2, Steps: 13 | Train Loss: 5.040 Vali Loss: 13.260 Vali Acc: 0.200 Test Loss: 13.260 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.4650681018829346
Epoch: 3, Steps: 13 | Train Loss: 10.064 Vali Loss: 15.311 Vali Acc: 0.200 Test Loss: 15.311 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.524651527404785
Epoch: 4, Steps: 13 | Train Loss: 7.796 Vali Loss: 6.580 Vali Acc: 0.240 Test Loss: 6.580 Test Acc: 0.240
Validation loss decreased (-0.199962 --> -0.239934).  Saving model ...
Epoch: 5 cost time: 2.5185632705688477
Epoch: 5, Steps: 13 | Train Loss: 6.273 Vali Loss: 7.924 Vali Acc: 0.380 Test Loss: 7.924 Test Acc: 0.380
Validation loss decreased (-0.239934 --> -0.379921).  Saving model ...
Epoch: 6 cost time: 2.6097686290740967
Epoch: 6, Steps: 13 | Train Loss: 7.876 Vali Loss: 17.856 Vali Acc: 0.300 Test Loss: 17.856 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.67879056930542
Epoch: 7, Steps: 13 | Train Loss: 6.568 Vali Loss: 10.388 Vali Acc: 0.300 Test Loss: 10.388 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.549400568008423
Epoch: 8, Steps: 13 | Train Loss: 4.284 Vali Loss: 8.195 Vali Acc: 0.260 Test Loss: 8.195 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.4100446701049805
Epoch: 9, Steps: 13 | Train Loss: 1.103 Vali Loss: 8.209 Vali Acc: 0.360 Test Loss: 8.209 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.7096524238586426
Epoch: 10, Steps: 13 | Train Loss: 2.973 Vali Loss: 19.704 Vali Acc: 0.360 Test Loss: 19.704 Test Acc: 0.360
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.743147611618042
Epoch: 11, Steps: 13 | Train Loss: 7.604 Vali Loss: 13.801 Vali Acc: 0.360 Test Loss: 13.801 Test Acc: 0.360
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.4970569610595703
Epoch: 12, Steps: 13 | Train Loss: 7.072 Vali Loss: 13.972 Vali Acc: 0.340 Test Loss: 13.972 Test Acc: 0.340
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.3718879222869873
Epoch: 13, Steps: 13 | Train Loss: 3.696 Vali Loss: 14.363 Vali Acc: 0.420 Test Loss: 14.363 Test Acc: 0.420
Validation loss decreased (-0.379921 --> -0.419856).  Saving model ...
Epoch: 14 cost time: 2.446237087249756
Epoch: 14, Steps: 13 | Train Loss: 7.709 Vali Loss: 29.205 Vali Acc: 0.380 Test Loss: 29.205 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.470736503601074
Epoch: 15, Steps: 13 | Train Loss: 7.499 Vali Loss: 19.382 Vali Acc: 0.300 Test Loss: 19.382 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.6012117862701416
Epoch: 16, Steps: 13 | Train Loss: 2.436 Vali Loss: 15.276 Vali Acc: 0.460 Test Loss: 15.276 Test Acc: 0.460
Validation loss decreased (-0.419856 --> -0.459847).  Saving model ...
Epoch: 17 cost time: 2.5473978519439697
Epoch: 17, Steps: 13 | Train Loss: 3.129 Vali Loss: 29.746 Vali Acc: 0.380 Test Loss: 29.746 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.6490914821624756
Epoch: 18, Steps: 13 | Train Loss: 8.259 Vali Loss: 22.232 Vali Acc: 0.440 Test Loss: 22.232 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.385643720626831
Epoch: 19, Steps: 13 | Train Loss: 3.532 Vali Loss: 17.755 Vali Acc: 0.500 Test Loss: 17.755 Test Acc: 0.500
Validation loss decreased (-0.459847 --> -0.499822).  Saving model ...
Epoch: 20 cost time: 2.6292247772216797
Epoch: 20, Steps: 13 | Train Loss: 1.698 Vali Loss: 34.530 Vali Acc: 0.400 Test Loss: 34.530 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.7749416828155518
Epoch: 21, Steps: 13 | Train Loss: 1.835 Vali Loss: 19.067 Vali Acc: 0.480 Test Loss: 19.067 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.7825326919555664
Epoch: 22, Steps: 13 | Train Loss: 0.011 Vali Loss: 20.954 Vali Acc: 0.480 Test Loss: 20.954 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.661684036254883
Epoch: 23, Steps: 13 | Train Loss: 0.374 Vali Loss: 22.253 Vali Acc: 0.440 Test Loss: 22.253 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.73000168800354
Epoch: 24, Steps: 13 | Train Loss: 3.951 Vali Loss: 23.401 Vali Acc: 0.400 Test Loss: 23.401 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.0935585498809814
Epoch: 25, Steps: 13 | Train Loss: 3.761 Vali Loss: 24.695 Vali Acc: 0.480 Test Loss: 24.695 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.752077341079712
Epoch: 26, Steps: 13 | Train Loss: 2.054 Vali Loss: 19.502 Vali Acc: 0.360 Test Loss: 19.502 Test Acc: 0.360
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.7297556400299072
Epoch: 27, Steps: 13 | Train Loss: 0.131 Vali Loss: 26.485 Vali Acc: 0.420 Test Loss: 26.485 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.657383918762207
Epoch: 28, Steps: 13 | Train Loss: 0.623 Vali Loss: 21.978 Vali Acc: 0.420 Test Loss: 21.978 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.6824593544006348
Epoch: 29, Steps: 13 | Train Loss: 0.781 Vali Loss: 21.045 Vali Acc: 0.560 Test Loss: 21.045 Test Acc: 0.560
Validation loss decreased (-0.499822 --> -0.559790).  Saving model ...
Epoch: 30 cost time: 2.998718023300171
Epoch: 30, Steps: 13 | Train Loss: 1.447 Vali Loss: 31.713 Vali Acc: 0.480 Test Loss: 31.713 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.754033327102661
Epoch: 31, Steps: 13 | Train Loss: 0.179 Vali Loss: 34.697 Vali Acc: 0.420 Test Loss: 34.697 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.601076126098633
Epoch: 32, Steps: 13 | Train Loss: 0.998 Vali Loss: 30.732 Vali Acc: 0.420 Test Loss: 30.732 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.5485072135925293
Epoch: 33, Steps: 13 | Train Loss: 0.000 Vali Loss: 32.027 Vali Acc: 0.380 Test Loss: 32.027 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.6324269771575928
Epoch: 34, Steps: 13 | Train Loss: 0.000 Vali Loss: 32.341 Vali Acc: 0.400 Test Loss: 32.341 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.524036407470703
Epoch: 35, Steps: 13 | Train Loss: 0.000 Vali Loss: 32.418 Vali Acc: 0.400 Test Loss: 32.418 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 2.5814764499664307
Epoch: 36, Steps: 13 | Train Loss: 0.000 Vali Loss: 32.438 Vali Acc: 0.400 Test Loss: 32.438 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 2.6087262630462646
Epoch: 37, Steps: 13 | Train Loss: 0.000 Vali Loss: 32.443 Vali Acc: 0.400 Test Loss: 32.443 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 2.726562976837158
Epoch: 38, Steps: 13 | Train Loss: 0.000 Vali Loss: 32.444 Vali Acc: 0.400 Test Loss: 32.444 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 2.855799674987793
Epoch: 39, Steps: 13 | Train Loss: 0.000 Vali Loss: 32.445 Vali Acc: 0.400 Test Loss: 32.445 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 2467861
model size : 10.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.565323352813721
Epoch: 1, Steps: 13 | Train Loss: 2.887 Vali Loss: 2.834 Vali Acc: 0.200 Test Loss: 2.834 Test Acc: 0.200
Validation loss decreased (inf --> -0.199972).  Saving model ...
Epoch: 2 cost time: 2.484099864959717
Epoch: 2, Steps: 13 | Train Loss: 3.230 Vali Loss: 9.012 Vali Acc: 0.300 Test Loss: 9.012 Test Acc: 0.300
Validation loss decreased (-0.199972 --> -0.299910).  Saving model ...
Epoch: 3 cost time: 2.6318886280059814
Epoch: 3, Steps: 13 | Train Loss: 3.280 Vali Loss: 4.581 Vali Acc: 0.220 Test Loss: 4.581 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.7919671535491943
Epoch: 4, Steps: 13 | Train Loss: 6.894 Vali Loss: 6.439 Vali Acc: 0.280 Test Loss: 6.439 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.864091634750366
Epoch: 5, Steps: 13 | Train Loss: 6.920 Vali Loss: 7.861 Vali Acc: 0.300 Test Loss: 7.861 Test Acc: 0.300
Validation loss decreased (-0.299910 --> -0.299921).  Saving model ...
Epoch: 6 cost time: 2.8861448764801025
Epoch: 6, Steps: 13 | Train Loss: 6.916 Vali Loss: 8.140 Vali Acc: 0.440 Test Loss: 8.140 Test Acc: 0.440
Validation loss decreased (-0.299921 --> -0.439919).  Saving model ...
Epoch: 7 cost time: 2.6671347618103027
Epoch: 7, Steps: 13 | Train Loss: 4.416 Vali Loss: 12.087 Vali Acc: 0.420 Test Loss: 12.087 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.97993540763855
Epoch: 8, Steps: 13 | Train Loss: 8.701 Vali Loss: 11.104 Vali Acc: 0.440 Test Loss: 11.104 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.5402839183807373
Epoch: 9, Steps: 13 | Train Loss: 7.306 Vali Loss: 12.958 Vali Acc: 0.440 Test Loss: 12.958 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.6177423000335693
Epoch: 10, Steps: 13 | Train Loss: 7.851 Vali Loss: 21.735 Vali Acc: 0.380 Test Loss: 21.735 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.652873992919922
Epoch: 11, Steps: 13 | Train Loss: 4.656 Vali Loss: 32.552 Vali Acc: 0.400 Test Loss: 32.552 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.6435770988464355
Epoch: 12, Steps: 13 | Train Loss: 12.831 Vali Loss: 22.825 Vali Acc: 0.380 Test Loss: 22.825 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.917255163192749
Epoch: 13, Steps: 13 | Train Loss: 5.473 Vali Loss: 22.307 Vali Acc: 0.440 Test Loss: 22.307 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.906984329223633
Epoch: 14, Steps: 13 | Train Loss: 2.924 Vali Loss: 18.632 Vali Acc: 0.440 Test Loss: 18.632 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.5948281288146973
Epoch: 15, Steps: 13 | Train Loss: 7.042 Vali Loss: 29.874 Vali Acc: 0.360 Test Loss: 29.874 Test Acc: 0.360
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.572826623916626
Epoch: 16, Steps: 13 | Train Loss: 8.495 Vali Loss: 35.835 Vali Acc: 0.400 Test Loss: 35.835 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.44
model parameter : 2466549
model size : 10.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.690257549285889
Epoch: 1, Steps: 13 | Train Loss: 2.660 Vali Loss: 2.245 Vali Acc: 0.240 Test Loss: 2.245 Test Acc: 0.240
Validation loss decreased (inf --> -0.239978).  Saving model ...
Epoch: 2 cost time: 2.487623691558838
Epoch: 2, Steps: 13 | Train Loss: 3.423 Vali Loss: 6.380 Vali Acc: 0.280 Test Loss: 6.380 Test Acc: 0.280
Validation loss decreased (-0.239978 --> -0.279936).  Saving model ...
Epoch: 3 cost time: 2.5899531841278076
Epoch: 3, Steps: 13 | Train Loss: 3.338 Vali Loss: 6.496 Vali Acc: 0.240 Test Loss: 6.496 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.46773624420166
Epoch: 4, Steps: 13 | Train Loss: 4.620 Vali Loss: 6.865 Vali Acc: 0.240 Test Loss: 6.865 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.522552967071533
Epoch: 5, Steps: 13 | Train Loss: 5.275 Vali Loss: 15.391 Vali Acc: 0.300 Test Loss: 15.391 Test Acc: 0.300
Validation loss decreased (-0.279936 --> -0.299846).  Saving model ...
Epoch: 6 cost time: 2.4643073081970215
Epoch: 6, Steps: 13 | Train Loss: 8.011 Vali Loss: 15.035 Vali Acc: 0.360 Test Loss: 15.035 Test Acc: 0.360
Validation loss decreased (-0.299846 --> -0.359850).  Saving model ...
Epoch: 7 cost time: 2.469881296157837
Epoch: 7, Steps: 13 | Train Loss: 8.877 Vali Loss: 21.093 Vali Acc: 0.240 Test Loss: 21.093 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.606938600540161
Epoch: 8, Steps: 13 | Train Loss: 8.303 Vali Loss: 19.844 Vali Acc: 0.400 Test Loss: 19.844 Test Acc: 0.400
Validation loss decreased (-0.359850 --> -0.399802).  Saving model ...
Epoch: 9 cost time: 2.6408066749572754
Epoch: 9, Steps: 13 | Train Loss: 10.381 Vali Loss: 10.444 Vali Acc: 0.480 Test Loss: 10.444 Test Acc: 0.480
Validation loss decreased (-0.399802 --> -0.479896).  Saving model ...
Epoch: 10 cost time: 3.0044288635253906
Epoch: 10, Steps: 13 | Train Loss: 2.639 Vali Loss: 20.748 Vali Acc: 0.440 Test Loss: 20.748 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.608812093734741
Epoch: 11, Steps: 13 | Train Loss: 5.739 Vali Loss: 31.521 Vali Acc: 0.360 Test Loss: 31.521 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.778097152709961
Epoch: 12, Steps: 13 | Train Loss: 5.340 Vali Loss: 23.134 Vali Acc: 0.400 Test Loss: 23.134 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.598893880844116
Epoch: 13, Steps: 13 | Train Loss: 5.788 Vali Loss: 22.901 Vali Acc: 0.360 Test Loss: 22.901 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.524824857711792
Epoch: 14, Steps: 13 | Train Loss: 3.760 Vali Loss: 25.562 Vali Acc: 0.400 Test Loss: 25.562 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.8322956562042236
Epoch: 15, Steps: 13 | Train Loss: 5.834 Vali Loss: 21.752 Vali Acc: 0.420 Test Loss: 21.752 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.630574941635132
Epoch: 16, Steps: 13 | Train Loss: 3.282 Vali Loss: 26.612 Vali Acc: 0.520 Test Loss: 26.612 Test Acc: 0.520
Validation loss decreased (-0.479896 --> -0.519734).  Saving model ...
Epoch: 17 cost time: 2.7201244831085205
Epoch: 17, Steps: 13 | Train Loss: 3.681 Vali Loss: 29.774 Vali Acc: 0.400 Test Loss: 29.774 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.7634670734405518
Epoch: 18, Steps: 13 | Train Loss: 10.394 Vali Loss: 43.761 Vali Acc: 0.380 Test Loss: 43.761 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.605848789215088
Epoch: 19, Steps: 13 | Train Loss: 2.903 Vali Loss: 21.384 Vali Acc: 0.500 Test Loss: 21.384 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.6271088123321533
Epoch: 20, Steps: 13 | Train Loss: 3.495 Vali Loss: 21.331 Vali Acc: 0.540 Test Loss: 21.331 Test Acc: 0.540
Validation loss decreased (-0.519734 --> -0.539787).  Saving model ...
Epoch: 21 cost time: 2.5422701835632324
Epoch: 21, Steps: 13 | Train Loss: 4.902 Vali Loss: 19.005 Vali Acc: 0.540 Test Loss: 19.005 Test Acc: 0.540
Validation loss decreased (-0.539787 --> -0.539810).  Saving model ...
Epoch: 22 cost time: 2.5862202644348145
Epoch: 22, Steps: 13 | Train Loss: 0.789 Vali Loss: 26.631 Vali Acc: 0.580 Test Loss: 26.631 Test Acc: 0.580
Validation loss decreased (-0.539810 --> -0.579734).  Saving model ...
Epoch: 23 cost time: 2.5334231853485107
Epoch: 23, Steps: 13 | Train Loss: 0.865 Vali Loss: 26.831 Vali Acc: 0.420 Test Loss: 26.831 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.4073922634124756
Epoch: 24, Steps: 13 | Train Loss: 1.204 Vali Loss: 24.676 Vali Acc: 0.500 Test Loss: 24.676 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.515291213989258
Epoch: 25, Steps: 13 | Train Loss: 2.045 Vali Loss: 26.900 Vali Acc: 0.460 Test Loss: 26.900 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.677248001098633
Epoch: 26, Steps: 13 | Train Loss: 3.847 Vali Loss: 28.545 Vali Acc: 0.480 Test Loss: 28.545 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.7801408767700195
Epoch: 27, Steps: 13 | Train Loss: 0.554 Vali Loss: 30.103 Vali Acc: 0.460 Test Loss: 30.103 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.587383270263672
Epoch: 28, Steps: 13 | Train Loss: 0.768 Vali Loss: 39.864 Vali Acc: 0.500 Test Loss: 39.864 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.5220751762390137
Epoch: 29, Steps: 13 | Train Loss: 1.689 Vali Loss: 23.840 Vali Acc: 0.520 Test Loss: 23.840 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.638507127761841
Epoch: 30, Steps: 13 | Train Loss: 0.747 Vali Loss: 27.162 Vali Acc: 0.460 Test Loss: 27.162 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.7614409923553467
Epoch: 31, Steps: 13 | Train Loss: 0.416 Vali Loss: 44.598 Vali Acc: 0.460 Test Loss: 44.598 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.454655885696411
Epoch: 32, Steps: 13 | Train Loss: 1.161 Vali Loss: 34.136 Vali Acc: 0.560 Test Loss: 34.136 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 2465237
model size : 10.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.127798557281494
Epoch: 1, Steps: 13 | Train Loss: 2.819 Vali Loss: 5.248 Vali Acc: 0.240 Test Loss: 5.248 Test Acc: 0.240
Validation loss decreased (inf --> -0.239948).  Saving model ...
Epoch: 2 cost time: 2.7623612880706787
Epoch: 2, Steps: 13 | Train Loss: 4.738 Vali Loss: 7.689 Vali Acc: 0.200 Test Loss: 7.689 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.205352544784546
Epoch: 3, Steps: 13 | Train Loss: 4.290 Vali Loss: 10.375 Vali Acc: 0.300 Test Loss: 10.375 Test Acc: 0.300
Validation loss decreased (-0.239948 --> -0.299896).  Saving model ...
Epoch: 4 cost time: 2.7162582874298096
Epoch: 4, Steps: 13 | Train Loss: 8.115 Vali Loss: 5.862 Vali Acc: 0.280 Test Loss: 5.862 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.787656545639038
Epoch: 5, Steps: 13 | Train Loss: 4.929 Vali Loss: 6.548 Vali Acc: 0.320 Test Loss: 6.548 Test Acc: 0.320
Validation loss decreased (-0.299896 --> -0.319935).  Saving model ...
Epoch: 6 cost time: 2.7064948081970215
Epoch: 6, Steps: 13 | Train Loss: 5.161 Vali Loss: 11.474 Vali Acc: 0.440 Test Loss: 11.474 Test Acc: 0.440
Validation loss decreased (-0.319935 --> -0.439885).  Saving model ...
Epoch: 7 cost time: 2.938594341278076
Epoch: 7, Steps: 13 | Train Loss: 6.154 Vali Loss: 12.086 Vali Acc: 0.280 Test Loss: 12.086 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.9084649085998535
Epoch: 8, Steps: 13 | Train Loss: 4.310 Vali Loss: 16.156 Vali Acc: 0.380 Test Loss: 16.156 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.8035500049591064
Epoch: 9, Steps: 13 | Train Loss: 9.779 Vali Loss: 19.497 Vali Acc: 0.320 Test Loss: 19.497 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.848625421524048
Epoch: 10, Steps: 13 | Train Loss: 7.271 Vali Loss: 12.825 Vali Acc: 0.380 Test Loss: 12.825 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.5633597373962402
Epoch: 11, Steps: 13 | Train Loss: 11.783 Vali Loss: 19.872 Vali Acc: 0.420 Test Loss: 19.872 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.595782995223999
Epoch: 12, Steps: 13 | Train Loss: 3.816 Vali Loss: 17.659 Vali Acc: 0.540 Test Loss: 17.659 Test Acc: 0.540
Validation loss decreased (-0.439885 --> -0.539823).  Saving model ...
Epoch: 13 cost time: 3.1284101009368896
Epoch: 13, Steps: 13 | Train Loss: 3.912 Vali Loss: 16.828 Vali Acc: 0.520 Test Loss: 16.828 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.802478551864624
Epoch: 14, Steps: 13 | Train Loss: 1.111 Vali Loss: 12.857 Vali Acc: 0.540 Test Loss: 12.857 Test Acc: 0.540
Validation loss decreased (-0.539823 --> -0.539871).  Saving model ...
Epoch: 15 cost time: 2.5350639820098877
Epoch: 15, Steps: 13 | Train Loss: 1.112 Vali Loss: 21.748 Vali Acc: 0.540 Test Loss: 21.748 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.893503427505493
Epoch: 16, Steps: 13 | Train Loss: 6.873 Vali Loss: 41.046 Vali Acc: 0.360 Test Loss: 41.046 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.0872690677642822
Epoch: 17, Steps: 13 | Train Loss: 5.763 Vali Loss: 27.251 Vali Acc: 0.420 Test Loss: 27.251 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.6607959270477295
Epoch: 18, Steps: 13 | Train Loss: 3.297 Vali Loss: 25.356 Vali Acc: 0.500 Test Loss: 25.356 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.5486326217651367
Epoch: 19, Steps: 13 | Train Loss: 3.765 Vali Loss: 17.420 Vali Acc: 0.460 Test Loss: 17.420 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.6092116832733154
Epoch: 20, Steps: 13 | Train Loss: 0.696 Vali Loss: 33.306 Vali Acc: 0.440 Test Loss: 33.306 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.6680638790130615
Epoch: 21, Steps: 13 | Train Loss: 4.974 Vali Loss: 22.505 Vali Acc: 0.480 Test Loss: 22.505 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.7860054969787598
Epoch: 22, Steps: 13 | Train Loss: 2.037 Vali Loss: 15.040 Vali Acc: 0.480 Test Loss: 15.040 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.757296562194824
Epoch: 23, Steps: 13 | Train Loss: 0.846 Vali Loss: 25.941 Vali Acc: 0.340 Test Loss: 25.941 Test Acc: 0.340
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.6027355194091797
Epoch: 24, Steps: 13 | Train Loss: 0.719 Vali Loss: 24.068 Vali Acc: 0.500 Test Loss: 24.068 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 2463925
model size : 10.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 8.092425107955933
Epoch: 1, Steps: 13 | Train Loss: 29.846 Vali Loss: 16.051 Vali Acc: 0.200 Test Loss: 16.051 Test Acc: 0.200
Validation loss decreased (inf --> -0.199839).  Saving model ...
Epoch: 2 cost time: 6.158396482467651
Epoch: 2, Steps: 13 | Train Loss: 52.145 Vali Loss: 45.842 Vali Acc: 0.400 Test Loss: 45.842 Test Acc: 0.400
Validation loss decreased (-0.199839 --> -0.399542).  Saving model ...
Epoch: 3 cost time: 6.276552200317383
Epoch: 3, Steps: 13 | Train Loss: 64.655 Vali Loss: 137.751 Vali Acc: 0.260 Test Loss: 137.751 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.064949035644531
Epoch: 4, Steps: 13 | Train Loss: 135.886 Vali Loss: 239.237 Vali Acc: 0.320 Test Loss: 239.237 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.044396638870239
Epoch: 5, Steps: 13 | Train Loss: 100.562 Vali Loss: 245.672 Vali Acc: 0.300 Test Loss: 245.672 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.929213523864746
Epoch: 6, Steps: 13 | Train Loss: 157.761 Vali Loss: 257.340 Vali Acc: 0.280 Test Loss: 257.340 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.0164759159088135
Epoch: 7, Steps: 13 | Train Loss: 157.431 Vali Loss: 217.408 Vali Acc: 0.520 Test Loss: 217.408 Test Acc: 0.520
Validation loss decreased (-0.399542 --> -0.517826).  Saving model ...
Epoch: 8 cost time: 6.2493438720703125
Epoch: 8, Steps: 13 | Train Loss: 84.123 Vali Loss: 240.104 Vali Acc: 0.380 Test Loss: 240.104 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.20119309425354
Epoch: 9, Steps: 13 | Train Loss: 82.614 Vali Loss: 219.159 Vali Acc: 0.500 Test Loss: 219.159 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.107857942581177
Epoch: 10, Steps: 13 | Train Loss: 45.801 Vali Loss: 120.124 Vali Acc: 0.520 Test Loss: 120.124 Test Acc: 0.520
Validation loss decreased (-0.517826 --> -0.518799).  Saving model ...
Epoch: 11 cost time: 6.0443949699401855
Epoch: 11, Steps: 13 | Train Loss: 41.752 Vali Loss: 176.441 Vali Acc: 0.380 Test Loss: 176.441 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.119222402572632
Epoch: 12, Steps: 13 | Train Loss: 13.236 Vali Loss: 236.687 Vali Acc: 0.560 Test Loss: 236.687 Test Acc: 0.560
Validation loss decreased (-0.518799 --> -0.557633).  Saving model ...
Epoch: 13 cost time: 6.004188776016235
Epoch: 13, Steps: 13 | Train Loss: 12.231 Vali Loss: 219.602 Vali Acc: 0.520 Test Loss: 219.602 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.297593355178833
Epoch: 14, Steps: 13 | Train Loss: 27.257 Vali Loss: 189.148 Vali Acc: 0.520 Test Loss: 189.148 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.319345474243164
Epoch: 15, Steps: 13 | Train Loss: 13.098 Vali Loss: 216.551 Vali Acc: 0.480 Test Loss: 216.551 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.323967456817627
Epoch: 16, Steps: 13 | Train Loss: 0.581 Vali Loss: 239.330 Vali Acc: 0.440 Test Loss: 239.330 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 6.612223386764526
Epoch: 17, Steps: 13 | Train Loss: 1.572 Vali Loss: 193.948 Vali Acc: 0.480 Test Loss: 193.948 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 6.247561693191528
Epoch: 18, Steps: 13 | Train Loss: 11.099 Vali Loss: 223.268 Vali Acc: 0.520 Test Loss: 223.268 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 6.572738409042358
Epoch: 19, Steps: 13 | Train Loss: 20.736 Vali Loss: 307.642 Vali Acc: 0.460 Test Loss: 307.642 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 6.371021509170532
Epoch: 20, Steps: 13 | Train Loss: 14.317 Vali Loss: 305.309 Vali Acc: 0.460 Test Loss: 305.309 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 6.6417858600616455
Epoch: 21, Steps: 13 | Train Loss: 6.277 Vali Loss: 155.981 Vali Acc: 0.540 Test Loss: 155.981 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 6.193872690200806
Epoch: 22, Steps: 13 | Train Loss: 29.524 Vali Loss: 263.965 Vali Acc: 0.420 Test Loss: 263.965 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 36533801
model size : 144.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 7.884748697280884
Epoch: 1, Steps: 13 | Train Loss: 41.259 Vali Loss: 58.246 Vali Acc: 0.200 Test Loss: 58.246 Test Acc: 0.200
Validation loss decreased (inf --> -0.199418).  Saving model ...
Epoch: 2 cost time: 5.973850250244141
Epoch: 2, Steps: 13 | Train Loss: 97.975 Vali Loss: 134.417 Vali Acc: 0.220 Test Loss: 134.417 Test Acc: 0.220
Validation loss decreased (-0.199418 --> -0.218656).  Saving model ...
Epoch: 3 cost time: 6.29837965965271
Epoch: 3, Steps: 13 | Train Loss: 99.692 Vali Loss: 144.582 Vali Acc: 0.200 Test Loss: 144.582 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.1046106815338135
Epoch: 4, Steps: 13 | Train Loss: 85.411 Vali Loss: 80.794 Vali Acc: 0.400 Test Loss: 80.794 Test Acc: 0.400
Validation loss decreased (-0.218656 --> -0.399192).  Saving model ...
Epoch: 5 cost time: 6.25004768371582
Epoch: 5, Steps: 13 | Train Loss: 79.763 Vali Loss: 183.060 Vali Acc: 0.400 Test Loss: 183.060 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.047403335571289
Epoch: 6, Steps: 13 | Train Loss: 102.316 Vali Loss: 196.244 Vali Acc: 0.320 Test Loss: 196.244 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.2838053703308105
Epoch: 7, Steps: 13 | Train Loss: 86.058 Vali Loss: 186.998 Vali Acc: 0.460 Test Loss: 186.998 Test Acc: 0.460
Validation loss decreased (-0.399192 --> -0.458130).  Saving model ...
Epoch: 8 cost time: 6.233889579772949
Epoch: 8, Steps: 13 | Train Loss: 75.639 Vali Loss: 232.981 Vali Acc: 0.400 Test Loss: 232.981 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.084798336029053
Epoch: 9, Steps: 13 | Train Loss: 51.607 Vali Loss: 150.000 Vali Acc: 0.460 Test Loss: 150.000 Test Acc: 0.460
Validation loss decreased (-0.458130 --> -0.458500).  Saving model ...
Epoch: 10 cost time: 6.382631778717041
Epoch: 10, Steps: 13 | Train Loss: 71.634 Vali Loss: 169.749 Vali Acc: 0.480 Test Loss: 169.749 Test Acc: 0.480
Validation loss decreased (-0.458500 --> -0.478303).  Saving model ...
Epoch: 11 cost time: 6.303239583969116
Epoch: 11, Steps: 13 | Train Loss: 23.283 Vali Loss: 126.983 Vali Acc: 0.520 Test Loss: 126.983 Test Acc: 0.520
Validation loss decreased (-0.478303 --> -0.518730).  Saving model ...
Epoch: 12 cost time: 6.003855228424072
Epoch: 12, Steps: 13 | Train Loss: 9.572 Vali Loss: 142.794 Vali Acc: 0.580 Test Loss: 142.794 Test Acc: 0.580
Validation loss decreased (-0.518730 --> -0.578572).  Saving model ...
Epoch: 13 cost time: 6.007356405258179
Epoch: 13, Steps: 13 | Train Loss: 10.056 Vali Loss: 266.826 Vali Acc: 0.280 Test Loss: 266.826 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.030151128768921
Epoch: 14, Steps: 13 | Train Loss: 22.597 Vali Loss: 164.660 Vali Acc: 0.420 Test Loss: 164.660 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.991936206817627
Epoch: 15, Steps: 13 | Train Loss: 14.108 Vali Loss: 175.361 Vali Acc: 0.480 Test Loss: 175.361 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.368381023406982
Epoch: 16, Steps: 13 | Train Loss: 1.364 Vali Loss: 166.420 Vali Acc: 0.460 Test Loss: 166.420 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 6.123815298080444
Epoch: 17, Steps: 13 | Train Loss: 5.624 Vali Loss: 129.644 Vali Acc: 0.520 Test Loss: 129.644 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 6.410219669342041
Epoch: 18, Steps: 13 | Train Loss: 0.873 Vali Loss: 169.423 Vali Acc: 0.480 Test Loss: 169.423 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 6.268039703369141
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 194.739 Vali Acc: 0.460 Test Loss: 194.739 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 5.955640554428101
Epoch: 20, Steps: 13 | Train Loss: 1.215 Vali Loss: 131.645 Vali Acc: 0.500 Test Loss: 131.645 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 6.106639862060547
Epoch: 21, Steps: 13 | Train Loss: 10.389 Vali Loss: 203.663 Vali Acc: 0.420 Test Loss: 203.663 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 5.9858787059783936
Epoch: 22, Steps: 13 | Train Loss: 38.325 Vali Loss: 169.956 Vali Acc: 0.540 Test Loss: 169.956 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 36524841
model size : 144.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 7.945633411407471
Epoch: 1, Steps: 13 | Train Loss: 37.817 Vali Loss: 76.110 Vali Acc: 0.220 Test Loss: 76.110 Test Acc: 0.220
Validation loss decreased (inf --> -0.219239).  Saving model ...
Epoch: 2 cost time: 5.8614842891693115
Epoch: 2, Steps: 13 | Train Loss: 82.046 Vali Loss: 58.209 Vali Acc: 0.360 Test Loss: 58.209 Test Acc: 0.360
Validation loss decreased (-0.219239 --> -0.359418).  Saving model ...
Epoch: 3 cost time: 5.945260763168335
Epoch: 3, Steps: 13 | Train Loss: 48.791 Vali Loss: 110.239 Vali Acc: 0.460 Test Loss: 110.239 Test Acc: 0.460
Validation loss decreased (-0.359418 --> -0.458898).  Saving model ...
Epoch: 4 cost time: 6.160828351974487
Epoch: 4, Steps: 13 | Train Loss: 62.687 Vali Loss: 82.292 Vali Acc: 0.480 Test Loss: 82.292 Test Acc: 0.480
Validation loss decreased (-0.458898 --> -0.479177).  Saving model ...
Epoch: 5 cost time: 6.0722496509552
Epoch: 5, Steps: 13 | Train Loss: 40.282 Vali Loss: 68.195 Vali Acc: 0.420 Test Loss: 68.195 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.006554365158081
Epoch: 6, Steps: 13 | Train Loss: 41.492 Vali Loss: 183.208 Vali Acc: 0.340 Test Loss: 183.208 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.009213447570801
Epoch: 7, Steps: 13 | Train Loss: 50.999 Vali Loss: 115.985 Vali Acc: 0.420 Test Loss: 115.985 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.094270944595337
Epoch: 8, Steps: 13 | Train Loss: 44.404 Vali Loss: 199.827 Vali Acc: 0.440 Test Loss: 199.827 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.410008907318115
Epoch: 9, Steps: 13 | Train Loss: 129.718 Vali Loss: 156.585 Vali Acc: 0.380 Test Loss: 156.585 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.950824022293091
Epoch: 10, Steps: 13 | Train Loss: 94.268 Vali Loss: 356.034 Vali Acc: 0.360 Test Loss: 356.034 Test Acc: 0.360
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 6.583570957183838
Epoch: 11, Steps: 13 | Train Loss: 96.521 Vali Loss: 201.386 Vali Acc: 0.440 Test Loss: 201.386 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 6.111226558685303
Epoch: 12, Steps: 13 | Train Loss: 66.476 Vali Loss: 321.045 Vali Acc: 0.460 Test Loss: 321.045 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 6.0359718799591064
Epoch: 13, Steps: 13 | Train Loss: 43.293 Vali Loss: 287.673 Vali Acc: 0.440 Test Loss: 287.673 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 5.936345338821411
Epoch: 14, Steps: 13 | Train Loss: 33.157 Vali Loss: 206.882 Vali Acc: 0.540 Test Loss: 206.882 Test Acc: 0.540
Validation loss decreased (-0.479177 --> -0.537931).  Saving model ...
Epoch: 15 cost time: 6.182620525360107
Epoch: 15, Steps: 13 | Train Loss: 15.598 Vali Loss: 452.470 Vali Acc: 0.340 Test Loss: 452.470 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.968602657318115
Epoch: 16, Steps: 13 | Train Loss: 36.075 Vali Loss: 223.492 Vali Acc: 0.480 Test Loss: 223.492 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.147916555404663
Epoch: 17, Steps: 13 | Train Loss: 14.689 Vali Loss: 242.639 Vali Acc: 0.480 Test Loss: 242.639 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 6.257126569747925
Epoch: 18, Steps: 13 | Train Loss: 15.657 Vali Loss: 158.273 Vali Acc: 0.540 Test Loss: 158.273 Test Acc: 0.540
Validation loss decreased (-0.537931 --> -0.538417).  Saving model ...
Epoch: 19 cost time: 5.912442922592163
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 197.964 Vali Acc: 0.520 Test Loss: 197.964 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.241974115371704
Epoch: 20, Steps: 13 | Train Loss: 5.299 Vali Loss: 165.446 Vali Acc: 0.560 Test Loss: 165.446 Test Acc: 0.560
Validation loss decreased (-0.538417 --> -0.558346).  Saving model ...
Epoch: 21 cost time: 5.950592994689941
Epoch: 21, Steps: 13 | Train Loss: 5.367 Vali Loss: 211.219 Vali Acc: 0.500 Test Loss: 211.219 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.178564548492432
Epoch: 22, Steps: 13 | Train Loss: 1.244 Vali Loss: 253.594 Vali Acc: 0.460 Test Loss: 253.594 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 6.064862012863159
Epoch: 23, Steps: 13 | Train Loss: 3.404 Vali Loss: 221.931 Vali Acc: 0.460 Test Loss: 221.931 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 6.189660549163818
Epoch: 24, Steps: 13 | Train Loss: 18.932 Vali Loss: 289.316 Vali Acc: 0.460 Test Loss: 289.316 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 6.082394361495972
Epoch: 25, Steps: 13 | Train Loss: 22.882 Vali Loss: 208.655 Vali Acc: 0.440 Test Loss: 208.655 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 6.057076692581177
Epoch: 26, Steps: 13 | Train Loss: 11.522 Vali Loss: 219.797 Vali Acc: 0.400 Test Loss: 219.797 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 6.149576902389526
Epoch: 27, Steps: 13 | Train Loss: 3.280 Vali Loss: 241.995 Vali Acc: 0.460 Test Loss: 241.995 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 6.074796438217163
Epoch: 28, Steps: 13 | Train Loss: 13.558 Vali Loss: 224.967 Vali Acc: 0.560 Test Loss: 224.967 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 6.190000295639038
Epoch: 29, Steps: 13 | Train Loss: 0.529 Vali Loss: 171.331 Vali Acc: 0.520 Test Loss: 171.331 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 6.016441583633423
Epoch: 30, Steps: 13 | Train Loss: 0.788 Vali Loss: 278.608 Vali Acc: 0.480 Test Loss: 278.608 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 36515881
model size : 144.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 7.979083061218262
Epoch: 1, Steps: 13 | Train Loss: 30.763 Vali Loss: 83.006 Vali Acc: 0.200 Test Loss: 83.006 Test Acc: 0.200
Validation loss decreased (inf --> -0.199170).  Saving model ...
Epoch: 2 cost time: 5.874532461166382
Epoch: 2, Steps: 13 | Train Loss: 72.374 Vali Loss: 91.595 Vali Acc: 0.260 Test Loss: 91.595 Test Acc: 0.260
Validation loss decreased (-0.199170 --> -0.259084).  Saving model ...
Epoch: 3 cost time: 5.860341787338257
Epoch: 3, Steps: 13 | Train Loss: 77.373 Vali Loss: 72.143 Vali Acc: 0.280 Test Loss: 72.143 Test Acc: 0.280
Validation loss decreased (-0.259084 --> -0.279279).  Saving model ...
Epoch: 4 cost time: 5.8199005126953125
Epoch: 4, Steps: 13 | Train Loss: 51.988 Vali Loss: 121.734 Vali Acc: 0.420 Test Loss: 121.734 Test Acc: 0.420
Validation loss decreased (-0.279279 --> -0.418783).  Saving model ...
Epoch: 5 cost time: 6.048524618148804
Epoch: 5, Steps: 13 | Train Loss: 84.553 Vali Loss: 151.901 Vali Acc: 0.340 Test Loss: 151.901 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.8033223152160645
Epoch: 6, Steps: 13 | Train Loss: 90.454 Vali Loss: 153.435 Vali Acc: 0.420 Test Loss: 153.435 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.698614835739136
Epoch: 7, Steps: 13 | Train Loss: 69.023 Vali Loss: 148.521 Vali Acc: 0.480 Test Loss: 148.521 Test Acc: 0.480
Validation loss decreased (-0.418783 --> -0.478515).  Saving model ...
Epoch: 8 cost time: 5.663064956665039
Epoch: 8, Steps: 13 | Train Loss: 57.690 Vali Loss: 194.944 Vali Acc: 0.420 Test Loss: 194.944 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.719094514846802
Epoch: 9, Steps: 13 | Train Loss: 40.753 Vali Loss: 224.436 Vali Acc: 0.500 Test Loss: 224.436 Test Acc: 0.500
Validation loss decreased (-0.478515 --> -0.497756).  Saving model ...
Epoch: 10 cost time: 5.788923263549805
Epoch: 10, Steps: 13 | Train Loss: 53.807 Vali Loss: 264.606 Vali Acc: 0.500 Test Loss: 264.606 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.947902679443359
Epoch: 11, Steps: 13 | Train Loss: 68.457 Vali Loss: 328.908 Vali Acc: 0.440 Test Loss: 328.908 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.807036638259888
Epoch: 12, Steps: 13 | Train Loss: 62.596 Vali Loss: 253.785 Vali Acc: 0.480 Test Loss: 253.785 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.87065052986145
Epoch: 13, Steps: 13 | Train Loss: 39.963 Vali Loss: 245.537 Vali Acc: 0.300 Test Loss: 245.537 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.8987016677856445
Epoch: 14, Steps: 13 | Train Loss: 25.866 Vali Loss: 207.435 Vali Acc: 0.420 Test Loss: 207.435 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 6.048957347869873
Epoch: 15, Steps: 13 | Train Loss: 58.616 Vali Loss: 231.144 Vali Acc: 0.360 Test Loss: 231.144 Test Acc: 0.360
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.735062837600708
Epoch: 16, Steps: 13 | Train Loss: 25.375 Vali Loss: 250.452 Vali Acc: 0.460 Test Loss: 250.452 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.900959014892578
Epoch: 17, Steps: 13 | Train Loss: 17.315 Vali Loss: 287.491 Vali Acc: 0.500 Test Loss: 287.491 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.753068208694458
Epoch: 18, Steps: 13 | Train Loss: 29.067 Vali Loss: 141.191 Vali Acc: 0.560 Test Loss: 141.191 Test Acc: 0.560
Validation loss decreased (-0.497756 --> -0.558588).  Saving model ...
Epoch: 19 cost time: 5.70986270904541
Epoch: 19, Steps: 13 | Train Loss: 9.099 Vali Loss: 164.382 Vali Acc: 0.600 Test Loss: 164.382 Test Acc: 0.600
Validation loss decreased (-0.558588 --> -0.598356).  Saving model ...
Epoch: 20 cost time: 5.6485466957092285
Epoch: 20, Steps: 13 | Train Loss: 2.358 Vali Loss: 228.278 Vali Acc: 0.460 Test Loss: 228.278 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.779601812362671
Epoch: 21, Steps: 13 | Train Loss: 17.411 Vali Loss: 183.746 Vali Acc: 0.580 Test Loss: 183.746 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.713499546051025
Epoch: 22, Steps: 13 | Train Loss: 13.019 Vali Loss: 404.992 Vali Acc: 0.500 Test Loss: 404.992 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 5.911585330963135
Epoch: 23, Steps: 13 | Train Loss: 31.103 Vali Loss: 256.405 Vali Acc: 0.540 Test Loss: 256.405 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 5.825411081314087
Epoch: 24, Steps: 13 | Train Loss: 7.700 Vali Loss: 314.003 Vali Acc: 0.560 Test Loss: 314.003 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 5.926614284515381
Epoch: 25, Steps: 13 | Train Loss: 0.780 Vali Loss: 251.436 Vali Acc: 0.540 Test Loss: 251.436 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 5.86166524887085
Epoch: 26, Steps: 13 | Train Loss: 4.743 Vali Loss: 410.027 Vali Acc: 0.400 Test Loss: 410.027 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 5.777535915374756
Epoch: 27, Steps: 13 | Train Loss: 24.314 Vali Loss: 344.135 Vali Acc: 0.520 Test Loss: 344.135 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 6.0528082847595215
Epoch: 28, Steps: 13 | Train Loss: 19.568 Vali Loss: 187.646 Vali Acc: 0.640 Test Loss: 187.646 Test Acc: 0.640
Validation loss decreased (-0.598356 --> -0.638124).  Saving model ...
Epoch: 29 cost time: 5.791582345962524
Epoch: 29, Steps: 13 | Train Loss: 5.220 Vali Loss: 245.277 Vali Acc: 0.540 Test Loss: 245.277 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 5.800755262374878
Epoch: 30, Steps: 13 | Train Loss: 1.162 Vali Loss: 387.713 Vali Acc: 0.540 Test Loss: 387.713 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 5.868252515792847
Epoch: 31, Steps: 13 | Train Loss: 6.780 Vali Loss: 259.962 Vali Acc: 0.620 Test Loss: 259.962 Test Acc: 0.620
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 5.740906476974487
Epoch: 32, Steps: 13 | Train Loss: 11.369 Vali Loss: 330.833 Vali Acc: 0.520 Test Loss: 330.833 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 5.89130711555481
Epoch: 33, Steps: 13 | Train Loss: 8.937 Vali Loss: 227.078 Vali Acc: 0.600 Test Loss: 227.078 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 5.700819969177246
Epoch: 34, Steps: 13 | Train Loss: 9.592 Vali Loss: 277.814 Vali Acc: 0.500 Test Loss: 277.814 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 5.784144878387451
Epoch: 35, Steps: 13 | Train Loss: 1.710 Vali Loss: 402.029 Vali Acc: 0.380 Test Loss: 402.029 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 6.047358512878418
Epoch: 36, Steps: 13 | Train Loss: 31.729 Vali Loss: 267.242 Vali Acc: 0.580 Test Loss: 267.242 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 6.052274227142334
Epoch: 37, Steps: 13 | Train Loss: 2.444 Vali Loss: 278.046 Vali Acc: 0.540 Test Loss: 278.046 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 5.797647714614868
Epoch: 38, Steps: 13 | Train Loss: 1.923 Vali Loss: 326.106 Vali Acc: 0.580 Test Loss: 326.106 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.64
model parameter : 36506921
model size : 144.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 7.836487054824829
Epoch: 1, Steps: 13 | Train Loss: 26.972 Vali Loss: 48.121 Vali Acc: 0.220 Test Loss: 48.121 Test Acc: 0.220
Validation loss decreased (inf --> -0.219519).  Saving model ...
Epoch: 2 cost time: 5.930449724197388
Epoch: 2, Steps: 13 | Train Loss: 50.918 Vali Loss: 88.559 Vali Acc: 0.380 Test Loss: 88.559 Test Acc: 0.380
Validation loss decreased (-0.219519 --> -0.379114).  Saving model ...
Epoch: 3 cost time: 5.4960246086120605
Epoch: 3, Steps: 13 | Train Loss: 99.852 Vali Loss: 90.738 Vali Acc: 0.280 Test Loss: 90.738 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.537889719009399
Epoch: 4, Steps: 13 | Train Loss: 51.889 Vali Loss: 92.107 Vali Acc: 0.360 Test Loss: 92.107 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.546917200088501
Epoch: 5, Steps: 13 | Train Loss: 61.922 Vali Loss: 89.686 Vali Acc: 0.360 Test Loss: 89.686 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.475151538848877
Epoch: 6, Steps: 13 | Train Loss: 43.896 Vali Loss: 127.446 Vali Acc: 0.500 Test Loss: 127.446 Test Acc: 0.500
Validation loss decreased (-0.379114 --> -0.498726).  Saving model ...
Epoch: 7 cost time: 5.525176048278809
Epoch: 7, Steps: 13 | Train Loss: 55.607 Vali Loss: 181.896 Vali Acc: 0.420 Test Loss: 181.896 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.536388397216797
Epoch: 8, Steps: 13 | Train Loss: 42.696 Vali Loss: 119.983 Vali Acc: 0.520 Test Loss: 119.983 Test Acc: 0.520
Validation loss decreased (-0.498726 --> -0.518800).  Saving model ...
Epoch: 9 cost time: 5.585697650909424
Epoch: 9, Steps: 13 | Train Loss: 41.068 Vali Loss: 83.295 Vali Acc: 0.520 Test Loss: 83.295 Test Acc: 0.520
Validation loss decreased (-0.518800 --> -0.519167).  Saving model ...
Epoch: 10 cost time: 5.833963871002197
Epoch: 10, Steps: 13 | Train Loss: 39.473 Vali Loss: 241.663 Vali Acc: 0.440 Test Loss: 241.663 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.68782901763916
Epoch: 11, Steps: 13 | Train Loss: 60.390 Vali Loss: 165.131 Vali Acc: 0.500 Test Loss: 165.131 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.481089115142822
Epoch: 12, Steps: 13 | Train Loss: 26.028 Vali Loss: 139.146 Vali Acc: 0.540 Test Loss: 139.146 Test Acc: 0.540
Validation loss decreased (-0.519167 --> -0.538609).  Saving model ...
Epoch: 13 cost time: 5.588818073272705
Epoch: 13, Steps: 13 | Train Loss: 23.464 Vali Loss: 357.811 Vali Acc: 0.480 Test Loss: 357.811 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.5742270946502686
Epoch: 14, Steps: 13 | Train Loss: 54.476 Vali Loss: 173.087 Vali Acc: 0.480 Test Loss: 173.087 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.490522861480713
Epoch: 15, Steps: 13 | Train Loss: 40.229 Vali Loss: 123.946 Vali Acc: 0.580 Test Loss: 123.946 Test Acc: 0.580
Validation loss decreased (-0.538609 --> -0.578761).  Saving model ...
Epoch: 16 cost time: 5.664999723434448
Epoch: 16, Steps: 13 | Train Loss: 20.089 Vali Loss: 150.301 Vali Acc: 0.540 Test Loss: 150.301 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.859278202056885
Epoch: 17, Steps: 13 | Train Loss: 8.507 Vali Loss: 262.355 Vali Acc: 0.520 Test Loss: 262.355 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.482752084732056
Epoch: 18, Steps: 13 | Train Loss: 26.604 Vali Loss: 253.528 Vali Acc: 0.480 Test Loss: 253.528 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.591181516647339
Epoch: 19, Steps: 13 | Train Loss: 19.065 Vali Loss: 221.180 Vali Acc: 0.540 Test Loss: 221.180 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 5.41845178604126
Epoch: 20, Steps: 13 | Train Loss: 7.141 Vali Loss: 244.269 Vali Acc: 0.460 Test Loss: 244.269 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 5.3083319664001465
Epoch: 21, Steps: 13 | Train Loss: 15.972 Vali Loss: 198.997 Vali Acc: 0.580 Test Loss: 198.997 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 5.587207078933716
Epoch: 22, Steps: 13 | Train Loss: 3.135 Vali Loss: 251.287 Vali Acc: 0.520 Test Loss: 251.287 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 5.55646014213562
Epoch: 23, Steps: 13 | Train Loss: 2.978 Vali Loss: 294.616 Vali Acc: 0.600 Test Loss: 294.616 Test Acc: 0.600
Validation loss decreased (-0.578761 --> -0.597054).  Saving model ...
Epoch: 24 cost time: 5.466032981872559
Epoch: 24, Steps: 13 | Train Loss: 10.124 Vali Loss: 265.546 Vali Acc: 0.540 Test Loss: 265.546 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 5.891673564910889
Epoch: 25, Steps: 13 | Train Loss: 14.209 Vali Loss: 201.733 Vali Acc: 0.480 Test Loss: 201.733 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 5.6407670974731445
Epoch: 26, Steps: 13 | Train Loss: 8.696 Vali Loss: 304.987 Vali Acc: 0.360 Test Loss: 304.987 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 5.402823448181152
Epoch: 27, Steps: 13 | Train Loss: 2.099 Vali Loss: 179.639 Vali Acc: 0.500 Test Loss: 179.639 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 5.738255977630615
Epoch: 28, Steps: 13 | Train Loss: 11.370 Vali Loss: 424.254 Vali Acc: 0.420 Test Loss: 424.254 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 5.686589479446411
Epoch: 29, Steps: 13 | Train Loss: 10.272 Vali Loss: 225.356 Vali Acc: 0.520 Test Loss: 225.356 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 5.626359939575195
Epoch: 30, Steps: 13 | Train Loss: 27.684 Vali Loss: 283.649 Vali Acc: 0.520 Test Loss: 283.649 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 5.759400367736816
Epoch: 31, Steps: 13 | Train Loss: 141.159 Vali Loss: 318.729 Vali Acc: 0.380 Test Loss: 318.729 Test Acc: 0.380
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 5.512201547622681
Epoch: 32, Steps: 13 | Train Loss: 5.734 Vali Loss: 282.522 Vali Acc: 0.480 Test Loss: 282.522 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 6.090364933013916
Epoch: 33, Steps: 13 | Train Loss: 6.760 Vali Loss: 439.958 Vali Acc: 0.440 Test Loss: 439.958 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 35220521
model size : 139.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 7.67118763923645
Epoch: 1, Steps: 13 | Train Loss: 20.949 Vali Loss: 34.221 Vali Acc: 0.200 Test Loss: 34.221 Test Acc: 0.200
Validation loss decreased (inf --> -0.199658).  Saving model ...
Epoch: 2 cost time: 5.41310453414917
Epoch: 2, Steps: 13 | Train Loss: 65.567 Vali Loss: 129.901 Vali Acc: 0.180 Test Loss: 129.901 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.396634340286255
Epoch: 3, Steps: 13 | Train Loss: 119.839 Vali Loss: 91.861 Vali Acc: 0.240 Test Loss: 91.861 Test Acc: 0.240
Validation loss decreased (-0.199658 --> -0.239081).  Saving model ...
Epoch: 4 cost time: 5.430585622787476
Epoch: 4, Steps: 13 | Train Loss: 135.833 Vali Loss: 153.127 Vali Acc: 0.240 Test Loss: 153.127 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.764744758605957
Epoch: 5, Steps: 13 | Train Loss: 104.850 Vali Loss: 177.720 Vali Acc: 0.260 Test Loss: 177.720 Test Acc: 0.260
Validation loss decreased (-0.239081 --> -0.258223).  Saving model ...
Epoch: 6 cost time: 5.50091028213501
Epoch: 6, Steps: 13 | Train Loss: 86.232 Vali Loss: 95.374 Vali Acc: 0.520 Test Loss: 95.374 Test Acc: 0.520
Validation loss decreased (-0.258223 --> -0.519046).  Saving model ...
Epoch: 7 cost time: 5.356249809265137
Epoch: 7, Steps: 13 | Train Loss: 48.894 Vali Loss: 141.315 Vali Acc: 0.380 Test Loss: 141.315 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.4192540645599365
Epoch: 8, Steps: 13 | Train Loss: 38.610 Vali Loss: 127.880 Vali Acc: 0.420 Test Loss: 127.880 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.713800668716431
Epoch: 9, Steps: 13 | Train Loss: 26.837 Vali Loss: 267.277 Vali Acc: 0.440 Test Loss: 267.277 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.310670852661133
Epoch: 10, Steps: 13 | Train Loss: 64.360 Vali Loss: 132.407 Vali Acc: 0.520 Test Loss: 132.407 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.547749042510986
Epoch: 11, Steps: 13 | Train Loss: 40.254 Vali Loss: 211.370 Vali Acc: 0.300 Test Loss: 211.370 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.262917518615723
Epoch: 12, Steps: 13 | Train Loss: 48.295 Vali Loss: 170.669 Vali Acc: 0.540 Test Loss: 170.669 Test Acc: 0.540
Validation loss decreased (-0.519046 --> -0.538293).  Saving model ...
Epoch: 13 cost time: 5.3792033195495605
Epoch: 13, Steps: 13 | Train Loss: 16.186 Vali Loss: 212.939 Vali Acc: 0.480 Test Loss: 212.939 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.348623991012573
Epoch: 14, Steps: 13 | Train Loss: 14.791 Vali Loss: 156.113 Vali Acc: 0.520 Test Loss: 156.113 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.366809129714966
Epoch: 15, Steps: 13 | Train Loss: 22.324 Vali Loss: 123.065 Vali Acc: 0.480 Test Loss: 123.065 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.537665367126465
Epoch: 16, Steps: 13 | Train Loss: 9.315 Vali Loss: 313.913 Vali Acc: 0.420 Test Loss: 313.913 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.520582437515259
Epoch: 17, Steps: 13 | Train Loss: 37.218 Vali Loss: 189.475 Vali Acc: 0.360 Test Loss: 189.475 Test Acc: 0.360
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.64778470993042
Epoch: 18, Steps: 13 | Train Loss: 15.254 Vali Loss: 152.108 Vali Acc: 0.560 Test Loss: 152.108 Test Acc: 0.560
Validation loss decreased (-0.538293 --> -0.558479).  Saving model ...
Epoch: 19 cost time: 5.556670427322388
Epoch: 19, Steps: 13 | Train Loss: 15.566 Vali Loss: 187.342 Vali Acc: 0.500 Test Loss: 187.342 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.594274044036865
Epoch: 20, Steps: 13 | Train Loss: 2.430 Vali Loss: 107.440 Vali Acc: 0.560 Test Loss: 107.440 Test Acc: 0.560
Validation loss decreased (-0.558479 --> -0.558926).  Saving model ...
Epoch: 21 cost time: 5.507817029953003
Epoch: 21, Steps: 13 | Train Loss: 0.294 Vali Loss: 96.817 Vali Acc: 0.600 Test Loss: 96.817 Test Acc: 0.600
Validation loss decreased (-0.558926 --> -0.599032).  Saving model ...
Epoch: 22 cost time: 5.586825609207153
Epoch: 22, Steps: 13 | Train Loss: 10.999 Vali Loss: 149.365 Vali Acc: 0.580 Test Loss: 149.365 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.376481056213379
Epoch: 23, Steps: 13 | Train Loss: 2.045 Vali Loss: 187.510 Vali Acc: 0.540 Test Loss: 187.510 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 5.459693908691406
Epoch: 24, Steps: 13 | Train Loss: 4.135 Vali Loss: 138.635 Vali Acc: 0.560 Test Loss: 138.635 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 5.246110200881958
Epoch: 25, Steps: 13 | Train Loss: 0.000 Vali Loss: 127.122 Vali Acc: 0.540 Test Loss: 127.122 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 5.526038646697998
Epoch: 26, Steps: 13 | Train Loss: 0.000 Vali Loss: 129.585 Vali Acc: 0.560 Test Loss: 129.585 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 5.579483985900879
Epoch: 27, Steps: 13 | Train Loss: 0.000 Vali Loss: 131.173 Vali Acc: 0.560 Test Loss: 131.173 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 5.481013059616089
Epoch: 28, Steps: 13 | Train Loss: 0.000 Vali Loss: 131.589 Vali Acc: 0.580 Test Loss: 131.589 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 5.39813756942749
Epoch: 29, Steps: 13 | Train Loss: 0.000 Vali Loss: 131.698 Vali Acc: 0.580 Test Loss: 131.698 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 5.424222946166992
Epoch: 30, Steps: 13 | Train Loss: 0.000 Vali Loss: 131.727 Vali Acc: 0.580 Test Loss: 131.727 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 5.625933885574341
Epoch: 31, Steps: 13 | Train Loss: 0.000 Vali Loss: 131.735 Vali Acc: 0.580 Test Loss: 131.735 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 35211561
model size : 139.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 8.686515092849731
Epoch: 1, Steps: 13 | Train Loss: 40.670 Vali Loss: 71.707 Vali Acc: 0.220 Test Loss: 71.707 Test Acc: 0.220
Validation loss decreased (inf --> -0.219283).  Saving model ...
Epoch: 2 cost time: 5.92570686340332
Epoch: 2, Steps: 13 | Train Loss: 53.842 Vali Loss: 73.439 Vali Acc: 0.200 Test Loss: 73.439 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.695462226867676
Epoch: 3, Steps: 13 | Train Loss: 63.240 Vali Loss: 193.671 Vali Acc: 0.260 Test Loss: 193.671 Test Acc: 0.260
Validation loss decreased (-0.219283 --> -0.258063).  Saving model ...
Epoch: 4 cost time: 5.6355860233306885
Epoch: 4, Steps: 13 | Train Loss: 87.331 Vali Loss: 144.402 Vali Acc: 0.300 Test Loss: 144.402 Test Acc: 0.300
Validation loss decreased (-0.258063 --> -0.298556).  Saving model ...
Epoch: 5 cost time: 5.839884996414185
Epoch: 5, Steps: 13 | Train Loss: 101.578 Vali Loss: 195.914 Vali Acc: 0.360 Test Loss: 195.914 Test Acc: 0.360
Validation loss decreased (-0.298556 --> -0.358041).  Saving model ...
Epoch: 6 cost time: 5.6158318519592285
Epoch: 6, Steps: 13 | Train Loss: 130.227 Vali Loss: 250.669 Vali Acc: 0.220 Test Loss: 250.669 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.634497404098511
Epoch: 7, Steps: 13 | Train Loss: 67.618 Vali Loss: 196.350 Vali Acc: 0.420 Test Loss: 196.350 Test Acc: 0.420
Validation loss decreased (-0.358041 --> -0.418036).  Saving model ...
Epoch: 8 cost time: 5.312352657318115
Epoch: 8, Steps: 13 | Train Loss: 67.631 Vali Loss: 202.246 Vali Acc: 0.420 Test Loss: 202.246 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.621422290802002
Epoch: 9, Steps: 13 | Train Loss: 64.820 Vali Loss: 261.457 Vali Acc: 0.460 Test Loss: 261.457 Test Acc: 0.460
Validation loss decreased (-0.418036 --> -0.457385).  Saving model ...
Epoch: 10 cost time: 5.75669264793396
Epoch: 10, Steps: 13 | Train Loss: 105.435 Vali Loss: 237.665 Vali Acc: 0.380 Test Loss: 237.665 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.0170252323150635
Epoch: 11, Steps: 13 | Train Loss: 92.145 Vali Loss: 219.263 Vali Acc: 0.460 Test Loss: 219.263 Test Acc: 0.460
Validation loss decreased (-0.457385 --> -0.457807).  Saving model ...
Epoch: 12 cost time: 5.712404012680054
Epoch: 12, Steps: 13 | Train Loss: 60.441 Vali Loss: 314.523 Vali Acc: 0.400 Test Loss: 314.523 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.738591432571411
Epoch: 13, Steps: 13 | Train Loss: 64.770 Vali Loss: 153.947 Vali Acc: 0.460 Test Loss: 153.947 Test Acc: 0.460
Validation loss decreased (-0.457807 --> -0.458461).  Saving model ...
Epoch: 14 cost time: 5.629919528961182
Epoch: 14, Steps: 13 | Train Loss: 28.283 Vali Loss: 132.548 Vali Acc: 0.460 Test Loss: 132.548 Test Acc: 0.460
Validation loss decreased (-0.458461 --> -0.458675).  Saving model ...
Epoch: 15 cost time: 5.611342668533325
Epoch: 15, Steps: 13 | Train Loss: 1.551 Vali Loss: 171.046 Vali Acc: 0.420 Test Loss: 171.046 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.771413087844849
Epoch: 16, Steps: 13 | Train Loss: 13.844 Vali Loss: 109.290 Vali Acc: 0.540 Test Loss: 109.290 Test Acc: 0.540
Validation loss decreased (-0.458675 --> -0.538907).  Saving model ...
Epoch: 17 cost time: 5.398813486099243
Epoch: 17, Steps: 13 | Train Loss: 3.940 Vali Loss: 213.644 Vali Acc: 0.480 Test Loss: 213.644 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.9491026401519775
Epoch: 18, Steps: 13 | Train Loss: 16.550 Vali Loss: 194.462 Vali Acc: 0.540 Test Loss: 194.462 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.74762225151062
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 177.779 Vali Acc: 0.600 Test Loss: 177.779 Test Acc: 0.600
Validation loss decreased (-0.538907 --> -0.598222).  Saving model ...
Epoch: 20 cost time: 5.595197439193726
Epoch: 20, Steps: 13 | Train Loss: 6.149 Vali Loss: 183.992 Vali Acc: 0.580 Test Loss: 183.992 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.54355525970459
Epoch: 21, Steps: 13 | Train Loss: 19.163 Vali Loss: 163.557 Vali Acc: 0.560 Test Loss: 163.557 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.554136514663696
Epoch: 22, Steps: 13 | Train Loss: 1.086 Vali Loss: 259.716 Vali Acc: 0.480 Test Loss: 259.716 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 5.655789613723755
Epoch: 23, Steps: 13 | Train Loss: 11.268 Vali Loss: 161.537 Vali Acc: 0.540 Test Loss: 161.537 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 5.490899562835693
Epoch: 24, Steps: 13 | Train Loss: 9.177 Vali Loss: 143.663 Vali Acc: 0.620 Test Loss: 143.663 Test Acc: 0.620
Validation loss decreased (-0.598222 --> -0.618563).  Saving model ...
Epoch: 25 cost time: 5.695271968841553
Epoch: 25, Steps: 13 | Train Loss: 0.000 Vali Loss: 167.876 Vali Acc: 0.520 Test Loss: 167.876 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.533381223678589
Epoch: 26, Steps: 13 | Train Loss: 1.118 Vali Loss: 196.984 Vali Acc: 0.540 Test Loss: 196.984 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 5.599771738052368
Epoch: 27, Steps: 13 | Train Loss: 4.527 Vali Loss: 194.359 Vali Acc: 0.580 Test Loss: 194.359 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 5.8302154541015625
Epoch: 28, Steps: 13 | Train Loss: 6.358 Vali Loss: 202.441 Vali Acc: 0.580 Test Loss: 202.441 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 5.891590118408203
Epoch: 29, Steps: 13 | Train Loss: 1.141 Vali Loss: 234.278 Vali Acc: 0.460 Test Loss: 234.278 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 5.978714942932129
Epoch: 30, Steps: 13 | Train Loss: 6.677 Vali Loss: 178.109 Vali Acc: 0.580 Test Loss: 178.109 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 5.530947923660278
Epoch: 31, Steps: 13 | Train Loss: 16.630 Vali Loss: 194.024 Vali Acc: 0.520 Test Loss: 194.024 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 5.970789909362793
Epoch: 32, Steps: 13 | Train Loss: 4.802 Vali Loss: 156.933 Vali Acc: 0.580 Test Loss: 156.933 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 5.658339262008667
Epoch: 33, Steps: 13 | Train Loss: 16.059 Vali Loss: 183.690 Vali Acc: 0.500 Test Loss: 183.690 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 5.459551095962524
Epoch: 34, Steps: 13 | Train Loss: 0.000 Vali Loss: 211.200 Vali Acc: 0.500 Test Loss: 211.200 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 35202601
model size : 139.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 7.069486618041992
Epoch: 1, Steps: 13 | Train Loss: 29.481 Vali Loss: 51.678 Vali Acc: 0.240 Test Loss: 51.678 Test Acc: 0.240
Validation loss decreased (inf --> -0.239483).  Saving model ...
Epoch: 2 cost time: 5.334296226501465
Epoch: 2, Steps: 13 | Train Loss: 49.109 Vali Loss: 68.368 Vali Acc: 0.260 Test Loss: 68.368 Test Acc: 0.260
Validation loss decreased (-0.239483 --> -0.259316).  Saving model ...
Epoch: 3 cost time: 5.427815198898315
Epoch: 3, Steps: 13 | Train Loss: 34.639 Vali Loss: 61.116 Vali Acc: 0.300 Test Loss: 61.116 Test Acc: 0.300
Validation loss decreased (-0.259316 --> -0.299389).  Saving model ...
Epoch: 4 cost time: 5.449169397354126
Epoch: 4, Steps: 13 | Train Loss: 51.395 Vali Loss: 118.365 Vali Acc: 0.280 Test Loss: 118.365 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.644706726074219
Epoch: 5, Steps: 13 | Train Loss: 87.565 Vali Loss: 148.099 Vali Acc: 0.300 Test Loss: 148.099 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.684046506881714
Epoch: 6, Steps: 13 | Train Loss: 71.649 Vali Loss: 132.699 Vali Acc: 0.380 Test Loss: 132.699 Test Acc: 0.380
Validation loss decreased (-0.299389 --> -0.378673).  Saving model ...
Epoch: 7 cost time: 5.465778827667236
Epoch: 7, Steps: 13 | Train Loss: 52.095 Vali Loss: 122.595 Vali Acc: 0.500 Test Loss: 122.595 Test Acc: 0.500
Validation loss decreased (-0.378673 --> -0.498774).  Saving model ...
Epoch: 8 cost time: 5.526196479797363
Epoch: 8, Steps: 13 | Train Loss: 80.423 Vali Loss: 167.113 Vali Acc: 0.400 Test Loss: 167.113 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.478471279144287
Epoch: 9, Steps: 13 | Train Loss: 49.465 Vali Loss: 155.059 Vali Acc: 0.540 Test Loss: 155.059 Test Acc: 0.540
Validation loss decreased (-0.498774 --> -0.538449).  Saving model ...
Epoch: 10 cost time: 5.440262794494629
Epoch: 10, Steps: 13 | Train Loss: 83.434 Vali Loss: 138.137 Vali Acc: 0.520 Test Loss: 138.137 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.351064443588257
Epoch: 11, Steps: 13 | Train Loss: 103.267 Vali Loss: 177.996 Vali Acc: 0.340 Test Loss: 177.996 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.585639953613281
Epoch: 12, Steps: 13 | Train Loss: 28.157 Vali Loss: 167.985 Vali Acc: 0.520 Test Loss: 167.985 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.444440126419067
Epoch: 13, Steps: 13 | Train Loss: 4.916 Vali Loss: 233.699 Vali Acc: 0.500 Test Loss: 233.699 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.319570541381836
Epoch: 14, Steps: 13 | Train Loss: 30.123 Vali Loss: 303.548 Vali Acc: 0.520 Test Loss: 303.548 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.472844839096069
Epoch: 15, Steps: 13 | Train Loss: 67.258 Vali Loss: 311.844 Vali Acc: 0.360 Test Loss: 311.844 Test Acc: 0.360
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.27718186378479
Epoch: 16, Steps: 13 | Train Loss: 66.390 Vali Loss: 229.727 Vali Acc: 0.540 Test Loss: 229.727 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.4901299476623535
Epoch: 17, Steps: 13 | Train Loss: 14.796 Vali Loss: 208.106 Vali Acc: 0.500 Test Loss: 208.106 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.494688272476196
Epoch: 18, Steps: 13 | Train Loss: 14.933 Vali Loss: 144.496 Vali Acc: 0.620 Test Loss: 144.496 Test Acc: 0.620
Validation loss decreased (-0.538449 --> -0.618555).  Saving model ...
Epoch: 19 cost time: 5.868266582489014
Epoch: 19, Steps: 13 | Train Loss: 13.933 Vali Loss: 196.720 Vali Acc: 0.620 Test Loss: 196.720 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.492778539657593
Epoch: 20, Steps: 13 | Train Loss: 0.498 Vali Loss: 199.226 Vali Acc: 0.620 Test Loss: 199.226 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.656514406204224
Epoch: 21, Steps: 13 | Train Loss: 0.000 Vali Loss: 203.121 Vali Acc: 0.600 Test Loss: 203.121 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 5.534837245941162
Epoch: 22, Steps: 13 | Train Loss: 0.000 Vali Loss: 210.800 Vali Acc: 0.600 Test Loss: 210.800 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 5.742469787597656
Epoch: 23, Steps: 13 | Train Loss: 0.000 Vali Loss: 212.718 Vali Acc: 0.580 Test Loss: 212.718 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 5.598388910293579
Epoch: 24, Steps: 13 | Train Loss: 0.000 Vali Loss: 213.333 Vali Acc: 0.580 Test Loss: 213.333 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 5.654698133468628
Epoch: 25, Steps: 13 | Train Loss: 0.000 Vali Loss: 213.516 Vali Acc: 0.560 Test Loss: 213.516 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 6.012732028961182
Epoch: 26, Steps: 13 | Train Loss: 0.000 Vali Loss: 213.566 Vali Acc: 0.560 Test Loss: 213.566 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 5.444419622421265
Epoch: 27, Steps: 13 | Train Loss: 0.000 Vali Loss: 213.580 Vali Acc: 0.560 Test Loss: 213.580 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 5.532973051071167
Epoch: 28, Steps: 13 | Train Loss: 0.000 Vali Loss: 213.583 Vali Acc: 0.560 Test Loss: 213.583 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 35193641
model size : 139.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 7.612874746322632
Epoch: 1, Steps: 13 | Train Loss: 34.345 Vali Loss: 57.594 Vali Acc: 0.200 Test Loss: 57.594 Test Acc: 0.200
Validation loss decreased (inf --> -0.199424).  Saving model ...
Epoch: 2 cost time: 5.466843605041504
Epoch: 2, Steps: 13 | Train Loss: 50.149 Vali Loss: 66.198 Vali Acc: 0.340 Test Loss: 66.198 Test Acc: 0.340
Validation loss decreased (-0.199424 --> -0.339338).  Saving model ...
Epoch: 3 cost time: 5.367177724838257
Epoch: 3, Steps: 13 | Train Loss: 127.516 Vali Loss: 84.225 Vali Acc: 0.360 Test Loss: 84.225 Test Acc: 0.360
Validation loss decreased (-0.339338 --> -0.359158).  Saving model ...
Epoch: 4 cost time: 5.779481649398804
Epoch: 4, Steps: 13 | Train Loss: 188.196 Vali Loss: 238.960 Vali Acc: 0.300 Test Loss: 238.960 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.53615927696228
Epoch: 5, Steps: 13 | Train Loss: 164.206 Vali Loss: 197.753 Vali Acc: 0.400 Test Loss: 197.753 Test Acc: 0.400
Validation loss decreased (-0.359158 --> -0.398022).  Saving model ...
Epoch: 6 cost time: 5.572916030883789
Epoch: 6, Steps: 13 | Train Loss: 110.701 Vali Loss: 283.511 Vali Acc: 0.340 Test Loss: 283.511 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.317751884460449
Epoch: 7, Steps: 13 | Train Loss: 116.262 Vali Loss: 337.776 Vali Acc: 0.340 Test Loss: 337.776 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.167750120162964
Epoch: 8, Steps: 13 | Train Loss: 141.828 Vali Loss: 225.427 Vali Acc: 0.420 Test Loss: 225.427 Test Acc: 0.420
Validation loss decreased (-0.398022 --> -0.417746).  Saving model ...
Epoch: 9 cost time: 5.427350282669067
Epoch: 9, Steps: 13 | Train Loss: 69.244 Vali Loss: 217.704 Vali Acc: 0.440 Test Loss: 217.704 Test Acc: 0.440
Validation loss decreased (-0.417746 --> -0.437823).  Saving model ...
Epoch: 10 cost time: 5.450466156005859
Epoch: 10, Steps: 13 | Train Loss: 70.782 Vali Loss: 231.645 Vali Acc: 0.480 Test Loss: 231.645 Test Acc: 0.480
Validation loss decreased (-0.437823 --> -0.477684).  Saving model ...
Epoch: 11 cost time: 5.511869430541992
Epoch: 11, Steps: 13 | Train Loss: 32.780 Vali Loss: 266.990 Vali Acc: 0.400 Test Loss: 266.990 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.2884697914123535
Epoch: 12, Steps: 13 | Train Loss: 55.949 Vali Loss: 372.280 Vali Acc: 0.460 Test Loss: 372.280 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.176542043685913
Epoch: 13, Steps: 13 | Train Loss: 67.085 Vali Loss: 289.631 Vali Acc: 0.460 Test Loss: 289.631 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.43263578414917
Epoch: 14, Steps: 13 | Train Loss: 19.663 Vali Loss: 171.049 Vali Acc: 0.580 Test Loss: 171.049 Test Acc: 0.580
Validation loss decreased (-0.477684 --> -0.578290).  Saving model ...
Epoch: 15 cost time: 5.288049936294556
Epoch: 15, Steps: 13 | Train Loss: 8.462 Vali Loss: 200.576 Vali Acc: 0.480 Test Loss: 200.576 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.337347507476807
Epoch: 16, Steps: 13 | Train Loss: 14.423 Vali Loss: 267.287 Vali Acc: 0.440 Test Loss: 267.287 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.148667335510254
Epoch: 17, Steps: 13 | Train Loss: 14.798 Vali Loss: 182.485 Vali Acc: 0.460 Test Loss: 182.485 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.451488256454468
Epoch: 18, Steps: 13 | Train Loss: 16.923 Vali Loss: 368.484 Vali Acc: 0.420 Test Loss: 368.484 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 5.422984838485718
Epoch: 19, Steps: 13 | Train Loss: 29.247 Vali Loss: 318.582 Vali Acc: 0.460 Test Loss: 318.582 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 5.1711437702178955
Epoch: 20, Steps: 13 | Train Loss: 0.002 Vali Loss: 362.361 Vali Acc: 0.460 Test Loss: 362.361 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 5.337846279144287
Epoch: 21, Steps: 13 | Train Loss: 9.666 Vali Loss: 268.419 Vali Acc: 0.540 Test Loss: 268.419 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 5.583042144775391
Epoch: 22, Steps: 13 | Train Loss: 9.520 Vali Loss: 326.208 Vali Acc: 0.460 Test Loss: 326.208 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 5.257471799850464
Epoch: 23, Steps: 13 | Train Loss: 11.599 Vali Loss: 134.588 Vali Acc: 0.620 Test Loss: 134.588 Test Acc: 0.620
Validation loss decreased (-0.578290 --> -0.618654).  Saving model ...
Epoch: 24 cost time: 5.511225700378418
Epoch: 24, Steps: 13 | Train Loss: 0.000 Vali Loss: 223.626 Vali Acc: 0.480 Test Loss: 223.626 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 5.460237503051758
Epoch: 25, Steps: 13 | Train Loss: 9.243 Vali Loss: 216.285 Vali Acc: 0.560 Test Loss: 216.285 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 5.722650051116943
Epoch: 26, Steps: 13 | Train Loss: 35.537 Vali Loss: 228.277 Vali Acc: 0.640 Test Loss: 228.277 Test Acc: 0.640
Validation loss decreased (-0.618654 --> -0.637717).  Saving model ...
Epoch: 27 cost time: 5.758666515350342
Epoch: 27, Steps: 13 | Train Loss: 25.483 Vali Loss: 219.524 Vali Acc: 0.500 Test Loss: 219.524 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 5.571758031845093
Epoch: 28, Steps: 13 | Train Loss: 11.499 Vali Loss: 310.025 Vali Acc: 0.440 Test Loss: 310.025 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 5.253227233886719
Epoch: 29, Steps: 13 | Train Loss: 4.448 Vali Loss: 273.570 Vali Acc: 0.440 Test Loss: 273.570 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 5.357547044754028
Epoch: 30, Steps: 13 | Train Loss: 20.624 Vali Loss: 275.221 Vali Acc: 0.560 Test Loss: 275.221 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 5.400132179260254
Epoch: 31, Steps: 13 | Train Loss: 19.196 Vali Loss: 285.522 Vali Acc: 0.480 Test Loss: 285.522 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 5.295103073120117
Epoch: 32, Steps: 13 | Train Loss: 0.000 Vali Loss: 288.383 Vali Acc: 0.500 Test Loss: 288.383 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 5.477491617202759
Epoch: 33, Steps: 13 | Train Loss: 0.000 Vali Loss: 289.230 Vali Acc: 0.500 Test Loss: 289.230 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 5.479846715927124
Epoch: 34, Steps: 13 | Train Loss: 0.562 Vali Loss: 337.319 Vali Acc: 0.440 Test Loss: 337.319 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 5.344978094100952
Epoch: 35, Steps: 13 | Train Loss: 2.748 Vali Loss: 308.285 Vali Acc: 0.580 Test Loss: 308.285 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 5.683099269866943
Epoch: 36, Steps: 13 | Train Loss: 2.396 Vali Loss: 356.803 Vali Acc: 0.460 Test Loss: 356.803 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.64
model parameter : 34563881
model size : 136.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 7.584304094314575
Epoch: 1, Steps: 13 | Train Loss: 28.193 Vali Loss: 63.777 Vali Acc: 0.200 Test Loss: 63.777 Test Acc: 0.200
Validation loss decreased (inf --> -0.199362).  Saving model ...
Epoch: 2 cost time: 5.32733678817749
Epoch: 2, Steps: 13 | Train Loss: 53.149 Vali Loss: 55.741 Vali Acc: 0.220 Test Loss: 55.741 Test Acc: 0.220
Validation loss decreased (-0.199362 --> -0.219443).  Saving model ...
Epoch: 3 cost time: 5.469109773635864
Epoch: 3, Steps: 13 | Train Loss: 51.002 Vali Loss: 226.824 Vali Acc: 0.200 Test Loss: 226.824 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.428584575653076
Epoch: 4, Steps: 13 | Train Loss: 144.332 Vali Loss: 154.548 Vali Acc: 0.240 Test Loss: 154.548 Test Acc: 0.240
Validation loss decreased (-0.219443 --> -0.238455).  Saving model ...
Epoch: 5 cost time: 5.3869500160217285
Epoch: 5, Steps: 13 | Train Loss: 153.338 Vali Loss: 124.899 Vali Acc: 0.380 Test Loss: 124.899 Test Acc: 0.380
Validation loss decreased (-0.238455 --> -0.378751).  Saving model ...
Epoch: 6 cost time: 5.409211874008179
Epoch: 6, Steps: 13 | Train Loss: 161.666 Vali Loss: 182.982 Vali Acc: 0.480 Test Loss: 182.982 Test Acc: 0.480
Validation loss decreased (-0.378751 --> -0.478170).  Saving model ...
Epoch: 7 cost time: 5.352283716201782
Epoch: 7, Steps: 13 | Train Loss: 85.596 Vali Loss: 148.150 Vali Acc: 0.460 Test Loss: 148.150 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.283378839492798
Epoch: 8, Steps: 13 | Train Loss: 26.903 Vali Loss: 159.650 Vali Acc: 0.400 Test Loss: 159.650 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.263578414916992
Epoch: 9, Steps: 13 | Train Loss: 65.632 Vali Loss: 174.053 Vali Acc: 0.440 Test Loss: 174.053 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.467427015304565
Epoch: 10, Steps: 13 | Train Loss: 44.091 Vali Loss: 257.845 Vali Acc: 0.300 Test Loss: 257.845 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.450333595275879
Epoch: 11, Steps: 13 | Train Loss: 33.405 Vali Loss: 164.951 Vali Acc: 0.420 Test Loss: 164.951 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.1943583488464355
Epoch: 12, Steps: 13 | Train Loss: 31.268 Vali Loss: 366.526 Vali Acc: 0.400 Test Loss: 366.526 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.276705026626587
Epoch: 13, Steps: 13 | Train Loss: 116.045 Vali Loss: 172.754 Vali Acc: 0.420 Test Loss: 172.754 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.287844657897949
Epoch: 14, Steps: 13 | Train Loss: 92.166 Vali Loss: 357.797 Vali Acc: 0.460 Test Loss: 357.797 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.5388267040252686
Epoch: 15, Steps: 13 | Train Loss: 42.455 Vali Loss: 275.978 Vali Acc: 0.480 Test Loss: 275.978 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.271040916442871
Epoch: 16, Steps: 13 | Train Loss: 130.718 Vali Loss: 270.348 Vali Acc: 0.420 Test Loss: 270.348 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 34554921
model size : 136.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 7.252090692520142
Epoch: 1, Steps: 13 | Train Loss: 27.537 Vali Loss: 66.039 Vali Acc: 0.220 Test Loss: 66.039 Test Acc: 0.220
Validation loss decreased (inf --> -0.219340).  Saving model ...
Epoch: 2 cost time: 5.355589389801025
Epoch: 2, Steps: 13 | Train Loss: 67.121 Vali Loss: 71.699 Vali Acc: 0.240 Test Loss: 71.699 Test Acc: 0.240
Validation loss decreased (-0.219340 --> -0.239283).  Saving model ...
Epoch: 3 cost time: 5.511813640594482
Epoch: 3, Steps: 13 | Train Loss: 72.685 Vali Loss: 111.409 Vali Acc: 0.320 Test Loss: 111.409 Test Acc: 0.320
Validation loss decreased (-0.239283 --> -0.318886).  Saving model ...
Epoch: 4 cost time: 5.2245848178863525
Epoch: 4, Steps: 13 | Train Loss: 37.398 Vali Loss: 56.423 Vali Acc: 0.360 Test Loss: 56.423 Test Acc: 0.360
Validation loss decreased (-0.318886 --> -0.359436).  Saving model ...
Epoch: 5 cost time: 5.371785640716553
Epoch: 5, Steps: 13 | Train Loss: 48.111 Vali Loss: 97.983 Vali Acc: 0.420 Test Loss: 97.983 Test Acc: 0.420
Validation loss decreased (-0.359436 --> -0.419020).  Saving model ...
Epoch: 6 cost time: 5.433380126953125
Epoch: 6, Steps: 13 | Train Loss: 74.360 Vali Loss: 235.517 Vali Acc: 0.340 Test Loss: 235.517 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.290467023849487
Epoch: 7, Steps: 13 | Train Loss: 86.236 Vali Loss: 169.193 Vali Acc: 0.420 Test Loss: 169.193 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.406800031661987
Epoch: 8, Steps: 13 | Train Loss: 48.220 Vali Loss: 105.115 Vali Acc: 0.460 Test Loss: 105.115 Test Acc: 0.460
Validation loss decreased (-0.419020 --> -0.458949).  Saving model ...
Epoch: 9 cost time: 5.199517488479614
Epoch: 9, Steps: 13 | Train Loss: 104.286 Vali Loss: 223.081 Vali Acc: 0.400 Test Loss: 223.081 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.34307336807251
Epoch: 10, Steps: 13 | Train Loss: 126.262 Vali Loss: 324.159 Vali Acc: 0.340 Test Loss: 324.159 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.2951340675354
Epoch: 11, Steps: 13 | Train Loss: 77.793 Vali Loss: 201.321 Vali Acc: 0.640 Test Loss: 201.321 Test Acc: 0.640
Validation loss decreased (-0.458949 --> -0.637987).  Saving model ...
Epoch: 12 cost time: 5.5414838790893555
Epoch: 12, Steps: 13 | Train Loss: 87.349 Vali Loss: 329.599 Vali Acc: 0.380 Test Loss: 329.599 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.3503148555755615
Epoch: 13, Steps: 13 | Train Loss: 38.719 Vali Loss: 344.248 Vali Acc: 0.420 Test Loss: 344.248 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.37363862991333
Epoch: 14, Steps: 13 | Train Loss: 111.413 Vali Loss: 132.632 Vali Acc: 0.560 Test Loss: 132.632 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.460509300231934
Epoch: 15, Steps: 13 | Train Loss: 1.968 Vali Loss: 189.515 Vali Acc: 0.440 Test Loss: 189.515 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.4107396602630615
Epoch: 16, Steps: 13 | Train Loss: 35.719 Vali Loss: 208.671 Vali Acc: 0.460 Test Loss: 208.671 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.398625373840332
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 181.141 Vali Acc: 0.480 Test Loss: 181.141 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.2299017906188965
Epoch: 18, Steps: 13 | Train Loss: 0.101 Vali Loss: 218.253 Vali Acc: 0.480 Test Loss: 218.253 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.238950967788696
Epoch: 19, Steps: 13 | Train Loss: 44.060 Vali Loss: 220.333 Vali Acc: 0.540 Test Loss: 220.333 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.451009511947632
Epoch: 20, Steps: 13 | Train Loss: 28.631 Vali Loss: 269.172 Vali Acc: 0.360 Test Loss: 269.172 Test Acc: 0.360
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.218671798706055
Epoch: 21, Steps: 13 | Train Loss: 39.434 Vali Loss: 217.162 Vali Acc: 0.560 Test Loss: 217.162 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.64
model parameter : 34545961
model size : 136.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 6.827863454818726
Epoch: 1, Steps: 13 | Train Loss: 33.941 Vali Loss: 72.932 Vali Acc: 0.220 Test Loss: 72.932 Test Acc: 0.220
Validation loss decreased (inf --> -0.219271).  Saving model ...
Epoch: 2 cost time: 5.208526611328125
Epoch: 2, Steps: 13 | Train Loss: 79.519 Vali Loss: 97.840 Vali Acc: 0.240 Test Loss: 97.840 Test Acc: 0.240
Validation loss decreased (-0.219271 --> -0.239022).  Saving model ...
Epoch: 3 cost time: 5.168024301528931
Epoch: 3, Steps: 13 | Train Loss: 94.698 Vali Loss: 131.125 Vali Acc: 0.260 Test Loss: 131.125 Test Acc: 0.260
Validation loss decreased (-0.239022 --> -0.258689).  Saving model ...
Epoch: 4 cost time: 5.432226657867432
Epoch: 4, Steps: 13 | Train Loss: 116.865 Vali Loss: 152.588 Vali Acc: 0.300 Test Loss: 152.588 Test Acc: 0.300
Validation loss decreased (-0.258689 --> -0.298474).  Saving model ...
Epoch: 5 cost time: 5.135509729385376
Epoch: 5, Steps: 13 | Train Loss: 93.267 Vali Loss: 223.017 Vali Acc: 0.400 Test Loss: 223.017 Test Acc: 0.400
Validation loss decreased (-0.298474 --> -0.397770).  Saving model ...
Epoch: 6 cost time: 5.049323320388794
Epoch: 6, Steps: 13 | Train Loss: 126.870 Vali Loss: 96.788 Vali Acc: 0.500 Test Loss: 96.788 Test Acc: 0.500
Validation loss decreased (-0.397770 --> -0.499032).  Saving model ...
Epoch: 7 cost time: 5.139603853225708
Epoch: 7, Steps: 13 | Train Loss: 65.127 Vali Loss: 176.319 Vali Acc: 0.440 Test Loss: 176.319 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.281947374343872
Epoch: 8, Steps: 13 | Train Loss: 62.277 Vali Loss: 256.400 Vali Acc: 0.440 Test Loss: 256.400 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.0752997398376465
Epoch: 9, Steps: 13 | Train Loss: 139.723 Vali Loss: 174.660 Vali Acc: 0.500 Test Loss: 174.660 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.0536439418792725
Epoch: 10, Steps: 13 | Train Loss: 75.719 Vali Loss: 189.473 Vali Acc: 0.520 Test Loss: 189.473 Test Acc: 0.520
Validation loss decreased (-0.499032 --> -0.518105).  Saving model ...
Epoch: 11 cost time: 4.988934755325317
Epoch: 11, Steps: 13 | Train Loss: 42.282 Vali Loss: 197.604 Vali Acc: 0.440 Test Loss: 197.604 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.139859914779663
Epoch: 12, Steps: 13 | Train Loss: 68.739 Vali Loss: 215.041 Vali Acc: 0.540 Test Loss: 215.041 Test Acc: 0.540
Validation loss decreased (-0.518105 --> -0.537850).  Saving model ...
Epoch: 13 cost time: 5.324230909347534
Epoch: 13, Steps: 13 | Train Loss: 70.908 Vali Loss: 210.853 Vali Acc: 0.500 Test Loss: 210.853 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.5503411293029785
Epoch: 14, Steps: 13 | Train Loss: 75.436 Vali Loss: 316.239 Vali Acc: 0.380 Test Loss: 316.239 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.32751989364624
Epoch: 15, Steps: 13 | Train Loss: 82.190 Vali Loss: 317.109 Vali Acc: 0.520 Test Loss: 317.109 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.296490669250488
Epoch: 16, Steps: 13 | Train Loss: 63.309 Vali Loss: 274.915 Vali Acc: 0.480 Test Loss: 274.915 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.341275215148926
Epoch: 17, Steps: 13 | Train Loss: 1.242 Vali Loss: 329.582 Vali Acc: 0.480 Test Loss: 329.582 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.378909111022949
Epoch: 18, Steps: 13 | Train Loss: 17.344 Vali Loss: 313.816 Vali Acc: 0.480 Test Loss: 313.816 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 5.2882609367370605
Epoch: 19, Steps: 13 | Train Loss: 19.974 Vali Loss: 270.224 Vali Acc: 0.580 Test Loss: 270.224 Test Acc: 0.580
Validation loss decreased (-0.537850 --> -0.577298).  Saving model ...
Epoch: 20 cost time: 5.263780832290649
Epoch: 20, Steps: 13 | Train Loss: 4.236 Vali Loss: 300.681 Vali Acc: 0.520 Test Loss: 300.681 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.195014715194702
Epoch: 21, Steps: 13 | Train Loss: 13.754 Vali Loss: 227.722 Vali Acc: 0.540 Test Loss: 227.722 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.210258722305298
Epoch: 22, Steps: 13 | Train Loss: 28.057 Vali Loss: 473.284 Vali Acc: 0.440 Test Loss: 473.284 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 5.330189943313599
Epoch: 23, Steps: 13 | Train Loss: 48.827 Vali Loss: 360.317 Vali Acc: 0.480 Test Loss: 360.317 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 5.048533916473389
Epoch: 24, Steps: 13 | Train Loss: 13.649 Vali Loss: 248.616 Vali Acc: 0.560 Test Loss: 248.616 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 5.391523838043213
Epoch: 25, Steps: 13 | Train Loss: 3.557 Vali Loss: 260.908 Vali Acc: 0.540 Test Loss: 260.908 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 5.459913730621338
Epoch: 26, Steps: 13 | Train Loss: 5.723 Vali Loss: 270.798 Vali Acc: 0.540 Test Loss: 270.798 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 5.394409894943237
Epoch: 27, Steps: 13 | Train Loss: 0.110 Vali Loss: 317.644 Vali Acc: 0.560 Test Loss: 317.644 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 5.2643537521362305
Epoch: 28, Steps: 13 | Train Loss: 25.087 Vali Loss: 326.327 Vali Acc: 0.480 Test Loss: 326.327 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 5.2236151695251465
Epoch: 29, Steps: 13 | Train Loss: 2.688 Vali Loss: 306.281 Vali Acc: 0.560 Test Loss: 306.281 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 34537001
model size : 136.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 7.272902727127075
Epoch: 1, Steps: 13 | Train Loss: 44.339 Vali Loss: 71.358 Vali Acc: 0.200 Test Loss: 71.358 Test Acc: 0.200
Validation loss decreased (inf --> -0.199286).  Saving model ...
Epoch: 2 cost time: 5.207425355911255
Epoch: 2, Steps: 13 | Train Loss: 92.725 Vali Loss: 94.890 Vali Acc: 0.240 Test Loss: 94.890 Test Acc: 0.240
Validation loss decreased (-0.199286 --> -0.239051).  Saving model ...
Epoch: 3 cost time: 5.365813732147217
Epoch: 3, Steps: 13 | Train Loss: 91.117 Vali Loss: 106.610 Vali Acc: 0.260 Test Loss: 106.610 Test Acc: 0.260
Validation loss decreased (-0.239051 --> -0.258934).  Saving model ...
Epoch: 4 cost time: 5.360478401184082
Epoch: 4, Steps: 13 | Train Loss: 63.952 Vali Loss: 123.778 Vali Acc: 0.360 Test Loss: 123.778 Test Acc: 0.360
Validation loss decreased (-0.258934 --> -0.358762).  Saving model ...
Epoch: 5 cost time: 5.315166711807251
Epoch: 5, Steps: 13 | Train Loss: 87.297 Vali Loss: 102.515 Vali Acc: 0.380 Test Loss: 102.515 Test Acc: 0.380
Validation loss decreased (-0.358762 --> -0.378975).  Saving model ...
Epoch: 6 cost time: 5.286448955535889
Epoch: 6, Steps: 13 | Train Loss: 81.734 Vali Loss: 216.810 Vali Acc: 0.280 Test Loss: 216.810 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.404686689376831
Epoch: 7, Steps: 13 | Train Loss: 158.941 Vali Loss: 117.560 Vali Acc: 0.440 Test Loss: 117.560 Test Acc: 0.440
Validation loss decreased (-0.378975 --> -0.438824).  Saving model ...
Epoch: 8 cost time: 5.365995645523071
Epoch: 8, Steps: 13 | Train Loss: 47.925 Vali Loss: 134.535 Vali Acc: 0.540 Test Loss: 134.535 Test Acc: 0.540
Validation loss decreased (-0.438824 --> -0.538655).  Saving model ...
Epoch: 9 cost time: 5.168641090393066
Epoch: 9, Steps: 13 | Train Loss: 67.483 Vali Loss: 157.132 Vali Acc: 0.480 Test Loss: 157.132 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.178210735321045
Epoch: 10, Steps: 13 | Train Loss: 41.879 Vali Loss: 101.675 Vali Acc: 0.480 Test Loss: 101.675 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.070300817489624
Epoch: 11, Steps: 13 | Train Loss: 26.686 Vali Loss: 112.692 Vali Acc: 0.520 Test Loss: 112.692 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.739091396331787
Epoch: 12, Steps: 13 | Train Loss: 29.370 Vali Loss: 141.941 Vali Acc: 0.500 Test Loss: 141.941 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.141529560089111
Epoch: 13, Steps: 13 | Train Loss: 4.732 Vali Loss: 289.219 Vali Acc: 0.440 Test Loss: 289.219 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.168334007263184
Epoch: 14, Steps: 13 | Train Loss: 54.243 Vali Loss: 197.783 Vali Acc: 0.440 Test Loss: 197.783 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.334961175918579
Epoch: 15, Steps: 13 | Train Loss: 32.125 Vali Loss: 363.394 Vali Acc: 0.500 Test Loss: 363.394 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.092024326324463
Epoch: 16, Steps: 13 | Train Loss: 93.380 Vali Loss: 145.588 Vali Acc: 0.540 Test Loss: 145.588 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 5.213234901428223
Epoch: 17, Steps: 13 | Train Loss: 12.263 Vali Loss: 222.726 Vali Acc: 0.460 Test Loss: 222.726 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 5.366234302520752
Epoch: 18, Steps: 13 | Train Loss: 9.233 Vali Loss: 237.859 Vali Acc: 0.500 Test Loss: 237.859 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 34235561
model size : 135.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 8.940494537353516
Epoch: 1, Steps: 13 | Train Loss: 39.959 Vali Loss: 54.930 Vali Acc: 0.200 Test Loss: 54.930 Test Acc: 0.200
Validation loss decreased (inf --> -0.199451).  Saving model ...
Epoch: 2 cost time: 5.257207155227661
Epoch: 2, Steps: 13 | Train Loss: 72.958 Vali Loss: 91.195 Vali Acc: 0.200 Test Loss: 91.195 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.339352369308472
Epoch: 3, Steps: 13 | Train Loss: 69.953 Vali Loss: 172.957 Vali Acc: 0.420 Test Loss: 172.957 Test Acc: 0.420
Validation loss decreased (-0.199451 --> -0.418270).  Saving model ...
Epoch: 4 cost time: 5.376072883605957
Epoch: 4, Steps: 13 | Train Loss: 114.099 Vali Loss: 192.163 Vali Acc: 0.320 Test Loss: 192.163 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.13154673576355
Epoch: 5, Steps: 13 | Train Loss: 98.191 Vali Loss: 255.061 Vali Acc: 0.340 Test Loss: 255.061 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.167095184326172
Epoch: 6, Steps: 13 | Train Loss: 92.626 Vali Loss: 167.167 Vali Acc: 0.420 Test Loss: 167.167 Test Acc: 0.420
Validation loss decreased (-0.418270 --> -0.418328).  Saving model ...
Epoch: 7 cost time: 5.320250749588013
Epoch: 7, Steps: 13 | Train Loss: 84.733 Vali Loss: 190.539 Vali Acc: 0.340 Test Loss: 190.539 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.496187686920166
Epoch: 8, Steps: 13 | Train Loss: 94.952 Vali Loss: 267.435 Vali Acc: 0.420 Test Loss: 267.435 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.237529754638672
Epoch: 9, Steps: 13 | Train Loss: 87.462 Vali Loss: 307.368 Vali Acc: 0.500 Test Loss: 307.368 Test Acc: 0.500
Validation loss decreased (-0.418328 --> -0.496926).  Saving model ...
Epoch: 10 cost time: 5.297276973724365
Epoch: 10, Steps: 13 | Train Loss: 122.415 Vali Loss: 147.125 Vali Acc: 0.460 Test Loss: 147.125 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.3754987716674805
Epoch: 11, Steps: 13 | Train Loss: 34.952 Vali Loss: 247.853 Vali Acc: 0.360 Test Loss: 247.853 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.311120271682739
Epoch: 12, Steps: 13 | Train Loss: 54.228 Vali Loss: 273.892 Vali Acc: 0.420 Test Loss: 273.892 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.520920753479004
Epoch: 13, Steps: 13 | Train Loss: 63.547 Vali Loss: 140.473 Vali Acc: 0.640 Test Loss: 140.473 Test Acc: 0.640
Validation loss decreased (-0.496926 --> -0.638595).  Saving model ...
Epoch: 14 cost time: 5.322186708450317
Epoch: 14, Steps: 13 | Train Loss: 9.257 Vali Loss: 193.538 Vali Acc: 0.660 Test Loss: 193.538 Test Acc: 0.660
Validation loss decreased (-0.638595 --> -0.658065).  Saving model ...
Epoch: 15 cost time: 5.123324155807495
Epoch: 15, Steps: 13 | Train Loss: 27.925 Vali Loss: 171.196 Vali Acc: 0.580 Test Loss: 171.196 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.251829147338867
Epoch: 16, Steps: 13 | Train Loss: 2.848 Vali Loss: 150.469 Vali Acc: 0.540 Test Loss: 150.469 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.331436395645142
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 179.769 Vali Acc: 0.500 Test Loss: 179.769 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.250089406967163
Epoch: 18, Steps: 13 | Train Loss: 2.019 Vali Loss: 150.747 Vali Acc: 0.640 Test Loss: 150.747 Test Acc: 0.640
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 5.252411365509033
Epoch: 19, Steps: 13 | Train Loss: 6.652 Vali Loss: 171.862 Vali Acc: 0.520 Test Loss: 171.862 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 5.379283666610718
Epoch: 20, Steps: 13 | Train Loss: 35.038 Vali Loss: 160.286 Vali Acc: 0.480 Test Loss: 160.286 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 5.409076929092407
Epoch: 21, Steps: 13 | Train Loss: 9.280 Vali Loss: 205.350 Vali Acc: 0.520 Test Loss: 205.350 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 5.254897356033325
Epoch: 22, Steps: 13 | Train Loss: 6.510 Vali Loss: 256.754 Vali Acc: 0.500 Test Loss: 256.754 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 5.0637595653533936
Epoch: 23, Steps: 13 | Train Loss: 18.942 Vali Loss: 193.086 Vali Acc: 0.600 Test Loss: 193.086 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 5.070545673370361
Epoch: 24, Steps: 13 | Train Loss: 9.379 Vali Loss: 184.054 Vali Acc: 0.500 Test Loss: 184.054 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.66
model parameter : 34226601
model size : 135.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 7.045511722564697
Epoch: 1, Steps: 13 | Train Loss: 53.131 Vali Loss: 72.649 Vali Acc: 0.200 Test Loss: 72.649 Test Acc: 0.200
Validation loss decreased (inf --> -0.199274).  Saving model ...
Epoch: 2 cost time: 5.20903205871582
Epoch: 2, Steps: 13 | Train Loss: 76.557 Vali Loss: 102.609 Vali Acc: 0.220 Test Loss: 102.609 Test Acc: 0.220
Validation loss decreased (-0.199274 --> -0.218974).  Saving model ...
Epoch: 3 cost time: 5.275800943374634
Epoch: 3, Steps: 13 | Train Loss: 57.026 Vali Loss: 138.469 Vali Acc: 0.340 Test Loss: 138.469 Test Acc: 0.340
Validation loss decreased (-0.218974 --> -0.338615).  Saving model ...
Epoch: 4 cost time: 5.1156089305877686
Epoch: 4, Steps: 13 | Train Loss: 84.524 Vali Loss: 92.396 Vali Acc: 0.380 Test Loss: 92.396 Test Acc: 0.380
Validation loss decreased (-0.338615 --> -0.379076).  Saving model ...
Epoch: 5 cost time: 5.281078100204468
Epoch: 5, Steps: 13 | Train Loss: 86.893 Vali Loss: 209.060 Vali Acc: 0.540 Test Loss: 209.060 Test Acc: 0.540
Validation loss decreased (-0.379076 --> -0.537909).  Saving model ...
Epoch: 6 cost time: 5.548699378967285
Epoch: 6, Steps: 13 | Train Loss: 132.795 Vali Loss: 166.563 Vali Acc: 0.400 Test Loss: 166.563 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.02744197845459
Epoch: 7, Steps: 13 | Train Loss: 152.272 Vali Loss: 178.388 Vali Acc: 0.440 Test Loss: 178.388 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.244518756866455
Epoch: 8, Steps: 13 | Train Loss: 81.425 Vali Loss: 258.986 Vali Acc: 0.440 Test Loss: 258.986 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.383954763412476
Epoch: 9, Steps: 13 | Train Loss: 105.472 Vali Loss: 352.739 Vali Acc: 0.420 Test Loss: 352.739 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.248486280441284
Epoch: 10, Steps: 13 | Train Loss: 82.148 Vali Loss: 203.823 Vali Acc: 0.480 Test Loss: 203.823 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.123576879501343
Epoch: 11, Steps: 13 | Train Loss: 61.622 Vali Loss: 191.582 Vali Acc: 0.480 Test Loss: 191.582 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.0356316566467285
Epoch: 12, Steps: 13 | Train Loss: 26.238 Vali Loss: 233.543 Vali Acc: 0.460 Test Loss: 233.543 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 5.242965459823608
Epoch: 13, Steps: 13 | Train Loss: 36.793 Vali Loss: 181.434 Vali Acc: 0.520 Test Loss: 181.434 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 5.197133779525757
Epoch: 14, Steps: 13 | Train Loss: 2.653 Vali Loss: 224.323 Vali Acc: 0.500 Test Loss: 224.323 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 5.211431980133057
Epoch: 15, Steps: 13 | Train Loss: 31.618 Vali Loss: 218.847 Vali Acc: 0.500 Test Loss: 218.847 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 34217641
model size : 135.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 7.228509426116943
Epoch: 1, Steps: 13 | Train Loss: 41.099 Vali Loss: 157.682 Vali Acc: 0.200 Test Loss: 157.682 Test Acc: 0.200
Validation loss decreased (inf --> -0.198423).  Saving model ...
Epoch: 2 cost time: 5.206991195678711
Epoch: 2, Steps: 13 | Train Loss: 97.292 Vali Loss: 74.770 Vali Acc: 0.260 Test Loss: 74.770 Test Acc: 0.260
Validation loss decreased (-0.198423 --> -0.259252).  Saving model ...
Epoch: 3 cost time: 5.062248229980469
Epoch: 3, Steps: 13 | Train Loss: 60.758 Vali Loss: 211.338 Vali Acc: 0.200 Test Loss: 211.338 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.184837341308594
Epoch: 4, Steps: 13 | Train Loss: 93.997 Vali Loss: 128.676 Vali Acc: 0.400 Test Loss: 128.676 Test Acc: 0.400
Validation loss decreased (-0.259252 --> -0.398713).  Saving model ...
Epoch: 5 cost time: 5.0884950160980225
Epoch: 5, Steps: 13 | Train Loss: 74.006 Vali Loss: 103.160 Vali Acc: 0.520 Test Loss: 103.160 Test Acc: 0.520
Validation loss decreased (-0.398713 --> -0.518968).  Saving model ...
Epoch: 6 cost time: 5.095914602279663
Epoch: 6, Steps: 13 | Train Loss: 54.982 Vali Loss: 133.764 Vali Acc: 0.440 Test Loss: 133.764 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.3800389766693115
Epoch: 7, Steps: 13 | Train Loss: 55.916 Vali Loss: 176.757 Vali Acc: 0.400 Test Loss: 176.757 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.326386451721191
Epoch: 8, Steps: 13 | Train Loss: 98.206 Vali Loss: 149.765 Vali Acc: 0.400 Test Loss: 149.765 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.138720750808716
Epoch: 9, Steps: 13 | Train Loss: 26.107 Vali Loss: 151.263 Vali Acc: 0.360 Test Loss: 151.263 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.289344310760498
Epoch: 10, Steps: 13 | Train Loss: 55.532 Vali Loss: 186.152 Vali Acc: 0.520 Test Loss: 186.152 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.975776195526123
Epoch: 11, Steps: 13 | Train Loss: 46.822 Vali Loss: 204.682 Vali Acc: 0.400 Test Loss: 204.682 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.146657705307007
Epoch: 12, Steps: 13 | Train Loss: 78.164 Vali Loss: 278.463 Vali Acc: 0.420 Test Loss: 278.463 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 5.214897394180298
Epoch: 13, Steps: 13 | Train Loss: 222.396 Vali Loss: 253.148 Vali Acc: 0.420 Test Loss: 253.148 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 5.304070472717285
Epoch: 14, Steps: 13 | Train Loss: 60.712 Vali Loss: 259.498 Vali Acc: 0.400 Test Loss: 259.498 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 5.0360026359558105
Epoch: 15, Steps: 13 | Train Loss: 49.562 Vali Loss: 188.337 Vali Acc: 0.400 Test Loss: 188.337 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 34208681
model size : 135.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 7.130819797515869
Epoch: 1, Steps: 13 | Train Loss: 9.913 Vali Loss: 12.594 Vali Acc: 0.200 Test Loss: 12.594 Test Acc: 0.200
Validation loss decreased (inf --> -0.199874).  Saving model ...
Epoch: 2 cost time: 4.317659378051758
Epoch: 2, Steps: 13 | Train Loss: 22.152 Vali Loss: 54.339 Vali Acc: 0.200 Test Loss: 54.339 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.371196508407593
Epoch: 3, Steps: 13 | Train Loss: 57.883 Vali Loss: 78.225 Vali Acc: 0.200 Test Loss: 78.225 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.415116548538208
Epoch: 4, Steps: 13 | Train Loss: 29.897 Vali Loss: 46.568 Vali Acc: 0.380 Test Loss: 46.568 Test Acc: 0.380
Validation loss decreased (-0.199874 --> -0.379534).  Saving model ...
Epoch: 5 cost time: 4.317331790924072
Epoch: 5, Steps: 13 | Train Loss: 43.199 Vali Loss: 39.106 Vali Acc: 0.420 Test Loss: 39.106 Test Acc: 0.420
Validation loss decreased (-0.379534 --> -0.419609).  Saving model ...
Epoch: 6 cost time: 4.4082560539245605
Epoch: 6, Steps: 13 | Train Loss: 17.044 Vali Loss: 58.136 Vali Acc: 0.260 Test Loss: 58.136 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.2096545696258545
Epoch: 7, Steps: 13 | Train Loss: 45.653 Vali Loss: 80.521 Vali Acc: 0.400 Test Loss: 80.521 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.199282646179199
Epoch: 8, Steps: 13 | Train Loss: 20.936 Vali Loss: 115.558 Vali Acc: 0.340 Test Loss: 115.558 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.250688076019287
Epoch: 9, Steps: 13 | Train Loss: 49.250 Vali Loss: 173.947 Vali Acc: 0.380 Test Loss: 173.947 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.16208815574646
Epoch: 10, Steps: 13 | Train Loss: 57.128 Vali Loss: 94.482 Vali Acc: 0.460 Test Loss: 94.482 Test Acc: 0.460
Validation loss decreased (-0.419609 --> -0.459055).  Saving model ...
Epoch: 11 cost time: 4.306655406951904
Epoch: 11, Steps: 13 | Train Loss: 20.009 Vali Loss: 148.504 Vali Acc: 0.400 Test Loss: 148.504 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.356126546859741
Epoch: 12, Steps: 13 | Train Loss: 36.206 Vali Loss: 131.124 Vali Acc: 0.460 Test Loss: 131.124 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.3387534618377686
Epoch: 13, Steps: 13 | Train Loss: 35.296 Vali Loss: 168.769 Vali Acc: 0.460 Test Loss: 168.769 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.210345506668091
Epoch: 14, Steps: 13 | Train Loss: 31.076 Vali Loss: 273.757 Vali Acc: 0.400 Test Loss: 273.757 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.505490064620972
Epoch: 15, Steps: 13 | Train Loss: 74.000 Vali Loss: 194.676 Vali Acc: 0.440 Test Loss: 194.676 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.189866065979004
Epoch: 16, Steps: 13 | Train Loss: 36.473 Vali Loss: 209.313 Vali Acc: 0.440 Test Loss: 209.313 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.587109804153442
Epoch: 17, Steps: 13 | Train Loss: 9.509 Vali Loss: 135.826 Vali Acc: 0.440 Test Loss: 135.826 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.3784284591674805
Epoch: 18, Steps: 13 | Train Loss: 9.491 Vali Loss: 169.436 Vali Acc: 0.540 Test Loss: 169.436 Test Acc: 0.540
Validation loss decreased (-0.459055 --> -0.538306).  Saving model ...
Epoch: 19 cost time: 4.184889554977417
Epoch: 19, Steps: 13 | Train Loss: 21.705 Vali Loss: 213.499 Vali Acc: 0.460 Test Loss: 213.499 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.80525279045105
Epoch: 20, Steps: 13 | Train Loss: 41.779 Vali Loss: 150.465 Vali Acc: 0.480 Test Loss: 150.465 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.4653239250183105
Epoch: 21, Steps: 13 | Train Loss: 5.196 Vali Loss: 89.335 Vali Acc: 0.460 Test Loss: 89.335 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.356371164321899
Epoch: 22, Steps: 13 | Train Loss: 0.000 Vali Loss: 93.439 Vali Acc: 0.460 Test Loss: 93.439 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.515394926071167
Epoch: 23, Steps: 13 | Train Loss: 0.000 Vali Loss: 97.184 Vali Acc: 0.460 Test Loss: 97.184 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 4.298102617263794
Epoch: 24, Steps: 13 | Train Loss: 0.311 Vali Loss: 82.253 Vali Acc: 0.560 Test Loss: 82.253 Test Acc: 0.560
Validation loss decreased (-0.538306 --> -0.559177).  Saving model ...
Epoch: 25 cost time: 4.513212442398071
Epoch: 25, Steps: 13 | Train Loss: 1.607 Vali Loss: 131.879 Vali Acc: 0.460 Test Loss: 131.879 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.373616933822632
Epoch: 26, Steps: 13 | Train Loss: 0.294 Vali Loss: 119.916 Vali Acc: 0.480 Test Loss: 119.916 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 4.273469686508179
Epoch: 27, Steps: 13 | Train Loss: 0.000 Vali Loss: 144.933 Vali Acc: 0.540 Test Loss: 144.933 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 4.382373332977295
Epoch: 28, Steps: 13 | Train Loss: 1.492 Vali Loss: 117.246 Vali Acc: 0.500 Test Loss: 117.246 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 4.516587972640991
Epoch: 29, Steps: 13 | Train Loss: 5.749 Vali Loss: 144.914 Vali Acc: 0.400 Test Loss: 144.914 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 4.235415697097778
Epoch: 30, Steps: 13 | Train Loss: 12.480 Vali Loss: 195.273 Vali Acc: 0.380 Test Loss: 195.273 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 4.297896146774292
Epoch: 31, Steps: 13 | Train Loss: 5.228 Vali Loss: 150.454 Vali Acc: 0.520 Test Loss: 150.454 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 4.405991315841675
Epoch: 32, Steps: 13 | Train Loss: 0.000 Vali Loss: 149.081 Vali Acc: 0.460 Test Loss: 149.081 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 4.365417957305908
Epoch: 33, Steps: 13 | Train Loss: 0.000 Vali Loss: 151.263 Vali Acc: 0.480 Test Loss: 151.263 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 4.329164028167725
Epoch: 34, Steps: 13 | Train Loss: 0.000 Vali Loss: 151.969 Vali Acc: 0.500 Test Loss: 151.969 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 16958761
model size : 67.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 6.933284521102905
Epoch: 1, Steps: 13 | Train Loss: 14.711 Vali Loss: 50.722 Vali Acc: 0.200 Test Loss: 50.722 Test Acc: 0.200
Validation loss decreased (inf --> -0.199493).  Saving model ...
Epoch: 2 cost time: 4.327528238296509
Epoch: 2, Steps: 13 | Train Loss: 37.071 Vali Loss: 36.141 Vali Acc: 0.260 Test Loss: 36.141 Test Acc: 0.260
Validation loss decreased (-0.199493 --> -0.259639).  Saving model ...
Epoch: 3 cost time: 4.303725719451904
Epoch: 3, Steps: 13 | Train Loss: 26.770 Vali Loss: 43.250 Vali Acc: 0.300 Test Loss: 43.250 Test Acc: 0.300
Validation loss decreased (-0.259639 --> -0.299568).  Saving model ...
Epoch: 4 cost time: 4.126885890960693
Epoch: 4, Steps: 13 | Train Loss: 46.237 Vali Loss: 51.437 Vali Acc: 0.260 Test Loss: 51.437 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.061523675918579
Epoch: 5, Steps: 13 | Train Loss: 16.910 Vali Loss: 37.506 Vali Acc: 0.420 Test Loss: 37.506 Test Acc: 0.420
Validation loss decreased (-0.299568 --> -0.419625).  Saving model ...
Epoch: 6 cost time: 4.137030124664307
Epoch: 6, Steps: 13 | Train Loss: 38.556 Vali Loss: 88.551 Vali Acc: 0.320 Test Loss: 88.551 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.057224273681641
Epoch: 7, Steps: 13 | Train Loss: 53.763 Vali Loss: 92.842 Vali Acc: 0.420 Test Loss: 92.842 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.157076358795166
Epoch: 8, Steps: 13 | Train Loss: 76.547 Vali Loss: 186.452 Vali Acc: 0.300 Test Loss: 186.452 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.27957820892334
Epoch: 9, Steps: 13 | Train Loss: 64.666 Vali Loss: 110.642 Vali Acc: 0.420 Test Loss: 110.642 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.30152440071106
Epoch: 10, Steps: 13 | Train Loss: 66.085 Vali Loss: 241.025 Vali Acc: 0.280 Test Loss: 241.025 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.2326741218566895
Epoch: 11, Steps: 13 | Train Loss: 48.366 Vali Loss: 134.142 Vali Acc: 0.440 Test Loss: 134.142 Test Acc: 0.440
Validation loss decreased (-0.419625 --> -0.438659).  Saving model ...
Epoch: 12 cost time: 4.296899795532227
Epoch: 12, Steps: 13 | Train Loss: 45.156 Vali Loss: 103.199 Vali Acc: 0.500 Test Loss: 103.199 Test Acc: 0.500
Validation loss decreased (-0.438659 --> -0.498968).  Saving model ...
Epoch: 13 cost time: 4.208649158477783
Epoch: 13, Steps: 13 | Train Loss: 11.837 Vali Loss: 140.525 Vali Acc: 0.480 Test Loss: 140.525 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.21871542930603
Epoch: 14, Steps: 13 | Train Loss: 27.922 Vali Loss: 266.548 Vali Acc: 0.440 Test Loss: 266.548 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.248044967651367
Epoch: 15, Steps: 13 | Train Loss: 60.726 Vali Loss: 177.901 Vali Acc: 0.500 Test Loss: 177.901 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.997441053390503
Epoch: 16, Steps: 13 | Train Loss: 16.869 Vali Loss: 139.615 Vali Acc: 0.480 Test Loss: 139.615 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.636092185974121
Epoch: 17, Steps: 13 | Train Loss: 16.806 Vali Loss: 186.662 Vali Acc: 0.400 Test Loss: 186.662 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.172701835632324
Epoch: 18, Steps: 13 | Train Loss: 11.536 Vali Loss: 108.423 Vali Acc: 0.560 Test Loss: 108.423 Test Acc: 0.560
Validation loss decreased (-0.498968 --> -0.558916).  Saving model ...
Epoch: 19 cost time: 4.344426870346069
Epoch: 19, Steps: 13 | Train Loss: 3.630 Vali Loss: 135.338 Vali Acc: 0.460 Test Loss: 135.338 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.1507368087768555
Epoch: 20, Steps: 13 | Train Loss: 2.606 Vali Loss: 120.152 Vali Acc: 0.460 Test Loss: 120.152 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.4455788135528564
Epoch: 21, Steps: 13 | Train Loss: 1.824 Vali Loss: 131.320 Vali Acc: 0.480 Test Loss: 131.320 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.097004413604736
Epoch: 22, Steps: 13 | Train Loss: 1.626 Vali Loss: 239.777 Vali Acc: 0.440 Test Loss: 239.777 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.322531461715698
Epoch: 23, Steps: 13 | Train Loss: 30.257 Vali Loss: 142.699 Vali Acc: 0.540 Test Loss: 142.699 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 4.060130834579468
Epoch: 24, Steps: 13 | Train Loss: 2.912 Vali Loss: 112.531 Vali Acc: 0.520 Test Loss: 112.531 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 4.215532064437866
Epoch: 25, Steps: 13 | Train Loss: 0.000 Vali Loss: 151.523 Vali Acc: 0.480 Test Loss: 151.523 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 4.418935298919678
Epoch: 26, Steps: 13 | Train Loss: 1.155 Vali Loss: 216.165 Vali Acc: 0.360 Test Loss: 216.165 Test Acc: 0.360
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 4.399279832839966
Epoch: 27, Steps: 13 | Train Loss: 6.704 Vali Loss: 124.563 Vali Acc: 0.460 Test Loss: 124.563 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 4.146494150161743
Epoch: 28, Steps: 13 | Train Loss: 0.000 Vali Loss: 126.373 Vali Acc: 0.460 Test Loss: 126.373 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 16954281
model size : 67.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 6.126455307006836
Epoch: 1, Steps: 13 | Train Loss: 12.522 Vali Loss: 22.144 Vali Acc: 0.220 Test Loss: 22.144 Test Acc: 0.220
Validation loss decreased (inf --> -0.219779).  Saving model ...
Epoch: 2 cost time: 4.7097790241241455
Epoch: 2, Steps: 13 | Train Loss: 21.091 Vali Loss: 51.610 Vali Acc: 0.240 Test Loss: 51.610 Test Acc: 0.240
Validation loss decreased (-0.219779 --> -0.239484).  Saving model ...
Epoch: 3 cost time: 4.421212196350098
Epoch: 3, Steps: 13 | Train Loss: 47.017 Vali Loss: 41.347 Vali Acc: 0.380 Test Loss: 41.347 Test Acc: 0.380
Validation loss decreased (-0.239484 --> -0.379587).  Saving model ...
Epoch: 4 cost time: 4.451253890991211
Epoch: 4, Steps: 13 | Train Loss: 45.167 Vali Loss: 120.833 Vali Acc: 0.240 Test Loss: 120.833 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.42082953453064
Epoch: 5, Steps: 13 | Train Loss: 110.222 Vali Loss: 147.870 Vali Acc: 0.240 Test Loss: 147.870 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.311820030212402
Epoch: 6, Steps: 13 | Train Loss: 59.740 Vali Loss: 77.786 Vali Acc: 0.340 Test Loss: 77.786 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.141118764877319
Epoch: 7, Steps: 13 | Train Loss: 50.506 Vali Loss: 162.826 Vali Acc: 0.300 Test Loss: 162.826 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.214210271835327
Epoch: 8, Steps: 13 | Train Loss: 104.637 Vali Loss: 109.785 Vali Acc: 0.540 Test Loss: 109.785 Test Acc: 0.540
Validation loss decreased (-0.379587 --> -0.538902).  Saving model ...
Epoch: 9 cost time: 4.101339101791382
Epoch: 9, Steps: 13 | Train Loss: 49.279 Vali Loss: 92.171 Vali Acc: 0.420 Test Loss: 92.171 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.3015220165252686
Epoch: 10, Steps: 13 | Train Loss: 32.153 Vali Loss: 100.196 Vali Acc: 0.400 Test Loss: 100.196 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.209892988204956
Epoch: 11, Steps: 13 | Train Loss: 17.742 Vali Loss: 87.802 Vali Acc: 0.420 Test Loss: 87.802 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.308534622192383
Epoch: 12, Steps: 13 | Train Loss: 9.446 Vali Loss: 107.640 Vali Acc: 0.460 Test Loss: 107.640 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.298977375030518
Epoch: 13, Steps: 13 | Train Loss: 0.937 Vali Loss: 80.173 Vali Acc: 0.440 Test Loss: 80.173 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.136148929595947
Epoch: 14, Steps: 13 | Train Loss: 30.520 Vali Loss: 133.231 Vali Acc: 0.440 Test Loss: 133.231 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.238614559173584
Epoch: 15, Steps: 13 | Train Loss: 34.486 Vali Loss: 81.054 Vali Acc: 0.560 Test Loss: 81.054 Test Acc: 0.560
Validation loss decreased (-0.538902 --> -0.559189).  Saving model ...
Epoch: 16 cost time: 4.2152369022369385
Epoch: 16, Steps: 13 | Train Loss: 3.944 Vali Loss: 147.059 Vali Acc: 0.440 Test Loss: 147.059 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.495248317718506
Epoch: 17, Steps: 13 | Train Loss: 12.480 Vali Loss: 113.202 Vali Acc: 0.480 Test Loss: 113.202 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.449274063110352
Epoch: 18, Steps: 13 | Train Loss: 4.222 Vali Loss: 128.157 Vali Acc: 0.380 Test Loss: 128.157 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.070684432983398
Epoch: 19, Steps: 13 | Train Loss: 7.712 Vali Loss: 92.974 Vali Acc: 0.540 Test Loss: 92.974 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.405693054199219
Epoch: 20, Steps: 13 | Train Loss: 9.395 Vali Loss: 98.894 Vali Acc: 0.440 Test Loss: 98.894 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.275431394577026
Epoch: 21, Steps: 13 | Train Loss: 3.412 Vali Loss: 194.837 Vali Acc: 0.320 Test Loss: 194.837 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.3065643310546875
Epoch: 22, Steps: 13 | Train Loss: 2.274 Vali Loss: 94.262 Vali Acc: 0.480 Test Loss: 94.262 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 4.464681148529053
Epoch: 23, Steps: 13 | Train Loss: 0.000 Vali Loss: 95.888 Vali Acc: 0.480 Test Loss: 95.888 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.473758220672607
Epoch: 24, Steps: 13 | Train Loss: 0.192 Vali Loss: 87.528 Vali Acc: 0.540 Test Loss: 87.528 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 4.558090448379517
Epoch: 25, Steps: 13 | Train Loss: 0.000 Vali Loss: 155.255 Vali Acc: 0.500 Test Loss: 155.255 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 16949801
model size : 67.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.801954030990601
Epoch: 1, Steps: 13 | Train Loss: 16.312 Vali Loss: 45.011 Vali Acc: 0.200 Test Loss: 45.011 Test Acc: 0.200
Validation loss decreased (inf --> -0.199550).  Saving model ...
Epoch: 2 cost time: 4.089887857437134
Epoch: 2, Steps: 13 | Train Loss: 21.592 Vali Loss: 33.162 Vali Acc: 0.260 Test Loss: 33.162 Test Acc: 0.260
Validation loss decreased (-0.199550 --> -0.259668).  Saving model ...
Epoch: 3 cost time: 4.160682916641235
Epoch: 3, Steps: 13 | Train Loss: 39.669 Vali Loss: 80.704 Vali Acc: 0.320 Test Loss: 80.704 Test Acc: 0.320
Validation loss decreased (-0.259668 --> -0.319193).  Saving model ...
Epoch: 4 cost time: 4.175288438796997
Epoch: 4, Steps: 13 | Train Loss: 57.327 Vali Loss: 119.106 Vali Acc: 0.340 Test Loss: 119.106 Test Acc: 0.340
Validation loss decreased (-0.319193 --> -0.338809).  Saving model ...
Epoch: 5 cost time: 4.330215215682983
Epoch: 5, Steps: 13 | Train Loss: 149.409 Vali Loss: 130.007 Vali Acc: 0.420 Test Loss: 130.007 Test Acc: 0.420
Validation loss decreased (-0.338809 --> -0.418700).  Saving model ...
Epoch: 6 cost time: 4.236144304275513
Epoch: 6, Steps: 13 | Train Loss: 109.123 Vali Loss: 120.345 Vali Acc: 0.300 Test Loss: 120.345 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.212120532989502
Epoch: 7, Steps: 13 | Train Loss: 60.211 Vali Loss: 202.354 Vali Acc: 0.400 Test Loss: 202.354 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.164100170135498
Epoch: 8, Steps: 13 | Train Loss: 109.185 Vali Loss: 119.655 Vali Acc: 0.380 Test Loss: 119.655 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.228167533874512
Epoch: 9, Steps: 13 | Train Loss: 20.249 Vali Loss: 67.581 Vali Acc: 0.420 Test Loss: 67.581 Test Acc: 0.420
Validation loss decreased (-0.418700 --> -0.419324).  Saving model ...
Epoch: 10 cost time: 4.071972846984863
Epoch: 10, Steps: 13 | Train Loss: 14.290 Vali Loss: 106.883 Vali Acc: 0.340 Test Loss: 106.883 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.288494110107422
Epoch: 11, Steps: 13 | Train Loss: 33.125 Vali Loss: 56.542 Vali Acc: 0.500 Test Loss: 56.542 Test Acc: 0.500
Validation loss decreased (-0.419324 --> -0.499435).  Saving model ...
Epoch: 12 cost time: 4.226273775100708
Epoch: 12, Steps: 13 | Train Loss: 26.620 Vali Loss: 176.045 Vali Acc: 0.460 Test Loss: 176.045 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.077639579772949
Epoch: 13, Steps: 13 | Train Loss: 51.649 Vali Loss: 92.390 Vali Acc: 0.500 Test Loss: 92.390 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.107543706893921
Epoch: 14, Steps: 13 | Train Loss: 12.235 Vali Loss: 116.835 Vali Acc: 0.560 Test Loss: 116.835 Test Acc: 0.560
Validation loss decreased (-0.499435 --> -0.558832).  Saving model ...
Epoch: 15 cost time: 4.18934965133667
Epoch: 15, Steps: 13 | Train Loss: 9.017 Vali Loss: 113.349 Vali Acc: 0.460 Test Loss: 113.349 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.241614818572998
Epoch: 16, Steps: 13 | Train Loss: 5.380 Vali Loss: 112.679 Vali Acc: 0.460 Test Loss: 112.679 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.214077711105347
Epoch: 17, Steps: 13 | Train Loss: 26.312 Vali Loss: 97.237 Vali Acc: 0.460 Test Loss: 97.237 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.462613582611084
Epoch: 18, Steps: 13 | Train Loss: 17.300 Vali Loss: 118.904 Vali Acc: 0.500 Test Loss: 118.904 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.693680286407471
Epoch: 19, Steps: 13 | Train Loss: 17.898 Vali Loss: 134.395 Vali Acc: 0.520 Test Loss: 134.395 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.536343336105347
Epoch: 20, Steps: 13 | Train Loss: 20.472 Vali Loss: 84.608 Vali Acc: 0.460 Test Loss: 84.608 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.77539849281311
Epoch: 21, Steps: 13 | Train Loss: 3.934 Vali Loss: 90.704 Vali Acc: 0.540 Test Loss: 90.704 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.41448974609375
Epoch: 22, Steps: 13 | Train Loss: 0.000 Vali Loss: 140.867 Vali Acc: 0.440 Test Loss: 140.867 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.606981039047241
Epoch: 23, Steps: 13 | Train Loss: 6.306 Vali Loss: 99.306 Vali Acc: 0.400 Test Loss: 99.306 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 4.5608460903167725
Epoch: 24, Steps: 13 | Train Loss: 7.793 Vali Loss: 111.027 Vali Acc: 0.520 Test Loss: 111.027 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 16945321
model size : 67.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.312071084976196
Epoch: 1, Steps: 13 | Train Loss: 11.963 Vali Loss: 45.473 Vali Acc: 0.200 Test Loss: 45.473 Test Acc: 0.200
Validation loss decreased (inf --> -0.199545).  Saving model ...
Epoch: 2 cost time: 3.875340461730957
Epoch: 2, Steps: 13 | Train Loss: 43.124 Vali Loss: 56.772 Vali Acc: 0.200 Test Loss: 56.772 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.8831965923309326
Epoch: 3, Steps: 13 | Train Loss: 37.080 Vali Loss: 72.208 Vali Acc: 0.240 Test Loss: 72.208 Test Acc: 0.240
Validation loss decreased (-0.199545 --> -0.239278).  Saving model ...
Epoch: 4 cost time: 3.906891345977783
Epoch: 4, Steps: 13 | Train Loss: 24.848 Vali Loss: 45.777 Vali Acc: 0.240 Test Loss: 45.777 Test Acc: 0.240
Validation loss decreased (-0.239278 --> -0.239542).  Saving model ...
Epoch: 5 cost time: 3.988886833190918
Epoch: 5, Steps: 13 | Train Loss: 32.380 Vali Loss: 46.742 Vali Acc: 0.300 Test Loss: 46.742 Test Acc: 0.300
Validation loss decreased (-0.239542 --> -0.299533).  Saving model ...
Epoch: 6 cost time: 3.855313539505005
Epoch: 6, Steps: 13 | Train Loss: 49.914 Vali Loss: 38.396 Vali Acc: 0.400 Test Loss: 38.396 Test Acc: 0.400
Validation loss decreased (-0.299533 --> -0.399616).  Saving model ...
Epoch: 7 cost time: 3.8818163871765137
Epoch: 7, Steps: 13 | Train Loss: 60.233 Vali Loss: 121.147 Vali Acc: 0.320 Test Loss: 121.147 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.9275293350219727
Epoch: 8, Steps: 13 | Train Loss: 53.343 Vali Loss: 104.826 Vali Acc: 0.300 Test Loss: 104.826 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.04302453994751
Epoch: 9, Steps: 13 | Train Loss: 64.722 Vali Loss: 104.059 Vali Acc: 0.400 Test Loss: 104.059 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.937835931777954
Epoch: 10, Steps: 13 | Train Loss: 47.759 Vali Loss: 86.212 Vali Acc: 0.500 Test Loss: 86.212 Test Acc: 0.500
Validation loss decreased (-0.399616 --> -0.499138).  Saving model ...
Epoch: 11 cost time: 4.355851888656616
Epoch: 11, Steps: 13 | Train Loss: 34.725 Vali Loss: 190.858 Vali Acc: 0.340 Test Loss: 190.858 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.9624385833740234
Epoch: 12, Steps: 13 | Train Loss: 28.093 Vali Loss: 134.992 Vali Acc: 0.440 Test Loss: 134.992 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.983576536178589
Epoch: 13, Steps: 13 | Train Loss: 10.366 Vali Loss: 196.258 Vali Acc: 0.340 Test Loss: 196.258 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.156428575515747
Epoch: 14, Steps: 13 | Train Loss: 26.582 Vali Loss: 97.359 Vali Acc: 0.520 Test Loss: 97.359 Test Acc: 0.520
Validation loss decreased (-0.499138 --> -0.519026).  Saving model ...
Epoch: 15 cost time: 3.951002359390259
Epoch: 15, Steps: 13 | Train Loss: 22.842 Vali Loss: 94.842 Vali Acc: 0.540 Test Loss: 94.842 Test Acc: 0.540
Validation loss decreased (-0.519026 --> -0.539052).  Saving model ...
Epoch: 16 cost time: 3.9788155555725098
Epoch: 16, Steps: 13 | Train Loss: 14.176 Vali Loss: 137.243 Vali Acc: 0.380 Test Loss: 137.243 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.051232576370239
Epoch: 17, Steps: 13 | Train Loss: 19.648 Vali Loss: 150.711 Vali Acc: 0.440 Test Loss: 150.711 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.7472004890441895
Epoch: 18, Steps: 13 | Train Loss: 23.362 Vali Loss: 214.847 Vali Acc: 0.480 Test Loss: 214.847 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.206649541854858
Epoch: 19, Steps: 13 | Train Loss: 15.893 Vali Loss: 116.544 Vali Acc: 0.460 Test Loss: 116.544 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.181941032409668
Epoch: 20, Steps: 13 | Train Loss: 8.628 Vali Loss: 187.311 Vali Acc: 0.500 Test Loss: 187.311 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.9840495586395264
Epoch: 21, Steps: 13 | Train Loss: 14.507 Vali Loss: 79.899 Vali Acc: 0.540 Test Loss: 79.899 Test Acc: 0.540
Validation loss decreased (-0.539052 --> -0.539201).  Saving model ...
Epoch: 22 cost time: 3.7142062187194824
Epoch: 22, Steps: 13 | Train Loss: 4.632 Vali Loss: 164.432 Vali Acc: 0.520 Test Loss: 164.432 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.065213441848755
Epoch: 23, Steps: 13 | Train Loss: 8.787 Vali Loss: 102.055 Vali Acc: 0.500 Test Loss: 102.055 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.075254201889038
Epoch: 24, Steps: 13 | Train Loss: 4.920 Vali Loss: 162.215 Vali Acc: 0.440 Test Loss: 162.215 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 4.0446343421936035
Epoch: 25, Steps: 13 | Train Loss: 4.228 Vali Loss: 311.932 Vali Acc: 0.340 Test Loss: 311.932 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.913426399230957
Epoch: 26, Steps: 13 | Train Loss: 21.616 Vali Loss: 152.099 Vali Acc: 0.520 Test Loss: 152.099 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 4.102756023406982
Epoch: 27, Steps: 13 | Train Loss: 6.722 Vali Loss: 171.564 Vali Acc: 0.500 Test Loss: 171.564 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.9434211254119873
Epoch: 28, Steps: 13 | Train Loss: 0.000 Vali Loss: 180.122 Vali Acc: 0.560 Test Loss: 180.122 Test Acc: 0.560
Validation loss decreased (-0.539201 --> -0.558199).  Saving model ...
Epoch: 29 cost time: 4.021552085876465
Epoch: 29, Steps: 13 | Train Loss: 3.142 Vali Loss: 152.328 Vali Acc: 0.560 Test Loss: 152.328 Test Acc: 0.560
Validation loss decreased (-0.558199 --> -0.558477).  Saving model ...
Epoch: 30 cost time: 3.781755208969116
Epoch: 30, Steps: 13 | Train Loss: 0.000 Vali Loss: 160.920 Vali Acc: 0.560 Test Loss: 160.920 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 4.027708530426025
Epoch: 31, Steps: 13 | Train Loss: 4.200 Vali Loss: 165.201 Vali Acc: 0.500 Test Loss: 165.201 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.8866944313049316
Epoch: 32, Steps: 13 | Train Loss: 0.914 Vali Loss: 157.490 Vali Acc: 0.620 Test Loss: 157.490 Test Acc: 0.620
Validation loss decreased (-0.558477 --> -0.618425).  Saving model ...
Epoch: 33 cost time: 3.9529030323028564
Epoch: 33, Steps: 13 | Train Loss: 0.000 Vali Loss: 184.311 Vali Acc: 0.540 Test Loss: 184.311 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 4.190437078475952
Epoch: 34, Steps: 13 | Train Loss: 0.000 Vali Loss: 197.017 Vali Acc: 0.520 Test Loss: 197.017 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.8491809368133545
Epoch: 35, Steps: 13 | Train Loss: 0.000 Vali Loss: 200.534 Vali Acc: 0.520 Test Loss: 200.534 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 4.124077796936035
Epoch: 36, Steps: 13 | Train Loss: 0.000 Vali Loss: 201.453 Vali Acc: 0.520 Test Loss: 201.453 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 3.8912980556488037
Epoch: 37, Steps: 13 | Train Loss: 0.000 Vali Loss: 201.693 Vali Acc: 0.520 Test Loss: 201.693 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 3.9774515628814697
Epoch: 38, Steps: 13 | Train Loss: 0.000 Vali Loss: 201.756 Vali Acc: 0.520 Test Loss: 201.756 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 3.7804150581359863
Epoch: 39, Steps: 13 | Train Loss: 0.000 Vali Loss: 201.773 Vali Acc: 0.520 Test Loss: 201.773 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 4.136141538619995
Epoch: 40, Steps: 13 | Train Loss: 0.000 Vali Loss: 201.777 Vali Acc: 0.520 Test Loss: 201.777 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 4.297207832336426
Epoch: 41, Steps: 13 | Train Loss: 0.000 Vali Loss: 201.778 Vali Acc: 0.520 Test Loss: 201.778 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 4.2750563621521
Epoch: 42, Steps: 13 | Train Loss: 0.000 Vali Loss: 201.778 Vali Acc: 0.520 Test Loss: 201.778 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 16300841
model size : 64.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.8703882694244385
Epoch: 1, Steps: 13 | Train Loss: 24.059 Vali Loss: 58.371 Vali Acc: 0.200 Test Loss: 58.371 Test Acc: 0.200
Validation loss decreased (inf --> -0.199416).  Saving model ...
Epoch: 2 cost time: 4.116781711578369
Epoch: 2, Steps: 13 | Train Loss: 32.936 Vali Loss: 23.382 Vali Acc: 0.260 Test Loss: 23.382 Test Acc: 0.260
Validation loss decreased (-0.199416 --> -0.259766).  Saving model ...
Epoch: 3 cost time: 4.11526894569397
Epoch: 3, Steps: 13 | Train Loss: 18.947 Vali Loss: 53.942 Vali Acc: 0.380 Test Loss: 53.942 Test Acc: 0.380
Validation loss decreased (-0.259766 --> -0.379461).  Saving model ...
Epoch: 4 cost time: 3.915982484817505
Epoch: 4, Steps: 13 | Train Loss: 38.297 Vali Loss: 127.279 Vali Acc: 0.200 Test Loss: 127.279 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.8264858722686768
Epoch: 5, Steps: 13 | Train Loss: 55.179 Vali Loss: 29.314 Vali Acc: 0.340 Test Loss: 29.314 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.054358959197998
Epoch: 6, Steps: 13 | Train Loss: 38.217 Vali Loss: 71.995 Vali Acc: 0.300 Test Loss: 71.995 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.911522626876831
Epoch: 7, Steps: 13 | Train Loss: 63.346 Vali Loss: 78.320 Vali Acc: 0.340 Test Loss: 78.320 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.042057275772095
Epoch: 8, Steps: 13 | Train Loss: 27.533 Vali Loss: 66.607 Vali Acc: 0.420 Test Loss: 66.607 Test Acc: 0.420
Validation loss decreased (-0.379461 --> -0.419334).  Saving model ...
Epoch: 9 cost time: 4.024705171585083
Epoch: 9, Steps: 13 | Train Loss: 36.578 Vali Loss: 107.729 Vali Acc: 0.300 Test Loss: 107.729 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.1076881885528564
Epoch: 10, Steps: 13 | Train Loss: 33.330 Vali Loss: 55.981 Vali Acc: 0.500 Test Loss: 55.981 Test Acc: 0.500
Validation loss decreased (-0.419334 --> -0.499440).  Saving model ...
Epoch: 11 cost time: 4.105799674987793
Epoch: 11, Steps: 13 | Train Loss: 29.145 Vali Loss: 131.034 Vali Acc: 0.400 Test Loss: 131.034 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.01902961730957
Epoch: 12, Steps: 13 | Train Loss: 38.466 Vali Loss: 124.305 Vali Acc: 0.400 Test Loss: 124.305 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.214428901672363
Epoch: 13, Steps: 13 | Train Loss: 26.458 Vali Loss: 133.792 Vali Acc: 0.320 Test Loss: 133.792 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.154436111450195
Epoch: 14, Steps: 13 | Train Loss: 56.875 Vali Loss: 128.675 Vali Acc: 0.360 Test Loss: 128.675 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.162336349487305
Epoch: 15, Steps: 13 | Train Loss: 16.535 Vali Loss: 166.466 Vali Acc: 0.420 Test Loss: 166.466 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.057184219360352
Epoch: 16, Steps: 13 | Train Loss: 47.305 Vali Loss: 117.441 Vali Acc: 0.500 Test Loss: 117.441 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.007268190383911
Epoch: 17, Steps: 13 | Train Loss: 8.067 Vali Loss: 141.880 Vali Acc: 0.380 Test Loss: 141.880 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.104724645614624
Epoch: 18, Steps: 13 | Train Loss: 6.003 Vali Loss: 85.152 Vali Acc: 0.500 Test Loss: 85.152 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.182110071182251
Epoch: 19, Steps: 13 | Train Loss: 12.819 Vali Loss: 136.142 Vali Acc: 0.380 Test Loss: 136.142 Test Acc: 0.380
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.9067394733428955
Epoch: 20, Steps: 13 | Train Loss: 33.190 Vali Loss: 169.081 Vali Acc: 0.460 Test Loss: 169.081 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 16296361
model size : 64.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 6.710916042327881
Epoch: 1, Steps: 13 | Train Loss: 15.331 Vali Loss: 53.090 Vali Acc: 0.200 Test Loss: 53.090 Test Acc: 0.200
Validation loss decreased (inf --> -0.199469).  Saving model ...
Epoch: 2 cost time: 3.9107213020324707
Epoch: 2, Steps: 13 | Train Loss: 38.189 Vali Loss: 42.625 Vali Acc: 0.200 Test Loss: 42.625 Test Acc: 0.200
Validation loss decreased (-0.199469 --> -0.199574).  Saving model ...
Epoch: 3 cost time: 3.970574140548706
Epoch: 3, Steps: 13 | Train Loss: 27.544 Vali Loss: 38.015 Vali Acc: 0.360 Test Loss: 38.015 Test Acc: 0.360
Validation loss decreased (-0.199574 --> -0.359620).  Saving model ...
Epoch: 4 cost time: 4.046459436416626
Epoch: 4, Steps: 13 | Train Loss: 59.162 Vali Loss: 35.750 Vali Acc: 0.280 Test Loss: 35.750 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.874157428741455
Epoch: 5, Steps: 13 | Train Loss: 46.620 Vali Loss: 119.774 Vali Acc: 0.440 Test Loss: 119.774 Test Acc: 0.440
Validation loss decreased (-0.359620 --> -0.438802).  Saving model ...
Epoch: 6 cost time: 3.8473434448242188
Epoch: 6, Steps: 13 | Train Loss: 86.527 Vali Loss: 119.081 Vali Acc: 0.240 Test Loss: 119.081 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.361482620239258
Epoch: 7, Steps: 13 | Train Loss: 52.521 Vali Loss: 111.865 Vali Acc: 0.500 Test Loss: 111.865 Test Acc: 0.500
Validation loss decreased (-0.438802 --> -0.498881).  Saving model ...
Epoch: 8 cost time: 3.960707187652588
Epoch: 8, Steps: 13 | Train Loss: 46.617 Vali Loss: 119.457 Vali Acc: 0.280 Test Loss: 119.457 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.093379735946655
Epoch: 9, Steps: 13 | Train Loss: 20.548 Vali Loss: 65.804 Vali Acc: 0.580 Test Loss: 65.804 Test Acc: 0.580
Validation loss decreased (-0.498881 --> -0.579342).  Saving model ...
Epoch: 10 cost time: 3.8005363941192627
Epoch: 10, Steps: 13 | Train Loss: 20.228 Vali Loss: 137.071 Vali Acc: 0.360 Test Loss: 137.071 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.9390053749084473
Epoch: 11, Steps: 13 | Train Loss: 20.878 Vali Loss: 146.135 Vali Acc: 0.400 Test Loss: 146.135 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.278184413909912
Epoch: 12, Steps: 13 | Train Loss: 46.506 Vali Loss: 157.868 Vali Acc: 0.380 Test Loss: 157.868 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.1544506549835205
Epoch: 13, Steps: 13 | Train Loss: 21.874 Vali Loss: 115.001 Vali Acc: 0.480 Test Loss: 115.001 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.291746377944946
Epoch: 14, Steps: 13 | Train Loss: 14.391 Vali Loss: 103.099 Vali Acc: 0.540 Test Loss: 103.099 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.084322690963745
Epoch: 15, Steps: 13 | Train Loss: 18.179 Vali Loss: 189.800 Vali Acc: 0.340 Test Loss: 189.800 Test Acc: 0.340
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.8245084285736084
Epoch: 16, Steps: 13 | Train Loss: 26.800 Vali Loss: 184.495 Vali Acc: 0.400 Test Loss: 184.495 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.159308671951294
Epoch: 17, Steps: 13 | Train Loss: 17.567 Vali Loss: 108.327 Vali Acc: 0.600 Test Loss: 108.327 Test Acc: 0.600
Validation loss decreased (-0.579342 --> -0.598917).  Saving model ...
Epoch: 18 cost time: 3.97562837600708
Epoch: 18, Steps: 13 | Train Loss: 3.574 Vali Loss: 120.777 Vali Acc: 0.540 Test Loss: 120.777 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.9590744972229004
Epoch: 19, Steps: 13 | Train Loss: 0.089 Vali Loss: 189.700 Vali Acc: 0.400 Test Loss: 189.700 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.0641443729400635
Epoch: 20, Steps: 13 | Train Loss: 16.170 Vali Loss: 246.823 Vali Acc: 0.360 Test Loss: 246.823 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.91166353225708
Epoch: 21, Steps: 13 | Train Loss: 16.809 Vali Loss: 134.559 Vali Acc: 0.560 Test Loss: 134.559 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.2574567794799805
Epoch: 22, Steps: 13 | Train Loss: 6.978 Vali Loss: 112.877 Vali Acc: 0.560 Test Loss: 112.877 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.18200945854187
Epoch: 23, Steps: 13 | Train Loss: 9.264 Vali Loss: 144.771 Vali Acc: 0.500 Test Loss: 144.771 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 4.0876405239105225
Epoch: 24, Steps: 13 | Train Loss: 1.957 Vali Loss: 155.438 Vali Acc: 0.440 Test Loss: 155.438 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.9202077388763428
Epoch: 25, Steps: 13 | Train Loss: 0.003 Vali Loss: 147.630 Vali Acc: 0.520 Test Loss: 147.630 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 4.047521352767944
Epoch: 26, Steps: 13 | Train Loss: 1.851 Vali Loss: 253.748 Vali Acc: 0.380 Test Loss: 253.748 Test Acc: 0.380
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 4.075395345687866
Epoch: 27, Steps: 13 | Train Loss: 11.926 Vali Loss: 109.886 Vali Acc: 0.540 Test Loss: 109.886 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 16291881
model size : 64.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 6.3606438636779785
Epoch: 1, Steps: 13 | Train Loss: 13.957 Vali Loss: 25.542 Vali Acc: 0.200 Test Loss: 25.542 Test Acc: 0.200
Validation loss decreased (inf --> -0.199745).  Saving model ...
Epoch: 2 cost time: 3.998558282852173
Epoch: 2, Steps: 13 | Train Loss: 42.675 Vali Loss: 43.358 Vali Acc: 0.280 Test Loss: 43.358 Test Acc: 0.280
Validation loss decreased (-0.199745 --> -0.279566).  Saving model ...
Epoch: 3 cost time: 4.015340566635132
Epoch: 3, Steps: 13 | Train Loss: 36.395 Vali Loss: 52.804 Vali Acc: 0.220 Test Loss: 52.804 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.255048513412476
Epoch: 4, Steps: 13 | Train Loss: 41.316 Vali Loss: 55.458 Vali Acc: 0.360 Test Loss: 55.458 Test Acc: 0.360
Validation loss decreased (-0.279566 --> -0.359445).  Saving model ...
Epoch: 5 cost time: 3.9157443046569824
Epoch: 5, Steps: 13 | Train Loss: 62.308 Vali Loss: 106.312 Vali Acc: 0.360 Test Loss: 106.312 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.18796181678772
Epoch: 6, Steps: 13 | Train Loss: 56.098 Vali Loss: 33.928 Vali Acc: 0.520 Test Loss: 33.928 Test Acc: 0.520
Validation loss decreased (-0.359445 --> -0.519661).  Saving model ...
Epoch: 7 cost time: 4.0518105030059814
Epoch: 7, Steps: 13 | Train Loss: 29.247 Vali Loss: 104.721 Vali Acc: 0.260 Test Loss: 104.721 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.989758253097534
Epoch: 8, Steps: 13 | Train Loss: 48.703 Vali Loss: 87.843 Vali Acc: 0.440 Test Loss: 87.843 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.9785869121551514
Epoch: 9, Steps: 13 | Train Loss: 70.110 Vali Loss: 119.440 Vali Acc: 0.400 Test Loss: 119.440 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.9749903678894043
Epoch: 10, Steps: 13 | Train Loss: 73.992 Vali Loss: 105.912 Vali Acc: 0.400 Test Loss: 105.912 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.020400047302246
Epoch: 11, Steps: 13 | Train Loss: 50.694 Vali Loss: 94.888 Vali Acc: 0.520 Test Loss: 94.888 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.113023519515991
Epoch: 12, Steps: 13 | Train Loss: 15.072 Vali Loss: 104.517 Vali Acc: 0.360 Test Loss: 104.517 Test Acc: 0.360
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.100015878677368
Epoch: 13, Steps: 13 | Train Loss: 47.497 Vali Loss: 141.684 Vali Acc: 0.460 Test Loss: 141.684 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.012836694717407
Epoch: 14, Steps: 13 | Train Loss: 33.775 Vali Loss: 248.693 Vali Acc: 0.480 Test Loss: 248.693 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.177838087081909
Epoch: 15, Steps: 13 | Train Loss: 56.924 Vali Loss: 128.437 Vali Acc: 0.400 Test Loss: 128.437 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.044217824935913
Epoch: 16, Steps: 13 | Train Loss: 20.076 Vali Loss: 107.996 Vali Acc: 0.500 Test Loss: 107.996 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 16287401
model size : 64.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.6983466148376465
Epoch: 1, Steps: 13 | Train Loss: 19.157 Vali Loss: 31.148 Vali Acc: 0.200 Test Loss: 31.148 Test Acc: 0.200
Validation loss decreased (inf --> -0.199689).  Saving model ...
Epoch: 2 cost time: 3.988100290298462
Epoch: 2, Steps: 13 | Train Loss: 19.070 Vali Loss: 39.135 Vali Acc: 0.260 Test Loss: 39.135 Test Acc: 0.260
Validation loss decreased (-0.199689 --> -0.259609).  Saving model ...
Epoch: 3 cost time: 4.099061012268066
Epoch: 3, Steps: 13 | Train Loss: 28.891 Vali Loss: 56.449 Vali Acc: 0.240 Test Loss: 56.449 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.099819898605347
Epoch: 4, Steps: 13 | Train Loss: 34.780 Vali Loss: 85.910 Vali Acc: 0.280 Test Loss: 85.910 Test Acc: 0.280
Validation loss decreased (-0.259609 --> -0.279141).  Saving model ...
Epoch: 5 cost time: 3.84747052192688
Epoch: 5, Steps: 13 | Train Loss: 44.430 Vali Loss: 101.073 Vali Acc: 0.360 Test Loss: 101.073 Test Acc: 0.360
Validation loss decreased (-0.279141 --> -0.358989).  Saving model ...
Epoch: 6 cost time: 4.148557901382446
Epoch: 6, Steps: 13 | Train Loss: 40.628 Vali Loss: 81.240 Vali Acc: 0.400 Test Loss: 81.240 Test Acc: 0.400
Validation loss decreased (-0.358989 --> -0.399188).  Saving model ...
Epoch: 7 cost time: 3.7781264781951904
Epoch: 7, Steps: 13 | Train Loss: 49.440 Vali Loss: 104.235 Vali Acc: 0.340 Test Loss: 104.235 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.261725187301636
Epoch: 8, Steps: 13 | Train Loss: 61.558 Vali Loss: 80.279 Vali Acc: 0.540 Test Loss: 80.279 Test Acc: 0.540
Validation loss decreased (-0.399188 --> -0.539197).  Saving model ...
Epoch: 9 cost time: 3.821864128112793
Epoch: 9, Steps: 13 | Train Loss: 82.854 Vali Loss: 76.926 Vali Acc: 0.480 Test Loss: 76.926 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.916654109954834
Epoch: 10, Steps: 13 | Train Loss: 28.270 Vali Loss: 123.190 Vali Acc: 0.340 Test Loss: 123.190 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.8990023136138916
Epoch: 11, Steps: 13 | Train Loss: 47.024 Vali Loss: 172.061 Vali Acc: 0.340 Test Loss: 172.061 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.123078107833862
Epoch: 12, Steps: 13 | Train Loss: 35.105 Vali Loss: 143.788 Vali Acc: 0.520 Test Loss: 143.788 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.977283239364624
Epoch: 13, Steps: 13 | Train Loss: 29.794 Vali Loss: 157.624 Vali Acc: 0.520 Test Loss: 157.624 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.9039738178253174
Epoch: 14, Steps: 13 | Train Loss: 37.913 Vali Loss: 162.198 Vali Acc: 0.480 Test Loss: 162.198 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.9621880054473877
Epoch: 15, Steps: 13 | Train Loss: 36.542 Vali Loss: 226.768 Vali Acc: 0.380 Test Loss: 226.768 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.997236967086792
Epoch: 16, Steps: 13 | Train Loss: 102.120 Vali Loss: 217.545 Vali Acc: 0.340 Test Loss: 217.545 Test Acc: 0.340
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.84829044342041
Epoch: 17, Steps: 13 | Train Loss: 17.836 Vali Loss: 260.585 Vali Acc: 0.400 Test Loss: 260.585 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.1633241176605225
Epoch: 18, Steps: 13 | Train Loss: 16.717 Vali Loss: 227.773 Vali Acc: 0.400 Test Loss: 227.773 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 15971881
model size : 63.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 6.548020839691162
Epoch: 1, Steps: 13 | Train Loss: 9.737 Vali Loss: 29.346 Vali Acc: 0.320 Test Loss: 29.346 Test Acc: 0.320
Validation loss decreased (inf --> -0.319707).  Saving model ...
Epoch: 2 cost time: 3.858330249786377
Epoch: 2, Steps: 13 | Train Loss: 40.124 Vali Loss: 59.775 Vali Acc: 0.200 Test Loss: 59.775 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.795473337173462
Epoch: 3, Steps: 13 | Train Loss: 41.406 Vali Loss: 42.369 Vali Acc: 0.240 Test Loss: 42.369 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.9381463527679443
Epoch: 4, Steps: 13 | Train Loss: 47.626 Vali Loss: 41.264 Vali Acc: 0.300 Test Loss: 41.264 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.785407066345215
Epoch: 5, Steps: 13 | Train Loss: 43.875 Vali Loss: 103.959 Vali Acc: 0.360 Test Loss: 103.959 Test Acc: 0.360
Validation loss decreased (-0.319707 --> -0.358960).  Saving model ...
Epoch: 6 cost time: 3.983577251434326
Epoch: 6, Steps: 13 | Train Loss: 62.505 Vali Loss: 130.020 Vali Acc: 0.300 Test Loss: 130.020 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.968222141265869
Epoch: 7, Steps: 13 | Train Loss: 70.789 Vali Loss: 54.283 Vali Acc: 0.400 Test Loss: 54.283 Test Acc: 0.400
Validation loss decreased (-0.358960 --> -0.399457).  Saving model ...
Epoch: 8 cost time: 4.268740892410278
Epoch: 8, Steps: 13 | Train Loss: 27.958 Vali Loss: 43.845 Vali Acc: 0.460 Test Loss: 43.845 Test Acc: 0.460
Validation loss decreased (-0.399457 --> -0.459562).  Saving model ...
Epoch: 9 cost time: 4.2279372215271
Epoch: 9, Steps: 13 | Train Loss: 52.089 Vali Loss: 158.709 Vali Acc: 0.300 Test Loss: 158.709 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.583653450012207
Epoch: 10, Steps: 13 | Train Loss: 103.033 Vali Loss: 146.078 Vali Acc: 0.400 Test Loss: 146.078 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.109409809112549
Epoch: 11, Steps: 13 | Train Loss: 77.526 Vali Loss: 145.115 Vali Acc: 0.460 Test Loss: 145.115 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.147377252578735
Epoch: 12, Steps: 13 | Train Loss: 63.418 Vali Loss: 146.813 Vali Acc: 0.460 Test Loss: 146.813 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.430565118789673
Epoch: 13, Steps: 13 | Train Loss: 31.719 Vali Loss: 214.475 Vali Acc: 0.520 Test Loss: 214.475 Test Acc: 0.520
Validation loss decreased (-0.459562 --> -0.517855).  Saving model ...
Epoch: 14 cost time: 4.02429723739624
Epoch: 14, Steps: 13 | Train Loss: 57.625 Vali Loss: 194.529 Vali Acc: 0.500 Test Loss: 194.529 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.1794679164886475
Epoch: 15, Steps: 13 | Train Loss: 42.282 Vali Loss: 128.329 Vali Acc: 0.540 Test Loss: 128.329 Test Acc: 0.540
Validation loss decreased (-0.517855 --> -0.538717).  Saving model ...
Epoch: 16 cost time: 4.022948503494263
Epoch: 16, Steps: 13 | Train Loss: 16.051 Vali Loss: 152.150 Vali Acc: 0.560 Test Loss: 152.150 Test Acc: 0.560
Validation loss decreased (-0.538717 --> -0.558479).  Saving model ...
Epoch: 17 cost time: 3.9648211002349854
Epoch: 17, Steps: 13 | Train Loss: 14.868 Vali Loss: 137.270 Vali Acc: 0.560 Test Loss: 137.270 Test Acc: 0.560
Validation loss decreased (-0.558479 --> -0.558627).  Saving model ...
Epoch: 18 cost time: 4.174976110458374
Epoch: 18, Steps: 13 | Train Loss: 10.617 Vali Loss: 108.717 Vali Acc: 0.600 Test Loss: 108.717 Test Acc: 0.600
Validation loss decreased (-0.558627 --> -0.598913).  Saving model ...
Epoch: 19 cost time: 4.04300856590271
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 111.327 Vali Acc: 0.640 Test Loss: 111.327 Test Acc: 0.640
Validation loss decreased (-0.598913 --> -0.638887).  Saving model ...
Epoch: 20 cost time: 4.24517035484314
Epoch: 20, Steps: 13 | Train Loss: 0.000 Vali Loss: 127.870 Vali Acc: 0.520 Test Loss: 127.870 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.9195055961608887
Epoch: 21, Steps: 13 | Train Loss: 5.202 Vali Loss: 141.922 Vali Acc: 0.540 Test Loss: 141.922 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.093888521194458
Epoch: 22, Steps: 13 | Train Loss: 3.090 Vali Loss: 206.921 Vali Acc: 0.380 Test Loss: 206.921 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.942694664001465
Epoch: 23, Steps: 13 | Train Loss: 37.854 Vali Loss: 198.065 Vali Acc: 0.420 Test Loss: 198.065 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.894059181213379
Epoch: 24, Steps: 13 | Train Loss: 8.346 Vali Loss: 113.129 Vali Acc: 0.620 Test Loss: 113.129 Test Acc: 0.620
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.981738328933716
Epoch: 25, Steps: 13 | Train Loss: 0.000 Vali Loss: 125.264 Vali Acc: 0.520 Test Loss: 125.264 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.9225380420684814
Epoch: 26, Steps: 13 | Train Loss: 3.422 Vali Loss: 126.612 Vali Acc: 0.560 Test Loss: 126.612 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 4.345314979553223
Epoch: 27, Steps: 13 | Train Loss: 4.549 Vali Loss: 209.019 Vali Acc: 0.520 Test Loss: 209.019 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.9180514812469482
Epoch: 28, Steps: 13 | Train Loss: 18.942 Vali Loss: 147.865 Vali Acc: 0.540 Test Loss: 147.865 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 4.064596176147461
Epoch: 29, Steps: 13 | Train Loss: 0.000 Vali Loss: 162.374 Vali Acc: 0.620 Test Loss: 162.374 Test Acc: 0.620
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.64
model parameter : 15967401
model size : 63.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 6.554516792297363
Epoch: 1, Steps: 13 | Train Loss: 19.149 Vali Loss: 51.694 Vali Acc: 0.200 Test Loss: 51.694 Test Acc: 0.200
Validation loss decreased (inf --> -0.199483).  Saving model ...
Epoch: 2 cost time: 3.87394642829895
Epoch: 2, Steps: 13 | Train Loss: 22.988 Vali Loss: 46.716 Vali Acc: 0.180 Test Loss: 46.716 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.096192836761475
Epoch: 3, Steps: 13 | Train Loss: 31.431 Vali Loss: 46.609 Vali Acc: 0.260 Test Loss: 46.609 Test Acc: 0.260
Validation loss decreased (-0.199483 --> -0.259534).  Saving model ...
Epoch: 4 cost time: 3.691676378250122
Epoch: 4, Steps: 13 | Train Loss: 49.731 Vali Loss: 65.943 Vali Acc: 0.300 Test Loss: 65.943 Test Acc: 0.300
Validation loss decreased (-0.259534 --> -0.299341).  Saving model ...
Epoch: 5 cost time: 3.733971357345581
Epoch: 5, Steps: 13 | Train Loss: 42.752 Vali Loss: 57.812 Vali Acc: 0.280 Test Loss: 57.812 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.751065969467163
Epoch: 6, Steps: 13 | Train Loss: 31.938 Vali Loss: 91.678 Vali Acc: 0.320 Test Loss: 91.678 Test Acc: 0.320
Validation loss decreased (-0.299341 --> -0.319083).  Saving model ...
Epoch: 7 cost time: 3.840815305709839
Epoch: 7, Steps: 13 | Train Loss: 80.310 Vali Loss: 157.850 Vali Acc: 0.420 Test Loss: 157.850 Test Acc: 0.420
Validation loss decreased (-0.319083 --> -0.418421).  Saving model ...
Epoch: 8 cost time: 3.8533036708831787
Epoch: 8, Steps: 13 | Train Loss: 80.535 Vali Loss: 74.771 Vali Acc: 0.380 Test Loss: 74.771 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.0405988693237305
Epoch: 9, Steps: 13 | Train Loss: 40.022 Vali Loss: 128.464 Vali Acc: 0.360 Test Loss: 128.464 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.798433303833008
Epoch: 10, Steps: 13 | Train Loss: 37.951 Vali Loss: 125.066 Vali Acc: 0.400 Test Loss: 125.066 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.8918426036834717
Epoch: 11, Steps: 13 | Train Loss: 25.909 Vali Loss: 106.709 Vali Acc: 0.360 Test Loss: 106.709 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.945604085922241
Epoch: 12, Steps: 13 | Train Loss: 22.500 Vali Loss: 109.868 Vali Acc: 0.420 Test Loss: 109.868 Test Acc: 0.420
Validation loss decreased (-0.418421 --> -0.418901).  Saving model ...
Epoch: 13 cost time: 4.046083211898804
Epoch: 13, Steps: 13 | Train Loss: 13.591 Vali Loss: 181.602 Vali Acc: 0.500 Test Loss: 181.602 Test Acc: 0.500
Validation loss decreased (-0.418901 --> -0.498184).  Saving model ...
Epoch: 14 cost time: 4.065851449966431
Epoch: 14, Steps: 13 | Train Loss: 30.221 Vali Loss: 138.108 Vali Acc: 0.420 Test Loss: 138.108 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.087150573730469
Epoch: 15, Steps: 13 | Train Loss: 30.575 Vali Loss: 150.753 Vali Acc: 0.440 Test Loss: 150.753 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.8758416175842285
Epoch: 16, Steps: 13 | Train Loss: 29.226 Vali Loss: 126.821 Vali Acc: 0.420 Test Loss: 126.821 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.144695281982422
Epoch: 17, Steps: 13 | Train Loss: 21.986 Vali Loss: 154.558 Vali Acc: 0.540 Test Loss: 154.558 Test Acc: 0.540
Validation loss decreased (-0.498184 --> -0.538454).  Saving model ...
Epoch: 18 cost time: 3.7705183029174805
Epoch: 18, Steps: 13 | Train Loss: 13.856 Vali Loss: 130.246 Vali Acc: 0.460 Test Loss: 130.246 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.9100961685180664
Epoch: 19, Steps: 13 | Train Loss: 8.203 Vali Loss: 99.875 Vali Acc: 0.580 Test Loss: 99.875 Test Acc: 0.580
Validation loss decreased (-0.538454 --> -0.579001).  Saving model ...
Epoch: 20 cost time: 3.96081805229187
Epoch: 20, Steps: 13 | Train Loss: 19.057 Vali Loss: 165.328 Vali Acc: 0.460 Test Loss: 165.328 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.876936435699463
Epoch: 21, Steps: 13 | Train Loss: 19.121 Vali Loss: 175.713 Vali Acc: 0.420 Test Loss: 175.713 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.017520427703857
Epoch: 22, Steps: 13 | Train Loss: 4.817 Vali Loss: 169.448 Vali Acc: 0.380 Test Loss: 169.448 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.7713005542755127
Epoch: 23, Steps: 13 | Train Loss: 0.000 Vali Loss: 198.138 Vali Acc: 0.460 Test Loss: 198.138 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.9991462230682373
Epoch: 24, Steps: 13 | Train Loss: 4.702 Vali Loss: 166.187 Vali Acc: 0.380 Test Loss: 166.187 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.8717880249023438
Epoch: 25, Steps: 13 | Train Loss: 0.609 Vali Loss: 141.746 Vali Acc: 0.480 Test Loss: 141.746 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.974820613861084
Epoch: 26, Steps: 13 | Train Loss: 5.011 Vali Loss: 163.347 Vali Acc: 0.480 Test Loss: 163.347 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.746797800064087
Epoch: 27, Steps: 13 | Train Loss: 15.413 Vali Loss: 225.413 Vali Acc: 0.460 Test Loss: 225.413 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.8008365631103516
Epoch: 28, Steps: 13 | Train Loss: 4.899 Vali Loss: 212.879 Vali Acc: 0.480 Test Loss: 212.879 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.687513828277588
Epoch: 29, Steps: 13 | Train Loss: 18.658 Vali Loss: 205.760 Vali Acc: 0.520 Test Loss: 205.760 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 15962921
model size : 63.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.96959376335144
Epoch: 1, Steps: 13 | Train Loss: 13.253 Vali Loss: 17.586 Vali Acc: 0.220 Test Loss: 17.586 Test Acc: 0.220
Validation loss decreased (inf --> -0.219824).  Saving model ...
Epoch: 2 cost time: 3.6824777126312256
Epoch: 2, Steps: 13 | Train Loss: 25.723 Vali Loss: 47.491 Vali Acc: 0.280 Test Loss: 47.491 Test Acc: 0.280
Validation loss decreased (-0.219824 --> -0.279525).  Saving model ...
Epoch: 3 cost time: 3.6568915843963623
Epoch: 3, Steps: 13 | Train Loss: 35.877 Vali Loss: 14.229 Vali Acc: 0.460 Test Loss: 14.229 Test Acc: 0.460
Validation loss decreased (-0.279525 --> -0.459858).  Saving model ...
Epoch: 4 cost time: 4.375639915466309
Epoch: 4, Steps: 13 | Train Loss: 23.196 Vali Loss: 21.122 Vali Acc: 0.340 Test Loss: 21.122 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.8160171508789062
Epoch: 5, Steps: 13 | Train Loss: 24.949 Vali Loss: 63.910 Vali Acc: 0.280 Test Loss: 63.910 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.044893503189087
Epoch: 6, Steps: 13 | Train Loss: 39.751 Vali Loss: 135.442 Vali Acc: 0.200 Test Loss: 135.442 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.705936908721924
Epoch: 7, Steps: 13 | Train Loss: 72.664 Vali Loss: 110.000 Vali Acc: 0.400 Test Loss: 110.000 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.741267681121826
Epoch: 8, Steps: 13 | Train Loss: 88.187 Vali Loss: 84.588 Vali Acc: 0.340 Test Loss: 84.588 Test Acc: 0.340
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.2779271602630615
Epoch: 9, Steps: 13 | Train Loss: 30.414 Vali Loss: 118.207 Vali Acc: 0.260 Test Loss: 118.207 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.759199380874634
Epoch: 10, Steps: 13 | Train Loss: 53.515 Vali Loss: 189.883 Vali Acc: 0.380 Test Loss: 189.883 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.837252616882324
Epoch: 11, Steps: 13 | Train Loss: 43.212 Vali Loss: 130.233 Vali Acc: 0.400 Test Loss: 130.233 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.025060415267944
Epoch: 12, Steps: 13 | Train Loss: 42.487 Vali Loss: 173.024 Vali Acc: 0.300 Test Loss: 173.024 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.7387900352478027
Epoch: 13, Steps: 13 | Train Loss: 42.264 Vali Loss: 124.232 Vali Acc: 0.500 Test Loss: 124.232 Test Acc: 0.500
Validation loss decreased (-0.459858 --> -0.498758).  Saving model ...
Epoch: 14 cost time: 3.7341179847717285
Epoch: 14, Steps: 13 | Train Loss: 29.254 Vali Loss: 185.577 Vali Acc: 0.380 Test Loss: 185.577 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.8862838745117188
Epoch: 15, Steps: 13 | Train Loss: 118.560 Vali Loss: 185.588 Vali Acc: 0.440 Test Loss: 185.588 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.9721076488494873
Epoch: 16, Steps: 13 | Train Loss: 9.289 Vali Loss: 118.760 Vali Acc: 0.500 Test Loss: 118.760 Test Acc: 0.500
Validation loss decreased (-0.498758 --> -0.498812).  Saving model ...
Epoch: 17 cost time: 3.687573194503784
Epoch: 17, Steps: 13 | Train Loss: 16.135 Vali Loss: 199.881 Vali Acc: 0.520 Test Loss: 199.881 Test Acc: 0.520
Validation loss decreased (-0.498812 --> -0.518001).  Saving model ...
Epoch: 18 cost time: 4.044534206390381
Epoch: 18, Steps: 13 | Train Loss: 9.371 Vali Loss: 189.987 Vali Acc: 0.540 Test Loss: 189.987 Test Acc: 0.540
Validation loss decreased (-0.518001 --> -0.538100).  Saving model ...
Epoch: 19 cost time: 3.8041038513183594
Epoch: 19, Steps: 13 | Train Loss: 5.818 Vali Loss: 171.565 Vali Acc: 0.580 Test Loss: 171.565 Test Acc: 0.580
Validation loss decreased (-0.538100 --> -0.578284).  Saving model ...
Epoch: 20 cost time: 3.7243568897247314
Epoch: 20, Steps: 13 | Train Loss: 20.526 Vali Loss: 176.833 Vali Acc: 0.520 Test Loss: 176.833 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.257970571517944
Epoch: 21, Steps: 13 | Train Loss: 16.253 Vali Loss: 207.540 Vali Acc: 0.440 Test Loss: 207.540 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.058572292327881
Epoch: 22, Steps: 13 | Train Loss: 22.832 Vali Loss: 242.419 Vali Acc: 0.360 Test Loss: 242.419 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.01175856590271
Epoch: 23, Steps: 13 | Train Loss: 56.442 Vali Loss: 249.885 Vali Acc: 0.460 Test Loss: 249.885 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 4.04065203666687
Epoch: 24, Steps: 13 | Train Loss: 7.350 Vali Loss: 239.478 Vali Acc: 0.480 Test Loss: 239.478 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.8733129501342773
Epoch: 25, Steps: 13 | Train Loss: 22.740 Vali Loss: 232.728 Vali Acc: 0.500 Test Loss: 232.728 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 4.044757127761841
Epoch: 26, Steps: 13 | Train Loss: 10.922 Vali Loss: 136.128 Vali Acc: 0.560 Test Loss: 136.128 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 4.026482105255127
Epoch: 27, Steps: 13 | Train Loss: 12.463 Vali Loss: 167.751 Vali Acc: 0.600 Test Loss: 167.751 Test Acc: 0.600
Validation loss decreased (-0.578284 --> -0.598322).  Saving model ...
Epoch: 28 cost time: 4.264799118041992
Epoch: 28, Steps: 13 | Train Loss: 4.746 Vali Loss: 205.827 Vali Acc: 0.480 Test Loss: 205.827 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.776628017425537
Epoch: 29, Steps: 13 | Train Loss: 2.388 Vali Loss: 152.018 Vali Acc: 0.580 Test Loss: 152.018 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 4.321528196334839
Epoch: 30, Steps: 13 | Train Loss: 6.485 Vali Loss: 161.963 Vali Acc: 0.620 Test Loss: 161.963 Test Acc: 0.620
Validation loss decreased (-0.598322 --> -0.618380).  Saving model ...
Epoch: 31 cost time: 3.960181474685669
Epoch: 31, Steps: 13 | Train Loss: 2.453 Vali Loss: 287.889 Vali Acc: 0.420 Test Loss: 287.889 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 4.051851511001587
Epoch: 32, Steps: 13 | Train Loss: 4.502 Vali Loss: 228.420 Vali Acc: 0.500 Test Loss: 228.420 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.7192294597625732
Epoch: 33, Steps: 13 | Train Loss: 8.288 Vali Loss: 176.119 Vali Acc: 0.580 Test Loss: 176.119 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.800631046295166
Epoch: 34, Steps: 13 | Train Loss: 0.000 Vali Loss: 220.956 Vali Acc: 0.460 Test Loss: 220.956 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 4.04486608505249
Epoch: 35, Steps: 13 | Train Loss: 4.304 Vali Loss: 256.109 Vali Acc: 0.400 Test Loss: 256.109 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 3.950340509414673
Epoch: 36, Steps: 13 | Train Loss: 9.769 Vali Loss: 207.921 Vali Acc: 0.480 Test Loss: 207.921 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 3.968651294708252
Epoch: 37, Steps: 13 | Train Loss: 8.862 Vali Loss: 339.200 Vali Acc: 0.320 Test Loss: 339.200 Test Acc: 0.320
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 3.659529209136963
Epoch: 38, Steps: 13 | Train Loss: 11.079 Vali Loss: 293.554 Vali Acc: 0.460 Test Loss: 293.554 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 3.68949818611145
Epoch: 39, Steps: 13 | Train Loss: 9.409 Vali Loss: 209.077 Vali Acc: 0.500 Test Loss: 209.077 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 4.011302709579468
Epoch: 40, Steps: 13 | Train Loss: 2.080 Vali Loss: 213.657 Vali Acc: 0.560 Test Loss: 213.657 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 15958441
model size : 63.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.669155836105347
Epoch: 1, Steps: 13 | Train Loss: 13.423 Vali Loss: 27.555 Vali Acc: 0.200 Test Loss: 27.555 Test Acc: 0.200
Validation loss decreased (inf --> -0.199724).  Saving model ...
Epoch: 2 cost time: 3.9083189964294434
Epoch: 2, Steps: 13 | Train Loss: 23.785 Vali Loss: 21.353 Vali Acc: 0.220 Test Loss: 21.353 Test Acc: 0.220
Validation loss decreased (-0.199724 --> -0.219786).  Saving model ...
Epoch: 3 cost time: 3.583895444869995
Epoch: 3, Steps: 13 | Train Loss: 40.952 Vali Loss: 45.122 Vali Acc: 0.240 Test Loss: 45.122 Test Acc: 0.240
Validation loss decreased (-0.219786 --> -0.239549).  Saving model ...
Epoch: 4 cost time: 4.191792011260986
Epoch: 4, Steps: 13 | Train Loss: 49.330 Vali Loss: 56.230 Vali Acc: 0.360 Test Loss: 56.230 Test Acc: 0.360
Validation loss decreased (-0.239549 --> -0.359438).  Saving model ...
Epoch: 5 cost time: 3.5521328449249268
Epoch: 5, Steps: 13 | Train Loss: 35.647 Vali Loss: 62.686 Vali Acc: 0.300 Test Loss: 62.686 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.7051565647125244
Epoch: 6, Steps: 13 | Train Loss: 47.316 Vali Loss: 169.153 Vali Acc: 0.280 Test Loss: 169.153 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.7418441772460938
Epoch: 7, Steps: 13 | Train Loss: 93.384 Vali Loss: 211.036 Vali Acc: 0.340 Test Loss: 211.036 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.600358009338379
Epoch: 8, Steps: 13 | Train Loss: 80.958 Vali Loss: 106.045 Vali Acc: 0.320 Test Loss: 106.045 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.6773040294647217
Epoch: 9, Steps: 13 | Train Loss: 34.538 Vali Loss: 71.668 Vali Acc: 0.360 Test Loss: 71.668 Test Acc: 0.360
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.641700029373169
Epoch: 10, Steps: 13 | Train Loss: 21.933 Vali Loss: 87.305 Vali Acc: 0.440 Test Loss: 87.305 Test Acc: 0.440
Validation loss decreased (-0.359438 --> -0.439127).  Saving model ...
Epoch: 11 cost time: 3.6937713623046875
Epoch: 11, Steps: 13 | Train Loss: 23.380 Vali Loss: 150.921 Vali Acc: 0.500 Test Loss: 150.921 Test Acc: 0.500
Validation loss decreased (-0.439127 --> -0.498491).  Saving model ...
Epoch: 12 cost time: 3.7400784492492676
Epoch: 12, Steps: 13 | Train Loss: 40.216 Vali Loss: 169.376 Vali Acc: 0.540 Test Loss: 169.376 Test Acc: 0.540
Validation loss decreased (-0.498491 --> -0.538306).  Saving model ...
Epoch: 13 cost time: 3.5649986267089844
Epoch: 13, Steps: 13 | Train Loss: 48.471 Vali Loss: 204.129 Vali Acc: 0.400 Test Loss: 204.129 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.5996742248535156
Epoch: 14, Steps: 13 | Train Loss: 64.950 Vali Loss: 116.523 Vali Acc: 0.540 Test Loss: 116.523 Test Acc: 0.540
Validation loss decreased (-0.538306 --> -0.538835).  Saving model ...
Epoch: 15 cost time: 3.7277238368988037
Epoch: 15, Steps: 13 | Train Loss: 8.324 Vali Loss: 128.316 Vali Acc: 0.500 Test Loss: 128.316 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.5701236724853516
Epoch: 16, Steps: 13 | Train Loss: 9.938 Vali Loss: 123.762 Vali Acc: 0.500 Test Loss: 123.762 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.680102825164795
Epoch: 17, Steps: 13 | Train Loss: 7.616 Vali Loss: 129.938 Vali Acc: 0.480 Test Loss: 129.938 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.462191104888916
Epoch: 18, Steps: 13 | Train Loss: 3.554 Vali Loss: 118.326 Vali Acc: 0.500 Test Loss: 118.326 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.606691837310791
Epoch: 19, Steps: 13 | Train Loss: 6.894 Vali Loss: 112.603 Vali Acc: 0.480 Test Loss: 112.603 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.645723342895508
Epoch: 20, Steps: 13 | Train Loss: 12.597 Vali Loss: 139.605 Vali Acc: 0.520 Test Loss: 139.605 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.755584478378296
Epoch: 21, Steps: 13 | Train Loss: 10.569 Vali Loss: 146.266 Vali Acc: 0.580 Test Loss: 146.266 Test Acc: 0.580
Validation loss decreased (-0.538835 --> -0.578537).  Saving model ...
Epoch: 22 cost time: 3.591398239135742
Epoch: 22, Steps: 13 | Train Loss: 17.975 Vali Loss: 80.217 Vali Acc: 0.620 Test Loss: 80.217 Test Acc: 0.620
Validation loss decreased (-0.578537 --> -0.619198).  Saving model ...
Epoch: 23 cost time: 3.5226011276245117
Epoch: 23, Steps: 13 | Train Loss: 6.565 Vali Loss: 160.503 Vali Acc: 0.520 Test Loss: 160.503 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.9099485874176025
Epoch: 24, Steps: 13 | Train Loss: 9.701 Vali Loss: 166.439 Vali Acc: 0.460 Test Loss: 166.439 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.672651529312134
Epoch: 25, Steps: 13 | Train Loss: 3.682 Vali Loss: 128.993 Vali Acc: 0.460 Test Loss: 128.993 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.730961561203003
Epoch: 26, Steps: 13 | Train Loss: 3.528 Vali Loss: 86.597 Vali Acc: 0.520 Test Loss: 86.597 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.661633014678955
Epoch: 27, Steps: 13 | Train Loss: 0.824 Vali Loss: 119.982 Vali Acc: 0.420 Test Loss: 119.982 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.670382261276245
Epoch: 28, Steps: 13 | Train Loss: 0.378 Vali Loss: 114.741 Vali Acc: 0.460 Test Loss: 114.741 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.8072307109832764
Epoch: 29, Steps: 13 | Train Loss: 5.084 Vali Loss: 121.463 Vali Acc: 0.360 Test Loss: 121.463 Test Acc: 0.360
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.771430015563965
Epoch: 30, Steps: 13 | Train Loss: 1.756 Vali Loss: 128.739 Vali Acc: 0.500 Test Loss: 128.739 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 3.696157455444336
Epoch: 31, Steps: 13 | Train Loss: 0.000 Vali Loss: 126.461 Vali Acc: 0.500 Test Loss: 126.461 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 3.6697871685028076
Epoch: 32, Steps: 13 | Train Loss: 0.000 Vali Loss: 134.310 Vali Acc: 0.500 Test Loss: 134.310 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 15807401
model size : 62.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.4392249584198
Epoch: 1, Steps: 13 | Train Loss: 15.344 Vali Loss: 19.323 Vali Acc: 0.240 Test Loss: 19.323 Test Acc: 0.240
Validation loss decreased (inf --> -0.239807).  Saving model ...
Epoch: 2 cost time: 3.8398056030273438
Epoch: 2, Steps: 13 | Train Loss: 27.235 Vali Loss: 58.815 Vali Acc: 0.260 Test Loss: 58.815 Test Acc: 0.260
Validation loss decreased (-0.239807 --> -0.259412).  Saving model ...
Epoch: 3 cost time: 3.7735836505889893
Epoch: 3, Steps: 13 | Train Loss: 50.783 Vali Loss: 55.531 Vali Acc: 0.220 Test Loss: 55.531 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.261766672134399
Epoch: 4, Steps: 13 | Train Loss: 50.841 Vali Loss: 56.793 Vali Acc: 0.240 Test Loss: 56.793 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.9582297801971436
Epoch: 5, Steps: 13 | Train Loss: 44.437 Vali Loss: 99.355 Vali Acc: 0.320 Test Loss: 99.355 Test Acc: 0.320
Validation loss decreased (-0.259412 --> -0.319006).  Saving model ...
Epoch: 6 cost time: 3.8353874683380127
Epoch: 6, Steps: 13 | Train Loss: 45.365 Vali Loss: 66.260 Vali Acc: 0.360 Test Loss: 66.260 Test Acc: 0.360
Validation loss decreased (-0.319006 --> -0.359337).  Saving model ...
Epoch: 7 cost time: 4.1816651821136475
Epoch: 7, Steps: 13 | Train Loss: 30.369 Vali Loss: 54.890 Vali Acc: 0.500 Test Loss: 54.890 Test Acc: 0.500
Validation loss decreased (-0.359337 --> -0.499451).  Saving model ...
Epoch: 8 cost time: 4.155723333358765
Epoch: 8, Steps: 13 | Train Loss: 59.133 Vali Loss: 147.630 Vali Acc: 0.400 Test Loss: 147.630 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.114061117172241
Epoch: 9, Steps: 13 | Train Loss: 77.398 Vali Loss: 140.869 Vali Acc: 0.380 Test Loss: 140.869 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.9101080894470215
Epoch: 10, Steps: 13 | Train Loss: 61.945 Vali Loss: 116.565 Vali Acc: 0.480 Test Loss: 116.565 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.8523545265197754
Epoch: 11, Steps: 13 | Train Loss: 20.348 Vali Loss: 107.964 Vali Acc: 0.400 Test Loss: 107.964 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.231062650680542
Epoch: 12, Steps: 13 | Train Loss: 42.229 Vali Loss: 123.023 Vali Acc: 0.340 Test Loss: 123.023 Test Acc: 0.340
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.9620964527130127
Epoch: 13, Steps: 13 | Train Loss: 30.679 Vali Loss: 137.088 Vali Acc: 0.440 Test Loss: 137.088 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.826122760772705
Epoch: 14, Steps: 13 | Train Loss: 18.828 Vali Loss: 117.174 Vali Acc: 0.480 Test Loss: 117.174 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.160738229751587
Epoch: 15, Steps: 13 | Train Loss: 35.836 Vali Loss: 193.367 Vali Acc: 0.520 Test Loss: 193.367 Test Acc: 0.520
Validation loss decreased (-0.499451 --> -0.518066).  Saving model ...
Epoch: 16 cost time: 3.940516471862793
Epoch: 16, Steps: 13 | Train Loss: 38.195 Vali Loss: 177.328 Vali Acc: 0.520 Test Loss: 177.328 Test Acc: 0.520
Validation loss decreased (-0.518066 --> -0.518227).  Saving model ...
Epoch: 17 cost time: 3.8990094661712646
Epoch: 17, Steps: 13 | Train Loss: 5.195 Vali Loss: 132.648 Vali Acc: 0.480 Test Loss: 132.648 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.891895055770874
Epoch: 18, Steps: 13 | Train Loss: 11.832 Vali Loss: 111.462 Vali Acc: 0.600 Test Loss: 111.462 Test Acc: 0.600
Validation loss decreased (-0.518227 --> -0.598885).  Saving model ...
Epoch: 19 cost time: 3.768868923187256
Epoch: 19, Steps: 13 | Train Loss: 9.040 Vali Loss: 188.093 Vali Acc: 0.460 Test Loss: 188.093 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.8916525840759277
Epoch: 20, Steps: 13 | Train Loss: 4.893 Vali Loss: 170.080 Vali Acc: 0.440 Test Loss: 170.080 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.938528537750244
Epoch: 21, Steps: 13 | Train Loss: 10.368 Vali Loss: 195.277 Vali Acc: 0.540 Test Loss: 195.277 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.235836982727051
Epoch: 22, Steps: 13 | Train Loss: 17.329 Vali Loss: 245.016 Vali Acc: 0.520 Test Loss: 245.016 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.9701855182647705
Epoch: 23, Steps: 13 | Train Loss: 13.210 Vali Loss: 197.801 Vali Acc: 0.540 Test Loss: 197.801 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.963663101196289
Epoch: 24, Steps: 13 | Train Loss: 21.315 Vali Loss: 279.075 Vali Acc: 0.400 Test Loss: 279.075 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 4.059197664260864
Epoch: 25, Steps: 13 | Train Loss: 23.943 Vali Loss: 176.927 Vali Acc: 0.520 Test Loss: 176.927 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.9998319149017334
Epoch: 26, Steps: 13 | Train Loss: 12.610 Vali Loss: 170.649 Vali Acc: 0.520 Test Loss: 170.649 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.966799736022949
Epoch: 27, Steps: 13 | Train Loss: 12.291 Vali Loss: 136.004 Vali Acc: 0.540 Test Loss: 136.004 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 4.091368675231934
Epoch: 28, Steps: 13 | Train Loss: 10.017 Vali Loss: 197.010 Vali Acc: 0.480 Test Loss: 197.010 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 15802921
model size : 62.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.398881912231445
Epoch: 1, Steps: 13 | Train Loss: 9.786 Vali Loss: 43.287 Vali Acc: 0.180 Test Loss: 43.287 Test Acc: 0.180
Validation loss decreased (inf --> -0.179567).  Saving model ...
Epoch: 2 cost time: 3.3953537940979004
Epoch: 2, Steps: 13 | Train Loss: 42.986 Vali Loss: 57.512 Vali Acc: 0.200 Test Loss: 57.512 Test Acc: 0.200
Validation loss decreased (-0.179567 --> -0.199425).  Saving model ...
Epoch: 3 cost time: 3.7704482078552246
Epoch: 3, Steps: 13 | Train Loss: 52.445 Vali Loss: 88.628 Vali Acc: 0.340 Test Loss: 88.628 Test Acc: 0.340
Validation loss decreased (-0.199425 --> -0.339114).  Saving model ...
Epoch: 4 cost time: 3.458106279373169
Epoch: 4, Steps: 13 | Train Loss: 53.553 Vali Loss: 59.491 Vali Acc: 0.300 Test Loss: 59.491 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.6070139408111572
Epoch: 5, Steps: 13 | Train Loss: 28.741 Vali Loss: 79.619 Vali Acc: 0.380 Test Loss: 79.619 Test Acc: 0.380
Validation loss decreased (-0.339114 --> -0.379204).  Saving model ...
Epoch: 6 cost time: 3.8759868144989014
Epoch: 6, Steps: 13 | Train Loss: 71.698 Vali Loss: 102.043 Vali Acc: 0.440 Test Loss: 102.043 Test Acc: 0.440
Validation loss decreased (-0.379204 --> -0.438980).  Saving model ...
Epoch: 7 cost time: 3.594646692276001
Epoch: 7, Steps: 13 | Train Loss: 20.015 Vali Loss: 104.414 Vali Acc: 0.400 Test Loss: 104.414 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.6968677043914795
Epoch: 8, Steps: 13 | Train Loss: 36.292 Vali Loss: 160.561 Vali Acc: 0.380 Test Loss: 160.561 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.8398892879486084
Epoch: 9, Steps: 13 | Train Loss: 63.390 Vali Loss: 164.187 Vali Acc: 0.460 Test Loss: 164.187 Test Acc: 0.460
Validation loss decreased (-0.438980 --> -0.458358).  Saving model ...
Epoch: 10 cost time: 3.6913259029388428
Epoch: 10, Steps: 13 | Train Loss: 47.719 Vali Loss: 130.260 Vali Acc: 0.540 Test Loss: 130.260 Test Acc: 0.540
Validation loss decreased (-0.458358 --> -0.538697).  Saving model ...
Epoch: 11 cost time: 3.8617541790008545
Epoch: 11, Steps: 13 | Train Loss: 51.343 Vali Loss: 122.207 Vali Acc: 0.540 Test Loss: 122.207 Test Acc: 0.540
Validation loss decreased (-0.538697 --> -0.538778).  Saving model ...
Epoch: 12 cost time: 3.7474844455718994
Epoch: 12, Steps: 13 | Train Loss: 26.513 Vali Loss: 109.867 Vali Acc: 0.540 Test Loss: 109.867 Test Acc: 0.540
Validation loss decreased (-0.538778 --> -0.538901).  Saving model ...
Epoch: 13 cost time: 3.71331524848938
Epoch: 13, Steps: 13 | Train Loss: 30.110 Vali Loss: 126.211 Vali Acc: 0.420 Test Loss: 126.211 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.6026382446289062
Epoch: 14, Steps: 13 | Train Loss: 34.516 Vali Loss: 154.723 Vali Acc: 0.500 Test Loss: 154.723 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.582108736038208
Epoch: 15, Steps: 13 | Train Loss: 12.754 Vali Loss: 161.389 Vali Acc: 0.500 Test Loss: 161.389 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.739792585372925
Epoch: 16, Steps: 13 | Train Loss: 20.296 Vali Loss: 201.459 Vali Acc: 0.500 Test Loss: 201.459 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.9623124599456787
Epoch: 17, Steps: 13 | Train Loss: 22.467 Vali Loss: 170.553 Vali Acc: 0.420 Test Loss: 170.553 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.709726095199585
Epoch: 18, Steps: 13 | Train Loss: 19.149 Vali Loss: 166.783 Vali Acc: 0.500 Test Loss: 166.783 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.6829800605773926
Epoch: 19, Steps: 13 | Train Loss: 13.516 Vali Loss: 107.370 Vali Acc: 0.520 Test Loss: 107.370 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.7172374725341797
Epoch: 20, Steps: 13 | Train Loss: 4.735 Vali Loss: 89.853 Vali Acc: 0.620 Test Loss: 89.853 Test Acc: 0.620
Validation loss decreased (-0.538901 --> -0.619101).  Saving model ...
Epoch: 21 cost time: 3.621792793273926
Epoch: 21, Steps: 13 | Train Loss: 0.000 Vali Loss: 123.092 Vali Acc: 0.560 Test Loss: 123.092 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.574064016342163
Epoch: 22, Steps: 13 | Train Loss: 0.399 Vali Loss: 140.874 Vali Acc: 0.540 Test Loss: 140.874 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.6472625732421875
Epoch: 23, Steps: 13 | Train Loss: 4.528 Vali Loss: 136.276 Vali Acc: 0.580 Test Loss: 136.276 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.557358980178833
Epoch: 24, Steps: 13 | Train Loss: 19.648 Vali Loss: 117.152 Vali Acc: 0.580 Test Loss: 117.152 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.672451972961426
Epoch: 25, Steps: 13 | Train Loss: 3.098 Vali Loss: 124.350 Vali Acc: 0.600 Test Loss: 124.350 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.7710702419281006
Epoch: 26, Steps: 13 | Train Loss: 2.272 Vali Loss: 123.443 Vali Acc: 0.580 Test Loss: 123.443 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.740074634552002
Epoch: 27, Steps: 13 | Train Loss: 14.003 Vali Loss: 119.804 Vali Acc: 0.540 Test Loss: 119.804 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.681159734725952
Epoch: 28, Steps: 13 | Train Loss: 24.492 Vali Loss: 150.555 Vali Acc: 0.560 Test Loss: 150.555 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.790133237838745
Epoch: 29, Steps: 13 | Train Loss: 76.138 Vali Loss: 322.673 Vali Acc: 0.460 Test Loss: 322.673 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.6485483646392822
Epoch: 30, Steps: 13 | Train Loss: 9.540 Vali Loss: 178.883 Vali Acc: 0.640 Test Loss: 178.883 Test Acc: 0.640
Validation loss decreased (-0.619101 --> -0.638211).  Saving model ...
Epoch: 31 cost time: 3.983454704284668
Epoch: 31, Steps: 13 | Train Loss: 30.058 Vali Loss: 160.585 Vali Acc: 0.520 Test Loss: 160.585 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.9888880252838135
Epoch: 32, Steps: 13 | Train Loss: 5.113 Vali Loss: 202.768 Vali Acc: 0.460 Test Loss: 202.768 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.85915470123291
Epoch: 33, Steps: 13 | Train Loss: 0.108 Vali Loss: 230.448 Vali Acc: 0.440 Test Loss: 230.448 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.676680326461792
Epoch: 34, Steps: 13 | Train Loss: 8.118 Vali Loss: 239.178 Vali Acc: 0.500 Test Loss: 239.178 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 3.981509208679199
Epoch: 35, Steps: 13 | Train Loss: 7.515 Vali Loss: 244.327 Vali Acc: 0.520 Test Loss: 244.327 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 3.698800802230835
Epoch: 36, Steps: 13 | Train Loss: 16.894 Vali Loss: 208.358 Vali Acc: 0.560 Test Loss: 208.358 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 3.7059547901153564
Epoch: 37, Steps: 13 | Train Loss: 13.469 Vali Loss: 241.644 Vali Acc: 0.460 Test Loss: 241.644 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 3.7337536811828613
Epoch: 38, Steps: 13 | Train Loss: 1.513 Vali Loss: 220.520 Vali Acc: 0.580 Test Loss: 220.520 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 3.551884889602661
Epoch: 39, Steps: 13 | Train Loss: 16.522 Vali Loss: 187.226 Vali Acc: 0.520 Test Loss: 187.226 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 3.654168128967285
Epoch: 40, Steps: 13 | Train Loss: 4.105 Vali Loss: 205.412 Vali Acc: 0.440 Test Loss: 205.412 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.64
model parameter : 15798441
model size : 62.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.2401123046875
Epoch: 1, Steps: 13 | Train Loss: 20.471 Vali Loss: 44.098 Vali Acc: 0.200 Test Loss: 44.098 Test Acc: 0.200
Validation loss decreased (inf --> -0.199559).  Saving model ...
Epoch: 2 cost time: 3.397005081176758
Epoch: 2, Steps: 13 | Train Loss: 52.316 Vali Loss: 46.213 Vali Acc: 0.200 Test Loss: 46.213 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.426663398742676
Epoch: 3, Steps: 13 | Train Loss: 67.732 Vali Loss: 93.265 Vali Acc: 0.320 Test Loss: 93.265 Test Acc: 0.320
Validation loss decreased (-0.199559 --> -0.319067).  Saving model ...
Epoch: 4 cost time: 3.482727289199829
Epoch: 4, Steps: 13 | Train Loss: 64.254 Vali Loss: 123.335 Vali Acc: 0.360 Test Loss: 123.335 Test Acc: 0.360
Validation loss decreased (-0.319067 --> -0.358767).  Saving model ...
Epoch: 5 cost time: 3.4719715118408203
Epoch: 5, Steps: 13 | Train Loss: 60.501 Vali Loss: 111.451 Vali Acc: 0.320 Test Loss: 111.451 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.7314696311950684
Epoch: 6, Steps: 13 | Train Loss: 39.413 Vali Loss: 142.959 Vali Acc: 0.240 Test Loss: 142.959 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.662706136703491
Epoch: 7, Steps: 13 | Train Loss: 50.423 Vali Loss: 94.856 Vali Acc: 0.480 Test Loss: 94.856 Test Acc: 0.480
Validation loss decreased (-0.358767 --> -0.479051).  Saving model ...
Epoch: 8 cost time: 3.499048948287964
Epoch: 8, Steps: 13 | Train Loss: 58.536 Vali Loss: 194.476 Vali Acc: 0.320 Test Loss: 194.476 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.589933395385742
Epoch: 9, Steps: 13 | Train Loss: 88.943 Vali Loss: 144.496 Vali Acc: 0.420 Test Loss: 144.496 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.6683809757232666
Epoch: 10, Steps: 13 | Train Loss: 44.879 Vali Loss: 129.815 Vali Acc: 0.420 Test Loss: 129.815 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.6013481616973877
Epoch: 11, Steps: 13 | Train Loss: 53.973 Vali Loss: 132.479 Vali Acc: 0.520 Test Loss: 132.479 Test Acc: 0.520
Validation loss decreased (-0.479051 --> -0.518675).  Saving model ...
Epoch: 12 cost time: 3.542772054672241
Epoch: 12, Steps: 13 | Train Loss: 33.869 Vali Loss: 209.104 Vali Acc: 0.400 Test Loss: 209.104 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.5005276203155518
Epoch: 13, Steps: 13 | Train Loss: 49.005 Vali Loss: 180.176 Vali Acc: 0.400 Test Loss: 180.176 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.7014966011047363
Epoch: 14, Steps: 13 | Train Loss: 14.874 Vali Loss: 127.309 Vali Acc: 0.500 Test Loss: 127.309 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.647467613220215
Epoch: 15, Steps: 13 | Train Loss: 11.437 Vali Loss: 191.388 Vali Acc: 0.380 Test Loss: 191.388 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.5371272563934326
Epoch: 16, Steps: 13 | Train Loss: 29.892 Vali Loss: 225.852 Vali Acc: 0.540 Test Loss: 225.852 Test Acc: 0.540
Validation loss decreased (-0.518675 --> -0.537741).  Saving model ...
Epoch: 17 cost time: 3.691664934158325
Epoch: 17, Steps: 13 | Train Loss: 34.660 Vali Loss: 116.271 Vali Acc: 0.540 Test Loss: 116.271 Test Acc: 0.540
Validation loss decreased (-0.537741 --> -0.538837).  Saving model ...
Epoch: 18 cost time: 3.5019593238830566
Epoch: 18, Steps: 13 | Train Loss: 20.410 Vali Loss: 191.589 Vali Acc: 0.540 Test Loss: 191.589 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.5821633338928223
Epoch: 19, Steps: 13 | Train Loss: 13.794 Vali Loss: 212.054 Vali Acc: 0.460 Test Loss: 212.054 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.4886298179626465
Epoch: 20, Steps: 13 | Train Loss: 17.627 Vali Loss: 270.798 Vali Acc: 0.400 Test Loss: 270.798 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.8275771141052246
Epoch: 21, Steps: 13 | Train Loss: 28.698 Vali Loss: 176.846 Vali Acc: 0.540 Test Loss: 176.846 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.577308177947998
Epoch: 22, Steps: 13 | Train Loss: 27.135 Vali Loss: 208.212 Vali Acc: 0.500 Test Loss: 208.212 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.802180767059326
Epoch: 23, Steps: 13 | Train Loss: 8.701 Vali Loss: 163.426 Vali Acc: 0.500 Test Loss: 163.426 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.5607731342315674
Epoch: 24, Steps: 13 | Train Loss: 2.015 Vali Loss: 177.135 Vali Acc: 0.480 Test Loss: 177.135 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.78373384475708
Epoch: 25, Steps: 13 | Train Loss: 6.915 Vali Loss: 217.191 Vali Acc: 0.400 Test Loss: 217.191 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.576148748397827
Epoch: 26, Steps: 13 | Train Loss: 31.627 Vali Loss: 218.671 Vali Acc: 0.440 Test Loss: 218.671 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.5258073806762695
Epoch: 27, Steps: 13 | Train Loss: 1.946 Vali Loss: 169.693 Vali Acc: 0.540 Test Loss: 169.693 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 15793961
model size : 62.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.061584949493408
Epoch: 1, Steps: 13 | Train Loss: 5.908 Vali Loss: 28.984 Vali Acc: 0.200 Test Loss: 28.984 Test Acc: 0.200
Validation loss decreased (inf --> -0.199710).  Saving model ...
Epoch: 2 cost time: 3.230323314666748
Epoch: 2, Steps: 13 | Train Loss: 21.516 Vali Loss: 22.318 Vali Acc: 0.380 Test Loss: 22.318 Test Acc: 0.380
Validation loss decreased (-0.199710 --> -0.379777).  Saving model ...
Epoch: 3 cost time: 3.6867053508758545
Epoch: 3, Steps: 13 | Train Loss: 17.693 Vali Loss: 43.356 Vali Acc: 0.300 Test Loss: 43.356 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.404447555541992
Epoch: 4, Steps: 13 | Train Loss: 19.365 Vali Loss: 22.742 Vali Acc: 0.460 Test Loss: 22.742 Test Acc: 0.460
Validation loss decreased (-0.379777 --> -0.459773).  Saving model ...
Epoch: 5 cost time: 3.057079315185547
Epoch: 5, Steps: 13 | Train Loss: 16.812 Vali Loss: 33.125 Vali Acc: 0.240 Test Loss: 33.125 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.496387481689453
Epoch: 6, Steps: 13 | Train Loss: 30.158 Vali Loss: 71.649 Vali Acc: 0.300 Test Loss: 71.649 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.411266565322876
Epoch: 7, Steps: 13 | Train Loss: 21.837 Vali Loss: 89.414 Vali Acc: 0.340 Test Loss: 89.414 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.360426664352417
Epoch: 8, Steps: 13 | Train Loss: 27.168 Vali Loss: 58.064 Vali Acc: 0.340 Test Loss: 58.064 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.201719284057617
Epoch: 9, Steps: 13 | Train Loss: 19.315 Vali Loss: 47.114 Vali Acc: 0.480 Test Loss: 47.114 Test Acc: 0.480
Validation loss decreased (-0.459773 --> -0.479529).  Saving model ...
Epoch: 10 cost time: 3.3239834308624268
Epoch: 10, Steps: 13 | Train Loss: 27.640 Vali Loss: 66.173 Vali Acc: 0.440 Test Loss: 66.173 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.802117347717285
Epoch: 11, Steps: 13 | Train Loss: 16.386 Vali Loss: 68.044 Vali Acc: 0.400 Test Loss: 68.044 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.667384147644043
Epoch: 12, Steps: 13 | Train Loss: 20.519 Vali Loss: 75.717 Vali Acc: 0.440 Test Loss: 75.717 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.4381957054138184
Epoch: 13, Steps: 13 | Train Loss: 35.935 Vali Loss: 87.127 Vali Acc: 0.440 Test Loss: 87.127 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.6992220878601074
Epoch: 14, Steps: 13 | Train Loss: 23.425 Vali Loss: 37.606 Vali Acc: 0.560 Test Loss: 37.606 Test Acc: 0.560
Validation loss decreased (-0.479529 --> -0.559624).  Saving model ...
Epoch: 15 cost time: 3.250030040740967
Epoch: 15, Steps: 13 | Train Loss: 8.853 Vali Loss: 85.465 Vali Acc: 0.360 Test Loss: 85.465 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.6719212532043457
Epoch: 16, Steps: 13 | Train Loss: 12.243 Vali Loss: 64.215 Vali Acc: 0.420 Test Loss: 64.215 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.53049373626709
Epoch: 17, Steps: 13 | Train Loss: 7.643 Vali Loss: 84.214 Vali Acc: 0.460 Test Loss: 84.214 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.315878391265869
Epoch: 18, Steps: 13 | Train Loss: 6.003 Vali Loss: 50.290 Vali Acc: 0.580 Test Loss: 50.290 Test Acc: 0.580
Validation loss decreased (-0.559624 --> -0.579497).  Saving model ...
Epoch: 19 cost time: 3.389766216278076
Epoch: 19, Steps: 13 | Train Loss: 11.095 Vali Loss: 50.451 Vali Acc: 0.580 Test Loss: 50.451 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.2712767124176025
Epoch: 20, Steps: 13 | Train Loss: 0.112 Vali Loss: 92.568 Vali Acc: 0.380 Test Loss: 92.568 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.532567262649536
Epoch: 21, Steps: 13 | Train Loss: 4.480 Vali Loss: 71.733 Vali Acc: 0.480 Test Loss: 71.733 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.534000873565674
Epoch: 22, Steps: 13 | Train Loss: 2.700 Vali Loss: 66.785 Vali Acc: 0.480 Test Loss: 66.785 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.374030590057373
Epoch: 23, Steps: 13 | Train Loss: 1.174 Vali Loss: 76.115 Vali Acc: 0.540 Test Loss: 76.115 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.2978765964508057
Epoch: 24, Steps: 13 | Train Loss: 1.319 Vali Loss: 70.474 Vali Acc: 0.520 Test Loss: 70.474 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.2272822856903076
Epoch: 25, Steps: 13 | Train Loss: 2.219 Vali Loss: 61.194 Vali Acc: 0.520 Test Loss: 61.194 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.368631362915039
Epoch: 26, Steps: 13 | Train Loss: 3.282 Vali Loss: 76.437 Vali Acc: 0.540 Test Loss: 76.437 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.4734818935394287
Epoch: 27, Steps: 13 | Train Loss: 0.888 Vali Loss: 70.708 Vali Acc: 0.380 Test Loss: 70.708 Test Acc: 0.380
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 3.427471399307251
Epoch: 28, Steps: 13 | Train Loss: 4.897 Vali Loss: 69.519 Vali Acc: 0.500 Test Loss: 69.519 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 8154281
model size : 32.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.278908014297485
Epoch: 1, Steps: 13 | Train Loss: 6.711 Vali Loss: 11.171 Vali Acc: 0.200 Test Loss: 11.171 Test Acc: 0.200
Validation loss decreased (inf --> -0.199888).  Saving model ...
Epoch: 2 cost time: 3.252387523651123
Epoch: 2, Steps: 13 | Train Loss: 9.067 Vali Loss: 23.804 Vali Acc: 0.200 Test Loss: 23.804 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.399195671081543
Epoch: 3, Steps: 13 | Train Loss: 17.091 Vali Loss: 25.262 Vali Acc: 0.320 Test Loss: 25.262 Test Acc: 0.320
Validation loss decreased (-0.199888 --> -0.319747).  Saving model ...
Epoch: 4 cost time: 3.3702855110168457
Epoch: 4, Steps: 13 | Train Loss: 18.270 Vali Loss: 28.237 Vali Acc: 0.340 Test Loss: 28.237 Test Acc: 0.340
Validation loss decreased (-0.319747 --> -0.339718).  Saving model ...
Epoch: 5 cost time: 3.431506395339966
Epoch: 5, Steps: 13 | Train Loss: 22.729 Vali Loss: 45.598 Vali Acc: 0.400 Test Loss: 45.598 Test Acc: 0.400
Validation loss decreased (-0.339718 --> -0.399544).  Saving model ...
Epoch: 6 cost time: 3.375277519226074
Epoch: 6, Steps: 13 | Train Loss: 16.504 Vali Loss: 22.008 Vali Acc: 0.420 Test Loss: 22.008 Test Acc: 0.420
Validation loss decreased (-0.399544 --> -0.419780).  Saving model ...
Epoch: 7 cost time: 3.4205620288848877
Epoch: 7, Steps: 13 | Train Loss: 10.019 Vali Loss: 25.910 Vali Acc: 0.380 Test Loss: 25.910 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.462128162384033
Epoch: 8, Steps: 13 | Train Loss: 26.013 Vali Loss: 65.971 Vali Acc: 0.420 Test Loss: 65.971 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.2372868061065674
Epoch: 9, Steps: 13 | Train Loss: 30.803 Vali Loss: 34.856 Vali Acc: 0.500 Test Loss: 34.856 Test Acc: 0.500
Validation loss decreased (-0.419780 --> -0.499651).  Saving model ...
Epoch: 10 cost time: 3.2474660873413086
Epoch: 10, Steps: 13 | Train Loss: 25.432 Vali Loss: 39.008 Vali Acc: 0.420 Test Loss: 39.008 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.336836576461792
Epoch: 11, Steps: 13 | Train Loss: 20.636 Vali Loss: 81.418 Vali Acc: 0.400 Test Loss: 81.418 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.214446544647217
Epoch: 12, Steps: 13 | Train Loss: 16.748 Vali Loss: 71.499 Vali Acc: 0.400 Test Loss: 71.499 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.3789942264556885
Epoch: 13, Steps: 13 | Train Loss: 6.442 Vali Loss: 67.531 Vali Acc: 0.600 Test Loss: 67.531 Test Acc: 0.600
Validation loss decreased (-0.499651 --> -0.599325).  Saving model ...
Epoch: 14 cost time: 3.445394992828369
Epoch: 14, Steps: 13 | Train Loss: 13.284 Vali Loss: 51.885 Vali Acc: 0.520 Test Loss: 51.885 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.4617815017700195
Epoch: 15, Steps: 13 | Train Loss: 7.342 Vali Loss: 47.186 Vali Acc: 0.560 Test Loss: 47.186 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.305715322494507
Epoch: 16, Steps: 13 | Train Loss: 9.467 Vali Loss: 59.111 Vali Acc: 0.480 Test Loss: 59.111 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.502013921737671
Epoch: 17, Steps: 13 | Train Loss: 4.538 Vali Loss: 76.228 Vali Acc: 0.440 Test Loss: 76.228 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.3907079696655273
Epoch: 18, Steps: 13 | Train Loss: 8.365 Vali Loss: 77.831 Vali Acc: 0.480 Test Loss: 77.831 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.5241479873657227
Epoch: 19, Steps: 13 | Train Loss: 8.438 Vali Loss: 95.785 Vali Acc: 0.460 Test Loss: 95.785 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.457500457763672
Epoch: 20, Steps: 13 | Train Loss: 1.540 Vali Loss: 68.032 Vali Acc: 0.460 Test Loss: 68.032 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.5166823863983154
Epoch: 21, Steps: 13 | Train Loss: 3.121 Vali Loss: 91.419 Vali Acc: 0.400 Test Loss: 91.419 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.5798962116241455
Epoch: 22, Steps: 13 | Train Loss: 9.318 Vali Loss: 96.496 Vali Acc: 0.420 Test Loss: 96.496 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.1836602687835693
Epoch: 23, Steps: 13 | Train Loss: 18.937 Vali Loss: 87.481 Vali Acc: 0.540 Test Loss: 87.481 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 8152041
model size : 32.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.942279100418091
Epoch: 1, Steps: 13 | Train Loss: 9.734 Vali Loss: 22.749 Vali Acc: 0.200 Test Loss: 22.749 Test Acc: 0.200
Validation loss decreased (inf --> -0.199773).  Saving model ...
Epoch: 2 cost time: 3.327268123626709
Epoch: 2, Steps: 13 | Train Loss: 11.615 Vali Loss: 21.219 Vali Acc: 0.220 Test Loss: 21.219 Test Acc: 0.220
Validation loss decreased (-0.199773 --> -0.219788).  Saving model ...
Epoch: 3 cost time: 3.4412193298339844
Epoch: 3, Steps: 13 | Train Loss: 21.003 Vali Loss: 30.467 Vali Acc: 0.240 Test Loss: 30.467 Test Acc: 0.240
Validation loss decreased (-0.219788 --> -0.239695).  Saving model ...
Epoch: 4 cost time: 3.1750619411468506
Epoch: 4, Steps: 13 | Train Loss: 10.539 Vali Loss: 14.431 Vali Acc: 0.420 Test Loss: 14.431 Test Acc: 0.420
Validation loss decreased (-0.239695 --> -0.419856).  Saving model ...
Epoch: 5 cost time: 3.500042200088501
Epoch: 5, Steps: 13 | Train Loss: 19.040 Vali Loss: 29.819 Vali Acc: 0.440 Test Loss: 29.819 Test Acc: 0.440
Validation loss decreased (-0.419856 --> -0.439702).  Saving model ...
Epoch: 6 cost time: 3.4579436779022217
Epoch: 6, Steps: 13 | Train Loss: 16.872 Vali Loss: 56.168 Vali Acc: 0.320 Test Loss: 56.168 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.589717149734497
Epoch: 7, Steps: 13 | Train Loss: 22.429 Vali Loss: 42.793 Vali Acc: 0.300 Test Loss: 42.793 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.3500125408172607
Epoch: 8, Steps: 13 | Train Loss: 11.017 Vali Loss: 37.456 Vali Acc: 0.420 Test Loss: 37.456 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.6257681846618652
Epoch: 9, Steps: 13 | Train Loss: 31.699 Vali Loss: 57.940 Vali Acc: 0.320 Test Loss: 57.940 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.5524206161499023
Epoch: 10, Steps: 13 | Train Loss: 25.099 Vali Loss: 63.393 Vali Acc: 0.380 Test Loss: 63.393 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.337066888809204
Epoch: 11, Steps: 13 | Train Loss: 29.724 Vali Loss: 95.878 Vali Acc: 0.400 Test Loss: 95.878 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.564338445663452
Epoch: 12, Steps: 13 | Train Loss: 31.046 Vali Loss: 56.332 Vali Acc: 0.440 Test Loss: 56.332 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.39239501953125
Epoch: 13, Steps: 13 | Train Loss: 30.962 Vali Loss: 125.333 Vali Acc: 0.400 Test Loss: 125.333 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.4178757667541504
Epoch: 14, Steps: 13 | Train Loss: 17.964 Vali Loss: 90.183 Vali Acc: 0.500 Test Loss: 90.183 Test Acc: 0.500
Validation loss decreased (-0.439702 --> -0.499098).  Saving model ...
Epoch: 15 cost time: 3.5164949893951416
Epoch: 15, Steps: 13 | Train Loss: 21.009 Vali Loss: 86.715 Vali Acc: 0.560 Test Loss: 86.715 Test Acc: 0.560
Validation loss decreased (-0.499098 --> -0.559133).  Saving model ...
Epoch: 16 cost time: 3.334563970565796
Epoch: 16, Steps: 13 | Train Loss: 17.820 Vali Loss: 156.348 Vali Acc: 0.400 Test Loss: 156.348 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.4280238151550293
Epoch: 17, Steps: 13 | Train Loss: 19.996 Vali Loss: 51.336 Vali Acc: 0.580 Test Loss: 51.336 Test Acc: 0.580
Validation loss decreased (-0.559133 --> -0.579487).  Saving model ...
Epoch: 18 cost time: 3.3722312450408936
Epoch: 18, Steps: 13 | Train Loss: 4.341 Vali Loss: 78.741 Vali Acc: 0.540 Test Loss: 78.741 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.3220274448394775
Epoch: 19, Steps: 13 | Train Loss: 11.788 Vali Loss: 86.214 Vali Acc: 0.520 Test Loss: 86.214 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.246269702911377
Epoch: 20, Steps: 13 | Train Loss: 10.880 Vali Loss: 71.538 Vali Acc: 0.540 Test Loss: 71.538 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.267740249633789
Epoch: 21, Steps: 13 | Train Loss: 11.967 Vali Loss: 130.984 Vali Acc: 0.480 Test Loss: 130.984 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.4207653999328613
Epoch: 22, Steps: 13 | Train Loss: 23.688 Vali Loss: 69.357 Vali Acc: 0.580 Test Loss: 69.357 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.418318271636963
Epoch: 23, Steps: 13 | Train Loss: 10.049 Vali Loss: 80.283 Vali Acc: 0.440 Test Loss: 80.283 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.2581167221069336
Epoch: 24, Steps: 13 | Train Loss: 4.714 Vali Loss: 80.296 Vali Acc: 0.480 Test Loss: 80.296 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.4141132831573486
Epoch: 25, Steps: 13 | Train Loss: 2.627 Vali Loss: 87.975 Vali Acc: 0.540 Test Loss: 87.975 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.393181085586548
Epoch: 26, Steps: 13 | Train Loss: 0.000 Vali Loss: 114.251 Vali Acc: 0.480 Test Loss: 114.251 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.3265223503112793
Epoch: 27, Steps: 13 | Train Loss: 1.153 Vali Loss: 115.932 Vali Acc: 0.480 Test Loss: 115.932 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 8149801
model size : 32.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.120059013366699
Epoch: 1, Steps: 13 | Train Loss: 5.529 Vali Loss: 6.696 Vali Acc: 0.220 Test Loss: 6.696 Test Acc: 0.220
Validation loss decreased (inf --> -0.219933).  Saving model ...
Epoch: 2 cost time: 3.0497984886169434
Epoch: 2, Steps: 13 | Train Loss: 8.542 Vali Loss: 7.692 Vali Acc: 0.200 Test Loss: 7.692 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.1858954429626465
Epoch: 3, Steps: 13 | Train Loss: 12.112 Vali Loss: 39.732 Vali Acc: 0.240 Test Loss: 39.732 Test Acc: 0.240
Validation loss decreased (-0.219933 --> -0.239603).  Saving model ...
Epoch: 4 cost time: 3.1314480304718018
Epoch: 4, Steps: 13 | Train Loss: 24.731 Vali Loss: 16.236 Vali Acc: 0.300 Test Loss: 16.236 Test Acc: 0.300
Validation loss decreased (-0.239603 --> -0.299838).  Saving model ...
Epoch: 5 cost time: 3.3456830978393555
Epoch: 5, Steps: 13 | Train Loss: 20.594 Vali Loss: 29.270 Vali Acc: 0.320 Test Loss: 29.270 Test Acc: 0.320
Validation loss decreased (-0.299838 --> -0.319707).  Saving model ...
Epoch: 6 cost time: 3.1486973762512207
Epoch: 6, Steps: 13 | Train Loss: 13.831 Vali Loss: 43.633 Vali Acc: 0.400 Test Loss: 43.633 Test Acc: 0.400
Validation loss decreased (-0.319707 --> -0.399564).  Saving model ...
Epoch: 7 cost time: 3.1654858589172363
Epoch: 7, Steps: 13 | Train Loss: 9.866 Vali Loss: 53.352 Vali Acc: 0.320 Test Loss: 53.352 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.1422476768493652
Epoch: 8, Steps: 13 | Train Loss: 62.970 Vali Loss: 24.873 Vali Acc: 0.440 Test Loss: 24.873 Test Acc: 0.440
Validation loss decreased (-0.399564 --> -0.439751).  Saving model ...
Epoch: 9 cost time: 3.0227324962615967
Epoch: 9, Steps: 13 | Train Loss: 19.817 Vali Loss: 71.999 Vali Acc: 0.340 Test Loss: 71.999 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.025883197784424
Epoch: 10, Steps: 13 | Train Loss: 13.790 Vali Loss: 92.389 Vali Acc: 0.340 Test Loss: 92.389 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.115678071975708
Epoch: 11, Steps: 13 | Train Loss: 23.447 Vali Loss: 84.566 Vali Acc: 0.360 Test Loss: 84.566 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.172677993774414
Epoch: 12, Steps: 13 | Train Loss: 17.074 Vali Loss: 69.775 Vali Acc: 0.360 Test Loss: 69.775 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.1466739177703857
Epoch: 13, Steps: 13 | Train Loss: 16.872 Vali Loss: 59.465 Vali Acc: 0.320 Test Loss: 59.465 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.1500601768493652
Epoch: 14, Steps: 13 | Train Loss: 10.690 Vali Loss: 78.193 Vali Acc: 0.400 Test Loss: 78.193 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.0352392196655273
Epoch: 15, Steps: 13 | Train Loss: 10.013 Vali Loss: 57.528 Vali Acc: 0.480 Test Loss: 57.528 Test Acc: 0.480
Validation loss decreased (-0.439751 --> -0.479425).  Saving model ...
Epoch: 16 cost time: 3.214047431945801
Epoch: 16, Steps: 13 | Train Loss: 22.323 Vali Loss: 155.280 Vali Acc: 0.380 Test Loss: 155.280 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.293093681335449
Epoch: 17, Steps: 13 | Train Loss: 31.979 Vali Loss: 57.981 Vali Acc: 0.500 Test Loss: 57.981 Test Acc: 0.500
Validation loss decreased (-0.479425 --> -0.499420).  Saving model ...
Epoch: 18 cost time: 3.4188027381896973
Epoch: 18, Steps: 13 | Train Loss: 16.043 Vali Loss: 96.409 Vali Acc: 0.420 Test Loss: 96.409 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.9683923721313477
Epoch: 19, Steps: 13 | Train Loss: 4.594 Vali Loss: 152.104 Vali Acc: 0.360 Test Loss: 152.104 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.2232460975646973
Epoch: 20, Steps: 13 | Train Loss: 10.217 Vali Loss: 79.993 Vali Acc: 0.560 Test Loss: 79.993 Test Acc: 0.560
Validation loss decreased (-0.499420 --> -0.559200).  Saving model ...
Epoch: 21 cost time: 3.1621265411376953
Epoch: 21, Steps: 13 | Train Loss: 0.736 Vali Loss: 130.211 Vali Acc: 0.420 Test Loss: 130.211 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.113945960998535
Epoch: 22, Steps: 13 | Train Loss: 12.947 Vali Loss: 90.835 Vali Acc: 0.520 Test Loss: 90.835 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.315001964569092
Epoch: 23, Steps: 13 | Train Loss: 6.664 Vali Loss: 100.203 Vali Acc: 0.480 Test Loss: 100.203 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.2008607387542725
Epoch: 24, Steps: 13 | Train Loss: 2.883 Vali Loss: 79.136 Vali Acc: 0.520 Test Loss: 79.136 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.231022357940674
Epoch: 25, Steps: 13 | Train Loss: 9.018 Vali Loss: 97.515 Vali Acc: 0.500 Test Loss: 97.515 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.2084436416625977
Epoch: 26, Steps: 13 | Train Loss: 3.191 Vali Loss: 84.310 Vali Acc: 0.520 Test Loss: 84.310 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.163346767425537
Epoch: 27, Steps: 13 | Train Loss: 4.636 Vali Loss: 68.450 Vali Acc: 0.540 Test Loss: 68.450 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.1085398197174072
Epoch: 28, Steps: 13 | Train Loss: 4.799 Vali Loss: 77.990 Vali Acc: 0.540 Test Loss: 77.990 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.0036661624908447
Epoch: 29, Steps: 13 | Train Loss: 4.028 Vali Loss: 92.895 Vali Acc: 0.500 Test Loss: 92.895 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.1839356422424316
Epoch: 30, Steps: 13 | Train Loss: 6.285 Vali Loss: 76.841 Vali Acc: 0.560 Test Loss: 76.841 Test Acc: 0.560
Validation loss decreased (-0.559200 --> -0.559232).  Saving model ...
Epoch: 31 cost time: 3.1457700729370117
Epoch: 31, Steps: 13 | Train Loss: 1.822 Vali Loss: 91.124 Vali Acc: 0.540 Test Loss: 91.124 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.2576656341552734
Epoch: 32, Steps: 13 | Train Loss: 0.961 Vali Loss: 78.058 Vali Acc: 0.560 Test Loss: 78.058 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.1473565101623535
Epoch: 33, Steps: 13 | Train Loss: 2.717 Vali Loss: 114.137 Vali Acc: 0.420 Test Loss: 114.137 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.240875720977783
Epoch: 34, Steps: 13 | Train Loss: 0.329 Vali Loss: 117.810 Vali Acc: 0.420 Test Loss: 117.810 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 3.4036917686462402
Epoch: 35, Steps: 13 | Train Loss: 1.580 Vali Loss: 121.895 Vali Acc: 0.540 Test Loss: 121.895 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 3.268890857696533
Epoch: 36, Steps: 13 | Train Loss: 5.767 Vali Loss: 135.342 Vali Acc: 0.500 Test Loss: 135.342 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 3.161956548690796
Epoch: 37, Steps: 13 | Train Loss: 1.985 Vali Loss: 106.529 Vali Acc: 0.560 Test Loss: 106.529 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 3.173572540283203
Epoch: 38, Steps: 13 | Train Loss: 6.033 Vali Loss: 84.665 Vali Acc: 0.620 Test Loss: 84.665 Test Acc: 0.620
Validation loss decreased (-0.559232 --> -0.619153).  Saving model ...
Epoch: 39 cost time: 3.0228140354156494
Epoch: 39, Steps: 13 | Train Loss: 0.411 Vali Loss: 97.808 Vali Acc: 0.460 Test Loss: 97.808 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.4071693420410156
Epoch: 40, Steps: 13 | Train Loss: 1.539 Vali Loss: 111.764 Vali Acc: 0.560 Test Loss: 111.764 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.5040230751037598
Epoch: 41, Steps: 13 | Train Loss: 6.469 Vali Loss: 121.133 Vali Acc: 0.460 Test Loss: 121.133 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 3.303424119949341
Epoch: 42, Steps: 13 | Train Loss: 3.225 Vali Loss: 151.032 Vali Acc: 0.500 Test Loss: 151.032 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 3.459812879562378
Epoch: 43, Steps: 13 | Train Loss: 2.994 Vali Loss: 131.416 Vali Acc: 0.540 Test Loss: 131.416 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 3.1946775913238525
Epoch: 44, Steps: 13 | Train Loss: 1.450 Vali Loss: 158.942 Vali Acc: 0.440 Test Loss: 158.942 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 3.3749327659606934
Epoch: 45, Steps: 13 | Train Loss: 5.963 Vali Loss: 153.452 Vali Acc: 0.520 Test Loss: 153.452 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 3.3161704540252686
Epoch: 46, Steps: 13 | Train Loss: 5.321 Vali Loss: 184.876 Vali Acc: 0.460 Test Loss: 184.876 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 3.1515443325042725
Epoch: 47, Steps: 13 | Train Loss: 12.319 Vali Loss: 166.223 Vali Acc: 0.540 Test Loss: 166.223 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 3.0075604915618896
Epoch: 48, Steps: 13 | Train Loss: 7.679 Vali Loss: 129.447 Vali Acc: 0.460 Test Loss: 129.447 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 8147561
model size : 32.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.506054162979126
Epoch: 1, Steps: 13 | Train Loss: 13.165 Vali Loss: 17.877 Vali Acc: 0.240 Test Loss: 17.877 Test Acc: 0.240
Validation loss decreased (inf --> -0.239821).  Saving model ...
Epoch: 2 cost time: 3.0881307125091553
Epoch: 2, Steps: 13 | Train Loss: 13.505 Vali Loss: 22.569 Vali Acc: 0.200 Test Loss: 22.569 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.0641589164733887
Epoch: 3, Steps: 13 | Train Loss: 16.078 Vali Loss: 17.033 Vali Acc: 0.300 Test Loss: 17.033 Test Acc: 0.300
Validation loss decreased (-0.239821 --> -0.299830).  Saving model ...
Epoch: 4 cost time: 3.068429708480835
Epoch: 4, Steps: 13 | Train Loss: 13.836 Vali Loss: 24.346 Vali Acc: 0.240 Test Loss: 24.346 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.874457836151123
Epoch: 5, Steps: 13 | Train Loss: 18.228 Vali Loss: 37.077 Vali Acc: 0.280 Test Loss: 37.077 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.042370557785034
Epoch: 6, Steps: 13 | Train Loss: 22.327 Vali Loss: 32.914 Vali Acc: 0.380 Test Loss: 32.914 Test Acc: 0.380
Validation loss decreased (-0.299830 --> -0.379671).  Saving model ...
Epoch: 7 cost time: 2.8665077686309814
Epoch: 7, Steps: 13 | Train Loss: 42.230 Vali Loss: 71.717 Vali Acc: 0.300 Test Loss: 71.717 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.9698543548583984
Epoch: 8, Steps: 13 | Train Loss: 54.855 Vali Loss: 59.166 Vali Acc: 0.420 Test Loss: 59.166 Test Acc: 0.420
Validation loss decreased (-0.379671 --> -0.419408).  Saving model ...
Epoch: 9 cost time: 2.979001522064209
Epoch: 9, Steps: 13 | Train Loss: 23.129 Vali Loss: 67.834 Vali Acc: 0.400 Test Loss: 67.834 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.0941247940063477
Epoch: 10, Steps: 13 | Train Loss: 21.201 Vali Loss: 41.847 Vali Acc: 0.420 Test Loss: 41.847 Test Acc: 0.420
Validation loss decreased (-0.419408 --> -0.419582).  Saving model ...
Epoch: 11 cost time: 2.9834511280059814
Epoch: 11, Steps: 13 | Train Loss: 18.361 Vali Loss: 42.242 Vali Acc: 0.480 Test Loss: 42.242 Test Acc: 0.480
Validation loss decreased (-0.419582 --> -0.479578).  Saving model ...
Epoch: 12 cost time: 2.9316039085388184
Epoch: 12, Steps: 13 | Train Loss: 14.706 Vali Loss: 70.427 Vali Acc: 0.480 Test Loss: 70.427 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.154653549194336
Epoch: 13, Steps: 13 | Train Loss: 18.883 Vali Loss: 64.995 Vali Acc: 0.500 Test Loss: 64.995 Test Acc: 0.500
Validation loss decreased (-0.479578 --> -0.499350).  Saving model ...
Epoch: 14 cost time: 3.1520824432373047
Epoch: 14, Steps: 13 | Train Loss: 27.747 Vali Loss: 56.267 Vali Acc: 0.580 Test Loss: 56.267 Test Acc: 0.580
Validation loss decreased (-0.499350 --> -0.579437).  Saving model ...
Epoch: 15 cost time: 3.0718836784362793
Epoch: 15, Steps: 13 | Train Loss: 18.443 Vali Loss: 84.785 Vali Acc: 0.420 Test Loss: 84.785 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.961461067199707
Epoch: 16, Steps: 13 | Train Loss: 5.330 Vali Loss: 70.303 Vali Acc: 0.440 Test Loss: 70.303 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.0271525382995605
Epoch: 17, Steps: 13 | Train Loss: 5.047 Vali Loss: 72.782 Vali Acc: 0.440 Test Loss: 72.782 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.1161341667175293
Epoch: 18, Steps: 13 | Train Loss: 11.738 Vali Loss: 87.234 Vali Acc: 0.440 Test Loss: 87.234 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.2037606239318848
Epoch: 19, Steps: 13 | Train Loss: 7.337 Vali Loss: 76.527 Vali Acc: 0.540 Test Loss: 76.527 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.961385488510132
Epoch: 20, Steps: 13 | Train Loss: 12.209 Vali Loss: 71.359 Vali Acc: 0.460 Test Loss: 71.359 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.0978498458862305
Epoch: 21, Steps: 13 | Train Loss: 1.895 Vali Loss: 125.954 Vali Acc: 0.380 Test Loss: 125.954 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.013340711593628
Epoch: 22, Steps: 13 | Train Loss: 16.973 Vali Loss: 85.819 Vali Acc: 0.540 Test Loss: 85.819 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.122263193130493
Epoch: 23, Steps: 13 | Train Loss: 17.134 Vali Loss: 149.569 Vali Acc: 0.420 Test Loss: 149.569 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.3524179458618164
Epoch: 24, Steps: 13 | Train Loss: 15.427 Vali Loss: 127.365 Vali Acc: 0.520 Test Loss: 127.365 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 7824041
model size : 31.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.561040639877319
Epoch: 1, Steps: 13 | Train Loss: 11.056 Vali Loss: 17.511 Vali Acc: 0.200 Test Loss: 17.511 Test Acc: 0.200
Validation loss decreased (inf --> -0.199825).  Saving model ...
Epoch: 2 cost time: 3.1544647216796875
Epoch: 2, Steps: 13 | Train Loss: 16.847 Vali Loss: 10.110 Vali Acc: 0.260 Test Loss: 10.110 Test Acc: 0.260
Validation loss decreased (-0.199825 --> -0.259899).  Saving model ...
Epoch: 3 cost time: 3.202608346939087
Epoch: 3, Steps: 13 | Train Loss: 23.086 Vali Loss: 29.429 Vali Acc: 0.220 Test Loss: 29.429 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.13118577003479
Epoch: 4, Steps: 13 | Train Loss: 16.660 Vali Loss: 57.669 Vali Acc: 0.200 Test Loss: 57.669 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.236210823059082
Epoch: 5, Steps: 13 | Train Loss: 17.407 Vali Loss: 23.711 Vali Acc: 0.340 Test Loss: 23.711 Test Acc: 0.340
Validation loss decreased (-0.259899 --> -0.339763).  Saving model ...
Epoch: 6 cost time: 3.1021625995635986
Epoch: 6, Steps: 13 | Train Loss: 8.730 Vali Loss: 38.542 Vali Acc: 0.380 Test Loss: 38.542 Test Acc: 0.380
Validation loss decreased (-0.339763 --> -0.379615).  Saving model ...
Epoch: 7 cost time: 3.1134560108184814
Epoch: 7, Steps: 13 | Train Loss: 21.332 Vali Loss: 32.118 Vali Acc: 0.440 Test Loss: 32.118 Test Acc: 0.440
Validation loss decreased (-0.379615 --> -0.439679).  Saving model ...
Epoch: 8 cost time: 2.9839541912078857
Epoch: 8, Steps: 13 | Train Loss: 56.710 Vali Loss: 87.999 Vali Acc: 0.380 Test Loss: 87.999 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.2751543521881104
Epoch: 9, Steps: 13 | Train Loss: 32.363 Vali Loss: 99.827 Vali Acc: 0.300 Test Loss: 99.827 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.114314556121826
Epoch: 10, Steps: 13 | Train Loss: 32.651 Vali Loss: 131.267 Vali Acc: 0.360 Test Loss: 131.267 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.1500284671783447
Epoch: 11, Steps: 13 | Train Loss: 56.398 Vali Loss: 93.004 Vali Acc: 0.340 Test Loss: 93.004 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.0491623878479004
Epoch: 12, Steps: 13 | Train Loss: 11.166 Vali Loss: 73.193 Vali Acc: 0.480 Test Loss: 73.193 Test Acc: 0.480
Validation loss decreased (-0.439679 --> -0.479268).  Saving model ...
Epoch: 13 cost time: 3.094054698944092
Epoch: 13, Steps: 13 | Train Loss: 21.037 Vali Loss: 47.609 Vali Acc: 0.600 Test Loss: 47.609 Test Acc: 0.600
Validation loss decreased (-0.479268 --> -0.599524).  Saving model ...
Epoch: 14 cost time: 3.304730176925659
Epoch: 14, Steps: 13 | Train Loss: 10.654 Vali Loss: 48.155 Vali Acc: 0.460 Test Loss: 48.155 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.0424866676330566
Epoch: 15, Steps: 13 | Train Loss: 10.891 Vali Loss: 115.664 Vali Acc: 0.400 Test Loss: 115.664 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.337214708328247
Epoch: 16, Steps: 13 | Train Loss: 15.769 Vali Loss: 111.646 Vali Acc: 0.460 Test Loss: 111.646 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.460205078125
Epoch: 17, Steps: 13 | Train Loss: 10.680 Vali Loss: 72.465 Vali Acc: 0.540 Test Loss: 72.465 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.3268463611602783
Epoch: 18, Steps: 13 | Train Loss: 11.389 Vali Loss: 80.025 Vali Acc: 0.440 Test Loss: 80.025 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.2387852668762207
Epoch: 19, Steps: 13 | Train Loss: 5.940 Vali Loss: 108.875 Vali Acc: 0.420 Test Loss: 108.875 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.266094207763672
Epoch: 20, Steps: 13 | Train Loss: 9.953 Vali Loss: 75.601 Vali Acc: 0.460 Test Loss: 75.601 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.5480453968048096
Epoch: 21, Steps: 13 | Train Loss: 9.040 Vali Loss: 86.850 Vali Acc: 0.460 Test Loss: 86.850 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.5108866691589355
Epoch: 22, Steps: 13 | Train Loss: 3.820 Vali Loss: 197.639 Vali Acc: 0.380 Test Loss: 197.639 Test Acc: 0.380
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.5502164363861084
Epoch: 23, Steps: 13 | Train Loss: 7.511 Vali Loss: 112.501 Vali Acc: 0.520 Test Loss: 112.501 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 7821801
model size : 31.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.943448066711426
Epoch: 1, Steps: 13 | Train Loss: 9.399 Vali Loss: 14.371 Vali Acc: 0.220 Test Loss: 14.371 Test Acc: 0.220
Validation loss decreased (inf --> -0.219856).  Saving model ...
Epoch: 2 cost time: 3.0220303535461426
Epoch: 2, Steps: 13 | Train Loss: 15.293 Vali Loss: 19.393 Vali Acc: 0.340 Test Loss: 19.393 Test Acc: 0.340
Validation loss decreased (-0.219856 --> -0.339806).  Saving model ...
Epoch: 3 cost time: 2.841111898422241
Epoch: 3, Steps: 13 | Train Loss: 20.996 Vali Loss: 30.077 Vali Acc: 0.200 Test Loss: 30.077 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.985309600830078
Epoch: 4, Steps: 13 | Train Loss: 23.826 Vali Loss: 40.179 Vali Acc: 0.300 Test Loss: 40.179 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.967465400695801
Epoch: 5, Steps: 13 | Train Loss: 17.999 Vali Loss: 42.727 Vali Acc: 0.200 Test Loss: 42.727 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.1396310329437256
Epoch: 6, Steps: 13 | Train Loss: 14.729 Vali Loss: 45.039 Vali Acc: 0.320 Test Loss: 45.039 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.189608097076416
Epoch: 7, Steps: 13 | Train Loss: 14.168 Vali Loss: 78.031 Vali Acc: 0.280 Test Loss: 78.031 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.0677969455718994
Epoch: 8, Steps: 13 | Train Loss: 31.639 Vali Loss: 58.261 Vali Acc: 0.340 Test Loss: 58.261 Test Acc: 0.340
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.0349409580230713
Epoch: 9, Steps: 13 | Train Loss: 36.778 Vali Loss: 79.033 Vali Acc: 0.400 Test Loss: 79.033 Test Acc: 0.400
Validation loss decreased (-0.339806 --> -0.399210).  Saving model ...
Epoch: 10 cost time: 3.195312976837158
Epoch: 10, Steps: 13 | Train Loss: 48.538 Vali Loss: 72.337 Vali Acc: 0.420 Test Loss: 72.337 Test Acc: 0.420
Validation loss decreased (-0.399210 --> -0.419277).  Saving model ...
Epoch: 11 cost time: 2.970381736755371
Epoch: 11, Steps: 13 | Train Loss: 30.059 Vali Loss: 34.308 Vali Acc: 0.580 Test Loss: 34.308 Test Acc: 0.580
Validation loss decreased (-0.419277 --> -0.579657).  Saving model ...
Epoch: 12 cost time: 3.055014133453369
Epoch: 12, Steps: 13 | Train Loss: 12.109 Vali Loss: 75.516 Vali Acc: 0.460 Test Loss: 75.516 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.0974228382110596
Epoch: 13, Steps: 13 | Train Loss: 6.930 Vali Loss: 49.402 Vali Acc: 0.460 Test Loss: 49.402 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.062457323074341
Epoch: 14, Steps: 13 | Train Loss: 15.486 Vali Loss: 46.759 Vali Acc: 0.460 Test Loss: 46.759 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.09847092628479
Epoch: 15, Steps: 13 | Train Loss: 10.663 Vali Loss: 62.374 Vali Acc: 0.360 Test Loss: 62.374 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.0706787109375
Epoch: 16, Steps: 13 | Train Loss: 8.942 Vali Loss: 46.643 Vali Acc: 0.440 Test Loss: 46.643 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.1122684478759766
Epoch: 17, Steps: 13 | Train Loss: 11.413 Vali Loss: 55.114 Vali Acc: 0.400 Test Loss: 55.114 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.090160608291626
Epoch: 18, Steps: 13 | Train Loss: 5.897 Vali Loss: 75.616 Vali Acc: 0.420 Test Loss: 75.616 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.190603017807007
Epoch: 19, Steps: 13 | Train Loss: 4.911 Vali Loss: 101.967 Vali Acc: 0.420 Test Loss: 101.967 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.2268624305725098
Epoch: 20, Steps: 13 | Train Loss: 8.333 Vali Loss: 63.604 Vali Acc: 0.440 Test Loss: 63.604 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.047569751739502
Epoch: 21, Steps: 13 | Train Loss: 23.520 Vali Loss: 180.747 Vali Acc: 0.340 Test Loss: 180.747 Test Acc: 0.340
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 7819561
model size : 31.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.9538679122924805
Epoch: 1, Steps: 13 | Train Loss: 9.675 Vali Loss: 14.662 Vali Acc: 0.220 Test Loss: 14.662 Test Acc: 0.220
Validation loss decreased (inf --> -0.219853).  Saving model ...
Epoch: 2 cost time: 3.036525249481201
Epoch: 2, Steps: 13 | Train Loss: 19.672 Vali Loss: 25.635 Vali Acc: 0.320 Test Loss: 25.635 Test Acc: 0.320
Validation loss decreased (-0.219853 --> -0.319744).  Saving model ...
Epoch: 3 cost time: 2.9669034481048584
Epoch: 3, Steps: 13 | Train Loss: 29.325 Vali Loss: 23.568 Vali Acc: 0.260 Test Loss: 23.568 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.900033473968506
Epoch: 4, Steps: 13 | Train Loss: 22.324 Vali Loss: 23.121 Vali Acc: 0.280 Test Loss: 23.121 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.1486237049102783
Epoch: 5, Steps: 13 | Train Loss: 22.945 Vali Loss: 17.571 Vali Acc: 0.380 Test Loss: 17.571 Test Acc: 0.380
Validation loss decreased (-0.319744 --> -0.379824).  Saving model ...
Epoch: 6 cost time: 3.085118055343628
Epoch: 6, Steps: 13 | Train Loss: 27.213 Vali Loss: 29.699 Vali Acc: 0.480 Test Loss: 29.699 Test Acc: 0.480
Validation loss decreased (-0.379824 --> -0.479703).  Saving model ...
Epoch: 7 cost time: 2.9872214794158936
Epoch: 7, Steps: 13 | Train Loss: 28.853 Vali Loss: 86.170 Vali Acc: 0.420 Test Loss: 86.170 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.24630069732666
Epoch: 8, Steps: 13 | Train Loss: 34.012 Vali Loss: 65.616 Vali Acc: 0.500 Test Loss: 65.616 Test Acc: 0.500
Validation loss decreased (-0.479703 --> -0.499344).  Saving model ...
Epoch: 9 cost time: 2.9717941284179688
Epoch: 9, Steps: 13 | Train Loss: 25.820 Vali Loss: 62.425 Vali Acc: 0.520 Test Loss: 62.425 Test Acc: 0.520
Validation loss decreased (-0.499344 --> -0.519376).  Saving model ...
Epoch: 10 cost time: 3.0897769927978516
Epoch: 10, Steps: 13 | Train Loss: 36.738 Vali Loss: 128.621 Vali Acc: 0.320 Test Loss: 128.621 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.323010206222534
Epoch: 11, Steps: 13 | Train Loss: 45.836 Vali Loss: 70.556 Vali Acc: 0.500 Test Loss: 70.556 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.489058017730713
Epoch: 12, Steps: 13 | Train Loss: 25.039 Vali Loss: 54.325 Vali Acc: 0.500 Test Loss: 54.325 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.2238786220550537
Epoch: 13, Steps: 13 | Train Loss: 16.615 Vali Loss: 73.642 Vali Acc: 0.500 Test Loss: 73.642 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.0609006881713867
Epoch: 14, Steps: 13 | Train Loss: 11.721 Vali Loss: 72.624 Vali Acc: 0.440 Test Loss: 72.624 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.9668829441070557
Epoch: 15, Steps: 13 | Train Loss: 9.299 Vali Loss: 81.391 Vali Acc: 0.380 Test Loss: 81.391 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.9589996337890625
Epoch: 16, Steps: 13 | Train Loss: 5.851 Vali Loss: 70.478 Vali Acc: 0.500 Test Loss: 70.478 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.8587708473205566
Epoch: 17, Steps: 13 | Train Loss: 4.707 Vali Loss: 64.436 Vali Acc: 0.560 Test Loss: 64.436 Test Acc: 0.560
Validation loss decreased (-0.519376 --> -0.559356).  Saving model ...
Epoch: 18 cost time: 3.150733470916748
Epoch: 18, Steps: 13 | Train Loss: 3.224 Vali Loss: 65.374 Vali Acc: 0.540 Test Loss: 65.374 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.2462000846862793
Epoch: 19, Steps: 13 | Train Loss: 2.636 Vali Loss: 69.798 Vali Acc: 0.520 Test Loss: 69.798 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.3357601165771484
Epoch: 20, Steps: 13 | Train Loss: 0.864 Vali Loss: 102.767 Vali Acc: 0.420 Test Loss: 102.767 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.130117654800415
Epoch: 21, Steps: 13 | Train Loss: 1.090 Vali Loss: 87.273 Vali Acc: 0.480 Test Loss: 87.273 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.875053644180298
Epoch: 22, Steps: 13 | Train Loss: 9.480 Vali Loss: 87.634 Vali Acc: 0.440 Test Loss: 87.634 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.3255200386047363
Epoch: 23, Steps: 13 | Train Loss: 8.530 Vali Loss: 74.666 Vali Acc: 0.440 Test Loss: 74.666 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.3780910968780518
Epoch: 24, Steps: 13 | Train Loss: 4.227 Vali Loss: 87.286 Vali Acc: 0.440 Test Loss: 87.286 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.9436230659484863
Epoch: 25, Steps: 13 | Train Loss: 1.607 Vali Loss: 69.924 Vali Acc: 0.520 Test Loss: 69.924 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.1659746170043945
Epoch: 26, Steps: 13 | Train Loss: 4.210 Vali Loss: 109.810 Vali Acc: 0.400 Test Loss: 109.810 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.3697736263275146
Epoch: 27, Steps: 13 | Train Loss: 1.842 Vali Loss: 118.712 Vali Acc: 0.440 Test Loss: 118.712 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 7817321
model size : 31.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.170385837554932
Epoch: 1, Steps: 13 | Train Loss: 6.612 Vali Loss: 12.317 Vali Acc: 0.300 Test Loss: 12.317 Test Acc: 0.300
Validation loss decreased (inf --> -0.299877).  Saving model ...
Epoch: 2 cost time: 2.7843635082244873
Epoch: 2, Steps: 13 | Train Loss: 13.250 Vali Loss: 35.633 Vali Acc: 0.200 Test Loss: 35.633 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.0853567123413086
Epoch: 3, Steps: 13 | Train Loss: 12.339 Vali Loss: 16.397 Vali Acc: 0.280 Test Loss: 16.397 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.7409114837646484
Epoch: 4, Steps: 13 | Train Loss: 8.995 Vali Loss: 31.816 Vali Acc: 0.220 Test Loss: 31.816 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.7094054222106934
Epoch: 5, Steps: 13 | Train Loss: 15.812 Vali Loss: 52.306 Vali Acc: 0.340 Test Loss: 52.306 Test Acc: 0.340
Validation loss decreased (-0.299877 --> -0.339477).  Saving model ...
Epoch: 6 cost time: 2.6295604705810547
Epoch: 6, Steps: 13 | Train Loss: 28.794 Vali Loss: 39.119 Vali Acc: 0.340 Test Loss: 39.119 Test Acc: 0.340
Validation loss decreased (-0.339477 --> -0.339609).  Saving model ...
Epoch: 7 cost time: 2.789836883544922
Epoch: 7, Steps: 13 | Train Loss: 22.711 Vali Loss: 46.377 Vali Acc: 0.400 Test Loss: 46.377 Test Acc: 0.400
Validation loss decreased (-0.339609 --> -0.399536).  Saving model ...
Epoch: 8 cost time: 2.9557688236236572
Epoch: 8, Steps: 13 | Train Loss: 19.741 Vali Loss: 58.602 Vali Acc: 0.360 Test Loss: 58.602 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.1460185050964355
Epoch: 9, Steps: 13 | Train Loss: 28.761 Vali Loss: 43.608 Vali Acc: 0.480 Test Loss: 43.608 Test Acc: 0.480
Validation loss decreased (-0.399536 --> -0.479564).  Saving model ...
Epoch: 10 cost time: 2.968773365020752
Epoch: 10, Steps: 13 | Train Loss: 22.617 Vali Loss: 82.345 Vali Acc: 0.320 Test Loss: 82.345 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.920408010482788
Epoch: 11, Steps: 13 | Train Loss: 16.647 Vali Loss: 56.533 Vali Acc: 0.440 Test Loss: 56.533 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.8920581340789795
Epoch: 12, Steps: 13 | Train Loss: 15.320 Vali Loss: 47.510 Vali Acc: 0.500 Test Loss: 47.510 Test Acc: 0.500
Validation loss decreased (-0.479564 --> -0.499525).  Saving model ...
Epoch: 13 cost time: 3.0616962909698486
Epoch: 13, Steps: 13 | Train Loss: 4.314 Vali Loss: 61.341 Vali Acc: 0.420 Test Loss: 61.341 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.764559745788574
Epoch: 14, Steps: 13 | Train Loss: 12.585 Vali Loss: 80.400 Vali Acc: 0.540 Test Loss: 80.400 Test Acc: 0.540
Validation loss decreased (-0.499525 --> -0.539196).  Saving model ...
Epoch: 15 cost time: 3.1480321884155273
Epoch: 15, Steps: 13 | Train Loss: 10.419 Vali Loss: 63.255 Vali Acc: 0.520 Test Loss: 63.255 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.1254985332489014
Epoch: 16, Steps: 13 | Train Loss: 5.364 Vali Loss: 87.394 Vali Acc: 0.520 Test Loss: 87.394 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.7028491497039795
Epoch: 17, Steps: 13 | Train Loss: 11.917 Vali Loss: 62.210 Vali Acc: 0.500 Test Loss: 62.210 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.8772406578063965
Epoch: 18, Steps: 13 | Train Loss: 3.287 Vali Loss: 93.824 Vali Acc: 0.480 Test Loss: 93.824 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.986973524093628
Epoch: 19, Steps: 13 | Train Loss: 14.078 Vali Loss: 112.045 Vali Acc: 0.480 Test Loss: 112.045 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.751574754714966
Epoch: 20, Steps: 13 | Train Loss: 19.175 Vali Loss: 75.323 Vali Acc: 0.500 Test Loss: 75.323 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.0189998149871826
Epoch: 21, Steps: 13 | Train Loss: 7.762 Vali Loss: 95.200 Vali Acc: 0.500 Test Loss: 95.200 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.736452579498291
Epoch: 22, Steps: 13 | Train Loss: 21.072 Vali Loss: 114.484 Vali Acc: 0.400 Test Loss: 114.484 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.7010319232940674
Epoch: 23, Steps: 13 | Train Loss: 9.026 Vali Loss: 90.423 Vali Acc: 0.540 Test Loss: 90.423 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.9662106037139893
Epoch: 24, Steps: 13 | Train Loss: 10.943 Vali Loss: 107.425 Vali Acc: 0.380 Test Loss: 107.425 Test Acc: 0.380
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 7658921
model size : 30.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.585741996765137
Epoch: 1, Steps: 13 | Train Loss: 5.947 Vali Loss: 20.472 Vali Acc: 0.180 Test Loss: 20.472 Test Acc: 0.180
Validation loss decreased (inf --> -0.179795).  Saving model ...
Epoch: 2 cost time: 3.0051589012145996
Epoch: 2, Steps: 13 | Train Loss: 21.987 Vali Loss: 21.317 Vali Acc: 0.280 Test Loss: 21.317 Test Acc: 0.280
Validation loss decreased (-0.179795 --> -0.279787).  Saving model ...
Epoch: 3 cost time: 3.4434361457824707
Epoch: 3, Steps: 13 | Train Loss: 12.140 Vali Loss: 11.433 Vali Acc: 0.340 Test Loss: 11.433 Test Acc: 0.340
Validation loss decreased (-0.279787 --> -0.339886).  Saving model ...
Epoch: 4 cost time: 3.0831403732299805
Epoch: 4, Steps: 13 | Train Loss: 15.868 Vali Loss: 14.318 Vali Acc: 0.280 Test Loss: 14.318 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.128171682357788
Epoch: 5, Steps: 13 | Train Loss: 23.828 Vali Loss: 35.806 Vali Acc: 0.340 Test Loss: 35.806 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.832308769226074
Epoch: 6, Steps: 13 | Train Loss: 23.268 Vali Loss: 24.133 Vali Acc: 0.420 Test Loss: 24.133 Test Acc: 0.420
Validation loss decreased (-0.339886 --> -0.419759).  Saving model ...
Epoch: 7 cost time: 3.15470552444458
Epoch: 7, Steps: 13 | Train Loss: 29.091 Vali Loss: 93.344 Vali Acc: 0.340 Test Loss: 93.344 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.3679940700531006
Epoch: 8, Steps: 13 | Train Loss: 59.567 Vali Loss: 36.362 Vali Acc: 0.340 Test Loss: 36.362 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.213686466217041
Epoch: 9, Steps: 13 | Train Loss: 40.757 Vali Loss: 92.303 Vali Acc: 0.480 Test Loss: 92.303 Test Acc: 0.480
Validation loss decreased (-0.419759 --> -0.479077).  Saving model ...
Epoch: 10 cost time: 3.0640575885772705
Epoch: 10, Steps: 13 | Train Loss: 24.804 Vali Loss: 81.394 Vali Acc: 0.380 Test Loss: 81.394 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.195909023284912
Epoch: 11, Steps: 13 | Train Loss: 29.883 Vali Loss: 72.260 Vali Acc: 0.420 Test Loss: 72.260 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.0204384326934814
Epoch: 12, Steps: 13 | Train Loss: 26.948 Vali Loss: 105.110 Vali Acc: 0.440 Test Loss: 105.110 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.320280075073242
Epoch: 13, Steps: 13 | Train Loss: 28.540 Vali Loss: 115.998 Vali Acc: 0.360 Test Loss: 115.998 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.288644313812256
Epoch: 14, Steps: 13 | Train Loss: 32.575 Vali Loss: 67.480 Vali Acc: 0.480 Test Loss: 67.480 Test Acc: 0.480
Validation loss decreased (-0.479077 --> -0.479325).  Saving model ...
Epoch: 15 cost time: 3.125014543533325
Epoch: 15, Steps: 13 | Train Loss: 13.592 Vali Loss: 48.693 Vali Acc: 0.540 Test Loss: 48.693 Test Acc: 0.540
Validation loss decreased (-0.479325 --> -0.539513).  Saving model ...
Epoch: 16 cost time: 3.3403663635253906
Epoch: 16, Steps: 13 | Train Loss: 23.996 Vali Loss: 166.116 Vali Acc: 0.380 Test Loss: 166.116 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.2764687538146973
Epoch: 17, Steps: 13 | Train Loss: 20.026 Vali Loss: 88.183 Vali Acc: 0.480 Test Loss: 88.183 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.0354630947113037
Epoch: 18, Steps: 13 | Train Loss: 10.975 Vali Loss: 167.219 Vali Acc: 0.440 Test Loss: 167.219 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.8547215461730957
Epoch: 19, Steps: 13 | Train Loss: 22.652 Vali Loss: 142.088 Vali Acc: 0.460 Test Loss: 142.088 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.334580898284912
Epoch: 20, Steps: 13 | Train Loss: 12.193 Vali Loss: 114.107 Vali Acc: 0.500 Test Loss: 114.107 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.966304302215576
Epoch: 21, Steps: 13 | Train Loss: 4.843 Vali Loss: 90.125 Vali Acc: 0.680 Test Loss: 90.125 Test Acc: 0.680
Validation loss decreased (-0.539513 --> -0.679099).  Saving model ...
Epoch: 22 cost time: 3.0466561317443848
Epoch: 22, Steps: 13 | Train Loss: 3.925 Vali Loss: 87.967 Vali Acc: 0.520 Test Loss: 87.967 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.3555963039398193
Epoch: 23, Steps: 13 | Train Loss: 13.161 Vali Loss: 107.651 Vali Acc: 0.440 Test Loss: 107.651 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.3313748836517334
Epoch: 24, Steps: 13 | Train Loss: 0.940 Vali Loss: 126.292 Vali Acc: 0.440 Test Loss: 126.292 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.961453437805176
Epoch: 25, Steps: 13 | Train Loss: 16.035 Vali Loss: 131.452 Vali Acc: 0.420 Test Loss: 131.452 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.162090539932251
Epoch: 26, Steps: 13 | Train Loss: 3.767 Vali Loss: 109.278 Vali Acc: 0.560 Test Loss: 109.278 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.1893808841705322
Epoch: 27, Steps: 13 | Train Loss: 0.018 Vali Loss: 141.418 Vali Acc: 0.480 Test Loss: 141.418 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.424386978149414
Epoch: 28, Steps: 13 | Train Loss: 0.862 Vali Loss: 98.556 Vali Acc: 0.560 Test Loss: 98.556 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.20925235748291
Epoch: 29, Steps: 13 | Train Loss: 0.500 Vali Loss: 91.239 Vali Acc: 0.520 Test Loss: 91.239 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.4084277153015137
Epoch: 30, Steps: 13 | Train Loss: 9.702 Vali Loss: 107.008 Vali Acc: 0.560 Test Loss: 107.008 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 3.105199098587036
Epoch: 31, Steps: 13 | Train Loss: 9.425 Vali Loss: 148.653 Vali Acc: 0.480 Test Loss: 148.653 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.68
model parameter : 7656681
model size : 30.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.033950328826904
Epoch: 1, Steps: 13 | Train Loss: 7.886 Vali Loss: 16.256 Vali Acc: 0.200 Test Loss: 16.256 Test Acc: 0.200
Validation loss decreased (inf --> -0.199837).  Saving model ...
Epoch: 2 cost time: 2.8527097702026367
Epoch: 2, Steps: 13 | Train Loss: 17.081 Vali Loss: 18.443 Vali Acc: 0.200 Test Loss: 18.443 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.798299551010132
Epoch: 3, Steps: 13 | Train Loss: 22.379 Vali Loss: 26.840 Vali Acc: 0.280 Test Loss: 26.840 Test Acc: 0.280
Validation loss decreased (-0.199837 --> -0.279732).  Saving model ...
Epoch: 4 cost time: 2.6151669025421143
Epoch: 4, Steps: 13 | Train Loss: 15.703 Vali Loss: 20.593 Vali Acc: 0.400 Test Loss: 20.593 Test Acc: 0.400
Validation loss decreased (-0.279732 --> -0.399794).  Saving model ...
Epoch: 5 cost time: 2.8431107997894287
Epoch: 5, Steps: 13 | Train Loss: 18.743 Vali Loss: 26.565 Vali Acc: 0.280 Test Loss: 26.565 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.865657091140747
Epoch: 6, Steps: 13 | Train Loss: 17.496 Vali Loss: 41.924 Vali Acc: 0.400 Test Loss: 41.924 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.7595558166503906
Epoch: 7, Steps: 13 | Train Loss: 30.914 Vali Loss: 52.672 Vali Acc: 0.460 Test Loss: 52.672 Test Acc: 0.460
Validation loss decreased (-0.399794 --> -0.459473).  Saving model ...
Epoch: 8 cost time: 2.882770538330078
Epoch: 8, Steps: 13 | Train Loss: 19.717 Vali Loss: 51.864 Vali Acc: 0.480 Test Loss: 51.864 Test Acc: 0.480
Validation loss decreased (-0.459473 --> -0.479481).  Saving model ...
Epoch: 9 cost time: 3.0358762741088867
Epoch: 9, Steps: 13 | Train Loss: 20.315 Vali Loss: 44.941 Vali Acc: 0.480 Test Loss: 44.941 Test Acc: 0.480
Validation loss decreased (-0.479481 --> -0.479551).  Saving model ...
Epoch: 10 cost time: 2.9602129459381104
Epoch: 10, Steps: 13 | Train Loss: 27.071 Vali Loss: 98.330 Vali Acc: 0.380 Test Loss: 98.330 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.1639039516448975
Epoch: 11, Steps: 13 | Train Loss: 31.601 Vali Loss: 75.647 Vali Acc: 0.400 Test Loss: 75.647 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.9432623386383057
Epoch: 12, Steps: 13 | Train Loss: 13.884 Vali Loss: 64.535 Vali Acc: 0.520 Test Loss: 64.535 Test Acc: 0.520
Validation loss decreased (-0.479551 --> -0.519355).  Saving model ...
Epoch: 13 cost time: 2.8562705516815186
Epoch: 13, Steps: 13 | Train Loss: 19.767 Vali Loss: 101.050 Vali Acc: 0.460 Test Loss: 101.050 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.9284510612487793
Epoch: 14, Steps: 13 | Train Loss: 39.519 Vali Loss: 59.843 Vali Acc: 0.440 Test Loss: 59.843 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.1191444396972656
Epoch: 15, Steps: 13 | Train Loss: 12.125 Vali Loss: 59.324 Vali Acc: 0.540 Test Loss: 59.324 Test Acc: 0.540
Validation loss decreased (-0.519355 --> -0.539407).  Saving model ...
Epoch: 16 cost time: 2.919649839401245
Epoch: 16, Steps: 13 | Train Loss: 3.293 Vali Loss: 78.594 Vali Acc: 0.440 Test Loss: 78.594 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.8255555629730225
Epoch: 17, Steps: 13 | Train Loss: 17.651 Vali Loss: 101.308 Vali Acc: 0.440 Test Loss: 101.308 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.0106730461120605
Epoch: 18, Steps: 13 | Train Loss: 12.352 Vali Loss: 105.361 Vali Acc: 0.540 Test Loss: 105.361 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.2128100395202637
Epoch: 19, Steps: 13 | Train Loss: 9.717 Vali Loss: 112.422 Vali Acc: 0.400 Test Loss: 112.422 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.895019292831421
Epoch: 20, Steps: 13 | Train Loss: 18.082 Vali Loss: 120.469 Vali Acc: 0.400 Test Loss: 120.469 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.9432132244110107
Epoch: 21, Steps: 13 | Train Loss: 13.893 Vali Loss: 96.881 Vali Acc: 0.440 Test Loss: 96.881 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.8733391761779785
Epoch: 22, Steps: 13 | Train Loss: 8.609 Vali Loss: 99.611 Vali Acc: 0.500 Test Loss: 99.611 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.8259544372558594
Epoch: 23, Steps: 13 | Train Loss: 10.373 Vali Loss: 140.663 Vali Acc: 0.420 Test Loss: 140.663 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.9996254444122314
Epoch: 24, Steps: 13 | Train Loss: 27.502 Vali Loss: 70.350 Vali Acc: 0.500 Test Loss: 70.350 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.8059306144714355
Epoch: 25, Steps: 13 | Train Loss: 0.007 Vali Loss: 107.678 Vali Acc: 0.400 Test Loss: 107.678 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 7654441
model size : 30.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.47374963760376
Epoch: 1, Steps: 13 | Train Loss: 4.856 Vali Loss: 9.955 Vali Acc: 0.200 Test Loss: 9.955 Test Acc: 0.200
Validation loss decreased (inf --> -0.199900).  Saving model ...
Epoch: 2 cost time: 2.732512950897217
Epoch: 2, Steps: 13 | Train Loss: 13.236 Vali Loss: 19.238 Vali Acc: 0.280 Test Loss: 19.238 Test Acc: 0.280
Validation loss decreased (-0.199900 --> -0.279808).  Saving model ...
Epoch: 3 cost time: 2.7840735912323
Epoch: 3, Steps: 13 | Train Loss: 22.472 Vali Loss: 20.070 Vali Acc: 0.280 Test Loss: 20.070 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.8536765575408936
Epoch: 4, Steps: 13 | Train Loss: 18.156 Vali Loss: 12.540 Vali Acc: 0.420 Test Loss: 12.540 Test Acc: 0.420
Validation loss decreased (-0.279808 --> -0.419875).  Saving model ...
Epoch: 5 cost time: 2.857457399368286
Epoch: 5, Steps: 13 | Train Loss: 17.550 Vali Loss: 34.171 Vali Acc: 0.320 Test Loss: 34.171 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.695307970046997
Epoch: 6, Steps: 13 | Train Loss: 24.458 Vali Loss: 30.514 Vali Acc: 0.420 Test Loss: 30.514 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.9684247970581055
Epoch: 7, Steps: 13 | Train Loss: 9.491 Vali Loss: 36.042 Vali Acc: 0.300 Test Loss: 36.042 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.8296470642089844
Epoch: 8, Steps: 13 | Train Loss: 17.389 Vali Loss: 43.287 Vali Acc: 0.320 Test Loss: 43.287 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.7616896629333496
Epoch: 9, Steps: 13 | Train Loss: 20.280 Vali Loss: 44.901 Vali Acc: 0.360 Test Loss: 44.901 Test Acc: 0.360
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.760495662689209
Epoch: 10, Steps: 13 | Train Loss: 16.132 Vali Loss: 33.884 Vali Acc: 0.400 Test Loss: 33.884 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.7077319622039795
Epoch: 11, Steps: 13 | Train Loss: 11.603 Vali Loss: 50.000 Vali Acc: 0.400 Test Loss: 50.000 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.146960973739624
Epoch: 12, Steps: 13 | Train Loss: 27.669 Vali Loss: 74.435 Vali Acc: 0.360 Test Loss: 74.435 Test Acc: 0.360
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.5624377727508545
Epoch: 13, Steps: 13 | Train Loss: 21.925 Vali Loss: 62.035 Vali Acc: 0.460 Test Loss: 62.035 Test Acc: 0.460
Validation loss decreased (-0.419875 --> -0.459380).  Saving model ...
Epoch: 14 cost time: 2.7499771118164062
Epoch: 14, Steps: 13 | Train Loss: 13.844 Vali Loss: 72.176 Vali Acc: 0.360 Test Loss: 72.176 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.118482828140259
Epoch: 15, Steps: 13 | Train Loss: 20.796 Vali Loss: 72.059 Vali Acc: 0.400 Test Loss: 72.059 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.8188555240631104
Epoch: 16, Steps: 13 | Train Loss: 8.591 Vali Loss: 60.013 Vali Acc: 0.420 Test Loss: 60.013 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.725539207458496
Epoch: 17, Steps: 13 | Train Loss: 9.064 Vali Loss: 112.128 Vali Acc: 0.300 Test Loss: 112.128 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.881437301635742
Epoch: 18, Steps: 13 | Train Loss: 27.217 Vali Loss: 76.606 Vali Acc: 0.540 Test Loss: 76.606 Test Acc: 0.540
Validation loss decreased (-0.459380 --> -0.539234).  Saving model ...
Epoch: 19 cost time: 2.8479204177856445
Epoch: 19, Steps: 13 | Train Loss: 16.668 Vali Loss: 69.890 Vali Acc: 0.460 Test Loss: 69.890 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.8972442150115967
Epoch: 20, Steps: 13 | Train Loss: 5.929 Vali Loss: 76.525 Vali Acc: 0.540 Test Loss: 76.525 Test Acc: 0.540
Validation loss decreased (-0.539234 --> -0.539235).  Saving model ...
Epoch: 21 cost time: 2.9994969367980957
Epoch: 21, Steps: 13 | Train Loss: 11.428 Vali Loss: 131.365 Vali Acc: 0.480 Test Loss: 131.365 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.8172130584716797
Epoch: 22, Steps: 13 | Train Loss: 6.182 Vali Loss: 85.743 Vali Acc: 0.420 Test Loss: 85.743 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.642725944519043
Epoch: 23, Steps: 13 | Train Loss: 6.735 Vali Loss: 94.245 Vali Acc: 0.460 Test Loss: 94.245 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.812375783920288
Epoch: 24, Steps: 13 | Train Loss: 6.405 Vali Loss: 95.940 Vali Acc: 0.460 Test Loss: 95.940 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.9263534545898438
Epoch: 25, Steps: 13 | Train Loss: 1.102 Vali Loss: 84.274 Vali Acc: 0.540 Test Loss: 84.274 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.7741222381591797
Epoch: 26, Steps: 13 | Train Loss: 6.583 Vali Loss: 92.195 Vali Acc: 0.440 Test Loss: 92.195 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.815945625305176
Epoch: 27, Steps: 13 | Train Loss: 2.340 Vali Loss: 82.051 Vali Acc: 0.520 Test Loss: 82.051 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.7579379081726074
Epoch: 28, Steps: 13 | Train Loss: 2.790 Vali Loss: 98.249 Vali Acc: 0.500 Test Loss: 98.249 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.632868528366089
Epoch: 29, Steps: 13 | Train Loss: 2.358 Vali Loss: 122.108 Vali Acc: 0.440 Test Loss: 122.108 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.814807891845703
Epoch: 30, Steps: 13 | Train Loss: 0.465 Vali Loss: 139.569 Vali Acc: 0.520 Test Loss: 139.569 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 7652201
model size : 30.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.143407583236694
Epoch: 1, Steps: 13 | Train Loss: 9.002 Vali Loss: 15.569 Vali Acc: 0.200 Test Loss: 15.569 Test Acc: 0.200
Validation loss decreased (inf --> -0.199844).  Saving model ...
Epoch: 2 cost time: 2.9184062480926514
Epoch: 2, Steps: 13 | Train Loss: 13.925 Vali Loss: 28.428 Vali Acc: 0.240 Test Loss: 28.428 Test Acc: 0.240
Validation loss decreased (-0.199844 --> -0.239716).  Saving model ...
Epoch: 3 cost time: 2.6029396057128906
Epoch: 3, Steps: 13 | Train Loss: 19.320 Vali Loss: 41.684 Vali Acc: 0.320 Test Loss: 41.684 Test Acc: 0.320
Validation loss decreased (-0.239716 --> -0.319583).  Saving model ...
Epoch: 4 cost time: 2.690849781036377
Epoch: 4, Steps: 13 | Train Loss: 33.607 Vali Loss: 41.935 Vali Acc: 0.240 Test Loss: 41.935 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.8845107555389404
Epoch: 5, Steps: 13 | Train Loss: 24.540 Vali Loss: 36.435 Vali Acc: 0.400 Test Loss: 36.435 Test Acc: 0.400
Validation loss decreased (-0.319583 --> -0.399636).  Saving model ...
Epoch: 6 cost time: 2.5979270935058594
Epoch: 6, Steps: 13 | Train Loss: 48.311 Vali Loss: 55.134 Vali Acc: 0.460 Test Loss: 55.134 Test Acc: 0.460
Validation loss decreased (-0.399636 --> -0.459449).  Saving model ...
Epoch: 7 cost time: 2.9193997383117676
Epoch: 7, Steps: 13 | Train Loss: 28.575 Vali Loss: 97.925 Vali Acc: 0.260 Test Loss: 97.925 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.7144603729248047
Epoch: 8, Steps: 13 | Train Loss: 47.952 Vali Loss: 83.263 Vali Acc: 0.280 Test Loss: 83.263 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.7163875102996826
Epoch: 9, Steps: 13 | Train Loss: 24.445 Vali Loss: 93.544 Vali Acc: 0.240 Test Loss: 93.544 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.784114122390747
Epoch: 10, Steps: 13 | Train Loss: 46.717 Vali Loss: 73.203 Vali Acc: 0.300 Test Loss: 73.203 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.789595365524292
Epoch: 11, Steps: 13 | Train Loss: 19.942 Vali Loss: 57.752 Vali Acc: 0.440 Test Loss: 57.752 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.9743378162384033
Epoch: 12, Steps: 13 | Train Loss: 15.735 Vali Loss: 92.475 Vali Acc: 0.400 Test Loss: 92.475 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.74649977684021
Epoch: 13, Steps: 13 | Train Loss: 26.421 Vali Loss: 117.827 Vali Acc: 0.420 Test Loss: 117.827 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.7741971015930176
Epoch: 14, Steps: 13 | Train Loss: 38.433 Vali Loss: 103.952 Vali Acc: 0.540 Test Loss: 103.952 Test Acc: 0.540
Validation loss decreased (-0.459449 --> -0.538960).  Saving model ...
Epoch: 15 cost time: 2.794844388961792
Epoch: 15, Steps: 13 | Train Loss: 13.217 Vali Loss: 57.937 Vali Acc: 0.400 Test Loss: 57.937 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.8692753314971924
Epoch: 16, Steps: 13 | Train Loss: 2.912 Vali Loss: 69.297 Vali Acc: 0.520 Test Loss: 69.297 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.8085575103759766
Epoch: 17, Steps: 13 | Train Loss: 24.001 Vali Loss: 79.835 Vali Acc: 0.520 Test Loss: 79.835 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.2144763469696045
Epoch: 18, Steps: 13 | Train Loss: 7.398 Vali Loss: 77.945 Vali Acc: 0.540 Test Loss: 77.945 Test Acc: 0.540
Validation loss decreased (-0.538960 --> -0.539221).  Saving model ...
Epoch: 19 cost time: 2.80950927734375
Epoch: 19, Steps: 13 | Train Loss: 8.412 Vali Loss: 60.475 Vali Acc: 0.580 Test Loss: 60.475 Test Acc: 0.580
Validation loss decreased (-0.539221 --> -0.579395).  Saving model ...
Epoch: 20 cost time: 2.88466215133667
Epoch: 20, Steps: 13 | Train Loss: 4.642 Vali Loss: 75.914 Vali Acc: 0.500 Test Loss: 75.914 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.8982021808624268
Epoch: 21, Steps: 13 | Train Loss: 14.269 Vali Loss: 81.234 Vali Acc: 0.540 Test Loss: 81.234 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.7825450897216797
Epoch: 22, Steps: 13 | Train Loss: 4.206 Vali Loss: 74.286 Vali Acc: 0.460 Test Loss: 74.286 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.878365993499756
Epoch: 23, Steps: 13 | Train Loss: 12.967 Vali Loss: 93.384 Vali Acc: 0.480 Test Loss: 93.384 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.9340462684631348
Epoch: 24, Steps: 13 | Train Loss: 4.297 Vali Loss: 93.665 Vali Acc: 0.560 Test Loss: 93.665 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.8559913635253906
Epoch: 25, Steps: 13 | Train Loss: 5.983 Vali Loss: 105.214 Vali Acc: 0.500 Test Loss: 105.214 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.9063193798065186
Epoch: 26, Steps: 13 | Train Loss: 17.818 Vali Loss: 87.111 Vali Acc: 0.540 Test Loss: 87.111 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.8057947158813477
Epoch: 27, Steps: 13 | Train Loss: 0.566 Vali Loss: 112.111 Vali Acc: 0.500 Test Loss: 112.111 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.8084757328033447
Epoch: 28, Steps: 13 | Train Loss: 4.806 Vali Loss: 130.609 Vali Acc: 0.480 Test Loss: 130.609 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.8196120262145996
Epoch: 29, Steps: 13 | Train Loss: 0.203 Vali Loss: 92.492 Vali Acc: 0.540 Test Loss: 92.492 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 7576361
model size : 30.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.175156354904175
Epoch: 1, Steps: 13 | Train Loss: 5.969 Vali Loss: 7.579 Vali Acc: 0.240 Test Loss: 7.579 Test Acc: 0.240
Validation loss decreased (inf --> -0.239924).  Saving model ...
Epoch: 2 cost time: 3.0114872455596924
Epoch: 2, Steps: 13 | Train Loss: 15.268 Vali Loss: 17.671 Vali Acc: 0.340 Test Loss: 17.671 Test Acc: 0.340
Validation loss decreased (-0.239924 --> -0.339823).  Saving model ...
Epoch: 3 cost time: 3.1132757663726807
Epoch: 3, Steps: 13 | Train Loss: 12.223 Vali Loss: 21.995 Vali Acc: 0.240 Test Loss: 21.995 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.0513594150543213
Epoch: 4, Steps: 13 | Train Loss: 20.340 Vali Loss: 42.989 Vali Acc: 0.220 Test Loss: 42.989 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.8299286365509033
Epoch: 5, Steps: 13 | Train Loss: 19.589 Vali Loss: 33.734 Vali Acc: 0.460 Test Loss: 33.734 Test Acc: 0.460
Validation loss decreased (-0.339823 --> -0.459663).  Saving model ...
Epoch: 6 cost time: 2.916900634765625
Epoch: 6, Steps: 13 | Train Loss: 35.069 Vali Loss: 70.194 Vali Acc: 0.260 Test Loss: 70.194 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.8970718383789062
Epoch: 7, Steps: 13 | Train Loss: 43.290 Vali Loss: 71.060 Vali Acc: 0.440 Test Loss: 71.060 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.2456107139587402
Epoch: 8, Steps: 13 | Train Loss: 25.677 Vali Loss: 78.553 Vali Acc: 0.420 Test Loss: 78.553 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.0522406101226807
Epoch: 9, Steps: 13 | Train Loss: 47.764 Vali Loss: 66.928 Vali Acc: 0.380 Test Loss: 66.928 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.9798967838287354
Epoch: 10, Steps: 13 | Train Loss: 11.969 Vali Loss: 50.975 Vali Acc: 0.460 Test Loss: 50.975 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.2380530834198
Epoch: 11, Steps: 13 | Train Loss: 11.929 Vali Loss: 43.145 Vali Acc: 0.520 Test Loss: 43.145 Test Acc: 0.520
Validation loss decreased (-0.459663 --> -0.519569).  Saving model ...
Epoch: 12 cost time: 3.0555202960968018
Epoch: 12, Steps: 13 | Train Loss: 17.909 Vali Loss: 76.865 Vali Acc: 0.400 Test Loss: 76.865 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.9781253337860107
Epoch: 13, Steps: 13 | Train Loss: 29.567 Vali Loss: 96.603 Vali Acc: 0.460 Test Loss: 96.603 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.8127076625823975
Epoch: 14, Steps: 13 | Train Loss: 14.918 Vali Loss: 58.790 Vali Acc: 0.400 Test Loss: 58.790 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.9864020347595215
Epoch: 15, Steps: 13 | Train Loss: 2.931 Vali Loss: 64.472 Vali Acc: 0.400 Test Loss: 64.472 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.9533605575561523
Epoch: 16, Steps: 13 | Train Loss: 2.407 Vali Loss: 58.961 Vali Acc: 0.420 Test Loss: 58.961 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.9735708236694336
Epoch: 17, Steps: 13 | Train Loss: 2.199 Vali Loss: 142.333 Vali Acc: 0.420 Test Loss: 142.333 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.882164478302002
Epoch: 18, Steps: 13 | Train Loss: 25.156 Vali Loss: 86.415 Vali Acc: 0.460 Test Loss: 86.415 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.912494421005249
Epoch: 19, Steps: 13 | Train Loss: 10.282 Vali Loss: 123.906 Vali Acc: 0.380 Test Loss: 123.906 Test Acc: 0.380
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.032567024230957
Epoch: 20, Steps: 13 | Train Loss: 17.424 Vali Loss: 104.293 Vali Acc: 0.480 Test Loss: 104.293 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.058286666870117
Epoch: 21, Steps: 13 | Train Loss: 12.669 Vali Loss: 62.376 Vali Acc: 0.540 Test Loss: 62.376 Test Acc: 0.540
Validation loss decreased (-0.519569 --> -0.539376).  Saving model ...
Epoch: 22 cost time: 3.0179529190063477
Epoch: 22, Steps: 13 | Train Loss: 4.853 Vali Loss: 86.809 Vali Acc: 0.560 Test Loss: 86.809 Test Acc: 0.560
Validation loss decreased (-0.539376 --> -0.559132).  Saving model ...
Epoch: 23 cost time: 2.989453077316284
Epoch: 23, Steps: 13 | Train Loss: 4.296 Vali Loss: 94.647 Vali Acc: 0.540 Test Loss: 94.647 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.1543853282928467
Epoch: 24, Steps: 13 | Train Loss: 10.805 Vali Loss: 107.033 Vali Acc: 0.460 Test Loss: 107.033 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.0306200981140137
Epoch: 25, Steps: 13 | Train Loss: 8.658 Vali Loss: 124.217 Vali Acc: 0.440 Test Loss: 124.217 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.9931740760803223
Epoch: 26, Steps: 13 | Train Loss: 2.839 Vali Loss: 77.670 Vali Acc: 0.600 Test Loss: 77.670 Test Acc: 0.600
Validation loss decreased (-0.559132 --> -0.599223).  Saving model ...
Epoch: 27 cost time: 3.145235538482666
Epoch: 27, Steps: 13 | Train Loss: 0.934 Vali Loss: 95.310 Vali Acc: 0.600 Test Loss: 95.310 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.910733938217163
Epoch: 28, Steps: 13 | Train Loss: 9.119 Vali Loss: 77.026 Vali Acc: 0.600 Test Loss: 77.026 Test Acc: 0.600
Validation loss decreased (-0.599223 --> -0.599230).  Saving model ...
Epoch: 29 cost time: 3.173261880874634
Epoch: 29, Steps: 13 | Train Loss: 14.524 Vali Loss: 73.724 Vali Acc: 0.600 Test Loss: 73.724 Test Acc: 0.600
Validation loss decreased (-0.599230 --> -0.599263).  Saving model ...
Epoch: 30 cost time: 2.7748169898986816
Epoch: 30, Steps: 13 | Train Loss: 3.647 Vali Loss: 100.325 Vali Acc: 0.580 Test Loss: 100.325 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.759697914123535
Epoch: 31, Steps: 13 | Train Loss: 0.000 Vali Loss: 124.918 Vali Acc: 0.520 Test Loss: 124.918 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.1115190982818604
Epoch: 32, Steps: 13 | Train Loss: 4.302 Vali Loss: 99.595 Vali Acc: 0.500 Test Loss: 99.595 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.2703893184661865
Epoch: 33, Steps: 13 | Train Loss: 8.497 Vali Loss: 137.569 Vali Acc: 0.500 Test Loss: 137.569 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.0073776245117188
Epoch: 34, Steps: 13 | Train Loss: 20.676 Vali Loss: 188.127 Vali Acc: 0.460 Test Loss: 188.127 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.8797428607940674
Epoch: 35, Steps: 13 | Train Loss: 21.611 Vali Loss: 112.533 Vali Acc: 0.540 Test Loss: 112.533 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 2.956052541732788
Epoch: 36, Steps: 13 | Train Loss: 5.763 Vali Loss: 78.568 Vali Acc: 0.500 Test Loss: 78.568 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 2.7921643257141113
Epoch: 37, Steps: 13 | Train Loss: 14.524 Vali Loss: 132.766 Vali Acc: 0.500 Test Loss: 132.766 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 3.0379600524902344
Epoch: 38, Steps: 13 | Train Loss: 16.418 Vali Loss: 136.346 Vali Acc: 0.460 Test Loss: 136.346 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 2.8629634380340576
Epoch: 39, Steps: 13 | Train Loss: 18.280 Vali Loss: 125.931 Vali Acc: 0.560 Test Loss: 125.931 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 7574121
model size : 30.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.658891439437866
Epoch: 1, Steps: 13 | Train Loss: 10.016 Vali Loss: 17.770 Vali Acc: 0.200 Test Loss: 17.770 Test Acc: 0.200
Validation loss decreased (inf --> -0.199822).  Saving model ...
Epoch: 2 cost time: 2.7701478004455566
Epoch: 2, Steps: 13 | Train Loss: 18.873 Vali Loss: 20.929 Vali Acc: 0.160 Test Loss: 20.929 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.8288044929504395
Epoch: 3, Steps: 13 | Train Loss: 26.993 Vali Loss: 65.332 Vali Acc: 0.200 Test Loss: 65.332 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.877863883972168
Epoch: 4, Steps: 13 | Train Loss: 35.611 Vali Loss: 74.489 Vali Acc: 0.200 Test Loss: 74.489 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.651240348815918
Epoch: 5, Steps: 13 | Train Loss: 45.650 Vali Loss: 119.405 Vali Acc: 0.200 Test Loss: 119.405 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.7022159099578857
Epoch: 6, Steps: 13 | Train Loss: 65.566 Vali Loss: 105.231 Vali Acc: 0.380 Test Loss: 105.231 Test Acc: 0.380
Validation loss decreased (-0.199822 --> -0.378948).  Saving model ...
Epoch: 7 cost time: 2.808576822280884
Epoch: 7, Steps: 13 | Train Loss: 62.446 Vali Loss: 91.472 Vali Acc: 0.260 Test Loss: 91.472 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.743858575820923
Epoch: 8, Steps: 13 | Train Loss: 29.523 Vali Loss: 38.862 Vali Acc: 0.480 Test Loss: 38.862 Test Acc: 0.480
Validation loss decreased (-0.378948 --> -0.479611).  Saving model ...
Epoch: 9 cost time: 2.9283602237701416
Epoch: 9, Steps: 13 | Train Loss: 10.945 Vali Loss: 27.376 Vali Acc: 0.420 Test Loss: 27.376 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.7036542892456055
Epoch: 10, Steps: 13 | Train Loss: 22.292 Vali Loss: 62.605 Vali Acc: 0.340 Test Loss: 62.605 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.7936978340148926
Epoch: 11, Steps: 13 | Train Loss: 18.431 Vali Loss: 70.516 Vali Acc: 0.420 Test Loss: 70.516 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.609920024871826
Epoch: 12, Steps: 13 | Train Loss: 26.021 Vali Loss: 46.003 Vali Acc: 0.520 Test Loss: 46.003 Test Acc: 0.520
Validation loss decreased (-0.479611 --> -0.519540).  Saving model ...
Epoch: 13 cost time: 2.7215588092803955
Epoch: 13, Steps: 13 | Train Loss: 18.647 Vali Loss: 38.494 Vali Acc: 0.520 Test Loss: 38.494 Test Acc: 0.520
Validation loss decreased (-0.519540 --> -0.519615).  Saving model ...
Epoch: 14 cost time: 2.8528778553009033
Epoch: 14, Steps: 13 | Train Loss: 8.330 Vali Loss: 65.120 Vali Acc: 0.320 Test Loss: 65.120 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.7858569622039795
Epoch: 15, Steps: 13 | Train Loss: 20.168 Vali Loss: 144.782 Vali Acc: 0.400 Test Loss: 144.782 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.979041814804077
Epoch: 16, Steps: 13 | Train Loss: 20.982 Vali Loss: 123.538 Vali Acc: 0.420 Test Loss: 123.538 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.7474093437194824
Epoch: 17, Steps: 13 | Train Loss: 39.080 Vali Loss: 85.828 Vali Acc: 0.420 Test Loss: 85.828 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.7924540042877197
Epoch: 18, Steps: 13 | Train Loss: 26.902 Vali Loss: 104.780 Vali Acc: 0.480 Test Loss: 104.780 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.9809253215789795
Epoch: 19, Steps: 13 | Train Loss: 17.265 Vali Loss: 69.501 Vali Acc: 0.520 Test Loss: 69.501 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.643380641937256
Epoch: 20, Steps: 13 | Train Loss: 8.170 Vali Loss: 63.399 Vali Acc: 0.620 Test Loss: 63.399 Test Acc: 0.620
Validation loss decreased (-0.519615 --> -0.619366).  Saving model ...
Epoch: 21 cost time: 2.8451104164123535
Epoch: 21, Steps: 13 | Train Loss: 4.993 Vali Loss: 93.373 Vali Acc: 0.480 Test Loss: 93.373 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.7101829051971436
Epoch: 22, Steps: 13 | Train Loss: 4.983 Vali Loss: 59.192 Vali Acc: 0.600 Test Loss: 59.192 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.8603880405426025
Epoch: 23, Steps: 13 | Train Loss: 1.864 Vali Loss: 85.554 Vali Acc: 0.560 Test Loss: 85.554 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.7401838302612305
Epoch: 24, Steps: 13 | Train Loss: 3.802 Vali Loss: 157.070 Vali Acc: 0.360 Test Loss: 157.070 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.887275218963623
Epoch: 25, Steps: 13 | Train Loss: 10.224 Vali Loss: 115.878 Vali Acc: 0.500 Test Loss: 115.878 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.798262357711792
Epoch: 26, Steps: 13 | Train Loss: 13.907 Vali Loss: 76.693 Vali Acc: 0.540 Test Loss: 76.693 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.779261589050293
Epoch: 27, Steps: 13 | Train Loss: 0.285 Vali Loss: 84.267 Vali Acc: 0.520 Test Loss: 84.267 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.1937766075134277
Epoch: 28, Steps: 13 | Train Loss: 0.332 Vali Loss: 114.435 Vali Acc: 0.440 Test Loss: 114.435 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.9133334159851074
Epoch: 29, Steps: 13 | Train Loss: 0.814 Vali Loss: 99.186 Vali Acc: 0.540 Test Loss: 99.186 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.9069597721099854
Epoch: 30, Steps: 13 | Train Loss: 0.975 Vali Loss: 122.275 Vali Acc: 0.520 Test Loss: 122.275 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 7571881
model size : 30.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.381743669509888
Epoch: 1, Steps: 13 | Train Loss: 6.232 Vali Loss: 10.509 Vali Acc: 0.180 Test Loss: 10.509 Test Acc: 0.180
Validation loss decreased (inf --> -0.179895).  Saving model ...
Epoch: 2 cost time: 2.595271587371826
Epoch: 2, Steps: 13 | Train Loss: 23.622 Vali Loss: 32.720 Vali Acc: 0.280 Test Loss: 32.720 Test Acc: 0.280
Validation loss decreased (-0.179895 --> -0.279673).  Saving model ...
Epoch: 3 cost time: 2.7202625274658203
Epoch: 3, Steps: 13 | Train Loss: 27.091 Vali Loss: 40.793 Vali Acc: 0.220 Test Loss: 40.793 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.7078394889831543
Epoch: 4, Steps: 13 | Train Loss: 35.807 Vali Loss: 30.354 Vali Acc: 0.340 Test Loss: 30.354 Test Acc: 0.340
Validation loss decreased (-0.279673 --> -0.339696).  Saving model ...
Epoch: 5 cost time: 3.057358741760254
Epoch: 5, Steps: 13 | Train Loss: 22.592 Vali Loss: 65.865 Vali Acc: 0.200 Test Loss: 65.865 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.9936416149139404
Epoch: 6, Steps: 13 | Train Loss: 39.638 Vali Loss: 31.114 Vali Acc: 0.360 Test Loss: 31.114 Test Acc: 0.360
Validation loss decreased (-0.339696 --> -0.359689).  Saving model ...
Epoch: 7 cost time: 2.9597668647766113
Epoch: 7, Steps: 13 | Train Loss: 15.927 Vali Loss: 62.663 Vali Acc: 0.380 Test Loss: 62.663 Test Acc: 0.380
Validation loss decreased (-0.359689 --> -0.379373).  Saving model ...
Epoch: 8 cost time: 2.682527542114258
Epoch: 8, Steps: 13 | Train Loss: 31.614 Vali Loss: 63.576 Vali Acc: 0.300 Test Loss: 63.576 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.2024307250976562
Epoch: 9, Steps: 13 | Train Loss: 29.347 Vali Loss: 66.628 Vali Acc: 0.380 Test Loss: 66.628 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.7982053756713867
Epoch: 10, Steps: 13 | Train Loss: 26.496 Vali Loss: 57.263 Vali Acc: 0.440 Test Loss: 57.263 Test Acc: 0.440
Validation loss decreased (-0.379373 --> -0.439427).  Saving model ...
Epoch: 11 cost time: 2.8923492431640625
Epoch: 11, Steps: 13 | Train Loss: 12.360 Vali Loss: 72.840 Vali Acc: 0.420 Test Loss: 72.840 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.9458258152008057
Epoch: 12, Steps: 13 | Train Loss: 18.561 Vali Loss: 60.374 Vali Acc: 0.480 Test Loss: 60.374 Test Acc: 0.480
Validation loss decreased (-0.439427 --> -0.479396).  Saving model ...
Epoch: 13 cost time: 2.8349056243896484
Epoch: 13, Steps: 13 | Train Loss: 29.389 Vali Loss: 53.341 Vali Acc: 0.520 Test Loss: 53.341 Test Acc: 0.520
Validation loss decreased (-0.479396 --> -0.519467).  Saving model ...
Epoch: 14 cost time: 2.958409309387207
Epoch: 14, Steps: 13 | Train Loss: 18.570 Vali Loss: 56.718 Vali Acc: 0.440 Test Loss: 56.718 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.7273762226104736
Epoch: 15, Steps: 13 | Train Loss: 24.141 Vali Loss: 94.538 Vali Acc: 0.440 Test Loss: 94.538 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.647139072418213
Epoch: 16, Steps: 13 | Train Loss: 9.639 Vali Loss: 59.571 Vali Acc: 0.540 Test Loss: 59.571 Test Acc: 0.540
Validation loss decreased (-0.519467 --> -0.539404).  Saving model ...
Epoch: 17 cost time: 2.854815721511841
Epoch: 17, Steps: 13 | Train Loss: 16.944 Vali Loss: 57.807 Vali Acc: 0.520 Test Loss: 57.807 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.9973607063293457
Epoch: 18, Steps: 13 | Train Loss: 20.671 Vali Loss: 79.232 Vali Acc: 0.400 Test Loss: 79.232 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.6681439876556396
Epoch: 19, Steps: 13 | Train Loss: 6.454 Vali Loss: 61.716 Vali Acc: 0.500 Test Loss: 61.716 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.6489129066467285
Epoch: 20, Steps: 13 | Train Loss: 1.090 Vali Loss: 64.748 Vali Acc: 0.620 Test Loss: 64.748 Test Acc: 0.620
Validation loss decreased (-0.539404 --> -0.619353).  Saving model ...
Epoch: 21 cost time: 2.7543420791625977
Epoch: 21, Steps: 13 | Train Loss: 7.500 Vali Loss: 73.118 Vali Acc: 0.420 Test Loss: 73.118 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.6286306381225586
Epoch: 22, Steps: 13 | Train Loss: 14.284 Vali Loss: 84.475 Vali Acc: 0.500 Test Loss: 84.475 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.70511794090271
Epoch: 23, Steps: 13 | Train Loss: 5.119 Vali Loss: 67.540 Vali Acc: 0.480 Test Loss: 67.540 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.719309091567993
Epoch: 24, Steps: 13 | Train Loss: 7.692 Vali Loss: 88.688 Vali Acc: 0.480 Test Loss: 88.688 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.900387763977051
Epoch: 25, Steps: 13 | Train Loss: 2.609 Vali Loss: 104.019 Vali Acc: 0.460 Test Loss: 104.019 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.8984854221343994
Epoch: 26, Steps: 13 | Train Loss: 10.660 Vali Loss: 121.344 Vali Acc: 0.420 Test Loss: 121.344 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.8925106525421143
Epoch: 27, Steps: 13 | Train Loss: 14.089 Vali Loss: 100.899 Vali Acc: 0.420 Test Loss: 100.899 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.63746976852417
Epoch: 28, Steps: 13 | Train Loss: 21.098 Vali Loss: 71.881 Vali Acc: 0.580 Test Loss: 71.881 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.5653791427612305
Epoch: 29, Steps: 13 | Train Loss: 4.023 Vali Loss: 103.717 Vali Acc: 0.500 Test Loss: 103.717 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.804574728012085
Epoch: 30, Steps: 13 | Train Loss: 3.822 Vali Loss: 86.669 Vali Acc: 0.520 Test Loss: 86.669 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 7569641
model size : 30.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.298626184463501
Epoch: 1, Steps: 13 | Train Loss: 5.042 Vali Loss: 8.445 Vali Acc: 0.200 Test Loss: 8.445 Test Acc: 0.200
Validation loss decreased (inf --> -0.199916).  Saving model ...
Epoch: 2 cost time: 2.8731322288513184
Epoch: 2, Steps: 13 | Train Loss: 8.418 Vali Loss: 6.450 Vali Acc: 0.200 Test Loss: 6.450 Test Acc: 0.200
Validation loss decreased (-0.199916 --> -0.199935).  Saving model ...
Epoch: 3 cost time: 2.711894989013672
Epoch: 3, Steps: 13 | Train Loss: 7.737 Vali Loss: 16.230 Vali Acc: 0.200 Test Loss: 16.230 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.6129910945892334
Epoch: 4, Steps: 13 | Train Loss: 6.888 Vali Loss: 28.569 Vali Acc: 0.380 Test Loss: 28.569 Test Acc: 0.380
Validation loss decreased (-0.199935 --> -0.379714).  Saving model ...
Epoch: 5 cost time: 2.646340847015381
Epoch: 5, Steps: 13 | Train Loss: 18.855 Vali Loss: 29.055 Vali Acc: 0.220 Test Loss: 29.055 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.7335293292999268
Epoch: 6, Steps: 13 | Train Loss: 16.760 Vali Loss: 21.245 Vali Acc: 0.200 Test Loss: 21.245 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.602465867996216
Epoch: 7, Steps: 13 | Train Loss: 5.817 Vali Loss: 22.533 Vali Acc: 0.380 Test Loss: 22.533 Test Acc: 0.380
Validation loss decreased (-0.379714 --> -0.379775).  Saving model ...
Epoch: 8 cost time: 2.533973217010498
Epoch: 8, Steps: 13 | Train Loss: 11.747 Vali Loss: 28.204 Vali Acc: 0.280 Test Loss: 28.204 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.570491313934326
Epoch: 9, Steps: 13 | Train Loss: 12.355 Vali Loss: 14.704 Vali Acc: 0.320 Test Loss: 14.704 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.692108392715454
Epoch: 10, Steps: 13 | Train Loss: 6.000 Vali Loss: 20.014 Vali Acc: 0.400 Test Loss: 20.014 Test Acc: 0.400
Validation loss decreased (-0.379775 --> -0.399800).  Saving model ...
Epoch: 11 cost time: 2.740478038787842
Epoch: 11, Steps: 13 | Train Loss: 11.483 Vali Loss: 42.241 Vali Acc: 0.300 Test Loss: 42.241 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.9147984981536865
Epoch: 12, Steps: 13 | Train Loss: 7.496 Vali Loss: 42.654 Vali Acc: 0.380 Test Loss: 42.654 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.700408697128296
Epoch: 13, Steps: 13 | Train Loss: 8.213 Vali Loss: 28.126 Vali Acc: 0.440 Test Loss: 28.126 Test Acc: 0.440
Validation loss decreased (-0.399800 --> -0.439719).  Saving model ...
Epoch: 14 cost time: 2.5824875831604004
Epoch: 14, Steps: 13 | Train Loss: 1.655 Vali Loss: 37.323 Vali Acc: 0.420 Test Loss: 37.323 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.787466049194336
Epoch: 15, Steps: 13 | Train Loss: 4.986 Vali Loss: 29.069 Vali Acc: 0.400 Test Loss: 29.069 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.8674023151397705
Epoch: 16, Steps: 13 | Train Loss: 5.915 Vali Loss: 31.654 Vali Acc: 0.460 Test Loss: 31.654 Test Acc: 0.460
Validation loss decreased (-0.439719 --> -0.459683).  Saving model ...
Epoch: 17 cost time: 2.692518472671509
Epoch: 17, Steps: 13 | Train Loss: 7.051 Vali Loss: 31.171 Vali Acc: 0.460 Test Loss: 31.171 Test Acc: 0.460
Validation loss decreased (-0.459683 --> -0.459688).  Saving model ...
Epoch: 18 cost time: 2.925335168838501
Epoch: 18, Steps: 13 | Train Loss: 3.180 Vali Loss: 32.477 Vali Acc: 0.480 Test Loss: 32.477 Test Acc: 0.480
Validation loss decreased (-0.459688 --> -0.479675).  Saving model ...
Epoch: 19 cost time: 2.7627792358398438
Epoch: 19, Steps: 13 | Train Loss: 0.343 Vali Loss: 29.605 Vali Acc: 0.440 Test Loss: 29.605 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.745321035385132
Epoch: 20, Steps: 13 | Train Loss: 0.318 Vali Loss: 28.574 Vali Acc: 0.520 Test Loss: 28.574 Test Acc: 0.520
Validation loss decreased (-0.479675 --> -0.519714).  Saving model ...
Epoch: 21 cost time: 2.644319534301758
Epoch: 21, Steps: 13 | Train Loss: 0.000 Vali Loss: 28.919 Vali Acc: 0.500 Test Loss: 28.919 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.6752474308013916
Epoch: 22, Steps: 13 | Train Loss: 0.846 Vali Loss: 35.197 Vali Acc: 0.460 Test Loss: 35.197 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.59493350982666
Epoch: 23, Steps: 13 | Train Loss: 8.773 Vali Loss: 37.527 Vali Acc: 0.480 Test Loss: 37.527 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.844928741455078
Epoch: 24, Steps: 13 | Train Loss: 1.286 Vali Loss: 26.844 Vali Acc: 0.480 Test Loss: 26.844 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.6684048175811768
Epoch: 25, Steps: 13 | Train Loss: 4.236 Vali Loss: 34.341 Vali Acc: 0.440 Test Loss: 34.341 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.5840203762054443
Epoch: 26, Steps: 13 | Train Loss: 4.181 Vali Loss: 44.431 Vali Acc: 0.520 Test Loss: 44.431 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.8800792694091797
Epoch: 27, Steps: 13 | Train Loss: 0.719 Vali Loss: 38.670 Vali Acc: 0.460 Test Loss: 38.670 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.692990779876709
Epoch: 28, Steps: 13 | Train Loss: 1.517 Vali Loss: 32.679 Vali Acc: 0.480 Test Loss: 32.679 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.6709771156311035
Epoch: 29, Steps: 13 | Train Loss: 0.942 Vali Loss: 35.636 Vali Acc: 0.520 Test Loss: 35.636 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.763904333114624
Epoch: 30, Steps: 13 | Train Loss: 0.614 Vali Loss: 66.358 Vali Acc: 0.340 Test Loss: 66.358 Test Acc: 0.340
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 3997801
model size : 15.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.812684059143066
Epoch: 1, Steps: 13 | Train Loss: 4.482 Vali Loss: 20.179 Vali Acc: 0.200 Test Loss: 20.179 Test Acc: 0.200
Validation loss decreased (inf --> -0.199798).  Saving model ...
Epoch: 2 cost time: 2.631571054458618
Epoch: 2, Steps: 13 | Train Loss: 7.312 Vali Loss: 16.571 Vali Acc: 0.200 Test Loss: 16.571 Test Acc: 0.200
Validation loss decreased (-0.199798 --> -0.199834).  Saving model ...
Epoch: 3 cost time: 2.825029134750366
Epoch: 3, Steps: 13 | Train Loss: 11.430 Vali Loss: 20.930 Vali Acc: 0.200 Test Loss: 20.930 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.939333438873291
Epoch: 4, Steps: 13 | Train Loss: 16.754 Vali Loss: 17.358 Vali Acc: 0.280 Test Loss: 17.358 Test Acc: 0.280
Validation loss decreased (-0.199834 --> -0.279826).  Saving model ...
Epoch: 5 cost time: 2.668804168701172
Epoch: 5, Steps: 13 | Train Loss: 9.314 Vali Loss: 12.204 Vali Acc: 0.400 Test Loss: 12.204 Test Acc: 0.400
Validation loss decreased (-0.279826 --> -0.399878).  Saving model ...
Epoch: 6 cost time: 2.6941332817077637
Epoch: 6, Steps: 13 | Train Loss: 13.438 Vali Loss: 17.772 Vali Acc: 0.420 Test Loss: 17.772 Test Acc: 0.420
Validation loss decreased (-0.399878 --> -0.419822).  Saving model ...
Epoch: 7 cost time: 2.629995346069336
Epoch: 7, Steps: 13 | Train Loss: 15.439 Vali Loss: 31.312 Vali Acc: 0.360 Test Loss: 31.312 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.6570305824279785
Epoch: 8, Steps: 13 | Train Loss: 19.131 Vali Loss: 35.796 Vali Acc: 0.400 Test Loss: 35.796 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.7630817890167236
Epoch: 9, Steps: 13 | Train Loss: 12.223 Vali Loss: 36.271 Vali Acc: 0.440 Test Loss: 36.271 Test Acc: 0.440
Validation loss decreased (-0.419822 --> -0.439637).  Saving model ...
Epoch: 10 cost time: 2.5488078594207764
Epoch: 10, Steps: 13 | Train Loss: 15.201 Vali Loss: 31.644 Vali Acc: 0.380 Test Loss: 31.644 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.6845204830169678
Epoch: 11, Steps: 13 | Train Loss: 15.724 Vali Loss: 37.387 Vali Acc: 0.480 Test Loss: 37.387 Test Acc: 0.480
Validation loss decreased (-0.439637 --> -0.479626).  Saving model ...
Epoch: 12 cost time: 2.9858322143554688
Epoch: 12, Steps: 13 | Train Loss: 14.272 Vali Loss: 55.807 Vali Acc: 0.420 Test Loss: 55.807 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.905341148376465
Epoch: 13, Steps: 13 | Train Loss: 17.138 Vali Loss: 48.173 Vali Acc: 0.380 Test Loss: 48.173 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.5727996826171875
Epoch: 14, Steps: 13 | Train Loss: 9.385 Vali Loss: 55.294 Vali Acc: 0.500 Test Loss: 55.294 Test Acc: 0.500
Validation loss decreased (-0.479626 --> -0.499447).  Saving model ...
Epoch: 15 cost time: 2.6358349323272705
Epoch: 15, Steps: 13 | Train Loss: 8.094 Vali Loss: 56.868 Vali Acc: 0.340 Test Loss: 56.868 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.646326780319214
Epoch: 16, Steps: 13 | Train Loss: 2.779 Vali Loss: 48.489 Vali Acc: 0.360 Test Loss: 48.489 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.6575310230255127
Epoch: 17, Steps: 13 | Train Loss: 7.889 Vali Loss: 46.994 Vali Acc: 0.380 Test Loss: 46.994 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.736647844314575
Epoch: 18, Steps: 13 | Train Loss: 4.051 Vali Loss: 51.320 Vali Acc: 0.480 Test Loss: 51.320 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.650085687637329
Epoch: 19, Steps: 13 | Train Loss: 2.732 Vali Loss: 40.651 Vali Acc: 0.400 Test Loss: 40.651 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.710649251937866
Epoch: 20, Steps: 13 | Train Loss: 0.097 Vali Loss: 43.465 Vali Acc: 0.500 Test Loss: 43.465 Test Acc: 0.500
Validation loss decreased (-0.499447 --> -0.499565).  Saving model ...
Epoch: 21 cost time: 2.700746774673462
Epoch: 21, Steps: 13 | Train Loss: 4.451 Vali Loss: 32.014 Vali Acc: 0.500 Test Loss: 32.014 Test Acc: 0.500
Validation loss decreased (-0.499565 --> -0.499680).  Saving model ...
Epoch: 22 cost time: 2.6149985790252686
Epoch: 22, Steps: 13 | Train Loss: 1.231 Vali Loss: 52.999 Vali Acc: 0.440 Test Loss: 52.999 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.743128538131714
Epoch: 23, Steps: 13 | Train Loss: 4.129 Vali Loss: 31.712 Vali Acc: 0.520 Test Loss: 31.712 Test Acc: 0.520
Validation loss decreased (-0.499680 --> -0.519683).  Saving model ...
Epoch: 24 cost time: 2.7639286518096924
Epoch: 24, Steps: 13 | Train Loss: 7.073 Vali Loss: 42.283 Vali Acc: 0.540 Test Loss: 42.283 Test Acc: 0.540
Validation loss decreased (-0.519683 --> -0.539577).  Saving model ...
Epoch: 25 cost time: 2.63057541847229
Epoch: 25, Steps: 13 | Train Loss: 1.607 Vali Loss: 32.150 Vali Acc: 0.500 Test Loss: 32.150 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.6896889209747314
Epoch: 26, Steps: 13 | Train Loss: 0.440 Vali Loss: 53.310 Vali Acc: 0.480 Test Loss: 53.310 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.8143467903137207
Epoch: 27, Steps: 13 | Train Loss: 3.451 Vali Loss: 79.629 Vali Acc: 0.340 Test Loss: 79.629 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.7001397609710693
Epoch: 28, Steps: 13 | Train Loss: 1.296 Vali Loss: 57.120 Vali Acc: 0.420 Test Loss: 57.120 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.699861526489258
Epoch: 29, Steps: 13 | Train Loss: 2.195 Vali Loss: 52.270 Vali Acc: 0.440 Test Loss: 52.270 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.589000940322876
Epoch: 30, Steps: 13 | Train Loss: 5.214 Vali Loss: 78.179 Vali Acc: 0.340 Test Loss: 78.179 Test Acc: 0.340
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.753307580947876
Epoch: 31, Steps: 13 | Train Loss: 3.376 Vali Loss: 46.185 Vali Acc: 0.480 Test Loss: 46.185 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.666746139526367
Epoch: 32, Steps: 13 | Train Loss: 0.000 Vali Loss: 63.554 Vali Acc: 0.420 Test Loss: 63.554 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.6693193912506104
Epoch: 33, Steps: 13 | Train Loss: 0.737 Vali Loss: 53.089 Vali Acc: 0.500 Test Loss: 53.089 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.686113119125366
Epoch: 34, Steps: 13 | Train Loss: 0.250 Vali Loss: 55.112 Vali Acc: 0.400 Test Loss: 55.112 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 3996681
model size : 15.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.891089200973511
Epoch: 1, Steps: 13 | Train Loss: 5.744 Vali Loss: 10.041 Vali Acc: 0.200 Test Loss: 10.041 Test Acc: 0.200
Validation loss decreased (inf --> -0.199900).  Saving model ...
Epoch: 2 cost time: 2.662720203399658
Epoch: 2, Steps: 13 | Train Loss: 5.761 Vali Loss: 8.411 Vali Acc: 0.380 Test Loss: 8.411 Test Acc: 0.380
Validation loss decreased (-0.199900 --> -0.379916).  Saving model ...
Epoch: 3 cost time: 2.5815789699554443
Epoch: 3, Steps: 13 | Train Loss: 4.604 Vali Loss: 15.946 Vali Acc: 0.200 Test Loss: 15.946 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.629356861114502
Epoch: 4, Steps: 13 | Train Loss: 14.202 Vali Loss: 22.071 Vali Acc: 0.240 Test Loss: 22.071 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.52542781829834
Epoch: 5, Steps: 13 | Train Loss: 22.623 Vali Loss: 25.128 Vali Acc: 0.300 Test Loss: 25.128 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.780553102493286
Epoch: 6, Steps: 13 | Train Loss: 13.783 Vali Loss: 17.250 Vali Acc: 0.360 Test Loss: 17.250 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.835667133331299
Epoch: 7, Steps: 13 | Train Loss: 6.808 Vali Loss: 13.789 Vali Acc: 0.420 Test Loss: 13.789 Test Acc: 0.420
Validation loss decreased (-0.379916 --> -0.419862).  Saving model ...
Epoch: 8 cost time: 2.62719464302063
Epoch: 8, Steps: 13 | Train Loss: 2.538 Vali Loss: 15.641 Vali Acc: 0.320 Test Loss: 15.641 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.638245105743408
Epoch: 9, Steps: 13 | Train Loss: 5.955 Vali Loss: 15.235 Vali Acc: 0.400 Test Loss: 15.235 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.8638951778411865
Epoch: 10, Steps: 13 | Train Loss: 5.697 Vali Loss: 16.355 Vali Acc: 0.440 Test Loss: 16.355 Test Acc: 0.440
Validation loss decreased (-0.419862 --> -0.439836).  Saving model ...
Epoch: 11 cost time: 2.773550510406494
Epoch: 11, Steps: 13 | Train Loss: 9.393 Vali Loss: 29.673 Vali Acc: 0.360 Test Loss: 29.673 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.800025224685669
Epoch: 12, Steps: 13 | Train Loss: 5.266 Vali Loss: 27.325 Vali Acc: 0.400 Test Loss: 27.325 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.805438756942749
Epoch: 13, Steps: 13 | Train Loss: 3.872 Vali Loss: 61.057 Vali Acc: 0.400 Test Loss: 61.057 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.9478251934051514
Epoch: 14, Steps: 13 | Train Loss: 14.934 Vali Loss: 37.181 Vali Acc: 0.480 Test Loss: 37.181 Test Acc: 0.480
Validation loss decreased (-0.439836 --> -0.479628).  Saving model ...
Epoch: 15 cost time: 3.005023717880249
Epoch: 15, Steps: 13 | Train Loss: 7.042 Vali Loss: 42.003 Vali Acc: 0.400 Test Loss: 42.003 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.916396379470825
Epoch: 16, Steps: 13 | Train Loss: 5.747 Vali Loss: 42.668 Vali Acc: 0.360 Test Loss: 42.668 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.7699456214904785
Epoch: 17, Steps: 13 | Train Loss: 4.642 Vali Loss: 41.380 Vali Acc: 0.500 Test Loss: 41.380 Test Acc: 0.500
Validation loss decreased (-0.479628 --> -0.499586).  Saving model ...
Epoch: 18 cost time: 2.83697772026062
Epoch: 18, Steps: 13 | Train Loss: 8.963 Vali Loss: 29.150 Vali Acc: 0.440 Test Loss: 29.150 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.01448917388916
Epoch: 19, Steps: 13 | Train Loss: 7.467 Vali Loss: 42.195 Vali Acc: 0.440 Test Loss: 42.195 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.750575304031372
Epoch: 20, Steps: 13 | Train Loss: 6.460 Vali Loss: 69.351 Vali Acc: 0.320 Test Loss: 69.351 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.8072702884674072
Epoch: 21, Steps: 13 | Train Loss: 3.711 Vali Loss: 46.602 Vali Acc: 0.420 Test Loss: 46.602 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.0593583583831787
Epoch: 22, Steps: 13 | Train Loss: 9.692 Vali Loss: 40.587 Vali Acc: 0.460 Test Loss: 40.587 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.049403429031372
Epoch: 23, Steps: 13 | Train Loss: 1.698 Vali Loss: 57.514 Vali Acc: 0.320 Test Loss: 57.514 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.8061680793762207
Epoch: 24, Steps: 13 | Train Loss: 1.778 Vali Loss: 40.539 Vali Acc: 0.480 Test Loss: 40.539 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.8194785118103027
Epoch: 25, Steps: 13 | Train Loss: 1.114 Vali Loss: 42.470 Vali Acc: 0.460 Test Loss: 42.470 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.117022752761841
Epoch: 26, Steps: 13 | Train Loss: 0.722 Vali Loss: 45.017 Vali Acc: 0.340 Test Loss: 45.017 Test Acc: 0.340
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.686262845993042
Epoch: 27, Steps: 13 | Train Loss: 0.006 Vali Loss: 40.507 Vali Acc: 0.480 Test Loss: 40.507 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 3995561
model size : 15.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.757622957229614
Epoch: 1, Steps: 13 | Train Loss: 8.182 Vali Loss: 5.304 Vali Acc: 0.320 Test Loss: 5.304 Test Acc: 0.320
Validation loss decreased (inf --> -0.319947).  Saving model ...
Epoch: 2 cost time: 2.7106423377990723
Epoch: 2, Steps: 13 | Train Loss: 15.265 Vali Loss: 13.270 Vali Acc: 0.240 Test Loss: 13.270 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.697558879852295
Epoch: 3, Steps: 13 | Train Loss: 16.647 Vali Loss: 28.205 Vali Acc: 0.240 Test Loss: 28.205 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.601212978363037
Epoch: 4, Steps: 13 | Train Loss: 13.270 Vali Loss: 12.538 Vali Acc: 0.300 Test Loss: 12.538 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.6185531616210938
Epoch: 5, Steps: 13 | Train Loss: 8.068 Vali Loss: 10.151 Vali Acc: 0.340 Test Loss: 10.151 Test Acc: 0.340
Validation loss decreased (-0.319947 --> -0.339898).  Saving model ...
Epoch: 6 cost time: 2.653291702270508
Epoch: 6, Steps: 13 | Train Loss: 11.245 Vali Loss: 20.203 Vali Acc: 0.300 Test Loss: 20.203 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.624183177947998
Epoch: 7, Steps: 13 | Train Loss: 13.532 Vali Loss: 17.268 Vali Acc: 0.360 Test Loss: 17.268 Test Acc: 0.360
Validation loss decreased (-0.339898 --> -0.359827).  Saving model ...
Epoch: 8 cost time: 2.695573091506958
Epoch: 8, Steps: 13 | Train Loss: 10.564 Vali Loss: 20.232 Vali Acc: 0.460 Test Loss: 20.232 Test Acc: 0.460
Validation loss decreased (-0.359827 --> -0.459798).  Saving model ...
Epoch: 9 cost time: 2.6457812786102295
Epoch: 9, Steps: 13 | Train Loss: 3.742 Vali Loss: 11.497 Vali Acc: 0.460 Test Loss: 11.497 Test Acc: 0.460
Validation loss decreased (-0.459798 --> -0.459885).  Saving model ...
Epoch: 10 cost time: 2.45979380607605
Epoch: 10, Steps: 13 | Train Loss: 0.913 Vali Loss: 15.341 Vali Acc: 0.400 Test Loss: 15.341 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.4888932704925537
Epoch: 11, Steps: 13 | Train Loss: 7.486 Vali Loss: 22.718 Vali Acc: 0.360 Test Loss: 22.718 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.6941139698028564
Epoch: 12, Steps: 13 | Train Loss: 10.717 Vali Loss: 27.067 Vali Acc: 0.360 Test Loss: 27.067 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.5632517337799072
Epoch: 13, Steps: 13 | Train Loss: 4.501 Vali Loss: 37.262 Vali Acc: 0.340 Test Loss: 37.262 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.7038564682006836
Epoch: 14, Steps: 13 | Train Loss: 6.008 Vali Loss: 32.468 Vali Acc: 0.500 Test Loss: 32.468 Test Acc: 0.500
Validation loss decreased (-0.459885 --> -0.499675).  Saving model ...
Epoch: 15 cost time: 2.47537899017334
Epoch: 15, Steps: 13 | Train Loss: 7.581 Vali Loss: 31.708 Vali Acc: 0.400 Test Loss: 31.708 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.5067927837371826
Epoch: 16, Steps: 13 | Train Loss: 10.218 Vali Loss: 27.845 Vali Acc: 0.460 Test Loss: 27.845 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.4510483741760254
Epoch: 17, Steps: 13 | Train Loss: 7.222 Vali Loss: 51.084 Vali Acc: 0.360 Test Loss: 51.084 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.6386823654174805
Epoch: 18, Steps: 13 | Train Loss: 4.511 Vali Loss: 53.593 Vali Acc: 0.440 Test Loss: 53.593 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.5754899978637695
Epoch: 19, Steps: 13 | Train Loss: 6.717 Vali Loss: 48.584 Vali Acc: 0.480 Test Loss: 48.584 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.5374765396118164
Epoch: 20, Steps: 13 | Train Loss: 4.754 Vali Loss: 36.360 Vali Acc: 0.520 Test Loss: 36.360 Test Acc: 0.520
Validation loss decreased (-0.499675 --> -0.519636).  Saving model ...
Epoch: 21 cost time: 2.3933472633361816
Epoch: 21, Steps: 13 | Train Loss: 1.067 Vali Loss: 38.783 Vali Acc: 0.460 Test Loss: 38.783 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.5939745903015137
Epoch: 22, Steps: 13 | Train Loss: 2.531 Vali Loss: 41.388 Vali Acc: 0.460 Test Loss: 41.388 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.546682357788086
Epoch: 23, Steps: 13 | Train Loss: 0.505 Vali Loss: 57.017 Vali Acc: 0.360 Test Loss: 57.017 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.428539752960205
Epoch: 24, Steps: 13 | Train Loss: 16.371 Vali Loss: 41.673 Vali Acc: 0.400 Test Loss: 41.673 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.5718917846679688
Epoch: 25, Steps: 13 | Train Loss: 8.127 Vali Loss: 82.778 Vali Acc: 0.400 Test Loss: 82.778 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.5975868701934814
Epoch: 26, Steps: 13 | Train Loss: 7.538 Vali Loss: 40.843 Vali Acc: 0.380 Test Loss: 40.843 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.601620674133301
Epoch: 27, Steps: 13 | Train Loss: 0.314 Vali Loss: 62.469 Vali Acc: 0.420 Test Loss: 62.469 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.6945695877075195
Epoch: 28, Steps: 13 | Train Loss: 3.563 Vali Loss: 42.448 Vali Acc: 0.440 Test Loss: 42.448 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.5357115268707275
Epoch: 29, Steps: 13 | Train Loss: 0.108 Vali Loss: 45.003 Vali Acc: 0.480 Test Loss: 45.003 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.584122896194458
Epoch: 30, Steps: 13 | Train Loss: 0.000 Vali Loss: 42.242 Vali Acc: 0.460 Test Loss: 42.242 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 3994441
model size : 15.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.239369630813599
Epoch: 1, Steps: 13 | Train Loss: 3.445 Vali Loss: 8.476 Vali Acc: 0.200 Test Loss: 8.476 Test Acc: 0.200
Validation loss decreased (inf --> -0.199915).  Saving model ...
Epoch: 2 cost time: 2.3736677169799805
Epoch: 2, Steps: 13 | Train Loss: 8.678 Vali Loss: 16.240 Vali Acc: 0.200 Test Loss: 16.240 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.5169894695281982
Epoch: 3, Steps: 13 | Train Loss: 7.300 Vali Loss: 10.908 Vali Acc: 0.220 Test Loss: 10.908 Test Acc: 0.220
Validation loss decreased (-0.199915 --> -0.219891).  Saving model ...
Epoch: 4 cost time: 2.2520253658294678
Epoch: 4, Steps: 13 | Train Loss: 7.206 Vali Loss: 22.915 Vali Acc: 0.200 Test Loss: 22.915 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.55489444732666
Epoch: 5, Steps: 13 | Train Loss: 11.534 Vali Loss: 17.185 Vali Acc: 0.200 Test Loss: 17.185 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.331711769104004
Epoch: 6, Steps: 13 | Train Loss: 20.034 Vali Loss: 20.185 Vali Acc: 0.300 Test Loss: 20.185 Test Acc: 0.300
Validation loss decreased (-0.219891 --> -0.299798).  Saving model ...
Epoch: 7 cost time: 2.318075656890869
Epoch: 7, Steps: 13 | Train Loss: 7.649 Vali Loss: 12.113 Vali Acc: 0.400 Test Loss: 12.113 Test Acc: 0.400
Validation loss decreased (-0.299798 --> -0.399879).  Saving model ...
Epoch: 8 cost time: 2.3166356086730957
Epoch: 8, Steps: 13 | Train Loss: 17.110 Vali Loss: 22.235 Vali Acc: 0.460 Test Loss: 22.235 Test Acc: 0.460
Validation loss decreased (-0.399879 --> -0.459778).  Saving model ...
Epoch: 9 cost time: 2.327583074569702
Epoch: 9, Steps: 13 | Train Loss: 7.276 Vali Loss: 16.299 Vali Acc: 0.360 Test Loss: 16.299 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.3283793926239014
Epoch: 10, Steps: 13 | Train Loss: 2.861 Vali Loss: 27.365 Vali Acc: 0.380 Test Loss: 27.365 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.253955841064453
Epoch: 11, Steps: 13 | Train Loss: 8.490 Vali Loss: 20.414 Vali Acc: 0.480 Test Loss: 20.414 Test Acc: 0.480
Validation loss decreased (-0.459778 --> -0.479796).  Saving model ...
Epoch: 12 cost time: 2.3129427433013916
Epoch: 12, Steps: 13 | Train Loss: 9.562 Vali Loss: 64.520 Vali Acc: 0.220 Test Loss: 64.520 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.3013992309570312
Epoch: 13, Steps: 13 | Train Loss: 34.808 Vali Loss: 35.071 Vali Acc: 0.440 Test Loss: 35.071 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.330303430557251
Epoch: 14, Steps: 13 | Train Loss: 13.034 Vali Loss: 36.268 Vali Acc: 0.440 Test Loss: 36.268 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.2502355575561523
Epoch: 15, Steps: 13 | Train Loss: 6.847 Vali Loss: 27.313 Vali Acc: 0.500 Test Loss: 27.313 Test Acc: 0.500
Validation loss decreased (-0.479796 --> -0.499727).  Saving model ...
Epoch: 16 cost time: 2.5515849590301514
Epoch: 16, Steps: 13 | Train Loss: 1.860 Vali Loss: 28.745 Vali Acc: 0.500 Test Loss: 28.745 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.3093202114105225
Epoch: 17, Steps: 13 | Train Loss: 1.314 Vali Loss: 39.957 Vali Acc: 0.400 Test Loss: 39.957 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.438828706741333
Epoch: 18, Steps: 13 | Train Loss: 3.829 Vali Loss: 31.091 Vali Acc: 0.420 Test Loss: 31.091 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.3052914142608643
Epoch: 19, Steps: 13 | Train Loss: 6.236 Vali Loss: 28.035 Vali Acc: 0.520 Test Loss: 28.035 Test Acc: 0.520
Validation loss decreased (-0.499727 --> -0.519720).  Saving model ...
Epoch: 20 cost time: 2.3469362258911133
Epoch: 20, Steps: 13 | Train Loss: 5.988 Vali Loss: 55.982 Vali Acc: 0.380 Test Loss: 55.982 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.1846132278442383
Epoch: 21, Steps: 13 | Train Loss: 3.986 Vali Loss: 41.193 Vali Acc: 0.460 Test Loss: 41.193 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.392869472503662
Epoch: 22, Steps: 13 | Train Loss: 1.813 Vali Loss: 42.549 Vali Acc: 0.440 Test Loss: 42.549 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.3834855556488037
Epoch: 23, Steps: 13 | Train Loss: 1.835 Vali Loss: 44.453 Vali Acc: 0.520 Test Loss: 44.453 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.425233840942383
Epoch: 24, Steps: 13 | Train Loss: 0.293 Vali Loss: 30.643 Vali Acc: 0.520 Test Loss: 30.643 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.808330774307251
Epoch: 25, Steps: 13 | Train Loss: 0.746 Vali Loss: 39.376 Vali Acc: 0.540 Test Loss: 39.376 Test Acc: 0.540
Validation loss decreased (-0.519720 --> -0.539606).  Saving model ...
Epoch: 26 cost time: 2.471115827560425
Epoch: 26, Steps: 13 | Train Loss: 14.394 Vali Loss: 78.877 Vali Acc: 0.420 Test Loss: 78.877 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.3728065490722656
Epoch: 27, Steps: 13 | Train Loss: 11.038 Vali Loss: 44.509 Vali Acc: 0.440 Test Loss: 44.509 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.333892822265625
Epoch: 28, Steps: 13 | Train Loss: 0.543 Vali Loss: 74.835 Vali Acc: 0.340 Test Loss: 74.835 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.415464162826538
Epoch: 29, Steps: 13 | Train Loss: 13.191 Vali Loss: 45.029 Vali Acc: 0.520 Test Loss: 45.029 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.349848747253418
Epoch: 30, Steps: 13 | Train Loss: 7.266 Vali Loss: 48.120 Vali Acc: 0.460 Test Loss: 48.120 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.6531269550323486
Epoch: 31, Steps: 13 | Train Loss: 5.914 Vali Loss: 36.803 Vali Acc: 0.520 Test Loss: 36.803 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.2888925075531006
Epoch: 32, Steps: 13 | Train Loss: 3.308 Vali Loss: 61.207 Vali Acc: 0.420 Test Loss: 61.207 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.354484796524048
Epoch: 33, Steps: 13 | Train Loss: 2.407 Vali Loss: 43.476 Vali Acc: 0.540 Test Loss: 43.476 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.6627252101898193
Epoch: 34, Steps: 13 | Train Loss: 0.427 Vali Loss: 60.760 Vali Acc: 0.420 Test Loss: 60.760 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.485959529876709
Epoch: 35, Steps: 13 | Train Loss: 0.212 Vali Loss: 48.763 Vali Acc: 0.460 Test Loss: 48.763 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 3831401
model size : 15.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.155332803726196
Epoch: 1, Steps: 13 | Train Loss: 5.223 Vali Loss: 5.339 Vali Acc: 0.200 Test Loss: 5.339 Test Acc: 0.200
Validation loss decreased (inf --> -0.199947).  Saving model ...
Epoch: 2 cost time: 2.4957125186920166
Epoch: 2, Steps: 13 | Train Loss: 7.217 Vali Loss: 20.872 Vali Acc: 0.200 Test Loss: 20.872 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.3374929428100586
Epoch: 3, Steps: 13 | Train Loss: 12.659 Vali Loss: 11.801 Vali Acc: 0.280 Test Loss: 11.801 Test Acc: 0.280
Validation loss decreased (-0.199947 --> -0.279882).  Saving model ...
Epoch: 4 cost time: 2.336846351623535
Epoch: 4, Steps: 13 | Train Loss: 8.435 Vali Loss: 13.291 Vali Acc: 0.220 Test Loss: 13.291 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.299929618835449
Epoch: 5, Steps: 13 | Train Loss: 8.324 Vali Loss: 7.396 Vali Acc: 0.340 Test Loss: 7.396 Test Acc: 0.340
Validation loss decreased (-0.279882 --> -0.339926).  Saving model ...
Epoch: 6 cost time: 2.4343268871307373
Epoch: 6, Steps: 13 | Train Loss: 7.082 Vali Loss: 19.309 Vali Acc: 0.480 Test Loss: 19.309 Test Acc: 0.480
Validation loss decreased (-0.339926 --> -0.479807).  Saving model ...
Epoch: 7 cost time: 2.602555751800537
Epoch: 7, Steps: 13 | Train Loss: 13.184 Vali Loss: 23.058 Vali Acc: 0.300 Test Loss: 23.058 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.5512685775756836
Epoch: 8, Steps: 13 | Train Loss: 17.156 Vali Loss: 31.610 Vali Acc: 0.400 Test Loss: 31.610 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.5946123600006104
Epoch: 9, Steps: 13 | Train Loss: 13.560 Vali Loss: 64.322 Vali Acc: 0.340 Test Loss: 64.322 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.521604061126709
Epoch: 10, Steps: 13 | Train Loss: 26.874 Vali Loss: 58.644 Vali Acc: 0.300 Test Loss: 58.644 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.542543411254883
Epoch: 11, Steps: 13 | Train Loss: 26.323 Vali Loss: 29.183 Vali Acc: 0.460 Test Loss: 29.183 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.6288414001464844
Epoch: 12, Steps: 13 | Train Loss: 8.584 Vali Loss: 50.842 Vali Acc: 0.280 Test Loss: 50.842 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.7190027236938477
Epoch: 13, Steps: 13 | Train Loss: 16.248 Vali Loss: 47.067 Vali Acc: 0.400 Test Loss: 47.067 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.4118552207946777
Epoch: 14, Steps: 13 | Train Loss: 10.142 Vali Loss: 33.615 Vali Acc: 0.420 Test Loss: 33.615 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.6211438179016113
Epoch: 15, Steps: 13 | Train Loss: 7.671 Vali Loss: 34.503 Vali Acc: 0.400 Test Loss: 34.503 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.653764486312866
Epoch: 16, Steps: 13 | Train Loss: 11.491 Vali Loss: 33.105 Vali Acc: 0.500 Test Loss: 33.105 Test Acc: 0.500
Validation loss decreased (-0.479807 --> -0.499669).  Saving model ...
Epoch: 17 cost time: 2.40386962890625
Epoch: 17, Steps: 13 | Train Loss: 7.691 Vali Loss: 44.556 Vali Acc: 0.460 Test Loss: 44.556 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.446359872817993
Epoch: 18, Steps: 13 | Train Loss: 3.008 Vali Loss: 25.815 Vali Acc: 0.500 Test Loss: 25.815 Test Acc: 0.500
Validation loss decreased (-0.499669 --> -0.499742).  Saving model ...
Epoch: 19 cost time: 2.4749696254730225
Epoch: 19, Steps: 13 | Train Loss: 4.479 Vali Loss: 30.996 Vali Acc: 0.500 Test Loss: 30.996 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.723841428756714
Epoch: 20, Steps: 13 | Train Loss: 0.895 Vali Loss: 28.704 Vali Acc: 0.500 Test Loss: 28.704 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.465071201324463
Epoch: 21, Steps: 13 | Train Loss: 0.649 Vali Loss: 39.135 Vali Acc: 0.540 Test Loss: 39.135 Test Acc: 0.540
Validation loss decreased (-0.499742 --> -0.539609).  Saving model ...
Epoch: 22 cost time: 2.430332660675049
Epoch: 22, Steps: 13 | Train Loss: 6.398 Vali Loss: 47.173 Vali Acc: 0.440 Test Loss: 47.173 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.6523351669311523
Epoch: 23, Steps: 13 | Train Loss: 7.291 Vali Loss: 40.902 Vali Acc: 0.540 Test Loss: 40.902 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.5656418800354004
Epoch: 24, Steps: 13 | Train Loss: 1.336 Vali Loss: 47.088 Vali Acc: 0.460 Test Loss: 47.088 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.5533316135406494
Epoch: 25, Steps: 13 | Train Loss: 2.928 Vali Loss: 57.518 Vali Acc: 0.480 Test Loss: 57.518 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.555758476257324
Epoch: 26, Steps: 13 | Train Loss: 1.295 Vali Loss: 66.450 Vali Acc: 0.420 Test Loss: 66.450 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.4353322982788086
Epoch: 27, Steps: 13 | Train Loss: 4.436 Vali Loss: 62.402 Vali Acc: 0.440 Test Loss: 62.402 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.7014150619506836
Epoch: 28, Steps: 13 | Train Loss: 9.203 Vali Loss: 44.928 Vali Acc: 0.420 Test Loss: 44.928 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.5308518409729004
Epoch: 29, Steps: 13 | Train Loss: 0.956 Vali Loss: 68.558 Vali Acc: 0.520 Test Loss: 68.558 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.4560844898223877
Epoch: 30, Steps: 13 | Train Loss: 1.048 Vali Loss: 56.284 Vali Acc: 0.500 Test Loss: 56.284 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.5063066482543945
Epoch: 31, Steps: 13 | Train Loss: 4.016 Vali Loss: 47.823 Vali Acc: 0.540 Test Loss: 47.823 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 3830281
model size : 15.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.4923601150512695
Epoch: 1, Steps: 13 | Train Loss: 3.374 Vali Loss: 6.923 Vali Acc: 0.200 Test Loss: 6.923 Test Acc: 0.200
Validation loss decreased (inf --> -0.199931).  Saving model ...
Epoch: 2 cost time: 2.2987780570983887
Epoch: 2, Steps: 13 | Train Loss: 5.314 Vali Loss: 11.225 Vali Acc: 0.200 Test Loss: 11.225 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.3532416820526123
Epoch: 3, Steps: 13 | Train Loss: 8.272 Vali Loss: 7.107 Vali Acc: 0.240 Test Loss: 7.107 Test Acc: 0.240
Validation loss decreased (-0.199931 --> -0.239929).  Saving model ...
Epoch: 4 cost time: 2.4831035137176514
Epoch: 4, Steps: 13 | Train Loss: 5.657 Vali Loss: 19.656 Vali Acc: 0.240 Test Loss: 19.656 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.3222262859344482
Epoch: 5, Steps: 13 | Train Loss: 13.791 Vali Loss: 19.706 Vali Acc: 0.220 Test Loss: 19.706 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.247192621231079
Epoch: 6, Steps: 13 | Train Loss: 9.126 Vali Loss: 12.944 Vali Acc: 0.300 Test Loss: 12.944 Test Acc: 0.300
Validation loss decreased (-0.239929 --> -0.299871).  Saving model ...
Epoch: 7 cost time: 2.1715199947357178
Epoch: 7, Steps: 13 | Train Loss: 12.308 Vali Loss: 12.585 Vali Acc: 0.320 Test Loss: 12.585 Test Acc: 0.320
Validation loss decreased (-0.299871 --> -0.319874).  Saving model ...
Epoch: 8 cost time: 2.2882683277130127
Epoch: 8, Steps: 13 | Train Loss: 10.906 Vali Loss: 32.234 Vali Acc: 0.380 Test Loss: 32.234 Test Acc: 0.380
Validation loss decreased (-0.319874 --> -0.379678).  Saving model ...
Epoch: 9 cost time: 2.330561399459839
Epoch: 9, Steps: 13 | Train Loss: 9.637 Vali Loss: 35.031 Vali Acc: 0.360 Test Loss: 35.031 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.34274959564209
Epoch: 10, Steps: 13 | Train Loss: 7.253 Vali Loss: 29.373 Vali Acc: 0.360 Test Loss: 29.373 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.410893440246582
Epoch: 11, Steps: 13 | Train Loss: 8.359 Vali Loss: 30.948 Vali Acc: 0.580 Test Loss: 30.948 Test Acc: 0.580
Validation loss decreased (-0.379678 --> -0.579691).  Saving model ...
Epoch: 12 cost time: 2.5471999645233154
Epoch: 12, Steps: 13 | Train Loss: 8.348 Vali Loss: 49.254 Vali Acc: 0.360 Test Loss: 49.254 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.6194818019866943
Epoch: 13, Steps: 13 | Train Loss: 17.324 Vali Loss: 48.555 Vali Acc: 0.400 Test Loss: 48.555 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.5831680297851562
Epoch: 14, Steps: 13 | Train Loss: 7.968 Vali Loss: 26.843 Vali Acc: 0.460 Test Loss: 26.843 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.4798660278320312
Epoch: 15, Steps: 13 | Train Loss: 6.286 Vali Loss: 27.725 Vali Acc: 0.420 Test Loss: 27.725 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.4017903804779053
Epoch: 16, Steps: 13 | Train Loss: 4.741 Vali Loss: 40.823 Vali Acc: 0.460 Test Loss: 40.823 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.387470006942749
Epoch: 17, Steps: 13 | Train Loss: 3.198 Vali Loss: 26.358 Vali Acc: 0.520 Test Loss: 26.358 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.4850118160247803
Epoch: 18, Steps: 13 | Train Loss: 1.583 Vali Loss: 66.742 Vali Acc: 0.500 Test Loss: 66.742 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.3830137252807617
Epoch: 19, Steps: 13 | Train Loss: 15.491 Vali Loss: 35.150 Vali Acc: 0.440 Test Loss: 35.150 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.9691340923309326
Epoch: 20, Steps: 13 | Train Loss: 16.468 Vali Loss: 64.608 Vali Acc: 0.320 Test Loss: 64.608 Test Acc: 0.320
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.742123603820801
Epoch: 21, Steps: 13 | Train Loss: 23.899 Vali Loss: 49.158 Vali Acc: 0.420 Test Loss: 49.158 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 3829161
model size : 15.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.923776626586914
Epoch: 1, Steps: 13 | Train Loss: 6.468 Vali Loss: 6.996 Vali Acc: 0.200 Test Loss: 6.996 Test Acc: 0.200
Validation loss decreased (inf --> -0.199930).  Saving model ...
Epoch: 2 cost time: 2.5540084838867188
Epoch: 2, Steps: 13 | Train Loss: 9.153 Vali Loss: 21.554 Vali Acc: 0.220 Test Loss: 21.554 Test Acc: 0.220
Validation loss decreased (-0.199930 --> -0.219784).  Saving model ...
Epoch: 3 cost time: 2.6034793853759766
Epoch: 3, Steps: 13 | Train Loss: 15.776 Vali Loss: 14.693 Vali Acc: 0.200 Test Loss: 14.693 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.5445666313171387
Epoch: 4, Steps: 13 | Train Loss: 14.208 Vali Loss: 14.723 Vali Acc: 0.260 Test Loss: 14.723 Test Acc: 0.260
Validation loss decreased (-0.219784 --> -0.259853).  Saving model ...
Epoch: 5 cost time: 2.3650894165039062
Epoch: 5, Steps: 13 | Train Loss: 13.524 Vali Loss: 22.874 Vali Acc: 0.340 Test Loss: 22.874 Test Acc: 0.340
Validation loss decreased (-0.259853 --> -0.339771).  Saving model ...
Epoch: 6 cost time: 2.396179437637329
Epoch: 6, Steps: 13 | Train Loss: 13.656 Vali Loss: 17.737 Vali Acc: 0.380 Test Loss: 17.737 Test Acc: 0.380
Validation loss decreased (-0.339771 --> -0.379823).  Saving model ...
Epoch: 7 cost time: 2.3712637424468994
Epoch: 7, Steps: 13 | Train Loss: 6.425 Vali Loss: 17.345 Vali Acc: 0.360 Test Loss: 17.345 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.5228419303894043
Epoch: 8, Steps: 13 | Train Loss: 6.333 Vali Loss: 28.693 Vali Acc: 0.400 Test Loss: 28.693 Test Acc: 0.400
Validation loss decreased (-0.379823 --> -0.399713).  Saving model ...
Epoch: 9 cost time: 2.567660331726074
Epoch: 9, Steps: 13 | Train Loss: 16.260 Vali Loss: 34.076 Vali Acc: 0.340 Test Loss: 34.076 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.539064407348633
Epoch: 10, Steps: 13 | Train Loss: 22.047 Vali Loss: 24.782 Vali Acc: 0.440 Test Loss: 24.782 Test Acc: 0.440
Validation loss decreased (-0.399713 --> -0.439752).  Saving model ...
Epoch: 11 cost time: 2.5893561840057373
Epoch: 11, Steps: 13 | Train Loss: 15.839 Vali Loss: 77.691 Vali Acc: 0.300 Test Loss: 77.691 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.693650722503662
Epoch: 12, Steps: 13 | Train Loss: 31.186 Vali Loss: 37.959 Vali Acc: 0.420 Test Loss: 37.959 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.5446290969848633
Epoch: 13, Steps: 13 | Train Loss: 12.909 Vali Loss: 45.304 Vali Acc: 0.420 Test Loss: 45.304 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.6209709644317627
Epoch: 14, Steps: 13 | Train Loss: 13.757 Vali Loss: 25.110 Vali Acc: 0.420 Test Loss: 25.110 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.7828798294067383
Epoch: 15, Steps: 13 | Train Loss: 12.507 Vali Loss: 58.068 Vali Acc: 0.440 Test Loss: 58.068 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.6316652297973633
Epoch: 16, Steps: 13 | Train Loss: 29.384 Vali Loss: 51.463 Vali Acc: 0.380 Test Loss: 51.463 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.4010825157165527
Epoch: 17, Steps: 13 | Train Loss: 1.805 Vali Loss: 25.607 Vali Acc: 0.500 Test Loss: 25.607 Test Acc: 0.500
Validation loss decreased (-0.439752 --> -0.499744).  Saving model ...
Epoch: 18 cost time: 2.5096161365509033
Epoch: 18, Steps: 13 | Train Loss: 2.301 Vali Loss: 27.121 Vali Acc: 0.460 Test Loss: 27.121 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.510369300842285
Epoch: 19, Steps: 13 | Train Loss: 2.062 Vali Loss: 44.493 Vali Acc: 0.500 Test Loss: 44.493 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.495819091796875
Epoch: 20, Steps: 13 | Train Loss: 3.335 Vali Loss: 26.012 Vali Acc: 0.540 Test Loss: 26.012 Test Acc: 0.540
Validation loss decreased (-0.499744 --> -0.539740).  Saving model ...
Epoch: 21 cost time: 2.3476202487945557
Epoch: 21, Steps: 13 | Train Loss: 3.432 Vali Loss: 56.984 Vali Acc: 0.520 Test Loss: 56.984 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.6225833892822266
Epoch: 22, Steps: 13 | Train Loss: 1.877 Vali Loss: 40.340 Vali Acc: 0.500 Test Loss: 40.340 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.6014320850372314
Epoch: 23, Steps: 13 | Train Loss: 2.127 Vali Loss: 64.676 Vali Acc: 0.380 Test Loss: 64.676 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.369122266769409
Epoch: 24, Steps: 13 | Train Loss: 4.255 Vali Loss: 39.081 Vali Acc: 0.460 Test Loss: 39.081 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.444767475128174
Epoch: 25, Steps: 13 | Train Loss: 3.622 Vali Loss: 37.933 Vali Acc: 0.540 Test Loss: 37.933 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.4315929412841797
Epoch: 26, Steps: 13 | Train Loss: 5.346 Vali Loss: 41.878 Vali Acc: 0.480 Test Loss: 41.878 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.5124051570892334
Epoch: 27, Steps: 13 | Train Loss: 4.255 Vali Loss: 35.825 Vali Acc: 0.620 Test Loss: 35.825 Test Acc: 0.620
Validation loss decreased (-0.539740 --> -0.619642).  Saving model ...
Epoch: 28 cost time: 2.2489070892333984
Epoch: 28, Steps: 13 | Train Loss: 1.660 Vali Loss: 62.673 Vali Acc: 0.420 Test Loss: 62.673 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.3613414764404297
Epoch: 29, Steps: 13 | Train Loss: 4.207 Vali Loss: 58.711 Vali Acc: 0.480 Test Loss: 58.711 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.506530523300171
Epoch: 30, Steps: 13 | Train Loss: 7.299 Vali Loss: 49.355 Vali Acc: 0.520 Test Loss: 49.355 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.373316764831543
Epoch: 31, Steps: 13 | Train Loss: 2.094 Vali Loss: 45.066 Vali Acc: 0.460 Test Loss: 45.066 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.4404945373535156
Epoch: 32, Steps: 13 | Train Loss: 0.000 Vali Loss: 42.559 Vali Acc: 0.500 Test Loss: 42.559 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.5583746433258057
Epoch: 33, Steps: 13 | Train Loss: 0.000 Vali Loss: 44.628 Vali Acc: 0.540 Test Loss: 44.628 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.629930019378662
Epoch: 34, Steps: 13 | Train Loss: 0.000 Vali Loss: 42.879 Vali Acc: 0.540 Test Loss: 42.879 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 2.656944513320923
Epoch: 35, Steps: 13 | Train Loss: 0.000 Vali Loss: 42.521 Vali Acc: 0.560 Test Loss: 42.521 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 2.4327855110168457
Epoch: 36, Steps: 13 | Train Loss: 0.000 Vali Loss: 42.449 Vali Acc: 0.560 Test Loss: 42.449 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 2.886594772338867
Epoch: 37, Steps: 13 | Train Loss: 0.000 Vali Loss: 42.431 Vali Acc: 0.560 Test Loss: 42.431 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 3828041
model size : 15.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.9920430183410645
Epoch: 1, Steps: 13 | Train Loss: 4.444 Vali Loss: 7.827 Vali Acc: 0.200 Test Loss: 7.827 Test Acc: 0.200
Validation loss decreased (inf --> -0.199922).  Saving model ...
Epoch: 2 cost time: 2.1628811359405518
Epoch: 2, Steps: 13 | Train Loss: 6.257 Vali Loss: 12.733 Vali Acc: 0.200 Test Loss: 12.733 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.252941131591797
Epoch: 3, Steps: 13 | Train Loss: 10.352 Vali Loss: 18.962 Vali Acc: 0.280 Test Loss: 18.962 Test Acc: 0.280
Validation loss decreased (-0.199922 --> -0.279810).  Saving model ...
Epoch: 4 cost time: 2.159895181655884
Epoch: 4, Steps: 13 | Train Loss: 12.149 Vali Loss: 19.723 Vali Acc: 0.240 Test Loss: 19.723 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.4448742866516113
Epoch: 5, Steps: 13 | Train Loss: 11.559 Vali Loss: 13.983 Vali Acc: 0.240 Test Loss: 13.983 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.095550537109375
Epoch: 6, Steps: 13 | Train Loss: 16.205 Vali Loss: 16.742 Vali Acc: 0.340 Test Loss: 16.742 Test Acc: 0.340
Validation loss decreased (-0.279810 --> -0.339833).  Saving model ...
Epoch: 7 cost time: 2.0915656089782715
Epoch: 7, Steps: 13 | Train Loss: 15.319 Vali Loss: 17.393 Vali Acc: 0.420 Test Loss: 17.393 Test Acc: 0.420
Validation loss decreased (-0.339833 --> -0.419826).  Saving model ...
Epoch: 8 cost time: 2.0857996940612793
Epoch: 8, Steps: 13 | Train Loss: 16.936 Vali Loss: 31.335 Vali Acc: 0.300 Test Loss: 31.335 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.2834463119506836
Epoch: 9, Steps: 13 | Train Loss: 9.349 Vali Loss: 49.479 Vali Acc: 0.420 Test Loss: 49.479 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.3008792400360107
Epoch: 10, Steps: 13 | Train Loss: 18.160 Vali Loss: 25.320 Vali Acc: 0.340 Test Loss: 25.320 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.1594955921173096
Epoch: 11, Steps: 13 | Train Loss: 11.795 Vali Loss: 37.459 Vali Acc: 0.480 Test Loss: 37.459 Test Acc: 0.480
Validation loss decreased (-0.419826 --> -0.479625).  Saving model ...
Epoch: 12 cost time: 2.245607376098633
Epoch: 12, Steps: 13 | Train Loss: 14.222 Vali Loss: 28.728 Vali Acc: 0.480 Test Loss: 28.728 Test Acc: 0.480
Validation loss decreased (-0.479625 --> -0.479713).  Saving model ...
Epoch: 13 cost time: 2.5363876819610596
Epoch: 13, Steps: 13 | Train Loss: 8.265 Vali Loss: 30.975 Vali Acc: 0.500 Test Loss: 30.975 Test Acc: 0.500
Validation loss decreased (-0.479713 --> -0.499690).  Saving model ...
Epoch: 14 cost time: 2.4074153900146484
Epoch: 14, Steps: 13 | Train Loss: 7.843 Vali Loss: 30.160 Vali Acc: 0.500 Test Loss: 30.160 Test Acc: 0.500
Validation loss decreased (-0.499690 --> -0.499698).  Saving model ...
Epoch: 15 cost time: 2.3374135494232178
Epoch: 15, Steps: 13 | Train Loss: 18.317 Vali Loss: 44.890 Vali Acc: 0.340 Test Loss: 44.890 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.4877262115478516
Epoch: 16, Steps: 13 | Train Loss: 8.969 Vali Loss: 48.860 Vali Acc: 0.380 Test Loss: 48.860 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.5633797645568848
Epoch: 17, Steps: 13 | Train Loss: 13.310 Vali Loss: 43.862 Vali Acc: 0.540 Test Loss: 43.862 Test Acc: 0.540
Validation loss decreased (-0.499698 --> -0.539561).  Saving model ...
Epoch: 18 cost time: 2.547755479812622
Epoch: 18, Steps: 13 | Train Loss: 5.416 Vali Loss: 35.271 Vali Acc: 0.400 Test Loss: 35.271 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.2527201175689697
Epoch: 19, Steps: 13 | Train Loss: 2.260 Vali Loss: 27.532 Vali Acc: 0.500 Test Loss: 27.532 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.230912685394287
Epoch: 20, Steps: 13 | Train Loss: 0.441 Vali Loss: 41.040 Vali Acc: 0.440 Test Loss: 41.040 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.1790082454681396
Epoch: 21, Steps: 13 | Train Loss: 0.970 Vali Loss: 51.391 Vali Acc: 0.480 Test Loss: 51.391 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.5453004837036133
Epoch: 22, Steps: 13 | Train Loss: 3.179 Vali Loss: 53.726 Vali Acc: 0.440 Test Loss: 53.726 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.3692495822906494
Epoch: 23, Steps: 13 | Train Loss: 1.670 Vali Loss: 41.379 Vali Acc: 0.420 Test Loss: 41.379 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.6249074935913086
Epoch: 24, Steps: 13 | Train Loss: 2.116 Vali Loss: 43.066 Vali Acc: 0.400 Test Loss: 43.066 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.3637077808380127
Epoch: 25, Steps: 13 | Train Loss: 0.000 Vali Loss: 36.596 Vali Acc: 0.520 Test Loss: 36.596 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.7719154357910156
Epoch: 26, Steps: 13 | Train Loss: 0.000 Vali Loss: 38.304 Vali Acc: 0.480 Test Loss: 38.304 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.5748660564422607
Epoch: 27, Steps: 13 | Train Loss: 0.000 Vali Loss: 38.900 Vali Acc: 0.480 Test Loss: 38.900 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 3748201
model size : 15.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.7416574954986572
Epoch: 1, Steps: 13 | Train Loss: 4.872 Vali Loss: 6.216 Vali Acc: 0.280 Test Loss: 6.216 Test Acc: 0.280
Validation loss decreased (inf --> -0.279938).  Saving model ...
Epoch: 2 cost time: 1.9900867938995361
Epoch: 2, Steps: 13 | Train Loss: 8.660 Vali Loss: 11.985 Vali Acc: 0.200 Test Loss: 11.985 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.13295316696167
Epoch: 3, Steps: 13 | Train Loss: 9.262 Vali Loss: 23.070 Vali Acc: 0.240 Test Loss: 23.070 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.3015379905700684
Epoch: 4, Steps: 13 | Train Loss: 9.231 Vali Loss: 26.815 Vali Acc: 0.320 Test Loss: 26.815 Test Acc: 0.320
Validation loss decreased (-0.279938 --> -0.319732).  Saving model ...
Epoch: 5 cost time: 2.164790391921997
Epoch: 5, Steps: 13 | Train Loss: 15.416 Vali Loss: 15.022 Vali Acc: 0.480 Test Loss: 15.022 Test Acc: 0.480
Validation loss decreased (-0.319732 --> -0.479850).  Saving model ...
Epoch: 6 cost time: 2.1299736499786377
Epoch: 6, Steps: 13 | Train Loss: 11.780 Vali Loss: 21.978 Vali Acc: 0.280 Test Loss: 21.978 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.3631606101989746
Epoch: 7, Steps: 13 | Train Loss: 22.521 Vali Loss: 22.906 Vali Acc: 0.400 Test Loss: 22.906 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.1076886653900146
Epoch: 8, Steps: 13 | Train Loss: 13.002 Vali Loss: 21.820 Vali Acc: 0.460 Test Loss: 21.820 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.1881260871887207
Epoch: 9, Steps: 13 | Train Loss: 12.619 Vali Loss: 31.797 Vali Acc: 0.260 Test Loss: 31.797 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.194226026535034
Epoch: 10, Steps: 13 | Train Loss: 13.639 Vali Loss: 25.814 Vali Acc: 0.320 Test Loss: 25.814 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.042548894882202
Epoch: 11, Steps: 13 | Train Loss: 17.222 Vali Loss: 28.474 Vali Acc: 0.420 Test Loss: 28.474 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.3419439792633057
Epoch: 12, Steps: 13 | Train Loss: 10.173 Vali Loss: 29.743 Vali Acc: 0.480 Test Loss: 29.743 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.276444673538208
Epoch: 13, Steps: 13 | Train Loss: 4.291 Vali Loss: 22.234 Vali Acc: 0.460 Test Loss: 22.234 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.0986039638519287
Epoch: 14, Steps: 13 | Train Loss: 1.936 Vali Loss: 26.757 Vali Acc: 0.520 Test Loss: 26.757 Test Acc: 0.520
Validation loss decreased (-0.479850 --> -0.519732).  Saving model ...
Epoch: 15 cost time: 2.291306972503662
Epoch: 15, Steps: 13 | Train Loss: 4.909 Vali Loss: 49.790 Vali Acc: 0.460 Test Loss: 49.790 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.4249427318573
Epoch: 16, Steps: 13 | Train Loss: 15.604 Vali Loss: 46.595 Vali Acc: 0.380 Test Loss: 46.595 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.352922201156616
Epoch: 17, Steps: 13 | Train Loss: 9.464 Vali Loss: 40.850 Vali Acc: 0.440 Test Loss: 40.850 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.3087918758392334
Epoch: 18, Steps: 13 | Train Loss: 16.080 Vali Loss: 65.448 Vali Acc: 0.360 Test Loss: 65.448 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.219533681869507
Epoch: 19, Steps: 13 | Train Loss: 10.556 Vali Loss: 53.529 Vali Acc: 0.460 Test Loss: 53.529 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.333852767944336
Epoch: 20, Steps: 13 | Train Loss: 5.170 Vali Loss: 51.559 Vali Acc: 0.340 Test Loss: 51.559 Test Acc: 0.340
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.4244143962860107
Epoch: 21, Steps: 13 | Train Loss: 7.495 Vali Loss: 60.667 Vali Acc: 0.320 Test Loss: 60.667 Test Acc: 0.320
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.2666354179382324
Epoch: 22, Steps: 13 | Train Loss: 3.425 Vali Loss: 51.135 Vali Acc: 0.440 Test Loss: 51.135 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.1860225200653076
Epoch: 23, Steps: 13 | Train Loss: 4.902 Vali Loss: 76.642 Vali Acc: 0.320 Test Loss: 76.642 Test Acc: 0.320
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.1314749717712402
Epoch: 24, Steps: 13 | Train Loss: 6.647 Vali Loss: 56.364 Vali Acc: 0.400 Test Loss: 56.364 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 3747081
model size : 15.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.264726638793945
Epoch: 1, Steps: 13 | Train Loss: 7.115 Vali Loss: 9.236 Vali Acc: 0.200 Test Loss: 9.236 Test Acc: 0.200
Validation loss decreased (inf --> -0.199908).  Saving model ...
Epoch: 2 cost time: 2.2412309646606445
Epoch: 2, Steps: 13 | Train Loss: 8.758 Vali Loss: 12.391 Vali Acc: 0.220 Test Loss: 12.391 Test Acc: 0.220
Validation loss decreased (-0.199908 --> -0.219876).  Saving model ...
Epoch: 3 cost time: 2.2793173789978027
Epoch: 3, Steps: 13 | Train Loss: 9.568 Vali Loss: 12.955 Vali Acc: 0.260 Test Loss: 12.955 Test Acc: 0.260
Validation loss decreased (-0.219876 --> -0.259870).  Saving model ...
Epoch: 4 cost time: 2.2559454441070557
Epoch: 4, Steps: 13 | Train Loss: 13.734 Vali Loss: 24.755 Vali Acc: 0.220 Test Loss: 24.755 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.374626636505127
Epoch: 5, Steps: 13 | Train Loss: 17.214 Vali Loss: 25.551 Vali Acc: 0.280 Test Loss: 25.551 Test Acc: 0.280
Validation loss decreased (-0.259870 --> -0.279744).  Saving model ...
Epoch: 6 cost time: 2.351140022277832
Epoch: 6, Steps: 13 | Train Loss: 13.643 Vali Loss: 28.560 Vali Acc: 0.300 Test Loss: 28.560 Test Acc: 0.300
Validation loss decreased (-0.279744 --> -0.299714).  Saving model ...
Epoch: 7 cost time: 2.2779767513275146
Epoch: 7, Steps: 13 | Train Loss: 17.061 Vali Loss: 22.121 Vali Acc: 0.460 Test Loss: 22.121 Test Acc: 0.460
Validation loss decreased (-0.299714 --> -0.459779).  Saving model ...
Epoch: 8 cost time: 2.74851393699646
Epoch: 8, Steps: 13 | Train Loss: 14.670 Vali Loss: 32.811 Vali Acc: 0.380 Test Loss: 32.811 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.3715734481811523
Epoch: 9, Steps: 13 | Train Loss: 11.512 Vali Loss: 18.793 Vali Acc: 0.360 Test Loss: 18.793 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.413538932800293
Epoch: 10, Steps: 13 | Train Loss: 22.115 Vali Loss: 58.944 Vali Acc: 0.280 Test Loss: 58.944 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.5364460945129395
Epoch: 11, Steps: 13 | Train Loss: 20.286 Vali Loss: 47.778 Vali Acc: 0.420 Test Loss: 47.778 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.310641050338745
Epoch: 12, Steps: 13 | Train Loss: 19.261 Vali Loss: 25.005 Vali Acc: 0.380 Test Loss: 25.005 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.383087158203125
Epoch: 13, Steps: 13 | Train Loss: 8.208 Vali Loss: 48.319 Vali Acc: 0.380 Test Loss: 48.319 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.3565032482147217
Epoch: 14, Steps: 13 | Train Loss: 12.663 Vali Loss: 29.199 Vali Acc: 0.420 Test Loss: 29.199 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.595858335494995
Epoch: 15, Steps: 13 | Train Loss: 13.960 Vali Loss: 51.755 Vali Acc: 0.240 Test Loss: 51.755 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.5950798988342285
Epoch: 16, Steps: 13 | Train Loss: 8.203 Vali Loss: 32.702 Vali Acc: 0.500 Test Loss: 32.702 Test Acc: 0.500
Validation loss decreased (-0.459779 --> -0.499673).  Saving model ...
Epoch: 17 cost time: 2.5606842041015625
Epoch: 17, Steps: 13 | Train Loss: 9.084 Vali Loss: 47.548 Vali Acc: 0.540 Test Loss: 47.548 Test Acc: 0.540
Validation loss decreased (-0.499673 --> -0.539525).  Saving model ...
Epoch: 18 cost time: 2.355288028717041
Epoch: 18, Steps: 13 | Train Loss: 6.904 Vali Loss: 34.964 Vali Acc: 0.500 Test Loss: 34.964 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.2501697540283203
Epoch: 19, Steps: 13 | Train Loss: 4.205 Vali Loss: 29.979 Vali Acc: 0.500 Test Loss: 29.979 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.3485007286071777
Epoch: 20, Steps: 13 | Train Loss: 9.194 Vali Loss: 75.980 Vali Acc: 0.480 Test Loss: 75.980 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.347867727279663
Epoch: 21, Steps: 13 | Train Loss: 11.837 Vali Loss: 41.881 Vali Acc: 0.460 Test Loss: 41.881 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.5620973110198975
Epoch: 22, Steps: 13 | Train Loss: 4.932 Vali Loss: 59.345 Vali Acc: 0.400 Test Loss: 59.345 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.3396401405334473
Epoch: 23, Steps: 13 | Train Loss: 0.968 Vali Loss: 53.676 Vali Acc: 0.540 Test Loss: 53.676 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.202770948410034
Epoch: 24, Steps: 13 | Train Loss: 2.203 Vali Loss: 44.726 Vali Acc: 0.460 Test Loss: 44.726 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.77236008644104
Epoch: 25, Steps: 13 | Train Loss: 3.678 Vali Loss: 43.198 Vali Acc: 0.520 Test Loss: 43.198 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.649251699447632
Epoch: 26, Steps: 13 | Train Loss: 7.406 Vali Loss: 59.351 Vali Acc: 0.440 Test Loss: 59.351 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.6183958053588867
Epoch: 27, Steps: 13 | Train Loss: 4.771 Vali Loss: 81.511 Vali Acc: 0.320 Test Loss: 81.511 Test Acc: 0.320
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 3745961
model size : 15.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.095900774002075
Epoch: 1, Steps: 13 | Train Loss: 3.370 Vali Loss: 5.470 Vali Acc: 0.200 Test Loss: 5.470 Test Acc: 0.200
Validation loss decreased (inf --> -0.199945).  Saving model ...
Epoch: 2 cost time: 2.293938636779785
Epoch: 2, Steps: 13 | Train Loss: 9.863 Vali Loss: 11.606 Vali Acc: 0.380 Test Loss: 11.606 Test Acc: 0.380
Validation loss decreased (-0.199945 --> -0.379884).  Saving model ...
Epoch: 3 cost time: 2.547616720199585
Epoch: 3, Steps: 13 | Train Loss: 10.223 Vali Loss: 6.666 Vali Acc: 0.340 Test Loss: 6.666 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.2704904079437256
Epoch: 4, Steps: 13 | Train Loss: 6.903 Vali Loss: 14.376 Vali Acc: 0.300 Test Loss: 14.376 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.498866558074951
Epoch: 5, Steps: 13 | Train Loss: 14.322 Vali Loss: 22.744 Vali Acc: 0.200 Test Loss: 22.744 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.4684646129608154
Epoch: 6, Steps: 13 | Train Loss: 15.311 Vali Loss: 27.607 Vali Acc: 0.220 Test Loss: 27.607 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.8076553344726562
Epoch: 7, Steps: 13 | Train Loss: 10.750 Vali Loss: 21.846 Vali Acc: 0.400 Test Loss: 21.846 Test Acc: 0.400
Validation loss decreased (-0.379884 --> -0.399782).  Saving model ...
Epoch: 8 cost time: 2.3724145889282227
Epoch: 8, Steps: 13 | Train Loss: 14.229 Vali Loss: 31.239 Vali Acc: 0.300 Test Loss: 31.239 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.656799554824829
Epoch: 9, Steps: 13 | Train Loss: 16.533 Vali Loss: 18.663 Vali Acc: 0.440 Test Loss: 18.663 Test Acc: 0.440
Validation loss decreased (-0.399782 --> -0.439813).  Saving model ...
Epoch: 10 cost time: 2.2977540493011475
Epoch: 10, Steps: 13 | Train Loss: 5.062 Vali Loss: 20.187 Vali Acc: 0.460 Test Loss: 20.187 Test Acc: 0.460
Validation loss decreased (-0.439813 --> -0.459798).  Saving model ...
Epoch: 11 cost time: 2.289875030517578
Epoch: 11, Steps: 13 | Train Loss: 4.173 Vali Loss: 22.879 Vali Acc: 0.400 Test Loss: 22.879 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.1871426105499268
Epoch: 12, Steps: 13 | Train Loss: 5.593 Vali Loss: 34.619 Vali Acc: 0.380 Test Loss: 34.619 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.384404420852661
Epoch: 13, Steps: 13 | Train Loss: 5.746 Vali Loss: 32.687 Vali Acc: 0.360 Test Loss: 32.687 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.4329416751861572
Epoch: 14, Steps: 13 | Train Loss: 2.307 Vali Loss: 46.469 Vali Acc: 0.360 Test Loss: 46.469 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.3788537979125977
Epoch: 15, Steps: 13 | Train Loss: 9.347 Vali Loss: 35.886 Vali Acc: 0.440 Test Loss: 35.886 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.175337314605713
Epoch: 16, Steps: 13 | Train Loss: 2.699 Vali Loss: 44.393 Vali Acc: 0.420 Test Loss: 44.393 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.1949753761291504
Epoch: 17, Steps: 13 | Train Loss: 7.289 Vali Loss: 62.619 Vali Acc: 0.420 Test Loss: 62.619 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.626136302947998
Epoch: 18, Steps: 13 | Train Loss: 15.538 Vali Loss: 57.021 Vali Acc: 0.440 Test Loss: 57.021 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.4298720359802246
Epoch: 19, Steps: 13 | Train Loss: 23.968 Vali Loss: 35.804 Vali Acc: 0.420 Test Loss: 35.804 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.248856782913208
Epoch: 20, Steps: 13 | Train Loss: 6.082 Vali Loss: 48.883 Vali Acc: 0.420 Test Loss: 48.883 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.46
model parameter : 3744841
model size : 15.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.489344835281372
Epoch: 1, Steps: 13 | Train Loss: 6.607 Vali Loss: 8.068 Vali Acc: 0.200 Test Loss: 8.068 Test Acc: 0.200
Validation loss decreased (inf --> -0.199919).  Saving model ...
Epoch: 2 cost time: 2.2731940746307373
Epoch: 2, Steps: 13 | Train Loss: 7.121 Vali Loss: 12.390 Vali Acc: 0.400 Test Loss: 12.390 Test Acc: 0.400
Validation loss decreased (-0.199919 --> -0.399876).  Saving model ...
Epoch: 3 cost time: 1.9842963218688965
Epoch: 3, Steps: 13 | Train Loss: 7.349 Vali Loss: 16.466 Vali Acc: 0.300 Test Loss: 16.466 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.117100954055786
Epoch: 4, Steps: 13 | Train Loss: 6.131 Vali Loss: 15.111 Vali Acc: 0.200 Test Loss: 15.111 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.1207327842712402
Epoch: 5, Steps: 13 | Train Loss: 5.907 Vali Loss: 11.977 Vali Acc: 0.340 Test Loss: 11.977 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.212372064590454
Epoch: 6, Steps: 13 | Train Loss: 6.632 Vali Loss: 11.057 Vali Acc: 0.320 Test Loss: 11.057 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.1544833183288574
Epoch: 7, Steps: 13 | Train Loss: 5.014 Vali Loss: 16.149 Vali Acc: 0.400 Test Loss: 16.149 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.3261866569519043
Epoch: 8, Steps: 13 | Train Loss: 13.302 Vali Loss: 22.229 Vali Acc: 0.300 Test Loss: 22.229 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.087315559387207
Epoch: 9, Steps: 13 | Train Loss: 8.665 Vali Loss: 20.331 Vali Acc: 0.400 Test Loss: 20.331 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.2109599113464355
Epoch: 10, Steps: 13 | Train Loss: 3.403 Vali Loss: 20.038 Vali Acc: 0.380 Test Loss: 20.038 Test Acc: 0.380
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.0870351791381836
Epoch: 11, Steps: 13 | Train Loss: 6.859 Vali Loss: 21.786 Vali Acc: 0.460 Test Loss: 21.786 Test Acc: 0.460
Validation loss decreased (-0.399876 --> -0.459782).  Saving model ...
Epoch: 12 cost time: 2.1289145946502686
Epoch: 12, Steps: 13 | Train Loss: 7.782 Vali Loss: 36.278 Vali Acc: 0.320 Test Loss: 36.278 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.1416540145874023
Epoch: 13, Steps: 13 | Train Loss: 14.044 Vali Loss: 35.631 Vali Acc: 0.380 Test Loss: 35.631 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.0666399002075195
Epoch: 14, Steps: 13 | Train Loss: 6.833 Vali Loss: 28.766 Vali Acc: 0.420 Test Loss: 28.766 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.2606234550476074
Epoch: 15, Steps: 13 | Train Loss: 9.441 Vali Loss: 22.533 Vali Acc: 0.480 Test Loss: 22.533 Test Acc: 0.480
Validation loss decreased (-0.459782 --> -0.479775).  Saving model ...
Epoch: 16 cost time: 2.014695882797241
Epoch: 16, Steps: 13 | Train Loss: 3.515 Vali Loss: 35.143 Vali Acc: 0.500 Test Loss: 35.143 Test Acc: 0.500
Validation loss decreased (-0.479775 --> -0.499649).  Saving model ...
Epoch: 17 cost time: 2.1298608779907227
Epoch: 17, Steps: 13 | Train Loss: 3.619 Vali Loss: 41.579 Vali Acc: 0.380 Test Loss: 41.579 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.2972469329833984
Epoch: 18, Steps: 13 | Train Loss: 10.867 Vali Loss: 75.544 Vali Acc: 0.400 Test Loss: 75.544 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.9748880863189697
Epoch: 19, Steps: 13 | Train Loss: 9.060 Vali Loss: 51.176 Vali Acc: 0.420 Test Loss: 51.176 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.9940190315246582
Epoch: 20, Steps: 13 | Train Loss: 5.573 Vali Loss: 35.843 Vali Acc: 0.520 Test Loss: 35.843 Test Acc: 0.520
Validation loss decreased (-0.499649 --> -0.519642).  Saving model ...
Epoch: 21 cost time: 2.389280319213867
Epoch: 21, Steps: 13 | Train Loss: 1.725 Vali Loss: 39.599 Vali Acc: 0.380 Test Loss: 39.599 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.201057195663452
Epoch: 22, Steps: 13 | Train Loss: 1.890 Vali Loss: 39.003 Vali Acc: 0.440 Test Loss: 39.003 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.3669965267181396
Epoch: 23, Steps: 13 | Train Loss: 1.531 Vali Loss: 42.545 Vali Acc: 0.380 Test Loss: 42.545 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.193779945373535
Epoch: 24, Steps: 13 | Train Loss: 1.076 Vali Loss: 48.098 Vali Acc: 0.400 Test Loss: 48.098 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.251505136489868
Epoch: 25, Steps: 13 | Train Loss: 7.193 Vali Loss: 68.526 Vali Acc: 0.400 Test Loss: 68.526 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.3241348266601562
Epoch: 26, Steps: 13 | Train Loss: 5.845 Vali Loss: 63.446 Vali Acc: 0.440 Test Loss: 63.446 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.231844902038574
Epoch: 27, Steps: 13 | Train Loss: 11.337 Vali Loss: 69.845 Vali Acc: 0.380 Test Loss: 69.845 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.0769810676574707
Epoch: 28, Steps: 13 | Train Loss: 5.051 Vali Loss: 58.781 Vali Acc: 0.440 Test Loss: 58.781 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.171415090560913
Epoch: 29, Steps: 13 | Train Loss: 5.735 Vali Loss: 64.447 Vali Acc: 0.400 Test Loss: 64.447 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.24707293510437
Epoch: 30, Steps: 13 | Train Loss: 1.862 Vali Loss: 55.511 Vali Acc: 0.500 Test Loss: 55.511 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 3706601
model size : 14.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.053138494491577
Epoch: 1, Steps: 13 | Train Loss: 6.526 Vali Loss: 5.592 Vali Acc: 0.200 Test Loss: 5.592 Test Acc: 0.200
Validation loss decreased (inf --> -0.199944).  Saving model ...
Epoch: 2 cost time: 2.4176158905029297
Epoch: 2, Steps: 13 | Train Loss: 7.985 Vali Loss: 14.981 Vali Acc: 0.300 Test Loss: 14.981 Test Acc: 0.300
Validation loss decreased (-0.199944 --> -0.299850).  Saving model ...
Epoch: 3 cost time: 2.035921335220337
Epoch: 3, Steps: 13 | Train Loss: 6.881 Vali Loss: 14.020 Vali Acc: 0.240 Test Loss: 14.020 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.2105579376220703
Epoch: 4, Steps: 13 | Train Loss: 7.309 Vali Loss: 9.880 Vali Acc: 0.340 Test Loss: 9.880 Test Acc: 0.340
Validation loss decreased (-0.299850 --> -0.339901).  Saving model ...
Epoch: 5 cost time: 2.1768743991851807
Epoch: 5, Steps: 13 | Train Loss: 4.822 Vali Loss: 8.550 Vali Acc: 0.340 Test Loss: 8.550 Test Acc: 0.340
Validation loss decreased (-0.339901 --> -0.339915).  Saving model ...
Epoch: 6 cost time: 2.119429588317871
Epoch: 6, Steps: 13 | Train Loss: 4.953 Vali Loss: 28.782 Vali Acc: 0.220 Test Loss: 28.782 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.330235719680786
Epoch: 7, Steps: 13 | Train Loss: 18.606 Vali Loss: 12.616 Vali Acc: 0.440 Test Loss: 12.616 Test Acc: 0.440
Validation loss decreased (-0.339915 --> -0.439874).  Saving model ...
Epoch: 8 cost time: 2.170792579650879
Epoch: 8, Steps: 13 | Train Loss: 11.291 Vali Loss: 33.033 Vali Acc: 0.320 Test Loss: 33.033 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.3098714351654053
Epoch: 9, Steps: 13 | Train Loss: 21.467 Vali Loss: 14.396 Vali Acc: 0.380 Test Loss: 14.396 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.150707244873047
Epoch: 10, Steps: 13 | Train Loss: 12.566 Vali Loss: 43.193 Vali Acc: 0.340 Test Loss: 43.193 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.6602325439453125
Epoch: 11, Steps: 13 | Train Loss: 19.431 Vali Loss: 52.937 Vali Acc: 0.360 Test Loss: 52.937 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.4323277473449707
Epoch: 12, Steps: 13 | Train Loss: 11.447 Vali Loss: 27.639 Vali Acc: 0.380 Test Loss: 27.639 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.4727728366851807
Epoch: 13, Steps: 13 | Train Loss: 9.619 Vali Loss: 28.268 Vali Acc: 0.480 Test Loss: 28.268 Test Acc: 0.480
Validation loss decreased (-0.439874 --> -0.479717).  Saving model ...
Epoch: 14 cost time: 2.544520139694214
Epoch: 14, Steps: 13 | Train Loss: 15.832 Vali Loss: 60.065 Vali Acc: 0.320 Test Loss: 60.065 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.4035427570343018
Epoch: 15, Steps: 13 | Train Loss: 5.197 Vali Loss: 37.785 Vali Acc: 0.400 Test Loss: 37.785 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.9498960971832275
Epoch: 16, Steps: 13 | Train Loss: 6.218 Vali Loss: 51.828 Vali Acc: 0.420 Test Loss: 51.828 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.4479377269744873
Epoch: 17, Steps: 13 | Train Loss: 13.010 Vali Loss: 46.793 Vali Acc: 0.440 Test Loss: 46.793 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.2963221073150635
Epoch: 18, Steps: 13 | Train Loss: 2.218 Vali Loss: 41.326 Vali Acc: 0.480 Test Loss: 41.326 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.2544867992401123
Epoch: 19, Steps: 13 | Train Loss: 7.302 Vali Loss: 25.057 Vali Acc: 0.540 Test Loss: 25.057 Test Acc: 0.540
Validation loss decreased (-0.479717 --> -0.539749).  Saving model ...
Epoch: 20 cost time: 2.249267339706421
Epoch: 20, Steps: 13 | Train Loss: 3.952 Vali Loss: 48.922 Vali Acc: 0.520 Test Loss: 48.922 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.053734302520752
Epoch: 21, Steps: 13 | Train Loss: 4.253 Vali Loss: 35.882 Vali Acc: 0.560 Test Loss: 35.882 Test Acc: 0.560
Validation loss decreased (-0.539749 --> -0.559641).  Saving model ...
Epoch: 22 cost time: 2.152024507522583
Epoch: 22, Steps: 13 | Train Loss: 2.956 Vali Loss: 71.782 Vali Acc: 0.460 Test Loss: 71.782 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.208592414855957
Epoch: 23, Steps: 13 | Train Loss: 7.244 Vali Loss: 50.871 Vali Acc: 0.520 Test Loss: 50.871 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.093001365661621
Epoch: 24, Steps: 13 | Train Loss: 2.437 Vali Loss: 31.562 Vali Acc: 0.620 Test Loss: 31.562 Test Acc: 0.620
Validation loss decreased (-0.559641 --> -0.619684).  Saving model ...
Epoch: 25 cost time: 2.232308864593506
Epoch: 25, Steps: 13 | Train Loss: 0.732 Vali Loss: 35.026 Vali Acc: 0.580 Test Loss: 35.026 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.149343729019165
Epoch: 26, Steps: 13 | Train Loss: 1.412 Vali Loss: 37.536 Vali Acc: 0.540 Test Loss: 37.536 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.151897668838501
Epoch: 27, Steps: 13 | Train Loss: 2.002 Vali Loss: 37.562 Vali Acc: 0.580 Test Loss: 37.562 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.5259969234466553
Epoch: 28, Steps: 13 | Train Loss: 0.643 Vali Loss: 61.567 Vali Acc: 0.540 Test Loss: 61.567 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.378486156463623
Epoch: 29, Steps: 13 | Train Loss: 0.767 Vali Loss: 52.900 Vali Acc: 0.380 Test Loss: 52.900 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.2120258808135986
Epoch: 30, Steps: 13 | Train Loss: 1.456 Vali Loss: 88.025 Vali Acc: 0.340 Test Loss: 88.025 Test Acc: 0.340
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.1341443061828613
Epoch: 31, Steps: 13 | Train Loss: 8.145 Vali Loss: 72.903 Vali Acc: 0.380 Test Loss: 72.903 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.2144827842712402
Epoch: 32, Steps: 13 | Train Loss: 8.735 Vali Loss: 108.294 Vali Acc: 0.340 Test Loss: 108.294 Test Acc: 0.340
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.0736470222473145
Epoch: 33, Steps: 13 | Train Loss: 10.210 Vali Loss: 62.706 Vali Acc: 0.460 Test Loss: 62.706 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.044464349746704
Epoch: 34, Steps: 13 | Train Loss: 1.513 Vali Loss: 101.788 Vali Acc: 0.440 Test Loss: 101.788 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 3705481
model size : 14.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.695652961730957
Epoch: 1, Steps: 13 | Train Loss: 4.194 Vali Loss: 5.609 Vali Acc: 0.240 Test Loss: 5.609 Test Acc: 0.240
Validation loss decreased (inf --> -0.239944).  Saving model ...
Epoch: 2 cost time: 2.203958749771118
Epoch: 2, Steps: 13 | Train Loss: 3.954 Vali Loss: 10.975 Vali Acc: 0.240 Test Loss: 10.975 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.4314754009246826
Epoch: 3, Steps: 13 | Train Loss: 8.855 Vali Loss: 13.178 Vali Acc: 0.300 Test Loss: 13.178 Test Acc: 0.300
Validation loss decreased (-0.239944 --> -0.299868).  Saving model ...
Epoch: 4 cost time: 2.1272196769714355
Epoch: 4, Steps: 13 | Train Loss: 11.069 Vali Loss: 16.557 Vali Acc: 0.400 Test Loss: 16.557 Test Acc: 0.400
Validation loss decreased (-0.299868 --> -0.399834).  Saving model ...
Epoch: 5 cost time: 2.268758535385132
Epoch: 5, Steps: 13 | Train Loss: 8.460 Vali Loss: 24.105 Vali Acc: 0.280 Test Loss: 24.105 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.164897918701172
Epoch: 6, Steps: 13 | Train Loss: 14.918 Vali Loss: 14.664 Vali Acc: 0.420 Test Loss: 14.664 Test Acc: 0.420
Validation loss decreased (-0.399834 --> -0.419853).  Saving model ...
Epoch: 7 cost time: 2.192841053009033
Epoch: 7, Steps: 13 | Train Loss: 4.111 Vali Loss: 14.333 Vali Acc: 0.360 Test Loss: 14.333 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.270590305328369
Epoch: 8, Steps: 13 | Train Loss: 7.678 Vali Loss: 24.783 Vali Acc: 0.440 Test Loss: 24.783 Test Acc: 0.440
Validation loss decreased (-0.419853 --> -0.439752).  Saving model ...
Epoch: 9 cost time: 2.0696473121643066
Epoch: 9, Steps: 13 | Train Loss: 10.030 Vali Loss: 18.638 Vali Acc: 0.400 Test Loss: 18.638 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1668801307678223
Epoch: 10, Steps: 13 | Train Loss: 7.348 Vali Loss: 49.539 Vali Acc: 0.320 Test Loss: 49.539 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.3918585777282715
Epoch: 11, Steps: 13 | Train Loss: 26.962 Vali Loss: 38.187 Vali Acc: 0.280 Test Loss: 38.187 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.187389850616455
Epoch: 12, Steps: 13 | Train Loss: 9.159 Vali Loss: 39.612 Vali Acc: 0.420 Test Loss: 39.612 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.184966564178467
Epoch: 13, Steps: 13 | Train Loss: 11.629 Vali Loss: 45.589 Vali Acc: 0.340 Test Loss: 45.589 Test Acc: 0.340
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.1737148761749268
Epoch: 14, Steps: 13 | Train Loss: 6.916 Vali Loss: 36.769 Vali Acc: 0.420 Test Loss: 36.769 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.2289319038391113
Epoch: 15, Steps: 13 | Train Loss: 3.553 Vali Loss: 29.615 Vali Acc: 0.420 Test Loss: 29.615 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.5671424865722656
Epoch: 16, Steps: 13 | Train Loss: 15.078 Vali Loss: 44.193 Vali Acc: 0.480 Test Loss: 44.193 Test Acc: 0.480
Validation loss decreased (-0.439752 --> -0.479558).  Saving model ...
Epoch: 17 cost time: 2.1468536853790283
Epoch: 17, Steps: 13 | Train Loss: 7.131 Vali Loss: 70.179 Vali Acc: 0.420 Test Loss: 70.179 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.121910572052002
Epoch: 18, Steps: 13 | Train Loss: 18.552 Vali Loss: 66.339 Vali Acc: 0.440 Test Loss: 66.339 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.2515153884887695
Epoch: 19, Steps: 13 | Train Loss: 16.763 Vali Loss: 62.374 Vali Acc: 0.460 Test Loss: 62.374 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.2337567806243896
Epoch: 20, Steps: 13 | Train Loss: 8.734 Vali Loss: 60.802 Vali Acc: 0.500 Test Loss: 60.802 Test Acc: 0.500
Validation loss decreased (-0.479558 --> -0.499392).  Saving model ...
Epoch: 21 cost time: 2.3391900062561035
Epoch: 21, Steps: 13 | Train Loss: 15.046 Vali Loss: 66.909 Vali Acc: 0.460 Test Loss: 66.909 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.0529673099517822
Epoch: 22, Steps: 13 | Train Loss: 8.166 Vali Loss: 57.534 Vali Acc: 0.480 Test Loss: 57.534 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.1645240783691406
Epoch: 23, Steps: 13 | Train Loss: 7.680 Vali Loss: 60.737 Vali Acc: 0.420 Test Loss: 60.737 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.2100603580474854
Epoch: 24, Steps: 13 | Train Loss: 13.975 Vali Loss: 84.587 Vali Acc: 0.400 Test Loss: 84.587 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.201781988143921
Epoch: 25, Steps: 13 | Train Loss: 6.307 Vali Loss: 69.335 Vali Acc: 0.440 Test Loss: 69.335 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.4254777431488037
Epoch: 26, Steps: 13 | Train Loss: 6.031 Vali Loss: 77.746 Vali Acc: 0.480 Test Loss: 77.746 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.3594717979431152
Epoch: 27, Steps: 13 | Train Loss: 6.779 Vali Loss: 61.584 Vali Acc: 0.360 Test Loss: 61.584 Test Acc: 0.360
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.508596420288086
Epoch: 28, Steps: 13 | Train Loss: 2.072 Vali Loss: 56.628 Vali Acc: 0.460 Test Loss: 56.628 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.1497809886932373
Epoch: 29, Steps: 13 | Train Loss: 1.165 Vali Loss: 51.883 Vali Acc: 0.540 Test Loss: 51.883 Test Acc: 0.540
Validation loss decreased (-0.499392 --> -0.539481).  Saving model ...
Epoch: 30 cost time: 2.208763837814331
Epoch: 30, Steps: 13 | Train Loss: 2.539 Vali Loss: 51.742 Vali Acc: 0.560 Test Loss: 51.742 Test Acc: 0.560
Validation loss decreased (-0.539481 --> -0.559483).  Saving model ...
Epoch: 31 cost time: 2.4654030799865723
Epoch: 31, Steps: 13 | Train Loss: 7.693 Vali Loss: 73.492 Vali Acc: 0.480 Test Loss: 73.492 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.373898983001709
Epoch: 32, Steps: 13 | Train Loss: 1.339 Vali Loss: 57.163 Vali Acc: 0.520 Test Loss: 57.163 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.1678264141082764
Epoch: 33, Steps: 13 | Train Loss: 12.429 Vali Loss: 65.712 Vali Acc: 0.500 Test Loss: 65.712 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.208249807357788
Epoch: 34, Steps: 13 | Train Loss: 0.600 Vali Loss: 86.477 Vali Acc: 0.460 Test Loss: 86.477 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 2.3407676219940186
Epoch: 35, Steps: 13 | Train Loss: 5.605 Vali Loss: 60.008 Vali Acc: 0.460 Test Loss: 60.008 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 2.267127275466919
Epoch: 36, Steps: 13 | Train Loss: 3.287 Vali Loss: 87.654 Vali Acc: 0.420 Test Loss: 87.654 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 2.391901731491089
Epoch: 37, Steps: 13 | Train Loss: 1.900 Vali Loss: 71.506 Vali Acc: 0.540 Test Loss: 71.506 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 2.1713778972625732
Epoch: 38, Steps: 13 | Train Loss: 1.206 Vali Loss: 82.985 Vali Acc: 0.440 Test Loss: 82.985 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 2.2566447257995605
Epoch: 39, Steps: 13 | Train Loss: 1.515 Vali Loss: 68.980 Vali Acc: 0.460 Test Loss: 68.980 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 2.476588726043701
Epoch: 40, Steps: 13 | Train Loss: 1.823 Vali Loss: 89.101 Vali Acc: 0.500 Test Loss: 89.101 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 3704361
model size : 14.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.309218883514404
Epoch: 1, Steps: 13 | Train Loss: 5.885 Vali Loss: 6.125 Vali Acc: 0.240 Test Loss: 6.125 Test Acc: 0.240
Validation loss decreased (inf --> -0.239939).  Saving model ...
Epoch: 2 cost time: 2.075273275375366
Epoch: 2, Steps: 13 | Train Loss: 11.434 Vali Loss: 5.142 Vali Acc: 0.240 Test Loss: 5.142 Test Acc: 0.240
Validation loss decreased (-0.239939 --> -0.239949).  Saving model ...
Epoch: 3 cost time: 1.9587392807006836
Epoch: 3, Steps: 13 | Train Loss: 9.154 Vali Loss: 14.918 Vali Acc: 0.340 Test Loss: 14.918 Test Acc: 0.340
Validation loss decreased (-0.239949 --> -0.339851).  Saving model ...
Epoch: 4 cost time: 2.010739803314209
Epoch: 4, Steps: 13 | Train Loss: 14.100 Vali Loss: 49.508 Vali Acc: 0.200 Test Loss: 49.508 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.1770989894866943
Epoch: 5, Steps: 13 | Train Loss: 25.791 Vali Loss: 38.914 Vali Acc: 0.240 Test Loss: 38.914 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.133725881576538
Epoch: 6, Steps: 13 | Train Loss: 15.594 Vali Loss: 11.794 Vali Acc: 0.300 Test Loss: 11.794 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.1892001628875732
Epoch: 7, Steps: 13 | Train Loss: 8.018 Vali Loss: 18.513 Vali Acc: 0.400 Test Loss: 18.513 Test Acc: 0.400
Validation loss decreased (-0.339851 --> -0.399815).  Saving model ...
Epoch: 8 cost time: 1.9638593196868896
Epoch: 8, Steps: 13 | Train Loss: 14.903 Vali Loss: 27.527 Vali Acc: 0.320 Test Loss: 27.527 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.2948431968688965
Epoch: 9, Steps: 13 | Train Loss: 7.153 Vali Loss: 32.500 Vali Acc: 0.240 Test Loss: 32.500 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.1086323261260986
Epoch: 10, Steps: 13 | Train Loss: 16.189 Vali Loss: 43.895 Vali Acc: 0.320 Test Loss: 43.895 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.1800198554992676
Epoch: 11, Steps: 13 | Train Loss: 19.992 Vali Loss: 28.745 Vali Acc: 0.340 Test Loss: 28.745 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.2947380542755127
Epoch: 12, Steps: 13 | Train Loss: 10.699 Vali Loss: 26.612 Vali Acc: 0.440 Test Loss: 26.612 Test Acc: 0.440
Validation loss decreased (-0.399815 --> -0.439734).  Saving model ...
Epoch: 13 cost time: 2.1910953521728516
Epoch: 13, Steps: 13 | Train Loss: 7.650 Vali Loss: 23.560 Vali Acc: 0.460 Test Loss: 23.560 Test Acc: 0.460
Validation loss decreased (-0.439734 --> -0.459764).  Saving model ...
Epoch: 14 cost time: 1.9740099906921387
Epoch: 14, Steps: 13 | Train Loss: 15.084 Vali Loss: 37.037 Vali Acc: 0.400 Test Loss: 37.037 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.0798277854919434
Epoch: 15, Steps: 13 | Train Loss: 6.958 Vali Loss: 49.157 Vali Acc: 0.380 Test Loss: 49.157 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.110065460205078
Epoch: 16, Steps: 13 | Train Loss: 4.890 Vali Loss: 43.775 Vali Acc: 0.420 Test Loss: 43.775 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.0254688262939453
Epoch: 17, Steps: 13 | Train Loss: 12.178 Vali Loss: 49.841 Vali Acc: 0.460 Test Loss: 49.841 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.3378703594207764
Epoch: 18, Steps: 13 | Train Loss: 5.519 Vali Loss: 37.515 Vali Acc: 0.440 Test Loss: 37.515 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.267216682434082
Epoch: 19, Steps: 13 | Train Loss: 7.494 Vali Loss: 50.007 Vali Acc: 0.500 Test Loss: 50.007 Test Acc: 0.500
Validation loss decreased (-0.459764 --> -0.499500).  Saving model ...
Epoch: 20 cost time: 1.9226393699645996
Epoch: 20, Steps: 13 | Train Loss: 11.566 Vali Loss: 73.462 Vali Acc: 0.420 Test Loss: 73.462 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.3993606567382812
Epoch: 21, Steps: 13 | Train Loss: 15.425 Vali Loss: 74.268 Vali Acc: 0.420 Test Loss: 74.268 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.3731417655944824
Epoch: 22, Steps: 13 | Train Loss: 9.023 Vali Loss: 68.486 Vali Acc: 0.520 Test Loss: 68.486 Test Acc: 0.520
Validation loss decreased (-0.499500 --> -0.519315).  Saving model ...
Epoch: 23 cost time: 2.0312421321868896
Epoch: 23, Steps: 13 | Train Loss: 8.767 Vali Loss: 50.606 Vali Acc: 0.460 Test Loss: 50.606 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.084630250930786
Epoch: 24, Steps: 13 | Train Loss: 4.468 Vali Loss: 38.645 Vali Acc: 0.560 Test Loss: 38.645 Test Acc: 0.560
Validation loss decreased (-0.519315 --> -0.559614).  Saving model ...
Epoch: 25 cost time: 2.0228426456451416
Epoch: 25, Steps: 13 | Train Loss: 2.266 Vali Loss: 86.531 Vali Acc: 0.460 Test Loss: 86.531 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.3518152236938477
Epoch: 26, Steps: 13 | Train Loss: 4.235 Vali Loss: 50.384 Vali Acc: 0.460 Test Loss: 50.384 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.8848609924316406
Epoch: 27, Steps: 13 | Train Loss: 2.952 Vali Loss: 45.511 Vali Acc: 0.560 Test Loss: 45.511 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.9563016891479492
Epoch: 28, Steps: 13 | Train Loss: 1.863 Vali Loss: 42.094 Vali Acc: 0.480 Test Loss: 42.094 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.1221187114715576
Epoch: 29, Steps: 13 | Train Loss: 1.459 Vali Loss: 49.244 Vali Acc: 0.520 Test Loss: 49.244 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.1863486766815186
Epoch: 30, Steps: 13 | Train Loss: 0.739 Vali Loss: 72.432 Vali Acc: 0.480 Test Loss: 72.432 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.9430134296417236
Epoch: 31, Steps: 13 | Train Loss: 4.852 Vali Loss: 66.081 Vali Acc: 0.420 Test Loss: 66.081 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.9326884746551514
Epoch: 32, Steps: 13 | Train Loss: 2.041 Vali Loss: 86.351 Vali Acc: 0.420 Test Loss: 86.351 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.284870147705078
Epoch: 33, Steps: 13 | Train Loss: 2.658 Vali Loss: 122.864 Vali Acc: 0.300 Test Loss: 122.864 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.0577821731567383
Epoch: 34, Steps: 13 | Train Loss: 5.841 Vali Loss: 112.366 Vali Acc: 0.440 Test Loss: 112.366 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 3703241
model size : 14.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 6.360138177871704
Epoch: 1, Steps: 13 | Train Loss: 47.520 Vali Loss: 145.738 Vali Acc: 0.300 Test Loss: 145.738 Test Acc: 0.300
Validation loss decreased (inf --> -0.298543).  Saving model ...
Epoch: 2 cost time: 4.593041658401489
Epoch: 2, Steps: 13 | Train Loss: 119.857 Vali Loss: 219.074 Vali Acc: 0.220 Test Loss: 219.074 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.546871662139893
Epoch: 3, Steps: 13 | Train Loss: 132.568 Vali Loss: 173.978 Vali Acc: 0.220 Test Loss: 173.978 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.526441335678101
Epoch: 4, Steps: 13 | Train Loss: 212.148 Vali Loss: 119.241 Vali Acc: 0.380 Test Loss: 119.241 Test Acc: 0.380
Validation loss decreased (-0.298543 --> -0.378808).  Saving model ...
Epoch: 5 cost time: 4.49269962310791
Epoch: 5, Steps: 13 | Train Loss: 77.309 Vali Loss: 283.242 Vali Acc: 0.380 Test Loss: 283.242 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.4864490032196045
Epoch: 6, Steps: 13 | Train Loss: 110.537 Vali Loss: 248.516 Vali Acc: 0.340 Test Loss: 248.516 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.486060380935669
Epoch: 7, Steps: 13 | Train Loss: 208.344 Vali Loss: 291.540 Vali Acc: 0.440 Test Loss: 291.540 Test Acc: 0.440
Validation loss decreased (-0.378808 --> -0.437085).  Saving model ...
Epoch: 8 cost time: 4.439314126968384
Epoch: 8, Steps: 13 | Train Loss: 118.706 Vali Loss: 392.572 Vali Acc: 0.440 Test Loss: 392.572 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.499907732009888
Epoch: 9, Steps: 13 | Train Loss: 154.947 Vali Loss: 504.194 Vali Acc: 0.380 Test Loss: 504.194 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.466330289840698
Epoch: 10, Steps: 13 | Train Loss: 198.150 Vali Loss: 381.707 Vali Acc: 0.460 Test Loss: 381.707 Test Acc: 0.460
Validation loss decreased (-0.437085 --> -0.456183).  Saving model ...
Epoch: 11 cost time: 4.421751499176025
Epoch: 11, Steps: 13 | Train Loss: 182.476 Vali Loss: 326.084 Vali Acc: 0.420 Test Loss: 326.084 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.592292547225952
Epoch: 12, Steps: 13 | Train Loss: 66.714 Vali Loss: 593.750 Vali Acc: 0.420 Test Loss: 593.750 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.556879758834839
Epoch: 13, Steps: 13 | Train Loss: 93.523 Vali Loss: 470.166 Vali Acc: 0.520 Test Loss: 470.166 Test Acc: 0.520
Validation loss decreased (-0.456183 --> -0.515298).  Saving model ...
Epoch: 14 cost time: 4.502405166625977
Epoch: 14, Steps: 13 | Train Loss: 58.246 Vali Loss: 438.654 Vali Acc: 0.440 Test Loss: 438.654 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.517820596694946
Epoch: 15, Steps: 13 | Train Loss: 32.044 Vali Loss: 284.240 Vali Acc: 0.600 Test Loss: 284.240 Test Acc: 0.600
Validation loss decreased (-0.515298 --> -0.597158).  Saving model ...
Epoch: 16 cost time: 4.449997425079346
Epoch: 16, Steps: 13 | Train Loss: 15.060 Vali Loss: 374.160 Vali Acc: 0.540 Test Loss: 374.160 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.480080604553223
Epoch: 17, Steps: 13 | Train Loss: 47.609 Vali Loss: 403.508 Vali Acc: 0.500 Test Loss: 403.508 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.382262706756592
Epoch: 18, Steps: 13 | Train Loss: 42.464 Vali Loss: 565.733 Vali Acc: 0.460 Test Loss: 565.733 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.488813161849976
Epoch: 19, Steps: 13 | Train Loss: 33.930 Vali Loss: 817.566 Vali Acc: 0.420 Test Loss: 817.566 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.374871730804443
Epoch: 20, Steps: 13 | Train Loss: 51.825 Vali Loss: 522.264 Vali Acc: 0.500 Test Loss: 522.264 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.468969106674194
Epoch: 21, Steps: 13 | Train Loss: 28.279 Vali Loss: 621.846 Vali Acc: 0.540 Test Loss: 621.846 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.567539215087891
Epoch: 22, Steps: 13 | Train Loss: 18.461 Vali Loss: 593.984 Vali Acc: 0.460 Test Loss: 593.984 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 4.541356086730957
Epoch: 23, Steps: 13 | Train Loss: 3.498 Vali Loss: 578.760 Vali Acc: 0.480 Test Loss: 578.760 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.547761917114258
Epoch: 24, Steps: 13 | Train Loss: 5.398 Vali Loss: 592.403 Vali Acc: 0.440 Test Loss: 592.403 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 4.533939599990845
Epoch: 25, Steps: 13 | Train Loss: 38.222 Vali Loss: 372.074 Vali Acc: 0.520 Test Loss: 372.074 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 52293149
model size : 204.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 6.175837755203247
Epoch: 1, Steps: 13 | Train Loss: 66.431 Vali Loss: 156.761 Vali Acc: 0.200 Test Loss: 156.761 Test Acc: 0.200
Validation loss decreased (inf --> -0.198432).  Saving model ...
Epoch: 2 cost time: 4.522964239120483
Epoch: 2, Steps: 13 | Train Loss: 112.919 Vali Loss: 102.243 Vali Acc: 0.320 Test Loss: 102.243 Test Acc: 0.320
Validation loss decreased (-0.198432 --> -0.318978).  Saving model ...
Epoch: 3 cost time: 4.582229852676392
Epoch: 3, Steps: 13 | Train Loss: 158.663 Vali Loss: 378.901 Vali Acc: 0.260 Test Loss: 378.901 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.485538721084595
Epoch: 4, Steps: 13 | Train Loss: 300.408 Vali Loss: 224.467 Vali Acc: 0.260 Test Loss: 224.467 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.567850112915039
Epoch: 5, Steps: 13 | Train Loss: 147.819 Vali Loss: 399.501 Vali Acc: 0.200 Test Loss: 399.501 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.437852621078491
Epoch: 6, Steps: 13 | Train Loss: 190.004 Vali Loss: 174.026 Vali Acc: 0.400 Test Loss: 174.026 Test Acc: 0.400
Validation loss decreased (-0.318978 --> -0.398260).  Saving model ...
Epoch: 7 cost time: 4.491426706314087
Epoch: 7, Steps: 13 | Train Loss: 97.856 Vali Loss: 275.821 Vali Acc: 0.360 Test Loss: 275.821 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.697043180465698
Epoch: 8, Steps: 13 | Train Loss: 94.192 Vali Loss: 653.635 Vali Acc: 0.260 Test Loss: 653.635 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.630136966705322
Epoch: 9, Steps: 13 | Train Loss: 288.474 Vali Loss: 484.149 Vali Acc: 0.480 Test Loss: 484.149 Test Acc: 0.480
Validation loss decreased (-0.398260 --> -0.475159).  Saving model ...
Epoch: 10 cost time: 4.624430894851685
Epoch: 10, Steps: 13 | Train Loss: 234.510 Vali Loss: 498.348 Vali Acc: 0.360 Test Loss: 498.348 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.661872863769531
Epoch: 11, Steps: 13 | Train Loss: 215.374 Vali Loss: 339.548 Vali Acc: 0.540 Test Loss: 339.548 Test Acc: 0.540
Validation loss decreased (-0.475159 --> -0.536605).  Saving model ...
Epoch: 12 cost time: 4.684145212173462
Epoch: 12, Steps: 13 | Train Loss: 123.131 Vali Loss: 317.097 Vali Acc: 0.640 Test Loss: 317.097 Test Acc: 0.640
Validation loss decreased (-0.536605 --> -0.636829).  Saving model ...
Epoch: 13 cost time: 4.644450664520264
Epoch: 13, Steps: 13 | Train Loss: 122.948 Vali Loss: 248.945 Vali Acc: 0.660 Test Loss: 248.945 Test Acc: 0.660
Validation loss decreased (-0.636829 --> -0.657511).  Saving model ...
Epoch: 14 cost time: 4.691789150238037
Epoch: 14, Steps: 13 | Train Loss: 21.323 Vali Loss: 537.231 Vali Acc: 0.520 Test Loss: 537.231 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.610192537307739
Epoch: 15, Steps: 13 | Train Loss: 79.153 Vali Loss: 670.384 Vali Acc: 0.560 Test Loss: 670.384 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.534785985946655
Epoch: 16, Steps: 13 | Train Loss: 102.120 Vali Loss: 617.468 Vali Acc: 0.580 Test Loss: 617.468 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.789271593093872
Epoch: 17, Steps: 13 | Train Loss: 87.417 Vali Loss: 463.172 Vali Acc: 0.640 Test Loss: 463.172 Test Acc: 0.640
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.425057411193848
Epoch: 18, Steps: 13 | Train Loss: 43.198 Vali Loss: 342.469 Vali Acc: 0.620 Test Loss: 342.469 Test Acc: 0.620
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.7339866161346436
Epoch: 19, Steps: 13 | Train Loss: 73.155 Vali Loss: 793.819 Vali Acc: 0.500 Test Loss: 793.819 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.617079257965088
Epoch: 20, Steps: 13 | Train Loss: 81.073 Vali Loss: 693.588 Vali Acc: 0.500 Test Loss: 693.588 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 4.6469175815582275
Epoch: 21, Steps: 13 | Train Loss: 160.393 Vali Loss: 468.417 Vali Acc: 0.540 Test Loss: 468.417 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.681201219558716
Epoch: 22, Steps: 13 | Train Loss: 214.195 Vali Loss: 1146.733 Vali Acc: 0.440 Test Loss: 1146.733 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.710712671279907
Epoch: 23, Steps: 13 | Train Loss: 123.082 Vali Loss: 913.160 Vali Acc: 0.500 Test Loss: 913.160 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.66
model parameter : 52287261
model size : 204.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 6.0978944301605225
Epoch: 1, Steps: 13 | Train Loss: 67.360 Vali Loss: 128.174 Vali Acc: 0.200 Test Loss: 128.174 Test Acc: 0.200
Validation loss decreased (inf --> -0.198718).  Saving model ...
Epoch: 2 cost time: 4.500535011291504
Epoch: 2, Steps: 13 | Train Loss: 178.687 Vali Loss: 355.807 Vali Acc: 0.220 Test Loss: 355.807 Test Acc: 0.220
Validation loss decreased (-0.198718 --> -0.216442).  Saving model ...
Epoch: 3 cost time: 4.834803819656372
Epoch: 3, Steps: 13 | Train Loss: 223.691 Vali Loss: 226.467 Vali Acc: 0.340 Test Loss: 226.467 Test Acc: 0.340
Validation loss decreased (-0.216442 --> -0.337735).  Saving model ...
Epoch: 4 cost time: 5.016207456588745
Epoch: 4, Steps: 13 | Train Loss: 244.057 Vali Loss: 398.554 Vali Acc: 0.220 Test Loss: 398.554 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.667848587036133
Epoch: 5, Steps: 13 | Train Loss: 203.558 Vali Loss: 240.346 Vali Acc: 0.260 Test Loss: 240.346 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.8034913539886475
Epoch: 6, Steps: 13 | Train Loss: 117.030 Vali Loss: 475.868 Vali Acc: 0.200 Test Loss: 475.868 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.609439134597778
Epoch: 7, Steps: 13 | Train Loss: 216.933 Vali Loss: 359.673 Vali Acc: 0.320 Test Loss: 359.673 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.8788299560546875
Epoch: 8, Steps: 13 | Train Loss: 244.008 Vali Loss: 507.341 Vali Acc: 0.280 Test Loss: 507.341 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.717968463897705
Epoch: 9, Steps: 13 | Train Loss: 175.735 Vali Loss: 284.265 Vali Acc: 0.440 Test Loss: 284.265 Test Acc: 0.440
Validation loss decreased (-0.337735 --> -0.437157).  Saving model ...
Epoch: 10 cost time: 4.7076311111450195
Epoch: 10, Steps: 13 | Train Loss: 110.233 Vali Loss: 390.926 Vali Acc: 0.440 Test Loss: 390.926 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.834206819534302
Epoch: 11, Steps: 13 | Train Loss: 123.823 Vali Loss: 210.168 Vali Acc: 0.560 Test Loss: 210.168 Test Acc: 0.560
Validation loss decreased (-0.437157 --> -0.557898).  Saving model ...
Epoch: 12 cost time: 4.737368822097778
Epoch: 12, Steps: 13 | Train Loss: 110.466 Vali Loss: 291.522 Vali Acc: 0.500 Test Loss: 291.522 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.6596598625183105
Epoch: 13, Steps: 13 | Train Loss: 56.849 Vali Loss: 360.808 Vali Acc: 0.600 Test Loss: 360.808 Test Acc: 0.600
Validation loss decreased (-0.557898 --> -0.596392).  Saving model ...
Epoch: 14 cost time: 4.9944353103637695
Epoch: 14, Steps: 13 | Train Loss: 182.902 Vali Loss: 378.186 Vali Acc: 0.420 Test Loss: 378.186 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.780990123748779
Epoch: 15, Steps: 13 | Train Loss: 69.930 Vali Loss: 529.910 Vali Acc: 0.520 Test Loss: 529.910 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.997897148132324
Epoch: 16, Steps: 13 | Train Loss: 57.020 Vali Loss: 361.713 Vali Acc: 0.600 Test Loss: 361.713 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.857184886932373
Epoch: 17, Steps: 13 | Train Loss: 104.344 Vali Loss: 1080.781 Vali Acc: 0.380 Test Loss: 1080.781 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.944419622421265
Epoch: 18, Steps: 13 | Train Loss: 253.928 Vali Loss: 559.810 Vali Acc: 0.600 Test Loss: 559.810 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.857346057891846
Epoch: 19, Steps: 13 | Train Loss: 36.952 Vali Loss: 669.729 Vali Acc: 0.480 Test Loss: 669.729 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 5.1533684730529785
Epoch: 20, Steps: 13 | Train Loss: 218.411 Vali Loss: 293.047 Vali Acc: 0.540 Test Loss: 293.047 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 4.736177682876587
Epoch: 21, Steps: 13 | Train Loss: 253.265 Vali Loss: 470.595 Vali Acc: 0.580 Test Loss: 470.595 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.940399646759033
Epoch: 22, Steps: 13 | Train Loss: 46.574 Vali Loss: 360.655 Vali Acc: 0.660 Test Loss: 360.655 Test Acc: 0.660
Validation loss decreased (-0.596392 --> -0.656393).  Saving model ...
Epoch: 23 cost time: 4.899919748306274
Epoch: 23, Steps: 13 | Train Loss: 15.800 Vali Loss: 497.018 Vali Acc: 0.480 Test Loss: 497.018 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.811152696609497
Epoch: 24, Steps: 13 | Train Loss: 34.124 Vali Loss: 588.916 Vali Acc: 0.520 Test Loss: 588.916 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.6118409633636475
Epoch: 25, Steps: 13 | Train Loss: 10.635 Vali Loss: 698.952 Vali Acc: 0.540 Test Loss: 698.952 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 4.913114547729492
Epoch: 26, Steps: 13 | Train Loss: 4.459 Vali Loss: 564.729 Vali Acc: 0.500 Test Loss: 564.729 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 4.657712936401367
Epoch: 27, Steps: 13 | Train Loss: 21.724 Vali Loss: 787.305 Vali Acc: 0.420 Test Loss: 787.305 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 4.806413412094116
Epoch: 28, Steps: 13 | Train Loss: 24.651 Vali Loss: 579.540 Vali Acc: 0.600 Test Loss: 579.540 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 4.701292514801025
Epoch: 29, Steps: 13 | Train Loss: 0.000 Vali Loss: 574.011 Vali Acc: 0.660 Test Loss: 574.011 Test Acc: 0.660
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 4.698046445846558
Epoch: 30, Steps: 13 | Train Loss: 0.000 Vali Loss: 574.814 Vali Acc: 0.660 Test Loss: 574.814 Test Acc: 0.660
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 4.968498468399048
Epoch: 31, Steps: 13 | Train Loss: 0.000 Vali Loss: 575.314 Vali Acc: 0.660 Test Loss: 575.314 Test Acc: 0.660
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 4.901438474655151
Epoch: 32, Steps: 13 | Train Loss: 0.000 Vali Loss: 575.436 Vali Acc: 0.660 Test Loss: 575.436 Test Acc: 0.660
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.66
model parameter : 52281373
model size : 204.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 6.351778268814087
Epoch: 1, Steps: 13 | Train Loss: 61.976 Vali Loss: 193.479 Vali Acc: 0.200 Test Loss: 193.479 Test Acc: 0.200
Validation loss decreased (inf --> -0.198065).  Saving model ...
Epoch: 2 cost time: 4.529739141464233
Epoch: 2, Steps: 13 | Train Loss: 190.321 Vali Loss: 172.334 Vali Acc: 0.260 Test Loss: 172.334 Test Acc: 0.260
Validation loss decreased (-0.198065 --> -0.258277).  Saving model ...
Epoch: 3 cost time: 4.331531524658203
Epoch: 3, Steps: 13 | Train Loss: 131.562 Vali Loss: 140.334 Vali Acc: 0.220 Test Loss: 140.334 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.541320085525513
Epoch: 4, Steps: 13 | Train Loss: 138.353 Vali Loss: 149.080 Vali Acc: 0.300 Test Loss: 149.080 Test Acc: 0.300
Validation loss decreased (-0.258277 --> -0.298509).  Saving model ...
Epoch: 5 cost time: 4.56099534034729
Epoch: 5, Steps: 13 | Train Loss: 217.876 Vali Loss: 276.827 Vali Acc: 0.260 Test Loss: 276.827 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.757183074951172
Epoch: 6, Steps: 13 | Train Loss: 106.236 Vali Loss: 311.712 Vali Acc: 0.340 Test Loss: 311.712 Test Acc: 0.340
Validation loss decreased (-0.298509 --> -0.336883).  Saving model ...
Epoch: 7 cost time: 4.4975903034210205
Epoch: 7, Steps: 13 | Train Loss: 109.139 Vali Loss: 245.544 Vali Acc: 0.400 Test Loss: 245.544 Test Acc: 0.400
Validation loss decreased (-0.336883 --> -0.397545).  Saving model ...
Epoch: 8 cost time: 4.687939405441284
Epoch: 8, Steps: 13 | Train Loss: 122.062 Vali Loss: 390.222 Vali Acc: 0.420 Test Loss: 390.222 Test Acc: 0.420
Validation loss decreased (-0.397545 --> -0.416098).  Saving model ...
Epoch: 9 cost time: 4.67241096496582
Epoch: 9, Steps: 13 | Train Loss: 214.522 Vali Loss: 315.466 Vali Acc: 0.540 Test Loss: 315.466 Test Acc: 0.540
Validation loss decreased (-0.416098 --> -0.536845).  Saving model ...
Epoch: 10 cost time: 4.725818157196045
Epoch: 10, Steps: 13 | Train Loss: 168.168 Vali Loss: 454.545 Vali Acc: 0.480 Test Loss: 454.545 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.8522303104400635
Epoch: 11, Steps: 13 | Train Loss: 120.477 Vali Loss: 255.602 Vali Acc: 0.560 Test Loss: 255.602 Test Acc: 0.560
Validation loss decreased (-0.536845 --> -0.557444).  Saving model ...
Epoch: 12 cost time: 4.718311309814453
Epoch: 12, Steps: 13 | Train Loss: 48.515 Vali Loss: 463.964 Vali Acc: 0.500 Test Loss: 463.964 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.714474201202393
Epoch: 13, Steps: 13 | Train Loss: 90.596 Vali Loss: 492.042 Vali Acc: 0.500 Test Loss: 492.042 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.503728866577148
Epoch: 14, Steps: 13 | Train Loss: 70.306 Vali Loss: 378.401 Vali Acc: 0.500 Test Loss: 378.401 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.651743650436401
Epoch: 15, Steps: 13 | Train Loss: 67.325 Vali Loss: 412.672 Vali Acc: 0.420 Test Loss: 412.672 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.540483713150024
Epoch: 16, Steps: 13 | Train Loss: 20.143 Vali Loss: 442.607 Vali Acc: 0.460 Test Loss: 442.607 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.521164417266846
Epoch: 17, Steps: 13 | Train Loss: 78.048 Vali Loss: 987.883 Vali Acc: 0.440 Test Loss: 987.883 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.039514780044556
Epoch: 18, Steps: 13 | Train Loss: 166.457 Vali Loss: 728.437 Vali Acc: 0.420 Test Loss: 728.437 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.849233150482178
Epoch: 19, Steps: 13 | Train Loss: 96.795 Vali Loss: 542.745 Vali Acc: 0.640 Test Loss: 542.745 Test Acc: 0.640
Validation loss decreased (-0.557444 --> -0.634573).  Saving model ...
Epoch: 20 cost time: 4.891678094863892
Epoch: 20, Steps: 13 | Train Loss: 68.951 Vali Loss: 400.076 Vali Acc: 0.680 Test Loss: 400.076 Test Acc: 0.680
Validation loss decreased (-0.634573 --> -0.675999).  Saving model ...
Epoch: 21 cost time: 4.621392488479614
Epoch: 21, Steps: 13 | Train Loss: 0.000 Vali Loss: 730.565 Vali Acc: 0.520 Test Loss: 730.565 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.792680740356445
Epoch: 22, Steps: 13 | Train Loss: 19.970 Vali Loss: 713.979 Vali Acc: 0.500 Test Loss: 713.979 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.6892924308776855
Epoch: 23, Steps: 13 | Train Loss: 7.965 Vali Loss: 564.316 Vali Acc: 0.560 Test Loss: 564.316 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.757389068603516
Epoch: 24, Steps: 13 | Train Loss: 5.149 Vali Loss: 657.913 Vali Acc: 0.420 Test Loss: 657.913 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 4.598498821258545
Epoch: 25, Steps: 13 | Train Loss: 24.638 Vali Loss: 932.925 Vali Acc: 0.520 Test Loss: 932.925 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.527415037155151
Epoch: 26, Steps: 13 | Train Loss: 71.342 Vali Loss: 1108.890 Vali Acc: 0.540 Test Loss: 1108.890 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 4.743376016616821
Epoch: 27, Steps: 13 | Train Loss: 50.855 Vali Loss: 667.347 Vali Acc: 0.600 Test Loss: 667.347 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 4.776007175445557
Epoch: 28, Steps: 13 | Train Loss: 17.541 Vali Loss: 591.393 Vali Acc: 0.560 Test Loss: 591.393 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 4.622854232788086
Epoch: 29, Steps: 13 | Train Loss: 0.000 Vali Loss: 808.787 Vali Acc: 0.480 Test Loss: 808.787 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 4.739991188049316
Epoch: 30, Steps: 13 | Train Loss: 92.735 Vali Loss: 735.872 Vali Acc: 0.520 Test Loss: 735.872 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.68
model parameter : 52275485
model size : 204.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.521036624908447
Epoch: 1, Steps: 13 | Train Loss: 68.787 Vali Loss: 129.672 Vali Acc: 0.200 Test Loss: 129.672 Test Acc: 0.200
Validation loss decreased (inf --> -0.198703).  Saving model ...
Epoch: 2 cost time: 4.355970144271851
Epoch: 2, Steps: 13 | Train Loss: 127.995 Vali Loss: 199.606 Vali Acc: 0.200 Test Loss: 199.606 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.195674657821655
Epoch: 3, Steps: 13 | Train Loss: 112.205 Vali Loss: 119.014 Vali Acc: 0.240 Test Loss: 119.014 Test Acc: 0.240
Validation loss decreased (-0.198703 --> -0.238810).  Saving model ...
Epoch: 4 cost time: 4.091050386428833
Epoch: 4, Steps: 13 | Train Loss: 51.030 Vali Loss: 175.855 Vali Acc: 0.400 Test Loss: 175.855 Test Acc: 0.400
Validation loss decreased (-0.238810 --> -0.398241).  Saving model ...
Epoch: 5 cost time: 4.1260085105896
Epoch: 5, Steps: 13 | Train Loss: 143.688 Vali Loss: 299.242 Vali Acc: 0.380 Test Loss: 299.242 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.151113986968994
Epoch: 6, Steps: 13 | Train Loss: 125.546 Vali Loss: 317.202 Vali Acc: 0.280 Test Loss: 317.202 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.11116623878479
Epoch: 7, Steps: 13 | Train Loss: 202.211 Vali Loss: 433.645 Vali Acc: 0.360 Test Loss: 433.645 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.1233532428741455
Epoch: 8, Steps: 13 | Train Loss: 360.862 Vali Loss: 558.080 Vali Acc: 0.320 Test Loss: 558.080 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.232415199279785
Epoch: 9, Steps: 13 | Train Loss: 240.858 Vali Loss: 415.435 Vali Acc: 0.520 Test Loss: 415.435 Test Acc: 0.520
Validation loss decreased (-0.398241 --> -0.515846).  Saving model ...
Epoch: 10 cost time: 4.21848464012146
Epoch: 10, Steps: 13 | Train Loss: 149.592 Vali Loss: 591.979 Vali Acc: 0.480 Test Loss: 591.979 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.1299684047698975
Epoch: 11, Steps: 13 | Train Loss: 166.270 Vali Loss: 601.226 Vali Acc: 0.560 Test Loss: 601.226 Test Acc: 0.560
Validation loss decreased (-0.515846 --> -0.553988).  Saving model ...
Epoch: 12 cost time: 4.357961177825928
Epoch: 12, Steps: 13 | Train Loss: 178.007 Vali Loss: 627.445 Vali Acc: 0.480 Test Loss: 627.445 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.3416428565979
Epoch: 13, Steps: 13 | Train Loss: 227.905 Vali Loss: 429.387 Vali Acc: 0.520 Test Loss: 429.387 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.1943519115448
Epoch: 14, Steps: 13 | Train Loss: 141.428 Vali Loss: 752.996 Vali Acc: 0.420 Test Loss: 752.996 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.3419740200042725
Epoch: 15, Steps: 13 | Train Loss: 60.210 Vali Loss: 735.368 Vali Acc: 0.500 Test Loss: 735.368 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.156668186187744
Epoch: 16, Steps: 13 | Train Loss: 94.938 Vali Loss: 522.055 Vali Acc: 0.480 Test Loss: 522.055 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.393571615219116
Epoch: 17, Steps: 13 | Train Loss: 40.426 Vali Loss: 373.291 Vali Acc: 0.580 Test Loss: 373.291 Test Acc: 0.580
Validation loss decreased (-0.553988 --> -0.576267).  Saving model ...
Epoch: 18 cost time: 4.189621686935425
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 500.557 Vali Acc: 0.540 Test Loss: 500.557 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.206723213195801
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 559.520 Vali Acc: 0.500 Test Loss: 559.520 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.1927502155303955
Epoch: 20, Steps: 13 | Train Loss: 3.585 Vali Loss: 510.601 Vali Acc: 0.560 Test Loss: 510.601 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.1445839405059814
Epoch: 21, Steps: 13 | Train Loss: 46.988 Vali Loss: 605.472 Vali Acc: 0.500 Test Loss: 605.472 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.267160177230835
Epoch: 22, Steps: 13 | Train Loss: 40.348 Vali Loss: 501.394 Vali Acc: 0.560 Test Loss: 501.394 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.275238037109375
Epoch: 23, Steps: 13 | Train Loss: 40.840 Vali Loss: 515.551 Vali Acc: 0.560 Test Loss: 515.551 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 4.34282922744751
Epoch: 24, Steps: 13 | Train Loss: 19.758 Vali Loss: 687.103 Vali Acc: 0.500 Test Loss: 687.103 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 4.27591347694397
Epoch: 25, Steps: 13 | Train Loss: 0.638 Vali Loss: 822.039 Vali Acc: 0.480 Test Loss: 822.039 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 4.351933717727661
Epoch: 26, Steps: 13 | Train Loss: 33.844 Vali Loss: 568.397 Vali Acc: 0.540 Test Loss: 568.397 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 4.148629665374756
Epoch: 27, Steps: 13 | Train Loss: 0.000 Vali Loss: 708.540 Vali Acc: 0.520 Test Loss: 708.540 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 51505181
model size : 201.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 6.070810317993164
Epoch: 1, Steps: 13 | Train Loss: 63.480 Vali Loss: 58.815 Vali Acc: 0.200 Test Loss: 58.815 Test Acc: 0.200
Validation loss decreased (inf --> -0.199412).  Saving model ...
Epoch: 2 cost time: 4.103267431259155
Epoch: 2, Steps: 13 | Train Loss: 166.627 Vali Loss: 251.585 Vali Acc: 0.240 Test Loss: 251.585 Test Acc: 0.240
Validation loss decreased (-0.199412 --> -0.237484).  Saving model ...
Epoch: 3 cost time: 4.196949243545532
Epoch: 3, Steps: 13 | Train Loss: 191.226 Vali Loss: 147.814 Vali Acc: 0.280 Test Loss: 147.814 Test Acc: 0.280
Validation loss decreased (-0.237484 --> -0.278522).  Saving model ...
Epoch: 4 cost time: 4.084861755371094
Epoch: 4, Steps: 13 | Train Loss: 185.379 Vali Loss: 264.960 Vali Acc: 0.340 Test Loss: 264.960 Test Acc: 0.340
Validation loss decreased (-0.278522 --> -0.337350).  Saving model ...
Epoch: 5 cost time: 4.144583225250244
Epoch: 5, Steps: 13 | Train Loss: 120.469 Vali Loss: 360.026 Vali Acc: 0.320 Test Loss: 360.026 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.211293697357178
Epoch: 6, Steps: 13 | Train Loss: 186.234 Vali Loss: 278.806 Vali Acc: 0.460 Test Loss: 278.806 Test Acc: 0.460
Validation loss decreased (-0.337350 --> -0.457212).  Saving model ...
Epoch: 7 cost time: 4.079120397567749
Epoch: 7, Steps: 13 | Train Loss: 223.681 Vali Loss: 433.798 Vali Acc: 0.440 Test Loss: 433.798 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.263309478759766
Epoch: 8, Steps: 13 | Train Loss: 298.287 Vali Loss: 746.654 Vali Acc: 0.260 Test Loss: 746.654 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.236147403717041
Epoch: 9, Steps: 13 | Train Loss: 233.985 Vali Loss: 393.883 Vali Acc: 0.520 Test Loss: 393.883 Test Acc: 0.520
Validation loss decreased (-0.457212 --> -0.516061).  Saving model ...
Epoch: 10 cost time: 4.171115875244141
Epoch: 10, Steps: 13 | Train Loss: 290.630 Vali Loss: 556.331 Vali Acc: 0.440 Test Loss: 556.331 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.283884286880493
Epoch: 11, Steps: 13 | Train Loss: 172.326 Vali Loss: 406.524 Vali Acc: 0.580 Test Loss: 406.524 Test Acc: 0.580
Validation loss decreased (-0.516061 --> -0.575935).  Saving model ...
Epoch: 12 cost time: 4.101477861404419
Epoch: 12, Steps: 13 | Train Loss: 223.253 Vali Loss: 374.345 Vali Acc: 0.540 Test Loss: 374.345 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.321128845214844
Epoch: 13, Steps: 13 | Train Loss: 77.155 Vali Loss: 697.416 Vali Acc: 0.400 Test Loss: 697.416 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.125039100646973
Epoch: 14, Steps: 13 | Train Loss: 132.261 Vali Loss: 376.676 Vali Acc: 0.560 Test Loss: 376.676 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.456695795059204
Epoch: 15, Steps: 13 | Train Loss: 116.113 Vali Loss: 620.199 Vali Acc: 0.420 Test Loss: 620.199 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.213085651397705
Epoch: 16, Steps: 13 | Train Loss: 217.463 Vali Loss: 628.157 Vali Acc: 0.500 Test Loss: 628.157 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.038222312927246
Epoch: 17, Steps: 13 | Train Loss: 49.701 Vali Loss: 583.119 Vali Acc: 0.580 Test Loss: 583.119 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.190170526504517
Epoch: 18, Steps: 13 | Train Loss: 13.998 Vali Loss: 540.584 Vali Acc: 0.560 Test Loss: 540.584 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.171796560287476
Epoch: 19, Steps: 13 | Train Loss: 47.261 Vali Loss: 560.904 Vali Acc: 0.540 Test Loss: 560.904 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.190157890319824
Epoch: 20, Steps: 13 | Train Loss: 32.240 Vali Loss: 547.972 Vali Acc: 0.540 Test Loss: 547.972 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.138328790664673
Epoch: 21, Steps: 13 | Train Loss: 9.005 Vali Loss: 508.544 Vali Acc: 0.560 Test Loss: 508.544 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 51499293
model size : 201.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.747293472290039
Epoch: 1, Steps: 13 | Train Loss: 40.436 Vali Loss: 118.056 Vali Acc: 0.240 Test Loss: 118.056 Test Acc: 0.240
Validation loss decreased (inf --> -0.238819).  Saving model ...
Epoch: 2 cost time: 4.208788871765137
Epoch: 2, Steps: 13 | Train Loss: 164.973 Vali Loss: 269.126 Vali Acc: 0.160 Test Loss: 269.126 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.284530401229858
Epoch: 3, Steps: 13 | Train Loss: 176.686 Vali Loss: 164.577 Vali Acc: 0.260 Test Loss: 164.577 Test Acc: 0.260
Validation loss decreased (-0.238819 --> -0.258354).  Saving model ...
Epoch: 4 cost time: 4.231483459472656
Epoch: 4, Steps: 13 | Train Loss: 119.931 Vali Loss: 438.501 Vali Acc: 0.220 Test Loss: 438.501 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.128941535949707
Epoch: 5, Steps: 13 | Train Loss: 223.596 Vali Loss: 513.908 Vali Acc: 0.200 Test Loss: 513.908 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.247012376785278
Epoch: 6, Steps: 13 | Train Loss: 197.376 Vali Loss: 179.591 Vali Acc: 0.360 Test Loss: 179.591 Test Acc: 0.360
Validation loss decreased (-0.258354 --> -0.358204).  Saving model ...
Epoch: 7 cost time: 4.201114177703857
Epoch: 7, Steps: 13 | Train Loss: 155.906 Vali Loss: 261.221 Vali Acc: 0.380 Test Loss: 261.221 Test Acc: 0.380
Validation loss decreased (-0.358204 --> -0.377388).  Saving model ...
Epoch: 8 cost time: 4.255112171173096
Epoch: 8, Steps: 13 | Train Loss: 115.532 Vali Loss: 345.153 Vali Acc: 0.520 Test Loss: 345.153 Test Acc: 0.520
Validation loss decreased (-0.377388 --> -0.516548).  Saving model ...
Epoch: 9 cost time: 4.1757988929748535
Epoch: 9, Steps: 13 | Train Loss: 159.417 Vali Loss: 329.163 Vali Acc: 0.480 Test Loss: 329.163 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.149977207183838
Epoch: 10, Steps: 13 | Train Loss: 79.620 Vali Loss: 312.917 Vali Acc: 0.460 Test Loss: 312.917 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.120399475097656
Epoch: 11, Steps: 13 | Train Loss: 124.911 Vali Loss: 434.184 Vali Acc: 0.460 Test Loss: 434.184 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.120447158813477
Epoch: 12, Steps: 13 | Train Loss: 58.482 Vali Loss: 423.047 Vali Acc: 0.520 Test Loss: 423.047 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.405844688415527
Epoch: 13, Steps: 13 | Train Loss: 71.866 Vali Loss: 443.406 Vali Acc: 0.460 Test Loss: 443.406 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.278362512588501
Epoch: 14, Steps: 13 | Train Loss: 62.061 Vali Loss: 654.445 Vali Acc: 0.420 Test Loss: 654.445 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.230294704437256
Epoch: 15, Steps: 13 | Train Loss: 300.145 Vali Loss: 700.176 Vali Acc: 0.480 Test Loss: 700.176 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.265735864639282
Epoch: 16, Steps: 13 | Train Loss: 174.459 Vali Loss: 483.484 Vali Acc: 0.380 Test Loss: 483.484 Test Acc: 0.380
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.382986307144165
Epoch: 17, Steps: 13 | Train Loss: 222.052 Vali Loss: 568.778 Vali Acc: 0.520 Test Loss: 568.778 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.06370210647583
Epoch: 18, Steps: 13 | Train Loss: 10.103 Vali Loss: 632.888 Vali Acc: 0.460 Test Loss: 632.888 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 51493405
model size : 201.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.934708118438721
Epoch: 1, Steps: 13 | Train Loss: 60.080 Vali Loss: 108.066 Vali Acc: 0.220 Test Loss: 108.066 Test Acc: 0.220
Validation loss decreased (inf --> -0.218919).  Saving model ...
Epoch: 2 cost time: 4.318249464035034
Epoch: 2, Steps: 13 | Train Loss: 125.502 Vali Loss: 404.670 Vali Acc: 0.200 Test Loss: 404.670 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.074856281280518
Epoch: 3, Steps: 13 | Train Loss: 165.003 Vali Loss: 220.124 Vali Acc: 0.280 Test Loss: 220.124 Test Acc: 0.280
Validation loss decreased (-0.218919 --> -0.277799).  Saving model ...
Epoch: 4 cost time: 4.30456018447876
Epoch: 4, Steps: 13 | Train Loss: 144.049 Vali Loss: 270.089 Vali Acc: 0.360 Test Loss: 270.089 Test Acc: 0.360
Validation loss decreased (-0.277799 --> -0.357299).  Saving model ...
Epoch: 5 cost time: 4.167043685913086
Epoch: 5, Steps: 13 | Train Loss: 262.483 Vali Loss: 580.060 Vali Acc: 0.200 Test Loss: 580.060 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.11812162399292
Epoch: 6, Steps: 13 | Train Loss: 242.363 Vali Loss: 634.595 Vali Acc: 0.300 Test Loss: 634.595 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.276400327682495
Epoch: 7, Steps: 13 | Train Loss: 396.475 Vali Loss: 365.786 Vali Acc: 0.300 Test Loss: 365.786 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.232854604721069
Epoch: 8, Steps: 13 | Train Loss: 162.544 Vali Loss: 340.520 Vali Acc: 0.500 Test Loss: 340.520 Test Acc: 0.500
Validation loss decreased (-0.357299 --> -0.496595).  Saving model ...
Epoch: 9 cost time: 4.170016765594482
Epoch: 9, Steps: 13 | Train Loss: 179.769 Vali Loss: 370.290 Vali Acc: 0.580 Test Loss: 370.290 Test Acc: 0.580
Validation loss decreased (-0.496595 --> -0.576297).  Saving model ...
Epoch: 10 cost time: 4.282068490982056
Epoch: 10, Steps: 13 | Train Loss: 120.863 Vali Loss: 619.258 Vali Acc: 0.340 Test Loss: 619.258 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.131930351257324
Epoch: 11, Steps: 13 | Train Loss: 239.446 Vali Loss: 1134.307 Vali Acc: 0.340 Test Loss: 1134.307 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.155763864517212
Epoch: 12, Steps: 13 | Train Loss: 512.056 Vali Loss: 374.194 Vali Acc: 0.440 Test Loss: 374.194 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.045285940170288
Epoch: 13, Steps: 13 | Train Loss: 164.065 Vali Loss: 582.426 Vali Acc: 0.540 Test Loss: 582.426 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.407756090164185
Epoch: 14, Steps: 13 | Train Loss: 53.222 Vali Loss: 476.984 Vali Acc: 0.500 Test Loss: 476.984 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.2163004875183105
Epoch: 15, Steps: 13 | Train Loss: 81.147 Vali Loss: 499.545 Vali Acc: 0.540 Test Loss: 499.545 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.219946622848511
Epoch: 16, Steps: 13 | Train Loss: 77.984 Vali Loss: 752.614 Vali Acc: 0.480 Test Loss: 752.614 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.289810419082642
Epoch: 17, Steps: 13 | Train Loss: 177.045 Vali Loss: 432.419 Vali Acc: 0.520 Test Loss: 432.419 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.307158708572388
Epoch: 18, Steps: 13 | Train Loss: 16.732 Vali Loss: 739.038 Vali Acc: 0.560 Test Loss: 739.038 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.116038799285889
Epoch: 19, Steps: 13 | Train Loss: 156.676 Vali Loss: 868.015 Vali Acc: 0.440 Test Loss: 868.015 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 51487517
model size : 201.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 6.233725547790527
Epoch: 1, Steps: 13 | Train Loss: 62.906 Vali Loss: 119.707 Vali Acc: 0.280 Test Loss: 119.707 Test Acc: 0.280
Validation loss decreased (inf --> -0.278803).  Saving model ...
Epoch: 2 cost time: 3.997622013092041
Epoch: 2, Steps: 13 | Train Loss: 105.589 Vali Loss: 157.770 Vali Acc: 0.240 Test Loss: 157.770 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.974818229675293
Epoch: 3, Steps: 13 | Train Loss: 128.456 Vali Loss: 131.769 Vali Acc: 0.280 Test Loss: 131.769 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.200768709182739
Epoch: 4, Steps: 13 | Train Loss: 113.947 Vali Loss: 375.377 Vali Acc: 0.300 Test Loss: 375.377 Test Acc: 0.300
Validation loss decreased (-0.278803 --> -0.296246).  Saving model ...
Epoch: 5 cost time: 4.050866603851318
Epoch: 5, Steps: 13 | Train Loss: 176.207 Vali Loss: 179.412 Vali Acc: 0.360 Test Loss: 179.412 Test Acc: 0.360
Validation loss decreased (-0.296246 --> -0.358206).  Saving model ...
Epoch: 6 cost time: 4.189685344696045
Epoch: 6, Steps: 13 | Train Loss: 65.683 Vali Loss: 476.503 Vali Acc: 0.300 Test Loss: 476.503 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.108545541763306
Epoch: 7, Steps: 13 | Train Loss: 213.965 Vali Loss: 598.605 Vali Acc: 0.300 Test Loss: 598.605 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.047463417053223
Epoch: 8, Steps: 13 | Train Loss: 160.181 Vali Loss: 256.710 Vali Acc: 0.480 Test Loss: 256.710 Test Acc: 0.480
Validation loss decreased (-0.358206 --> -0.477433).  Saving model ...
Epoch: 9 cost time: 4.094689607620239
Epoch: 9, Steps: 13 | Train Loss: 134.617 Vali Loss: 314.254 Vali Acc: 0.400 Test Loss: 314.254 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.9858596324920654
Epoch: 10, Steps: 13 | Train Loss: 182.229 Vali Loss: 211.405 Vali Acc: 0.600 Test Loss: 211.405 Test Acc: 0.600
Validation loss decreased (-0.477433 --> -0.597886).  Saving model ...
Epoch: 11 cost time: 4.227642774581909
Epoch: 11, Steps: 13 | Train Loss: 60.772 Vali Loss: 615.499 Vali Acc: 0.340 Test Loss: 615.499 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.101160049438477
Epoch: 12, Steps: 13 | Train Loss: 164.326 Vali Loss: 589.568 Vali Acc: 0.420 Test Loss: 589.568 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.11423397064209
Epoch: 13, Steps: 13 | Train Loss: 253.351 Vali Loss: 945.545 Vali Acc: 0.380 Test Loss: 945.545 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.066020488739014
Epoch: 14, Steps: 13 | Train Loss: 273.945 Vali Loss: 652.106 Vali Acc: 0.460 Test Loss: 652.106 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.065868139266968
Epoch: 15, Steps: 13 | Train Loss: 145.921 Vali Loss: 688.040 Vali Acc: 0.480 Test Loss: 688.040 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.266225337982178
Epoch: 16, Steps: 13 | Train Loss: 118.538 Vali Loss: 345.917 Vali Acc: 0.480 Test Loss: 345.917 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.0834736824035645
Epoch: 17, Steps: 13 | Train Loss: 94.256 Vali Loss: 493.041 Vali Acc: 0.460 Test Loss: 493.041 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.999924659729004
Epoch: 18, Steps: 13 | Train Loss: 22.084 Vali Loss: 780.952 Vali Acc: 0.420 Test Loss: 780.952 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.046565055847168
Epoch: 19, Steps: 13 | Train Loss: 49.986 Vali Loss: 670.193 Vali Acc: 0.460 Test Loss: 670.193 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.968268632888794
Epoch: 20, Steps: 13 | Train Loss: 51.985 Vali Loss: 459.224 Vali Acc: 0.520 Test Loss: 459.224 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 51111197
model size : 199.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.907194375991821
Epoch: 1, Steps: 13 | Train Loss: 80.239 Vali Loss: 127.343 Vali Acc: 0.200 Test Loss: 127.343 Test Acc: 0.200
Validation loss decreased (inf --> -0.198727).  Saving model ...
Epoch: 2 cost time: 3.948300361633301
Epoch: 2, Steps: 13 | Train Loss: 152.547 Vali Loss: 277.255 Vali Acc: 0.200 Test Loss: 277.255 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.878321409225464
Epoch: 3, Steps: 13 | Train Loss: 193.312 Vali Loss: 310.131 Vali Acc: 0.200 Test Loss: 310.131 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.15307879447937
Epoch: 4, Steps: 13 | Train Loss: 178.792 Vali Loss: 288.857 Vali Acc: 0.280 Test Loss: 288.857 Test Acc: 0.280
Validation loss decreased (-0.198727 --> -0.277111).  Saving model ...
Epoch: 5 cost time: 4.128681182861328
Epoch: 5, Steps: 13 | Train Loss: 186.961 Vali Loss: 403.952 Vali Acc: 0.220 Test Loss: 403.952 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.118642091751099
Epoch: 6, Steps: 13 | Train Loss: 202.878 Vali Loss: 572.057 Vali Acc: 0.280 Test Loss: 572.057 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.05340313911438
Epoch: 7, Steps: 13 | Train Loss: 380.025 Vali Loss: 560.625 Vali Acc: 0.380 Test Loss: 560.625 Test Acc: 0.380
Validation loss decreased (-0.277111 --> -0.374394).  Saving model ...
Epoch: 8 cost time: 4.134711742401123
Epoch: 8, Steps: 13 | Train Loss: 307.864 Vali Loss: 574.808 Vali Acc: 0.420 Test Loss: 574.808 Test Acc: 0.420
Validation loss decreased (-0.374394 --> -0.414252).  Saving model ...
Epoch: 9 cost time: 4.3516576290130615
Epoch: 9, Steps: 13 | Train Loss: 229.931 Vali Loss: 451.055 Vali Acc: 0.460 Test Loss: 451.055 Test Acc: 0.460
Validation loss decreased (-0.414252 --> -0.455489).  Saving model ...
Epoch: 10 cost time: 4.070310354232788
Epoch: 10, Steps: 13 | Train Loss: 124.376 Vali Loss: 243.275 Vali Acc: 0.560 Test Loss: 243.275 Test Acc: 0.560
Validation loss decreased (-0.455489 --> -0.557567).  Saving model ...
Epoch: 11 cost time: 4.225861549377441
Epoch: 11, Steps: 13 | Train Loss: 72.613 Vali Loss: 551.464 Vali Acc: 0.460 Test Loss: 551.464 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.173269987106323
Epoch: 12, Steps: 13 | Train Loss: 167.145 Vali Loss: 771.319 Vali Acc: 0.420 Test Loss: 771.319 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.179607629776001
Epoch: 13, Steps: 13 | Train Loss: 107.463 Vali Loss: 494.075 Vali Acc: 0.520 Test Loss: 494.075 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.235279083251953
Epoch: 14, Steps: 13 | Train Loss: 162.255 Vali Loss: 562.638 Vali Acc: 0.540 Test Loss: 562.638 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.061778783798218
Epoch: 15, Steps: 13 | Train Loss: 33.165 Vali Loss: 700.868 Vali Acc: 0.520 Test Loss: 700.868 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.242796421051025
Epoch: 16, Steps: 13 | Train Loss: 79.694 Vali Loss: 560.590 Vali Acc: 0.560 Test Loss: 560.590 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.1566150188446045
Epoch: 17, Steps: 13 | Train Loss: 83.203 Vali Loss: 568.805 Vali Acc: 0.580 Test Loss: 568.805 Test Acc: 0.580
Validation loss decreased (-0.557567 --> -0.574312).  Saving model ...
Epoch: 18 cost time: 4.193984031677246
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 429.678 Vali Acc: 0.660 Test Loss: 429.678 Test Acc: 0.660
Validation loss decreased (-0.574312 --> -0.655703).  Saving model ...
Epoch: 19 cost time: 4.234216690063477
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 456.990 Vali Acc: 0.640 Test Loss: 456.990 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.148075342178345
Epoch: 20, Steps: 13 | Train Loss: 17.189 Vali Loss: 476.226 Vali Acc: 0.620 Test Loss: 476.226 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.2106242179870605
Epoch: 21, Steps: 13 | Train Loss: 0.000 Vali Loss: 646.237 Vali Acc: 0.580 Test Loss: 646.237 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.1737682819366455
Epoch: 22, Steps: 13 | Train Loss: 10.253 Vali Loss: 544.994 Vali Acc: 0.620 Test Loss: 544.994 Test Acc: 0.620
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.243677616119385
Epoch: 23, Steps: 13 | Train Loss: 38.790 Vali Loss: 593.403 Vali Acc: 0.580 Test Loss: 593.403 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 4.209906816482544
Epoch: 24, Steps: 13 | Train Loss: 24.270 Vali Loss: 602.644 Vali Acc: 0.600 Test Loss: 602.644 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 4.403466463088989
Epoch: 25, Steps: 13 | Train Loss: 3.966 Vali Loss: 591.804 Vali Acc: 0.540 Test Loss: 591.804 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 4.2435925006866455
Epoch: 26, Steps: 13 | Train Loss: 44.469 Vali Loss: 514.594 Vali Acc: 0.620 Test Loss: 514.594 Test Acc: 0.620
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 4.1190314292907715
Epoch: 27, Steps: 13 | Train Loss: 47.232 Vali Loss: 430.214 Vali Acc: 0.600 Test Loss: 430.214 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 4.429677963256836
Epoch: 28, Steps: 13 | Train Loss: 17.529 Vali Loss: 551.228 Vali Acc: 0.500 Test Loss: 551.228 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.66
model parameter : 51105309
model size : 199.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.6504738330841064
Epoch: 1, Steps: 13 | Train Loss: 87.256 Vali Loss: 228.304 Vali Acc: 0.200 Test Loss: 228.304 Test Acc: 0.200
Validation loss decreased (inf --> -0.197717).  Saving model ...
Epoch: 2 cost time: 4.271164417266846
Epoch: 2, Steps: 13 | Train Loss: 205.614 Vali Loss: 453.145 Vali Acc: 0.200 Test Loss: 453.145 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.1781041622161865
Epoch: 3, Steps: 13 | Train Loss: 285.111 Vali Loss: 399.624 Vali Acc: 0.260 Test Loss: 399.624 Test Acc: 0.260
Validation loss decreased (-0.197717 --> -0.256004).  Saving model ...
Epoch: 4 cost time: 4.516441822052002
Epoch: 4, Steps: 13 | Train Loss: 156.135 Vali Loss: 273.125 Vali Acc: 0.300 Test Loss: 273.125 Test Acc: 0.300
Validation loss decreased (-0.256004 --> -0.297269).  Saving model ...
Epoch: 5 cost time: 3.9397013187408447
Epoch: 5, Steps: 13 | Train Loss: 133.036 Vali Loss: 251.915 Vali Acc: 0.400 Test Loss: 251.915 Test Acc: 0.400
Validation loss decreased (-0.297269 --> -0.397481).  Saving model ...
Epoch: 6 cost time: 4.0437188148498535
Epoch: 6, Steps: 13 | Train Loss: 89.025 Vali Loss: 285.803 Vali Acc: 0.280 Test Loss: 285.803 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.9482719898223877
Epoch: 7, Steps: 13 | Train Loss: 127.285 Vali Loss: 387.170 Vali Acc: 0.320 Test Loss: 387.170 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.2247560024261475
Epoch: 8, Steps: 13 | Train Loss: 227.517 Vali Loss: 306.398 Vali Acc: 0.420 Test Loss: 306.398 Test Acc: 0.420
Validation loss decreased (-0.397481 --> -0.416936).  Saving model ...
Epoch: 9 cost time: 4.6371238231658936
Epoch: 9, Steps: 13 | Train Loss: 156.397 Vali Loss: 267.827 Vali Acc: 0.420 Test Loss: 267.827 Test Acc: 0.420
Validation loss decreased (-0.416936 --> -0.417322).  Saving model ...
Epoch: 10 cost time: 4.117244482040405
Epoch: 10, Steps: 13 | Train Loss: 146.651 Vali Loss: 347.167 Vali Acc: 0.480 Test Loss: 347.167 Test Acc: 0.480
Validation loss decreased (-0.417322 --> -0.476528).  Saving model ...
Epoch: 11 cost time: 4.23590612411499
Epoch: 11, Steps: 13 | Train Loss: 93.728 Vali Loss: 371.354 Vali Acc: 0.460 Test Loss: 371.354 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.9926276206970215
Epoch: 12, Steps: 13 | Train Loss: 92.827 Vali Loss: 445.012 Vali Acc: 0.500 Test Loss: 445.012 Test Acc: 0.500
Validation loss decreased (-0.476528 --> -0.495550).  Saving model ...
Epoch: 13 cost time: 4.115206718444824
Epoch: 13, Steps: 13 | Train Loss: 73.783 Vali Loss: 580.746 Vali Acc: 0.420 Test Loss: 580.746 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.026081323623657
Epoch: 14, Steps: 13 | Train Loss: 251.940 Vali Loss: 485.997 Vali Acc: 0.500 Test Loss: 485.997 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.080476760864258
Epoch: 15, Steps: 13 | Train Loss: 151.313 Vali Loss: 811.089 Vali Acc: 0.400 Test Loss: 811.089 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.136708736419678
Epoch: 16, Steps: 13 | Train Loss: 176.668 Vali Loss: 520.433 Vali Acc: 0.620 Test Loss: 520.433 Test Acc: 0.620
Validation loss decreased (-0.495550 --> -0.614796).  Saving model ...
Epoch: 17 cost time: 4.20760178565979
Epoch: 17, Steps: 13 | Train Loss: 42.422 Vali Loss: 460.117 Vali Acc: 0.660 Test Loss: 460.117 Test Acc: 0.660
Validation loss decreased (-0.614796 --> -0.655399).  Saving model ...
Epoch: 18 cost time: 4.042267560958862
Epoch: 18, Steps: 13 | Train Loss: 45.480 Vali Loss: 497.480 Vali Acc: 0.500 Test Loss: 497.480 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.054129123687744
Epoch: 19, Steps: 13 | Train Loss: 35.460 Vali Loss: 582.402 Vali Acc: 0.480 Test Loss: 582.402 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.053417205810547
Epoch: 20, Steps: 13 | Train Loss: 79.805 Vali Loss: 726.652 Vali Acc: 0.460 Test Loss: 726.652 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.125581979751587
Epoch: 21, Steps: 13 | Train Loss: 27.009 Vali Loss: 661.094 Vali Acc: 0.440 Test Loss: 661.094 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.1460862159729
Epoch: 22, Steps: 13 | Train Loss: 29.085 Vali Loss: 490.717 Vali Acc: 0.520 Test Loss: 490.717 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.154235124588013
Epoch: 23, Steps: 13 | Train Loss: 1.781 Vali Loss: 515.598 Vali Acc: 0.640 Test Loss: 515.598 Test Acc: 0.640
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 4.132704019546509
Epoch: 24, Steps: 13 | Train Loss: 29.126 Vali Loss: 428.133 Vali Acc: 0.640 Test Loss: 428.133 Test Acc: 0.640
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 4.114674806594849
Epoch: 25, Steps: 13 | Train Loss: 0.000 Vali Loss: 792.967 Vali Acc: 0.440 Test Loss: 792.967 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 4.00552225112915
Epoch: 26, Steps: 13 | Train Loss: 15.310 Vali Loss: 675.625 Vali Acc: 0.480 Test Loss: 675.625 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 4.134912967681885
Epoch: 27, Steps: 13 | Train Loss: 10.890 Vali Loss: 608.076 Vali Acc: 0.500 Test Loss: 608.076 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.66
model parameter : 51099421
model size : 199.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.9375319480896
Epoch: 1, Steps: 13 | Train Loss: 46.321 Vali Loss: 120.081 Vali Acc: 0.200 Test Loss: 120.081 Test Acc: 0.200
Validation loss decreased (inf --> -0.198799).  Saving model ...
Epoch: 2 cost time: 4.027879953384399
Epoch: 2, Steps: 13 | Train Loss: 73.814 Vali Loss: 156.528 Vali Acc: 0.240 Test Loss: 156.528 Test Acc: 0.240
Validation loss decreased (-0.198799 --> -0.238435).  Saving model ...
Epoch: 3 cost time: 4.105793714523315
Epoch: 3, Steps: 13 | Train Loss: 196.151 Vali Loss: 86.988 Vali Acc: 0.280 Test Loss: 86.988 Test Acc: 0.280
Validation loss decreased (-0.238435 --> -0.279130).  Saving model ...
Epoch: 4 cost time: 4.097884893417358
Epoch: 4, Steps: 13 | Train Loss: 95.061 Vali Loss: 187.560 Vali Acc: 0.300 Test Loss: 187.560 Test Acc: 0.300
Validation loss decreased (-0.279130 --> -0.298124).  Saving model ...
Epoch: 5 cost time: 4.191400051116943
Epoch: 5, Steps: 13 | Train Loss: 211.460 Vali Loss: 244.556 Vali Acc: 0.340 Test Loss: 244.556 Test Acc: 0.340
Validation loss decreased (-0.298124 --> -0.337554).  Saving model ...
Epoch: 6 cost time: 4.318874835968018
Epoch: 6, Steps: 13 | Train Loss: 111.262 Vali Loss: 268.189 Vali Acc: 0.320 Test Loss: 268.189 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.114672422409058
Epoch: 7, Steps: 13 | Train Loss: 85.346 Vali Loss: 166.300 Vali Acc: 0.340 Test Loss: 166.300 Test Acc: 0.340
Validation loss decreased (-0.337554 --> -0.338337).  Saving model ...
Epoch: 8 cost time: 4.296632528305054
Epoch: 8, Steps: 13 | Train Loss: 95.175 Vali Loss: 244.386 Vali Acc: 0.440 Test Loss: 244.386 Test Acc: 0.440
Validation loss decreased (-0.338337 --> -0.437556).  Saving model ...
Epoch: 9 cost time: 4.283595085144043
Epoch: 9, Steps: 13 | Train Loss: 267.080 Vali Loss: 555.836 Vali Acc: 0.420 Test Loss: 555.836 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.064120054244995
Epoch: 10, Steps: 13 | Train Loss: 204.207 Vali Loss: 705.386 Vali Acc: 0.420 Test Loss: 705.386 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.1797544956207275
Epoch: 11, Steps: 13 | Train Loss: 164.168 Vali Loss: 822.690 Vali Acc: 0.380 Test Loss: 822.690 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.045383453369141
Epoch: 12, Steps: 13 | Train Loss: 288.871 Vali Loss: 564.170 Vali Acc: 0.560 Test Loss: 564.170 Test Acc: 0.560
Validation loss decreased (-0.437556 --> -0.554358).  Saving model ...
Epoch: 13 cost time: 4.063647270202637
Epoch: 13, Steps: 13 | Train Loss: 86.919 Vali Loss: 495.072 Vali Acc: 0.420 Test Loss: 495.072 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.0920209884643555
Epoch: 14, Steps: 13 | Train Loss: 117.914 Vali Loss: 697.933 Vali Acc: 0.540 Test Loss: 697.933 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.9558863639831543
Epoch: 15, Steps: 13 | Train Loss: 68.218 Vali Loss: 979.644 Vali Acc: 0.380 Test Loss: 979.644 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.092952489852905
Epoch: 16, Steps: 13 | Train Loss: 112.049 Vali Loss: 698.112 Vali Acc: 0.500 Test Loss: 698.112 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.000151634216309
Epoch: 17, Steps: 13 | Train Loss: 187.334 Vali Loss: 1068.903 Vali Acc: 0.460 Test Loss: 1068.903 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.162768602371216
Epoch: 18, Steps: 13 | Train Loss: 175.496 Vali Loss: 777.782 Vali Acc: 0.500 Test Loss: 777.782 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.055498123168945
Epoch: 19, Steps: 13 | Train Loss: 204.348 Vali Loss: 928.144 Vali Acc: 0.420 Test Loss: 928.144 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.071213483810425
Epoch: 20, Steps: 13 | Train Loss: 47.303 Vali Loss: 796.487 Vali Acc: 0.440 Test Loss: 796.487 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.306607723236084
Epoch: 21, Steps: 13 | Train Loss: 116.915 Vali Loss: 597.244 Vali Acc: 0.520 Test Loss: 597.244 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.136677980422974
Epoch: 22, Steps: 13 | Train Loss: 20.994 Vali Loss: 661.383 Vali Acc: 0.580 Test Loss: 661.383 Test Acc: 0.580
Validation loss decreased (-0.554358 --> -0.573386).  Saving model ...
Epoch: 23 cost time: 4.227839708328247
Epoch: 23, Steps: 13 | Train Loss: 3.834 Vali Loss: 634.742 Vali Acc: 0.600 Test Loss: 634.742 Test Acc: 0.600
Validation loss decreased (-0.573386 --> -0.593653).  Saving model ...
Epoch: 24 cost time: 4.116337060928345
Epoch: 24, Steps: 13 | Train Loss: 9.436 Vali Loss: 698.988 Vali Acc: 0.600 Test Loss: 698.988 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.9326817989349365
Epoch: 25, Steps: 13 | Train Loss: 7.478 Vali Loss: 991.204 Vali Acc: 0.580 Test Loss: 991.204 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 4.171091318130493
Epoch: 26, Steps: 13 | Train Loss: 15.203 Vali Loss: 1032.673 Vali Acc: 0.560 Test Loss: 1032.673 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.99955153465271
Epoch: 27, Steps: 13 | Train Loss: 32.133 Vali Loss: 959.266 Vali Acc: 0.520 Test Loss: 959.266 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 4.083446502685547
Epoch: 28, Steps: 13 | Train Loss: 81.862 Vali Loss: 877.963 Vali Acc: 0.560 Test Loss: 877.963 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 4.133304595947266
Epoch: 29, Steps: 13 | Train Loss: 51.123 Vali Loss: 724.554 Vali Acc: 0.560 Test Loss: 724.554 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 4.1496901512146
Epoch: 30, Steps: 13 | Train Loss: 0.000 Vali Loss: 828.815 Vali Acc: 0.500 Test Loss: 828.815 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 4.212151288986206
Epoch: 31, Steps: 13 | Train Loss: 13.470 Vali Loss: 983.253 Vali Acc: 0.520 Test Loss: 983.253 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 3.984177827835083
Epoch: 32, Steps: 13 | Train Loss: 34.628 Vali Loss: 861.880 Vali Acc: 0.560 Test Loss: 861.880 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 4.204907417297363
Epoch: 33, Steps: 13 | Train Loss: 44.520 Vali Loss: 1070.159 Vali Acc: 0.480 Test Loss: 1070.159 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 51093533
model size : 199.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 6.166975975036621
Epoch: 1, Steps: 13 | Train Loss: 54.387 Vali Loss: 70.192 Vali Acc: 0.260 Test Loss: 70.192 Test Acc: 0.260
Validation loss decreased (inf --> -0.259298).  Saving model ...
Epoch: 2 cost time: 4.074022054672241
Epoch: 2, Steps: 13 | Train Loss: 84.144 Vali Loss: 367.821 Vali Acc: 0.200 Test Loss: 367.821 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.18403434753418
Epoch: 3, Steps: 13 | Train Loss: 201.325 Vali Loss: 148.498 Vali Acc: 0.380 Test Loss: 148.498 Test Acc: 0.380
Validation loss decreased (-0.259298 --> -0.378515).  Saving model ...
Epoch: 4 cost time: 3.899322748184204
Epoch: 4, Steps: 13 | Train Loss: 102.845 Vali Loss: 374.590 Vali Acc: 0.220 Test Loss: 374.590 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.985307455062866
Epoch: 5, Steps: 13 | Train Loss: 237.106 Vali Loss: 330.604 Vali Acc: 0.260 Test Loss: 330.604 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.015082120895386
Epoch: 6, Steps: 13 | Train Loss: 222.850 Vali Loss: 315.224 Vali Acc: 0.280 Test Loss: 315.224 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.061876535415649
Epoch: 7, Steps: 13 | Train Loss: 206.758 Vali Loss: 483.402 Vali Acc: 0.320 Test Loss: 483.402 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.011599540710449
Epoch: 8, Steps: 13 | Train Loss: 190.098 Vali Loss: 321.395 Vali Acc: 0.380 Test Loss: 321.395 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.028103590011597
Epoch: 9, Steps: 13 | Train Loss: 105.593 Vali Loss: 395.932 Vali Acc: 0.360 Test Loss: 395.932 Test Acc: 0.360
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.9986937046051025
Epoch: 10, Steps: 13 | Train Loss: 104.714 Vali Loss: 434.400 Vali Acc: 0.460 Test Loss: 434.400 Test Acc: 0.460
Validation loss decreased (-0.378515 --> -0.455656).  Saving model ...
Epoch: 11 cost time: 4.1025354862213135
Epoch: 11, Steps: 13 | Train Loss: 109.319 Vali Loss: 763.682 Vali Acc: 0.360 Test Loss: 763.682 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.951324462890625
Epoch: 12, Steps: 13 | Train Loss: 106.770 Vali Loss: 444.312 Vali Acc: 0.480 Test Loss: 444.312 Test Acc: 0.480
Validation loss decreased (-0.455656 --> -0.475557).  Saving model ...
Epoch: 13 cost time: 4.054270505905151
Epoch: 13, Steps: 13 | Train Loss: 112.835 Vali Loss: 659.516 Vali Acc: 0.500 Test Loss: 659.516 Test Acc: 0.500
Validation loss decreased (-0.475557 --> -0.493405).  Saving model ...
Epoch: 14 cost time: 4.161491870880127
Epoch: 14, Steps: 13 | Train Loss: 111.183 Vali Loss: 829.971 Vali Acc: 0.560 Test Loss: 829.971 Test Acc: 0.560
Validation loss decreased (-0.493405 --> -0.551700).  Saving model ...
Epoch: 15 cost time: 4.211819648742676
Epoch: 15, Steps: 13 | Train Loss: 129.781 Vali Loss: 561.411 Vali Acc: 0.440 Test Loss: 561.411 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.0301172733306885
Epoch: 16, Steps: 13 | Train Loss: 42.337 Vali Loss: 768.844 Vali Acc: 0.500 Test Loss: 768.844 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.026577949523926
Epoch: 17, Steps: 13 | Train Loss: 49.923 Vali Loss: 543.699 Vali Acc: 0.500 Test Loss: 543.699 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.918135166168213
Epoch: 18, Steps: 13 | Train Loss: 8.235 Vali Loss: 815.891 Vali Acc: 0.500 Test Loss: 815.891 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.03711724281311
Epoch: 19, Steps: 13 | Train Loss: 63.280 Vali Loss: 600.982 Vali Acc: 0.520 Test Loss: 600.982 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.023437738418579
Epoch: 20, Steps: 13 | Train Loss: 23.682 Vali Loss: 489.771 Vali Acc: 0.480 Test Loss: 489.771 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.958747148513794
Epoch: 21, Steps: 13 | Train Loss: 37.729 Vali Loss: 426.679 Vali Acc: 0.640 Test Loss: 426.679 Test Acc: 0.640
Validation loss decreased (-0.551700 --> -0.635733).  Saving model ...
Epoch: 22 cost time: 4.08134126663208
Epoch: 22, Steps: 13 | Train Loss: 19.014 Vali Loss: 591.509 Vali Acc: 0.520 Test Loss: 591.509 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.047379732131958
Epoch: 23, Steps: 13 | Train Loss: 108.249 Vali Loss: 1015.951 Vali Acc: 0.440 Test Loss: 1015.951 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.020220518112183
Epoch: 24, Steps: 13 | Train Loss: 80.459 Vali Loss: 745.689 Vali Acc: 0.580 Test Loss: 745.689 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 4.084672451019287
Epoch: 25, Steps: 13 | Train Loss: 120.215 Vali Loss: 730.039 Vali Acc: 0.660 Test Loss: 730.039 Test Acc: 0.660
Validation loss decreased (-0.635733 --> -0.652700).  Saving model ...
Epoch: 26 cost time: 4.0065598487854
Epoch: 26, Steps: 13 | Train Loss: 54.376 Vali Loss: 816.545 Vali Acc: 0.480 Test Loss: 816.545 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.003122329711914
Epoch: 27, Steps: 13 | Train Loss: 43.738 Vali Loss: 690.186 Vali Acc: 0.600 Test Loss: 690.186 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.9638264179229736
Epoch: 28, Steps: 13 | Train Loss: 0.000 Vali Loss: 757.242 Vali Acc: 0.580 Test Loss: 757.242 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 4.168665409088135
Epoch: 29, Steps: 13 | Train Loss: 2.692 Vali Loss: 811.713 Vali Acc: 0.540 Test Loss: 811.713 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 4.101025819778442
Epoch: 30, Steps: 13 | Train Loss: 13.200 Vali Loss: 773.673 Vali Acc: 0.580 Test Loss: 773.673 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 4.1206889152526855
Epoch: 31, Steps: 13 | Train Loss: 0.000 Vali Loss: 803.816 Vali Acc: 0.580 Test Loss: 803.816 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 4.039795398712158
Epoch: 32, Steps: 13 | Train Loss: 18.578 Vali Loss: 998.672 Vali Acc: 0.540 Test Loss: 998.672 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 4.114200592041016
Epoch: 33, Steps: 13 | Train Loss: 11.796 Vali Loss: 978.441 Vali Acc: 0.640 Test Loss: 978.441 Test Acc: 0.640
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 4.0144476890563965
Epoch: 34, Steps: 13 | Train Loss: 27.419 Vali Loss: 968.246 Vali Acc: 0.520 Test Loss: 968.246 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 3.9947242736816406
Epoch: 35, Steps: 13 | Train Loss: 67.202 Vali Loss: 929.249 Vali Acc: 0.520 Test Loss: 929.249 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.66
model parameter : 50914205
model size : 199.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.641124963760376
Epoch: 1, Steps: 13 | Train Loss: 67.138 Vali Loss: 98.659 Vali Acc: 0.220 Test Loss: 98.659 Test Acc: 0.220
Validation loss decreased (inf --> -0.219013).  Saving model ...
Epoch: 2 cost time: 4.084637641906738
Epoch: 2, Steps: 13 | Train Loss: 139.856 Vali Loss: 183.777 Vali Acc: 0.220 Test Loss: 183.777 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.057638883590698
Epoch: 3, Steps: 13 | Train Loss: 148.360 Vali Loss: 234.550 Vali Acc: 0.320 Test Loss: 234.550 Test Acc: 0.320
Validation loss decreased (-0.219013 --> -0.317655).  Saving model ...
Epoch: 4 cost time: 3.9604508876800537
Epoch: 4, Steps: 13 | Train Loss: 150.788 Vali Loss: 286.501 Vali Acc: 0.220 Test Loss: 286.501 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.008107900619507
Epoch: 5, Steps: 13 | Train Loss: 110.083 Vali Loss: 118.769 Vali Acc: 0.380 Test Loss: 118.769 Test Acc: 0.380
Validation loss decreased (-0.317655 --> -0.378812).  Saving model ...
Epoch: 6 cost time: 4.028539419174194
Epoch: 6, Steps: 13 | Train Loss: 130.746 Vali Loss: 146.557 Vali Acc: 0.480 Test Loss: 146.557 Test Acc: 0.480
Validation loss decreased (-0.378812 --> -0.478534).  Saving model ...
Epoch: 7 cost time: 3.894024610519409
Epoch: 7, Steps: 13 | Train Loss: 90.745 Vali Loss: 416.917 Vali Acc: 0.240 Test Loss: 416.917 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.9842684268951416
Epoch: 8, Steps: 13 | Train Loss: 145.150 Vali Loss: 409.389 Vali Acc: 0.480 Test Loss: 409.389 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.9071853160858154
Epoch: 9, Steps: 13 | Train Loss: 171.356 Vali Loss: 684.863 Vali Acc: 0.340 Test Loss: 684.863 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.9087839126586914
Epoch: 10, Steps: 13 | Train Loss: 352.443 Vali Loss: 738.514 Vali Acc: 0.400 Test Loss: 738.514 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.445779323577881
Epoch: 11, Steps: 13 | Train Loss: 271.338 Vali Loss: 555.741 Vali Acc: 0.440 Test Loss: 555.741 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.9055967330932617
Epoch: 12, Steps: 13 | Train Loss: 90.297 Vali Loss: 423.340 Vali Acc: 0.540 Test Loss: 423.340 Test Acc: 0.540
Validation loss decreased (-0.478534 --> -0.535767).  Saving model ...
Epoch: 13 cost time: 4.042804956436157
Epoch: 13, Steps: 13 | Train Loss: 135.142 Vali Loss: 546.106 Vali Acc: 0.400 Test Loss: 546.106 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.117148399353027
Epoch: 14, Steps: 13 | Train Loss: 89.613 Vali Loss: 211.510 Vali Acc: 0.680 Test Loss: 211.510 Test Acc: 0.680
Validation loss decreased (-0.535767 --> -0.677885).  Saving model ...
Epoch: 15 cost time: 3.955082416534424
Epoch: 15, Steps: 13 | Train Loss: 35.412 Vali Loss: 397.423 Vali Acc: 0.520 Test Loss: 397.423 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.038175106048584
Epoch: 16, Steps: 13 | Train Loss: 39.380 Vali Loss: 303.186 Vali Acc: 0.680 Test Loss: 303.186 Test Acc: 0.680
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.0689003467559814
Epoch: 17, Steps: 13 | Train Loss: 38.583 Vali Loss: 453.940 Vali Acc: 0.520 Test Loss: 453.940 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.023655414581299
Epoch: 18, Steps: 13 | Train Loss: 73.363 Vali Loss: 439.099 Vali Acc: 0.560 Test Loss: 439.099 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.075063467025757
Epoch: 19, Steps: 13 | Train Loss: 63.956 Vali Loss: 377.294 Vali Acc: 0.540 Test Loss: 377.294 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.9463322162628174
Epoch: 20, Steps: 13 | Train Loss: 68.160 Vali Loss: 557.310 Vali Acc: 0.620 Test Loss: 557.310 Test Acc: 0.620
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.8617048263549805
Epoch: 21, Steps: 13 | Train Loss: 7.350 Vali Loss: 401.462 Vali Acc: 0.680 Test Loss: 401.462 Test Acc: 0.680
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.9475526809692383
Epoch: 22, Steps: 13 | Train Loss: 30.330 Vali Loss: 367.697 Vali Acc: 0.640 Test Loss: 367.697 Test Acc: 0.640
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.98850679397583
Epoch: 23, Steps: 13 | Train Loss: 0.000 Vali Loss: 427.955 Vali Acc: 0.580 Test Loss: 427.955 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.9841361045837402
Epoch: 24, Steps: 13 | Train Loss: 0.000 Vali Loss: 492.581 Vali Acc: 0.560 Test Loss: 492.581 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.68
model parameter : 50908317
model size : 199.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.843526840209961
Epoch: 1, Steps: 13 | Train Loss: 100.393 Vali Loss: 136.049 Vali Acc: 0.200 Test Loss: 136.049 Test Acc: 0.200
Validation loss decreased (inf --> -0.198640).  Saving model ...
Epoch: 2 cost time: 4.068251371383667
Epoch: 2, Steps: 13 | Train Loss: 155.169 Vali Loss: 180.528 Vali Acc: 0.340 Test Loss: 180.528 Test Acc: 0.340
Validation loss decreased (-0.198640 --> -0.338195).  Saving model ...
Epoch: 3 cost time: 3.940793514251709
Epoch: 3, Steps: 13 | Train Loss: 235.055 Vali Loss: 366.222 Vali Acc: 0.380 Test Loss: 366.222 Test Acc: 0.380
Validation loss decreased (-0.338195 --> -0.376338).  Saving model ...
Epoch: 4 cost time: 4.148144721984863
Epoch: 4, Steps: 13 | Train Loss: 143.644 Vali Loss: 719.745 Vali Acc: 0.260 Test Loss: 719.745 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.201683282852173
Epoch: 5, Steps: 13 | Train Loss: 337.031 Vali Loss: 297.393 Vali Acc: 0.280 Test Loss: 297.393 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.108281373977661
Epoch: 6, Steps: 13 | Train Loss: 264.236 Vali Loss: 474.370 Vali Acc: 0.380 Test Loss: 474.370 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.1556947231292725
Epoch: 7, Steps: 13 | Train Loss: 328.767 Vali Loss: 484.086 Vali Acc: 0.340 Test Loss: 484.086 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.012921333312988
Epoch: 8, Steps: 13 | Train Loss: 274.941 Vali Loss: 261.364 Vali Acc: 0.520 Test Loss: 261.364 Test Acc: 0.520
Validation loss decreased (-0.376338 --> -0.517386).  Saving model ...
Epoch: 9 cost time: 4.360507488250732
Epoch: 9, Steps: 13 | Train Loss: 119.845 Vali Loss: 461.157 Vali Acc: 0.340 Test Loss: 461.157 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.127400875091553
Epoch: 10, Steps: 13 | Train Loss: 155.747 Vali Loss: 336.286 Vali Acc: 0.480 Test Loss: 336.286 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.098231315612793
Epoch: 11, Steps: 13 | Train Loss: 112.081 Vali Loss: 513.234 Vali Acc: 0.420 Test Loss: 513.234 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.184995174407959
Epoch: 12, Steps: 13 | Train Loss: 169.791 Vali Loss: 849.362 Vali Acc: 0.360 Test Loss: 849.362 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.014557838439941
Epoch: 13, Steps: 13 | Train Loss: 238.576 Vali Loss: 485.174 Vali Acc: 0.480 Test Loss: 485.174 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.9350497722625732
Epoch: 14, Steps: 13 | Train Loss: 77.087 Vali Loss: 465.721 Vali Acc: 0.520 Test Loss: 465.721 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.233182430267334
Epoch: 15, Steps: 13 | Train Loss: 39.188 Vali Loss: 563.946 Vali Acc: 0.440 Test Loss: 563.946 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.590994358062744
Epoch: 16, Steps: 13 | Train Loss: 59.974 Vali Loss: 608.443 Vali Acc: 0.580 Test Loss: 608.443 Test Acc: 0.580
Validation loss decreased (-0.517386 --> -0.573916).  Saving model ...
Epoch: 17 cost time: 4.173367261886597
Epoch: 17, Steps: 13 | Train Loss: 121.667 Vali Loss: 839.203 Vali Acc: 0.540 Test Loss: 839.203 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.318531513214111
Epoch: 18, Steps: 13 | Train Loss: 113.291 Vali Loss: 685.983 Vali Acc: 0.500 Test Loss: 685.983 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.158886194229126
Epoch: 19, Steps: 13 | Train Loss: 83.427 Vali Loss: 661.677 Vali Acc: 0.540 Test Loss: 661.677 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.123474836349487
Epoch: 20, Steps: 13 | Train Loss: 15.068 Vali Loss: 738.785 Vali Acc: 0.440 Test Loss: 738.785 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 4.134891748428345
Epoch: 21, Steps: 13 | Train Loss: 57.095 Vali Loss: 525.128 Vali Acc: 0.680 Test Loss: 525.128 Test Acc: 0.680
Validation loss decreased (-0.573916 --> -0.674749).  Saving model ...
Epoch: 22 cost time: 4.1729981899261475
Epoch: 22, Steps: 13 | Train Loss: 26.696 Vali Loss: 558.564 Vali Acc: 0.660 Test Loss: 558.564 Test Acc: 0.660
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.18939733505249
Epoch: 23, Steps: 13 | Train Loss: 0.000 Vali Loss: 657.511 Vali Acc: 0.640 Test Loss: 657.511 Test Acc: 0.640
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.215943813323975
Epoch: 24, Steps: 13 | Train Loss: 0.000 Vali Loss: 688.093 Vali Acc: 0.640 Test Loss: 688.093 Test Acc: 0.640
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 4.253551959991455
Epoch: 25, Steps: 13 | Train Loss: 5.383 Vali Loss: 667.170 Vali Acc: 0.640 Test Loss: 667.170 Test Acc: 0.640
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 4.18981146812439
Epoch: 26, Steps: 13 | Train Loss: 0.173 Vali Loss: 484.602 Vali Acc: 0.600 Test Loss: 484.602 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 4.136580944061279
Epoch: 27, Steps: 13 | Train Loss: 0.000 Vali Loss: 427.456 Vali Acc: 0.620 Test Loss: 427.456 Test Acc: 0.620
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 4.022130489349365
Epoch: 28, Steps: 13 | Train Loss: 0.000 Vali Loss: 418.808 Vali Acc: 0.680 Test Loss: 418.808 Test Acc: 0.680
Validation loss decreased (-0.674749 --> -0.675812).  Saving model ...
Epoch: 29 cost time: 4.128629922866821
Epoch: 29, Steps: 13 | Train Loss: 0.000 Vali Loss: 417.270 Vali Acc: 0.680 Test Loss: 417.270 Test Acc: 0.680
Validation loss decreased (-0.675812 --> -0.675827).  Saving model ...
Epoch: 30 cost time: 4.048490047454834
Epoch: 30, Steps: 13 | Train Loss: 0.000 Vali Loss: 416.864 Vali Acc: 0.680 Test Loss: 416.864 Test Acc: 0.680
Validation loss decreased (-0.675827 --> -0.675831).  Saving model ...
Epoch: 31 cost time: 4.188377618789673
Epoch: 31, Steps: 13 | Train Loss: 0.000 Vali Loss: 416.759 Vali Acc: 0.680 Test Loss: 416.759 Test Acc: 0.680
Validation loss decreased (-0.675831 --> -0.675832).  Saving model ...
Epoch: 32 cost time: 4.043380975723267
Epoch: 32, Steps: 13 | Train Loss: 0.000 Vali Loss: 416.731 Vali Acc: 0.680 Test Loss: 416.731 Test Acc: 0.680
Validation loss decreased (-0.675832 --> -0.675833).  Saving model ...
Epoch: 33 cost time: 4.174962282180786
Epoch: 33, Steps: 13 | Train Loss: 0.000 Vali Loss: 416.724 Vali Acc: 0.680 Test Loss: 416.724 Test Acc: 0.680
Validation loss decreased (-0.675833 --> -0.675833).  Saving model ...
Epoch: 34 cost time: 4.202309846878052
Epoch: 34, Steps: 13 | Train Loss: 0.000 Vali Loss: 416.722 Vali Acc: 0.680 Test Loss: 416.722 Test Acc: 0.680
Validation loss decreased (-0.675833 --> -0.675833).  Saving model ...
Epoch: 35 cost time: 3.920802593231201
Epoch: 35, Steps: 13 | Train Loss: 0.000 Vali Loss: 416.721 Vali Acc: 0.680 Test Loss: 416.721 Test Acc: 0.680
Validation loss decreased (-0.675833 --> -0.675833).  Saving model ...
Epoch: 36 cost time: 4.203529357910156
Epoch: 36, Steps: 13 | Train Loss: 0.000 Vali Loss: 416.721 Vali Acc: 0.680 Test Loss: 416.721 Test Acc: 0.680
Validation loss decreased (-0.675833 --> -0.675833).  Saving model ...
Epoch: 37 cost time: 4.175705671310425
Epoch: 37, Steps: 13 | Train Loss: 0.000 Vali Loss: 416.721 Vali Acc: 0.680 Test Loss: 416.721 Test Acc: 0.680
Validation loss decreased (-0.675833 --> -0.675833).  Saving model ...
Epoch: 38 cost time: 4.080610036849976
Epoch: 38, Steps: 13 | Train Loss: 0.000 Vali Loss: 416.721 Vali Acc: 0.680 Test Loss: 416.721 Test Acc: 0.680
Validation loss decreased (-0.675833 --> -0.675833).  Saving model ...
Epoch: 39 cost time: 4.470858573913574
Epoch: 39, Steps: 13 | Train Loss: 0.000 Vali Loss: 416.721 Vali Acc: 0.680 Test Loss: 416.721 Test Acc: 0.680
Validation loss decreased (-0.675833 --> -0.675833).  Saving model ...
Epoch: 40 cost time: 4.3015828132629395
Epoch: 40, Steps: 13 | Train Loss: 0.000 Vali Loss: 416.721 Vali Acc: 0.680 Test Loss: 416.721 Test Acc: 0.680
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 4.218179702758789
Epoch: 41, Steps: 13 | Train Loss: 0.000 Vali Loss: 416.721 Vali Acc: 0.680 Test Loss: 416.721 Test Acc: 0.680
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 4.073376417160034
Epoch: 42, Steps: 13 | Train Loss: 0.000 Vali Loss: 416.721 Vali Acc: 0.680 Test Loss: 416.721 Test Acc: 0.680
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 4.20685887336731
Epoch: 43, Steps: 13 | Train Loss: 0.000 Vali Loss: 416.721 Vali Acc: 0.680 Test Loss: 416.721 Test Acc: 0.680
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 4.108862638473511
Epoch: 44, Steps: 13 | Train Loss: 0.000 Vali Loss: 416.721 Vali Acc: 0.680 Test Loss: 416.721 Test Acc: 0.680
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 4.212496042251587
Epoch: 45, Steps: 13 | Train Loss: 0.000 Vali Loss: 416.721 Vali Acc: 0.680 Test Loss: 416.721 Test Acc: 0.680
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 4.153080701828003
Epoch: 46, Steps: 13 | Train Loss: 0.000 Vali Loss: 416.721 Vali Acc: 0.680 Test Loss: 416.721 Test Acc: 0.680
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 4.259389877319336
Epoch: 47, Steps: 13 | Train Loss: 0.000 Vali Loss: 416.721 Vali Acc: 0.680 Test Loss: 416.721 Test Acc: 0.680
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 4.159261465072632
Epoch: 48, Steps: 13 | Train Loss: 0.000 Vali Loss: 416.721 Vali Acc: 0.680 Test Loss: 416.721 Test Acc: 0.680
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 4.113603830337524
Epoch: 49, Steps: 13 | Train Loss: 0.000 Vali Loss: 416.721 Vali Acc: 0.680 Test Loss: 416.721 Test Acc: 0.680
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.68
model parameter : 50902429
model size : 199.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.980143070220947
Epoch: 1, Steps: 13 | Train Loss: 26.078 Vali Loss: 91.059 Vali Acc: 0.220 Test Loss: 91.059 Test Acc: 0.220
Validation loss decreased (inf --> -0.219089).  Saving model ...
Epoch: 2 cost time: 3.9852967262268066
Epoch: 2, Steps: 13 | Train Loss: 95.697 Vali Loss: 309.857 Vali Acc: 0.200 Test Loss: 309.857 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.1789233684539795
Epoch: 3, Steps: 13 | Train Loss: 71.531 Vali Loss: 237.516 Vali Acc: 0.200 Test Loss: 237.516 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.098031520843506
Epoch: 4, Steps: 13 | Train Loss: 107.248 Vali Loss: 304.664 Vali Acc: 0.260 Test Loss: 304.664 Test Acc: 0.260
Validation loss decreased (-0.219089 --> -0.256953).  Saving model ...
Epoch: 5 cost time: 4.047525882720947
Epoch: 5, Steps: 13 | Train Loss: 145.352 Vali Loss: 558.792 Vali Acc: 0.200 Test Loss: 558.792 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.102967739105225
Epoch: 6, Steps: 13 | Train Loss: 335.706 Vali Loss: 221.596 Vali Acc: 0.440 Test Loss: 221.596 Test Acc: 0.440
Validation loss decreased (-0.256953 --> -0.437784).  Saving model ...
Epoch: 7 cost time: 3.906972646713257
Epoch: 7, Steps: 13 | Train Loss: 200.814 Vali Loss: 505.746 Vali Acc: 0.420 Test Loss: 505.746 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.9383304119110107
Epoch: 8, Steps: 13 | Train Loss: 310.678 Vali Loss: 385.858 Vali Acc: 0.380 Test Loss: 385.858 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.9442059993743896
Epoch: 9, Steps: 13 | Train Loss: 217.663 Vali Loss: 366.754 Vali Acc: 0.460 Test Loss: 366.754 Test Acc: 0.460
Validation loss decreased (-0.437784 --> -0.456332).  Saving model ...
Epoch: 10 cost time: 4.239054918289185
Epoch: 10, Steps: 13 | Train Loss: 164.942 Vali Loss: 931.734 Vali Acc: 0.500 Test Loss: 931.734 Test Acc: 0.500
Validation loss decreased (-0.456332 --> -0.490683).  Saving model ...
Epoch: 11 cost time: 4.14116358757019
Epoch: 11, Steps: 13 | Train Loss: 443.075 Vali Loss: 642.183 Vali Acc: 0.420 Test Loss: 642.183 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.24422550201416
Epoch: 12, Steps: 13 | Train Loss: 210.698 Vali Loss: 568.481 Vali Acc: 0.500 Test Loss: 568.481 Test Acc: 0.500
Validation loss decreased (-0.490683 --> -0.494315).  Saving model ...
Epoch: 13 cost time: 3.9334802627563477
Epoch: 13, Steps: 13 | Train Loss: 243.080 Vali Loss: 723.727 Vali Acc: 0.480 Test Loss: 723.727 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.182304382324219
Epoch: 14, Steps: 13 | Train Loss: 129.431 Vali Loss: 434.776 Vali Acc: 0.620 Test Loss: 434.776 Test Acc: 0.620
Validation loss decreased (-0.494315 --> -0.615652).  Saving model ...
Epoch: 15 cost time: 4.0175347328186035
Epoch: 15, Steps: 13 | Train Loss: 46.300 Vali Loss: 585.732 Vali Acc: 0.680 Test Loss: 585.732 Test Acc: 0.680
Validation loss decreased (-0.615652 --> -0.674143).  Saving model ...
Epoch: 16 cost time: 4.189137697219849
Epoch: 16, Steps: 13 | Train Loss: 207.678 Vali Loss: 646.390 Vali Acc: 0.540 Test Loss: 646.390 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.188778400421143
Epoch: 17, Steps: 13 | Train Loss: 35.343 Vali Loss: 444.138 Vali Acc: 0.540 Test Loss: 444.138 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.8953864574432373
Epoch: 18, Steps: 13 | Train Loss: 33.761 Vali Loss: 482.456 Vali Acc: 0.560 Test Loss: 482.456 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.028868198394775
Epoch: 19, Steps: 13 | Train Loss: 5.676 Vali Loss: 469.853 Vali Acc: 0.580 Test Loss: 469.853 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.9510462284088135
Epoch: 20, Steps: 13 | Train Loss: 29.537 Vali Loss: 725.937 Vali Acc: 0.500 Test Loss: 725.937 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.9693098068237305
Epoch: 21, Steps: 13 | Train Loss: 22.042 Vali Loss: 734.026 Vali Acc: 0.560 Test Loss: 734.026 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.199288606643677
Epoch: 22, Steps: 13 | Train Loss: 16.662 Vali Loss: 784.645 Vali Acc: 0.540 Test Loss: 784.645 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 4.020882844924927
Epoch: 23, Steps: 13 | Train Loss: 58.520 Vali Loss: 632.807 Vali Acc: 0.580 Test Loss: 632.807 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.039407253265381
Epoch: 24, Steps: 13 | Train Loss: 0.717 Vali Loss: 384.375 Vali Acc: 0.700 Test Loss: 384.375 Test Acc: 0.700
Validation loss decreased (-0.674143 --> -0.696156).  Saving model ...
Epoch: 25 cost time: 4.093598127365112
Epoch: 25, Steps: 13 | Train Loss: 15.023 Vali Loss: 471.222 Vali Acc: 0.640 Test Loss: 471.222 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.956498861312866
Epoch: 26, Steps: 13 | Train Loss: 3.326 Vali Loss: 1093.622 Vali Acc: 0.480 Test Loss: 1093.622 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 4.177008152008057
Epoch: 27, Steps: 13 | Train Loss: 51.861 Vali Loss: 709.080 Vali Acc: 0.600 Test Loss: 709.080 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 4.126845121383667
Epoch: 28, Steps: 13 | Train Loss: 0.000 Vali Loss: 825.249 Vali Acc: 0.600 Test Loss: 825.249 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 4.301923036575317
Epoch: 29, Steps: 13 | Train Loss: 45.784 Vali Loss: 677.453 Vali Acc: 0.560 Test Loss: 677.453 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 4.0641233921051025
Epoch: 30, Steps: 13 | Train Loss: 28.090 Vali Loss: 735.056 Vali Acc: 0.620 Test Loss: 735.056 Test Acc: 0.620
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 4.015796422958374
Epoch: 31, Steps: 13 | Train Loss: 0.000 Vali Loss: 685.573 Vali Acc: 0.580 Test Loss: 685.573 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 3.993464946746826
Epoch: 32, Steps: 13 | Train Loss: 0.000 Vali Loss: 688.847 Vali Acc: 0.540 Test Loss: 688.847 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 4.110402822494507
Epoch: 33, Steps: 13 | Train Loss: 2.696 Vali Loss: 834.947 Vali Acc: 0.560 Test Loss: 834.947 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 3.9924702644348145
Epoch: 34, Steps: 13 | Train Loss: 11.865 Vali Loss: 744.926 Vali Acc: 0.600 Test Loss: 744.926 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.7
model parameter : 50896541
model size : 199.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.054110765457153
Epoch: 1, Steps: 13 | Train Loss: 25.970 Vali Loss: 98.981 Vali Acc: 0.220 Test Loss: 98.981 Test Acc: 0.220
Validation loss decreased (inf --> -0.219010).  Saving model ...
Epoch: 2 cost time: 3.384014368057251
Epoch: 2, Steps: 13 | Train Loss: 114.768 Vali Loss: 54.067 Vali Acc: 0.220 Test Loss: 54.067 Test Acc: 0.220
Validation loss decreased (-0.219010 --> -0.219459).  Saving model ...
Epoch: 3 cost time: 3.2350056171417236
Epoch: 3, Steps: 13 | Train Loss: 66.192 Vali Loss: 59.048 Vali Acc: 0.320 Test Loss: 59.048 Test Acc: 0.320
Validation loss decreased (-0.219459 --> -0.319410).  Saving model ...
Epoch: 4 cost time: 3.4743847846984863
Epoch: 4, Steps: 13 | Train Loss: 58.944 Vali Loss: 257.896 Vali Acc: 0.220 Test Loss: 257.896 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.2455360889434814
Epoch: 5, Steps: 13 | Train Loss: 187.241 Vali Loss: 168.593 Vali Acc: 0.300 Test Loss: 168.593 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.263134479522705
Epoch: 6, Steps: 13 | Train Loss: 150.077 Vali Loss: 221.832 Vali Acc: 0.280 Test Loss: 221.832 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.3065953254699707
Epoch: 7, Steps: 13 | Train Loss: 216.540 Vali Loss: 120.153 Vali Acc: 0.340 Test Loss: 120.153 Test Acc: 0.340
Validation loss decreased (-0.319410 --> -0.338798).  Saving model ...
Epoch: 8 cost time: 3.261448383331299
Epoch: 8, Steps: 13 | Train Loss: 94.917 Vali Loss: 90.377 Vali Acc: 0.600 Test Loss: 90.377 Test Acc: 0.600
Validation loss decreased (-0.338798 --> -0.599096).  Saving model ...
Epoch: 9 cost time: 3.208611249923706
Epoch: 9, Steps: 13 | Train Loss: 66.434 Vali Loss: 153.244 Vali Acc: 0.400 Test Loss: 153.244 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.0751161575317383
Epoch: 10, Steps: 13 | Train Loss: 29.833 Vali Loss: 199.282 Vali Acc: 0.480 Test Loss: 199.282 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.2800896167755127
Epoch: 11, Steps: 13 | Train Loss: 95.010 Vali Loss: 205.875 Vali Acc: 0.480 Test Loss: 205.875 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.213923215866089
Epoch: 12, Steps: 13 | Train Loss: 93.040 Vali Loss: 360.166 Vali Acc: 0.440 Test Loss: 360.166 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.1192288398742676
Epoch: 13, Steps: 13 | Train Loss: 82.221 Vali Loss: 206.302 Vali Acc: 0.520 Test Loss: 206.302 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.4785995483398438
Epoch: 14, Steps: 13 | Train Loss: 76.920 Vali Loss: 330.617 Vali Acc: 0.500 Test Loss: 330.617 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.3873989582061768
Epoch: 15, Steps: 13 | Train Loss: 16.675 Vali Loss: 253.841 Vali Acc: 0.540 Test Loss: 253.841 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.281511068344116
Epoch: 16, Steps: 13 | Train Loss: 62.001 Vali Loss: 468.779 Vali Acc: 0.460 Test Loss: 468.779 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.3431739807128906
Epoch: 17, Steps: 13 | Train Loss: 61.587 Vali Loss: 214.603 Vali Acc: 0.500 Test Loss: 214.603 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.891435146331787
Epoch: 18, Steps: 13 | Train Loss: 24.951 Vali Loss: 280.709 Vali Acc: 0.480 Test Loss: 280.709 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 25361693
model size : 99.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.833084583282471
Epoch: 1, Steps: 13 | Train Loss: 41.024 Vali Loss: 96.388 Vali Acc: 0.200 Test Loss: 96.388 Test Acc: 0.200
Validation loss decreased (inf --> -0.199036).  Saving model ...
Epoch: 2 cost time: 3.144651174545288
Epoch: 2, Steps: 13 | Train Loss: 81.138 Vali Loss: 61.745 Vali Acc: 0.440 Test Loss: 61.745 Test Acc: 0.440
Validation loss decreased (-0.199036 --> -0.439383).  Saving model ...
Epoch: 3 cost time: 3.2922115325927734
Epoch: 3, Steps: 13 | Train Loss: 97.408 Vali Loss: 131.277 Vali Acc: 0.220 Test Loss: 131.277 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.1287474632263184
Epoch: 4, Steps: 13 | Train Loss: 160.862 Vali Loss: 177.511 Vali Acc: 0.240 Test Loss: 177.511 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.1630654335021973
Epoch: 5, Steps: 13 | Train Loss: 88.800 Vali Loss: 64.612 Vali Acc: 0.380 Test Loss: 64.612 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.1229805946350098
Epoch: 6, Steps: 13 | Train Loss: 41.637 Vali Loss: 248.252 Vali Acc: 0.240 Test Loss: 248.252 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.188854694366455
Epoch: 7, Steps: 13 | Train Loss: 87.456 Vali Loss: 145.972 Vali Acc: 0.420 Test Loss: 145.972 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.1820366382598877
Epoch: 8, Steps: 13 | Train Loss: 73.314 Vali Loss: 156.890 Vali Acc: 0.360 Test Loss: 156.890 Test Acc: 0.360
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.1078596115112305
Epoch: 9, Steps: 13 | Train Loss: 58.841 Vali Loss: 182.486 Vali Acc: 0.380 Test Loss: 182.486 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.1788082122802734
Epoch: 10, Steps: 13 | Train Loss: 84.720 Vali Loss: 271.471 Vali Acc: 0.460 Test Loss: 271.471 Test Acc: 0.460
Validation loss decreased (-0.439383 --> -0.457285).  Saving model ...
Epoch: 11 cost time: 3.3340365886688232
Epoch: 11, Steps: 13 | Train Loss: 66.761 Vali Loss: 180.016 Vali Acc: 0.520 Test Loss: 180.016 Test Acc: 0.520
Validation loss decreased (-0.457285 --> -0.518200).  Saving model ...
Epoch: 12 cost time: 3.3128437995910645
Epoch: 12, Steps: 13 | Train Loss: 46.469 Vali Loss: 442.560 Vali Acc: 0.400 Test Loss: 442.560 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.4441721439361572
Epoch: 13, Steps: 13 | Train Loss: 65.249 Vali Loss: 296.463 Vali Acc: 0.400 Test Loss: 296.463 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.359961748123169
Epoch: 14, Steps: 13 | Train Loss: 49.555 Vali Loss: 213.881 Vali Acc: 0.540 Test Loss: 213.881 Test Acc: 0.540
Validation loss decreased (-0.518200 --> -0.537861).  Saving model ...
Epoch: 15 cost time: 3.362732172012329
Epoch: 15, Steps: 13 | Train Loss: 22.786 Vali Loss: 369.347 Vali Acc: 0.440 Test Loss: 369.347 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.2763710021972656
Epoch: 16, Steps: 13 | Train Loss: 122.116 Vali Loss: 271.321 Vali Acc: 0.460 Test Loss: 271.321 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.498318672180176
Epoch: 17, Steps: 13 | Train Loss: 75.190 Vali Loss: 394.338 Vali Acc: 0.320 Test Loss: 394.338 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.3284168243408203
Epoch: 18, Steps: 13 | Train Loss: 32.602 Vali Loss: 164.867 Vali Acc: 0.540 Test Loss: 164.867 Test Acc: 0.540
Validation loss decreased (-0.537861 --> -0.538351).  Saving model ...
Epoch: 19 cost time: 3.30368709564209
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 236.198 Vali Acc: 0.540 Test Loss: 236.198 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.5093822479248047
Epoch: 20, Steps: 13 | Train Loss: 43.452 Vali Loss: 257.902 Vali Acc: 0.520 Test Loss: 257.902 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.18906831741333
Epoch: 21, Steps: 13 | Train Loss: 41.337 Vali Loss: 398.805 Vali Acc: 0.400 Test Loss: 398.805 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.2563180923461914
Epoch: 22, Steps: 13 | Train Loss: 75.577 Vali Loss: 403.462 Vali Acc: 0.380 Test Loss: 403.462 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.150630235671997
Epoch: 23, Steps: 13 | Train Loss: 41.728 Vali Loss: 324.680 Vali Acc: 0.540 Test Loss: 324.680 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.3721389770507812
Epoch: 24, Steps: 13 | Train Loss: 18.457 Vali Loss: 312.039 Vali Acc: 0.500 Test Loss: 312.039 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.1892611980438232
Epoch: 25, Steps: 13 | Train Loss: 17.222 Vali Loss: 373.426 Vali Acc: 0.520 Test Loss: 373.426 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.413801908493042
Epoch: 26, Steps: 13 | Train Loss: 27.437 Vali Loss: 441.434 Vali Acc: 0.460 Test Loss: 441.434 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.492190361022949
Epoch: 27, Steps: 13 | Train Loss: 52.756 Vali Loss: 270.603 Vali Acc: 0.480 Test Loss: 270.603 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 3.2343146800994873
Epoch: 28, Steps: 13 | Train Loss: 53.742 Vali Loss: 368.919 Vali Acc: 0.360 Test Loss: 368.919 Test Acc: 0.360
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 25358749
model size : 99.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.2673444747924805
Epoch: 1, Steps: 13 | Train Loss: 45.118 Vali Loss: 81.305 Vali Acc: 0.200 Test Loss: 81.305 Test Acc: 0.200
Validation loss decreased (inf --> -0.199187).  Saving model ...
Epoch: 2 cost time: 3.333521842956543
Epoch: 2, Steps: 13 | Train Loss: 69.901 Vali Loss: 99.738 Vali Acc: 0.200 Test Loss: 99.738 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.286940336227417
Epoch: 3, Steps: 13 | Train Loss: 85.273 Vali Loss: 129.375 Vali Acc: 0.340 Test Loss: 129.375 Test Acc: 0.340
Validation loss decreased (-0.199187 --> -0.338706).  Saving model ...
Epoch: 4 cost time: 3.0855839252471924
Epoch: 4, Steps: 13 | Train Loss: 58.322 Vali Loss: 167.382 Vali Acc: 0.220 Test Loss: 167.382 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.095613479614258
Epoch: 5, Steps: 13 | Train Loss: 117.205 Vali Loss: 277.227 Vali Acc: 0.220 Test Loss: 277.227 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.1277475357055664
Epoch: 6, Steps: 13 | Train Loss: 147.719 Vali Loss: 159.908 Vali Acc: 0.400 Test Loss: 159.908 Test Acc: 0.400
Validation loss decreased (-0.338706 --> -0.398401).  Saving model ...
Epoch: 7 cost time: 3.1120808124542236
Epoch: 7, Steps: 13 | Train Loss: 66.170 Vali Loss: 144.188 Vali Acc: 0.360 Test Loss: 144.188 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.9666078090667725
Epoch: 8, Steps: 13 | Train Loss: 114.442 Vali Loss: 94.838 Vali Acc: 0.460 Test Loss: 94.838 Test Acc: 0.460
Validation loss decreased (-0.398401 --> -0.459052).  Saving model ...
Epoch: 9 cost time: 3.068333387374878
Epoch: 9, Steps: 13 | Train Loss: 90.178 Vali Loss: 174.173 Vali Acc: 0.360 Test Loss: 174.173 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.1573431491851807
Epoch: 10, Steps: 13 | Train Loss: 99.114 Vali Loss: 210.364 Vali Acc: 0.420 Test Loss: 210.364 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.165410280227661
Epoch: 11, Steps: 13 | Train Loss: 170.749 Vali Loss: 262.525 Vali Acc: 0.560 Test Loss: 262.525 Test Acc: 0.560
Validation loss decreased (-0.459052 --> -0.557375).  Saving model ...
Epoch: 12 cost time: 3.2285664081573486
Epoch: 12, Steps: 13 | Train Loss: 40.112 Vali Loss: 346.134 Vali Acc: 0.260 Test Loss: 346.134 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.1217117309570312
Epoch: 13, Steps: 13 | Train Loss: 57.466 Vali Loss: 187.004 Vali Acc: 0.540 Test Loss: 187.004 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.2309763431549072
Epoch: 14, Steps: 13 | Train Loss: 36.403 Vali Loss: 206.527 Vali Acc: 0.580 Test Loss: 206.527 Test Acc: 0.580
Validation loss decreased (-0.557375 --> -0.577935).  Saving model ...
Epoch: 15 cost time: 3.114409923553467
Epoch: 15, Steps: 13 | Train Loss: 50.371 Vali Loss: 270.789 Vali Acc: 0.500 Test Loss: 270.789 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.0660924911499023
Epoch: 16, Steps: 13 | Train Loss: 21.399 Vali Loss: 272.578 Vali Acc: 0.440 Test Loss: 272.578 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.2119953632354736
Epoch: 17, Steps: 13 | Train Loss: 4.316 Vali Loss: 203.035 Vali Acc: 0.560 Test Loss: 203.035 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.1794636249542236
Epoch: 18, Steps: 13 | Train Loss: 7.074 Vali Loss: 182.545 Vali Acc: 0.600 Test Loss: 182.545 Test Acc: 0.600
Validation loss decreased (-0.577935 --> -0.598175).  Saving model ...
Epoch: 19 cost time: 3.431072473526001
Epoch: 19, Steps: 13 | Train Loss: 16.287 Vali Loss: 357.887 Vali Acc: 0.480 Test Loss: 357.887 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.2759931087493896
Epoch: 20, Steps: 13 | Train Loss: 21.620 Vali Loss: 405.508 Vali Acc: 0.500 Test Loss: 405.508 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.1544623374938965
Epoch: 21, Steps: 13 | Train Loss: 58.874 Vali Loss: 538.327 Vali Acc: 0.400 Test Loss: 538.327 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.251767635345459
Epoch: 22, Steps: 13 | Train Loss: 64.356 Vali Loss: 321.031 Vali Acc: 0.520 Test Loss: 321.031 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.1851649284362793
Epoch: 23, Steps: 13 | Train Loss: 17.593 Vali Loss: 449.438 Vali Acc: 0.380 Test Loss: 449.438 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.096956491470337
Epoch: 24, Steps: 13 | Train Loss: 11.353 Vali Loss: 300.056 Vali Acc: 0.540 Test Loss: 300.056 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.028522491455078
Epoch: 25, Steps: 13 | Train Loss: 0.333 Vali Loss: 299.887 Vali Acc: 0.580 Test Loss: 299.887 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.08849835395813
Epoch: 26, Steps: 13 | Train Loss: 17.747 Vali Loss: 179.772 Vali Acc: 0.640 Test Loss: 179.772 Test Acc: 0.640
Validation loss decreased (-0.598175 --> -0.638202).  Saving model ...
Epoch: 27 cost time: 3.277014970779419
Epoch: 27, Steps: 13 | Train Loss: 4.465 Vali Loss: 336.219 Vali Acc: 0.500 Test Loss: 336.219 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.059403419494629
Epoch: 28, Steps: 13 | Train Loss: 11.109 Vali Loss: 348.007 Vali Acc: 0.520 Test Loss: 348.007 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.2321648597717285
Epoch: 29, Steps: 13 | Train Loss: 5.324 Vali Loss: 291.907 Vali Acc: 0.520 Test Loss: 291.907 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.113748550415039
Epoch: 30, Steps: 13 | Train Loss: 3.085 Vali Loss: 401.510 Vali Acc: 0.540 Test Loss: 401.510 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.1032872200012207
Epoch: 31, Steps: 13 | Train Loss: 35.727 Vali Loss: 540.243 Vali Acc: 0.460 Test Loss: 540.243 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 3.070502758026123
Epoch: 32, Steps: 13 | Train Loss: 95.599 Vali Loss: 434.193 Vali Acc: 0.540 Test Loss: 434.193 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 3.210975408554077
Epoch: 33, Steps: 13 | Train Loss: 4.302 Vali Loss: 578.558 Vali Acc: 0.380 Test Loss: 578.558 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 3.1888957023620605
Epoch: 34, Steps: 13 | Train Loss: 10.154 Vali Loss: 509.194 Vali Acc: 0.440 Test Loss: 509.194 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 3.1621952056884766
Epoch: 35, Steps: 13 | Train Loss: 0.000 Vali Loss: 635.876 Vali Acc: 0.340 Test Loss: 635.876 Test Acc: 0.340
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 3.199195146560669
Epoch: 36, Steps: 13 | Train Loss: 1.642 Vali Loss: 501.219 Vali Acc: 0.500 Test Loss: 501.219 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.64
model parameter : 25355805
model size : 99.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.135620594024658
Epoch: 1, Steps: 13 | Train Loss: 33.725 Vali Loss: 95.862 Vali Acc: 0.200 Test Loss: 95.862 Test Acc: 0.200
Validation loss decreased (inf --> -0.199041).  Saving model ...
Epoch: 2 cost time: 3.067775011062622
Epoch: 2, Steps: 13 | Train Loss: 74.976 Vali Loss: 193.017 Vali Acc: 0.220 Test Loss: 193.017 Test Acc: 0.220
Validation loss decreased (-0.199041 --> -0.218070).  Saving model ...
Epoch: 3 cost time: 3.188009738922119
Epoch: 3, Steps: 13 | Train Loss: 111.283 Vali Loss: 154.616 Vali Acc: 0.200 Test Loss: 154.616 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.347357749938965
Epoch: 4, Steps: 13 | Train Loss: 57.651 Vali Loss: 112.932 Vali Acc: 0.280 Test Loss: 112.932 Test Acc: 0.280
Validation loss decreased (-0.218070 --> -0.278871).  Saving model ...
Epoch: 5 cost time: 3.1549267768859863
Epoch: 5, Steps: 13 | Train Loss: 83.242 Vali Loss: 233.469 Vali Acc: 0.320 Test Loss: 233.469 Test Acc: 0.320
Validation loss decreased (-0.278871 --> -0.317665).  Saving model ...
Epoch: 6 cost time: 3.2342207431793213
Epoch: 6, Steps: 13 | Train Loss: 193.962 Vali Loss: 256.237 Vali Acc: 0.200 Test Loss: 256.237 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.21661639213562
Epoch: 7, Steps: 13 | Train Loss: 112.494 Vali Loss: 305.900 Vali Acc: 0.340 Test Loss: 305.900 Test Acc: 0.340
Validation loss decreased (-0.317665 --> -0.336941).  Saving model ...
Epoch: 8 cost time: 3.0700278282165527
Epoch: 8, Steps: 13 | Train Loss: 129.328 Vali Loss: 270.172 Vali Acc: 0.320 Test Loss: 270.172 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.0001025199890137
Epoch: 9, Steps: 13 | Train Loss: 92.482 Vali Loss: 181.091 Vali Acc: 0.360 Test Loss: 181.091 Test Acc: 0.360
Validation loss decreased (-0.336941 --> -0.358189).  Saving model ...
Epoch: 10 cost time: 2.979336977005005
Epoch: 10, Steps: 13 | Train Loss: 83.311 Vali Loss: 181.289 Vali Acc: 0.500 Test Loss: 181.289 Test Acc: 0.500
Validation loss decreased (-0.358189 --> -0.498187).  Saving model ...
Epoch: 11 cost time: 3.376828670501709
Epoch: 11, Steps: 13 | Train Loss: 20.768 Vali Loss: 184.594 Vali Acc: 0.420 Test Loss: 184.594 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.3017725944519043
Epoch: 12, Steps: 13 | Train Loss: 47.648 Vali Loss: 248.193 Vali Acc: 0.460 Test Loss: 248.193 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.4758119583129883
Epoch: 13, Steps: 13 | Train Loss: 91.726 Vali Loss: 274.983 Vali Acc: 0.420 Test Loss: 274.983 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.1546244621276855
Epoch: 14, Steps: 13 | Train Loss: 31.838 Vali Loss: 237.119 Vali Acc: 0.480 Test Loss: 237.119 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.3064024448394775
Epoch: 15, Steps: 13 | Train Loss: 53.463 Vali Loss: 199.083 Vali Acc: 0.580 Test Loss: 199.083 Test Acc: 0.580
Validation loss decreased (-0.498187 --> -0.578009).  Saving model ...
Epoch: 16 cost time: 3.2879486083984375
Epoch: 16, Steps: 13 | Train Loss: 6.089 Vali Loss: 266.722 Vali Acc: 0.500 Test Loss: 266.722 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.325138568878174
Epoch: 17, Steps: 13 | Train Loss: 64.404 Vali Loss: 389.137 Vali Acc: 0.380 Test Loss: 389.137 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.2926790714263916
Epoch: 18, Steps: 13 | Train Loss: 32.663 Vali Loss: 359.836 Vali Acc: 0.440 Test Loss: 359.836 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.4892525672912598
Epoch: 19, Steps: 13 | Train Loss: 151.179 Vali Loss: 252.537 Vali Acc: 0.520 Test Loss: 252.537 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.3416996002197266
Epoch: 20, Steps: 13 | Train Loss: 28.063 Vali Loss: 288.104 Vali Acc: 0.580 Test Loss: 288.104 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.1651883125305176
Epoch: 21, Steps: 13 | Train Loss: 31.237 Vali Loss: 340.820 Vali Acc: 0.520 Test Loss: 340.820 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.393967628479004
Epoch: 22, Steps: 13 | Train Loss: 11.644 Vali Loss: 331.651 Vali Acc: 0.460 Test Loss: 331.651 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.310112476348877
Epoch: 23, Steps: 13 | Train Loss: 18.700 Vali Loss: 274.699 Vali Acc: 0.520 Test Loss: 274.699 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.208723545074463
Epoch: 24, Steps: 13 | Train Loss: 10.371 Vali Loss: 235.446 Vali Acc: 0.580 Test Loss: 235.446 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.459132671356201
Epoch: 25, Steps: 13 | Train Loss: 14.614 Vali Loss: 403.929 Vali Acc: 0.400 Test Loss: 403.929 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 25352861
model size : 99.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.548755168914795
Epoch: 1, Steps: 13 | Train Loss: 27.638 Vali Loss: 77.845 Vali Acc: 0.200 Test Loss: 77.845 Test Acc: 0.200
Validation loss decreased (inf --> -0.199222).  Saving model ...
Epoch: 2 cost time: 2.9703664779663086
Epoch: 2, Steps: 13 | Train Loss: 67.261 Vali Loss: 98.700 Vali Acc: 0.200 Test Loss: 98.700 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.0660228729248047
Epoch: 3, Steps: 13 | Train Loss: 96.589 Vali Loss: 212.057 Vali Acc: 0.200 Test Loss: 212.057 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.0799715518951416
Epoch: 4, Steps: 13 | Train Loss: 189.728 Vali Loss: 114.985 Vali Acc: 0.240 Test Loss: 114.985 Test Acc: 0.240
Validation loss decreased (-0.199222 --> -0.238850).  Saving model ...
Epoch: 5 cost time: 2.868748664855957
Epoch: 5, Steps: 13 | Train Loss: 55.031 Vali Loss: 119.783 Vali Acc: 0.200 Test Loss: 119.783 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.9844677448272705
Epoch: 6, Steps: 13 | Train Loss: 119.004 Vali Loss: 551.131 Vali Acc: 0.200 Test Loss: 551.131 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.03208589553833
Epoch: 7, Steps: 13 | Train Loss: 263.046 Vali Loss: 275.804 Vali Acc: 0.280 Test Loss: 275.804 Test Acc: 0.280
Validation loss decreased (-0.238850 --> -0.277242).  Saving model ...
Epoch: 8 cost time: 2.898982048034668
Epoch: 8, Steps: 13 | Train Loss: 130.195 Vali Loss: 208.651 Vali Acc: 0.400 Test Loss: 208.651 Test Acc: 0.400
Validation loss decreased (-0.277242 --> -0.397913).  Saving model ...
Epoch: 9 cost time: 2.9015238285064697
Epoch: 9, Steps: 13 | Train Loss: 139.044 Vali Loss: 137.330 Vali Acc: 0.540 Test Loss: 137.330 Test Acc: 0.540
Validation loss decreased (-0.397913 --> -0.538627).  Saving model ...
Epoch: 10 cost time: 3.0271401405334473
Epoch: 10, Steps: 13 | Train Loss: 36.249 Vali Loss: 234.811 Vali Acc: 0.400 Test Loss: 234.811 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.0115132331848145
Epoch: 11, Steps: 13 | Train Loss: 34.408 Vali Loss: 165.783 Vali Acc: 0.500 Test Loss: 165.783 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.872997522354126
Epoch: 12, Steps: 13 | Train Loss: 33.377 Vali Loss: 222.572 Vali Acc: 0.380 Test Loss: 222.572 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.8968746662139893
Epoch: 13, Steps: 13 | Train Loss: 84.453 Vali Loss: 185.554 Vali Acc: 0.460 Test Loss: 185.554 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.333124876022339
Epoch: 14, Steps: 13 | Train Loss: 151.519 Vali Loss: 309.273 Vali Acc: 0.440 Test Loss: 309.273 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.966442584991455
Epoch: 15, Steps: 13 | Train Loss: 147.205 Vali Loss: 336.283 Vali Acc: 0.580 Test Loss: 336.283 Test Acc: 0.580
Validation loss decreased (-0.538627 --> -0.576637).  Saving model ...
Epoch: 16 cost time: 2.9414563179016113
Epoch: 16, Steps: 13 | Train Loss: 80.154 Vali Loss: 287.992 Vali Acc: 0.460 Test Loss: 287.992 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.034212827682495
Epoch: 17, Steps: 13 | Train Loss: 56.276 Vali Loss: 330.963 Vali Acc: 0.480 Test Loss: 330.963 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.0258798599243164
Epoch: 18, Steps: 13 | Train Loss: 48.497 Vali Loss: 361.767 Vali Acc: 0.560 Test Loss: 361.767 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.8592960834503174
Epoch: 19, Steps: 13 | Train Loss: 40.357 Vali Loss: 558.698 Vali Acc: 0.340 Test Loss: 558.698 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.985192060470581
Epoch: 20, Steps: 13 | Train Loss: 88.507 Vali Loss: 324.635 Vali Acc: 0.540 Test Loss: 324.635 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.0637989044189453
Epoch: 21, Steps: 13 | Train Loss: 44.136 Vali Loss: 312.844 Vali Acc: 0.540 Test Loss: 312.844 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.003284454345703
Epoch: 22, Steps: 13 | Train Loss: 0.000 Vali Loss: 167.198 Vali Acc: 0.600 Test Loss: 167.198 Test Acc: 0.600
Validation loss decreased (-0.576637 --> -0.598328).  Saving model ...
Epoch: 23 cost time: 2.939464807510376
Epoch: 23, Steps: 13 | Train Loss: 0.000 Vali Loss: 160.869 Vali Acc: 0.680 Test Loss: 160.869 Test Acc: 0.680
Validation loss decreased (-0.598328 --> -0.678391).  Saving model ...
Epoch: 24 cost time: 3.1208608150482178
Epoch: 24, Steps: 13 | Train Loss: 23.472 Vali Loss: 239.195 Vali Acc: 0.600 Test Loss: 239.195 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.950761556625366
Epoch: 25, Steps: 13 | Train Loss: 55.958 Vali Loss: 376.958 Vali Acc: 0.480 Test Loss: 376.958 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.943241834640503
Epoch: 26, Steps: 13 | Train Loss: 1.411 Vali Loss: 236.208 Vali Acc: 0.600 Test Loss: 236.208 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.918206214904785
Epoch: 27, Steps: 13 | Train Loss: 2.450 Vali Loss: 350.737 Vali Acc: 0.480 Test Loss: 350.737 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.993074893951416
Epoch: 28, Steps: 13 | Train Loss: 0.000 Vali Loss: 322.772 Vali Acc: 0.560 Test Loss: 322.772 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.8776514530181885
Epoch: 29, Steps: 13 | Train Loss: 2.105 Vali Loss: 354.941 Vali Acc: 0.640 Test Loss: 354.941 Test Acc: 0.640
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.0397493839263916
Epoch: 30, Steps: 13 | Train Loss: 0.000 Vali Loss: 510.387 Vali Acc: 0.440 Test Loss: 510.387 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.973518133163452
Epoch: 31, Steps: 13 | Train Loss: 13.810 Vali Loss: 578.204 Vali Acc: 0.480 Test Loss: 578.204 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.9976844787597656
Epoch: 32, Steps: 13 | Train Loss: 26.511 Vali Loss: 600.726 Vali Acc: 0.440 Test Loss: 600.726 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.9008564949035645
Epoch: 33, Steps: 13 | Train Loss: 4.138 Vali Loss: 415.274 Vali Acc: 0.580 Test Loss: 415.274 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.68
model parameter : 24966941
model size : 97.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.598523139953613
Epoch: 1, Steps: 13 | Train Loss: 35.361 Vali Loss: 45.513 Vali Acc: 0.240 Test Loss: 45.513 Test Acc: 0.240
Validation loss decreased (inf --> -0.239545).  Saving model ...
Epoch: 2 cost time: 3.0368382930755615
Epoch: 2, Steps: 13 | Train Loss: 59.610 Vali Loss: 105.053 Vali Acc: 0.200 Test Loss: 105.053 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.831747055053711
Epoch: 3, Steps: 13 | Train Loss: 86.620 Vali Loss: 109.307 Vali Acc: 0.260 Test Loss: 109.307 Test Acc: 0.260
Validation loss decreased (-0.239545 --> -0.258907).  Saving model ...
Epoch: 4 cost time: 3.0490574836730957
Epoch: 4, Steps: 13 | Train Loss: 78.020 Vali Loss: 183.897 Vali Acc: 0.320 Test Loss: 183.897 Test Acc: 0.320
Validation loss decreased (-0.258907 --> -0.318161).  Saving model ...
Epoch: 5 cost time: 2.96230149269104
Epoch: 5, Steps: 13 | Train Loss: 90.543 Vali Loss: 83.544 Vali Acc: 0.360 Test Loss: 83.544 Test Acc: 0.360
Validation loss decreased (-0.318161 --> -0.359165).  Saving model ...
Epoch: 6 cost time: 2.9631428718566895
Epoch: 6, Steps: 13 | Train Loss: 121.316 Vali Loss: 173.360 Vali Acc: 0.220 Test Loss: 173.360 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.179821014404297
Epoch: 7, Steps: 13 | Train Loss: 59.365 Vali Loss: 139.431 Vali Acc: 0.460 Test Loss: 139.431 Test Acc: 0.460
Validation loss decreased (-0.359165 --> -0.458606).  Saving model ...
Epoch: 8 cost time: 2.9585952758789062
Epoch: 8, Steps: 13 | Train Loss: 68.167 Vali Loss: 209.204 Vali Acc: 0.440 Test Loss: 209.204 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.97481369972229
Epoch: 9, Steps: 13 | Train Loss: 122.675 Vali Loss: 280.395 Vali Acc: 0.240 Test Loss: 280.395 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.1530227661132812
Epoch: 10, Steps: 13 | Train Loss: 114.977 Vali Loss: 240.052 Vali Acc: 0.300 Test Loss: 240.052 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.99988055229187
Epoch: 11, Steps: 13 | Train Loss: 69.538 Vali Loss: 245.412 Vali Acc: 0.460 Test Loss: 245.412 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.974682331085205
Epoch: 12, Steps: 13 | Train Loss: 32.112 Vali Loss: 311.289 Vali Acc: 0.340 Test Loss: 311.289 Test Acc: 0.340
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.0665299892425537
Epoch: 13, Steps: 13 | Train Loss: 95.296 Vali Loss: 359.018 Vali Acc: 0.380 Test Loss: 359.018 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.283484935760498
Epoch: 14, Steps: 13 | Train Loss: 100.496 Vali Loss: 216.490 Vali Acc: 0.420 Test Loss: 216.490 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.0310819149017334
Epoch: 15, Steps: 13 | Train Loss: 16.599 Vali Loss: 309.076 Vali Acc: 0.460 Test Loss: 309.076 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.1444458961486816
Epoch: 16, Steps: 13 | Train Loss: 33.320 Vali Loss: 482.527 Vali Acc: 0.440 Test Loss: 482.527 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.949495553970337
Epoch: 17, Steps: 13 | Train Loss: 149.554 Vali Loss: 509.095 Vali Acc: 0.440 Test Loss: 509.095 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.46
model parameter : 24963997
model size : 97.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.6118669509887695
Epoch: 1, Steps: 13 | Train Loss: 46.202 Vali Loss: 35.688 Vali Acc: 0.200 Test Loss: 35.688 Test Acc: 0.200
Validation loss decreased (inf --> -0.199643).  Saving model ...
Epoch: 2 cost time: 3.005554676055908
Epoch: 2, Steps: 13 | Train Loss: 110.901 Vali Loss: 163.659 Vali Acc: 0.220 Test Loss: 163.659 Test Acc: 0.220
Validation loss decreased (-0.199643 --> -0.218363).  Saving model ...
Epoch: 3 cost time: 3.069443464279175
Epoch: 3, Steps: 13 | Train Loss: 94.166 Vali Loss: 103.030 Vali Acc: 0.280 Test Loss: 103.030 Test Acc: 0.280
Validation loss decreased (-0.218363 --> -0.278970).  Saving model ...
Epoch: 4 cost time: 2.953252077102661
Epoch: 4, Steps: 13 | Train Loss: 105.753 Vali Loss: 119.218 Vali Acc: 0.260 Test Loss: 119.218 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.9661660194396973
Epoch: 5, Steps: 13 | Train Loss: 86.575 Vali Loss: 218.894 Vali Acc: 0.240 Test Loss: 218.894 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.9778265953063965
Epoch: 6, Steps: 13 | Train Loss: 128.053 Vali Loss: 139.343 Vali Acc: 0.340 Test Loss: 139.343 Test Acc: 0.340
Validation loss decreased (-0.278970 --> -0.338607).  Saving model ...
Epoch: 7 cost time: 3.1873064041137695
Epoch: 7, Steps: 13 | Train Loss: 106.337 Vali Loss: 276.654 Vali Acc: 0.200 Test Loss: 276.654 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.9160523414611816
Epoch: 8, Steps: 13 | Train Loss: 99.155 Vali Loss: 174.111 Vali Acc: 0.400 Test Loss: 174.111 Test Acc: 0.400
Validation loss decreased (-0.338607 --> -0.398259).  Saving model ...
Epoch: 9 cost time: 2.974140167236328
Epoch: 9, Steps: 13 | Train Loss: 31.767 Vali Loss: 188.615 Vali Acc: 0.400 Test Loss: 188.615 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.020214557647705
Epoch: 10, Steps: 13 | Train Loss: 44.806 Vali Loss: 202.809 Vali Acc: 0.460 Test Loss: 202.809 Test Acc: 0.460
Validation loss decreased (-0.398259 --> -0.457972).  Saving model ...
Epoch: 11 cost time: 2.9353275299072266
Epoch: 11, Steps: 13 | Train Loss: 36.212 Vali Loss: 186.938 Vali Acc: 0.360 Test Loss: 186.938 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.9649338722229004
Epoch: 12, Steps: 13 | Train Loss: 59.885 Vali Loss: 155.823 Vali Acc: 0.500 Test Loss: 155.823 Test Acc: 0.500
Validation loss decreased (-0.457972 --> -0.498442).  Saving model ...
Epoch: 13 cost time: 2.8992350101470947
Epoch: 13, Steps: 13 | Train Loss: 83.978 Vali Loss: 216.278 Vali Acc: 0.460 Test Loss: 216.278 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.9500513076782227
Epoch: 14, Steps: 13 | Train Loss: 66.254 Vali Loss: 340.275 Vali Acc: 0.500 Test Loss: 340.275 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.9972100257873535
Epoch: 15, Steps: 13 | Train Loss: 39.893 Vali Loss: 295.234 Vali Acc: 0.500 Test Loss: 295.234 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.96958065032959
Epoch: 16, Steps: 13 | Train Loss: 88.937 Vali Loss: 510.468 Vali Acc: 0.400 Test Loss: 510.468 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.256359815597534
Epoch: 17, Steps: 13 | Train Loss: 133.818 Vali Loss: 308.951 Vali Acc: 0.480 Test Loss: 308.951 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.9749369621276855
Epoch: 18, Steps: 13 | Train Loss: 85.009 Vali Loss: 237.650 Vali Acc: 0.520 Test Loss: 237.650 Test Acc: 0.520
Validation loss decreased (-0.498442 --> -0.517623).  Saving model ...
Epoch: 19 cost time: 2.971834659576416
Epoch: 19, Steps: 13 | Train Loss: 32.680 Vali Loss: 388.467 Vali Acc: 0.480 Test Loss: 388.467 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.1018893718719482
Epoch: 20, Steps: 13 | Train Loss: 53.646 Vali Loss: 310.224 Vali Acc: 0.500 Test Loss: 310.224 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.0658020973205566
Epoch: 21, Steps: 13 | Train Loss: 14.906 Vali Loss: 442.028 Vali Acc: 0.420 Test Loss: 442.028 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.002408027648926
Epoch: 22, Steps: 13 | Train Loss: 34.782 Vali Loss: 312.755 Vali Acc: 0.400 Test Loss: 312.755 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.967365026473999
Epoch: 23, Steps: 13 | Train Loss: 29.332 Vali Loss: 271.608 Vali Acc: 0.560 Test Loss: 271.608 Test Acc: 0.560
Validation loss decreased (-0.517623 --> -0.557284).  Saving model ...
Epoch: 24 cost time: 2.9784393310546875
Epoch: 24, Steps: 13 | Train Loss: 20.428 Vali Loss: 316.941 Vali Acc: 0.580 Test Loss: 316.941 Test Acc: 0.580
Validation loss decreased (-0.557284 --> -0.576831).  Saving model ...
Epoch: 25 cost time: 2.842135429382324
Epoch: 25, Steps: 13 | Train Loss: 7.075 Vali Loss: 320.339 Vali Acc: 0.600 Test Loss: 320.339 Test Acc: 0.600
Validation loss decreased (-0.576831 --> -0.596797).  Saving model ...
Epoch: 26 cost time: 3.060551404953003
Epoch: 26, Steps: 13 | Train Loss: 14.341 Vali Loss: 363.402 Vali Acc: 0.600 Test Loss: 363.402 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.001399517059326
Epoch: 27, Steps: 13 | Train Loss: 7.923 Vali Loss: 424.648 Vali Acc: 0.440 Test Loss: 424.648 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.963677167892456
Epoch: 28, Steps: 13 | Train Loss: 14.682 Vali Loss: 764.280 Vali Acc: 0.440 Test Loss: 764.280 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.997246503829956
Epoch: 29, Steps: 13 | Train Loss: 82.232 Vali Loss: 459.984 Vali Acc: 0.560 Test Loss: 459.984 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.2215733528137207
Epoch: 30, Steps: 13 | Train Loss: 16.396 Vali Loss: 946.719 Vali Acc: 0.480 Test Loss: 946.719 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.9173333644866943
Epoch: 31, Steps: 13 | Train Loss: 156.763 Vali Loss: 538.854 Vali Acc: 0.560 Test Loss: 538.854 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 3.081836462020874
Epoch: 32, Steps: 13 | Train Loss: 53.293 Vali Loss: 385.036 Vali Acc: 0.600 Test Loss: 385.036 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 3.291201591491699
Epoch: 33, Steps: 13 | Train Loss: 31.885 Vali Loss: 501.735 Vali Acc: 0.520 Test Loss: 501.735 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 3.1357312202453613
Epoch: 34, Steps: 13 | Train Loss: 48.598 Vali Loss: 479.941 Vali Acc: 0.520 Test Loss: 479.941 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.9134154319763184
Epoch: 35, Steps: 13 | Train Loss: 41.177 Vali Loss: 360.774 Vali Acc: 0.660 Test Loss: 360.774 Test Acc: 0.660
Validation loss decreased (-0.596797 --> -0.656392).  Saving model ...
Epoch: 36 cost time: 3.1028783321380615
Epoch: 36, Steps: 13 | Train Loss: 0.000 Vali Loss: 577.573 Vali Acc: 0.560 Test Loss: 577.573 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.160327196121216
Epoch: 37, Steps: 13 | Train Loss: 16.834 Vali Loss: 486.982 Vali Acc: 0.520 Test Loss: 486.982 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.9474105834960938
Epoch: 38, Steps: 13 | Train Loss: 14.061 Vali Loss: 458.546 Vali Acc: 0.560 Test Loss: 458.546 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 2.8802878856658936
Epoch: 39, Steps: 13 | Train Loss: 5.700 Vali Loss: 441.745 Vali Acc: 0.560 Test Loss: 441.745 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 3.0206847190856934
Epoch: 40, Steps: 13 | Train Loss: 0.000 Vali Loss: 419.131 Vali Acc: 0.540 Test Loss: 419.131 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 2.9297049045562744
Epoch: 41, Steps: 13 | Train Loss: 0.000 Vali Loss: 445.795 Vali Acc: 0.560 Test Loss: 445.795 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 2.8945279121398926
Epoch: 42, Steps: 13 | Train Loss: 0.000 Vali Loss: 453.528 Vali Acc: 0.600 Test Loss: 453.528 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 2.877546548843384
Epoch: 43, Steps: 13 | Train Loss: 0.000 Vali Loss: 455.565 Vali Acc: 0.600 Test Loss: 455.565 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 2.9979937076568604
Epoch: 44, Steps: 13 | Train Loss: 0.000 Vali Loss: 456.095 Vali Acc: 0.600 Test Loss: 456.095 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 2.8723652362823486
Epoch: 45, Steps: 13 | Train Loss: 0.000 Vali Loss: 456.233 Vali Acc: 0.600 Test Loss: 456.233 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.66
model parameter : 24961053
model size : 97.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.335578203201294
Epoch: 1, Steps: 13 | Train Loss: 41.720 Vali Loss: 53.686 Vali Acc: 0.220 Test Loss: 53.686 Test Acc: 0.220
Validation loss decreased (inf --> -0.219463).  Saving model ...
Epoch: 2 cost time: 2.8310647010803223
Epoch: 2, Steps: 13 | Train Loss: 59.375 Vali Loss: 198.552 Vali Acc: 0.200 Test Loss: 198.552 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.782792568206787
Epoch: 3, Steps: 13 | Train Loss: 112.784 Vali Loss: 113.889 Vali Acc: 0.220 Test Loss: 113.889 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.077070713043213
Epoch: 4, Steps: 13 | Train Loss: 85.926 Vali Loss: 85.924 Vali Acc: 0.220 Test Loss: 85.924 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.8707199096679688
Epoch: 5, Steps: 13 | Train Loss: 74.708 Vali Loss: 127.244 Vali Acc: 0.280 Test Loss: 127.244 Test Acc: 0.280
Validation loss decreased (-0.219463 --> -0.278728).  Saving model ...
Epoch: 6 cost time: 2.8223507404327393
Epoch: 6, Steps: 13 | Train Loss: 70.683 Vali Loss: 131.314 Vali Acc: 0.280 Test Loss: 131.314 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.8590610027313232
Epoch: 7, Steps: 13 | Train Loss: 66.645 Vali Loss: 159.224 Vali Acc: 0.360 Test Loss: 159.224 Test Acc: 0.360
Validation loss decreased (-0.278728 --> -0.358408).  Saving model ...
Epoch: 8 cost time: 2.75246524810791
Epoch: 8, Steps: 13 | Train Loss: 62.477 Vali Loss: 156.902 Vali Acc: 0.380 Test Loss: 156.902 Test Acc: 0.380
Validation loss decreased (-0.358408 --> -0.378431).  Saving model ...
Epoch: 9 cost time: 2.748807430267334
Epoch: 9, Steps: 13 | Train Loss: 89.618 Vali Loss: 152.798 Vali Acc: 0.340 Test Loss: 152.798 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.8398659229278564
Epoch: 10, Steps: 13 | Train Loss: 46.038 Vali Loss: 301.369 Vali Acc: 0.260 Test Loss: 301.369 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.025808334350586
Epoch: 11, Steps: 13 | Train Loss: 137.494 Vali Loss: 215.124 Vali Acc: 0.480 Test Loss: 215.124 Test Acc: 0.480
Validation loss decreased (-0.378431 --> -0.477849).  Saving model ...
Epoch: 12 cost time: 2.962968111038208
Epoch: 12, Steps: 13 | Train Loss: 11.372 Vali Loss: 293.935 Vali Acc: 0.400 Test Loss: 293.935 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.8734562397003174
Epoch: 13, Steps: 13 | Train Loss: 103.215 Vali Loss: 242.899 Vali Acc: 0.380 Test Loss: 242.899 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.9585914611816406
Epoch: 14, Steps: 13 | Train Loss: 104.008 Vali Loss: 400.110 Vali Acc: 0.280 Test Loss: 400.110 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.7908706665039062
Epoch: 15, Steps: 13 | Train Loss: 182.171 Vali Loss: 614.969 Vali Acc: 0.420 Test Loss: 614.969 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.9292709827423096
Epoch: 16, Steps: 13 | Train Loss: 140.110 Vali Loss: 276.832 Vali Acc: 0.460 Test Loss: 276.832 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.903090238571167
Epoch: 17, Steps: 13 | Train Loss: 69.976 Vali Loss: 301.079 Vali Acc: 0.460 Test Loss: 301.079 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.886715888977051
Epoch: 18, Steps: 13 | Train Loss: 43.548 Vali Loss: 550.813 Vali Acc: 0.460 Test Loss: 550.813 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.8730242252349854
Epoch: 19, Steps: 13 | Train Loss: 112.560 Vali Loss: 502.414 Vali Acc: 0.400 Test Loss: 502.414 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.137565851211548
Epoch: 20, Steps: 13 | Train Loss: 36.648 Vali Loss: 256.369 Vali Acc: 0.600 Test Loss: 256.369 Test Acc: 0.600
Validation loss decreased (-0.477849 --> -0.597436).  Saving model ...
Epoch: 21 cost time: 2.8055148124694824
Epoch: 21, Steps: 13 | Train Loss: 24.215 Vali Loss: 159.536 Vali Acc: 0.620 Test Loss: 159.536 Test Acc: 0.620
Validation loss decreased (-0.597436 --> -0.618405).  Saving model ...
Epoch: 22 cost time: 2.82035756111145
Epoch: 22, Steps: 13 | Train Loss: 11.844 Vali Loss: 173.731 Vali Acc: 0.640 Test Loss: 173.731 Test Acc: 0.640
Validation loss decreased (-0.618405 --> -0.638263).  Saving model ...
Epoch: 23 cost time: 3.0228123664855957
Epoch: 23, Steps: 13 | Train Loss: 2.908 Vali Loss: 248.920 Vali Acc: 0.540 Test Loss: 248.920 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.889829635620117
Epoch: 24, Steps: 13 | Train Loss: 12.577 Vali Loss: 292.844 Vali Acc: 0.540 Test Loss: 292.844 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.852170705795288
Epoch: 25, Steps: 13 | Train Loss: 8.223 Vali Loss: 236.485 Vali Acc: 0.600 Test Loss: 236.485 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.026787757873535
Epoch: 26, Steps: 13 | Train Loss: 1.898 Vali Loss: 270.266 Vali Acc: 0.540 Test Loss: 270.266 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.8758575916290283
Epoch: 27, Steps: 13 | Train Loss: 35.409 Vali Loss: 371.977 Vali Acc: 0.440 Test Loss: 371.977 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.830277442932129
Epoch: 28, Steps: 13 | Train Loss: 61.699 Vali Loss: 360.710 Vali Acc: 0.440 Test Loss: 360.710 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.8805785179138184
Epoch: 29, Steps: 13 | Train Loss: 9.419 Vali Loss: 388.557 Vali Acc: 0.520 Test Loss: 388.557 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.9856669902801514
Epoch: 30, Steps: 13 | Train Loss: 10.949 Vali Loss: 425.979 Vali Acc: 0.480 Test Loss: 425.979 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.8966729640960693
Epoch: 31, Steps: 13 | Train Loss: 7.398 Vali Loss: 342.255 Vali Acc: 0.500 Test Loss: 342.255 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.9679195880889893
Epoch: 32, Steps: 13 | Train Loss: 9.774 Vali Loss: 521.515 Vali Acc: 0.420 Test Loss: 521.515 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.64
model parameter : 24958109
model size : 97.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.5713889598846436
Epoch: 1, Steps: 13 | Train Loss: 19.194 Vali Loss: 44.575 Vali Acc: 0.260 Test Loss: 44.575 Test Acc: 0.260
Validation loss decreased (inf --> -0.259554).  Saving model ...
Epoch: 2 cost time: 2.8093721866607666
Epoch: 2, Steps: 13 | Train Loss: 48.400 Vali Loss: 62.567 Vali Acc: 0.320 Test Loss: 62.567 Test Acc: 0.320
Validation loss decreased (-0.259554 --> -0.319374).  Saving model ...
Epoch: 3 cost time: 2.823589324951172
Epoch: 3, Steps: 13 | Train Loss: 67.889 Vali Loss: 43.637 Vali Acc: 0.340 Test Loss: 43.637 Test Acc: 0.340
Validation loss decreased (-0.319374 --> -0.339564).  Saving model ...
Epoch: 4 cost time: 2.8022239208221436
Epoch: 4, Steps: 13 | Train Loss: 38.178 Vali Loss: 87.996 Vali Acc: 0.380 Test Loss: 87.996 Test Acc: 0.380
Validation loss decreased (-0.339564 --> -0.379120).  Saving model ...
Epoch: 5 cost time: 2.89424729347229
Epoch: 5, Steps: 13 | Train Loss: 77.331 Vali Loss: 105.985 Vali Acc: 0.260 Test Loss: 105.985 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.8983542919158936
Epoch: 6, Steps: 13 | Train Loss: 162.579 Vali Loss: 272.546 Vali Acc: 0.260 Test Loss: 272.546 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.9668540954589844
Epoch: 7, Steps: 13 | Train Loss: 161.130 Vali Loss: 259.082 Vali Acc: 0.320 Test Loss: 259.082 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.8053793907165527
Epoch: 8, Steps: 13 | Train Loss: 78.589 Vali Loss: 176.959 Vali Acc: 0.340 Test Loss: 176.959 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.088146686553955
Epoch: 9, Steps: 13 | Train Loss: 45.532 Vali Loss: 120.641 Vali Acc: 0.440 Test Loss: 120.641 Test Acc: 0.440
Validation loss decreased (-0.379120 --> -0.438794).  Saving model ...
Epoch: 10 cost time: 2.907188892364502
Epoch: 10, Steps: 13 | Train Loss: 69.966 Vali Loss: 390.221 Vali Acc: 0.200 Test Loss: 390.221 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.8747122287750244
Epoch: 11, Steps: 13 | Train Loss: 150.415 Vali Loss: 148.276 Vali Acc: 0.460 Test Loss: 148.276 Test Acc: 0.460
Validation loss decreased (-0.438794 --> -0.458517).  Saving model ...
Epoch: 12 cost time: 3.019843339920044
Epoch: 12, Steps: 13 | Train Loss: 33.058 Vali Loss: 221.385 Vali Acc: 0.460 Test Loss: 221.385 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.8932175636291504
Epoch: 13, Steps: 13 | Train Loss: 110.521 Vali Loss: 281.292 Vali Acc: 0.520 Test Loss: 281.292 Test Acc: 0.520
Validation loss decreased (-0.458517 --> -0.517187).  Saving model ...
Epoch: 14 cost time: 2.9469892978668213
Epoch: 14, Steps: 13 | Train Loss: 92.618 Vali Loss: 271.939 Vali Acc: 0.500 Test Loss: 271.939 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.892331600189209
Epoch: 15, Steps: 13 | Train Loss: 39.370 Vali Loss: 218.369 Vali Acc: 0.500 Test Loss: 218.369 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.822470188140869
Epoch: 16, Steps: 13 | Train Loss: 80.748 Vali Loss: 393.368 Vali Acc: 0.460 Test Loss: 393.368 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.7559027671813965
Epoch: 17, Steps: 13 | Train Loss: 51.200 Vali Loss: 252.252 Vali Acc: 0.580 Test Loss: 252.252 Test Acc: 0.580
Validation loss decreased (-0.517187 --> -0.577477).  Saving model ...
Epoch: 18 cost time: 2.8516781330108643
Epoch: 18, Steps: 13 | Train Loss: 58.610 Vali Loss: 290.772 Vali Acc: 0.540 Test Loss: 290.772 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.8473565578460693
Epoch: 19, Steps: 13 | Train Loss: 34.198 Vali Loss: 413.982 Vali Acc: 0.500 Test Loss: 413.982 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.7928731441497803
Epoch: 20, Steps: 13 | Train Loss: 67.930 Vali Loss: 332.214 Vali Acc: 0.540 Test Loss: 332.214 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.7894089221954346
Epoch: 21, Steps: 13 | Train Loss: 85.828 Vali Loss: 227.038 Vali Acc: 0.600 Test Loss: 227.038 Test Acc: 0.600
Validation loss decreased (-0.577477 --> -0.597730).  Saving model ...
Epoch: 22 cost time: 2.899632453918457
Epoch: 22, Steps: 13 | Train Loss: 27.678 Vali Loss: 475.634 Vali Acc: 0.480 Test Loss: 475.634 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.8698160648345947
Epoch: 23, Steps: 13 | Train Loss: 48.799 Vali Loss: 372.350 Vali Acc: 0.480 Test Loss: 372.350 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.830195426940918
Epoch: 24, Steps: 13 | Train Loss: 6.568 Vali Loss: 349.720 Vali Acc: 0.560 Test Loss: 349.720 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.0083625316619873
Epoch: 25, Steps: 13 | Train Loss: 4.813 Vali Loss: 326.340 Vali Acc: 0.660 Test Loss: 326.340 Test Acc: 0.660
Validation loss decreased (-0.597730 --> -0.656737).  Saving model ...
Epoch: 26 cost time: 2.950728178024292
Epoch: 26, Steps: 13 | Train Loss: 0.000 Vali Loss: 409.843 Vali Acc: 0.520 Test Loss: 409.843 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.7672276496887207
Epoch: 27, Steps: 13 | Train Loss: 11.711 Vali Loss: 477.143 Vali Acc: 0.520 Test Loss: 477.143 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.8427133560180664
Epoch: 28, Steps: 13 | Train Loss: 17.316 Vali Loss: 475.191 Vali Acc: 0.500 Test Loss: 475.191 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.8837103843688965
Epoch: 29, Steps: 13 | Train Loss: 6.361 Vali Loss: 400.571 Vali Acc: 0.560 Test Loss: 400.571 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.7999510765075684
Epoch: 30, Steps: 13 | Train Loss: 7.950 Vali Loss: 301.163 Vali Acc: 0.620 Test Loss: 301.163 Test Acc: 0.620
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.762449264526367
Epoch: 31, Steps: 13 | Train Loss: 0.000 Vali Loss: 357.285 Vali Acc: 0.560 Test Loss: 357.285 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.919870376586914
Epoch: 32, Steps: 13 | Train Loss: 0.541 Vali Loss: 459.114 Vali Acc: 0.480 Test Loss: 459.114 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.7492215633392334
Epoch: 33, Steps: 13 | Train Loss: 4.707 Vali Loss: 427.204 Vali Acc: 0.580 Test Loss: 427.204 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.9429433345794678
Epoch: 34, Steps: 13 | Train Loss: 21.577 Vali Loss: 510.344 Vali Acc: 0.520 Test Loss: 510.344 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.906811475753784
Epoch: 35, Steps: 13 | Train Loss: 55.438 Vali Loss: 417.554 Vali Acc: 0.600 Test Loss: 417.554 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.66
model parameter : 24769565
model size : 97.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.924177408218384
Epoch: 1, Steps: 13 | Train Loss: 42.457 Vali Loss: 68.981 Vali Acc: 0.200 Test Loss: 68.981 Test Acc: 0.200
Validation loss decreased (inf --> -0.199310).  Saving model ...
Epoch: 2 cost time: 2.7894508838653564
Epoch: 2, Steps: 13 | Train Loss: 105.649 Vali Loss: 144.708 Vali Acc: 0.220 Test Loss: 144.708 Test Acc: 0.220
Validation loss decreased (-0.199310 --> -0.218553).  Saving model ...
Epoch: 3 cost time: 2.9796698093414307
Epoch: 3, Steps: 13 | Train Loss: 99.744 Vali Loss: 127.543 Vali Acc: 0.240 Test Loss: 127.543 Test Acc: 0.240
Validation loss decreased (-0.218553 --> -0.238725).  Saving model ...
Epoch: 4 cost time: 2.8603296279907227
Epoch: 4, Steps: 13 | Train Loss: 141.129 Vali Loss: 308.436 Vali Acc: 0.200 Test Loss: 308.436 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.7339138984680176
Epoch: 5, Steps: 13 | Train Loss: 178.866 Vali Loss: 139.149 Vali Acc: 0.240 Test Loss: 139.149 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.8256587982177734
Epoch: 6, Steps: 13 | Train Loss: 68.286 Vali Loss: 185.013 Vali Acc: 0.340 Test Loss: 185.013 Test Acc: 0.340
Validation loss decreased (-0.238725 --> -0.338150).  Saving model ...
Epoch: 7 cost time: 2.8363986015319824
Epoch: 7, Steps: 13 | Train Loss: 114.821 Vali Loss: 181.043 Vali Acc: 0.340 Test Loss: 181.043 Test Acc: 0.340
Validation loss decreased (-0.338150 --> -0.338190).  Saving model ...
Epoch: 8 cost time: 2.767021656036377
Epoch: 8, Steps: 13 | Train Loss: 139.370 Vali Loss: 159.131 Vali Acc: 0.440 Test Loss: 159.131 Test Acc: 0.440
Validation loss decreased (-0.338190 --> -0.438409).  Saving model ...
Epoch: 9 cost time: 2.722501039505005
Epoch: 9, Steps: 13 | Train Loss: 180.831 Vali Loss: 214.675 Vali Acc: 0.280 Test Loss: 214.675 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.9616994857788086
Epoch: 10, Steps: 13 | Train Loss: 118.603 Vali Loss: 366.169 Vali Acc: 0.280 Test Loss: 366.169 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.8159279823303223
Epoch: 11, Steps: 13 | Train Loss: 136.427 Vali Loss: 284.988 Vali Acc: 0.360 Test Loss: 284.988 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.7412405014038086
Epoch: 12, Steps: 13 | Train Loss: 115.473 Vali Loss: 255.989 Vali Acc: 0.440 Test Loss: 255.989 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.8332059383392334
Epoch: 13, Steps: 13 | Train Loss: 88.137 Vali Loss: 228.626 Vali Acc: 0.400 Test Loss: 228.626 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.96451997756958
Epoch: 14, Steps: 13 | Train Loss: 45.436 Vali Loss: 384.708 Vali Acc: 0.440 Test Loss: 384.708 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.9876418113708496
Epoch: 15, Steps: 13 | Train Loss: 56.028 Vali Loss: 169.461 Vali Acc: 0.600 Test Loss: 169.461 Test Acc: 0.600
Validation loss decreased (-0.438409 --> -0.598305).  Saving model ...
Epoch: 16 cost time: 2.918010711669922
Epoch: 16, Steps: 13 | Train Loss: 28.233 Vali Loss: 257.855 Vali Acc: 0.540 Test Loss: 257.855 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.9084599018096924
Epoch: 17, Steps: 13 | Train Loss: 45.099 Vali Loss: 361.967 Vali Acc: 0.420 Test Loss: 361.967 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.929948568344116
Epoch: 18, Steps: 13 | Train Loss: 82.352 Vali Loss: 365.270 Vali Acc: 0.380 Test Loss: 365.270 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.867241144180298
Epoch: 19, Steps: 13 | Train Loss: 12.710 Vali Loss: 440.598 Vali Acc: 0.420 Test Loss: 440.598 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.93183970451355
Epoch: 20, Steps: 13 | Train Loss: 16.835 Vali Loss: 276.946 Vali Acc: 0.540 Test Loss: 276.946 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.833984375
Epoch: 21, Steps: 13 | Train Loss: 59.776 Vali Loss: 404.041 Vali Acc: 0.460 Test Loss: 404.041 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.9244022369384766
Epoch: 22, Steps: 13 | Train Loss: 30.965 Vali Loss: 409.002 Vali Acc: 0.480 Test Loss: 409.002 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.740973949432373
Epoch: 23, Steps: 13 | Train Loss: 12.937 Vali Loss: 371.204 Vali Acc: 0.480 Test Loss: 371.204 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.926525592803955
Epoch: 24, Steps: 13 | Train Loss: 12.546 Vali Loss: 355.712 Vali Acc: 0.500 Test Loss: 355.712 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.9843130111694336
Epoch: 25, Steps: 13 | Train Loss: 2.718 Vali Loss: 480.610 Vali Acc: 0.500 Test Loss: 480.610 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 24766621
model size : 96.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.305306911468506
Epoch: 1, Steps: 13 | Train Loss: 33.737 Vali Loss: 44.951 Vali Acc: 0.220 Test Loss: 44.951 Test Acc: 0.220
Validation loss decreased (inf --> -0.219550).  Saving model ...
Epoch: 2 cost time: 2.863518476486206
Epoch: 2, Steps: 13 | Train Loss: 61.263 Vali Loss: 78.570 Vali Acc: 0.200 Test Loss: 78.570 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.818160057067871
Epoch: 3, Steps: 13 | Train Loss: 62.820 Vali Loss: 54.973 Vali Acc: 0.220 Test Loss: 54.973 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.8131027221679688
Epoch: 4, Steps: 13 | Train Loss: 34.371 Vali Loss: 70.737 Vali Acc: 0.320 Test Loss: 70.737 Test Acc: 0.320
Validation loss decreased (-0.219550 --> -0.319293).  Saving model ...
Epoch: 5 cost time: 2.9412200450897217
Epoch: 5, Steps: 13 | Train Loss: 34.110 Vali Loss: 86.846 Vali Acc: 0.320 Test Loss: 86.846 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.051086187362671
Epoch: 6, Steps: 13 | Train Loss: 70.362 Vali Loss: 96.145 Vali Acc: 0.380 Test Loss: 96.145 Test Acc: 0.380
Validation loss decreased (-0.319293 --> -0.379039).  Saving model ...
Epoch: 7 cost time: 2.8596439361572266
Epoch: 7, Steps: 13 | Train Loss: 59.704 Vali Loss: 84.785 Vali Acc: 0.420 Test Loss: 84.785 Test Acc: 0.420
Validation loss decreased (-0.379039 --> -0.419152).  Saving model ...
Epoch: 8 cost time: 2.9043102264404297
Epoch: 8, Steps: 13 | Train Loss: 108.930 Vali Loss: 248.869 Vali Acc: 0.240 Test Loss: 248.869 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.7891647815704346
Epoch: 9, Steps: 13 | Train Loss: 62.815 Vali Loss: 177.134 Vali Acc: 0.320 Test Loss: 177.134 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.8433210849761963
Epoch: 10, Steps: 13 | Train Loss: 81.123 Vali Loss: 170.415 Vali Acc: 0.500 Test Loss: 170.415 Test Acc: 0.500
Validation loss decreased (-0.419152 --> -0.498296).  Saving model ...
Epoch: 11 cost time: 3.106154203414917
Epoch: 11, Steps: 13 | Train Loss: 90.782 Vali Loss: 419.483 Vali Acc: 0.460 Test Loss: 419.483 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.8781213760375977
Epoch: 12, Steps: 13 | Train Loss: 220.342 Vali Loss: 444.874 Vali Acc: 0.340 Test Loss: 444.874 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.0133628845214844
Epoch: 13, Steps: 13 | Train Loss: 61.721 Vali Loss: 158.757 Vali Acc: 0.500 Test Loss: 158.757 Test Acc: 0.500
Validation loss decreased (-0.498296 --> -0.498412).  Saving model ...
Epoch: 14 cost time: 2.730842351913452
Epoch: 14, Steps: 13 | Train Loss: 52.782 Vali Loss: 191.068 Vali Acc: 0.540 Test Loss: 191.068 Test Acc: 0.540
Validation loss decreased (-0.498412 --> -0.538089).  Saving model ...
Epoch: 15 cost time: 3.020723819732666
Epoch: 15, Steps: 13 | Train Loss: 55.823 Vali Loss: 333.458 Vali Acc: 0.460 Test Loss: 333.458 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.085810899734497
Epoch: 16, Steps: 13 | Train Loss: 45.750 Vali Loss: 279.213 Vali Acc: 0.360 Test Loss: 279.213 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.8667099475860596
Epoch: 17, Steps: 13 | Train Loss: 116.855 Vali Loss: 247.470 Vali Acc: 0.540 Test Loss: 247.470 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.977965831756592
Epoch: 18, Steps: 13 | Train Loss: 99.158 Vali Loss: 355.077 Vali Acc: 0.340 Test Loss: 355.077 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.953101634979248
Epoch: 19, Steps: 13 | Train Loss: 120.823 Vali Loss: 323.198 Vali Acc: 0.500 Test Loss: 323.198 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.924175977706909
Epoch: 20, Steps: 13 | Train Loss: 79.916 Vali Loss: 332.346 Vali Acc: 0.520 Test Loss: 332.346 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.872986078262329
Epoch: 21, Steps: 13 | Train Loss: 41.145 Vali Loss: 291.409 Vali Acc: 0.540 Test Loss: 291.409 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.8486008644104004
Epoch: 22, Steps: 13 | Train Loss: 0.809 Vali Loss: 296.137 Vali Acc: 0.560 Test Loss: 296.137 Test Acc: 0.560
Validation loss decreased (-0.538089 --> -0.557039).  Saving model ...
Epoch: 23 cost time: 3.2059686183929443
Epoch: 23, Steps: 13 | Train Loss: 7.733 Vali Loss: 304.132 Vali Acc: 0.600 Test Loss: 304.132 Test Acc: 0.600
Validation loss decreased (-0.557039 --> -0.596959).  Saving model ...
Epoch: 24 cost time: 2.95355486869812
Epoch: 24, Steps: 13 | Train Loss: 1.648 Vali Loss: 320.576 Vali Acc: 0.560 Test Loss: 320.576 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.011862277984619
Epoch: 25, Steps: 13 | Train Loss: 3.004 Vali Loss: 356.240 Vali Acc: 0.540 Test Loss: 356.240 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.936471462249756
Epoch: 26, Steps: 13 | Train Loss: 26.759 Vali Loss: 376.706 Vali Acc: 0.520 Test Loss: 376.706 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.9050045013427734
Epoch: 27, Steps: 13 | Train Loss: 0.000 Vali Loss: 340.359 Vali Acc: 0.540 Test Loss: 340.359 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.9553534984588623
Epoch: 28, Steps: 13 | Train Loss: 0.000 Vali Loss: 340.049 Vali Acc: 0.560 Test Loss: 340.049 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.0792813301086426
Epoch: 29, Steps: 13 | Train Loss: 0.000 Vali Loss: 340.955 Vali Acc: 0.560 Test Loss: 340.955 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.8201324939727783
Epoch: 30, Steps: 13 | Train Loss: 0.000 Vali Loss: 341.207 Vali Acc: 0.560 Test Loss: 341.207 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.690307378768921
Epoch: 31, Steps: 13 | Train Loss: 0.000 Vali Loss: 341.275 Vali Acc: 0.560 Test Loss: 341.275 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.9535093307495117
Epoch: 32, Steps: 13 | Train Loss: 0.000 Vali Loss: 341.292 Vali Acc: 0.560 Test Loss: 341.292 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.8176333904266357
Epoch: 33, Steps: 13 | Train Loss: 0.000 Vali Loss: 341.297 Vali Acc: 0.560 Test Loss: 341.297 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 24763677
model size : 96.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.303017616271973
Epoch: 1, Steps: 13 | Train Loss: 40.835 Vali Loss: 57.188 Vali Acc: 0.200 Test Loss: 57.188 Test Acc: 0.200
Validation loss decreased (inf --> -0.199428).  Saving model ...
Epoch: 2 cost time: 2.837144136428833
Epoch: 2, Steps: 13 | Train Loss: 72.357 Vali Loss: 159.142 Vali Acc: 0.240 Test Loss: 159.142 Test Acc: 0.240
Validation loss decreased (-0.199428 --> -0.238409).  Saving model ...
Epoch: 3 cost time: 2.788482189178467
Epoch: 3, Steps: 13 | Train Loss: 95.017 Vali Loss: 69.898 Vali Acc: 0.240 Test Loss: 69.898 Test Acc: 0.240
Validation loss decreased (-0.238409 --> -0.239301).  Saving model ...
Epoch: 4 cost time: 2.8195743560791016
Epoch: 4, Steps: 13 | Train Loss: 71.577 Vali Loss: 79.349 Vali Acc: 0.320 Test Loss: 79.349 Test Acc: 0.320
Validation loss decreased (-0.239301 --> -0.319207).  Saving model ...
Epoch: 5 cost time: 2.803349733352661
Epoch: 5, Steps: 13 | Train Loss: 79.564 Vali Loss: 112.882 Vali Acc: 0.360 Test Loss: 112.882 Test Acc: 0.360
Validation loss decreased (-0.319207 --> -0.358871).  Saving model ...
Epoch: 6 cost time: 2.7177906036376953
Epoch: 6, Steps: 13 | Train Loss: 89.529 Vali Loss: 136.604 Vali Acc: 0.380 Test Loss: 136.604 Test Acc: 0.380
Validation loss decreased (-0.358871 --> -0.378634).  Saving model ...
Epoch: 7 cost time: 2.836956024169922
Epoch: 7, Steps: 13 | Train Loss: 48.948 Vali Loss: 241.192 Vali Acc: 0.260 Test Loss: 241.192 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.7890491485595703
Epoch: 8, Steps: 13 | Train Loss: 174.225 Vali Loss: 188.868 Vali Acc: 0.440 Test Loss: 188.868 Test Acc: 0.440
Validation loss decreased (-0.378634 --> -0.438111).  Saving model ...
Epoch: 9 cost time: 2.8157734870910645
Epoch: 9, Steps: 13 | Train Loss: 74.826 Vali Loss: 163.175 Vali Acc: 0.400 Test Loss: 163.175 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.9250121116638184
Epoch: 10, Steps: 13 | Train Loss: 94.005 Vali Loss: 310.687 Vali Acc: 0.360 Test Loss: 310.687 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.0463707447052
Epoch: 11, Steps: 13 | Train Loss: 150.066 Vali Loss: 144.234 Vali Acc: 0.500 Test Loss: 144.234 Test Acc: 0.500
Validation loss decreased (-0.438111 --> -0.498558).  Saving model ...
Epoch: 12 cost time: 2.8530783653259277
Epoch: 12, Steps: 13 | Train Loss: 122.821 Vali Loss: 275.817 Vali Acc: 0.440 Test Loss: 275.817 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.813810348510742
Epoch: 13, Steps: 13 | Train Loss: 130.605 Vali Loss: 330.695 Vali Acc: 0.480 Test Loss: 330.695 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.854926347732544
Epoch: 14, Steps: 13 | Train Loss: 69.729 Vali Loss: 171.950 Vali Acc: 0.600 Test Loss: 171.950 Test Acc: 0.600
Validation loss decreased (-0.498558 --> -0.598281).  Saving model ...
Epoch: 15 cost time: 2.700721025466919
Epoch: 15, Steps: 13 | Train Loss: 56.814 Vali Loss: 521.850 Vali Acc: 0.560 Test Loss: 521.850 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.897488594055176
Epoch: 16, Steps: 13 | Train Loss: 94.476 Vali Loss: 184.379 Vali Acc: 0.620 Test Loss: 184.379 Test Acc: 0.620
Validation loss decreased (-0.598281 --> -0.618156).  Saving model ...
Epoch: 17 cost time: 2.8568577766418457
Epoch: 17, Steps: 13 | Train Loss: 13.174 Vali Loss: 353.992 Vali Acc: 0.560 Test Loss: 353.992 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.897437810897827
Epoch: 18, Steps: 13 | Train Loss: 63.124 Vali Loss: 234.542 Vali Acc: 0.500 Test Loss: 234.542 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.8818836212158203
Epoch: 19, Steps: 13 | Train Loss: 52.131 Vali Loss: 272.607 Vali Acc: 0.500 Test Loss: 272.607 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.9234778881073
Epoch: 20, Steps: 13 | Train Loss: 48.515 Vali Loss: 317.449 Vali Acc: 0.560 Test Loss: 317.449 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.8680500984191895
Epoch: 21, Steps: 13 | Train Loss: 15.102 Vali Loss: 435.441 Vali Acc: 0.540 Test Loss: 435.441 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.715275764465332
Epoch: 22, Steps: 13 | Train Loss: 66.636 Vali Loss: 185.968 Vali Acc: 0.640 Test Loss: 185.968 Test Acc: 0.640
Validation loss decreased (-0.618156 --> -0.638140).  Saving model ...
Epoch: 23 cost time: 2.8729288578033447
Epoch: 23, Steps: 13 | Train Loss: 15.116 Vali Loss: 254.782 Vali Acc: 0.500 Test Loss: 254.782 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.058534860610962
Epoch: 24, Steps: 13 | Train Loss: 61.710 Vali Loss: 230.684 Vali Acc: 0.480 Test Loss: 230.684 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.8794407844543457
Epoch: 25, Steps: 13 | Train Loss: 50.351 Vali Loss: 588.843 Vali Acc: 0.460 Test Loss: 588.843 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.8735194206237793
Epoch: 26, Steps: 13 | Train Loss: 28.438 Vali Loss: 473.082 Vali Acc: 0.480 Test Loss: 473.082 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.8114869594573975
Epoch: 27, Steps: 13 | Train Loss: 25.674 Vali Loss: 477.776 Vali Acc: 0.540 Test Loss: 477.776 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.80237078666687
Epoch: 28, Steps: 13 | Train Loss: 28.548 Vali Loss: 341.236 Vali Acc: 0.620 Test Loss: 341.236 Test Acc: 0.620
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.762815475463867
Epoch: 29, Steps: 13 | Train Loss: 0.000 Vali Loss: 376.090 Vali Acc: 0.620 Test Loss: 376.090 Test Acc: 0.620
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.8147950172424316
Epoch: 30, Steps: 13 | Train Loss: 3.105 Vali Loss: 491.158 Vali Acc: 0.520 Test Loss: 491.158 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.838052988052368
Epoch: 31, Steps: 13 | Train Loss: 15.050 Vali Loss: 365.718 Vali Acc: 0.600 Test Loss: 365.718 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.893664598464966
Epoch: 32, Steps: 13 | Train Loss: 17.939 Vali Loss: 399.156 Vali Acc: 0.560 Test Loss: 399.156 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.64
model parameter : 24760733
model size : 96.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.201592445373535
Epoch: 1, Steps: 13 | Train Loss: 23.081 Vali Loss: 15.618 Vali Acc: 0.240 Test Loss: 15.618 Test Acc: 0.240
Validation loss decreased (inf --> -0.239844).  Saving model ...
Epoch: 2 cost time: 2.7050986289978027
Epoch: 2, Steps: 13 | Train Loss: 55.267 Vali Loss: 107.459 Vali Acc: 0.200 Test Loss: 107.459 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.9160001277923584
Epoch: 3, Steps: 13 | Train Loss: 80.035 Vali Loss: 101.362 Vali Acc: 0.220 Test Loss: 101.362 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.819833517074585
Epoch: 4, Steps: 13 | Train Loss: 121.805 Vali Loss: 137.253 Vali Acc: 0.240 Test Loss: 137.253 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.6545944213867188
Epoch: 5, Steps: 13 | Train Loss: 107.859 Vali Loss: 210.900 Vali Acc: 0.200 Test Loss: 210.900 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.836899757385254
Epoch: 6, Steps: 13 | Train Loss: 148.338 Vali Loss: 283.961 Vali Acc: 0.280 Test Loss: 283.961 Test Acc: 0.280
Validation loss decreased (-0.239844 --> -0.277160).  Saving model ...
Epoch: 7 cost time: 2.6663613319396973
Epoch: 7, Steps: 13 | Train Loss: 275.412 Vali Loss: 309.444 Vali Acc: 0.280 Test Loss: 309.444 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.668191909790039
Epoch: 8, Steps: 13 | Train Loss: 128.120 Vali Loss: 118.112 Vali Acc: 0.500 Test Loss: 118.112 Test Acc: 0.500
Validation loss decreased (-0.277160 --> -0.498819).  Saving model ...
Epoch: 9 cost time: 2.848731279373169
Epoch: 9, Steps: 13 | Train Loss: 111.291 Vali Loss: 330.238 Vali Acc: 0.360 Test Loss: 330.238 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.761066436767578
Epoch: 10, Steps: 13 | Train Loss: 138.720 Vali Loss: 337.989 Vali Acc: 0.300 Test Loss: 337.989 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.5034525394439697
Epoch: 11, Steps: 13 | Train Loss: 169.179 Vali Loss: 328.999 Vali Acc: 0.420 Test Loss: 328.999 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.7291157245635986
Epoch: 12, Steps: 13 | Train Loss: 124.351 Vali Loss: 270.836 Vali Acc: 0.480 Test Loss: 270.836 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.7028610706329346
Epoch: 13, Steps: 13 | Train Loss: 57.553 Vali Loss: 290.323 Vali Acc: 0.400 Test Loss: 290.323 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.6984946727752686
Epoch: 14, Steps: 13 | Train Loss: 84.720 Vali Loss: 260.202 Vali Acc: 0.500 Test Loss: 260.202 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.701375961303711
Epoch: 15, Steps: 13 | Train Loss: 30.203 Vali Loss: 182.088 Vali Acc: 0.600 Test Loss: 182.088 Test Acc: 0.600
Validation loss decreased (-0.498819 --> -0.598179).  Saving model ...
Epoch: 16 cost time: 2.7280163764953613
Epoch: 16, Steps: 13 | Train Loss: 30.270 Vali Loss: 227.669 Vali Acc: 0.460 Test Loss: 227.669 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.6926119327545166
Epoch: 17, Steps: 13 | Train Loss: 48.250 Vali Loss: 266.091 Vali Acc: 0.500 Test Loss: 266.091 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.598280906677246
Epoch: 18, Steps: 13 | Train Loss: 50.208 Vali Loss: 385.558 Vali Acc: 0.500 Test Loss: 385.558 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.682845115661621
Epoch: 19, Steps: 13 | Train Loss: 63.178 Vali Loss: 322.656 Vali Acc: 0.600 Test Loss: 322.656 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.664752960205078
Epoch: 20, Steps: 13 | Train Loss: 58.322 Vali Loss: 332.585 Vali Acc: 0.620 Test Loss: 332.585 Test Acc: 0.620
Validation loss decreased (-0.598179 --> -0.616674).  Saving model ...
Epoch: 21 cost time: 2.6440954208374023
Epoch: 21, Steps: 13 | Train Loss: 21.218 Vali Loss: 546.593 Vali Acc: 0.520 Test Loss: 546.593 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.701730489730835
Epoch: 22, Steps: 13 | Train Loss: 65.737 Vali Loss: 241.915 Vali Acc: 0.640 Test Loss: 241.915 Test Acc: 0.640
Validation loss decreased (-0.616674 --> -0.637581).  Saving model ...
Epoch: 23 cost time: 2.700514078140259
Epoch: 23, Steps: 13 | Train Loss: 3.873 Vali Loss: 180.278 Vali Acc: 0.680 Test Loss: 180.278 Test Acc: 0.680
Validation loss decreased (-0.637581 --> -0.678197).  Saving model ...
Epoch: 24 cost time: 2.684692859649658
Epoch: 24, Steps: 13 | Train Loss: 12.187 Vali Loss: 266.340 Vali Acc: 0.560 Test Loss: 266.340 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.9088237285614014
Epoch: 25, Steps: 13 | Train Loss: 36.365 Vali Loss: 318.291 Vali Acc: 0.540 Test Loss: 318.291 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.8077950477600098
Epoch: 26, Steps: 13 | Train Loss: 5.347 Vali Loss: 440.233 Vali Acc: 0.520 Test Loss: 440.233 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.680443286895752
Epoch: 27, Steps: 13 | Train Loss: 22.639 Vali Loss: 346.360 Vali Acc: 0.580 Test Loss: 346.360 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.658480405807495
Epoch: 28, Steps: 13 | Train Loss: 4.001 Vali Loss: 430.693 Vali Acc: 0.460 Test Loss: 430.693 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.654102325439453
Epoch: 29, Steps: 13 | Train Loss: 21.261 Vali Loss: 303.892 Vali Acc: 0.600 Test Loss: 303.892 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.7478466033935547
Epoch: 30, Steps: 13 | Train Loss: 0.598 Vali Loss: 256.331 Vali Acc: 0.600 Test Loss: 256.331 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.6962108612060547
Epoch: 31, Steps: 13 | Train Loss: 17.619 Vali Loss: 482.427 Vali Acc: 0.480 Test Loss: 482.427 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.809734582901001
Epoch: 32, Steps: 13 | Train Loss: 30.140 Vali Loss: 549.759 Vali Acc: 0.480 Test Loss: 549.759 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.6986067295074463
Epoch: 33, Steps: 13 | Train Loss: 7.114 Vali Loss: 284.552 Vali Acc: 0.700 Test Loss: 284.552 Test Acc: 0.700
Validation loss decreased (-0.678197 --> -0.697154).  Saving model ...
Epoch: 34 cost time: 2.6763453483581543
Epoch: 34, Steps: 13 | Train Loss: 6.853 Vali Loss: 389.466 Vali Acc: 0.560 Test Loss: 389.466 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.7393250465393066
Epoch: 35, Steps: 13 | Train Loss: 36.167 Vali Loss: 287.189 Vali Acc: 0.660 Test Loss: 287.189 Test Acc: 0.660
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.605708122253418
Epoch: 36, Steps: 13 | Train Loss: 4.139 Vali Loss: 346.147 Vali Acc: 0.540 Test Loss: 346.147 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.6676013469696045
Epoch: 37, Steps: 13 | Train Loss: 8.408 Vali Loss: 361.783 Vali Acc: 0.540 Test Loss: 361.783 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 2.712148666381836
Epoch: 38, Steps: 13 | Train Loss: 3.743 Vali Loss: 373.004 Vali Acc: 0.580 Test Loss: 373.004 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 2.80824875831604
Epoch: 39, Steps: 13 | Train Loss: 4.301 Vali Loss: 381.390 Vali Acc: 0.540 Test Loss: 381.390 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 2.6954734325408936
Epoch: 40, Steps: 13 | Train Loss: 9.043 Vali Loss: 650.062 Vali Acc: 0.520 Test Loss: 650.062 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 2.744112253189087
Epoch: 41, Steps: 13 | Train Loss: 64.945 Vali Loss: 658.782 Vali Acc: 0.460 Test Loss: 658.782 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 2.663316488265991
Epoch: 42, Steps: 13 | Train Loss: 26.864 Vali Loss: 642.556 Vali Acc: 0.540 Test Loss: 642.556 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 2.7096781730651855
Epoch: 43, Steps: 13 | Train Loss: 45.800 Vali Loss: 595.586 Vali Acc: 0.420 Test Loss: 595.586 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.7
model parameter : 24670877
model size : 96.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.128031969070435
Epoch: 1, Steps: 13 | Train Loss: 25.920 Vali Loss: 58.659 Vali Acc: 0.220 Test Loss: 58.659 Test Acc: 0.220
Validation loss decreased (inf --> -0.219413).  Saving model ...
Epoch: 2 cost time: 2.7848103046417236
Epoch: 2, Steps: 13 | Train Loss: 87.447 Vali Loss: 110.682 Vali Acc: 0.280 Test Loss: 110.682 Test Acc: 0.280
Validation loss decreased (-0.219413 --> -0.278893).  Saving model ...
Epoch: 3 cost time: 2.6278796195983887
Epoch: 3, Steps: 13 | Train Loss: 146.682 Vali Loss: 101.704 Vali Acc: 0.180 Test Loss: 101.704 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.6999993324279785
Epoch: 4, Steps: 13 | Train Loss: 75.096 Vali Loss: 97.137 Vali Acc: 0.220 Test Loss: 97.137 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.8160336017608643
Epoch: 5, Steps: 13 | Train Loss: 96.029 Vali Loss: 141.901 Vali Acc: 0.300 Test Loss: 141.901 Test Acc: 0.300
Validation loss decreased (-0.278893 --> -0.298581).  Saving model ...
Epoch: 6 cost time: 2.7911174297332764
Epoch: 6, Steps: 13 | Train Loss: 66.970 Vali Loss: 152.548 Vali Acc: 0.260 Test Loss: 152.548 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.652540445327759
Epoch: 7, Steps: 13 | Train Loss: 74.446 Vali Loss: 206.103 Vali Acc: 0.280 Test Loss: 206.103 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.573051691055298
Epoch: 8, Steps: 13 | Train Loss: 81.641 Vali Loss: 356.467 Vali Acc: 0.240 Test Loss: 356.467 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.722980260848999
Epoch: 9, Steps: 13 | Train Loss: 198.504 Vali Loss: 252.638 Vali Acc: 0.300 Test Loss: 252.638 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.6926043033599854
Epoch: 10, Steps: 13 | Train Loss: 146.056 Vali Loss: 369.154 Vali Acc: 0.260 Test Loss: 369.154 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.6342437267303467
Epoch: 11, Steps: 13 | Train Loss: 208.607 Vali Loss: 424.548 Vali Acc: 0.440 Test Loss: 424.548 Test Acc: 0.440
Validation loss decreased (-0.298581 --> -0.435755).  Saving model ...
Epoch: 12 cost time: 2.7210943698883057
Epoch: 12, Steps: 13 | Train Loss: 295.638 Vali Loss: 823.926 Vali Acc: 0.260 Test Loss: 823.926 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.699705123901367
Epoch: 13, Steps: 13 | Train Loss: 315.720 Vali Loss: 472.234 Vali Acc: 0.400 Test Loss: 472.234 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.792728900909424
Epoch: 14, Steps: 13 | Train Loss: 100.717 Vali Loss: 209.229 Vali Acc: 0.520 Test Loss: 209.229 Test Acc: 0.520
Validation loss decreased (-0.435755 --> -0.517908).  Saving model ...
Epoch: 15 cost time: 2.710691213607788
Epoch: 15, Steps: 13 | Train Loss: 38.127 Vali Loss: 271.918 Vali Acc: 0.560 Test Loss: 271.918 Test Acc: 0.560
Validation loss decreased (-0.517908 --> -0.557281).  Saving model ...
Epoch: 16 cost time: 2.7286176681518555
Epoch: 16, Steps: 13 | Train Loss: 53.459 Vali Loss: 217.881 Vali Acc: 0.580 Test Loss: 217.881 Test Acc: 0.580
Validation loss decreased (-0.557281 --> -0.577821).  Saving model ...
Epoch: 17 cost time: 2.807180881500244
Epoch: 17, Steps: 13 | Train Loss: 81.048 Vali Loss: 233.881 Vali Acc: 0.480 Test Loss: 233.881 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.6409401893615723
Epoch: 18, Steps: 13 | Train Loss: 79.366 Vali Loss: 322.379 Vali Acc: 0.460 Test Loss: 322.379 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.6479971408843994
Epoch: 19, Steps: 13 | Train Loss: 79.099 Vali Loss: 370.091 Vali Acc: 0.460 Test Loss: 370.091 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.7469334602355957
Epoch: 20, Steps: 13 | Train Loss: 83.104 Vali Loss: 497.621 Vali Acc: 0.500 Test Loss: 497.621 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.6759629249572754
Epoch: 21, Steps: 13 | Train Loss: 33.085 Vali Loss: 355.886 Vali Acc: 0.500 Test Loss: 355.886 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.777822494506836
Epoch: 22, Steps: 13 | Train Loss: 14.297 Vali Loss: 441.193 Vali Acc: 0.480 Test Loss: 441.193 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.6738903522491455
Epoch: 23, Steps: 13 | Train Loss: 34.580 Vali Loss: 290.162 Vali Acc: 0.600 Test Loss: 290.162 Test Acc: 0.600
Validation loss decreased (-0.577821 --> -0.597098).  Saving model ...
Epoch: 24 cost time: 2.7194266319274902
Epoch: 24, Steps: 13 | Train Loss: 39.841 Vali Loss: 312.663 Vali Acc: 0.560 Test Loss: 312.663 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.623377799987793
Epoch: 25, Steps: 13 | Train Loss: 24.336 Vali Loss: 266.425 Vali Acc: 0.660 Test Loss: 266.425 Test Acc: 0.660
Validation loss decreased (-0.597098 --> -0.657336).  Saving model ...
Epoch: 26 cost time: 2.64040207862854
Epoch: 26, Steps: 13 | Train Loss: 0.000 Vali Loss: 264.726 Vali Acc: 0.620 Test Loss: 264.726 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.687783718109131
Epoch: 27, Steps: 13 | Train Loss: 0.000 Vali Loss: 276.771 Vali Acc: 0.600 Test Loss: 276.771 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.636605978012085
Epoch: 28, Steps: 13 | Train Loss: 0.000 Vali Loss: 280.098 Vali Acc: 0.600 Test Loss: 280.098 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.83050274848938
Epoch: 29, Steps: 13 | Train Loss: 0.000 Vali Loss: 280.989 Vali Acc: 0.600 Test Loss: 280.989 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.9905338287353516
Epoch: 30, Steps: 13 | Train Loss: 0.000 Vali Loss: 281.225 Vali Acc: 0.600 Test Loss: 281.225 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.7520806789398193
Epoch: 31, Steps: 13 | Train Loss: 0.000 Vali Loss: 281.236 Vali Acc: 0.600 Test Loss: 281.236 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.6544411182403564
Epoch: 32, Steps: 13 | Train Loss: 0.000 Vali Loss: 281.223 Vali Acc: 0.600 Test Loss: 281.223 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.859743118286133
Epoch: 33, Steps: 13 | Train Loss: 0.000 Vali Loss: 281.220 Vali Acc: 0.600 Test Loss: 281.220 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.732858896255493
Epoch: 34, Steps: 13 | Train Loss: 0.000 Vali Loss: 281.219 Vali Acc: 0.600 Test Loss: 281.219 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.751356601715088
Epoch: 35, Steps: 13 | Train Loss: 0.000 Vali Loss: 281.218 Vali Acc: 0.600 Test Loss: 281.218 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.66
model parameter : 24667933
model size : 96.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.464897871017456
Epoch: 1, Steps: 13 | Train Loss: 46.420 Vali Loss: 54.546 Vali Acc: 0.200 Test Loss: 54.546 Test Acc: 0.200
Validation loss decreased (inf --> -0.199455).  Saving model ...
Epoch: 2 cost time: 2.786351442337036
Epoch: 2, Steps: 13 | Train Loss: 73.879 Vali Loss: 74.060 Vali Acc: 0.200 Test Loss: 74.060 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.729179620742798
Epoch: 3, Steps: 13 | Train Loss: 83.126 Vali Loss: 163.298 Vali Acc: 0.260 Test Loss: 163.298 Test Acc: 0.260
Validation loss decreased (-0.199455 --> -0.258367).  Saving model ...
Epoch: 4 cost time: 2.61547589302063
Epoch: 4, Steps: 13 | Train Loss: 127.644 Vali Loss: 141.882 Vali Acc: 0.220 Test Loss: 141.882 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.646249771118164
Epoch: 5, Steps: 13 | Train Loss: 83.242 Vali Loss: 172.917 Vali Acc: 0.260 Test Loss: 172.917 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.632636785507202
Epoch: 6, Steps: 13 | Train Loss: 154.240 Vali Loss: 145.031 Vali Acc: 0.300 Test Loss: 145.031 Test Acc: 0.300
Validation loss decreased (-0.258367 --> -0.298550).  Saving model ...
Epoch: 7 cost time: 2.7768259048461914
Epoch: 7, Steps: 13 | Train Loss: 112.272 Vali Loss: 394.120 Vali Acc: 0.380 Test Loss: 394.120 Test Acc: 0.380
Validation loss decreased (-0.298550 --> -0.376059).  Saving model ...
Epoch: 8 cost time: 2.7276039123535156
Epoch: 8, Steps: 13 | Train Loss: 219.336 Vali Loss: 288.231 Vali Acc: 0.260 Test Loss: 288.231 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.9151601791381836
Epoch: 9, Steps: 13 | Train Loss: 191.393 Vali Loss: 267.918 Vali Acc: 0.380 Test Loss: 267.918 Test Acc: 0.380
Validation loss decreased (-0.376059 --> -0.377321).  Saving model ...
Epoch: 10 cost time: 3.0095479488372803
Epoch: 10, Steps: 13 | Train Loss: 90.031 Vali Loss: 148.846 Vali Acc: 0.460 Test Loss: 148.846 Test Acc: 0.460
Validation loss decreased (-0.377321 --> -0.458512).  Saving model ...
Epoch: 11 cost time: 2.9242241382598877
Epoch: 11, Steps: 13 | Train Loss: 99.512 Vali Loss: 245.072 Vali Acc: 0.400 Test Loss: 245.072 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.717796802520752
Epoch: 12, Steps: 13 | Train Loss: 77.268 Vali Loss: 225.801 Vali Acc: 0.440 Test Loss: 225.801 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.9589805603027344
Epoch: 13, Steps: 13 | Train Loss: 81.878 Vali Loss: 278.599 Vali Acc: 0.500 Test Loss: 278.599 Test Acc: 0.500
Validation loss decreased (-0.458512 --> -0.497214).  Saving model ...
Epoch: 14 cost time: 2.8813295364379883
Epoch: 14, Steps: 13 | Train Loss: 112.147 Vali Loss: 294.408 Vali Acc: 0.480 Test Loss: 294.408 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.68434739112854
Epoch: 15, Steps: 13 | Train Loss: 109.822 Vali Loss: 238.059 Vali Acc: 0.520 Test Loss: 238.059 Test Acc: 0.520
Validation loss decreased (-0.497214 --> -0.517619).  Saving model ...
Epoch: 16 cost time: 2.7878854274749756
Epoch: 16, Steps: 13 | Train Loss: 61.612 Vali Loss: 184.940 Vali Acc: 0.660 Test Loss: 184.940 Test Acc: 0.660
Validation loss decreased (-0.517619 --> -0.658151).  Saving model ...
Epoch: 17 cost time: 2.8285257816314697
Epoch: 17, Steps: 13 | Train Loss: 40.353 Vali Loss: 232.058 Vali Acc: 0.560 Test Loss: 232.058 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.7350730895996094
Epoch: 18, Steps: 13 | Train Loss: 37.279 Vali Loss: 313.792 Vali Acc: 0.480 Test Loss: 313.792 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.7148561477661133
Epoch: 19, Steps: 13 | Train Loss: 29.402 Vali Loss: 428.738 Vali Acc: 0.500 Test Loss: 428.738 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.7314138412475586
Epoch: 20, Steps: 13 | Train Loss: 24.685 Vali Loss: 320.535 Vali Acc: 0.580 Test Loss: 320.535 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.6695752143859863
Epoch: 21, Steps: 13 | Train Loss: 41.993 Vali Loss: 371.537 Vali Acc: 0.620 Test Loss: 371.537 Test Acc: 0.620
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.6974124908447266
Epoch: 22, Steps: 13 | Train Loss: 48.767 Vali Loss: 305.172 Vali Acc: 0.540 Test Loss: 305.172 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.7960121631622314
Epoch: 23, Steps: 13 | Train Loss: 33.652 Vali Loss: 452.621 Vali Acc: 0.420 Test Loss: 452.621 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.851001739501953
Epoch: 24, Steps: 13 | Train Loss: 4.132 Vali Loss: 387.052 Vali Acc: 0.540 Test Loss: 387.052 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.726809501647949
Epoch: 25, Steps: 13 | Train Loss: 1.027 Vali Loss: 367.341 Vali Acc: 0.520 Test Loss: 367.341 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.77673077583313
Epoch: 26, Steps: 13 | Train Loss: 17.743 Vali Loss: 385.368 Vali Acc: 0.480 Test Loss: 385.368 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.66
model parameter : 24664989
model size : 96.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.0584797859191895
Epoch: 1, Steps: 13 | Train Loss: 31.742 Vali Loss: 79.946 Vali Acc: 0.240 Test Loss: 79.946 Test Acc: 0.240
Validation loss decreased (inf --> -0.239201).  Saving model ...
Epoch: 2 cost time: 2.6785240173339844
Epoch: 2, Steps: 13 | Train Loss: 67.934 Vali Loss: 89.420 Vali Acc: 0.280 Test Loss: 89.420 Test Acc: 0.280
Validation loss decreased (-0.239201 --> -0.279106).  Saving model ...
Epoch: 3 cost time: 2.539501905441284
Epoch: 3, Steps: 13 | Train Loss: 84.289 Vali Loss: 141.584 Vali Acc: 0.200 Test Loss: 141.584 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.5949487686157227
Epoch: 4, Steps: 13 | Train Loss: 133.933 Vali Loss: 359.392 Vali Acc: 0.200 Test Loss: 359.392 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.492971181869507
Epoch: 5, Steps: 13 | Train Loss: 237.243 Vali Loss: 211.893 Vali Acc: 0.280 Test Loss: 211.893 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.6040124893188477
Epoch: 6, Steps: 13 | Train Loss: 145.626 Vali Loss: 221.019 Vali Acc: 0.320 Test Loss: 221.019 Test Acc: 0.320
Validation loss decreased (-0.279106 --> -0.317790).  Saving model ...
Epoch: 7 cost time: 2.559813976287842
Epoch: 7, Steps: 13 | Train Loss: 168.950 Vali Loss: 254.666 Vali Acc: 0.260 Test Loss: 254.666 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.674786329269409
Epoch: 8, Steps: 13 | Train Loss: 217.136 Vali Loss: 139.790 Vali Acc: 0.360 Test Loss: 139.790 Test Acc: 0.360
Validation loss decreased (-0.317790 --> -0.358602).  Saving model ...
Epoch: 9 cost time: 2.6245431900024414
Epoch: 9, Steps: 13 | Train Loss: 55.948 Vali Loss: 279.673 Vali Acc: 0.440 Test Loss: 279.673 Test Acc: 0.440
Validation loss decreased (-0.358602 --> -0.437203).  Saving model ...
Epoch: 10 cost time: 2.673633575439453
Epoch: 10, Steps: 13 | Train Loss: 182.153 Vali Loss: 457.696 Vali Acc: 0.360 Test Loss: 457.696 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.6799943447113037
Epoch: 11, Steps: 13 | Train Loss: 169.737 Vali Loss: 200.489 Vali Acc: 0.420 Test Loss: 200.489 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.5995564460754395
Epoch: 12, Steps: 13 | Train Loss: 86.855 Vali Loss: 294.670 Vali Acc: 0.420 Test Loss: 294.670 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.8200902938842773
Epoch: 13, Steps: 13 | Train Loss: 44.523 Vali Loss: 258.169 Vali Acc: 0.420 Test Loss: 258.169 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.6389050483703613
Epoch: 14, Steps: 13 | Train Loss: 33.636 Vali Loss: 359.967 Vali Acc: 0.460 Test Loss: 359.967 Test Acc: 0.460
Validation loss decreased (-0.437203 --> -0.456400).  Saving model ...
Epoch: 15 cost time: 2.6645052433013916
Epoch: 15, Steps: 13 | Train Loss: 216.556 Vali Loss: 264.849 Vali Acc: 0.500 Test Loss: 264.849 Test Acc: 0.500
Validation loss decreased (-0.456400 --> -0.497352).  Saving model ...
Epoch: 16 cost time: 2.6801352500915527
Epoch: 16, Steps: 13 | Train Loss: 90.332 Vali Loss: 408.254 Vali Acc: 0.420 Test Loss: 408.254 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.978363037109375
Epoch: 17, Steps: 13 | Train Loss: 100.569 Vali Loss: 274.429 Vali Acc: 0.560 Test Loss: 274.429 Test Acc: 0.560
Validation loss decreased (-0.497352 --> -0.557256).  Saving model ...
Epoch: 18 cost time: 2.594144344329834
Epoch: 18, Steps: 13 | Train Loss: 45.001 Vali Loss: 305.354 Vali Acc: 0.500 Test Loss: 305.354 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.7686591148376465
Epoch: 19, Steps: 13 | Train Loss: 29.263 Vali Loss: 286.204 Vali Acc: 0.520 Test Loss: 286.204 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.6707255840301514
Epoch: 20, Steps: 13 | Train Loss: 33.662 Vali Loss: 311.042 Vali Acc: 0.480 Test Loss: 311.042 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.607816696166992
Epoch: 21, Steps: 13 | Train Loss: 24.040 Vali Loss: 496.199 Vali Acc: 0.460 Test Loss: 496.199 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.650097370147705
Epoch: 22, Steps: 13 | Train Loss: 52.146 Vali Loss: 359.320 Vali Acc: 0.520 Test Loss: 359.320 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.81270694732666
Epoch: 23, Steps: 13 | Train Loss: 41.188 Vali Loss: 396.865 Vali Acc: 0.440 Test Loss: 396.865 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.5356945991516113
Epoch: 24, Steps: 13 | Train Loss: 35.177 Vali Loss: 413.863 Vali Acc: 0.480 Test Loss: 413.863 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.559051513671875
Epoch: 25, Steps: 13 | Train Loss: 73.042 Vali Loss: 448.168 Vali Acc: 0.480 Test Loss: 448.168 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.693906545639038
Epoch: 26, Steps: 13 | Train Loss: 84.942 Vali Loss: 490.688 Vali Acc: 0.460 Test Loss: 490.688 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.5875232219696045
Epoch: 27, Steps: 13 | Train Loss: 39.477 Vali Loss: 279.072 Vali Acc: 0.620 Test Loss: 279.072 Test Acc: 0.620
Validation loss decreased (-0.557256 --> -0.617209).  Saving model ...
Epoch: 28 cost time: 2.4976229667663574
Epoch: 28, Steps: 13 | Train Loss: 12.814 Vali Loss: 318.114 Vali Acc: 0.640 Test Loss: 318.114 Test Acc: 0.640
Validation loss decreased (-0.617209 --> -0.636819).  Saving model ...
Epoch: 29 cost time: 2.6343212127685547
Epoch: 29, Steps: 13 | Train Loss: 0.000 Vali Loss: 330.428 Vali Acc: 0.640 Test Loss: 330.428 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.6436166763305664
Epoch: 30, Steps: 13 | Train Loss: 24.744 Vali Loss: 286.767 Vali Acc: 0.600 Test Loss: 286.767 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.551889419555664
Epoch: 31, Steps: 13 | Train Loss: 10.867 Vali Loss: 300.995 Vali Acc: 0.680 Test Loss: 300.995 Test Acc: 0.680
Validation loss decreased (-0.636819 --> -0.676990).  Saving model ...
Epoch: 32 cost time: 2.5487260818481445
Epoch: 32, Steps: 13 | Train Loss: 0.000 Vali Loss: 373.267 Vali Acc: 0.560 Test Loss: 373.267 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.842374801635742
Epoch: 33, Steps: 13 | Train Loss: 9.918 Vali Loss: 278.678 Vali Acc: 0.700 Test Loss: 278.678 Test Acc: 0.700
Validation loss decreased (-0.676990 --> -0.697213).  Saving model ...
Epoch: 34 cost time: 2.63702392578125
Epoch: 34, Steps: 13 | Train Loss: 3.385 Vali Loss: 378.737 Vali Acc: 0.600 Test Loss: 378.737 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.653679609298706
Epoch: 35, Steps: 13 | Train Loss: 13.113 Vali Loss: 302.806 Vali Acc: 0.680 Test Loss: 302.806 Test Acc: 0.680
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.6175074577331543
Epoch: 36, Steps: 13 | Train Loss: 0.000 Vali Loss: 296.415 Vali Acc: 0.600 Test Loss: 296.415 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.6533546447753906
Epoch: 37, Steps: 13 | Train Loss: 0.000 Vali Loss: 319.927 Vali Acc: 0.540 Test Loss: 319.927 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 2.5745368003845215
Epoch: 38, Steps: 13 | Train Loss: 0.000 Vali Loss: 326.766 Vali Acc: 0.540 Test Loss: 326.766 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 2.476134777069092
Epoch: 39, Steps: 13 | Train Loss: 0.000 Vali Loss: 328.552 Vali Acc: 0.540 Test Loss: 328.552 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 2.6244592666625977
Epoch: 40, Steps: 13 | Train Loss: 0.000 Vali Loss: 329.018 Vali Acc: 0.540 Test Loss: 329.018 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 2.68619966506958
Epoch: 41, Steps: 13 | Train Loss: 0.000 Vali Loss: 329.140 Vali Acc: 0.540 Test Loss: 329.140 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 2.6798362731933594
Epoch: 42, Steps: 13 | Train Loss: 0.000 Vali Loss: 329.171 Vali Acc: 0.540 Test Loss: 329.171 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 2.6013898849487305
Epoch: 43, Steps: 13 | Train Loss: 0.000 Vali Loss: 329.179 Vali Acc: 0.540 Test Loss: 329.179 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.7
model parameter : 24662045
model size : 96.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.7397077083587646
Epoch: 1, Steps: 13 | Train Loss: 10.075 Vali Loss: 11.630 Vali Acc: 0.360 Test Loss: 11.630 Test Acc: 0.360
Validation loss decreased (inf --> -0.359884).  Saving model ...
Epoch: 2 cost time: 2.277803421020508
Epoch: 2, Steps: 13 | Train Loss: 18.745 Vali Loss: 40.106 Vali Acc: 0.280 Test Loss: 40.106 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2433698177337646
Epoch: 3, Steps: 13 | Train Loss: 32.843 Vali Loss: 75.756 Vali Acc: 0.240 Test Loss: 75.756 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.1963272094726562
Epoch: 4, Steps: 13 | Train Loss: 64.468 Vali Loss: 43.004 Vali Acc: 0.320 Test Loss: 43.004 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.4280858039855957
Epoch: 5, Steps: 13 | Train Loss: 66.394 Vali Loss: 109.756 Vali Acc: 0.260 Test Loss: 109.756 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.3570730686187744
Epoch: 6, Steps: 13 | Train Loss: 65.542 Vali Loss: 44.523 Vali Acc: 0.360 Test Loss: 44.523 Test Acc: 0.360
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.204587697982788
Epoch: 7, Steps: 13 | Train Loss: 31.577 Vali Loss: 90.114 Vali Acc: 0.380 Test Loss: 90.114 Test Acc: 0.380
Validation loss decreased (-0.359884 --> -0.379099).  Saving model ...
Epoch: 8 cost time: 2.2876548767089844
Epoch: 8, Steps: 13 | Train Loss: 43.886 Vali Loss: 101.837 Vali Acc: 0.380 Test Loss: 101.837 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.324625015258789
Epoch: 9, Steps: 13 | Train Loss: 38.771 Vali Loss: 136.494 Vali Acc: 0.460 Test Loss: 136.494 Test Acc: 0.460
Validation loss decreased (-0.379099 --> -0.458635).  Saving model ...
Epoch: 10 cost time: 2.3710227012634277
Epoch: 10, Steps: 13 | Train Loss: 70.038 Vali Loss: 136.472 Vali Acc: 0.320 Test Loss: 136.472 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.3155243396759033
Epoch: 11, Steps: 13 | Train Loss: 29.938 Vali Loss: 65.185 Vali Acc: 0.560 Test Loss: 65.185 Test Acc: 0.560
Validation loss decreased (-0.458635 --> -0.559348).  Saving model ...
Epoch: 12 cost time: 2.223238468170166
Epoch: 12, Steps: 13 | Train Loss: 36.929 Vali Loss: 168.077 Vali Acc: 0.460 Test Loss: 168.077 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.365962028503418
Epoch: 13, Steps: 13 | Train Loss: 35.647 Vali Loss: 139.842 Vali Acc: 0.520 Test Loss: 139.842 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.4617650508880615
Epoch: 14, Steps: 13 | Train Loss: 22.248 Vali Loss: 193.750 Vali Acc: 0.360 Test Loss: 193.750 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.3085110187530518
Epoch: 15, Steps: 13 | Train Loss: 33.879 Vali Loss: 211.052 Vali Acc: 0.340 Test Loss: 211.052 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.367337703704834
Epoch: 16, Steps: 13 | Train Loss: 52.203 Vali Loss: 91.502 Vali Acc: 0.540 Test Loss: 91.502 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.4859609603881836
Epoch: 17, Steps: 13 | Train Loss: 16.963 Vali Loss: 152.096 Vali Acc: 0.480 Test Loss: 152.096 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.44454026222229
Epoch: 18, Steps: 13 | Train Loss: 10.870 Vali Loss: 126.973 Vali Acc: 0.480 Test Loss: 126.973 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.1663224697113037
Epoch: 19, Steps: 13 | Train Loss: 25.389 Vali Loss: 155.623 Vali Acc: 0.460 Test Loss: 155.623 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.2960548400878906
Epoch: 20, Steps: 13 | Train Loss: 11.519 Vali Loss: 102.404 Vali Acc: 0.520 Test Loss: 102.404 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.51531982421875
Epoch: 21, Steps: 13 | Train Loss: 2.180 Vali Loss: 168.029 Vali Acc: 0.540 Test Loss: 168.029 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 12485789
model size : 48.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.069309711456299
Epoch: 1, Steps: 13 | Train Loss: 12.374 Vali Loss: 24.634 Vali Acc: 0.200 Test Loss: 24.634 Test Acc: 0.200
Validation loss decreased (inf --> -0.199754).  Saving model ...
Epoch: 2 cost time: 2.2598447799682617
Epoch: 2, Steps: 13 | Train Loss: 41.207 Vali Loss: 56.846 Vali Acc: 0.200 Test Loss: 56.846 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.482680320739746
Epoch: 3, Steps: 13 | Train Loss: 53.520 Vali Loss: 74.558 Vali Acc: 0.360 Test Loss: 74.558 Test Acc: 0.360
Validation loss decreased (-0.199754 --> -0.359254).  Saving model ...
Epoch: 4 cost time: 2.359766721725464
Epoch: 4, Steps: 13 | Train Loss: 42.243 Vali Loss: 83.696 Vali Acc: 0.240 Test Loss: 83.696 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2824959754943848
Epoch: 5, Steps: 13 | Train Loss: 25.396 Vali Loss: 31.960 Vali Acc: 0.460 Test Loss: 31.960 Test Acc: 0.460
Validation loss decreased (-0.359254 --> -0.459680).  Saving model ...
Epoch: 6 cost time: 2.3094942569732666
Epoch: 6, Steps: 13 | Train Loss: 29.996 Vali Loss: 61.088 Vali Acc: 0.400 Test Loss: 61.088 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.235971450805664
Epoch: 7, Steps: 13 | Train Loss: 49.160 Vali Loss: 102.497 Vali Acc: 0.340 Test Loss: 102.497 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.4206910133361816
Epoch: 8, Steps: 13 | Train Loss: 52.950 Vali Loss: 85.548 Vali Acc: 0.320 Test Loss: 85.548 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.264897584915161
Epoch: 9, Steps: 13 | Train Loss: 14.439 Vali Loss: 62.452 Vali Acc: 0.460 Test Loss: 62.452 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.3464367389678955
Epoch: 10, Steps: 13 | Train Loss: 26.894 Vali Loss: 99.440 Vali Acc: 0.340 Test Loss: 99.440 Test Acc: 0.340
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.271782159805298
Epoch: 11, Steps: 13 | Train Loss: 53.119 Vali Loss: 94.229 Vali Acc: 0.440 Test Loss: 94.229 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.2045953273773193
Epoch: 12, Steps: 13 | Train Loss: 5.515 Vali Loss: 118.544 Vali Acc: 0.300 Test Loss: 118.544 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.254453659057617
Epoch: 13, Steps: 13 | Train Loss: 36.240 Vali Loss: 103.642 Vali Acc: 0.380 Test Loss: 103.642 Test Acc: 0.380
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.392045736312866
Epoch: 14, Steps: 13 | Train Loss: 17.311 Vali Loss: 115.512 Vali Acc: 0.340 Test Loss: 115.512 Test Acc: 0.340
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.2867000102996826
Epoch: 15, Steps: 13 | Train Loss: 28.855 Vali Loss: 115.052 Vali Acc: 0.420 Test Loss: 115.052 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.46
model parameter : 12484317
model size : 48.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.530017852783203
Epoch: 1, Steps: 13 | Train Loss: 17.444 Vali Loss: 58.713 Vali Acc: 0.200 Test Loss: 58.713 Test Acc: 0.200
Validation loss decreased (inf --> -0.199413).  Saving model ...
Epoch: 2 cost time: 2.3774759769439697
Epoch: 2, Steps: 13 | Train Loss: 45.577 Vali Loss: 75.590 Vali Acc: 0.200 Test Loss: 75.590 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.314311981201172
Epoch: 3, Steps: 13 | Train Loss: 33.287 Vali Loss: 61.410 Vali Acc: 0.200 Test Loss: 61.410 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.2235541343688965
Epoch: 4, Steps: 13 | Train Loss: 47.645 Vali Loss: 95.875 Vali Acc: 0.240 Test Loss: 95.875 Test Acc: 0.240
Validation loss decreased (-0.199413 --> -0.239041).  Saving model ...
Epoch: 5 cost time: 2.2666175365448
Epoch: 5, Steps: 13 | Train Loss: 73.621 Vali Loss: 104.448 Vali Acc: 0.200 Test Loss: 104.448 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.2714474201202393
Epoch: 6, Steps: 13 | Train Loss: 58.919 Vali Loss: 82.743 Vali Acc: 0.360 Test Loss: 82.743 Test Acc: 0.360
Validation loss decreased (-0.239041 --> -0.359173).  Saving model ...
Epoch: 7 cost time: 2.3277690410614014
Epoch: 7, Steps: 13 | Train Loss: 21.603 Vali Loss: 56.092 Vali Acc: 0.440 Test Loss: 56.092 Test Acc: 0.440
Validation loss decreased (-0.359173 --> -0.439439).  Saving model ...
Epoch: 8 cost time: 2.2178680896759033
Epoch: 8, Steps: 13 | Train Loss: 22.360 Vali Loss: 81.605 Vali Acc: 0.460 Test Loss: 81.605 Test Acc: 0.460
Validation loss decreased (-0.439439 --> -0.459184).  Saving model ...
Epoch: 9 cost time: 2.2309532165527344
Epoch: 9, Steps: 13 | Train Loss: 35.163 Vali Loss: 96.093 Vali Acc: 0.300 Test Loss: 96.093 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.2626733779907227
Epoch: 10, Steps: 13 | Train Loss: 37.854 Vali Loss: 136.162 Vali Acc: 0.320 Test Loss: 136.162 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.3362648487091064
Epoch: 11, Steps: 13 | Train Loss: 81.384 Vali Loss: 177.814 Vali Acc: 0.300 Test Loss: 177.814 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.2384164333343506
Epoch: 12, Steps: 13 | Train Loss: 50.632 Vali Loss: 145.058 Vali Acc: 0.340 Test Loss: 145.058 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.329026460647583
Epoch: 13, Steps: 13 | Train Loss: 84.505 Vali Loss: 147.644 Vali Acc: 0.380 Test Loss: 147.644 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.4919073581695557
Epoch: 14, Steps: 13 | Train Loss: 37.038 Vali Loss: 113.930 Vali Acc: 0.480 Test Loss: 113.930 Test Acc: 0.480
Validation loss decreased (-0.459184 --> -0.478861).  Saving model ...
Epoch: 15 cost time: 2.3735766410827637
Epoch: 15, Steps: 13 | Train Loss: 25.683 Vali Loss: 121.202 Vali Acc: 0.400 Test Loss: 121.202 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.382561683654785
Epoch: 16, Steps: 13 | Train Loss: 15.585 Vali Loss: 275.538 Vali Acc: 0.360 Test Loss: 275.538 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.3915762901306152
Epoch: 17, Steps: 13 | Train Loss: 71.334 Vali Loss: 239.243 Vali Acc: 0.420 Test Loss: 239.243 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.4296743869781494
Epoch: 18, Steps: 13 | Train Loss: 9.594 Vali Loss: 107.654 Vali Acc: 0.520 Test Loss: 107.654 Test Acc: 0.520
Validation loss decreased (-0.478861 --> -0.518923).  Saving model ...
Epoch: 19 cost time: 2.261470317840576
Epoch: 19, Steps: 13 | Train Loss: 19.972 Vali Loss: 250.761 Vali Acc: 0.360 Test Loss: 250.761 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.296602487564087
Epoch: 20, Steps: 13 | Train Loss: 26.155 Vali Loss: 157.781 Vali Acc: 0.380 Test Loss: 157.781 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.3990070819854736
Epoch: 21, Steps: 13 | Train Loss: 16.025 Vali Loss: 139.566 Vali Acc: 0.460 Test Loss: 139.566 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.2582952976226807
Epoch: 22, Steps: 13 | Train Loss: 3.747 Vali Loss: 157.116 Vali Acc: 0.520 Test Loss: 157.116 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.3171114921569824
Epoch: 23, Steps: 13 | Train Loss: 27.068 Vali Loss: 208.304 Vali Acc: 0.440 Test Loss: 208.304 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.2364554405212402
Epoch: 24, Steps: 13 | Train Loss: 8.464 Vali Loss: 105.951 Vali Acc: 0.640 Test Loss: 105.951 Test Acc: 0.640
Validation loss decreased (-0.518923 --> -0.638940).  Saving model ...
Epoch: 25 cost time: 2.340672492980957
Epoch: 25, Steps: 13 | Train Loss: 0.252 Vali Loss: 110.410 Vali Acc: 0.600 Test Loss: 110.410 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.2811343669891357
Epoch: 26, Steps: 13 | Train Loss: 0.394 Vali Loss: 134.300 Vali Acc: 0.560 Test Loss: 134.300 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.325251340866089
Epoch: 27, Steps: 13 | Train Loss: 6.771 Vali Loss: 315.563 Vali Acc: 0.420 Test Loss: 315.563 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.3297486305236816
Epoch: 28, Steps: 13 | Train Loss: 33.372 Vali Loss: 251.066 Vali Acc: 0.480 Test Loss: 251.066 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.2837257385253906
Epoch: 29, Steps: 13 | Train Loss: 27.644 Vali Loss: 171.296 Vali Acc: 0.580 Test Loss: 171.296 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.2255468368530273
Epoch: 30, Steps: 13 | Train Loss: 3.823 Vali Loss: 215.447 Vali Acc: 0.480 Test Loss: 215.447 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.2447826862335205
Epoch: 31, Steps: 13 | Train Loss: 9.874 Vali Loss: 204.061 Vali Acc: 0.420 Test Loss: 204.061 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.333202362060547
Epoch: 32, Steps: 13 | Train Loss: 11.672 Vali Loss: 227.122 Vali Acc: 0.400 Test Loss: 227.122 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.461883783340454
Epoch: 33, Steps: 13 | Train Loss: 29.530 Vali Loss: 147.187 Vali Acc: 0.580 Test Loss: 147.187 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.338569402694702
Epoch: 34, Steps: 13 | Train Loss: 12.304 Vali Loss: 194.265 Vali Acc: 0.480 Test Loss: 194.265 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.64
model parameter : 12482845
model size : 48.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.507081985473633
Epoch: 1, Steps: 13 | Train Loss: 14.699 Vali Loss: 53.587 Vali Acc: 0.200 Test Loss: 53.587 Test Acc: 0.200
Validation loss decreased (inf --> -0.199464).  Saving model ...
Epoch: 2 cost time: 2.243492603302002
Epoch: 2, Steps: 13 | Train Loss: 37.550 Vali Loss: 40.843 Vali Acc: 0.200 Test Loss: 40.843 Test Acc: 0.200
Validation loss decreased (-0.199464 --> -0.199592).  Saving model ...
Epoch: 3 cost time: 2.233316421508789
Epoch: 3, Steps: 13 | Train Loss: 59.578 Vali Loss: 35.227 Vali Acc: 0.320 Test Loss: 35.227 Test Acc: 0.320
Validation loss decreased (-0.199592 --> -0.319648).  Saving model ...
Epoch: 4 cost time: 2.1937944889068604
Epoch: 4, Steps: 13 | Train Loss: 44.367 Vali Loss: 95.232 Vali Acc: 0.260 Test Loss: 95.232 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2179410457611084
Epoch: 5, Steps: 13 | Train Loss: 44.592 Vali Loss: 45.250 Vali Acc: 0.360 Test Loss: 45.250 Test Acc: 0.360
Validation loss decreased (-0.319648 --> -0.359547).  Saving model ...
Epoch: 6 cost time: 2.282262086868286
Epoch: 6, Steps: 13 | Train Loss: 33.331 Vali Loss: 30.172 Vali Acc: 0.380 Test Loss: 30.172 Test Acc: 0.380
Validation loss decreased (-0.359547 --> -0.379698).  Saving model ...
Epoch: 7 cost time: 2.17059326171875
Epoch: 7, Steps: 13 | Train Loss: 22.245 Vali Loss: 46.446 Vali Acc: 0.300 Test Loss: 46.446 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.1584792137145996
Epoch: 8, Steps: 13 | Train Loss: 24.296 Vali Loss: 96.807 Vali Acc: 0.280 Test Loss: 96.807 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.2553014755249023
Epoch: 9, Steps: 13 | Train Loss: 23.884 Vali Loss: 96.039 Vali Acc: 0.320 Test Loss: 96.039 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.240907907485962
Epoch: 10, Steps: 13 | Train Loss: 19.962 Vali Loss: 88.069 Vali Acc: 0.360 Test Loss: 88.069 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.2142233848571777
Epoch: 11, Steps: 13 | Train Loss: 25.274 Vali Loss: 58.310 Vali Acc: 0.460 Test Loss: 58.310 Test Acc: 0.460
Validation loss decreased (-0.379698 --> -0.459417).  Saving model ...
Epoch: 12 cost time: 2.1514060497283936
Epoch: 12, Steps: 13 | Train Loss: 14.253 Vali Loss: 161.462 Vali Acc: 0.380 Test Loss: 161.462 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.2283244132995605
Epoch: 13, Steps: 13 | Train Loss: 61.554 Vali Loss: 84.373 Vali Acc: 0.460 Test Loss: 84.373 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.3439457416534424
Epoch: 14, Steps: 13 | Train Loss: 21.153 Vali Loss: 164.351 Vali Acc: 0.360 Test Loss: 164.351 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.3453140258789062
Epoch: 15, Steps: 13 | Train Loss: 21.509 Vali Loss: 79.750 Vali Acc: 0.480 Test Loss: 79.750 Test Acc: 0.480
Validation loss decreased (-0.459417 --> -0.479202).  Saving model ...
Epoch: 16 cost time: 2.199406147003174
Epoch: 16, Steps: 13 | Train Loss: 28.961 Vali Loss: 167.138 Vali Acc: 0.360 Test Loss: 167.138 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.228727340698242
Epoch: 17, Steps: 13 | Train Loss: 18.653 Vali Loss: 195.336 Vali Acc: 0.440 Test Loss: 195.336 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.280845880508423
Epoch: 18, Steps: 13 | Train Loss: 64.816 Vali Loss: 156.673 Vali Acc: 0.480 Test Loss: 156.673 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.275763988494873
Epoch: 19, Steps: 13 | Train Loss: 15.234 Vali Loss: 124.783 Vali Acc: 0.520 Test Loss: 124.783 Test Acc: 0.520
Validation loss decreased (-0.479202 --> -0.518752).  Saving model ...
Epoch: 20 cost time: 2.259467601776123
Epoch: 20, Steps: 13 | Train Loss: 24.979 Vali Loss: 87.025 Vali Acc: 0.580 Test Loss: 87.025 Test Acc: 0.580
Validation loss decreased (-0.518752 --> -0.579130).  Saving model ...
Epoch: 21 cost time: 2.3135032653808594
Epoch: 21, Steps: 13 | Train Loss: 9.295 Vali Loss: 98.248 Vali Acc: 0.460 Test Loss: 98.248 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.3013033866882324
Epoch: 22, Steps: 13 | Train Loss: 2.200 Vali Loss: 153.175 Vali Acc: 0.480 Test Loss: 153.175 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.292090892791748
Epoch: 23, Steps: 13 | Train Loss: 4.211 Vali Loss: 126.844 Vali Acc: 0.440 Test Loss: 126.844 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.499373435974121
Epoch: 24, Steps: 13 | Train Loss: 29.396 Vali Loss: 328.230 Vali Acc: 0.280 Test Loss: 328.230 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.238208293914795
Epoch: 25, Steps: 13 | Train Loss: 6.499 Vali Loss: 311.950 Vali Acc: 0.300 Test Loss: 311.950 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.2076244354248047
Epoch: 26, Steps: 13 | Train Loss: 25.067 Vali Loss: 149.924 Vali Acc: 0.420 Test Loss: 149.924 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.2513840198516846
Epoch: 27, Steps: 13 | Train Loss: 0.201 Vali Loss: 111.279 Vali Acc: 0.440 Test Loss: 111.279 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.2385261058807373
Epoch: 28, Steps: 13 | Train Loss: 1.909 Vali Loss: 167.599 Vali Acc: 0.460 Test Loss: 167.599 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.2088258266448975
Epoch: 29, Steps: 13 | Train Loss: 1.866 Vali Loss: 152.248 Vali Acc: 0.540 Test Loss: 152.248 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.3201189041137695
Epoch: 30, Steps: 13 | Train Loss: 0.276 Vali Loss: 177.483 Vali Acc: 0.540 Test Loss: 177.483 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 12481373
model size : 48.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.9215314388275146
Epoch: 1, Steps: 13 | Train Loss: 19.157 Vali Loss: 27.277 Vali Acc: 0.200 Test Loss: 27.277 Test Acc: 0.200
Validation loss decreased (inf --> -0.199727).  Saving model ...
Epoch: 2 cost time: 2.4226551055908203
Epoch: 2, Steps: 13 | Train Loss: 26.892 Vali Loss: 51.941 Vali Acc: 0.260 Test Loss: 51.941 Test Acc: 0.260
Validation loss decreased (-0.199727 --> -0.259481).  Saving model ...
Epoch: 3 cost time: 2.2541136741638184
Epoch: 3, Steps: 13 | Train Loss: 50.376 Vali Loss: 118.091 Vali Acc: 0.200 Test Loss: 118.091 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.2365779876708984
Epoch: 4, Steps: 13 | Train Loss: 79.881 Vali Loss: 66.318 Vali Acc: 0.400 Test Loss: 66.318 Test Acc: 0.400
Validation loss decreased (-0.259481 --> -0.399337).  Saving model ...
Epoch: 5 cost time: 2.2704825401306152
Epoch: 5, Steps: 13 | Train Loss: 67.278 Vali Loss: 74.558 Vali Acc: 0.260 Test Loss: 74.558 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.324781656265259
Epoch: 6, Steps: 13 | Train Loss: 75.586 Vali Loss: 110.035 Vali Acc: 0.300 Test Loss: 110.035 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.23079252243042
Epoch: 7, Steps: 13 | Train Loss: 47.414 Vali Loss: 94.090 Vali Acc: 0.320 Test Loss: 94.090 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.37882924079895
Epoch: 8, Steps: 13 | Train Loss: 31.840 Vali Loss: 52.312 Vali Acc: 0.460 Test Loss: 52.312 Test Acc: 0.460
Validation loss decreased (-0.399337 --> -0.459477).  Saving model ...
Epoch: 9 cost time: 2.19203519821167
Epoch: 9, Steps: 13 | Train Loss: 17.312 Vali Loss: 135.392 Vali Acc: 0.220 Test Loss: 135.392 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.2033004760742188
Epoch: 10, Steps: 13 | Train Loss: 41.814 Vali Loss: 92.603 Vali Acc: 0.500 Test Loss: 92.603 Test Acc: 0.500
Validation loss decreased (-0.459477 --> -0.499074).  Saving model ...
Epoch: 11 cost time: 2.3186357021331787
Epoch: 11, Steps: 13 | Train Loss: 82.289 Vali Loss: 116.396 Vali Acc: 0.360 Test Loss: 116.396 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.3182482719421387
Epoch: 12, Steps: 13 | Train Loss: 35.064 Vali Loss: 138.857 Vali Acc: 0.440 Test Loss: 138.857 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.453239917755127
Epoch: 13, Steps: 13 | Train Loss: 54.715 Vali Loss: 206.213 Vali Acc: 0.300 Test Loss: 206.213 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.30448055267334
Epoch: 14, Steps: 13 | Train Loss: 24.457 Vali Loss: 129.561 Vali Acc: 0.460 Test Loss: 129.561 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.3418519496917725
Epoch: 15, Steps: 13 | Train Loss: 12.564 Vali Loss: 78.373 Vali Acc: 0.540 Test Loss: 78.373 Test Acc: 0.540
Validation loss decreased (-0.499074 --> -0.539216).  Saving model ...
Epoch: 16 cost time: 2.3837575912475586
Epoch: 16, Steps: 13 | Train Loss: 20.048 Vali Loss: 99.007 Vali Acc: 0.520 Test Loss: 99.007 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.289742946624756
Epoch: 17, Steps: 13 | Train Loss: 34.718 Vali Loss: 196.040 Vali Acc: 0.400 Test Loss: 196.040 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.2527859210968018
Epoch: 18, Steps: 13 | Train Loss: 72.958 Vali Loss: 190.575 Vali Acc: 0.480 Test Loss: 190.575 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.3705294132232666
Epoch: 19, Steps: 13 | Train Loss: 42.064 Vali Loss: 118.932 Vali Acc: 0.480 Test Loss: 118.932 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.4237725734710693
Epoch: 20, Steps: 13 | Train Loss: 30.688 Vali Loss: 223.855 Vali Acc: 0.380 Test Loss: 223.855 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.246673345565796
Epoch: 21, Steps: 13 | Train Loss: 24.787 Vali Loss: 127.076 Vali Acc: 0.540 Test Loss: 127.076 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.300279140472412
Epoch: 22, Steps: 13 | Train Loss: 13.902 Vali Loss: 160.831 Vali Acc: 0.540 Test Loss: 160.831 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.3493082523345947
Epoch: 23, Steps: 13 | Train Loss: 24.756 Vali Loss: 174.894 Vali Acc: 0.480 Test Loss: 174.894 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.412935972213745
Epoch: 24, Steps: 13 | Train Loss: 31.236 Vali Loss: 147.713 Vali Acc: 0.420 Test Loss: 147.713 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.3377177715301514
Epoch: 25, Steps: 13 | Train Loss: 13.947 Vali Loss: 233.780 Vali Acc: 0.400 Test Loss: 233.780 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 12287645
model size : 48.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.678623914718628
Epoch: 1, Steps: 13 | Train Loss: 17.095 Vali Loss: 17.457 Vali Acc: 0.360 Test Loss: 17.457 Test Acc: 0.360
Validation loss decreased (inf --> -0.359825).  Saving model ...
Epoch: 2 cost time: 2.2754595279693604
Epoch: 2, Steps: 13 | Train Loss: 39.001 Vali Loss: 10.210 Vali Acc: 0.360 Test Loss: 10.210 Test Acc: 0.360
Validation loss decreased (-0.359825 --> -0.359898).  Saving model ...
Epoch: 3 cost time: 2.1954967975616455
Epoch: 3, Steps: 13 | Train Loss: 37.553 Vali Loss: 35.490 Vali Acc: 0.200 Test Loss: 35.490 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.209373712539673
Epoch: 4, Steps: 13 | Train Loss: 41.492 Vali Loss: 52.446 Vali Acc: 0.240 Test Loss: 52.446 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.4752471446990967
Epoch: 5, Steps: 13 | Train Loss: 31.323 Vali Loss: 85.845 Vali Acc: 0.180 Test Loss: 85.845 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.329826593399048
Epoch: 6, Steps: 13 | Train Loss: 29.634 Vali Loss: 58.888 Vali Acc: 0.200 Test Loss: 58.888 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.2149388790130615
Epoch: 7, Steps: 13 | Train Loss: 25.481 Vali Loss: 66.837 Vali Acc: 0.300 Test Loss: 66.837 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.3140180110931396
Epoch: 8, Steps: 13 | Train Loss: 26.250 Vali Loss: 69.664 Vali Acc: 0.380 Test Loss: 69.664 Test Acc: 0.380
Validation loss decreased (-0.359898 --> -0.379303).  Saving model ...
Epoch: 9 cost time: 2.3878238201141357
Epoch: 9, Steps: 13 | Train Loss: 29.199 Vali Loss: 115.127 Vali Acc: 0.240 Test Loss: 115.127 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.241621255874634
Epoch: 10, Steps: 13 | Train Loss: 40.706 Vali Loss: 106.434 Vali Acc: 0.460 Test Loss: 106.434 Test Acc: 0.460
Validation loss decreased (-0.379303 --> -0.458936).  Saving model ...
Epoch: 11 cost time: 2.231978178024292
Epoch: 11, Steps: 13 | Train Loss: 51.668 Vali Loss: 55.527 Vali Acc: 0.520 Test Loss: 55.527 Test Acc: 0.520
Validation loss decreased (-0.458936 --> -0.519445).  Saving model ...
Epoch: 12 cost time: 2.2106056213378906
Epoch: 12, Steps: 13 | Train Loss: 16.194 Vali Loss: 91.474 Vali Acc: 0.340 Test Loss: 91.474 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.1443874835968018
Epoch: 13, Steps: 13 | Train Loss: 18.801 Vali Loss: 137.824 Vali Acc: 0.320 Test Loss: 137.824 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.1454498767852783
Epoch: 14, Steps: 13 | Train Loss: 48.609 Vali Loss: 195.772 Vali Acc: 0.420 Test Loss: 195.772 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.1138269901275635
Epoch: 15, Steps: 13 | Train Loss: 132.956 Vali Loss: 178.963 Vali Acc: 0.400 Test Loss: 178.963 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.272273302078247
Epoch: 16, Steps: 13 | Train Loss: 64.067 Vali Loss: 117.130 Vali Acc: 0.460 Test Loss: 117.130 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.296438694000244
Epoch: 17, Steps: 13 | Train Loss: 16.576 Vali Loss: 152.976 Vali Acc: 0.420 Test Loss: 152.976 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.3490591049194336
Epoch: 18, Steps: 13 | Train Loss: 32.457 Vali Loss: 221.377 Vali Acc: 0.420 Test Loss: 221.377 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.282902717590332
Epoch: 19, Steps: 13 | Train Loss: 25.857 Vali Loss: 117.559 Vali Acc: 0.480 Test Loss: 117.559 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.3440730571746826
Epoch: 20, Steps: 13 | Train Loss: 33.862 Vali Loss: 154.117 Vali Acc: 0.460 Test Loss: 154.117 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.258826732635498
Epoch: 21, Steps: 13 | Train Loss: 52.803 Vali Loss: 139.018 Vali Acc: 0.460 Test Loss: 139.018 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 12286173
model size : 48.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.622544050216675
Epoch: 1, Steps: 13 | Train Loss: 9.905 Vali Loss: 21.963 Vali Acc: 0.200 Test Loss: 21.963 Test Acc: 0.200
Validation loss decreased (inf --> -0.199780).  Saving model ...
Epoch: 2 cost time: 2.1397182941436768
Epoch: 2, Steps: 13 | Train Loss: 22.396 Vali Loss: 65.092 Vali Acc: 0.200 Test Loss: 65.092 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2081174850463867
Epoch: 3, Steps: 13 | Train Loss: 35.569 Vali Loss: 17.951 Vali Acc: 0.380 Test Loss: 17.951 Test Acc: 0.380
Validation loss decreased (-0.199780 --> -0.379820).  Saving model ...
Epoch: 4 cost time: 2.3863027095794678
Epoch: 4, Steps: 13 | Train Loss: 30.058 Vali Loss: 58.420 Vali Acc: 0.280 Test Loss: 58.420 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2995707988739014
Epoch: 5, Steps: 13 | Train Loss: 37.013 Vali Loss: 72.399 Vali Acc: 0.320 Test Loss: 72.399 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.206533432006836
Epoch: 6, Steps: 13 | Train Loss: 57.436 Vali Loss: 167.720 Vali Acc: 0.260 Test Loss: 167.720 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.256708860397339
Epoch: 7, Steps: 13 | Train Loss: 56.005 Vali Loss: 76.418 Vali Acc: 0.340 Test Loss: 76.418 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.137238025665283
Epoch: 8, Steps: 13 | Train Loss: 56.386 Vali Loss: 133.535 Vali Acc: 0.480 Test Loss: 133.535 Test Acc: 0.480
Validation loss decreased (-0.379820 --> -0.478665).  Saving model ...
Epoch: 9 cost time: 2.1754403114318848
Epoch: 9, Steps: 13 | Train Loss: 75.199 Vali Loss: 110.539 Vali Acc: 0.340 Test Loss: 110.539 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1178553104400635
Epoch: 10, Steps: 13 | Train Loss: 22.022 Vali Loss: 55.514 Vali Acc: 0.500 Test Loss: 55.514 Test Acc: 0.500
Validation loss decreased (-0.478665 --> -0.499445).  Saving model ...
Epoch: 11 cost time: 2.3095319271087646
Epoch: 11, Steps: 13 | Train Loss: 17.361 Vali Loss: 125.946 Vali Acc: 0.360 Test Loss: 125.946 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.138296127319336
Epoch: 12, Steps: 13 | Train Loss: 42.260 Vali Loss: 154.169 Vali Acc: 0.440 Test Loss: 154.169 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.3408091068267822
Epoch: 13, Steps: 13 | Train Loss: 40.835 Vali Loss: 77.387 Vali Acc: 0.520 Test Loss: 77.387 Test Acc: 0.520
Validation loss decreased (-0.499445 --> -0.519226).  Saving model ...
Epoch: 14 cost time: 2.285512924194336
Epoch: 14, Steps: 13 | Train Loss: 61.673 Vali Loss: 182.460 Vali Acc: 0.320 Test Loss: 182.460 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.281506061553955
Epoch: 15, Steps: 13 | Train Loss: 82.245 Vali Loss: 235.390 Vali Acc: 0.480 Test Loss: 235.390 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.189281702041626
Epoch: 16, Steps: 13 | Train Loss: 77.809 Vali Loss: 154.117 Vali Acc: 0.460 Test Loss: 154.117 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.370614767074585
Epoch: 17, Steps: 13 | Train Loss: 44.499 Vali Loss: 246.090 Vali Acc: 0.420 Test Loss: 246.090 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.362592935562134
Epoch: 18, Steps: 13 | Train Loss: 19.407 Vali Loss: 141.503 Vali Acc: 0.480 Test Loss: 141.503 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.2155065536499023
Epoch: 19, Steps: 13 | Train Loss: 36.572 Vali Loss: 129.340 Vali Acc: 0.600 Test Loss: 129.340 Test Acc: 0.600
Validation loss decreased (-0.519226 --> -0.598707).  Saving model ...
Epoch: 20 cost time: 2.261180877685547
Epoch: 20, Steps: 13 | Train Loss: 35.127 Vali Loss: 198.614 Vali Acc: 0.360 Test Loss: 198.614 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.1488430500030518
Epoch: 21, Steps: 13 | Train Loss: 24.665 Vali Loss: 173.032 Vali Acc: 0.480 Test Loss: 173.032 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.3219873905181885
Epoch: 22, Steps: 13 | Train Loss: 15.215 Vali Loss: 230.578 Vali Acc: 0.420 Test Loss: 230.578 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.2513859272003174
Epoch: 23, Steps: 13 | Train Loss: 34.404 Vali Loss: 191.842 Vali Acc: 0.600 Test Loss: 191.842 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.258812665939331
Epoch: 24, Steps: 13 | Train Loss: 6.825 Vali Loss: 126.014 Vali Acc: 0.580 Test Loss: 126.014 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.1128549575805664
Epoch: 25, Steps: 13 | Train Loss: 2.747 Vali Loss: 164.159 Vali Acc: 0.480 Test Loss: 164.159 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.2658815383911133
Epoch: 26, Steps: 13 | Train Loss: 1.915 Vali Loss: 120.682 Vali Acc: 0.560 Test Loss: 120.682 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.1786091327667236
Epoch: 27, Steps: 13 | Train Loss: 2.340 Vali Loss: 164.990 Vali Acc: 0.480 Test Loss: 164.990 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.1383109092712402
Epoch: 28, Steps: 13 | Train Loss: 7.357 Vali Loss: 142.954 Vali Acc: 0.520 Test Loss: 142.954 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.317690372467041
Epoch: 29, Steps: 13 | Train Loss: 4.016 Vali Loss: 209.421 Vali Acc: 0.480 Test Loss: 209.421 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 12284701
model size : 48.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.6754074096679688
Epoch: 1, Steps: 13 | Train Loss: 20.464 Vali Loss: 24.552 Vali Acc: 0.220 Test Loss: 24.552 Test Acc: 0.220
Validation loss decreased (inf --> -0.219754).  Saving model ...
Epoch: 2 cost time: 2.186676502227783
Epoch: 2, Steps: 13 | Train Loss: 26.730 Vali Loss: 23.780 Vali Acc: 0.260 Test Loss: 23.780 Test Acc: 0.260
Validation loss decreased (-0.219754 --> -0.259762).  Saving model ...
Epoch: 3 cost time: 2.178846597671509
Epoch: 3, Steps: 13 | Train Loss: 40.092 Vali Loss: 72.108 Vali Acc: 0.260 Test Loss: 72.108 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.1892917156219482
Epoch: 4, Steps: 13 | Train Loss: 41.967 Vali Loss: 43.920 Vali Acc: 0.360 Test Loss: 43.920 Test Acc: 0.360
Validation loss decreased (-0.259762 --> -0.359561).  Saving model ...
Epoch: 5 cost time: 2.1903676986694336
Epoch: 5, Steps: 13 | Train Loss: 22.610 Vali Loss: 73.308 Vali Acc: 0.380 Test Loss: 73.308 Test Acc: 0.380
Validation loss decreased (-0.359561 --> -0.379267).  Saving model ...
Epoch: 6 cost time: 2.1083133220672607
Epoch: 6, Steps: 13 | Train Loss: 38.345 Vali Loss: 167.456 Vali Acc: 0.200 Test Loss: 167.456 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0726163387298584
Epoch: 7, Steps: 13 | Train Loss: 142.104 Vali Loss: 227.570 Vali Acc: 0.220 Test Loss: 227.570 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.242079734802246
Epoch: 8, Steps: 13 | Train Loss: 73.750 Vali Loss: 153.867 Vali Acc: 0.400 Test Loss: 153.867 Test Acc: 0.400
Validation loss decreased (-0.379267 --> -0.398461).  Saving model ...
Epoch: 9 cost time: 2.1186325550079346
Epoch: 9, Steps: 13 | Train Loss: 52.449 Vali Loss: 220.031 Vali Acc: 0.260 Test Loss: 220.031 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1762542724609375
Epoch: 10, Steps: 13 | Train Loss: 91.903 Vali Loss: 178.685 Vali Acc: 0.380 Test Loss: 178.685 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.0534846782684326
Epoch: 11, Steps: 13 | Train Loss: 43.503 Vali Loss: 118.608 Vali Acc: 0.320 Test Loss: 118.608 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.14363956451416
Epoch: 12, Steps: 13 | Train Loss: 50.624 Vali Loss: 170.641 Vali Acc: 0.440 Test Loss: 170.641 Test Acc: 0.440
Validation loss decreased (-0.398461 --> -0.438294).  Saving model ...
Epoch: 13 cost time: 2.293666362762451
Epoch: 13, Steps: 13 | Train Loss: 21.610 Vali Loss: 108.259 Vali Acc: 0.420 Test Loss: 108.259 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.108880043029785
Epoch: 14, Steps: 13 | Train Loss: 31.469 Vali Loss: 99.118 Vali Acc: 0.520 Test Loss: 99.118 Test Acc: 0.520
Validation loss decreased (-0.438294 --> -0.519009).  Saving model ...
Epoch: 15 cost time: 2.3780813217163086
Epoch: 15, Steps: 13 | Train Loss: 24.237 Vali Loss: 281.503 Vali Acc: 0.440 Test Loss: 281.503 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.168423891067505
Epoch: 16, Steps: 13 | Train Loss: 72.292 Vali Loss: 199.732 Vali Acc: 0.440 Test Loss: 199.732 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.2037482261657715
Epoch: 17, Steps: 13 | Train Loss: 37.729 Vali Loss: 173.851 Vali Acc: 0.340 Test Loss: 173.851 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.224241018295288
Epoch: 18, Steps: 13 | Train Loss: 31.171 Vali Loss: 244.176 Vali Acc: 0.440 Test Loss: 244.176 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.294219732284546
Epoch: 19, Steps: 13 | Train Loss: 63.611 Vali Loss: 236.175 Vali Acc: 0.400 Test Loss: 236.175 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.2959611415863037
Epoch: 20, Steps: 13 | Train Loss: 26.492 Vali Loss: 204.139 Vali Acc: 0.560 Test Loss: 204.139 Test Acc: 0.560
Validation loss decreased (-0.519009 --> -0.557959).  Saving model ...
Epoch: 21 cost time: 2.089095115661621
Epoch: 21, Steps: 13 | Train Loss: 10.040 Vali Loss: 221.802 Vali Acc: 0.500 Test Loss: 221.802 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.2901713848114014
Epoch: 22, Steps: 13 | Train Loss: 18.700 Vali Loss: 177.218 Vali Acc: 0.420 Test Loss: 177.218 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.2907986640930176
Epoch: 23, Steps: 13 | Train Loss: 15.658 Vali Loss: 101.089 Vali Acc: 0.520 Test Loss: 101.089 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.2399401664733887
Epoch: 24, Steps: 13 | Train Loss: 21.699 Vali Loss: 143.591 Vali Acc: 0.420 Test Loss: 143.591 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.2043063640594482
Epoch: 25, Steps: 13 | Train Loss: 11.517 Vali Loss: 121.704 Vali Acc: 0.440 Test Loss: 121.704 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.1475610733032227
Epoch: 26, Steps: 13 | Train Loss: 6.794 Vali Loss: 186.407 Vali Acc: 0.440 Test Loss: 186.407 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.237771987915039
Epoch: 27, Steps: 13 | Train Loss: 1.225 Vali Loss: 163.935 Vali Acc: 0.460 Test Loss: 163.935 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.221881628036499
Epoch: 28, Steps: 13 | Train Loss: 30.637 Vali Loss: 235.782 Vali Acc: 0.440 Test Loss: 235.782 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.077092409133911
Epoch: 29, Steps: 13 | Train Loss: 46.089 Vali Loss: 576.448 Vali Acc: 0.360 Test Loss: 576.448 Test Acc: 0.360
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.271212577819824
Epoch: 30, Steps: 13 | Train Loss: 237.898 Vali Loss: 235.135 Vali Acc: 0.560 Test Loss: 235.135 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 12283229
model size : 48.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.010881185531616
Epoch: 1, Steps: 13 | Train Loss: 11.420 Vali Loss: 18.709 Vali Acc: 0.320 Test Loss: 18.709 Test Acc: 0.320
Validation loss decreased (inf --> -0.319813).  Saving model ...
Epoch: 2 cost time: 2.24741268157959
Epoch: 2, Steps: 13 | Train Loss: 29.630 Vali Loss: 46.568 Vali Acc: 0.200 Test Loss: 46.568 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0618972778320312
Epoch: 3, Steps: 13 | Train Loss: 22.248 Vali Loss: 23.517 Vali Acc: 0.260 Test Loss: 23.517 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.2423195838928223
Epoch: 4, Steps: 13 | Train Loss: 28.030 Vali Loss: 42.100 Vali Acc: 0.240 Test Loss: 42.100 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.171402931213379
Epoch: 5, Steps: 13 | Train Loss: 24.302 Vali Loss: 75.971 Vali Acc: 0.260 Test Loss: 75.971 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.126774549484253
Epoch: 6, Steps: 13 | Train Loss: 30.934 Vali Loss: 41.609 Vali Acc: 0.400 Test Loss: 41.609 Test Acc: 0.400
Validation loss decreased (-0.319813 --> -0.399584).  Saving model ...
Epoch: 7 cost time: 2.042724609375
Epoch: 7, Steps: 13 | Train Loss: 24.258 Vali Loss: 79.487 Vali Acc: 0.260 Test Loss: 79.487 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.072138547897339
Epoch: 8, Steps: 13 | Train Loss: 64.963 Vali Loss: 95.931 Vali Acc: 0.320 Test Loss: 95.931 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.246169090270996
Epoch: 9, Steps: 13 | Train Loss: 61.860 Vali Loss: 164.780 Vali Acc: 0.340 Test Loss: 164.780 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.087233066558838
Epoch: 10, Steps: 13 | Train Loss: 55.223 Vali Loss: 62.845 Vali Acc: 0.460 Test Loss: 62.845 Test Acc: 0.460
Validation loss decreased (-0.399584 --> -0.459372).  Saving model ...
Epoch: 11 cost time: 2.1885457038879395
Epoch: 11, Steps: 13 | Train Loss: 66.857 Vali Loss: 188.954 Vali Acc: 0.240 Test Loss: 188.954 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.183016300201416
Epoch: 12, Steps: 13 | Train Loss: 37.504 Vali Loss: 131.222 Vali Acc: 0.400 Test Loss: 131.222 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.0958147048950195
Epoch: 13, Steps: 13 | Train Loss: 51.960 Vali Loss: 126.938 Vali Acc: 0.420 Test Loss: 126.938 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.0501291751861572
Epoch: 14, Steps: 13 | Train Loss: 33.514 Vali Loss: 110.963 Vali Acc: 0.460 Test Loss: 110.963 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.9569206237792969
Epoch: 15, Steps: 13 | Train Loss: 81.010 Vali Loss: 149.335 Vali Acc: 0.380 Test Loss: 149.335 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.0204484462738037
Epoch: 16, Steps: 13 | Train Loss: 48.583 Vali Loss: 153.196 Vali Acc: 0.400 Test Loss: 153.196 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.965355634689331
Epoch: 17, Steps: 13 | Train Loss: 12.089 Vali Loss: 152.649 Vali Acc: 0.540 Test Loss: 152.649 Test Acc: 0.540
Validation loss decreased (-0.459372 --> -0.538474).  Saving model ...
Epoch: 18 cost time: 1.9742631912231445
Epoch: 18, Steps: 13 | Train Loss: 18.030 Vali Loss: 141.443 Vali Acc: 0.460 Test Loss: 141.443 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.1399033069610596
Epoch: 19, Steps: 13 | Train Loss: 42.019 Vali Loss: 150.933 Vali Acc: 0.400 Test Loss: 150.933 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.1276633739471436
Epoch: 20, Steps: 13 | Train Loss: 41.355 Vali Loss: 171.031 Vali Acc: 0.520 Test Loss: 171.031 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.062940835952759
Epoch: 21, Steps: 13 | Train Loss: 9.882 Vali Loss: 192.941 Vali Acc: 0.540 Test Loss: 192.941 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.015856981277466
Epoch: 22, Steps: 13 | Train Loss: 2.374 Vali Loss: 168.141 Vali Acc: 0.480 Test Loss: 168.141 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.2040257453918457
Epoch: 23, Steps: 13 | Train Loss: 3.751 Vali Loss: 208.042 Vali Acc: 0.380 Test Loss: 208.042 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.087907075881958
Epoch: 24, Steps: 13 | Train Loss: 12.012 Vali Loss: 220.343 Vali Acc: 0.440 Test Loss: 220.343 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.1985249519348145
Epoch: 25, Steps: 13 | Train Loss: 23.017 Vali Loss: 178.550 Vali Acc: 0.520 Test Loss: 178.550 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.059133291244507
Epoch: 26, Steps: 13 | Train Loss: 5.937 Vali Loss: 296.043 Vali Acc: 0.520 Test Loss: 296.043 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.104553699493408
Epoch: 27, Steps: 13 | Train Loss: 33.413 Vali Loss: 201.985 Vali Acc: 0.520 Test Loss: 201.985 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 12188573
model size : 47.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.564587116241455
Epoch: 1, Steps: 13 | Train Loss: 20.532 Vali Loss: 33.974 Vali Acc: 0.180 Test Loss: 33.974 Test Acc: 0.180
Validation loss decreased (inf --> -0.179660).  Saving model ...
Epoch: 2 cost time: 2.0334935188293457
Epoch: 2, Steps: 13 | Train Loss: 29.012 Vali Loss: 48.035 Vali Acc: 0.300 Test Loss: 48.035 Test Acc: 0.300
Validation loss decreased (-0.179660 --> -0.299520).  Saving model ...
Epoch: 3 cost time: 2.0590736865997314
Epoch: 3, Steps: 13 | Train Loss: 22.629 Vali Loss: 53.493 Vali Acc: 0.320 Test Loss: 53.493 Test Acc: 0.320
Validation loss decreased (-0.299520 --> -0.319465).  Saving model ...
Epoch: 4 cost time: 2.120845317840576
Epoch: 4, Steps: 13 | Train Loss: 32.201 Vali Loss: 45.446 Vali Acc: 0.280 Test Loss: 45.446 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.1503190994262695
Epoch: 5, Steps: 13 | Train Loss: 31.749 Vali Loss: 77.677 Vali Acc: 0.280 Test Loss: 77.677 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.1048576831817627
Epoch: 6, Steps: 13 | Train Loss: 48.445 Vali Loss: 50.945 Vali Acc: 0.320 Test Loss: 50.945 Test Acc: 0.320
Validation loss decreased (-0.319465 --> -0.319491).  Saving model ...
Epoch: 7 cost time: 2.025214195251465
Epoch: 7, Steps: 13 | Train Loss: 42.840 Vali Loss: 130.667 Vali Acc: 0.220 Test Loss: 130.667 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0858612060546875
Epoch: 8, Steps: 13 | Train Loss: 61.503 Vali Loss: 102.168 Vali Acc: 0.340 Test Loss: 102.168 Test Acc: 0.340
Validation loss decreased (-0.319491 --> -0.338978).  Saving model ...
Epoch: 9 cost time: 2.1310365200042725
Epoch: 9, Steps: 13 | Train Loss: 41.363 Vali Loss: 155.059 Vali Acc: 0.320 Test Loss: 155.059 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.08975887298584
Epoch: 10, Steps: 13 | Train Loss: 74.730 Vali Loss: 134.163 Vali Acc: 0.340 Test Loss: 134.163 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.988661527633667
Epoch: 11, Steps: 13 | Train Loss: 32.945 Vali Loss: 105.856 Vali Acc: 0.480 Test Loss: 105.856 Test Acc: 0.480
Validation loss decreased (-0.338978 --> -0.478941).  Saving model ...
Epoch: 12 cost time: 2.0719168186187744
Epoch: 12, Steps: 13 | Train Loss: 28.440 Vali Loss: 67.974 Vali Acc: 0.420 Test Loss: 67.974 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.074049711227417
Epoch: 13, Steps: 13 | Train Loss: 18.523 Vali Loss: 80.052 Vali Acc: 0.440 Test Loss: 80.052 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.1627471446990967
Epoch: 14, Steps: 13 | Train Loss: 22.333 Vali Loss: 87.920 Vali Acc: 0.340 Test Loss: 87.920 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.1022517681121826
Epoch: 15, Steps: 13 | Train Loss: 16.202 Vali Loss: 145.594 Vali Acc: 0.380 Test Loss: 145.594 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.2388410568237305
Epoch: 16, Steps: 13 | Train Loss: 41.265 Vali Loss: 180.550 Vali Acc: 0.340 Test Loss: 180.550 Test Acc: 0.340
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.074803590774536
Epoch: 17, Steps: 13 | Train Loss: 45.970 Vali Loss: 134.425 Vali Acc: 0.440 Test Loss: 134.425 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.1577415466308594
Epoch: 18, Steps: 13 | Train Loss: 15.659 Vali Loss: 313.159 Vali Acc: 0.320 Test Loss: 313.159 Test Acc: 0.320
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.1716318130493164
Epoch: 19, Steps: 13 | Train Loss: 31.937 Vali Loss: 231.597 Vali Acc: 0.380 Test Loss: 231.597 Test Acc: 0.380
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.9913673400878906
Epoch: 20, Steps: 13 | Train Loss: 33.552 Vali Loss: 176.727 Vali Acc: 0.540 Test Loss: 176.727 Test Acc: 0.540
Validation loss decreased (-0.478941 --> -0.538233).  Saving model ...
Epoch: 21 cost time: 1.9928309917449951
Epoch: 21, Steps: 13 | Train Loss: 4.016 Vali Loss: 191.195 Vali Acc: 0.540 Test Loss: 191.195 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.0583643913269043
Epoch: 22, Steps: 13 | Train Loss: 14.334 Vali Loss: 233.243 Vali Acc: 0.440 Test Loss: 233.243 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.049999237060547
Epoch: 23, Steps: 13 | Train Loss: 35.985 Vali Loss: 241.957 Vali Acc: 0.480 Test Loss: 241.957 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.869866132736206
Epoch: 24, Steps: 13 | Train Loss: 19.383 Vali Loss: 161.939 Vali Acc: 0.600 Test Loss: 161.939 Test Acc: 0.600
Validation loss decreased (-0.538233 --> -0.598381).  Saving model ...
Epoch: 25 cost time: 2.1676504611968994
Epoch: 25, Steps: 13 | Train Loss: 19.721 Vali Loss: 299.415 Vali Acc: 0.440 Test Loss: 299.415 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.132838487625122
Epoch: 26, Steps: 13 | Train Loss: 21.770 Vali Loss: 251.411 Vali Acc: 0.420 Test Loss: 251.411 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.18440842628479
Epoch: 27, Steps: 13 | Train Loss: 21.585 Vali Loss: 206.470 Vali Acc: 0.520 Test Loss: 206.470 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.1071324348449707
Epoch: 28, Steps: 13 | Train Loss: 8.670 Vali Loss: 315.844 Vali Acc: 0.440 Test Loss: 315.844 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.0517406463623047
Epoch: 29, Steps: 13 | Train Loss: 21.169 Vali Loss: 259.264 Vali Acc: 0.480 Test Loss: 259.264 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.2129569053649902
Epoch: 30, Steps: 13 | Train Loss: 0.555 Vali Loss: 255.177 Vali Acc: 0.440 Test Loss: 255.177 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.117473602294922
Epoch: 31, Steps: 13 | Train Loss: 1.127 Vali Loss: 225.888 Vali Acc: 0.420 Test Loss: 225.888 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.060499429702759
Epoch: 32, Steps: 13 | Train Loss: 16.556 Vali Loss: 357.074 Vali Acc: 0.500 Test Loss: 357.074 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.1852338314056396
Epoch: 33, Steps: 13 | Train Loss: 32.766 Vali Loss: 245.617 Vali Acc: 0.560 Test Loss: 245.617 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.065660238265991
Epoch: 34, Steps: 13 | Train Loss: 10.840 Vali Loss: 304.272 Vali Acc: 0.480 Test Loss: 304.272 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 12187101
model size : 47.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.2880728244781494
Epoch: 1, Steps: 13 | Train Loss: 17.232 Vali Loss: 44.602 Vali Acc: 0.200 Test Loss: 44.602 Test Acc: 0.200
Validation loss decreased (inf --> -0.199554).  Saving model ...
Epoch: 2 cost time: 1.9952208995819092
Epoch: 2, Steps: 13 | Train Loss: 35.538 Vali Loss: 35.231 Vali Acc: 0.320 Test Loss: 35.231 Test Acc: 0.320
Validation loss decreased (-0.199554 --> -0.319648).  Saving model ...
Epoch: 3 cost time: 2.0123119354248047
Epoch: 3, Steps: 13 | Train Loss: 24.959 Vali Loss: 34.681 Vali Acc: 0.400 Test Loss: 34.681 Test Acc: 0.400
Validation loss decreased (-0.319648 --> -0.399653).  Saving model ...
Epoch: 4 cost time: 2.027317762374878
Epoch: 4, Steps: 13 | Train Loss: 32.810 Vali Loss: 34.891 Vali Acc: 0.400 Test Loss: 34.891 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0857608318328857
Epoch: 5, Steps: 13 | Train Loss: 21.266 Vali Loss: 27.763 Vali Acc: 0.300 Test Loss: 27.763 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.0734829902648926
Epoch: 6, Steps: 13 | Train Loss: 16.221 Vali Loss: 109.981 Vali Acc: 0.200 Test Loss: 109.981 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.0765585899353027
Epoch: 7, Steps: 13 | Train Loss: 57.594 Vali Loss: 32.152 Vali Acc: 0.440 Test Loss: 32.152 Test Acc: 0.440
Validation loss decreased (-0.399653 --> -0.439678).  Saving model ...
Epoch: 8 cost time: 2.059061050415039
Epoch: 8, Steps: 13 | Train Loss: 66.724 Vali Loss: 86.327 Vali Acc: 0.320 Test Loss: 86.327 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.0070817470550537
Epoch: 9, Steps: 13 | Train Loss: 42.758 Vali Loss: 171.639 Vali Acc: 0.280 Test Loss: 171.639 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.1027352809906006
Epoch: 10, Steps: 13 | Train Loss: 55.152 Vali Loss: 215.616 Vali Acc: 0.220 Test Loss: 215.616 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.1447672843933105
Epoch: 11, Steps: 13 | Train Loss: 69.523 Vali Loss: 101.873 Vali Acc: 0.380 Test Loss: 101.873 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.1236422061920166
Epoch: 12, Steps: 13 | Train Loss: 24.515 Vali Loss: 116.180 Vali Acc: 0.320 Test Loss: 116.180 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.136420488357544
Epoch: 13, Steps: 13 | Train Loss: 25.608 Vali Loss: 168.059 Vali Acc: 0.320 Test Loss: 168.059 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.03098726272583
Epoch: 14, Steps: 13 | Train Loss: 69.433 Vali Loss: 268.669 Vali Acc: 0.400 Test Loss: 268.669 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.2553367614746094
Epoch: 15, Steps: 13 | Train Loss: 97.781 Vali Loss: 228.382 Vali Acc: 0.300 Test Loss: 228.382 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.89133620262146
Epoch: 16, Steps: 13 | Train Loss: 73.354 Vali Loss: 258.780 Vali Acc: 0.380 Test Loss: 258.780 Test Acc: 0.380
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.9984629154205322
Epoch: 17, Steps: 13 | Train Loss: 54.218 Vali Loss: 185.301 Vali Acc: 0.420 Test Loss: 185.301 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.44
model parameter : 12185629
model size : 47.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.4940011501312256
Epoch: 1, Steps: 13 | Train Loss: 14.583 Vali Loss: 13.266 Vali Acc: 0.200 Test Loss: 13.266 Test Acc: 0.200
Validation loss decreased (inf --> -0.199867).  Saving model ...
Epoch: 2 cost time: 1.8410327434539795
Epoch: 2, Steps: 13 | Train Loss: 26.903 Vali Loss: 50.984 Vali Acc: 0.200 Test Loss: 50.984 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0147440433502197
Epoch: 3, Steps: 13 | Train Loss: 57.861 Vali Loss: 86.214 Vali Acc: 0.300 Test Loss: 86.214 Test Acc: 0.300
Validation loss decreased (-0.199867 --> -0.299138).  Saving model ...
Epoch: 4 cost time: 1.938281774520874
Epoch: 4, Steps: 13 | Train Loss: 55.057 Vali Loss: 99.361 Vali Acc: 0.280 Test Loss: 99.361 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0310983657836914
Epoch: 5, Steps: 13 | Train Loss: 59.343 Vali Loss: 89.975 Vali Acc: 0.280 Test Loss: 89.975 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.0544519424438477
Epoch: 6, Steps: 13 | Train Loss: 54.855 Vali Loss: 88.465 Vali Acc: 0.260 Test Loss: 88.465 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.0528666973114014
Epoch: 7, Steps: 13 | Train Loss: 77.329 Vali Loss: 138.666 Vali Acc: 0.220 Test Loss: 138.666 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.008087158203125
Epoch: 8, Steps: 13 | Train Loss: 36.733 Vali Loss: 62.792 Vali Acc: 0.400 Test Loss: 62.792 Test Acc: 0.400
Validation loss decreased (-0.299138 --> -0.399372).  Saving model ...
Epoch: 9 cost time: 2.159965753555298
Epoch: 9, Steps: 13 | Train Loss: 61.705 Vali Loss: 150.768 Vali Acc: 0.300 Test Loss: 150.768 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9679534435272217
Epoch: 10, Steps: 13 | Train Loss: 45.075 Vali Loss: 112.492 Vali Acc: 0.260 Test Loss: 112.492 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.014427661895752
Epoch: 11, Steps: 13 | Train Loss: 34.990 Vali Loss: 111.856 Vali Acc: 0.440 Test Loss: 111.856 Test Acc: 0.440
Validation loss decreased (-0.399372 --> -0.438881).  Saving model ...
Epoch: 12 cost time: 2.1498708724975586
Epoch: 12, Steps: 13 | Train Loss: 12.708 Vali Loss: 91.977 Vali Acc: 0.500 Test Loss: 91.977 Test Acc: 0.500
Validation loss decreased (-0.438881 --> -0.499080).  Saving model ...
Epoch: 13 cost time: 2.167323589324951
Epoch: 13, Steps: 13 | Train Loss: 34.962 Vali Loss: 159.707 Vali Acc: 0.280 Test Loss: 159.707 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.1564624309539795
Epoch: 14, Steps: 13 | Train Loss: 27.999 Vali Loss: 139.335 Vali Acc: 0.360 Test Loss: 139.335 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.174227476119995
Epoch: 15, Steps: 13 | Train Loss: 46.865 Vali Loss: 170.431 Vali Acc: 0.380 Test Loss: 170.431 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.1827211380004883
Epoch: 16, Steps: 13 | Train Loss: 26.633 Vali Loss: 110.781 Vali Acc: 0.420 Test Loss: 110.781 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.1258747577667236
Epoch: 17, Steps: 13 | Train Loss: 18.060 Vali Loss: 175.070 Vali Acc: 0.460 Test Loss: 175.070 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.222867012023926
Epoch: 18, Steps: 13 | Train Loss: 14.960 Vali Loss: 120.885 Vali Acc: 0.460 Test Loss: 120.885 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.1529574394226074
Epoch: 19, Steps: 13 | Train Loss: 27.019 Vali Loss: 160.550 Vali Acc: 0.460 Test Loss: 160.550 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.2023632526397705
Epoch: 20, Steps: 13 | Train Loss: 27.339 Vali Loss: 217.811 Vali Acc: 0.360 Test Loss: 217.811 Test Acc: 0.360
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.018817901611328
Epoch: 21, Steps: 13 | Train Loss: 25.660 Vali Loss: 140.238 Vali Acc: 0.420 Test Loss: 140.238 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.2607970237731934
Epoch: 22, Steps: 13 | Train Loss: 50.817 Vali Loss: 145.536 Vali Acc: 0.500 Test Loss: 145.536 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 12184157
model size : 47.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.3119592666625977
Epoch: 1, Steps: 13 | Train Loss: 20.279 Vali Loss: 40.710 Vali Acc: 0.200 Test Loss: 40.710 Test Acc: 0.200
Validation loss decreased (inf --> -0.199593).  Saving model ...
Epoch: 2 cost time: 1.9825551509857178
Epoch: 2, Steps: 13 | Train Loss: 30.799 Vali Loss: 94.987 Vali Acc: 0.200 Test Loss: 94.987 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2009835243225098
Epoch: 3, Steps: 13 | Train Loss: 56.275 Vali Loss: 53.816 Vali Acc: 0.220 Test Loss: 53.816 Test Acc: 0.220
Validation loss decreased (-0.199593 --> -0.219462).  Saving model ...
Epoch: 4 cost time: 1.965627908706665
Epoch: 4, Steps: 13 | Train Loss: 38.968 Vali Loss: 93.535 Vali Acc: 0.260 Test Loss: 93.535 Test Acc: 0.260
Validation loss decreased (-0.219462 --> -0.259065).  Saving model ...
Epoch: 5 cost time: 1.891568660736084
Epoch: 5, Steps: 13 | Train Loss: 68.715 Vali Loss: 118.535 Vali Acc: 0.360 Test Loss: 118.535 Test Acc: 0.360
Validation loss decreased (-0.259065 --> -0.358815).  Saving model ...
Epoch: 6 cost time: 1.922630786895752
Epoch: 6, Steps: 13 | Train Loss: 74.131 Vali Loss: 59.453 Vali Acc: 0.360 Test Loss: 59.453 Test Acc: 0.360
Validation loss decreased (-0.358815 --> -0.359405).  Saving model ...
Epoch: 7 cost time: 1.9255735874176025
Epoch: 7, Steps: 13 | Train Loss: 72.839 Vali Loss: 99.858 Vali Acc: 0.300 Test Loss: 99.858 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.938631534576416
Epoch: 8, Steps: 13 | Train Loss: 78.100 Vali Loss: 77.064 Vali Acc: 0.300 Test Loss: 77.064 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.891573429107666
Epoch: 9, Steps: 13 | Train Loss: 50.964 Vali Loss: 124.441 Vali Acc: 0.280 Test Loss: 124.441 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.9788825511932373
Epoch: 10, Steps: 13 | Train Loss: 91.404 Vali Loss: 89.739 Vali Acc: 0.400 Test Loss: 89.739 Test Acc: 0.400
Validation loss decreased (-0.359405 --> -0.399103).  Saving model ...
Epoch: 11 cost time: 1.9888153076171875
Epoch: 11, Steps: 13 | Train Loss: 41.243 Vali Loss: 117.656 Vali Acc: 0.400 Test Loss: 117.656 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9445195198059082
Epoch: 12, Steps: 13 | Train Loss: 20.996 Vali Loss: 81.341 Vali Acc: 0.380 Test Loss: 81.341 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.9196417331695557
Epoch: 13, Steps: 13 | Train Loss: 34.609 Vali Loss: 231.640 Vali Acc: 0.300 Test Loss: 231.640 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.9396486282348633
Epoch: 14, Steps: 13 | Train Loss: 68.019 Vali Loss: 123.268 Vali Acc: 0.400 Test Loss: 123.268 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.073115825653076
Epoch: 15, Steps: 13 | Train Loss: 73.922 Vali Loss: 158.731 Vali Acc: 0.360 Test Loss: 158.731 Test Acc: 0.360
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.9388957023620605
Epoch: 16, Steps: 13 | Train Loss: 87.729 Vali Loss: 231.417 Vali Acc: 0.400 Test Loss: 231.417 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.929427146911621
Epoch: 17, Steps: 13 | Train Loss: 49.659 Vali Loss: 167.570 Vali Acc: 0.320 Test Loss: 167.570 Test Acc: 0.320
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.981182336807251
Epoch: 18, Steps: 13 | Train Loss: 60.444 Vali Loss: 225.722 Vali Acc: 0.440 Test Loss: 225.722 Test Acc: 0.440
Validation loss decreased (-0.399103 --> -0.437743).  Saving model ...
Epoch: 19 cost time: 1.98954439163208
Epoch: 19, Steps: 13 | Train Loss: 20.945 Vali Loss: 339.738 Vali Acc: 0.260 Test Loss: 339.738 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.9617478847503662
Epoch: 20, Steps: 13 | Train Loss: 49.049 Vali Loss: 189.605 Vali Acc: 0.500 Test Loss: 189.605 Test Acc: 0.500
Validation loss decreased (-0.437743 --> -0.498104).  Saving model ...
Epoch: 21 cost time: 1.8646984100341797
Epoch: 21, Steps: 13 | Train Loss: 31.413 Vali Loss: 197.329 Vali Acc: 0.540 Test Loss: 197.329 Test Acc: 0.540
Validation loss decreased (-0.498104 --> -0.538027).  Saving model ...
Epoch: 22 cost time: 1.8982434272766113
Epoch: 22, Steps: 13 | Train Loss: 27.493 Vali Loss: 180.085 Vali Acc: 0.500 Test Loss: 180.085 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.9073610305786133
Epoch: 23, Steps: 13 | Train Loss: 8.385 Vali Loss: 181.165 Vali Acc: 0.440 Test Loss: 181.165 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.9278430938720703
Epoch: 24, Steps: 13 | Train Loss: 0.000 Vali Loss: 162.914 Vali Acc: 0.460 Test Loss: 162.914 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.8739817142486572
Epoch: 25, Steps: 13 | Train Loss: 0.016 Vali Loss: 180.961 Vali Acc: 0.420 Test Loss: 180.961 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.9266676902770996
Epoch: 26, Steps: 13 | Train Loss: 2.913 Vali Loss: 166.565 Vali Acc: 0.480 Test Loss: 166.565 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.9130189418792725
Epoch: 27, Steps: 13 | Train Loss: 24.384 Vali Loss: 340.081 Vali Acc: 0.320 Test Loss: 340.081 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.9391355514526367
Epoch: 28, Steps: 13 | Train Loss: 8.410 Vali Loss: 229.993 Vali Acc: 0.500 Test Loss: 229.993 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.9821603298187256
Epoch: 29, Steps: 13 | Train Loss: 13.990 Vali Loss: 198.668 Vali Acc: 0.500 Test Loss: 198.668 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.9893286228179932
Epoch: 30, Steps: 13 | Train Loss: 20.101 Vali Loss: 237.045 Vali Acc: 0.480 Test Loss: 237.045 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.915137529373169
Epoch: 31, Steps: 13 | Train Loss: 8.284 Vali Loss: 190.646 Vali Acc: 0.520 Test Loss: 190.646 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 12139037
model size : 47.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.3680264949798584
Epoch: 1, Steps: 13 | Train Loss: 18.836 Vali Loss: 65.811 Vali Acc: 0.200 Test Loss: 65.811 Test Acc: 0.200
Validation loss decreased (inf --> -0.199342).  Saving model ...
Epoch: 2 cost time: 2.040250778198242
Epoch: 2, Steps: 13 | Train Loss: 53.842 Vali Loss: 75.134 Vali Acc: 0.260 Test Loss: 75.134 Test Acc: 0.260
Validation loss decreased (-0.199342 --> -0.259249).  Saving model ...
Epoch: 3 cost time: 1.9898505210876465
Epoch: 3, Steps: 13 | Train Loss: 96.961 Vali Loss: 75.220 Vali Acc: 0.240 Test Loss: 75.220 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9346258640289307
Epoch: 4, Steps: 13 | Train Loss: 62.371 Vali Loss: 54.902 Vali Acc: 0.320 Test Loss: 54.902 Test Acc: 0.320
Validation loss decreased (-0.259249 --> -0.319451).  Saving model ...
Epoch: 5 cost time: 1.9766361713409424
Epoch: 5, Steps: 13 | Train Loss: 28.237 Vali Loss: 84.188 Vali Acc: 0.280 Test Loss: 84.188 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9465360641479492
Epoch: 6, Steps: 13 | Train Loss: 54.700 Vali Loss: 92.207 Vali Acc: 0.280 Test Loss: 92.207 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.979356288909912
Epoch: 7, Steps: 13 | Train Loss: 119.145 Vali Loss: 172.166 Vali Acc: 0.240 Test Loss: 172.166 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.9132769107818604
Epoch: 8, Steps: 13 | Train Loss: 65.872 Vali Loss: 82.916 Vali Acc: 0.300 Test Loss: 82.916 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.037156343460083
Epoch: 9, Steps: 13 | Train Loss: 51.788 Vali Loss: 128.497 Vali Acc: 0.300 Test Loss: 128.497 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.0146844387054443
Epoch: 10, Steps: 13 | Train Loss: 93.599 Vali Loss: 158.363 Vali Acc: 0.360 Test Loss: 158.363 Test Acc: 0.360
Validation loss decreased (-0.319451 --> -0.358416).  Saving model ...
Epoch: 11 cost time: 1.925473928451538
Epoch: 11, Steps: 13 | Train Loss: 78.171 Vali Loss: 218.055 Vali Acc: 0.320 Test Loss: 218.055 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.015380859375
Epoch: 12, Steps: 13 | Train Loss: 45.645 Vali Loss: 134.889 Vali Acc: 0.460 Test Loss: 134.889 Test Acc: 0.460
Validation loss decreased (-0.358416 --> -0.458651).  Saving model ...
Epoch: 13 cost time: 2.2010388374328613
Epoch: 13, Steps: 13 | Train Loss: 63.666 Vali Loss: 159.020 Vali Acc: 0.380 Test Loss: 159.020 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.184741258621216
Epoch: 14, Steps: 13 | Train Loss: 42.307 Vali Loss: 109.889 Vali Acc: 0.320 Test Loss: 109.889 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.018129348754883
Epoch: 15, Steps: 13 | Train Loss: 42.567 Vali Loss: 168.248 Vali Acc: 0.400 Test Loss: 168.248 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.0235798358917236
Epoch: 16, Steps: 13 | Train Loss: 41.067 Vali Loss: 150.871 Vali Acc: 0.480 Test Loss: 150.871 Test Acc: 0.480
Validation loss decreased (-0.458651 --> -0.478491).  Saving model ...
Epoch: 17 cost time: 2.016963243484497
Epoch: 17, Steps: 13 | Train Loss: 27.123 Vali Loss: 159.729 Vali Acc: 0.520 Test Loss: 159.729 Test Acc: 0.520
Validation loss decreased (-0.478491 --> -0.518403).  Saving model ...
Epoch: 18 cost time: 2.091996669769287
Epoch: 18, Steps: 13 | Train Loss: 48.260 Vali Loss: 185.815 Vali Acc: 0.500 Test Loss: 185.815 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.9810678958892822
Epoch: 19, Steps: 13 | Train Loss: 23.244 Vali Loss: 183.931 Vali Acc: 0.460 Test Loss: 183.931 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.102774143218994
Epoch: 20, Steps: 13 | Train Loss: 66.774 Vali Loss: 189.901 Vali Acc: 0.420 Test Loss: 189.901 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.0440852642059326
Epoch: 21, Steps: 13 | Train Loss: 32.203 Vali Loss: 153.479 Vali Acc: 0.580 Test Loss: 153.479 Test Acc: 0.580
Validation loss decreased (-0.518403 --> -0.578465).  Saving model ...
Epoch: 22 cost time: 2.0187008380889893
Epoch: 22, Steps: 13 | Train Loss: 15.086 Vali Loss: 143.870 Vali Acc: 0.560 Test Loss: 143.870 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.146667242050171
Epoch: 23, Steps: 13 | Train Loss: 14.950 Vali Loss: 214.238 Vali Acc: 0.480 Test Loss: 214.238 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.956512212753296
Epoch: 24, Steps: 13 | Train Loss: 20.782 Vali Loss: 173.125 Vali Acc: 0.560 Test Loss: 173.125 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.0085995197296143
Epoch: 25, Steps: 13 | Train Loss: 3.519 Vali Loss: 208.159 Vali Acc: 0.500 Test Loss: 208.159 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.9002890586853027
Epoch: 26, Steps: 13 | Train Loss: 22.303 Vali Loss: 212.904 Vali Acc: 0.440 Test Loss: 212.904 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.038239002227783
Epoch: 27, Steps: 13 | Train Loss: 10.667 Vali Loss: 113.092 Vali Acc: 0.640 Test Loss: 113.092 Test Acc: 0.640
Validation loss decreased (-0.578465 --> -0.638869).  Saving model ...
Epoch: 28 cost time: 1.9969792366027832
Epoch: 28, Steps: 13 | Train Loss: 7.199 Vali Loss: 158.886 Vali Acc: 0.560 Test Loss: 158.886 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.019542694091797
Epoch: 29, Steps: 13 | Train Loss: 9.710 Vali Loss: 184.280 Vali Acc: 0.540 Test Loss: 184.280 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.069154977798462
Epoch: 30, Steps: 13 | Train Loss: 0.608 Vali Loss: 173.638 Vali Acc: 0.540 Test Loss: 173.638 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.8932790756225586
Epoch: 31, Steps: 13 | Train Loss: 21.222 Vali Loss: 189.000 Vali Acc: 0.540 Test Loss: 189.000 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.9152233600616455
Epoch: 32, Steps: 13 | Train Loss: 8.239 Vali Loss: 172.007 Vali Acc: 0.560 Test Loss: 172.007 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.9967317581176758
Epoch: 33, Steps: 13 | Train Loss: 1.083 Vali Loss: 230.683 Vali Acc: 0.500 Test Loss: 230.683 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.9534952640533447
Epoch: 34, Steps: 13 | Train Loss: 2.946 Vali Loss: 303.925 Vali Acc: 0.420 Test Loss: 303.925 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 2.0417799949645996
Epoch: 35, Steps: 13 | Train Loss: 14.827 Vali Loss: 265.350 Vali Acc: 0.500 Test Loss: 265.350 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 2.003300905227661
Epoch: 36, Steps: 13 | Train Loss: 34.997 Vali Loss: 415.683 Vali Acc: 0.480 Test Loss: 415.683 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 2.0293707847595215
Epoch: 37, Steps: 13 | Train Loss: 26.889 Vali Loss: 401.259 Vali Acc: 0.400 Test Loss: 401.259 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.64
model parameter : 12137565
model size : 47.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.462667226791382
Epoch: 1, Steps: 13 | Train Loss: 19.393 Vali Loss: 33.035 Vali Acc: 0.200 Test Loss: 33.035 Test Acc: 0.200
Validation loss decreased (inf --> -0.199670).  Saving model ...
Epoch: 2 cost time: 2.0333657264709473
Epoch: 2, Steps: 13 | Train Loss: 39.765 Vali Loss: 75.729 Vali Acc: 0.380 Test Loss: 75.729 Test Acc: 0.380
Validation loss decreased (-0.199670 --> -0.379243).  Saving model ...
Epoch: 3 cost time: 1.928650140762329
Epoch: 3, Steps: 13 | Train Loss: 65.187 Vali Loss: 65.302 Vali Acc: 0.240 Test Loss: 65.302 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9111528396606445
Epoch: 4, Steps: 13 | Train Loss: 52.658 Vali Loss: 79.334 Vali Acc: 0.280 Test Loss: 79.334 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.0063254833221436
Epoch: 5, Steps: 13 | Train Loss: 67.541 Vali Loss: 104.565 Vali Acc: 0.260 Test Loss: 104.565 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.0151329040527344
Epoch: 6, Steps: 13 | Train Loss: 86.615 Vali Loss: 96.494 Vali Acc: 0.300 Test Loss: 96.494 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.9736473560333252
Epoch: 7, Steps: 13 | Train Loss: 85.004 Vali Loss: 138.414 Vali Acc: 0.360 Test Loss: 138.414 Test Acc: 0.360
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.0125584602355957
Epoch: 8, Steps: 13 | Train Loss: 111.612 Vali Loss: 116.329 Vali Acc: 0.380 Test Loss: 116.329 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.142122507095337
Epoch: 9, Steps: 13 | Train Loss: 50.617 Vali Loss: 107.964 Vali Acc: 0.280 Test Loss: 107.964 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.9454987049102783
Epoch: 10, Steps: 13 | Train Loss: 46.471 Vali Loss: 110.921 Vali Acc: 0.360 Test Loss: 110.921 Test Acc: 0.360
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.9719593524932861
Epoch: 11, Steps: 13 | Train Loss: 37.912 Vali Loss: 91.671 Vali Acc: 0.380 Test Loss: 91.671 Test Acc: 0.380
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.0147523880004883
Epoch: 12, Steps: 13 | Train Loss: 21.796 Vali Loss: 86.560 Vali Acc: 0.400 Test Loss: 86.560 Test Acc: 0.400
Validation loss decreased (-0.379243 --> -0.399134).  Saving model ...
Epoch: 13 cost time: 2.130772352218628
Epoch: 13, Steps: 13 | Train Loss: 24.335 Vali Loss: 99.833 Vali Acc: 0.440 Test Loss: 99.833 Test Acc: 0.440
Validation loss decreased (-0.399134 --> -0.439002).  Saving model ...
Epoch: 14 cost time: 1.9882957935333252
Epoch: 14, Steps: 13 | Train Loss: 40.458 Vali Loss: 109.406 Vali Acc: 0.420 Test Loss: 109.406 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.9611127376556396
Epoch: 15, Steps: 13 | Train Loss: 56.222 Vali Loss: 124.737 Vali Acc: 0.340 Test Loss: 124.737 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.0519399642944336
Epoch: 16, Steps: 13 | Train Loss: 23.895 Vali Loss: 80.833 Vali Acc: 0.540 Test Loss: 80.833 Test Acc: 0.540
Validation loss decreased (-0.439002 --> -0.539192).  Saving model ...
Epoch: 17 cost time: 2.0654709339141846
Epoch: 17, Steps: 13 | Train Loss: 17.276 Vali Loss: 89.412 Vali Acc: 0.440 Test Loss: 89.412 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.9347991943359375
Epoch: 18, Steps: 13 | Train Loss: 16.056 Vali Loss: 146.120 Vali Acc: 0.420 Test Loss: 146.120 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.9442613124847412
Epoch: 19, Steps: 13 | Train Loss: 34.930 Vali Loss: 170.248 Vali Acc: 0.380 Test Loss: 170.248 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.9401085376739502
Epoch: 20, Steps: 13 | Train Loss: 16.984 Vali Loss: 164.814 Vali Acc: 0.400 Test Loss: 164.814 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.8418834209442139
Epoch: 21, Steps: 13 | Train Loss: 32.304 Vali Loss: 170.027 Vali Acc: 0.500 Test Loss: 170.027 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.8915729522705078
Epoch: 22, Steps: 13 | Train Loss: 16.734 Vali Loss: 123.498 Vali Acc: 0.620 Test Loss: 123.498 Test Acc: 0.620
Validation loss decreased (-0.539192 --> -0.618765).  Saving model ...
Epoch: 23 cost time: 1.9157044887542725
Epoch: 23, Steps: 13 | Train Loss: 5.960 Vali Loss: 212.101 Vali Acc: 0.440 Test Loss: 212.101 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.9623427391052246
Epoch: 24, Steps: 13 | Train Loss: 25.146 Vali Loss: 167.276 Vali Acc: 0.520 Test Loss: 167.276 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.9907817840576172
Epoch: 25, Steps: 13 | Train Loss: 11.423 Vali Loss: 260.001 Vali Acc: 0.380 Test Loss: 260.001 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.9779677391052246
Epoch: 26, Steps: 13 | Train Loss: 21.221 Vali Loss: 156.892 Vali Acc: 0.600 Test Loss: 156.892 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.043503761291504
Epoch: 27, Steps: 13 | Train Loss: 21.288 Vali Loss: 216.292 Vali Acc: 0.500 Test Loss: 216.292 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.991654634475708
Epoch: 28, Steps: 13 | Train Loss: 45.486 Vali Loss: 250.739 Vali Acc: 0.500 Test Loss: 250.739 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.9965627193450928
Epoch: 29, Steps: 13 | Train Loss: 7.000 Vali Loss: 236.135 Vali Acc: 0.460 Test Loss: 236.135 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.0995264053344727
Epoch: 30, Steps: 13 | Train Loss: 13.991 Vali Loss: 172.837 Vali Acc: 0.560 Test Loss: 172.837 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.0416648387908936
Epoch: 31, Steps: 13 | Train Loss: 2.998 Vali Loss: 222.438 Vali Acc: 0.600 Test Loss: 222.438 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.03922963142395
Epoch: 32, Steps: 13 | Train Loss: 7.288 Vali Loss: 238.287 Vali Acc: 0.500 Test Loss: 238.287 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 12136093
model size : 47.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.1864261627197266
Epoch: 1, Steps: 13 | Train Loss: 19.505 Vali Loss: 26.600 Vali Acc: 0.200 Test Loss: 26.600 Test Acc: 0.200
Validation loss decreased (inf --> -0.199734).  Saving model ...
Epoch: 2 cost time: 1.8856699466705322
Epoch: 2, Steps: 13 | Train Loss: 36.507 Vali Loss: 30.952 Vali Acc: 0.240 Test Loss: 30.952 Test Acc: 0.240
Validation loss decreased (-0.199734 --> -0.239690).  Saving model ...
Epoch: 3 cost time: 1.9883015155792236
Epoch: 3, Steps: 13 | Train Loss: 29.774 Vali Loss: 40.402 Vali Acc: 0.340 Test Loss: 40.402 Test Acc: 0.340
Validation loss decreased (-0.239690 --> -0.339596).  Saving model ...
Epoch: 4 cost time: 1.9339783191680908
Epoch: 4, Steps: 13 | Train Loss: 29.006 Vali Loss: 91.105 Vali Acc: 0.260 Test Loss: 91.105 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9120149612426758
Epoch: 5, Steps: 13 | Train Loss: 44.287 Vali Loss: 125.679 Vali Acc: 0.200 Test Loss: 125.679 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.963454246520996
Epoch: 6, Steps: 13 | Train Loss: 52.454 Vali Loss: 101.591 Vali Acc: 0.320 Test Loss: 101.591 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.915252447128296
Epoch: 7, Steps: 13 | Train Loss: 98.902 Vali Loss: 162.542 Vali Acc: 0.200 Test Loss: 162.542 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.072021245956421
Epoch: 8, Steps: 13 | Train Loss: 65.226 Vali Loss: 79.937 Vali Acc: 0.420 Test Loss: 79.937 Test Acc: 0.420
Validation loss decreased (-0.339596 --> -0.419201).  Saving model ...
Epoch: 9 cost time: 1.8753769397735596
Epoch: 9, Steps: 13 | Train Loss: 25.654 Vali Loss: 72.646 Vali Acc: 0.340 Test Loss: 72.646 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.853788137435913
Epoch: 10, Steps: 13 | Train Loss: 22.076 Vali Loss: 147.446 Vali Acc: 0.420 Test Loss: 147.446 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9749743938446045
Epoch: 11, Steps: 13 | Train Loss: 31.768 Vali Loss: 148.342 Vali Acc: 0.400 Test Loss: 148.342 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.9063377380371094
Epoch: 12, Steps: 13 | Train Loss: 53.914 Vali Loss: 95.854 Vali Acc: 0.480 Test Loss: 95.854 Test Acc: 0.480
Validation loss decreased (-0.419201 --> -0.479041).  Saving model ...
Epoch: 13 cost time: 1.918015718460083
Epoch: 13, Steps: 13 | Train Loss: 84.271 Vali Loss: 216.399 Vali Acc: 0.400 Test Loss: 216.399 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9256348609924316
Epoch: 14, Steps: 13 | Train Loss: 87.956 Vali Loss: 217.830 Vali Acc: 0.320 Test Loss: 217.830 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.9798307418823242
Epoch: 15, Steps: 13 | Train Loss: 120.915 Vali Loss: 190.741 Vali Acc: 0.380 Test Loss: 190.741 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.01436710357666
Epoch: 16, Steps: 13 | Train Loss: 53.090 Vali Loss: 194.762 Vali Acc: 0.400 Test Loss: 194.762 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.94136381149292
Epoch: 17, Steps: 13 | Train Loss: 55.767 Vali Loss: 173.325 Vali Acc: 0.500 Test Loss: 173.325 Test Acc: 0.500
Validation loss decreased (-0.479041 --> -0.498267).  Saving model ...
Epoch: 18 cost time: 1.995297908782959
Epoch: 18, Steps: 13 | Train Loss: 49.963 Vali Loss: 202.445 Vali Acc: 0.320 Test Loss: 202.445 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.005969762802124
Epoch: 19, Steps: 13 | Train Loss: 69.030 Vali Loss: 310.348 Vali Acc: 0.320 Test Loss: 310.348 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.8778042793273926
Epoch: 20, Steps: 13 | Train Loss: 101.026 Vali Loss: 264.542 Vali Acc: 0.400 Test Loss: 264.542 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.8544964790344238
Epoch: 21, Steps: 13 | Train Loss: 69.613 Vali Loss: 185.888 Vali Acc: 0.520 Test Loss: 185.888 Test Acc: 0.520
Validation loss decreased (-0.498267 --> -0.518141).  Saving model ...
Epoch: 22 cost time: 1.9055767059326172
Epoch: 22, Steps: 13 | Train Loss: 27.975 Vali Loss: 214.134 Vali Acc: 0.480 Test Loss: 214.134 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.9857757091522217
Epoch: 23, Steps: 13 | Train Loss: 31.614 Vali Loss: 183.722 Vali Acc: 0.560 Test Loss: 183.722 Test Acc: 0.560
Validation loss decreased (-0.518141 --> -0.558163).  Saving model ...
Epoch: 24 cost time: 1.945699691772461
Epoch: 24, Steps: 13 | Train Loss: 10.141 Vali Loss: 212.933 Vali Acc: 0.540 Test Loss: 212.933 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.9220492839813232
Epoch: 25, Steps: 13 | Train Loss: 8.132 Vali Loss: 151.279 Vali Acc: 0.560 Test Loss: 151.279 Test Acc: 0.560
Validation loss decreased (-0.558163 --> -0.558487).  Saving model ...
Epoch: 26 cost time: 1.9911575317382812
Epoch: 26, Steps: 13 | Train Loss: 0.882 Vali Loss: 200.418 Vali Acc: 0.520 Test Loss: 200.418 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.9858548641204834
Epoch: 27, Steps: 13 | Train Loss: 13.928 Vali Loss: 204.102 Vali Acc: 0.540 Test Loss: 204.102 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.05843448638916
Epoch: 28, Steps: 13 | Train Loss: 7.304 Vali Loss: 180.458 Vali Acc: 0.580 Test Loss: 180.458 Test Acc: 0.580
Validation loss decreased (-0.558487 --> -0.578195).  Saving model ...
Epoch: 29 cost time: 1.9307904243469238
Epoch: 29, Steps: 13 | Train Loss: 5.971 Vali Loss: 164.801 Vali Acc: 0.520 Test Loss: 164.801 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.996995210647583
Epoch: 30, Steps: 13 | Train Loss: 0.529 Vali Loss: 210.175 Vali Acc: 0.520 Test Loss: 210.175 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.137603759765625
Epoch: 31, Steps: 13 | Train Loss: 13.073 Vali Loss: 200.267 Vali Acc: 0.520 Test Loss: 200.267 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.9096922874450684
Epoch: 32, Steps: 13 | Train Loss: 0.143 Vali Loss: 183.456 Vali Acc: 0.520 Test Loss: 183.456 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 2.040580987930298
Epoch: 33, Steps: 13 | Train Loss: 2.160 Vali Loss: 227.802 Vali Acc: 0.560 Test Loss: 227.802 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.9747791290283203
Epoch: 34, Steps: 13 | Train Loss: 13.379 Vali Loss: 207.260 Vali Acc: 0.520 Test Loss: 207.260 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.9545152187347412
Epoch: 35, Steps: 13 | Train Loss: 2.043 Vali Loss: 296.067 Vali Acc: 0.460 Test Loss: 296.067 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.9768028259277344
Epoch: 36, Steps: 13 | Train Loss: 16.342 Vali Loss: 325.761 Vali Acc: 0.440 Test Loss: 325.761 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.9615497589111328
Epoch: 37, Steps: 13 | Train Loss: 24.564 Vali Loss: 418.313 Vali Acc: 0.440 Test Loss: 418.313 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.9266204833984375
Epoch: 38, Steps: 13 | Train Loss: 5.721 Vali Loss: 248.637 Vali Acc: 0.580 Test Loss: 248.637 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 12134621
model size : 47.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.655339002609253
Epoch: 1, Steps: 13 | Train Loss: 5.417 Vali Loss: 16.440 Vali Acc: 0.200 Test Loss: 16.440 Test Acc: 0.200
Validation loss decreased (inf --> -0.199836).  Saving model ...
Epoch: 2 cost time: 1.8141522407531738
Epoch: 2, Steps: 13 | Train Loss: 14.490 Vali Loss: 19.674 Vali Acc: 0.220 Test Loss: 19.674 Test Acc: 0.220
Validation loss decreased (-0.199836 --> -0.219803).  Saving model ...
Epoch: 3 cost time: 1.8556573390960693
Epoch: 3, Steps: 13 | Train Loss: 8.572 Vali Loss: 19.844 Vali Acc: 0.180 Test Loss: 19.844 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9695699214935303
Epoch: 4, Steps: 13 | Train Loss: 13.468 Vali Loss: 26.325 Vali Acc: 0.340 Test Loss: 26.325 Test Acc: 0.340
Validation loss decreased (-0.219803 --> -0.339737).  Saving model ...
Epoch: 5 cost time: 1.9776654243469238
Epoch: 5, Steps: 13 | Train Loss: 11.334 Vali Loss: 11.808 Vali Acc: 0.380 Test Loss: 11.808 Test Acc: 0.380
Validation loss decreased (-0.339737 --> -0.379882).  Saving model ...
Epoch: 6 cost time: 1.9812583923339844
Epoch: 6, Steps: 13 | Train Loss: 9.431 Vali Loss: 50.362 Vali Acc: 0.240 Test Loss: 50.362 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.885411262512207
Epoch: 7, Steps: 13 | Train Loss: 19.958 Vali Loss: 37.868 Vali Acc: 0.360 Test Loss: 37.868 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8931918144226074
Epoch: 8, Steps: 13 | Train Loss: 34.480 Vali Loss: 30.095 Vali Acc: 0.360 Test Loss: 30.095 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.946894884109497
Epoch: 9, Steps: 13 | Train Loss: 25.863 Vali Loss: 90.691 Vali Acc: 0.340 Test Loss: 90.691 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.8605332374572754
Epoch: 10, Steps: 13 | Train Loss: 66.931 Vali Loss: 138.365 Vali Acc: 0.300 Test Loss: 138.365 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.8473975658416748
Epoch: 11, Steps: 13 | Train Loss: 28.230 Vali Loss: 90.823 Vali Acc: 0.420 Test Loss: 90.823 Test Acc: 0.420
Validation loss decreased (-0.379882 --> -0.419092).  Saving model ...
Epoch: 12 cost time: 1.8498876094818115
Epoch: 12, Steps: 13 | Train Loss: 56.252 Vali Loss: 68.837 Vali Acc: 0.460 Test Loss: 68.837 Test Acc: 0.460
Validation loss decreased (-0.419092 --> -0.459312).  Saving model ...
Epoch: 13 cost time: 1.9541771411895752
Epoch: 13, Steps: 13 | Train Loss: 26.062 Vali Loss: 38.844 Vali Acc: 0.500 Test Loss: 38.844 Test Acc: 0.500
Validation loss decreased (-0.459312 --> -0.499612).  Saving model ...
Epoch: 14 cost time: 1.79787015914917
Epoch: 14, Steps: 13 | Train Loss: 7.731 Vali Loss: 80.628 Vali Acc: 0.400 Test Loss: 80.628 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8447372913360596
Epoch: 15, Steps: 13 | Train Loss: 9.424 Vali Loss: 83.156 Vali Acc: 0.380 Test Loss: 83.156 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7910797595977783
Epoch: 16, Steps: 13 | Train Loss: 16.566 Vali Loss: 104.519 Vali Acc: 0.420 Test Loss: 104.519 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.8498167991638184
Epoch: 17, Steps: 13 | Train Loss: 22.284 Vali Loss: 68.879 Vali Acc: 0.460 Test Loss: 68.879 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.7789254188537598
Epoch: 18, Steps: 13 | Train Loss: 13.301 Vali Loss: 117.310 Vali Acc: 0.440 Test Loss: 117.310 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.8308892250061035
Epoch: 19, Steps: 13 | Train Loss: 19.839 Vali Loss: 114.683 Vali Acc: 0.400 Test Loss: 114.683 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.7145943641662598
Epoch: 20, Steps: 13 | Train Loss: 37.050 Vali Loss: 119.399 Vali Acc: 0.480 Test Loss: 119.399 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.7862308025360107
Epoch: 21, Steps: 13 | Train Loss: 4.126 Vali Loss: 73.267 Vali Acc: 0.420 Test Loss: 73.267 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.8132050037384033
Epoch: 22, Steps: 13 | Train Loss: 4.806 Vali Loss: 66.577 Vali Acc: 0.460 Test Loss: 66.577 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.9094884395599365
Epoch: 23, Steps: 13 | Train Loss: 1.352 Vali Loss: 82.050 Vali Acc: 0.400 Test Loss: 82.050 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 6195293
model size : 24.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.093888759613037
Epoch: 1, Steps: 13 | Train Loss: 6.227 Vali Loss: 16.806 Vali Acc: 0.200 Test Loss: 16.806 Test Acc: 0.200
Validation loss decreased (inf --> -0.199832).  Saving model ...
Epoch: 2 cost time: 1.861734390258789
Epoch: 2, Steps: 13 | Train Loss: 14.441 Vali Loss: 37.836 Vali Acc: 0.200 Test Loss: 37.836 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.771761178970337
Epoch: 3, Steps: 13 | Train Loss: 28.256 Vali Loss: 25.299 Vali Acc: 0.280 Test Loss: 25.299 Test Acc: 0.280
Validation loss decreased (-0.199832 --> -0.279747).  Saving model ...
Epoch: 4 cost time: 1.7949748039245605
Epoch: 4, Steps: 13 | Train Loss: 32.895 Vali Loss: 41.588 Vali Acc: 0.220 Test Loss: 41.588 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8338229656219482
Epoch: 5, Steps: 13 | Train Loss: 33.967 Vali Loss: 49.783 Vali Acc: 0.400 Test Loss: 49.783 Test Acc: 0.400
Validation loss decreased (-0.279747 --> -0.399502).  Saving model ...
Epoch: 6 cost time: 1.8049335479736328
Epoch: 6, Steps: 13 | Train Loss: 20.641 Vali Loss: 39.981 Vali Acc: 0.300 Test Loss: 39.981 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8249945640563965
Epoch: 7, Steps: 13 | Train Loss: 13.534 Vali Loss: 40.176 Vali Acc: 0.420 Test Loss: 40.176 Test Acc: 0.420
Validation loss decreased (-0.399502 --> -0.419598).  Saving model ...
Epoch: 8 cost time: 1.8358216285705566
Epoch: 8, Steps: 13 | Train Loss: 11.749 Vali Loss: 22.553 Vali Acc: 0.440 Test Loss: 22.553 Test Acc: 0.440
Validation loss decreased (-0.419598 --> -0.439774).  Saving model ...
Epoch: 9 cost time: 1.7837858200073242
Epoch: 9, Steps: 13 | Train Loss: 0.957 Vali Loss: 53.309 Vali Acc: 0.400 Test Loss: 53.309 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.713914155960083
Epoch: 10, Steps: 13 | Train Loss: 10.660 Vali Loss: 23.813 Vali Acc: 0.380 Test Loss: 23.813 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8152334690093994
Epoch: 11, Steps: 13 | Train Loss: 8.203 Vali Loss: 40.377 Vali Acc: 0.360 Test Loss: 40.377 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.806227445602417
Epoch: 12, Steps: 13 | Train Loss: 19.346 Vali Loss: 68.690 Vali Acc: 0.240 Test Loss: 68.690 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.8868939876556396
Epoch: 13, Steps: 13 | Train Loss: 20.125 Vali Loss: 75.638 Vali Acc: 0.220 Test Loss: 75.638 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.7965352535247803
Epoch: 14, Steps: 13 | Train Loss: 19.506 Vali Loss: 83.967 Vali Acc: 0.280 Test Loss: 83.967 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.749140739440918
Epoch: 15, Steps: 13 | Train Loss: 13.350 Vali Loss: 101.470 Vali Acc: 0.440 Test Loss: 101.470 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.704063892364502
Epoch: 16, Steps: 13 | Train Loss: 10.824 Vali Loss: 92.976 Vali Acc: 0.280 Test Loss: 92.976 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.8248002529144287
Epoch: 17, Steps: 13 | Train Loss: 12.660 Vali Loss: 72.465 Vali Acc: 0.480 Test Loss: 72.465 Test Acc: 0.480
Validation loss decreased (-0.439774 --> -0.479275).  Saving model ...
Epoch: 18 cost time: 1.7658298015594482
Epoch: 18, Steps: 13 | Train Loss: 9.134 Vali Loss: 88.888 Vali Acc: 0.400 Test Loss: 88.888 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7174923419952393
Epoch: 19, Steps: 13 | Train Loss: 5.754 Vali Loss: 77.622 Vali Acc: 0.420 Test Loss: 77.622 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.696622371673584
Epoch: 20, Steps: 13 | Train Loss: 0.000 Vali Loss: 72.605 Vali Acc: 0.460 Test Loss: 72.605 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.8091013431549072
Epoch: 21, Steps: 13 | Train Loss: 6.348 Vali Loss: 63.780 Vali Acc: 0.460 Test Loss: 63.780 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.8414056301116943
Epoch: 22, Steps: 13 | Train Loss: 0.555 Vali Loss: 85.547 Vali Acc: 0.480 Test Loss: 85.547 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.7957804203033447
Epoch: 23, Steps: 13 | Train Loss: 7.337 Vali Loss: 107.597 Vali Acc: 0.460 Test Loss: 107.597 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.834479570388794
Epoch: 24, Steps: 13 | Train Loss: 34.132 Vali Loss: 114.912 Vali Acc: 0.460 Test Loss: 114.912 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.74476957321167
Epoch: 25, Steps: 13 | Train Loss: 13.583 Vali Loss: 92.640 Vali Acc: 0.500 Test Loss: 92.640 Test Acc: 0.500
Validation loss decreased (-0.479275 --> -0.499074).  Saving model ...
Epoch: 26 cost time: 1.840606927871704
Epoch: 26, Steps: 13 | Train Loss: 16.567 Vali Loss: 141.145 Vali Acc: 0.280 Test Loss: 141.145 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.8953356742858887
Epoch: 27, Steps: 13 | Train Loss: 16.139 Vali Loss: 156.925 Vali Acc: 0.420 Test Loss: 156.925 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.9054746627807617
Epoch: 28, Steps: 13 | Train Loss: 14.397 Vali Loss: 117.495 Vali Acc: 0.460 Test Loss: 117.495 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.8762009143829346
Epoch: 29, Steps: 13 | Train Loss: 10.941 Vali Loss: 172.141 Vali Acc: 0.380 Test Loss: 172.141 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.7842907905578613
Epoch: 30, Steps: 13 | Train Loss: 20.456 Vali Loss: 89.848 Vali Acc: 0.440 Test Loss: 89.848 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.993952751159668
Epoch: 31, Steps: 13 | Train Loss: 1.658 Vali Loss: 121.329 Vali Acc: 0.340 Test Loss: 121.329 Test Acc: 0.340
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.8219919204711914
Epoch: 32, Steps: 13 | Train Loss: 2.019 Vali Loss: 146.713 Vali Acc: 0.380 Test Loss: 146.713 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.8078851699829102
Epoch: 33, Steps: 13 | Train Loss: 2.710 Vali Loss: 157.846 Vali Acc: 0.420 Test Loss: 157.846 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.840254545211792
Epoch: 34, Steps: 13 | Train Loss: 11.811 Vali Loss: 132.472 Vali Acc: 0.400 Test Loss: 132.472 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.8026316165924072
Epoch: 35, Steps: 13 | Train Loss: 8.878 Vali Loss: 227.921 Vali Acc: 0.340 Test Loss: 227.921 Test Acc: 0.340
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 6194557
model size : 24.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.346062421798706
Epoch: 1, Steps: 13 | Train Loss: 7.591 Vali Loss: 20.995 Vali Acc: 0.200 Test Loss: 20.995 Test Acc: 0.200
Validation loss decreased (inf --> -0.199790).  Saving model ...
Epoch: 2 cost time: 1.8794350624084473
Epoch: 2, Steps: 13 | Train Loss: 12.685 Vali Loss: 16.050 Vali Acc: 0.360 Test Loss: 16.050 Test Acc: 0.360
Validation loss decreased (-0.199790 --> -0.359839).  Saving model ...
Epoch: 3 cost time: 1.7618827819824219
Epoch: 3, Steps: 13 | Train Loss: 11.614 Vali Loss: 24.302 Vali Acc: 0.260 Test Loss: 24.302 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7717673778533936
Epoch: 4, Steps: 13 | Train Loss: 8.420 Vali Loss: 26.830 Vali Acc: 0.380 Test Loss: 26.830 Test Acc: 0.380
Validation loss decreased (-0.359839 --> -0.379732).  Saving model ...
Epoch: 5 cost time: 1.9281306266784668
Epoch: 5, Steps: 13 | Train Loss: 12.785 Vali Loss: 24.895 Vali Acc: 0.280 Test Loss: 24.895 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8616247177124023
Epoch: 6, Steps: 13 | Train Loss: 11.393 Vali Loss: 59.202 Vali Acc: 0.200 Test Loss: 59.202 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8845767974853516
Epoch: 7, Steps: 13 | Train Loss: 18.827 Vali Loss: 59.991 Vali Acc: 0.240 Test Loss: 59.991 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.7225158214569092
Epoch: 8, Steps: 13 | Train Loss: 20.016 Vali Loss: 24.181 Vali Acc: 0.320 Test Loss: 24.181 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.7876498699188232
Epoch: 9, Steps: 13 | Train Loss: 16.965 Vali Loss: 72.281 Vali Acc: 0.360 Test Loss: 72.281 Test Acc: 0.360
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.816087007522583
Epoch: 10, Steps: 13 | Train Loss: 43.839 Vali Loss: 68.370 Vali Acc: 0.340 Test Loss: 68.370 Test Acc: 0.340
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.8731002807617188
Epoch: 11, Steps: 13 | Train Loss: 20.733 Vali Loss: 63.092 Vali Acc: 0.400 Test Loss: 63.092 Test Acc: 0.400
Validation loss decreased (-0.379732 --> -0.399369).  Saving model ...
Epoch: 12 cost time: 1.794689655303955
Epoch: 12, Steps: 13 | Train Loss: 19.650 Vali Loss: 73.583 Vali Acc: 0.360 Test Loss: 73.583 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8806710243225098
Epoch: 13, Steps: 13 | Train Loss: 21.414 Vali Loss: 45.271 Vali Acc: 0.380 Test Loss: 45.271 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.920525312423706
Epoch: 14, Steps: 13 | Train Loss: 23.990 Vali Loss: 81.673 Vali Acc: 0.420 Test Loss: 81.673 Test Acc: 0.420
Validation loss decreased (-0.399369 --> -0.419183).  Saving model ...
Epoch: 15 cost time: 1.8108100891113281
Epoch: 15, Steps: 13 | Train Loss: 27.697 Vali Loss: 70.884 Vali Acc: 0.420 Test Loss: 70.884 Test Acc: 0.420
Validation loss decreased (-0.419183 --> -0.419291).  Saving model ...
Epoch: 16 cost time: 1.8725991249084473
Epoch: 16, Steps: 13 | Train Loss: 21.272 Vali Loss: 143.071 Vali Acc: 0.340 Test Loss: 143.071 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7821316719055176
Epoch: 17, Steps: 13 | Train Loss: 22.147 Vali Loss: 82.182 Vali Acc: 0.520 Test Loss: 82.182 Test Acc: 0.520
Validation loss decreased (-0.419291 --> -0.519178).  Saving model ...
Epoch: 18 cost time: 1.8354718685150146
Epoch: 18, Steps: 13 | Train Loss: 11.561 Vali Loss: 71.522 Vali Acc: 0.400 Test Loss: 71.522 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7835774421691895
Epoch: 19, Steps: 13 | Train Loss: 15.506 Vali Loss: 113.083 Vali Acc: 0.380 Test Loss: 113.083 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.8118829727172852
Epoch: 20, Steps: 13 | Train Loss: 8.572 Vali Loss: 98.648 Vali Acc: 0.440 Test Loss: 98.648 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.7728147506713867
Epoch: 21, Steps: 13 | Train Loss: 28.385 Vali Loss: 257.375 Vali Acc: 0.340 Test Loss: 257.375 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.818746566772461
Epoch: 22, Steps: 13 | Train Loss: 78.933 Vali Loss: 92.401 Vali Acc: 0.480 Test Loss: 92.401 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.7001161575317383
Epoch: 23, Steps: 13 | Train Loss: 9.984 Vali Loss: 210.154 Vali Acc: 0.320 Test Loss: 210.154 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.8976235389709473
Epoch: 24, Steps: 13 | Train Loss: 17.372 Vali Loss: 114.857 Vali Acc: 0.420 Test Loss: 114.857 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.7917399406433105
Epoch: 25, Steps: 13 | Train Loss: 8.208 Vali Loss: 111.600 Vali Acc: 0.480 Test Loss: 111.600 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.9230656623840332
Epoch: 26, Steps: 13 | Train Loss: 3.087 Vali Loss: 80.220 Vali Acc: 0.440 Test Loss: 80.220 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.8577215671539307
Epoch: 27, Steps: 13 | Train Loss: 3.064 Vali Loss: 104.730 Vali Acc: 0.400 Test Loss: 104.730 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 6193821
model size : 24.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.249640941619873
Epoch: 1, Steps: 13 | Train Loss: 8.566 Vali Loss: 20.128 Vali Acc: 0.200 Test Loss: 20.128 Test Acc: 0.200
Validation loss decreased (inf --> -0.199799).  Saving model ...
Epoch: 2 cost time: 1.73504638671875
Epoch: 2, Steps: 13 | Train Loss: 13.945 Vali Loss: 25.896 Vali Acc: 0.240 Test Loss: 25.896 Test Acc: 0.240
Validation loss decreased (-0.199799 --> -0.239741).  Saving model ...
Epoch: 3 cost time: 1.7978100776672363
Epoch: 3, Steps: 13 | Train Loss: 23.724 Vali Loss: 23.158 Vali Acc: 0.320 Test Loss: 23.158 Test Acc: 0.320
Validation loss decreased (-0.239741 --> -0.319768).  Saving model ...
Epoch: 4 cost time: 1.851294994354248
Epoch: 4, Steps: 13 | Train Loss: 17.985 Vali Loss: 46.031 Vali Acc: 0.200 Test Loss: 46.031 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8662612438201904
Epoch: 5, Steps: 13 | Train Loss: 23.740 Vali Loss: 62.504 Vali Acc: 0.220 Test Loss: 62.504 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7742047309875488
Epoch: 6, Steps: 13 | Train Loss: 20.952 Vali Loss: 23.861 Vali Acc: 0.360 Test Loss: 23.861 Test Acc: 0.360
Validation loss decreased (-0.319768 --> -0.359761).  Saving model ...
Epoch: 7 cost time: 1.8276593685150146
Epoch: 7, Steps: 13 | Train Loss: 22.627 Vali Loss: 27.922 Vali Acc: 0.440 Test Loss: 27.922 Test Acc: 0.440
Validation loss decreased (-0.359761 --> -0.439721).  Saving model ...
Epoch: 8 cost time: 1.758528709411621
Epoch: 8, Steps: 13 | Train Loss: 20.127 Vali Loss: 52.509 Vali Acc: 0.320 Test Loss: 52.509 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6626646518707275
Epoch: 9, Steps: 13 | Train Loss: 14.601 Vali Loss: 49.064 Vali Acc: 0.300 Test Loss: 49.064 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6964457035064697
Epoch: 10, Steps: 13 | Train Loss: 17.281 Vali Loss: 59.760 Vali Acc: 0.360 Test Loss: 59.760 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.6750924587249756
Epoch: 11, Steps: 13 | Train Loss: 19.188 Vali Loss: 60.507 Vali Acc: 0.460 Test Loss: 60.507 Test Acc: 0.460
Validation loss decreased (-0.439721 --> -0.459395).  Saving model ...
Epoch: 12 cost time: 1.7709119319915771
Epoch: 12, Steps: 13 | Train Loss: 15.902 Vali Loss: 58.381 Vali Acc: 0.460 Test Loss: 58.381 Test Acc: 0.460
Validation loss decreased (-0.459395 --> -0.459416).  Saving model ...
Epoch: 13 cost time: 1.8834130764007568
Epoch: 13, Steps: 13 | Train Loss: 11.924 Vali Loss: 79.974 Vali Acc: 0.340 Test Loss: 79.974 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7383818626403809
Epoch: 14, Steps: 13 | Train Loss: 40.607 Vali Loss: 72.764 Vali Acc: 0.500 Test Loss: 72.764 Test Acc: 0.500
Validation loss decreased (-0.459416 --> -0.499272).  Saving model ...
Epoch: 15 cost time: 1.7495782375335693
Epoch: 15, Steps: 13 | Train Loss: 28.496 Vali Loss: 82.428 Vali Acc: 0.460 Test Loss: 82.428 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8139352798461914
Epoch: 16, Steps: 13 | Train Loss: 14.284 Vali Loss: 75.453 Vali Acc: 0.460 Test Loss: 75.453 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7248897552490234
Epoch: 17, Steps: 13 | Train Loss: 25.700 Vali Loss: 116.312 Vali Acc: 0.260 Test Loss: 116.312 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.8797261714935303
Epoch: 18, Steps: 13 | Train Loss: 41.375 Vali Loss: 169.839 Vali Acc: 0.360 Test Loss: 169.839 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.916856050491333
Epoch: 19, Steps: 13 | Train Loss: 40.134 Vali Loss: 124.307 Vali Acc: 0.380 Test Loss: 124.307 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.780529499053955
Epoch: 20, Steps: 13 | Train Loss: 14.496 Vali Loss: 159.932 Vali Acc: 0.300 Test Loss: 159.932 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.777294635772705
Epoch: 21, Steps: 13 | Train Loss: 11.312 Vali Loss: 121.653 Vali Acc: 0.500 Test Loss: 121.653 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.8488974571228027
Epoch: 22, Steps: 13 | Train Loss: 13.548 Vali Loss: 108.186 Vali Acc: 0.400 Test Loss: 108.186 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.7631683349609375
Epoch: 23, Steps: 13 | Train Loss: 10.627 Vali Loss: 116.002 Vali Acc: 0.520 Test Loss: 116.002 Test Acc: 0.520
Validation loss decreased (-0.499272 --> -0.518840).  Saving model ...
Epoch: 24 cost time: 1.8715605735778809
Epoch: 24, Steps: 13 | Train Loss: 3.026 Vali Loss: 128.337 Vali Acc: 0.500 Test Loss: 128.337 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.8540914058685303
Epoch: 25, Steps: 13 | Train Loss: 8.259 Vali Loss: 117.272 Vali Acc: 0.440 Test Loss: 117.272 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.7693026065826416
Epoch: 26, Steps: 13 | Train Loss: 15.217 Vali Loss: 100.033 Vali Acc: 0.440 Test Loss: 100.033 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.7427148818969727
Epoch: 27, Steps: 13 | Train Loss: 19.221 Vali Loss: 97.912 Vali Acc: 0.400 Test Loss: 97.912 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.750258445739746
Epoch: 28, Steps: 13 | Train Loss: 2.920 Vali Loss: 106.104 Vali Acc: 0.500 Test Loss: 106.104 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.7869999408721924
Epoch: 29, Steps: 13 | Train Loss: 5.887 Vali Loss: 128.297 Vali Acc: 0.460 Test Loss: 128.297 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.782716989517212
Epoch: 30, Steps: 13 | Train Loss: 3.855 Vali Loss: 125.145 Vali Acc: 0.380 Test Loss: 125.145 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.8191556930541992
Epoch: 31, Steps: 13 | Train Loss: 7.844 Vali Loss: 169.679 Vali Acc: 0.460 Test Loss: 169.679 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.7178688049316406
Epoch: 32, Steps: 13 | Train Loss: 24.854 Vali Loss: 146.494 Vali Acc: 0.460 Test Loss: 146.494 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.736715316772461
Epoch: 33, Steps: 13 | Train Loss: 10.422 Vali Loss: 157.327 Vali Acc: 0.420 Test Loss: 157.327 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 6193085
model size : 24.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.122431993484497
Epoch: 1, Steps: 13 | Train Loss: 7.373 Vali Loss: 24.285 Vali Acc: 0.200 Test Loss: 24.285 Test Acc: 0.200
Validation loss decreased (inf --> -0.199757).  Saving model ...
Epoch: 2 cost time: 1.6423349380493164
Epoch: 2, Steps: 13 | Train Loss: 23.683 Vali Loss: 16.642 Vali Acc: 0.200 Test Loss: 16.642 Test Acc: 0.200
Validation loss decreased (-0.199757 --> -0.199834).  Saving model ...
Epoch: 3 cost time: 1.54191255569458
Epoch: 3, Steps: 13 | Train Loss: 17.229 Vali Loss: 21.951 Vali Acc: 0.260 Test Loss: 21.951 Test Acc: 0.260
Validation loss decreased (-0.199834 --> -0.259780).  Saving model ...
Epoch: 4 cost time: 1.6114907264709473
Epoch: 4, Steps: 13 | Train Loss: 19.234 Vali Loss: 19.578 Vali Acc: 0.280 Test Loss: 19.578 Test Acc: 0.280
Validation loss decreased (-0.259780 --> -0.279804).  Saving model ...
Epoch: 5 cost time: 1.609837532043457
Epoch: 5, Steps: 13 | Train Loss: 16.219 Vali Loss: 24.296 Vali Acc: 0.400 Test Loss: 24.296 Test Acc: 0.400
Validation loss decreased (-0.279804 --> -0.399757).  Saving model ...
Epoch: 6 cost time: 1.5391871929168701
Epoch: 6, Steps: 13 | Train Loss: 38.954 Vali Loss: 41.657 Vali Acc: 0.240 Test Loss: 41.657 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7178564071655273
Epoch: 7, Steps: 13 | Train Loss: 21.153 Vali Loss: 41.321 Vali Acc: 0.380 Test Loss: 41.321 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6784017086029053
Epoch: 8, Steps: 13 | Train Loss: 11.016 Vali Loss: 30.673 Vali Acc: 0.440 Test Loss: 30.673 Test Acc: 0.440
Validation loss decreased (-0.399757 --> -0.439693).  Saving model ...
Epoch: 9 cost time: 1.5544383525848389
Epoch: 9, Steps: 13 | Train Loss: 16.912 Vali Loss: 73.366 Vali Acc: 0.240 Test Loss: 73.366 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7033021450042725
Epoch: 10, Steps: 13 | Train Loss: 37.980 Vali Loss: 89.091 Vali Acc: 0.240 Test Loss: 89.091 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6801915168762207
Epoch: 11, Steps: 13 | Train Loss: 34.452 Vali Loss: 71.658 Vali Acc: 0.400 Test Loss: 71.658 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.6093449592590332
Epoch: 12, Steps: 13 | Train Loss: 9.262 Vali Loss: 47.809 Vali Acc: 0.480 Test Loss: 47.809 Test Acc: 0.480
Validation loss decreased (-0.439693 --> -0.479522).  Saving model ...
Epoch: 13 cost time: 1.61275315284729
Epoch: 13, Steps: 13 | Train Loss: 3.820 Vali Loss: 46.135 Vali Acc: 0.420 Test Loss: 46.135 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4761271476745605
Epoch: 14, Steps: 13 | Train Loss: 8.531 Vali Loss: 59.479 Vali Acc: 0.420 Test Loss: 59.479 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5010066032409668
Epoch: 15, Steps: 13 | Train Loss: 70.618 Vali Loss: 144.472 Vali Acc: 0.320 Test Loss: 144.472 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.6477751731872559
Epoch: 16, Steps: 13 | Train Loss: 54.762 Vali Loss: 78.215 Vali Acc: 0.440 Test Loss: 78.215 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.6261177062988281
Epoch: 17, Steps: 13 | Train Loss: 17.812 Vali Loss: 127.126 Vali Acc: 0.300 Test Loss: 127.126 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.4982941150665283
Epoch: 18, Steps: 13 | Train Loss: 17.990 Vali Loss: 81.496 Vali Acc: 0.500 Test Loss: 81.496 Test Acc: 0.500
Validation loss decreased (-0.479522 --> -0.499185).  Saving model ...
Epoch: 19 cost time: 1.5139997005462646
Epoch: 19, Steps: 13 | Train Loss: 14.443 Vali Loss: 113.796 Vali Acc: 0.400 Test Loss: 113.796 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5694503784179688
Epoch: 20, Steps: 13 | Train Loss: 8.907 Vali Loss: 62.946 Vali Acc: 0.460 Test Loss: 62.946 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.6032905578613281
Epoch: 21, Steps: 13 | Train Loss: 9.952 Vali Loss: 67.474 Vali Acc: 0.480 Test Loss: 67.474 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.7638838291168213
Epoch: 22, Steps: 13 | Train Loss: 1.903 Vali Loss: 82.360 Vali Acc: 0.520 Test Loss: 82.360 Test Acc: 0.520
Validation loss decreased (-0.499185 --> -0.519176).  Saving model ...
Epoch: 23 cost time: 1.6196415424346924
Epoch: 23, Steps: 13 | Train Loss: 3.447 Vali Loss: 116.693 Vali Acc: 0.420 Test Loss: 116.693 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5981638431549072
Epoch: 24, Steps: 13 | Train Loss: 42.642 Vali Loss: 119.933 Vali Acc: 0.380 Test Loss: 119.933 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.6597089767456055
Epoch: 25, Steps: 13 | Train Loss: 56.765 Vali Loss: 152.140 Vali Acc: 0.400 Test Loss: 152.140 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.6208219528198242
Epoch: 26, Steps: 13 | Train Loss: 12.464 Vali Loss: 109.626 Vali Acc: 0.540 Test Loss: 109.626 Test Acc: 0.540
Validation loss decreased (-0.519176 --> -0.538904).  Saving model ...
Epoch: 27 cost time: 1.6053504943847656
Epoch: 27, Steps: 13 | Train Loss: 12.916 Vali Loss: 103.611 Vali Acc: 0.460 Test Loss: 103.611 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.7603521347045898
Epoch: 28, Steps: 13 | Train Loss: 27.698 Vali Loss: 203.467 Vali Acc: 0.400 Test Loss: 203.467 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.636648178100586
Epoch: 29, Steps: 13 | Train Loss: 24.008 Vali Loss: 126.217 Vali Acc: 0.480 Test Loss: 126.217 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.7491297721862793
Epoch: 30, Steps: 13 | Train Loss: 2.749 Vali Loss: 177.625 Vali Acc: 0.520 Test Loss: 177.625 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.7589004039764404
Epoch: 31, Steps: 13 | Train Loss: 8.962 Vali Loss: 119.533 Vali Acc: 0.500 Test Loss: 119.533 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.6574220657348633
Epoch: 32, Steps: 13 | Train Loss: 13.694 Vali Loss: 155.100 Vali Acc: 0.540 Test Loss: 155.100 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.7744486331939697
Epoch: 33, Steps: 13 | Train Loss: 8.068 Vali Loss: 124.199 Vali Acc: 0.540 Test Loss: 124.199 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.6721038818359375
Epoch: 34, Steps: 13 | Train Loss: 0.000 Vali Loss: 125.405 Vali Acc: 0.480 Test Loss: 125.405 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.6770844459533691
Epoch: 35, Steps: 13 | Train Loss: 0.000 Vali Loss: 136.778 Vali Acc: 0.500 Test Loss: 136.778 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.7262816429138184
Epoch: 36, Steps: 13 | Train Loss: 0.000 Vali Loss: 139.936 Vali Acc: 0.500 Test Loss: 139.936 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 6095453
model size : 23.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.9389500617980957
Epoch: 1, Steps: 13 | Train Loss: 6.494 Vali Loss: 12.842 Vali Acc: 0.200 Test Loss: 12.842 Test Acc: 0.200
Validation loss decreased (inf --> -0.199872).  Saving model ...
Epoch: 2 cost time: 1.614215612411499
Epoch: 2, Steps: 13 | Train Loss: 10.875 Vali Loss: 29.789 Vali Acc: 0.200 Test Loss: 29.789 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5730788707733154
Epoch: 3, Steps: 13 | Train Loss: 30.539 Vali Loss: 40.837 Vali Acc: 0.200 Test Loss: 40.837 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5418245792388916
Epoch: 4, Steps: 13 | Train Loss: 14.089 Vali Loss: 25.289 Vali Acc: 0.280 Test Loss: 25.289 Test Acc: 0.280
Validation loss decreased (-0.199872 --> -0.279747).  Saving model ...
Epoch: 5 cost time: 1.5924289226531982
Epoch: 5, Steps: 13 | Train Loss: 16.289 Vali Loss: 40.257 Vali Acc: 0.200 Test Loss: 40.257 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5798132419586182
Epoch: 6, Steps: 13 | Train Loss: 31.950 Vali Loss: 50.970 Vali Acc: 0.260 Test Loss: 50.970 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7105236053466797
Epoch: 7, Steps: 13 | Train Loss: 34.548 Vali Loss: 41.737 Vali Acc: 0.340 Test Loss: 41.737 Test Acc: 0.340
Validation loss decreased (-0.279747 --> -0.339583).  Saving model ...
Epoch: 8 cost time: 1.5421631336212158
Epoch: 8, Steps: 13 | Train Loss: 33.813 Vali Loss: 67.193 Vali Acc: 0.280 Test Loss: 67.193 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6115095615386963
Epoch: 9, Steps: 13 | Train Loss: 33.541 Vali Loss: 40.128 Vali Acc: 0.460 Test Loss: 40.128 Test Acc: 0.460
Validation loss decreased (-0.339583 --> -0.459599).  Saving model ...
Epoch: 10 cost time: 1.6666922569274902
Epoch: 10, Steps: 13 | Train Loss: 18.169 Vali Loss: 40.835 Vali Acc: 0.340 Test Loss: 40.835 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5617716312408447
Epoch: 11, Steps: 13 | Train Loss: 3.788 Vali Loss: 33.202 Vali Acc: 0.420 Test Loss: 33.202 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6182115077972412
Epoch: 12, Steps: 13 | Train Loss: 15.703 Vali Loss: 81.962 Vali Acc: 0.300 Test Loss: 81.962 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.6291265487670898
Epoch: 13, Steps: 13 | Train Loss: 33.490 Vali Loss: 56.418 Vali Acc: 0.440 Test Loss: 56.418 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.5730516910552979
Epoch: 14, Steps: 13 | Train Loss: 25.954 Vali Loss: 94.373 Vali Acc: 0.340 Test Loss: 94.373 Test Acc: 0.340
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.6469337940216064
Epoch: 15, Steps: 13 | Train Loss: 30.784 Vali Loss: 76.481 Vali Acc: 0.560 Test Loss: 76.481 Test Acc: 0.560
Validation loss decreased (-0.459599 --> -0.559235).  Saving model ...
Epoch: 16 cost time: 1.599726676940918
Epoch: 16, Steps: 13 | Train Loss: 10.695 Vali Loss: 99.508 Vali Acc: 0.440 Test Loss: 99.508 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6515555381774902
Epoch: 17, Steps: 13 | Train Loss: 31.424 Vali Loss: 106.524 Vali Acc: 0.380 Test Loss: 106.524 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.6252782344818115
Epoch: 18, Steps: 13 | Train Loss: 23.900 Vali Loss: 93.012 Vali Acc: 0.360 Test Loss: 93.012 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.6004810333251953
Epoch: 19, Steps: 13 | Train Loss: 10.992 Vali Loss: 47.886 Vali Acc: 0.580 Test Loss: 47.886 Test Acc: 0.580
Validation loss decreased (-0.559235 --> -0.579521).  Saving model ...
Epoch: 20 cost time: 1.6067016124725342
Epoch: 20, Steps: 13 | Train Loss: 13.179 Vali Loss: 111.146 Vali Acc: 0.320 Test Loss: 111.146 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6292898654937744
Epoch: 21, Steps: 13 | Train Loss: 2.838 Vali Loss: 84.828 Vali Acc: 0.460 Test Loss: 84.828 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.6206986904144287
Epoch: 22, Steps: 13 | Train Loss: 5.305 Vali Loss: 107.064 Vali Acc: 0.400 Test Loss: 107.064 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.595977783203125
Epoch: 23, Steps: 13 | Train Loss: 9.854 Vali Loss: 91.912 Vali Acc: 0.520 Test Loss: 91.912 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.686347246170044
Epoch: 24, Steps: 13 | Train Loss: 7.530 Vali Loss: 132.842 Vali Acc: 0.460 Test Loss: 132.842 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.7386219501495361
Epoch: 25, Steps: 13 | Train Loss: 19.800 Vali Loss: 127.974 Vali Acc: 0.340 Test Loss: 127.974 Test Acc: 0.340
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.5726664066314697
Epoch: 26, Steps: 13 | Train Loss: 6.598 Vali Loss: 124.714 Vali Acc: 0.400 Test Loss: 124.714 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.5856907367706299
Epoch: 27, Steps: 13 | Train Loss: 9.222 Vali Loss: 75.828 Vali Acc: 0.500 Test Loss: 75.828 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.7270605564117432
Epoch: 28, Steps: 13 | Train Loss: 4.906 Vali Loss: 140.742 Vali Acc: 0.380 Test Loss: 140.742 Test Acc: 0.380
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.603788137435913
Epoch: 29, Steps: 13 | Train Loss: 5.220 Vali Loss: 80.097 Vali Acc: 0.480 Test Loss: 80.097 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 6094717
model size : 23.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.941957473754883
Epoch: 1, Steps: 13 | Train Loss: 3.523 Vali Loss: 6.347 Vali Acc: 0.220 Test Loss: 6.347 Test Acc: 0.220
Validation loss decreased (inf --> -0.219937).  Saving model ...
Epoch: 2 cost time: 1.6217820644378662
Epoch: 2, Steps: 13 | Train Loss: 7.532 Vali Loss: 15.130 Vali Acc: 0.200 Test Loss: 15.130 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5941133499145508
Epoch: 3, Steps: 13 | Train Loss: 19.248 Vali Loss: 18.203 Vali Acc: 0.260 Test Loss: 18.203 Test Acc: 0.260
Validation loss decreased (-0.219937 --> -0.259818).  Saving model ...
Epoch: 4 cost time: 1.6666405200958252
Epoch: 4, Steps: 13 | Train Loss: 19.982 Vali Loss: 31.098 Vali Acc: 0.380 Test Loss: 31.098 Test Acc: 0.380
Validation loss decreased (-0.259818 --> -0.379689).  Saving model ...
Epoch: 5 cost time: 1.6836473941802979
Epoch: 5, Steps: 13 | Train Loss: 26.797 Vali Loss: 19.887 Vali Acc: 0.380 Test Loss: 19.887 Test Acc: 0.380
Validation loss decreased (-0.379689 --> -0.379801).  Saving model ...
Epoch: 6 cost time: 1.5202829837799072
Epoch: 6, Steps: 13 | Train Loss: 15.013 Vali Loss: 29.141 Vali Acc: 0.380 Test Loss: 29.141 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5714514255523682
Epoch: 7, Steps: 13 | Train Loss: 14.736 Vali Loss: 36.324 Vali Acc: 0.380 Test Loss: 36.324 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.583096981048584
Epoch: 8, Steps: 13 | Train Loss: 17.424 Vali Loss: 64.916 Vali Acc: 0.260 Test Loss: 64.916 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.6152005195617676
Epoch: 9, Steps: 13 | Train Loss: 35.853 Vali Loss: 55.135 Vali Acc: 0.260 Test Loss: 55.135 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.6012647151947021
Epoch: 10, Steps: 13 | Train Loss: 25.420 Vali Loss: 64.191 Vali Acc: 0.240 Test Loss: 64.191 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.6015396118164062
Epoch: 11, Steps: 13 | Train Loss: 20.781 Vali Loss: 73.445 Vali Acc: 0.380 Test Loss: 73.445 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.5775806903839111
Epoch: 12, Steps: 13 | Train Loss: 25.722 Vali Loss: 64.712 Vali Acc: 0.340 Test Loss: 64.712 Test Acc: 0.340
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.5670087337493896
Epoch: 13, Steps: 13 | Train Loss: 8.315 Vali Loss: 52.288 Vali Acc: 0.360 Test Loss: 52.288 Test Acc: 0.360
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.7085728645324707
Epoch: 14, Steps: 13 | Train Loss: 6.656 Vali Loss: 64.349 Vali Acc: 0.380 Test Loss: 64.349 Test Acc: 0.380
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.5540943145751953
Epoch: 15, Steps: 13 | Train Loss: 14.122 Vali Loss: 98.697 Vali Acc: 0.420 Test Loss: 98.697 Test Acc: 0.420
Validation loss decreased (-0.379801 --> -0.419013).  Saving model ...
Epoch: 16 cost time: 1.6156988143920898
Epoch: 16, Steps: 13 | Train Loss: 9.742 Vali Loss: 48.289 Vali Acc: 0.420 Test Loss: 48.289 Test Acc: 0.420
Validation loss decreased (-0.419013 --> -0.419517).  Saving model ...
Epoch: 17 cost time: 1.5788707733154297
Epoch: 17, Steps: 13 | Train Loss: 22.339 Vali Loss: 115.642 Vali Acc: 0.360 Test Loss: 115.642 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6410536766052246
Epoch: 18, Steps: 13 | Train Loss: 19.753 Vali Loss: 124.437 Vali Acc: 0.300 Test Loss: 124.437 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.5391950607299805
Epoch: 19, Steps: 13 | Train Loss: 33.425 Vali Loss: 87.040 Vali Acc: 0.440 Test Loss: 87.040 Test Acc: 0.440
Validation loss decreased (-0.419517 --> -0.439130).  Saving model ...
Epoch: 20 cost time: 1.6858186721801758
Epoch: 20, Steps: 13 | Train Loss: 25.610 Vali Loss: 89.270 Vali Acc: 0.400 Test Loss: 89.270 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6796367168426514
Epoch: 21, Steps: 13 | Train Loss: 9.206 Vali Loss: 91.584 Vali Acc: 0.400 Test Loss: 91.584 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.7075650691986084
Epoch: 22, Steps: 13 | Train Loss: 14.552 Vali Loss: 74.258 Vali Acc: 0.440 Test Loss: 74.258 Test Acc: 0.440
Validation loss decreased (-0.439130 --> -0.439257).  Saving model ...
Epoch: 23 cost time: 1.6366372108459473
Epoch: 23, Steps: 13 | Train Loss: 7.569 Vali Loss: 141.132 Vali Acc: 0.580 Test Loss: 141.132 Test Acc: 0.580
Validation loss decreased (-0.439257 --> -0.578589).  Saving model ...
Epoch: 24 cost time: 1.7321758270263672
Epoch: 24, Steps: 13 | Train Loss: 6.781 Vali Loss: 86.587 Vali Acc: 0.480 Test Loss: 86.587 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.62847900390625
Epoch: 25, Steps: 13 | Train Loss: 3.389 Vali Loss: 95.666 Vali Acc: 0.520 Test Loss: 95.666 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.9344182014465332
Epoch: 26, Steps: 13 | Train Loss: 1.515 Vali Loss: 117.922 Vali Acc: 0.400 Test Loss: 117.922 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.6133062839508057
Epoch: 27, Steps: 13 | Train Loss: 2.142 Vali Loss: 79.064 Vali Acc: 0.480 Test Loss: 79.064 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.5844447612762451
Epoch: 28, Steps: 13 | Train Loss: 2.107 Vali Loss: 85.304 Vali Acc: 0.540 Test Loss: 85.304 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.5158491134643555
Epoch: 29, Steps: 13 | Train Loss: 1.702 Vali Loss: 81.227 Vali Acc: 0.480 Test Loss: 81.227 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.5958843231201172
Epoch: 30, Steps: 13 | Train Loss: 2.844 Vali Loss: 79.187 Vali Acc: 0.560 Test Loss: 79.187 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.7624330520629883
Epoch: 31, Steps: 13 | Train Loss: 3.699 Vali Loss: 119.063 Vali Acc: 0.460 Test Loss: 119.063 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.5937080383300781
Epoch: 32, Steps: 13 | Train Loss: 0.000 Vali Loss: 91.640 Vali Acc: 0.460 Test Loss: 91.640 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.6115608215332031
Epoch: 33, Steps: 13 | Train Loss: 2.560 Vali Loss: 94.122 Vali Acc: 0.560 Test Loss: 94.122 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 6093981
model size : 23.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.115748882293701
Epoch: 1, Steps: 13 | Train Loss: 6.923 Vali Loss: 24.565 Vali Acc: 0.200 Test Loss: 24.565 Test Acc: 0.200
Validation loss decreased (inf --> -0.199754).  Saving model ...
Epoch: 2 cost time: 1.679720163345337
Epoch: 2, Steps: 13 | Train Loss: 24.360 Vali Loss: 31.291 Vali Acc: 0.200 Test Loss: 31.291 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5538363456726074
Epoch: 3, Steps: 13 | Train Loss: 20.125 Vali Loss: 23.686 Vali Acc: 0.280 Test Loss: 23.686 Test Acc: 0.280
Validation loss decreased (-0.199754 --> -0.279763).  Saving model ...
Epoch: 4 cost time: 1.525608777999878
Epoch: 4, Steps: 13 | Train Loss: 21.885 Vali Loss: 33.881 Vali Acc: 0.300 Test Loss: 33.881 Test Acc: 0.300
Validation loss decreased (-0.279763 --> -0.299661).  Saving model ...
Epoch: 5 cost time: 1.622035026550293
Epoch: 5, Steps: 13 | Train Loss: 16.275 Vali Loss: 55.426 Vali Acc: 0.220 Test Loss: 55.426 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6921944618225098
Epoch: 6, Steps: 13 | Train Loss: 34.339 Vali Loss: 40.717 Vali Acc: 0.320 Test Loss: 40.717 Test Acc: 0.320
Validation loss decreased (-0.299661 --> -0.319593).  Saving model ...
Epoch: 7 cost time: 1.5720539093017578
Epoch: 7, Steps: 13 | Train Loss: 16.343 Vali Loss: 34.624 Vali Acc: 0.400 Test Loss: 34.624 Test Acc: 0.400
Validation loss decreased (-0.319593 --> -0.399654).  Saving model ...
Epoch: 8 cost time: 1.5178496837615967
Epoch: 8, Steps: 13 | Train Loss: 21.493 Vali Loss: 38.755 Vali Acc: 0.340 Test Loss: 38.755 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5312929153442383
Epoch: 9, Steps: 13 | Train Loss: 18.812 Vali Loss: 77.071 Vali Acc: 0.240 Test Loss: 77.071 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5880000591278076
Epoch: 10, Steps: 13 | Train Loss: 18.120 Vali Loss: 90.688 Vali Acc: 0.460 Test Loss: 90.688 Test Acc: 0.460
Validation loss decreased (-0.399654 --> -0.459093).  Saving model ...
Epoch: 11 cost time: 1.6700432300567627
Epoch: 11, Steps: 13 | Train Loss: 52.272 Vali Loss: 58.255 Vali Acc: 0.280 Test Loss: 58.255 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5794188976287842
Epoch: 12, Steps: 13 | Train Loss: 29.811 Vali Loss: 82.941 Vali Acc: 0.300 Test Loss: 82.941 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.658783197402954
Epoch: 13, Steps: 13 | Train Loss: 31.604 Vali Loss: 91.117 Vali Acc: 0.320 Test Loss: 91.117 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.6467771530151367
Epoch: 14, Steps: 13 | Train Loss: 41.845 Vali Loss: 43.950 Vali Acc: 0.500 Test Loss: 43.950 Test Acc: 0.500
Validation loss decreased (-0.459093 --> -0.499561).  Saving model ...
Epoch: 15 cost time: 1.5490460395812988
Epoch: 15, Steps: 13 | Train Loss: 18.123 Vali Loss: 91.759 Vali Acc: 0.420 Test Loss: 91.759 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.487370252609253
Epoch: 16, Steps: 13 | Train Loss: 13.603 Vali Loss: 50.821 Vali Acc: 0.520 Test Loss: 50.821 Test Acc: 0.520
Validation loss decreased (-0.499561 --> -0.519492).  Saving model ...
Epoch: 17 cost time: 1.4468510150909424
Epoch: 17, Steps: 13 | Train Loss: 20.605 Vali Loss: 155.529 Vali Acc: 0.300 Test Loss: 155.529 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5601787567138672
Epoch: 18, Steps: 13 | Train Loss: 36.717 Vali Loss: 79.677 Vali Acc: 0.480 Test Loss: 79.677 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.590062141418457
Epoch: 19, Steps: 13 | Train Loss: 21.382 Vali Loss: 108.569 Vali Acc: 0.420 Test Loss: 108.569 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.5792834758758545
Epoch: 20, Steps: 13 | Train Loss: 14.190 Vali Loss: 73.427 Vali Acc: 0.540 Test Loss: 73.427 Test Acc: 0.540
Validation loss decreased (-0.519492 --> -0.539266).  Saving model ...
Epoch: 21 cost time: 1.5980873107910156
Epoch: 21, Steps: 13 | Train Loss: 5.694 Vali Loss: 62.088 Vali Acc: 0.520 Test Loss: 62.088 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5167851448059082
Epoch: 22, Steps: 13 | Train Loss: 16.061 Vali Loss: 86.447 Vali Acc: 0.500 Test Loss: 86.447 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.6895887851715088
Epoch: 23, Steps: 13 | Train Loss: 7.055 Vali Loss: 125.637 Vali Acc: 0.420 Test Loss: 125.637 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.5831608772277832
Epoch: 24, Steps: 13 | Train Loss: 13.561 Vali Loss: 64.886 Vali Acc: 0.520 Test Loss: 64.886 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.6130104064941406
Epoch: 25, Steps: 13 | Train Loss: 11.445 Vali Loss: 143.953 Vali Acc: 0.440 Test Loss: 143.953 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.4694747924804688
Epoch: 26, Steps: 13 | Train Loss: 1.518 Vali Loss: 86.189 Vali Acc: 0.440 Test Loss: 86.189 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.544508695602417
Epoch: 27, Steps: 13 | Train Loss: 1.226 Vali Loss: 95.381 Vali Acc: 0.440 Test Loss: 95.381 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.5037751197814941
Epoch: 28, Steps: 13 | Train Loss: 12.242 Vali Loss: 125.334 Vali Acc: 0.500 Test Loss: 125.334 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.6956813335418701
Epoch: 29, Steps: 13 | Train Loss: 14.140 Vali Loss: 93.231 Vali Acc: 0.440 Test Loss: 93.231 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.5749292373657227
Epoch: 30, Steps: 13 | Train Loss: 3.623 Vali Loss: 121.260 Vali Acc: 0.560 Test Loss: 121.260 Test Acc: 0.560
Validation loss decreased (-0.539266 --> -0.558787).  Saving model ...
Epoch: 31 cost time: 1.4915249347686768
Epoch: 31, Steps: 13 | Train Loss: 6.169 Vali Loss: 114.196 Vali Acc: 0.520 Test Loss: 114.196 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.6032931804656982
Epoch: 32, Steps: 13 | Train Loss: 3.027 Vali Loss: 159.076 Vali Acc: 0.480 Test Loss: 159.076 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.5598058700561523
Epoch: 33, Steps: 13 | Train Loss: 8.105 Vali Loss: 93.644 Vali Acc: 0.500 Test Loss: 93.644 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.5842466354370117
Epoch: 34, Steps: 13 | Train Loss: 2.665 Vali Loss: 111.218 Vali Acc: 0.540 Test Loss: 111.218 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.5170042514801025
Epoch: 35, Steps: 13 | Train Loss: 0.179 Vali Loss: 108.416 Vali Acc: 0.460 Test Loss: 108.416 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.5418014526367188
Epoch: 36, Steps: 13 | Train Loss: 3.443 Vali Loss: 123.573 Vali Acc: 0.400 Test Loss: 123.573 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.4679772853851318
Epoch: 37, Steps: 13 | Train Loss: 0.322 Vali Loss: 86.458 Vali Acc: 0.520 Test Loss: 86.458 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.4984009265899658
Epoch: 38, Steps: 13 | Train Loss: 3.435 Vali Loss: 284.535 Vali Acc: 0.300 Test Loss: 284.535 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.6103379726409912
Epoch: 39, Steps: 13 | Train Loss: 24.915 Vali Loss: 167.085 Vali Acc: 0.460 Test Loss: 167.085 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.5554404258728027
Epoch: 40, Steps: 13 | Train Loss: 10.199 Vali Loss: 112.480 Vali Acc: 0.600 Test Loss: 112.480 Test Acc: 0.600
Validation loss decreased (-0.558787 --> -0.598875).  Saving model ...
Epoch: 41 cost time: 1.4964172840118408
Epoch: 41, Steps: 13 | Train Loss: 12.554 Vali Loss: 197.769 Vali Acc: 0.460 Test Loss: 197.769 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.630937099456787
Epoch: 42, Steps: 13 | Train Loss: 7.159 Vali Loss: 100.278 Vali Acc: 0.540 Test Loss: 100.278 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.5378062725067139
Epoch: 43, Steps: 13 | Train Loss: 5.637 Vali Loss: 185.045 Vali Acc: 0.480 Test Loss: 185.045 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.5367884635925293
Epoch: 44, Steps: 13 | Train Loss: 1.584 Vali Loss: 146.604 Vali Acc: 0.520 Test Loss: 146.604 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.5533063411712646
Epoch: 45, Steps: 13 | Train Loss: 9.249 Vali Loss: 122.649 Vali Acc: 0.440 Test Loss: 122.649 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.5032284259796143
Epoch: 46, Steps: 13 | Train Loss: 3.654 Vali Loss: 184.179 Vali Acc: 0.420 Test Loss: 184.179 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.533252477645874
Epoch: 47, Steps: 13 | Train Loss: 4.866 Vali Loss: 173.841 Vali Acc: 0.380 Test Loss: 173.841 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.4966886043548584
Epoch: 48, Steps: 13 | Train Loss: 6.454 Vali Loss: 214.956 Vali Acc: 0.340 Test Loss: 214.956 Test Acc: 0.340
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.572209119796753
Epoch: 49, Steps: 13 | Train Loss: 5.486 Vali Loss: 170.172 Vali Acc: 0.460 Test Loss: 170.172 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.5575308799743652
Epoch: 50, Steps: 13 | Train Loss: 7.567 Vali Loss: 219.334 Vali Acc: 0.400 Test Loss: 219.334 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 6093245
model size : 23.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.0560529232025146
Epoch: 1, Steps: 13 | Train Loss: 11.758 Vali Loss: 16.998 Vali Acc: 0.200 Test Loss: 16.998 Test Acc: 0.200
Validation loss decreased (inf --> -0.199830).  Saving model ...
Epoch: 2 cost time: 1.5197157859802246
Epoch: 2, Steps: 13 | Train Loss: 20.114 Vali Loss: 33.969 Vali Acc: 0.200 Test Loss: 33.969 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5307986736297607
Epoch: 3, Steps: 13 | Train Loss: 20.913 Vali Loss: 42.134 Vali Acc: 0.200 Test Loss: 42.134 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5712130069732666
Epoch: 4, Steps: 13 | Train Loss: 41.731 Vali Loss: 51.725 Vali Acc: 0.220 Test Loss: 51.725 Test Acc: 0.220
Validation loss decreased (-0.199830 --> -0.219483).  Saving model ...
Epoch: 5 cost time: 1.4979517459869385
Epoch: 5, Steps: 13 | Train Loss: 16.458 Vali Loss: 18.546 Vali Acc: 0.420 Test Loss: 18.546 Test Acc: 0.420
Validation loss decreased (-0.219483 --> -0.419815).  Saving model ...
Epoch: 6 cost time: 1.6199898719787598
Epoch: 6, Steps: 13 | Train Loss: 8.992 Vali Loss: 17.965 Vali Acc: 0.460 Test Loss: 17.965 Test Acc: 0.460
Validation loss decreased (-0.419815 --> -0.459820).  Saving model ...
Epoch: 7 cost time: 1.5917339324951172
Epoch: 7, Steps: 13 | Train Loss: 6.498 Vali Loss: 51.863 Vali Acc: 0.280 Test Loss: 51.863 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5193471908569336
Epoch: 8, Steps: 13 | Train Loss: 48.255 Vali Loss: 44.273 Vali Acc: 0.340 Test Loss: 44.273 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6100845336914062
Epoch: 9, Steps: 13 | Train Loss: 25.247 Vali Loss: 42.639 Vali Acc: 0.400 Test Loss: 42.639 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5012602806091309
Epoch: 10, Steps: 13 | Train Loss: 21.076 Vali Loss: 33.249 Vali Acc: 0.300 Test Loss: 33.249 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.5789518356323242
Epoch: 11, Steps: 13 | Train Loss: 19.365 Vali Loss: 76.239 Vali Acc: 0.260 Test Loss: 76.239 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.6302826404571533
Epoch: 12, Steps: 13 | Train Loss: 26.508 Vali Loss: 90.978 Vali Acc: 0.240 Test Loss: 90.978 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.7273757457733154
Epoch: 13, Steps: 13 | Train Loss: 29.469 Vali Loss: 82.838 Vali Acc: 0.240 Test Loss: 82.838 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.6583890914916992
Epoch: 14, Steps: 13 | Train Loss: 32.412 Vali Loss: 97.825 Vali Acc: 0.280 Test Loss: 97.825 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.6677165031433105
Epoch: 15, Steps: 13 | Train Loss: 23.813 Vali Loss: 123.469 Vali Acc: 0.380 Test Loss: 123.469 Test Acc: 0.380
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.7233610153198242
Epoch: 16, Steps: 13 | Train Loss: 49.797 Vali Loss: 86.624 Vali Acc: 0.440 Test Loss: 86.624 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.46
model parameter : 6045533
model size : 23.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.797309637069702
Epoch: 1, Steps: 13 | Train Loss: 9.947 Vali Loss: 7.162 Vali Acc: 0.260 Test Loss: 7.162 Test Acc: 0.260
Validation loss decreased (inf --> -0.259928).  Saving model ...
Epoch: 2 cost time: 1.626253366470337
Epoch: 2, Steps: 13 | Train Loss: 11.037 Vali Loss: 19.910 Vali Acc: 0.200 Test Loss: 19.910 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7036113739013672
Epoch: 3, Steps: 13 | Train Loss: 22.842 Vali Loss: 27.792 Vali Acc: 0.300 Test Loss: 27.792 Test Acc: 0.300
Validation loss decreased (-0.259928 --> -0.299722).  Saving model ...
Epoch: 4 cost time: 1.735680341720581
Epoch: 4, Steps: 13 | Train Loss: 22.570 Vali Loss: 22.681 Vali Acc: 0.300 Test Loss: 22.681 Test Acc: 0.300
Validation loss decreased (-0.299722 --> -0.299773).  Saving model ...
Epoch: 5 cost time: 1.652820348739624
Epoch: 5, Steps: 13 | Train Loss: 12.489 Vali Loss: 33.871 Vali Acc: 0.480 Test Loss: 33.871 Test Acc: 0.480
Validation loss decreased (-0.299773 --> -0.479661).  Saving model ...
Epoch: 6 cost time: 1.7049908638000488
Epoch: 6, Steps: 13 | Train Loss: 19.231 Vali Loss: 28.453 Vali Acc: 0.340 Test Loss: 28.453 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7354230880737305
Epoch: 7, Steps: 13 | Train Loss: 25.102 Vali Loss: 48.455 Vali Acc: 0.240 Test Loss: 48.455 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5602362155914307
Epoch: 8, Steps: 13 | Train Loss: 17.422 Vali Loss: 34.438 Vali Acc: 0.340 Test Loss: 34.438 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.614652156829834
Epoch: 9, Steps: 13 | Train Loss: 13.620 Vali Loss: 28.981 Vali Acc: 0.400 Test Loss: 28.981 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.5315003395080566
Epoch: 10, Steps: 13 | Train Loss: 19.217 Vali Loss: 54.548 Vali Acc: 0.280 Test Loss: 54.548 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.522519588470459
Epoch: 11, Steps: 13 | Train Loss: 12.216 Vali Loss: 68.643 Vali Acc: 0.340 Test Loss: 68.643 Test Acc: 0.340
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.6356213092803955
Epoch: 12, Steps: 13 | Train Loss: 27.557 Vali Loss: 71.533 Vali Acc: 0.340 Test Loss: 71.533 Test Acc: 0.340
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.5470833778381348
Epoch: 13, Steps: 13 | Train Loss: 34.327 Vali Loss: 107.907 Vali Acc: 0.320 Test Loss: 107.907 Test Acc: 0.320
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.5665819644927979
Epoch: 14, Steps: 13 | Train Loss: 26.414 Vali Loss: 43.734 Vali Acc: 0.380 Test Loss: 43.734 Test Acc: 0.380
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.6341612339019775
Epoch: 15, Steps: 13 | Train Loss: 8.817 Vali Loss: 69.776 Vali Acc: 0.400 Test Loss: 69.776 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 6044797
model size : 23.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.98395037651062
Epoch: 1, Steps: 13 | Train Loss: 6.025 Vali Loss: 15.476 Vali Acc: 0.200 Test Loss: 15.476 Test Acc: 0.200
Validation loss decreased (inf --> -0.199845).  Saving model ...
Epoch: 2 cost time: 1.5969278812408447
Epoch: 2, Steps: 13 | Train Loss: 14.550 Vali Loss: 25.068 Vali Acc: 0.220 Test Loss: 25.068 Test Acc: 0.220
Validation loss decreased (-0.199845 --> -0.219749).  Saving model ...
Epoch: 3 cost time: 1.5892765522003174
Epoch: 3, Steps: 13 | Train Loss: 11.291 Vali Loss: 20.637 Vali Acc: 0.320 Test Loss: 20.637 Test Acc: 0.320
Validation loss decreased (-0.219749 --> -0.319794).  Saving model ...
Epoch: 4 cost time: 1.629377841949463
Epoch: 4, Steps: 13 | Train Loss: 13.418 Vali Loss: 29.413 Vali Acc: 0.320 Test Loss: 29.413 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5289027690887451
Epoch: 5, Steps: 13 | Train Loss: 16.580 Vali Loss: 12.279 Vali Acc: 0.360 Test Loss: 12.279 Test Acc: 0.360
Validation loss decreased (-0.319794 --> -0.359877).  Saving model ...
Epoch: 6 cost time: 1.5622453689575195
Epoch: 6, Steps: 13 | Train Loss: 19.666 Vali Loss: 23.085 Vali Acc: 0.380 Test Loss: 23.085 Test Acc: 0.380
Validation loss decreased (-0.359877 --> -0.379769).  Saving model ...
Epoch: 7 cost time: 1.6054000854492188
Epoch: 7, Steps: 13 | Train Loss: 13.103 Vali Loss: 69.874 Vali Acc: 0.200 Test Loss: 69.874 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6891205310821533
Epoch: 8, Steps: 13 | Train Loss: 31.232 Vali Loss: 45.629 Vali Acc: 0.320 Test Loss: 45.629 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5436959266662598
Epoch: 9, Steps: 13 | Train Loss: 25.893 Vali Loss: 49.623 Vali Acc: 0.240 Test Loss: 49.623 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.6616451740264893
Epoch: 10, Steps: 13 | Train Loss: 22.467 Vali Loss: 55.725 Vali Acc: 0.380 Test Loss: 55.725 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.5385699272155762
Epoch: 11, Steps: 13 | Train Loss: 28.099 Vali Loss: 72.115 Vali Acc: 0.320 Test Loss: 72.115 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.5979609489440918
Epoch: 12, Steps: 13 | Train Loss: 23.656 Vali Loss: 79.377 Vali Acc: 0.400 Test Loss: 79.377 Test Acc: 0.400
Validation loss decreased (-0.379769 --> -0.399206).  Saving model ...
Epoch: 13 cost time: 1.6422147750854492
Epoch: 13, Steps: 13 | Train Loss: 45.505 Vali Loss: 138.375 Vali Acc: 0.220 Test Loss: 138.375 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.573974847793579
Epoch: 14, Steps: 13 | Train Loss: 45.865 Vali Loss: 71.127 Vali Acc: 0.300 Test Loss: 71.127 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.429960012435913
Epoch: 15, Steps: 13 | Train Loss: 92.273 Vali Loss: 102.877 Vali Acc: 0.420 Test Loss: 102.877 Test Acc: 0.420
Validation loss decreased (-0.399206 --> -0.418971).  Saving model ...
Epoch: 16 cost time: 1.433661937713623
Epoch: 16, Steps: 13 | Train Loss: 123.425 Vali Loss: 124.695 Vali Acc: 0.420 Test Loss: 124.695 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6219441890716553
Epoch: 17, Steps: 13 | Train Loss: 25.421 Vali Loss: 67.083 Vali Acc: 0.520 Test Loss: 67.083 Test Acc: 0.520
Validation loss decreased (-0.418971 --> -0.519329).  Saving model ...
Epoch: 18 cost time: 1.610156536102295
Epoch: 18, Steps: 13 | Train Loss: 16.280 Vali Loss: 97.609 Vali Acc: 0.380 Test Loss: 97.609 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.65446138381958
Epoch: 19, Steps: 13 | Train Loss: 11.575 Vali Loss: 73.563 Vali Acc: 0.480 Test Loss: 73.563 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.6504299640655518
Epoch: 20, Steps: 13 | Train Loss: 9.911 Vali Loss: 71.838 Vali Acc: 0.480 Test Loss: 71.838 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.4656715393066406
Epoch: 21, Steps: 13 | Train Loss: 1.984 Vali Loss: 76.830 Vali Acc: 0.420 Test Loss: 76.830 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.7876315116882324
Epoch: 22, Steps: 13 | Train Loss: 7.101 Vali Loss: 81.208 Vali Acc: 0.460 Test Loss: 81.208 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.6381545066833496
Epoch: 23, Steps: 13 | Train Loss: 18.822 Vali Loss: 79.785 Vali Acc: 0.480 Test Loss: 79.785 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.6459085941314697
Epoch: 24, Steps: 13 | Train Loss: 8.670 Vali Loss: 134.093 Vali Acc: 0.480 Test Loss: 134.093 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.641331434249878
Epoch: 25, Steps: 13 | Train Loss: 14.211 Vali Loss: 101.278 Vali Acc: 0.460 Test Loss: 101.278 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.6156926155090332
Epoch: 26, Steps: 13 | Train Loss: 15.025 Vali Loss: 132.256 Vali Acc: 0.400 Test Loss: 132.256 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.6156163215637207
Epoch: 27, Steps: 13 | Train Loss: 4.558 Vali Loss: 105.552 Vali Acc: 0.540 Test Loss: 105.552 Test Acc: 0.540
Validation loss decreased (-0.519329 --> -0.538944).  Saving model ...
Epoch: 28 cost time: 1.6485095024108887
Epoch: 28, Steps: 13 | Train Loss: 3.129 Vali Loss: 103.713 Vali Acc: 0.480 Test Loss: 103.713 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.6205098628997803
Epoch: 29, Steps: 13 | Train Loss: 3.435 Vali Loss: 118.549 Vali Acc: 0.520 Test Loss: 118.549 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.5605618953704834
Epoch: 30, Steps: 13 | Train Loss: 2.991 Vali Loss: 89.772 Vali Acc: 0.520 Test Loss: 89.772 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.5767080783843994
Epoch: 31, Steps: 13 | Train Loss: 2.420 Vali Loss: 124.299 Vali Acc: 0.500 Test Loss: 124.299 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.6671192646026611
Epoch: 32, Steps: 13 | Train Loss: 9.772 Vali Loss: 172.728 Vali Acc: 0.440 Test Loss: 172.728 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.5266985893249512
Epoch: 33, Steps: 13 | Train Loss: 13.186 Vali Loss: 140.054 Vali Acc: 0.440 Test Loss: 140.054 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.5145263671875
Epoch: 34, Steps: 13 | Train Loss: 4.921 Vali Loss: 263.263 Vali Acc: 0.360 Test Loss: 263.263 Test Acc: 0.360
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.529271125793457
Epoch: 35, Steps: 13 | Train Loss: 20.201 Vali Loss: 160.247 Vali Acc: 0.460 Test Loss: 160.247 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.6696538925170898
Epoch: 36, Steps: 13 | Train Loss: 22.416 Vali Loss: 147.114 Vali Acc: 0.420 Test Loss: 147.114 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.6255829334259033
Epoch: 37, Steps: 13 | Train Loss: 6.266 Vali Loss: 164.839 Vali Acc: 0.400 Test Loss: 164.839 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 6044061
model size : 23.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.2210285663604736
Epoch: 1, Steps: 13 | Train Loss: 10.893 Vali Loss: 9.858 Vali Acc: 0.220 Test Loss: 9.858 Test Acc: 0.220
Validation loss decreased (inf --> -0.219901).  Saving model ...
Epoch: 2 cost time: 1.4548723697662354
Epoch: 2, Steps: 13 | Train Loss: 18.065 Vali Loss: 13.365 Vali Acc: 0.340 Test Loss: 13.365 Test Acc: 0.340
Validation loss decreased (-0.219901 --> -0.339866).  Saving model ...
Epoch: 3 cost time: 1.5273659229278564
Epoch: 3, Steps: 13 | Train Loss: 12.887 Vali Loss: 17.107 Vali Acc: 0.220 Test Loss: 17.107 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4776020050048828
Epoch: 4, Steps: 13 | Train Loss: 16.422 Vali Loss: 23.263 Vali Acc: 0.220 Test Loss: 23.263 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.655501365661621
Epoch: 5, Steps: 13 | Train Loss: 17.808 Vali Loss: 16.820 Vali Acc: 0.280 Test Loss: 16.820 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5650453567504883
Epoch: 6, Steps: 13 | Train Loss: 13.959 Vali Loss: 32.127 Vali Acc: 0.360 Test Loss: 32.127 Test Acc: 0.360
Validation loss decreased (-0.339866 --> -0.359679).  Saving model ...
Epoch: 7 cost time: 1.5806989669799805
Epoch: 7, Steps: 13 | Train Loss: 20.493 Vali Loss: 36.666 Vali Acc: 0.360 Test Loss: 36.666 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4870305061340332
Epoch: 8, Steps: 13 | Train Loss: 18.232 Vali Loss: 61.058 Vali Acc: 0.380 Test Loss: 61.058 Test Acc: 0.380
Validation loss decreased (-0.359679 --> -0.379389).  Saving model ...
Epoch: 9 cost time: 1.5191371440887451
Epoch: 9, Steps: 13 | Train Loss: 26.206 Vali Loss: 70.077 Vali Acc: 0.380 Test Loss: 70.077 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5655450820922852
Epoch: 10, Steps: 13 | Train Loss: 28.337 Vali Loss: 69.518 Vali Acc: 0.260 Test Loss: 69.518 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5528943538665771
Epoch: 11, Steps: 13 | Train Loss: 49.900 Vali Loss: 44.813 Vali Acc: 0.380 Test Loss: 44.813 Test Acc: 0.380
Validation loss decreased (-0.379389 --> -0.379552).  Saving model ...
Epoch: 12 cost time: 1.6670150756835938
Epoch: 12, Steps: 13 | Train Loss: 13.624 Vali Loss: 34.036 Vali Acc: 0.420 Test Loss: 34.036 Test Acc: 0.420
Validation loss decreased (-0.379552 --> -0.419660).  Saving model ...
Epoch: 13 cost time: 1.4297678470611572
Epoch: 13, Steps: 13 | Train Loss: 8.626 Vali Loss: 35.118 Vali Acc: 0.540 Test Loss: 35.118 Test Acc: 0.540
Validation loss decreased (-0.419660 --> -0.539649).  Saving model ...
Epoch: 14 cost time: 1.4923171997070312
Epoch: 14, Steps: 13 | Train Loss: 51.685 Vali Loss: 49.422 Vali Acc: 0.420 Test Loss: 49.422 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5135009288787842
Epoch: 15, Steps: 13 | Train Loss: 19.608 Vali Loss: 92.772 Vali Acc: 0.400 Test Loss: 92.772 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4510130882263184
Epoch: 16, Steps: 13 | Train Loss: 8.457 Vali Loss: 95.835 Vali Acc: 0.440 Test Loss: 95.835 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.4743578433990479
Epoch: 17, Steps: 13 | Train Loss: 17.240 Vali Loss: 77.622 Vali Acc: 0.380 Test Loss: 77.622 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.4504985809326172
Epoch: 18, Steps: 13 | Train Loss: 2.418 Vali Loss: 54.130 Vali Acc: 0.460 Test Loss: 54.130 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.4035091400146484
Epoch: 19, Steps: 13 | Train Loss: 2.575 Vali Loss: 67.323 Vali Acc: 0.400 Test Loss: 67.323 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.4500820636749268
Epoch: 20, Steps: 13 | Train Loss: 38.791 Vali Loss: 85.878 Vali Acc: 0.440 Test Loss: 85.878 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.416297435760498
Epoch: 21, Steps: 13 | Train Loss: 8.007 Vali Loss: 76.381 Vali Acc: 0.400 Test Loss: 76.381 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.3996381759643555
Epoch: 22, Steps: 13 | Train Loss: 9.080 Vali Loss: 79.649 Vali Acc: 0.460 Test Loss: 79.649 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.3891286849975586
Epoch: 23, Steps: 13 | Train Loss: 14.218 Vali Loss: 67.963 Vali Acc: 0.500 Test Loss: 67.963 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 6043325
model size : 23.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.1152679920196533
Epoch: 1, Steps: 13 | Train Loss: 10.855 Vali Loss: 12.208 Vali Acc: 0.260 Test Loss: 12.208 Test Acc: 0.260
Validation loss decreased (inf --> -0.259878).  Saving model ...
Epoch: 2 cost time: 1.6587677001953125
Epoch: 2, Steps: 13 | Train Loss: 22.271 Vali Loss: 17.068 Vali Acc: 0.200 Test Loss: 17.068 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6396076679229736
Epoch: 3, Steps: 13 | Train Loss: 16.428 Vali Loss: 44.809 Vali Acc: 0.280 Test Loss: 44.809 Test Acc: 0.280
Validation loss decreased (-0.259878 --> -0.279552).  Saving model ...
Epoch: 4 cost time: 1.6875300407409668
Epoch: 4, Steps: 13 | Train Loss: 24.731 Vali Loss: 23.894 Vali Acc: 0.220 Test Loss: 23.894 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5285661220550537
Epoch: 5, Steps: 13 | Train Loss: 13.769 Vali Loss: 14.476 Vali Acc: 0.260 Test Loss: 14.476 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.570009469985962
Epoch: 6, Steps: 13 | Train Loss: 10.965 Vali Loss: 24.979 Vali Acc: 0.380 Test Loss: 24.979 Test Acc: 0.380
Validation loss decreased (-0.279552 --> -0.379750).  Saving model ...
Epoch: 7 cost time: 1.5901861190795898
Epoch: 7, Steps: 13 | Train Loss: 13.408 Vali Loss: 33.813 Vali Acc: 0.480 Test Loss: 33.813 Test Acc: 0.480
Validation loss decreased (-0.379750 --> -0.479662).  Saving model ...
Epoch: 8 cost time: 1.6417737007141113
Epoch: 8, Steps: 13 | Train Loss: 23.118 Vali Loss: 54.224 Vali Acc: 0.320 Test Loss: 54.224 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.617654800415039
Epoch: 9, Steps: 13 | Train Loss: 8.997 Vali Loss: 50.630 Vali Acc: 0.280 Test Loss: 50.630 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.7177131175994873
Epoch: 10, Steps: 13 | Train Loss: 20.865 Vali Loss: 42.962 Vali Acc: 0.260 Test Loss: 42.962 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.5772082805633545
Epoch: 11, Steps: 13 | Train Loss: 13.878 Vali Loss: 46.481 Vali Acc: 0.300 Test Loss: 46.481 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.5663132667541504
Epoch: 12, Steps: 13 | Train Loss: 27.749 Vali Loss: 57.853 Vali Acc: 0.240 Test Loss: 57.853 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.695251226425171
Epoch: 13, Steps: 13 | Train Loss: 26.100 Vali Loss: 86.627 Vali Acc: 0.260 Test Loss: 86.627 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.5437147617340088
Epoch: 14, Steps: 13 | Train Loss: 26.355 Vali Loss: 117.654 Vali Acc: 0.400 Test Loss: 117.654 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.5341181755065918
Epoch: 15, Steps: 13 | Train Loss: 43.270 Vali Loss: 92.893 Vali Acc: 0.260 Test Loss: 92.893 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.495518684387207
Epoch: 16, Steps: 13 | Train Loss: 39.045 Vali Loss: 93.674 Vali Acc: 0.340 Test Loss: 93.674 Test Acc: 0.340
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.504028081893921
Epoch: 17, Steps: 13 | Train Loss: 29.507 Vali Loss: 57.997 Vali Acc: 0.400 Test Loss: 57.997 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 6020573
model size : 23.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.100432872772217
Epoch: 1, Steps: 13 | Train Loss: 7.256 Vali Loss: 16.838 Vali Acc: 0.200 Test Loss: 16.838 Test Acc: 0.200
Validation loss decreased (inf --> -0.199832).  Saving model ...
Epoch: 2 cost time: 1.5954766273498535
Epoch: 2, Steps: 13 | Train Loss: 11.249 Vali Loss: 19.659 Vali Acc: 0.260 Test Loss: 19.659 Test Acc: 0.260
Validation loss decreased (-0.199832 --> -0.259803).  Saving model ...
Epoch: 3 cost time: 1.4732015132904053
Epoch: 3, Steps: 13 | Train Loss: 13.530 Vali Loss: 27.606 Vali Acc: 0.280 Test Loss: 27.606 Test Acc: 0.280
Validation loss decreased (-0.259803 --> -0.279724).  Saving model ...
Epoch: 4 cost time: 1.508608341217041
Epoch: 4, Steps: 13 | Train Loss: 17.352 Vali Loss: 28.919 Vali Acc: 0.240 Test Loss: 28.919 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.486647367477417
Epoch: 5, Steps: 13 | Train Loss: 16.823 Vali Loss: 13.327 Vali Acc: 0.340 Test Loss: 13.327 Test Acc: 0.340
Validation loss decreased (-0.279724 --> -0.339867).  Saving model ...
Epoch: 6 cost time: 1.5281176567077637
Epoch: 6, Steps: 13 | Train Loss: 7.346 Vali Loss: 64.424 Vali Acc: 0.220 Test Loss: 64.424 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.440676212310791
Epoch: 7, Steps: 13 | Train Loss: 44.237 Vali Loss: 61.709 Vali Acc: 0.260 Test Loss: 61.709 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5189564228057861
Epoch: 8, Steps: 13 | Train Loss: 25.284 Vali Loss: 87.264 Vali Acc: 0.200 Test Loss: 87.264 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7331037521362305
Epoch: 9, Steps: 13 | Train Loss: 26.263 Vali Loss: 63.067 Vali Acc: 0.380 Test Loss: 63.067 Test Acc: 0.380
Validation loss decreased (-0.339867 --> -0.379369).  Saving model ...
Epoch: 10 cost time: 1.6700069904327393
Epoch: 10, Steps: 13 | Train Loss: 26.834 Vali Loss: 98.468 Vali Acc: 0.300 Test Loss: 98.468 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5514960289001465
Epoch: 11, Steps: 13 | Train Loss: 51.491 Vali Loss: 80.801 Vali Acc: 0.260 Test Loss: 80.801 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8356127738952637
Epoch: 12, Steps: 13 | Train Loss: 30.372 Vali Loss: 87.044 Vali Acc: 0.240 Test Loss: 87.044 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.5371663570404053
Epoch: 13, Steps: 13 | Train Loss: 11.004 Vali Loss: 45.227 Vali Acc: 0.440 Test Loss: 45.227 Test Acc: 0.440
Validation loss decreased (-0.379369 --> -0.439548).  Saving model ...
Epoch: 14 cost time: 1.5122065544128418
Epoch: 14, Steps: 13 | Train Loss: 39.793 Vali Loss: 188.419 Vali Acc: 0.260 Test Loss: 188.419 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5307691097259521
Epoch: 15, Steps: 13 | Train Loss: 54.238 Vali Loss: 112.084 Vali Acc: 0.360 Test Loss: 112.084 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4632549285888672
Epoch: 16, Steps: 13 | Train Loss: 60.186 Vali Loss: 146.666 Vali Acc: 0.340 Test Loss: 146.666 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.5870153903961182
Epoch: 17, Steps: 13 | Train Loss: 53.999 Vali Loss: 110.240 Vali Acc: 0.360 Test Loss: 110.240 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.5702636241912842
Epoch: 18, Steps: 13 | Train Loss: 14.823 Vali Loss: 115.019 Vali Acc: 0.420 Test Loss: 115.019 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.5215375423431396
Epoch: 19, Steps: 13 | Train Loss: 30.939 Vali Loss: 107.538 Vali Acc: 0.360 Test Loss: 107.538 Test Acc: 0.360
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.4641571044921875
Epoch: 20, Steps: 13 | Train Loss: 14.491 Vali Loss: 114.746 Vali Acc: 0.460 Test Loss: 114.746 Test Acc: 0.460
Validation loss decreased (-0.439548 --> -0.458853).  Saving model ...
Epoch: 21 cost time: 1.5581719875335693
Epoch: 21, Steps: 13 | Train Loss: 7.599 Vali Loss: 107.116 Vali Acc: 0.460 Test Loss: 107.116 Test Acc: 0.460
Validation loss decreased (-0.458853 --> -0.458929).  Saving model ...
Epoch: 22 cost time: 1.6659603118896484
Epoch: 22, Steps: 13 | Train Loss: 15.124 Vali Loss: 91.026 Vali Acc: 0.440 Test Loss: 91.026 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.5726332664489746
Epoch: 23, Steps: 13 | Train Loss: 4.191 Vali Loss: 71.263 Vali Acc: 0.540 Test Loss: 71.263 Test Acc: 0.540
Validation loss decreased (-0.458929 --> -0.539287).  Saving model ...
Epoch: 24 cost time: 1.558429479598999
Epoch: 24, Steps: 13 | Train Loss: 0.000 Vali Loss: 86.767 Vali Acc: 0.500 Test Loss: 86.767 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.6427085399627686
Epoch: 25, Steps: 13 | Train Loss: 0.239 Vali Loss: 83.445 Vali Acc: 0.460 Test Loss: 83.445 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.6666865348815918
Epoch: 26, Steps: 13 | Train Loss: 1.844 Vali Loss: 119.883 Vali Acc: 0.400 Test Loss: 119.883 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.6419367790222168
Epoch: 27, Steps: 13 | Train Loss: 13.506 Vali Loss: 93.620 Vali Acc: 0.560 Test Loss: 93.620 Test Acc: 0.560
Validation loss decreased (-0.539287 --> -0.559064).  Saving model ...
Epoch: 28 cost time: 1.7132501602172852
Epoch: 28, Steps: 13 | Train Loss: 24.373 Vali Loss: 139.975 Vali Acc: 0.360 Test Loss: 139.975 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.526381015777588
Epoch: 29, Steps: 13 | Train Loss: 11.916 Vali Loss: 76.228 Vali Acc: 0.540 Test Loss: 76.228 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.6421778202056885
Epoch: 30, Steps: 13 | Train Loss: 2.577 Vali Loss: 105.270 Vali Acc: 0.400 Test Loss: 105.270 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.55352783203125
Epoch: 31, Steps: 13 | Train Loss: 3.610 Vali Loss: 95.443 Vali Acc: 0.460 Test Loss: 95.443 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.5976893901824951
Epoch: 32, Steps: 13 | Train Loss: 10.562 Vali Loss: 130.549 Vali Acc: 0.440 Test Loss: 130.549 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.6374962329864502
Epoch: 33, Steps: 13 | Train Loss: 4.852 Vali Loss: 128.837 Vali Acc: 0.380 Test Loss: 128.837 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.5114927291870117
Epoch: 34, Steps: 13 | Train Loss: 10.562 Vali Loss: 95.218 Vali Acc: 0.460 Test Loss: 95.218 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.6724040508270264
Epoch: 35, Steps: 13 | Train Loss: 7.230 Vali Loss: 139.168 Vali Acc: 0.440 Test Loss: 139.168 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.4090368747711182
Epoch: 36, Steps: 13 | Train Loss: 14.550 Vali Loss: 134.326 Vali Acc: 0.460 Test Loss: 134.326 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.45770263671875
Epoch: 37, Steps: 13 | Train Loss: 18.897 Vali Loss: 133.004 Vali Acc: 0.460 Test Loss: 133.004 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 6019837
model size : 23.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.674410820007324
Epoch: 1, Steps: 13 | Train Loss: 8.407 Vali Loss: 17.535 Vali Acc: 0.200 Test Loss: 17.535 Test Acc: 0.200
Validation loss decreased (inf --> -0.199825).  Saving model ...
Epoch: 2 cost time: 1.4647939205169678
Epoch: 2, Steps: 13 | Train Loss: 16.695 Vali Loss: 21.379 Vali Acc: 0.320 Test Loss: 21.379 Test Acc: 0.320
Validation loss decreased (-0.199825 --> -0.319786).  Saving model ...
Epoch: 3 cost time: 1.5761463642120361
Epoch: 3, Steps: 13 | Train Loss: 16.497 Vali Loss: 23.668 Vali Acc: 0.220 Test Loss: 23.668 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5776965618133545
Epoch: 4, Steps: 13 | Train Loss: 14.279 Vali Loss: 14.937 Vali Acc: 0.280 Test Loss: 14.937 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4716382026672363
Epoch: 5, Steps: 13 | Train Loss: 7.261 Vali Loss: 18.067 Vali Acc: 0.240 Test Loss: 18.067 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.4855973720550537
Epoch: 6, Steps: 13 | Train Loss: 5.100 Vali Loss: 34.172 Vali Acc: 0.360 Test Loss: 34.172 Test Acc: 0.360
Validation loss decreased (-0.319786 --> -0.359658).  Saving model ...
Epoch: 7 cost time: 1.4558672904968262
Epoch: 7, Steps: 13 | Train Loss: 13.806 Vali Loss: 14.783 Vali Acc: 0.500 Test Loss: 14.783 Test Acc: 0.500
Validation loss decreased (-0.359658 --> -0.499852).  Saving model ...
Epoch: 8 cost time: 1.4375014305114746
Epoch: 8, Steps: 13 | Train Loss: 10.792 Vali Loss: 62.449 Vali Acc: 0.300 Test Loss: 62.449 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4758172035217285
Epoch: 9, Steps: 13 | Train Loss: 29.123 Vali Loss: 46.286 Vali Acc: 0.280 Test Loss: 46.286 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5432217121124268
Epoch: 10, Steps: 13 | Train Loss: 32.544 Vali Loss: 55.932 Vali Acc: 0.260 Test Loss: 55.932 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4343891143798828
Epoch: 11, Steps: 13 | Train Loss: 35.117 Vali Loss: 68.155 Vali Acc: 0.300 Test Loss: 68.155 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.4195556640625
Epoch: 12, Steps: 13 | Train Loss: 26.133 Vali Loss: 42.474 Vali Acc: 0.340 Test Loss: 42.474 Test Acc: 0.340
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.5048251152038574
Epoch: 13, Steps: 13 | Train Loss: 25.692 Vali Loss: 79.468 Vali Acc: 0.260 Test Loss: 79.468 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.6373188495635986
Epoch: 14, Steps: 13 | Train Loss: 9.488 Vali Loss: 71.860 Vali Acc: 0.340 Test Loss: 71.860 Test Acc: 0.340
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.540329933166504
Epoch: 15, Steps: 13 | Train Loss: 22.099 Vali Loss: 69.708 Vali Acc: 0.340 Test Loss: 69.708 Test Acc: 0.340
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.5073089599609375
Epoch: 16, Steps: 13 | Train Loss: 8.366 Vali Loss: 85.090 Vali Acc: 0.420 Test Loss: 85.090 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.475092887878418
Epoch: 17, Steps: 13 | Train Loss: 17.099 Vali Loss: 114.506 Vali Acc: 0.420 Test Loss: 114.506 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 6019101
model size : 23.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.9916980266571045
Epoch: 1, Steps: 13 | Train Loss: 7.551 Vali Loss: 29.062 Vali Acc: 0.200 Test Loss: 29.062 Test Acc: 0.200
Validation loss decreased (inf --> -0.199709).  Saving model ...
Epoch: 2 cost time: 1.6203656196594238
Epoch: 2, Steps: 13 | Train Loss: 15.394 Vali Loss: 27.969 Vali Acc: 0.200 Test Loss: 27.969 Test Acc: 0.200
Validation loss decreased (-0.199709 --> -0.199720).  Saving model ...
Epoch: 3 cost time: 1.5389742851257324
Epoch: 3, Steps: 13 | Train Loss: 22.573 Vali Loss: 32.399 Vali Acc: 0.300 Test Loss: 32.399 Test Acc: 0.300
Validation loss decreased (-0.199720 --> -0.299676).  Saving model ...
Epoch: 4 cost time: 1.5719900131225586
Epoch: 4, Steps: 13 | Train Loss: 27.853 Vali Loss: 49.961 Vali Acc: 0.280 Test Loss: 49.961 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5029911994934082
Epoch: 5, Steps: 13 | Train Loss: 19.190 Vali Loss: 20.097 Vali Acc: 0.420 Test Loss: 20.097 Test Acc: 0.420
Validation loss decreased (-0.299676 --> -0.419799).  Saving model ...
Epoch: 6 cost time: 1.446012020111084
Epoch: 6, Steps: 13 | Train Loss: 23.876 Vali Loss: 57.484 Vali Acc: 0.200 Test Loss: 57.484 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5241074562072754
Epoch: 7, Steps: 13 | Train Loss: 24.553 Vali Loss: 31.069 Vali Acc: 0.360 Test Loss: 31.069 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5537230968475342
Epoch: 8, Steps: 13 | Train Loss: 51.446 Vali Loss: 101.171 Vali Acc: 0.220 Test Loss: 101.171 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7476806640625
Epoch: 9, Steps: 13 | Train Loss: 45.137 Vali Loss: 33.460 Vali Acc: 0.260 Test Loss: 33.460 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.5925028324127197
Epoch: 10, Steps: 13 | Train Loss: 25.120 Vali Loss: 89.686 Vali Acc: 0.240 Test Loss: 89.686 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.6511728763580322
Epoch: 11, Steps: 13 | Train Loss: 76.726 Vali Loss: 61.548 Vali Acc: 0.460 Test Loss: 61.548 Test Acc: 0.460
Validation loss decreased (-0.419799 --> -0.459385).  Saving model ...
Epoch: 12 cost time: 1.673006296157837
Epoch: 12, Steps: 13 | Train Loss: 30.896 Vali Loss: 117.077 Vali Acc: 0.300 Test Loss: 117.077 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6557648181915283
Epoch: 13, Steps: 13 | Train Loss: 56.820 Vali Loss: 140.556 Vali Acc: 0.260 Test Loss: 140.556 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7621376514434814
Epoch: 14, Steps: 13 | Train Loss: 54.413 Vali Loss: 104.983 Vali Acc: 0.280 Test Loss: 104.983 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.819873332977295
Epoch: 15, Steps: 13 | Train Loss: 38.187 Vali Loss: 79.681 Vali Acc: 0.440 Test Loss: 79.681 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.7498595714569092
Epoch: 16, Steps: 13 | Train Loss: 23.763 Vali Loss: 108.948 Vali Acc: 0.440 Test Loss: 108.948 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.7447023391723633
Epoch: 17, Steps: 13 | Train Loss: 35.949 Vali Loss: 135.415 Vali Acc: 0.320 Test Loss: 135.415 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.7682249546051025
Epoch: 18, Steps: 13 | Train Loss: 26.721 Vali Loss: 74.067 Vali Acc: 0.440 Test Loss: 74.067 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.5756406784057617
Epoch: 19, Steps: 13 | Train Loss: 14.128 Vali Loss: 78.502 Vali Acc: 0.540 Test Loss: 78.502 Test Acc: 0.540
Validation loss decreased (-0.459385 --> -0.539215).  Saving model ...
Epoch: 20 cost time: 1.6676559448242188
Epoch: 20, Steps: 13 | Train Loss: 10.839 Vali Loss: 84.817 Vali Acc: 0.420 Test Loss: 84.817 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6963648796081543
Epoch: 21, Steps: 13 | Train Loss: 5.987 Vali Loss: 71.227 Vali Acc: 0.460 Test Loss: 71.227 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.7726669311523438
Epoch: 22, Steps: 13 | Train Loss: 4.641 Vali Loss: 110.012 Vali Acc: 0.460 Test Loss: 110.012 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.5614545345306396
Epoch: 23, Steps: 13 | Train Loss: 19.155 Vali Loss: 89.325 Vali Acc: 0.500 Test Loss: 89.325 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.6698968410491943
Epoch: 24, Steps: 13 | Train Loss: 7.866 Vali Loss: 116.230 Vali Acc: 0.400 Test Loss: 116.230 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.8200664520263672
Epoch: 25, Steps: 13 | Train Loss: 4.159 Vali Loss: 84.314 Vali Acc: 0.460 Test Loss: 84.314 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.6575422286987305
Epoch: 26, Steps: 13 | Train Loss: 15.366 Vali Loss: 129.339 Vali Acc: 0.360 Test Loss: 129.339 Test Acc: 0.360
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.754183292388916
Epoch: 27, Steps: 13 | Train Loss: 10.582 Vali Loss: 113.748 Vali Acc: 0.420 Test Loss: 113.748 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.7361366748809814
Epoch: 28, Steps: 13 | Train Loss: 22.415 Vali Loss: 131.186 Vali Acc: 0.500 Test Loss: 131.186 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.7408950328826904
Epoch: 29, Steps: 13 | Train Loss: 7.478 Vali Loss: 90.383 Vali Acc: 0.540 Test Loss: 90.383 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_Crossformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 6018365
model size : 23.63MB
