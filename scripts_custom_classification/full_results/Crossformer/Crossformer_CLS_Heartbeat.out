Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 11.64233112335205
Epoch: 1, Steps: 13 | Train Loss: 0.717 Vali Loss: 0.949 Vali Acc: 0.722 Test Loss: 0.949 Test Acc: 0.722
Validation loss decreased (inf --> -0.721942).  Saving model ...
Epoch: 2 cost time: 8.090769290924072
Epoch: 2, Steps: 13 | Train Loss: 1.102 Vali Loss: 0.558 Vali Acc: 0.722 Test Loss: 0.558 Test Acc: 0.722
Validation loss decreased (-0.721942 --> -0.721946).  Saving model ...
Epoch: 3 cost time: 8.090537786483765
Epoch: 3, Steps: 13 | Train Loss: 0.561 Vali Loss: 0.685 Vali Acc: 0.629 Test Loss: 0.685 Test Acc: 0.629
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.398314714431763
Epoch: 4, Steps: 13 | Train Loss: 0.523 Vali Loss: 0.817 Vali Acc: 0.527 Test Loss: 0.817 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.723472595214844
Epoch: 5, Steps: 13 | Train Loss: 0.839 Vali Loss: 1.653 Vali Acc: 0.722 Test Loss: 1.653 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 8.423028707504272
Epoch: 6, Steps: 13 | Train Loss: 1.075 Vali Loss: 1.066 Vali Acc: 0.737 Test Loss: 1.066 Test Acc: 0.737
Validation loss decreased (-0.721946 --> -0.736575).  Saving model ...
Epoch: 7 cost time: 8.32892918586731
Epoch: 7, Steps: 13 | Train Loss: 0.943 Vali Loss: 1.358 Vali Acc: 0.722 Test Loss: 1.358 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.204230785369873
Epoch: 8, Steps: 13 | Train Loss: 0.860 Vali Loss: 1.848 Vali Acc: 0.717 Test Loss: 1.848 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.768401145935059
Epoch: 9, Steps: 13 | Train Loss: 1.449 Vali Loss: 1.758 Vali Acc: 0.722 Test Loss: 1.758 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 9.19068956375122
Epoch: 10, Steps: 13 | Train Loss: 0.912 Vali Loss: 1.531 Vali Acc: 0.727 Test Loss: 1.531 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 9.326194763183594
Epoch: 11, Steps: 13 | Train Loss: 0.664 Vali Loss: 1.147 Vali Acc: 0.751 Test Loss: 1.147 Test Acc: 0.751
Validation loss decreased (-0.736575 --> -0.751208).  Saving model ...
Epoch: 12 cost time: 9.066392660140991
Epoch: 12, Steps: 13 | Train Loss: 0.700 Vali Loss: 0.938 Vali Acc: 0.663 Test Loss: 0.938 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 8.87032699584961
Epoch: 13, Steps: 13 | Train Loss: 1.205 Vali Loss: 0.995 Vali Acc: 0.702 Test Loss: 0.995 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 9.244666814804077
Epoch: 14, Steps: 13 | Train Loss: 2.841 Vali Loss: 1.451 Vali Acc: 0.746 Test Loss: 1.451 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.091466665267944
Epoch: 15, Steps: 13 | Train Loss: 0.499 Vali Loss: 1.017 Vali Acc: 0.659 Test Loss: 1.017 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 8.265931844711304
Epoch: 16, Steps: 13 | Train Loss: 0.640 Vali Loss: 1.043 Vali Acc: 0.712 Test Loss: 1.043 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 8.369171142578125
Epoch: 17, Steps: 13 | Train Loss: 0.231 Vali Loss: 2.037 Vali Acc: 0.737 Test Loss: 2.037 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 7.23931622505188
Epoch: 18, Steps: 13 | Train Loss: 0.227 Vali Loss: 2.039 Vali Acc: 0.556 Test Loss: 2.039 Test Acc: 0.556
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 8.400850534439087
Epoch: 19, Steps: 13 | Train Loss: 0.325 Vali Loss: 2.572 Vali Acc: 0.483 Test Loss: 2.572 Test Acc: 0.483
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 8.655287981033325
Epoch: 20, Steps: 13 | Train Loss: 0.326 Vali Loss: 1.634 Vali Acc: 0.688 Test Loss: 1.634 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 8.084261655807495
Epoch: 21, Steps: 13 | Train Loss: 0.518 Vali Loss: 1.531 Vali Acc: 0.683 Test Loss: 1.531 Test Acc: 0.683
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 15004990
model size : 62.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 11.090506076812744
Epoch: 1, Steps: 13 | Train Loss: 0.683 Vali Loss: 1.062 Vali Acc: 0.278 Test Loss: 1.062 Test Acc: 0.278
Validation loss decreased (inf --> -0.278038).  Saving model ...
Epoch: 2 cost time: 8.930420875549316
Epoch: 2, Steps: 13 | Train Loss: 0.687 Vali Loss: 0.528 Vali Acc: 0.741 Test Loss: 0.528 Test Acc: 0.741
Validation loss decreased (-0.278038 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 6.953202247619629
Epoch: 3, Steps: 13 | Train Loss: 0.795 Vali Loss: 2.149 Vali Acc: 0.278 Test Loss: 2.149 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.527023553848267
Epoch: 4, Steps: 13 | Train Loss: 1.017 Vali Loss: 0.586 Vali Acc: 0.668 Test Loss: 0.586 Test Acc: 0.668
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 9.003599405288696
Epoch: 5, Steps: 13 | Train Loss: 0.808 Vali Loss: 0.566 Vali Acc: 0.693 Test Loss: 0.566 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 7.9159255027771
Epoch: 6, Steps: 13 | Train Loss: 1.463 Vali Loss: 5.678 Vali Acc: 0.278 Test Loss: 5.678 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 7.474225759506226
Epoch: 7, Steps: 13 | Train Loss: 2.514 Vali Loss: 0.821 Vali Acc: 0.737 Test Loss: 0.821 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 8.447712182998657
Epoch: 8, Steps: 13 | Train Loss: 1.630 Vali Loss: 1.660 Vali Acc: 0.732 Test Loss: 1.660 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 7.93014931678772
Epoch: 9, Steps: 13 | Train Loss: 0.874 Vali Loss: 0.817 Vali Acc: 0.727 Test Loss: 0.817 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 7.6246888637542725
Epoch: 10, Steps: 13 | Train Loss: 0.892 Vali Loss: 1.542 Vali Acc: 0.498 Test Loss: 1.542 Test Acc: 0.498
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 8.163698673248291
Epoch: 11, Steps: 13 | Train Loss: 1.224 Vali Loss: 1.582 Vali Acc: 0.454 Test Loss: 1.582 Test Acc: 0.454
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 7.698513746261597
Epoch: 12, Steps: 13 | Train Loss: 0.632 Vali Loss: 0.767 Vali Acc: 0.654 Test Loss: 0.767 Test Acc: 0.654
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 14988350
model size : 62.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 10.265029430389404
Epoch: 1, Steps: 13 | Train Loss: 0.658 Vali Loss: 0.575 Vali Acc: 0.717 Test Loss: 0.575 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 7.420873641967773
Epoch: 2, Steps: 13 | Train Loss: 0.566 Vali Loss: 0.538 Vali Acc: 0.727 Test Loss: 0.538 Test Acc: 0.727
Validation loss decreased (-0.717067 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 9.101236343383789
Epoch: 3, Steps: 13 | Train Loss: 1.034 Vali Loss: 1.596 Vali Acc: 0.722 Test Loss: 1.596 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.169270277023315
Epoch: 4, Steps: 13 | Train Loss: 2.327 Vali Loss: 3.859 Vali Acc: 0.293 Test Loss: 3.859 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.729440450668335
Epoch: 5, Steps: 13 | Train Loss: 1.650 Vali Loss: 1.972 Vali Acc: 0.722 Test Loss: 1.972 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 8.137695550918579
Epoch: 6, Steps: 13 | Train Loss: 1.098 Vali Loss: 0.602 Vali Acc: 0.629 Test Loss: 0.602 Test Acc: 0.629
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.507434606552124
Epoch: 7, Steps: 13 | Train Loss: 1.117 Vali Loss: 1.744 Vali Acc: 0.712 Test Loss: 1.744 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.492344856262207
Epoch: 8, Steps: 13 | Train Loss: 2.090 Vali Loss: 4.397 Vali Acc: 0.307 Test Loss: 4.397 Test Acc: 0.307
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 6.406824588775635
Epoch: 9, Steps: 13 | Train Loss: 1.767 Vali Loss: 0.870 Vali Acc: 0.756 Test Loss: 0.870 Test Acc: 0.756
Validation loss decreased (-0.726824 --> -0.756089).  Saving model ...
Epoch: 10 cost time: 8.111854076385498
Epoch: 10, Steps: 13 | Train Loss: 1.070 Vali Loss: 0.754 Vali Acc: 0.590 Test Loss: 0.754 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 7.7337119579315186
Epoch: 11, Steps: 13 | Train Loss: 1.841 Vali Loss: 0.856 Vali Acc: 0.463 Test Loss: 0.856 Test Acc: 0.463
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 8.685505628585815
Epoch: 12, Steps: 13 | Train Loss: 0.567 Vali Loss: 1.032 Vali Acc: 0.541 Test Loss: 1.032 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 8.962942600250244
Epoch: 13, Steps: 13 | Train Loss: 1.739 Vali Loss: 1.213 Vali Acc: 0.756 Test Loss: 1.213 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 7.6582324504852295
Epoch: 14, Steps: 13 | Train Loss: 1.241 Vali Loss: 0.977 Vali Acc: 0.732 Test Loss: 0.977 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 8.311444282531738
Epoch: 15, Steps: 13 | Train Loss: 0.445 Vali Loss: 0.822 Vali Acc: 0.693 Test Loss: 0.822 Test Acc: 0.693
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 8.485574722290039
Epoch: 16, Steps: 13 | Train Loss: 0.335 Vali Loss: 1.098 Vali Acc: 0.620 Test Loss: 1.098 Test Acc: 0.620
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 7.834700107574463
Epoch: 17, Steps: 13 | Train Loss: 0.733 Vali Loss: 0.859 Vali Acc: 0.698 Test Loss: 0.859 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 7.2004735469818115
Epoch: 18, Steps: 13 | Train Loss: 0.401 Vali Loss: 1.142 Vali Acc: 0.751 Test Loss: 1.142 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 7.031837224960327
Epoch: 19, Steps: 13 | Train Loss: 0.344 Vali Loss: 1.927 Vali Acc: 0.737 Test Loss: 1.927 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 14971710
model size : 62.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 9.650593042373657
Epoch: 1, Steps: 13 | Train Loss: 0.824 Vali Loss: 0.905 Vali Acc: 0.717 Test Loss: 0.905 Test Acc: 0.717
Validation loss decreased (inf --> -0.717064).  Saving model ...
Epoch: 2 cost time: 7.979301691055298
Epoch: 2, Steps: 13 | Train Loss: 0.656 Vali Loss: 0.557 Vali Acc: 0.732 Test Loss: 0.557 Test Acc: 0.732
Validation loss decreased (-0.717064 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 7.891911745071411
Epoch: 3, Steps: 13 | Train Loss: 0.777 Vali Loss: 0.568 Vali Acc: 0.683 Test Loss: 0.568 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.433849573135376
Epoch: 4, Steps: 13 | Train Loss: 0.523 Vali Loss: 0.524 Vali Acc: 0.746 Test Loss: 0.524 Test Acc: 0.746
Validation loss decreased (-0.731702 --> -0.746336).  Saving model ...
Epoch: 5 cost time: 7.187801122665405
Epoch: 5, Steps: 13 | Train Loss: 0.786 Vali Loss: 2.030 Vali Acc: 0.722 Test Loss: 2.030 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.805678129196167
Epoch: 6, Steps: 13 | Train Loss: 1.884 Vali Loss: 1.866 Vali Acc: 0.332 Test Loss: 1.866 Test Acc: 0.332
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.437474489212036
Epoch: 7, Steps: 13 | Train Loss: 1.521 Vali Loss: 1.416 Vali Acc: 0.722 Test Loss: 1.416 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.430065393447876
Epoch: 8, Steps: 13 | Train Loss: 0.826 Vali Loss: 0.641 Vali Acc: 0.741 Test Loss: 0.641 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.9663166999816895
Epoch: 9, Steps: 13 | Train Loss: 1.969 Vali Loss: 3.371 Vali Acc: 0.722 Test Loss: 3.371 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.500993728637695
Epoch: 10, Steps: 13 | Train Loss: 1.425 Vali Loss: 1.174 Vali Acc: 0.454 Test Loss: 1.174 Test Acc: 0.454
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 6.349328279495239
Epoch: 11, Steps: 13 | Train Loss: 0.488 Vali Loss: 1.933 Vali Acc: 0.405 Test Loss: 1.933 Test Acc: 0.405
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 7.13977313041687
Epoch: 12, Steps: 13 | Train Loss: 0.859 Vali Loss: 1.357 Vali Acc: 0.537 Test Loss: 1.357 Test Acc: 0.537
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 7.118086576461792
Epoch: 13, Steps: 13 | Train Loss: 0.672 Vali Loss: 1.981 Vali Acc: 0.737 Test Loss: 1.981 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 7.237417936325073
Epoch: 14, Steps: 13 | Train Loss: 0.738 Vali Loss: 5.359 Vali Acc: 0.283 Test Loss: 5.359 Test Acc: 0.283
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 14955070
model size : 62.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.594808578491211
Epoch: 1, Steps: 13 | Train Loss: 0.727 Vali Loss: 0.859 Vali Acc: 0.288 Test Loss: 0.859 Test Acc: 0.288
Validation loss decreased (inf --> -0.287796).  Saving model ...
Epoch: 2 cost time: 7.583064794540405
Epoch: 2, Steps: 13 | Train Loss: 0.679 Vali Loss: 0.517 Vali Acc: 0.746 Test Loss: 0.517 Test Acc: 0.746
Validation loss decreased (-0.287796 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 6.7706568241119385
Epoch: 3, Steps: 13 | Train Loss: 0.733 Vali Loss: 0.701 Vali Acc: 0.741 Test Loss: 0.701 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.378601312637329
Epoch: 4, Steps: 13 | Train Loss: 0.684 Vali Loss: 0.722 Vali Acc: 0.732 Test Loss: 0.722 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.923136949539185
Epoch: 5, Steps: 13 | Train Loss: 0.869 Vali Loss: 1.850 Vali Acc: 0.302 Test Loss: 1.850 Test Acc: 0.302
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 8.001790761947632
Epoch: 6, Steps: 13 | Train Loss: 1.030 Vali Loss: 1.295 Vali Acc: 0.722 Test Loss: 1.295 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.920159816741943
Epoch: 7, Steps: 13 | Train Loss: 0.763 Vali Loss: 0.550 Vali Acc: 0.693 Test Loss: 0.550 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 7.465673446655273
Epoch: 8, Steps: 13 | Train Loss: 2.051 Vali Loss: 1.665 Vali Acc: 0.444 Test Loss: 1.665 Test Acc: 0.444
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 8.452779293060303
Epoch: 9, Steps: 13 | Train Loss: 0.582 Vali Loss: 1.259 Vali Acc: 0.454 Test Loss: 1.259 Test Acc: 0.454
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 6.787323951721191
Epoch: 10, Steps: 13 | Train Loss: 0.590 Vali Loss: 2.610 Vali Acc: 0.722 Test Loss: 2.610 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 7.467775106430054
Epoch: 11, Steps: 13 | Train Loss: 1.131 Vali Loss: 0.906 Vali Acc: 0.751 Test Loss: 0.906 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751210).  Saving model ...
Epoch: 12 cost time: 7.483572483062744
Epoch: 12, Steps: 13 | Train Loss: 1.283 Vali Loss: 1.204 Vali Acc: 0.644 Test Loss: 1.204 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 7.423649311065674
Epoch: 13, Steps: 13 | Train Loss: 2.300 Vali Loss: 5.704 Vali Acc: 0.712 Test Loss: 5.704 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 8.59556245803833
Epoch: 14, Steps: 13 | Train Loss: 4.210 Vali Loss: 17.148 Vali Acc: 0.278 Test Loss: 17.148 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 7.472841739654541
Epoch: 15, Steps: 13 | Train Loss: 8.809 Vali Loss: 2.601 Vali Acc: 0.722 Test Loss: 2.601 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 6.244476079940796
Epoch: 16, Steps: 13 | Train Loss: 3.141 Vali Loss: 1.094 Vali Acc: 0.722 Test Loss: 1.094 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.616255760192871
Epoch: 17, Steps: 13 | Train Loss: 2.634 Vali Loss: 0.986 Vali Acc: 0.722 Test Loss: 0.986 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 8.013941764831543
Epoch: 18, Steps: 13 | Train Loss: 1.067 Vali Loss: 0.701 Vali Acc: 0.278 Test Loss: 0.701 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 7.777601718902588
Epoch: 19, Steps: 13 | Train Loss: 0.762 Vali Loss: 0.605 Vali Acc: 0.722 Test Loss: 0.605 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 8.329623937606812
Epoch: 20, Steps: 13 | Train Loss: 0.815 Vali Loss: 1.304 Vali Acc: 0.278 Test Loss: 1.304 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 7.175448179244995
Epoch: 21, Steps: 13 | Train Loss: 1.065 Vali Loss: 0.874 Vali Acc: 0.278 Test Loss: 0.874 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 12641086
model size : 53.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 9.303348302841187
Epoch: 1, Steps: 13 | Train Loss: 0.863 Vali Loss: 1.363 Vali Acc: 0.278 Test Loss: 1.363 Test Acc: 0.278
Validation loss decreased (inf --> -0.278035).  Saving model ...
Epoch: 2 cost time: 8.10499906539917
Epoch: 2, Steps: 13 | Train Loss: 0.824 Vali Loss: 0.716 Vali Acc: 0.507 Test Loss: 0.716 Test Acc: 0.507
Validation loss decreased (-0.278035 --> -0.507310).  Saving model ...
Epoch: 3 cost time: 8.147626638412476
Epoch: 3, Steps: 13 | Train Loss: 1.021 Vali Loss: 0.642 Vali Acc: 0.649 Test Loss: 0.642 Test Acc: 0.649
Validation loss decreased (-0.507310 --> -0.648774).  Saving model ...
Epoch: 4 cost time: 6.952477931976318
Epoch: 4, Steps: 13 | Train Loss: 0.880 Vali Loss: 0.543 Vali Acc: 0.756 Test Loss: 0.543 Test Acc: 0.756
Validation loss decreased (-0.648774 --> -0.756092).  Saving model ...
Epoch: 5 cost time: 8.030189752578735
Epoch: 5, Steps: 13 | Train Loss: 0.962 Vali Loss: 0.514 Vali Acc: 0.756 Test Loss: 0.514 Test Acc: 0.756
Validation loss decreased (-0.756092 --> -0.756092).  Saving model ...
Epoch: 6 cost time: 8.539990186691284
Epoch: 6, Steps: 13 | Train Loss: 0.649 Vali Loss: 1.533 Vali Acc: 0.722 Test Loss: 1.533 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.177237272262573
Epoch: 7, Steps: 13 | Train Loss: 1.246 Vali Loss: 1.562 Vali Acc: 0.727 Test Loss: 1.562 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.0681188106536865
Epoch: 8, Steps: 13 | Train Loss: 0.915 Vali Loss: 4.241 Vali Acc: 0.712 Test Loss: 4.241 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.535282135009766
Epoch: 9, Steps: 13 | Train Loss: 2.894 Vali Loss: 0.608 Vali Acc: 0.751 Test Loss: 0.608 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 7.288611173629761
Epoch: 10, Steps: 13 | Train Loss: 2.391 Vali Loss: 0.629 Vali Acc: 0.751 Test Loss: 0.629 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 7.311489582061768
Epoch: 11, Steps: 13 | Train Loss: 0.841 Vali Loss: 0.612 Vali Acc: 0.737 Test Loss: 0.612 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.583214521408081
Epoch: 12, Steps: 13 | Train Loss: 1.880 Vali Loss: 3.958 Vali Acc: 0.317 Test Loss: 3.958 Test Acc: 0.317
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 6.69440484046936
Epoch: 13, Steps: 13 | Train Loss: 1.932 Vali Loss: 1.619 Vali Acc: 0.385 Test Loss: 1.619 Test Acc: 0.385
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 6.505306005477905
Epoch: 14, Steps: 13 | Train Loss: 0.803 Vali Loss: 0.993 Vali Acc: 0.727 Test Loss: 0.993 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 7.921036005020142
Epoch: 15, Steps: 13 | Train Loss: 0.367 Vali Loss: 0.846 Vali Acc: 0.620 Test Loss: 0.846 Test Acc: 0.620
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 12624446
model size : 53.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 9.3357675075531
Epoch: 1, Steps: 13 | Train Loss: 0.858 Vali Loss: 0.619 Vali Acc: 0.712 Test Loss: 0.619 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 7.268887758255005
Epoch: 2, Steps: 13 | Train Loss: 0.796 Vali Loss: 0.540 Vali Acc: 0.732 Test Loss: 0.540 Test Acc: 0.732
Validation loss decreased (-0.712189 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 7.387593030929565
Epoch: 3, Steps: 13 | Train Loss: 0.804 Vali Loss: 0.586 Vali Acc: 0.732 Test Loss: 0.586 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.668959856033325
Epoch: 4, Steps: 13 | Train Loss: 0.907 Vali Loss: 0.809 Vali Acc: 0.732 Test Loss: 0.809 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.090327024459839
Epoch: 5, Steps: 13 | Train Loss: 0.723 Vali Loss: 1.759 Vali Acc: 0.722 Test Loss: 1.759 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 7.124008417129517
Epoch: 6, Steps: 13 | Train Loss: 1.007 Vali Loss: 1.394 Vali Acc: 0.727 Test Loss: 1.394 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 7.627890110015869
Epoch: 7, Steps: 13 | Train Loss: 0.520 Vali Loss: 0.592 Vali Acc: 0.732 Test Loss: 0.592 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.919526100158691
Epoch: 8, Steps: 13 | Train Loss: 1.717 Vali Loss: 2.683 Vali Acc: 0.712 Test Loss: 2.683 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 7.726020574569702
Epoch: 9, Steps: 13 | Train Loss: 1.349 Vali Loss: 1.407 Vali Acc: 0.727 Test Loss: 1.407 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 6.879681587219238
Epoch: 10, Steps: 13 | Train Loss: 0.597 Vali Loss: 1.509 Vali Acc: 0.722 Test Loss: 1.509 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 7.067765235900879
Epoch: 11, Steps: 13 | Train Loss: 0.493 Vali Loss: 0.855 Vali Acc: 0.751 Test Loss: 0.855 Test Acc: 0.751
Validation loss decreased (-0.731702 --> -0.751211).  Saving model ...
Epoch: 12 cost time: 8.49624752998352
Epoch: 12, Steps: 13 | Train Loss: 0.444 Vali Loss: 1.511 Vali Acc: 0.727 Test Loss: 1.511 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 7.521296262741089
Epoch: 13, Steps: 13 | Train Loss: 0.399 Vali Loss: 4.703 Vali Acc: 0.298 Test Loss: 4.703 Test Acc: 0.298
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 7.590641498565674
Epoch: 14, Steps: 13 | Train Loss: 1.226 Vali Loss: 2.802 Vali Acc: 0.390 Test Loss: 2.802 Test Acc: 0.390
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 7.954522609710693
Epoch: 15, Steps: 13 | Train Loss: 0.743 Vali Loss: 2.444 Vali Acc: 0.727 Test Loss: 2.444 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 7.016084432601929
Epoch: 16, Steps: 13 | Train Loss: 1.024 Vali Loss: 3.785 Vali Acc: 0.717 Test Loss: 3.785 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 6.270449876785278
Epoch: 17, Steps: 13 | Train Loss: 0.423 Vali Loss: 2.826 Vali Acc: 0.732 Test Loss: 2.826 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.699615716934204
Epoch: 18, Steps: 13 | Train Loss: 2.123 Vali Loss: 6.470 Vali Acc: 0.390 Test Loss: 6.470 Test Acc: 0.390
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 7.457782030105591
Epoch: 19, Steps: 13 | Train Loss: 1.150 Vali Loss: 1.507 Vali Acc: 0.698 Test Loss: 1.507 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.943012237548828
Epoch: 20, Steps: 13 | Train Loss: 0.423 Vali Loss: 2.054 Vali Acc: 0.590 Test Loss: 2.054 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.715877532958984
Epoch: 21, Steps: 13 | Train Loss: 0.922 Vali Loss: 2.383 Vali Acc: 0.732 Test Loss: 2.383 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 12607806
model size : 53.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 9.893638372421265
Epoch: 1, Steps: 13 | Train Loss: 0.765 Vali Loss: 0.699 Vali Acc: 0.454 Test Loss: 0.699 Test Acc: 0.454
Validation loss decreased (inf --> -0.453652).  Saving model ...
Epoch: 2 cost time: 6.744946241378784
Epoch: 2, Steps: 13 | Train Loss: 1.158 Vali Loss: 1.407 Vali Acc: 0.722 Test Loss: 1.407 Test Acc: 0.722
Validation loss decreased (-0.453652 --> -0.721937).  Saving model ...
Epoch: 3 cost time: 6.443994760513306
Epoch: 3, Steps: 13 | Train Loss: 0.937 Vali Loss: 0.611 Vali Acc: 0.732 Test Loss: 0.611 Test Acc: 0.732
Validation loss decreased (-0.721937 --> -0.731701).  Saving model ...
Epoch: 4 cost time: 7.83920431137085
Epoch: 4, Steps: 13 | Train Loss: 0.834 Vali Loss: 1.465 Vali Acc: 0.722 Test Loss: 1.465 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.407736539840698
Epoch: 5, Steps: 13 | Train Loss: 0.494 Vali Loss: 0.554 Vali Acc: 0.688 Test Loss: 0.554 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.037914752960205
Epoch: 6, Steps: 13 | Train Loss: 0.937 Vali Loss: 1.028 Vali Acc: 0.400 Test Loss: 1.028 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.185328722000122
Epoch: 7, Steps: 13 | Train Loss: 1.021 Vali Loss: 5.020 Vali Acc: 0.293 Test Loss: 5.020 Test Acc: 0.293
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.3746113777160645
Epoch: 8, Steps: 13 | Train Loss: 2.145 Vali Loss: 1.425 Vali Acc: 0.722 Test Loss: 1.425 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.7416346073150635
Epoch: 9, Steps: 13 | Train Loss: 1.068 Vali Loss: 5.188 Vali Acc: 0.283 Test Loss: 5.188 Test Acc: 0.283
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 6.981313467025757
Epoch: 10, Steps: 13 | Train Loss: 2.328 Vali Loss: 0.674 Vali Acc: 0.712 Test Loss: 0.674 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 6.644667387008667
Epoch: 11, Steps: 13 | Train Loss: 1.035 Vali Loss: 2.160 Vali Acc: 0.341 Test Loss: 2.160 Test Acc: 0.341
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.999793767929077
Epoch: 12, Steps: 13 | Train Loss: 0.646 Vali Loss: 0.902 Vali Acc: 0.649 Test Loss: 0.902 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 6.073498725891113
Epoch: 13, Steps: 13 | Train Loss: 2.244 Vali Loss: 4.980 Vali Acc: 0.712 Test Loss: 4.980 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7317073170731707
model parameter : 12591166
model size : 53.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 11.041258096694946
Epoch: 1, Steps: 13 | Train Loss: 0.697 Vali Loss: 0.775 Vali Acc: 0.298 Test Loss: 0.775 Test Acc: 0.298
Validation loss decreased (inf --> -0.297553).  Saving model ...
Epoch: 2 cost time: 8.176146268844604
Epoch: 2, Steps: 13 | Train Loss: 0.780 Vali Loss: 0.857 Vali Acc: 0.346 Test Loss: 0.857 Test Acc: 0.346
Validation loss decreased (-0.297553 --> -0.346333).  Saving model ...
Epoch: 3 cost time: 7.623295545578003
Epoch: 3, Steps: 13 | Train Loss: 0.554 Vali Loss: 0.511 Vali Acc: 0.751 Test Loss: 0.511 Test Acc: 0.751
Validation loss decreased (-0.346333 --> -0.751214).  Saving model ...
Epoch: 4 cost time: 6.56820011138916
Epoch: 4, Steps: 13 | Train Loss: 1.260 Vali Loss: 1.791 Vali Acc: 0.722 Test Loss: 1.791 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.182503938674927
Epoch: 5, Steps: 13 | Train Loss: 0.714 Vali Loss: 2.242 Vali Acc: 0.327 Test Loss: 2.242 Test Acc: 0.327
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.646800994873047
Epoch: 6, Steps: 13 | Train Loss: 0.978 Vali Loss: 1.787 Vali Acc: 0.722 Test Loss: 1.787 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 8.022114515304565
Epoch: 7, Steps: 13 | Train Loss: 0.710 Vali Loss: 0.923 Vali Acc: 0.722 Test Loss: 0.923 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 7.487144947052002
Epoch: 8, Steps: 13 | Train Loss: 0.688 Vali Loss: 4.136 Vali Acc: 0.288 Test Loss: 4.136 Test Acc: 0.288
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 8.138012647628784
Epoch: 9, Steps: 13 | Train Loss: 0.887 Vali Loss: 1.169 Vali Acc: 0.727 Test Loss: 1.169 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 8.322746753692627
Epoch: 10, Steps: 13 | Train Loss: 0.424 Vali Loss: 0.961 Vali Acc: 0.741 Test Loss: 0.961 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 8.199610471725464
Epoch: 11, Steps: 13 | Train Loss: 0.424 Vali Loss: 3.418 Vali Acc: 0.312 Test Loss: 3.418 Test Acc: 0.312
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 8.460320949554443
Epoch: 12, Steps: 13 | Train Loss: 2.803 Vali Loss: 0.906 Vali Acc: 0.727 Test Loss: 0.906 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 7.282407999038696
Epoch: 13, Steps: 13 | Train Loss: 1.736 Vali Loss: 1.011 Vali Acc: 0.698 Test Loss: 1.011 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 11459134
model size : 48.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 9.537742853164673
Epoch: 1, Steps: 13 | Train Loss: 0.674 Vali Loss: 0.898 Vali Acc: 0.722 Test Loss: 0.898 Test Acc: 0.722
Validation loss decreased (inf --> -0.721942).  Saving model ...
Epoch: 2 cost time: 8.610090970993042
Epoch: 2, Steps: 13 | Train Loss: 1.043 Vali Loss: 0.646 Vali Acc: 0.629 Test Loss: 0.646 Test Acc: 0.629
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.999259948730469
Epoch: 3, Steps: 13 | Train Loss: 0.865 Vali Loss: 0.527 Vali Acc: 0.761 Test Loss: 0.527 Test Acc: 0.761
Validation loss decreased (-0.721942 --> -0.760970).  Saving model ...
Epoch: 4 cost time: 8.476519107818604
Epoch: 4, Steps: 13 | Train Loss: 0.821 Vali Loss: 0.845 Vali Acc: 0.717 Test Loss: 0.845 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.098885774612427
Epoch: 5, Steps: 13 | Train Loss: 1.121 Vali Loss: 2.447 Vali Acc: 0.346 Test Loss: 2.447 Test Acc: 0.346
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.738882303237915
Epoch: 6, Steps: 13 | Train Loss: 0.998 Vali Loss: 0.890 Vali Acc: 0.727 Test Loss: 0.890 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 7.988714218139648
Epoch: 7, Steps: 13 | Train Loss: 0.701 Vali Loss: 0.535 Vali Acc: 0.737 Test Loss: 0.535 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.874927282333374
Epoch: 8, Steps: 13 | Train Loss: 1.041 Vali Loss: 0.883 Vali Acc: 0.556 Test Loss: 0.883 Test Acc: 0.556
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.874811410903931
Epoch: 9, Steps: 13 | Train Loss: 0.802 Vali Loss: 3.611 Vali Acc: 0.317 Test Loss: 3.611 Test Acc: 0.317
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 8.358595132827759
Epoch: 10, Steps: 13 | Train Loss: 1.052 Vali Loss: 0.803 Vali Acc: 0.654 Test Loss: 0.803 Test Acc: 0.654
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 8.289288520812988
Epoch: 11, Steps: 13 | Train Loss: 1.059 Vali Loss: 0.999 Vali Acc: 0.737 Test Loss: 0.999 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 7.759496688842773
Epoch: 12, Steps: 13 | Train Loss: 0.837 Vali Loss: 3.274 Vali Acc: 0.722 Test Loss: 3.274 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 9.160877227783203
Epoch: 13, Steps: 13 | Train Loss: 1.008 Vali Loss: 0.898 Vali Acc: 0.688 Test Loss: 0.898 Test Acc: 0.688
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 11442494
model size : 48.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 10.173008441925049
Epoch: 1, Steps: 13 | Train Loss: 0.605 Vali Loss: 0.650 Vali Acc: 0.712 Test Loss: 0.650 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 7.89417290687561
Epoch: 2, Steps: 13 | Train Loss: 0.708 Vali Loss: 0.515 Vali Acc: 0.741 Test Loss: 0.515 Test Acc: 0.741
Validation loss decreased (-0.712189 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 8.944228649139404
Epoch: 3, Steps: 13 | Train Loss: 0.838 Vali Loss: 1.267 Vali Acc: 0.722 Test Loss: 1.267 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.975777626037598
Epoch: 4, Steps: 13 | Train Loss: 1.562 Vali Loss: 2.221 Vali Acc: 0.283 Test Loss: 2.221 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 8.054773569107056
Epoch: 5, Steps: 13 | Train Loss: 1.404 Vali Loss: 0.853 Vali Acc: 0.737 Test Loss: 0.853 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 7.716057538986206
Epoch: 6, Steps: 13 | Train Loss: 1.329 Vali Loss: 1.587 Vali Acc: 0.712 Test Loss: 1.587 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 8.17474365234375
Epoch: 7, Steps: 13 | Train Loss: 1.941 Vali Loss: 1.424 Vali Acc: 0.415 Test Loss: 1.424 Test Acc: 0.415
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 8.312087535858154
Epoch: 8, Steps: 13 | Train Loss: 0.619 Vali Loss: 0.781 Vali Acc: 0.732 Test Loss: 0.781 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 7.556942701339722
Epoch: 9, Steps: 13 | Train Loss: 0.567 Vali Loss: 1.098 Vali Acc: 0.737 Test Loss: 1.098 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 7.597337961196899
Epoch: 10, Steps: 13 | Train Loss: 1.285 Vali Loss: 7.717 Vali Acc: 0.283 Test Loss: 7.717 Test Acc: 0.283
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 7.247711658477783
Epoch: 11, Steps: 13 | Train Loss: 1.236 Vali Loss: 0.795 Vali Acc: 0.615 Test Loss: 0.795 Test Acc: 0.615
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 8.866187334060669
Epoch: 12, Steps: 13 | Train Loss: 0.922 Vali Loss: 7.984 Vali Acc: 0.283 Test Loss: 7.984 Test Acc: 0.283
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 11425854
model size : 48.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 11.180675506591797
Epoch: 1, Steps: 13 | Train Loss: 0.723 Vali Loss: 0.735 Vali Acc: 0.356 Test Loss: 0.735 Test Acc: 0.356
Validation loss decreased (inf --> -0.356090).  Saving model ...
Epoch: 2 cost time: 8.45145058631897
Epoch: 2, Steps: 13 | Train Loss: 0.746 Vali Loss: 0.721 Vali Acc: 0.576 Test Loss: 0.721 Test Acc: 0.576
Validation loss decreased (-0.356090 --> -0.575603).  Saving model ...
Epoch: 3 cost time: 7.352632284164429
Epoch: 3, Steps: 13 | Train Loss: 0.790 Vali Loss: 0.932 Vali Acc: 0.722 Test Loss: 0.932 Test Acc: 0.722
Validation loss decreased (-0.575603 --> -0.721942).  Saving model ...
Epoch: 4 cost time: 6.512160062789917
Epoch: 4, Steps: 13 | Train Loss: 1.272 Vali Loss: 1.905 Vali Acc: 0.361 Test Loss: 1.905 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.696529388427734
Epoch: 5, Steps: 13 | Train Loss: 0.808 Vali Loss: 0.530 Vali Acc: 0.737 Test Loss: 0.530 Test Acc: 0.737
Validation loss decreased (-0.721942 --> -0.736580).  Saving model ...
Epoch: 6 cost time: 7.778168678283691
Epoch: 6, Steps: 13 | Train Loss: 1.444 Vali Loss: 3.987 Vali Acc: 0.322 Test Loss: 3.987 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.520124197006226
Epoch: 7, Steps: 13 | Train Loss: 1.795 Vali Loss: 3.071 Vali Acc: 0.722 Test Loss: 3.071 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 7.733914613723755
Epoch: 8, Steps: 13 | Train Loss: 0.961 Vali Loss: 0.682 Vali Acc: 0.756 Test Loss: 0.682 Test Acc: 0.756
Validation loss decreased (-0.736580 --> -0.756091).  Saving model ...
Epoch: 9 cost time: 6.863714218139648
Epoch: 9, Steps: 13 | Train Loss: 0.681 Vali Loss: 1.165 Vali Acc: 0.522 Test Loss: 1.165 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 8.300513505935669
Epoch: 10, Steps: 13 | Train Loss: 0.521 Vali Loss: 1.375 Vali Acc: 0.439 Test Loss: 1.375 Test Acc: 0.439
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 7.988112688064575
Epoch: 11, Steps: 13 | Train Loss: 0.973 Vali Loss: 4.840 Vali Acc: 0.298 Test Loss: 4.840 Test Acc: 0.298
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 7.79817271232605
Epoch: 12, Steps: 13 | Train Loss: 2.667 Vali Loss: 3.898 Vali Acc: 0.722 Test Loss: 3.898 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 7.832712650299072
Epoch: 13, Steps: 13 | Train Loss: 1.664 Vali Loss: 1.578 Vali Acc: 0.732 Test Loss: 1.578 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 7.338589906692505
Epoch: 14, Steps: 13 | Train Loss: 0.760 Vali Loss: 0.949 Vali Acc: 0.717 Test Loss: 0.949 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 6.589822053909302
Epoch: 15, Steps: 13 | Train Loss: 1.002 Vali Loss: 1.130 Vali Acc: 0.717 Test Loss: 1.130 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 7.691213130950928
Epoch: 16, Steps: 13 | Train Loss: 1.839 Vali Loss: 3.087 Vali Acc: 0.722 Test Loss: 3.087 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 7.261000156402588
Epoch: 17, Steps: 13 | Train Loss: 1.287 Vali Loss: 3.180 Vali Acc: 0.410 Test Loss: 3.180 Test Acc: 0.410
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 8.280168771743774
Epoch: 18, Steps: 13 | Train Loss: 0.826 Vali Loss: 1.826 Vali Acc: 0.698 Test Loss: 1.826 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 11409214
model size : 48.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 9.007776260375977
Epoch: 1, Steps: 13 | Train Loss: 1.236 Vali Loss: 1.130 Vali Acc: 0.722 Test Loss: 1.130 Test Acc: 0.722
Validation loss decreased (inf --> -0.721940).  Saving model ...
Epoch: 2 cost time: 6.695018768310547
Epoch: 2, Steps: 13 | Train Loss: 0.760 Vali Loss: 0.605 Vali Acc: 0.722 Test Loss: 0.605 Test Acc: 0.722
Validation loss decreased (-0.721940 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 8.019302368164062
Epoch: 3, Steps: 13 | Train Loss: 0.583 Vali Loss: 0.518 Vali Acc: 0.746 Test Loss: 0.518 Test Acc: 0.746
Validation loss decreased (-0.721945 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 8.023591995239258
Epoch: 4, Steps: 13 | Train Loss: 1.254 Vali Loss: 1.011 Vali Acc: 0.732 Test Loss: 1.011 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.551377773284912
Epoch: 5, Steps: 13 | Train Loss: 1.212 Vali Loss: 1.196 Vali Acc: 0.429 Test Loss: 1.196 Test Acc: 0.429
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 8.480143308639526
Epoch: 6, Steps: 13 | Train Loss: 1.075 Vali Loss: 2.851 Vali Acc: 0.722 Test Loss: 2.851 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 8.515926122665405
Epoch: 7, Steps: 13 | Train Loss: 1.804 Vali Loss: 4.912 Vali Acc: 0.307 Test Loss: 4.912 Test Acc: 0.307
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 8.204425573348999
Epoch: 8, Steps: 13 | Train Loss: 1.620 Vali Loss: 1.071 Vali Acc: 0.727 Test Loss: 1.071 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 8.159653663635254
Epoch: 9, Steps: 13 | Train Loss: 0.907 Vali Loss: 2.488 Vali Acc: 0.722 Test Loss: 2.488 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 8.30734133720398
Epoch: 10, Steps: 13 | Train Loss: 0.702 Vali Loss: 0.716 Vali Acc: 0.629 Test Loss: 0.716 Test Acc: 0.629
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 9.019627809524536
Epoch: 11, Steps: 13 | Train Loss: 0.527 Vali Loss: 0.888 Vali Acc: 0.746 Test Loss: 0.888 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 8.154306173324585
Epoch: 12, Steps: 13 | Train Loss: 0.595 Vali Loss: 1.441 Vali Acc: 0.483 Test Loss: 1.441 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 7.9280455112457275
Epoch: 13, Steps: 13 | Train Loss: 1.065 Vali Loss: 1.707 Vali Acc: 0.751 Test Loss: 1.707 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751202).  Saving model ...
Epoch: 14 cost time: 8.150732040405273
Epoch: 14, Steps: 13 | Train Loss: 1.628 Vali Loss: 2.674 Vali Acc: 0.722 Test Loss: 2.674 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 7.891049146652222
Epoch: 15, Steps: 13 | Train Loss: 1.576 Vali Loss: 4.574 Vali Acc: 0.420 Test Loss: 4.574 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 8.77318811416626
Epoch: 16, Steps: 13 | Train Loss: 1.287 Vali Loss: 1.804 Vali Acc: 0.683 Test Loss: 1.804 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 7.959271192550659
Epoch: 17, Steps: 13 | Train Loss: 1.746 Vali Loss: 3.247 Vali Acc: 0.722 Test Loss: 3.247 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 7.511685848236084
Epoch: 18, Steps: 13 | Train Loss: 0.830 Vali Loss: 2.854 Vali Acc: 0.741 Test Loss: 2.854 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 6.9504616260528564
Epoch: 19, Steps: 13 | Train Loss: 0.867 Vali Loss: 1.173 Vali Acc: 0.693 Test Loss: 1.173 Test Acc: 0.693
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 7.970063924789429
Epoch: 20, Steps: 13 | Train Loss: 0.439 Vali Loss: 1.516 Vali Acc: 0.585 Test Loss: 1.516 Test Acc: 0.585
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 5.742633581161499
Epoch: 21, Steps: 13 | Train Loss: 2.314 Vali Loss: 1.914 Vali Acc: 0.737 Test Loss: 1.914 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 6.678180456161499
Epoch: 22, Steps: 13 | Train Loss: 1.228 Vali Loss: 1.663 Vali Acc: 0.610 Test Loss: 1.663 Test Acc: 0.610
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 9.181427717208862
Epoch: 23, Steps: 13 | Train Loss: 0.259 Vali Loss: 1.392 Vali Acc: 0.698 Test Loss: 1.392 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 10868158
model size : 46.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 9.71743392944336
Epoch: 1, Steps: 13 | Train Loss: 0.780 Vali Loss: 0.912 Vali Acc: 0.722 Test Loss: 0.912 Test Acc: 0.722
Validation loss decreased (inf --> -0.721942).  Saving model ...
Epoch: 2 cost time: 8.474709272384644
Epoch: 2, Steps: 13 | Train Loss: 0.810 Vali Loss: 0.668 Vali Acc: 0.712 Test Loss: 0.668 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.845093727111816
Epoch: 3, Steps: 13 | Train Loss: 1.770 Vali Loss: 2.243 Vali Acc: 0.722 Test Loss: 2.243 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.8485424518585205
Epoch: 4, Steps: 13 | Train Loss: 1.685 Vali Loss: 1.049 Vali Acc: 0.390 Test Loss: 1.049 Test Acc: 0.390
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 8.051608800888062
Epoch: 5, Steps: 13 | Train Loss: 0.793 Vali Loss: 1.679 Vali Acc: 0.722 Test Loss: 1.679 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.768791675567627
Epoch: 6, Steps: 13 | Train Loss: 0.788 Vali Loss: 0.595 Vali Acc: 0.746 Test Loss: 0.595 Test Acc: 0.746
Validation loss decreased (-0.721942 --> -0.746336).  Saving model ...
Epoch: 7 cost time: 7.8641932010650635
Epoch: 7, Steps: 13 | Train Loss: 0.523 Vali Loss: 0.599 Vali Acc: 0.698 Test Loss: 0.599 Test Acc: 0.698
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.084033489227295
Epoch: 8, Steps: 13 | Train Loss: 0.504 Vali Loss: 0.642 Vali Acc: 0.688 Test Loss: 0.642 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 8.771416902542114
Epoch: 9, Steps: 13 | Train Loss: 0.502 Vali Loss: 1.215 Vali Acc: 0.454 Test Loss: 1.215 Test Acc: 0.454
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 9.01564908027649
Epoch: 10, Steps: 13 | Train Loss: 1.193 Vali Loss: 0.682 Vali Acc: 0.702 Test Loss: 0.682 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 9.187479257583618
Epoch: 11, Steps: 13 | Train Loss: 0.569 Vali Loss: 0.748 Vali Acc: 0.615 Test Loss: 0.748 Test Acc: 0.615
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 9.614030361175537
Epoch: 12, Steps: 13 | Train Loss: 1.964 Vali Loss: 1.401 Vali Acc: 0.546 Test Loss: 1.401 Test Acc: 0.546
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 8.437617778778076
Epoch: 13, Steps: 13 | Train Loss: 0.904 Vali Loss: 1.003 Vali Acc: 0.624 Test Loss: 1.003 Test Acc: 0.624
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 8.663098096847534
Epoch: 14, Steps: 13 | Train Loss: 0.582 Vali Loss: 2.306 Vali Acc: 0.727 Test Loss: 2.306 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 7.984233140945435
Epoch: 15, Steps: 13 | Train Loss: 0.826 Vali Loss: 1.153 Vali Acc: 0.741 Test Loss: 1.153 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 8.502517223358154
Epoch: 16, Steps: 13 | Train Loss: 0.387 Vali Loss: 1.266 Vali Acc: 0.659 Test Loss: 1.266 Test Acc: 0.659
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 10851518
model size : 46.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 9.63073468208313
Epoch: 1, Steps: 13 | Train Loss: 0.660 Vali Loss: 0.638 Vali Acc: 0.746 Test Loss: 0.638 Test Acc: 0.746
Validation loss decreased (inf --> -0.746335).  Saving model ...
Epoch: 2 cost time: 7.877834796905518
Epoch: 2, Steps: 13 | Train Loss: 0.738 Vali Loss: 0.714 Vali Acc: 0.512 Test Loss: 0.714 Test Acc: 0.512
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.033266544342041
Epoch: 3, Steps: 13 | Train Loss: 1.018 Vali Loss: 2.265 Vali Acc: 0.283 Test Loss: 2.265 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 8.476897478103638
Epoch: 4, Steps: 13 | Train Loss: 1.034 Vali Loss: 1.265 Vali Acc: 0.405 Test Loss: 1.265 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 9.041032791137695
Epoch: 5, Steps: 13 | Train Loss: 0.754 Vali Loss: 0.702 Vali Acc: 0.746 Test Loss: 0.702 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.421664237976074
Epoch: 6, Steps: 13 | Train Loss: 0.822 Vali Loss: 0.951 Vali Acc: 0.722 Test Loss: 0.951 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 7.906237840652466
Epoch: 7, Steps: 13 | Train Loss: 1.923 Vali Loss: 1.748 Vali Acc: 0.351 Test Loss: 1.748 Test Acc: 0.351
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 8.135427236557007
Epoch: 8, Steps: 13 | Train Loss: 0.966 Vali Loss: 1.904 Vali Acc: 0.371 Test Loss: 1.904 Test Acc: 0.371
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 7.8587024211883545
Epoch: 9, Steps: 13 | Train Loss: 3.590 Vali Loss: 3.574 Vali Acc: 0.712 Test Loss: 3.574 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 7.837560176849365
Epoch: 10, Steps: 13 | Train Loss: 1.285 Vali Loss: 2.631 Vali Acc: 0.722 Test Loss: 2.631 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 7.080810785293579
Epoch: 11, Steps: 13 | Train Loss: 0.969 Vali Loss: 0.947 Vali Acc: 0.732 Test Loss: 0.947 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 10834878
model size : 46.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 9.252517938613892
Epoch: 1, Steps: 13 | Train Loss: 0.697 Vali Loss: 0.580 Vali Acc: 0.717 Test Loss: 0.580 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 7.825998544692993
Epoch: 2, Steps: 13 | Train Loss: 1.006 Vali Loss: 1.164 Vali Acc: 0.717 Test Loss: 1.164 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.1550211906433105
Epoch: 3, Steps: 13 | Train Loss: 1.019 Vali Loss: 0.995 Vali Acc: 0.434 Test Loss: 0.995 Test Acc: 0.434
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.491762161254883
Epoch: 4, Steps: 13 | Train Loss: 0.940 Vali Loss: 1.383 Vali Acc: 0.473 Test Loss: 1.383 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.342181444168091
Epoch: 5, Steps: 13 | Train Loss: 2.153 Vali Loss: 1.450 Vali Acc: 0.722 Test Loss: 1.450 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721937).  Saving model ...
Epoch: 6 cost time: 7.815161228179932
Epoch: 6, Steps: 13 | Train Loss: 2.148 Vali Loss: 0.706 Vali Acc: 0.678 Test Loss: 0.706 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.552660942077637
Epoch: 7, Steps: 13 | Train Loss: 1.607 Vali Loss: 0.810 Vali Acc: 0.654 Test Loss: 0.810 Test Acc: 0.654
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 7.854832887649536
Epoch: 8, Steps: 13 | Train Loss: 1.194 Vali Loss: 0.535 Vali Acc: 0.737 Test Loss: 0.535 Test Acc: 0.737
Validation loss decreased (-0.721937 --> -0.736580).  Saving model ...
Epoch: 9 cost time: 7.374796152114868
Epoch: 9, Steps: 13 | Train Loss: 1.288 Vali Loss: 1.034 Vali Acc: 0.498 Test Loss: 1.034 Test Acc: 0.498
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.6165711879730225
Epoch: 10, Steps: 13 | Train Loss: 1.621 Vali Loss: 1.699 Vali Acc: 0.439 Test Loss: 1.699 Test Acc: 0.439
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 7.783731460571289
Epoch: 11, Steps: 13 | Train Loss: 1.015 Vali Loss: 0.612 Vali Acc: 0.688 Test Loss: 0.612 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 7.065055847167969
Epoch: 12, Steps: 13 | Train Loss: 1.074 Vali Loss: 5.213 Vali Acc: 0.312 Test Loss: 5.213 Test Acc: 0.312
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 7.671705722808838
Epoch: 13, Steps: 13 | Train Loss: 1.591 Vali Loss: 1.178 Vali Acc: 0.756 Test Loss: 1.178 Test Acc: 0.756
Validation loss decreased (-0.736580 --> -0.756086).  Saving model ...
Epoch: 14 cost time: 7.403709888458252
Epoch: 14, Steps: 13 | Train Loss: 0.771 Vali Loss: 1.176 Vali Acc: 0.693 Test Loss: 1.176 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 7.772113561630249
Epoch: 15, Steps: 13 | Train Loss: 0.992 Vali Loss: 5.078 Vali Acc: 0.283 Test Loss: 5.078 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 7.023658275604248
Epoch: 16, Steps: 13 | Train Loss: 2.088 Vali Loss: 2.282 Vali Acc: 0.722 Test Loss: 2.282 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 7.347742557525635
Epoch: 17, Steps: 13 | Train Loss: 0.739 Vali Loss: 1.728 Vali Acc: 0.732 Test Loss: 1.728 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 6.760550022125244
Epoch: 18, Steps: 13 | Train Loss: 0.317 Vali Loss: 1.001 Vali Acc: 0.678 Test Loss: 1.001 Test Acc: 0.678
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 6.770437002182007
Epoch: 19, Steps: 13 | Train Loss: 0.363 Vali Loss: 1.149 Vali Acc: 0.741 Test Loss: 1.149 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 7.1919310092926025
Epoch: 20, Steps: 13 | Train Loss: 0.304 Vali Loss: 1.471 Vali Acc: 0.732 Test Loss: 1.471 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 7.632080554962158
Epoch: 21, Steps: 13 | Train Loss: 0.206 Vali Loss: 1.140 Vali Acc: 0.717 Test Loss: 1.140 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 7.2865893840789795
Epoch: 22, Steps: 13 | Train Loss: 0.172 Vali Loss: 1.720 Vali Acc: 0.688 Test Loss: 1.720 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 7.799701929092407
Epoch: 23, Steps: 13 | Train Loss: 0.524 Vali Loss: 3.042 Vali Acc: 0.732 Test Loss: 3.042 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 10818238
model size : 46.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 10.392238855361938
Epoch: 1, Steps: 13 | Train Loss: 0.702 Vali Loss: 0.883 Vali Acc: 0.722 Test Loss: 0.883 Test Acc: 0.722
Validation loss decreased (inf --> -0.721942).  Saving model ...
Epoch: 2 cost time: 7.6053736209869385
Epoch: 2, Steps: 13 | Train Loss: 0.667 Vali Loss: 0.574 Vali Acc: 0.737 Test Loss: 0.574 Test Acc: 0.737
Validation loss decreased (-0.721942 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 5.649501323699951
Epoch: 3, Steps: 13 | Train Loss: 0.622 Vali Loss: 0.551 Vali Acc: 0.737 Test Loss: 0.551 Test Acc: 0.737
Validation loss decreased (-0.736580 --> -0.736580).  Saving model ...
Epoch: 4 cost time: 5.198380708694458
Epoch: 4, Steps: 13 | Train Loss: 1.060 Vali Loss: 1.785 Vali Acc: 0.722 Test Loss: 1.785 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.9210124015808105
Epoch: 5, Steps: 13 | Train Loss: 2.022 Vali Loss: 1.612 Vali Acc: 0.722 Test Loss: 1.612 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.393753528594971
Epoch: 6, Steps: 13 | Train Loss: 1.004 Vali Loss: 0.526 Vali Acc: 0.727 Test Loss: 0.526 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.42703104019165
Epoch: 7, Steps: 13 | Train Loss: 0.700 Vali Loss: 0.877 Vali Acc: 0.429 Test Loss: 0.877 Test Acc: 0.429
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 7.283994674682617
Epoch: 8, Steps: 13 | Train Loss: 0.606 Vali Loss: 0.600 Vali Acc: 0.707 Test Loss: 0.600 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 7.4280171394348145
Epoch: 9, Steps: 13 | Train Loss: 0.973 Vali Loss: 0.573 Vali Acc: 0.683 Test Loss: 0.573 Test Acc: 0.683
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 7.932937145233154
Epoch: 10, Steps: 13 | Train Loss: 0.538 Vali Loss: 1.130 Vali Acc: 0.741 Test Loss: 1.130 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741452).  Saving model ...
Epoch: 11 cost time: 7.4717512130737305
Epoch: 11, Steps: 13 | Train Loss: 1.100 Vali Loss: 1.268 Vali Acc: 0.473 Test Loss: 1.268 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.491783857345581
Epoch: 12, Steps: 13 | Train Loss: 1.246 Vali Loss: 0.709 Vali Acc: 0.688 Test Loss: 0.709 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.886248826980591
Epoch: 13, Steps: 13 | Train Loss: 0.379 Vali Loss: 0.859 Vali Acc: 0.566 Test Loss: 0.859 Test Acc: 0.566
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.728783130645752
Epoch: 14, Steps: 13 | Train Loss: 0.323 Vali Loss: 1.711 Vali Acc: 0.463 Test Loss: 1.711 Test Acc: 0.463
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.955220699310303
Epoch: 15, Steps: 13 | Train Loss: 0.452 Vali Loss: 0.964 Vali Acc: 0.605 Test Loss: 0.964 Test Acc: 0.605
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 7.652052640914917
Epoch: 16, Steps: 13 | Train Loss: 0.813 Vali Loss: 2.665 Vali Acc: 0.444 Test Loss: 2.665 Test Acc: 0.444
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 5.916440486907959
Epoch: 17, Steps: 13 | Train Loss: 0.905 Vali Loss: 2.390 Vali Acc: 0.732 Test Loss: 2.390 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 7.815938234329224
Epoch: 18, Steps: 13 | Train Loss: 1.014 Vali Loss: 2.150 Vali Acc: 0.473 Test Loss: 2.150 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 6.651307106018066
Epoch: 19, Steps: 13 | Train Loss: 0.298 Vali Loss: 1.931 Vali Acc: 0.502 Test Loss: 1.931 Test Acc: 0.502
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 7.293955326080322
Epoch: 20, Steps: 13 | Train Loss: 0.329 Vali Loss: 3.499 Vali Acc: 0.429 Test Loss: 3.499 Test Acc: 0.429
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 5147838
model size : 22.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.99078631401062
Epoch: 1, Steps: 13 | Train Loss: 0.669 Vali Loss: 0.601 Vali Acc: 0.722 Test Loss: 0.601 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 6.89391565322876
Epoch: 2, Steps: 13 | Train Loss: 0.720 Vali Loss: 0.836 Vali Acc: 0.722 Test Loss: 0.836 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.306594371795654
Epoch: 3, Steps: 13 | Train Loss: 0.844 Vali Loss: 0.865 Vali Acc: 0.327 Test Loss: 0.865 Test Acc: 0.327
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.368223428726196
Epoch: 4, Steps: 13 | Train Loss: 0.730 Vali Loss: 0.607 Vali Acc: 0.741 Test Loss: 0.607 Test Acc: 0.741
Validation loss decreased (-0.721945 --> -0.741457).  Saving model ...
Epoch: 5 cost time: 6.716511487960815
Epoch: 5, Steps: 13 | Train Loss: 0.625 Vali Loss: 0.505 Vali Acc: 0.751 Test Loss: 0.505 Test Acc: 0.751
Validation loss decreased (-0.741457 --> -0.751214).  Saving model ...
Epoch: 6 cost time: 5.116343021392822
Epoch: 6, Steps: 13 | Train Loss: 0.532 Vali Loss: 0.619 Vali Acc: 0.644 Test Loss: 0.619 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.463909864425659
Epoch: 7, Steps: 13 | Train Loss: 0.709 Vali Loss: 1.001 Vali Acc: 0.488 Test Loss: 1.001 Test Acc: 0.488
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.471217393875122
Epoch: 8, Steps: 13 | Train Loss: 0.418 Vali Loss: 1.128 Vali Acc: 0.727 Test Loss: 1.128 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.840193748474121
Epoch: 9, Steps: 13 | Train Loss: 0.923 Vali Loss: 1.286 Vali Acc: 0.380 Test Loss: 1.286 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.994857549667358
Epoch: 10, Steps: 13 | Train Loss: 0.427 Vali Loss: 1.381 Vali Acc: 0.356 Test Loss: 1.381 Test Acc: 0.356
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 6.797652244567871
Epoch: 11, Steps: 13 | Train Loss: 1.376 Vali Loss: 0.934 Vali Acc: 0.722 Test Loss: 0.934 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 7.3677544593811035
Epoch: 12, Steps: 13 | Train Loss: 1.016 Vali Loss: 1.435 Vali Acc: 0.722 Test Loss: 1.435 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 6.6177918910980225
Epoch: 13, Steps: 13 | Train Loss: 0.720 Vali Loss: 2.297 Vali Acc: 0.410 Test Loss: 2.297 Test Acc: 0.410
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 5.491303205490112
Epoch: 14, Steps: 13 | Train Loss: 0.513 Vali Loss: 0.769 Vali Acc: 0.732 Test Loss: 0.769 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 6.038190841674805
Epoch: 15, Steps: 13 | Train Loss: 0.345 Vali Loss: 1.406 Vali Acc: 0.746 Test Loss: 1.406 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 5139518
model size : 22.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 9.617000341415405
Epoch: 1, Steps: 13 | Train Loss: 0.675 Vali Loss: 0.578 Vali Acc: 0.722 Test Loss: 0.578 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 7.154263973236084
Epoch: 2, Steps: 13 | Train Loss: 0.553 Vali Loss: 0.554 Vali Acc: 0.737 Test Loss: 0.554 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 7.78905725479126
Epoch: 3, Steps: 13 | Train Loss: 0.805 Vali Loss: 0.533 Vali Acc: 0.732 Test Loss: 0.533 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.972252368927002
Epoch: 4, Steps: 13 | Train Loss: 0.791 Vali Loss: 0.526 Vali Acc: 0.737 Test Loss: 0.526 Test Acc: 0.737
Validation loss decreased (-0.736580 --> -0.736580).  Saving model ...
Epoch: 5 cost time: 7.513118267059326
Epoch: 5, Steps: 13 | Train Loss: 0.789 Vali Loss: 0.831 Vali Acc: 0.722 Test Loss: 0.831 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.909367561340332
Epoch: 6, Steps: 13 | Train Loss: 0.796 Vali Loss: 0.772 Vali Acc: 0.727 Test Loss: 0.772 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.650174379348755
Epoch: 7, Steps: 13 | Train Loss: 0.947 Vali Loss: 1.763 Vali Acc: 0.356 Test Loss: 1.763 Test Acc: 0.356
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.051266431808472
Epoch: 8, Steps: 13 | Train Loss: 0.684 Vali Loss: 0.616 Vali Acc: 0.756 Test Loss: 0.616 Test Acc: 0.756
Validation loss decreased (-0.736580 --> -0.756091).  Saving model ...
Epoch: 9 cost time: 6.06586217880249
Epoch: 9, Steps: 13 | Train Loss: 0.593 Vali Loss: 0.552 Vali Acc: 0.732 Test Loss: 0.552 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.7293267250061035
Epoch: 10, Steps: 13 | Train Loss: 0.601 Vali Loss: 0.767 Vali Acc: 0.737 Test Loss: 0.767 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.456568956375122
Epoch: 11, Steps: 13 | Train Loss: 0.378 Vali Loss: 0.965 Vali Acc: 0.566 Test Loss: 0.965 Test Acc: 0.566
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.600217580795288
Epoch: 12, Steps: 13 | Train Loss: 0.552 Vali Loss: 0.799 Vali Acc: 0.644 Test Loss: 0.799 Test Acc: 0.644
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.776075124740601
Epoch: 13, Steps: 13 | Train Loss: 0.362 Vali Loss: 1.074 Vali Acc: 0.766 Test Loss: 1.074 Test Acc: 0.766
Validation loss decreased (-0.756091 --> -0.765843).  Saving model ...
Epoch: 14 cost time: 7.5335609912872314
Epoch: 14, Steps: 13 | Train Loss: 0.728 Vali Loss: 0.801 Vali Acc: 0.702 Test Loss: 0.801 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.224954843521118
Epoch: 15, Steps: 13 | Train Loss: 0.243 Vali Loss: 1.413 Vali Acc: 0.527 Test Loss: 1.413 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 7.344175100326538
Epoch: 16, Steps: 13 | Train Loss: 0.277 Vali Loss: 1.527 Vali Acc: 0.732 Test Loss: 1.527 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 7.5673017501831055
Epoch: 17, Steps: 13 | Train Loss: 0.501 Vali Loss: 1.308 Vali Acc: 0.707 Test Loss: 1.308 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 7.625260591506958
Epoch: 18, Steps: 13 | Train Loss: 0.730 Vali Loss: 1.456 Vali Acc: 0.668 Test Loss: 1.456 Test Acc: 0.668
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 7.30263352394104
Epoch: 19, Steps: 13 | Train Loss: 0.613 Vali Loss: 1.928 Vali Acc: 0.517 Test Loss: 1.928 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 8.126240015029907
Epoch: 20, Steps: 13 | Train Loss: 1.253 Vali Loss: 2.243 Vali Acc: 0.727 Test Loss: 2.243 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 7.1523072719573975
Epoch: 21, Steps: 13 | Train Loss: 0.353 Vali Loss: 1.898 Vali Acc: 0.737 Test Loss: 1.898 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 6.878389835357666
Epoch: 22, Steps: 13 | Train Loss: 0.547 Vali Loss: 3.410 Vali Acc: 0.449 Test Loss: 3.410 Test Acc: 0.449
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 7.429516553878784
Epoch: 23, Steps: 13 | Train Loss: 0.366 Vali Loss: 1.852 Vali Acc: 0.732 Test Loss: 1.852 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 5131198
model size : 22.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 9.432594299316406
Epoch: 1, Steps: 13 | Train Loss: 0.781 Vali Loss: 0.627 Vali Acc: 0.722 Test Loss: 0.627 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 6.641647577285767
Epoch: 2, Steps: 13 | Train Loss: 0.735 Vali Loss: 0.694 Vali Acc: 0.712 Test Loss: 0.694 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.323013782501221
Epoch: 3, Steps: 13 | Train Loss: 0.679 Vali Loss: 1.252 Vali Acc: 0.278 Test Loss: 1.252 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.433731555938721
Epoch: 4, Steps: 13 | Train Loss: 0.659 Vali Loss: 0.859 Vali Acc: 0.722 Test Loss: 0.859 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.797086000442505
Epoch: 5, Steps: 13 | Train Loss: 0.552 Vali Loss: 1.012 Vali Acc: 0.459 Test Loss: 1.012 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.533861398696899
Epoch: 6, Steps: 13 | Train Loss: 0.549 Vali Loss: 0.567 Vali Acc: 0.654 Test Loss: 0.567 Test Acc: 0.654
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.473333835601807
Epoch: 7, Steps: 13 | Train Loss: 0.635 Vali Loss: 0.614 Vali Acc: 0.756 Test Loss: 0.614 Test Acc: 0.756
Validation loss decreased (-0.721945 --> -0.756091).  Saving model ...
Epoch: 8 cost time: 6.694498062133789
Epoch: 8, Steps: 13 | Train Loss: 1.230 Vali Loss: 1.014 Vali Acc: 0.746 Test Loss: 1.014 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.081585168838501
Epoch: 9, Steps: 13 | Train Loss: 0.468 Vali Loss: 1.055 Vali Acc: 0.727 Test Loss: 1.055 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 7.078390836715698
Epoch: 10, Steps: 13 | Train Loss: 0.965 Vali Loss: 4.067 Vali Acc: 0.278 Test Loss: 4.067 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.4184253215789795
Epoch: 11, Steps: 13 | Train Loss: 1.001 Vali Loss: 1.144 Vali Acc: 0.746 Test Loss: 1.144 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.95634913444519
Epoch: 12, Steps: 13 | Train Loss: 0.717 Vali Loss: 1.270 Vali Acc: 0.751 Test Loss: 1.270 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.418458938598633
Epoch: 13, Steps: 13 | Train Loss: 1.579 Vali Loss: 2.944 Vali Acc: 0.722 Test Loss: 2.944 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.673602819442749
Epoch: 14, Steps: 13 | Train Loss: 0.956 Vali Loss: 0.696 Vali Acc: 0.746 Test Loss: 0.696 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 6.77167534828186
Epoch: 15, Steps: 13 | Train Loss: 0.789 Vali Loss: 3.953 Vali Acc: 0.278 Test Loss: 3.953 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.980332612991333
Epoch: 16, Steps: 13 | Train Loss: 1.102 Vali Loss: 3.755 Vali Acc: 0.717 Test Loss: 3.755 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.775416374206543
Epoch: 17, Steps: 13 | Train Loss: 0.968 Vali Loss: 0.995 Vali Acc: 0.683 Test Loss: 0.995 Test Acc: 0.683
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 5122878
model size : 22.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 9.394200801849365
Epoch: 1, Steps: 13 | Train Loss: 0.731 Vali Loss: 0.854 Vali Acc: 0.722 Test Loss: 0.854 Test Acc: 0.722
Validation loss decreased (inf --> -0.721943).  Saving model ...
Epoch: 2 cost time: 6.178513050079346
Epoch: 2, Steps: 13 | Train Loss: 0.655 Vali Loss: 0.857 Vali Acc: 0.717 Test Loss: 0.857 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.676538467407227
Epoch: 3, Steps: 13 | Train Loss: 0.767 Vali Loss: 2.029 Vali Acc: 0.283 Test Loss: 2.029 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.914839744567871
Epoch: 4, Steps: 13 | Train Loss: 1.053 Vali Loss: 0.516 Vali Acc: 0.780 Test Loss: 0.516 Test Acc: 0.780
Validation loss decreased (-0.721943 --> -0.780483).  Saving model ...
Epoch: 5 cost time: 7.600287675857544
Epoch: 5, Steps: 13 | Train Loss: 0.724 Vali Loss: 0.719 Vali Acc: 0.605 Test Loss: 0.719 Test Acc: 0.605
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.350164413452148
Epoch: 6, Steps: 13 | Train Loss: 0.903 Vali Loss: 1.024 Vali Acc: 0.732 Test Loss: 1.024 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.039535045623779
Epoch: 7, Steps: 13 | Train Loss: 0.552 Vali Loss: 0.652 Vali Acc: 0.737 Test Loss: 0.652 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 7.342606544494629
Epoch: 8, Steps: 13 | Train Loss: 0.462 Vali Loss: 0.527 Vali Acc: 0.751 Test Loss: 0.527 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.63236141204834
Epoch: 9, Steps: 13 | Train Loss: 0.549 Vali Loss: 1.280 Vali Acc: 0.405 Test Loss: 1.280 Test Acc: 0.405
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 7.2324323654174805
Epoch: 10, Steps: 13 | Train Loss: 0.539 Vali Loss: 0.715 Vali Acc: 0.659 Test Loss: 0.715 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 6.1036155223846436
Epoch: 11, Steps: 13 | Train Loss: 0.437 Vali Loss: 0.789 Vali Acc: 0.624 Test Loss: 0.789 Test Acc: 0.624
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 6.433529376983643
Epoch: 12, Steps: 13 | Train Loss: 0.687 Vali Loss: 1.659 Vali Acc: 0.444 Test Loss: 1.659 Test Acc: 0.444
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 7.26628565788269
Epoch: 13, Steps: 13 | Train Loss: 0.389 Vali Loss: 0.993 Vali Acc: 0.746 Test Loss: 0.993 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 6.965574026107788
Epoch: 14, Steps: 13 | Train Loss: 0.340 Vali Loss: 0.796 Vali Acc: 0.732 Test Loss: 0.796 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7804878048780488
model parameter : 3963582
model size : 17.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 10.51099181175232
Epoch: 1, Steps: 13 | Train Loss: 0.605 Vali Loss: 0.575 Vali Acc: 0.722 Test Loss: 0.575 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 6.345124244689941
Epoch: 2, Steps: 13 | Train Loss: 0.635 Vali Loss: 0.558 Vali Acc: 0.751 Test Loss: 0.558 Test Acc: 0.751
Validation loss decreased (-0.721945 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 6.30698561668396
Epoch: 3, Steps: 13 | Train Loss: 0.602 Vali Loss: 0.692 Vali Acc: 0.576 Test Loss: 0.692 Test Acc: 0.576
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.59182333946228
Epoch: 4, Steps: 13 | Train Loss: 0.568 Vali Loss: 0.618 Vali Acc: 0.659 Test Loss: 0.618 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.493346929550171
Epoch: 5, Steps: 13 | Train Loss: 0.530 Vali Loss: 1.077 Vali Acc: 0.722 Test Loss: 1.077 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 7.01810097694397
Epoch: 6, Steps: 13 | Train Loss: 1.164 Vali Loss: 0.531 Vali Acc: 0.722 Test Loss: 0.531 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.964244604110718
Epoch: 7, Steps: 13 | Train Loss: 0.484 Vali Loss: 0.705 Vali Acc: 0.600 Test Loss: 0.705 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.99082350730896
Epoch: 8, Steps: 13 | Train Loss: 0.533 Vali Loss: 0.589 Vali Acc: 0.683 Test Loss: 0.589 Test Acc: 0.683
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 6.435076713562012
Epoch: 9, Steps: 13 | Train Loss: 0.539 Vali Loss: 1.091 Vali Acc: 0.727 Test Loss: 1.091 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.652637243270874
Epoch: 10, Steps: 13 | Train Loss: 0.494 Vali Loss: 0.915 Vali Acc: 0.551 Test Loss: 0.915 Test Acc: 0.551
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 6.573619842529297
Epoch: 11, Steps: 13 | Train Loss: 0.341 Vali Loss: 0.674 Vali Acc: 0.737 Test Loss: 0.674 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 6.365309238433838
Epoch: 12, Steps: 13 | Train Loss: 0.383 Vali Loss: 0.749 Vali Acc: 0.615 Test Loss: 0.749 Test Acc: 0.615
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 3955262
model size : 17.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.571405410766602
Epoch: 1, Steps: 13 | Train Loss: 0.645 Vali Loss: 0.584 Vali Acc: 0.712 Test Loss: 0.584 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 6.351147651672363
Epoch: 2, Steps: 13 | Train Loss: 0.617 Vali Loss: 0.565 Vali Acc: 0.732 Test Loss: 0.565 Test Acc: 0.732
Validation loss decreased (-0.712189 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 5.942490100860596
Epoch: 3, Steps: 13 | Train Loss: 0.604 Vali Loss: 0.675 Vali Acc: 0.727 Test Loss: 0.675 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.10891318321228
Epoch: 4, Steps: 13 | Train Loss: 0.523 Vali Loss: 0.554 Vali Acc: 0.737 Test Loss: 0.554 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736580).  Saving model ...
Epoch: 5 cost time: 5.853483438491821
Epoch: 5, Steps: 13 | Train Loss: 0.746 Vali Loss: 1.036 Vali Acc: 0.371 Test Loss: 1.036 Test Acc: 0.371
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.569875001907349
Epoch: 6, Steps: 13 | Train Loss: 0.641 Vali Loss: 0.525 Vali Acc: 0.722 Test Loss: 0.525 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.351250648498535
Epoch: 7, Steps: 13 | Train Loss: 0.550 Vali Loss: 1.569 Vali Acc: 0.327 Test Loss: 1.569 Test Acc: 0.327
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.871169090270996
Epoch: 8, Steps: 13 | Train Loss: 0.946 Vali Loss: 0.848 Vali Acc: 0.732 Test Loss: 0.848 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.7586753368377686
Epoch: 9, Steps: 13 | Train Loss: 0.413 Vali Loss: 0.932 Vali Acc: 0.532 Test Loss: 0.932 Test Acc: 0.532
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 7.101210594177246
Epoch: 10, Steps: 13 | Train Loss: 0.449 Vali Loss: 1.438 Vali Acc: 0.722 Test Loss: 1.438 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.834526777267456
Epoch: 11, Steps: 13 | Train Loss: 1.260 Vali Loss: 4.369 Vali Acc: 0.317 Test Loss: 4.369 Test Acc: 0.317
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 6.267057180404663
Epoch: 12, Steps: 13 | Train Loss: 1.237 Vali Loss: 1.262 Vali Acc: 0.737 Test Loss: 1.262 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 6.177771806716919
Epoch: 13, Steps: 13 | Train Loss: 1.592 Vali Loss: 3.269 Vali Acc: 0.385 Test Loss: 3.269 Test Acc: 0.385
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 6.445036172866821
Epoch: 14, Steps: 13 | Train Loss: 1.779 Vali Loss: 2.150 Vali Acc: 0.727 Test Loss: 2.150 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 3946942
model size : 17.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.594752073287964
Epoch: 1, Steps: 13 | Train Loss: 0.629 Vali Loss: 0.795 Vali Acc: 0.278 Test Loss: 0.795 Test Acc: 0.278
Validation loss decreased (inf --> -0.278041).  Saving model ...
Epoch: 2 cost time: 6.460553407669067
Epoch: 2, Steps: 13 | Train Loss: 0.613 Vali Loss: 1.254 Vali Acc: 0.717 Test Loss: 1.254 Test Acc: 0.717
Validation loss decreased (-0.278041 --> -0.717061).  Saving model ...
Epoch: 3 cost time: 5.723594427108765
Epoch: 3, Steps: 13 | Train Loss: 1.323 Vali Loss: 1.086 Vali Acc: 0.722 Test Loss: 1.086 Test Acc: 0.722
Validation loss decreased (-0.717061 --> -0.721940).  Saving model ...
Epoch: 4 cost time: 6.056380987167358
Epoch: 4, Steps: 13 | Train Loss: 1.053 Vali Loss: 0.539 Vali Acc: 0.732 Test Loss: 0.539 Test Acc: 0.732
Validation loss decreased (-0.721940 --> -0.731702).  Saving model ...
Epoch: 5 cost time: 6.406291723251343
Epoch: 5, Steps: 13 | Train Loss: 1.176 Vali Loss: 0.520 Vali Acc: 0.746 Test Loss: 0.520 Test Acc: 0.746
Validation loss decreased (-0.731702 --> -0.746336).  Saving model ...
Epoch: 6 cost time: 6.256974697113037
Epoch: 6, Steps: 13 | Train Loss: 0.539 Vali Loss: 0.646 Vali Acc: 0.722 Test Loss: 0.646 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.669515609741211
Epoch: 7, Steps: 13 | Train Loss: 0.551 Vali Loss: 0.806 Vali Acc: 0.722 Test Loss: 0.806 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.49507999420166
Epoch: 8, Steps: 13 | Train Loss: 0.549 Vali Loss: 0.650 Vali Acc: 0.732 Test Loss: 0.650 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.818099498748779
Epoch: 9, Steps: 13 | Train Loss: 0.462 Vali Loss: 1.114 Vali Acc: 0.395 Test Loss: 1.114 Test Acc: 0.395
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.720505237579346
Epoch: 10, Steps: 13 | Train Loss: 0.486 Vali Loss: 0.586 Vali Acc: 0.732 Test Loss: 0.586 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 6.458616733551025
Epoch: 11, Steps: 13 | Train Loss: 1.630 Vali Loss: 1.616 Vali Acc: 0.712 Test Loss: 1.616 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.988049745559692
Epoch: 12, Steps: 13 | Train Loss: 1.183 Vali Loss: 0.775 Vali Acc: 0.654 Test Loss: 0.775 Test Acc: 0.654
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 6.492238759994507
Epoch: 13, Steps: 13 | Train Loss: 0.253 Vali Loss: 0.616 Vali Acc: 0.683 Test Loss: 0.616 Test Acc: 0.683
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 6.447585105895996
Epoch: 14, Steps: 13 | Train Loss: 0.509 Vali Loss: 0.632 Vali Acc: 0.707 Test Loss: 0.632 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 6.049463510513306
Epoch: 15, Steps: 13 | Train Loss: 0.388 Vali Loss: 1.229 Vali Acc: 0.722 Test Loss: 1.229 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 3938622
model size : 17.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.982686281204224
Epoch: 1, Steps: 13 | Train Loss: 0.773 Vali Loss: 0.685 Vali Acc: 0.722 Test Loss: 0.685 Test Acc: 0.722
Validation loss decreased (inf --> -0.721944).  Saving model ...
Epoch: 2 cost time: 5.731188535690308
Epoch: 2, Steps: 13 | Train Loss: 1.103 Vali Loss: 1.009 Vali Acc: 0.722 Test Loss: 1.009 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.2443931102752686
Epoch: 3, Steps: 13 | Train Loss: 0.670 Vali Loss: 0.629 Vali Acc: 0.663 Test Loss: 0.629 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.91010856628418
Epoch: 4, Steps: 13 | Train Loss: 0.882 Vali Loss: 1.678 Vali Acc: 0.722 Test Loss: 1.678 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.341967344284058
Epoch: 5, Steps: 13 | Train Loss: 1.578 Vali Loss: 1.315 Vali Acc: 0.712 Test Loss: 1.315 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.023285150527954
Epoch: 6, Steps: 13 | Train Loss: 0.694 Vali Loss: 0.524 Vali Acc: 0.756 Test Loss: 0.524 Test Acc: 0.756
Validation loss decreased (-0.721944 --> -0.756092).  Saving model ...
Epoch: 7 cost time: 6.908276081085205
Epoch: 7, Steps: 13 | Train Loss: 0.496 Vali Loss: 1.342 Vali Acc: 0.312 Test Loss: 1.342 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.3075644969940186
Epoch: 8, Steps: 13 | Train Loss: 0.902 Vali Loss: 0.545 Vali Acc: 0.712 Test Loss: 0.545 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.924773216247559
Epoch: 9, Steps: 13 | Train Loss: 0.376 Vali Loss: 0.572 Vali Acc: 0.761 Test Loss: 0.572 Test Acc: 0.761
Validation loss decreased (-0.756092 --> -0.760970).  Saving model ...
Epoch: 10 cost time: 8.001578569412231
Epoch: 10, Steps: 13 | Train Loss: 0.655 Vali Loss: 1.649 Vali Acc: 0.727 Test Loss: 1.649 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 7.12528133392334
Epoch: 11, Steps: 13 | Train Loss: 0.957 Vali Loss: 0.606 Vali Acc: 0.737 Test Loss: 0.606 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.219740629196167
Epoch: 12, Steps: 13 | Train Loss: 0.642 Vali Loss: 1.453 Vali Acc: 0.410 Test Loss: 1.453 Test Acc: 0.410
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.766605854034424
Epoch: 13, Steps: 13 | Train Loss: 0.444 Vali Loss: 0.629 Vali Acc: 0.693 Test Loss: 0.629 Test Acc: 0.693
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.576825857162476
Epoch: 14, Steps: 13 | Train Loss: 0.355 Vali Loss: 1.021 Vali Acc: 0.732 Test Loss: 1.021 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 6.538088321685791
Epoch: 15, Steps: 13 | Train Loss: 0.451 Vali Loss: 1.326 Vali Acc: 0.507 Test Loss: 1.326 Test Acc: 0.507
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.063841819763184
Epoch: 16, Steps: 13 | Train Loss: 0.488 Vali Loss: 0.838 Vali Acc: 0.668 Test Loss: 0.838 Test Acc: 0.668
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.446205377578735
Epoch: 17, Steps: 13 | Train Loss: 0.396 Vali Loss: 1.600 Vali Acc: 0.517 Test Loss: 1.600 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.624182939529419
Epoch: 18, Steps: 13 | Train Loss: 0.283 Vali Loss: 0.817 Vali Acc: 0.707 Test Loss: 0.817 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 5.83627986907959
Epoch: 19, Steps: 13 | Train Loss: 0.645 Vali Loss: 2.923 Vali Acc: 0.722 Test Loss: 2.923 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 3371454
model size : 15.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.193585395812988
Epoch: 1, Steps: 13 | Train Loss: 0.648 Vali Loss: 0.632 Vali Acc: 0.722 Test Loss: 0.632 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 5.553799390792847
Epoch: 2, Steps: 13 | Train Loss: 0.647 Vali Loss: 0.555 Vali Acc: 0.727 Test Loss: 0.555 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 6.500989198684692
Epoch: 3, Steps: 13 | Train Loss: 0.554 Vali Loss: 0.533 Vali Acc: 0.751 Test Loss: 0.533 Test Acc: 0.751
Validation loss decreased (-0.726824 --> -0.751214).  Saving model ...
Epoch: 4 cost time: 5.939325332641602
Epoch: 4, Steps: 13 | Train Loss: 0.538 Vali Loss: 0.521 Vali Acc: 0.732 Test Loss: 0.521 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.118314266204834
Epoch: 5, Steps: 13 | Train Loss: 0.534 Vali Loss: 0.930 Vali Acc: 0.717 Test Loss: 0.930 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.791687250137329
Epoch: 6, Steps: 13 | Train Loss: 0.545 Vali Loss: 0.649 Vali Acc: 0.737 Test Loss: 0.649 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.005932807922363
Epoch: 7, Steps: 13 | Train Loss: 0.474 Vali Loss: 0.832 Vali Acc: 0.737 Test Loss: 0.832 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.059341907501221
Epoch: 8, Steps: 13 | Train Loss: 0.515 Vali Loss: 0.824 Vali Acc: 0.737 Test Loss: 0.824 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.557717561721802
Epoch: 9, Steps: 13 | Train Loss: 0.331 Vali Loss: 0.966 Vali Acc: 0.498 Test Loss: 0.966 Test Acc: 0.498
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.3530638217926025
Epoch: 10, Steps: 13 | Train Loss: 0.436 Vali Loss: 1.044 Vali Acc: 0.727 Test Loss: 1.044 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 6.226022005081177
Epoch: 11, Steps: 13 | Train Loss: 0.453 Vali Loss: 0.709 Vali Acc: 0.644 Test Loss: 0.709 Test Acc: 0.644
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 6.122285604476929
Epoch: 12, Steps: 13 | Train Loss: 0.431 Vali Loss: 0.703 Vali Acc: 0.634 Test Loss: 0.703 Test Acc: 0.634
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.335815191268921
Epoch: 13, Steps: 13 | Train Loss: 1.170 Vali Loss: 2.147 Vali Acc: 0.337 Test Loss: 2.147 Test Acc: 0.337
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 3363134
model size : 15.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.840085744857788
Epoch: 1, Steps: 13 | Train Loss: 0.774 Vali Loss: 0.855 Vali Acc: 0.722 Test Loss: 0.855 Test Acc: 0.722
Validation loss decreased (inf --> -0.721943).  Saving model ...
Epoch: 2 cost time: 6.2653443813323975
Epoch: 2, Steps: 13 | Train Loss: 0.611 Vali Loss: 0.678 Vali Acc: 0.566 Test Loss: 0.678 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.206545114517212
Epoch: 3, Steps: 13 | Train Loss: 0.763 Vali Loss: 0.955 Vali Acc: 0.722 Test Loss: 0.955 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.587594032287598
Epoch: 4, Steps: 13 | Train Loss: 0.782 Vali Loss: 0.626 Vali Acc: 0.663 Test Loss: 0.626 Test Acc: 0.663
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.541322469711304
Epoch: 5, Steps: 13 | Train Loss: 0.744 Vali Loss: 0.531 Vali Acc: 0.741 Test Loss: 0.531 Test Acc: 0.741
Validation loss decreased (-0.721943 --> -0.741458).  Saving model ...
Epoch: 6 cost time: 6.804957628250122
Epoch: 6, Steps: 13 | Train Loss: 0.720 Vali Loss: 0.588 Vali Acc: 0.698 Test Loss: 0.588 Test Acc: 0.698
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.797385931015015
Epoch: 7, Steps: 13 | Train Loss: 0.515 Vali Loss: 0.670 Vali Acc: 0.732 Test Loss: 0.670 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 7.0479724407196045
Epoch: 8, Steps: 13 | Train Loss: 0.405 Vali Loss: 0.576 Vali Acc: 0.737 Test Loss: 0.576 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.165316581726074
Epoch: 9, Steps: 13 | Train Loss: 0.438 Vali Loss: 0.708 Vali Acc: 0.600 Test Loss: 0.708 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.31122899055481
Epoch: 10, Steps: 13 | Train Loss: 0.787 Vali Loss: 0.693 Vali Acc: 0.634 Test Loss: 0.693 Test Acc: 0.634
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 6.283472776412964
Epoch: 11, Steps: 13 | Train Loss: 0.473 Vali Loss: 0.599 Vali Acc: 0.722 Test Loss: 0.599 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 6.282847166061401
Epoch: 12, Steps: 13 | Train Loss: 0.561 Vali Loss: 1.276 Vali Acc: 0.727 Test Loss: 1.276 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 6.165964841842651
Epoch: 13, Steps: 13 | Train Loss: 0.449 Vali Loss: 0.660 Vali Acc: 0.693 Test Loss: 0.660 Test Acc: 0.693
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 6.75408411026001
Epoch: 14, Steps: 13 | Train Loss: 0.991 Vali Loss: 0.785 Vali Acc: 0.732 Test Loss: 0.785 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 5.531414031982422
Epoch: 15, Steps: 13 | Train Loss: 0.178 Vali Loss: 1.437 Vali Acc: 0.737 Test Loss: 1.437 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 3354814
model size : 15.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 9.566107988357544
Epoch: 1, Steps: 13 | Train Loss: 0.722 Vali Loss: 0.749 Vali Acc: 0.717 Test Loss: 0.749 Test Acc: 0.717
Validation loss decreased (inf --> -0.717066).  Saving model ...
Epoch: 2 cost time: 5.184214353561401
Epoch: 2, Steps: 13 | Train Loss: 0.895 Vali Loss: 1.569 Vali Acc: 0.722 Test Loss: 1.569 Test Acc: 0.722
Validation loss decreased (-0.717066 --> -0.721936).  Saving model ...
Epoch: 3 cost time: 5.430043697357178
Epoch: 3, Steps: 13 | Train Loss: 1.228 Vali Loss: 1.141 Vali Acc: 0.717 Test Loss: 1.141 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.530353784561157
Epoch: 4, Steps: 13 | Train Loss: 0.850 Vali Loss: 0.580 Vali Acc: 0.698 Test Loss: 0.580 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.492490768432617
Epoch: 5, Steps: 13 | Train Loss: 0.514 Vali Loss: 0.839 Vali Acc: 0.722 Test Loss: 0.839 Test Acc: 0.722
Validation loss decreased (-0.721936 --> -0.721943).  Saving model ...
Epoch: 6 cost time: 7.017016887664795
Epoch: 6, Steps: 13 | Train Loss: 0.816 Vali Loss: 0.526 Vali Acc: 0.761 Test Loss: 0.526 Test Acc: 0.761
Validation loss decreased (-0.721943 --> -0.760970).  Saving model ...
Epoch: 7 cost time: 6.199373960494995
Epoch: 7, Steps: 13 | Train Loss: 0.415 Vali Loss: 0.658 Vali Acc: 0.737 Test Loss: 0.658 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.73074197769165
Epoch: 8, Steps: 13 | Train Loss: 0.390 Vali Loss: 0.683 Vali Acc: 0.766 Test Loss: 0.683 Test Acc: 0.766
Validation loss decreased (-0.760970 --> -0.765847).  Saving model ...
Epoch: 9 cost time: 6.103576898574829
Epoch: 9, Steps: 13 | Train Loss: 0.432 Vali Loss: 0.564 Vali Acc: 0.732 Test Loss: 0.564 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.749581813812256
Epoch: 10, Steps: 13 | Train Loss: 0.379 Vali Loss: 0.837 Vali Acc: 0.571 Test Loss: 0.837 Test Acc: 0.571
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.005244731903076
Epoch: 11, Steps: 13 | Train Loss: 0.811 Vali Loss: 0.888 Vali Acc: 0.737 Test Loss: 0.888 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.377930641174316
Epoch: 12, Steps: 13 | Train Loss: 0.443 Vali Loss: 0.640 Vali Acc: 0.727 Test Loss: 0.640 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.130925416946411
Epoch: 13, Steps: 13 | Train Loss: 0.991 Vali Loss: 1.101 Vali Acc: 0.727 Test Loss: 1.101 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.424097776412964
Epoch: 14, Steps: 13 | Train Loss: 0.503 Vali Loss: 0.716 Vali Acc: 0.732 Test Loss: 0.716 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 6.312628746032715
Epoch: 15, Steps: 13 | Train Loss: 0.445 Vali Loss: 1.526 Vali Acc: 0.395 Test Loss: 1.526 Test Acc: 0.395
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 6.334770441055298
Epoch: 16, Steps: 13 | Train Loss: 0.227 Vali Loss: 2.159 Vali Acc: 0.463 Test Loss: 2.159 Test Acc: 0.463
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 6.199384927749634
Epoch: 17, Steps: 13 | Train Loss: 0.340 Vali Loss: 1.320 Vali Acc: 0.576 Test Loss: 1.320 Test Acc: 0.576
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 6.425879955291748
Epoch: 18, Steps: 13 | Train Loss: 0.440 Vali Loss: 2.632 Vali Acc: 0.346 Test Loss: 2.632 Test Acc: 0.346
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 3346494
model size : 15.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.842569589614868
Epoch: 1, Steps: 13 | Train Loss: 0.652 Vali Loss: 0.570 Vali Acc: 0.722 Test Loss: 0.570 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 6.863187789916992
Epoch: 2, Steps: 13 | Train Loss: 0.595 Vali Loss: 0.640 Vali Acc: 0.678 Test Loss: 0.640 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.941676378250122
Epoch: 3, Steps: 13 | Train Loss: 0.606 Vali Loss: 0.535 Vali Acc: 0.737 Test Loss: 0.535 Test Acc: 0.737
Validation loss decreased (-0.721946 --> -0.736580).  Saving model ...
Epoch: 4 cost time: 6.1141037940979
Epoch: 4, Steps: 13 | Train Loss: 0.715 Vali Loss: 0.911 Vali Acc: 0.727 Test Loss: 0.911 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.668994665145874
Epoch: 5, Steps: 13 | Train Loss: 0.655 Vali Loss: 0.593 Vali Acc: 0.698 Test Loss: 0.593 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.155355215072632
Epoch: 6, Steps: 13 | Train Loss: 0.529 Vali Loss: 0.623 Vali Acc: 0.688 Test Loss: 0.623 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.8670814037323
Epoch: 7, Steps: 13 | Train Loss: 0.474 Vali Loss: 0.540 Vali Acc: 0.741 Test Loss: 0.540 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741458).  Saving model ...
Epoch: 8 cost time: 5.6683454513549805
Epoch: 8, Steps: 13 | Train Loss: 0.586 Vali Loss: 0.577 Vali Acc: 0.727 Test Loss: 0.577 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.355405807495117
Epoch: 9, Steps: 13 | Train Loss: 0.621 Vali Loss: 1.013 Vali Acc: 0.727 Test Loss: 1.013 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.251023530960083
Epoch: 10, Steps: 13 | Train Loss: 0.382 Vali Loss: 0.906 Vali Acc: 0.737 Test Loss: 0.906 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.320584297180176
Epoch: 11, Steps: 13 | Train Loss: 0.529 Vali Loss: 1.869 Vali Acc: 0.337 Test Loss: 1.869 Test Acc: 0.337
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.175409317016602
Epoch: 12, Steps: 13 | Train Loss: 0.933 Vali Loss: 2.758 Vali Acc: 0.722 Test Loss: 2.758 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.700185537338257
Epoch: 13, Steps: 13 | Train Loss: 2.272 Vali Loss: 2.999 Vali Acc: 0.712 Test Loss: 2.999 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.8985748291015625
Epoch: 14, Steps: 13 | Train Loss: 2.473 Vali Loss: 0.993 Vali Acc: 0.737 Test Loss: 0.993 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 6.156111001968384
Epoch: 15, Steps: 13 | Train Loss: 0.667 Vali Loss: 0.720 Vali Acc: 0.698 Test Loss: 0.720 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 6.2099480628967285
Epoch: 16, Steps: 13 | Train Loss: 0.464 Vali Loss: 1.806 Vali Acc: 0.439 Test Loss: 1.806 Test Acc: 0.439
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.643011808395386
Epoch: 17, Steps: 13 | Train Loss: 0.737 Vali Loss: 2.336 Vali Acc: 0.727 Test Loss: 2.336 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 3075390
model size : 14.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.760404109954834
Epoch: 1, Steps: 13 | Train Loss: 0.639 Vali Loss: 0.710 Vali Acc: 0.361 Test Loss: 0.710 Test Acc: 0.361
Validation loss decreased (inf --> -0.360969).  Saving model ...
Epoch: 2 cost time: 6.3935019969940186
Epoch: 2, Steps: 13 | Train Loss: 0.759 Vali Loss: 0.566 Vali Acc: 0.732 Test Loss: 0.566 Test Acc: 0.732
Validation loss decreased (-0.360969 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 6.392468214035034
Epoch: 3, Steps: 13 | Train Loss: 0.598 Vali Loss: 0.643 Vali Acc: 0.722 Test Loss: 0.643 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.78819465637207
Epoch: 4, Steps: 13 | Train Loss: 0.614 Vali Loss: 0.629 Vali Acc: 0.732 Test Loss: 0.629 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.773852825164795
Epoch: 5, Steps: 13 | Train Loss: 0.520 Vali Loss: 0.738 Vali Acc: 0.722 Test Loss: 0.738 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.141999959945679
Epoch: 6, Steps: 13 | Train Loss: 0.507 Vali Loss: 0.613 Vali Acc: 0.746 Test Loss: 0.613 Test Acc: 0.746
Validation loss decreased (-0.731702 --> -0.746335).  Saving model ...
Epoch: 7 cost time: 6.847196102142334
Epoch: 7, Steps: 13 | Train Loss: 0.638 Vali Loss: 0.824 Vali Acc: 0.727 Test Loss: 0.824 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.141761302947998
Epoch: 8, Steps: 13 | Train Loss: 0.430 Vali Loss: 0.556 Vali Acc: 0.741 Test Loss: 0.556 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.5025434494018555
Epoch: 9, Steps: 13 | Train Loss: 0.407 Vali Loss: 0.723 Vali Acc: 0.741 Test Loss: 0.723 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.956188440322876
Epoch: 10, Steps: 13 | Train Loss: 0.358 Vali Loss: 1.089 Vali Acc: 0.737 Test Loss: 1.089 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.143400192260742
Epoch: 11, Steps: 13 | Train Loss: 0.528 Vali Loss: 0.710 Vali Acc: 0.746 Test Loss: 0.710 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.934269189834595
Epoch: 12, Steps: 13 | Train Loss: 0.351 Vali Loss: 0.766 Vali Acc: 0.732 Test Loss: 0.766 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 6.2962470054626465
Epoch: 13, Steps: 13 | Train Loss: 0.816 Vali Loss: 1.717 Vali Acc: 0.732 Test Loss: 1.717 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.487581729888916
Epoch: 14, Steps: 13 | Train Loss: 2.071 Vali Loss: 5.304 Vali Acc: 0.302 Test Loss: 5.304 Test Acc: 0.302
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 6.010569334030151
Epoch: 15, Steps: 13 | Train Loss: 1.721 Vali Loss: 2.559 Vali Acc: 0.722 Test Loss: 2.559 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.51477837562561
Epoch: 16, Steps: 13 | Train Loss: 0.867 Vali Loss: 1.946 Vali Acc: 0.732 Test Loss: 1.946 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 3067070
model size : 14.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 9.423200607299805
Epoch: 1, Steps: 13 | Train Loss: 0.646 Vali Loss: 0.598 Vali Acc: 0.717 Test Loss: 0.598 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 6.239252328872681
Epoch: 2, Steps: 13 | Train Loss: 0.737 Vali Loss: 0.620 Vali Acc: 0.712 Test Loss: 0.620 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.761038780212402
Epoch: 3, Steps: 13 | Train Loss: 0.927 Vali Loss: 0.963 Vali Acc: 0.712 Test Loss: 0.963 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.178612470626831
Epoch: 4, Steps: 13 | Train Loss: 0.608 Vali Loss: 0.612 Vali Acc: 0.737 Test Loss: 0.612 Test Acc: 0.737
Validation loss decreased (-0.717067 --> -0.736579).  Saving model ...
Epoch: 5 cost time: 5.803372144699097
Epoch: 5, Steps: 13 | Train Loss: 0.521 Vali Loss: 0.568 Vali Acc: 0.746 Test Loss: 0.568 Test Acc: 0.746
Validation loss decreased (-0.736579 --> -0.746336).  Saving model ...
Epoch: 6 cost time: 5.249094247817993
Epoch: 6, Steps: 13 | Train Loss: 1.087 Vali Loss: 2.143 Vali Acc: 0.302 Test Loss: 2.143 Test Acc: 0.302
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.032386779785156
Epoch: 7, Steps: 13 | Train Loss: 1.461 Vali Loss: 0.963 Vali Acc: 0.727 Test Loss: 0.963 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.016874313354492
Epoch: 8, Steps: 13 | Train Loss: 0.639 Vali Loss: 0.829 Vali Acc: 0.741 Test Loss: 0.829 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.130724906921387
Epoch: 9, Steps: 13 | Train Loss: 0.735 Vali Loss: 1.064 Vali Acc: 0.454 Test Loss: 1.064 Test Acc: 0.454
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.790454864501953
Epoch: 10, Steps: 13 | Train Loss: 0.538 Vali Loss: 1.063 Vali Acc: 0.459 Test Loss: 1.063 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.393283843994141
Epoch: 11, Steps: 13 | Train Loss: 0.763 Vali Loss: 1.698 Vali Acc: 0.727 Test Loss: 1.698 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.769814968109131
Epoch: 12, Steps: 13 | Train Loss: 0.875 Vali Loss: 0.761 Vali Acc: 0.668 Test Loss: 0.761 Test Acc: 0.668
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 6.3202080726623535
Epoch: 13, Steps: 13 | Train Loss: 0.487 Vali Loss: 0.638 Vali Acc: 0.727 Test Loss: 0.638 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 6.746323347091675
Epoch: 14, Steps: 13 | Train Loss: 0.262 Vali Loss: 0.887 Vali Acc: 0.722 Test Loss: 0.887 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 5.72576379776001
Epoch: 15, Steps: 13 | Train Loss: 0.418 Vali Loss: 1.140 Vali Acc: 0.737 Test Loss: 1.140 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 3058750
model size : 14.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.405737161636353
Epoch: 1, Steps: 13 | Train Loss: 0.658 Vali Loss: 0.965 Vali Acc: 0.712 Test Loss: 0.965 Test Acc: 0.712
Validation loss decreased (inf --> -0.712185).  Saving model ...
Epoch: 2 cost time: 6.047322750091553
Epoch: 2, Steps: 13 | Train Loss: 0.759 Vali Loss: 0.803 Vali Acc: 0.337 Test Loss: 0.803 Test Acc: 0.337
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.327226161956787
Epoch: 3, Steps: 13 | Train Loss: 0.742 Vali Loss: 0.533 Vali Acc: 0.746 Test Loss: 0.533 Test Acc: 0.746
Validation loss decreased (-0.712185 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 4.785020351409912
Epoch: 4, Steps: 13 | Train Loss: 0.659 Vali Loss: 0.711 Vali Acc: 0.727 Test Loss: 0.711 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.522143602371216
Epoch: 5, Steps: 13 | Train Loss: 0.714 Vali Loss: 1.559 Vali Acc: 0.722 Test Loss: 1.559 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.257775545120239
Epoch: 6, Steps: 13 | Train Loss: 1.192 Vali Loss: 0.551 Vali Acc: 0.668 Test Loss: 0.551 Test Acc: 0.668
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.529055833816528
Epoch: 7, Steps: 13 | Train Loss: 0.602 Vali Loss: 1.115 Vali Acc: 0.371 Test Loss: 1.115 Test Acc: 0.371
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.821300745010376
Epoch: 8, Steps: 13 | Train Loss: 0.421 Vali Loss: 0.551 Vali Acc: 0.683 Test Loss: 0.551 Test Acc: 0.683
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.296759605407715
Epoch: 9, Steps: 13 | Train Loss: 0.431 Vali Loss: 0.571 Vali Acc: 0.741 Test Loss: 0.571 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.429276943206787
Epoch: 10, Steps: 13 | Train Loss: 0.877 Vali Loss: 2.717 Vali Acc: 0.293 Test Loss: 2.717 Test Acc: 0.293
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.737378835678101
Epoch: 11, Steps: 13 | Train Loss: 2.185 Vali Loss: 1.282 Vali Acc: 0.424 Test Loss: 1.282 Test Acc: 0.424
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.682493209838867
Epoch: 12, Steps: 13 | Train Loss: 0.468 Vali Loss: 0.807 Vali Acc: 0.746 Test Loss: 0.807 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.202939987182617
Epoch: 13, Steps: 13 | Train Loss: 0.454 Vali Loss: 0.631 Vali Acc: 0.741 Test Loss: 0.631 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 3050430
model size : 14.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.947728157043457
Epoch: 1, Steps: 13 | Train Loss: 0.646 Vali Loss: 0.580 Vali Acc: 0.722 Test Loss: 0.580 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 6.1625823974609375
Epoch: 2, Steps: 13 | Train Loss: 0.719 Vali Loss: 0.573 Vali Acc: 0.722 Test Loss: 0.573 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 5.1983642578125
Epoch: 3, Steps: 13 | Train Loss: 0.756 Vali Loss: 0.711 Vali Acc: 0.722 Test Loss: 0.711 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.8202526569366455
Epoch: 4, Steps: 13 | Train Loss: 0.652 Vali Loss: 0.984 Vali Acc: 0.722 Test Loss: 0.984 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.927857160568237
Epoch: 5, Steps: 13 | Train Loss: 0.570 Vali Loss: 0.577 Vali Acc: 0.688 Test Loss: 0.577 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.529844760894775
Epoch: 6, Steps: 13 | Train Loss: 0.553 Vali Loss: 0.802 Vali Acc: 0.722 Test Loss: 0.802 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.218914031982422
Epoch: 7, Steps: 13 | Train Loss: 0.548 Vali Loss: 0.503 Vali Acc: 0.751 Test Loss: 0.503 Test Acc: 0.751
Validation loss decreased (-0.721945 --> -0.751214).  Saving model ...
Epoch: 8 cost time: 5.321412801742554
Epoch: 8, Steps: 13 | Train Loss: 0.906 Vali Loss: 0.769 Vali Acc: 0.746 Test Loss: 0.769 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.5825958251953125
Epoch: 9, Steps: 13 | Train Loss: 0.789 Vali Loss: 0.922 Vali Acc: 0.732 Test Loss: 0.922 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.833829641342163
Epoch: 10, Steps: 13 | Train Loss: 0.558 Vali Loss: 0.627 Vali Acc: 0.649 Test Loss: 0.627 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.436323881149292
Epoch: 11, Steps: 13 | Train Loss: 0.411 Vali Loss: 0.608 Vali Acc: 0.751 Test Loss: 0.608 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.382671117782593
Epoch: 12, Steps: 13 | Train Loss: 0.359 Vali Loss: 0.621 Vali Acc: 0.756 Test Loss: 0.621 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756091).  Saving model ...
Epoch: 13 cost time: 5.943808555603027
Epoch: 13, Steps: 13 | Train Loss: 0.321 Vali Loss: 1.312 Vali Acc: 0.727 Test Loss: 1.312 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.942706823348999
Epoch: 14, Steps: 13 | Train Loss: 0.406 Vali Loss: 1.208 Vali Acc: 0.493 Test Loss: 1.208 Test Acc: 0.493
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.039400815963745
Epoch: 15, Steps: 13 | Train Loss: 0.334 Vali Loss: 0.749 Vali Acc: 0.727 Test Loss: 0.749 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.451003313064575
Epoch: 16, Steps: 13 | Train Loss: 0.424 Vali Loss: 0.953 Vali Acc: 0.746 Test Loss: 0.953 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.8378355503082275
Epoch: 17, Steps: 13 | Train Loss: 0.674 Vali Loss: 2.922 Vali Acc: 0.332 Test Loss: 2.922 Test Acc: 0.332
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.487605333328247
Epoch: 18, Steps: 13 | Train Loss: 0.583 Vali Loss: 0.996 Vali Acc: 0.746 Test Loss: 0.996 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 6.058001279830933
Epoch: 19, Steps: 13 | Train Loss: 0.194 Vali Loss: 0.794 Vali Acc: 0.732 Test Loss: 0.794 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 5.335455417633057
Epoch: 20, Steps: 13 | Train Loss: 0.232 Vali Loss: 2.013 Vali Acc: 0.732 Test Loss: 2.013 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 5.84842324256897
Epoch: 21, Steps: 13 | Train Loss: 0.531 Vali Loss: 0.941 Vali Acc: 0.702 Test Loss: 0.941 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 6.052977085113525
Epoch: 22, Steps: 13 | Train Loss: 0.258 Vali Loss: 1.031 Vali Acc: 0.654 Test Loss: 1.031 Test Acc: 0.654
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 1988734
model size : 9.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.45196533203125
Epoch: 1, Steps: 13 | Train Loss: 0.651 Vali Loss: 0.584 Vali Acc: 0.722 Test Loss: 0.584 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 5.763593673706055
Epoch: 2, Steps: 13 | Train Loss: 0.631 Vali Loss: 0.578 Vali Acc: 0.722 Test Loss: 0.578 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 5.3624327182769775
Epoch: 3, Steps: 13 | Train Loss: 0.658 Vali Loss: 0.664 Vali Acc: 0.722 Test Loss: 0.664 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.322998523712158
Epoch: 4, Steps: 13 | Train Loss: 0.561 Vali Loss: 0.535 Vali Acc: 0.746 Test Loss: 0.535 Test Acc: 0.746
Validation loss decreased (-0.721945 --> -0.746336).  Saving model ...
Epoch: 5 cost time: 5.747863054275513
Epoch: 5, Steps: 13 | Train Loss: 0.561 Vali Loss: 0.528 Vali Acc: 0.737 Test Loss: 0.528 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.302661657333374
Epoch: 6, Steps: 13 | Train Loss: 0.551 Vali Loss: 0.602 Vali Acc: 0.654 Test Loss: 0.602 Test Acc: 0.654
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.505344867706299
Epoch: 7, Steps: 13 | Train Loss: 0.443 Vali Loss: 0.615 Vali Acc: 0.659 Test Loss: 0.615 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.442943572998047
Epoch: 8, Steps: 13 | Train Loss: 0.409 Vali Loss: 0.782 Vali Acc: 0.556 Test Loss: 0.782 Test Acc: 0.556
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.184325933456421
Epoch: 9, Steps: 13 | Train Loss: 0.501 Vali Loss: 0.560 Vali Acc: 0.732 Test Loss: 0.560 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.646093845367432
Epoch: 10, Steps: 13 | Train Loss: 0.368 Vali Loss: 0.891 Vali Acc: 0.732 Test Loss: 0.891 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 6.060763359069824
Epoch: 11, Steps: 13 | Train Loss: 0.300 Vali Loss: 0.865 Vali Acc: 0.741 Test Loss: 0.865 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.396032094955444
Epoch: 12, Steps: 13 | Train Loss: 0.403 Vali Loss: 0.793 Vali Acc: 0.737 Test Loss: 0.793 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 5.8392229080200195
Epoch: 13, Steps: 13 | Train Loss: 0.524 Vali Loss: 0.632 Vali Acc: 0.663 Test Loss: 0.632 Test Acc: 0.663
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 5.755711317062378
Epoch: 14, Steps: 13 | Train Loss: 0.265 Vali Loss: 0.760 Vali Acc: 0.751 Test Loss: 0.760 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751212).  Saving model ...
Epoch: 15 cost time: 4.98273777961731
Epoch: 15, Steps: 13 | Train Loss: 0.211 Vali Loss: 0.864 Vali Acc: 0.741 Test Loss: 0.864 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.267035722732544
Epoch: 16, Steps: 13 | Train Loss: 0.260 Vali Loss: 0.697 Vali Acc: 0.746 Test Loss: 0.697 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.0283708572387695
Epoch: 17, Steps: 13 | Train Loss: 0.992 Vali Loss: 1.445 Vali Acc: 0.727 Test Loss: 1.445 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.610010862350464
Epoch: 18, Steps: 13 | Train Loss: 0.342 Vali Loss: 2.726 Vali Acc: 0.395 Test Loss: 2.726 Test Acc: 0.395
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.638521194458008
Epoch: 19, Steps: 13 | Train Loss: 0.476 Vali Loss: 1.140 Vali Acc: 0.732 Test Loss: 1.140 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.670969247817993
Epoch: 20, Steps: 13 | Train Loss: 0.277 Vali Loss: 0.843 Vali Acc: 0.727 Test Loss: 0.843 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 5.758344650268555
Epoch: 21, Steps: 13 | Train Loss: 0.393 Vali Loss: 3.648 Vali Acc: 0.322 Test Loss: 3.648 Test Acc: 0.322
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 6.067630052566528
Epoch: 22, Steps: 13 | Train Loss: 0.801 Vali Loss: 1.604 Vali Acc: 0.746 Test Loss: 1.604 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.881732702255249
Epoch: 23, Steps: 13 | Train Loss: 0.327 Vali Loss: 1.271 Vali Acc: 0.741 Test Loss: 1.271 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 5.686568021774292
Epoch: 24, Steps: 13 | Train Loss: 0.118 Vali Loss: 0.944 Vali Acc: 0.722 Test Loss: 0.944 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 1984574
model size : 8.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.585270404815674
Epoch: 1, Steps: 13 | Train Loss: 0.626 Vali Loss: 0.607 Vali Acc: 0.722 Test Loss: 0.607 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 3.908198595046997
Epoch: 2, Steps: 13 | Train Loss: 0.668 Vali Loss: 1.393 Vali Acc: 0.278 Test Loss: 1.393 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.8042070865631104
Epoch: 3, Steps: 13 | Train Loss: 0.726 Vali Loss: 0.565 Vali Acc: 0.712 Test Loss: 0.565 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.146206378936768
Epoch: 4, Steps: 13 | Train Loss: 0.613 Vali Loss: 1.273 Vali Acc: 0.722 Test Loss: 1.273 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.02752161026001
Epoch: 5, Steps: 13 | Train Loss: 0.848 Vali Loss: 1.182 Vali Acc: 0.722 Test Loss: 1.182 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.920860528945923
Epoch: 6, Steps: 13 | Train Loss: 0.821 Vali Loss: 0.575 Vali Acc: 0.693 Test Loss: 0.575 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.681783199310303
Epoch: 7, Steps: 13 | Train Loss: 0.496 Vali Loss: 0.526 Vali Acc: 0.737 Test Loss: 0.526 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736580).  Saving model ...
Epoch: 8 cost time: 5.510369062423706
Epoch: 8, Steps: 13 | Train Loss: 0.400 Vali Loss: 0.566 Vali Acc: 0.737 Test Loss: 0.566 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.632583141326904
Epoch: 9, Steps: 13 | Train Loss: 0.429 Vali Loss: 0.605 Vali Acc: 0.683 Test Loss: 0.605 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.016663551330566
Epoch: 10, Steps: 13 | Train Loss: 0.951 Vali Loss: 1.293 Vali Acc: 0.722 Test Loss: 1.293 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.208580732345581
Epoch: 11, Steps: 13 | Train Loss: 0.627 Vali Loss: 2.171 Vali Acc: 0.346 Test Loss: 2.171 Test Acc: 0.346
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.809529066085815
Epoch: 12, Steps: 13 | Train Loss: 0.809 Vali Loss: 0.865 Vali Acc: 0.732 Test Loss: 0.865 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.722872495651245
Epoch: 13, Steps: 13 | Train Loss: 0.483 Vali Loss: 0.856 Vali Acc: 0.566 Test Loss: 0.856 Test Acc: 0.566
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.507675409317017
Epoch: 14, Steps: 13 | Train Loss: 0.320 Vali Loss: 1.113 Vali Acc: 0.727 Test Loss: 1.113 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.637251138687134
Epoch: 15, Steps: 13 | Train Loss: 0.517 Vali Loss: 0.679 Vali Acc: 0.673 Test Loss: 0.679 Test Acc: 0.673
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.121030807495117
Epoch: 16, Steps: 13 | Train Loss: 0.394 Vali Loss: 0.710 Vali Acc: 0.737 Test Loss: 0.710 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.606845140457153
Epoch: 17, Steps: 13 | Train Loss: 0.322 Vali Loss: 0.710 Vali Acc: 0.707 Test Loss: 0.710 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 1980414
model size : 8.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.108358383178711
Epoch: 1, Steps: 13 | Train Loss: 0.729 Vali Loss: 0.592 Vali Acc: 0.712 Test Loss: 0.592 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 5.300952672958374
Epoch: 2, Steps: 13 | Train Loss: 0.666 Vali Loss: 0.991 Vali Acc: 0.717 Test Loss: 0.991 Test Acc: 0.717
Validation loss decreased (-0.712189 --> -0.717063).  Saving model ...
Epoch: 3 cost time: 5.5306031703948975
Epoch: 3, Steps: 13 | Train Loss: 0.783 Vali Loss: 0.739 Vali Acc: 0.722 Test Loss: 0.739 Test Acc: 0.722
Validation loss decreased (-0.717063 --> -0.721944).  Saving model ...
Epoch: 4 cost time: 5.011914014816284
Epoch: 4, Steps: 13 | Train Loss: 0.692 Vali Loss: 0.674 Vali Acc: 0.722 Test Loss: 0.674 Test Acc: 0.722
Validation loss decreased (-0.721944 --> -0.721944).  Saving model ...
Epoch: 5 cost time: 5.373323917388916
Epoch: 5, Steps: 13 | Train Loss: 0.530 Vali Loss: 0.523 Vali Acc: 0.727 Test Loss: 0.523 Test Acc: 0.727
Validation loss decreased (-0.721944 --> -0.726824).  Saving model ...
Epoch: 6 cost time: 5.294351100921631
Epoch: 6, Steps: 13 | Train Loss: 0.524 Vali Loss: 0.569 Vali Acc: 0.707 Test Loss: 0.569 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.8621931076049805
Epoch: 7, Steps: 13 | Train Loss: 0.599 Vali Loss: 0.540 Vali Acc: 0.732 Test Loss: 0.540 Test Acc: 0.732
Validation loss decreased (-0.726824 --> -0.731702).  Saving model ...
Epoch: 8 cost time: 4.745760679244995
Epoch: 8, Steps: 13 | Train Loss: 0.758 Vali Loss: 2.496 Vali Acc: 0.307 Test Loss: 2.496 Test Acc: 0.307
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.35829758644104
Epoch: 9, Steps: 13 | Train Loss: 1.135 Vali Loss: 0.691 Vali Acc: 0.732 Test Loss: 0.691 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.689820289611816
Epoch: 10, Steps: 13 | Train Loss: 0.442 Vali Loss: 0.656 Vali Acc: 0.727 Test Loss: 0.656 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.897587299346924
Epoch: 11, Steps: 13 | Train Loss: 0.457 Vali Loss: 0.602 Vali Acc: 0.722 Test Loss: 0.602 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.827744245529175
Epoch: 12, Steps: 13 | Train Loss: 0.400 Vali Loss: 0.919 Vali Acc: 0.727 Test Loss: 0.919 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.940821409225464
Epoch: 13, Steps: 13 | Train Loss: 0.429 Vali Loss: 0.628 Vali Acc: 0.732 Test Loss: 0.628 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.227888822555542
Epoch: 14, Steps: 13 | Train Loss: 0.381 Vali Loss: 0.722 Vali Acc: 0.737 Test Loss: 0.722 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736578).  Saving model ...
Epoch: 15 cost time: 6.22403883934021
Epoch: 15, Steps: 13 | Train Loss: 0.334 Vali Loss: 1.037 Vali Acc: 0.537 Test Loss: 1.037 Test Acc: 0.537
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.072218418121338
Epoch: 16, Steps: 13 | Train Loss: 0.485 Vali Loss: 0.618 Vali Acc: 0.712 Test Loss: 0.618 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.02410364151001
Epoch: 17, Steps: 13 | Train Loss: 0.358 Vali Loss: 0.761 Vali Acc: 0.741 Test Loss: 0.761 Test Acc: 0.741
Validation loss decreased (-0.736578 --> -0.741456).  Saving model ...
Epoch: 18 cost time: 4.716299295425415
Epoch: 18, Steps: 13 | Train Loss: 0.351 Vali Loss: 0.638 Vali Acc: 0.707 Test Loss: 0.638 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.86339259147644
Epoch: 19, Steps: 13 | Train Loss: 0.160 Vali Loss: 0.716 Vali Acc: 0.722 Test Loss: 0.716 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.347524166107178
Epoch: 20, Steps: 13 | Train Loss: 0.475 Vali Loss: 2.798 Vali Acc: 0.385 Test Loss: 2.798 Test Acc: 0.385
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.451876163482666
Epoch: 21, Steps: 13 | Train Loss: 0.573 Vali Loss: 1.343 Vali Acc: 0.751 Test Loss: 1.343 Test Acc: 0.751
Validation loss decreased (-0.741456 --> -0.751206).  Saving model ...
Epoch: 22 cost time: 5.110328197479248
Epoch: 22, Steps: 13 | Train Loss: 0.146 Vali Loss: 1.052 Vali Acc: 0.580 Test Loss: 1.052 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.317445755004883
Epoch: 23, Steps: 13 | Train Loss: 0.321 Vali Loss: 1.218 Vali Acc: 0.746 Test Loss: 1.218 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 5.391841411590576
Epoch: 24, Steps: 13 | Train Loss: 0.158 Vali Loss: 0.906 Vali Acc: 0.639 Test Loss: 0.906 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 4.885956048965454
Epoch: 25, Steps: 13 | Train Loss: 0.259 Vali Loss: 1.303 Vali Acc: 0.746 Test Loss: 1.303 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 4.653738975524902
Epoch: 26, Steps: 13 | Train Loss: 0.426 Vali Loss: 1.179 Vali Acc: 0.610 Test Loss: 1.179 Test Acc: 0.610
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 5.154125213623047
Epoch: 27, Steps: 13 | Train Loss: 0.081 Vali Loss: 0.900 Vali Acc: 0.698 Test Loss: 0.900 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 5.037024021148682
Epoch: 28, Steps: 13 | Train Loss: 0.172 Vali Loss: 1.739 Vali Acc: 0.732 Test Loss: 1.739 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 4.591174840927124
Epoch: 29, Steps: 13 | Train Loss: 0.205 Vali Loss: 1.648 Vali Acc: 0.580 Test Loss: 1.648 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 4.799314498901367
Epoch: 30, Steps: 13 | Train Loss: 0.125 Vali Loss: 1.596 Vali Acc: 0.756 Test Loss: 1.596 Test Acc: 0.756
Validation loss decreased (-0.751206 --> -0.756082).  Saving model ...
Epoch: 31 cost time: 4.99357533454895
Epoch: 31, Steps: 13 | Train Loss: 0.086 Vali Loss: 1.230 Vali Acc: 0.634 Test Loss: 1.230 Test Acc: 0.634
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 6.365033149719238
Epoch: 32, Steps: 13 | Train Loss: 0.040 Vali Loss: 1.339 Vali Acc: 0.741 Test Loss: 1.339 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 6.027148723602295
Epoch: 33, Steps: 13 | Train Loss: 0.024 Vali Loss: 1.056 Vali Acc: 0.663 Test Loss: 1.056 Test Acc: 0.663
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 6.352684497833252
Epoch: 34, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.244 Vali Acc: 0.722 Test Loss: 1.244 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 5.418386459350586
Epoch: 35, Steps: 13 | Train Loss: 0.019 Vali Loss: 1.186 Vali Acc: 0.624 Test Loss: 1.186 Test Acc: 0.624
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 4.910870313644409
Epoch: 36, Steps: 13 | Train Loss: 0.027 Vali Loss: 1.600 Vali Acc: 0.732 Test Loss: 1.600 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 5.144551992416382
Epoch: 37, Steps: 13 | Train Loss: 0.024 Vali Loss: 1.216 Vali Acc: 0.702 Test Loss: 1.216 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 4.631588459014893
Epoch: 38, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.327 Vali Acc: 0.741 Test Loss: 1.327 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 5.507587194442749
Epoch: 39, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.206 Vali Acc: 0.737 Test Loss: 1.206 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 5.413009166717529
Epoch: 40, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.164 Vali Acc: 0.702 Test Loss: 1.164 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 1976254
model size : 8.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 11.564842224121094
Epoch: 1, Steps: 13 | Train Loss: 0.755 Vali Loss: 0.593 Vali Acc: 0.722 Test Loss: 0.593 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 3.990236759185791
Epoch: 2, Steps: 13 | Train Loss: 0.628 Vali Loss: 0.587 Vali Acc: 0.746 Test Loss: 0.587 Test Acc: 0.746
Validation loss decreased (-0.721945 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 4.3620123863220215
Epoch: 3, Steps: 13 | Train Loss: 0.645 Vali Loss: 0.650 Vali Acc: 0.712 Test Loss: 0.650 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.309415817260742
Epoch: 4, Steps: 13 | Train Loss: 0.718 Vali Loss: 0.776 Vali Acc: 0.722 Test Loss: 0.776 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.910336256027222
Epoch: 5, Steps: 13 | Train Loss: 0.556 Vali Loss: 0.642 Vali Acc: 0.600 Test Loss: 0.642 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.19716477394104
Epoch: 6, Steps: 13 | Train Loss: 0.536 Vali Loss: 0.522 Vali Acc: 0.737 Test Loss: 0.522 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.870436906814575
Epoch: 7, Steps: 13 | Train Loss: 0.565 Vali Loss: 0.600 Vali Acc: 0.654 Test Loss: 0.600 Test Acc: 0.654
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.183316469192505
Epoch: 8, Steps: 13 | Train Loss: 0.520 Vali Loss: 0.772 Vali Acc: 0.737 Test Loss: 0.772 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.9052863121032715
Epoch: 9, Steps: 13 | Train Loss: 0.525 Vali Loss: 0.536 Vali Acc: 0.712 Test Loss: 0.536 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 6.349393844604492
Epoch: 10, Steps: 13 | Train Loss: 0.662 Vali Loss: 0.730 Vali Acc: 0.537 Test Loss: 0.730 Test Acc: 0.537
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.580463886260986
Epoch: 11, Steps: 13 | Train Loss: 0.366 Vali Loss: 0.536 Vali Acc: 0.746 Test Loss: 0.536 Test Acc: 0.746
Validation loss decreased (-0.746336 --> -0.746336).  Saving model ...
Epoch: 12 cost time: 5.769955396652222
Epoch: 12, Steps: 13 | Train Loss: 0.406 Vali Loss: 1.513 Vali Acc: 0.351 Test Loss: 1.513 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.843145370483398
Epoch: 13, Steps: 13 | Train Loss: 0.958 Vali Loss: 0.681 Vali Acc: 0.702 Test Loss: 0.681 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.922262668609619
Epoch: 14, Steps: 13 | Train Loss: 0.368 Vali Loss: 0.583 Vali Acc: 0.717 Test Loss: 0.583 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.686430215835571
Epoch: 15, Steps: 13 | Train Loss: 0.310 Vali Loss: 0.695 Vali Acc: 0.654 Test Loss: 0.695 Test Acc: 0.654
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.864525318145752
Epoch: 16, Steps: 13 | Train Loss: 0.307 Vali Loss: 0.863 Vali Acc: 0.746 Test Loss: 0.863 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.172714710235596
Epoch: 17, Steps: 13 | Train Loss: 0.270 Vali Loss: 0.852 Vali Acc: 0.590 Test Loss: 0.852 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.479659080505371
Epoch: 18, Steps: 13 | Train Loss: 0.237 Vali Loss: 1.108 Vali Acc: 0.751 Test Loss: 1.108 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751208).  Saving model ...
Epoch: 19 cost time: 4.8827409744262695
Epoch: 19, Steps: 13 | Train Loss: 0.303 Vali Loss: 0.730 Vali Acc: 0.717 Test Loss: 0.730 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.948043584823608
Epoch: 20, Steps: 13 | Train Loss: 0.389 Vali Loss: 1.014 Vali Acc: 0.756 Test Loss: 1.014 Test Acc: 0.756
Validation loss decreased (-0.751208 --> -0.756087).  Saving model ...
Epoch: 21 cost time: 5.449460744857788
Epoch: 21, Steps: 13 | Train Loss: 0.530 Vali Loss: 1.760 Vali Acc: 0.463 Test Loss: 1.760 Test Acc: 0.463
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.943476438522339
Epoch: 22, Steps: 13 | Train Loss: 0.360 Vali Loss: 1.377 Vali Acc: 0.746 Test Loss: 1.377 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.090664386749268
Epoch: 23, Steps: 13 | Train Loss: 0.299 Vali Loss: 1.003 Vali Acc: 0.595 Test Loss: 1.003 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 5.39629864692688
Epoch: 24, Steps: 13 | Train Loss: 0.191 Vali Loss: 1.065 Vali Acc: 0.629 Test Loss: 1.065 Test Acc: 0.629
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 5.01902437210083
Epoch: 25, Steps: 13 | Train Loss: 0.309 Vali Loss: 1.039 Vali Acc: 0.732 Test Loss: 1.039 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 6.0554938316345215
Epoch: 26, Steps: 13 | Train Loss: 0.116 Vali Loss: 1.155 Vali Acc: 0.756 Test Loss: 1.155 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 5.7955405712127686
Epoch: 27, Steps: 13 | Train Loss: 0.110 Vali Loss: 1.536 Vali Acc: 0.761 Test Loss: 1.536 Test Acc: 0.761
Validation loss decreased (-0.756087 --> -0.760960).  Saving model ...
Epoch: 28 cost time: 5.5466203689575195
Epoch: 28, Steps: 13 | Train Loss: 0.340 Vali Loss: 1.350 Vali Acc: 0.756 Test Loss: 1.350 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 6.384521007537842
Epoch: 29, Steps: 13 | Train Loss: 0.105 Vali Loss: 1.334 Vali Acc: 0.766 Test Loss: 1.334 Test Acc: 0.766
Validation loss decreased (-0.760960 --> -0.765840).  Saving model ...
Epoch: 30 cost time: 5.1804468631744385
Epoch: 30, Steps: 13 | Train Loss: 0.074 Vali Loss: 1.152 Vali Acc: 0.688 Test Loss: 1.152 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 5.665889739990234
Epoch: 31, Steps: 13 | Train Loss: 0.098 Vali Loss: 2.281 Vali Acc: 0.746 Test Loss: 2.281 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 4.588043928146362
Epoch: 32, Steps: 13 | Train Loss: 0.439 Vali Loss: 1.422 Vali Acc: 0.746 Test Loss: 1.422 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 5.430522918701172
Epoch: 33, Steps: 13 | Train Loss: 0.140 Vali Loss: 1.257 Vali Acc: 0.678 Test Loss: 1.257 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 4.646784067153931
Epoch: 34, Steps: 13 | Train Loss: 0.032 Vali Loss: 1.296 Vali Acc: 0.639 Test Loss: 1.296 Test Acc: 0.639
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 5.34773850440979
Epoch: 35, Steps: 13 | Train Loss: 0.037 Vali Loss: 1.537 Vali Acc: 0.751 Test Loss: 1.537 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 5.223342418670654
Epoch: 36, Steps: 13 | Train Loss: 0.043 Vali Loss: 1.460 Vali Acc: 0.688 Test Loss: 1.460 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 4.910313844680786
Epoch: 37, Steps: 13 | Train Loss: 0.123 Vali Loss: 1.590 Vali Acc: 0.624 Test Loss: 1.590 Test Acc: 0.624
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 5.247196674346924
Epoch: 38, Steps: 13 | Train Loss: 0.016 Vali Loss: 1.435 Vali Acc: 0.712 Test Loss: 1.435 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 5.089946746826172
Epoch: 39, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.775 Vali Acc: 0.746 Test Loss: 1.775 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 1394302
model size : 6.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.467508316040039
Epoch: 1, Steps: 13 | Train Loss: 0.611 Vali Loss: 0.609 Vali Acc: 0.722 Test Loss: 0.609 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 5.569767713546753
Epoch: 2, Steps: 13 | Train Loss: 0.605 Vali Loss: 0.567 Vali Acc: 0.712 Test Loss: 0.567 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.094621181488037
Epoch: 3, Steps: 13 | Train Loss: 0.601 Vali Loss: 0.577 Vali Acc: 0.732 Test Loss: 0.577 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 4 cost time: 6.030031442642212
Epoch: 4, Steps: 13 | Train Loss: 0.532 Vali Loss: 0.608 Vali Acc: 0.702 Test Loss: 0.608 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.590386152267456
Epoch: 5, Steps: 13 | Train Loss: 0.601 Vali Loss: 0.642 Vali Acc: 0.732 Test Loss: 0.642 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.6946961879730225
Epoch: 6, Steps: 13 | Train Loss: 0.528 Vali Loss: 0.515 Vali Acc: 0.766 Test Loss: 0.515 Test Acc: 0.766
Validation loss decreased (-0.731702 --> -0.765849).  Saving model ...
Epoch: 7 cost time: 5.067895174026489
Epoch: 7, Steps: 13 | Train Loss: 0.447 Vali Loss: 0.711 Vali Acc: 0.737 Test Loss: 0.711 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.327524423599243
Epoch: 8, Steps: 13 | Train Loss: 0.408 Vali Loss: 0.508 Vali Acc: 0.746 Test Loss: 0.508 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.40421199798584
Epoch: 9, Steps: 13 | Train Loss: 0.429 Vali Loss: 0.703 Vali Acc: 0.737 Test Loss: 0.703 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.022842645645142
Epoch: 10, Steps: 13 | Train Loss: 0.480 Vali Loss: 1.134 Vali Acc: 0.483 Test Loss: 1.134 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.573639392852783
Epoch: 11, Steps: 13 | Train Loss: 0.603 Vali Loss: 0.643 Vali Acc: 0.746 Test Loss: 0.643 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.116514682769775
Epoch: 12, Steps: 13 | Train Loss: 0.480 Vali Loss: 1.493 Vali Acc: 0.420 Test Loss: 1.493 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.0217509269714355
Epoch: 13, Steps: 13 | Train Loss: 0.587 Vali Loss: 0.615 Vali Acc: 0.673 Test Loss: 0.615 Test Acc: 0.673
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.027035474777222
Epoch: 14, Steps: 13 | Train Loss: 0.318 Vali Loss: 0.685 Vali Acc: 0.746 Test Loss: 0.685 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.574122667312622
Epoch: 15, Steps: 13 | Train Loss: 0.305 Vali Loss: 0.657 Vali Acc: 0.741 Test Loss: 0.657 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.265299320220947
Epoch: 16, Steps: 13 | Train Loss: 0.606 Vali Loss: 2.045 Vali Acc: 0.346 Test Loss: 2.045 Test Acc: 0.346
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 1390142
model size : 6.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.092022657394409
Epoch: 1, Steps: 13 | Train Loss: 0.622 Vali Loss: 0.727 Vali Acc: 0.722 Test Loss: 0.727 Test Acc: 0.722
Validation loss decreased (inf --> -0.721944).  Saving model ...
Epoch: 2 cost time: 4.983571529388428
Epoch: 2, Steps: 13 | Train Loss: 0.654 Vali Loss: 0.582 Vali Acc: 0.722 Test Loss: 0.582 Test Acc: 0.722
Validation loss decreased (-0.721944 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 4.58214545249939
Epoch: 3, Steps: 13 | Train Loss: 0.576 Vali Loss: 0.629 Vali Acc: 0.722 Test Loss: 0.629 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.770467519760132
Epoch: 4, Steps: 13 | Train Loss: 0.696 Vali Loss: 0.542 Vali Acc: 0.732 Test Loss: 0.542 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 5 cost time: 4.2812888622283936
Epoch: 5, Steps: 13 | Train Loss: 0.601 Vali Loss: 0.524 Vali Acc: 0.741 Test Loss: 0.524 Test Acc: 0.741
Validation loss decreased (-0.731702 --> -0.741458).  Saving model ...
Epoch: 6 cost time: 5.625302791595459
Epoch: 6, Steps: 13 | Train Loss: 0.537 Vali Loss: 0.524 Vali Acc: 0.732 Test Loss: 0.524 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.30045223236084
Epoch: 7, Steps: 13 | Train Loss: 0.765 Vali Loss: 1.113 Vali Acc: 0.727 Test Loss: 1.113 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.0141212940216064
Epoch: 8, Steps: 13 | Train Loss: 0.562 Vali Loss: 0.635 Vali Acc: 0.737 Test Loss: 0.635 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.277248859405518
Epoch: 9, Steps: 13 | Train Loss: 0.497 Vali Loss: 0.848 Vali Acc: 0.498 Test Loss: 0.848 Test Acc: 0.498
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.195353746414185
Epoch: 10, Steps: 13 | Train Loss: 0.673 Vali Loss: 1.746 Vali Acc: 0.717 Test Loss: 1.746 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.282706022262573
Epoch: 11, Steps: 13 | Train Loss: 1.348 Vali Loss: 1.351 Vali Acc: 0.722 Test Loss: 1.351 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.943682670593262
Epoch: 12, Steps: 13 | Train Loss: 0.852 Vali Loss: 0.599 Vali Acc: 0.722 Test Loss: 0.599 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 5.301203966140747
Epoch: 13, Steps: 13 | Train Loss: 0.698 Vali Loss: 1.269 Vali Acc: 0.415 Test Loss: 1.269 Test Acc: 0.415
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 5.502942085266113
Epoch: 14, Steps: 13 | Train Loss: 0.641 Vali Loss: 0.620 Vali Acc: 0.732 Test Loss: 0.620 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 5.180893898010254
Epoch: 15, Steps: 13 | Train Loss: 0.311 Vali Loss: 0.592 Vali Acc: 0.702 Test Loss: 0.592 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 1385982
model size : 6.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.032483100891113
Epoch: 1, Steps: 13 | Train Loss: 0.650 Vali Loss: 0.583 Vali Acc: 0.722 Test Loss: 0.583 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 5.085026264190674
Epoch: 2, Steps: 13 | Train Loss: 0.633 Vali Loss: 0.587 Vali Acc: 0.746 Test Loss: 0.587 Test Acc: 0.746
Validation loss decreased (-0.721945 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 4.312105178833008
Epoch: 3, Steps: 13 | Train Loss: 0.545 Vali Loss: 0.580 Vali Acc: 0.717 Test Loss: 0.580 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.566638708114624
Epoch: 4, Steps: 13 | Train Loss: 0.512 Vali Loss: 0.548 Vali Acc: 0.741 Test Loss: 0.548 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.060334205627441
Epoch: 5, Steps: 13 | Train Loss: 0.509 Vali Loss: 0.649 Vali Acc: 0.639 Test Loss: 0.649 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.380192518234253
Epoch: 6, Steps: 13 | Train Loss: 0.646 Vali Loss: 0.768 Vali Acc: 0.732 Test Loss: 0.768 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.3030149936676025
Epoch: 7, Steps: 13 | Train Loss: 0.571 Vali Loss: 0.862 Vali Acc: 0.478 Test Loss: 0.862 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.028614044189453
Epoch: 8, Steps: 13 | Train Loss: 0.679 Vali Loss: 0.998 Vali Acc: 0.420 Test Loss: 0.998 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.829608917236328
Epoch: 9, Steps: 13 | Train Loss: 0.683 Vali Loss: 0.809 Vali Acc: 0.727 Test Loss: 0.809 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.055144786834717
Epoch: 10, Steps: 13 | Train Loss: 0.506 Vali Loss: 0.506 Vali Acc: 0.761 Test Loss: 0.506 Test Acc: 0.761
Validation loss decreased (-0.746336 --> -0.760971).  Saving model ...
Epoch: 11 cost time: 5.141016244888306
Epoch: 11, Steps: 13 | Train Loss: 0.383 Vali Loss: 1.117 Vali Acc: 0.722 Test Loss: 1.117 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.610736846923828
Epoch: 12, Steps: 13 | Train Loss: 0.803 Vali Loss: 1.089 Vali Acc: 0.576 Test Loss: 1.089 Test Acc: 0.576
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.219804763793945
Epoch: 13, Steps: 13 | Train Loss: 0.625 Vali Loss: 0.653 Vali Acc: 0.727 Test Loss: 0.653 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.754369497299194
Epoch: 14, Steps: 13 | Train Loss: 0.474 Vali Loss: 1.510 Vali Acc: 0.351 Test Loss: 1.510 Test Acc: 0.351
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.515474081039429
Epoch: 15, Steps: 13 | Train Loss: 0.386 Vali Loss: 0.813 Vali Acc: 0.737 Test Loss: 0.813 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.620612859725952
Epoch: 16, Steps: 13 | Train Loss: 0.338 Vali Loss: 0.670 Vali Acc: 0.746 Test Loss: 0.670 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.5277321338653564
Epoch: 17, Steps: 13 | Train Loss: 0.238 Vali Loss: 0.780 Vali Acc: 0.756 Test Loss: 0.780 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.620165824890137
Epoch: 18, Steps: 13 | Train Loss: 0.245 Vali Loss: 1.202 Vali Acc: 0.502 Test Loss: 1.202 Test Acc: 0.502
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.912861585617065
Epoch: 19, Steps: 13 | Train Loss: 0.482 Vali Loss: 0.850 Vali Acc: 0.737 Test Loss: 0.850 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.70721697807312
Epoch: 20, Steps: 13 | Train Loss: 0.300 Vali Loss: 1.229 Vali Acc: 0.517 Test Loss: 1.229 Test Acc: 0.517
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 1381822
model size : 6.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.310809135437012
Epoch: 1, Steps: 13 | Train Loss: 0.606 Vali Loss: 0.627 Vali Acc: 0.722 Test Loss: 0.627 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 5.926146507263184
Epoch: 2, Steps: 13 | Train Loss: 0.599 Vali Loss: 0.682 Vali Acc: 0.576 Test Loss: 0.682 Test Acc: 0.576
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.70404314994812
Epoch: 3, Steps: 13 | Train Loss: 0.630 Vali Loss: 0.559 Vali Acc: 0.737 Test Loss: 0.559 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736580).  Saving model ...
Epoch: 4 cost time: 5.259515762329102
Epoch: 4, Steps: 13 | Train Loss: 0.604 Vali Loss: 0.686 Vali Acc: 0.722 Test Loss: 0.686 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.326718807220459
Epoch: 5, Steps: 13 | Train Loss: 0.922 Vali Loss: 0.763 Vali Acc: 0.732 Test Loss: 0.763 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.087342739105225
Epoch: 6, Steps: 13 | Train Loss: 0.834 Vali Loss: 1.048 Vali Acc: 0.722 Test Loss: 1.048 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.916202783584595
Epoch: 7, Steps: 13 | Train Loss: 0.655 Vali Loss: 0.545 Vali Acc: 0.712 Test Loss: 0.545 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.608049631118774
Epoch: 8, Steps: 13 | Train Loss: 0.450 Vali Loss: 0.510 Vali Acc: 0.737 Test Loss: 0.510 Test Acc: 0.737
Validation loss decreased (-0.736580 --> -0.736580).  Saving model ...
Epoch: 9 cost time: 4.855861186981201
Epoch: 9, Steps: 13 | Train Loss: 0.611 Vali Loss: 1.179 Vali Acc: 0.722 Test Loss: 1.179 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.936725616455078
Epoch: 10, Steps: 13 | Train Loss: 0.755 Vali Loss: 0.781 Vali Acc: 0.576 Test Loss: 0.781 Test Acc: 0.576
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.5022923946380615
Epoch: 11, Steps: 13 | Train Loss: 0.422 Vali Loss: 0.526 Vali Acc: 0.737 Test Loss: 0.526 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.902345418930054
Epoch: 12, Steps: 13 | Train Loss: 0.407 Vali Loss: 1.239 Vali Acc: 0.722 Test Loss: 1.239 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.000497102737427
Epoch: 13, Steps: 13 | Train Loss: 0.553 Vali Loss: 0.600 Vali Acc: 0.702 Test Loss: 0.600 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.052440404891968
Epoch: 14, Steps: 13 | Train Loss: 0.396 Vali Loss: 0.646 Vali Acc: 0.654 Test Loss: 0.646 Test Acc: 0.654
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.1342456340789795
Epoch: 15, Steps: 13 | Train Loss: 0.389 Vali Loss: 1.436 Vali Acc: 0.727 Test Loss: 1.436 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.7885520458221436
Epoch: 16, Steps: 13 | Train Loss: 0.752 Vali Loss: 0.708 Vali Acc: 0.634 Test Loss: 0.708 Test Acc: 0.634
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 5.271697282791138
Epoch: 17, Steps: 13 | Train Loss: 0.327 Vali Loss: 1.836 Vali Acc: 0.410 Test Loss: 1.836 Test Acc: 0.410
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.371045112609863
Epoch: 18, Steps: 13 | Train Loss: 0.400 Vali Loss: 0.863 Vali Acc: 0.517 Test Loss: 0.863 Test Acc: 0.517
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 1097086
model size : 5.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.903074264526367
Epoch: 1, Steps: 13 | Train Loss: 0.736 Vali Loss: 0.809 Vali Acc: 0.278 Test Loss: 0.809 Test Acc: 0.278
Validation loss decreased (inf --> -0.278041).  Saving model ...
Epoch: 2 cost time: 4.173426151275635
Epoch: 2, Steps: 13 | Train Loss: 0.602 Vali Loss: 0.575 Vali Acc: 0.717 Test Loss: 0.575 Test Acc: 0.717
Validation loss decreased (-0.278041 --> -0.717067).  Saving model ...
Epoch: 3 cost time: 4.398834943771362
Epoch: 3, Steps: 13 | Train Loss: 0.575 Vali Loss: 0.580 Vali Acc: 0.712 Test Loss: 0.580 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.757356643676758
Epoch: 4, Steps: 13 | Train Loss: 0.531 Vali Loss: 0.526 Vali Acc: 0.746 Test Loss: 0.526 Test Acc: 0.746
Validation loss decreased (-0.717067 --> -0.746336).  Saving model ...
Epoch: 5 cost time: 4.294984817504883
Epoch: 5, Steps: 13 | Train Loss: 0.691 Vali Loss: 0.564 Vali Acc: 0.737 Test Loss: 0.564 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.17863130569458
Epoch: 6, Steps: 13 | Train Loss: 0.502 Vali Loss: 0.817 Vali Acc: 0.507 Test Loss: 0.817 Test Acc: 0.507
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.6513419151306152
Epoch: 7, Steps: 13 | Train Loss: 0.518 Vali Loss: 0.664 Vali Acc: 0.629 Test Loss: 0.664 Test Acc: 0.629
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.266932964324951
Epoch: 8, Steps: 13 | Train Loss: 0.435 Vali Loss: 0.575 Vali Acc: 0.741 Test Loss: 0.575 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.790395736694336
Epoch: 9, Steps: 13 | Train Loss: 0.495 Vali Loss: 0.551 Vali Acc: 0.712 Test Loss: 0.551 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.9629313945770264
Epoch: 10, Steps: 13 | Train Loss: 0.676 Vali Loss: 1.836 Vali Acc: 0.722 Test Loss: 1.836 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.500997543334961
Epoch: 11, Steps: 13 | Train Loss: 1.022 Vali Loss: 0.988 Vali Acc: 0.722 Test Loss: 0.988 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.3923380374908447
Epoch: 12, Steps: 13 | Train Loss: 1.108 Vali Loss: 1.865 Vali Acc: 0.356 Test Loss: 1.865 Test Acc: 0.356
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.996715545654297
Epoch: 13, Steps: 13 | Train Loss: 1.262 Vali Loss: 2.045 Vali Acc: 0.337 Test Loss: 2.045 Test Acc: 0.337
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.621471643447876
Epoch: 14, Steps: 13 | Train Loss: 0.966 Vali Loss: 0.558 Vali Acc: 0.702 Test Loss: 0.558 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 1092926
model size : 5.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.117046594619751
Epoch: 1, Steps: 13 | Train Loss: 0.698 Vali Loss: 0.842 Vali Acc: 0.278 Test Loss: 0.842 Test Acc: 0.278
Validation loss decreased (inf --> -0.278040).  Saving model ...
Epoch: 2 cost time: 5.180204391479492
Epoch: 2, Steps: 13 | Train Loss: 0.690 Vali Loss: 0.639 Vali Acc: 0.722 Test Loss: 0.639 Test Acc: 0.722
Validation loss decreased (-0.278040 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 5.113955020904541
Epoch: 3, Steps: 13 | Train Loss: 0.581 Vali Loss: 0.573 Vali Acc: 0.741 Test Loss: 0.573 Test Acc: 0.741
Validation loss decreased (-0.721945 --> -0.741458).  Saving model ...
Epoch: 4 cost time: 4.681561231613159
Epoch: 4, Steps: 13 | Train Loss: 0.578 Vali Loss: 0.535 Vali Acc: 0.722 Test Loss: 0.535 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.003311634063721
Epoch: 5, Steps: 13 | Train Loss: 0.587 Vali Loss: 0.646 Vali Acc: 0.732 Test Loss: 0.646 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.6061036586761475
Epoch: 6, Steps: 13 | Train Loss: 0.532 Vali Loss: 0.692 Vali Acc: 0.732 Test Loss: 0.692 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.16371488571167
Epoch: 7, Steps: 13 | Train Loss: 0.688 Vali Loss: 0.875 Vali Acc: 0.732 Test Loss: 0.875 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.451622009277344
Epoch: 8, Steps: 13 | Train Loss: 0.556 Vali Loss: 0.574 Vali Acc: 0.678 Test Loss: 0.574 Test Acc: 0.678
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.722301483154297
Epoch: 9, Steps: 13 | Train Loss: 0.403 Vali Loss: 0.512 Vali Acc: 0.741 Test Loss: 0.512 Test Acc: 0.741
Validation loss decreased (-0.741458 --> -0.741458).  Saving model ...
Epoch: 10 cost time: 4.566198110580444
Epoch: 10, Steps: 13 | Train Loss: 0.612 Vali Loss: 0.619 Vali Acc: 0.756 Test Loss: 0.619 Test Acc: 0.756
Validation loss decreased (-0.741458 --> -0.756091).  Saving model ...
Epoch: 11 cost time: 5.3160130977630615
Epoch: 11, Steps: 13 | Train Loss: 0.395 Vali Loss: 0.551 Vali Acc: 0.717 Test Loss: 0.551 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.216902494430542
Epoch: 12, Steps: 13 | Train Loss: 0.372 Vali Loss: 0.617 Vali Acc: 0.668 Test Loss: 0.617 Test Acc: 0.668
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.752203464508057
Epoch: 13, Steps: 13 | Train Loss: 0.383 Vali Loss: 0.599 Vali Acc: 0.741 Test Loss: 0.599 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.260668754577637
Epoch: 14, Steps: 13 | Train Loss: 0.643 Vali Loss: 0.604 Vali Acc: 0.737 Test Loss: 0.604 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.26572585105896
Epoch: 15, Steps: 13 | Train Loss: 0.384 Vali Loss: 0.679 Vali Acc: 0.659 Test Loss: 0.679 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.293294429779053
Epoch: 16, Steps: 13 | Train Loss: 0.284 Vali Loss: 0.681 Vali Acc: 0.737 Test Loss: 0.681 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.5806238651275635
Epoch: 17, Steps: 13 | Train Loss: 0.384 Vali Loss: 1.569 Vali Acc: 0.434 Test Loss: 1.569 Test Acc: 0.434
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 5.438397169113159
Epoch: 18, Steps: 13 | Train Loss: 0.380 Vali Loss: 0.686 Vali Acc: 0.732 Test Loss: 0.686 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.742286205291748
Epoch: 19, Steps: 13 | Train Loss: 0.177 Vali Loss: 0.929 Vali Acc: 0.620 Test Loss: 0.929 Test Acc: 0.620
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.863172292709351
Epoch: 20, Steps: 13 | Train Loss: 0.301 Vali Loss: 1.495 Vali Acc: 0.737 Test Loss: 1.495 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 1088766
model size : 5.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.935524225234985
Epoch: 1, Steps: 13 | Train Loss: 0.674 Vali Loss: 0.672 Vali Acc: 0.717 Test Loss: 0.672 Test Acc: 0.717
Validation loss decreased (inf --> -0.717066).  Saving model ...
Epoch: 2 cost time: 5.7777159214019775
Epoch: 2, Steps: 13 | Train Loss: 0.704 Vali Loss: 0.667 Vali Acc: 0.717 Test Loss: 0.667 Test Acc: 0.717
Validation loss decreased (-0.717066 --> -0.717067).  Saving model ...
Epoch: 3 cost time: 5.771956443786621
Epoch: 3, Steps: 13 | Train Loss: 0.579 Vali Loss: 0.645 Vali Acc: 0.717 Test Loss: 0.645 Test Acc: 0.717
Validation loss decreased (-0.717067 --> -0.717067).  Saving model ...
Epoch: 4 cost time: 5.467524290084839
Epoch: 4, Steps: 13 | Train Loss: 0.583 Vali Loss: 0.549 Vali Acc: 0.722 Test Loss: 0.549 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721946).  Saving model ...
Epoch: 5 cost time: 5.200235366821289
Epoch: 5, Steps: 13 | Train Loss: 0.630 Vali Loss: 1.444 Vali Acc: 0.278 Test Loss: 1.444 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.011099576950073
Epoch: 6, Steps: 13 | Train Loss: 0.767 Vali Loss: 0.529 Vali Acc: 0.746 Test Loss: 0.529 Test Acc: 0.746
Validation loss decreased (-0.721946 --> -0.746336).  Saving model ...
Epoch: 7 cost time: 5.355598211288452
Epoch: 7, Steps: 13 | Train Loss: 0.682 Vali Loss: 0.526 Vali Acc: 0.761 Test Loss: 0.526 Test Acc: 0.761
Validation loss decreased (-0.746336 --> -0.760970).  Saving model ...
Epoch: 8 cost time: 5.405417203903198
Epoch: 8, Steps: 13 | Train Loss: 0.445 Vali Loss: 0.570 Vali Acc: 0.702 Test Loss: 0.570 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.166643381118774
Epoch: 9, Steps: 13 | Train Loss: 0.462 Vali Loss: 0.725 Vali Acc: 0.732 Test Loss: 0.725 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.378545045852661
Epoch: 10, Steps: 13 | Train Loss: 0.429 Vali Loss: 0.620 Vali Acc: 0.737 Test Loss: 0.620 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.938567161560059
Epoch: 11, Steps: 13 | Train Loss: 0.416 Vali Loss: 0.956 Vali Acc: 0.459 Test Loss: 0.956 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.782938480377197
Epoch: 12, Steps: 13 | Train Loss: 0.954 Vali Loss: 0.616 Vali Acc: 0.727 Test Loss: 0.616 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.907329797744751
Epoch: 13, Steps: 13 | Train Loss: 0.597 Vali Loss: 1.395 Vali Acc: 0.717 Test Loss: 1.395 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.687044382095337
Epoch: 14, Steps: 13 | Train Loss: 0.504 Vali Loss: 0.581 Vali Acc: 0.741 Test Loss: 0.581 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.353002309799194
Epoch: 15, Steps: 13 | Train Loss: 0.407 Vali Loss: 0.915 Vali Acc: 0.732 Test Loss: 0.915 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.735127925872803
Epoch: 16, Steps: 13 | Train Loss: 0.307 Vali Loss: 1.137 Vali Acc: 0.478 Test Loss: 1.137 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.084256887435913
Epoch: 17, Steps: 13 | Train Loss: 0.384 Vali Loss: 0.664 Vali Acc: 0.732 Test Loss: 0.664 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 1084606
model size : 5.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.419917345046997
Epoch: 1, Steps: 13 | Train Loss: 0.652 Vali Loss: 0.643 Vali Acc: 0.722 Test Loss: 0.643 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 5.1994006633758545
Epoch: 2, Steps: 13 | Train Loss: 0.687 Vali Loss: 0.747 Vali Acc: 0.322 Test Loss: 0.747 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.198729038238525
Epoch: 3, Steps: 13 | Train Loss: 0.650 Vali Loss: 1.000 Vali Acc: 0.288 Test Loss: 1.000 Test Acc: 0.288
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.836243629455566
Epoch: 4, Steps: 13 | Train Loss: 0.722 Vali Loss: 0.645 Vali Acc: 0.659 Test Loss: 0.645 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.604604959487915
Epoch: 5, Steps: 13 | Train Loss: 0.782 Vali Loss: 0.526 Vali Acc: 0.756 Test Loss: 0.526 Test Acc: 0.756
Validation loss decreased (-0.721945 --> -0.756092).  Saving model ...
Epoch: 6 cost time: 4.7523417472839355
Epoch: 6, Steps: 13 | Train Loss: 0.793 Vali Loss: 0.674 Vali Acc: 0.737 Test Loss: 0.674 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.721904754638672
Epoch: 7, Steps: 13 | Train Loss: 0.511 Vali Loss: 0.540 Vali Acc: 0.707 Test Loss: 0.540 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.38484525680542
Epoch: 8, Steps: 13 | Train Loss: 0.435 Vali Loss: 0.556 Vali Acc: 0.756 Test Loss: 0.556 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.2901222705841064
Epoch: 9, Steps: 13 | Train Loss: 0.436 Vali Loss: 0.926 Vali Acc: 0.732 Test Loss: 0.926 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.515267848968506
Epoch: 10, Steps: 13 | Train Loss: 0.467 Vali Loss: 0.764 Vali Acc: 0.561 Test Loss: 0.764 Test Acc: 0.561
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.735168218612671
Epoch: 11, Steps: 13 | Train Loss: 0.381 Vali Loss: 0.780 Vali Acc: 0.741 Test Loss: 0.780 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.34641695022583
Epoch: 12, Steps: 13 | Train Loss: 0.404 Vali Loss: 0.557 Vali Acc: 0.727 Test Loss: 0.557 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 5.5927393436431885
Epoch: 13, Steps: 13 | Train Loss: 0.371 Vali Loss: 0.689 Vali Acc: 0.737 Test Loss: 0.689 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 5.927699327468872
Epoch: 14, Steps: 13 | Train Loss: 0.285 Vali Loss: 0.739 Vali Acc: 0.600 Test Loss: 0.739 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 5.105710983276367
Epoch: 15, Steps: 13 | Train Loss: 0.348 Vali Loss: 0.628 Vali Acc: 0.722 Test Loss: 0.628 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 948478
model size : 5.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.817867040634155
Epoch: 1, Steps: 13 | Train Loss: 0.638 Vali Loss: 0.589 Vali Acc: 0.717 Test Loss: 0.589 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 5.625742435455322
Epoch: 2, Steps: 13 | Train Loss: 0.610 Vali Loss: 0.586 Vali Acc: 0.727 Test Loss: 0.586 Test Acc: 0.727
Validation loss decreased (-0.717067 --> -0.726823).  Saving model ...
Epoch: 3 cost time: 4.7802934646606445
Epoch: 3, Steps: 13 | Train Loss: 0.568 Vali Loss: 0.568 Vali Acc: 0.712 Test Loss: 0.568 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.085099220275879
Epoch: 4, Steps: 13 | Train Loss: 0.606 Vali Loss: 0.540 Vali Acc: 0.732 Test Loss: 0.540 Test Acc: 0.732
Validation loss decreased (-0.726823 --> -0.731702).  Saving model ...
Epoch: 5 cost time: 4.949549198150635
Epoch: 5, Steps: 13 | Train Loss: 0.580 Vali Loss: 0.549 Vali Acc: 0.732 Test Loss: 0.549 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.53212308883667
Epoch: 6, Steps: 13 | Train Loss: 0.509 Vali Loss: 0.539 Vali Acc: 0.717 Test Loss: 0.539 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.970452070236206
Epoch: 7, Steps: 13 | Train Loss: 0.504 Vali Loss: 1.522 Vali Acc: 0.722 Test Loss: 1.522 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.7032647132873535
Epoch: 8, Steps: 13 | Train Loss: 1.200 Vali Loss: 0.735 Vali Acc: 0.727 Test Loss: 0.735 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.638499021530151
Epoch: 9, Steps: 13 | Train Loss: 0.621 Vali Loss: 0.895 Vali Acc: 0.722 Test Loss: 0.895 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.468254804611206
Epoch: 10, Steps: 13 | Train Loss: 0.633 Vali Loss: 1.252 Vali Acc: 0.415 Test Loss: 1.252 Test Acc: 0.415
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.355165004730225
Epoch: 11, Steps: 13 | Train Loss: 0.643 Vali Loss: 0.890 Vali Acc: 0.722 Test Loss: 0.890 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.354318141937256
Epoch: 12, Steps: 13 | Train Loss: 0.493 Vali Loss: 0.513 Vali Acc: 0.751 Test Loss: 0.513 Test Acc: 0.751
Validation loss decreased (-0.731702 --> -0.751214).  Saving model ...
Epoch: 13 cost time: 4.705956935882568
Epoch: 13, Steps: 13 | Train Loss: 0.325 Vali Loss: 0.535 Vali Acc: 0.712 Test Loss: 0.535 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.492358446121216
Epoch: 14, Steps: 13 | Train Loss: 0.322 Vali Loss: 1.153 Vali Acc: 0.439 Test Loss: 1.153 Test Acc: 0.439
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.255032539367676
Epoch: 15, Steps: 13 | Train Loss: 0.444 Vali Loss: 0.655 Vali Acc: 0.732 Test Loss: 0.655 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.381578683853149
Epoch: 16, Steps: 13 | Train Loss: 0.477 Vali Loss: 2.110 Vali Acc: 0.395 Test Loss: 2.110 Test Acc: 0.395
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.312406301498413
Epoch: 17, Steps: 13 | Train Loss: 0.560 Vali Loss: 0.658 Vali Acc: 0.702 Test Loss: 0.658 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.351705312728882
Epoch: 18, Steps: 13 | Train Loss: 0.307 Vali Loss: 0.974 Vali Acc: 0.595 Test Loss: 0.974 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 5.315676927566528
Epoch: 19, Steps: 13 | Train Loss: 0.558 Vali Loss: 1.108 Vali Acc: 0.737 Test Loss: 1.108 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 5.0992419719696045
Epoch: 20, Steps: 13 | Train Loss: 0.422 Vali Loss: 0.666 Vali Acc: 0.702 Test Loss: 0.666 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 5.689067602157593
Epoch: 21, Steps: 13 | Train Loss: 0.330 Vali Loss: 1.021 Vali Acc: 0.541 Test Loss: 1.021 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 5.0332276821136475
Epoch: 22, Steps: 13 | Train Loss: 0.367 Vali Loss: 0.824 Vali Acc: 0.654 Test Loss: 0.824 Test Acc: 0.654
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 944318
model size : 5.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.768165349960327
Epoch: 1, Steps: 13 | Train Loss: 0.701 Vali Loss: 0.583 Vali Acc: 0.722 Test Loss: 0.583 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.738152503967285
Epoch: 2, Steps: 13 | Train Loss: 0.633 Vali Loss: 0.579 Vali Acc: 0.722 Test Loss: 0.579 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 4.242510557174683
Epoch: 3, Steps: 13 | Train Loss: 0.626 Vali Loss: 0.589 Vali Acc: 0.737 Test Loss: 0.589 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736579).  Saving model ...
Epoch: 4 cost time: 4.960006475448608
Epoch: 4, Steps: 13 | Train Loss: 0.522 Vali Loss: 0.532 Vali Acc: 0.732 Test Loss: 0.532 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.806030035018921
Epoch: 5, Steps: 13 | Train Loss: 0.487 Vali Loss: 0.702 Vali Acc: 0.727 Test Loss: 0.702 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.639066457748413
Epoch: 6, Steps: 13 | Train Loss: 0.595 Vali Loss: 0.518 Vali Acc: 0.727 Test Loss: 0.518 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.92066502571106
Epoch: 7, Steps: 13 | Train Loss: 0.652 Vali Loss: 0.761 Vali Acc: 0.727 Test Loss: 0.761 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.8886778354644775
Epoch: 8, Steps: 13 | Train Loss: 0.500 Vali Loss: 0.889 Vali Acc: 0.722 Test Loss: 0.889 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.720147132873535
Epoch: 9, Steps: 13 | Train Loss: 0.429 Vali Loss: 0.709 Vali Acc: 0.727 Test Loss: 0.709 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.362111568450928
Epoch: 10, Steps: 13 | Train Loss: 0.361 Vali Loss: 0.543 Vali Acc: 0.722 Test Loss: 0.543 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.016417503356934
Epoch: 11, Steps: 13 | Train Loss: 0.386 Vali Loss: 0.534 Vali Acc: 0.746 Test Loss: 0.534 Test Acc: 0.746
Validation loss decreased (-0.736579 --> -0.746336).  Saving model ...
Epoch: 12 cost time: 4.466538429260254
Epoch: 12, Steps: 13 | Train Loss: 0.381 Vali Loss: 0.882 Vali Acc: 0.727 Test Loss: 0.882 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.011674404144287
Epoch: 13, Steps: 13 | Train Loss: 0.445 Vali Loss: 0.589 Vali Acc: 0.712 Test Loss: 0.589 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.9052019119262695
Epoch: 14, Steps: 13 | Train Loss: 0.995 Vali Loss: 0.643 Vali Acc: 0.741 Test Loss: 0.643 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.1232750415802
Epoch: 15, Steps: 13 | Train Loss: 0.940 Vali Loss: 1.233 Vali Acc: 0.727 Test Loss: 1.233 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.19624400138855
Epoch: 16, Steps: 13 | Train Loss: 0.860 Vali Loss: 1.108 Vali Acc: 0.732 Test Loss: 1.108 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.735049724578857
Epoch: 17, Steps: 13 | Train Loss: 0.558 Vali Loss: 1.518 Vali Acc: 0.463 Test Loss: 1.518 Test Acc: 0.463
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.635865211486816
Epoch: 18, Steps: 13 | Train Loss: 0.473 Vali Loss: 1.015 Vali Acc: 0.746 Test Loss: 1.015 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.862979888916016
Epoch: 19, Steps: 13 | Train Loss: 0.437 Vali Loss: 1.431 Vali Acc: 0.478 Test Loss: 1.431 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.819885492324829
Epoch: 20, Steps: 13 | Train Loss: 0.244 Vali Loss: 1.225 Vali Acc: 0.732 Test Loss: 1.225 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.145704984664917
Epoch: 21, Steps: 13 | Train Loss: 0.223 Vali Loss: 0.690 Vali Acc: 0.683 Test Loss: 0.690 Test Acc: 0.683
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 940158
model size : 5.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.8195741176605225
Epoch: 1, Steps: 13 | Train Loss: 0.637 Vali Loss: 0.585 Vali Acc: 0.717 Test Loss: 0.585 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 3.9001388549804688
Epoch: 2, Steps: 13 | Train Loss: 0.607 Vali Loss: 0.597 Vali Acc: 0.722 Test Loss: 0.597 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 4.53705906867981
Epoch: 3, Steps: 13 | Train Loss: 0.587 Vali Loss: 0.653 Vali Acc: 0.712 Test Loss: 0.653 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.4457573890686035
Epoch: 4, Steps: 13 | Train Loss: 0.624 Vali Loss: 0.786 Vali Acc: 0.722 Test Loss: 0.786 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.334467649459839
Epoch: 5, Steps: 13 | Train Loss: 0.564 Vali Loss: 0.572 Vali Acc: 0.712 Test Loss: 0.572 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.326916933059692
Epoch: 6, Steps: 13 | Train Loss: 0.565 Vali Loss: 0.638 Vali Acc: 0.741 Test Loss: 0.638 Test Acc: 0.741
Validation loss decreased (-0.721945 --> -0.741457).  Saving model ...
Epoch: 7 cost time: 4.17376184463501
Epoch: 7, Steps: 13 | Train Loss: 0.528 Vali Loss: 0.522 Vali Acc: 0.737 Test Loss: 0.522 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.5108349323272705
Epoch: 8, Steps: 13 | Train Loss: 0.450 Vali Loss: 0.517 Vali Acc: 0.751 Test Loss: 0.517 Test Acc: 0.751
Validation loss decreased (-0.741457 --> -0.751214).  Saving model ...
Epoch: 9 cost time: 4.571014404296875
Epoch: 9, Steps: 13 | Train Loss: 0.480 Vali Loss: 0.542 Vali Acc: 0.766 Test Loss: 0.542 Test Acc: 0.766
Validation loss decreased (-0.751214 --> -0.765848).  Saving model ...
Epoch: 10 cost time: 4.9181904792785645
Epoch: 10, Steps: 13 | Train Loss: 0.445 Vali Loss: 0.884 Vali Acc: 0.727 Test Loss: 0.884 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.274913549423218
Epoch: 11, Steps: 13 | Train Loss: 0.450 Vali Loss: 0.677 Vali Acc: 0.585 Test Loss: 0.677 Test Acc: 0.585
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.6996848583221436
Epoch: 12, Steps: 13 | Train Loss: 0.367 Vali Loss: 0.543 Vali Acc: 0.746 Test Loss: 0.543 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.488022804260254
Epoch: 13, Steps: 13 | Train Loss: 0.333 Vali Loss: 0.763 Vali Acc: 0.751 Test Loss: 0.763 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.7026612758636475
Epoch: 14, Steps: 13 | Train Loss: 0.651 Vali Loss: 0.751 Vali Acc: 0.600 Test Loss: 0.751 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.2639079093933105
Epoch: 15, Steps: 13 | Train Loss: 0.751 Vali Loss: 0.776 Vali Acc: 0.605 Test Loss: 0.776 Test Acc: 0.605
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.415513753890991
Epoch: 16, Steps: 13 | Train Loss: 0.523 Vali Loss: 0.871 Vali Acc: 0.746 Test Loss: 0.871 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.229709625244141
Epoch: 17, Steps: 13 | Train Loss: 0.322 Vali Loss: 0.766 Vali Acc: 0.751 Test Loss: 0.766 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.862532377243042
Epoch: 18, Steps: 13 | Train Loss: 0.276 Vali Loss: 0.606 Vali Acc: 0.756 Test Loss: 0.606 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.756519079208374
Epoch: 19, Steps: 13 | Train Loss: 0.229 Vali Loss: 0.806 Vali Acc: 0.751 Test Loss: 0.806 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 935998
model size : 4.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.869541883468628
Epoch: 1, Steps: 13 | Train Loss: 0.709 Vali Loss: 0.638 Vali Acc: 0.722 Test Loss: 0.638 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 5.2117438316345215
Epoch: 2, Steps: 13 | Train Loss: 0.582 Vali Loss: 0.576 Vali Acc: 0.722 Test Loss: 0.576 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 5.193910598754883
Epoch: 3, Steps: 13 | Train Loss: 0.581 Vali Loss: 0.674 Vali Acc: 0.712 Test Loss: 0.674 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.818192481994629
Epoch: 4, Steps: 13 | Train Loss: 0.590 Vali Loss: 0.574 Vali Acc: 0.727 Test Loss: 0.574 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726824).  Saving model ...
Epoch: 5 cost time: 4.863047361373901
Epoch: 5, Steps: 13 | Train Loss: 0.629 Vali Loss: 0.538 Vali Acc: 0.756 Test Loss: 0.538 Test Acc: 0.756
Validation loss decreased (-0.726824 --> -0.756092).  Saving model ...
Epoch: 6 cost time: 4.620215654373169
Epoch: 6, Steps: 13 | Train Loss: 0.584 Vali Loss: 0.625 Vali Acc: 0.727 Test Loss: 0.625 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.285024166107178
Epoch: 7, Steps: 13 | Train Loss: 0.672 Vali Loss: 0.695 Vali Acc: 0.727 Test Loss: 0.695 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.1529271602630615
Epoch: 8, Steps: 13 | Train Loss: 0.512 Vali Loss: 0.924 Vali Acc: 0.468 Test Loss: 0.924 Test Acc: 0.468
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.17514181137085
Epoch: 9, Steps: 13 | Train Loss: 0.637 Vali Loss: 0.590 Vali Acc: 0.751 Test Loss: 0.590 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.834166526794434
Epoch: 10, Steps: 13 | Train Loss: 0.429 Vali Loss: 0.571 Vali Acc: 0.766 Test Loss: 0.571 Test Acc: 0.766
Validation loss decreased (-0.756092 --> -0.765848).  Saving model ...
Epoch: 11 cost time: 5.545002460479736
Epoch: 11, Steps: 13 | Train Loss: 0.410 Vali Loss: 0.573 Vali Acc: 0.702 Test Loss: 0.573 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.208452463150024
Epoch: 12, Steps: 13 | Train Loss: 0.385 Vali Loss: 0.528 Vali Acc: 0.746 Test Loss: 0.528 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.748972654342651
Epoch: 13, Steps: 13 | Train Loss: 0.388 Vali Loss: 0.526 Vali Acc: 0.780 Test Loss: 0.526 Test Acc: 0.780
Validation loss decreased (-0.765848 --> -0.780483).  Saving model ...
Epoch: 14 cost time: 5.005512952804565
Epoch: 14, Steps: 13 | Train Loss: 0.397 Vali Loss: 0.685 Vali Acc: 0.649 Test Loss: 0.685 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.555493354797363
Epoch: 15, Steps: 13 | Train Loss: 0.432 Vali Loss: 0.603 Vali Acc: 0.707 Test Loss: 0.603 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.1202569007873535
Epoch: 16, Steps: 13 | Train Loss: 0.271 Vali Loss: 0.602 Vali Acc: 0.737 Test Loss: 0.602 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.404512405395508
Epoch: 17, Steps: 13 | Train Loss: 0.234 Vali Loss: 0.619 Vali Acc: 0.766 Test Loss: 0.619 Test Acc: 0.766
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.894088983535767
Epoch: 18, Steps: 13 | Train Loss: 0.318 Vali Loss: 0.592 Vali Acc: 0.756 Test Loss: 0.592 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.80005669593811
Epoch: 19, Steps: 13 | Train Loss: 0.206 Vali Loss: 0.629 Vali Acc: 0.751 Test Loss: 0.629 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.869765758514404
Epoch: 20, Steps: 13 | Train Loss: 0.215 Vali Loss: 0.700 Vali Acc: 0.732 Test Loss: 0.700 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 4.828497886657715
Epoch: 21, Steps: 13 | Train Loss: 0.191 Vali Loss: 0.720 Vali Acc: 0.678 Test Loss: 0.720 Test Acc: 0.678
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.746453762054443
Epoch: 22, Steps: 13 | Train Loss: 0.267 Vali Loss: 1.211 Vali Acc: 0.727 Test Loss: 1.211 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.434748888015747
Epoch: 23, Steps: 13 | Train Loss: 0.253 Vali Loss: 0.791 Vali Acc: 0.629 Test Loss: 0.791 Test Acc: 0.629
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7804878048780488
model parameter : 851550
model size : 4.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.74889874458313
Epoch: 1, Steps: 13 | Train Loss: 0.605 Vali Loss: 0.599 Vali Acc: 0.712 Test Loss: 0.599 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 4.63519024848938
Epoch: 2, Steps: 13 | Train Loss: 0.610 Vali Loss: 0.650 Vali Acc: 0.722 Test Loss: 0.650 Test Acc: 0.722
Validation loss decreased (-0.712189 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 5.212718963623047
Epoch: 3, Steps: 13 | Train Loss: 0.585 Vali Loss: 0.589 Vali Acc: 0.732 Test Loss: 0.589 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731701).  Saving model ...
Epoch: 4 cost time: 5.169008255004883
Epoch: 4, Steps: 13 | Train Loss: 0.580 Vali Loss: 0.534 Vali Acc: 0.741 Test Loss: 0.534 Test Acc: 0.741
Validation loss decreased (-0.731701 --> -0.741458).  Saving model ...
Epoch: 5 cost time: 4.160776376724243
Epoch: 5, Steps: 13 | Train Loss: 0.630 Vali Loss: 0.528 Vali Acc: 0.732 Test Loss: 0.528 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.761236667633057
Epoch: 6, Steps: 13 | Train Loss: 0.666 Vali Loss: 0.563 Vali Acc: 0.741 Test Loss: 0.563 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.811407089233398
Epoch: 7, Steps: 13 | Train Loss: 0.510 Vali Loss: 0.501 Vali Acc: 0.756 Test Loss: 0.501 Test Acc: 0.756
Validation loss decreased (-0.741458 --> -0.756093).  Saving model ...
Epoch: 8 cost time: 4.442298173904419
Epoch: 8, Steps: 13 | Train Loss: 0.456 Vali Loss: 0.646 Vali Acc: 0.727 Test Loss: 0.646 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.25247859954834
Epoch: 9, Steps: 13 | Train Loss: 0.459 Vali Loss: 0.521 Vali Acc: 0.717 Test Loss: 0.521 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.863245010375977
Epoch: 10, Steps: 13 | Train Loss: 0.428 Vali Loss: 0.674 Vali Acc: 0.741 Test Loss: 0.674 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.852470636367798
Epoch: 11, Steps: 13 | Train Loss: 0.427 Vali Loss: 0.518 Vali Acc: 0.727 Test Loss: 0.518 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.157506942749023
Epoch: 12, Steps: 13 | Train Loss: 0.363 Vali Loss: 0.678 Vali Acc: 0.732 Test Loss: 0.678 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.801630258560181
Epoch: 13, Steps: 13 | Train Loss: 0.387 Vali Loss: 0.843 Vali Acc: 0.507 Test Loss: 0.843 Test Acc: 0.507
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.1221582889556885
Epoch: 14, Steps: 13 | Train Loss: 0.289 Vali Loss: 0.636 Vali Acc: 0.756 Test Loss: 0.636 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.6018595695495605
Epoch: 15, Steps: 13 | Train Loss: 0.329 Vali Loss: 0.608 Vali Acc: 0.722 Test Loss: 0.608 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.807636022567749
Epoch: 16, Steps: 13 | Train Loss: 0.255 Vali Loss: 0.868 Vali Acc: 0.732 Test Loss: 0.868 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.800876140594482
Epoch: 17, Steps: 13 | Train Loss: 0.455 Vali Loss: 1.061 Vali Acc: 0.732 Test Loss: 1.061 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 849470
model size : 4.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.035069465637207
Epoch: 1, Steps: 13 | Train Loss: 0.621 Vali Loss: 0.648 Vali Acc: 0.722 Test Loss: 0.648 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 3.630150079727173
Epoch: 2, Steps: 13 | Train Loss: 0.642 Vali Loss: 0.579 Vali Acc: 0.722 Test Loss: 0.579 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 3.8035314083099365
Epoch: 3, Steps: 13 | Train Loss: 0.628 Vali Loss: 0.564 Vali Acc: 0.717 Test Loss: 0.564 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.7540106773376465
Epoch: 4, Steps: 13 | Train Loss: 0.610 Vali Loss: 0.547 Vali Acc: 0.732 Test Loss: 0.547 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 5 cost time: 3.864779233932495
Epoch: 5, Steps: 13 | Train Loss: 0.552 Vali Loss: 0.583 Vali Acc: 0.717 Test Loss: 0.583 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.896056413650513
Epoch: 6, Steps: 13 | Train Loss: 0.541 Vali Loss: 0.584 Vali Acc: 0.737 Test Loss: 0.584 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736580).  Saving model ...
Epoch: 7 cost time: 5.365898847579956
Epoch: 7, Steps: 13 | Train Loss: 0.556 Vali Loss: 0.578 Vali Acc: 0.727 Test Loss: 0.578 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.796720743179321
Epoch: 8, Steps: 13 | Train Loss: 0.498 Vali Loss: 0.593 Vali Acc: 0.683 Test Loss: 0.593 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.002822637557983
Epoch: 9, Steps: 13 | Train Loss: 0.451 Vali Loss: 0.792 Vali Acc: 0.722 Test Loss: 0.792 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.75080943107605
Epoch: 10, Steps: 13 | Train Loss: 0.476 Vali Loss: 0.759 Vali Acc: 0.546 Test Loss: 0.759 Test Acc: 0.546
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.176056861877441
Epoch: 11, Steps: 13 | Train Loss: 0.625 Vali Loss: 0.970 Vali Acc: 0.502 Test Loss: 0.970 Test Acc: 0.502
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.085145473480225
Epoch: 12, Steps: 13 | Train Loss: 0.448 Vali Loss: 0.792 Vali Acc: 0.722 Test Loss: 0.792 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.4047887325286865
Epoch: 13, Steps: 13 | Train Loss: 0.415 Vali Loss: 0.759 Vali Acc: 0.746 Test Loss: 0.759 Test Acc: 0.746
Validation loss decreased (-0.736580 --> -0.746334).  Saving model ...
Epoch: 14 cost time: 4.604953050613403
Epoch: 14, Steps: 13 | Train Loss: 0.420 Vali Loss: 0.530 Vali Acc: 0.756 Test Loss: 0.530 Test Acc: 0.756
Validation loss decreased (-0.746334 --> -0.756092).  Saving model ...
Epoch: 15 cost time: 4.714872598648071
Epoch: 15, Steps: 13 | Train Loss: 0.340 Vali Loss: 0.552 Vali Acc: 0.722 Test Loss: 0.552 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.340081691741943
Epoch: 16, Steps: 13 | Train Loss: 0.317 Vali Loss: 0.548 Vali Acc: 0.737 Test Loss: 0.548 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.850463151931763
Epoch: 17, Steps: 13 | Train Loss: 0.302 Vali Loss: 0.944 Vali Acc: 0.732 Test Loss: 0.944 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.253182888031006
Epoch: 18, Steps: 13 | Train Loss: 0.345 Vali Loss: 0.595 Vali Acc: 0.746 Test Loss: 0.595 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 5.152928113937378
Epoch: 19, Steps: 13 | Train Loss: 0.281 Vali Loss: 0.640 Vali Acc: 0.639 Test Loss: 0.640 Test Acc: 0.639
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.493530511856079
Epoch: 20, Steps: 13 | Train Loss: 0.281 Vali Loss: 0.611 Vali Acc: 0.722 Test Loss: 0.611 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.773080587387085
Epoch: 21, Steps: 13 | Train Loss: 0.243 Vali Loss: 0.962 Vali Acc: 0.727 Test Loss: 0.962 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 6.009624481201172
Epoch: 22, Steps: 13 | Train Loss: 0.186 Vali Loss: 1.085 Vali Acc: 0.546 Test Loss: 1.085 Test Acc: 0.546
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 5.283889293670654
Epoch: 23, Steps: 13 | Train Loss: 0.357 Vali Loss: 0.759 Vali Acc: 0.629 Test Loss: 0.759 Test Acc: 0.629
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 5.0028016567230225
Epoch: 24, Steps: 13 | Train Loss: 0.189 Vali Loss: 0.678 Vali Acc: 0.629 Test Loss: 0.678 Test Acc: 0.629
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 847390
model size : 4.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.144838333129883
Epoch: 1, Steps: 13 | Train Loss: 0.620 Vali Loss: 0.617 Vali Acc: 0.717 Test Loss: 0.617 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 4.635890483856201
Epoch: 2, Steps: 13 | Train Loss: 0.615 Vali Loss: 0.595 Vali Acc: 0.722 Test Loss: 0.595 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 4.571633815765381
Epoch: 3, Steps: 13 | Train Loss: 0.602 Vali Loss: 0.626 Vali Acc: 0.761 Test Loss: 0.626 Test Acc: 0.761
Validation loss decreased (-0.721945 --> -0.760969).  Saving model ...
Epoch: 4 cost time: 4.9538795948028564
Epoch: 4, Steps: 13 | Train Loss: 0.622 Vali Loss: 0.661 Vali Acc: 0.654 Test Loss: 0.661 Test Acc: 0.654
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.700871229171753
Epoch: 5, Steps: 13 | Train Loss: 0.562 Vali Loss: 0.691 Vali Acc: 0.512 Test Loss: 0.691 Test Acc: 0.512
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.358032703399658
Epoch: 6, Steps: 13 | Train Loss: 0.656 Vali Loss: 0.623 Vali Acc: 0.663 Test Loss: 0.623 Test Acc: 0.663
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.949747323989868
Epoch: 7, Steps: 13 | Train Loss: 0.538 Vali Loss: 0.607 Vali Acc: 0.732 Test Loss: 0.607 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.4168851375579834
Epoch: 8, Steps: 13 | Train Loss: 0.479 Vali Loss: 0.599 Vali Acc: 0.668 Test Loss: 0.599 Test Acc: 0.668
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.015843629837036
Epoch: 9, Steps: 13 | Train Loss: 0.514 Vali Loss: 0.544 Vali Acc: 0.741 Test Loss: 0.544 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.802430629730225
Epoch: 10, Steps: 13 | Train Loss: 0.570 Vali Loss: 0.530 Vali Acc: 0.737 Test Loss: 0.530 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.9397194385528564
Epoch: 11, Steps: 13 | Train Loss: 0.443 Vali Loss: 0.523 Vali Acc: 0.737 Test Loss: 0.523 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.146403074264526
Epoch: 12, Steps: 13 | Train Loss: 0.374 Vali Loss: 0.542 Vali Acc: 0.717 Test Loss: 0.542 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.135160207748413
Epoch: 13, Steps: 13 | Train Loss: 0.545 Vali Loss: 1.042 Vali Acc: 0.420 Test Loss: 1.042 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 845310
model size : 4.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.887620449066162
Epoch: 1, Steps: 13 | Train Loss: 0.619 Vali Loss: 0.585 Vali Acc: 0.722 Test Loss: 0.585 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 5.028207302093506
Epoch: 2, Steps: 13 | Train Loss: 0.626 Vali Loss: 0.589 Vali Acc: 0.722 Test Loss: 0.589 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.9381163120269775
Epoch: 3, Steps: 13 | Train Loss: 0.573 Vali Loss: 0.647 Vali Acc: 0.722 Test Loss: 0.647 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.867277383804321
Epoch: 4, Steps: 13 | Train Loss: 0.586 Vali Loss: 0.679 Vali Acc: 0.722 Test Loss: 0.679 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.568685531616211
Epoch: 5, Steps: 13 | Train Loss: 0.613 Vali Loss: 0.580 Vali Acc: 0.722 Test Loss: 0.580 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 6 cost time: 4.517880439758301
Epoch: 6, Steps: 13 | Train Loss: 0.503 Vali Loss: 0.523 Vali Acc: 0.761 Test Loss: 0.523 Test Acc: 0.761
Validation loss decreased (-0.721945 --> -0.760970).  Saving model ...
Epoch: 7 cost time: 4.172278165817261
Epoch: 7, Steps: 13 | Train Loss: 0.552 Vali Loss: 0.659 Vali Acc: 0.639 Test Loss: 0.659 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.36025595664978
Epoch: 8, Steps: 13 | Train Loss: 0.563 Vali Loss: 0.513 Vali Acc: 0.741 Test Loss: 0.513 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.9644765853881836
Epoch: 9, Steps: 13 | Train Loss: 0.473 Vali Loss: 0.521 Vali Acc: 0.761 Test Loss: 0.521 Test Acc: 0.761
Validation loss decreased (-0.760970 --> -0.760970).  Saving model ...
Epoch: 10 cost time: 4.49508810043335
Epoch: 10, Steps: 13 | Train Loss: 0.515 Vali Loss: 0.817 Vali Acc: 0.468 Test Loss: 0.817 Test Acc: 0.468
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.235171556472778
Epoch: 11, Steps: 13 | Train Loss: 0.432 Vali Loss: 0.659 Vali Acc: 0.727 Test Loss: 0.659 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.3320486545562744
Epoch: 12, Steps: 13 | Train Loss: 0.485 Vali Loss: 0.507 Vali Acc: 0.771 Test Loss: 0.507 Test Acc: 0.771
Validation loss decreased (-0.760970 --> -0.770727).  Saving model ...
Epoch: 13 cost time: 3.7475264072418213
Epoch: 13, Steps: 13 | Train Loss: 0.399 Vali Loss: 0.514 Vali Acc: 0.751 Test Loss: 0.514 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.296348571777344
Epoch: 14, Steps: 13 | Train Loss: 0.385 Vali Loss: 0.575 Vali Acc: 0.673 Test Loss: 0.575 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.9333481788635254
Epoch: 15, Steps: 13 | Train Loss: 0.423 Vali Loss: 0.688 Vali Acc: 0.746 Test Loss: 0.688 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.3415796756744385
Epoch: 16, Steps: 13 | Train Loss: 0.410 Vali Loss: 0.635 Vali Acc: 0.629 Test Loss: 0.635 Test Acc: 0.629
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.937241554260254
Epoch: 17, Steps: 13 | Train Loss: 0.417 Vali Loss: 0.591 Vali Acc: 0.766 Test Loss: 0.591 Test Acc: 0.766
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.262662649154663
Epoch: 18, Steps: 13 | Train Loss: 0.291 Vali Loss: 0.652 Vali Acc: 0.629 Test Loss: 0.652 Test Acc: 0.629
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.792168140411377
Epoch: 19, Steps: 13 | Train Loss: 0.320 Vali Loss: 0.622 Vali Acc: 0.654 Test Loss: 0.622 Test Acc: 0.654
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.945056438446045
Epoch: 20, Steps: 13 | Train Loss: 0.278 Vali Loss: 0.680 Vali Acc: 0.766 Test Loss: 0.680 Test Acc: 0.766
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.691225051879883
Epoch: 21, Steps: 13 | Train Loss: 0.278 Vali Loss: 0.683 Vali Acc: 0.654 Test Loss: 0.683 Test Acc: 0.654
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.534359931945801
Epoch: 22, Steps: 13 | Train Loss: 0.265 Vali Loss: 0.636 Vali Acc: 0.668 Test Loss: 0.636 Test Acc: 0.668
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 552030
model size : 2.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.494424819946289
Epoch: 1, Steps: 13 | Train Loss: 0.647 Vali Loss: 0.600 Vali Acc: 0.717 Test Loss: 0.600 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 4.455929279327393
Epoch: 2, Steps: 13 | Train Loss: 0.674 Vali Loss: 0.600 Vali Acc: 0.717 Test Loss: 0.600 Test Acc: 0.717
Validation loss decreased (-0.717067 --> -0.717067).  Saving model ...
Epoch: 3 cost time: 4.49226188659668
Epoch: 3, Steps: 13 | Train Loss: 0.598 Vali Loss: 0.591 Vali Acc: 0.732 Test Loss: 0.591 Test Acc: 0.732
Validation loss decreased (-0.717067 --> -0.731701).  Saving model ...
Epoch: 4 cost time: 4.352781534194946
Epoch: 4, Steps: 13 | Train Loss: 0.596 Vali Loss: 0.578 Vali Acc: 0.741 Test Loss: 0.578 Test Acc: 0.741
Validation loss decreased (-0.731701 --> -0.741458).  Saving model ...
Epoch: 5 cost time: 4.387596130371094
Epoch: 5, Steps: 13 | Train Loss: 0.566 Vali Loss: 0.557 Vali Acc: 0.727 Test Loss: 0.557 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.970028400421143
Epoch: 6, Steps: 13 | Train Loss: 0.536 Vali Loss: 0.522 Vali Acc: 0.732 Test Loss: 0.522 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.6310484409332275
Epoch: 7, Steps: 13 | Train Loss: 0.573 Vali Loss: 0.621 Vali Acc: 0.659 Test Loss: 0.621 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.568530082702637
Epoch: 8, Steps: 13 | Train Loss: 0.511 Vali Loss: 0.813 Vali Acc: 0.498 Test Loss: 0.813 Test Acc: 0.498
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.901739120483398
Epoch: 9, Steps: 13 | Train Loss: 0.646 Vali Loss: 1.030 Vali Acc: 0.449 Test Loss: 1.030 Test Acc: 0.449
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.846890211105347
Epoch: 10, Steps: 13 | Train Loss: 0.617 Vali Loss: 0.517 Vali Acc: 0.741 Test Loss: 0.517 Test Acc: 0.741
Validation loss decreased (-0.741458 --> -0.741458).  Saving model ...
Epoch: 11 cost time: 4.8791961669921875
Epoch: 11, Steps: 13 | Train Loss: 0.502 Vali Loss: 0.576 Vali Acc: 0.741 Test Loss: 0.576 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.189768552780151
Epoch: 12, Steps: 13 | Train Loss: 0.472 Vali Loss: 0.600 Vali Acc: 0.678 Test Loss: 0.600 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.790954828262329
Epoch: 13, Steps: 13 | Train Loss: 0.453 Vali Loss: 0.630 Vali Acc: 0.634 Test Loss: 0.630 Test Acc: 0.634
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.995333671569824
Epoch: 14, Steps: 13 | Train Loss: 0.529 Vali Loss: 1.184 Vali Acc: 0.468 Test Loss: 1.184 Test Acc: 0.468
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.998626708984375
Epoch: 15, Steps: 13 | Train Loss: 0.552 Vali Loss: 0.654 Vali Acc: 0.654 Test Loss: 0.654 Test Acc: 0.654
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.0724856853485107
Epoch: 16, Steps: 13 | Train Loss: 0.347 Vali Loss: 0.557 Vali Acc: 0.727 Test Loss: 0.557 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.0715954303741455
Epoch: 17, Steps: 13 | Train Loss: 0.561 Vali Loss: 0.759 Vali Acc: 0.605 Test Loss: 0.759 Test Acc: 0.605
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.3460428714752197
Epoch: 18, Steps: 13 | Train Loss: 0.306 Vali Loss: 0.571 Vali Acc: 0.746 Test Loss: 0.571 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746336).  Saving model ...
Epoch: 19 cost time: 5.3420045375823975
Epoch: 19, Steps: 13 | Train Loss: 0.281 Vali Loss: 0.659 Vali Acc: 0.702 Test Loss: 0.659 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.564718723297119
Epoch: 20, Steps: 13 | Train Loss: 0.377 Vali Loss: 0.917 Vali Acc: 0.737 Test Loss: 0.917 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.743230819702148
Epoch: 21, Steps: 13 | Train Loss: 0.296 Vali Loss: 0.792 Vali Acc: 0.629 Test Loss: 0.792 Test Acc: 0.629
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.63364315032959
Epoch: 22, Steps: 13 | Train Loss: 0.196 Vali Loss: 0.673 Vali Acc: 0.746 Test Loss: 0.673 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.019792079925537
Epoch: 23, Steps: 13 | Train Loss: 0.238 Vali Loss: 0.845 Vali Acc: 0.634 Test Loss: 0.845 Test Acc: 0.634
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.9232177734375
Epoch: 24, Steps: 13 | Train Loss: 0.199 Vali Loss: 0.998 Vali Acc: 0.737 Test Loss: 0.998 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 4.506398439407349
Epoch: 25, Steps: 13 | Train Loss: 0.248 Vali Loss: 0.792 Vali Acc: 0.605 Test Loss: 0.792 Test Acc: 0.605
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.631572961807251
Epoch: 26, Steps: 13 | Train Loss: 0.127 Vali Loss: 0.766 Vali Acc: 0.702 Test Loss: 0.766 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.8255531787872314
Epoch: 27, Steps: 13 | Train Loss: 0.154 Vali Loss: 0.825 Vali Acc: 0.707 Test Loss: 0.825 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 4.10035514831543
Epoch: 28, Steps: 13 | Train Loss: 0.098 Vali Loss: 0.885 Vali Acc: 0.644 Test Loss: 0.885 Test Acc: 0.644
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 549950
model size : 2.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.248409032821655
Epoch: 1, Steps: 13 | Train Loss: 0.676 Vali Loss: 0.592 Vali Acc: 0.712 Test Loss: 0.592 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 3.5790512561798096
Epoch: 2, Steps: 13 | Train Loss: 0.640 Vali Loss: 0.688 Vali Acc: 0.712 Test Loss: 0.688 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.001351833343506
Epoch: 3, Steps: 13 | Train Loss: 0.625 Vali Loss: 0.727 Vali Acc: 0.722 Test Loss: 0.727 Test Acc: 0.722
Validation loss decreased (-0.712189 --> -0.721944).  Saving model ...
Epoch: 4 cost time: 4.192891359329224
Epoch: 4, Steps: 13 | Train Loss: 0.662 Vali Loss: 0.691 Vali Acc: 0.722 Test Loss: 0.691 Test Acc: 0.722
Validation loss decreased (-0.721944 --> -0.721944).  Saving model ...
Epoch: 5 cost time: 3.6525371074676514
Epoch: 5, Steps: 13 | Train Loss: 0.608 Vali Loss: 0.561 Vali Acc: 0.722 Test Loss: 0.561 Test Acc: 0.722
Validation loss decreased (-0.721944 --> -0.721946).  Saving model ...
Epoch: 6 cost time: 5.155003070831299
Epoch: 6, Steps: 13 | Train Loss: 0.512 Vali Loss: 0.520 Vali Acc: 0.756 Test Loss: 0.520 Test Acc: 0.756
Validation loss decreased (-0.721946 --> -0.756092).  Saving model ...
Epoch: 7 cost time: 3.7130374908447266
Epoch: 7, Steps: 13 | Train Loss: 0.486 Vali Loss: 0.660 Vali Acc: 0.722 Test Loss: 0.660 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.496451377868652
Epoch: 8, Steps: 13 | Train Loss: 0.503 Vali Loss: 0.614 Vali Acc: 0.615 Test Loss: 0.614 Test Acc: 0.615
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.9801812171936035
Epoch: 9, Steps: 13 | Train Loss: 0.600 Vali Loss: 0.529 Vali Acc: 0.751 Test Loss: 0.529 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.424143075942993
Epoch: 10, Steps: 13 | Train Loss: 0.486 Vali Loss: 0.543 Vali Acc: 0.737 Test Loss: 0.543 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.3542234897613525
Epoch: 11, Steps: 13 | Train Loss: 0.448 Vali Loss: 0.543 Vali Acc: 0.712 Test Loss: 0.543 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.665573358535767
Epoch: 12, Steps: 13 | Train Loss: 0.491 Vali Loss: 0.634 Vali Acc: 0.746 Test Loss: 0.634 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.589085340499878
Epoch: 13, Steps: 13 | Train Loss: 0.417 Vali Loss: 0.521 Vali Acc: 0.732 Test Loss: 0.521 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.555084466934204
Epoch: 14, Steps: 13 | Train Loss: 0.416 Vali Loss: 0.582 Vali Acc: 0.673 Test Loss: 0.582 Test Acc: 0.673
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.285239219665527
Epoch: 15, Steps: 13 | Train Loss: 0.388 Vali Loss: 0.522 Vali Acc: 0.766 Test Loss: 0.522 Test Acc: 0.766
Validation loss decreased (-0.756092 --> -0.765848).  Saving model ...
Epoch: 16 cost time: 3.9494059085845947
Epoch: 16, Steps: 13 | Train Loss: 0.339 Vali Loss: 0.772 Vali Acc: 0.741 Test Loss: 0.772 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.470881223678589
Epoch: 17, Steps: 13 | Train Loss: 0.522 Vali Loss: 0.750 Vali Acc: 0.741 Test Loss: 0.750 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.8062632083892822
Epoch: 18, Steps: 13 | Train Loss: 0.269 Vali Loss: 0.615 Vali Acc: 0.771 Test Loss: 0.615 Test Acc: 0.771
Validation loss decreased (-0.765848 --> -0.770726).  Saving model ...
Epoch: 19 cost time: 3.3943240642547607
Epoch: 19, Steps: 13 | Train Loss: 0.320 Vali Loss: 0.708 Vali Acc: 0.566 Test Loss: 0.708 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.9565207958221436
Epoch: 20, Steps: 13 | Train Loss: 0.470 Vali Loss: 0.827 Vali Acc: 0.561 Test Loss: 0.827 Test Acc: 0.561
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.229918956756592
Epoch: 21, Steps: 13 | Train Loss: 0.486 Vali Loss: 0.783 Vali Acc: 0.605 Test Loss: 0.783 Test Acc: 0.605
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.367097616195679
Epoch: 22, Steps: 13 | Train Loss: 0.217 Vali Loss: 0.653 Vali Acc: 0.746 Test Loss: 0.653 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.900697708129883
Epoch: 23, Steps: 13 | Train Loss: 0.148 Vali Loss: 0.601 Vali Acc: 0.727 Test Loss: 0.601 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 4.044143915176392
Epoch: 24, Steps: 13 | Train Loss: 0.168 Vali Loss: 0.894 Vali Acc: 0.737 Test Loss: 0.894 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 4.448945045471191
Epoch: 25, Steps: 13 | Train Loss: 0.113 Vali Loss: 1.172 Vali Acc: 0.517 Test Loss: 1.172 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 4.784986257553101
Epoch: 26, Steps: 13 | Train Loss: 0.191 Vali Loss: 0.697 Vali Acc: 0.717 Test Loss: 0.697 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 4.282886028289795
Epoch: 27, Steps: 13 | Train Loss: 0.094 Vali Loss: 0.774 Vali Acc: 0.746 Test Loss: 0.774 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 4.1440513134002686
Epoch: 28, Steps: 13 | Train Loss: 0.082 Vali Loss: 0.879 Vali Acc: 0.761 Test Loss: 0.879 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 547870
model size : 2.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.334091424942017
Epoch: 1, Steps: 13 | Train Loss: 0.636 Vali Loss: 0.604 Vali Acc: 0.717 Test Loss: 0.604 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 4.018744468688965
Epoch: 2, Steps: 13 | Train Loss: 0.644 Vali Loss: 0.605 Vali Acc: 0.722 Test Loss: 0.605 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 3.755899429321289
Epoch: 3, Steps: 13 | Train Loss: 0.578 Vali Loss: 0.566 Vali Acc: 0.717 Test Loss: 0.566 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.5709545612335205
Epoch: 4, Steps: 13 | Train Loss: 0.532 Vali Loss: 0.548 Vali Acc: 0.722 Test Loss: 0.548 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721946).  Saving model ...
Epoch: 5 cost time: 3.9550769329071045
Epoch: 5, Steps: 13 | Train Loss: 0.522 Vali Loss: 0.636 Vali Acc: 0.654 Test Loss: 0.636 Test Acc: 0.654
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.842181921005249
Epoch: 6, Steps: 13 | Train Loss: 0.589 Vali Loss: 0.519 Vali Acc: 0.737 Test Loss: 0.519 Test Acc: 0.737
Validation loss decreased (-0.721946 --> -0.736580).  Saving model ...
Epoch: 7 cost time: 3.8955936431884766
Epoch: 7, Steps: 13 | Train Loss: 0.508 Vali Loss: 0.645 Vali Acc: 0.722 Test Loss: 0.645 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.7392337322235107
Epoch: 8, Steps: 13 | Train Loss: 0.539 Vali Loss: 0.510 Vali Acc: 0.761 Test Loss: 0.510 Test Acc: 0.761
Validation loss decreased (-0.736580 --> -0.760971).  Saving model ...
Epoch: 9 cost time: 3.823732852935791
Epoch: 9, Steps: 13 | Train Loss: 0.527 Vali Loss: 0.615 Vali Acc: 0.722 Test Loss: 0.615 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.337024450302124
Epoch: 10, Steps: 13 | Train Loss: 0.533 Vali Loss: 0.683 Vali Acc: 0.732 Test Loss: 0.683 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.751675128936768
Epoch: 11, Steps: 13 | Train Loss: 0.516 Vali Loss: 0.589 Vali Acc: 0.654 Test Loss: 0.589 Test Acc: 0.654
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.431732416152954
Epoch: 12, Steps: 13 | Train Loss: 0.443 Vali Loss: 0.506 Vali Acc: 0.761 Test Loss: 0.506 Test Acc: 0.761
Validation loss decreased (-0.760971 --> -0.760971).  Saving model ...
Epoch: 13 cost time: 4.43835711479187
Epoch: 13, Steps: 13 | Train Loss: 0.371 Vali Loss: 0.539 Vali Acc: 0.776 Test Loss: 0.539 Test Acc: 0.776
Validation loss decreased (-0.760971 --> -0.775604).  Saving model ...
Epoch: 14 cost time: 4.465437412261963
Epoch: 14, Steps: 13 | Train Loss: 0.374 Vali Loss: 0.615 Vali Acc: 0.727 Test Loss: 0.615 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.589265823364258
Epoch: 15, Steps: 13 | Train Loss: 0.329 Vali Loss: 0.537 Vali Acc: 0.761 Test Loss: 0.537 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.709838390350342
Epoch: 16, Steps: 13 | Train Loss: 0.372 Vali Loss: 0.710 Vali Acc: 0.624 Test Loss: 0.710 Test Acc: 0.624
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.371635675430298
Epoch: 17, Steps: 13 | Train Loss: 0.265 Vali Loss: 0.572 Vali Acc: 0.702 Test Loss: 0.572 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.528703451156616
Epoch: 18, Steps: 13 | Train Loss: 0.314 Vali Loss: 0.798 Vali Acc: 0.741 Test Loss: 0.798 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.542758464813232
Epoch: 19, Steps: 13 | Train Loss: 0.305 Vali Loss: 1.645 Vali Acc: 0.429 Test Loss: 1.645 Test Acc: 0.429
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.856549978256226
Epoch: 20, Steps: 13 | Train Loss: 0.555 Vali Loss: 0.765 Vali Acc: 0.688 Test Loss: 0.765 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.961841344833374
Epoch: 21, Steps: 13 | Train Loss: 0.231 Vali Loss: 0.710 Vali Acc: 0.624 Test Loss: 0.710 Test Acc: 0.624
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.8203024864196777
Epoch: 22, Steps: 13 | Train Loss: 0.193 Vali Loss: 0.667 Vali Acc: 0.737 Test Loss: 0.667 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.948547601699829
Epoch: 23, Steps: 13 | Train Loss: 0.193 Vali Loss: 0.775 Vali Acc: 0.629 Test Loss: 0.775 Test Acc: 0.629
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 545790
model size : 2.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.889775276184082
Epoch: 1, Steps: 13 | Train Loss: 0.636 Vali Loss: 0.600 Vali Acc: 0.722 Test Loss: 0.600 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.1033923625946045
Epoch: 2, Steps: 13 | Train Loss: 0.573 Vali Loss: 0.639 Vali Acc: 0.722 Test Loss: 0.639 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.480837821960449
Epoch: 3, Steps: 13 | Train Loss: 0.590 Vali Loss: 0.562 Vali Acc: 0.732 Test Loss: 0.562 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 4 cost time: 4.648932456970215
Epoch: 4, Steps: 13 | Train Loss: 0.547 Vali Loss: 0.549 Vali Acc: 0.751 Test Loss: 0.549 Test Acc: 0.751
Validation loss decreased (-0.731702 --> -0.751214).  Saving model ...
Epoch: 5 cost time: 4.246712684631348
Epoch: 5, Steps: 13 | Train Loss: 0.611 Vali Loss: 0.969 Vali Acc: 0.346 Test Loss: 0.969 Test Acc: 0.346
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.237900972366333
Epoch: 6, Steps: 13 | Train Loss: 0.689 Vali Loss: 0.546 Vali Acc: 0.727 Test Loss: 0.546 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.990906000137329
Epoch: 7, Steps: 13 | Train Loss: 0.532 Vali Loss: 0.777 Vali Acc: 0.507 Test Loss: 0.777 Test Acc: 0.507
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.734287977218628
Epoch: 8, Steps: 13 | Train Loss: 0.642 Vali Loss: 0.731 Vali Acc: 0.600 Test Loss: 0.731 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.731877326965332
Epoch: 9, Steps: 13 | Train Loss: 0.485 Vali Loss: 0.536 Vali Acc: 0.717 Test Loss: 0.536 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.37935733795166
Epoch: 10, Steps: 13 | Train Loss: 0.590 Vali Loss: 0.615 Vali Acc: 0.649 Test Loss: 0.615 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.081153154373169
Epoch: 11, Steps: 13 | Train Loss: 0.519 Vali Loss: 0.516 Vali Acc: 0.737 Test Loss: 0.516 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.5587408542633057
Epoch: 12, Steps: 13 | Train Loss: 0.403 Vali Loss: 0.659 Vali Acc: 0.727 Test Loss: 0.659 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.311760187149048
Epoch: 13, Steps: 13 | Train Loss: 0.473 Vali Loss: 0.531 Vali Acc: 0.717 Test Loss: 0.531 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.657830715179443
Epoch: 14, Steps: 13 | Train Loss: 0.596 Vali Loss: 0.656 Vali Acc: 0.629 Test Loss: 0.656 Test Acc: 0.629
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 402270
model size : 2.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.412540435791016
Epoch: 1, Steps: 13 | Train Loss: 0.690 Vali Loss: 0.583 Vali Acc: 0.722 Test Loss: 0.583 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 3.9716391563415527
Epoch: 2, Steps: 13 | Train Loss: 0.628 Vali Loss: 0.654 Vali Acc: 0.722 Test Loss: 0.654 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.11423659324646
Epoch: 3, Steps: 13 | Train Loss: 0.674 Vali Loss: 0.619 Vali Acc: 0.722 Test Loss: 0.619 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.4458541870117188
Epoch: 4, Steps: 13 | Train Loss: 0.578 Vali Loss: 0.564 Vali Acc: 0.712 Test Loss: 0.564 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.34622049331665
Epoch: 5, Steps: 13 | Train Loss: 0.591 Vali Loss: 0.597 Vali Acc: 0.712 Test Loss: 0.597 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.8598251342773438
Epoch: 6, Steps: 13 | Train Loss: 0.564 Vali Loss: 0.554 Vali Acc: 0.722 Test Loss: 0.554 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721946).  Saving model ...
Epoch: 7 cost time: 4.512293100357056
Epoch: 7, Steps: 13 | Train Loss: 0.586 Vali Loss: 0.568 Vali Acc: 0.722 Test Loss: 0.568 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.175963640213013
Epoch: 8, Steps: 13 | Train Loss: 0.520 Vali Loss: 0.594 Vali Acc: 0.668 Test Loss: 0.594 Test Acc: 0.668
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.631180763244629
Epoch: 9, Steps: 13 | Train Loss: 0.551 Vali Loss: 0.625 Vali Acc: 0.634 Test Loss: 0.625 Test Acc: 0.634
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.447932243347168
Epoch: 10, Steps: 13 | Train Loss: 0.532 Vali Loss: 0.510 Vali Acc: 0.766 Test Loss: 0.510 Test Acc: 0.766
Validation loss decreased (-0.721946 --> -0.765849).  Saving model ...
Epoch: 11 cost time: 3.215944528579712
Epoch: 11, Steps: 13 | Train Loss: 0.520 Vali Loss: 0.821 Vali Acc: 0.722 Test Loss: 0.821 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.733111381530762
Epoch: 12, Steps: 13 | Train Loss: 0.441 Vali Loss: 0.520 Vali Acc: 0.771 Test Loss: 0.520 Test Acc: 0.771
Validation loss decreased (-0.765849 --> -0.770727).  Saving model ...
Epoch: 13 cost time: 6.318359375
Epoch: 13, Steps: 13 | Train Loss: 0.455 Vali Loss: 0.500 Vali Acc: 0.746 Test Loss: 0.500 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.882415533065796
Epoch: 14, Steps: 13 | Train Loss: 0.438 Vali Loss: 0.628 Vali Acc: 0.624 Test Loss: 0.628 Test Acc: 0.624
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.738100528717041
Epoch: 15, Steps: 13 | Train Loss: 0.344 Vali Loss: 0.541 Vali Acc: 0.737 Test Loss: 0.541 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.229348659515381
Epoch: 16, Steps: 13 | Train Loss: 0.303 Vali Loss: 0.910 Vali Acc: 0.722 Test Loss: 0.910 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.217767000198364
Epoch: 17, Steps: 13 | Train Loss: 0.461 Vali Loss: 0.540 Vali Acc: 0.751 Test Loss: 0.540 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.73945164680481
Epoch: 18, Steps: 13 | Train Loss: 0.315 Vali Loss: 0.548 Vali Acc: 0.727 Test Loss: 0.548 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 5.586158037185669
Epoch: 19, Steps: 13 | Train Loss: 0.352 Vali Loss: 0.588 Vali Acc: 0.693 Test Loss: 0.588 Test Acc: 0.693
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.656712770462036
Epoch: 20, Steps: 13 | Train Loss: 0.381 Vali Loss: 1.078 Vali Acc: 0.741 Test Loss: 1.078 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.8978569507598877
Epoch: 21, Steps: 13 | Train Loss: 0.264 Vali Loss: 0.581 Vali Acc: 0.717 Test Loss: 0.581 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.9137661457061768
Epoch: 22, Steps: 13 | Train Loss: 0.201 Vali Loss: 0.594 Vali Acc: 0.698 Test Loss: 0.594 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 400190
model size : 2.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.0415449142456055
Epoch: 1, Steps: 13 | Train Loss: 0.633 Vali Loss: 0.590 Vali Acc: 0.722 Test Loss: 0.590 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.343981504440308
Epoch: 2, Steps: 13 | Train Loss: 0.604 Vali Loss: 0.575 Vali Acc: 0.722 Test Loss: 0.575 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 3.899738311767578
Epoch: 3, Steps: 13 | Train Loss: 0.603 Vali Loss: 0.571 Vali Acc: 0.722 Test Loss: 0.571 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721946).  Saving model ...
Epoch: 4 cost time: 3.5379860401153564
Epoch: 4, Steps: 13 | Train Loss: 0.575 Vali Loss: 0.672 Vali Acc: 0.600 Test Loss: 0.672 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.60092830657959
Epoch: 5, Steps: 13 | Train Loss: 0.612 Vali Loss: 0.546 Vali Acc: 0.732 Test Loss: 0.546 Test Acc: 0.732
Validation loss decreased (-0.721946 --> -0.731702).  Saving model ...
Epoch: 6 cost time: 3.6818885803222656
Epoch: 6, Steps: 13 | Train Loss: 0.518 Vali Loss: 0.552 Vali Acc: 0.732 Test Loss: 0.552 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.904165267944336
Epoch: 7, Steps: 13 | Train Loss: 0.519 Vali Loss: 0.567 Vali Acc: 0.722 Test Loss: 0.567 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.478667497634888
Epoch: 8, Steps: 13 | Train Loss: 0.501 Vali Loss: 0.818 Vali Acc: 0.502 Test Loss: 0.818 Test Acc: 0.502
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.350816965103149
Epoch: 9, Steps: 13 | Train Loss: 0.611 Vali Loss: 1.099 Vali Acc: 0.356 Test Loss: 1.099 Test Acc: 0.356
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.675782918930054
Epoch: 10, Steps: 13 | Train Loss: 0.641 Vali Loss: 1.111 Vali Acc: 0.371 Test Loss: 1.111 Test Acc: 0.371
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.696990013122559
Epoch: 11, Steps: 13 | Train Loss: 0.622 Vali Loss: 0.732 Vali Acc: 0.610 Test Loss: 0.732 Test Acc: 0.610
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.43947172164917
Epoch: 12, Steps: 13 | Train Loss: 0.477 Vali Loss: 0.566 Vali Acc: 0.746 Test Loss: 0.566 Test Acc: 0.746
Validation loss decreased (-0.731702 --> -0.746336).  Saving model ...
Epoch: 13 cost time: 4.368499994277954
Epoch: 13, Steps: 13 | Train Loss: 0.416 Vali Loss: 0.567 Vali Acc: 0.741 Test Loss: 0.567 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.219163179397583
Epoch: 14, Steps: 13 | Train Loss: 0.446 Vali Loss: 0.543 Vali Acc: 0.732 Test Loss: 0.543 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.7854537963867188
Epoch: 15, Steps: 13 | Train Loss: 0.341 Vali Loss: 0.709 Vali Acc: 0.727 Test Loss: 0.709 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.219072341918945
Epoch: 16, Steps: 13 | Train Loss: 0.360 Vali Loss: 0.640 Vali Acc: 0.673 Test Loss: 0.640 Test Acc: 0.673
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.666292190551758
Epoch: 17, Steps: 13 | Train Loss: 0.348 Vali Loss: 0.776 Vali Acc: 0.741 Test Loss: 0.776 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.031032085418701
Epoch: 18, Steps: 13 | Train Loss: 0.278 Vali Loss: 0.902 Vali Acc: 0.585 Test Loss: 0.902 Test Acc: 0.585
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.436007738113403
Epoch: 19, Steps: 13 | Train Loss: 0.320 Vali Loss: 0.822 Vali Acc: 0.737 Test Loss: 0.822 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.3130393028259277
Epoch: 20, Steps: 13 | Train Loss: 0.251 Vali Loss: 0.763 Vali Acc: 0.634 Test Loss: 0.763 Test Acc: 0.634
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.125415086746216
Epoch: 21, Steps: 13 | Train Loss: 0.272 Vali Loss: 1.463 Vali Acc: 0.722 Test Loss: 1.463 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.432514667510986
Epoch: 22, Steps: 13 | Train Loss: 0.390 Vali Loss: 1.415 Vali Acc: 0.732 Test Loss: 1.415 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 398110
model size : 2.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.457967519760132
Epoch: 1, Steps: 13 | Train Loss: 0.610 Vali Loss: 0.649 Vali Acc: 0.722 Test Loss: 0.649 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.291032314300537
Epoch: 2, Steps: 13 | Train Loss: 0.647 Vali Loss: 0.706 Vali Acc: 0.717 Test Loss: 0.706 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.459502935409546
Epoch: 3, Steps: 13 | Train Loss: 0.631 Vali Loss: 0.600 Vali Acc: 0.712 Test Loss: 0.600 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.323630332946777
Epoch: 4, Steps: 13 | Train Loss: 0.583 Vali Loss: 0.573 Vali Acc: 0.717 Test Loss: 0.573 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.303028345108032
Epoch: 5, Steps: 13 | Train Loss: 0.595 Vali Loss: 0.606 Vali Acc: 0.722 Test Loss: 0.606 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 6 cost time: 4.374128341674805
Epoch: 6, Steps: 13 | Train Loss: 0.564 Vali Loss: 0.542 Vali Acc: 0.727 Test Loss: 0.542 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726824).  Saving model ...
Epoch: 7 cost time: 4.351819276809692
Epoch: 7, Steps: 13 | Train Loss: 0.656 Vali Loss: 0.539 Vali Acc: 0.737 Test Loss: 0.539 Test Acc: 0.737
Validation loss decreased (-0.726824 --> -0.736580).  Saving model ...
Epoch: 8 cost time: 3.989887237548828
Epoch: 8, Steps: 13 | Train Loss: 0.603 Vali Loss: 0.553 Vali Acc: 0.712 Test Loss: 0.553 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.4473204612731934
Epoch: 9, Steps: 13 | Train Loss: 0.453 Vali Loss: 0.594 Vali Acc: 0.673 Test Loss: 0.594 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.096574783325195
Epoch: 10, Steps: 13 | Train Loss: 0.423 Vali Loss: 0.687 Vali Acc: 0.727 Test Loss: 0.687 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.6808230876922607
Epoch: 11, Steps: 13 | Train Loss: 0.543 Vali Loss: 0.767 Vali Acc: 0.722 Test Loss: 0.767 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.722285032272339
Epoch: 12, Steps: 13 | Train Loss: 0.468 Vali Loss: 0.547 Vali Acc: 0.741 Test Loss: 0.547 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741458).  Saving model ...
Epoch: 13 cost time: 3.3130953311920166
Epoch: 13, Steps: 13 | Train Loss: 0.436 Vali Loss: 0.804 Vali Acc: 0.727 Test Loss: 0.804 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.447853326797485
Epoch: 14, Steps: 13 | Train Loss: 0.463 Vali Loss: 0.563 Vali Acc: 0.717 Test Loss: 0.563 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.124044418334961
Epoch: 15, Steps: 13 | Train Loss: 0.457 Vali Loss: 0.835 Vali Acc: 0.551 Test Loss: 0.835 Test Acc: 0.551
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.314571380615234
Epoch: 16, Steps: 13 | Train Loss: 0.489 Vali Loss: 0.737 Vali Acc: 0.629 Test Loss: 0.737 Test Acc: 0.629
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.10211181640625
Epoch: 17, Steps: 13 | Train Loss: 0.356 Vali Loss: 0.660 Vali Acc: 0.727 Test Loss: 0.660 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.8965137004852295
Epoch: 18, Steps: 13 | Train Loss: 0.287 Vali Loss: 0.714 Vali Acc: 0.737 Test Loss: 0.714 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.358983755111694
Epoch: 19, Steps: 13 | Train Loss: 0.244 Vali Loss: 0.605 Vali Acc: 0.698 Test Loss: 0.605 Test Acc: 0.698
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.3199641704559326
Epoch: 20, Steps: 13 | Train Loss: 0.230 Vali Loss: 0.676 Vali Acc: 0.741 Test Loss: 0.676 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.533445835113525
Epoch: 21, Steps: 13 | Train Loss: 0.229 Vali Loss: 0.822 Vali Acc: 0.629 Test Loss: 0.822 Test Acc: 0.629
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.536142110824585
Epoch: 22, Steps: 13 | Train Loss: 0.318 Vali Loss: 0.900 Vali Acc: 0.722 Test Loss: 0.900 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 396030
model size : 2.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.28952693939209
Epoch: 1, Steps: 13 | Train Loss: 0.640 Vali Loss: 0.615 Vali Acc: 0.717 Test Loss: 0.615 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 4.926161527633667
Epoch: 2, Steps: 13 | Train Loss: 0.621 Vali Loss: 0.612 Vali Acc: 0.717 Test Loss: 0.612 Test Acc: 0.717
Validation loss decreased (-0.717067 --> -0.717067).  Saving model ...
Epoch: 3 cost time: 4.413249492645264
Epoch: 3, Steps: 13 | Train Loss: 0.668 Vali Loss: 0.591 Vali Acc: 0.722 Test Loss: 0.591 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721945).  Saving model ...
Epoch: 4 cost time: 4.291249752044678
Epoch: 4, Steps: 13 | Train Loss: 0.709 Vali Loss: 0.934 Vali Acc: 0.278 Test Loss: 0.934 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.530862331390381
Epoch: 5, Steps: 13 | Train Loss: 0.789 Vali Loss: 0.609 Vali Acc: 0.722 Test Loss: 0.609 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.895169734954834
Epoch: 6, Steps: 13 | Train Loss: 0.564 Vali Loss: 0.641 Vali Acc: 0.722 Test Loss: 0.641 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.5421810150146484
Epoch: 7, Steps: 13 | Train Loss: 0.553 Vali Loss: 0.562 Vali Acc: 0.717 Test Loss: 0.562 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.6746907234191895
Epoch: 8, Steps: 13 | Train Loss: 0.497 Vali Loss: 0.524 Vali Acc: 0.746 Test Loss: 0.524 Test Acc: 0.746
Validation loss decreased (-0.721945 --> -0.746336).  Saving model ...
Epoch: 9 cost time: 4.07538104057312
Epoch: 9, Steps: 13 | Train Loss: 0.477 Vali Loss: 0.523 Vali Acc: 0.761 Test Loss: 0.523 Test Acc: 0.761
Validation loss decreased (-0.746336 --> -0.760970).  Saving model ...
Epoch: 10 cost time: 4.029068946838379
Epoch: 10, Steps: 13 | Train Loss: 0.495 Vali Loss: 0.666 Vali Acc: 0.732 Test Loss: 0.666 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.267781972885132
Epoch: 11, Steps: 13 | Train Loss: 0.499 Vali Loss: 0.746 Vali Acc: 0.541 Test Loss: 0.746 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.619349718093872
Epoch: 12, Steps: 13 | Train Loss: 0.517 Vali Loss: 0.544 Vali Acc: 0.746 Test Loss: 0.544 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.838165760040283
Epoch: 13, Steps: 13 | Train Loss: 0.487 Vali Loss: 0.540 Vali Acc: 0.746 Test Loss: 0.540 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.103880405426025
Epoch: 14, Steps: 13 | Train Loss: 0.414 Vali Loss: 0.528 Vali Acc: 0.722 Test Loss: 0.528 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.270224094390869
Epoch: 15, Steps: 13 | Train Loss: 0.378 Vali Loss: 0.565 Vali Acc: 0.683 Test Loss: 0.565 Test Acc: 0.683
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.3965535163879395
Epoch: 16, Steps: 13 | Train Loss: 0.381 Vali Loss: 0.657 Vali Acc: 0.741 Test Loss: 0.657 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.7422873973846436
Epoch: 17, Steps: 13 | Train Loss: 0.442 Vali Loss: 0.561 Vali Acc: 0.776 Test Loss: 0.561 Test Acc: 0.776
Validation loss decreased (-0.760970 --> -0.775604).  Saving model ...
Epoch: 18 cost time: 4.43222451210022
Epoch: 18, Steps: 13 | Train Loss: 0.383 Vali Loss: 1.042 Vali Acc: 0.478 Test Loss: 1.042 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.998704195022583
Epoch: 19, Steps: 13 | Train Loss: 0.586 Vali Loss: 0.704 Vali Acc: 0.620 Test Loss: 0.704 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.129544734954834
Epoch: 20, Steps: 13 | Train Loss: 0.336 Vali Loss: 0.713 Vali Acc: 0.741 Test Loss: 0.713 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.318339109420776
Epoch: 21, Steps: 13 | Train Loss: 0.286 Vali Loss: 0.603 Vali Acc: 0.751 Test Loss: 0.603 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.186235189437866
Epoch: 22, Steps: 13 | Train Loss: 0.279 Vali Loss: 0.620 Vali Acc: 0.741 Test Loss: 0.620 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.482466459274292
Epoch: 23, Steps: 13 | Train Loss: 0.270 Vali Loss: 0.778 Vali Acc: 0.746 Test Loss: 0.778 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.742530584335327
Epoch: 24, Steps: 13 | Train Loss: 0.304 Vali Loss: 0.747 Vali Acc: 0.654 Test Loss: 0.747 Test Acc: 0.654
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 4.100345849990845
Epoch: 25, Steps: 13 | Train Loss: 0.195 Vali Loss: 0.700 Vali Acc: 0.737 Test Loss: 0.700 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.861645460128784
Epoch: 26, Steps: 13 | Train Loss: 0.169 Vali Loss: 0.759 Vali Acc: 0.732 Test Loss: 0.759 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 4.496872186660767
Epoch: 27, Steps: 13 | Train Loss: 0.179 Vali Loss: 0.859 Vali Acc: 0.746 Test Loss: 0.859 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 327390
model size : 2.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.652377128601074
Epoch: 1, Steps: 13 | Train Loss: 0.751 Vali Loss: 0.618 Vali Acc: 0.712 Test Loss: 0.618 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 4.479654788970947
Epoch: 2, Steps: 13 | Train Loss: 0.682 Vali Loss: 0.754 Vali Acc: 0.712 Test Loss: 0.754 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.9727895259857178
Epoch: 3, Steps: 13 | Train Loss: 0.613 Vali Loss: 0.581 Vali Acc: 0.712 Test Loss: 0.581 Test Acc: 0.712
Validation loss decreased (-0.712189 --> -0.712189).  Saving model ...
Epoch: 4 cost time: 3.799919605255127
Epoch: 4, Steps: 13 | Train Loss: 0.569 Vali Loss: 0.607 Vali Acc: 0.712 Test Loss: 0.607 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.025815010070801
Epoch: 5, Steps: 13 | Train Loss: 0.564 Vali Loss: 0.546 Vali Acc: 0.717 Test Loss: 0.546 Test Acc: 0.717
Validation loss decreased (-0.712189 --> -0.717068).  Saving model ...
Epoch: 6 cost time: 3.908435583114624
Epoch: 6, Steps: 13 | Train Loss: 0.542 Vali Loss: 0.528 Vali Acc: 0.737 Test Loss: 0.528 Test Acc: 0.737
Validation loss decreased (-0.717068 --> -0.736580).  Saving model ...
Epoch: 7 cost time: 4.677891254425049
Epoch: 7, Steps: 13 | Train Loss: 0.460 Vali Loss: 0.707 Vali Acc: 0.717 Test Loss: 0.707 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.509465456008911
Epoch: 8, Steps: 13 | Train Loss: 0.573 Vali Loss: 0.633 Vali Acc: 0.644 Test Loss: 0.633 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.7757949829101562
Epoch: 9, Steps: 13 | Train Loss: 0.451 Vali Loss: 0.507 Vali Acc: 0.761 Test Loss: 0.507 Test Acc: 0.761
Validation loss decreased (-0.736580 --> -0.760971).  Saving model ...
Epoch: 10 cost time: 4.0329954624176025
Epoch: 10, Steps: 13 | Train Loss: 0.484 Vali Loss: 0.522 Vali Acc: 0.766 Test Loss: 0.522 Test Acc: 0.766
Validation loss decreased (-0.760971 --> -0.765848).  Saving model ...
Epoch: 11 cost time: 4.5602240562438965
Epoch: 11, Steps: 13 | Train Loss: 0.431 Vali Loss: 0.685 Vali Acc: 0.615 Test Loss: 0.685 Test Acc: 0.615
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.0640869140625
Epoch: 12, Steps: 13 | Train Loss: 0.403 Vali Loss: 0.589 Vali Acc: 0.634 Test Loss: 0.589 Test Acc: 0.634
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.123875379562378
Epoch: 13, Steps: 13 | Train Loss: 0.373 Vali Loss: 0.534 Vali Acc: 0.756 Test Loss: 0.534 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.910421848297119
Epoch: 14, Steps: 13 | Train Loss: 0.374 Vali Loss: 0.542 Vali Acc: 0.751 Test Loss: 0.542 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.6121127605438232
Epoch: 15, Steps: 13 | Train Loss: 0.349 Vali Loss: 0.761 Vali Acc: 0.727 Test Loss: 0.761 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.5346834659576416
Epoch: 16, Steps: 13 | Train Loss: 0.386 Vali Loss: 0.564 Vali Acc: 0.678 Test Loss: 0.564 Test Acc: 0.678
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.301794528961182
Epoch: 17, Steps: 13 | Train Loss: 0.531 Vali Loss: 0.663 Vali Acc: 0.644 Test Loss: 0.663 Test Acc: 0.644
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.861229181289673
Epoch: 18, Steps: 13 | Train Loss: 0.251 Vali Loss: 0.571 Vali Acc: 0.727 Test Loss: 0.571 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.064254283905029
Epoch: 19, Steps: 13 | Train Loss: 0.260 Vali Loss: 0.839 Vali Acc: 0.580 Test Loss: 0.839 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.73045015335083
Epoch: 20, Steps: 13 | Train Loss: 0.257 Vali Loss: 0.612 Vali Acc: 0.707 Test Loss: 0.612 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 325310
model size : 2.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.980529546737671
Epoch: 1, Steps: 13 | Train Loss: 0.618 Vali Loss: 0.613 Vali Acc: 0.717 Test Loss: 0.613 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 3.6895172595977783
Epoch: 2, Steps: 13 | Train Loss: 0.600 Vali Loss: 0.743 Vali Acc: 0.293 Test Loss: 0.743 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.098764419555664
Epoch: 3, Steps: 13 | Train Loss: 0.608 Vali Loss: 0.570 Vali Acc: 0.717 Test Loss: 0.570 Test Acc: 0.717
Validation loss decreased (-0.717067 --> -0.717067).  Saving model ...
Epoch: 4 cost time: 4.214933395385742
Epoch: 4, Steps: 13 | Train Loss: 0.580 Vali Loss: 0.593 Vali Acc: 0.741 Test Loss: 0.593 Test Acc: 0.741
Validation loss decreased (-0.717067 --> -0.741457).  Saving model ...
Epoch: 5 cost time: 4.16848087310791
Epoch: 5, Steps: 13 | Train Loss: 0.561 Vali Loss: 0.719 Vali Acc: 0.722 Test Loss: 0.719 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.1412811279296875
Epoch: 6, Steps: 13 | Train Loss: 0.759 Vali Loss: 1.309 Vali Acc: 0.278 Test Loss: 1.309 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.754762649536133
Epoch: 7, Steps: 13 | Train Loss: 0.622 Vali Loss: 0.521 Vali Acc: 0.751 Test Loss: 0.521 Test Acc: 0.751
Validation loss decreased (-0.741457 --> -0.751214).  Saving model ...
Epoch: 8 cost time: 3.7372663021087646
Epoch: 8, Steps: 13 | Train Loss: 0.488 Vali Loss: 0.557 Vali Acc: 0.727 Test Loss: 0.557 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.078824520111084
Epoch: 9, Steps: 13 | Train Loss: 0.466 Vali Loss: 0.512 Vali Acc: 0.756 Test Loss: 0.512 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756092).  Saving model ...
Epoch: 10 cost time: 4.550679683685303
Epoch: 10, Steps: 13 | Train Loss: 0.511 Vali Loss: 0.659 Vali Acc: 0.732 Test Loss: 0.659 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.816179275512695
Epoch: 11, Steps: 13 | Train Loss: 0.482 Vali Loss: 0.519 Vali Acc: 0.737 Test Loss: 0.519 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.302106618881226
Epoch: 12, Steps: 13 | Train Loss: 0.482 Vali Loss: 0.514 Vali Acc: 0.717 Test Loss: 0.514 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.1932127475738525
Epoch: 13, Steps: 13 | Train Loss: 0.390 Vali Loss: 0.542 Vali Acc: 0.741 Test Loss: 0.542 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.7253873348236084
Epoch: 14, Steps: 13 | Train Loss: 0.366 Vali Loss: 0.525 Vali Acc: 0.737 Test Loss: 0.525 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.997906446456909
Epoch: 15, Steps: 13 | Train Loss: 0.370 Vali Loss: 0.542 Vali Acc: 0.722 Test Loss: 0.542 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.9433085918426514
Epoch: 16, Steps: 13 | Train Loss: 0.350 Vali Loss: 0.603 Vali Acc: 0.732 Test Loss: 0.603 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.225697755813599
Epoch: 17, Steps: 13 | Train Loss: 0.367 Vali Loss: 0.940 Vali Acc: 0.512 Test Loss: 0.940 Test Acc: 0.512
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.203265905380249
Epoch: 18, Steps: 13 | Train Loss: 0.361 Vali Loss: 0.637 Vali Acc: 0.732 Test Loss: 0.637 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.36849045753479
Epoch: 19, Steps: 13 | Train Loss: 0.291 Vali Loss: 0.711 Vali Acc: 0.722 Test Loss: 0.711 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 323230
model size : 2.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.450991868972778
Epoch: 1, Steps: 13 | Train Loss: 0.647 Vali Loss: 0.587 Vali Acc: 0.722 Test Loss: 0.587 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.63142204284668
Epoch: 2, Steps: 13 | Train Loss: 0.610 Vali Loss: 0.580 Vali Acc: 0.722 Test Loss: 0.580 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 3.82094407081604
Epoch: 3, Steps: 13 | Train Loss: 0.586 Vali Loss: 0.584 Vali Acc: 0.722 Test Loss: 0.584 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.770603895187378
Epoch: 4, Steps: 13 | Train Loss: 0.592 Vali Loss: 0.656 Vali Acc: 0.722 Test Loss: 0.656 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.7119572162628174
Epoch: 5, Steps: 13 | Train Loss: 0.592 Vali Loss: 0.544 Vali Acc: 0.732 Test Loss: 0.544 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 6 cost time: 3.400449514389038
Epoch: 6, Steps: 13 | Train Loss: 0.510 Vali Loss: 0.544 Vali Acc: 0.727 Test Loss: 0.544 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.2233309745788574
Epoch: 7, Steps: 13 | Train Loss: 0.490 Vali Loss: 0.526 Vali Acc: 0.746 Test Loss: 0.526 Test Acc: 0.746
Validation loss decreased (-0.731702 --> -0.746336).  Saving model ...
Epoch: 8 cost time: 3.759714365005493
Epoch: 8, Steps: 13 | Train Loss: 0.466 Vali Loss: 0.570 Vali Acc: 0.727 Test Loss: 0.570 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.314226150512695
Epoch: 9, Steps: 13 | Train Loss: 0.516 Vali Loss: 0.629 Vali Acc: 0.732 Test Loss: 0.629 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.613652944564819
Epoch: 10, Steps: 13 | Train Loss: 0.534 Vali Loss: 0.603 Vali Acc: 0.678 Test Loss: 0.603 Test Acc: 0.678
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.980649948120117
Epoch: 11, Steps: 13 | Train Loss: 0.467 Vali Loss: 0.689 Vali Acc: 0.624 Test Loss: 0.689 Test Acc: 0.624
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.3717193603515625
Epoch: 12, Steps: 13 | Train Loss: 0.494 Vali Loss: 0.666 Vali Acc: 0.590 Test Loss: 0.666 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.876997470855713
Epoch: 13, Steps: 13 | Train Loss: 0.636 Vali Loss: 0.537 Vali Acc: 0.712 Test Loss: 0.537 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.859238624572754
Epoch: 14, Steps: 13 | Train Loss: 0.383 Vali Loss: 0.559 Vali Acc: 0.737 Test Loss: 0.559 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.6108057498931885
Epoch: 15, Steps: 13 | Train Loss: 0.436 Vali Loss: 0.646 Vali Acc: 0.624 Test Loss: 0.646 Test Acc: 0.624
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.0701329708099365
Epoch: 16, Steps: 13 | Train Loss: 0.379 Vali Loss: 0.600 Vali Acc: 0.751 Test Loss: 0.600 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751214).  Saving model ...
Epoch: 17 cost time: 3.6686043739318848
Epoch: 17, Steps: 13 | Train Loss: 0.416 Vali Loss: 0.656 Vali Acc: 0.659 Test Loss: 0.656 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.584842205047607
Epoch: 18, Steps: 13 | Train Loss: 0.524 Vali Loss: 1.060 Vali Acc: 0.454 Test Loss: 1.060 Test Acc: 0.454
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.9452409744262695
Epoch: 19, Steps: 13 | Train Loss: 0.587 Vali Loss: 0.603 Vali Acc: 0.668 Test Loss: 0.603 Test Acc: 0.668
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.765745639801025
Epoch: 20, Steps: 13 | Train Loss: 0.310 Vali Loss: 0.889 Vali Acc: 0.741 Test Loss: 0.889 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.118377685546875
Epoch: 21, Steps: 13 | Train Loss: 0.494 Vali Loss: 0.642 Vali Acc: 0.756 Test Loss: 0.642 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756091).  Saving model ...
Epoch: 22 cost time: 3.3868565559387207
Epoch: 22, Steps: 13 | Train Loss: 0.310 Vali Loss: 1.532 Vali Acc: 0.415 Test Loss: 1.532 Test Acc: 0.415
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.1549124717712402
Epoch: 23, Steps: 13 | Train Loss: 0.457 Vali Loss: 2.251 Vali Acc: 0.351 Test Loss: 2.251 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.243805170059204
Epoch: 24, Steps: 13 | Train Loss: 0.569 Vali Loss: 0.679 Vali Acc: 0.668 Test Loss: 0.679 Test Acc: 0.668
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 4.289895057678223
Epoch: 25, Steps: 13 | Train Loss: 0.186 Vali Loss: 0.794 Vali Acc: 0.751 Test Loss: 0.794 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.5221164226531982
Epoch: 26, Steps: 13 | Train Loss: 0.207 Vali Loss: 0.693 Vali Acc: 0.654 Test Loss: 0.693 Test Acc: 0.654
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.928373336791992
Epoch: 27, Steps: 13 | Train Loss: 0.226 Vali Loss: 0.674 Vali Acc: 0.737 Test Loss: 0.674 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 4.1486289501190186
Epoch: 28, Steps: 13 | Train Loss: 0.167 Vali Loss: 0.725 Vali Acc: 0.737 Test Loss: 0.725 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.895819664001465
Epoch: 29, Steps: 13 | Train Loss: 0.135 Vali Loss: 0.733 Vali Acc: 0.668 Test Loss: 0.733 Test Acc: 0.668
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 4.216175317764282
Epoch: 30, Steps: 13 | Train Loss: 0.125 Vali Loss: 0.954 Vali Acc: 0.580 Test Loss: 0.954 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 4.8141961097717285
Epoch: 31, Steps: 13 | Train Loss: 0.148 Vali Loss: 0.744 Vali Acc: 0.722 Test Loss: 0.744 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 321150
model size : 2.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 9.813738346099854
Epoch: 1, Steps: 13 | Train Loss: 1.092 Vali Loss: 0.573 Vali Acc: 0.722 Test Loss: 0.573 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 6.734879970550537
Epoch: 2, Steps: 13 | Train Loss: 1.280 Vali Loss: 0.801 Vali Acc: 0.371 Test Loss: 0.801 Test Acc: 0.371
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.75969672203064
Epoch: 3, Steps: 13 | Train Loss: 1.067 Vali Loss: 2.605 Vali Acc: 0.293 Test Loss: 2.605 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.12617301940918
Epoch: 4, Steps: 13 | Train Loss: 1.196 Vali Loss: 0.578 Vali Acc: 0.727 Test Loss: 0.578 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726823).  Saving model ...
Epoch: 5 cost time: 6.170877933502197
Epoch: 5, Steps: 13 | Train Loss: 1.229 Vali Loss: 0.990 Vali Acc: 0.746 Test Loss: 0.990 Test Acc: 0.746
Validation loss decreased (-0.726823 --> -0.746332).  Saving model ...
Epoch: 6 cost time: 6.331896781921387
Epoch: 6, Steps: 13 | Train Loss: 1.129 Vali Loss: 2.202 Vali Acc: 0.722 Test Loss: 2.202 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.168562650680542
Epoch: 7, Steps: 13 | Train Loss: 1.500 Vali Loss: 2.836 Vali Acc: 0.722 Test Loss: 2.836 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.87591814994812
Epoch: 8, Steps: 13 | Train Loss: 2.925 Vali Loss: 0.896 Vali Acc: 0.683 Test Loss: 0.896 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 7.343500137329102
Epoch: 9, Steps: 13 | Train Loss: 0.654 Vali Loss: 1.499 Vali Acc: 0.741 Test Loss: 1.499 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.612629652023315
Epoch: 10, Steps: 13 | Train Loss: 1.570 Vali Loss: 1.434 Vali Acc: 0.454 Test Loss: 1.434 Test Acc: 0.454
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 7.143237113952637
Epoch: 11, Steps: 13 | Train Loss: 1.537 Vali Loss: 6.176 Vali Acc: 0.293 Test Loss: 6.176 Test Acc: 0.293
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 7.583638668060303
Epoch: 12, Steps: 13 | Train Loss: 1.594 Vali Loss: 0.828 Vali Acc: 0.712 Test Loss: 0.828 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 7.4196178913116455
Epoch: 13, Steps: 13 | Train Loss: 1.252 Vali Loss: 2.574 Vali Acc: 0.741 Test Loss: 2.574 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 7.1234564781188965
Epoch: 14, Steps: 13 | Train Loss: 3.321 Vali Loss: 2.437 Vali Acc: 0.527 Test Loss: 2.437 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 7.735391616821289
Epoch: 15, Steps: 13 | Train Loss: 0.958 Vali Loss: 1.961 Vali Acc: 0.546 Test Loss: 1.961 Test Acc: 0.546
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 11958834
model size : 50.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 9.75576901435852
Epoch: 1, Steps: 13 | Train Loss: 0.785 Vali Loss: 1.637 Vali Acc: 0.278 Test Loss: 1.637 Test Acc: 0.278
Validation loss decreased (inf --> -0.278032).  Saving model ...
Epoch: 2 cost time: 6.651514053344727
Epoch: 2, Steps: 13 | Train Loss: 0.926 Vali Loss: 0.515 Vali Acc: 0.756 Test Loss: 0.515 Test Acc: 0.756
Validation loss decreased (-0.278032 --> -0.756092).  Saving model ...
Epoch: 3 cost time: 6.520503282546997
Epoch: 3, Steps: 13 | Train Loss: 1.011 Vali Loss: 1.179 Vali Acc: 0.717 Test Loss: 1.179 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.494615793228149
Epoch: 4, Steps: 13 | Train Loss: 1.036 Vali Loss: 1.883 Vali Acc: 0.722 Test Loss: 1.883 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.742911100387573
Epoch: 5, Steps: 13 | Train Loss: 0.908 Vali Loss: 0.803 Vali Acc: 0.741 Test Loss: 0.803 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.370455503463745
Epoch: 6, Steps: 13 | Train Loss: 0.897 Vali Loss: 5.629 Vali Acc: 0.278 Test Loss: 5.629 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 7.302439212799072
Epoch: 7, Steps: 13 | Train Loss: 1.756 Vali Loss: 0.949 Vali Acc: 0.741 Test Loss: 0.949 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.5727219581604
Epoch: 8, Steps: 13 | Train Loss: 1.699 Vali Loss: 3.115 Vali Acc: 0.717 Test Loss: 3.115 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 7.624239683151245
Epoch: 9, Steps: 13 | Train Loss: 1.335 Vali Loss: 2.262 Vali Acc: 0.722 Test Loss: 2.262 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 6.681913614273071
Epoch: 10, Steps: 13 | Train Loss: 1.166 Vali Loss: 1.036 Vali Acc: 0.756 Test Loss: 1.036 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 6.972840785980225
Epoch: 11, Steps: 13 | Train Loss: 1.364 Vali Loss: 0.874 Vali Acc: 0.673 Test Loss: 0.874 Test Acc: 0.673
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 7.218359708786011
Epoch: 12, Steps: 13 | Train Loss: 1.687 Vali Loss: 1.738 Vali Acc: 0.561 Test Loss: 1.738 Test Acc: 0.561
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 11943474
model size : 50.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 9.281837224960327
Epoch: 1, Steps: 13 | Train Loss: 0.748 Vali Loss: 0.603 Vali Acc: 0.717 Test Loss: 0.603 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 5.921218395233154
Epoch: 2, Steps: 13 | Train Loss: 0.636 Vali Loss: 0.603 Vali Acc: 0.673 Test Loss: 0.603 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.341375350952148
Epoch: 3, Steps: 13 | Train Loss: 1.137 Vali Loss: 0.539 Vali Acc: 0.712 Test Loss: 0.539 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.242834091186523
Epoch: 4, Steps: 13 | Train Loss: 1.103 Vali Loss: 0.642 Vali Acc: 0.746 Test Loss: 0.642 Test Acc: 0.746
Validation loss decreased (-0.717067 --> -0.746335).  Saving model ...
Epoch: 5 cost time: 6.958083629608154
Epoch: 5, Steps: 13 | Train Loss: 1.153 Vali Loss: 1.440 Vali Acc: 0.722 Test Loss: 1.440 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.008670806884766
Epoch: 6, Steps: 13 | Train Loss: 2.134 Vali Loss: 1.903 Vali Acc: 0.732 Test Loss: 1.903 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.358943700790405
Epoch: 7, Steps: 13 | Train Loss: 1.905 Vali Loss: 1.973 Vali Acc: 0.722 Test Loss: 1.973 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.3771138191223145
Epoch: 8, Steps: 13 | Train Loss: 1.104 Vali Loss: 1.015 Vali Acc: 0.532 Test Loss: 1.015 Test Acc: 0.532
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.663689613342285
Epoch: 9, Steps: 13 | Train Loss: 1.598 Vali Loss: 0.908 Vali Acc: 0.600 Test Loss: 0.908 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 7.839955568313599
Epoch: 10, Steps: 13 | Train Loss: 0.803 Vali Loss: 0.948 Vali Acc: 0.668 Test Loss: 0.948 Test Acc: 0.668
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 6.9692933559417725
Epoch: 11, Steps: 13 | Train Loss: 1.347 Vali Loss: 1.155 Vali Acc: 0.727 Test Loss: 1.155 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 8.086258888244629
Epoch: 12, Steps: 13 | Train Loss: 0.697 Vali Loss: 1.819 Vali Acc: 0.444 Test Loss: 1.819 Test Acc: 0.444
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 6.956443548202515
Epoch: 13, Steps: 13 | Train Loss: 0.543 Vali Loss: 1.763 Vali Acc: 0.741 Test Loss: 1.763 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 6.573423385620117
Epoch: 14, Steps: 13 | Train Loss: 2.185 Vali Loss: 4.032 Vali Acc: 0.727 Test Loss: 4.032 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 11928114
model size : 50.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.686145782470703
Epoch: 1, Steps: 13 | Train Loss: 0.734 Vali Loss: 0.894 Vali Acc: 0.722 Test Loss: 0.894 Test Acc: 0.722
Validation loss decreased (inf --> -0.721942).  Saving model ...
Epoch: 2 cost time: 6.125378370285034
Epoch: 2, Steps: 13 | Train Loss: 0.804 Vali Loss: 2.966 Vali Acc: 0.278 Test Loss: 2.966 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.633776664733887
Epoch: 3, Steps: 13 | Train Loss: 2.880 Vali Loss: 2.303 Vali Acc: 0.722 Test Loss: 2.303 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.4738452434539795
Epoch: 4, Steps: 13 | Train Loss: 2.702 Vali Loss: 0.856 Vali Acc: 0.600 Test Loss: 0.856 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.318456411361694
Epoch: 5, Steps: 13 | Train Loss: 1.400 Vali Loss: 3.210 Vali Acc: 0.317 Test Loss: 3.210 Test Acc: 0.317
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.031430244445801
Epoch: 6, Steps: 13 | Train Loss: 1.584 Vali Loss: 0.943 Vali Acc: 0.615 Test Loss: 0.943 Test Acc: 0.615
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.679534673690796
Epoch: 7, Steps: 13 | Train Loss: 1.105 Vali Loss: 1.600 Vali Acc: 0.727 Test Loss: 1.600 Test Acc: 0.727
Validation loss decreased (-0.721942 --> -0.726813).  Saving model ...
Epoch: 8 cost time: 6.041152238845825
Epoch: 8, Steps: 13 | Train Loss: 0.900 Vali Loss: 0.933 Vali Acc: 0.722 Test Loss: 0.933 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.241879463195801
Epoch: 9, Steps: 13 | Train Loss: 1.757 Vali Loss: 7.374 Vali Acc: 0.288 Test Loss: 7.374 Test Acc: 0.288
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.9561216831207275
Epoch: 10, Steps: 13 | Train Loss: 3.080 Vali Loss: 2.724 Vali Acc: 0.727 Test Loss: 2.724 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.377213001251221
Epoch: 11, Steps: 13 | Train Loss: 1.891 Vali Loss: 0.808 Vali Acc: 0.732 Test Loss: 0.808 Test Acc: 0.732
Validation loss decreased (-0.726813 --> -0.731699).  Saving model ...
Epoch: 12 cost time: 5.671089172363281
Epoch: 12, Steps: 13 | Train Loss: 2.149 Vali Loss: 10.151 Vali Acc: 0.288 Test Loss: 10.151 Test Acc: 0.288
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.715271711349487
Epoch: 13, Steps: 13 | Train Loss: 2.808 Vali Loss: 3.487 Vali Acc: 0.522 Test Loss: 3.487 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.874138832092285
Epoch: 14, Steps: 13 | Train Loss: 3.710 Vali Loss: 2.391 Vali Acc: 0.737 Test Loss: 2.391 Test Acc: 0.737
Validation loss decreased (-0.731699 --> -0.736561).  Saving model ...
Epoch: 15 cost time: 6.0952467918396
Epoch: 15, Steps: 13 | Train Loss: 2.245 Vali Loss: 2.948 Vali Acc: 0.761 Test Loss: 2.948 Test Acc: 0.761
Validation loss decreased (-0.736561 --> -0.760946).  Saving model ...
Epoch: 16 cost time: 6.126574516296387
Epoch: 16, Steps: 13 | Train Loss: 1.386 Vali Loss: 1.583 Vali Acc: 0.693 Test Loss: 1.583 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.514188051223755
Epoch: 17, Steps: 13 | Train Loss: 0.576 Vali Loss: 3.836 Vali Acc: 0.346 Test Loss: 3.836 Test Acc: 0.346
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.575253248214722
Epoch: 18, Steps: 13 | Train Loss: 0.894 Vali Loss: 5.842 Vali Acc: 0.366 Test Loss: 5.842 Test Acc: 0.366
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 6.692054510116577
Epoch: 19, Steps: 13 | Train Loss: 1.092 Vali Loss: 2.355 Vali Acc: 0.698 Test Loss: 2.355 Test Acc: 0.698
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 6.07028341293335
Epoch: 20, Steps: 13 | Train Loss: 0.302 Vali Loss: 3.068 Vali Acc: 0.737 Test Loss: 3.068 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 7.109206676483154
Epoch: 21, Steps: 13 | Train Loss: 0.384 Vali Loss: 2.540 Vali Acc: 0.727 Test Loss: 2.540 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 5.487860679626465
Epoch: 22, Steps: 13 | Train Loss: 6.555 Vali Loss: 16.931 Vali Acc: 0.307 Test Loss: 16.931 Test Acc: 0.307
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 7.3370301723480225
Epoch: 23, Steps: 13 | Train Loss: 1.817 Vali Loss: 3.000 Vali Acc: 0.707 Test Loss: 3.000 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 6.466763496398926
Epoch: 24, Steps: 13 | Train Loss: 0.380 Vali Loss: 6.143 Vali Acc: 0.756 Test Loss: 6.143 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 6.647306203842163
Epoch: 25, Steps: 13 | Train Loss: 1.174 Vali Loss: 6.340 Vali Acc: 0.727 Test Loss: 6.340 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 11912754
model size : 50.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.362523794174194
Epoch: 1, Steps: 13 | Train Loss: 0.660 Vali Loss: 1.170 Vali Acc: 0.293 Test Loss: 1.170 Test Acc: 0.293
Validation loss decreased (inf --> -0.292671).  Saving model ...
Epoch: 2 cost time: 6.007706642150879
Epoch: 2, Steps: 13 | Train Loss: 1.305 Vali Loss: 0.667 Vali Acc: 0.737 Test Loss: 0.667 Test Acc: 0.737
Validation loss decreased (-0.292671 --> -0.736579).  Saving model ...
Epoch: 3 cost time: 5.739353895187378
Epoch: 3, Steps: 13 | Train Loss: 0.937 Vali Loss: 2.378 Vali Acc: 0.307 Test Loss: 2.378 Test Acc: 0.307
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.844664573669434
Epoch: 4, Steps: 13 | Train Loss: 1.420 Vali Loss: 0.687 Vali Acc: 0.693 Test Loss: 0.687 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.513561964035034
Epoch: 5, Steps: 13 | Train Loss: 0.737 Vali Loss: 1.054 Vali Acc: 0.473 Test Loss: 1.054 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.9905407428741455
Epoch: 6, Steps: 13 | Train Loss: 0.635 Vali Loss: 1.026 Vali Acc: 0.493 Test Loss: 1.026 Test Acc: 0.493
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.241037368774414
Epoch: 7, Steps: 13 | Train Loss: 0.590 Vali Loss: 0.984 Vali Acc: 0.727 Test Loss: 0.984 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.506666898727417
Epoch: 8, Steps: 13 | Train Loss: 1.835 Vali Loss: 3.834 Vali Acc: 0.288 Test Loss: 3.834 Test Acc: 0.288
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 6.501960277557373
Epoch: 9, Steps: 13 | Train Loss: 1.692 Vali Loss: 8.022 Vali Acc: 0.283 Test Loss: 8.022 Test Acc: 0.283
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 7.5549492835998535
Epoch: 10, Steps: 13 | Train Loss: 3.756 Vali Loss: 5.180 Vali Acc: 0.707 Test Loss: 5.180 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 6.764657974243164
Epoch: 11, Steps: 13 | Train Loss: 2.229 Vali Loss: 1.963 Vali Acc: 0.732 Test Loss: 1.963 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 7.5925984382629395
Epoch: 12, Steps: 13 | Train Loss: 0.510 Vali Loss: 1.006 Vali Acc: 0.756 Test Loss: 1.006 Test Acc: 0.756
Validation loss decreased (-0.736579 --> -0.756088).  Saving model ...
Epoch: 13 cost time: 6.79895281791687
Epoch: 13, Steps: 13 | Train Loss: 0.982 Vali Loss: 3.281 Vali Acc: 0.722 Test Loss: 3.281 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.024440765380859
Epoch: 14, Steps: 13 | Train Loss: 3.990 Vali Loss: 11.643 Vali Acc: 0.317 Test Loss: 11.643 Test Acc: 0.317
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.199725151062012
Epoch: 15, Steps: 13 | Train Loss: 2.133 Vali Loss: 5.710 Vali Acc: 0.415 Test Loss: 5.710 Test Acc: 0.415
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.314495325088501
Epoch: 16, Steps: 13 | Train Loss: 1.749 Vali Loss: 1.219 Vali Acc: 0.712 Test Loss: 1.219 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 6.340381860733032
Epoch: 17, Steps: 13 | Train Loss: 4.932 Vali Loss: 2.602 Vali Acc: 0.610 Test Loss: 2.602 Test Acc: 0.610
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 6.607400417327881
Epoch: 18, Steps: 13 | Train Loss: 1.580 Vali Loss: 2.983 Vali Acc: 0.517 Test Loss: 2.983 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 6.579996585845947
Epoch: 19, Steps: 13 | Train Loss: 1.010 Vali Loss: 1.762 Vali Acc: 0.600 Test Loss: 1.762 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 6.55169939994812
Epoch: 20, Steps: 13 | Train Loss: 3.485 Vali Loss: 5.209 Vali Acc: 0.727 Test Loss: 5.209 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 5.78579044342041
Epoch: 21, Steps: 13 | Train Loss: 0.895 Vali Loss: 1.514 Vali Acc: 0.702 Test Loss: 1.514 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 6.0320680141448975
Epoch: 22, Steps: 13 | Train Loss: 0.540 Vali Loss: 1.577 Vali Acc: 0.712 Test Loss: 1.577 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 10120242
model size : 43.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.52999997138977
Epoch: 1, Steps: 13 | Train Loss: 0.654 Vali Loss: 1.476 Vali Acc: 0.278 Test Loss: 1.476 Test Acc: 0.278
Validation loss decreased (inf --> -0.278034).  Saving model ...
Epoch: 2 cost time: 6.585086107254028
Epoch: 2, Steps: 13 | Train Loss: 1.394 Vali Loss: 1.655 Vali Acc: 0.712 Test Loss: 1.655 Test Acc: 0.712
Validation loss decreased (-0.278034 --> -0.712179).  Saving model ...
Epoch: 3 cost time: 5.857347011566162
Epoch: 3, Steps: 13 | Train Loss: 0.906 Vali Loss: 0.558 Vali Acc: 0.688 Test Loss: 0.558 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.306082248687744
Epoch: 4, Steps: 13 | Train Loss: 0.725 Vali Loss: 0.691 Vali Acc: 0.556 Test Loss: 0.691 Test Acc: 0.556
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.092567682266235
Epoch: 5, Steps: 13 | Train Loss: 0.596 Vali Loss: 1.432 Vali Acc: 0.722 Test Loss: 1.432 Test Acc: 0.722
Validation loss decreased (-0.712179 --> -0.721937).  Saving model ...
Epoch: 6 cost time: 6.2114951610565186
Epoch: 6, Steps: 13 | Train Loss: 2.709 Vali Loss: 1.706 Vali Acc: 0.351 Test Loss: 1.706 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.936743259429932
Epoch: 7, Steps: 13 | Train Loss: 1.320 Vali Loss: 3.132 Vali Acc: 0.327 Test Loss: 3.132 Test Acc: 0.327
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.779806852340698
Epoch: 8, Steps: 13 | Train Loss: 1.688 Vali Loss: 2.237 Vali Acc: 0.712 Test Loss: 2.237 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.3953447341918945
Epoch: 9, Steps: 13 | Train Loss: 1.943 Vali Loss: 1.488 Vali Acc: 0.737 Test Loss: 1.488 Test Acc: 0.737
Validation loss decreased (-0.721937 --> -0.736570).  Saving model ...
Epoch: 10 cost time: 5.901181936264038
Epoch: 10, Steps: 13 | Train Loss: 0.736 Vali Loss: 1.010 Vali Acc: 0.580 Test Loss: 1.010 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.0844056606292725
Epoch: 11, Steps: 13 | Train Loss: 0.765 Vali Loss: 6.096 Vali Acc: 0.288 Test Loss: 6.096 Test Acc: 0.288
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.137003421783447
Epoch: 12, Steps: 13 | Train Loss: 1.491 Vali Loss: 0.896 Vali Acc: 0.698 Test Loss: 0.896 Test Acc: 0.698
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.646299600601196
Epoch: 13, Steps: 13 | Train Loss: 1.086 Vali Loss: 2.290 Vali Acc: 0.741 Test Loss: 2.290 Test Acc: 0.741
Validation loss decreased (-0.736570 --> -0.741441).  Saving model ...
Epoch: 14 cost time: 5.901811122894287
Epoch: 14, Steps: 13 | Train Loss: 0.914 Vali Loss: 5.257 Vali Acc: 0.722 Test Loss: 5.257 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.922170162200928
Epoch: 15, Steps: 13 | Train Loss: 2.323 Vali Loss: 2.727 Vali Acc: 0.761 Test Loss: 2.727 Test Acc: 0.761
Validation loss decreased (-0.741441 --> -0.760948).  Saving model ...
Epoch: 16 cost time: 6.977867364883423
Epoch: 16, Steps: 13 | Train Loss: 1.702 Vali Loss: 2.914 Vali Acc: 0.722 Test Loss: 2.914 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.275344371795654
Epoch: 17, Steps: 13 | Train Loss: 3.380 Vali Loss: 3.040 Vali Acc: 0.751 Test Loss: 3.040 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.447101354598999
Epoch: 18, Steps: 13 | Train Loss: 1.622 Vali Loss: 5.043 Vali Acc: 0.727 Test Loss: 5.043 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.972975254058838
Epoch: 19, Steps: 13 | Train Loss: 2.322 Vali Loss: 7.916 Vali Acc: 0.366 Test Loss: 7.916 Test Acc: 0.366
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 5.997179746627808
Epoch: 20, Steps: 13 | Train Loss: 1.155 Vali Loss: 8.265 Vali Acc: 0.424 Test Loss: 8.265 Test Acc: 0.424
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 5.785447835922241
Epoch: 21, Steps: 13 | Train Loss: 0.630 Vali Loss: 2.216 Vali Acc: 0.678 Test Loss: 2.216 Test Acc: 0.678
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 6.6298205852508545
Epoch: 22, Steps: 13 | Train Loss: 1.295 Vali Loss: 2.623 Vali Acc: 0.707 Test Loss: 2.623 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 6.331596612930298
Epoch: 23, Steps: 13 | Train Loss: 0.431 Vali Loss: 2.858 Vali Acc: 0.727 Test Loss: 2.858 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 6.1140899658203125
Epoch: 24, Steps: 13 | Train Loss: 0.230 Vali Loss: 3.177 Vali Acc: 0.746 Test Loss: 3.177 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 6.036491632461548
Epoch: 25, Steps: 13 | Train Loss: 0.163 Vali Loss: 2.296 Vali Acc: 0.688 Test Loss: 2.296 Test Acc: 0.688
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 10104882
model size : 43.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.14910888671875
Epoch: 1, Steps: 13 | Train Loss: 0.938 Vali Loss: 1.811 Vali Acc: 0.722 Test Loss: 1.811 Test Acc: 0.722
Validation loss decreased (inf --> -0.721933).  Saving model ...
Epoch: 2 cost time: 6.903355121612549
Epoch: 2, Steps: 13 | Train Loss: 1.550 Vali Loss: 0.608 Vali Acc: 0.698 Test Loss: 0.608 Test Acc: 0.698
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.387814998626709
Epoch: 3, Steps: 13 | Train Loss: 1.004 Vali Loss: 2.019 Vali Acc: 0.307 Test Loss: 2.019 Test Acc: 0.307
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.491666793823242
Epoch: 4, Steps: 13 | Train Loss: 0.861 Vali Loss: 0.844 Vali Acc: 0.468 Test Loss: 0.844 Test Acc: 0.468
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.74471640586853
Epoch: 5, Steps: 13 | Train Loss: 1.085 Vali Loss: 2.289 Vali Acc: 0.712 Test Loss: 2.289 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.486678600311279
Epoch: 6, Steps: 13 | Train Loss: 2.493 Vali Loss: 1.700 Vali Acc: 0.366 Test Loss: 1.700 Test Acc: 0.366
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.271026372909546
Epoch: 7, Steps: 13 | Train Loss: 0.701 Vali Loss: 0.692 Vali Acc: 0.688 Test Loss: 0.692 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.749973297119141
Epoch: 8, Steps: 13 | Train Loss: 2.737 Vali Loss: 1.686 Vali Acc: 0.434 Test Loss: 1.686 Test Acc: 0.434
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.475382328033447
Epoch: 9, Steps: 13 | Train Loss: 1.674 Vali Loss: 1.065 Vali Acc: 0.576 Test Loss: 1.065 Test Acc: 0.576
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 6.427142858505249
Epoch: 10, Steps: 13 | Train Loss: 0.645 Vali Loss: 6.886 Vali Acc: 0.288 Test Loss: 6.886 Test Acc: 0.288
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 6.269026517868042
Epoch: 11, Steps: 13 | Train Loss: 3.154 Vali Loss: 0.875 Vali Acc: 0.707 Test Loss: 0.875 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 10089522
model size : 43.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.913728952407837
Epoch: 1, Steps: 13 | Train Loss: 0.938 Vali Loss: 0.603 Vali Acc: 0.722 Test Loss: 0.603 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 6.159869909286499
Epoch: 2, Steps: 13 | Train Loss: 0.904 Vali Loss: 1.721 Vali Acc: 0.293 Test Loss: 1.721 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.00336217880249
Epoch: 3, Steps: 13 | Train Loss: 0.951 Vali Loss: 0.772 Vali Acc: 0.737 Test Loss: 0.772 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736578).  Saving model ...
Epoch: 4 cost time: 5.80605936050415
Epoch: 4, Steps: 13 | Train Loss: 0.727 Vali Loss: 0.709 Vali Acc: 0.590 Test Loss: 0.709 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.047630310058594
Epoch: 5, Steps: 13 | Train Loss: 0.731 Vali Loss: 5.187 Vali Acc: 0.288 Test Loss: 5.187 Test Acc: 0.288
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.688412189483643
Epoch: 6, Steps: 13 | Train Loss: 1.862 Vali Loss: 1.308 Vali Acc: 0.737 Test Loss: 1.308 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.725827217102051
Epoch: 7, Steps: 13 | Train Loss: 3.105 Vali Loss: 3.989 Vali Acc: 0.722 Test Loss: 3.989 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.377316236495972
Epoch: 8, Steps: 13 | Train Loss: 2.436 Vali Loss: 0.765 Vali Acc: 0.746 Test Loss: 0.765 Test Acc: 0.746
Validation loss decreased (-0.736578 --> -0.746334).  Saving model ...
Epoch: 9 cost time: 4.499435901641846
Epoch: 9, Steps: 13 | Train Loss: 1.677 Vali Loss: 2.742 Vali Acc: 0.722 Test Loss: 2.742 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.417060375213623
Epoch: 10, Steps: 13 | Train Loss: 1.105 Vali Loss: 1.680 Vali Acc: 0.737 Test Loss: 1.680 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.15049409866333
Epoch: 11, Steps: 13 | Train Loss: 1.074 Vali Loss: 3.682 Vali Acc: 0.712 Test Loss: 3.682 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.596820592880249
Epoch: 12, Steps: 13 | Train Loss: 1.248 Vali Loss: 4.926 Vali Acc: 0.722 Test Loss: 4.926 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.338550090789795
Epoch: 13, Steps: 13 | Train Loss: 3.400 Vali Loss: 11.031 Vali Acc: 0.278 Test Loss: 11.031 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.286212921142578
Epoch: 14, Steps: 13 | Train Loss: 2.461 Vali Loss: 9.385 Vali Acc: 0.288 Test Loss: 9.385 Test Acc: 0.288
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.871489763259888
Epoch: 15, Steps: 13 | Train Loss: 2.016 Vali Loss: 1.898 Vali Acc: 0.615 Test Loss: 1.898 Test Acc: 0.615
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 6.52929162979126
Epoch: 16, Steps: 13 | Train Loss: 1.675 Vali Loss: 3.013 Vali Acc: 0.756 Test Loss: 3.013 Test Acc: 0.756
Validation loss decreased (-0.746334 --> -0.756067).  Saving model ...
Epoch: 17 cost time: 5.6704583168029785
Epoch: 17, Steps: 13 | Train Loss: 0.887 Vali Loss: 3.078 Vali Acc: 0.551 Test Loss: 3.078 Test Acc: 0.551
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.952463626861572
Epoch: 18, Steps: 13 | Train Loss: 0.472 Vali Loss: 2.421 Vali Acc: 0.746 Test Loss: 2.421 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.8958516120910645
Epoch: 19, Steps: 13 | Train Loss: 0.590 Vali Loss: 5.729 Vali Acc: 0.737 Test Loss: 5.729 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.63108229637146
Epoch: 20, Steps: 13 | Train Loss: 1.273 Vali Loss: 7.263 Vali Acc: 0.717 Test Loss: 7.263 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 6.476525545120239
Epoch: 21, Steps: 13 | Train Loss: 1.295 Vali Loss: 6.638 Vali Acc: 0.532 Test Loss: 6.638 Test Acc: 0.532
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 5.384952545166016
Epoch: 22, Steps: 13 | Train Loss: 0.367 Vali Loss: 2.801 Vali Acc: 0.717 Test Loss: 2.801 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 6.450060844421387
Epoch: 23, Steps: 13 | Train Loss: 0.290 Vali Loss: 6.977 Vali Acc: 0.737 Test Loss: 6.977 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 5.242541074752808
Epoch: 24, Steps: 13 | Train Loss: 0.797 Vali Loss: 4.380 Vali Acc: 0.717 Test Loss: 4.380 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 6.089379549026489
Epoch: 25, Steps: 13 | Train Loss: 1.554 Vali Loss: 10.317 Vali Acc: 0.712 Test Loss: 10.317 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 5.387845754623413
Epoch: 26, Steps: 13 | Train Loss: 3.665 Vali Loss: 3.095 Vali Acc: 0.571 Test Loss: 3.095 Test Acc: 0.571
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 10074162
model size : 43.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.146216869354248
Epoch: 1, Steps: 13 | Train Loss: 0.645 Vali Loss: 1.111 Vali Acc: 0.712 Test Loss: 1.111 Test Acc: 0.712
Validation loss decreased (inf --> -0.712184).  Saving model ...
Epoch: 2 cost time: 5.803290605545044
Epoch: 2, Steps: 13 | Train Loss: 1.013 Vali Loss: 0.788 Vali Acc: 0.722 Test Loss: 0.788 Test Acc: 0.722
Validation loss decreased (-0.712184 --> -0.721943).  Saving model ...
Epoch: 3 cost time: 5.603585958480835
Epoch: 3, Steps: 13 | Train Loss: 0.914 Vali Loss: 0.941 Vali Acc: 0.722 Test Loss: 0.941 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.79148006439209
Epoch: 4, Steps: 13 | Train Loss: 0.684 Vali Loss: 0.707 Vali Acc: 0.561 Test Loss: 0.707 Test Acc: 0.561
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.952399253845215
Epoch: 5, Steps: 13 | Train Loss: 0.606 Vali Loss: 0.706 Vali Acc: 0.624 Test Loss: 0.706 Test Acc: 0.624
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.280982255935669
Epoch: 6, Steps: 13 | Train Loss: 0.738 Vali Loss: 0.593 Vali Acc: 0.698 Test Loss: 0.593 Test Acc: 0.698
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.928978443145752
Epoch: 7, Steps: 13 | Train Loss: 1.195 Vali Loss: 2.263 Vali Acc: 0.722 Test Loss: 2.263 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 7.1423094272613525
Epoch: 8, Steps: 13 | Train Loss: 2.123 Vali Loss: 0.606 Vali Acc: 0.678 Test Loss: 0.606 Test Acc: 0.678
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.460047006607056
Epoch: 9, Steps: 13 | Train Loss: 1.513 Vali Loss: 3.421 Vali Acc: 0.712 Test Loss: 3.421 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 7.010761976242065
Epoch: 10, Steps: 13 | Train Loss: 1.409 Vali Loss: 2.001 Vali Acc: 0.488 Test Loss: 2.001 Test Acc: 0.488
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 6.228421211242676
Epoch: 11, Steps: 13 | Train Loss: 1.583 Vali Loss: 2.308 Vali Acc: 0.737 Test Loss: 2.308 Test Acc: 0.737
Validation loss decreased (-0.721943 --> -0.736562).  Saving model ...
Epoch: 12 cost time: 6.249367952346802
Epoch: 12, Steps: 13 | Train Loss: 1.200 Vali Loss: 2.931 Vali Acc: 0.722 Test Loss: 2.931 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.664223670959473
Epoch: 13, Steps: 13 | Train Loss: 1.676 Vali Loss: 4.430 Vali Acc: 0.717 Test Loss: 4.430 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.1464948654174805
Epoch: 14, Steps: 13 | Train Loss: 1.196 Vali Loss: 8.833 Vali Acc: 0.283 Test Loss: 8.833 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.961674451828003
Epoch: 15, Steps: 13 | Train Loss: 1.602 Vali Loss: 1.710 Vali Acc: 0.590 Test Loss: 1.710 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.47515869140625
Epoch: 16, Steps: 13 | Train Loss: 1.766 Vali Loss: 3.278 Vali Acc: 0.732 Test Loss: 3.278 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.500001907348633
Epoch: 17, Steps: 13 | Train Loss: 3.287 Vali Loss: 15.803 Vali Acc: 0.317 Test Loss: 15.803 Test Acc: 0.317
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.5478246212005615
Epoch: 18, Steps: 13 | Train Loss: 3.793 Vali Loss: 2.177 Vali Acc: 0.741 Test Loss: 2.177 Test Acc: 0.741
Validation loss decreased (-0.736562 --> -0.741442).  Saving model ...
Epoch: 19 cost time: 6.027571678161621
Epoch: 19, Steps: 13 | Train Loss: 1.488 Vali Loss: 2.684 Vali Acc: 0.527 Test Loss: 2.684 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.970935821533203
Epoch: 20, Steps: 13 | Train Loss: 0.328 Vali Loss: 2.196 Vali Acc: 0.649 Test Loss: 2.196 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 6.454885721206665
Epoch: 21, Steps: 13 | Train Loss: 0.565 Vali Loss: 2.617 Vali Acc: 0.615 Test Loss: 2.617 Test Acc: 0.615
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 6.843437910079956
Epoch: 22, Steps: 13 | Train Loss: 1.296 Vali Loss: 3.154 Vali Acc: 0.629 Test Loss: 3.154 Test Acc: 0.629
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 6.87199854850769
Epoch: 23, Steps: 13 | Train Loss: 2.733 Vali Loss: 14.040 Vali Acc: 0.712 Test Loss: 14.040 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 6.768290042877197
Epoch: 24, Steps: 13 | Train Loss: 6.800 Vali Loss: 4.571 Vali Acc: 0.727 Test Loss: 4.571 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 6.92404842376709
Epoch: 25, Steps: 13 | Train Loss: 1.238 Vali Loss: 3.395 Vali Acc: 0.668 Test Loss: 3.395 Test Acc: 0.668
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 6.9034435749053955
Epoch: 26, Steps: 13 | Train Loss: 0.874 Vali Loss: 3.937 Vali Acc: 0.693 Test Loss: 3.937 Test Acc: 0.693
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 6.092138290405273
Epoch: 27, Steps: 13 | Train Loss: 0.562 Vali Loss: 5.089 Vali Acc: 0.580 Test Loss: 5.089 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 7.195376396179199
Epoch: 28, Steps: 13 | Train Loss: 0.538 Vali Loss: 5.337 Vali Acc: 0.746 Test Loss: 5.337 Test Acc: 0.746
Validation loss decreased (-0.741442 --> -0.746288).  Saving model ...
Epoch: 29 cost time: 6.449045181274414
Epoch: 29, Steps: 13 | Train Loss: 0.263 Vali Loss: 3.390 Vali Acc: 0.620 Test Loss: 3.390 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 6.1880903244018555
Epoch: 30, Steps: 13 | Train Loss: 0.515 Vali Loss: 11.318 Vali Acc: 0.385 Test Loss: 11.318 Test Acc: 0.385
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 5.473492622375488
Epoch: 31, Steps: 13 | Train Loss: 0.997 Vali Loss: 4.208 Vali Acc: 0.722 Test Loss: 4.208 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 7.310760021209717
Epoch: 32, Steps: 13 | Train Loss: 0.929 Vali Loss: 7.503 Vali Acc: 0.722 Test Loss: 7.503 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 6.107250690460205
Epoch: 33, Steps: 13 | Train Loss: 1.459 Vali Loss: 4.315 Vali Acc: 0.737 Test Loss: 4.315 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 6.314897298812866
Epoch: 34, Steps: 13 | Train Loss: 1.013 Vali Loss: 4.619 Vali Acc: 0.585 Test Loss: 4.619 Test Acc: 0.585
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 7.089685678482056
Epoch: 35, Steps: 13 | Train Loss: 0.048 Vali Loss: 3.888 Vali Acc: 0.698 Test Loss: 3.888 Test Acc: 0.698
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 7.273253679275513
Epoch: 36, Steps: 13 | Train Loss: 0.045 Vali Loss: 5.202 Vali Acc: 0.751 Test Loss: 5.202 Test Acc: 0.751
Validation loss decreased (-0.746288 --> -0.751167).  Saving model ...
Epoch: 37 cost time: 7.3600263595581055
Epoch: 37, Steps: 13 | Train Loss: 0.181 Vali Loss: 4.500 Vali Acc: 0.673 Test Loss: 4.500 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 6.661098480224609
Epoch: 38, Steps: 13 | Train Loss: 0.173 Vali Loss: 7.120 Vali Acc: 0.522 Test Loss: 7.120 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 6.866783142089844
Epoch: 39, Steps: 13 | Train Loss: 0.084 Vali Loss: 6.184 Vali Acc: 0.727 Test Loss: 6.184 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 7.218876600265503
Epoch: 40, Steps: 13 | Train Loss: 0.275 Vali Loss: 7.258 Vali Acc: 0.541 Test Loss: 7.258 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 6.410820960998535
Epoch: 41, Steps: 13 | Train Loss: 0.214 Vali Loss: 5.709 Vali Acc: 0.546 Test Loss: 5.709 Test Acc: 0.546
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 7.070781707763672
Epoch: 42, Steps: 13 | Train Loss: 0.140 Vali Loss: 6.213 Vali Acc: 0.712 Test Loss: 6.213 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 5.959501266479492
Epoch: 43, Steps: 13 | Train Loss: 0.571 Vali Loss: 11.021 Vali Acc: 0.483 Test Loss: 11.021 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 5.881160497665405
Epoch: 44, Steps: 13 | Train Loss: 0.798 Vali Loss: 6.722 Vali Acc: 0.722 Test Loss: 6.722 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 5.803843021392822
Epoch: 45, Steps: 13 | Train Loss: 0.209 Vali Loss: 5.959 Vali Acc: 0.644 Test Loss: 5.959 Test Acc: 0.644
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 6.959278106689453
Epoch: 46, Steps: 13 | Train Loss: 0.367 Vali Loss: 6.351 Vali Acc: 0.732 Test Loss: 6.351 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 9200946
model size : 40.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.325934171676636
Epoch: 1, Steps: 13 | Train Loss: 0.761 Vali Loss: 0.669 Vali Acc: 0.717 Test Loss: 0.669 Test Acc: 0.717
Validation loss decreased (inf --> -0.717066).  Saving model ...
Epoch: 2 cost time: 6.446504354476929
Epoch: 2, Steps: 13 | Train Loss: 1.526 Vali Loss: 1.242 Vali Acc: 0.717 Test Loss: 1.242 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.183161020278931
Epoch: 3, Steps: 13 | Train Loss: 0.833 Vali Loss: 0.545 Vali Acc: 0.741 Test Loss: 0.545 Test Acc: 0.741
Validation loss decreased (-0.717066 --> -0.741458).  Saving model ...
Epoch: 4 cost time: 6.632263898849487
Epoch: 4, Steps: 13 | Train Loss: 0.874 Vali Loss: 1.564 Vali Acc: 0.356 Test Loss: 1.564 Test Acc: 0.356
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.103177070617676
Epoch: 5, Steps: 13 | Train Loss: 0.730 Vali Loss: 4.300 Vali Acc: 0.288 Test Loss: 4.300 Test Acc: 0.288
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.839601516723633
Epoch: 6, Steps: 13 | Train Loss: 2.549 Vali Loss: 0.565 Vali Acc: 0.746 Test Loss: 0.565 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746336).  Saving model ...
Epoch: 7 cost time: 6.388127326965332
Epoch: 7, Steps: 13 | Train Loss: 0.820 Vali Loss: 1.650 Vali Acc: 0.722 Test Loss: 1.650 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.319323778152466
Epoch: 8, Steps: 13 | Train Loss: 0.763 Vali Loss: 3.349 Vali Acc: 0.307 Test Loss: 3.349 Test Acc: 0.307
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.369921684265137
Epoch: 9, Steps: 13 | Train Loss: 0.901 Vali Loss: 1.716 Vali Acc: 0.732 Test Loss: 1.716 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.462526559829712
Epoch: 10, Steps: 13 | Train Loss: 4.546 Vali Loss: 16.774 Vali Acc: 0.278 Test Loss: 16.774 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.554636001586914
Epoch: 11, Steps: 13 | Train Loss: 4.806 Vali Loss: 4.925 Vali Acc: 0.332 Test Loss: 4.925 Test Acc: 0.332
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 6.717290163040161
Epoch: 12, Steps: 13 | Train Loss: 5.122 Vali Loss: 8.476 Vali Acc: 0.722 Test Loss: 8.476 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 6.02925705909729
Epoch: 13, Steps: 13 | Train Loss: 1.898 Vali Loss: 1.769 Vali Acc: 0.741 Test Loss: 1.769 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 6.198077440261841
Epoch: 14, Steps: 13 | Train Loss: 3.370 Vali Loss: 5.611 Vali Acc: 0.337 Test Loss: 5.611 Test Acc: 0.337
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 6.096247911453247
Epoch: 15, Steps: 13 | Train Loss: 1.181 Vali Loss: 2.333 Vali Acc: 0.732 Test Loss: 2.333 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 6.121912717819214
Epoch: 16, Steps: 13 | Train Loss: 0.618 Vali Loss: 3.667 Vali Acc: 0.732 Test Loss: 3.667 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 9185586
model size : 40.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.411690711975098
Epoch: 1, Steps: 13 | Train Loss: 0.854 Vali Loss: 0.578 Vali Acc: 0.722 Test Loss: 0.578 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 5.764910459518433
Epoch: 2, Steps: 13 | Train Loss: 0.777 Vali Loss: 1.285 Vali Acc: 0.722 Test Loss: 1.285 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.824419021606445
Epoch: 3, Steps: 13 | Train Loss: 1.072 Vali Loss: 0.978 Vali Acc: 0.722 Test Loss: 0.978 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.334610939025879
Epoch: 4, Steps: 13 | Train Loss: 1.194 Vali Loss: 0.734 Vali Acc: 0.605 Test Loss: 0.734 Test Acc: 0.605
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.400551795959473
Epoch: 5, Steps: 13 | Train Loss: 0.951 Vali Loss: 4.425 Vali Acc: 0.288 Test Loss: 4.425 Test Acc: 0.288
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.511359930038452
Epoch: 6, Steps: 13 | Train Loss: 1.480 Vali Loss: 0.647 Vali Acc: 0.693 Test Loss: 0.647 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.913523435592651
Epoch: 7, Steps: 13 | Train Loss: 1.310 Vali Loss: 1.592 Vali Acc: 0.717 Test Loss: 1.592 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 6.1108269691467285
Epoch: 8, Steps: 13 | Train Loss: 1.104 Vali Loss: 1.115 Vali Acc: 0.732 Test Loss: 1.115 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731696).  Saving model ...
Epoch: 9 cost time: 6.077503442764282
Epoch: 9, Steps: 13 | Train Loss: 3.072 Vali Loss: 3.865 Vali Acc: 0.722 Test Loss: 3.865 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.2189390659332275
Epoch: 10, Steps: 13 | Train Loss: 2.270 Vali Loss: 0.752 Vali Acc: 0.712 Test Loss: 0.752 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.192745923995972
Epoch: 11, Steps: 13 | Train Loss: 1.455 Vali Loss: 3.108 Vali Acc: 0.737 Test Loss: 3.108 Test Acc: 0.737
Validation loss decreased (-0.731696 --> -0.736554).  Saving model ...
Epoch: 12 cost time: 6.527221918106079
Epoch: 12, Steps: 13 | Train Loss: 1.633 Vali Loss: 1.612 Vali Acc: 0.751 Test Loss: 1.612 Test Acc: 0.751
Validation loss decreased (-0.736554 --> -0.751203).  Saving model ...
Epoch: 13 cost time: 6.166587829589844
Epoch: 13, Steps: 13 | Train Loss: 1.003 Vali Loss: 0.949 Vali Acc: 0.727 Test Loss: 0.949 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.029067754745483
Epoch: 14, Steps: 13 | Train Loss: 6.318 Vali Loss: 2.659 Vali Acc: 0.439 Test Loss: 2.659 Test Acc: 0.439
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.541794776916504
Epoch: 15, Steps: 13 | Train Loss: 2.383 Vali Loss: 1.791 Vali Acc: 0.527 Test Loss: 1.791 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.48235821723938
Epoch: 16, Steps: 13 | Train Loss: 0.552 Vali Loss: 1.645 Vali Acc: 0.698 Test Loss: 1.645 Test Acc: 0.698
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.838226556777954
Epoch: 17, Steps: 13 | Train Loss: 1.493 Vali Loss: 3.308 Vali Acc: 0.429 Test Loss: 3.308 Test Acc: 0.429
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.981572866439819
Epoch: 18, Steps: 13 | Train Loss: 1.249 Vali Loss: 2.597 Vali Acc: 0.741 Test Loss: 2.597 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 7.789624929428101
Epoch: 19, Steps: 13 | Train Loss: 0.630 Vali Loss: 3.347 Vali Acc: 0.722 Test Loss: 3.347 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 7.157825231552124
Epoch: 20, Steps: 13 | Train Loss: 1.460 Vali Loss: 1.671 Vali Acc: 0.688 Test Loss: 1.671 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 6.4564735889434814
Epoch: 21, Steps: 13 | Train Loss: 0.236 Vali Loss: 1.817 Vali Acc: 0.649 Test Loss: 1.817 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 6.464337587356567
Epoch: 22, Steps: 13 | Train Loss: 0.807 Vali Loss: 1.759 Vali Acc: 0.712 Test Loss: 1.759 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 9170226
model size : 40.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.314752340316772
Epoch: 1, Steps: 13 | Train Loss: 0.701 Vali Loss: 0.661 Vali Acc: 0.717 Test Loss: 0.661 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 7.156788110733032
Epoch: 2, Steps: 13 | Train Loss: 0.572 Vali Loss: 0.537 Vali Acc: 0.732 Test Loss: 0.537 Test Acc: 0.732
Validation loss decreased (-0.717067 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 6.806197881698608
Epoch: 3, Steps: 13 | Train Loss: 0.663 Vali Loss: 0.780 Vali Acc: 0.517 Test Loss: 0.780 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.201004505157471
Epoch: 4, Steps: 13 | Train Loss: 0.712 Vali Loss: 0.540 Vali Acc: 0.702 Test Loss: 0.540 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.866320848464966
Epoch: 5, Steps: 13 | Train Loss: 1.817 Vali Loss: 3.041 Vali Acc: 0.322 Test Loss: 3.041 Test Acc: 0.322
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.6705591678619385
Epoch: 6, Steps: 13 | Train Loss: 3.528 Vali Loss: 1.749 Vali Acc: 0.722 Test Loss: 1.749 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.851783514022827
Epoch: 7, Steps: 13 | Train Loss: 2.345 Vali Loss: 3.678 Vali Acc: 0.327 Test Loss: 3.678 Test Acc: 0.327
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.629807233810425
Epoch: 8, Steps: 13 | Train Loss: 1.312 Vali Loss: 6.054 Vali Acc: 0.293 Test Loss: 6.054 Test Acc: 0.293
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 7.30659031867981
Epoch: 9, Steps: 13 | Train Loss: 2.262 Vali Loss: 1.947 Vali Acc: 0.737 Test Loss: 1.947 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736566).  Saving model ...
Epoch: 10 cost time: 6.905281066894531
Epoch: 10, Steps: 13 | Train Loss: 2.880 Vali Loss: 4.800 Vali Acc: 0.722 Test Loss: 4.800 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.286489486694336
Epoch: 11, Steps: 13 | Train Loss: 4.307 Vali Loss: 15.391 Vali Acc: 0.288 Test Loss: 15.391 Test Acc: 0.288
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 7.151508808135986
Epoch: 12, Steps: 13 | Train Loss: 5.912 Vali Loss: 7.485 Vali Acc: 0.722 Test Loss: 7.485 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.487252712249756
Epoch: 13, Steps: 13 | Train Loss: 5.134 Vali Loss: 3.260 Vali Acc: 0.746 Test Loss: 3.260 Test Acc: 0.746
Validation loss decreased (-0.736566 --> -0.746309).  Saving model ...
Epoch: 14 cost time: 5.978332757949829
Epoch: 14, Steps: 13 | Train Loss: 1.165 Vali Loss: 8.506 Vali Acc: 0.298 Test Loss: 8.506 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.758667230606079
Epoch: 15, Steps: 13 | Train Loss: 3.306 Vali Loss: 1.381 Vali Acc: 0.585 Test Loss: 1.381 Test Acc: 0.585
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.622344017028809
Epoch: 16, Steps: 13 | Train Loss: 0.944 Vali Loss: 5.283 Vali Acc: 0.356 Test Loss: 5.283 Test Acc: 0.356
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 6.1246418952941895
Epoch: 17, Steps: 13 | Train Loss: 2.416 Vali Loss: 7.106 Vali Acc: 0.722 Test Loss: 7.106 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 6.226520299911499
Epoch: 18, Steps: 13 | Train Loss: 3.306 Vali Loss: 3.001 Vali Acc: 0.532 Test Loss: 3.001 Test Acc: 0.532
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 5.949717998504639
Epoch: 19, Steps: 13 | Train Loss: 0.913 Vali Loss: 4.585 Vali Acc: 0.483 Test Loss: 4.585 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 5.548619747161865
Epoch: 20, Steps: 13 | Train Loss: 0.220 Vali Loss: 2.248 Vali Acc: 0.673 Test Loss: 2.248 Test Acc: 0.673
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 5.550304651260376
Epoch: 21, Steps: 13 | Train Loss: 0.555 Vali Loss: 2.289 Vali Acc: 0.663 Test Loss: 2.289 Test Acc: 0.663
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 6.44266152381897
Epoch: 22, Steps: 13 | Train Loss: 0.336 Vali Loss: 2.292 Vali Acc: 0.693 Test Loss: 2.292 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 6.058896780014038
Epoch: 23, Steps: 13 | Train Loss: 1.521 Vali Loss: 13.956 Vali Acc: 0.307 Test Loss: 13.956 Test Acc: 0.307
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 9154866
model size : 39.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.557602882385254
Epoch: 1, Steps: 13 | Train Loss: 0.874 Vali Loss: 0.845 Vali Acc: 0.283 Test Loss: 0.845 Test Acc: 0.283
Validation loss decreased (inf --> -0.282918).  Saving model ...
Epoch: 2 cost time: 5.887803077697754
Epoch: 2, Steps: 13 | Train Loss: 0.911 Vali Loss: 1.263 Vali Acc: 0.288 Test Loss: 1.263 Test Acc: 0.288
Validation loss decreased (-0.282918 --> -0.287792).  Saving model ...
Epoch: 3 cost time: 5.79845118522644
Epoch: 3, Steps: 13 | Train Loss: 1.310 Vali Loss: 0.987 Vali Acc: 0.449 Test Loss: 0.987 Test Acc: 0.449
Validation loss decreased (-0.287792 --> -0.448771).  Saving model ...
Epoch: 4 cost time: 6.809784650802612
Epoch: 4, Steps: 13 | Train Loss: 1.037 Vali Loss: 1.620 Vali Acc: 0.722 Test Loss: 1.620 Test Acc: 0.722
Validation loss decreased (-0.448771 --> -0.721935).  Saving model ...
Epoch: 5 cost time: 6.076337099075317
Epoch: 5, Steps: 13 | Train Loss: 0.712 Vali Loss: 0.835 Vali Acc: 0.722 Test Loss: 0.835 Test Acc: 0.722
Validation loss decreased (-0.721935 --> -0.721943).  Saving model ...
Epoch: 6 cost time: 6.512698173522949
Epoch: 6, Steps: 13 | Train Loss: 0.645 Vali Loss: 0.902 Vali Acc: 0.478 Test Loss: 0.902 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.783692121505737
Epoch: 7, Steps: 13 | Train Loss: 0.600 Vali Loss: 0.567 Vali Acc: 0.712 Test Loss: 0.567 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.457968473434448
Epoch: 8, Steps: 13 | Train Loss: 0.645 Vali Loss: 1.788 Vali Acc: 0.312 Test Loss: 1.788 Test Acc: 0.312
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.354833602905273
Epoch: 9, Steps: 13 | Train Loss: 1.344 Vali Loss: 1.044 Vali Acc: 0.561 Test Loss: 1.044 Test Acc: 0.561
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.691418647766113
Epoch: 10, Steps: 13 | Train Loss: 1.196 Vali Loss: 1.419 Vali Acc: 0.741 Test Loss: 1.419 Test Acc: 0.741
Validation loss decreased (-0.721943 --> -0.741449).  Saving model ...
Epoch: 11 cost time: 6.300358772277832
Epoch: 11, Steps: 13 | Train Loss: 0.583 Vali Loss: 1.994 Vali Acc: 0.727 Test Loss: 1.994 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.8178839683532715
Epoch: 12, Steps: 13 | Train Loss: 2.068 Vali Loss: 0.951 Vali Acc: 0.737 Test Loss: 0.951 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.221849203109741
Epoch: 13, Steps: 13 | Train Loss: 1.087 Vali Loss: 3.792 Vali Acc: 0.341 Test Loss: 3.792 Test Acc: 0.341
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.416404485702515
Epoch: 14, Steps: 13 | Train Loss: 0.922 Vali Loss: 1.101 Vali Acc: 0.649 Test Loss: 1.101 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 7.022047996520996
Epoch: 15, Steps: 13 | Train Loss: 0.561 Vali Loss: 2.020 Vali Acc: 0.717 Test Loss: 2.020 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 6.791414022445679
Epoch: 16, Steps: 13 | Train Loss: 0.484 Vali Loss: 2.195 Vali Acc: 0.737 Test Loss: 2.195 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 6.654832363128662
Epoch: 17, Steps: 13 | Train Loss: 0.398 Vali Loss: 2.199 Vali Acc: 0.737 Test Loss: 2.199 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 6.91068959236145
Epoch: 18, Steps: 13 | Train Loss: 0.689 Vali Loss: 8.620 Vali Acc: 0.312 Test Loss: 8.620 Test Acc: 0.312
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 6.488415002822876
Epoch: 19, Steps: 13 | Train Loss: 1.180 Vali Loss: 1.735 Vali Acc: 0.751 Test Loss: 1.735 Test Acc: 0.751
Validation loss decreased (-0.741449 --> -0.751202).  Saving model ...
Epoch: 20 cost time: 5.728441476821899
Epoch: 20, Steps: 13 | Train Loss: 0.226 Vali Loss: 2.171 Vali Acc: 0.741 Test Loss: 2.171 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.103309869766235
Epoch: 21, Steps: 13 | Train Loss: 0.189 Vali Loss: 1.599 Vali Acc: 0.649 Test Loss: 1.599 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.675585985183716
Epoch: 22, Steps: 13 | Train Loss: 0.135 Vali Loss: 4.364 Vali Acc: 0.727 Test Loss: 4.364 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 5.591002464294434
Epoch: 23, Steps: 13 | Train Loss: 1.165 Vali Loss: 2.362 Vali Acc: 0.732 Test Loss: 2.362 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 5.988749265670776
Epoch: 24, Steps: 13 | Train Loss: 2.341 Vali Loss: 3.204 Vali Acc: 0.761 Test Loss: 3.204 Test Acc: 0.761
Validation loss decreased (-0.751202 --> -0.760944).  Saving model ...
Epoch: 25 cost time: 5.038017272949219
Epoch: 25, Steps: 13 | Train Loss: 1.088 Vali Loss: 6.028 Vali Acc: 0.712 Test Loss: 6.028 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 7.007766962051392
Epoch: 26, Steps: 13 | Train Loss: 0.809 Vali Loss: 8.461 Vali Acc: 0.459 Test Loss: 8.461 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 4.611323356628418
Epoch: 27, Steps: 13 | Train Loss: 0.762 Vali Loss: 9.110 Vali Acc: 0.444 Test Loss: 9.110 Test Acc: 0.444
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 4.611732482910156
Epoch: 28, Steps: 13 | Train Loss: 3.350 Vali Loss: 3.410 Vali Acc: 0.712 Test Loss: 3.410 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 5.458677530288696
Epoch: 29, Steps: 13 | Train Loss: 1.124 Vali Loss: 6.294 Vali Acc: 0.541 Test Loss: 6.294 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 6.899249315261841
Epoch: 30, Steps: 13 | Train Loss: 0.998 Vali Loss: 4.840 Vali Acc: 0.737 Test Loss: 4.840 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 5.9089953899383545
Epoch: 31, Steps: 13 | Train Loss: 0.054 Vali Loss: 5.592 Vali Acc: 0.590 Test Loss: 5.592 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 5.427285432815552
Epoch: 32, Steps: 13 | Train Loss: 0.283 Vali Loss: 6.567 Vali Acc: 0.741 Test Loss: 6.567 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 6.843432664871216
Epoch: 33, Steps: 13 | Train Loss: 1.018 Vali Loss: 10.181 Vali Acc: 0.717 Test Loss: 10.181 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 6.359744071960449
Epoch: 34, Steps: 13 | Train Loss: 1.293 Vali Loss: 11.001 Vali Acc: 0.727 Test Loss: 11.001 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 8741298
model size : 38.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.314195156097412
Epoch: 1, Steps: 13 | Train Loss: 0.729 Vali Loss: 0.557 Vali Acc: 0.722 Test Loss: 0.557 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 5.70837664604187
Epoch: 2, Steps: 13 | Train Loss: 1.119 Vali Loss: 2.776 Vali Acc: 0.722 Test Loss: 2.776 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.047723054885864
Epoch: 3, Steps: 13 | Train Loss: 2.696 Vali Loss: 4.803 Vali Acc: 0.278 Test Loss: 4.803 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.38576865196228
Epoch: 4, Steps: 13 | Train Loss: 3.997 Vali Loss: 3.236 Vali Acc: 0.293 Test Loss: 3.236 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.456403493881226
Epoch: 5, Steps: 13 | Train Loss: 2.322 Vali Loss: 1.755 Vali Acc: 0.717 Test Loss: 1.755 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.045323848724365
Epoch: 6, Steps: 13 | Train Loss: 1.544 Vali Loss: 0.531 Vali Acc: 0.761 Test Loss: 0.531 Test Acc: 0.761
Validation loss decreased (-0.721946 --> -0.760970).  Saving model ...
Epoch: 7 cost time: 6.429284572601318
Epoch: 7, Steps: 13 | Train Loss: 1.914 Vali Loss: 0.657 Vali Acc: 0.654 Test Loss: 0.657 Test Acc: 0.654
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.618471384048462
Epoch: 8, Steps: 13 | Train Loss: 2.637 Vali Loss: 3.729 Vali Acc: 0.707 Test Loss: 3.729 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.156680345535278
Epoch: 9, Steps: 13 | Train Loss: 1.234 Vali Loss: 1.404 Vali Acc: 0.478 Test Loss: 1.404 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 7.2772297859191895
Epoch: 10, Steps: 13 | Train Loss: 0.664 Vali Loss: 1.277 Vali Acc: 0.727 Test Loss: 1.277 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.914187431335449
Epoch: 11, Steps: 13 | Train Loss: 1.242 Vali Loss: 1.005 Vali Acc: 0.624 Test Loss: 1.005 Test Acc: 0.624
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 6.495971202850342
Epoch: 12, Steps: 13 | Train Loss: 2.345 Vali Loss: 0.858 Vali Acc: 0.722 Test Loss: 0.858 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 6.363328456878662
Epoch: 13, Steps: 13 | Train Loss: 0.943 Vali Loss: 0.934 Vali Acc: 0.580 Test Loss: 0.934 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 6.230505704879761
Epoch: 14, Steps: 13 | Train Loss: 1.459 Vali Loss: 0.949 Vali Acc: 0.585 Test Loss: 0.949 Test Acc: 0.585
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.89588475227356
Epoch: 15, Steps: 13 | Train Loss: 1.184 Vali Loss: 0.805 Vali Acc: 0.663 Test Loss: 0.805 Test Acc: 0.663
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 6.049465894699097
Epoch: 16, Steps: 13 | Train Loss: 1.028 Vali Loss: 1.268 Vali Acc: 0.766 Test Loss: 1.268 Test Acc: 0.766
Validation loss decreased (-0.760970 --> -0.765841).  Saving model ...
Epoch: 17 cost time: 6.039951324462891
Epoch: 17, Steps: 13 | Train Loss: 1.502 Vali Loss: 1.196 Vali Acc: 0.517 Test Loss: 1.196 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.707597494125366
Epoch: 18, Steps: 13 | Train Loss: 0.402 Vali Loss: 1.982 Vali Acc: 0.478 Test Loss: 1.982 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 6.207916259765625
Epoch: 19, Steps: 13 | Train Loss: 1.512 Vali Loss: 1.230 Vali Acc: 0.639 Test Loss: 1.230 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.963658094406128
Epoch: 20, Steps: 13 | Train Loss: 0.670 Vali Loss: 1.439 Vali Acc: 0.693 Test Loss: 1.439 Test Acc: 0.693
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 6.227909326553345
Epoch: 21, Steps: 13 | Train Loss: 0.495 Vali Loss: 1.476 Vali Acc: 0.746 Test Loss: 1.476 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 6.015485525131226
Epoch: 22, Steps: 13 | Train Loss: 0.289 Vali Loss: 3.150 Vali Acc: 0.473 Test Loss: 3.150 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 6.097493886947632
Epoch: 23, Steps: 13 | Train Loss: 0.232 Vali Loss: 4.385 Vali Acc: 0.722 Test Loss: 4.385 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 6.058021306991577
Epoch: 24, Steps: 13 | Train Loss: 0.318 Vali Loss: 3.424 Vali Acc: 0.737 Test Loss: 3.424 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 6.526177167892456
Epoch: 25, Steps: 13 | Train Loss: 0.667 Vali Loss: 1.878 Vali Acc: 0.649 Test Loss: 1.878 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 6.278655290603638
Epoch: 26, Steps: 13 | Train Loss: 0.431 Vali Loss: 2.901 Vali Acc: 0.663 Test Loss: 2.901 Test Acc: 0.663
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 8725938
model size : 38.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 9.468820333480835
Epoch: 1, Steps: 13 | Train Loss: 0.674 Vali Loss: 0.622 Vali Acc: 0.746 Test Loss: 0.622 Test Acc: 0.746
Validation loss decreased (inf --> -0.746335).  Saving model ...
Epoch: 2 cost time: 5.003175497055054
Epoch: 2, Steps: 13 | Train Loss: 0.662 Vali Loss: 0.821 Vali Acc: 0.405 Test Loss: 0.821 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.309422492980957
Epoch: 3, Steps: 13 | Train Loss: 1.274 Vali Loss: 6.903 Vali Acc: 0.288 Test Loss: 6.903 Test Acc: 0.288
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.905411243438721
Epoch: 4, Steps: 13 | Train Loss: 2.744 Vali Loss: 3.210 Vali Acc: 0.722 Test Loss: 3.210 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.273266792297363
Epoch: 5, Steps: 13 | Train Loss: 4.128 Vali Loss: 3.584 Vali Acc: 0.288 Test Loss: 3.584 Test Acc: 0.288
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.044437646865845
Epoch: 6, Steps: 13 | Train Loss: 2.377 Vali Loss: 3.201 Vali Acc: 0.722 Test Loss: 3.201 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.368579149246216
Epoch: 7, Steps: 13 | Train Loss: 2.286 Vali Loss: 2.935 Vali Acc: 0.415 Test Loss: 2.935 Test Acc: 0.415
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.880232810974121
Epoch: 8, Steps: 13 | Train Loss: 2.020 Vali Loss: 4.118 Vali Acc: 0.346 Test Loss: 4.118 Test Acc: 0.346
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.449245452880859
Epoch: 9, Steps: 13 | Train Loss: 1.883 Vali Loss: 1.101 Vali Acc: 0.576 Test Loss: 1.101 Test Acc: 0.576
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.735998630523682
Epoch: 10, Steps: 13 | Train Loss: 0.880 Vali Loss: 3.666 Vali Acc: 0.722 Test Loss: 3.666 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 6.312399864196777
Epoch: 11, Steps: 13 | Train Loss: 2.294 Vali Loss: 1.525 Vali Acc: 0.741 Test Loss: 1.525 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 8710578
model size : 38.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.6720569133758545
Epoch: 1, Steps: 13 | Train Loss: 0.782 Vali Loss: 0.577 Vali Acc: 0.712 Test Loss: 0.577 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 5.327596426010132
Epoch: 2, Steps: 13 | Train Loss: 0.832 Vali Loss: 1.427 Vali Acc: 0.302 Test Loss: 1.427 Test Acc: 0.302
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.234002113342285
Epoch: 3, Steps: 13 | Train Loss: 1.071 Vali Loss: 0.565 Vali Acc: 0.756 Test Loss: 0.565 Test Acc: 0.756
Validation loss decreased (-0.712189 --> -0.756092).  Saving model ...
Epoch: 4 cost time: 6.175900459289551
Epoch: 4, Steps: 13 | Train Loss: 1.221 Vali Loss: 0.864 Vali Acc: 0.732 Test Loss: 0.864 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.632776260375977
Epoch: 5, Steps: 13 | Train Loss: 1.184 Vali Loss: 1.933 Vali Acc: 0.717 Test Loss: 1.933 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.315109014511108
Epoch: 6, Steps: 13 | Train Loss: 1.078 Vali Loss: 1.768 Vali Acc: 0.722 Test Loss: 1.768 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.489006280899048
Epoch: 7, Steps: 13 | Train Loss: 2.098 Vali Loss: 1.086 Vali Acc: 0.746 Test Loss: 1.086 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 6.318242788314819
Epoch: 8, Steps: 13 | Train Loss: 1.266 Vali Loss: 0.677 Vali Acc: 0.751 Test Loss: 0.677 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.7091686725616455
Epoch: 9, Steps: 13 | Train Loss: 0.718 Vali Loss: 1.453 Vali Acc: 0.424 Test Loss: 1.453 Test Acc: 0.424
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.229470729827881
Epoch: 10, Steps: 13 | Train Loss: 0.609 Vali Loss: 1.603 Vali Acc: 0.741 Test Loss: 1.603 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.85184121131897
Epoch: 11, Steps: 13 | Train Loss: 2.455 Vali Loss: 5.344 Vali Acc: 0.722 Test Loss: 5.344 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 6.371090650558472
Epoch: 12, Steps: 13 | Train Loss: 1.579 Vali Loss: 3.472 Vali Acc: 0.722 Test Loss: 3.472 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 6.1932761669158936
Epoch: 13, Steps: 13 | Train Loss: 1.433 Vali Loss: 2.954 Vali Acc: 0.737 Test Loss: 2.954 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 8695218
model size : 38.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.6191792488098145
Epoch: 1, Steps: 13 | Train Loss: 0.740 Vali Loss: 0.772 Vali Acc: 0.293 Test Loss: 0.772 Test Acc: 0.293
Validation loss decreased (inf --> -0.292675).  Saving model ...
Epoch: 2 cost time: 6.060985565185547
Epoch: 2, Steps: 13 | Train Loss: 0.884 Vali Loss: 0.561 Vali Acc: 0.751 Test Loss: 0.561 Test Acc: 0.751
Validation loss decreased (-0.292675 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 5.847050428390503
Epoch: 3, Steps: 13 | Train Loss: 0.659 Vali Loss: 0.658 Vali Acc: 0.610 Test Loss: 0.658 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.813733816146851
Epoch: 4, Steps: 13 | Train Loss: 0.522 Vali Loss: 0.673 Vali Acc: 0.605 Test Loss: 0.673 Test Acc: 0.605
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.494317054748535
Epoch: 5, Steps: 13 | Train Loss: 1.185 Vali Loss: 0.585 Vali Acc: 0.761 Test Loss: 0.585 Test Acc: 0.761
Validation loss decreased (-0.751214 --> -0.760970).  Saving model ...
Epoch: 6 cost time: 4.879176139831543
Epoch: 6, Steps: 13 | Train Loss: 1.806 Vali Loss: 1.466 Vali Acc: 0.434 Test Loss: 1.466 Test Acc: 0.434
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.026719808578491
Epoch: 7, Steps: 13 | Train Loss: 0.884 Vali Loss: 0.740 Vali Acc: 0.761 Test Loss: 0.740 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.909601926803589
Epoch: 8, Steps: 13 | Train Loss: 0.795 Vali Loss: 0.635 Vali Acc: 0.722 Test Loss: 0.635 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.335705041885376
Epoch: 9, Steps: 13 | Train Loss: 0.423 Vali Loss: 1.465 Vali Acc: 0.371 Test Loss: 1.465 Test Acc: 0.371
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.852036714553833
Epoch: 10, Steps: 13 | Train Loss: 0.382 Vali Loss: 0.662 Vali Acc: 0.717 Test Loss: 0.662 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.655145645141602
Epoch: 11, Steps: 13 | Train Loss: 0.383 Vali Loss: 0.800 Vali Acc: 0.766 Test Loss: 0.800 Test Acc: 0.766
Validation loss decreased (-0.760970 --> -0.765846).  Saving model ...
Epoch: 12 cost time: 5.406250238418579
Epoch: 12, Steps: 13 | Train Loss: 0.183 Vali Loss: 2.481 Vali Acc: 0.341 Test Loss: 2.481 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.3836095333099365
Epoch: 13, Steps: 13 | Train Loss: 0.378 Vali Loss: 3.058 Vali Acc: 0.722 Test Loss: 3.058 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.746779918670654
Epoch: 14, Steps: 13 | Train Loss: 1.233 Vali Loss: 6.190 Vali Acc: 0.293 Test Loss: 6.190 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.774617671966553
Epoch: 15, Steps: 13 | Train Loss: 1.187 Vali Loss: 2.534 Vali Acc: 0.478 Test Loss: 2.534 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 6.5782389640808105
Epoch: 16, Steps: 13 | Train Loss: 0.299 Vali Loss: 2.453 Vali Acc: 0.478 Test Loss: 2.453 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.666971921920776
Epoch: 17, Steps: 13 | Train Loss: 0.244 Vali Loss: 1.132 Vali Acc: 0.707 Test Loss: 1.132 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 6.119222640991211
Epoch: 18, Steps: 13 | Train Loss: 0.413 Vali Loss: 2.826 Vali Acc: 0.732 Test Loss: 2.826 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 6.163775205612183
Epoch: 19, Steps: 13 | Train Loss: 0.945 Vali Loss: 2.155 Vali Acc: 0.620 Test Loss: 2.155 Test Acc: 0.620
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.590807914733887
Epoch: 20, Steps: 13 | Train Loss: 0.636 Vali Loss: 2.303 Vali Acc: 0.746 Test Loss: 2.303 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.955207824707031
Epoch: 21, Steps: 13 | Train Loss: 0.533 Vali Loss: 1.987 Vali Acc: 0.605 Test Loss: 1.987 Test Acc: 0.605
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 4148018
model size : 18.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.912039756774902
Epoch: 1, Steps: 13 | Train Loss: 0.679 Vali Loss: 0.742 Vali Acc: 0.337 Test Loss: 0.742 Test Acc: 0.337
Validation loss decreased (inf --> -0.336578).  Saving model ...
Epoch: 2 cost time: 5.524434328079224
Epoch: 2, Steps: 13 | Train Loss: 0.682 Vali Loss: 0.794 Vali Acc: 0.307 Test Loss: 0.794 Test Acc: 0.307
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.203364133834839
Epoch: 3, Steps: 13 | Train Loss: 0.590 Vali Loss: 0.528 Vali Acc: 0.741 Test Loss: 0.528 Test Acc: 0.741
Validation loss decreased (-0.336578 --> -0.741458).  Saving model ...
Epoch: 4 cost time: 5.425601482391357
Epoch: 4, Steps: 13 | Train Loss: 0.716 Vali Loss: 0.524 Vali Acc: 0.751 Test Loss: 0.524 Test Acc: 0.751
Validation loss decreased (-0.741458 --> -0.751214).  Saving model ...
Epoch: 5 cost time: 5.1940367221832275
Epoch: 5, Steps: 13 | Train Loss: 1.747 Vali Loss: 1.851 Vali Acc: 0.327 Test Loss: 1.851 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.525416135787964
Epoch: 6, Steps: 13 | Train Loss: 0.945 Vali Loss: 2.214 Vali Acc: 0.312 Test Loss: 2.214 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.416475772857666
Epoch: 7, Steps: 13 | Train Loss: 2.581 Vali Loss: 1.054 Vali Acc: 0.741 Test Loss: 1.054 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.772948980331421
Epoch: 8, Steps: 13 | Train Loss: 0.728 Vali Loss: 0.736 Vali Acc: 0.741 Test Loss: 0.736 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.578536033630371
Epoch: 9, Steps: 13 | Train Loss: 0.398 Vali Loss: 0.602 Vali Acc: 0.771 Test Loss: 0.602 Test Acc: 0.771
Validation loss decreased (-0.751214 --> -0.770726).  Saving model ...
Epoch: 10 cost time: 5.479795932769775
Epoch: 10, Steps: 13 | Train Loss: 0.293 Vali Loss: 0.778 Vali Acc: 0.771 Test Loss: 0.778 Test Acc: 0.771
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.513457775115967
Epoch: 11, Steps: 13 | Train Loss: 0.459 Vali Loss: 0.668 Vali Acc: 0.722 Test Loss: 0.668 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.936270236968994
Epoch: 12, Steps: 13 | Train Loss: 0.653 Vali Loss: 4.913 Vali Acc: 0.278 Test Loss: 4.913 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.215059518814087
Epoch: 13, Steps: 13 | Train Loss: 1.870 Vali Loss: 2.877 Vali Acc: 0.732 Test Loss: 2.877 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.608558893203735
Epoch: 14, Steps: 13 | Train Loss: 1.335 Vali Loss: 3.211 Vali Acc: 0.405 Test Loss: 3.211 Test Acc: 0.405
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.66703987121582
Epoch: 15, Steps: 13 | Train Loss: 1.096 Vali Loss: 0.961 Vali Acc: 0.712 Test Loss: 0.961 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.342106342315674
Epoch: 16, Steps: 13 | Train Loss: 0.314 Vali Loss: 1.678 Vali Acc: 0.746 Test Loss: 1.678 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.391238451004028
Epoch: 17, Steps: 13 | Train Loss: 0.639 Vali Loss: 1.455 Vali Acc: 0.756 Test Loss: 1.455 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.493746280670166
Epoch: 18, Steps: 13 | Train Loss: 0.465 Vali Loss: 2.463 Vali Acc: 0.737 Test Loss: 2.463 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 5.816831827163696
Epoch: 19, Steps: 13 | Train Loss: 0.555 Vali Loss: 1.359 Vali Acc: 0.698 Test Loss: 1.359 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 4140338
model size : 18.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.941821813583374
Epoch: 1, Steps: 13 | Train Loss: 0.719 Vali Loss: 0.590 Vali Acc: 0.707 Test Loss: 0.590 Test Acc: 0.707
Validation loss decreased (inf --> -0.707311).  Saving model ...
Epoch: 2 cost time: 4.9222798347473145
Epoch: 2, Steps: 13 | Train Loss: 0.611 Vali Loss: 0.785 Vali Acc: 0.722 Test Loss: 0.785 Test Acc: 0.722
Validation loss decreased (-0.707311 --> -0.721943).  Saving model ...
Epoch: 3 cost time: 4.860101938247681
Epoch: 3, Steps: 13 | Train Loss: 0.932 Vali Loss: 1.822 Vali Acc: 0.283 Test Loss: 1.822 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.417761325836182
Epoch: 4, Steps: 13 | Train Loss: 2.122 Vali Loss: 2.383 Vali Acc: 0.283 Test Loss: 2.383 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.745143890380859
Epoch: 5, Steps: 13 | Train Loss: 1.349 Vali Loss: 0.862 Vali Acc: 0.737 Test Loss: 0.862 Test Acc: 0.737
Validation loss decreased (-0.721943 --> -0.736577).  Saving model ...
Epoch: 6 cost time: 5.759399175643921
Epoch: 6, Steps: 13 | Train Loss: 1.275 Vali Loss: 0.611 Vali Acc: 0.741 Test Loss: 0.611 Test Acc: 0.741
Validation loss decreased (-0.736577 --> -0.741457).  Saving model ...
Epoch: 7 cost time: 6.333151817321777
Epoch: 7, Steps: 13 | Train Loss: 1.077 Vali Loss: 1.204 Vali Acc: 0.434 Test Loss: 1.204 Test Acc: 0.434
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.824531316757202
Epoch: 8, Steps: 13 | Train Loss: 0.638 Vali Loss: 1.231 Vali Acc: 0.712 Test Loss: 1.231 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.030336856842041
Epoch: 9, Steps: 13 | Train Loss: 0.787 Vali Loss: 1.766 Vali Acc: 0.717 Test Loss: 1.766 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.7594239711761475
Epoch: 10, Steps: 13 | Train Loss: 1.646 Vali Loss: 5.083 Vali Acc: 0.322 Test Loss: 5.083 Test Acc: 0.322
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.049082517623901
Epoch: 11, Steps: 13 | Train Loss: 1.857 Vali Loss: 5.111 Vali Acc: 0.722 Test Loss: 5.111 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 6.329935073852539
Epoch: 12, Steps: 13 | Train Loss: 1.905 Vali Loss: 1.354 Vali Acc: 0.463 Test Loss: 1.354 Test Acc: 0.463
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.058414697647095
Epoch: 13, Steps: 13 | Train Loss: 0.790 Vali Loss: 3.774 Vali Acc: 0.298 Test Loss: 3.774 Test Acc: 0.298
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 6.275548696517944
Epoch: 14, Steps: 13 | Train Loss: 0.827 Vali Loss: 2.038 Vali Acc: 0.449 Test Loss: 2.038 Test Acc: 0.449
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.193674325942993
Epoch: 15, Steps: 13 | Train Loss: 0.506 Vali Loss: 0.895 Vali Acc: 0.707 Test Loss: 0.895 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.321607351303101
Epoch: 16, Steps: 13 | Train Loss: 0.675 Vali Loss: 6.960 Vali Acc: 0.293 Test Loss: 6.960 Test Acc: 0.293
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 4132658
model size : 18.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.355392694473267
Epoch: 1, Steps: 13 | Train Loss: 0.709 Vali Loss: 0.639 Vali Acc: 0.702 Test Loss: 0.639 Test Acc: 0.702
Validation loss decreased (inf --> -0.702433).  Saving model ...
Epoch: 2 cost time: 5.0906007289886475
Epoch: 2, Steps: 13 | Train Loss: 0.721 Vali Loss: 0.551 Vali Acc: 0.737 Test Loss: 0.551 Test Acc: 0.737
Validation loss decreased (-0.702433 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 6.005506277084351
Epoch: 3, Steps: 13 | Train Loss: 1.052 Vali Loss: 1.048 Vali Acc: 0.717 Test Loss: 1.048 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.973725080490112
Epoch: 4, Steps: 13 | Train Loss: 1.193 Vali Loss: 0.603 Vali Acc: 0.737 Test Loss: 0.603 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.572507858276367
Epoch: 5, Steps: 13 | Train Loss: 0.759 Vali Loss: 0.579 Vali Acc: 0.698 Test Loss: 0.579 Test Acc: 0.698
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.3921058177948
Epoch: 6, Steps: 13 | Train Loss: 0.700 Vali Loss: 0.507 Vali Acc: 0.746 Test Loss: 0.507 Test Acc: 0.746
Validation loss decreased (-0.736580 --> -0.746336).  Saving model ...
Epoch: 7 cost time: 5.270258903503418
Epoch: 7, Steps: 13 | Train Loss: 0.441 Vali Loss: 0.682 Vali Acc: 0.737 Test Loss: 0.682 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.783353328704834
Epoch: 8, Steps: 13 | Train Loss: 0.847 Vali Loss: 0.686 Vali Acc: 0.644 Test Loss: 0.686 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.733857154846191
Epoch: 9, Steps: 13 | Train Loss: 2.049 Vali Loss: 0.733 Vali Acc: 0.683 Test Loss: 0.733 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.727487802505493
Epoch: 10, Steps: 13 | Train Loss: 0.843 Vali Loss: 0.674 Vali Acc: 0.722 Test Loss: 0.674 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.108668565750122
Epoch: 11, Steps: 13 | Train Loss: 0.474 Vali Loss: 0.770 Vali Acc: 0.732 Test Loss: 0.770 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.953255891799927
Epoch: 12, Steps: 13 | Train Loss: 1.486 Vali Loss: 2.674 Vali Acc: 0.712 Test Loss: 2.674 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 6.283156633377075
Epoch: 13, Steps: 13 | Train Loss: 0.883 Vali Loss: 0.818 Vali Acc: 0.668 Test Loss: 0.818 Test Acc: 0.668
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.982503652572632
Epoch: 14, Steps: 13 | Train Loss: 1.011 Vali Loss: 4.105 Vali Acc: 0.722 Test Loss: 4.105 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.529056549072266
Epoch: 15, Steps: 13 | Train Loss: 1.955 Vali Loss: 2.894 Vali Acc: 0.463 Test Loss: 2.894 Test Acc: 0.463
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.93545126914978
Epoch: 16, Steps: 13 | Train Loss: 0.656 Vali Loss: 2.094 Vali Acc: 0.737 Test Loss: 2.094 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 4124978
model size : 18.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.641993999481201
Epoch: 1, Steps: 13 | Train Loss: 0.967 Vali Loss: 0.712 Vali Acc: 0.722 Test Loss: 0.712 Test Acc: 0.722
Validation loss decreased (inf --> -0.721944).  Saving model ...
Epoch: 2 cost time: 5.908104419708252
Epoch: 2, Steps: 13 | Train Loss: 0.680 Vali Loss: 1.507 Vali Acc: 0.278 Test Loss: 1.507 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.910731792449951
Epoch: 3, Steps: 13 | Train Loss: 0.978 Vali Loss: 1.362 Vali Acc: 0.722 Test Loss: 1.362 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.170287847518921
Epoch: 4, Steps: 13 | Train Loss: 0.971 Vali Loss: 0.540 Vali Acc: 0.717 Test Loss: 0.540 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.614989519119263
Epoch: 5, Steps: 13 | Train Loss: 0.720 Vali Loss: 2.263 Vali Acc: 0.307 Test Loss: 2.263 Test Acc: 0.307
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.904391288757324
Epoch: 6, Steps: 13 | Train Loss: 1.753 Vali Loss: 1.586 Vali Acc: 0.722 Test Loss: 1.586 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.085331201553345
Epoch: 7, Steps: 13 | Train Loss: 1.117 Vali Loss: 0.854 Vali Acc: 0.571 Test Loss: 0.854 Test Acc: 0.571
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.71194314956665
Epoch: 8, Steps: 13 | Train Loss: 0.720 Vali Loss: 1.278 Vali Acc: 0.722 Test Loss: 1.278 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.4324049949646
Epoch: 9, Steps: 13 | Train Loss: 2.151 Vali Loss: 1.550 Vali Acc: 0.717 Test Loss: 1.550 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 6.147750377655029
Epoch: 10, Steps: 13 | Train Loss: 0.901 Vali Loss: 0.767 Vali Acc: 0.761 Test Loss: 0.767 Test Acc: 0.761
Validation loss decreased (-0.721944 --> -0.760968).  Saving model ...
Epoch: 11 cost time: 5.693952322006226
Epoch: 11, Steps: 13 | Train Loss: 0.586 Vali Loss: 1.413 Vali Acc: 0.727 Test Loss: 1.413 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.410435199737549
Epoch: 12, Steps: 13 | Train Loss: 0.536 Vali Loss: 1.683 Vali Acc: 0.400 Test Loss: 1.683 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.195765495300293
Epoch: 13, Steps: 13 | Train Loss: 0.555 Vali Loss: 1.074 Vali Acc: 0.571 Test Loss: 1.074 Test Acc: 0.571
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.290741205215454
Epoch: 14, Steps: 13 | Train Loss: 0.407 Vali Loss: 1.224 Vali Acc: 0.463 Test Loss: 1.224 Test Acc: 0.463
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.801869869232178
Epoch: 15, Steps: 13 | Train Loss: 0.213 Vali Loss: 1.439 Vali Acc: 0.732 Test Loss: 1.439 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.706863164901733
Epoch: 16, Steps: 13 | Train Loss: 1.009 Vali Loss: 3.468 Vali Acc: 0.434 Test Loss: 3.468 Test Acc: 0.434
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 5.865875005722046
Epoch: 17, Steps: 13 | Train Loss: 0.459 Vali Loss: 1.380 Vali Acc: 0.732 Test Loss: 1.380 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 5.481189250946045
Epoch: 18, Steps: 13 | Train Loss: 0.327 Vali Loss: 0.982 Vali Acc: 0.727 Test Loss: 0.982 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 5.172498464584351
Epoch: 19, Steps: 13 | Train Loss: 0.203 Vali Loss: 1.093 Vali Acc: 0.698 Test Loss: 1.093 Test Acc: 0.698
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 5.239794492721558
Epoch: 20, Steps: 13 | Train Loss: 0.940 Vali Loss: 3.719 Vali Acc: 0.732 Test Loss: 3.719 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 3226930
model size : 14.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.004215002059937
Epoch: 1, Steps: 13 | Train Loss: 0.694 Vali Loss: 0.644 Vali Acc: 0.712 Test Loss: 0.644 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 6.0472235679626465
Epoch: 2, Steps: 13 | Train Loss: 0.889 Vali Loss: 2.066 Vali Acc: 0.278 Test Loss: 2.066 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.267079830169678
Epoch: 3, Steps: 13 | Train Loss: 0.902 Vali Loss: 0.526 Vali Acc: 0.741 Test Loss: 0.526 Test Acc: 0.741
Validation loss decreased (-0.712189 --> -0.741458).  Saving model ...
Epoch: 4 cost time: 6.110267877578735
Epoch: 4, Steps: 13 | Train Loss: 0.629 Vali Loss: 0.520 Vali Acc: 0.741 Test Loss: 0.520 Test Acc: 0.741
Validation loss decreased (-0.741458 --> -0.741458).  Saving model ...
Epoch: 5 cost time: 5.005338191986084
Epoch: 5, Steps: 13 | Train Loss: 1.012 Vali Loss: 1.864 Vali Acc: 0.722 Test Loss: 1.864 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.76754903793335
Epoch: 6, Steps: 13 | Train Loss: 1.481 Vali Loss: 3.093 Vali Acc: 0.322 Test Loss: 3.093 Test Acc: 0.322
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.692608833312988
Epoch: 7, Steps: 13 | Train Loss: 1.400 Vali Loss: 2.395 Vali Acc: 0.722 Test Loss: 2.395 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.322819232940674
Epoch: 8, Steps: 13 | Train Loss: 0.719 Vali Loss: 1.070 Vali Acc: 0.722 Test Loss: 1.070 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.8832502365112305
Epoch: 9, Steps: 13 | Train Loss: 1.454 Vali Loss: 1.046 Vali Acc: 0.722 Test Loss: 1.046 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.308551549911499
Epoch: 10, Steps: 13 | Train Loss: 1.423 Vali Loss: 3.295 Vali Acc: 0.341 Test Loss: 3.295 Test Acc: 0.341
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.854747533798218
Epoch: 11, Steps: 13 | Train Loss: 1.351 Vali Loss: 1.322 Vali Acc: 0.727 Test Loss: 1.322 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.808736562728882
Epoch: 12, Steps: 13 | Train Loss: 0.825 Vali Loss: 1.516 Vali Acc: 0.439 Test Loss: 1.516 Test Acc: 0.439
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 5.3225743770599365
Epoch: 13, Steps: 13 | Train Loss: 1.690 Vali Loss: 3.174 Vali Acc: 0.722 Test Loss: 3.174 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.760629653930664
Epoch: 14, Steps: 13 | Train Loss: 0.855 Vali Loss: 0.872 Vali Acc: 0.639 Test Loss: 0.872 Test Acc: 0.639
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 3219250
model size : 14.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.456155776977539
Epoch: 1, Steps: 13 | Train Loss: 0.627 Vali Loss: 1.570 Vali Acc: 0.278 Test Loss: 1.570 Test Acc: 0.278
Validation loss decreased (inf --> -0.278033).  Saving model ...
Epoch: 2 cost time: 5.071574926376343
Epoch: 2, Steps: 13 | Train Loss: 1.453 Vali Loss: 0.737 Vali Acc: 0.405 Test Loss: 0.737 Test Acc: 0.405
Validation loss decreased (-0.278033 --> -0.404871).  Saving model ...
Epoch: 3 cost time: 6.298969268798828
Epoch: 3, Steps: 13 | Train Loss: 1.109 Vali Loss: 0.851 Vali Acc: 0.722 Test Loss: 0.851 Test Acc: 0.722
Validation loss decreased (-0.404871 --> -0.721943).  Saving model ...
Epoch: 4 cost time: 5.7631285190582275
Epoch: 4, Steps: 13 | Train Loss: 0.599 Vali Loss: 0.710 Vali Acc: 0.541 Test Loss: 0.710 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.7873499393463135
Epoch: 5, Steps: 13 | Train Loss: 1.186 Vali Loss: 0.599 Vali Acc: 0.741 Test Loss: 0.599 Test Acc: 0.741
Validation loss decreased (-0.721943 --> -0.741457).  Saving model ...
Epoch: 6 cost time: 5.6144118309021
Epoch: 6, Steps: 13 | Train Loss: 1.224 Vali Loss: 0.702 Vali Acc: 0.737 Test Loss: 0.702 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.020665645599365
Epoch: 7, Steps: 13 | Train Loss: 0.619 Vali Loss: 0.556 Vali Acc: 0.727 Test Loss: 0.556 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.989103078842163
Epoch: 8, Steps: 13 | Train Loss: 0.747 Vali Loss: 1.106 Vali Acc: 0.732 Test Loss: 1.106 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.255368709564209
Epoch: 9, Steps: 13 | Train Loss: 0.628 Vali Loss: 2.582 Vali Acc: 0.712 Test Loss: 2.582 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.478607654571533
Epoch: 10, Steps: 13 | Train Loss: 1.569 Vali Loss: 3.898 Vali Acc: 0.298 Test Loss: 3.898 Test Acc: 0.298
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.908770322799683
Epoch: 11, Steps: 13 | Train Loss: 1.371 Vali Loss: 0.946 Vali Acc: 0.737 Test Loss: 0.946 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.2643914222717285
Epoch: 12, Steps: 13 | Train Loss: 0.587 Vali Loss: 0.764 Vali Acc: 0.649 Test Loss: 0.764 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 5.34309983253479
Epoch: 13, Steps: 13 | Train Loss: 0.248 Vali Loss: 0.729 Vali Acc: 0.732 Test Loss: 0.729 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 5.184715986251831
Epoch: 14, Steps: 13 | Train Loss: 0.762 Vali Loss: 2.172 Vali Acc: 0.410 Test Loss: 2.172 Test Acc: 0.410
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.9303858280181885
Epoch: 15, Steps: 13 | Train Loss: 2.515 Vali Loss: 1.089 Vali Acc: 0.620 Test Loss: 1.089 Test Acc: 0.620
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 3211570
model size : 14.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.997226238250732
Epoch: 1, Steps: 13 | Train Loss: 0.723 Vali Loss: 0.592 Vali Acc: 0.712 Test Loss: 0.592 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 6.200154542922974
Epoch: 2, Steps: 13 | Train Loss: 0.629 Vali Loss: 0.856 Vali Acc: 0.293 Test Loss: 0.856 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.273600101470947
Epoch: 3, Steps: 13 | Train Loss: 0.668 Vali Loss: 0.673 Vali Acc: 0.727 Test Loss: 0.673 Test Acc: 0.727
Validation loss decreased (-0.712189 --> -0.726823).  Saving model ...
Epoch: 4 cost time: 4.957659006118774
Epoch: 4, Steps: 13 | Train Loss: 0.784 Vali Loss: 1.139 Vali Acc: 0.356 Test Loss: 1.139 Test Acc: 0.356
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.181119441986084
Epoch: 5, Steps: 13 | Train Loss: 1.084 Vali Loss: 1.153 Vali Acc: 0.468 Test Loss: 1.153 Test Acc: 0.468
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.257478952407837
Epoch: 6, Steps: 13 | Train Loss: 0.940 Vali Loss: 0.652 Vali Acc: 0.678 Test Loss: 0.652 Test Acc: 0.678
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.456026315689087
Epoch: 7, Steps: 13 | Train Loss: 0.822 Vali Loss: 0.611 Vali Acc: 0.654 Test Loss: 0.611 Test Acc: 0.654
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.03203010559082
Epoch: 8, Steps: 13 | Train Loss: 0.794 Vali Loss: 1.635 Vali Acc: 0.317 Test Loss: 1.635 Test Acc: 0.317
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.532259225845337
Epoch: 9, Steps: 13 | Train Loss: 1.288 Vali Loss: 0.670 Vali Acc: 0.751 Test Loss: 0.670 Test Acc: 0.751
Validation loss decreased (-0.726823 --> -0.751213).  Saving model ...
Epoch: 10 cost time: 5.130027532577515
Epoch: 10, Steps: 13 | Train Loss: 1.487 Vali Loss: 0.704 Vali Acc: 0.756 Test Loss: 0.704 Test Acc: 0.756
Validation loss decreased (-0.751213 --> -0.756091).  Saving model ...
Epoch: 11 cost time: 5.574581146240234
Epoch: 11, Steps: 13 | Train Loss: 0.350 Vali Loss: 1.900 Vali Acc: 0.307 Test Loss: 1.900 Test Acc: 0.307
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.227914333343506
Epoch: 12, Steps: 13 | Train Loss: 0.786 Vali Loss: 1.450 Vali Acc: 0.449 Test Loss: 1.450 Test Acc: 0.449
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.3567421436309814
Epoch: 13, Steps: 13 | Train Loss: 0.734 Vali Loss: 6.977 Vali Acc: 0.293 Test Loss: 6.977 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.564825534820557
Epoch: 14, Steps: 13 | Train Loss: 1.489 Vali Loss: 0.894 Vali Acc: 0.659 Test Loss: 0.894 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.152560710906982
Epoch: 15, Steps: 13 | Train Loss: 0.789 Vali Loss: 2.502 Vali Acc: 0.361 Test Loss: 2.502 Test Acc: 0.361
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.915323257446289
Epoch: 16, Steps: 13 | Train Loss: 0.633 Vali Loss: 0.854 Vali Acc: 0.712 Test Loss: 0.854 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.510392427444458
Epoch: 17, Steps: 13 | Train Loss: 1.335 Vali Loss: 6.354 Vali Acc: 0.283 Test Loss: 6.354 Test Acc: 0.283
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 5.094204902648926
Epoch: 18, Steps: 13 | Train Loss: 0.919 Vali Loss: 1.723 Vali Acc: 0.551 Test Loss: 1.723 Test Acc: 0.551
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 5.138311147689819
Epoch: 19, Steps: 13 | Train Loss: 0.413 Vali Loss: 1.877 Vali Acc: 0.532 Test Loss: 1.877 Test Acc: 0.532
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 5.496108055114746
Epoch: 20, Steps: 13 | Train Loss: 0.199 Vali Loss: 1.168 Vali Acc: 0.688 Test Loss: 1.168 Test Acc: 0.688
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 3203890
model size : 14.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.078016757965088
Epoch: 1, Steps: 13 | Train Loss: 0.701 Vali Loss: 0.578 Vali Acc: 0.722 Test Loss: 0.578 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.973376750946045
Epoch: 2, Steps: 13 | Train Loss: 1.306 Vali Loss: 2.248 Vali Acc: 0.278 Test Loss: 2.248 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.418482780456543
Epoch: 3, Steps: 13 | Train Loss: 0.837 Vali Loss: 0.596 Vali Acc: 0.727 Test Loss: 0.596 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726823).  Saving model ...
Epoch: 4 cost time: 5.317642688751221
Epoch: 4, Steps: 13 | Train Loss: 0.503 Vali Loss: 0.600 Vali Acc: 0.737 Test Loss: 0.600 Test Acc: 0.737
Validation loss decreased (-0.726823 --> -0.736579).  Saving model ...
Epoch: 5 cost time: 5.1090943813323975
Epoch: 5, Steps: 13 | Train Loss: 0.656 Vali Loss: 1.328 Vali Acc: 0.356 Test Loss: 1.328 Test Acc: 0.356
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.146894216537476
Epoch: 6, Steps: 13 | Train Loss: 0.650 Vali Loss: 0.517 Vali Acc: 0.741 Test Loss: 0.517 Test Acc: 0.741
Validation loss decreased (-0.736579 --> -0.741458).  Saving model ...
Epoch: 7 cost time: 4.97980523109436
Epoch: 7, Steps: 13 | Train Loss: 0.692 Vali Loss: 1.117 Vali Acc: 0.722 Test Loss: 1.117 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.195030212402344
Epoch: 8, Steps: 13 | Train Loss: 1.384 Vali Loss: 0.606 Vali Acc: 0.746 Test Loss: 0.606 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746335).  Saving model ...
Epoch: 9 cost time: 5.660431861877441
Epoch: 9, Steps: 13 | Train Loss: 0.587 Vali Loss: 0.635 Vali Acc: 0.702 Test Loss: 0.635 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.06059718132019
Epoch: 10, Steps: 13 | Train Loss: 1.506 Vali Loss: 0.772 Vali Acc: 0.751 Test Loss: 0.772 Test Acc: 0.751
Validation loss decreased (-0.746335 --> -0.751212).  Saving model ...
Epoch: 11 cost time: 5.503576040267944
Epoch: 11, Steps: 13 | Train Loss: 1.325 Vali Loss: 2.440 Vali Acc: 0.341 Test Loss: 2.440 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.707223892211914
Epoch: 12, Steps: 13 | Train Loss: 2.530 Vali Loss: 1.031 Vali Acc: 0.615 Test Loss: 1.031 Test Acc: 0.615
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.027549982070923
Epoch: 13, Steps: 13 | Train Loss: 2.033 Vali Loss: 4.083 Vali Acc: 0.712 Test Loss: 4.083 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.0985260009765625
Epoch: 14, Steps: 13 | Train Loss: 1.189 Vali Loss: 0.874 Vali Acc: 0.688 Test Loss: 0.874 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.15404486656189
Epoch: 15, Steps: 13 | Train Loss: 1.539 Vali Loss: 1.011 Vali Acc: 0.717 Test Loss: 1.011 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.500810861587524
Epoch: 16, Steps: 13 | Train Loss: 0.715 Vali Loss: 1.128 Vali Acc: 0.741 Test Loss: 1.128 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 6.109879016876221
Epoch: 17, Steps: 13 | Train Loss: 0.766 Vali Loss: 1.935 Vali Acc: 0.468 Test Loss: 1.935 Test Acc: 0.468
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 5.571191787719727
Epoch: 18, Steps: 13 | Train Loss: 0.704 Vali Loss: 5.437 Vali Acc: 0.361 Test Loss: 5.437 Test Acc: 0.361
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 6.085461616516113
Epoch: 19, Steps: 13 | Train Loss: 3.787 Vali Loss: 5.801 Vali Acc: 0.380 Test Loss: 5.801 Test Acc: 0.380
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 5.2998411655426025
Epoch: 20, Steps: 13 | Train Loss: 0.664 Vali Loss: 2.084 Vali Acc: 0.761 Test Loss: 2.084 Test Acc: 0.761
Validation loss decreased (-0.751212 --> -0.760955).  Saving model ...
Epoch: 21 cost time: 5.687180280685425
Epoch: 21, Steps: 13 | Train Loss: 1.931 Vali Loss: 6.001 Vali Acc: 0.361 Test Loss: 6.001 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.281585693359375
Epoch: 22, Steps: 13 | Train Loss: 0.798 Vali Loss: 3.866 Vali Acc: 0.424 Test Loss: 3.866 Test Acc: 0.424
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.695628643035889
Epoch: 23, Steps: 13 | Train Loss: 0.481 Vali Loss: 3.894 Vali Acc: 0.429 Test Loss: 3.894 Test Acc: 0.429
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 5.853034496307373
Epoch: 24, Steps: 13 | Train Loss: 0.368 Vali Loss: 1.616 Vali Acc: 0.732 Test Loss: 1.616 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 5.867362022399902
Epoch: 25, Steps: 13 | Train Loss: 0.083 Vali Loss: 1.512 Vali Acc: 0.644 Test Loss: 1.512 Test Acc: 0.644
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 5.486942768096924
Epoch: 26, Steps: 13 | Train Loss: 0.060 Vali Loss: 1.677 Vali Acc: 0.712 Test Loss: 1.677 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 5.3553147315979
Epoch: 27, Steps: 13 | Train Loss: 0.053 Vali Loss: 2.338 Vali Acc: 0.756 Test Loss: 2.338 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 5.498736381530762
Epoch: 28, Steps: 13 | Train Loss: 0.048 Vali Loss: 1.903 Vali Acc: 0.702 Test Loss: 1.903 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 5.706889629364014
Epoch: 29, Steps: 13 | Train Loss: 0.251 Vali Loss: 3.488 Vali Acc: 0.717 Test Loss: 3.488 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 5.813802242279053
Epoch: 30, Steps: 13 | Train Loss: 0.129 Vali Loss: 2.239 Vali Acc: 0.712 Test Loss: 2.239 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 2766386
model size : 13.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.268737554550171
Epoch: 1, Steps: 13 | Train Loss: 0.701 Vali Loss: 0.769 Vali Acc: 0.722 Test Loss: 0.769 Test Acc: 0.722
Validation loss decreased (inf --> -0.721944).  Saving model ...
Epoch: 2 cost time: 4.9264068603515625
Epoch: 2, Steps: 13 | Train Loss: 0.755 Vali Loss: 0.907 Vali Acc: 0.283 Test Loss: 0.907 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.207402229309082
Epoch: 3, Steps: 13 | Train Loss: 1.070 Vali Loss: 0.557 Vali Acc: 0.732 Test Loss: 0.557 Test Acc: 0.732
Validation loss decreased (-0.721944 --> -0.731702).  Saving model ...
Epoch: 4 cost time: 4.950191497802734
Epoch: 4, Steps: 13 | Train Loss: 0.823 Vali Loss: 0.650 Vali Acc: 0.732 Test Loss: 0.650 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.526361703872681
Epoch: 5, Steps: 13 | Train Loss: 0.894 Vali Loss: 1.065 Vali Acc: 0.722 Test Loss: 1.065 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.753882884979248
Epoch: 6, Steps: 13 | Train Loss: 1.107 Vali Loss: 0.915 Vali Acc: 0.722 Test Loss: 0.915 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.589807987213135
Epoch: 7, Steps: 13 | Train Loss: 0.518 Vali Loss: 0.711 Vali Acc: 0.737 Test Loss: 0.711 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736578).  Saving model ...
Epoch: 8 cost time: 5.693264484405518
Epoch: 8, Steps: 13 | Train Loss: 1.133 Vali Loss: 1.283 Vali Acc: 0.722 Test Loss: 1.283 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.896360874176025
Epoch: 9, Steps: 13 | Train Loss: 1.082 Vali Loss: 3.945 Vali Acc: 0.298 Test Loss: 3.945 Test Acc: 0.298
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.522507667541504
Epoch: 10, Steps: 13 | Train Loss: 1.446 Vali Loss: 1.194 Vali Acc: 0.741 Test Loss: 1.194 Test Acc: 0.741
Validation loss decreased (-0.736578 --> -0.741451).  Saving model ...
Epoch: 11 cost time: 4.42063307762146
Epoch: 11, Steps: 13 | Train Loss: 0.731 Vali Loss: 1.662 Vali Acc: 0.732 Test Loss: 1.662 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.984675645828247
Epoch: 12, Steps: 13 | Train Loss: 2.119 Vali Loss: 0.714 Vali Acc: 0.707 Test Loss: 0.714 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.419381856918335
Epoch: 13, Steps: 13 | Train Loss: 2.097 Vali Loss: 0.845 Vali Acc: 0.688 Test Loss: 0.845 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.983339309692383
Epoch: 14, Steps: 13 | Train Loss: 0.929 Vali Loss: 4.909 Vali Acc: 0.307 Test Loss: 4.909 Test Acc: 0.307
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.399404048919678
Epoch: 15, Steps: 13 | Train Loss: 1.571 Vali Loss: 2.312 Vali Acc: 0.722 Test Loss: 2.312 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.883305072784424
Epoch: 16, Steps: 13 | Train Loss: 0.414 Vali Loss: 1.228 Vali Acc: 0.707 Test Loss: 1.228 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 5.701971769332886
Epoch: 17, Steps: 13 | Train Loss: 0.515 Vali Loss: 1.339 Vali Acc: 0.737 Test Loss: 1.339 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 5.475990295410156
Epoch: 18, Steps: 13 | Train Loss: 1.313 Vali Loss: 2.093 Vali Acc: 0.722 Test Loss: 2.093 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 5.418032884597778
Epoch: 19, Steps: 13 | Train Loss: 0.980 Vali Loss: 3.060 Vali Acc: 0.454 Test Loss: 3.060 Test Acc: 0.454
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 5.562158107757568
Epoch: 20, Steps: 13 | Train Loss: 0.348 Vali Loss: 3.586 Vali Acc: 0.390 Test Loss: 3.586 Test Acc: 0.390
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 2758706
model size : 13.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.568933486938477
Epoch: 1, Steps: 13 | Train Loss: 0.759 Vali Loss: 0.580 Vali Acc: 0.712 Test Loss: 0.580 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 5.259644985198975
Epoch: 2, Steps: 13 | Train Loss: 1.219 Vali Loss: 3.817 Vali Acc: 0.278 Test Loss: 3.817 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.6925625801086426
Epoch: 3, Steps: 13 | Train Loss: 2.096 Vali Loss: 4.342 Vali Acc: 0.278 Test Loss: 4.342 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.2156360149383545
Epoch: 4, Steps: 13 | Train Loss: 1.532 Vali Loss: 0.546 Vali Acc: 0.727 Test Loss: 0.546 Test Acc: 0.727
Validation loss decreased (-0.712189 --> -0.726824).  Saving model ...
Epoch: 5 cost time: 5.524071216583252
Epoch: 5, Steps: 13 | Train Loss: 0.779 Vali Loss: 1.803 Vali Acc: 0.307 Test Loss: 1.803 Test Acc: 0.307
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.4567015171051025
Epoch: 6, Steps: 13 | Train Loss: 1.134 Vali Loss: 1.476 Vali Acc: 0.712 Test Loss: 1.476 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.908410310745239
Epoch: 7, Steps: 13 | Train Loss: 1.214 Vali Loss: 1.977 Vali Acc: 0.341 Test Loss: 1.977 Test Acc: 0.341
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.7302565574646
Epoch: 8, Steps: 13 | Train Loss: 0.904 Vali Loss: 0.669 Vali Acc: 0.644 Test Loss: 0.669 Test Acc: 0.644
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.7272047996521
Epoch: 9, Steps: 13 | Train Loss: 1.256 Vali Loss: 0.601 Vali Acc: 0.766 Test Loss: 0.601 Test Acc: 0.766
Validation loss decreased (-0.726824 --> -0.765848).  Saving model ...
Epoch: 10 cost time: 5.070650339126587
Epoch: 10, Steps: 13 | Train Loss: 1.463 Vali Loss: 3.855 Vali Acc: 0.712 Test Loss: 3.855 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.8548264503479
Epoch: 11, Steps: 13 | Train Loss: 1.958 Vali Loss: 3.265 Vali Acc: 0.312 Test Loss: 3.265 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.269178628921509
Epoch: 12, Steps: 13 | Train Loss: 1.735 Vali Loss: 2.996 Vali Acc: 0.722 Test Loss: 2.996 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.768789052963257
Epoch: 13, Steps: 13 | Train Loss: 0.824 Vali Loss: 0.728 Vali Acc: 0.741 Test Loss: 0.728 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.178114891052246
Epoch: 14, Steps: 13 | Train Loss: 0.690 Vali Loss: 0.839 Vali Acc: 0.693 Test Loss: 0.839 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.3371241092681885
Epoch: 15, Steps: 13 | Train Loss: 0.417 Vali Loss: 0.854 Vali Acc: 0.702 Test Loss: 0.854 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.995699644088745
Epoch: 16, Steps: 13 | Train Loss: 0.344 Vali Loss: 1.997 Vali Acc: 0.732 Test Loss: 1.997 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.148271322250366
Epoch: 17, Steps: 13 | Train Loss: 1.748 Vali Loss: 1.095 Vali Acc: 0.702 Test Loss: 1.095 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.948346138000488
Epoch: 18, Steps: 13 | Train Loss: 2.836 Vali Loss: 1.190 Vali Acc: 0.722 Test Loss: 1.190 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.613991022109985
Epoch: 19, Steps: 13 | Train Loss: 0.655 Vali Loss: 1.691 Vali Acc: 0.741 Test Loss: 1.691 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 2751026
model size : 13.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.9540886878967285
Epoch: 1, Steps: 13 | Train Loss: 0.686 Vali Loss: 0.578 Vali Acc: 0.722 Test Loss: 0.578 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.691434860229492
Epoch: 2, Steps: 13 | Train Loss: 0.814 Vali Loss: 1.051 Vali Acc: 0.722 Test Loss: 1.051 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.178997278213501
Epoch: 3, Steps: 13 | Train Loss: 0.727 Vali Loss: 0.671 Vali Acc: 0.722 Test Loss: 0.671 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.7134013175964355
Epoch: 4, Steps: 13 | Train Loss: 0.508 Vali Loss: 1.529 Vali Acc: 0.722 Test Loss: 1.529 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.771566152572632
Epoch: 5, Steps: 13 | Train Loss: 0.874 Vali Loss: 1.243 Vali Acc: 0.332 Test Loss: 1.243 Test Acc: 0.332
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.699635744094849
Epoch: 6, Steps: 13 | Train Loss: 0.735 Vali Loss: 0.532 Vali Acc: 0.761 Test Loss: 0.532 Test Acc: 0.761
Validation loss decreased (-0.721945 --> -0.760970).  Saving model ...
Epoch: 7 cost time: 4.660412311553955
Epoch: 7, Steps: 13 | Train Loss: 0.764 Vali Loss: 3.606 Vali Acc: 0.283 Test Loss: 3.606 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.68046760559082
Epoch: 8, Steps: 13 | Train Loss: 1.312 Vali Loss: 1.022 Vali Acc: 0.732 Test Loss: 1.022 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.796658515930176
Epoch: 9, Steps: 13 | Train Loss: 2.293 Vali Loss: 3.803 Vali Acc: 0.293 Test Loss: 3.803 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.815109729766846
Epoch: 10, Steps: 13 | Train Loss: 2.162 Vali Loss: 3.101 Vali Acc: 0.707 Test Loss: 3.101 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.780777215957642
Epoch: 11, Steps: 13 | Train Loss: 0.848 Vali Loss: 2.567 Vali Acc: 0.332 Test Loss: 2.567 Test Acc: 0.332
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.699530363082886
Epoch: 12, Steps: 13 | Train Loss: 1.698 Vali Loss: 1.252 Vali Acc: 0.732 Test Loss: 1.252 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.44315767288208
Epoch: 13, Steps: 13 | Train Loss: 0.407 Vali Loss: 1.869 Vali Acc: 0.415 Test Loss: 1.869 Test Acc: 0.415
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.067466735839844
Epoch: 14, Steps: 13 | Train Loss: 1.308 Vali Loss: 1.141 Vali Acc: 0.751 Test Loss: 1.141 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.904108762741089
Epoch: 15, Steps: 13 | Train Loss: 0.648 Vali Loss: 1.352 Vali Acc: 0.746 Test Loss: 1.352 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.3319923877716064
Epoch: 16, Steps: 13 | Train Loss: 0.329 Vali Loss: 1.180 Vali Acc: 0.756 Test Loss: 1.180 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 2743346
model size : 13.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.361568927764893
Epoch: 1, Steps: 13 | Train Loss: 0.622 Vali Loss: 0.765 Vali Acc: 0.293 Test Loss: 0.765 Test Acc: 0.293
Validation loss decreased (inf --> -0.292675).  Saving model ...
Epoch: 2 cost time: 4.93821120262146
Epoch: 2, Steps: 13 | Train Loss: 0.742 Vali Loss: 0.566 Vali Acc: 0.722 Test Loss: 0.566 Test Acc: 0.722
Validation loss decreased (-0.292675 --> -0.721946).  Saving model ...
Epoch: 3 cost time: 4.920828104019165
Epoch: 3, Steps: 13 | Train Loss: 0.619 Vali Loss: 0.724 Vali Acc: 0.722 Test Loss: 0.724 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.166785001754761
Epoch: 4, Steps: 13 | Train Loss: 1.207 Vali Loss: 3.533 Vali Acc: 0.288 Test Loss: 3.533 Test Acc: 0.288
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.001391649246216
Epoch: 5, Steps: 13 | Train Loss: 1.746 Vali Loss: 1.341 Vali Acc: 0.712 Test Loss: 1.341 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.368804693222046
Epoch: 6, Steps: 13 | Train Loss: 1.919 Vali Loss: 2.076 Vali Acc: 0.717 Test Loss: 2.076 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.518771171569824
Epoch: 7, Steps: 13 | Train Loss: 1.332 Vali Loss: 0.945 Vali Acc: 0.727 Test Loss: 0.945 Test Acc: 0.727
Validation loss decreased (-0.721946 --> -0.726820).  Saving model ...
Epoch: 8 cost time: 5.2234461307525635
Epoch: 8, Steps: 13 | Train Loss: 0.677 Vali Loss: 0.820 Vali Acc: 0.556 Test Loss: 0.820 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.468403577804565
Epoch: 9, Steps: 13 | Train Loss: 0.436 Vali Loss: 1.169 Vali Acc: 0.722 Test Loss: 1.169 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.242427825927734
Epoch: 10, Steps: 13 | Train Loss: 0.710 Vali Loss: 3.735 Vali Acc: 0.288 Test Loss: 3.735 Test Acc: 0.288
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.754601240158081
Epoch: 11, Steps: 13 | Train Loss: 1.714 Vali Loss: 0.621 Vali Acc: 0.732 Test Loss: 0.621 Test Acc: 0.732
Validation loss decreased (-0.726820 --> -0.731701).  Saving model ...
Epoch: 12 cost time: 5.354079961776733
Epoch: 12, Steps: 13 | Train Loss: 0.638 Vali Loss: 1.140 Vali Acc: 0.741 Test Loss: 1.140 Test Acc: 0.741
Validation loss decreased (-0.731701 --> -0.741452).  Saving model ...
Epoch: 13 cost time: 4.9994730949401855
Epoch: 13, Steps: 13 | Train Loss: 0.310 Vali Loss: 2.886 Vali Acc: 0.332 Test Loss: 2.886 Test Acc: 0.332
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.9452245235443115
Epoch: 14, Steps: 13 | Train Loss: 0.988 Vali Loss: 1.204 Vali Acc: 0.512 Test Loss: 1.204 Test Acc: 0.512
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.707655906677246
Epoch: 15, Steps: 13 | Train Loss: 0.891 Vali Loss: 1.118 Vali Acc: 0.537 Test Loss: 1.118 Test Acc: 0.537
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.736271619796753
Epoch: 16, Steps: 13 | Train Loss: 0.685 Vali Loss: 1.947 Vali Acc: 0.449 Test Loss: 1.947 Test Acc: 0.449
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.204351425170898
Epoch: 17, Steps: 13 | Train Loss: 1.737 Vali Loss: 1.081 Vali Acc: 0.756 Test Loss: 1.081 Test Acc: 0.756
Validation loss decreased (-0.741452 --> -0.756087).  Saving model ...
Epoch: 18 cost time: 4.966497182846069
Epoch: 18, Steps: 13 | Train Loss: 0.772 Vali Loss: 1.305 Vali Acc: 0.746 Test Loss: 1.305 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.817025899887085
Epoch: 19, Steps: 13 | Train Loss: 1.017 Vali Loss: 1.789 Vali Acc: 0.741 Test Loss: 1.789 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.009825229644775
Epoch: 20, Steps: 13 | Train Loss: 0.834 Vali Loss: 3.278 Vali Acc: 0.473 Test Loss: 3.278 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.707369565963745
Epoch: 21, Steps: 13 | Train Loss: 0.482 Vali Loss: 2.889 Vali Acc: 0.468 Test Loss: 2.889 Test Acc: 0.468
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 5.29882550239563
Epoch: 22, Steps: 13 | Train Loss: 1.937 Vali Loss: 4.751 Vali Acc: 0.722 Test Loss: 4.751 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 5.677597761154175
Epoch: 23, Steps: 13 | Train Loss: 0.687 Vali Loss: 2.331 Vali Acc: 0.571 Test Loss: 2.331 Test Acc: 0.571
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 4.8521294593811035
Epoch: 24, Steps: 13 | Train Loss: 0.156 Vali Loss: 1.753 Vali Acc: 0.746 Test Loss: 1.753 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.7896158695220947
Epoch: 25, Steps: 13 | Train Loss: 0.163 Vali Loss: 2.306 Vali Acc: 0.590 Test Loss: 2.306 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 4.795433759689331
Epoch: 26, Steps: 13 | Train Loss: 0.714 Vali Loss: 3.398 Vali Acc: 0.473 Test Loss: 3.398 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 4.8471784591674805
Epoch: 27, Steps: 13 | Train Loss: 0.290 Vali Loss: 7.016 Vali Acc: 0.722 Test Loss: 7.016 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 2536114
model size : 12.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.523865222930908
Epoch: 1, Steps: 13 | Train Loss: 0.730 Vali Loss: 1.139 Vali Acc: 0.278 Test Loss: 1.139 Test Acc: 0.278
Validation loss decreased (inf --> -0.278037).  Saving model ...
Epoch: 2 cost time: 5.7364866733551025
Epoch: 2, Steps: 13 | Train Loss: 0.864 Vali Loss: 0.576 Vali Acc: 0.707 Test Loss: 0.576 Test Acc: 0.707
Validation loss decreased (-0.278037 --> -0.707311).  Saving model ...
Epoch: 3 cost time: 5.478133678436279
Epoch: 3, Steps: 13 | Train Loss: 0.990 Vali Loss: 0.926 Vali Acc: 0.722 Test Loss: 0.926 Test Acc: 0.722
Validation loss decreased (-0.707311 --> -0.721942).  Saving model ...
Epoch: 4 cost time: 5.4550557136535645
Epoch: 4, Steps: 13 | Train Loss: 0.936 Vali Loss: 2.788 Vali Acc: 0.288 Test Loss: 2.788 Test Acc: 0.288
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.538464069366455
Epoch: 5, Steps: 13 | Train Loss: 1.090 Vali Loss: 1.019 Vali Acc: 0.385 Test Loss: 1.019 Test Acc: 0.385
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.149891138076782
Epoch: 6, Steps: 13 | Train Loss: 0.573 Vali Loss: 0.512 Vali Acc: 0.746 Test Loss: 0.512 Test Acc: 0.746
Validation loss decreased (-0.721942 --> -0.746336).  Saving model ...
Epoch: 7 cost time: 5.000481605529785
Epoch: 7, Steps: 13 | Train Loss: 0.452 Vali Loss: 0.579 Vali Acc: 0.698 Test Loss: 0.579 Test Acc: 0.698
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.033684730529785
Epoch: 8, Steps: 13 | Train Loss: 0.791 Vali Loss: 0.544 Vali Acc: 0.741 Test Loss: 0.544 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.68119215965271
Epoch: 9, Steps: 13 | Train Loss: 2.478 Vali Loss: 2.637 Vali Acc: 0.717 Test Loss: 2.637 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.829756259918213
Epoch: 10, Steps: 13 | Train Loss: 2.336 Vali Loss: 2.977 Vali Acc: 0.332 Test Loss: 2.977 Test Acc: 0.332
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.078977823257446
Epoch: 11, Steps: 13 | Train Loss: 2.112 Vali Loss: 1.353 Vali Acc: 0.732 Test Loss: 1.353 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.632063865661621
Epoch: 12, Steps: 13 | Train Loss: 0.592 Vali Loss: 1.048 Vali Acc: 0.737 Test Loss: 1.048 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.142407417297363
Epoch: 13, Steps: 13 | Train Loss: 0.689 Vali Loss: 0.729 Vali Acc: 0.727 Test Loss: 0.729 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.804703950881958
Epoch: 14, Steps: 13 | Train Loss: 1.172 Vali Loss: 2.267 Vali Acc: 0.727 Test Loss: 2.267 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.790191411972046
Epoch: 15, Steps: 13 | Train Loss: 1.190 Vali Loss: 1.712 Vali Acc: 0.483 Test Loss: 1.712 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.257059097290039
Epoch: 16, Steps: 13 | Train Loss: 0.626 Vali Loss: 1.274 Vali Acc: 0.507 Test Loss: 1.274 Test Acc: 0.507
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 2528434
model size : 12.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.648334741592407
Epoch: 1, Steps: 13 | Train Loss: 0.689 Vali Loss: 0.670 Vali Acc: 0.639 Test Loss: 0.670 Test Acc: 0.639
Validation loss decreased (inf --> -0.639018).  Saving model ...
Epoch: 2 cost time: 5.778533220291138
Epoch: 2, Steps: 13 | Train Loss: 0.733 Vali Loss: 0.566 Vali Acc: 0.722 Test Loss: 0.566 Test Acc: 0.722
Validation loss decreased (-0.639018 --> -0.721946).  Saving model ...
Epoch: 3 cost time: 5.392120361328125
Epoch: 3, Steps: 13 | Train Loss: 0.589 Vali Loss: 0.724 Vali Acc: 0.722 Test Loss: 0.724 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.7425291538238525
Epoch: 4, Steps: 13 | Train Loss: 0.552 Vali Loss: 0.985 Vali Acc: 0.395 Test Loss: 0.985 Test Acc: 0.395
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.18085241317749
Epoch: 5, Steps: 13 | Train Loss: 0.629 Vali Loss: 0.991 Vali Acc: 0.732 Test Loss: 0.991 Test Acc: 0.732
Validation loss decreased (-0.721946 --> -0.731697).  Saving model ...
Epoch: 6 cost time: 3.2769408226013184
Epoch: 6, Steps: 13 | Train Loss: 0.592 Vali Loss: 1.274 Vali Acc: 0.727 Test Loss: 1.274 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.4737770557403564
Epoch: 7, Steps: 13 | Train Loss: 0.731 Vali Loss: 2.212 Vali Acc: 0.722 Test Loss: 2.212 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.7720389366149902
Epoch: 8, Steps: 13 | Train Loss: 0.563 Vali Loss: 1.359 Vali Acc: 0.415 Test Loss: 1.359 Test Acc: 0.415
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.8749566078186035
Epoch: 9, Steps: 13 | Train Loss: 0.542 Vali Loss: 1.471 Vali Acc: 0.727 Test Loss: 1.471 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.097045660018921
Epoch: 10, Steps: 13 | Train Loss: 0.620 Vali Loss: 1.823 Vali Acc: 0.717 Test Loss: 1.823 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.035621881484985
Epoch: 11, Steps: 13 | Train Loss: 0.504 Vali Loss: 0.705 Vali Acc: 0.659 Test Loss: 0.705 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.24003529548645
Epoch: 12, Steps: 13 | Train Loss: 0.736 Vali Loss: 1.523 Vali Acc: 0.737 Test Loss: 1.523 Test Acc: 0.737
Validation loss decreased (-0.731697 --> -0.736570).  Saving model ...
Epoch: 13 cost time: 5.173162460327148
Epoch: 13, Steps: 13 | Train Loss: 1.068 Vali Loss: 1.419 Vali Acc: 0.546 Test Loss: 1.419 Test Acc: 0.546
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.187481164932251
Epoch: 14, Steps: 13 | Train Loss: 0.374 Vali Loss: 1.419 Vali Acc: 0.732 Test Loss: 1.419 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.176778078079224
Epoch: 15, Steps: 13 | Train Loss: 0.363 Vali Loss: 2.052 Vali Acc: 0.727 Test Loss: 2.052 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.319879055023193
Epoch: 16, Steps: 13 | Train Loss: 1.394 Vali Loss: 1.758 Vali Acc: 0.541 Test Loss: 1.758 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.787801027297974
Epoch: 17, Steps: 13 | Train Loss: 1.188 Vali Loss: 2.229 Vali Acc: 0.756 Test Loss: 2.229 Test Acc: 0.756
Validation loss decreased (-0.736570 --> -0.756075).  Saving model ...
Epoch: 18 cost time: 4.4458136558532715
Epoch: 18, Steps: 13 | Train Loss: 1.149 Vali Loss: 1.102 Vali Acc: 0.688 Test Loss: 1.102 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.49115514755249
Epoch: 19, Steps: 13 | Train Loss: 0.896 Vali Loss: 1.151 Vali Acc: 0.649 Test Loss: 1.151 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.837766170501709
Epoch: 20, Steps: 13 | Train Loss: 0.976 Vali Loss: 4.357 Vali Acc: 0.727 Test Loss: 4.357 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.377452373504639
Epoch: 21, Steps: 13 | Train Loss: 0.658 Vali Loss: 2.919 Vali Acc: 0.717 Test Loss: 2.919 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.7438037395477295
Epoch: 22, Steps: 13 | Train Loss: 1.551 Vali Loss: 5.054 Vali Acc: 0.341 Test Loss: 5.054 Test Acc: 0.341
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.820964574813843
Epoch: 23, Steps: 13 | Train Loss: 1.781 Vali Loss: 1.736 Vali Acc: 0.634 Test Loss: 1.736 Test Acc: 0.634
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 5.212222576141357
Epoch: 24, Steps: 13 | Train Loss: 0.880 Vali Loss: 2.017 Vali Acc: 0.649 Test Loss: 2.017 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 5.666522264480591
Epoch: 25, Steps: 13 | Train Loss: 0.651 Vali Loss: 4.115 Vali Acc: 0.463 Test Loss: 4.115 Test Acc: 0.463
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 4.750696182250977
Epoch: 26, Steps: 13 | Train Loss: 0.833 Vali Loss: 3.355 Vali Acc: 0.727 Test Loss: 3.355 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 5.290129899978638
Epoch: 27, Steps: 13 | Train Loss: 0.358 Vali Loss: 2.059 Vali Acc: 0.673 Test Loss: 2.059 Test Acc: 0.673
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 2520754
model size : 12.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.14295506477356
Epoch: 1, Steps: 13 | Train Loss: 0.959 Vali Loss: 0.632 Vali Acc: 0.712 Test Loss: 0.632 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 4.928668022155762
Epoch: 2, Steps: 13 | Train Loss: 0.609 Vali Loss: 0.734 Vali Acc: 0.722 Test Loss: 0.734 Test Acc: 0.722
Validation loss decreased (-0.712189 --> -0.721944).  Saving model ...
Epoch: 3 cost time: 4.488480567932129
Epoch: 3, Steps: 13 | Train Loss: 0.700 Vali Loss: 0.564 Vali Acc: 0.732 Test Loss: 0.564 Test Acc: 0.732
Validation loss decreased (-0.721944 --> -0.731702).  Saving model ...
Epoch: 4 cost time: 5.089809417724609
Epoch: 4, Steps: 13 | Train Loss: 0.493 Vali Loss: 0.577 Vali Acc: 0.732 Test Loss: 0.577 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.938648223876953
Epoch: 5, Steps: 13 | Train Loss: 0.570 Vali Loss: 0.520 Vali Acc: 0.737 Test Loss: 0.520 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736580).  Saving model ...
Epoch: 6 cost time: 4.953758955001831
Epoch: 6, Steps: 13 | Train Loss: 1.085 Vali Loss: 1.053 Vali Acc: 0.415 Test Loss: 1.053 Test Acc: 0.415
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.400069952011108
Epoch: 7, Steps: 13 | Train Loss: 0.425 Vali Loss: 1.055 Vali Acc: 0.727 Test Loss: 1.055 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.874441146850586
Epoch: 8, Steps: 13 | Train Loss: 1.664 Vali Loss: 2.221 Vali Acc: 0.293 Test Loss: 2.221 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.297110557556152
Epoch: 9, Steps: 13 | Train Loss: 0.916 Vali Loss: 0.581 Vali Acc: 0.732 Test Loss: 0.581 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.660947322845459
Epoch: 10, Steps: 13 | Train Loss: 0.579 Vali Loss: 1.391 Vali Acc: 0.737 Test Loss: 1.391 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.461656808853149
Epoch: 11, Steps: 13 | Train Loss: 0.355 Vali Loss: 1.117 Vali Acc: 0.522 Test Loss: 1.117 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.414551496505737
Epoch: 12, Steps: 13 | Train Loss: 0.907 Vali Loss: 0.694 Vali Acc: 0.737 Test Loss: 0.694 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.531076431274414
Epoch: 13, Steps: 13 | Train Loss: 0.365 Vali Loss: 1.000 Vali Acc: 0.532 Test Loss: 1.000 Test Acc: 0.532
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 5.040058612823486
Epoch: 14, Steps: 13 | Train Loss: 0.677 Vali Loss: 1.839 Vali Acc: 0.463 Test Loss: 1.839 Test Acc: 0.463
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.630094528198242
Epoch: 15, Steps: 13 | Train Loss: 1.142 Vali Loss: 1.076 Vali Acc: 0.668 Test Loss: 1.076 Test Acc: 0.668
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 2513074
model size : 12.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.241860866546631
Epoch: 1, Steps: 13 | Train Loss: 0.675 Vali Loss: 0.880 Vali Acc: 0.722 Test Loss: 0.880 Test Acc: 0.722
Validation loss decreased (inf --> -0.721942).  Saving model ...
Epoch: 2 cost time: 5.2411205768585205
Epoch: 2, Steps: 13 | Train Loss: 0.793 Vali Loss: 0.659 Vali Acc: 0.717 Test Loss: 0.659 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.39382791519165
Epoch: 3, Steps: 13 | Train Loss: 0.715 Vali Loss: 0.626 Vali Acc: 0.712 Test Loss: 0.626 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.419800043106079
Epoch: 4, Steps: 13 | Train Loss: 0.706 Vali Loss: 0.570 Vali Acc: 0.741 Test Loss: 0.570 Test Acc: 0.741
Validation loss decreased (-0.721942 --> -0.741458).  Saving model ...
Epoch: 5 cost time: 4.057016849517822
Epoch: 5, Steps: 13 | Train Loss: 0.593 Vali Loss: 1.353 Vali Acc: 0.307 Test Loss: 1.353 Test Acc: 0.307
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.061720848083496
Epoch: 6, Steps: 13 | Train Loss: 0.668 Vali Loss: 0.527 Vali Acc: 0.717 Test Loss: 0.527 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.761101961135864
Epoch: 7, Steps: 13 | Train Loss: 0.517 Vali Loss: 0.503 Vali Acc: 0.766 Test Loss: 0.503 Test Acc: 0.766
Validation loss decreased (-0.741458 --> -0.765849).  Saving model ...
Epoch: 8 cost time: 4.7496654987335205
Epoch: 8, Steps: 13 | Train Loss: 0.544 Vali Loss: 0.562 Vali Acc: 0.737 Test Loss: 0.562 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.887543201446533
Epoch: 9, Steps: 13 | Train Loss: 0.744 Vali Loss: 0.696 Vali Acc: 0.751 Test Loss: 0.696 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.925728797912598
Epoch: 10, Steps: 13 | Train Loss: 0.428 Vali Loss: 0.586 Vali Acc: 0.673 Test Loss: 0.586 Test Acc: 0.673
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.035073518753052
Epoch: 11, Steps: 13 | Train Loss: 0.437 Vali Loss: 0.767 Vali Acc: 0.746 Test Loss: 0.767 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.51053786277771
Epoch: 12, Steps: 13 | Train Loss: 0.626 Vali Loss: 0.731 Vali Acc: 0.678 Test Loss: 0.731 Test Acc: 0.678
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.867904424667358
Epoch: 13, Steps: 13 | Train Loss: 1.086 Vali Loss: 0.895 Vali Acc: 0.751 Test Loss: 0.895 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.45458459854126
Epoch: 14, Steps: 13 | Train Loss: 0.496 Vali Loss: 0.795 Vali Acc: 0.590 Test Loss: 0.795 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.432672739028931
Epoch: 15, Steps: 13 | Train Loss: 0.314 Vali Loss: 0.952 Vali Acc: 0.732 Test Loss: 0.952 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.745936393737793
Epoch: 16, Steps: 13 | Train Loss: 0.645 Vali Loss: 1.345 Vali Acc: 0.746 Test Loss: 1.345 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.487498760223389
Epoch: 17, Steps: 13 | Train Loss: 0.306 Vali Loss: 1.076 Vali Acc: 0.566 Test Loss: 1.076 Test Acc: 0.566
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 1618866
model size : 7.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.54674506187439
Epoch: 1, Steps: 13 | Train Loss: 0.609 Vali Loss: 0.587 Vali Acc: 0.722 Test Loss: 0.587 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.942586183547974
Epoch: 2, Steps: 13 | Train Loss: 0.702 Vali Loss: 1.302 Vali Acc: 0.278 Test Loss: 1.302 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.788299322128296
Epoch: 3, Steps: 13 | Train Loss: 0.718 Vali Loss: 0.778 Vali Acc: 0.722 Test Loss: 0.778 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.655112028121948
Epoch: 4, Steps: 13 | Train Loss: 0.680 Vali Loss: 0.717 Vali Acc: 0.717 Test Loss: 0.717 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.650728702545166
Epoch: 5, Steps: 13 | Train Loss: 0.700 Vali Loss: 0.646 Vali Acc: 0.737 Test Loss: 0.646 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736579).  Saving model ...
Epoch: 6 cost time: 4.654588460922241
Epoch: 6, Steps: 13 | Train Loss: 0.541 Vali Loss: 0.531 Vali Acc: 0.722 Test Loss: 0.531 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.9890170097351074
Epoch: 7, Steps: 13 | Train Loss: 0.480 Vali Loss: 0.697 Vali Acc: 0.732 Test Loss: 0.697 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.235836744308472
Epoch: 8, Steps: 13 | Train Loss: 0.410 Vali Loss: 0.576 Vali Acc: 0.746 Test Loss: 0.576 Test Acc: 0.746
Validation loss decreased (-0.736579 --> -0.746336).  Saving model ...
Epoch: 9 cost time: 3.8871278762817383
Epoch: 9, Steps: 13 | Train Loss: 0.429 Vali Loss: 0.688 Vali Acc: 0.634 Test Loss: 0.688 Test Acc: 0.634
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.68594217300415
Epoch: 10, Steps: 13 | Train Loss: 1.351 Vali Loss: 2.204 Vali Acc: 0.722 Test Loss: 2.204 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.620094060897827
Epoch: 11, Steps: 13 | Train Loss: 1.610 Vali Loss: 2.061 Vali Acc: 0.712 Test Loss: 2.061 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.389152765274048
Epoch: 12, Steps: 13 | Train Loss: 0.697 Vali Loss: 1.588 Vali Acc: 0.390 Test Loss: 1.588 Test Acc: 0.390
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.331447601318359
Epoch: 13, Steps: 13 | Train Loss: 0.622 Vali Loss: 1.016 Vali Acc: 0.741 Test Loss: 1.016 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.829569578170776
Epoch: 14, Steps: 13 | Train Loss: 0.549 Vali Loss: 0.822 Vali Acc: 0.751 Test Loss: 0.822 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751211).  Saving model ...
Epoch: 15 cost time: 4.416409969329834
Epoch: 15, Steps: 13 | Train Loss: 0.569 Vali Loss: 1.097 Vali Acc: 0.498 Test Loss: 1.097 Test Acc: 0.498
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.383122205734253
Epoch: 16, Steps: 13 | Train Loss: 0.244 Vali Loss: 0.691 Vali Acc: 0.722 Test Loss: 0.691 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.958680868148804
Epoch: 17, Steps: 13 | Train Loss: 0.964 Vali Loss: 1.661 Vali Acc: 0.459 Test Loss: 1.661 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.4261322021484375
Epoch: 18, Steps: 13 | Train Loss: 0.448 Vali Loss: 0.809 Vali Acc: 0.688 Test Loss: 0.809 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.867544412612915
Epoch: 19, Steps: 13 | Train Loss: 0.216 Vali Loss: 0.870 Vali Acc: 0.712 Test Loss: 0.870 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.664156436920166
Epoch: 20, Steps: 13 | Train Loss: 0.428 Vali Loss: 1.832 Vali Acc: 0.727 Test Loss: 1.832 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.602729082107544
Epoch: 21, Steps: 13 | Train Loss: 0.758 Vali Loss: 0.968 Vali Acc: 0.722 Test Loss: 0.968 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.826276779174805
Epoch: 22, Steps: 13 | Train Loss: 0.244 Vali Loss: 0.938 Vali Acc: 0.707 Test Loss: 0.938 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.685510873794556
Epoch: 23, Steps: 13 | Train Loss: 0.169 Vali Loss: 1.609 Vali Acc: 0.551 Test Loss: 1.609 Test Acc: 0.551
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.854326009750366
Epoch: 24, Steps: 13 | Train Loss: 0.083 Vali Loss: 1.616 Vali Acc: 0.746 Test Loss: 1.616 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 1615026
model size : 7.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.788356065750122
Epoch: 1, Steps: 13 | Train Loss: 0.734 Vali Loss: 0.606 Vali Acc: 0.722 Test Loss: 0.606 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.459305763244629
Epoch: 2, Steps: 13 | Train Loss: 0.719 Vali Loss: 0.573 Vali Acc: 0.712 Test Loss: 0.573 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.635499715805054
Epoch: 3, Steps: 13 | Train Loss: 0.573 Vali Loss: 0.603 Vali Acc: 0.722 Test Loss: 0.603 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 4 cost time: 4.575543165206909
Epoch: 4, Steps: 13 | Train Loss: 0.494 Vali Loss: 0.591 Vali Acc: 0.722 Test Loss: 0.591 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 5 cost time: 4.5633111000061035
Epoch: 5, Steps: 13 | Train Loss: 0.466 Vali Loss: 0.561 Vali Acc: 0.722 Test Loss: 0.561 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721946).  Saving model ...
Epoch: 6 cost time: 4.280459642410278
Epoch: 6, Steps: 13 | Train Loss: 0.704 Vali Loss: 0.972 Vali Acc: 0.420 Test Loss: 0.972 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.28065299987793
Epoch: 7, Steps: 13 | Train Loss: 1.043 Vali Loss: 1.299 Vali Acc: 0.346 Test Loss: 1.299 Test Acc: 0.346
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.657674551010132
Epoch: 8, Steps: 13 | Train Loss: 0.892 Vali Loss: 1.557 Vali Acc: 0.712 Test Loss: 1.557 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.850244760513306
Epoch: 9, Steps: 13 | Train Loss: 0.781 Vali Loss: 0.585 Vali Acc: 0.702 Test Loss: 0.585 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.738813161849976
Epoch: 10, Steps: 13 | Train Loss: 1.097 Vali Loss: 4.698 Vali Acc: 0.278 Test Loss: 4.698 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.738693714141846
Epoch: 11, Steps: 13 | Train Loss: 2.073 Vali Loss: 2.561 Vali Acc: 0.298 Test Loss: 2.561 Test Acc: 0.298
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.823603391647339
Epoch: 12, Steps: 13 | Train Loss: 1.141 Vali Loss: 1.955 Vali Acc: 0.712 Test Loss: 1.955 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.961477756500244
Epoch: 13, Steps: 13 | Train Loss: 0.885 Vali Loss: 1.217 Vali Acc: 0.507 Test Loss: 1.217 Test Acc: 0.507
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.497483730316162
Epoch: 14, Steps: 13 | Train Loss: 0.591 Vali Loss: 1.182 Vali Acc: 0.727 Test Loss: 1.182 Test Acc: 0.727
Validation loss decreased (-0.721946 --> -0.726817).  Saving model ...
Epoch: 15 cost time: 4.7189366817474365
Epoch: 15, Steps: 13 | Train Loss: 0.963 Vali Loss: 2.098 Vali Acc: 0.410 Test Loss: 2.098 Test Acc: 0.410
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.699973821640015
Epoch: 16, Steps: 13 | Train Loss: 1.235 Vali Loss: 1.036 Vali Acc: 0.576 Test Loss: 1.036 Test Acc: 0.576
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.693498849868774
Epoch: 17, Steps: 13 | Train Loss: 0.356 Vali Loss: 0.899 Vali Acc: 0.624 Test Loss: 0.899 Test Acc: 0.624
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.6675338745117188
Epoch: 18, Steps: 13 | Train Loss: 0.185 Vali Loss: 1.150 Vali Acc: 0.546 Test Loss: 1.150 Test Acc: 0.546
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.166428565979004
Epoch: 19, Steps: 13 | Train Loss: 0.267 Vali Loss: 0.848 Vali Acc: 0.668 Test Loss: 0.848 Test Acc: 0.668
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.155716419219971
Epoch: 20, Steps: 13 | Train Loss: 0.288 Vali Loss: 1.644 Vali Acc: 0.732 Test Loss: 1.644 Test Acc: 0.732
Validation loss decreased (-0.726817 --> -0.731691).  Saving model ...
Epoch: 21 cost time: 4.779829263687134
Epoch: 21, Steps: 13 | Train Loss: 0.215 Vali Loss: 1.197 Vali Acc: 0.571 Test Loss: 1.197 Test Acc: 0.571
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.852490663528442
Epoch: 22, Steps: 13 | Train Loss: 0.116 Vali Loss: 2.200 Vali Acc: 0.463 Test Loss: 2.200 Test Acc: 0.463
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.058301687240601
Epoch: 23, Steps: 13 | Train Loss: 0.294 Vali Loss: 1.298 Vali Acc: 0.751 Test Loss: 1.298 Test Acc: 0.751
Validation loss decreased (-0.731691 --> -0.751207).  Saving model ...
Epoch: 24 cost time: 4.585015535354614
Epoch: 24, Steps: 13 | Train Loss: 0.096 Vali Loss: 1.176 Vali Acc: 0.746 Test Loss: 1.176 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.751777648925781
Epoch: 25, Steps: 13 | Train Loss: 0.091 Vali Loss: 1.977 Vali Acc: 0.756 Test Loss: 1.977 Test Acc: 0.756
Validation loss decreased (-0.751207 --> -0.756078).  Saving model ...
Epoch: 26 cost time: 4.835450649261475
Epoch: 26, Steps: 13 | Train Loss: 0.141 Vali Loss: 1.865 Vali Acc: 0.741 Test Loss: 1.865 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 5.027163743972778
Epoch: 27, Steps: 13 | Train Loss: 0.171 Vali Loss: 1.354 Vali Acc: 0.746 Test Loss: 1.354 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 4.793065547943115
Epoch: 28, Steps: 13 | Train Loss: 0.165 Vali Loss: 3.764 Vali Acc: 0.415 Test Loss: 3.764 Test Acc: 0.415
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 5.057490587234497
Epoch: 29, Steps: 13 | Train Loss: 0.396 Vali Loss: 1.917 Vali Acc: 0.771 Test Loss: 1.917 Test Acc: 0.771
Validation loss decreased (-0.756078 --> -0.770713).  Saving model ...
Epoch: 30 cost time: 4.931987762451172
Epoch: 30, Steps: 13 | Train Loss: 0.204 Vali Loss: 1.490 Vali Acc: 0.610 Test Loss: 1.490 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 5.298014163970947
Epoch: 31, Steps: 13 | Train Loss: 0.067 Vali Loss: 1.398 Vali Acc: 0.727 Test Loss: 1.398 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 4.138090372085571
Epoch: 32, Steps: 13 | Train Loss: 0.023 Vali Loss: 1.488 Vali Acc: 0.746 Test Loss: 1.488 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 4.141950368881226
Epoch: 33, Steps: 13 | Train Loss: 0.021 Vali Loss: 2.056 Vali Acc: 0.527 Test Loss: 2.056 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.1367380619049072
Epoch: 34, Steps: 13 | Train Loss: 0.019 Vali Loss: 1.565 Vali Acc: 0.746 Test Loss: 1.565 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 4.099236726760864
Epoch: 35, Steps: 13 | Train Loss: 0.020 Vali Loss: 1.749 Vali Acc: 0.585 Test Loss: 1.749 Test Acc: 0.585
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 4.8478758335113525
Epoch: 36, Steps: 13 | Train Loss: 0.029 Vali Loss: 1.418 Vali Acc: 0.673 Test Loss: 1.418 Test Acc: 0.673
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 4.9507105350494385
Epoch: 37, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.910 Vali Acc: 0.717 Test Loss: 1.910 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 4.5593953132629395
Epoch: 38, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.637 Vali Acc: 0.673 Test Loss: 1.637 Test Acc: 0.673
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 4.539935111999512
Epoch: 39, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.607 Vali Acc: 0.693 Test Loss: 1.607 Test Acc: 0.693
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 1611186
model size : 7.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.667291164398193
Epoch: 1, Steps: 13 | Train Loss: 0.672 Vali Loss: 0.605 Vali Acc: 0.722 Test Loss: 0.605 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.069624900817871
Epoch: 2, Steps: 13 | Train Loss: 0.630 Vali Loss: 0.643 Vali Acc: 0.737 Test Loss: 0.643 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736579).  Saving model ...
Epoch: 3 cost time: 4.517941474914551
Epoch: 3, Steps: 13 | Train Loss: 0.691 Vali Loss: 0.542 Vali Acc: 0.727 Test Loss: 0.542 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.645932912826538
Epoch: 4, Steps: 13 | Train Loss: 0.651 Vali Loss: 0.655 Vali Acc: 0.590 Test Loss: 0.655 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.922178268432617
Epoch: 5, Steps: 13 | Train Loss: 0.657 Vali Loss: 0.665 Vali Acc: 0.727 Test Loss: 0.665 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.905503034591675
Epoch: 6, Steps: 13 | Train Loss: 0.512 Vali Loss: 0.534 Vali Acc: 0.727 Test Loss: 0.534 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.945080995559692
Epoch: 7, Steps: 13 | Train Loss: 0.523 Vali Loss: 0.521 Vali Acc: 0.746 Test Loss: 0.521 Test Acc: 0.746
Validation loss decreased (-0.736579 --> -0.746336).  Saving model ...
Epoch: 8 cost time: 4.712153911590576
Epoch: 8, Steps: 13 | Train Loss: 0.739 Vali Loss: 0.956 Vali Acc: 0.454 Test Loss: 0.956 Test Acc: 0.454
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.832517623901367
Epoch: 9, Steps: 13 | Train Loss: 0.664 Vali Loss: 1.458 Vali Acc: 0.722 Test Loss: 1.458 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.446945667266846
Epoch: 10, Steps: 13 | Train Loss: 0.732 Vali Loss: 0.903 Vali Acc: 0.498 Test Loss: 0.903 Test Acc: 0.498
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.643358945846558
Epoch: 11, Steps: 13 | Train Loss: 0.556 Vali Loss: 0.793 Vali Acc: 0.737 Test Loss: 0.793 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.276731967926025
Epoch: 12, Steps: 13 | Train Loss: 0.766 Vali Loss: 2.271 Vali Acc: 0.307 Test Loss: 2.271 Test Acc: 0.307
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.628918409347534
Epoch: 13, Steps: 13 | Train Loss: 0.728 Vali Loss: 1.415 Vali Acc: 0.727 Test Loss: 1.415 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.480358600616455
Epoch: 14, Steps: 13 | Train Loss: 1.003 Vali Loss: 1.492 Vali Acc: 0.737 Test Loss: 1.492 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.194943428039551
Epoch: 15, Steps: 13 | Train Loss: 0.845 Vali Loss: 1.318 Vali Acc: 0.429 Test Loss: 1.318 Test Acc: 0.429
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.6301796436309814
Epoch: 16, Steps: 13 | Train Loss: 0.931 Vali Loss: 0.898 Vali Acc: 0.751 Test Loss: 0.898 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751211).  Saving model ...
Epoch: 17 cost time: 4.405442953109741
Epoch: 17, Steps: 13 | Train Loss: 0.408 Vali Loss: 1.735 Vali Acc: 0.737 Test Loss: 1.735 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.7679033279418945
Epoch: 18, Steps: 13 | Train Loss: 0.358 Vali Loss: 1.010 Vali Acc: 0.756 Test Loss: 1.010 Test Acc: 0.756
Validation loss decreased (-0.751211 --> -0.756087).  Saving model ...
Epoch: 19 cost time: 4.139301776885986
Epoch: 19, Steps: 13 | Train Loss: 0.395 Vali Loss: 0.695 Vali Acc: 0.746 Test Loss: 0.695 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.825817346572876
Epoch: 20, Steps: 13 | Train Loss: 1.158 Vali Loss: 2.231 Vali Acc: 0.727 Test Loss: 2.231 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.401341438293457
Epoch: 21, Steps: 13 | Train Loss: 0.332 Vali Loss: 1.674 Vali Acc: 0.737 Test Loss: 1.674 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.168164968490601
Epoch: 22, Steps: 13 | Train Loss: 0.496 Vali Loss: 2.423 Vali Acc: 0.429 Test Loss: 2.423 Test Acc: 0.429
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.203847408294678
Epoch: 23, Steps: 13 | Train Loss: 0.287 Vali Loss: 1.173 Vali Acc: 0.620 Test Loss: 1.173 Test Acc: 0.620
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 4.827671527862549
Epoch: 24, Steps: 13 | Train Loss: 0.471 Vali Loss: 1.442 Vali Acc: 0.737 Test Loss: 1.442 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 4.709108591079712
Epoch: 25, Steps: 13 | Train Loss: 0.662 Vali Loss: 1.401 Vali Acc: 0.624 Test Loss: 1.401 Test Acc: 0.624
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 4.4447784423828125
Epoch: 26, Steps: 13 | Train Loss: 0.154 Vali Loss: 1.089 Vali Acc: 0.639 Test Loss: 1.089 Test Acc: 0.639
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 4.20446515083313
Epoch: 27, Steps: 13 | Train Loss: 0.560 Vali Loss: 3.667 Vali Acc: 0.463 Test Loss: 3.667 Test Acc: 0.463
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 4.450075626373291
Epoch: 28, Steps: 13 | Train Loss: 1.297 Vali Loss: 1.287 Vali Acc: 0.702 Test Loss: 1.287 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 1607346
model size : 7.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.902833700180054
Epoch: 1, Steps: 13 | Train Loss: 0.668 Vali Loss: 1.053 Vali Acc: 0.283 Test Loss: 1.053 Test Acc: 0.283
Validation loss decreased (inf --> -0.282916).  Saving model ...
Epoch: 2 cost time: 4.494684219360352
Epoch: 2, Steps: 13 | Train Loss: 0.730 Vali Loss: 0.688 Vali Acc: 0.537 Test Loss: 0.688 Test Acc: 0.537
Validation loss decreased (-0.282916 --> -0.536578).  Saving model ...
Epoch: 3 cost time: 4.578324556350708
Epoch: 3, Steps: 13 | Train Loss: 0.565 Vali Loss: 0.575 Vali Acc: 0.722 Test Loss: 0.575 Test Acc: 0.722
Validation loss decreased (-0.536578 --> -0.721945).  Saving model ...
Epoch: 4 cost time: 4.645931720733643
Epoch: 4, Steps: 13 | Train Loss: 0.586 Vali Loss: 0.521 Vali Acc: 0.741 Test Loss: 0.521 Test Acc: 0.741
Validation loss decreased (-0.721945 --> -0.741458).  Saving model ...
Epoch: 5 cost time: 3.9291067123413086
Epoch: 5, Steps: 13 | Train Loss: 0.575 Vali Loss: 0.541 Vali Acc: 0.756 Test Loss: 0.541 Test Acc: 0.756
Validation loss decreased (-0.741458 --> -0.756092).  Saving model ...
Epoch: 6 cost time: 4.7780539989471436
Epoch: 6, Steps: 13 | Train Loss: 0.430 Vali Loss: 0.538 Vali Acc: 0.741 Test Loss: 0.538 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.5238118171691895
Epoch: 7, Steps: 13 | Train Loss: 0.470 Vali Loss: 0.622 Vali Acc: 0.737 Test Loss: 0.622 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.40795373916626
Epoch: 8, Steps: 13 | Train Loss: 0.393 Vali Loss: 0.531 Vali Acc: 0.732 Test Loss: 0.531 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.884574890136719
Epoch: 9, Steps: 13 | Train Loss: 0.657 Vali Loss: 0.549 Vali Acc: 0.712 Test Loss: 0.549 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.422906160354614
Epoch: 10, Steps: 13 | Train Loss: 0.319 Vali Loss: 0.976 Vali Acc: 0.478 Test Loss: 0.976 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.088827848434448
Epoch: 11, Steps: 13 | Train Loss: 0.405 Vali Loss: 0.564 Vali Acc: 0.737 Test Loss: 0.564 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.247151613235474
Epoch: 12, Steps: 13 | Train Loss: 0.530 Vali Loss: 0.589 Vali Acc: 0.712 Test Loss: 0.589 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.2221198081970215
Epoch: 13, Steps: 13 | Train Loss: 0.417 Vali Loss: 1.640 Vali Acc: 0.722 Test Loss: 1.640 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.4950196743011475
Epoch: 14, Steps: 13 | Train Loss: 1.244 Vali Loss: 0.842 Vali Acc: 0.639 Test Loss: 0.842 Test Acc: 0.639
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 5.170662879943848
Epoch: 15, Steps: 13 | Train Loss: 0.661 Vali Loss: 1.408 Vali Acc: 0.732 Test Loss: 1.408 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 1156530
model size : 5.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.227205514907837
Epoch: 1, Steps: 13 | Train Loss: 0.756 Vali Loss: 0.663 Vali Acc: 0.732 Test Loss: 0.663 Test Acc: 0.732
Validation loss decreased (inf --> -0.731701).  Saving model ...
Epoch: 2 cost time: 3.9933040142059326
Epoch: 2, Steps: 13 | Train Loss: 0.799 Vali Loss: 0.913 Vali Acc: 0.278 Test Loss: 0.913 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.456049680709839
Epoch: 3, Steps: 13 | Train Loss: 0.617 Vali Loss: 0.571 Vali Acc: 0.732 Test Loss: 0.571 Test Acc: 0.732
Validation loss decreased (-0.731701 --> -0.731702).  Saving model ...
Epoch: 4 cost time: 4.104791641235352
Epoch: 4, Steps: 13 | Train Loss: 0.809 Vali Loss: 0.741 Vali Acc: 0.434 Test Loss: 0.741 Test Acc: 0.434
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.289792060852051
Epoch: 5, Steps: 13 | Train Loss: 0.754 Vali Loss: 0.607 Vali Acc: 0.732 Test Loss: 0.607 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.037027597427368
Epoch: 6, Steps: 13 | Train Loss: 0.579 Vali Loss: 0.881 Vali Acc: 0.459 Test Loss: 0.881 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.088329076766968
Epoch: 7, Steps: 13 | Train Loss: 0.906 Vali Loss: 1.223 Vali Acc: 0.722 Test Loss: 1.223 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.525315761566162
Epoch: 8, Steps: 13 | Train Loss: 0.718 Vali Loss: 0.537 Vali Acc: 0.741 Test Loss: 0.537 Test Acc: 0.741
Validation loss decreased (-0.731702 --> -0.741458).  Saving model ...
Epoch: 9 cost time: 4.158473491668701
Epoch: 9, Steps: 13 | Train Loss: 0.650 Vali Loss: 2.131 Vali Acc: 0.722 Test Loss: 2.131 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.42838191986084
Epoch: 10, Steps: 13 | Train Loss: 0.834 Vali Loss: 1.767 Vali Acc: 0.307 Test Loss: 1.767 Test Acc: 0.307
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.683731555938721
Epoch: 11, Steps: 13 | Train Loss: 0.716 Vali Loss: 0.546 Vali Acc: 0.761 Test Loss: 0.546 Test Acc: 0.761
Validation loss decreased (-0.741458 --> -0.760970).  Saving model ...
Epoch: 12 cost time: 5.5068840980529785
Epoch: 12, Steps: 13 | Train Loss: 1.166 Vali Loss: 3.578 Vali Acc: 0.293 Test Loss: 3.578 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.450425148010254
Epoch: 13, Steps: 13 | Train Loss: 2.346 Vali Loss: 8.056 Vali Acc: 0.278 Test Loss: 8.056 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.0609776973724365
Epoch: 14, Steps: 13 | Train Loss: 3.093 Vali Loss: 1.227 Vali Acc: 0.512 Test Loss: 1.227 Test Acc: 0.512
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.4770889282226562
Epoch: 15, Steps: 13 | Train Loss: 0.944 Vali Loss: 0.844 Vali Acc: 0.751 Test Loss: 0.844 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.7457656860351562
Epoch: 16, Steps: 13 | Train Loss: 0.576 Vali Loss: 1.391 Vali Acc: 0.727 Test Loss: 1.391 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.296377658843994
Epoch: 17, Steps: 13 | Train Loss: 0.365 Vali Loss: 1.047 Vali Acc: 0.741 Test Loss: 1.047 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.212499141693115
Epoch: 18, Steps: 13 | Train Loss: 0.444 Vali Loss: 0.962 Vali Acc: 0.741 Test Loss: 0.962 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.8326961994171143
Epoch: 19, Steps: 13 | Train Loss: 0.368 Vali Loss: 2.845 Vali Acc: 0.722 Test Loss: 2.845 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.732692241668701
Epoch: 20, Steps: 13 | Train Loss: 0.841 Vali Loss: 0.785 Vali Acc: 0.717 Test Loss: 0.785 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.091912746429443
Epoch: 21, Steps: 13 | Train Loss: 1.678 Vali Loss: 1.189 Vali Acc: 0.624 Test Loss: 1.189 Test Acc: 0.624
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 1152690
model size : 5.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.4210522174835205
Epoch: 1, Steps: 13 | Train Loss: 0.654 Vali Loss: 0.656 Vali Acc: 0.702 Test Loss: 0.656 Test Acc: 0.702
Validation loss decreased (inf --> -0.702432).  Saving model ...
Epoch: 2 cost time: 4.785508155822754
Epoch: 2, Steps: 13 | Train Loss: 0.561 Vali Loss: 0.826 Vali Acc: 0.722 Test Loss: 0.826 Test Acc: 0.722
Validation loss decreased (-0.702432 --> -0.721943).  Saving model ...
Epoch: 3 cost time: 4.441246032714844
Epoch: 3, Steps: 13 | Train Loss: 0.630 Vali Loss: 0.670 Vali Acc: 0.629 Test Loss: 0.670 Test Acc: 0.629
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.162782192230225
Epoch: 4, Steps: 13 | Train Loss: 0.665 Vali Loss: 0.574 Vali Acc: 0.727 Test Loss: 0.574 Test Acc: 0.727
Validation loss decreased (-0.721943 --> -0.726824).  Saving model ...
Epoch: 5 cost time: 4.829195499420166
Epoch: 5, Steps: 13 | Train Loss: 0.473 Vali Loss: 0.534 Vali Acc: 0.732 Test Loss: 0.534 Test Acc: 0.732
Validation loss decreased (-0.726824 --> -0.731702).  Saving model ...
Epoch: 6 cost time: 4.401471376419067
Epoch: 6, Steps: 13 | Train Loss: 0.475 Vali Loss: 0.515 Vali Acc: 0.756 Test Loss: 0.515 Test Acc: 0.756
Validation loss decreased (-0.731702 --> -0.756092).  Saving model ...
Epoch: 7 cost time: 3.4105947017669678
Epoch: 7, Steps: 13 | Train Loss: 0.679 Vali Loss: 0.647 Vali Acc: 0.639 Test Loss: 0.647 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.206419467926025
Epoch: 8, Steps: 13 | Train Loss: 0.529 Vali Loss: 0.517 Vali Acc: 0.737 Test Loss: 0.517 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.653923273086548
Epoch: 9, Steps: 13 | Train Loss: 0.424 Vali Loss: 0.921 Vali Acc: 0.498 Test Loss: 0.921 Test Acc: 0.498
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.060341119766235
Epoch: 10, Steps: 13 | Train Loss: 0.568 Vali Loss: 2.716 Vali Acc: 0.288 Test Loss: 2.716 Test Acc: 0.288
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.756971836090088
Epoch: 11, Steps: 13 | Train Loss: 0.904 Vali Loss: 1.338 Vali Acc: 0.722 Test Loss: 1.338 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.537745475769043
Epoch: 12, Steps: 13 | Train Loss: 0.394 Vali Loss: 0.594 Vali Acc: 0.712 Test Loss: 0.594 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.270291566848755
Epoch: 13, Steps: 13 | Train Loss: 0.392 Vali Loss: 0.900 Vali Acc: 0.732 Test Loss: 0.900 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.4146692752838135
Epoch: 14, Steps: 13 | Train Loss: 1.130 Vali Loss: 1.314 Vali Acc: 0.732 Test Loss: 1.314 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.639688730239868
Epoch: 15, Steps: 13 | Train Loss: 0.588 Vali Loss: 0.866 Vali Acc: 0.732 Test Loss: 0.866 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.531975746154785
Epoch: 16, Steps: 13 | Train Loss: 0.386 Vali Loss: 0.749 Vali Acc: 0.737 Test Loss: 0.749 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 1148850
model size : 5.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.543806076049805
Epoch: 1, Steps: 13 | Train Loss: 0.620 Vali Loss: 0.665 Vali Acc: 0.702 Test Loss: 0.665 Test Acc: 0.702
Validation loss decreased (inf --> -0.702432).  Saving model ...
Epoch: 2 cost time: 5.221704483032227
Epoch: 2, Steps: 13 | Train Loss: 0.709 Vali Loss: 0.653 Vali Acc: 0.712 Test Loss: 0.653 Test Acc: 0.712
Validation loss decreased (-0.702432 --> -0.712189).  Saving model ...
Epoch: 3 cost time: 4.607892751693726
Epoch: 3, Steps: 13 | Train Loss: 0.745 Vali Loss: 0.843 Vali Acc: 0.337 Test Loss: 0.843 Test Acc: 0.337
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.9397385120391846
Epoch: 4, Steps: 13 | Train Loss: 0.604 Vali Loss: 0.756 Vali Acc: 0.459 Test Loss: 0.756 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.241729259490967
Epoch: 5, Steps: 13 | Train Loss: 0.591 Vali Loss: 0.769 Vali Acc: 0.478 Test Loss: 0.769 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.3726680278778076
Epoch: 6, Steps: 13 | Train Loss: 0.536 Vali Loss: 0.686 Vali Acc: 0.722 Test Loss: 0.686 Test Acc: 0.722
Validation loss decreased (-0.712189 --> -0.721944).  Saving model ...
Epoch: 7 cost time: 3.554553270339966
Epoch: 7, Steps: 13 | Train Loss: 0.468 Vali Loss: 0.606 Vali Acc: 0.741 Test Loss: 0.606 Test Acc: 0.741
Validation loss decreased (-0.721944 --> -0.741457).  Saving model ...
Epoch: 8 cost time: 3.7469072341918945
Epoch: 8, Steps: 13 | Train Loss: 0.457 Vali Loss: 0.955 Vali Acc: 0.722 Test Loss: 0.955 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.688394546508789
Epoch: 9, Steps: 13 | Train Loss: 0.668 Vali Loss: 0.555 Vali Acc: 0.688 Test Loss: 0.555 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.8496146202087402
Epoch: 10, Steps: 13 | Train Loss: 0.636 Vali Loss: 0.985 Vali Acc: 0.424 Test Loss: 0.985 Test Acc: 0.424
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.7048680782318115
Epoch: 11, Steps: 13 | Train Loss: 0.420 Vali Loss: 1.854 Vali Acc: 0.332 Test Loss: 1.854 Test Acc: 0.332
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.2315993309021
Epoch: 12, Steps: 13 | Train Loss: 0.631 Vali Loss: 1.458 Vali Acc: 0.727 Test Loss: 1.458 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.433310508728027
Epoch: 13, Steps: 13 | Train Loss: 0.440 Vali Loss: 0.790 Vali Acc: 0.741 Test Loss: 0.790 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.275832176208496
Epoch: 14, Steps: 13 | Train Loss: 0.345 Vali Loss: 2.244 Vali Acc: 0.341 Test Loss: 2.244 Test Acc: 0.341
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.855294227600098
Epoch: 15, Steps: 13 | Train Loss: 0.793 Vali Loss: 1.533 Vali Acc: 0.732 Test Loss: 1.533 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.61521315574646
Epoch: 16, Steps: 13 | Train Loss: 0.320 Vali Loss: 1.716 Vali Acc: 0.722 Test Loss: 1.716 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.581723690032959
Epoch: 17, Steps: 13 | Train Loss: 0.480 Vali Loss: 0.918 Vali Acc: 0.600 Test Loss: 0.918 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 1145010
model size : 5.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.568293333053589
Epoch: 1, Steps: 13 | Train Loss: 0.617 Vali Loss: 0.588 Vali Acc: 0.722 Test Loss: 0.588 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.510786771774292
Epoch: 2, Steps: 13 | Train Loss: 0.614 Vali Loss: 0.549 Vali Acc: 0.722 Test Loss: 0.549 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721946).  Saving model ...
Epoch: 3 cost time: 4.059221267700195
Epoch: 3, Steps: 13 | Train Loss: 0.536 Vali Loss: 0.544 Vali Acc: 0.727 Test Loss: 0.544 Test Acc: 0.727
Validation loss decreased (-0.721946 --> -0.726824).  Saving model ...
Epoch: 4 cost time: 4.10576605796814
Epoch: 4, Steps: 13 | Train Loss: 0.503 Vali Loss: 0.579 Vali Acc: 0.737 Test Loss: 0.579 Test Acc: 0.737
Validation loss decreased (-0.726824 --> -0.736580).  Saving model ...
Epoch: 5 cost time: 3.8553500175476074
Epoch: 5, Steps: 13 | Train Loss: 0.472 Vali Loss: 0.768 Vali Acc: 0.727 Test Loss: 0.768 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.167781352996826
Epoch: 6, Steps: 13 | Train Loss: 0.623 Vali Loss: 0.521 Vali Acc: 0.751 Test Loss: 0.521 Test Acc: 0.751
Validation loss decreased (-0.736580 --> -0.751214).  Saving model ...
Epoch: 7 cost time: 4.375887393951416
Epoch: 7, Steps: 13 | Train Loss: 0.713 Vali Loss: 0.674 Vali Acc: 0.639 Test Loss: 0.674 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.509279727935791
Epoch: 8, Steps: 13 | Train Loss: 0.484 Vali Loss: 0.519 Vali Acc: 0.732 Test Loss: 0.519 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.382065773010254
Epoch: 9, Steps: 13 | Train Loss: 0.716 Vali Loss: 0.663 Vali Acc: 0.629 Test Loss: 0.663 Test Acc: 0.629
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.107991695404053
Epoch: 10, Steps: 13 | Train Loss: 0.387 Vali Loss: 0.595 Vali Acc: 0.668 Test Loss: 0.595 Test Acc: 0.668
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.2059736251831055
Epoch: 11, Steps: 13 | Train Loss: 0.496 Vali Loss: 1.908 Vali Acc: 0.722 Test Loss: 1.908 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.203500032424927
Epoch: 12, Steps: 13 | Train Loss: 0.909 Vali Loss: 0.659 Vali Acc: 0.761 Test Loss: 0.659 Test Acc: 0.761
Validation loss decreased (-0.751214 --> -0.760969).  Saving model ...
Epoch: 13 cost time: 4.497292995452881
Epoch: 13, Steps: 13 | Train Loss: 0.669 Vali Loss: 1.106 Vali Acc: 0.741 Test Loss: 1.106 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.3762969970703125
Epoch: 14, Steps: 13 | Train Loss: 0.582 Vali Loss: 1.023 Vali Acc: 0.502 Test Loss: 1.023 Test Acc: 0.502
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.427591800689697
Epoch: 15, Steps: 13 | Train Loss: 0.724 Vali Loss: 1.680 Vali Acc: 0.737 Test Loss: 1.680 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.7457664012908936
Epoch: 16, Steps: 13 | Train Loss: 0.361 Vali Loss: 0.873 Vali Acc: 0.595 Test Loss: 0.873 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.402841091156006
Epoch: 17, Steps: 13 | Train Loss: 0.212 Vali Loss: 0.729 Vali Acc: 0.649 Test Loss: 0.729 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.559666395187378
Epoch: 18, Steps: 13 | Train Loss: 0.262 Vali Loss: 1.134 Vali Acc: 0.746 Test Loss: 1.134 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.757294416427612
Epoch: 19, Steps: 13 | Train Loss: 0.499 Vali Loss: 0.781 Vali Acc: 0.722 Test Loss: 0.781 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.964675188064575
Epoch: 20, Steps: 13 | Train Loss: 0.262 Vali Loss: 1.164 Vali Acc: 0.566 Test Loss: 1.164 Test Acc: 0.566
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.4870941638946533
Epoch: 21, Steps: 13 | Train Loss: 0.540 Vali Loss: 0.869 Vali Acc: 0.737 Test Loss: 0.869 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.9552276134490967
Epoch: 22, Steps: 13 | Train Loss: 0.660 Vali Loss: 0.926 Vali Acc: 0.737 Test Loss: 0.926 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 925362
model size : 4.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.217381238937378
Epoch: 1, Steps: 13 | Train Loss: 0.658 Vali Loss: 0.581 Vali Acc: 0.717 Test Loss: 0.581 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 4.005692720413208
Epoch: 2, Steps: 13 | Train Loss: 0.583 Vali Loss: 0.582 Vali Acc: 0.722 Test Loss: 0.582 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 4.860996246337891
Epoch: 3, Steps: 13 | Train Loss: 0.602 Vali Loss: 0.549 Vali Acc: 0.746 Test Loss: 0.549 Test Acc: 0.746
Validation loss decreased (-0.721945 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 4.039545297622681
Epoch: 4, Steps: 13 | Train Loss: 0.507 Vali Loss: 0.518 Vali Acc: 0.761 Test Loss: 0.518 Test Acc: 0.761
Validation loss decreased (-0.746336 --> -0.760970).  Saving model ...
Epoch: 5 cost time: 4.2037270069122314
Epoch: 5, Steps: 13 | Train Loss: 0.605 Vali Loss: 0.982 Vali Acc: 0.722 Test Loss: 0.982 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.008625268936157
Epoch: 6, Steps: 13 | Train Loss: 0.533 Vali Loss: 0.537 Vali Acc: 0.732 Test Loss: 0.537 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.245692014694214
Epoch: 7, Steps: 13 | Train Loss: 0.569 Vali Loss: 0.746 Vali Acc: 0.727 Test Loss: 0.746 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.10001277923584
Epoch: 8, Steps: 13 | Train Loss: 0.444 Vali Loss: 0.855 Vali Acc: 0.722 Test Loss: 0.855 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.0272746086120605
Epoch: 9, Steps: 13 | Train Loss: 0.453 Vali Loss: 0.957 Vali Acc: 0.727 Test Loss: 0.957 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.4077274799346924
Epoch: 10, Steps: 13 | Train Loss: 0.624 Vali Loss: 2.318 Vali Acc: 0.312 Test Loss: 2.318 Test Acc: 0.312
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.895626783370972
Epoch: 11, Steps: 13 | Train Loss: 1.024 Vali Loss: 0.687 Vali Acc: 0.751 Test Loss: 0.687 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.294506072998047
Epoch: 12, Steps: 13 | Train Loss: 0.445 Vali Loss: 1.399 Vali Acc: 0.434 Test Loss: 1.399 Test Acc: 0.434
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.1526594161987305
Epoch: 13, Steps: 13 | Train Loss: 0.721 Vali Loss: 1.082 Vali Acc: 0.473 Test Loss: 1.082 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.828214406967163
Epoch: 14, Steps: 13 | Train Loss: 0.683 Vali Loss: 1.194 Vali Acc: 0.727 Test Loss: 1.194 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 921522
model size : 4.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.2204530239105225
Epoch: 1, Steps: 13 | Train Loss: 0.661 Vali Loss: 0.597 Vali Acc: 0.717 Test Loss: 0.597 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 4.353388071060181
Epoch: 2, Steps: 13 | Train Loss: 0.585 Vali Loss: 0.609 Vali Acc: 0.717 Test Loss: 0.609 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.726529836654663
Epoch: 3, Steps: 13 | Train Loss: 0.530 Vali Loss: 0.551 Vali Acc: 0.741 Test Loss: 0.551 Test Acc: 0.741
Validation loss decreased (-0.717067 --> -0.741458).  Saving model ...
Epoch: 4 cost time: 4.053857088088989
Epoch: 4, Steps: 13 | Train Loss: 0.553 Vali Loss: 0.957 Vali Acc: 0.376 Test Loss: 0.957 Test Acc: 0.376
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.2929699420928955
Epoch: 5, Steps: 13 | Train Loss: 0.632 Vali Loss: 0.934 Vali Acc: 0.717 Test Loss: 0.934 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.212395906448364
Epoch: 6, Steps: 13 | Train Loss: 1.483 Vali Loss: 1.416 Vali Acc: 0.722 Test Loss: 1.416 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.9563496112823486
Epoch: 7, Steps: 13 | Train Loss: 0.942 Vali Loss: 0.858 Vali Acc: 0.576 Test Loss: 0.858 Test Acc: 0.576
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.5795645713806152
Epoch: 8, Steps: 13 | Train Loss: 0.691 Vali Loss: 0.993 Vali Acc: 0.727 Test Loss: 0.993 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.051197290420532
Epoch: 9, Steps: 13 | Train Loss: 0.529 Vali Loss: 0.774 Vali Acc: 0.727 Test Loss: 0.774 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.3312158584594727
Epoch: 10, Steps: 13 | Train Loss: 0.494 Vali Loss: 1.162 Vali Acc: 0.727 Test Loss: 1.162 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.131194353103638
Epoch: 11, Steps: 13 | Train Loss: 0.694 Vali Loss: 1.126 Vali Acc: 0.415 Test Loss: 1.126 Test Acc: 0.415
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.136050701141357
Epoch: 12, Steps: 13 | Train Loss: 0.605 Vali Loss: 0.853 Vali Acc: 0.737 Test Loss: 0.853 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.398052453994751
Epoch: 13, Steps: 13 | Train Loss: 0.757 Vali Loss: 0.565 Vali Acc: 0.741 Test Loss: 0.565 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 917682
model size : 4.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.8539910316467285
Epoch: 1, Steps: 13 | Train Loss: 0.630 Vali Loss: 0.674 Vali Acc: 0.722 Test Loss: 0.674 Test Acc: 0.722
Validation loss decreased (inf --> -0.721944).  Saving model ...
Epoch: 2 cost time: 4.1237242221832275
Epoch: 2, Steps: 13 | Train Loss: 0.582 Vali Loss: 0.604 Vali Acc: 0.722 Test Loss: 0.604 Test Acc: 0.722
Validation loss decreased (-0.721944 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 4.260177373886108
Epoch: 3, Steps: 13 | Train Loss: 0.638 Vali Loss: 0.826 Vali Acc: 0.722 Test Loss: 0.826 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.703597784042358
Epoch: 4, Steps: 13 | Train Loss: 0.632 Vali Loss: 0.606 Vali Acc: 0.698 Test Loss: 0.606 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.599637031555176
Epoch: 5, Steps: 13 | Train Loss: 0.637 Vali Loss: 0.535 Vali Acc: 0.746 Test Loss: 0.535 Test Acc: 0.746
Validation loss decreased (-0.721945 --> -0.746336).  Saving model ...
Epoch: 6 cost time: 4.367306232452393
Epoch: 6, Steps: 13 | Train Loss: 0.488 Vali Loss: 0.525 Vali Acc: 0.756 Test Loss: 0.525 Test Acc: 0.756
Validation loss decreased (-0.746336 --> -0.756092).  Saving model ...
Epoch: 7 cost time: 3.421698570251465
Epoch: 7, Steps: 13 | Train Loss: 0.700 Vali Loss: 0.774 Vali Acc: 0.717 Test Loss: 0.774 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.843383550643921
Epoch: 8, Steps: 13 | Train Loss: 0.461 Vali Loss: 0.930 Vali Acc: 0.722 Test Loss: 0.930 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.5781779289245605
Epoch: 9, Steps: 13 | Train Loss: 0.642 Vali Loss: 1.400 Vali Acc: 0.361 Test Loss: 1.400 Test Acc: 0.361
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.8004183769226074
Epoch: 10, Steps: 13 | Train Loss: 0.472 Vali Loss: 0.620 Vali Acc: 0.683 Test Loss: 0.620 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.7107932567596436
Epoch: 11, Steps: 13 | Train Loss: 0.436 Vali Loss: 0.612 Vali Acc: 0.693 Test Loss: 0.612 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.8534438610076904
Epoch: 12, Steps: 13 | Train Loss: 0.377 Vali Loss: 0.719 Vali Acc: 0.580 Test Loss: 0.719 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.7999885082244873
Epoch: 13, Steps: 13 | Train Loss: 0.269 Vali Loss: 0.866 Vali Acc: 0.741 Test Loss: 0.866 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.9267261028289795
Epoch: 14, Steps: 13 | Train Loss: 0.779 Vali Loss: 2.794 Vali Acc: 0.327 Test Loss: 2.794 Test Acc: 0.327
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.058228254318237
Epoch: 15, Steps: 13 | Train Loss: 0.671 Vali Loss: 0.723 Vali Acc: 0.737 Test Loss: 0.723 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.60422420501709
Epoch: 16, Steps: 13 | Train Loss: 0.394 Vali Loss: 2.542 Vali Acc: 0.722 Test Loss: 2.542 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 913842
model size : 4.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.179526090621948
Epoch: 1, Steps: 13 | Train Loss: 0.656 Vali Loss: 0.669 Vali Acc: 0.668 Test Loss: 0.669 Test Acc: 0.668
Validation loss decreased (inf --> -0.668286).  Saving model ...
Epoch: 2 cost time: 4.351901292800903
Epoch: 2, Steps: 13 | Train Loss: 0.796 Vali Loss: 0.703 Vali Acc: 0.502 Test Loss: 0.703 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.199201345443726
Epoch: 3, Steps: 13 | Train Loss: 0.874 Vali Loss: 0.616 Vali Acc: 0.722 Test Loss: 0.616 Test Acc: 0.722
Validation loss decreased (-0.668286 --> -0.721945).  Saving model ...
Epoch: 4 cost time: 4.19544792175293
Epoch: 4, Steps: 13 | Train Loss: 0.706 Vali Loss: 1.341 Vali Acc: 0.283 Test Loss: 1.341 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.766901016235352
Epoch: 5, Steps: 13 | Train Loss: 0.656 Vali Loss: 0.867 Vali Acc: 0.722 Test Loss: 0.867 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.603600740432739
Epoch: 6, Steps: 13 | Train Loss: 0.585 Vali Loss: 0.628 Vali Acc: 0.732 Test Loss: 0.628 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731701).  Saving model ...
Epoch: 7 cost time: 4.060504913330078
Epoch: 7, Steps: 13 | Train Loss: 0.706 Vali Loss: 1.960 Vali Acc: 0.293 Test Loss: 1.960 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.317187786102295
Epoch: 8, Steps: 13 | Train Loss: 0.684 Vali Loss: 0.959 Vali Acc: 0.415 Test Loss: 0.959 Test Acc: 0.415
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.122306823730469
Epoch: 9, Steps: 13 | Train Loss: 0.496 Vali Loss: 0.609 Vali Acc: 0.756 Test Loss: 0.609 Test Acc: 0.756
Validation loss decreased (-0.731701 --> -0.756091).  Saving model ...
Epoch: 10 cost time: 2.933558225631714
Epoch: 10, Steps: 13 | Train Loss: 0.425 Vali Loss: 0.858 Vali Acc: 0.732 Test Loss: 0.858 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.537698745727539
Epoch: 11, Steps: 13 | Train Loss: 0.519 Vali Loss: 0.752 Vali Acc: 0.746 Test Loss: 0.752 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.767935514450073
Epoch: 12, Steps: 13 | Train Loss: 0.447 Vali Loss: 0.845 Vali Acc: 0.746 Test Loss: 0.845 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.8422675132751465
Epoch: 13, Steps: 13 | Train Loss: 0.435 Vali Loss: 0.957 Vali Acc: 0.732 Test Loss: 0.957 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.596172571182251
Epoch: 14, Steps: 13 | Train Loss: 0.727 Vali Loss: 0.893 Vali Acc: 0.571 Test Loss: 0.893 Test Acc: 0.571
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.7348792552948
Epoch: 15, Steps: 13 | Train Loss: 0.469 Vali Loss: 0.668 Vali Acc: 0.707 Test Loss: 0.668 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.200374126434326
Epoch: 16, Steps: 13 | Train Loss: 1.179 Vali Loss: 2.488 Vali Acc: 0.712 Test Loss: 2.488 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.199947834014893
Epoch: 17, Steps: 13 | Train Loss: 0.720 Vali Loss: 0.857 Vali Acc: 0.576 Test Loss: 0.857 Test Acc: 0.576
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.127866744995117
Epoch: 18, Steps: 13 | Train Loss: 0.449 Vali Loss: 0.750 Vali Acc: 0.702 Test Loss: 0.750 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.19746208190918
Epoch: 19, Steps: 13 | Train Loss: 0.822 Vali Loss: 0.761 Vali Acc: 0.693 Test Loss: 0.761 Test Acc: 0.693
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 809778
model size : 4.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.035829544067383
Epoch: 1, Steps: 13 | Train Loss: 0.669 Vali Loss: 0.600 Vali Acc: 0.722 Test Loss: 0.600 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.073065280914307
Epoch: 2, Steps: 13 | Train Loss: 0.619 Vali Loss: 0.776 Vali Acc: 0.722 Test Loss: 0.776 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.60327672958374
Epoch: 3, Steps: 13 | Train Loss: 0.746 Vali Loss: 0.537 Vali Acc: 0.741 Test Loss: 0.537 Test Acc: 0.741
Validation loss decreased (-0.721945 --> -0.741458).  Saving model ...
Epoch: 4 cost time: 4.285894393920898
Epoch: 4, Steps: 13 | Train Loss: 0.536 Vali Loss: 0.546 Vali Acc: 0.732 Test Loss: 0.546 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.57359504699707
Epoch: 5, Steps: 13 | Train Loss: 0.593 Vali Loss: 0.590 Vali Acc: 0.732 Test Loss: 0.590 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.539768695831299
Epoch: 6, Steps: 13 | Train Loss: 0.449 Vali Loss: 0.533 Vali Acc: 0.727 Test Loss: 0.533 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.7013964653015137
Epoch: 7, Steps: 13 | Train Loss: 0.407 Vali Loss: 0.807 Vali Acc: 0.483 Test Loss: 0.807 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.206576585769653
Epoch: 8, Steps: 13 | Train Loss: 0.418 Vali Loss: 0.518 Vali Acc: 0.741 Test Loss: 0.518 Test Acc: 0.741
Validation loss decreased (-0.741458 --> -0.741458).  Saving model ...
Epoch: 9 cost time: 4.202747821807861
Epoch: 9, Steps: 13 | Train Loss: 0.338 Vali Loss: 0.607 Vali Acc: 0.737 Test Loss: 0.607 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.3598434925079346
Epoch: 10, Steps: 13 | Train Loss: 0.508 Vali Loss: 0.571 Vali Acc: 0.698 Test Loss: 0.571 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.6269991397857666
Epoch: 11, Steps: 13 | Train Loss: 0.450 Vali Loss: 0.840 Vali Acc: 0.551 Test Loss: 0.840 Test Acc: 0.551
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.03513503074646
Epoch: 12, Steps: 13 | Train Loss: 0.346 Vali Loss: 0.585 Vali Acc: 0.732 Test Loss: 0.585 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.9576821327209473
Epoch: 13, Steps: 13 | Train Loss: 0.417 Vali Loss: 1.383 Vali Acc: 0.361 Test Loss: 1.383 Test Acc: 0.361
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.096508026123047
Epoch: 14, Steps: 13 | Train Loss: 0.623 Vali Loss: 0.903 Vali Acc: 0.737 Test Loss: 0.903 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.6136815547943115
Epoch: 15, Steps: 13 | Train Loss: 0.299 Vali Loss: 1.345 Vali Acc: 0.741 Test Loss: 1.345 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.8856234550476074
Epoch: 16, Steps: 13 | Train Loss: 0.404 Vali Loss: 0.791 Vali Acc: 0.639 Test Loss: 0.791 Test Acc: 0.639
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.2705748081207275
Epoch: 17, Steps: 13 | Train Loss: 0.200 Vali Loss: 0.738 Vali Acc: 0.727 Test Loss: 0.738 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.435988664627075
Epoch: 18, Steps: 13 | Train Loss: 0.184 Vali Loss: 0.834 Vali Acc: 0.727 Test Loss: 0.834 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 805938
model size : 4.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.263681650161743
Epoch: 1, Steps: 13 | Train Loss: 0.602 Vali Loss: 0.584 Vali Acc: 0.722 Test Loss: 0.584 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 3.9825243949890137
Epoch: 2, Steps: 13 | Train Loss: 0.741 Vali Loss: 0.830 Vali Acc: 0.722 Test Loss: 0.830 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.1369247436523438
Epoch: 3, Steps: 13 | Train Loss: 0.867 Vali Loss: 1.527 Vali Acc: 0.722 Test Loss: 1.527 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.3356032371520996
Epoch: 4, Steps: 13 | Train Loss: 1.268 Vali Loss: 1.519 Vali Acc: 0.722 Test Loss: 1.519 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.3860645294189453
Epoch: 5, Steps: 13 | Train Loss: 1.058 Vali Loss: 0.521 Vali Acc: 0.751 Test Loss: 0.521 Test Acc: 0.751
Validation loss decreased (-0.721945 --> -0.751214).  Saving model ...
Epoch: 6 cost time: 3.5794546604156494
Epoch: 6, Steps: 13 | Train Loss: 0.566 Vali Loss: 0.552 Vali Acc: 0.727 Test Loss: 0.552 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.55557656288147
Epoch: 7, Steps: 13 | Train Loss: 0.425 Vali Loss: 0.833 Vali Acc: 0.727 Test Loss: 0.833 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.6219799518585205
Epoch: 8, Steps: 13 | Train Loss: 0.473 Vali Loss: 0.592 Vali Acc: 0.741 Test Loss: 0.592 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.365959644317627
Epoch: 9, Steps: 13 | Train Loss: 0.477 Vali Loss: 1.149 Vali Acc: 0.722 Test Loss: 1.149 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.0262486934661865
Epoch: 10, Steps: 13 | Train Loss: 0.565 Vali Loss: 0.563 Vali Acc: 0.746 Test Loss: 0.563 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.746518611907959
Epoch: 11, Steps: 13 | Train Loss: 0.435 Vali Loss: 0.791 Vali Acc: 0.732 Test Loss: 0.791 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.4535603523254395
Epoch: 12, Steps: 13 | Train Loss: 0.601 Vali Loss: 1.558 Vali Acc: 0.395 Test Loss: 1.558 Test Acc: 0.395
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.099745273590088
Epoch: 13, Steps: 13 | Train Loss: 0.463 Vali Loss: 0.698 Vali Acc: 0.737 Test Loss: 0.698 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.6913459300994873
Epoch: 14, Steps: 13 | Train Loss: 0.629 Vali Loss: 2.383 Vali Acc: 0.722 Test Loss: 2.383 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.578728437423706
Epoch: 15, Steps: 13 | Train Loss: 0.666 Vali Loss: 0.705 Vali Acc: 0.644 Test Loss: 0.705 Test Acc: 0.644
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 802098
model size : 4.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.596625804901123
Epoch: 1, Steps: 13 | Train Loss: 0.715 Vali Loss: 0.712 Vali Acc: 0.722 Test Loss: 0.712 Test Acc: 0.722
Validation loss decreased (inf --> -0.721944).  Saving model ...
Epoch: 2 cost time: 2.571563959121704
Epoch: 2, Steps: 13 | Train Loss: 0.611 Vali Loss: 0.575 Vali Acc: 0.712 Test Loss: 0.575 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.77643346786499
Epoch: 3, Steps: 13 | Train Loss: 0.563 Vali Loss: 0.716 Vali Acc: 0.537 Test Loss: 0.716 Test Acc: 0.537
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.100034475326538
Epoch: 4, Steps: 13 | Train Loss: 0.620 Vali Loss: 0.549 Vali Acc: 0.727 Test Loss: 0.549 Test Acc: 0.727
Validation loss decreased (-0.721944 --> -0.726824).  Saving model ...
Epoch: 5 cost time: 3.4547200202941895
Epoch: 5, Steps: 13 | Train Loss: 0.503 Vali Loss: 0.569 Vali Acc: 0.737 Test Loss: 0.569 Test Acc: 0.737
Validation loss decreased (-0.726824 --> -0.736580).  Saving model ...
Epoch: 6 cost time: 3.0963404178619385
Epoch: 6, Steps: 13 | Train Loss: 0.528 Vali Loss: 0.780 Vali Acc: 0.722 Test Loss: 0.780 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.5391037464141846
Epoch: 7, Steps: 13 | Train Loss: 0.458 Vali Loss: 0.530 Vali Acc: 0.756 Test Loss: 0.530 Test Acc: 0.756
Validation loss decreased (-0.736580 --> -0.756092).  Saving model ...
Epoch: 8 cost time: 3.5068533420562744
Epoch: 8, Steps: 13 | Train Loss: 0.405 Vali Loss: 0.613 Vali Acc: 0.741 Test Loss: 0.613 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.584965944290161
Epoch: 9, Steps: 13 | Train Loss: 0.428 Vali Loss: 0.660 Vali Acc: 0.746 Test Loss: 0.660 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.7836966514587402
Epoch: 10, Steps: 13 | Train Loss: 0.396 Vali Loss: 0.582 Vali Acc: 0.688 Test Loss: 0.582 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.5366830825805664
Epoch: 11, Steps: 13 | Train Loss: 0.332 Vali Loss: 0.615 Vali Acc: 0.746 Test Loss: 0.615 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.4795632362365723
Epoch: 12, Steps: 13 | Train Loss: 0.282 Vali Loss: 0.576 Vali Acc: 0.712 Test Loss: 0.576 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.7337279319763184
Epoch: 13, Steps: 13 | Train Loss: 0.430 Vali Loss: 0.655 Vali Acc: 0.751 Test Loss: 0.655 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.4377219676971436
Epoch: 14, Steps: 13 | Train Loss: 0.858 Vali Loss: 1.765 Vali Acc: 0.390 Test Loss: 1.765 Test Acc: 0.390
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.030336141586304
Epoch: 15, Steps: 13 | Train Loss: 0.725 Vali Loss: 1.090 Vali Acc: 0.751 Test Loss: 1.090 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.9884889125823975
Epoch: 16, Steps: 13 | Train Loss: 0.313 Vali Loss: 1.050 Vali Acc: 0.746 Test Loss: 1.050 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.8868985176086426
Epoch: 17, Steps: 13 | Train Loss: 0.299 Vali Loss: 0.736 Vali Acc: 0.683 Test Loss: 0.736 Test Acc: 0.683
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 798258
model size : 4.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.079856872558594
Epoch: 1, Steps: 13 | Train Loss: 0.709 Vali Loss: 0.633 Vali Acc: 0.751 Test Loss: 0.633 Test Acc: 0.751
Validation loss decreased (inf --> -0.751213).  Saving model ...
Epoch: 2 cost time: 3.144181251525879
Epoch: 2, Steps: 13 | Train Loss: 0.726 Vali Loss: 0.638 Vali Acc: 0.761 Test Loss: 0.638 Test Acc: 0.761
Validation loss decreased (-0.751213 --> -0.760969).  Saving model ...
Epoch: 3 cost time: 3.5368199348449707
Epoch: 3, Steps: 13 | Train Loss: 0.574 Vali Loss: 0.543 Vali Acc: 0.722 Test Loss: 0.543 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.831127882003784
Epoch: 4, Steps: 13 | Train Loss: 0.593 Vali Loss: 0.507 Vali Acc: 0.766 Test Loss: 0.507 Test Acc: 0.766
Validation loss decreased (-0.760969 --> -0.765849).  Saving model ...
Epoch: 5 cost time: 3.5032358169555664
Epoch: 5, Steps: 13 | Train Loss: 0.577 Vali Loss: 0.493 Vali Acc: 0.785 Test Loss: 0.493 Test Acc: 0.785
Validation loss decreased (-0.765849 --> -0.785361).  Saving model ...
Epoch: 6 cost time: 3.6993002891540527
Epoch: 6, Steps: 13 | Train Loss: 0.626 Vali Loss: 0.775 Vali Acc: 0.537 Test Loss: 0.775 Test Acc: 0.537
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.0213303565979
Epoch: 7, Steps: 13 | Train Loss: 0.526 Vali Loss: 0.762 Vali Acc: 0.737 Test Loss: 0.762 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.225145578384399
Epoch: 8, Steps: 13 | Train Loss: 0.733 Vali Loss: 0.616 Vali Acc: 0.746 Test Loss: 0.616 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.638824701309204
Epoch: 9, Steps: 13 | Train Loss: 0.449 Vali Loss: 0.510 Vali Acc: 0.722 Test Loss: 0.510 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.052993059158325
Epoch: 10, Steps: 13 | Train Loss: 0.501 Vali Loss: 0.492 Vali Acc: 0.771 Test Loss: 0.492 Test Acc: 0.771
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.041295766830444
Epoch: 11, Steps: 13 | Train Loss: 0.456 Vali Loss: 0.574 Vali Acc: 0.673 Test Loss: 0.574 Test Acc: 0.673
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.8433947563171387
Epoch: 12, Steps: 13 | Train Loss: 0.476 Vali Loss: 0.536 Vali Acc: 0.741 Test Loss: 0.536 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.849363088607788
Epoch: 13, Steps: 13 | Train Loss: 0.300 Vali Loss: 0.566 Vali Acc: 0.751 Test Loss: 0.566 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.8306760787963867
Epoch: 14, Steps: 13 | Train Loss: 0.338 Vali Loss: 0.729 Vali Acc: 0.751 Test Loss: 0.729 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.9393348693847656
Epoch: 15, Steps: 13 | Train Loss: 0.485 Vali Loss: 0.600 Vali Acc: 0.756 Test Loss: 0.600 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7853658536585366
model parameter : 698354
model size : 3.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.356431007385254
Epoch: 1, Steps: 13 | Train Loss: 0.652 Vali Loss: 0.608 Vali Acc: 0.712 Test Loss: 0.608 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 3.9205400943756104
Epoch: 2, Steps: 13 | Train Loss: 0.695 Vali Loss: 0.707 Vali Acc: 0.483 Test Loss: 0.707 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.181837797164917
Epoch: 3, Steps: 13 | Train Loss: 0.742 Vali Loss: 0.608 Vali Acc: 0.732 Test Loss: 0.608 Test Acc: 0.732
Validation loss decreased (-0.712189 --> -0.731701).  Saving model ...
Epoch: 4 cost time: 4.161380290985107
Epoch: 4, Steps: 13 | Train Loss: 0.545 Vali Loss: 0.562 Vali Acc: 0.722 Test Loss: 0.562 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.9057018756866455
Epoch: 5, Steps: 13 | Train Loss: 0.533 Vali Loss: 0.546 Vali Acc: 0.722 Test Loss: 0.546 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.6766133308410645
Epoch: 6, Steps: 13 | Train Loss: 0.477 Vali Loss: 0.750 Vali Acc: 0.717 Test Loss: 0.750 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.218721389770508
Epoch: 7, Steps: 13 | Train Loss: 0.553 Vali Loss: 0.518 Vali Acc: 0.737 Test Loss: 0.518 Test Acc: 0.737
Validation loss decreased (-0.731701 --> -0.736580).  Saving model ...
Epoch: 8 cost time: 4.554300308227539
Epoch: 8, Steps: 13 | Train Loss: 0.466 Vali Loss: 0.646 Vali Acc: 0.654 Test Loss: 0.646 Test Acc: 0.654
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.1160337924957275
Epoch: 9, Steps: 13 | Train Loss: 0.555 Vali Loss: 0.552 Vali Acc: 0.707 Test Loss: 0.552 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.211596727371216
Epoch: 10, Steps: 13 | Train Loss: 0.476 Vali Loss: 0.705 Vali Acc: 0.722 Test Loss: 0.705 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.976381778717041
Epoch: 11, Steps: 13 | Train Loss: 0.665 Vali Loss: 0.706 Vali Acc: 0.615 Test Loss: 0.706 Test Acc: 0.615
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.309359550476074
Epoch: 12, Steps: 13 | Train Loss: 0.455 Vali Loss: 0.746 Vali Acc: 0.732 Test Loss: 0.746 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.1875832080841064
Epoch: 13, Steps: 13 | Train Loss: 0.485 Vali Loss: 1.661 Vali Acc: 0.322 Test Loss: 1.661 Test Acc: 0.322
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.9088501930236816
Epoch: 14, Steps: 13 | Train Loss: 0.678 Vali Loss: 0.642 Vali Acc: 0.751 Test Loss: 0.642 Test Acc: 0.751
Validation loss decreased (-0.736580 --> -0.751213).  Saving model ...
Epoch: 15 cost time: 4.012513637542725
Epoch: 15, Steps: 13 | Train Loss: 0.340 Vali Loss: 1.302 Vali Acc: 0.390 Test Loss: 1.302 Test Acc: 0.390
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.032592535018921
Epoch: 16, Steps: 13 | Train Loss: 0.491 Vali Loss: 1.065 Vali Acc: 0.727 Test Loss: 1.065 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.054819345474243
Epoch: 17, Steps: 13 | Train Loss: 0.428 Vali Loss: 0.698 Vali Acc: 0.659 Test Loss: 0.698 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.453900098800659
Epoch: 18, Steps: 13 | Train Loss: 0.299 Vali Loss: 1.013 Vali Acc: 0.551 Test Loss: 1.013 Test Acc: 0.551
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.526372194290161
Epoch: 19, Steps: 13 | Train Loss: 0.217 Vali Loss: 0.784 Vali Acc: 0.605 Test Loss: 0.784 Test Acc: 0.605
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.227372884750366
Epoch: 20, Steps: 13 | Train Loss: 0.160 Vali Loss: 0.783 Vali Acc: 0.644 Test Loss: 0.783 Test Acc: 0.644
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.0902316570281982
Epoch: 21, Steps: 13 | Train Loss: 0.350 Vali Loss: 0.782 Vali Acc: 0.741 Test Loss: 0.782 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.3246469497680664
Epoch: 22, Steps: 13 | Train Loss: 0.170 Vali Loss: 0.833 Vali Acc: 0.732 Test Loss: 0.833 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.010152339935303
Epoch: 23, Steps: 13 | Train Loss: 0.279 Vali Loss: 1.883 Vali Acc: 0.463 Test Loss: 1.883 Test Acc: 0.463
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.5627965927124023
Epoch: 24, Steps: 13 | Train Loss: 0.349 Vali Loss: 0.751 Vali Acc: 0.678 Test Loss: 0.751 Test Acc: 0.678
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 696434
model size : 3.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.601472616195679
Epoch: 1, Steps: 13 | Train Loss: 0.710 Vali Loss: 0.588 Vali Acc: 0.717 Test Loss: 0.588 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 4.148456573486328
Epoch: 2, Steps: 13 | Train Loss: 0.637 Vali Loss: 0.601 Vali Acc: 0.722 Test Loss: 0.601 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 4.039828062057495
Epoch: 3, Steps: 13 | Train Loss: 0.644 Vali Loss: 0.649 Vali Acc: 0.722 Test Loss: 0.649 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.231690406799316
Epoch: 4, Steps: 13 | Train Loss: 0.883 Vali Loss: 0.591 Vali Acc: 0.722 Test Loss: 0.591 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 5 cost time: 4.293018341064453
Epoch: 5, Steps: 13 | Train Loss: 0.644 Vali Loss: 0.552 Vali Acc: 0.727 Test Loss: 0.552 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726824).  Saving model ...
Epoch: 6 cost time: 2.9636850357055664
Epoch: 6, Steps: 13 | Train Loss: 0.592 Vali Loss: 0.592 Vali Acc: 0.727 Test Loss: 0.592 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.6643524169921875
Epoch: 7, Steps: 13 | Train Loss: 0.865 Vali Loss: 1.089 Vali Acc: 0.722 Test Loss: 1.089 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.153233289718628
Epoch: 8, Steps: 13 | Train Loss: 0.815 Vali Loss: 0.697 Vali Acc: 0.732 Test Loss: 0.697 Test Acc: 0.732
Validation loss decreased (-0.726824 --> -0.731700).  Saving model ...
Epoch: 9 cost time: 3.7269973754882812
Epoch: 9, Steps: 13 | Train Loss: 0.568 Vali Loss: 0.556 Vali Acc: 0.702 Test Loss: 0.556 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.060346364974976
Epoch: 10, Steps: 13 | Train Loss: 0.461 Vali Loss: 0.557 Vali Acc: 0.678 Test Loss: 0.557 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.9273319244384766
Epoch: 11, Steps: 13 | Train Loss: 0.499 Vali Loss: 0.853 Vali Acc: 0.732 Test Loss: 0.853 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.6480422019958496
Epoch: 12, Steps: 13 | Train Loss: 0.492 Vali Loss: 0.657 Vali Acc: 0.624 Test Loss: 0.657 Test Acc: 0.624
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.705990791320801
Epoch: 13, Steps: 13 | Train Loss: 0.360 Vali Loss: 0.565 Vali Acc: 0.698 Test Loss: 0.565 Test Acc: 0.698
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.570714235305786
Epoch: 14, Steps: 13 | Train Loss: 0.408 Vali Loss: 0.568 Vali Acc: 0.771 Test Loss: 0.568 Test Acc: 0.771
Validation loss decreased (-0.731700 --> -0.770726).  Saving model ...
Epoch: 15 cost time: 3.0884768962860107
Epoch: 15, Steps: 13 | Train Loss: 0.424 Vali Loss: 0.739 Vali Acc: 0.737 Test Loss: 0.739 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.5611653327941895
Epoch: 16, Steps: 13 | Train Loss: 0.398 Vali Loss: 0.596 Vali Acc: 0.732 Test Loss: 0.596 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.8665671348571777
Epoch: 17, Steps: 13 | Train Loss: 0.472 Vali Loss: 0.976 Vali Acc: 0.737 Test Loss: 0.976 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.868527412414551
Epoch: 18, Steps: 13 | Train Loss: 0.294 Vali Loss: 1.675 Vali Acc: 0.376 Test Loss: 1.675 Test Acc: 0.376
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.990553855895996
Epoch: 19, Steps: 13 | Train Loss: 0.285 Vali Loss: 1.067 Vali Acc: 0.737 Test Loss: 1.067 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.3678462505340576
Epoch: 20, Steps: 13 | Train Loss: 0.387 Vali Loss: 2.197 Vali Acc: 0.356 Test Loss: 2.197 Test Acc: 0.356
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.388319492340088
Epoch: 21, Steps: 13 | Train Loss: 0.296 Vali Loss: 0.911 Vali Acc: 0.737 Test Loss: 0.911 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.2705931663513184
Epoch: 22, Steps: 13 | Train Loss: 0.314 Vali Loss: 0.972 Vali Acc: 0.576 Test Loss: 0.972 Test Acc: 0.576
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.457319974899292
Epoch: 23, Steps: 13 | Train Loss: 0.419 Vali Loss: 1.148 Vali Acc: 0.541 Test Loss: 1.148 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.546988010406494
Epoch: 24, Steps: 13 | Train Loss: 0.182 Vali Loss: 0.873 Vali Acc: 0.741 Test Loss: 0.873 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 694514
model size : 3.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.711370944976807
Epoch: 1, Steps: 13 | Train Loss: 0.777 Vali Loss: 1.439 Vali Acc: 0.278 Test Loss: 1.439 Test Acc: 0.278
Validation loss decreased (inf --> -0.278034).  Saving model ...
Epoch: 2 cost time: 3.781858444213867
Epoch: 2, Steps: 13 | Train Loss: 0.840 Vali Loss: 0.606 Vali Acc: 0.717 Test Loss: 0.606 Test Acc: 0.717
Validation loss decreased (-0.278034 --> -0.717067).  Saving model ...
Epoch: 3 cost time: 3.92828631401062
Epoch: 3, Steps: 13 | Train Loss: 1.068 Vali Loss: 0.658 Vali Acc: 0.722 Test Loss: 0.658 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721945).  Saving model ...
Epoch: 4 cost time: 3.5188491344451904
Epoch: 4, Steps: 13 | Train Loss: 0.573 Vali Loss: 0.697 Vali Acc: 0.722 Test Loss: 0.697 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.9566304683685303
Epoch: 5, Steps: 13 | Train Loss: 0.615 Vali Loss: 0.665 Vali Acc: 0.590 Test Loss: 0.665 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.6653881072998047
Epoch: 6, Steps: 13 | Train Loss: 0.596 Vali Loss: 0.849 Vali Acc: 0.722 Test Loss: 0.849 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.6681323051452637
Epoch: 7, Steps: 13 | Train Loss: 0.619 Vali Loss: 0.927 Vali Acc: 0.722 Test Loss: 0.927 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.6231470108032227
Epoch: 8, Steps: 13 | Train Loss: 0.639 Vali Loss: 0.550 Vali Acc: 0.727 Test Loss: 0.550 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726824).  Saving model ...
Epoch: 9 cost time: 3.825651168823242
Epoch: 9, Steps: 13 | Train Loss: 0.422 Vali Loss: 0.768 Vali Acc: 0.537 Test Loss: 0.768 Test Acc: 0.537
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.230945587158203
Epoch: 10, Steps: 13 | Train Loss: 0.570 Vali Loss: 0.786 Vali Acc: 0.732 Test Loss: 0.786 Test Acc: 0.732
Validation loss decreased (-0.726824 --> -0.731699).  Saving model ...
Epoch: 11 cost time: 3.445101261138916
Epoch: 11, Steps: 13 | Train Loss: 0.697 Vali Loss: 0.937 Vali Acc: 0.732 Test Loss: 0.937 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.73398494720459
Epoch: 12, Steps: 13 | Train Loss: 0.400 Vali Loss: 0.601 Vali Acc: 0.644 Test Loss: 0.601 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.5730953216552734
Epoch: 13, Steps: 13 | Train Loss: 0.799 Vali Loss: 0.680 Vali Acc: 0.741 Test Loss: 0.680 Test Acc: 0.741
Validation loss decreased (-0.731699 --> -0.741457).  Saving model ...
Epoch: 14 cost time: 3.569098472595215
Epoch: 14, Steps: 13 | Train Loss: 0.609 Vali Loss: 0.543 Vali Acc: 0.741 Test Loss: 0.543 Test Acc: 0.741
Validation loss decreased (-0.741457 --> -0.741458).  Saving model ...
Epoch: 15 cost time: 4.015106439590454
Epoch: 15, Steps: 13 | Train Loss: 0.724 Vali Loss: 1.328 Vali Acc: 0.449 Test Loss: 1.328 Test Acc: 0.449
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.639066219329834
Epoch: 16, Steps: 13 | Train Loss: 0.502 Vali Loss: 1.063 Vali Acc: 0.732 Test Loss: 1.063 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.7435460090637207
Epoch: 17, Steps: 13 | Train Loss: 0.403 Vali Loss: 0.695 Vali Acc: 0.751 Test Loss: 0.695 Test Acc: 0.751
Validation loss decreased (-0.741458 --> -0.751213).  Saving model ...
Epoch: 18 cost time: 3.360740900039673
Epoch: 18, Steps: 13 | Train Loss: 0.448 Vali Loss: 1.079 Vali Acc: 0.527 Test Loss: 1.079 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.390016555786133
Epoch: 19, Steps: 13 | Train Loss: 0.482 Vali Loss: 0.628 Vali Acc: 0.693 Test Loss: 0.628 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.1192822456359863
Epoch: 20, Steps: 13 | Train Loss: 0.239 Vali Loss: 0.662 Vali Acc: 0.712 Test Loss: 0.662 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.9368624687194824
Epoch: 21, Steps: 13 | Train Loss: 0.186 Vali Loss: 0.679 Vali Acc: 0.693 Test Loss: 0.679 Test Acc: 0.693
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.07614278793335
Epoch: 22, Steps: 13 | Train Loss: 0.274 Vali Loss: 0.687 Vali Acc: 0.663 Test Loss: 0.687 Test Acc: 0.663
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.8378746509552
Epoch: 23, Steps: 13 | Train Loss: 0.216 Vali Loss: 0.847 Vali Acc: 0.771 Test Loss: 0.847 Test Acc: 0.771
Validation loss decreased (-0.751213 --> -0.770723).  Saving model ...
Epoch: 24 cost time: 3.9797475337982178
Epoch: 24, Steps: 13 | Train Loss: 0.113 Vali Loss: 0.938 Vali Acc: 0.571 Test Loss: 0.938 Test Acc: 0.571
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.8269588947296143
Epoch: 25, Steps: 13 | Train Loss: 0.156 Vali Loss: 0.815 Vali Acc: 0.659 Test Loss: 0.815 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.7428479194641113
Epoch: 26, Steps: 13 | Train Loss: 0.142 Vali Loss: 0.859 Vali Acc: 0.741 Test Loss: 0.859 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 4.03334379196167
Epoch: 27, Steps: 13 | Train Loss: 0.077 Vali Loss: 0.834 Vali Acc: 0.702 Test Loss: 0.834 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.273895263671875
Epoch: 28, Steps: 13 | Train Loss: 0.073 Vali Loss: 0.967 Vali Acc: 0.766 Test Loss: 0.967 Test Acc: 0.766
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.561908483505249
Epoch: 29, Steps: 13 | Train Loss: 0.079 Vali Loss: 1.054 Vali Acc: 0.600 Test Loss: 1.054 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.811275005340576
Epoch: 30, Steps: 13 | Train Loss: 0.073 Vali Loss: 0.911 Vali Acc: 0.707 Test Loss: 0.911 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 4.009936332702637
Epoch: 31, Steps: 13 | Train Loss: 0.039 Vali Loss: 0.936 Vali Acc: 0.683 Test Loss: 0.936 Test Acc: 0.683
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 3.536940336227417
Epoch: 32, Steps: 13 | Train Loss: 0.035 Vali Loss: 1.015 Vali Acc: 0.707 Test Loss: 1.015 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 3.5509955883026123
Epoch: 33, Steps: 13 | Train Loss: 0.040 Vali Loss: 1.411 Vali Acc: 0.561 Test Loss: 1.411 Test Acc: 0.561
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 692594
model size : 3.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.994263172149658
Epoch: 1, Steps: 13 | Train Loss: 0.679 Vali Loss: 0.735 Vali Acc: 0.298 Test Loss: 0.735 Test Acc: 0.298
Validation loss decreased (inf --> -0.297554).  Saving model ...
Epoch: 2 cost time: 3.238384246826172
Epoch: 2, Steps: 13 | Train Loss: 0.851 Vali Loss: 0.871 Vali Acc: 0.722 Test Loss: 0.871 Test Acc: 0.722
Validation loss decreased (-0.297554 --> -0.721943).  Saving model ...
Epoch: 3 cost time: 3.206597328186035
Epoch: 3, Steps: 13 | Train Loss: 0.701 Vali Loss: 0.933 Vali Acc: 0.722 Test Loss: 0.933 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.288395404815674
Epoch: 4, Steps: 13 | Train Loss: 0.705 Vali Loss: 0.921 Vali Acc: 0.722 Test Loss: 0.921 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.1982333660125732
Epoch: 5, Steps: 13 | Train Loss: 0.615 Vali Loss: 0.668 Vali Acc: 0.722 Test Loss: 0.668 Test Acc: 0.722
Validation loss decreased (-0.721943 --> -0.721945).  Saving model ...
Epoch: 6 cost time: 3.4674251079559326
Epoch: 6, Steps: 13 | Train Loss: 0.558 Vali Loss: 0.650 Vali Acc: 0.717 Test Loss: 0.650 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.9885659217834473
Epoch: 7, Steps: 13 | Train Loss: 0.540 Vali Loss: 0.607 Vali Acc: 0.727 Test Loss: 0.607 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726823).  Saving model ...
Epoch: 8 cost time: 4.133444547653198
Epoch: 8, Steps: 13 | Train Loss: 0.733 Vali Loss: 0.770 Vali Acc: 0.722 Test Loss: 0.770 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.5324604511260986
Epoch: 9, Steps: 13 | Train Loss: 0.550 Vali Loss: 0.537 Vali Acc: 0.698 Test Loss: 0.537 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.089197635650635
Epoch: 10, Steps: 13 | Train Loss: 0.525 Vali Loss: 0.560 Vali Acc: 0.766 Test Loss: 0.560 Test Acc: 0.766
Validation loss decreased (-0.726823 --> -0.765848).  Saving model ...
Epoch: 11 cost time: 3.833522081375122
Epoch: 11, Steps: 13 | Train Loss: 0.376 Vali Loss: 1.231 Vali Acc: 0.361 Test Loss: 1.231 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.6806397438049316
Epoch: 12, Steps: 13 | Train Loss: 0.880 Vali Loss: 0.776 Vali Acc: 0.566 Test Loss: 0.776 Test Acc: 0.566
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.479952812194824
Epoch: 13, Steps: 13 | Train Loss: 0.620 Vali Loss: 1.006 Vali Acc: 0.722 Test Loss: 1.006 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.364147663116455
Epoch: 14, Steps: 13 | Train Loss: 0.773 Vali Loss: 1.431 Vali Acc: 0.707 Test Loss: 1.431 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.060088872909546
Epoch: 15, Steps: 13 | Train Loss: 0.959 Vali Loss: 1.287 Vali Acc: 0.722 Test Loss: 1.287 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.639754056930542
Epoch: 16, Steps: 13 | Train Loss: 0.652 Vali Loss: 1.002 Vali Acc: 0.478 Test Loss: 1.002 Test Acc: 0.478
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.3795082569122314
Epoch: 17, Steps: 13 | Train Loss: 0.573 Vali Loss: 0.542 Vali Acc: 0.751 Test Loss: 0.542 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.7073793411254883
Epoch: 18, Steps: 13 | Train Loss: 0.354 Vali Loss: 0.584 Vali Acc: 0.756 Test Loss: 0.584 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.1447298526763916
Epoch: 19, Steps: 13 | Train Loss: 0.252 Vali Loss: 0.626 Vali Acc: 0.741 Test Loss: 0.626 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.605896234512329
Epoch: 20, Steps: 13 | Train Loss: 0.236 Vali Loss: 0.901 Vali Acc: 0.751 Test Loss: 0.901 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 465394
model size : 2.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.372148036956787
Epoch: 1, Steps: 13 | Train Loss: 0.661 Vali Loss: 0.648 Vali Acc: 0.727 Test Loss: 0.648 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 3.551909923553467
Epoch: 2, Steps: 13 | Train Loss: 0.688 Vali Loss: 0.726 Vali Acc: 0.341 Test Loss: 0.726 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.3635993003845215
Epoch: 3, Steps: 13 | Train Loss: 0.683 Vali Loss: 0.561 Vali Acc: 0.722 Test Loss: 0.561 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.586742639541626
Epoch: 4, Steps: 13 | Train Loss: 0.553 Vali Loss: 0.626 Vali Acc: 0.722 Test Loss: 0.626 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.9724552631378174
Epoch: 5, Steps: 13 | Train Loss: 0.726 Vali Loss: 0.695 Vali Acc: 0.551 Test Loss: 0.695 Test Acc: 0.551
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.5586342811584473
Epoch: 6, Steps: 13 | Train Loss: 0.636 Vali Loss: 0.577 Vali Acc: 0.717 Test Loss: 0.577 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.545339584350586
Epoch: 7, Steps: 13 | Train Loss: 0.532 Vali Loss: 0.527 Vali Acc: 0.732 Test Loss: 0.527 Test Acc: 0.732
Validation loss decreased (-0.726823 --> -0.731702).  Saving model ...
Epoch: 8 cost time: 3.6886794567108154
Epoch: 8, Steps: 13 | Train Loss: 0.509 Vali Loss: 0.508 Vali Acc: 0.756 Test Loss: 0.508 Test Acc: 0.756
Validation loss decreased (-0.731702 --> -0.756092).  Saving model ...
Epoch: 9 cost time: 3.6057822704315186
Epoch: 9, Steps: 13 | Train Loss: 0.424 Vali Loss: 0.532 Vali Acc: 0.746 Test Loss: 0.532 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.529103994369507
Epoch: 10, Steps: 13 | Train Loss: 0.449 Vali Loss: 1.528 Vali Acc: 0.302 Test Loss: 1.528 Test Acc: 0.302
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.705498695373535
Epoch: 11, Steps: 13 | Train Loss: 0.578 Vali Loss: 0.562 Vali Acc: 0.746 Test Loss: 0.562 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.6496126651763916
Epoch: 12, Steps: 13 | Train Loss: 0.424 Vali Loss: 0.625 Vali Acc: 0.751 Test Loss: 0.625 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.4984467029571533
Epoch: 13, Steps: 13 | Train Loss: 0.527 Vali Loss: 2.220 Vali Acc: 0.322 Test Loss: 2.220 Test Acc: 0.322
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.317948579788208
Epoch: 14, Steps: 13 | Train Loss: 0.883 Vali Loss: 0.679 Vali Acc: 0.644 Test Loss: 0.679 Test Acc: 0.644
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.959688425064087
Epoch: 15, Steps: 13 | Train Loss: 0.344 Vali Loss: 0.627 Vali Acc: 0.663 Test Loss: 0.627 Test Acc: 0.663
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.8769092559814453
Epoch: 16, Steps: 13 | Train Loss: 0.339 Vali Loss: 1.053 Vali Acc: 0.463 Test Loss: 1.053 Test Acc: 0.463
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.390510320663452
Epoch: 17, Steps: 13 | Train Loss: 0.398 Vali Loss: 1.026 Vali Acc: 0.732 Test Loss: 1.026 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.9002206325531006
Epoch: 18, Steps: 13 | Train Loss: 0.359 Vali Loss: 0.620 Vali Acc: 0.712 Test Loss: 0.620 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 463474
model size : 2.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.29165244102478
Epoch: 1, Steps: 13 | Train Loss: 0.736 Vali Loss: 0.592 Vali Acc: 0.722 Test Loss: 0.592 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 3.354565143585205
Epoch: 2, Steps: 13 | Train Loss: 0.592 Vali Loss: 0.564 Vali Acc: 0.722 Test Loss: 0.564 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721946).  Saving model ...
Epoch: 3 cost time: 2.7171928882598877
Epoch: 3, Steps: 13 | Train Loss: 0.575 Vali Loss: 0.692 Vali Acc: 0.722 Test Loss: 0.692 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.3975818157196045
Epoch: 4, Steps: 13 | Train Loss: 0.524 Vali Loss: 0.529 Vali Acc: 0.737 Test Loss: 0.529 Test Acc: 0.737
Validation loss decreased (-0.721946 --> -0.736580).  Saving model ...
Epoch: 5 cost time: 3.2605209350585938
Epoch: 5, Steps: 13 | Train Loss: 0.517 Vali Loss: 0.524 Vali Acc: 0.741 Test Loss: 0.524 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741458).  Saving model ...
Epoch: 6 cost time: 2.863773822784424
Epoch: 6, Steps: 13 | Train Loss: 0.529 Vali Loss: 0.989 Vali Acc: 0.722 Test Loss: 0.989 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.826185703277588
Epoch: 7, Steps: 13 | Train Loss: 0.528 Vali Loss: 0.558 Vali Acc: 0.678 Test Loss: 0.558 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.5501933097839355
Epoch: 8, Steps: 13 | Train Loss: 0.450 Vali Loss: 0.524 Vali Acc: 0.737 Test Loss: 0.524 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.4192023277282715
Epoch: 9, Steps: 13 | Train Loss: 0.422 Vali Loss: 0.515 Vali Acc: 0.756 Test Loss: 0.515 Test Acc: 0.756
Validation loss decreased (-0.741458 --> -0.756092).  Saving model ...
Epoch: 10 cost time: 3.010802984237671
Epoch: 10, Steps: 13 | Train Loss: 0.327 Vali Loss: 0.537 Vali Acc: 0.751 Test Loss: 0.537 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.397853374481201
Epoch: 11, Steps: 13 | Train Loss: 0.382 Vali Loss: 0.559 Vali Acc: 0.761 Test Loss: 0.559 Test Acc: 0.761
Validation loss decreased (-0.756092 --> -0.760970).  Saving model ...
Epoch: 12 cost time: 3.540602684020996
Epoch: 12, Steps: 13 | Train Loss: 0.335 Vali Loss: 0.675 Vali Acc: 0.615 Test Loss: 0.675 Test Acc: 0.615
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.3405966758728027
Epoch: 13, Steps: 13 | Train Loss: 0.320 Vali Loss: 0.590 Vali Acc: 0.732 Test Loss: 0.590 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.6415839195251465
Epoch: 14, Steps: 13 | Train Loss: 0.386 Vali Loss: 0.664 Vali Acc: 0.751 Test Loss: 0.664 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.201751708984375
Epoch: 15, Steps: 13 | Train Loss: 0.252 Vali Loss: 0.770 Vali Acc: 0.756 Test Loss: 0.770 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.354513645172119
Epoch: 16, Steps: 13 | Train Loss: 0.243 Vali Loss: 0.816 Vali Acc: 0.751 Test Loss: 0.816 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.098539352416992
Epoch: 17, Steps: 13 | Train Loss: 0.193 Vali Loss: 0.812 Vali Acc: 0.746 Test Loss: 0.812 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.051548004150391
Epoch: 18, Steps: 13 | Train Loss: 0.226 Vali Loss: 0.700 Vali Acc: 0.717 Test Loss: 0.700 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.748074769973755
Epoch: 19, Steps: 13 | Train Loss: 0.331 Vali Loss: 0.764 Vali Acc: 0.678 Test Loss: 0.764 Test Acc: 0.678
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.9130303859710693
Epoch: 20, Steps: 13 | Train Loss: 0.147 Vali Loss: 0.815 Vali Acc: 0.727 Test Loss: 0.815 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.7350471019744873
Epoch: 21, Steps: 13 | Train Loss: 0.227 Vali Loss: 1.114 Vali Acc: 0.561 Test Loss: 1.114 Test Acc: 0.561
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 461554
model size : 2.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.425923824310303
Epoch: 1, Steps: 13 | Train Loss: 0.620 Vali Loss: 0.603 Vali Acc: 0.722 Test Loss: 0.603 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 3.704671621322632
Epoch: 2, Steps: 13 | Train Loss: 0.619 Vali Loss: 0.678 Vali Acc: 0.722 Test Loss: 0.678 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.654958724975586
Epoch: 3, Steps: 13 | Train Loss: 0.619 Vali Loss: 0.705 Vali Acc: 0.722 Test Loss: 0.705 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.317930221557617
Epoch: 4, Steps: 13 | Train Loss: 0.565 Vali Loss: 0.577 Vali Acc: 0.712 Test Loss: 0.577 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.2210307121276855
Epoch: 5, Steps: 13 | Train Loss: 0.702 Vali Loss: 0.914 Vali Acc: 0.722 Test Loss: 0.914 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.460862159729004
Epoch: 6, Steps: 13 | Train Loss: 0.708 Vali Loss: 0.546 Vali Acc: 0.722 Test Loss: 0.546 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721946).  Saving model ...
Epoch: 7 cost time: 2.6326615810394287
Epoch: 7, Steps: 13 | Train Loss: 0.596 Vali Loss: 0.509 Vali Acc: 0.751 Test Loss: 0.509 Test Acc: 0.751
Validation loss decreased (-0.721946 --> -0.751214).  Saving model ...
Epoch: 8 cost time: 2.5490758419036865
Epoch: 8, Steps: 13 | Train Loss: 0.451 Vali Loss: 0.639 Vali Acc: 0.722 Test Loss: 0.639 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.4682517051696777
Epoch: 9, Steps: 13 | Train Loss: 0.455 Vali Loss: 0.510 Vali Acc: 0.766 Test Loss: 0.510 Test Acc: 0.766
Validation loss decreased (-0.751214 --> -0.765849).  Saving model ...
Epoch: 10 cost time: 2.4846553802490234
Epoch: 10, Steps: 13 | Train Loss: 0.398 Vali Loss: 0.599 Vali Acc: 0.659 Test Loss: 0.599 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.4516167640686035
Epoch: 11, Steps: 13 | Train Loss: 0.336 Vali Loss: 1.162 Vali Acc: 0.722 Test Loss: 1.162 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.8130695819854736
Epoch: 12, Steps: 13 | Train Loss: 0.425 Vali Loss: 0.529 Vali Acc: 0.722 Test Loss: 0.529 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.450808048248291
Epoch: 13, Steps: 13 | Train Loss: 0.296 Vali Loss: 0.666 Vali Acc: 0.732 Test Loss: 0.666 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.245917558670044
Epoch: 14, Steps: 13 | Train Loss: 0.853 Vali Loss: 1.010 Vali Acc: 0.727 Test Loss: 1.010 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.7193567752838135
Epoch: 15, Steps: 13 | Train Loss: 0.491 Vali Loss: 0.704 Vali Acc: 0.624 Test Loss: 0.704 Test Acc: 0.624
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.608064889907837
Epoch: 16, Steps: 13 | Train Loss: 0.327 Vali Loss: 0.584 Vali Acc: 0.712 Test Loss: 0.584 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.5875346660614014
Epoch: 17, Steps: 13 | Train Loss: 0.346 Vali Loss: 0.631 Vali Acc: 0.746 Test Loss: 0.631 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.580374240875244
Epoch: 18, Steps: 13 | Train Loss: 0.303 Vali Loss: 0.624 Vali Acc: 0.683 Test Loss: 0.624 Test Acc: 0.683
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.7802937030792236
Epoch: 19, Steps: 13 | Train Loss: 0.219 Vali Loss: 0.642 Vali Acc: 0.702 Test Loss: 0.642 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 459634
model size : 2.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.01682710647583
Epoch: 1, Steps: 13 | Train Loss: 0.747 Vali Loss: 0.598 Vali Acc: 0.722 Test Loss: 0.598 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 3.2008981704711914
Epoch: 2, Steps: 13 | Train Loss: 0.622 Vali Loss: 0.589 Vali Acc: 0.717 Test Loss: 0.589 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.7552406787872314
Epoch: 3, Steps: 13 | Train Loss: 0.688 Vali Loss: 0.621 Vali Acc: 0.756 Test Loss: 0.621 Test Acc: 0.756
Validation loss decreased (-0.721945 --> -0.756091).  Saving model ...
Epoch: 4 cost time: 3.697218894958496
Epoch: 4, Steps: 13 | Train Loss: 0.729 Vali Loss: 0.575 Vali Acc: 0.717 Test Loss: 0.575 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.243590831756592
Epoch: 5, Steps: 13 | Train Loss: 0.546 Vali Loss: 0.557 Vali Acc: 0.727 Test Loss: 0.557 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.1963956356048584
Epoch: 6, Steps: 13 | Train Loss: 0.533 Vali Loss: 0.519 Vali Acc: 0.761 Test Loss: 0.519 Test Acc: 0.761
Validation loss decreased (-0.756091 --> -0.760970).  Saving model ...
Epoch: 7 cost time: 2.6425976753234863
Epoch: 7, Steps: 13 | Train Loss: 0.553 Vali Loss: 0.555 Vali Acc: 0.737 Test Loss: 0.555 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.0651631355285645
Epoch: 8, Steps: 13 | Train Loss: 0.467 Vali Loss: 0.505 Vali Acc: 0.756 Test Loss: 0.505 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.395289659500122
Epoch: 9, Steps: 13 | Train Loss: 0.431 Vali Loss: 0.507 Vali Acc: 0.746 Test Loss: 0.507 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.958331823348999
Epoch: 10, Steps: 13 | Train Loss: 0.610 Vali Loss: 1.333 Vali Acc: 0.722 Test Loss: 1.333 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.982069969177246
Epoch: 11, Steps: 13 | Train Loss: 0.689 Vali Loss: 0.634 Vali Acc: 0.751 Test Loss: 0.634 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.6102137565612793
Epoch: 12, Steps: 13 | Train Loss: 0.437 Vali Loss: 0.638 Vali Acc: 0.737 Test Loss: 0.638 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.4265120029449463
Epoch: 13, Steps: 13 | Train Loss: 0.382 Vali Loss: 0.523 Vali Acc: 0.722 Test Loss: 0.523 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.2085189819335938
Epoch: 14, Steps: 13 | Train Loss: 0.540 Vali Loss: 0.891 Vali Acc: 0.727 Test Loss: 0.891 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.544001340866089
Epoch: 15, Steps: 13 | Train Loss: 0.357 Vali Loss: 0.629 Vali Acc: 0.737 Test Loss: 0.629 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.422398090362549
Epoch: 16, Steps: 13 | Train Loss: 0.351 Vali Loss: 0.959 Vali Acc: 0.522 Test Loss: 0.959 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 348914
model size : 2.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.139001131057739
Epoch: 1, Steps: 13 | Train Loss: 0.676 Vali Loss: 0.593 Vali Acc: 0.722 Test Loss: 0.593 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 3.1583988666534424
Epoch: 2, Steps: 13 | Train Loss: 0.628 Vali Loss: 0.591 Vali Acc: 0.717 Test Loss: 0.591 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.8382625579833984
Epoch: 3, Steps: 13 | Train Loss: 0.620 Vali Loss: 0.680 Vali Acc: 0.717 Test Loss: 0.680 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.218708038330078
Epoch: 4, Steps: 13 | Train Loss: 0.581 Vali Loss: 0.569 Vali Acc: 0.717 Test Loss: 0.569 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.1998178958892822
Epoch: 5, Steps: 13 | Train Loss: 0.599 Vali Loss: 0.571 Vali Acc: 0.751 Test Loss: 0.571 Test Acc: 0.751
Validation loss decreased (-0.721945 --> -0.751214).  Saving model ...
Epoch: 6 cost time: 3.716895818710327
Epoch: 6, Steps: 13 | Train Loss: 0.559 Vali Loss: 0.685 Vali Acc: 0.712 Test Loss: 0.685 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.639514446258545
Epoch: 7, Steps: 13 | Train Loss: 0.614 Vali Loss: 0.857 Vali Acc: 0.722 Test Loss: 0.857 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.870626926422119
Epoch: 8, Steps: 13 | Train Loss: 0.665 Vali Loss: 0.784 Vali Acc: 0.444 Test Loss: 0.784 Test Acc: 0.444
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.8881914615631104
Epoch: 9, Steps: 13 | Train Loss: 0.527 Vali Loss: 0.923 Vali Acc: 0.722 Test Loss: 0.923 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.683461904525757
Epoch: 10, Steps: 13 | Train Loss: 0.668 Vali Loss: 0.712 Vali Acc: 0.732 Test Loss: 0.712 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.736151933670044
Epoch: 11, Steps: 13 | Train Loss: 0.452 Vali Loss: 0.615 Vali Acc: 0.737 Test Loss: 0.615 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.348748207092285
Epoch: 12, Steps: 13 | Train Loss: 0.373 Vali Loss: 0.625 Vali Acc: 0.620 Test Loss: 0.625 Test Acc: 0.620
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.448007345199585
Epoch: 13, Steps: 13 | Train Loss: 0.385 Vali Loss: 0.561 Vali Acc: 0.727 Test Loss: 0.561 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.258328914642334
Epoch: 14, Steps: 13 | Train Loss: 0.477 Vali Loss: 0.694 Vali Acc: 0.615 Test Loss: 0.694 Test Acc: 0.615
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.45585036277771
Epoch: 15, Steps: 13 | Train Loss: 0.398 Vali Loss: 0.602 Vali Acc: 0.654 Test Loss: 0.602 Test Acc: 0.654
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 346994
model size : 2.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.682360410690308
Epoch: 1, Steps: 13 | Train Loss: 0.632 Vali Loss: 0.606 Vali Acc: 0.722 Test Loss: 0.606 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 3.77805495262146
Epoch: 2, Steps: 13 | Train Loss: 0.640 Vali Loss: 0.733 Vali Acc: 0.722 Test Loss: 0.733 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.207951545715332
Epoch: 3, Steps: 13 | Train Loss: 0.647 Vali Loss: 0.631 Vali Acc: 0.722 Test Loss: 0.631 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.4985573291778564
Epoch: 4, Steps: 13 | Train Loss: 0.651 Vali Loss: 0.556 Vali Acc: 0.727 Test Loss: 0.556 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726824).  Saving model ...
Epoch: 5 cost time: 3.757697343826294
Epoch: 5, Steps: 13 | Train Loss: 0.637 Vali Loss: 0.754 Vali Acc: 0.712 Test Loss: 0.754 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.772169351577759
Epoch: 6, Steps: 13 | Train Loss: 0.783 Vali Loss: 0.596 Vali Acc: 0.732 Test Loss: 0.596 Test Acc: 0.732
Validation loss decreased (-0.726824 --> -0.731701).  Saving model ...
Epoch: 7 cost time: 4.05280613899231
Epoch: 7, Steps: 13 | Train Loss: 0.500 Vali Loss: 0.764 Vali Acc: 0.722 Test Loss: 0.764 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.85095477104187
Epoch: 8, Steps: 13 | Train Loss: 0.516 Vali Loss: 0.535 Vali Acc: 0.746 Test Loss: 0.535 Test Acc: 0.746
Validation loss decreased (-0.731701 --> -0.746336).  Saving model ...
Epoch: 9 cost time: 3.782702684402466
Epoch: 9, Steps: 13 | Train Loss: 0.513 Vali Loss: 0.534 Vali Acc: 0.727 Test Loss: 0.534 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.940452814102173
Epoch: 10, Steps: 13 | Train Loss: 0.494 Vali Loss: 0.618 Vali Acc: 0.737 Test Loss: 0.618 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.793968915939331
Epoch: 11, Steps: 13 | Train Loss: 0.479 Vali Loss: 0.642 Vali Acc: 0.649 Test Loss: 0.642 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.197082042694092
Epoch: 12, Steps: 13 | Train Loss: 0.442 Vali Loss: 0.667 Vali Acc: 0.722 Test Loss: 0.667 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.166841983795166
Epoch: 13, Steps: 13 | Train Loss: 0.350 Vali Loss: 0.580 Vali Acc: 0.717 Test Loss: 0.580 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.905022621154785
Epoch: 14, Steps: 13 | Train Loss: 0.450 Vali Loss: 0.807 Vali Acc: 0.727 Test Loss: 0.807 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.86098051071167
Epoch: 15, Steps: 13 | Train Loss: 0.420 Vali Loss: 0.615 Vali Acc: 0.693 Test Loss: 0.615 Test Acc: 0.693
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.083197116851807
Epoch: 16, Steps: 13 | Train Loss: 0.494 Vali Loss: 0.803 Vali Acc: 0.556 Test Loss: 0.803 Test Acc: 0.556
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.4389548301696777
Epoch: 17, Steps: 13 | Train Loss: 0.387 Vali Loss: 1.177 Vali Acc: 0.434 Test Loss: 1.177 Test Acc: 0.434
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.317639112472534
Epoch: 18, Steps: 13 | Train Loss: 0.399 Vali Loss: 0.698 Vali Acc: 0.746 Test Loss: 0.698 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 345074
model size : 2.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.17877721786499
Epoch: 1, Steps: 13 | Train Loss: 0.634 Vali Loss: 0.683 Vali Acc: 0.649 Test Loss: 0.683 Test Acc: 0.649
Validation loss decreased (inf --> -0.648774).  Saving model ...
Epoch: 2 cost time: 3.1920900344848633
Epoch: 2, Steps: 13 | Train Loss: 0.613 Vali Loss: 0.594 Vali Acc: 0.722 Test Loss: 0.594 Test Acc: 0.722
Validation loss decreased (-0.648774 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 3.485682249069214
Epoch: 3, Steps: 13 | Train Loss: 0.607 Vali Loss: 0.562 Vali Acc: 0.737 Test Loss: 0.562 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736580).  Saving model ...
Epoch: 4 cost time: 2.7952041625976562
Epoch: 4, Steps: 13 | Train Loss: 0.537 Vali Loss: 0.564 Vali Acc: 0.712 Test Loss: 0.564 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.7081708908081055
Epoch: 5, Steps: 13 | Train Loss: 0.487 Vali Loss: 0.527 Vali Acc: 0.741 Test Loss: 0.527 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741458).  Saving model ...
Epoch: 6 cost time: 3.556004047393799
Epoch: 6, Steps: 13 | Train Loss: 0.469 Vali Loss: 0.544 Vali Acc: 0.707 Test Loss: 0.544 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.404517650604248
Epoch: 7, Steps: 13 | Train Loss: 0.433 Vali Loss: 0.587 Vali Acc: 0.732 Test Loss: 0.587 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.2592101097106934
Epoch: 8, Steps: 13 | Train Loss: 0.497 Vali Loss: 0.533 Vali Acc: 0.698 Test Loss: 0.533 Test Acc: 0.698
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.254995346069336
Epoch: 9, Steps: 13 | Train Loss: 0.640 Vali Loss: 0.532 Vali Acc: 0.737 Test Loss: 0.532 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.261455535888672
Epoch: 10, Steps: 13 | Train Loss: 0.431 Vali Loss: 0.558 Vali Acc: 0.737 Test Loss: 0.558 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.766336441040039
Epoch: 11, Steps: 13 | Train Loss: 0.442 Vali Loss: 0.748 Vali Acc: 0.732 Test Loss: 0.748 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.973454475402832
Epoch: 12, Steps: 13 | Train Loss: 0.526 Vali Loss: 0.856 Vali Acc: 0.561 Test Loss: 0.856 Test Acc: 0.561
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.732302188873291
Epoch: 13, Steps: 13 | Train Loss: 0.471 Vali Loss: 0.606 Vali Acc: 0.732 Test Loss: 0.606 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.4663703441619873
Epoch: 14, Steps: 13 | Train Loss: 0.373 Vali Loss: 0.581 Vali Acc: 0.668 Test Loss: 0.581 Test Acc: 0.668
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.8367319107055664
Epoch: 15, Steps: 13 | Train Loss: 0.294 Vali Loss: 0.602 Vali Acc: 0.712 Test Loss: 0.602 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 343154
model size : 2.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.250298738479614
Epoch: 1, Steps: 13 | Train Loss: 0.637 Vali Loss: 0.590 Vali Acc: 0.717 Test Loss: 0.590 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 3.22969651222229
Epoch: 2, Steps: 13 | Train Loss: 0.612 Vali Loss: 0.838 Vali Acc: 0.722 Test Loss: 0.838 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721943).  Saving model ...
Epoch: 3 cost time: 3.9502384662628174
Epoch: 3, Steps: 13 | Train Loss: 0.661 Vali Loss: 0.771 Vali Acc: 0.722 Test Loss: 0.771 Test Acc: 0.722
Validation loss decreased (-0.721943 --> -0.721944).  Saving model ...
Epoch: 4 cost time: 3.7866811752319336
Epoch: 4, Steps: 13 | Train Loss: 0.643 Vali Loss: 0.572 Vali Acc: 0.717 Test Loss: 0.572 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.5149686336517334
Epoch: 5, Steps: 13 | Train Loss: 0.580 Vali Loss: 0.917 Vali Acc: 0.307 Test Loss: 0.917 Test Acc: 0.307
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.959716796875
Epoch: 6, Steps: 13 | Train Loss: 0.626 Vali Loss: 0.676 Vali Acc: 0.727 Test Loss: 0.676 Test Acc: 0.727
Validation loss decreased (-0.721944 --> -0.726823).  Saving model ...
Epoch: 7 cost time: 3.4745895862579346
Epoch: 7, Steps: 13 | Train Loss: 0.571 Vali Loss: 0.632 Vali Acc: 0.649 Test Loss: 0.632 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.276366949081421
Epoch: 8, Steps: 13 | Train Loss: 0.680 Vali Loss: 0.572 Vali Acc: 0.707 Test Loss: 0.572 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.1463143825531006
Epoch: 9, Steps: 13 | Train Loss: 0.555 Vali Loss: 0.600 Vali Acc: 0.678 Test Loss: 0.600 Test Acc: 0.678
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.4253971576690674
Epoch: 10, Steps: 13 | Train Loss: 0.688 Vali Loss: 1.545 Vali Acc: 0.322 Test Loss: 1.545 Test Acc: 0.322
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.021881818771362
Epoch: 11, Steps: 13 | Train Loss: 0.980 Vali Loss: 1.010 Vali Acc: 0.424 Test Loss: 1.010 Test Acc: 0.424
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.9021387100219727
Epoch: 12, Steps: 13 | Train Loss: 0.662 Vali Loss: 0.654 Vali Acc: 0.737 Test Loss: 0.654 Test Acc: 0.737
Validation loss decreased (-0.726823 --> -0.736579).  Saving model ...
Epoch: 13 cost time: 3.5423073768615723
Epoch: 13, Steps: 13 | Train Loss: 0.663 Vali Loss: 0.736 Vali Acc: 0.732 Test Loss: 0.736 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.4002749919891357
Epoch: 14, Steps: 13 | Train Loss: 0.503 Vali Loss: 0.570 Vali Acc: 0.702 Test Loss: 0.570 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.4925708770751953
Epoch: 15, Steps: 13 | Train Loss: 0.377 Vali Loss: 0.553 Vali Acc: 0.698 Test Loss: 0.553 Test Acc: 0.698
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.762439250946045
Epoch: 16, Steps: 13 | Train Loss: 0.383 Vali Loss: 0.817 Vali Acc: 0.737 Test Loss: 0.817 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.7722887992858887
Epoch: 17, Steps: 13 | Train Loss: 0.339 Vali Loss: 0.553 Vali Acc: 0.727 Test Loss: 0.553 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.5152721405029297
Epoch: 18, Steps: 13 | Train Loss: 0.574 Vali Loss: 1.363 Vali Acc: 0.385 Test Loss: 1.363 Test Acc: 0.385
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.5654585361480713
Epoch: 19, Steps: 13 | Train Loss: 0.326 Vali Loss: 0.643 Vali Acc: 0.732 Test Loss: 0.643 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.156923770904541
Epoch: 20, Steps: 13 | Train Loss: 0.309 Vali Loss: 0.950 Vali Acc: 0.483 Test Loss: 0.950 Test Acc: 0.483
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.5963659286499023
Epoch: 21, Steps: 13 | Train Loss: 0.275 Vali Loss: 0.719 Vali Acc: 0.624 Test Loss: 0.719 Test Acc: 0.624
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.511577844619751
Epoch: 22, Steps: 13 | Train Loss: 0.276 Vali Loss: 0.825 Vali Acc: 0.532 Test Loss: 0.825 Test Acc: 0.532
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 290674
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.282185792922974
Epoch: 1, Steps: 13 | Train Loss: 0.727 Vali Loss: 0.845 Vali Acc: 0.283 Test Loss: 0.845 Test Acc: 0.283
Validation loss decreased (inf --> -0.282918).  Saving model ...
Epoch: 2 cost time: 3.761988639831543
Epoch: 2, Steps: 13 | Train Loss: 0.616 Vali Loss: 0.580 Vali Acc: 0.712 Test Loss: 0.580 Test Acc: 0.712
Validation loss decreased (-0.282918 --> -0.712189).  Saving model ...
Epoch: 3 cost time: 3.846776008605957
Epoch: 3, Steps: 13 | Train Loss: 0.617 Vali Loss: 0.566 Vali Acc: 0.727 Test Loss: 0.566 Test Acc: 0.727
Validation loss decreased (-0.712189 --> -0.726824).  Saving model ...
Epoch: 4 cost time: 3.576547861099243
Epoch: 4, Steps: 13 | Train Loss: 0.607 Vali Loss: 0.822 Vali Acc: 0.722 Test Loss: 0.822 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.4697229862213135
Epoch: 5, Steps: 13 | Train Loss: 0.687 Vali Loss: 0.726 Vali Acc: 0.722 Test Loss: 0.726 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.811474561691284
Epoch: 6, Steps: 13 | Train Loss: 0.609 Vali Loss: 0.765 Vali Acc: 0.722 Test Loss: 0.765 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.8139045238494873
Epoch: 7, Steps: 13 | Train Loss: 0.546 Vali Loss: 0.514 Vali Acc: 0.741 Test Loss: 0.514 Test Acc: 0.741
Validation loss decreased (-0.726824 --> -0.741458).  Saving model ...
Epoch: 8 cost time: 3.508692979812622
Epoch: 8, Steps: 13 | Train Loss: 0.448 Vali Loss: 0.779 Vali Acc: 0.722 Test Loss: 0.779 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.5570406913757324
Epoch: 9, Steps: 13 | Train Loss: 0.620 Vali Loss: 0.556 Vali Acc: 0.737 Test Loss: 0.556 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.70965576171875
Epoch: 10, Steps: 13 | Train Loss: 0.621 Vali Loss: 0.690 Vali Acc: 0.595 Test Loss: 0.690 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.6607062816619873
Epoch: 11, Steps: 13 | Train Loss: 0.575 Vali Loss: 0.581 Vali Acc: 0.741 Test Loss: 0.581 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.8960554599761963
Epoch: 12, Steps: 13 | Train Loss: 0.392 Vali Loss: 0.851 Vali Acc: 0.468 Test Loss: 0.851 Test Acc: 0.468
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.716264486312866
Epoch: 13, Steps: 13 | Train Loss: 0.476 Vali Loss: 0.557 Vali Acc: 0.707 Test Loss: 0.557 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.7029008865356445
Epoch: 14, Steps: 13 | Train Loss: 0.340 Vali Loss: 0.791 Vali Acc: 0.727 Test Loss: 0.791 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.493784189224243
Epoch: 15, Steps: 13 | Train Loss: 0.570 Vali Loss: 1.795 Vali Acc: 0.337 Test Loss: 1.795 Test Acc: 0.337
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.7884345054626465
Epoch: 16, Steps: 13 | Train Loss: 0.525 Vali Loss: 0.584 Vali Acc: 0.746 Test Loss: 0.584 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746336).  Saving model ...
Epoch: 17 cost time: 3.721876859664917
Epoch: 17, Steps: 13 | Train Loss: 0.314 Vali Loss: 0.575 Vali Acc: 0.702 Test Loss: 0.575 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.6139333248138428
Epoch: 18, Steps: 13 | Train Loss: 0.308 Vali Loss: 2.206 Vali Acc: 0.327 Test Loss: 2.206 Test Acc: 0.327
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.5035037994384766
Epoch: 19, Steps: 13 | Train Loss: 0.765 Vali Loss: 0.573 Vali Acc: 0.751 Test Loss: 0.573 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751214).  Saving model ...
Epoch: 20 cost time: 3.6357786655426025
Epoch: 20, Steps: 13 | Train Loss: 0.254 Vali Loss: 0.738 Vali Acc: 0.737 Test Loss: 0.738 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.825226306915283
Epoch: 21, Steps: 13 | Train Loss: 0.397 Vali Loss: 2.001 Vali Acc: 0.346 Test Loss: 2.001 Test Acc: 0.346
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.8431360721588135
Epoch: 22, Steps: 13 | Train Loss: 0.308 Vali Loss: 0.839 Vali Acc: 0.746 Test Loss: 0.839 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.558128833770752
Epoch: 23, Steps: 13 | Train Loss: 0.213 Vali Loss: 0.759 Vali Acc: 0.727 Test Loss: 0.759 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.3786115646362305
Epoch: 24, Steps: 13 | Train Loss: 0.178 Vali Loss: 0.714 Vali Acc: 0.751 Test Loss: 0.714 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.349874258041382
Epoch: 25, Steps: 13 | Train Loss: 0.187 Vali Loss: 0.742 Vali Acc: 0.629 Test Loss: 0.742 Test Acc: 0.629
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.070542335510254
Epoch: 26, Steps: 13 | Train Loss: 0.163 Vali Loss: 0.871 Vali Acc: 0.590 Test Loss: 0.871 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.817549705505371
Epoch: 27, Steps: 13 | Train Loss: 0.192 Vali Loss: 0.885 Vali Acc: 0.761 Test Loss: 0.885 Test Acc: 0.761
Validation loss decreased (-0.751214 --> -0.760967).  Saving model ...
Epoch: 28 cost time: 3.4983315467834473
Epoch: 28, Steps: 13 | Train Loss: 0.119 Vali Loss: 0.850 Vali Acc: 0.722 Test Loss: 0.850 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.460106372833252
Epoch: 29, Steps: 13 | Train Loss: 0.065 Vali Loss: 0.902 Vali Acc: 0.615 Test Loss: 0.902 Test Acc: 0.615
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.483560562133789
Epoch: 30, Steps: 13 | Train Loss: 0.072 Vali Loss: 0.889 Vali Acc: 0.610 Test Loss: 0.889 Test Acc: 0.610
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.665925979614258
Epoch: 31, Steps: 13 | Train Loss: 0.052 Vali Loss: 0.866 Vali Acc: 0.732 Test Loss: 0.866 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.9359259605407715
Epoch: 32, Steps: 13 | Train Loss: 0.070 Vali Loss: 1.091 Vali Acc: 0.737 Test Loss: 1.091 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 3.5824053287506104
Epoch: 33, Steps: 13 | Train Loss: 0.059 Vali Loss: 0.874 Vali Acc: 0.737 Test Loss: 0.874 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 3.860595703125
Epoch: 34, Steps: 13 | Train Loss: 0.059 Vali Loss: 0.918 Vali Acc: 0.668 Test Loss: 0.918 Test Acc: 0.668
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 3.529892683029175
Epoch: 35, Steps: 13 | Train Loss: 0.039 Vali Loss: 1.167 Vali Acc: 0.737 Test Loss: 1.167 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 3.2081339359283447
Epoch: 36, Steps: 13 | Train Loss: 0.032 Vali Loss: 0.928 Vali Acc: 0.634 Test Loss: 0.928 Test Acc: 0.634
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 3.2134146690368652
Epoch: 37, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.553 Vali Acc: 0.746 Test Loss: 1.553 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 288754
model size : 1.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.671078205108643
Epoch: 1, Steps: 13 | Train Loss: 0.673 Vali Loss: 0.592 Vali Acc: 0.712 Test Loss: 0.592 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 3.505359649658203
Epoch: 2, Steps: 13 | Train Loss: 0.659 Vali Loss: 0.796 Vali Acc: 0.712 Test Loss: 0.796 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.5445773601531982
Epoch: 3, Steps: 13 | Train Loss: 0.653 Vali Loss: 0.870 Vali Acc: 0.717 Test Loss: 0.870 Test Acc: 0.717
Validation loss decreased (-0.712189 --> -0.717064).  Saving model ...
Epoch: 4 cost time: 3.647946357727051
Epoch: 4, Steps: 13 | Train Loss: 0.658 Vali Loss: 0.547 Vali Acc: 0.737 Test Loss: 0.547 Test Acc: 0.737
Validation loss decreased (-0.717064 --> -0.736580).  Saving model ...
Epoch: 5 cost time: 3.817016124725342
Epoch: 5, Steps: 13 | Train Loss: 0.646 Vali Loss: 0.559 Vali Acc: 0.727 Test Loss: 0.559 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.2243006229400635
Epoch: 6, Steps: 13 | Train Loss: 0.538 Vali Loss: 0.531 Vali Acc: 0.751 Test Loss: 0.531 Test Acc: 0.751
Validation loss decreased (-0.736580 --> -0.751214).  Saving model ...
Epoch: 7 cost time: 3.9907948970794678
Epoch: 7, Steps: 13 | Train Loss: 0.461 Vali Loss: 0.541 Vali Acc: 0.722 Test Loss: 0.541 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.058716058731079
Epoch: 8, Steps: 13 | Train Loss: 0.542 Vali Loss: 0.540 Vali Acc: 0.746 Test Loss: 0.540 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.985849618911743
Epoch: 9, Steps: 13 | Train Loss: 0.407 Vali Loss: 0.721 Vali Acc: 0.727 Test Loss: 0.721 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.8461382389068604
Epoch: 10, Steps: 13 | Train Loss: 0.423 Vali Loss: 0.533 Vali Acc: 0.707 Test Loss: 0.533 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.8403236865997314
Epoch: 11, Steps: 13 | Train Loss: 0.499 Vali Loss: 0.880 Vali Acc: 0.722 Test Loss: 0.880 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.1548805236816406
Epoch: 12, Steps: 13 | Train Loss: 0.412 Vali Loss: 0.652 Vali Acc: 0.629 Test Loss: 0.652 Test Acc: 0.629
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.7503223419189453
Epoch: 13, Steps: 13 | Train Loss: 0.329 Vali Loss: 0.699 Vali Acc: 0.727 Test Loss: 0.699 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.7989418506622314
Epoch: 14, Steps: 13 | Train Loss: 0.305 Vali Loss: 0.822 Vali Acc: 0.576 Test Loss: 0.822 Test Acc: 0.576
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.455994129180908
Epoch: 15, Steps: 13 | Train Loss: 0.330 Vali Loss: 0.617 Vali Acc: 0.746 Test Loss: 0.617 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.125143051147461
Epoch: 16, Steps: 13 | Train Loss: 0.346 Vali Loss: 0.762 Vali Acc: 0.746 Test Loss: 0.762 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 286834
model size : 1.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.592902898788452
Epoch: 1, Steps: 13 | Train Loss: 0.697 Vali Loss: 0.594 Vali Acc: 0.722 Test Loss: 0.594 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 3.0413196086883545
Epoch: 2, Steps: 13 | Train Loss: 0.645 Vali Loss: 0.645 Vali Acc: 0.722 Test Loss: 0.645 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.4624855518341064
Epoch: 3, Steps: 13 | Train Loss: 0.611 Vali Loss: 0.603 Vali Acc: 0.756 Test Loss: 0.603 Test Acc: 0.756
Validation loss decreased (-0.721945 --> -0.756092).  Saving model ...
Epoch: 4 cost time: 3.4648818969726562
Epoch: 4, Steps: 13 | Train Loss: 0.571 Vali Loss: 0.610 Vali Acc: 0.722 Test Loss: 0.610 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.835014581680298
Epoch: 5, Steps: 13 | Train Loss: 0.570 Vali Loss: 0.937 Vali Acc: 0.722 Test Loss: 0.937 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.221414566040039
Epoch: 6, Steps: 13 | Train Loss: 0.565 Vali Loss: 0.526 Vali Acc: 0.756 Test Loss: 0.526 Test Acc: 0.756
Validation loss decreased (-0.756092 --> -0.756092).  Saving model ...
Epoch: 7 cost time: 2.731642246246338
Epoch: 7, Steps: 13 | Train Loss: 0.699 Vali Loss: 1.308 Vali Acc: 0.293 Test Loss: 1.308 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.3135290145874023
Epoch: 8, Steps: 13 | Train Loss: 0.810 Vali Loss: 0.600 Vali Acc: 0.663 Test Loss: 0.600 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.1572985649108887
Epoch: 9, Steps: 13 | Train Loss: 0.490 Vali Loss: 0.641 Vali Acc: 0.732 Test Loss: 0.641 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.194946527481079
Epoch: 10, Steps: 13 | Train Loss: 0.439 Vali Loss: 0.524 Vali Acc: 0.737 Test Loss: 0.524 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.461663246154785
Epoch: 11, Steps: 13 | Train Loss: 0.375 Vali Loss: 0.751 Vali Acc: 0.727 Test Loss: 0.751 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.2949416637420654
Epoch: 12, Steps: 13 | Train Loss: 0.691 Vali Loss: 1.342 Vali Acc: 0.712 Test Loss: 1.342 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.5425567626953125
Epoch: 13, Steps: 13 | Train Loss: 0.569 Vali Loss: 0.715 Vali Acc: 0.585 Test Loss: 0.715 Test Acc: 0.585
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.368145704269409
Epoch: 14, Steps: 13 | Train Loss: 0.502 Vali Loss: 1.186 Vali Acc: 0.429 Test Loss: 1.186 Test Acc: 0.429
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.4688479900360107
Epoch: 15, Steps: 13 | Train Loss: 0.398 Vali Loss: 0.562 Vali Acc: 0.746 Test Loss: 0.562 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.567474126815796
Epoch: 16, Steps: 13 | Train Loss: 0.308 Vali Loss: 0.771 Vali Acc: 0.741 Test Loss: 0.771 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 284914
model size : 1.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.400602579116821
Epoch: 1, Steps: 13 | Train Loss: 1.224 Vali Loss: 1.520 Vali Acc: 0.288 Test Loss: 1.520 Test Acc: 0.288
Validation loss decreased (inf --> -0.287790).  Saving model ...
Epoch: 2 cost time: 5.694668769836426
Epoch: 2, Steps: 13 | Train Loss: 0.683 Vali Loss: 0.525 Vali Acc: 0.761 Test Loss: 0.525 Test Acc: 0.761
Validation loss decreased (-0.287790 --> -0.760970).  Saving model ...
Epoch: 3 cost time: 4.978697776794434
Epoch: 3, Steps: 13 | Train Loss: 1.043 Vali Loss: 7.603 Vali Acc: 0.278 Test Loss: 7.603 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.784693002700806
Epoch: 4, Steps: 13 | Train Loss: 4.714 Vali Loss: 3.023 Vali Acc: 0.712 Test Loss: 3.023 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.36598539352417
Epoch: 5, Steps: 13 | Train Loss: 0.954 Vali Loss: 2.754 Vali Acc: 0.351 Test Loss: 2.754 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.94847559928894
Epoch: 6, Steps: 13 | Train Loss: 1.481 Vali Loss: 1.726 Vali Acc: 0.327 Test Loss: 1.726 Test Acc: 0.327
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.171497821807861
Epoch: 7, Steps: 13 | Train Loss: 2.679 Vali Loss: 4.511 Vali Acc: 0.722 Test Loss: 4.511 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.618646860122681
Epoch: 8, Steps: 13 | Train Loss: 4.253 Vali Loss: 4.337 Vali Acc: 0.307 Test Loss: 4.337 Test Acc: 0.307
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.613959550857544
Epoch: 9, Steps: 13 | Train Loss: 4.180 Vali Loss: 7.055 Vali Acc: 0.717 Test Loss: 7.055 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 7.253485918045044
Epoch: 10, Steps: 13 | Train Loss: 6.844 Vali Loss: 2.098 Vali Acc: 0.595 Test Loss: 2.098 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.042517900466919
Epoch: 11, Steps: 13 | Train Loss: 4.221 Vali Loss: 9.845 Vali Acc: 0.312 Test Loss: 9.845 Test Acc: 0.312
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.8600120544433594
Epoch: 12, Steps: 13 | Train Loss: 5.789 Vali Loss: 12.045 Vali Acc: 0.722 Test Loss: 12.045 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 9033510
model size : 39.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.959084510803223
Epoch: 1, Steps: 13 | Train Loss: 0.886 Vali Loss: 1.373 Vali Acc: 0.717 Test Loss: 1.373 Test Acc: 0.717
Validation loss decreased (inf --> -0.717059).  Saving model ...
Epoch: 2 cost time: 5.714961290359497
Epoch: 2, Steps: 13 | Train Loss: 1.809 Vali Loss: 2.420 Vali Acc: 0.722 Test Loss: 2.420 Test Acc: 0.722
Validation loss decreased (-0.717059 --> -0.721927).  Saving model ...
Epoch: 3 cost time: 4.630378007888794
Epoch: 3, Steps: 13 | Train Loss: 1.029 Vali Loss: 0.585 Vali Acc: 0.751 Test Loss: 0.585 Test Acc: 0.751
Validation loss decreased (-0.721927 --> -0.751214).  Saving model ...
Epoch: 4 cost time: 5.2395548820495605
Epoch: 4, Steps: 13 | Train Loss: 3.553 Vali Loss: 1.683 Vali Acc: 0.717 Test Loss: 1.683 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.460699558258057
Epoch: 5, Steps: 13 | Train Loss: 5.801 Vali Loss: 19.802 Vali Acc: 0.278 Test Loss: 19.802 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.945645332336426
Epoch: 6, Steps: 13 | Train Loss: 6.590 Vali Loss: 4.472 Vali Acc: 0.722 Test Loss: 4.472 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.536682605743408
Epoch: 7, Steps: 13 | Train Loss: 2.721 Vali Loss: 1.796 Vali Acc: 0.746 Test Loss: 1.796 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.116383790969849
Epoch: 8, Steps: 13 | Train Loss: 1.532 Vali Loss: 2.182 Vali Acc: 0.478 Test Loss: 2.182 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.714805603027344
Epoch: 9, Steps: 13 | Train Loss: 0.946 Vali Loss: 10.160 Vali Acc: 0.278 Test Loss: 10.160 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.487577438354492
Epoch: 10, Steps: 13 | Train Loss: 2.853 Vali Loss: 3.289 Vali Acc: 0.732 Test Loss: 3.289 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.177381277084351
Epoch: 11, Steps: 13 | Train Loss: 4.476 Vali Loss: 15.692 Vali Acc: 0.712 Test Loss: 15.692 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.117620468139648
Epoch: 12, Steps: 13 | Train Loss: 9.805 Vali Loss: 24.408 Vali Acc: 0.278 Test Loss: 24.408 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.900929689407349
Epoch: 13, Steps: 13 | Train Loss: 7.705 Vali Loss: 8.639 Vali Acc: 0.717 Test Loss: 8.639 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 9020454
model size : 39.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.491188049316406
Epoch: 1, Steps: 13 | Train Loss: 1.432 Vali Loss: 2.157 Vali Acc: 0.278 Test Loss: 2.157 Test Acc: 0.278
Validation loss decreased (inf --> -0.278027).  Saving model ...
Epoch: 2 cost time: 5.9064764976501465
Epoch: 2, Steps: 13 | Train Loss: 2.526 Vali Loss: 1.287 Vali Acc: 0.722 Test Loss: 1.287 Test Acc: 0.722
Validation loss decreased (-0.278027 --> -0.721938).  Saving model ...
Epoch: 3 cost time: 5.717034578323364
Epoch: 3, Steps: 13 | Train Loss: 1.868 Vali Loss: 1.808 Vali Acc: 0.717 Test Loss: 1.808 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.282448768615723
Epoch: 4, Steps: 13 | Train Loss: 1.103 Vali Loss: 3.591 Vali Acc: 0.293 Test Loss: 3.591 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.717876434326172
Epoch: 5, Steps: 13 | Train Loss: 4.671 Vali Loss: 4.153 Vali Acc: 0.712 Test Loss: 4.153 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.513533115386963
Epoch: 6, Steps: 13 | Train Loss: 4.444 Vali Loss: 1.647 Vali Acc: 0.629 Test Loss: 1.647 Test Acc: 0.629
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.679551362991333
Epoch: 7, Steps: 13 | Train Loss: 3.613 Vali Loss: 1.299 Vali Acc: 0.639 Test Loss: 1.299 Test Acc: 0.639
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.2420125007629395
Epoch: 8, Steps: 13 | Train Loss: 2.589 Vali Loss: 0.818 Vali Acc: 0.698 Test Loss: 0.818 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.478467226028442
Epoch: 9, Steps: 13 | Train Loss: 6.207 Vali Loss: 2.302 Vali Acc: 0.532 Test Loss: 2.302 Test Acc: 0.532
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.3461151123046875
Epoch: 10, Steps: 13 | Train Loss: 2.574 Vali Loss: 2.773 Vali Acc: 0.395 Test Loss: 2.773 Test Acc: 0.395
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.959056377410889
Epoch: 11, Steps: 13 | Train Loss: 1.534 Vali Loss: 1.577 Vali Acc: 0.727 Test Loss: 1.577 Test Acc: 0.727
Validation loss decreased (-0.721938 --> -0.726813).  Saving model ...
Epoch: 12 cost time: 4.886988878250122
Epoch: 12, Steps: 13 | Train Loss: 1.001 Vali Loss: 1.856 Vali Acc: 0.741 Test Loss: 1.856 Test Acc: 0.741
Validation loss decreased (-0.726813 --> -0.741445).  Saving model ...
Epoch: 13 cost time: 5.670708894729614
Epoch: 13, Steps: 13 | Train Loss: 3.359 Vali Loss: 8.248 Vali Acc: 0.717 Test Loss: 8.248 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.21310830116272
Epoch: 14, Steps: 13 | Train Loss: 3.761 Vali Loss: 1.702 Vali Acc: 0.693 Test Loss: 1.702 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.98798394203186
Epoch: 15, Steps: 13 | Train Loss: 0.582 Vali Loss: 2.178 Vali Acc: 0.615 Test Loss: 2.178 Test Acc: 0.615
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.474356412887573
Epoch: 16, Steps: 13 | Train Loss: 2.870 Vali Loss: 13.562 Vali Acc: 0.288 Test Loss: 13.562 Test Acc: 0.288
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.643362283706665
Epoch: 17, Steps: 13 | Train Loss: 2.546 Vali Loss: 4.598 Vali Acc: 0.741 Test Loss: 4.598 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 6.710612773895264
Epoch: 18, Steps: 13 | Train Loss: 0.516 Vali Loss: 3.895 Vali Acc: 0.756 Test Loss: 3.895 Test Acc: 0.756
Validation loss decreased (-0.741445 --> -0.756059).  Saving model ...
Epoch: 19 cost time: 6.376410484313965
Epoch: 19, Steps: 13 | Train Loss: 1.175 Vali Loss: 5.031 Vali Acc: 0.737 Test Loss: 5.031 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.728947639465332
Epoch: 20, Steps: 13 | Train Loss: 0.583 Vali Loss: 2.590 Vali Acc: 0.702 Test Loss: 2.590 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.773416042327881
Epoch: 21, Steps: 13 | Train Loss: 0.838 Vali Loss: 5.059 Vali Acc: 0.746 Test Loss: 5.059 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 5.799146890640259
Epoch: 22, Steps: 13 | Train Loss: 0.697 Vali Loss: 10.092 Vali Acc: 0.727 Test Loss: 10.092 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 5.928015232086182
Epoch: 23, Steps: 13 | Train Loss: 2.621 Vali Loss: 3.657 Vali Acc: 0.605 Test Loss: 3.657 Test Acc: 0.605
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 5.757778167724609
Epoch: 24, Steps: 13 | Train Loss: 0.678 Vali Loss: 5.206 Vali Acc: 0.712 Test Loss: 5.206 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 5.889254808425903
Epoch: 25, Steps: 13 | Train Loss: 0.961 Vali Loss: 5.350 Vali Acc: 0.722 Test Loss: 5.350 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 5.897078990936279
Epoch: 26, Steps: 13 | Train Loss: 0.547 Vali Loss: 4.857 Vali Acc: 0.707 Test Loss: 4.857 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 5.941310882568359
Epoch: 27, Steps: 13 | Train Loss: 0.360 Vali Loss: 4.963 Vali Acc: 0.639 Test Loss: 4.963 Test Acc: 0.639
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 5.579671859741211
Epoch: 28, Steps: 13 | Train Loss: 0.837 Vali Loss: 13.212 Vali Acc: 0.722 Test Loss: 13.212 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 9007398
model size : 39.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.674577474594116
Epoch: 1, Steps: 13 | Train Loss: 1.044 Vali Loss: 1.124 Vali Acc: 0.712 Test Loss: 1.124 Test Acc: 0.712
Validation loss decreased (inf --> -0.712184).  Saving model ...
Epoch: 2 cost time: 4.900588512420654
Epoch: 2, Steps: 13 | Train Loss: 1.023 Vali Loss: 5.844 Vali Acc: 0.283 Test Loss: 5.844 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.799221992492676
Epoch: 3, Steps: 13 | Train Loss: 1.522 Vali Loss: 1.942 Vali Acc: 0.317 Test Loss: 1.942 Test Acc: 0.317
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.977889060974121
Epoch: 4, Steps: 13 | Train Loss: 1.070 Vali Loss: 4.951 Vali Acc: 0.278 Test Loss: 4.951 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.064966440200806
Epoch: 5, Steps: 13 | Train Loss: 1.986 Vali Loss: 5.160 Vali Acc: 0.712 Test Loss: 5.160 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.824300050735474
Epoch: 6, Steps: 13 | Train Loss: 5.041 Vali Loss: 7.865 Vali Acc: 0.322 Test Loss: 7.865 Test Acc: 0.322
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.6930248737335205
Epoch: 7, Steps: 13 | Train Loss: 5.168 Vali Loss: 1.079 Vali Acc: 0.717 Test Loss: 1.079 Test Acc: 0.717
Validation loss decreased (-0.712184 --> -0.717062).  Saving model ...
Epoch: 8 cost time: 4.697368144989014
Epoch: 8, Steps: 13 | Train Loss: 7.206 Vali Loss: 5.286 Vali Acc: 0.712 Test Loss: 5.286 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.227652549743652
Epoch: 9, Steps: 13 | Train Loss: 3.053 Vali Loss: 3.953 Vali Acc: 0.712 Test Loss: 3.953 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.914059162139893
Epoch: 10, Steps: 13 | Train Loss: 2.743 Vali Loss: 2.359 Vali Acc: 0.741 Test Loss: 2.359 Test Acc: 0.741
Validation loss decreased (-0.717062 --> -0.741440).  Saving model ...
Epoch: 11 cost time: 5.067738056182861
Epoch: 11, Steps: 13 | Train Loss: 2.507 Vali Loss: 3.152 Vali Acc: 0.727 Test Loss: 3.152 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.314287185668945
Epoch: 12, Steps: 13 | Train Loss: 0.818 Vali Loss: 3.185 Vali Acc: 0.732 Test Loss: 3.185 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.168744087219238
Epoch: 13, Steps: 13 | Train Loss: 0.654 Vali Loss: 2.171 Vali Acc: 0.556 Test Loss: 2.171 Test Acc: 0.556
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.043996334075928
Epoch: 14, Steps: 13 | Train Loss: 2.797 Vali Loss: 4.050 Vali Acc: 0.751 Test Loss: 4.050 Test Acc: 0.751
Validation loss decreased (-0.741440 --> -0.751179).  Saving model ...
Epoch: 15 cost time: 5.032043218612671
Epoch: 15, Steps: 13 | Train Loss: 2.831 Vali Loss: 26.757 Vali Acc: 0.283 Test Loss: 26.757 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.279813766479492
Epoch: 16, Steps: 13 | Train Loss: 5.622 Vali Loss: 4.481 Vali Acc: 0.751 Test Loss: 4.481 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.0915446281433105
Epoch: 17, Steps: 13 | Train Loss: 5.338 Vali Loss: 12.131 Vali Acc: 0.429 Test Loss: 12.131 Test Acc: 0.429
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.189897298812866
Epoch: 18, Steps: 13 | Train Loss: 1.854 Vali Loss: 7.814 Vali Acc: 0.717 Test Loss: 7.814 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.749036073684692
Epoch: 19, Steps: 13 | Train Loss: 2.214 Vali Loss: 3.778 Vali Acc: 0.595 Test Loss: 3.778 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.7392072677612305
Epoch: 20, Steps: 13 | Train Loss: 1.709 Vali Loss: 21.067 Vali Acc: 0.356 Test Loss: 21.067 Test Acc: 0.356
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 5.287234544754028
Epoch: 21, Steps: 13 | Train Loss: 4.988 Vali Loss: 8.339 Vali Acc: 0.517 Test Loss: 8.339 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 5.44613242149353
Epoch: 22, Steps: 13 | Train Loss: 1.492 Vali Loss: 7.323 Vali Acc: 0.712 Test Loss: 7.323 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.982606410980225
Epoch: 23, Steps: 13 | Train Loss: 0.707 Vali Loss: 3.450 Vali Acc: 0.585 Test Loss: 3.450 Test Acc: 0.585
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 5.530952453613281
Epoch: 24, Steps: 13 | Train Loss: 0.061 Vali Loss: 6.756 Vali Acc: 0.537 Test Loss: 6.756 Test Acc: 0.537
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 8994342
model size : 39.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.106008768081665
Epoch: 1, Steps: 13 | Train Loss: 0.760 Vali Loss: 0.697 Vali Acc: 0.722 Test Loss: 0.697 Test Acc: 0.722
Validation loss decreased (inf --> -0.721944).  Saving model ...
Epoch: 2 cost time: 5.189998149871826
Epoch: 2, Steps: 13 | Train Loss: 0.618 Vali Loss: 0.530 Vali Acc: 0.766 Test Loss: 0.530 Test Acc: 0.766
Validation loss decreased (-0.721944 --> -0.765848).  Saving model ...
Epoch: 3 cost time: 5.1659932136535645
Epoch: 3, Steps: 13 | Train Loss: 2.787 Vali Loss: 3.594 Vali Acc: 0.722 Test Loss: 3.594 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.117760896682739
Epoch: 4, Steps: 13 | Train Loss: 3.575 Vali Loss: 4.634 Vali Acc: 0.278 Test Loss: 4.634 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.781472206115723
Epoch: 5, Steps: 13 | Train Loss: 4.039 Vali Loss: 1.197 Vali Acc: 0.741 Test Loss: 1.197 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.431277751922607
Epoch: 6, Steps: 13 | Train Loss: 3.469 Vali Loss: 2.730 Vali Acc: 0.761 Test Loss: 2.730 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.7354736328125
Epoch: 7, Steps: 13 | Train Loss: 2.087 Vali Loss: 11.287 Vali Acc: 0.288 Test Loss: 11.287 Test Acc: 0.288
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.865153789520264
Epoch: 8, Steps: 13 | Train Loss: 4.656 Vali Loss: 0.883 Vali Acc: 0.737 Test Loss: 0.883 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.158521890640259
Epoch: 9, Steps: 13 | Train Loss: 2.363 Vali Loss: 4.034 Vali Acc: 0.717 Test Loss: 4.034 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.457082509994507
Epoch: 10, Steps: 13 | Train Loss: 0.856 Vali Loss: 4.773 Vali Acc: 0.727 Test Loss: 4.773 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.71891713142395
Epoch: 11, Steps: 13 | Train Loss: 3.184 Vali Loss: 2.776 Vali Acc: 0.741 Test Loss: 2.776 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.6089417934417725
Epoch: 12, Steps: 13 | Train Loss: 1.922 Vali Loss: 4.180 Vali Acc: 0.400 Test Loss: 4.180 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 7720230
model size : 34.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.74121880531311
Epoch: 1, Steps: 13 | Train Loss: 1.717 Vali Loss: 1.662 Vali Acc: 0.288 Test Loss: 1.662 Test Acc: 0.288
Validation loss decreased (inf --> -0.287788).  Saving model ...
Epoch: 2 cost time: 5.237550973892212
Epoch: 2, Steps: 13 | Train Loss: 1.840 Vali Loss: 0.812 Vali Acc: 0.737 Test Loss: 0.812 Test Acc: 0.737
Validation loss decreased (-0.287788 --> -0.736577).  Saving model ...
Epoch: 3 cost time: 5.198988914489746
Epoch: 3, Steps: 13 | Train Loss: 0.759 Vali Loss: 0.687 Vali Acc: 0.722 Test Loss: 0.687 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.803570032119751
Epoch: 4, Steps: 13 | Train Loss: 1.064 Vali Loss: 1.786 Vali Acc: 0.327 Test Loss: 1.786 Test Acc: 0.327
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.234786748886108
Epoch: 5, Steps: 13 | Train Loss: 1.114 Vali Loss: 1.781 Vali Acc: 0.717 Test Loss: 1.781 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.194816589355469
Epoch: 6, Steps: 13 | Train Loss: 6.674 Vali Loss: 22.147 Vali Acc: 0.283 Test Loss: 22.147 Test Acc: 0.283
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.8350954055786133
Epoch: 7, Steps: 13 | Train Loss: 6.014 Vali Loss: 1.018 Vali Acc: 0.595 Test Loss: 1.018 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.5751564502716064
Epoch: 8, Steps: 13 | Train Loss: 1.693 Vali Loss: 1.479 Vali Acc: 0.732 Test Loss: 1.479 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.434473991394043
Epoch: 9, Steps: 13 | Train Loss: 1.952 Vali Loss: 2.140 Vali Acc: 0.741 Test Loss: 2.140 Test Acc: 0.741
Validation loss decreased (-0.736577 --> -0.741442).  Saving model ...
Epoch: 10 cost time: 4.862605810165405
Epoch: 10, Steps: 13 | Train Loss: 2.640 Vali Loss: 12.290 Vali Acc: 0.288 Test Loss: 12.290 Test Acc: 0.288
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.07973837852478
Epoch: 11, Steps: 13 | Train Loss: 8.285 Vali Loss: 7.797 Vali Acc: 0.712 Test Loss: 7.797 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.41773796081543
Epoch: 12, Steps: 13 | Train Loss: 3.843 Vali Loss: 6.064 Vali Acc: 0.722 Test Loss: 6.064 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.401964902877808
Epoch: 13, Steps: 13 | Train Loss: 0.886 Vali Loss: 2.056 Vali Acc: 0.746 Test Loss: 2.056 Test Acc: 0.746
Validation loss decreased (-0.741442 --> -0.746321).  Saving model ...
Epoch: 14 cost time: 4.318388938903809
Epoch: 14, Steps: 13 | Train Loss: 7.625 Vali Loss: 16.594 Vali Acc: 0.278 Test Loss: 16.594 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.956178426742554
Epoch: 15, Steps: 13 | Train Loss: 6.755 Vali Loss: 2.063 Vali Acc: 0.737 Test Loss: 2.063 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.606788158416748
Epoch: 16, Steps: 13 | Train Loss: 5.229 Vali Loss: 5.210 Vali Acc: 0.751 Test Loss: 5.210 Test Acc: 0.751
Validation loss decreased (-0.746321 --> -0.751167).  Saving model ...
Epoch: 17 cost time: 5.1364359855651855
Epoch: 17, Steps: 13 | Train Loss: 1.436 Vali Loss: 4.502 Vali Acc: 0.746 Test Loss: 4.502 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.041895389556885
Epoch: 18, Steps: 13 | Train Loss: 2.924 Vali Loss: 6.726 Vali Acc: 0.376 Test Loss: 6.726 Test Acc: 0.376
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.7018210887908936
Epoch: 19, Steps: 13 | Train Loss: 1.358 Vali Loss: 3.293 Vali Acc: 0.737 Test Loss: 3.293 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.258487701416016
Epoch: 20, Steps: 13 | Train Loss: 0.398 Vali Loss: 3.646 Vali Acc: 0.722 Test Loss: 3.646 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 5.068546533584595
Epoch: 21, Steps: 13 | Train Loss: 1.358 Vali Loss: 2.658 Vali Acc: 0.673 Test Loss: 2.658 Test Acc: 0.673
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 4.836926221847534
Epoch: 22, Steps: 13 | Train Loss: 1.652 Vali Loss: 5.461 Vali Acc: 0.473 Test Loss: 5.461 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 4.767560720443726
Epoch: 23, Steps: 13 | Train Loss: 0.517 Vali Loss: 2.738 Vali Acc: 0.688 Test Loss: 2.738 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 4.662191867828369
Epoch: 24, Steps: 13 | Train Loss: 0.407 Vali Loss: 2.846 Vali Acc: 0.698 Test Loss: 2.846 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 4.746041536331177
Epoch: 25, Steps: 13 | Train Loss: 0.045 Vali Loss: 4.553 Vali Acc: 0.600 Test Loss: 4.553 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 4.6867663860321045
Epoch: 26, Steps: 13 | Train Loss: 0.131 Vali Loss: 5.419 Vali Acc: 0.732 Test Loss: 5.419 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 7707174
model size : 34.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.922828435897827
Epoch: 1, Steps: 13 | Train Loss: 1.078 Vali Loss: 0.658 Vali Acc: 0.717 Test Loss: 0.658 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 4.855786561965942
Epoch: 2, Steps: 13 | Train Loss: 0.689 Vali Loss: 0.638 Vali Acc: 0.732 Test Loss: 0.638 Test Acc: 0.732
Validation loss decreased (-0.717067 --> -0.731701).  Saving model ...
Epoch: 3 cost time: 5.257090330123901
Epoch: 3, Steps: 13 | Train Loss: 0.904 Vali Loss: 2.710 Vali Acc: 0.722 Test Loss: 2.710 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.829883337020874
Epoch: 4, Steps: 13 | Train Loss: 3.785 Vali Loss: 2.133 Vali Acc: 0.346 Test Loss: 2.133 Test Acc: 0.346
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.137876033782959
Epoch: 5, Steps: 13 | Train Loss: 3.563 Vali Loss: 2.215 Vali Acc: 0.727 Test Loss: 2.215 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.312817335128784
Epoch: 6, Steps: 13 | Train Loss: 3.776 Vali Loss: 2.645 Vali Acc: 0.741 Test Loss: 2.645 Test Acc: 0.741
Validation loss decreased (-0.731701 --> -0.741437).  Saving model ...
Epoch: 7 cost time: 5.522270917892456
Epoch: 7, Steps: 13 | Train Loss: 3.433 Vali Loss: 7.943 Vali Acc: 0.366 Test Loss: 7.943 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.701237440109253
Epoch: 8, Steps: 13 | Train Loss: 2.691 Vali Loss: 1.673 Vali Acc: 0.737 Test Loss: 1.673 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.619449853897095
Epoch: 9, Steps: 13 | Train Loss: 2.699 Vali Loss: 9.470 Vali Acc: 0.278 Test Loss: 9.470 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.309144735336304
Epoch: 10, Steps: 13 | Train Loss: 2.383 Vali Loss: 2.128 Vali Acc: 0.751 Test Loss: 2.128 Test Acc: 0.751
Validation loss decreased (-0.741437 --> -0.751198).  Saving model ...
Epoch: 11 cost time: 4.9839043617248535
Epoch: 11, Steps: 13 | Train Loss: 2.805 Vali Loss: 5.121 Vali Acc: 0.722 Test Loss: 5.121 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.902851104736328
Epoch: 12, Steps: 13 | Train Loss: 1.161 Vali Loss: 1.603 Vali Acc: 0.707 Test Loss: 1.603 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.704923868179321
Epoch: 13, Steps: 13 | Train Loss: 2.822 Vali Loss: 19.989 Vali Acc: 0.288 Test Loss: 19.989 Test Acc: 0.288
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.933080673217773
Epoch: 14, Steps: 13 | Train Loss: 3.705 Vali Loss: 4.341 Vali Acc: 0.717 Test Loss: 4.341 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.7571775913238525
Epoch: 15, Steps: 13 | Train Loss: 4.781 Vali Loss: 19.722 Vali Acc: 0.722 Test Loss: 19.722 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.03957200050354
Epoch: 16, Steps: 13 | Train Loss: 10.017 Vali Loss: 11.958 Vali Acc: 0.405 Test Loss: 11.958 Test Acc: 0.405
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.75831937789917
Epoch: 17, Steps: 13 | Train Loss: 3.191 Vali Loss: 11.649 Vali Acc: 0.366 Test Loss: 11.649 Test Acc: 0.366
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.41165018081665
Epoch: 18, Steps: 13 | Train Loss: 10.230 Vali Loss: 7.833 Vali Acc: 0.727 Test Loss: 7.833 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.41340184211731
Epoch: 19, Steps: 13 | Train Loss: 4.423 Vali Loss: 15.154 Vali Acc: 0.400 Test Loss: 15.154 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.689871549606323
Epoch: 20, Steps: 13 | Train Loss: 2.994 Vali Loss: 10.477 Vali Acc: 0.727 Test Loss: 10.477 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 7694118
model size : 34.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.854877710342407
Epoch: 1, Steps: 13 | Train Loss: 0.951 Vali Loss: 4.183 Vali Acc: 0.278 Test Loss: 4.183 Test Acc: 0.278
Validation loss decreased (inf --> -0.278007).  Saving model ...
Epoch: 2 cost time: 4.45836329460144
Epoch: 2, Steps: 13 | Train Loss: 1.412 Vali Loss: 0.527 Vali Acc: 0.756 Test Loss: 0.527 Test Acc: 0.756
Validation loss decreased (-0.278007 --> -0.756092).  Saving model ...
Epoch: 3 cost time: 5.691581964492798
Epoch: 3, Steps: 13 | Train Loss: 2.273 Vali Loss: 0.949 Vali Acc: 0.546 Test Loss: 0.949 Test Acc: 0.546
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.045175790786743
Epoch: 4, Steps: 13 | Train Loss: 0.809 Vali Loss: 1.212 Vali Acc: 0.727 Test Loss: 1.212 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.552842140197754
Epoch: 5, Steps: 13 | Train Loss: 0.930 Vali Loss: 0.891 Vali Acc: 0.580 Test Loss: 0.891 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.213150501251221
Epoch: 6, Steps: 13 | Train Loss: 0.859 Vali Loss: 0.785 Vali Acc: 0.629 Test Loss: 0.785 Test Acc: 0.629
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.89551043510437
Epoch: 7, Steps: 13 | Train Loss: 0.826 Vali Loss: 1.405 Vali Acc: 0.463 Test Loss: 1.405 Test Acc: 0.463
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.1647374629974365
Epoch: 8, Steps: 13 | Train Loss: 1.777 Vali Loss: 4.917 Vali Acc: 0.722 Test Loss: 4.917 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.355832576751709
Epoch: 9, Steps: 13 | Train Loss: 4.197 Vali Loss: 9.309 Vali Acc: 0.722 Test Loss: 9.309 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.4623191356658936
Epoch: 10, Steps: 13 | Train Loss: 5.627 Vali Loss: 2.635 Vali Acc: 0.717 Test Loss: 2.635 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.486855983734131
Epoch: 11, Steps: 13 | Train Loss: 3.902 Vali Loss: 4.570 Vali Acc: 0.727 Test Loss: 4.570 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.952276945114136
Epoch: 12, Steps: 13 | Train Loss: 1.208 Vali Loss: 5.355 Vali Acc: 0.429 Test Loss: 5.355 Test Acc: 0.429
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 7681062
model size : 34.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.413559436798096
Epoch: 1, Steps: 13 | Train Loss: 0.920 Vali Loss: 0.561 Vali Acc: 0.746 Test Loss: 0.561 Test Acc: 0.746
Validation loss decreased (inf --> -0.746336).  Saving model ...
Epoch: 2 cost time: 3.9373281002044678
Epoch: 2, Steps: 13 | Train Loss: 1.578 Vali Loss: 1.857 Vali Acc: 0.722 Test Loss: 1.857 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.4301981925964355
Epoch: 3, Steps: 13 | Train Loss: 1.716 Vali Loss: 3.545 Vali Acc: 0.712 Test Loss: 3.545 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.7776248455047607
Epoch: 4, Steps: 13 | Train Loss: 4.458 Vali Loss: 6.902 Vali Acc: 0.288 Test Loss: 6.902 Test Acc: 0.288
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.1624205112457275
Epoch: 5, Steps: 13 | Train Loss: 2.393 Vali Loss: 0.737 Vali Acc: 0.746 Test Loss: 0.737 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.4157304763793945
Epoch: 6, Steps: 13 | Train Loss: 1.222 Vali Loss: 8.892 Vali Acc: 0.288 Test Loss: 8.892 Test Acc: 0.288
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.346011400222778
Epoch: 7, Steps: 13 | Train Loss: 3.327 Vali Loss: 9.520 Vali Acc: 0.283 Test Loss: 9.520 Test Acc: 0.283
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.532109498977661
Epoch: 8, Steps: 13 | Train Loss: 2.068 Vali Loss: 1.346 Vali Acc: 0.737 Test Loss: 1.346 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.447279930114746
Epoch: 9, Steps: 13 | Train Loss: 5.276 Vali Loss: 2.010 Vali Acc: 0.741 Test Loss: 2.010 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.7634968757629395
Epoch: 10, Steps: 13 | Train Loss: 5.308 Vali Loss: 4.108 Vali Acc: 0.410 Test Loss: 4.108 Test Acc: 0.410
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.021406888961792
Epoch: 11, Steps: 13 | Train Loss: 2.328 Vali Loss: 7.683 Vali Acc: 0.332 Test Loss: 7.683 Test Acc: 0.332
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 7063590
model size : 31.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.809757947921753
Epoch: 1, Steps: 13 | Train Loss: 0.865 Vali Loss: 0.565 Vali Acc: 0.737 Test Loss: 0.565 Test Acc: 0.737
Validation loss decreased (inf --> -0.736580).  Saving model ...
Epoch: 2 cost time: 4.820919513702393
Epoch: 2, Steps: 13 | Train Loss: 2.201 Vali Loss: 6.616 Vali Acc: 0.278 Test Loss: 6.616 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.263077974319458
Epoch: 3, Steps: 13 | Train Loss: 2.154 Vali Loss: 4.465 Vali Acc: 0.283 Test Loss: 4.465 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.429387807846069
Epoch: 4, Steps: 13 | Train Loss: 0.761 Vali Loss: 0.521 Vali Acc: 0.756 Test Loss: 0.521 Test Acc: 0.756
Validation loss decreased (-0.736580 --> -0.756092).  Saving model ...
Epoch: 5 cost time: 4.288705825805664
Epoch: 5, Steps: 13 | Train Loss: 2.398 Vali Loss: 0.973 Vali Acc: 0.737 Test Loss: 0.973 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.626734256744385
Epoch: 6, Steps: 13 | Train Loss: 3.909 Vali Loss: 3.426 Vali Acc: 0.322 Test Loss: 3.426 Test Acc: 0.322
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.703178882598877
Epoch: 7, Steps: 13 | Train Loss: 0.994 Vali Loss: 1.021 Vali Acc: 0.600 Test Loss: 1.021 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.7401862144470215
Epoch: 8, Steps: 13 | Train Loss: 2.864 Vali Loss: 0.797 Vali Acc: 0.727 Test Loss: 0.797 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.2622785568237305
Epoch: 9, Steps: 13 | Train Loss: 5.196 Vali Loss: 3.755 Vali Acc: 0.405 Test Loss: 3.755 Test Acc: 0.405
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.165321350097656
Epoch: 10, Steps: 13 | Train Loss: 4.745 Vali Loss: 1.442 Vali Acc: 0.512 Test Loss: 1.442 Test Acc: 0.512
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.494222402572632
Epoch: 11, Steps: 13 | Train Loss: 3.044 Vali Loss: 18.245 Vali Acc: 0.278 Test Loss: 18.245 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.1630847454071045
Epoch: 12, Steps: 13 | Train Loss: 4.617 Vali Loss: 10.479 Vali Acc: 0.302 Test Loss: 10.479 Test Acc: 0.302
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 5.052361249923706
Epoch: 13, Steps: 13 | Train Loss: 6.139 Vali Loss: 10.337 Vali Acc: 0.722 Test Loss: 10.337 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 5.340329170227051
Epoch: 14, Steps: 13 | Train Loss: 1.653 Vali Loss: 3.190 Vali Acc: 0.741 Test Loss: 3.190 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 7050534
model size : 31.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.036734342575073
Epoch: 1, Steps: 13 | Train Loss: 1.346 Vali Loss: 1.399 Vali Acc: 0.278 Test Loss: 1.399 Test Acc: 0.278
Validation loss decreased (inf --> -0.278035).  Saving model ...
Epoch: 2 cost time: 4.2340779304504395
Epoch: 2, Steps: 13 | Train Loss: 1.491 Vali Loss: 1.076 Vali Acc: 0.337 Test Loss: 1.076 Test Acc: 0.337
Validation loss decreased (-0.278035 --> -0.336575).  Saving model ...
Epoch: 3 cost time: 4.447839975357056
Epoch: 3, Steps: 13 | Train Loss: 1.600 Vali Loss: 2.418 Vali Acc: 0.717 Test Loss: 2.418 Test Acc: 0.717
Validation loss decreased (-0.336575 --> -0.717049).  Saving model ...
Epoch: 4 cost time: 4.859776973724365
Epoch: 4, Steps: 13 | Train Loss: 1.051 Vali Loss: 0.611 Vali Acc: 0.693 Test Loss: 0.611 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.988905191421509
Epoch: 5, Steps: 13 | Train Loss: 0.451 Vali Loss: 0.725 Vali Acc: 0.741 Test Loss: 0.725 Test Acc: 0.741
Validation loss decreased (-0.717049 --> -0.741456).  Saving model ...
Epoch: 6 cost time: 5.2837536334991455
Epoch: 6, Steps: 13 | Train Loss: 2.166 Vali Loss: 2.167 Vali Acc: 0.312 Test Loss: 2.167 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.396369695663452
Epoch: 7, Steps: 13 | Train Loss: 0.647 Vali Loss: 4.691 Vali Acc: 0.722 Test Loss: 4.691 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.920650005340576
Epoch: 8, Steps: 13 | Train Loss: 2.271 Vali Loss: 4.436 Vali Acc: 0.712 Test Loss: 4.436 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.443573713302612
Epoch: 9, Steps: 13 | Train Loss: 1.798 Vali Loss: 3.798 Vali Acc: 0.722 Test Loss: 3.798 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.758829116821289
Epoch: 10, Steps: 13 | Train Loss: 2.034 Vali Loss: 2.776 Vali Acc: 0.478 Test Loss: 2.776 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.54475736618042
Epoch: 11, Steps: 13 | Train Loss: 1.409 Vali Loss: 3.626 Vali Acc: 0.390 Test Loss: 3.626 Test Acc: 0.390
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.6345813274383545
Epoch: 12, Steps: 13 | Train Loss: 0.852 Vali Loss: 5.515 Vali Acc: 0.722 Test Loss: 5.515 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.659532785415649
Epoch: 13, Steps: 13 | Train Loss: 2.034 Vali Loss: 3.817 Vali Acc: 0.737 Test Loss: 3.817 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.622254371643066
Epoch: 14, Steps: 13 | Train Loss: 2.057 Vali Loss: 2.305 Vali Acc: 0.537 Test Loss: 2.305 Test Acc: 0.537
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.651995420455933
Epoch: 15, Steps: 13 | Train Loss: 1.414 Vali Loss: 4.727 Vali Acc: 0.444 Test Loss: 4.727 Test Acc: 0.444
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 7037478
model size : 31.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.427482604980469
Epoch: 1, Steps: 13 | Train Loss: 1.164 Vali Loss: 1.497 Vali Acc: 0.712 Test Loss: 1.497 Test Acc: 0.712
Validation loss decreased (inf --> -0.712180).  Saving model ...
Epoch: 2 cost time: 4.578317880630493
Epoch: 2, Steps: 13 | Train Loss: 1.254 Vali Loss: 6.298 Vali Acc: 0.288 Test Loss: 6.298 Test Acc: 0.288
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.127001523971558
Epoch: 3, Steps: 13 | Train Loss: 2.250 Vali Loss: 0.700 Vali Acc: 0.629 Test Loss: 0.700 Test Acc: 0.629
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.792444229125977
Epoch: 4, Steps: 13 | Train Loss: 2.221 Vali Loss: 5.549 Vali Acc: 0.278 Test Loss: 5.549 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.786004066467285
Epoch: 5, Steps: 13 | Train Loss: 1.958 Vali Loss: 0.747 Vali Acc: 0.737 Test Loss: 0.747 Test Acc: 0.737
Validation loss decreased (-0.712180 --> -0.736578).  Saving model ...
Epoch: 6 cost time: 5.03572940826416
Epoch: 6, Steps: 13 | Train Loss: 1.156 Vali Loss: 0.731 Vali Acc: 0.737 Test Loss: 0.731 Test Acc: 0.737
Validation loss decreased (-0.736578 --> -0.736578).  Saving model ...
Epoch: 7 cost time: 4.517042636871338
Epoch: 7, Steps: 13 | Train Loss: 1.346 Vali Loss: 2.087 Vali Acc: 0.722 Test Loss: 2.087 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.988962411880493
Epoch: 8, Steps: 13 | Train Loss: 3.446 Vali Loss: 3.061 Vali Acc: 0.361 Test Loss: 3.061 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.702980995178223
Epoch: 9, Steps: 13 | Train Loss: 9.812 Vali Loss: 6.945 Vali Acc: 0.722 Test Loss: 6.945 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.799359083175659
Epoch: 10, Steps: 13 | Train Loss: 3.198 Vali Loss: 8.848 Vali Acc: 0.361 Test Loss: 8.848 Test Acc: 0.361
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.670516729354858
Epoch: 11, Steps: 13 | Train Loss: 6.743 Vali Loss: 5.679 Vali Acc: 0.712 Test Loss: 5.679 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.3530285358428955
Epoch: 12, Steps: 13 | Train Loss: 1.984 Vali Loss: 1.124 Vali Acc: 0.688 Test Loss: 1.124 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.061266183853149
Epoch: 13, Steps: 13 | Train Loss: 5.404 Vali Loss: 5.365 Vali Acc: 0.732 Test Loss: 5.365 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.661358118057251
Epoch: 14, Steps: 13 | Train Loss: 1.446 Vali Loss: 2.594 Vali Acc: 0.488 Test Loss: 2.594 Test Acc: 0.488
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.476090908050537
Epoch: 15, Steps: 13 | Train Loss: 2.489 Vali Loss: 3.325 Vali Acc: 0.741 Test Loss: 3.325 Test Acc: 0.741
Validation loss decreased (-0.736578 --> -0.741430).  Saving model ...
Epoch: 16 cost time: 4.746443271636963
Epoch: 16, Steps: 13 | Train Loss: 1.859 Vali Loss: 4.171 Vali Acc: 0.732 Test Loss: 4.171 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.160266160964966
Epoch: 17, Steps: 13 | Train Loss: 0.975 Vali Loss: 3.848 Vali Acc: 0.732 Test Loss: 3.848 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.772008895874023
Epoch: 18, Steps: 13 | Train Loss: 0.436 Vali Loss: 2.995 Vali Acc: 0.732 Test Loss: 2.995 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.167193651199341
Epoch: 19, Steps: 13 | Train Loss: 1.471 Vali Loss: 13.890 Vali Acc: 0.332 Test Loss: 13.890 Test Acc: 0.332
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.6646924018859863
Epoch: 20, Steps: 13 | Train Loss: 4.355 Vali Loss: 8.500 Vali Acc: 0.732 Test Loss: 8.500 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 5.127902269363403
Epoch: 21, Steps: 13 | Train Loss: 1.153 Vali Loss: 8.583 Vali Acc: 0.478 Test Loss: 8.583 Test Acc: 0.478
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.998638391494751
Epoch: 22, Steps: 13 | Train Loss: 3.728 Vali Loss: 22.500 Vali Acc: 0.288 Test Loss: 22.500 Test Acc: 0.288
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 4.868295431137085
Epoch: 23, Steps: 13 | Train Loss: 2.955 Vali Loss: 15.635 Vali Acc: 0.415 Test Loss: 15.635 Test Acc: 0.415
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.624195098876953
Epoch: 24, Steps: 13 | Train Loss: 1.782 Vali Loss: 7.105 Vali Acc: 0.737 Test Loss: 7.105 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.6010844707489014
Epoch: 25, Steps: 13 | Train Loss: 0.450 Vali Loss: 8.781 Vali Acc: 0.741 Test Loss: 8.781 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 7024422
model size : 31.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.5745320320129395
Epoch: 1, Steps: 13 | Train Loss: 1.103 Vali Loss: 4.275 Vali Acc: 0.288 Test Loss: 4.275 Test Acc: 0.288
Validation loss decreased (inf --> -0.287762).  Saving model ...
Epoch: 2 cost time: 4.918691396713257
Epoch: 2, Steps: 13 | Train Loss: 2.854 Vali Loss: 3.470 Vali Acc: 0.712 Test Loss: 3.470 Test Acc: 0.712
Validation loss decreased (-0.287762 --> -0.712160).  Saving model ...
Epoch: 3 cost time: 6.2565600872039795
Epoch: 3, Steps: 13 | Train Loss: 2.949 Vali Loss: 5.037 Vali Acc: 0.278 Test Loss: 5.037 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.585572242736816
Epoch: 4, Steps: 13 | Train Loss: 3.025 Vali Loss: 1.921 Vali Acc: 0.732 Test Loss: 1.921 Test Acc: 0.732
Validation loss decreased (-0.712160 --> -0.731688).  Saving model ...
Epoch: 5 cost time: 6.128318786621094
Epoch: 5, Steps: 13 | Train Loss: 4.541 Vali Loss: 6.406 Vali Acc: 0.293 Test Loss: 6.406 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.8860416412353516
Epoch: 6, Steps: 13 | Train Loss: 1.824 Vali Loss: 1.323 Vali Acc: 0.541 Test Loss: 1.323 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.987880229949951
Epoch: 7, Steps: 13 | Train Loss: 3.497 Vali Loss: 3.495 Vali Acc: 0.722 Test Loss: 3.495 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.422368049621582
Epoch: 8, Steps: 13 | Train Loss: 2.494 Vali Loss: 3.865 Vali Acc: 0.356 Test Loss: 3.865 Test Acc: 0.356
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.381687164306641
Epoch: 9, Steps: 13 | Train Loss: 1.772 Vali Loss: 2.477 Vali Acc: 0.727 Test Loss: 2.477 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.371585130691528
Epoch: 10, Steps: 13 | Train Loss: 0.865 Vali Loss: 2.522 Vali Acc: 0.737 Test Loss: 2.522 Test Acc: 0.737
Validation loss decreased (-0.731688 --> -0.736560).  Saving model ...
Epoch: 11 cost time: 4.7875142097473145
Epoch: 11, Steps: 13 | Train Loss: 4.823 Vali Loss: 5.659 Vali Acc: 0.722 Test Loss: 5.659 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.682911157608032
Epoch: 12, Steps: 13 | Train Loss: 8.895 Vali Loss: 10.480 Vali Acc: 0.322 Test Loss: 10.480 Test Acc: 0.322
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.635083436965942
Epoch: 13, Steps: 13 | Train Loss: 2.210 Vali Loss: 1.241 Vali Acc: 0.737 Test Loss: 1.241 Test Acc: 0.737
Validation loss decreased (-0.736560 --> -0.736573).  Saving model ...
Epoch: 14 cost time: 5.070780277252197
Epoch: 14, Steps: 13 | Train Loss: 0.749 Vali Loss: 3.103 Vali Acc: 0.737 Test Loss: 3.103 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.532626152038574
Epoch: 15, Steps: 13 | Train Loss: 1.171 Vali Loss: 6.554 Vali Acc: 0.322 Test Loss: 6.554 Test Acc: 0.322
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.40776252746582
Epoch: 16, Steps: 13 | Train Loss: 3.203 Vali Loss: 8.201 Vali Acc: 0.722 Test Loss: 8.201 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.346791982650757
Epoch: 17, Steps: 13 | Train Loss: 7.253 Vali Loss: 5.041 Vali Acc: 0.732 Test Loss: 5.041 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.933046340942383
Epoch: 18, Steps: 13 | Train Loss: 0.649 Vali Loss: 4.125 Vali Acc: 0.498 Test Loss: 4.125 Test Acc: 0.498
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.671153783798218
Epoch: 19, Steps: 13 | Train Loss: 0.228 Vali Loss: 2.207 Vali Acc: 0.698 Test Loss: 2.207 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 5.165844917297363
Epoch: 20, Steps: 13 | Train Loss: 4.056 Vali Loss: 5.325 Vali Acc: 0.483 Test Loss: 5.325 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 4.498301982879639
Epoch: 21, Steps: 13 | Train Loss: 1.410 Vali Loss: 4.890 Vali Acc: 0.537 Test Loss: 4.890 Test Acc: 0.537
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 5.0195934772491455
Epoch: 22, Steps: 13 | Train Loss: 0.498 Vali Loss: 7.634 Vali Acc: 0.737 Test Loss: 7.634 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.600095748901367
Epoch: 23, Steps: 13 | Train Loss: 0.772 Vali Loss: 10.654 Vali Acc: 0.727 Test Loss: 10.654 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 6735270
model size : 30.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.822888374328613
Epoch: 1, Steps: 13 | Train Loss: 1.331 Vali Loss: 0.843 Vali Acc: 0.722 Test Loss: 0.843 Test Acc: 0.722
Validation loss decreased (inf --> -0.721943).  Saving model ...
Epoch: 2 cost time: 4.814985752105713
Epoch: 2, Steps: 13 | Train Loss: 2.557 Vali Loss: 4.486 Vali Acc: 0.278 Test Loss: 4.486 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.249612808227539
Epoch: 3, Steps: 13 | Train Loss: 1.350 Vali Loss: 2.128 Vali Acc: 0.293 Test Loss: 2.128 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.547400236129761
Epoch: 4, Steps: 13 | Train Loss: 1.007 Vali Loss: 1.737 Vali Acc: 0.722 Test Loss: 1.737 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.385494947433472
Epoch: 5, Steps: 13 | Train Loss: 0.828 Vali Loss: 2.032 Vali Acc: 0.712 Test Loss: 2.032 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.706923484802246
Epoch: 6, Steps: 13 | Train Loss: 5.286 Vali Loss: 0.879 Vali Acc: 0.761 Test Loss: 0.879 Test Acc: 0.761
Validation loss decreased (-0.721943 --> -0.760967).  Saving model ...
Epoch: 7 cost time: 4.580374002456665
Epoch: 7, Steps: 13 | Train Loss: 0.876 Vali Loss: 1.813 Vali Acc: 0.727 Test Loss: 1.813 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.577149391174316
Epoch: 8, Steps: 13 | Train Loss: 1.106 Vali Loss: 2.011 Vali Acc: 0.737 Test Loss: 2.011 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.050209999084473
Epoch: 9, Steps: 13 | Train Loss: 1.131 Vali Loss: 0.734 Vali Acc: 0.693 Test Loss: 0.734 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.335278511047363
Epoch: 10, Steps: 13 | Train Loss: 3.076 Vali Loss: 1.557 Vali Acc: 0.732 Test Loss: 1.557 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.473818778991699
Epoch: 11, Steps: 13 | Train Loss: 6.869 Vali Loss: 2.077 Vali Acc: 0.737 Test Loss: 2.077 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.1737072467803955
Epoch: 12, Steps: 13 | Train Loss: 3.709 Vali Loss: 3.891 Vali Acc: 0.732 Test Loss: 3.891 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.404922962188721
Epoch: 13, Steps: 13 | Train Loss: 1.536 Vali Loss: 1.415 Vali Acc: 0.751 Test Loss: 1.415 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.973961353302002
Epoch: 14, Steps: 13 | Train Loss: 8.972 Vali Loss: 9.010 Vali Acc: 0.351 Test Loss: 9.010 Test Acc: 0.351
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.643033981323242
Epoch: 15, Steps: 13 | Train Loss: 2.212 Vali Loss: 2.654 Vali Acc: 0.741 Test Loss: 2.654 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.785231590270996
Epoch: 16, Steps: 13 | Train Loss: 2.609 Vali Loss: 2.968 Vali Acc: 0.741 Test Loss: 2.968 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 6722214
model size : 30.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.390107154846191
Epoch: 1, Steps: 13 | Train Loss: 0.669 Vali Loss: 0.749 Vali Acc: 0.405 Test Loss: 0.749 Test Acc: 0.405
Validation loss decreased (inf --> -0.404871).  Saving model ...
Epoch: 2 cost time: 4.782469272613525
Epoch: 2, Steps: 13 | Train Loss: 0.774 Vali Loss: 1.478 Vali Acc: 0.298 Test Loss: 1.478 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.948939085006714
Epoch: 3, Steps: 13 | Train Loss: 2.310 Vali Loss: 5.101 Vali Acc: 0.288 Test Loss: 5.101 Test Acc: 0.288
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.422597169876099
Epoch: 4, Steps: 13 | Train Loss: 2.419 Vali Loss: 2.048 Vali Acc: 0.332 Test Loss: 2.048 Test Acc: 0.332
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.836613178253174
Epoch: 5, Steps: 13 | Train Loss: 2.362 Vali Loss: 2.941 Vali Acc: 0.332 Test Loss: 2.941 Test Acc: 0.332
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.415847539901733
Epoch: 6, Steps: 13 | Train Loss: 2.714 Vali Loss: 0.767 Vali Acc: 0.766 Test Loss: 0.767 Test Acc: 0.766
Validation loss decreased (-0.404871 --> -0.765846).  Saving model ...
Epoch: 7 cost time: 4.526008367538452
Epoch: 7, Steps: 13 | Train Loss: 1.058 Vali Loss: 2.034 Vali Acc: 0.722 Test Loss: 2.034 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.411666631698608
Epoch: 8, Steps: 13 | Train Loss: 0.994 Vali Loss: 2.363 Vali Acc: 0.722 Test Loss: 2.363 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.835657596588135
Epoch: 9, Steps: 13 | Train Loss: 2.032 Vali Loss: 1.353 Vali Acc: 0.746 Test Loss: 1.353 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.7816267013549805
Epoch: 10, Steps: 13 | Train Loss: 2.856 Vali Loss: 2.306 Vali Acc: 0.502 Test Loss: 2.306 Test Acc: 0.502
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.220363616943359
Epoch: 11, Steps: 13 | Train Loss: 2.538 Vali Loss: 10.248 Vali Acc: 0.302 Test Loss: 10.248 Test Acc: 0.302
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.690619230270386
Epoch: 12, Steps: 13 | Train Loss: 5.255 Vali Loss: 1.872 Vali Acc: 0.537 Test Loss: 1.872 Test Acc: 0.537
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.8899006843566895
Epoch: 13, Steps: 13 | Train Loss: 2.209 Vali Loss: 6.512 Vali Acc: 0.337 Test Loss: 6.512 Test Acc: 0.337
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.9342546463012695
Epoch: 14, Steps: 13 | Train Loss: 1.559 Vali Loss: 1.812 Vali Acc: 0.751 Test Loss: 1.812 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.6173758506774902
Epoch: 15, Steps: 13 | Train Loss: 1.558 Vali Loss: 21.757 Vali Acc: 0.283 Test Loss: 21.757 Test Acc: 0.283
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.849765300750732
Epoch: 16, Steps: 13 | Train Loss: 4.681 Vali Loss: 9.681 Vali Acc: 0.346 Test Loss: 9.681 Test Acc: 0.346
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 6709158
model size : 30.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.941357135772705
Epoch: 1, Steps: 13 | Train Loss: 0.956 Vali Loss: 1.243 Vali Acc: 0.283 Test Loss: 1.243 Test Acc: 0.283
Validation loss decreased (inf --> -0.282914).  Saving model ...
Epoch: 2 cost time: 5.0591089725494385
Epoch: 2, Steps: 13 | Train Loss: 1.675 Vali Loss: 8.195 Vali Acc: 0.278 Test Loss: 8.195 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.046567916870117
Epoch: 3, Steps: 13 | Train Loss: 2.480 Vali Loss: 0.762 Vali Acc: 0.732 Test Loss: 0.762 Test Acc: 0.732
Validation loss decreased (-0.282914 --> -0.731700).  Saving model ...
Epoch: 4 cost time: 4.774935722351074
Epoch: 4, Steps: 13 | Train Loss: 1.149 Vali Loss: 0.604 Vali Acc: 0.702 Test Loss: 0.604 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.5353844165802
Epoch: 5, Steps: 13 | Train Loss: 4.329 Vali Loss: 1.979 Vali Acc: 0.366 Test Loss: 1.979 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.7857067584991455
Epoch: 6, Steps: 13 | Train Loss: 2.873 Vali Loss: 9.085 Vali Acc: 0.293 Test Loss: 9.085 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.484996557235718
Epoch: 7, Steps: 13 | Train Loss: 5.610 Vali Loss: 5.565 Vali Acc: 0.712 Test Loss: 5.565 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.4736597537994385
Epoch: 8, Steps: 13 | Train Loss: 4.203 Vali Loss: 5.952 Vali Acc: 0.420 Test Loss: 5.952 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.176846981048584
Epoch: 9, Steps: 13 | Train Loss: 3.759 Vali Loss: 3.244 Vali Acc: 0.741 Test Loss: 3.244 Test Acc: 0.741
Validation loss decreased (-0.731700 --> -0.741431).  Saving model ...
Epoch: 10 cost time: 5.1821770668029785
Epoch: 10, Steps: 13 | Train Loss: 2.680 Vali Loss: 8.296 Vali Acc: 0.712 Test Loss: 8.296 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.4208433628082275
Epoch: 11, Steps: 13 | Train Loss: 3.179 Vali Loss: 4.722 Vali Acc: 0.444 Test Loss: 4.722 Test Acc: 0.444
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.336271286010742
Epoch: 12, Steps: 13 | Train Loss: 3.941 Vali Loss: 1.357 Vali Acc: 0.717 Test Loss: 1.357 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.6819241046905518
Epoch: 13, Steps: 13 | Train Loss: 2.766 Vali Loss: 1.534 Vali Acc: 0.663 Test Loss: 1.534 Test Acc: 0.663
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.00626540184021
Epoch: 14, Steps: 13 | Train Loss: 4.418 Vali Loss: 7.334 Vali Acc: 0.380 Test Loss: 7.334 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.764881134033203
Epoch: 15, Steps: 13 | Train Loss: 2.621 Vali Loss: 14.970 Vali Acc: 0.317 Test Loss: 14.970 Test Acc: 0.317
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.57073712348938
Epoch: 16, Steps: 13 | Train Loss: 4.390 Vali Loss: 9.308 Vali Acc: 0.722 Test Loss: 9.308 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.309475660324097
Epoch: 17, Steps: 13 | Train Loss: 3.071 Vali Loss: 2.377 Vali Acc: 0.673 Test Loss: 2.377 Test Acc: 0.673
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.462035655975342
Epoch: 18, Steps: 13 | Train Loss: 3.846 Vali Loss: 3.720 Vali Acc: 0.732 Test Loss: 3.720 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.719642162322998
Epoch: 19, Steps: 13 | Train Loss: 2.153 Vali Loss: 8.073 Vali Acc: 0.722 Test Loss: 8.073 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 6696102
model size : 30.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.393634080886841
Epoch: 1, Steps: 13 | Train Loss: 0.676 Vali Loss: 0.566 Vali Acc: 0.722 Test Loss: 0.566 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 3.596513509750366
Epoch: 2, Steps: 13 | Train Loss: 0.947 Vali Loss: 0.779 Vali Acc: 0.483 Test Loss: 0.779 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.071099042892456
Epoch: 3, Steps: 13 | Train Loss: 0.824 Vali Loss: 1.584 Vali Acc: 0.293 Test Loss: 1.584 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.403087854385376
Epoch: 4, Steps: 13 | Train Loss: 1.049 Vali Loss: 0.789 Vali Acc: 0.571 Test Loss: 0.789 Test Acc: 0.571
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.7605013847351074
Epoch: 5, Steps: 13 | Train Loss: 0.668 Vali Loss: 3.096 Vali Acc: 0.293 Test Loss: 3.096 Test Acc: 0.293
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.398167133331299
Epoch: 6, Steps: 13 | Train Loss: 1.404 Vali Loss: 1.340 Vali Acc: 0.405 Test Loss: 1.340 Test Acc: 0.405
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.924028635025024
Epoch: 7, Steps: 13 | Train Loss: 0.847 Vali Loss: 0.649 Vali Acc: 0.634 Test Loss: 0.649 Test Acc: 0.634
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.0828981399536133
Epoch: 8, Steps: 13 | Train Loss: 0.626 Vali Loss: 4.324 Vali Acc: 0.288 Test Loss: 4.324 Test Acc: 0.288
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.2688794136047363
Epoch: 9, Steps: 13 | Train Loss: 1.617 Vali Loss: 2.386 Vali Acc: 0.298 Test Loss: 2.386 Test Acc: 0.298
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.2161624431610107
Epoch: 10, Steps: 13 | Train Loss: 1.336 Vali Loss: 2.037 Vali Acc: 0.332 Test Loss: 2.037 Test Acc: 0.332
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.289926052093506
Epoch: 11, Steps: 13 | Train Loss: 1.064 Vali Loss: 1.943 Vali Acc: 0.732 Test Loss: 1.943 Test Acc: 0.732
Validation loss decreased (-0.721946 --> -0.731688).  Saving model ...
Epoch: 12 cost time: 3.159972906112671
Epoch: 12, Steps: 13 | Train Loss: 0.807 Vali Loss: 2.692 Vali Acc: 0.737 Test Loss: 2.692 Test Acc: 0.737
Validation loss decreased (-0.731688 --> -0.736558).  Saving model ...
Epoch: 13 cost time: 4.399820327758789
Epoch: 13, Steps: 13 | Train Loss: 1.917 Vali Loss: 1.062 Vali Acc: 0.698 Test Loss: 1.062 Test Acc: 0.698
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.115689516067505
Epoch: 14, Steps: 13 | Train Loss: 2.953 Vali Loss: 1.034 Vali Acc: 0.722 Test Loss: 1.034 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.65662693977356
Epoch: 15, Steps: 13 | Train Loss: 5.929 Vali Loss: 1.541 Vali Acc: 0.756 Test Loss: 1.541 Test Acc: 0.756
Validation loss decreased (-0.736558 --> -0.756082).  Saving model ...
Epoch: 16 cost time: 3.8240737915039062
Epoch: 16, Steps: 13 | Train Loss: 0.463 Vali Loss: 1.710 Vali Acc: 0.741 Test Loss: 1.710 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.6224584579467773
Epoch: 17, Steps: 13 | Train Loss: 0.900 Vali Loss: 2.258 Vali Acc: 0.483 Test Loss: 2.258 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.8282763957977295
Epoch: 18, Steps: 13 | Train Loss: 0.805 Vali Loss: 6.323 Vali Acc: 0.332 Test Loss: 6.323 Test Acc: 0.332
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.0777363777160645
Epoch: 19, Steps: 13 | Train Loss: 0.947 Vali Loss: 3.976 Vali Acc: 0.454 Test Loss: 3.976 Test Acc: 0.454
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.8979508876800537
Epoch: 20, Steps: 13 | Train Loss: 2.716 Vali Loss: 8.696 Vali Acc: 0.727 Test Loss: 8.696 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.094837665557861
Epoch: 21, Steps: 13 | Train Loss: 1.528 Vali Loss: 2.821 Vali Acc: 0.722 Test Loss: 2.821 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.289968490600586
Epoch: 22, Steps: 13 | Train Loss: 4.363 Vali Loss: 9.855 Vali Acc: 0.722 Test Loss: 9.855 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.886230707168579
Epoch: 23, Steps: 13 | Train Loss: 0.728 Vali Loss: 5.999 Vali Acc: 0.737 Test Loss: 5.999 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.0468974113464355
Epoch: 24, Steps: 13 | Train Loss: 3.861 Vali Loss: 2.855 Vali Acc: 0.644 Test Loss: 2.855 Test Acc: 0.644
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.878798007965088
Epoch: 25, Steps: 13 | Train Loss: 0.712 Vali Loss: 3.333 Vali Acc: 0.610 Test Loss: 3.333 Test Acc: 0.610
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 3208614
model size : 14.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.815566062927246
Epoch: 1, Steps: 13 | Train Loss: 0.993 Vali Loss: 0.605 Vali Acc: 0.717 Test Loss: 0.605 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 3.517864942550659
Epoch: 2, Steps: 13 | Train Loss: 1.351 Vali Loss: 1.254 Vali Acc: 0.722 Test Loss: 1.254 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721939).  Saving model ...
Epoch: 3 cost time: 4.243899583816528
Epoch: 3, Steps: 13 | Train Loss: 1.104 Vali Loss: 0.517 Vali Acc: 0.751 Test Loss: 0.517 Test Acc: 0.751
Validation loss decreased (-0.721939 --> -0.751214).  Saving model ...
Epoch: 4 cost time: 4.906254291534424
Epoch: 4, Steps: 13 | Train Loss: 0.932 Vali Loss: 1.489 Vali Acc: 0.322 Test Loss: 1.489 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.076629400253296
Epoch: 5, Steps: 13 | Train Loss: 0.724 Vali Loss: 0.661 Vali Acc: 0.634 Test Loss: 0.661 Test Acc: 0.634
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.0169782638549805
Epoch: 6, Steps: 13 | Train Loss: 0.928 Vali Loss: 0.561 Vali Acc: 0.746 Test Loss: 0.561 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.18766188621521
Epoch: 7, Steps: 13 | Train Loss: 1.849 Vali Loss: 0.649 Vali Acc: 0.659 Test Loss: 0.649 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.4540979862213135
Epoch: 8, Steps: 13 | Train Loss: 0.662 Vali Loss: 2.483 Vali Acc: 0.722 Test Loss: 2.483 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.5330283641815186
Epoch: 9, Steps: 13 | Train Loss: 1.287 Vali Loss: 0.996 Vali Acc: 0.766 Test Loss: 0.996 Test Acc: 0.766
Validation loss decreased (-0.751214 --> -0.765844).  Saving model ...
Epoch: 10 cost time: 3.8147239685058594
Epoch: 10, Steps: 13 | Train Loss: 1.005 Vali Loss: 1.243 Vali Acc: 0.546 Test Loss: 1.243 Test Acc: 0.546
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.8851206302642822
Epoch: 11, Steps: 13 | Train Loss: 0.900 Vali Loss: 7.831 Vali Acc: 0.288 Test Loss: 7.831 Test Acc: 0.288
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.589653968811035
Epoch: 12, Steps: 13 | Train Loss: 3.271 Vali Loss: 4.923 Vali Acc: 0.722 Test Loss: 4.923 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.225533962249756
Epoch: 13, Steps: 13 | Train Loss: 1.186 Vali Loss: 3.856 Vali Acc: 0.400 Test Loss: 3.856 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.326019287109375
Epoch: 14, Steps: 13 | Train Loss: 3.456 Vali Loss: 1.258 Vali Acc: 0.663 Test Loss: 1.258 Test Acc: 0.663
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.338072776794434
Epoch: 15, Steps: 13 | Train Loss: 3.746 Vali Loss: 2.820 Vali Acc: 0.732 Test Loss: 2.820 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.908842086791992
Epoch: 16, Steps: 13 | Train Loss: 0.894 Vali Loss: 1.129 Vali Acc: 0.673 Test Loss: 1.129 Test Acc: 0.673
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.919935703277588
Epoch: 17, Steps: 13 | Train Loss: 0.321 Vali Loss: 2.739 Vali Acc: 0.488 Test Loss: 2.739 Test Acc: 0.488
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.8777921199798584
Epoch: 18, Steps: 13 | Train Loss: 2.732 Vali Loss: 2.517 Vali Acc: 0.751 Test Loss: 2.517 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.075903654098511
Epoch: 19, Steps: 13 | Train Loss: 0.361 Vali Loss: 1.787 Vali Acc: 0.663 Test Loss: 1.787 Test Acc: 0.663
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 3202086
model size : 14.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.276587247848511
Epoch: 1, Steps: 13 | Train Loss: 1.047 Vali Loss: 0.636 Vali Acc: 0.722 Test Loss: 0.636 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.1232523918151855
Epoch: 2, Steps: 13 | Train Loss: 1.058 Vali Loss: 0.677 Vali Acc: 0.561 Test Loss: 0.677 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.6120057106018066
Epoch: 3, Steps: 13 | Train Loss: 0.757 Vali Loss: 0.757 Vali Acc: 0.722 Test Loss: 0.757 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.797607421875
Epoch: 4, Steps: 13 | Train Loss: 1.119 Vali Loss: 1.242 Vali Acc: 0.337 Test Loss: 1.242 Test Acc: 0.337
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.702141523361206
Epoch: 5, Steps: 13 | Train Loss: 0.990 Vali Loss: 1.486 Vali Acc: 0.390 Test Loss: 1.486 Test Acc: 0.390
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.9451656341552734
Epoch: 6, Steps: 13 | Train Loss: 1.242 Vali Loss: 0.596 Vali Acc: 0.746 Test Loss: 0.596 Test Acc: 0.746
Validation loss decreased (-0.721945 --> -0.746336).  Saving model ...
Epoch: 7 cost time: 4.039708614349365
Epoch: 7, Steps: 13 | Train Loss: 0.669 Vali Loss: 1.158 Vali Acc: 0.434 Test Loss: 1.158 Test Acc: 0.434
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.50042724609375
Epoch: 8, Steps: 13 | Train Loss: 0.634 Vali Loss: 0.595 Vali Acc: 0.683 Test Loss: 0.595 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.2398219108581543
Epoch: 9, Steps: 13 | Train Loss: 2.308 Vali Loss: 2.166 Vali Acc: 0.341 Test Loss: 2.166 Test Acc: 0.341
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.066095590591431
Epoch: 10, Steps: 13 | Train Loss: 0.447 Vali Loss: 3.080 Vali Acc: 0.346 Test Loss: 3.080 Test Acc: 0.346
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.7855072021484375
Epoch: 11, Steps: 13 | Train Loss: 3.226 Vali Loss: 3.148 Vali Acc: 0.712 Test Loss: 3.148 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.500457763671875
Epoch: 12, Steps: 13 | Train Loss: 1.745 Vali Loss: 2.060 Vali Acc: 0.727 Test Loss: 2.060 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.6050100326538086
Epoch: 13, Steps: 13 | Train Loss: 0.476 Vali Loss: 5.748 Vali Acc: 0.288 Test Loss: 5.748 Test Acc: 0.288
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.1230762004852295
Epoch: 14, Steps: 13 | Train Loss: 1.812 Vali Loss: 1.201 Vali Acc: 0.551 Test Loss: 1.201 Test Acc: 0.551
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.202133417129517
Epoch: 15, Steps: 13 | Train Loss: 0.796 Vali Loss: 1.072 Vali Acc: 0.659 Test Loss: 1.072 Test Acc: 0.659
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.8302314281463623
Epoch: 16, Steps: 13 | Train Loss: 0.305 Vali Loss: 3.973 Vali Acc: 0.356 Test Loss: 3.973 Test Acc: 0.356
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 3195558
model size : 14.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.025312423706055
Epoch: 1, Steps: 13 | Train Loss: 0.735 Vali Loss: 0.616 Vali Acc: 0.722 Test Loss: 0.616 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 3.3578362464904785
Epoch: 2, Steps: 13 | Train Loss: 0.882 Vali Loss: 1.793 Vali Acc: 0.278 Test Loss: 1.793 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.572903871536255
Epoch: 3, Steps: 13 | Train Loss: 1.222 Vali Loss: 0.813 Vali Acc: 0.454 Test Loss: 0.813 Test Acc: 0.454
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.000731468200684
Epoch: 4, Steps: 13 | Train Loss: 1.078 Vali Loss: 1.125 Vali Acc: 0.722 Test Loss: 1.125 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.899930000305176
Epoch: 5, Steps: 13 | Train Loss: 0.865 Vali Loss: 2.114 Vali Acc: 0.722 Test Loss: 2.114 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.30003809928894
Epoch: 6, Steps: 13 | Train Loss: 0.608 Vali Loss: 0.550 Vali Acc: 0.693 Test Loss: 0.550 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.863908052444458
Epoch: 7, Steps: 13 | Train Loss: 2.270 Vali Loss: 3.831 Vali Acc: 0.278 Test Loss: 3.831 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.9174952507019043
Epoch: 8, Steps: 13 | Train Loss: 0.884 Vali Loss: 0.807 Vali Acc: 0.610 Test Loss: 0.807 Test Acc: 0.610
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.693060874938965
Epoch: 9, Steps: 13 | Train Loss: 0.956 Vali Loss: 1.274 Vali Acc: 0.751 Test Loss: 1.274 Test Acc: 0.751
Validation loss decreased (-0.721945 --> -0.751207).  Saving model ...
Epoch: 10 cost time: 3.3104193210601807
Epoch: 10, Steps: 13 | Train Loss: 1.357 Vali Loss: 0.744 Vali Acc: 0.727 Test Loss: 0.744 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.5973424911499023
Epoch: 11, Steps: 13 | Train Loss: 0.663 Vali Loss: 4.354 Vali Acc: 0.307 Test Loss: 4.354 Test Acc: 0.307
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.548203468322754
Epoch: 12, Steps: 13 | Train Loss: 0.973 Vali Loss: 0.884 Vali Acc: 0.722 Test Loss: 0.884 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.454690933227539
Epoch: 13, Steps: 13 | Train Loss: 0.328 Vali Loss: 0.904 Vali Acc: 0.693 Test Loss: 0.904 Test Acc: 0.693
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.8264245986938477
Epoch: 14, Steps: 13 | Train Loss: 0.733 Vali Loss: 3.802 Vali Acc: 0.410 Test Loss: 3.802 Test Acc: 0.410
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.214773416519165
Epoch: 15, Steps: 13 | Train Loss: 0.621 Vali Loss: 1.341 Vali Acc: 0.663 Test Loss: 1.341 Test Acc: 0.663
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.7213335037231445
Epoch: 16, Steps: 13 | Train Loss: 1.320 Vali Loss: 1.346 Vali Acc: 0.678 Test Loss: 1.346 Test Acc: 0.678
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.120300054550171
Epoch: 17, Steps: 13 | Train Loss: 5.827 Vali Loss: 7.690 Vali Acc: 0.712 Test Loss: 7.690 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.149195909500122
Epoch: 18, Steps: 13 | Train Loss: 1.355 Vali Loss: 1.604 Vali Acc: 0.693 Test Loss: 1.604 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.3037848472595215
Epoch: 19, Steps: 13 | Train Loss: 0.330 Vali Loss: 1.763 Vali Acc: 0.688 Test Loss: 1.763 Test Acc: 0.688
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 3189030
model size : 14.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.095180988311768
Epoch: 1, Steps: 13 | Train Loss: 0.686 Vali Loss: 0.874 Vali Acc: 0.722 Test Loss: 0.874 Test Acc: 0.722
Validation loss decreased (inf --> -0.721942).  Saving model ...
Epoch: 2 cost time: 3.635063886642456
Epoch: 2, Steps: 13 | Train Loss: 0.893 Vali Loss: 0.538 Vali Acc: 0.737 Test Loss: 0.538 Test Acc: 0.737
Validation loss decreased (-0.721942 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 3.9122772216796875
Epoch: 3, Steps: 13 | Train Loss: 0.907 Vali Loss: 1.419 Vali Acc: 0.298 Test Loss: 1.419 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.206545352935791
Epoch: 4, Steps: 13 | Train Loss: 0.848 Vali Loss: 0.570 Vali Acc: 0.741 Test Loss: 0.570 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741458).  Saving model ...
Epoch: 5 cost time: 4.569453954696655
Epoch: 5, Steps: 13 | Train Loss: 2.785 Vali Loss: 6.102 Vali Acc: 0.278 Test Loss: 6.102 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.572457551956177
Epoch: 6, Steps: 13 | Train Loss: 3.183 Vali Loss: 3.969 Vali Acc: 0.722 Test Loss: 3.969 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.9967494010925293
Epoch: 7, Steps: 13 | Train Loss: 2.641 Vali Loss: 3.812 Vali Acc: 0.302 Test Loss: 3.812 Test Acc: 0.302
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.6815521717071533
Epoch: 8, Steps: 13 | Train Loss: 1.934 Vali Loss: 3.498 Vali Acc: 0.317 Test Loss: 3.498 Test Acc: 0.317
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.500201463699341
Epoch: 9, Steps: 13 | Train Loss: 4.075 Vali Loss: 6.326 Vali Acc: 0.278 Test Loss: 6.326 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.980897903442383
Epoch: 10, Steps: 13 | Train Loss: 2.420 Vali Loss: 1.175 Vali Acc: 0.512 Test Loss: 1.175 Test Acc: 0.512
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.113051414489746
Epoch: 11, Steps: 13 | Train Loss: 1.649 Vali Loss: 1.266 Vali Acc: 0.537 Test Loss: 1.266 Test Acc: 0.537
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.6708881855010986
Epoch: 12, Steps: 13 | Train Loss: 1.618 Vali Loss: 1.478 Vali Acc: 0.532 Test Loss: 1.478 Test Acc: 0.532
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.2921547889709473
Epoch: 13, Steps: 13 | Train Loss: 1.284 Vali Loss: 1.162 Vali Acc: 0.566 Test Loss: 1.162 Test Acc: 0.566
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.927891492843628
Epoch: 14, Steps: 13 | Train Loss: 0.858 Vali Loss: 3.661 Vali Acc: 0.727 Test Loss: 3.661 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 2550694
model size : 12.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.307750701904297
Epoch: 1, Steps: 13 | Train Loss: 0.902 Vali Loss: 0.574 Vali Acc: 0.722 Test Loss: 0.574 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 3.8783843517303467
Epoch: 2, Steps: 13 | Train Loss: 0.957 Vali Loss: 0.553 Vali Acc: 0.732 Test Loss: 0.553 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 3.062971353530884
Epoch: 3, Steps: 13 | Train Loss: 0.620 Vali Loss: 0.564 Vali Acc: 0.732 Test Loss: 0.564 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.614147186279297
Epoch: 4, Steps: 13 | Train Loss: 1.601 Vali Loss: 1.879 Vali Acc: 0.278 Test Loss: 1.879 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.9501688480377197
Epoch: 5, Steps: 13 | Train Loss: 0.847 Vali Loss: 1.376 Vali Acc: 0.312 Test Loss: 1.376 Test Acc: 0.312
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.0510926246643066
Epoch: 6, Steps: 13 | Train Loss: 1.262 Vali Loss: 1.298 Vali Acc: 0.717 Test Loss: 1.298 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.357697010040283
Epoch: 7, Steps: 13 | Train Loss: 0.645 Vali Loss: 0.690 Vali Acc: 0.620 Test Loss: 0.690 Test Acc: 0.620
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.805833578109741
Epoch: 8, Steps: 13 | Train Loss: 0.572 Vali Loss: 0.755 Vali Acc: 0.634 Test Loss: 0.755 Test Acc: 0.634
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.784285306930542
Epoch: 9, Steps: 13 | Train Loss: 0.454 Vali Loss: 1.269 Vali Acc: 0.737 Test Loss: 1.269 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736573).  Saving model ...
Epoch: 10 cost time: 3.622114658355713
Epoch: 10, Steps: 13 | Train Loss: 1.096 Vali Loss: 3.436 Vali Acc: 0.293 Test Loss: 3.436 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.4719130992889404
Epoch: 11, Steps: 13 | Train Loss: 1.138 Vali Loss: 0.819 Vali Acc: 0.741 Test Loss: 0.819 Test Acc: 0.741
Validation loss decreased (-0.736573 --> -0.741455).  Saving model ...
Epoch: 12 cost time: 3.9065639972686768
Epoch: 12, Steps: 13 | Train Loss: 2.163 Vali Loss: 3.266 Vali Acc: 0.351 Test Loss: 3.266 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.483193635940552
Epoch: 13, Steps: 13 | Train Loss: 1.795 Vali Loss: 4.199 Vali Acc: 0.337 Test Loss: 4.199 Test Acc: 0.337
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.035230875015259
Epoch: 14, Steps: 13 | Train Loss: 1.451 Vali Loss: 6.747 Vali Acc: 0.307 Test Loss: 6.747 Test Acc: 0.307
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.791952610015869
Epoch: 15, Steps: 13 | Train Loss: 2.376 Vali Loss: 5.895 Vali Acc: 0.722 Test Loss: 5.895 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.7693283557891846
Epoch: 16, Steps: 13 | Train Loss: 1.712 Vali Loss: 4.304 Vali Acc: 0.415 Test Loss: 4.304 Test Acc: 0.415
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.146714925765991
Epoch: 17, Steps: 13 | Train Loss: 0.457 Vali Loss: 1.705 Vali Acc: 0.717 Test Loss: 1.705 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.592693567276001
Epoch: 18, Steps: 13 | Train Loss: 2.916 Vali Loss: 7.234 Vali Acc: 0.366 Test Loss: 7.234 Test Acc: 0.366
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.181359767913818
Epoch: 19, Steps: 13 | Train Loss: 0.830 Vali Loss: 1.665 Vali Acc: 0.644 Test Loss: 1.665 Test Acc: 0.644
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.6969830989837646
Epoch: 20, Steps: 13 | Train Loss: 0.361 Vali Loss: 1.972 Vali Acc: 0.600 Test Loss: 1.972 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.754356622695923
Epoch: 21, Steps: 13 | Train Loss: 1.151 Vali Loss: 1.823 Vali Acc: 0.683 Test Loss: 1.823 Test Acc: 0.683
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 2544166
model size : 12.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.835530519485474
Epoch: 1, Steps: 13 | Train Loss: 0.777 Vali Loss: 1.824 Vali Acc: 0.288 Test Loss: 1.824 Test Acc: 0.288
Validation loss decreased (inf --> -0.287787).  Saving model ...
Epoch: 2 cost time: 3.537799596786499
Epoch: 2, Steps: 13 | Train Loss: 1.166 Vali Loss: 0.706 Vali Acc: 0.717 Test Loss: 0.706 Test Acc: 0.717
Validation loss decreased (-0.287787 --> -0.717066).  Saving model ...
Epoch: 3 cost time: 3.2434542179107666
Epoch: 3, Steps: 13 | Train Loss: 0.712 Vali Loss: 0.631 Vali Acc: 0.663 Test Loss: 0.631 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.593812942504883
Epoch: 4, Steps: 13 | Train Loss: 0.631 Vali Loss: 0.555 Vali Acc: 0.702 Test Loss: 0.555 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.590296506881714
Epoch: 5, Steps: 13 | Train Loss: 1.205 Vali Loss: 1.241 Vali Acc: 0.722 Test Loss: 1.241 Test Acc: 0.722
Validation loss decreased (-0.717066 --> -0.721939).  Saving model ...
Epoch: 6 cost time: 3.373042345046997
Epoch: 6, Steps: 13 | Train Loss: 2.089 Vali Loss: 1.837 Vali Acc: 0.712 Test Loss: 1.837 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.556638717651367
Epoch: 7, Steps: 13 | Train Loss: 1.210 Vali Loss: 0.604 Vali Acc: 0.737 Test Loss: 0.604 Test Acc: 0.737
Validation loss decreased (-0.721939 --> -0.736579).  Saving model ...
Epoch: 8 cost time: 3.4794886112213135
Epoch: 8, Steps: 13 | Train Loss: 0.713 Vali Loss: 1.627 Vali Acc: 0.727 Test Loss: 1.627 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.6152241230010986
Epoch: 9, Steps: 13 | Train Loss: 1.293 Vali Loss: 3.172 Vali Acc: 0.298 Test Loss: 3.172 Test Acc: 0.298
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.785438299179077
Epoch: 10, Steps: 13 | Train Loss: 1.138 Vali Loss: 2.857 Vali Acc: 0.312 Test Loss: 2.857 Test Acc: 0.312
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.3153157234191895
Epoch: 11, Steps: 13 | Train Loss: 2.396 Vali Loss: 1.090 Vali Acc: 0.741 Test Loss: 1.090 Test Acc: 0.741
Validation loss decreased (-0.736579 --> -0.741453).  Saving model ...
Epoch: 12 cost time: 3.715333938598633
Epoch: 12, Steps: 13 | Train Loss: 0.961 Vali Loss: 1.026 Vali Acc: 0.620 Test Loss: 1.026 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.795889139175415
Epoch: 13, Steps: 13 | Train Loss: 1.828 Vali Loss: 10.136 Vali Acc: 0.278 Test Loss: 10.136 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.652261257171631
Epoch: 14, Steps: 13 | Train Loss: 3.356 Vali Loss: 1.836 Vali Acc: 0.761 Test Loss: 1.836 Test Acc: 0.761
Validation loss decreased (-0.741453 --> -0.760957).  Saving model ...
Epoch: 15 cost time: 3.5334575176239014
Epoch: 15, Steps: 13 | Train Loss: 1.592 Vali Loss: 3.650 Vali Acc: 0.746 Test Loss: 3.650 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.872425079345703
Epoch: 16, Steps: 13 | Train Loss: 0.551 Vali Loss: 3.147 Vali Acc: 0.741 Test Loss: 3.147 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.9982221126556396
Epoch: 17, Steps: 13 | Train Loss: 0.579 Vali Loss: 2.725 Vali Acc: 0.737 Test Loss: 2.725 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.9419033527374268
Epoch: 18, Steps: 13 | Train Loss: 1.055 Vali Loss: 3.834 Vali Acc: 0.459 Test Loss: 3.834 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.6470937728881836
Epoch: 19, Steps: 13 | Train Loss: 1.627 Vali Loss: 10.870 Vali Acc: 0.317 Test Loss: 10.870 Test Acc: 0.317
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.799518585205078
Epoch: 20, Steps: 13 | Train Loss: 3.580 Vali Loss: 2.450 Vali Acc: 0.688 Test Loss: 2.450 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.3493587970733643
Epoch: 21, Steps: 13 | Train Loss: 2.571 Vali Loss: 3.381 Vali Acc: 0.746 Test Loss: 3.381 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.1618247032165527
Epoch: 22, Steps: 13 | Train Loss: 0.783 Vali Loss: 3.519 Vali Acc: 0.737 Test Loss: 3.519 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.2094030380249023
Epoch: 23, Steps: 13 | Train Loss: 0.329 Vali Loss: 4.904 Vali Acc: 0.732 Test Loss: 4.904 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.652332067489624
Epoch: 24, Steps: 13 | Train Loss: 0.575 Vali Loss: 2.747 Vali Acc: 0.722 Test Loss: 2.747 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 2537638
model size : 12.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.339096307754517
Epoch: 1, Steps: 13 | Train Loss: 0.729 Vali Loss: 0.694 Vali Acc: 0.722 Test Loss: 0.694 Test Acc: 0.722
Validation loss decreased (inf --> -0.721944).  Saving model ...
Epoch: 2 cost time: 3.202383518218994
Epoch: 2, Steps: 13 | Train Loss: 0.794 Vali Loss: 0.775 Vali Acc: 0.420 Test Loss: 0.775 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.643951892852783
Epoch: 3, Steps: 13 | Train Loss: 0.585 Vali Loss: 0.543 Vali Acc: 0.727 Test Loss: 0.543 Test Acc: 0.727
Validation loss decreased (-0.721944 --> -0.726824).  Saving model ...
Epoch: 4 cost time: 3.1463260650634766
Epoch: 4, Steps: 13 | Train Loss: 0.818 Vali Loss: 0.688 Vali Acc: 0.741 Test Loss: 0.688 Test Acc: 0.741
Validation loss decreased (-0.726824 --> -0.741457).  Saving model ...
Epoch: 5 cost time: 3.8859894275665283
Epoch: 5, Steps: 13 | Train Loss: 1.792 Vali Loss: 0.630 Vali Acc: 0.741 Test Loss: 0.630 Test Acc: 0.741
Validation loss decreased (-0.741457 --> -0.741457).  Saving model ...
Epoch: 6 cost time: 4.072899103164673
Epoch: 6, Steps: 13 | Train Loss: 1.448 Vali Loss: 5.838 Vali Acc: 0.288 Test Loss: 5.838 Test Acc: 0.288
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.644742250442505
Epoch: 7, Steps: 13 | Train Loss: 1.056 Vali Loss: 0.839 Vali Acc: 0.741 Test Loss: 0.839 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.4898715019226074
Epoch: 8, Steps: 13 | Train Loss: 0.483 Vali Loss: 2.682 Vali Acc: 0.288 Test Loss: 2.682 Test Acc: 0.288
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.3614914417266846
Epoch: 9, Steps: 13 | Train Loss: 1.941 Vali Loss: 2.005 Vali Acc: 0.722 Test Loss: 2.005 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.7863001823425293
Epoch: 10, Steps: 13 | Train Loss: 0.978 Vali Loss: 1.846 Vali Acc: 0.737 Test Loss: 1.846 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.5206263065338135
Epoch: 11, Steps: 13 | Train Loss: 0.468 Vali Loss: 1.114 Vali Acc: 0.756 Test Loss: 1.114 Test Acc: 0.756
Validation loss decreased (-0.741457 --> -0.756086).  Saving model ...
Epoch: 12 cost time: 3.3273112773895264
Epoch: 12, Steps: 13 | Train Loss: 0.718 Vali Loss: 2.364 Vali Acc: 0.722 Test Loss: 2.364 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.858590602874756
Epoch: 13, Steps: 13 | Train Loss: 1.849 Vali Loss: 2.190 Vali Acc: 0.732 Test Loss: 2.190 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.519132137298584
Epoch: 14, Steps: 13 | Train Loss: 1.099 Vali Loss: 1.071 Vali Acc: 0.707 Test Loss: 1.071 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.9308552742004395
Epoch: 15, Steps: 13 | Train Loss: 0.647 Vali Loss: 4.582 Vali Acc: 0.722 Test Loss: 4.582 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.331695795059204
Epoch: 16, Steps: 13 | Train Loss: 2.632 Vali Loss: 4.373 Vali Acc: 0.385 Test Loss: 4.373 Test Acc: 0.385
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.6262848377227783
Epoch: 17, Steps: 13 | Train Loss: 1.834 Vali Loss: 2.023 Vali Acc: 0.707 Test Loss: 2.023 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.4665491580963135
Epoch: 18, Steps: 13 | Train Loss: 1.217 Vali Loss: 1.752 Vali Acc: 0.712 Test Loss: 1.752 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.8675358295440674
Epoch: 19, Steps: 13 | Train Loss: 2.638 Vali Loss: 8.213 Vali Acc: 0.712 Test Loss: 8.213 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.7169930934906006
Epoch: 20, Steps: 13 | Train Loss: 3.774 Vali Loss: 2.801 Vali Acc: 0.746 Test Loss: 2.801 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.108080148696899
Epoch: 21, Steps: 13 | Train Loss: 1.250 Vali Loss: 4.416 Vali Acc: 0.732 Test Loss: 4.416 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 2531110
model size : 12.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.262194395065308
Epoch: 1, Steps: 13 | Train Loss: 0.622 Vali Loss: 0.734 Vali Acc: 0.722 Test Loss: 0.734 Test Acc: 0.722
Validation loss decreased (inf --> -0.721944).  Saving model ...
Epoch: 2 cost time: 2.784501075744629
Epoch: 2, Steps: 13 | Train Loss: 0.976 Vali Loss: 0.627 Vali Acc: 0.693 Test Loss: 0.627 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.32230544090271
Epoch: 3, Steps: 13 | Train Loss: 0.871 Vali Loss: 0.709 Vali Acc: 0.722 Test Loss: 0.709 Test Acc: 0.722
Validation loss decreased (-0.721944 --> -0.721944).  Saving model ...
Epoch: 4 cost time: 3.5951786041259766
Epoch: 4, Steps: 13 | Train Loss: 1.198 Vali Loss: 0.580 Vali Acc: 0.702 Test Loss: 0.580 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.6741342544555664
Epoch: 5, Steps: 13 | Train Loss: 2.145 Vali Loss: 0.728 Vali Acc: 0.746 Test Loss: 0.728 Test Acc: 0.746
Validation loss decreased (-0.721944 --> -0.746334).  Saving model ...
Epoch: 6 cost time: 3.6124989986419678
Epoch: 6, Steps: 13 | Train Loss: 1.229 Vali Loss: 0.583 Vali Acc: 0.756 Test Loss: 0.583 Test Acc: 0.756
Validation loss decreased (-0.746334 --> -0.756092).  Saving model ...
Epoch: 7 cost time: 3.2969162464141846
Epoch: 7, Steps: 13 | Train Loss: 0.839 Vali Loss: 5.512 Vali Acc: 0.288 Test Loss: 5.512 Test Acc: 0.288
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.0528018474578857
Epoch: 8, Steps: 13 | Train Loss: 2.353 Vali Loss: 0.781 Vali Acc: 0.746 Test Loss: 0.781 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.897578477859497
Epoch: 9, Steps: 13 | Train Loss: 0.510 Vali Loss: 1.110 Vali Acc: 0.732 Test Loss: 1.110 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.9336884021759033
Epoch: 10, Steps: 13 | Train Loss: 1.240 Vali Loss: 2.412 Vali Acc: 0.722 Test Loss: 2.412 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.317260503768921
Epoch: 11, Steps: 13 | Train Loss: 1.441 Vali Loss: 4.226 Vali Acc: 0.722 Test Loss: 4.226 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.5047874450683594
Epoch: 12, Steps: 13 | Train Loss: 2.079 Vali Loss: 3.879 Vali Acc: 0.298 Test Loss: 3.879 Test Acc: 0.298
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.9448258876800537
Epoch: 13, Steps: 13 | Train Loss: 1.106 Vali Loss: 0.901 Vali Acc: 0.678 Test Loss: 0.901 Test Acc: 0.678
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.049351453781128
Epoch: 14, Steps: 13 | Train Loss: 0.472 Vali Loss: 1.121 Vali Acc: 0.727 Test Loss: 1.121 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.4073524475097656
Epoch: 15, Steps: 13 | Train Loss: 0.348 Vali Loss: 0.985 Vali Acc: 0.698 Test Loss: 0.985 Test Acc: 0.698
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.097966909408569
Epoch: 16, Steps: 13 | Train Loss: 0.448 Vali Loss: 1.223 Vali Acc: 0.580 Test Loss: 1.223 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 2221734
model size : 11.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.884361743927002
Epoch: 1, Steps: 13 | Train Loss: 0.812 Vali Loss: 0.708 Vali Acc: 0.722 Test Loss: 0.708 Test Acc: 0.722
Validation loss decreased (inf --> -0.721944).  Saving model ...
Epoch: 2 cost time: 3.5024309158325195
Epoch: 2, Steps: 13 | Train Loss: 0.624 Vali Loss: 0.681 Vali Acc: 0.644 Test Loss: 0.681 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.7397665977478027
Epoch: 3, Steps: 13 | Train Loss: 0.741 Vali Loss: 3.634 Vali Acc: 0.288 Test Loss: 3.634 Test Acc: 0.288
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.414919853210449
Epoch: 4, Steps: 13 | Train Loss: 1.306 Vali Loss: 0.867 Vali Acc: 0.541 Test Loss: 0.867 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.074836492538452
Epoch: 5, Steps: 13 | Train Loss: 0.977 Vali Loss: 0.860 Vali Acc: 0.600 Test Loss: 0.860 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.702927350997925
Epoch: 6, Steps: 13 | Train Loss: 0.873 Vali Loss: 1.453 Vali Acc: 0.727 Test Loss: 1.453 Test Acc: 0.727
Validation loss decreased (-0.721944 --> -0.726815).  Saving model ...
Epoch: 7 cost time: 3.816751480102539
Epoch: 7, Steps: 13 | Train Loss: 1.015 Vali Loss: 1.659 Vali Acc: 0.722 Test Loss: 1.659 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.0889625549316406
Epoch: 8, Steps: 13 | Train Loss: 1.045 Vali Loss: 0.848 Vali Acc: 0.615 Test Loss: 0.848 Test Acc: 0.615
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.115857362747192
Epoch: 9, Steps: 13 | Train Loss: 0.977 Vali Loss: 0.672 Vali Acc: 0.746 Test Loss: 0.672 Test Acc: 0.746
Validation loss decreased (-0.726815 --> -0.746335).  Saving model ...
Epoch: 10 cost time: 2.7348008155822754
Epoch: 10, Steps: 13 | Train Loss: 0.811 Vali Loss: 3.396 Vali Acc: 0.722 Test Loss: 3.396 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.6695849895477295
Epoch: 11, Steps: 13 | Train Loss: 3.237 Vali Loss: 7.768 Vali Acc: 0.283 Test Loss: 7.768 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.887713670730591
Epoch: 12, Steps: 13 | Train Loss: 2.209 Vali Loss: 2.204 Vali Acc: 0.756 Test Loss: 2.204 Test Acc: 0.756
Validation loss decreased (-0.746335 --> -0.756076).  Saving model ...
Epoch: 13 cost time: 2.8055503368377686
Epoch: 13, Steps: 13 | Train Loss: 0.721 Vali Loss: 2.325 Vali Acc: 0.732 Test Loss: 2.325 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.7882211208343506
Epoch: 14, Steps: 13 | Train Loss: 0.306 Vali Loss: 3.663 Vali Acc: 0.395 Test Loss: 3.663 Test Acc: 0.395
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.110020160675049
Epoch: 15, Steps: 13 | Train Loss: 1.431 Vali Loss: 5.807 Vali Acc: 0.322 Test Loss: 5.807 Test Acc: 0.322
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.8114967346191406
Epoch: 16, Steps: 13 | Train Loss: 2.948 Vali Loss: 3.920 Vali Acc: 0.727 Test Loss: 3.920 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.6726179122924805
Epoch: 17, Steps: 13 | Train Loss: 1.118 Vali Loss: 1.923 Vali Acc: 0.737 Test Loss: 1.923 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.257274627685547
Epoch: 18, Steps: 13 | Train Loss: 0.580 Vali Loss: 2.389 Vali Acc: 0.502 Test Loss: 2.389 Test Acc: 0.502
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.4265329837799072
Epoch: 19, Steps: 13 | Train Loss: 0.626 Vali Loss: 5.144 Vali Acc: 0.727 Test Loss: 5.144 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.801848888397217
Epoch: 20, Steps: 13 | Train Loss: 1.463 Vali Loss: 1.801 Vali Acc: 0.698 Test Loss: 1.801 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.5178871154785156
Epoch: 21, Steps: 13 | Train Loss: 3.280 Vali Loss: 5.887 Vali Acc: 0.732 Test Loss: 5.887 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.3613626956939697
Epoch: 22, Steps: 13 | Train Loss: 2.970 Vali Loss: 7.763 Vali Acc: 0.429 Test Loss: 7.763 Test Acc: 0.429
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 2215206
model size : 11.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.675847768783569
Epoch: 1, Steps: 13 | Train Loss: 0.752 Vali Loss: 0.993 Vali Acc: 0.722 Test Loss: 0.993 Test Acc: 0.722
Validation loss decreased (inf --> -0.721941).  Saving model ...
Epoch: 2 cost time: 3.3557469844818115
Epoch: 2, Steps: 13 | Train Loss: 0.680 Vali Loss: 0.571 Vali Acc: 0.717 Test Loss: 0.571 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.3417935371398926
Epoch: 3, Steps: 13 | Train Loss: 0.746 Vali Loss: 0.516 Vali Acc: 0.751 Test Loss: 0.516 Test Acc: 0.751
Validation loss decreased (-0.721941 --> -0.751214).  Saving model ...
Epoch: 4 cost time: 3.3637678623199463
Epoch: 4, Steps: 13 | Train Loss: 2.836 Vali Loss: 6.008 Vali Acc: 0.278 Test Loss: 6.008 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.8284738063812256
Epoch: 5, Steps: 13 | Train Loss: 1.612 Vali Loss: 3.398 Vali Acc: 0.283 Test Loss: 3.398 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.97686767578125
Epoch: 6, Steps: 13 | Train Loss: 0.812 Vali Loss: 1.329 Vali Acc: 0.371 Test Loss: 1.329 Test Acc: 0.371
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.2421538829803467
Epoch: 7, Steps: 13 | Train Loss: 1.141 Vali Loss: 2.912 Vali Acc: 0.278 Test Loss: 2.912 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.3329455852508545
Epoch: 8, Steps: 13 | Train Loss: 2.240 Vali Loss: 2.182 Vali Acc: 0.717 Test Loss: 2.182 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.4843740463256836
Epoch: 9, Steps: 13 | Train Loss: 2.421 Vali Loss: 0.815 Vali Acc: 0.688 Test Loss: 0.815 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.663472890853882
Epoch: 10, Steps: 13 | Train Loss: 1.413 Vali Loss: 2.628 Vali Acc: 0.390 Test Loss: 2.628 Test Acc: 0.390
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.225992441177368
Epoch: 11, Steps: 13 | Train Loss: 2.190 Vali Loss: 3.932 Vali Acc: 0.712 Test Loss: 3.932 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.023069381713867
Epoch: 12, Steps: 13 | Train Loss: 1.175 Vali Loss: 1.820 Vali Acc: 0.507 Test Loss: 1.820 Test Acc: 0.507
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.8585503101348877
Epoch: 13, Steps: 13 | Train Loss: 0.526 Vali Loss: 1.874 Vali Acc: 0.746 Test Loss: 1.874 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 2208678
model size : 10.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.761466979980469
Epoch: 1, Steps: 13 | Train Loss: 1.197 Vali Loss: 1.340 Vali Acc: 0.722 Test Loss: 1.340 Test Acc: 0.722
Validation loss decreased (inf --> -0.721938).  Saving model ...
Epoch: 2 cost time: 3.401350736618042
Epoch: 2, Steps: 13 | Train Loss: 1.441 Vali Loss: 0.731 Vali Acc: 0.405 Test Loss: 0.731 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.328909397125244
Epoch: 3, Steps: 13 | Train Loss: 1.396 Vali Loss: 0.892 Vali Acc: 0.380 Test Loss: 0.892 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.8223202228546143
Epoch: 4, Steps: 13 | Train Loss: 1.134 Vali Loss: 1.100 Vali Acc: 0.722 Test Loss: 1.100 Test Acc: 0.722
Validation loss decreased (-0.721938 --> -0.721940).  Saving model ...
Epoch: 5 cost time: 3.214261054992676
Epoch: 5, Steps: 13 | Train Loss: 2.049 Vali Loss: 1.776 Vali Acc: 0.717 Test Loss: 1.776 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.6970646381378174
Epoch: 6, Steps: 13 | Train Loss: 1.769 Vali Loss: 2.796 Vali Acc: 0.307 Test Loss: 2.796 Test Acc: 0.307
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.593738079071045
Epoch: 7, Steps: 13 | Train Loss: 1.932 Vali Loss: 1.906 Vali Acc: 0.717 Test Loss: 1.906 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.1930971145629883
Epoch: 8, Steps: 13 | Train Loss: 2.445 Vali Loss: 0.750 Vali Acc: 0.756 Test Loss: 0.750 Test Acc: 0.756
Validation loss decreased (-0.721940 --> -0.756090).  Saving model ...
Epoch: 9 cost time: 3.469282627105713
Epoch: 9, Steps: 13 | Train Loss: 1.693 Vali Loss: 2.126 Vali Acc: 0.722 Test Loss: 2.126 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.686276435852051
Epoch: 10, Steps: 13 | Train Loss: 0.645 Vali Loss: 0.959 Vali Acc: 0.741 Test Loss: 0.959 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.569213628768921
Epoch: 11, Steps: 13 | Train Loss: 0.793 Vali Loss: 2.435 Vali Acc: 0.341 Test Loss: 2.435 Test Acc: 0.341
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.2690937519073486
Epoch: 12, Steps: 13 | Train Loss: 1.302 Vali Loss: 3.840 Vali Acc: 0.317 Test Loss: 3.840 Test Acc: 0.317
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.563170909881592
Epoch: 13, Steps: 13 | Train Loss: 0.838 Vali Loss: 1.025 Vali Acc: 0.654 Test Loss: 1.025 Test Acc: 0.654
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.495961904525757
Epoch: 14, Steps: 13 | Train Loss: 0.970 Vali Loss: 3.856 Vali Acc: 0.712 Test Loss: 3.856 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.4389185905456543
Epoch: 15, Steps: 13 | Train Loss: 1.410 Vali Loss: 7.106 Vali Acc: 0.283 Test Loss: 7.106 Test Acc: 0.283
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.615293264389038
Epoch: 16, Steps: 13 | Train Loss: 3.245 Vali Loss: 5.282 Vali Acc: 0.722 Test Loss: 5.282 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.908447027206421
Epoch: 17, Steps: 13 | Train Loss: 1.907 Vali Loss: 5.540 Vali Acc: 0.356 Test Loss: 5.540 Test Acc: 0.356
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.571546792984009
Epoch: 18, Steps: 13 | Train Loss: 1.713 Vali Loss: 5.001 Vali Acc: 0.727 Test Loss: 5.001 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 2202150
model size : 10.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.8598792552948
Epoch: 1, Steps: 13 | Train Loss: 0.663 Vali Loss: 0.747 Vali Acc: 0.722 Test Loss: 0.747 Test Acc: 0.722
Validation loss decreased (inf --> -0.721944).  Saving model ...
Epoch: 2 cost time: 3.3880844116210938
Epoch: 2, Steps: 13 | Train Loss: 0.635 Vali Loss: 0.621 Vali Acc: 0.727 Test Loss: 0.621 Test Acc: 0.727
Validation loss decreased (-0.721944 --> -0.726823).  Saving model ...
Epoch: 3 cost time: 4.182861804962158
Epoch: 3, Steps: 13 | Train Loss: 0.650 Vali Loss: 0.872 Vali Acc: 0.717 Test Loss: 0.872 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.789905071258545
Epoch: 4, Steps: 13 | Train Loss: 1.260 Vali Loss: 1.561 Vali Acc: 0.717 Test Loss: 1.561 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.518083333969116
Epoch: 5, Steps: 13 | Train Loss: 1.047 Vali Loss: 0.703 Vali Acc: 0.732 Test Loss: 0.703 Test Acc: 0.732
Validation loss decreased (-0.726823 --> -0.731700).  Saving model ...
Epoch: 6 cost time: 3.8594698905944824
Epoch: 6, Steps: 13 | Train Loss: 2.122 Vali Loss: 1.612 Vali Acc: 0.722 Test Loss: 1.612 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.9759421348571777
Epoch: 7, Steps: 13 | Train Loss: 1.981 Vali Loss: 2.015 Vali Acc: 0.434 Test Loss: 2.015 Test Acc: 0.434
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.378323554992676
Epoch: 8, Steps: 13 | Train Loss: 1.543 Vali Loss: 1.451 Vali Acc: 0.737 Test Loss: 1.451 Test Acc: 0.737
Validation loss decreased (-0.731700 --> -0.736571).  Saving model ...
Epoch: 9 cost time: 4.27858567237854
Epoch: 9, Steps: 13 | Train Loss: 1.977 Vali Loss: 1.799 Vali Acc: 0.463 Test Loss: 1.799 Test Acc: 0.463
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.713676929473877
Epoch: 10, Steps: 13 | Train Loss: 0.466 Vali Loss: 1.571 Vali Acc: 0.722 Test Loss: 1.571 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.3648464679718018
Epoch: 11, Steps: 13 | Train Loss: 0.482 Vali Loss: 1.785 Vali Acc: 0.722 Test Loss: 1.785 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.9985947608947754
Epoch: 12, Steps: 13 | Train Loss: 1.073 Vali Loss: 2.168 Vali Acc: 0.737 Test Loss: 2.168 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.8819873332977295
Epoch: 13, Steps: 13 | Train Loss: 2.717 Vali Loss: 12.471 Vali Acc: 0.293 Test Loss: 12.471 Test Acc: 0.293
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.6460278034210205
Epoch: 14, Steps: 13 | Train Loss: 4.105 Vali Loss: 3.520 Vali Acc: 0.741 Test Loss: 3.520 Test Acc: 0.741
Validation loss decreased (-0.736571 --> -0.741428).  Saving model ...
Epoch: 15 cost time: 3.855262041091919
Epoch: 15, Steps: 13 | Train Loss: 2.322 Vali Loss: 2.042 Vali Acc: 0.571 Test Loss: 2.042 Test Acc: 0.571
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.856445789337158
Epoch: 16, Steps: 13 | Train Loss: 1.964 Vali Loss: 1.159 Vali Acc: 0.746 Test Loss: 1.159 Test Acc: 0.746
Validation loss decreased (-0.741428 --> -0.746330).  Saving model ...
Epoch: 17 cost time: 3.6730122566223145
Epoch: 17, Steps: 13 | Train Loss: 1.090 Vali Loss: 1.464 Vali Acc: 0.761 Test Loss: 1.464 Test Acc: 0.761
Validation loss decreased (-0.746330 --> -0.760961).  Saving model ...
Epoch: 18 cost time: 3.7758631706237793
Epoch: 18, Steps: 13 | Train Loss: 0.415 Vali Loss: 1.540 Vali Acc: 0.766 Test Loss: 1.540 Test Acc: 0.766
Validation loss decreased (-0.760961 --> -0.765838).  Saving model ...
Epoch: 19 cost time: 3.5789711475372314
Epoch: 19, Steps: 13 | Train Loss: 0.424 Vali Loss: 2.002 Vali Acc: 0.761 Test Loss: 2.002 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.8773856163024902
Epoch: 20, Steps: 13 | Train Loss: 2.398 Vali Loss: 16.510 Vali Acc: 0.283 Test Loss: 16.510 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.861393451690674
Epoch: 21, Steps: 13 | Train Loss: 3.886 Vali Loss: 3.782 Vali Acc: 0.746 Test Loss: 3.782 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.6821084022521973
Epoch: 22, Steps: 13 | Train Loss: 0.555 Vali Loss: 3.020 Vali Acc: 0.741 Test Loss: 3.020 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.061201572418213
Epoch: 23, Steps: 13 | Train Loss: 0.545 Vali Loss: 3.886 Vali Acc: 0.727 Test Loss: 3.886 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 4.333140134811401
Epoch: 24, Steps: 13 | Train Loss: 0.280 Vali Loss: 2.177 Vali Acc: 0.732 Test Loss: 2.177 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 4.0133936405181885
Epoch: 25, Steps: 13 | Train Loss: 0.261 Vali Loss: 1.923 Vali Acc: 0.712 Test Loss: 1.923 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 4.039350748062134
Epoch: 26, Steps: 13 | Train Loss: 0.481 Vali Loss: 2.655 Vali Acc: 0.741 Test Loss: 2.655 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.931361436843872
Epoch: 27, Steps: 13 | Train Loss: 0.198 Vali Loss: 5.692 Vali Acc: 0.415 Test Loss: 5.692 Test Acc: 0.415
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 4.092031955718994
Epoch: 28, Steps: 13 | Train Loss: 0.810 Vali Loss: 3.024 Vali Acc: 0.585 Test Loss: 3.024 Test Acc: 0.585
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 2057254
model size : 10.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.7349982261657715
Epoch: 1, Steps: 13 | Train Loss: 0.776 Vali Loss: 1.027 Vali Acc: 0.278 Test Loss: 1.027 Test Acc: 0.278
Validation loss decreased (inf --> -0.278039).  Saving model ...
Epoch: 2 cost time: 3.0954322814941406
Epoch: 2, Steps: 13 | Train Loss: 0.742 Vali Loss: 0.528 Vali Acc: 0.737 Test Loss: 0.528 Test Acc: 0.737
Validation loss decreased (-0.278039 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 2.980734348297119
Epoch: 3, Steps: 13 | Train Loss: 0.614 Vali Loss: 0.813 Vali Acc: 0.722 Test Loss: 0.813 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.7164387702941895
Epoch: 4, Steps: 13 | Train Loss: 0.532 Vali Loss: 0.525 Vali Acc: 0.741 Test Loss: 0.525 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741458).  Saving model ...
Epoch: 5 cost time: 3.1494760513305664
Epoch: 5, Steps: 13 | Train Loss: 0.396 Vali Loss: 0.535 Vali Acc: 0.732 Test Loss: 0.535 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.798139810562134
Epoch: 6, Steps: 13 | Train Loss: 1.232 Vali Loss: 0.742 Vali Acc: 0.741 Test Loss: 0.742 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.012070894241333
Epoch: 7, Steps: 13 | Train Loss: 0.422 Vali Loss: 0.591 Vali Acc: 0.746 Test Loss: 0.591 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746336).  Saving model ...
Epoch: 8 cost time: 3.020310640335083
Epoch: 8, Steps: 13 | Train Loss: 0.534 Vali Loss: 1.756 Vali Acc: 0.727 Test Loss: 1.756 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.019521713256836
Epoch: 9, Steps: 13 | Train Loss: 1.057 Vali Loss: 0.651 Vali Acc: 0.712 Test Loss: 0.651 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.965424060821533
Epoch: 10, Steps: 13 | Train Loss: 0.360 Vali Loss: 2.573 Vali Acc: 0.722 Test Loss: 2.573 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.12587571144104
Epoch: 11, Steps: 13 | Train Loss: 1.288 Vali Loss: 2.962 Vali Acc: 0.727 Test Loss: 2.962 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.8310773372650146
Epoch: 12, Steps: 13 | Train Loss: 0.913 Vali Loss: 2.321 Vali Acc: 0.732 Test Loss: 2.321 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.5698931217193604
Epoch: 13, Steps: 13 | Train Loss: 0.549 Vali Loss: 6.165 Vali Acc: 0.332 Test Loss: 6.165 Test Acc: 0.332
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.239055871963501
Epoch: 14, Steps: 13 | Train Loss: 1.383 Vali Loss: 1.196 Vali Acc: 0.746 Test Loss: 1.196 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.3140714168548584
Epoch: 15, Steps: 13 | Train Loss: 1.178 Vali Loss: 2.098 Vali Acc: 0.507 Test Loss: 2.098 Test Acc: 0.507
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.190767765045166
Epoch: 16, Steps: 13 | Train Loss: 0.541 Vali Loss: 1.076 Vali Acc: 0.678 Test Loss: 1.076 Test Acc: 0.678
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.667478084564209
Epoch: 17, Steps: 13 | Train Loss: 1.862 Vali Loss: 3.765 Vali Acc: 0.415 Test Loss: 3.765 Test Acc: 0.415
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 2050726
model size : 10.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.703826427459717
Epoch: 1, Steps: 13 | Train Loss: 1.032 Vali Loss: 0.562 Vali Acc: 0.722 Test Loss: 0.562 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 3.347476005554199
Epoch: 2, Steps: 13 | Train Loss: 0.947 Vali Loss: 0.538 Vali Acc: 0.756 Test Loss: 0.538 Test Acc: 0.756
Validation loss decreased (-0.721946 --> -0.756092).  Saving model ...
Epoch: 3 cost time: 2.921318292617798
Epoch: 3, Steps: 13 | Train Loss: 0.937 Vali Loss: 0.562 Vali Acc: 0.737 Test Loss: 0.562 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.263669013977051
Epoch: 4, Steps: 13 | Train Loss: 1.191 Vali Loss: 0.810 Vali Acc: 0.722 Test Loss: 0.810 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.3581979274749756
Epoch: 5, Steps: 13 | Train Loss: 1.069 Vali Loss: 0.577 Vali Acc: 0.668 Test Loss: 0.577 Test Acc: 0.668
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.0957236289978027
Epoch: 6, Steps: 13 | Train Loss: 0.829 Vali Loss: 2.555 Vali Acc: 0.722 Test Loss: 2.555 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.8028218746185303
Epoch: 7, Steps: 13 | Train Loss: 2.657 Vali Loss: 7.550 Vali Acc: 0.278 Test Loss: 7.550 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.9375805854797363
Epoch: 8, Steps: 13 | Train Loss: 4.236 Vali Loss: 0.738 Vali Acc: 0.756 Test Loss: 0.738 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.919391393661499
Epoch: 9, Steps: 13 | Train Loss: 2.420 Vali Loss: 4.371 Vali Acc: 0.302 Test Loss: 4.371 Test Acc: 0.302
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.3533756732940674
Epoch: 10, Steps: 13 | Train Loss: 7.154 Vali Loss: 1.802 Vali Acc: 0.556 Test Loss: 1.802 Test Acc: 0.556
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.620823383331299
Epoch: 11, Steps: 13 | Train Loss: 2.906 Vali Loss: 1.994 Vali Acc: 0.727 Test Loss: 1.994 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.9696507453918457
Epoch: 12, Steps: 13 | Train Loss: 1.546 Vali Loss: 1.212 Vali Acc: 0.751 Test Loss: 1.212 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 2044198
model size : 10.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.692517042160034
Epoch: 1, Steps: 13 | Train Loss: 0.933 Vali Loss: 0.778 Vali Acc: 0.722 Test Loss: 0.778 Test Acc: 0.722
Validation loss decreased (inf --> -0.721943).  Saving model ...
Epoch: 2 cost time: 3.6718451976776123
Epoch: 2, Steps: 13 | Train Loss: 0.714 Vali Loss: 0.550 Vali Acc: 0.741 Test Loss: 0.550 Test Acc: 0.741
Validation loss decreased (-0.721943 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 3.290173292160034
Epoch: 3, Steps: 13 | Train Loss: 0.878 Vali Loss: 0.546 Vali Acc: 0.732 Test Loss: 0.546 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.415597915649414
Epoch: 4, Steps: 13 | Train Loss: 2.075 Vali Loss: 0.823 Vali Acc: 0.732 Test Loss: 0.823 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.27860426902771
Epoch: 5, Steps: 13 | Train Loss: 2.181 Vali Loss: 0.619 Vali Acc: 0.756 Test Loss: 0.619 Test Acc: 0.756
Validation loss decreased (-0.741458 --> -0.756091).  Saving model ...
Epoch: 6 cost time: 3.5225722789764404
Epoch: 6, Steps: 13 | Train Loss: 0.966 Vali Loss: 0.681 Vali Acc: 0.746 Test Loss: 0.681 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.337325096130371
Epoch: 7, Steps: 13 | Train Loss: 0.573 Vali Loss: 0.671 Vali Acc: 0.620 Test Loss: 0.671 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.650064468383789
Epoch: 8, Steps: 13 | Train Loss: 1.357 Vali Loss: 0.564 Vali Acc: 0.712 Test Loss: 0.564 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.89080810546875
Epoch: 9, Steps: 13 | Train Loss: 3.942 Vali Loss: 5.453 Vali Acc: 0.722 Test Loss: 5.453 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.4549078941345215
Epoch: 10, Steps: 13 | Train Loss: 3.887 Vali Loss: 1.190 Vali Acc: 0.776 Test Loss: 1.190 Test Acc: 0.776
Validation loss decreased (-0.756091 --> -0.775598).  Saving model ...
Epoch: 11 cost time: 2.6503233909606934
Epoch: 11, Steps: 13 | Train Loss: 5.274 Vali Loss: 9.393 Vali Acc: 0.298 Test Loss: 9.393 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.8977696895599365
Epoch: 12, Steps: 13 | Train Loss: 1.859 Vali Loss: 1.929 Vali Acc: 0.727 Test Loss: 1.929 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.8339052200317383
Epoch: 13, Steps: 13 | Train Loss: 0.903 Vali Loss: 1.120 Vali Acc: 0.746 Test Loss: 1.120 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.227666139602661
Epoch: 14, Steps: 13 | Train Loss: 0.453 Vali Loss: 0.902 Vali Acc: 0.707 Test Loss: 0.902 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.443589925765991
Epoch: 15, Steps: 13 | Train Loss: 3.835 Vali Loss: 7.273 Vali Acc: 0.293 Test Loss: 7.273 Test Acc: 0.293
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.4864377975463867
Epoch: 16, Steps: 13 | Train Loss: 3.888 Vali Loss: 3.761 Vali Acc: 0.727 Test Loss: 3.761 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.3528928756713867
Epoch: 17, Steps: 13 | Train Loss: 1.036 Vali Loss: 1.557 Vali Acc: 0.615 Test Loss: 1.557 Test Acc: 0.615
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.981776475906372
Epoch: 18, Steps: 13 | Train Loss: 0.619 Vali Loss: 2.007 Vali Acc: 0.756 Test Loss: 2.007 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.5803022384643555
Epoch: 19, Steps: 13 | Train Loss: 1.555 Vali Loss: 1.840 Vali Acc: 0.766 Test Loss: 1.840 Test Acc: 0.766
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.4839866161346436
Epoch: 20, Steps: 13 | Train Loss: 0.401 Vali Loss: 1.649 Vali Acc: 0.600 Test Loss: 1.649 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 2037670
model size : 10.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.594749689102173
Epoch: 1, Steps: 13 | Train Loss: 0.772 Vali Loss: 0.704 Vali Acc: 0.712 Test Loss: 0.704 Test Acc: 0.712
Validation loss decreased (inf --> -0.712188).  Saving model ...
Epoch: 2 cost time: 3.5044116973876953
Epoch: 2, Steps: 13 | Train Loss: 0.620 Vali Loss: 0.574 Vali Acc: 0.756 Test Loss: 0.574 Test Acc: 0.756
Validation loss decreased (-0.712188 --> -0.756092).  Saving model ...
Epoch: 3 cost time: 3.5022692680358887
Epoch: 3, Steps: 13 | Train Loss: 0.864 Vali Loss: 0.557 Vali Acc: 0.732 Test Loss: 0.557 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.2913806438446045
Epoch: 4, Steps: 13 | Train Loss: 0.518 Vali Loss: 0.571 Vali Acc: 0.732 Test Loss: 0.571 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.9096150398254395
Epoch: 5, Steps: 13 | Train Loss: 0.499 Vali Loss: 0.559 Vali Acc: 0.707 Test Loss: 0.559 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.204434633255005
Epoch: 6, Steps: 13 | Train Loss: 1.187 Vali Loss: 1.490 Vali Acc: 0.327 Test Loss: 1.490 Test Acc: 0.327
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.005146026611328
Epoch: 7, Steps: 13 | Train Loss: 0.705 Vali Loss: 1.134 Vali Acc: 0.722 Test Loss: 1.134 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.0301849842071533
Epoch: 8, Steps: 13 | Train Loss: 0.368 Vali Loss: 0.773 Vali Acc: 0.732 Test Loss: 0.773 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.171457052230835
Epoch: 9, Steps: 13 | Train Loss: 1.637 Vali Loss: 6.636 Vali Acc: 0.283 Test Loss: 6.636 Test Acc: 0.283
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.431001663208008
Epoch: 10, Steps: 13 | Train Loss: 2.198 Vali Loss: 0.916 Vali Acc: 0.746 Test Loss: 0.916 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.262277126312256
Epoch: 11, Steps: 13 | Train Loss: 0.394 Vali Loss: 0.807 Vali Acc: 0.741 Test Loss: 0.807 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.5625948905944824
Epoch: 12, Steps: 13 | Train Loss: 0.303 Vali Loss: 1.577 Vali Acc: 0.732 Test Loss: 1.577 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 1279206
model size : 6.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.4502272605896
Epoch: 1, Steps: 13 | Train Loss: 0.671 Vali Loss: 0.614 Vali Acc: 0.717 Test Loss: 0.614 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 3.1793949604034424
Epoch: 2, Steps: 13 | Train Loss: 0.782 Vali Loss: 0.555 Vali Acc: 0.717 Test Loss: 0.555 Test Acc: 0.717
Validation loss decreased (-0.717067 --> -0.717068).  Saving model ...
Epoch: 3 cost time: 2.4003140926361084
Epoch: 3, Steps: 13 | Train Loss: 0.644 Vali Loss: 0.996 Vali Acc: 0.722 Test Loss: 0.996 Test Acc: 0.722
Validation loss decreased (-0.717068 --> -0.721941).  Saving model ...
Epoch: 4 cost time: 3.1130013465881348
Epoch: 4, Steps: 13 | Train Loss: 1.085 Vali Loss: 1.100 Vali Acc: 0.302 Test Loss: 1.100 Test Acc: 0.302
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.0935797691345215
Epoch: 5, Steps: 13 | Train Loss: 0.786 Vali Loss: 0.531 Vali Acc: 0.741 Test Loss: 0.531 Test Acc: 0.741
Validation loss decreased (-0.721941 --> -0.741458).  Saving model ...
Epoch: 6 cost time: 2.822983741760254
Epoch: 6, Steps: 13 | Train Loss: 0.527 Vali Loss: 0.540 Vali Acc: 0.737 Test Loss: 0.540 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.9756200313568115
Epoch: 7, Steps: 13 | Train Loss: 0.582 Vali Loss: 0.608 Vali Acc: 0.649 Test Loss: 0.608 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.1147119998931885
Epoch: 8, Steps: 13 | Train Loss: 0.434 Vali Loss: 0.971 Vali Acc: 0.737 Test Loss: 0.971 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.5796432495117188
Epoch: 9, Steps: 13 | Train Loss: 1.170 Vali Loss: 0.830 Vali Acc: 0.732 Test Loss: 0.830 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.155988931655884
Epoch: 10, Steps: 13 | Train Loss: 0.391 Vali Loss: 1.201 Vali Acc: 0.727 Test Loss: 1.201 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.342956066131592
Epoch: 11, Steps: 13 | Train Loss: 0.747 Vali Loss: 1.175 Vali Acc: 0.722 Test Loss: 1.175 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.2535042762756348
Epoch: 12, Steps: 13 | Train Loss: 0.267 Vali Loss: 0.830 Vali Acc: 0.741 Test Loss: 0.830 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.972872257232666
Epoch: 13, Steps: 13 | Train Loss: 0.490 Vali Loss: 0.715 Vali Acc: 0.727 Test Loss: 0.715 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.2692675590515137
Epoch: 14, Steps: 13 | Train Loss: 1.069 Vali Loss: 2.779 Vali Acc: 0.722 Test Loss: 2.779 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.014998912811279
Epoch: 15, Steps: 13 | Train Loss: 0.998 Vali Loss: 2.743 Vali Acc: 0.371 Test Loss: 2.743 Test Acc: 0.371
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 1275942
model size : 6.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.317554235458374
Epoch: 1, Steps: 13 | Train Loss: 0.803 Vali Loss: 0.761 Vali Acc: 0.717 Test Loss: 0.761 Test Acc: 0.717
Validation loss decreased (inf --> -0.717066).  Saving model ...
Epoch: 2 cost time: 3.4569079875946045
Epoch: 2, Steps: 13 | Train Loss: 0.603 Vali Loss: 0.554 Vali Acc: 0.722 Test Loss: 0.554 Test Acc: 0.722
Validation loss decreased (-0.717066 --> -0.721946).  Saving model ...
Epoch: 3 cost time: 3.4299426078796387
Epoch: 3, Steps: 13 | Train Loss: 0.638 Vali Loss: 0.538 Vali Acc: 0.751 Test Loss: 0.538 Test Acc: 0.751
Validation loss decreased (-0.721946 --> -0.751214).  Saving model ...
Epoch: 4 cost time: 3.0284483432769775
Epoch: 4, Steps: 13 | Train Loss: 0.494 Vali Loss: 0.546 Vali Acc: 0.741 Test Loss: 0.546 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.215463876724243
Epoch: 5, Steps: 13 | Train Loss: 0.868 Vali Loss: 1.548 Vali Acc: 0.722 Test Loss: 1.548 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.4548957347869873
Epoch: 6, Steps: 13 | Train Loss: 0.894 Vali Loss: 1.042 Vali Acc: 0.376 Test Loss: 1.042 Test Acc: 0.376
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.382704973220825
Epoch: 7, Steps: 13 | Train Loss: 0.620 Vali Loss: 0.919 Vali Acc: 0.454 Test Loss: 0.919 Test Acc: 0.454
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.2832400798797607
Epoch: 8, Steps: 13 | Train Loss: 0.567 Vali Loss: 1.028 Vali Acc: 0.468 Test Loss: 1.028 Test Acc: 0.468
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.2270028591156006
Epoch: 9, Steps: 13 | Train Loss: 0.394 Vali Loss: 0.712 Vali Acc: 0.620 Test Loss: 0.712 Test Acc: 0.620
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.6803534030914307
Epoch: 10, Steps: 13 | Train Loss: 0.356 Vali Loss: 0.588 Vali Acc: 0.698 Test Loss: 0.588 Test Acc: 0.698
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.9127674102783203
Epoch: 11, Steps: 13 | Train Loss: 0.343 Vali Loss: 0.648 Vali Acc: 0.712 Test Loss: 0.648 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.0150060653686523
Epoch: 12, Steps: 13 | Train Loss: 0.742 Vali Loss: 1.422 Vali Acc: 0.454 Test Loss: 1.422 Test Acc: 0.454
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.156557559967041
Epoch: 13, Steps: 13 | Train Loss: 1.029 Vali Loss: 1.144 Vali Acc: 0.737 Test Loss: 1.144 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 1272678
model size : 6.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.961258888244629
Epoch: 1, Steps: 13 | Train Loss: 0.643 Vali Loss: 0.758 Vali Acc: 0.288 Test Loss: 0.758 Test Acc: 0.288
Validation loss decreased (inf --> -0.287797).  Saving model ...
Epoch: 2 cost time: 2.8575587272644043
Epoch: 2, Steps: 13 | Train Loss: 0.689 Vali Loss: 0.821 Vali Acc: 0.722 Test Loss: 0.821 Test Acc: 0.722
Validation loss decreased (-0.287797 --> -0.721943).  Saving model ...
Epoch: 3 cost time: 2.8182101249694824
Epoch: 3, Steps: 13 | Train Loss: 0.620 Vali Loss: 0.612 Vali Acc: 0.712 Test Loss: 0.612 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.8686270713806152
Epoch: 4, Steps: 13 | Train Loss: 0.636 Vali Loss: 0.967 Vali Acc: 0.712 Test Loss: 0.967 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.466334342956543
Epoch: 5, Steps: 13 | Train Loss: 0.542 Vali Loss: 0.768 Vali Acc: 0.722 Test Loss: 0.768 Test Acc: 0.722
Validation loss decreased (-0.721943 --> -0.721944).  Saving model ...
Epoch: 6 cost time: 3.2926747798919678
Epoch: 6, Steps: 13 | Train Loss: 0.812 Vali Loss: 0.904 Vali Acc: 0.434 Test Loss: 0.904 Test Acc: 0.434
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.7942352294921875
Epoch: 7, Steps: 13 | Train Loss: 0.487 Vali Loss: 0.654 Vali Acc: 0.644 Test Loss: 0.654 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.689286708831787
Epoch: 8, Steps: 13 | Train Loss: 0.396 Vali Loss: 0.827 Vali Acc: 0.737 Test Loss: 0.827 Test Acc: 0.737
Validation loss decreased (-0.721944 --> -0.736577).  Saving model ...
Epoch: 9 cost time: 3.2848193645477295
Epoch: 9, Steps: 13 | Train Loss: 0.678 Vali Loss: 3.018 Vali Acc: 0.722 Test Loss: 3.018 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.1987836360931396
Epoch: 10, Steps: 13 | Train Loss: 2.125 Vali Loss: 0.671 Vali Acc: 0.761 Test Loss: 0.671 Test Acc: 0.761
Validation loss decreased (-0.736577 --> -0.760969).  Saving model ...
Epoch: 11 cost time: 2.874790668487549
Epoch: 11, Steps: 13 | Train Loss: 1.123 Vali Loss: 0.747 Vali Acc: 0.756 Test Loss: 0.747 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.323469638824463
Epoch: 12, Steps: 13 | Train Loss: 0.445 Vali Loss: 0.606 Vali Acc: 0.727 Test Loss: 0.606 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.364767551422119
Epoch: 13, Steps: 13 | Train Loss: 0.720 Vali Loss: 1.200 Vali Acc: 0.737 Test Loss: 1.200 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.963210105895996
Epoch: 14, Steps: 13 | Train Loss: 0.472 Vali Loss: 0.766 Vali Acc: 0.737 Test Loss: 0.766 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.7347662448883057
Epoch: 15, Steps: 13 | Train Loss: 1.354 Vali Loss: 0.861 Vali Acc: 0.746 Test Loss: 0.861 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.7341573238372803
Epoch: 16, Steps: 13 | Train Loss: 0.389 Vali Loss: 0.992 Vali Acc: 0.761 Test Loss: 0.992 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.667224407196045
Epoch: 17, Steps: 13 | Train Loss: 0.490 Vali Loss: 3.178 Vali Acc: 0.332 Test Loss: 3.178 Test Acc: 0.332
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.9992074966430664
Epoch: 18, Steps: 13 | Train Loss: 0.801 Vali Loss: 3.159 Vali Acc: 0.717 Test Loss: 3.159 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.986677646636963
Epoch: 19, Steps: 13 | Train Loss: 0.413 Vali Loss: 2.778 Vali Acc: 0.434 Test Loss: 2.778 Test Acc: 0.434
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.4240152835845947
Epoch: 20, Steps: 13 | Train Loss: 0.623 Vali Loss: 1.004 Vali Acc: 0.663 Test Loss: 1.004 Test Acc: 0.663
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 1269414
model size : 6.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.238517761230469
Epoch: 1, Steps: 13 | Train Loss: 0.615 Vali Loss: 0.692 Vali Acc: 0.722 Test Loss: 0.692 Test Acc: 0.722
Validation loss decreased (inf --> -0.721944).  Saving model ...
Epoch: 2 cost time: 2.567586898803711
Epoch: 2, Steps: 13 | Train Loss: 0.857 Vali Loss: 0.838 Vali Acc: 0.312 Test Loss: 0.838 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.471341133117676
Epoch: 3, Steps: 13 | Train Loss: 1.204 Vali Loss: 1.412 Vali Acc: 0.722 Test Loss: 1.412 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.639029026031494
Epoch: 4, Steps: 13 | Train Loss: 1.310 Vali Loss: 0.808 Vali Acc: 0.717 Test Loss: 0.808 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.346639394760132
Epoch: 5, Steps: 13 | Train Loss: 1.373 Vali Loss: 2.572 Vali Acc: 0.288 Test Loss: 2.572 Test Acc: 0.288
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.332944631576538
Epoch: 6, Steps: 13 | Train Loss: 1.517 Vali Loss: 0.893 Vali Acc: 0.746 Test Loss: 0.893 Test Acc: 0.746
Validation loss decreased (-0.721944 --> -0.746333).  Saving model ...
Epoch: 7 cost time: 2.8547067642211914
Epoch: 7, Steps: 13 | Train Loss: 0.582 Vali Loss: 0.774 Vali Acc: 0.727 Test Loss: 0.774 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.8418667316436768
Epoch: 8, Steps: 13 | Train Loss: 1.157 Vali Loss: 0.885 Vali Acc: 0.737 Test Loss: 0.885 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.919801950454712
Epoch: 9, Steps: 13 | Train Loss: 0.810 Vali Loss: 1.021 Vali Acc: 0.737 Test Loss: 1.021 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.143775463104248
Epoch: 10, Steps: 13 | Train Loss: 0.503 Vali Loss: 0.856 Vali Acc: 0.541 Test Loss: 0.856 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.934725761413574
Epoch: 11, Steps: 13 | Train Loss: 0.462 Vali Loss: 1.649 Vali Acc: 0.376 Test Loss: 1.649 Test Acc: 0.376
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.2371764183044434
Epoch: 12, Steps: 13 | Train Loss: 0.576 Vali Loss: 0.605 Vali Acc: 0.688 Test Loss: 0.605 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.0094563961029053
Epoch: 13, Steps: 13 | Train Loss: 0.498 Vali Loss: 1.271 Vali Acc: 0.727 Test Loss: 1.271 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.2301905155181885
Epoch: 14, Steps: 13 | Train Loss: 0.675 Vali Loss: 1.136 Vali Acc: 0.746 Test Loss: 1.136 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.0728962421417236
Epoch: 15, Steps: 13 | Train Loss: 1.658 Vali Loss: 2.312 Vali Acc: 0.722 Test Loss: 2.312 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.0403647422790527
Epoch: 16, Steps: 13 | Train Loss: 1.007 Vali Loss: 1.343 Vali Acc: 0.746 Test Loss: 1.343 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 948966
model size : 4.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.8008034229278564
Epoch: 1, Steps: 13 | Train Loss: 0.667 Vali Loss: 0.760 Vali Acc: 0.722 Test Loss: 0.760 Test Acc: 0.722
Validation loss decreased (inf --> -0.721944).  Saving model ...
Epoch: 2 cost time: 2.6660101413726807
Epoch: 2, Steps: 13 | Train Loss: 0.682 Vali Loss: 0.622 Vali Acc: 0.722 Test Loss: 0.622 Test Acc: 0.722
Validation loss decreased (-0.721944 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 3.07804274559021
Epoch: 3, Steps: 13 | Train Loss: 0.785 Vali Loss: 2.639 Vali Acc: 0.278 Test Loss: 2.639 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.7219247817993164
Epoch: 4, Steps: 13 | Train Loss: 1.652 Vali Loss: 0.672 Vali Acc: 0.610 Test Loss: 0.672 Test Acc: 0.610
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.1020469665527344
Epoch: 5, Steps: 13 | Train Loss: 1.238 Vali Loss: 0.879 Vali Acc: 0.722 Test Loss: 0.879 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.8861052989959717
Epoch: 6, Steps: 13 | Train Loss: 0.624 Vali Loss: 0.728 Vali Acc: 0.556 Test Loss: 0.728 Test Acc: 0.556
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.9607388973236084
Epoch: 7, Steps: 13 | Train Loss: 0.613 Vali Loss: 0.619 Vali Acc: 0.673 Test Loss: 0.619 Test Acc: 0.673
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.6969258785247803
Epoch: 8, Steps: 13 | Train Loss: 0.500 Vali Loss: 0.907 Vali Acc: 0.727 Test Loss: 0.907 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726820).  Saving model ...
Epoch: 9 cost time: 2.5466299057006836
Epoch: 9, Steps: 13 | Train Loss: 0.999 Vali Loss: 0.763 Vali Acc: 0.600 Test Loss: 0.763 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.974006175994873
Epoch: 10, Steps: 13 | Train Loss: 0.561 Vali Loss: 0.775 Vali Acc: 0.741 Test Loss: 0.775 Test Acc: 0.741
Validation loss decreased (-0.726820 --> -0.741456).  Saving model ...
Epoch: 11 cost time: 3.063697576522827
Epoch: 11, Steps: 13 | Train Loss: 0.474 Vali Loss: 2.140 Vali Acc: 0.332 Test Loss: 2.140 Test Acc: 0.332
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.375131607055664
Epoch: 12, Steps: 13 | Train Loss: 0.773 Vali Loss: 5.191 Vali Acc: 0.283 Test Loss: 5.191 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.3363912105560303
Epoch: 13, Steps: 13 | Train Loss: 1.005 Vali Loss: 0.827 Vali Acc: 0.751 Test Loss: 0.827 Test Acc: 0.751
Validation loss decreased (-0.741456 --> -0.751211).  Saving model ...
Epoch: 14 cost time: 3.212289810180664
Epoch: 14, Steps: 13 | Train Loss: 1.023 Vali Loss: 1.567 Vali Acc: 0.727 Test Loss: 1.567 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.896042585372925
Epoch: 15, Steps: 13 | Train Loss: 1.031 Vali Loss: 1.094 Vali Acc: 0.546 Test Loss: 1.094 Test Acc: 0.546
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.897695302963257
Epoch: 16, Steps: 13 | Train Loss: 0.409 Vali Loss: 1.483 Vali Acc: 0.478 Test Loss: 1.483 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.858699321746826
Epoch: 17, Steps: 13 | Train Loss: 0.524 Vali Loss: 0.804 Vali Acc: 0.659 Test Loss: 0.804 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.1409106254577637
Epoch: 18, Steps: 13 | Train Loss: 0.286 Vali Loss: 0.944 Vali Acc: 0.722 Test Loss: 0.944 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.6847903728485107
Epoch: 19, Steps: 13 | Train Loss: 0.378 Vali Loss: 1.777 Vali Acc: 0.746 Test Loss: 1.777 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.889429807662964
Epoch: 20, Steps: 13 | Train Loss: 0.518 Vali Loss: 1.122 Vali Acc: 0.634 Test Loss: 1.122 Test Acc: 0.634
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.6575348377227783
Epoch: 21, Steps: 13 | Train Loss: 0.086 Vali Loss: 1.416 Vali Acc: 0.566 Test Loss: 1.416 Test Acc: 0.566
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.104275703430176
Epoch: 22, Steps: 13 | Train Loss: 0.147 Vali Loss: 1.122 Vali Acc: 0.620 Test Loss: 1.122 Test Acc: 0.620
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.9734835624694824
Epoch: 23, Steps: 13 | Train Loss: 0.231 Vali Loss: 1.204 Vali Acc: 0.634 Test Loss: 1.204 Test Acc: 0.634
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 945702
model size : 4.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.776956558227539
Epoch: 1, Steps: 13 | Train Loss: 0.719 Vali Loss: 0.889 Vali Acc: 0.722 Test Loss: 0.889 Test Acc: 0.722
Validation loss decreased (inf --> -0.721942).  Saving model ...
Epoch: 2 cost time: 2.9259846210479736
Epoch: 2, Steps: 13 | Train Loss: 0.921 Vali Loss: 1.344 Vali Acc: 0.283 Test Loss: 1.344 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.3812308311462402
Epoch: 3, Steps: 13 | Train Loss: 0.902 Vali Loss: 0.806 Vali Acc: 0.722 Test Loss: 0.806 Test Acc: 0.722
Validation loss decreased (-0.721942 --> -0.721943).  Saving model ...
Epoch: 4 cost time: 2.6888010501861572
Epoch: 4, Steps: 13 | Train Loss: 0.510 Vali Loss: 0.784 Vali Acc: 0.727 Test Loss: 0.784 Test Acc: 0.727
Validation loss decreased (-0.721943 --> -0.726821).  Saving model ...
Epoch: 5 cost time: 2.4840428829193115
Epoch: 5, Steps: 13 | Train Loss: 0.733 Vali Loss: 0.518 Vali Acc: 0.746 Test Loss: 0.518 Test Acc: 0.746
Validation loss decreased (-0.726821 --> -0.746336).  Saving model ...
Epoch: 6 cost time: 2.6058189868927
Epoch: 6, Steps: 13 | Train Loss: 1.725 Vali Loss: 2.193 Vali Acc: 0.722 Test Loss: 2.193 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.0804967880249023
Epoch: 7, Steps: 13 | Train Loss: 1.327 Vali Loss: 0.581 Vali Acc: 0.751 Test Loss: 0.581 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751214).  Saving model ...
Epoch: 8 cost time: 2.657606601715088
Epoch: 8, Steps: 13 | Train Loss: 0.717 Vali Loss: 0.849 Vali Acc: 0.722 Test Loss: 0.849 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.334256172180176
Epoch: 9, Steps: 13 | Train Loss: 0.406 Vali Loss: 0.571 Vali Acc: 0.707 Test Loss: 0.571 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.259593963623047
Epoch: 10, Steps: 13 | Train Loss: 0.655 Vali Loss: 0.573 Vali Acc: 0.741 Test Loss: 0.573 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.5979549884796143
Epoch: 11, Steps: 13 | Train Loss: 1.362 Vali Loss: 3.555 Vali Acc: 0.722 Test Loss: 3.555 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.0820493698120117
Epoch: 12, Steps: 13 | Train Loss: 1.233 Vali Loss: 0.584 Vali Acc: 0.717 Test Loss: 0.584 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.509061813354492
Epoch: 13, Steps: 13 | Train Loss: 0.527 Vali Loss: 0.812 Vali Acc: 0.746 Test Loss: 0.812 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.534256935119629
Epoch: 14, Steps: 13 | Train Loss: 0.428 Vali Loss: 1.701 Vali Acc: 0.400 Test Loss: 1.701 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.1316847801208496
Epoch: 15, Steps: 13 | Train Loss: 0.392 Vali Loss: 2.109 Vali Acc: 0.385 Test Loss: 2.109 Test Acc: 0.385
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.991978168487549
Epoch: 16, Steps: 13 | Train Loss: 1.331 Vali Loss: 0.748 Vali Acc: 0.707 Test Loss: 0.748 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.282841682434082
Epoch: 17, Steps: 13 | Train Loss: 0.831 Vali Loss: 1.940 Vali Acc: 0.732 Test Loss: 1.940 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 942438
model size : 4.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.2096734046936035
Epoch: 1, Steps: 13 | Train Loss: 0.823 Vali Loss: 0.839 Vali Acc: 0.288 Test Loss: 0.839 Test Acc: 0.288
Validation loss decreased (inf --> -0.287796).  Saving model ...
Epoch: 2 cost time: 3.0752856731414795
Epoch: 2, Steps: 13 | Train Loss: 1.224 Vali Loss: 1.300 Vali Acc: 0.722 Test Loss: 1.300 Test Acc: 0.722
Validation loss decreased (-0.287796 --> -0.721938).  Saving model ...
Epoch: 3 cost time: 2.6655373573303223
Epoch: 3, Steps: 13 | Train Loss: 1.058 Vali Loss: 0.573 Vali Acc: 0.746 Test Loss: 0.573 Test Acc: 0.746
Validation loss decreased (-0.721938 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 3.439241409301758
Epoch: 4, Steps: 13 | Train Loss: 0.573 Vali Loss: 0.620 Vali Acc: 0.722 Test Loss: 0.620 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.170987844467163
Epoch: 5, Steps: 13 | Train Loss: 0.597 Vali Loss: 0.783 Vali Acc: 0.454 Test Loss: 0.783 Test Acc: 0.454
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.1051011085510254
Epoch: 6, Steps: 13 | Train Loss: 0.601 Vali Loss: 1.034 Vali Acc: 0.722 Test Loss: 1.034 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.0094099044799805
Epoch: 7, Steps: 13 | Train Loss: 0.705 Vali Loss: 1.009 Vali Acc: 0.722 Test Loss: 1.009 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.036663770675659
Epoch: 8, Steps: 13 | Train Loss: 0.793 Vali Loss: 3.092 Vali Acc: 0.278 Test Loss: 3.092 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.8407371044158936
Epoch: 9, Steps: 13 | Train Loss: 1.335 Vali Loss: 1.373 Vali Acc: 0.712 Test Loss: 1.373 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.0578365325927734
Epoch: 10, Steps: 13 | Train Loss: 0.569 Vali Loss: 1.446 Vali Acc: 0.722 Test Loss: 1.446 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.289442539215088
Epoch: 11, Steps: 13 | Train Loss: 0.691 Vali Loss: 1.153 Vali Acc: 0.727 Test Loss: 1.153 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.603513717651367
Epoch: 12, Steps: 13 | Train Loss: 0.602 Vali Loss: 1.147 Vali Acc: 0.502 Test Loss: 1.147 Test Acc: 0.502
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.6633901596069336
Epoch: 13, Steps: 13 | Train Loss: 0.484 Vali Loss: 0.662 Vali Acc: 0.737 Test Loss: 0.662 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 939174
model size : 4.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.176492691040039
Epoch: 1, Steps: 13 | Train Loss: 1.247 Vali Loss: 0.589 Vali Acc: 0.722 Test Loss: 0.589 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.9316537380218506
Epoch: 2, Steps: 13 | Train Loss: 1.346 Vali Loss: 0.995 Vali Acc: 0.722 Test Loss: 0.995 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.0892250537872314
Epoch: 3, Steps: 13 | Train Loss: 0.734 Vali Loss: 0.546 Vali Acc: 0.732 Test Loss: 0.546 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 4 cost time: 3.3498005867004395
Epoch: 4, Steps: 13 | Train Loss: 1.063 Vali Loss: 0.879 Vali Acc: 0.405 Test Loss: 0.879 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.4338674545288086
Epoch: 5, Steps: 13 | Train Loss: 0.967 Vali Loss: 0.603 Vali Acc: 0.732 Test Loss: 0.603 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.1433937549591064
Epoch: 6, Steps: 13 | Train Loss: 0.490 Vali Loss: 0.918 Vali Acc: 0.722 Test Loss: 0.918 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.30220890045166
Epoch: 7, Steps: 13 | Train Loss: 0.594 Vali Loss: 0.554 Vali Acc: 0.751 Test Loss: 0.554 Test Acc: 0.751
Validation loss decreased (-0.731702 --> -0.751214).  Saving model ...
Epoch: 8 cost time: 3.1051783561706543
Epoch: 8, Steps: 13 | Train Loss: 0.489 Vali Loss: 0.551 Vali Acc: 0.737 Test Loss: 0.551 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.126616954803467
Epoch: 9, Steps: 13 | Train Loss: 0.656 Vali Loss: 4.285 Vali Acc: 0.298 Test Loss: 4.285 Test Acc: 0.298
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.067092180252075
Epoch: 10, Steps: 13 | Train Loss: 2.796 Vali Loss: 6.002 Vali Acc: 0.283 Test Loss: 6.002 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.0813870429992676
Epoch: 11, Steps: 13 | Train Loss: 2.366 Vali Loss: 0.953 Vali Acc: 0.610 Test Loss: 0.953 Test Acc: 0.610
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.8501012325286865
Epoch: 12, Steps: 13 | Train Loss: 2.134 Vali Loss: 2.310 Vali Acc: 0.722 Test Loss: 2.310 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.121100902557373
Epoch: 13, Steps: 13 | Train Loss: 1.614 Vali Loss: 1.579 Vali Acc: 0.517 Test Loss: 1.579 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.811985969543457
Epoch: 14, Steps: 13 | Train Loss: 1.488 Vali Loss: 0.963 Vali Acc: 0.644 Test Loss: 0.963 Test Acc: 0.644
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.8468313217163086
Epoch: 15, Steps: 13 | Train Loss: 0.699 Vali Loss: 0.786 Vali Acc: 0.722 Test Loss: 0.786 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.7704646587371826
Epoch: 16, Steps: 13 | Train Loss: 1.899 Vali Loss: 2.864 Vali Acc: 0.717 Test Loss: 2.864 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.837092399597168
Epoch: 17, Steps: 13 | Train Loss: 0.534 Vali Loss: 2.499 Vali Acc: 0.727 Test Loss: 2.499 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 783846
model size : 4.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.6912031173706055
Epoch: 1, Steps: 13 | Train Loss: 0.802 Vali Loss: 0.919 Vali Acc: 0.283 Test Loss: 0.919 Test Acc: 0.283
Validation loss decreased (inf --> -0.282918).  Saving model ...
Epoch: 2 cost time: 2.891340970993042
Epoch: 2, Steps: 13 | Train Loss: 0.678 Vali Loss: 0.565 Vali Acc: 0.751 Test Loss: 0.565 Test Acc: 0.751
Validation loss decreased (-0.282918 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 2.6981194019317627
Epoch: 3, Steps: 13 | Train Loss: 0.566 Vali Loss: 0.543 Vali Acc: 0.741 Test Loss: 0.543 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.6192967891693115
Epoch: 4, Steps: 13 | Train Loss: 0.625 Vali Loss: 0.519 Vali Acc: 0.746 Test Loss: 0.519 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.286066770553589
Epoch: 5, Steps: 13 | Train Loss: 0.567 Vali Loss: 0.532 Vali Acc: 0.761 Test Loss: 0.532 Test Acc: 0.761
Validation loss decreased (-0.751214 --> -0.760970).  Saving model ...
Epoch: 6 cost time: 3.388796806335449
Epoch: 6, Steps: 13 | Train Loss: 0.412 Vali Loss: 0.524 Vali Acc: 0.732 Test Loss: 0.524 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.3366446495056152
Epoch: 7, Steps: 13 | Train Loss: 0.397 Vali Loss: 0.554 Vali Acc: 0.741 Test Loss: 0.554 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.233720302581787
Epoch: 8, Steps: 13 | Train Loss: 0.327 Vali Loss: 1.029 Vali Acc: 0.468 Test Loss: 1.029 Test Acc: 0.468
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.103485345840454
Epoch: 9, Steps: 13 | Train Loss: 0.516 Vali Loss: 0.708 Vali Acc: 0.741 Test Loss: 0.708 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.0054845809936523
Epoch: 10, Steps: 13 | Train Loss: 0.761 Vali Loss: 0.810 Vali Acc: 0.580 Test Loss: 0.810 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.768035888671875
Epoch: 11, Steps: 13 | Train Loss: 0.840 Vali Loss: 2.123 Vali Acc: 0.327 Test Loss: 2.123 Test Acc: 0.327
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.605012893676758
Epoch: 12, Steps: 13 | Train Loss: 1.887 Vali Loss: 2.582 Vali Acc: 0.712 Test Loss: 2.582 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.8860316276550293
Epoch: 13, Steps: 13 | Train Loss: 1.956 Vali Loss: 1.409 Vali Acc: 0.746 Test Loss: 1.409 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.290783405303955
Epoch: 14, Steps: 13 | Train Loss: 0.625 Vali Loss: 1.564 Vali Acc: 0.488 Test Loss: 1.564 Test Acc: 0.488
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.789015054702759
Epoch: 15, Steps: 13 | Train Loss: 0.817 Vali Loss: 1.145 Vali Acc: 0.722 Test Loss: 1.145 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 780582
model size : 4.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.7202112674713135
Epoch: 1, Steps: 13 | Train Loss: 0.909 Vali Loss: 0.819 Vali Acc: 0.722 Test Loss: 0.819 Test Acc: 0.722
Validation loss decreased (inf --> -0.721943).  Saving model ...
Epoch: 2 cost time: 3.3474652767181396
Epoch: 2, Steps: 13 | Train Loss: 0.773 Vali Loss: 0.830 Vali Acc: 0.312 Test Loss: 0.830 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.2842020988464355
Epoch: 3, Steps: 13 | Train Loss: 1.773 Vali Loss: 0.620 Vali Acc: 0.659 Test Loss: 0.620 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.9708337783813477
Epoch: 4, Steps: 13 | Train Loss: 1.946 Vali Loss: 1.436 Vali Acc: 0.717 Test Loss: 1.436 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.073931932449341
Epoch: 5, Steps: 13 | Train Loss: 1.607 Vali Loss: 1.748 Vali Acc: 0.722 Test Loss: 1.748 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.9040679931640625
Epoch: 6, Steps: 13 | Train Loss: 1.589 Vali Loss: 1.065 Vali Acc: 0.459 Test Loss: 1.065 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.6776933670043945
Epoch: 7, Steps: 13 | Train Loss: 1.650 Vali Loss: 1.361 Vali Acc: 0.424 Test Loss: 1.361 Test Acc: 0.424
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.8496322631835938
Epoch: 8, Steps: 13 | Train Loss: 0.893 Vali Loss: 0.900 Vali Acc: 0.732 Test Loss: 0.900 Test Acc: 0.732
Validation loss decreased (-0.721943 --> -0.731698).  Saving model ...
Epoch: 9 cost time: 2.5219197273254395
Epoch: 9, Steps: 13 | Train Loss: 0.469 Vali Loss: 0.648 Vali Acc: 0.761 Test Loss: 0.648 Test Acc: 0.761
Validation loss decreased (-0.731698 --> -0.760969).  Saving model ...
Epoch: 10 cost time: 3.0089662075042725
Epoch: 10, Steps: 13 | Train Loss: 0.391 Vali Loss: 0.906 Vali Acc: 0.722 Test Loss: 0.906 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.222318649291992
Epoch: 11, Steps: 13 | Train Loss: 0.672 Vali Loss: 0.842 Vali Acc: 0.737 Test Loss: 0.842 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.1571500301361084
Epoch: 12, Steps: 13 | Train Loss: 0.659 Vali Loss: 1.120 Vali Acc: 0.732 Test Loss: 1.120 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.353466033935547
Epoch: 13, Steps: 13 | Train Loss: 0.510 Vali Loss: 2.961 Vali Acc: 0.327 Test Loss: 2.961 Test Acc: 0.327
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.0948450565338135
Epoch: 14, Steps: 13 | Train Loss: 0.581 Vali Loss: 0.716 Vali Acc: 0.688 Test Loss: 0.716 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.016274929046631
Epoch: 15, Steps: 13 | Train Loss: 0.291 Vali Loss: 0.926 Vali Acc: 0.761 Test Loss: 0.926 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.9749081134796143
Epoch: 16, Steps: 13 | Train Loss: 0.485 Vali Loss: 2.215 Vali Acc: 0.356 Test Loss: 2.215 Test Acc: 0.356
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.774249315261841
Epoch: 17, Steps: 13 | Train Loss: 0.561 Vali Loss: 2.158 Vali Acc: 0.390 Test Loss: 2.158 Test Acc: 0.390
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.951911687850952
Epoch: 18, Steps: 13 | Train Loss: 0.209 Vali Loss: 1.831 Vali Acc: 0.459 Test Loss: 1.831 Test Acc: 0.459
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.703298807144165
Epoch: 19, Steps: 13 | Train Loss: 1.156 Vali Loss: 1.774 Vali Acc: 0.751 Test Loss: 1.774 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 777318
model size : 4.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.227411508560181
Epoch: 1, Steps: 13 | Train Loss: 0.852 Vali Loss: 0.755 Vali Acc: 0.722 Test Loss: 0.755 Test Acc: 0.722
Validation loss decreased (inf --> -0.721944).  Saving model ...
Epoch: 2 cost time: 2.9470162391662598
Epoch: 2, Steps: 13 | Train Loss: 0.614 Vali Loss: 0.781 Vali Acc: 0.722 Test Loss: 0.781 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.5503427982330322
Epoch: 3, Steps: 13 | Train Loss: 0.641 Vali Loss: 0.936 Vali Acc: 0.312 Test Loss: 0.936 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.4516327381134033
Epoch: 4, Steps: 13 | Train Loss: 0.698 Vali Loss: 1.450 Vali Acc: 0.717 Test Loss: 1.450 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.9088618755340576
Epoch: 5, Steps: 13 | Train Loss: 0.810 Vali Loss: 0.523 Vali Acc: 0.746 Test Loss: 0.523 Test Acc: 0.746
Validation loss decreased (-0.721944 --> -0.746336).  Saving model ...
Epoch: 6 cost time: 2.6400983333587646
Epoch: 6, Steps: 13 | Train Loss: 0.618 Vali Loss: 0.592 Vali Acc: 0.746 Test Loss: 0.592 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.4964559078216553
Epoch: 7, Steps: 13 | Train Loss: 0.731 Vali Loss: 1.075 Vali Acc: 0.717 Test Loss: 1.075 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.0555150508880615
Epoch: 8, Steps: 13 | Train Loss: 0.532 Vali Loss: 0.905 Vali Acc: 0.717 Test Loss: 0.905 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.1990387439727783
Epoch: 9, Steps: 13 | Train Loss: 0.399 Vali Loss: 0.729 Vali Acc: 0.732 Test Loss: 0.729 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.412055492401123
Epoch: 10, Steps: 13 | Train Loss: 0.353 Vali Loss: 0.997 Vali Acc: 0.732 Test Loss: 0.997 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.589895248413086
Epoch: 11, Steps: 13 | Train Loss: 0.564 Vali Loss: 0.948 Vali Acc: 0.732 Test Loss: 0.948 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.8227200508117676
Epoch: 12, Steps: 13 | Train Loss: 0.545 Vali Loss: 2.053 Vali Acc: 0.337 Test Loss: 2.053 Test Acc: 0.337
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.6299989223480225
Epoch: 13, Steps: 13 | Train Loss: 0.295 Vali Loss: 0.872 Vali Acc: 0.566 Test Loss: 0.872 Test Acc: 0.566
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.223207950592041
Epoch: 14, Steps: 13 | Train Loss: 0.289 Vali Loss: 0.746 Vali Acc: 0.644 Test Loss: 0.746 Test Acc: 0.644
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.7889468669891357
Epoch: 15, Steps: 13 | Train Loss: 0.906 Vali Loss: 0.990 Vali Acc: 0.766 Test Loss: 0.990 Test Acc: 0.766
Validation loss decreased (-0.746336 --> -0.765844).  Saving model ...
Epoch: 16 cost time: 2.856166362762451
Epoch: 16, Steps: 13 | Train Loss: 1.907 Vali Loss: 4.358 Vali Acc: 0.332 Test Loss: 4.358 Test Acc: 0.332
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.8812577724456787
Epoch: 17, Steps: 13 | Train Loss: 0.638 Vali Loss: 2.483 Vali Acc: 0.366 Test Loss: 2.483 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.7948904037475586
Epoch: 18, Steps: 13 | Train Loss: 0.307 Vali Loss: 1.373 Vali Acc: 0.537 Test Loss: 1.373 Test Acc: 0.537
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.9588019847869873
Epoch: 19, Steps: 13 | Train Loss: 0.329 Vali Loss: 3.962 Vali Acc: 0.351 Test Loss: 3.962 Test Acc: 0.351
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.0977091789245605
Epoch: 20, Steps: 13 | Train Loss: 1.033 Vali Loss: 1.128 Vali Acc: 0.717 Test Loss: 1.128 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.911975383758545
Epoch: 21, Steps: 13 | Train Loss: 0.610 Vali Loss: 1.620 Vali Acc: 0.771 Test Loss: 1.620 Test Acc: 0.771
Validation loss decreased (-0.765844 --> -0.770716).  Saving model ...
Epoch: 22 cost time: 2.465419054031372
Epoch: 22, Steps: 13 | Train Loss: 0.843 Vali Loss: 1.194 Vali Acc: 0.678 Test Loss: 1.194 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.8669025897979736
Epoch: 23, Steps: 13 | Train Loss: 1.991 Vali Loss: 2.365 Vali Acc: 0.507 Test Loss: 2.365 Test Acc: 0.507
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.7910895347595215
Epoch: 24, Steps: 13 | Train Loss: 0.382 Vali Loss: 1.708 Vali Acc: 0.624 Test Loss: 1.708 Test Acc: 0.624
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.7692112922668457
Epoch: 25, Steps: 13 | Train Loss: 0.257 Vali Loss: 1.456 Vali Acc: 0.673 Test Loss: 1.456 Test Acc: 0.673
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.422478437423706
Epoch: 26, Steps: 13 | Train Loss: 0.206 Vali Loss: 1.588 Vali Acc: 0.741 Test Loss: 1.588 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.5370066165924072
Epoch: 27, Steps: 13 | Train Loss: 0.128 Vali Loss: 2.632 Vali Acc: 0.502 Test Loss: 2.632 Test Acc: 0.502
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.460659980773926
Epoch: 28, Steps: 13 | Train Loss: 0.086 Vali Loss: 1.597 Vali Acc: 0.668 Test Loss: 1.597 Test Acc: 0.668
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.4001569747924805
Epoch: 29, Steps: 13 | Train Loss: 0.085 Vali Loss: 2.099 Vali Acc: 0.741 Test Loss: 2.099 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.007930040359497
Epoch: 30, Steps: 13 | Train Loss: 0.098 Vali Loss: 2.103 Vali Acc: 0.751 Test Loss: 2.103 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.8807222843170166
Epoch: 31, Steps: 13 | Train Loss: 0.052 Vali Loss: 1.624 Vali Acc: 0.678 Test Loss: 1.624 Test Acc: 0.678
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 774054
model size : 4.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.0932910442352295
Epoch: 1, Steps: 13 | Train Loss: 0.765 Vali Loss: 0.892 Vali Acc: 0.722 Test Loss: 0.892 Test Acc: 0.722
Validation loss decreased (inf --> -0.721942).  Saving model ...
Epoch: 2 cost time: 2.980929136276245
Epoch: 2, Steps: 13 | Train Loss: 0.727 Vali Loss: 1.244 Vali Acc: 0.712 Test Loss: 1.244 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.109917402267456
Epoch: 3, Steps: 13 | Train Loss: 0.981 Vali Loss: 0.664 Vali Acc: 0.712 Test Loss: 0.664 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.1778337955474854
Epoch: 4, Steps: 13 | Train Loss: 0.503 Vali Loss: 0.524 Vali Acc: 0.746 Test Loss: 0.524 Test Acc: 0.746
Validation loss decreased (-0.721942 --> -0.746336).  Saving model ...
Epoch: 5 cost time: 2.868596315383911
Epoch: 5, Steps: 13 | Train Loss: 0.575 Vali Loss: 0.613 Vali Acc: 0.732 Test Loss: 0.613 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.001490831375122
Epoch: 6, Steps: 13 | Train Loss: 0.511 Vali Loss: 0.857 Vali Acc: 0.424 Test Loss: 0.857 Test Acc: 0.424
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.040869951248169
Epoch: 7, Steps: 13 | Train Loss: 0.555 Vali Loss: 0.517 Vali Acc: 0.761 Test Loss: 0.517 Test Acc: 0.761
Validation loss decreased (-0.746336 --> -0.760970).  Saving model ...
Epoch: 8 cost time: 3.1708028316497803
Epoch: 8, Steps: 13 | Train Loss: 1.479 Vali Loss: 0.547 Vali Acc: 0.741 Test Loss: 0.547 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.2189252376556396
Epoch: 9, Steps: 13 | Train Loss: 1.163 Vali Loss: 0.674 Vali Acc: 0.610 Test Loss: 0.674 Test Acc: 0.610
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.1619441509246826
Epoch: 10, Steps: 13 | Train Loss: 0.855 Vali Loss: 2.208 Vali Acc: 0.722 Test Loss: 2.208 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.0036871433258057
Epoch: 11, Steps: 13 | Train Loss: 0.541 Vali Loss: 0.584 Vali Acc: 0.722 Test Loss: 0.584 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.9090664386749268
Epoch: 12, Steps: 13 | Train Loss: 0.772 Vali Loss: 1.025 Vali Acc: 0.737 Test Loss: 1.025 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.7694199085235596
Epoch: 13, Steps: 13 | Train Loss: 0.529 Vali Loss: 0.621 Vali Acc: 0.698 Test Loss: 0.621 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.9080631732940674
Epoch: 14, Steps: 13 | Train Loss: 0.870 Vali Loss: 4.519 Vali Acc: 0.302 Test Loss: 4.519 Test Acc: 0.302
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.675908088684082
Epoch: 15, Steps: 13 | Train Loss: 1.110 Vali Loss: 1.636 Vali Acc: 0.737 Test Loss: 1.636 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.5983173847198486
Epoch: 16, Steps: 13 | Train Loss: 0.711 Vali Loss: 3.064 Vali Acc: 0.722 Test Loss: 3.064 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.9257869720458984
Epoch: 17, Steps: 13 | Train Loss: 2.392 Vali Loss: 0.840 Vali Acc: 0.741 Test Loss: 0.840 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 701286
model size : 4.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.511111736297607
Epoch: 1, Steps: 13 | Train Loss: 0.681 Vali Loss: 0.617 Vali Acc: 0.712 Test Loss: 0.617 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 3.0571444034576416
Epoch: 2, Steps: 13 | Train Loss: 0.971 Vali Loss: 1.345 Vali Acc: 0.278 Test Loss: 1.345 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.9974277019500732
Epoch: 3, Steps: 13 | Train Loss: 0.852 Vali Loss: 1.118 Vali Acc: 0.722 Test Loss: 1.118 Test Acc: 0.722
Validation loss decreased (-0.712189 --> -0.721940).  Saving model ...
Epoch: 4 cost time: 3.326382875442505
Epoch: 4, Steps: 13 | Train Loss: 0.586 Vali Loss: 0.569 Vali Acc: 0.712 Test Loss: 0.569 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.345320463180542
Epoch: 5, Steps: 13 | Train Loss: 0.685 Vali Loss: 0.570 Vali Acc: 0.712 Test Loss: 0.570 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.859337329864502
Epoch: 6, Steps: 13 | Train Loss: 0.471 Vali Loss: 0.537 Vali Acc: 0.698 Test Loss: 0.537 Test Acc: 0.698
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.2520828247070312
Epoch: 7, Steps: 13 | Train Loss: 0.429 Vali Loss: 0.959 Vali Acc: 0.439 Test Loss: 0.959 Test Acc: 0.439
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.195218086242676
Epoch: 8, Steps: 13 | Train Loss: 1.005 Vali Loss: 1.248 Vali Acc: 0.732 Test Loss: 1.248 Test Acc: 0.732
Validation loss decreased (-0.721940 --> -0.731695).  Saving model ...
Epoch: 9 cost time: 2.6053683757781982
Epoch: 9, Steps: 13 | Train Loss: 0.663 Vali Loss: 0.618 Vali Acc: 0.756 Test Loss: 0.618 Test Acc: 0.756
Validation loss decreased (-0.731695 --> -0.756091).  Saving model ...
Epoch: 10 cost time: 2.1742360591888428
Epoch: 10, Steps: 13 | Train Loss: 0.414 Vali Loss: 0.853 Vali Acc: 0.507 Test Loss: 0.853 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.558093309402466
Epoch: 11, Steps: 13 | Train Loss: 0.548 Vali Loss: 1.652 Vali Acc: 0.341 Test Loss: 1.652 Test Acc: 0.341
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.474822521209717
Epoch: 12, Steps: 13 | Train Loss: 1.277 Vali Loss: 0.576 Vali Acc: 0.722 Test Loss: 0.576 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.848658561706543
Epoch: 13, Steps: 13 | Train Loss: 1.785 Vali Loss: 3.797 Vali Acc: 0.302 Test Loss: 3.797 Test Acc: 0.302
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.382636308670044
Epoch: 14, Steps: 13 | Train Loss: 1.714 Vali Loss: 0.887 Vali Acc: 0.756 Test Loss: 0.887 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.413536548614502
Epoch: 15, Steps: 13 | Train Loss: 0.360 Vali Loss: 0.765 Vali Acc: 0.741 Test Loss: 0.765 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.148554801940918
Epoch: 16, Steps: 13 | Train Loss: 1.429 Vali Loss: 0.705 Vali Acc: 0.727 Test Loss: 0.705 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.213716745376587
Epoch: 17, Steps: 13 | Train Loss: 0.517 Vali Loss: 0.869 Vali Acc: 0.741 Test Loss: 0.869 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.649538040161133
Epoch: 18, Steps: 13 | Train Loss: 0.602 Vali Loss: 1.655 Vali Acc: 0.727 Test Loss: 1.655 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.294257879257202
Epoch: 19, Steps: 13 | Train Loss: 0.424 Vali Loss: 1.978 Vali Acc: 0.449 Test Loss: 1.978 Test Acc: 0.449
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 698022
model size : 3.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.3705432415008545
Epoch: 1, Steps: 13 | Train Loss: 0.866 Vali Loss: 0.654 Vali Acc: 0.722 Test Loss: 0.654 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.317565441131592
Epoch: 2, Steps: 13 | Train Loss: 0.848 Vali Loss: 0.829 Vali Acc: 0.283 Test Loss: 0.829 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.210040330886841
Epoch: 3, Steps: 13 | Train Loss: 0.605 Vali Loss: 0.800 Vali Acc: 0.722 Test Loss: 0.800 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.4587059020996094
Epoch: 4, Steps: 13 | Train Loss: 0.873 Vali Loss: 0.550 Vali Acc: 0.741 Test Loss: 0.550 Test Acc: 0.741
Validation loss decreased (-0.721945 --> -0.741458).  Saving model ...
Epoch: 5 cost time: 2.2949435710906982
Epoch: 5, Steps: 13 | Train Loss: 0.563 Vali Loss: 0.580 Vali Acc: 0.737 Test Loss: 0.580 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.89727783203125
Epoch: 6, Steps: 13 | Train Loss: 0.703 Vali Loss: 0.565 Vali Acc: 0.693 Test Loss: 0.565 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.8374221324920654
Epoch: 7, Steps: 13 | Train Loss: 0.552 Vali Loss: 1.853 Vali Acc: 0.293 Test Loss: 1.853 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.813145875930786
Epoch: 8, Steps: 13 | Train Loss: 1.185 Vali Loss: 1.351 Vali Acc: 0.722 Test Loss: 1.351 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.033656597137451
Epoch: 9, Steps: 13 | Train Loss: 0.465 Vali Loss: 0.554 Vali Acc: 0.702 Test Loss: 0.554 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.1702206134796143
Epoch: 10, Steps: 13 | Train Loss: 0.434 Vali Loss: 1.121 Vali Acc: 0.732 Test Loss: 1.121 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.0627872943878174
Epoch: 11, Steps: 13 | Train Loss: 0.513 Vali Loss: 0.890 Vali Acc: 0.737 Test Loss: 0.890 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.8125994205474854
Epoch: 12, Steps: 13 | Train Loss: 0.550 Vali Loss: 0.752 Vali Acc: 0.746 Test Loss: 0.752 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746334).  Saving model ...
Epoch: 13 cost time: 3.2814888954162598
Epoch: 13, Steps: 13 | Train Loss: 0.425 Vali Loss: 0.738 Vali Acc: 0.649 Test Loss: 0.738 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.891399383544922
Epoch: 14, Steps: 13 | Train Loss: 0.426 Vali Loss: 1.031 Vali Acc: 0.498 Test Loss: 1.031 Test Acc: 0.498
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.0386106967926025
Epoch: 15, Steps: 13 | Train Loss: 0.357 Vali Loss: 0.706 Vali Acc: 0.688 Test Loss: 0.706 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.7018394470214844
Epoch: 16, Steps: 13 | Train Loss: 0.520 Vali Loss: 0.921 Vali Acc: 0.761 Test Loss: 0.921 Test Acc: 0.761
Validation loss decreased (-0.746334 --> -0.760966).  Saving model ...
Epoch: 17 cost time: 2.1083600521087646
Epoch: 17, Steps: 13 | Train Loss: 0.412 Vali Loss: 2.890 Vali Acc: 0.717 Test Loss: 2.890 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.69050669670105
Epoch: 18, Steps: 13 | Train Loss: 1.315 Vali Loss: 1.400 Vali Acc: 0.527 Test Loss: 1.400 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.108140230178833
Epoch: 19, Steps: 13 | Train Loss: 0.437 Vali Loss: 1.059 Vali Acc: 0.590 Test Loss: 1.059 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.616443395614624
Epoch: 20, Steps: 13 | Train Loss: 0.251 Vali Loss: 3.786 Vali Acc: 0.366 Test Loss: 3.786 Test Acc: 0.366
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.429987668991089
Epoch: 21, Steps: 13 | Train Loss: 0.983 Vali Loss: 1.048 Vali Acc: 0.712 Test Loss: 1.048 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.6514365673065186
Epoch: 22, Steps: 13 | Train Loss: 1.389 Vali Loss: 1.316 Vali Acc: 0.737 Test Loss: 1.316 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.5236353874206543
Epoch: 23, Steps: 13 | Train Loss: 0.613 Vali Loss: 3.708 Vali Acc: 0.371 Test Loss: 3.708 Test Acc: 0.371
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.931541919708252
Epoch: 24, Steps: 13 | Train Loss: 0.541 Vali Loss: 1.318 Vali Acc: 0.732 Test Loss: 1.318 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.055002450942993
Epoch: 25, Steps: 13 | Train Loss: 0.417 Vali Loss: 1.595 Vali Acc: 0.727 Test Loss: 1.595 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.039132595062256
Epoch: 26, Steps: 13 | Train Loss: 0.097 Vali Loss: 1.342 Vali Acc: 0.654 Test Loss: 1.342 Test Acc: 0.654
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 694758
model size : 3.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.668124437332153
Epoch: 1, Steps: 13 | Train Loss: 0.698 Vali Loss: 0.572 Vali Acc: 0.717 Test Loss: 0.572 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 2.8727667331695557
Epoch: 2, Steps: 13 | Train Loss: 1.045 Vali Loss: 1.123 Vali Acc: 0.722 Test Loss: 1.123 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721940).  Saving model ...
Epoch: 3 cost time: 2.8549396991729736
Epoch: 3, Steps: 13 | Train Loss: 1.060 Vali Loss: 1.756 Vali Acc: 0.278 Test Loss: 1.756 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.8519842624664307
Epoch: 4, Steps: 13 | Train Loss: 0.915 Vali Loss: 0.542 Vali Acc: 0.732 Test Loss: 0.542 Test Acc: 0.732
Validation loss decreased (-0.721940 --> -0.731702).  Saving model ...
Epoch: 5 cost time: 2.540972948074341
Epoch: 5, Steps: 13 | Train Loss: 1.038 Vali Loss: 0.519 Vali Acc: 0.756 Test Loss: 0.519 Test Acc: 0.756
Validation loss decreased (-0.731702 --> -0.756092).  Saving model ...
Epoch: 6 cost time: 2.8365604877471924
Epoch: 6, Steps: 13 | Train Loss: 0.768 Vali Loss: 1.027 Vali Acc: 0.395 Test Loss: 1.027 Test Acc: 0.395
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.6672182083129883
Epoch: 7, Steps: 13 | Train Loss: 0.589 Vali Loss: 0.519 Vali Acc: 0.776 Test Loss: 0.519 Test Acc: 0.776
Validation loss decreased (-0.756092 --> -0.775605).  Saving model ...
Epoch: 8 cost time: 2.5065553188323975
Epoch: 8, Steps: 13 | Train Loss: 0.791 Vali Loss: 3.933 Vali Acc: 0.288 Test Loss: 3.933 Test Acc: 0.288
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.3065993785858154
Epoch: 9, Steps: 13 | Train Loss: 0.965 Vali Loss: 1.587 Vali Acc: 0.361 Test Loss: 1.587 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.3438360691070557
Epoch: 10, Steps: 13 | Train Loss: 0.608 Vali Loss: 0.540 Vali Acc: 0.746 Test Loss: 0.540 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.744626522064209
Epoch: 11, Steps: 13 | Train Loss: 0.309 Vali Loss: 0.816 Vali Acc: 0.756 Test Loss: 0.816 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.511356830596924
Epoch: 12, Steps: 13 | Train Loss: 0.545 Vali Loss: 0.600 Vali Acc: 0.727 Test Loss: 0.600 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.057941198348999
Epoch: 13, Steps: 13 | Train Loss: 0.579 Vali Loss: 4.221 Vali Acc: 0.307 Test Loss: 4.221 Test Acc: 0.307
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.7792372703552246
Epoch: 14, Steps: 13 | Train Loss: 1.209 Vali Loss: 1.073 Vali Acc: 0.771 Test Loss: 1.073 Test Acc: 0.771
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.8158183097839355
Epoch: 15, Steps: 13 | Train Loss: 0.332 Vali Loss: 0.740 Vali Acc: 0.707 Test Loss: 0.740 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.4529716968536377
Epoch: 16, Steps: 13 | Train Loss: 0.611 Vali Loss: 0.996 Vali Acc: 0.756 Test Loss: 0.996 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.655574321746826
Epoch: 17, Steps: 13 | Train Loss: 0.338 Vali Loss: 3.955 Vali Acc: 0.298 Test Loss: 3.955 Test Acc: 0.298
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 691494
model size : 3.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.177087783813477
Epoch: 1, Steps: 13 | Train Loss: 0.703 Vali Loss: 0.619 Vali Acc: 0.722 Test Loss: 0.619 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.870058536529541
Epoch: 2, Steps: 13 | Train Loss: 0.733 Vali Loss: 0.837 Vali Acc: 0.278 Test Loss: 0.837 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.8242077827453613
Epoch: 3, Steps: 13 | Train Loss: 0.939 Vali Loss: 0.788 Vali Acc: 0.317 Test Loss: 0.788 Test Acc: 0.317
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.4321696758270264
Epoch: 4, Steps: 13 | Train Loss: 0.645 Vali Loss: 0.529 Vali Acc: 0.741 Test Loss: 0.529 Test Acc: 0.741
Validation loss decreased (-0.721945 --> -0.741458).  Saving model ...
Epoch: 5 cost time: 2.972189426422119
Epoch: 5, Steps: 13 | Train Loss: 0.559 Vali Loss: 0.607 Vali Acc: 0.741 Test Loss: 0.607 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.965169906616211
Epoch: 6, Steps: 13 | Train Loss: 0.752 Vali Loss: 1.306 Vali Acc: 0.337 Test Loss: 1.306 Test Acc: 0.337
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.3964736461639404
Epoch: 7, Steps: 13 | Train Loss: 1.348 Vali Loss: 1.579 Vali Acc: 0.322 Test Loss: 1.579 Test Acc: 0.322
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.382955551147461
Epoch: 8, Steps: 13 | Train Loss: 0.964 Vali Loss: 1.113 Vali Acc: 0.722 Test Loss: 1.113 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.659193754196167
Epoch: 9, Steps: 13 | Train Loss: 0.869 Vali Loss: 0.681 Vali Acc: 0.741 Test Loss: 0.681 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.0308187007904053
Epoch: 10, Steps: 13 | Train Loss: 0.517 Vali Loss: 0.731 Vali Acc: 0.727 Test Loss: 0.731 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.7717158794403076
Epoch: 11, Steps: 13 | Train Loss: 0.546 Vali Loss: 1.040 Vali Acc: 0.473 Test Loss: 1.040 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.5851495265960693
Epoch: 12, Steps: 13 | Train Loss: 0.376 Vali Loss: 0.605 Vali Acc: 0.659 Test Loss: 0.605 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.135377883911133
Epoch: 13, Steps: 13 | Train Loss: 0.499 Vali Loss: 1.064 Vali Acc: 0.468 Test Loss: 1.064 Test Acc: 0.468
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.722799777984619
Epoch: 14, Steps: 13 | Train Loss: 0.594 Vali Loss: 1.378 Vali Acc: 0.722 Test Loss: 1.378 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 560262
model size : 2.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.2343292236328125
Epoch: 1, Steps: 13 | Train Loss: 0.675 Vali Loss: 0.599 Vali Acc: 0.722 Test Loss: 0.599 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.3686716556549072
Epoch: 2, Steps: 13 | Train Loss: 0.646 Vali Loss: 0.652 Vali Acc: 0.712 Test Loss: 0.652 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.7023885250091553
Epoch: 3, Steps: 13 | Train Loss: 0.604 Vali Loss: 1.225 Vali Acc: 0.283 Test Loss: 1.225 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.903505802154541
Epoch: 4, Steps: 13 | Train Loss: 0.691 Vali Loss: 0.864 Vali Acc: 0.722 Test Loss: 0.864 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.0184121131896973
Epoch: 5, Steps: 13 | Train Loss: 0.528 Vali Loss: 0.703 Vali Acc: 0.722 Test Loss: 0.703 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.5742897987365723
Epoch: 6, Steps: 13 | Train Loss: 0.512 Vali Loss: 0.908 Vali Acc: 0.722 Test Loss: 0.908 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.554611921310425
Epoch: 7, Steps: 13 | Train Loss: 0.501 Vali Loss: 0.522 Vali Acc: 0.741 Test Loss: 0.522 Test Acc: 0.741
Validation loss decreased (-0.721945 --> -0.741458).  Saving model ...
Epoch: 8 cost time: 3.083935022354126
Epoch: 8, Steps: 13 | Train Loss: 0.495 Vali Loss: 0.932 Vali Acc: 0.473 Test Loss: 0.932 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.8788678646087646
Epoch: 9, Steps: 13 | Train Loss: 0.638 Vali Loss: 0.724 Vali Acc: 0.732 Test Loss: 0.724 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.8133819103240967
Epoch: 10, Steps: 13 | Train Loss: 0.672 Vali Loss: 0.702 Vali Acc: 0.576 Test Loss: 0.702 Test Acc: 0.576
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.959599018096924
Epoch: 11, Steps: 13 | Train Loss: 0.441 Vali Loss: 1.849 Vali Acc: 0.327 Test Loss: 1.849 Test Acc: 0.327
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.394468307495117
Epoch: 12, Steps: 13 | Train Loss: 0.731 Vali Loss: 0.902 Vali Acc: 0.727 Test Loss: 0.902 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.353163242340088
Epoch: 13, Steps: 13 | Train Loss: 0.320 Vali Loss: 0.697 Vali Acc: 0.649 Test Loss: 0.697 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.118077278137207
Epoch: 14, Steps: 13 | Train Loss: 0.264 Vali Loss: 1.082 Vali Acc: 0.727 Test Loss: 1.082 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.3618052005767822
Epoch: 15, Steps: 13 | Train Loss: 0.382 Vali Loss: 1.532 Vali Acc: 0.390 Test Loss: 1.532 Test Acc: 0.390
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.2580511569976807
Epoch: 16, Steps: 13 | Train Loss: 0.484 Vali Loss: 0.881 Vali Acc: 0.737 Test Loss: 0.881 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.139265537261963
Epoch: 17, Steps: 13 | Train Loss: 0.495 Vali Loss: 1.221 Vali Acc: 0.732 Test Loss: 1.221 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 558630
model size : 2.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.615053415298462
Epoch: 1, Steps: 13 | Train Loss: 0.724 Vali Loss: 0.599 Vali Acc: 0.722 Test Loss: 0.599 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.7318341732025146
Epoch: 2, Steps: 13 | Train Loss: 0.678 Vali Loss: 0.701 Vali Acc: 0.410 Test Loss: 0.701 Test Acc: 0.410
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.23994779586792
Epoch: 3, Steps: 13 | Train Loss: 0.617 Vali Loss: 0.536 Vali Acc: 0.741 Test Loss: 0.536 Test Acc: 0.741
Validation loss decreased (-0.721945 --> -0.741458).  Saving model ...
Epoch: 4 cost time: 2.9800097942352295
Epoch: 4, Steps: 13 | Train Loss: 0.545 Vali Loss: 0.519 Vali Acc: 0.756 Test Loss: 0.519 Test Acc: 0.756
Validation loss decreased (-0.741458 --> -0.756092).  Saving model ...
Epoch: 5 cost time: 3.0296356678009033
Epoch: 5, Steps: 13 | Train Loss: 0.599 Vali Loss: 0.992 Vali Acc: 0.337 Test Loss: 0.992 Test Acc: 0.337
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.65751051902771
Epoch: 6, Steps: 13 | Train Loss: 0.800 Vali Loss: 1.076 Vali Acc: 0.722 Test Loss: 1.076 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.1781373023986816
Epoch: 7, Steps: 13 | Train Loss: 0.618 Vali Loss: 0.500 Vali Acc: 0.771 Test Loss: 0.500 Test Acc: 0.771
Validation loss decreased (-0.756092 --> -0.770727).  Saving model ...
Epoch: 8 cost time: 2.448277473449707
Epoch: 8, Steps: 13 | Train Loss: 0.474 Vali Loss: 0.735 Vali Acc: 0.566 Test Loss: 0.735 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.8712003231048584
Epoch: 9, Steps: 13 | Train Loss: 0.524 Vali Loss: 0.608 Vali Acc: 0.741 Test Loss: 0.608 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.3364241123199463
Epoch: 10, Steps: 13 | Train Loss: 0.593 Vali Loss: 0.547 Vali Acc: 0.766 Test Loss: 0.547 Test Acc: 0.766
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.4107344150543213
Epoch: 11, Steps: 13 | Train Loss: 0.340 Vali Loss: 0.572 Vali Acc: 0.776 Test Loss: 0.572 Test Acc: 0.776
Validation loss decreased (-0.770727 --> -0.775604).  Saving model ...
Epoch: 12 cost time: 2.8979668617248535
Epoch: 12, Steps: 13 | Train Loss: 0.313 Vali Loss: 0.668 Vali Acc: 0.644 Test Loss: 0.668 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.6907520294189453
Epoch: 13, Steps: 13 | Train Loss: 0.333 Vali Loss: 0.736 Vali Acc: 0.756 Test Loss: 0.736 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.2220587730407715
Epoch: 14, Steps: 13 | Train Loss: 0.246 Vali Loss: 0.953 Vali Acc: 0.571 Test Loss: 0.953 Test Acc: 0.571
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.8122074604034424
Epoch: 15, Steps: 13 | Train Loss: 0.325 Vali Loss: 1.526 Vali Acc: 0.459 Test Loss: 1.526 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.0757710933685303
Epoch: 16, Steps: 13 | Train Loss: 0.425 Vali Loss: 0.867 Vali Acc: 0.571 Test Loss: 0.867 Test Acc: 0.571
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.171046257019043
Epoch: 17, Steps: 13 | Train Loss: 0.187 Vali Loss: 1.051 Vali Acc: 0.761 Test Loss: 1.051 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.3554749488830566
Epoch: 18, Steps: 13 | Train Loss: 0.463 Vali Loss: 1.290 Vali Acc: 0.532 Test Loss: 1.290 Test Acc: 0.532
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.3629188537597656
Epoch: 19, Steps: 13 | Train Loss: 0.242 Vali Loss: 0.944 Vali Acc: 0.756 Test Loss: 0.944 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.967719793319702
Epoch: 20, Steps: 13 | Train Loss: 0.190 Vali Loss: 1.032 Vali Acc: 0.771 Test Loss: 1.032 Test Acc: 0.771
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.8327558040618896
Epoch: 21, Steps: 13 | Train Loss: 0.109 Vali Loss: 1.510 Vali Acc: 0.746 Test Loss: 1.510 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 556998
model size : 2.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.463067054748535
Epoch: 1, Steps: 13 | Train Loss: 0.647 Vali Loss: 0.591 Vali Acc: 0.722 Test Loss: 0.591 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.922712564468384
Epoch: 2, Steps: 13 | Train Loss: 0.677 Vali Loss: 0.589 Vali Acc: 0.722 Test Loss: 0.589 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 2.711118221282959
Epoch: 3, Steps: 13 | Train Loss: 0.688 Vali Loss: 0.557 Vali Acc: 0.727 Test Loss: 0.557 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726824).  Saving model ...
Epoch: 4 cost time: 2.81799578666687
Epoch: 4, Steps: 13 | Train Loss: 0.687 Vali Loss: 0.789 Vali Acc: 0.722 Test Loss: 0.789 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.7588837146759033
Epoch: 5, Steps: 13 | Train Loss: 0.643 Vali Loss: 0.864 Vali Acc: 0.312 Test Loss: 0.864 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.7552073001861572
Epoch: 6, Steps: 13 | Train Loss: 0.534 Vali Loss: 1.639 Vali Acc: 0.722 Test Loss: 1.639 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.603562593460083
Epoch: 7, Steps: 13 | Train Loss: 0.918 Vali Loss: 0.519 Vali Acc: 0.746 Test Loss: 0.519 Test Acc: 0.746
Validation loss decreased (-0.726824 --> -0.746336).  Saving model ...
Epoch: 8 cost time: 2.5865464210510254
Epoch: 8, Steps: 13 | Train Loss: 1.097 Vali Loss: 0.593 Vali Acc: 0.751 Test Loss: 0.593 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751214).  Saving model ...
Epoch: 9 cost time: 2.5370755195617676
Epoch: 9, Steps: 13 | Train Loss: 0.450 Vali Loss: 0.525 Vali Acc: 0.707 Test Loss: 0.525 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.045172929763794
Epoch: 10, Steps: 13 | Train Loss: 0.393 Vali Loss: 0.802 Vali Acc: 0.732 Test Loss: 0.802 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.9594171047210693
Epoch: 11, Steps: 13 | Train Loss: 0.524 Vali Loss: 0.542 Vali Acc: 0.707 Test Loss: 0.542 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.3728597164154053
Epoch: 12, Steps: 13 | Train Loss: 0.275 Vali Loss: 0.853 Vali Acc: 0.741 Test Loss: 0.853 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.9500043392181396
Epoch: 13, Steps: 13 | Train Loss: 0.395 Vali Loss: 0.671 Vali Acc: 0.624 Test Loss: 0.671 Test Acc: 0.624
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.5100064277648926
Epoch: 14, Steps: 13 | Train Loss: 0.284 Vali Loss: 0.600 Vali Acc: 0.737 Test Loss: 0.600 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.5305213928222656
Epoch: 15, Steps: 13 | Train Loss: 0.699 Vali Loss: 1.657 Vali Acc: 0.732 Test Loss: 1.657 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.185940980911255
Epoch: 16, Steps: 13 | Train Loss: 1.719 Vali Loss: 1.987 Vali Acc: 0.717 Test Loss: 1.987 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.685586929321289
Epoch: 17, Steps: 13 | Train Loss: 0.869 Vali Loss: 0.711 Vali Acc: 0.727 Test Loss: 0.711 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.7908668518066406
Epoch: 18, Steps: 13 | Train Loss: 0.687 Vali Loss: 1.189 Vali Acc: 0.522 Test Loss: 1.189 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 555366
model size : 2.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.1708173751831055
Epoch: 1, Steps: 13 | Train Loss: 0.692 Vali Loss: 0.712 Vali Acc: 0.337 Test Loss: 0.712 Test Acc: 0.337
Validation loss decreased (inf --> -0.336578).  Saving model ...
Epoch: 2 cost time: 2.880894184112549
Epoch: 2, Steps: 13 | Train Loss: 0.591 Vali Loss: 0.870 Vali Acc: 0.722 Test Loss: 0.870 Test Acc: 0.722
Validation loss decreased (-0.336578 --> -0.721943).  Saving model ...
Epoch: 3 cost time: 2.7914607524871826
Epoch: 3, Steps: 13 | Train Loss: 0.685 Vali Loss: 0.612 Vali Acc: 0.722 Test Loss: 0.612 Test Acc: 0.722
Validation loss decreased (-0.721943 --> -0.721945).  Saving model ...
Epoch: 4 cost time: 2.8121979236602783
Epoch: 4, Steps: 13 | Train Loss: 0.632 Vali Loss: 0.600 Vali Acc: 0.712 Test Loss: 0.600 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5831592082977295
Epoch: 5, Steps: 13 | Train Loss: 0.573 Vali Loss: 0.526 Vali Acc: 0.741 Test Loss: 0.526 Test Acc: 0.741
Validation loss decreased (-0.721945 --> -0.741458).  Saving model ...
Epoch: 6 cost time: 2.8147988319396973
Epoch: 6, Steps: 13 | Train Loss: 0.611 Vali Loss: 0.755 Vali Acc: 0.468 Test Loss: 0.755 Test Acc: 0.468
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.8698508739471436
Epoch: 7, Steps: 13 | Train Loss: 0.741 Vali Loss: 0.980 Vali Acc: 0.722 Test Loss: 0.980 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.6293749809265137
Epoch: 8, Steps: 13 | Train Loss: 0.559 Vali Loss: 0.746 Vali Acc: 0.566 Test Loss: 0.746 Test Acc: 0.566
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.667038917541504
Epoch: 9, Steps: 13 | Train Loss: 0.486 Vali Loss: 0.573 Vali Acc: 0.746 Test Loss: 0.573 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746336).  Saving model ...
Epoch: 10 cost time: 2.5637385845184326
Epoch: 10, Steps: 13 | Train Loss: 0.660 Vali Loss: 0.532 Vali Acc: 0.727 Test Loss: 0.532 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.783261775970459
Epoch: 11, Steps: 13 | Train Loss: 0.684 Vali Loss: 0.942 Vali Acc: 0.712 Test Loss: 0.942 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.6547603607177734
Epoch: 12, Steps: 13 | Train Loss: 0.554 Vali Loss: 0.673 Vali Acc: 0.746 Test Loss: 0.673 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.2202022075653076
Epoch: 13, Steps: 13 | Train Loss: 0.329 Vali Loss: 0.539 Vali Acc: 0.756 Test Loss: 0.539 Test Acc: 0.756
Validation loss decreased (-0.746336 --> -0.756092).  Saving model ...
Epoch: 14 cost time: 3.268126964569092
Epoch: 14, Steps: 13 | Train Loss: 0.680 Vali Loss: 0.561 Vali Acc: 0.702 Test Loss: 0.561 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.150305986404419
Epoch: 15, Steps: 13 | Train Loss: 0.293 Vali Loss: 1.243 Vali Acc: 0.722 Test Loss: 1.243 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.887735366821289
Epoch: 16, Steps: 13 | Train Loss: 0.413 Vali Loss: 0.894 Vali Acc: 0.541 Test Loss: 0.894 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.671689510345459
Epoch: 17, Steps: 13 | Train Loss: 0.262 Vali Loss: 0.594 Vali Acc: 0.737 Test Loss: 0.594 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.0084915161132812
Epoch: 18, Steps: 13 | Train Loss: 0.312 Vali Loss: 1.099 Vali Acc: 0.556 Test Loss: 1.099 Test Acc: 0.556
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.6489856243133545
Epoch: 19, Steps: 13 | Train Loss: 0.772 Vali Loss: 1.736 Vali Acc: 0.727 Test Loss: 1.736 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.584341287612915
Epoch: 20, Steps: 13 | Train Loss: 0.332 Vali Loss: 0.931 Vali Acc: 0.751 Test Loss: 0.931 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.6626858711242676
Epoch: 21, Steps: 13 | Train Loss: 0.210 Vali Loss: 0.914 Vali Acc: 0.741 Test Loss: 0.914 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.543531894683838
Epoch: 22, Steps: 13 | Train Loss: 0.211 Vali Loss: 0.894 Vali Acc: 0.644 Test Loss: 0.894 Test Acc: 0.644
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.393857955932617
Epoch: 23, Steps: 13 | Train Loss: 0.155 Vali Loss: 0.774 Vali Acc: 0.746 Test Loss: 0.774 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 393862
model size : 2.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.257074594497681
Epoch: 1, Steps: 13 | Train Loss: 0.674 Vali Loss: 0.661 Vali Acc: 0.732 Test Loss: 0.661 Test Acc: 0.732
Validation loss decreased (inf --> -0.731701).  Saving model ...
Epoch: 2 cost time: 2.5167713165283203
Epoch: 2, Steps: 13 | Train Loss: 0.626 Vali Loss: 0.605 Vali Acc: 0.756 Test Loss: 0.605 Test Acc: 0.756
Validation loss decreased (-0.731701 --> -0.756092).  Saving model ...
Epoch: 3 cost time: 2.1843554973602295
Epoch: 3, Steps: 13 | Train Loss: 0.657 Vali Loss: 0.748 Vali Acc: 0.722 Test Loss: 0.748 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.95324969291687
Epoch: 4, Steps: 13 | Train Loss: 0.771 Vali Loss: 0.960 Vali Acc: 0.298 Test Loss: 0.960 Test Acc: 0.298
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.141469955444336
Epoch: 5, Steps: 13 | Train Loss: 0.599 Vali Loss: 0.551 Vali Acc: 0.732 Test Loss: 0.551 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.9952616691589355
Epoch: 6, Steps: 13 | Train Loss: 0.481 Vali Loss: 0.575 Vali Acc: 0.678 Test Loss: 0.575 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.829143762588501
Epoch: 7, Steps: 13 | Train Loss: 0.396 Vali Loss: 0.527 Vali Acc: 0.741 Test Loss: 0.527 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.029447078704834
Epoch: 8, Steps: 13 | Train Loss: 0.416 Vali Loss: 0.514 Vali Acc: 0.727 Test Loss: 0.514 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.192443370819092
Epoch: 9, Steps: 13 | Train Loss: 0.619 Vali Loss: 0.904 Vali Acc: 0.722 Test Loss: 0.904 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.789039134979248
Epoch: 10, Steps: 13 | Train Loss: 0.374 Vali Loss: 0.565 Vali Acc: 0.761 Test Loss: 0.565 Test Acc: 0.761
Validation loss decreased (-0.756092 --> -0.760970).  Saving model ...
Epoch: 11 cost time: 3.654985189437866
Epoch: 11, Steps: 13 | Train Loss: 0.427 Vali Loss: 0.654 Vali Acc: 0.629 Test Loss: 0.654 Test Acc: 0.629
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.801576614379883
Epoch: 12, Steps: 13 | Train Loss: 0.366 Vali Loss: 1.730 Vali Acc: 0.341 Test Loss: 1.730 Test Acc: 0.341
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.6898820400238037
Epoch: 13, Steps: 13 | Train Loss: 0.563 Vali Loss: 1.433 Vali Acc: 0.727 Test Loss: 1.433 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.732970952987671
Epoch: 14, Steps: 13 | Train Loss: 0.300 Vali Loss: 1.698 Vali Acc: 0.405 Test Loss: 1.698 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.439375638961792
Epoch: 15, Steps: 13 | Train Loss: 0.885 Vali Loss: 0.717 Vali Acc: 0.756 Test Loss: 0.717 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.296903371810913
Epoch: 16, Steps: 13 | Train Loss: 0.218 Vali Loss: 0.633 Vali Acc: 0.673 Test Loss: 0.633 Test Acc: 0.673
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.9988842010498047
Epoch: 17, Steps: 13 | Train Loss: 0.166 Vali Loss: 0.644 Vali Acc: 0.678 Test Loss: 0.644 Test Acc: 0.678
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.6906092166900635
Epoch: 18, Steps: 13 | Train Loss: 0.169 Vali Loss: 0.866 Vali Acc: 0.780 Test Loss: 0.866 Test Acc: 0.780
Validation loss decreased (-0.760970 --> -0.780479).  Saving model ...
Epoch: 19 cost time: 2.535526990890503
Epoch: 19, Steps: 13 | Train Loss: 0.162 Vali Loss: 0.719 Vali Acc: 0.683 Test Loss: 0.719 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.577535629272461
Epoch: 20, Steps: 13 | Train Loss: 0.164 Vali Loss: 0.925 Vali Acc: 0.634 Test Loss: 0.925 Test Acc: 0.634
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.5209271907806396
Epoch: 21, Steps: 13 | Train Loss: 0.129 Vali Loss: 0.814 Vali Acc: 0.649 Test Loss: 0.814 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.2245256900787354
Epoch: 22, Steps: 13 | Train Loss: 0.110 Vali Loss: 1.216 Vali Acc: 0.751 Test Loss: 1.216 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.896657943725586
Epoch: 23, Steps: 13 | Train Loss: 0.308 Vali Loss: 2.520 Vali Acc: 0.434 Test Loss: 2.520 Test Acc: 0.434
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.0051252841949463
Epoch: 24, Steps: 13 | Train Loss: 0.459 Vali Loss: 1.693 Vali Acc: 0.746 Test Loss: 1.693 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.8641395568847656
Epoch: 25, Steps: 13 | Train Loss: 0.106 Vali Loss: 0.937 Vali Acc: 0.693 Test Loss: 0.937 Test Acc: 0.693
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.7532477378845215
Epoch: 26, Steps: 13 | Train Loss: 0.108 Vali Loss: 1.008 Vali Acc: 0.659 Test Loss: 1.008 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.4116666316986084
Epoch: 27, Steps: 13 | Train Loss: 0.075 Vali Loss: 1.389 Vali Acc: 0.590 Test Loss: 1.389 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.3445885181427
Epoch: 28, Steps: 13 | Train Loss: 0.092 Vali Loss: 1.049 Vali Acc: 0.737 Test Loss: 1.049 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7804878048780488
model parameter : 392230
model size : 2.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.588181972503662
Epoch: 1, Steps: 13 | Train Loss: 0.737 Vali Loss: 0.731 Vali Acc: 0.722 Test Loss: 0.731 Test Acc: 0.722
Validation loss decreased (inf --> -0.721944).  Saving model ...
Epoch: 2 cost time: 3.0116050243377686
Epoch: 2, Steps: 13 | Train Loss: 0.877 Vali Loss: 0.620 Vali Acc: 0.722 Test Loss: 0.620 Test Acc: 0.722
Validation loss decreased (-0.721944 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 2.8321046829223633
Epoch: 3, Steps: 13 | Train Loss: 0.871 Vali Loss: 0.631 Vali Acc: 0.702 Test Loss: 0.631 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.816337823867798
Epoch: 4, Steps: 13 | Train Loss: 0.677 Vali Loss: 0.588 Vali Acc: 0.717 Test Loss: 0.588 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.719219923019409
Epoch: 5, Steps: 13 | Train Loss: 0.544 Vali Loss: 0.529 Vali Acc: 0.751 Test Loss: 0.529 Test Acc: 0.751
Validation loss decreased (-0.721945 --> -0.751214).  Saving model ...
Epoch: 6 cost time: 2.485955238342285
Epoch: 6, Steps: 13 | Train Loss: 0.486 Vali Loss: 0.695 Vali Acc: 0.722 Test Loss: 0.695 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.709059238433838
Epoch: 7, Steps: 13 | Train Loss: 0.507 Vali Loss: 0.572 Vali Acc: 0.732 Test Loss: 0.572 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.601508617401123
Epoch: 8, Steps: 13 | Train Loss: 0.435 Vali Loss: 0.769 Vali Acc: 0.532 Test Loss: 0.769 Test Acc: 0.532
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.605412483215332
Epoch: 9, Steps: 13 | Train Loss: 0.648 Vali Loss: 0.706 Vali Acc: 0.727 Test Loss: 0.706 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.0518510341644287
Epoch: 10, Steps: 13 | Train Loss: 0.466 Vali Loss: 0.782 Vali Acc: 0.732 Test Loss: 0.782 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.3193211555480957
Epoch: 11, Steps: 13 | Train Loss: 0.411 Vali Loss: 0.558 Vali Acc: 0.746 Test Loss: 0.558 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.18114972114563
Epoch: 12, Steps: 13 | Train Loss: 0.306 Vali Loss: 0.597 Vali Acc: 0.741 Test Loss: 0.597 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.3009133338928223
Epoch: 13, Steps: 13 | Train Loss: 0.293 Vali Loss: 0.837 Vali Acc: 0.737 Test Loss: 0.837 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.666208028793335
Epoch: 14, Steps: 13 | Train Loss: 0.251 Vali Loss: 1.316 Vali Acc: 0.727 Test Loss: 1.316 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.541445255279541
Epoch: 15, Steps: 13 | Train Loss: 0.531 Vali Loss: 1.659 Vali Acc: 0.341 Test Loss: 1.659 Test Acc: 0.341
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 390598
model size : 2.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.9843809604644775
Epoch: 1, Steps: 13 | Train Loss: 0.703 Vali Loss: 0.755 Vali Acc: 0.722 Test Loss: 0.755 Test Acc: 0.722
Validation loss decreased (inf --> -0.721944).  Saving model ...
Epoch: 2 cost time: 3.010385513305664
Epoch: 2, Steps: 13 | Train Loss: 0.639 Vali Loss: 0.595 Vali Acc: 0.722 Test Loss: 0.595 Test Acc: 0.722
Validation loss decreased (-0.721944 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 2.6911118030548096
Epoch: 3, Steps: 13 | Train Loss: 0.675 Vali Loss: 0.567 Vali Acc: 0.722 Test Loss: 0.567 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721946).  Saving model ...
Epoch: 4 cost time: 2.5355122089385986
Epoch: 4, Steps: 13 | Train Loss: 0.645 Vali Loss: 0.542 Vali Acc: 0.727 Test Loss: 0.542 Test Acc: 0.727
Validation loss decreased (-0.721946 --> -0.726824).  Saving model ...
Epoch: 5 cost time: 2.6170735359191895
Epoch: 5, Steps: 13 | Train Loss: 0.493 Vali Loss: 0.794 Vali Acc: 0.424 Test Loss: 0.794 Test Acc: 0.424
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.9483916759490967
Epoch: 6, Steps: 13 | Train Loss: 0.568 Vali Loss: 0.677 Vali Acc: 0.595 Test Loss: 0.677 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.832754611968994
Epoch: 7, Steps: 13 | Train Loss: 0.468 Vali Loss: 0.762 Vali Acc: 0.522 Test Loss: 0.762 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.635735273361206
Epoch: 8, Steps: 13 | Train Loss: 0.538 Vali Loss: 0.556 Vali Acc: 0.741 Test Loss: 0.556 Test Acc: 0.741
Validation loss decreased (-0.726824 --> -0.741458).  Saving model ...
Epoch: 9 cost time: 2.512784004211426
Epoch: 9, Steps: 13 | Train Loss: 0.501 Vali Loss: 0.553 Vali Acc: 0.756 Test Loss: 0.553 Test Acc: 0.756
Validation loss decreased (-0.741458 --> -0.756092).  Saving model ...
Epoch: 10 cost time: 2.5860941410064697
Epoch: 10, Steps: 13 | Train Loss: 0.553 Vali Loss: 0.897 Vali Acc: 0.727 Test Loss: 0.897 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.371614933013916
Epoch: 11, Steps: 13 | Train Loss: 0.462 Vali Loss: 0.544 Vali Acc: 0.761 Test Loss: 0.544 Test Acc: 0.761
Validation loss decreased (-0.756092 --> -0.760970).  Saving model ...
Epoch: 12 cost time: 2.993396759033203
Epoch: 12, Steps: 13 | Train Loss: 0.485 Vali Loss: 2.033 Vali Acc: 0.322 Test Loss: 2.033 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.9134156703948975
Epoch: 13, Steps: 13 | Train Loss: 0.477 Vali Loss: 0.563 Vali Acc: 0.727 Test Loss: 0.563 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.658838987350464
Epoch: 14, Steps: 13 | Train Loss: 0.238 Vali Loss: 0.583 Vali Acc: 0.746 Test Loss: 0.583 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.737586498260498
Epoch: 15, Steps: 13 | Train Loss: 0.225 Vali Loss: 0.675 Vali Acc: 0.644 Test Loss: 0.675 Test Acc: 0.644
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.8185617923736572
Epoch: 16, Steps: 13 | Train Loss: 0.296 Vali Loss: 1.771 Vali Acc: 0.346 Test Loss: 1.771 Test Acc: 0.346
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.3978753089904785
Epoch: 17, Steps: 13 | Train Loss: 0.410 Vali Loss: 1.502 Vali Acc: 0.722 Test Loss: 1.502 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.6501243114471436
Epoch: 18, Steps: 13 | Train Loss: 0.268 Vali Loss: 0.768 Vali Acc: 0.737 Test Loss: 0.768 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.2783119678497314
Epoch: 19, Steps: 13 | Train Loss: 0.631 Vali Loss: 1.661 Vali Acc: 0.722 Test Loss: 1.661 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.5135676860809326
Epoch: 20, Steps: 13 | Train Loss: 0.385 Vali Loss: 0.750 Vali Acc: 0.688 Test Loss: 0.750 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.3923845291137695
Epoch: 21, Steps: 13 | Train Loss: 0.166 Vali Loss: 0.862 Vali Acc: 0.629 Test Loss: 0.862 Test Acc: 0.629
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 388966
model size : 2.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.189442873001099
Epoch: 1, Steps: 13 | Train Loss: 0.704 Vali Loss: 0.808 Vali Acc: 0.283 Test Loss: 0.808 Test Acc: 0.283
Validation loss decreased (inf --> -0.282919).  Saving model ...
Epoch: 2 cost time: 3.1279454231262207
Epoch: 2, Steps: 13 | Train Loss: 0.686 Vali Loss: 0.577 Vali Acc: 0.717 Test Loss: 0.577 Test Acc: 0.717
Validation loss decreased (-0.282919 --> -0.717067).  Saving model ...
Epoch: 3 cost time: 2.9560391902923584
Epoch: 3, Steps: 13 | Train Loss: 0.590 Vali Loss: 0.570 Vali Acc: 0.732 Test Loss: 0.570 Test Acc: 0.732
Validation loss decreased (-0.717067 --> -0.731702).  Saving model ...
Epoch: 4 cost time: 2.938236713409424
Epoch: 4, Steps: 13 | Train Loss: 0.619 Vali Loss: 0.865 Vali Acc: 0.717 Test Loss: 0.865 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5071725845336914
Epoch: 5, Steps: 13 | Train Loss: 0.641 Vali Loss: 1.103 Vali Acc: 0.307 Test Loss: 1.103 Test Acc: 0.307
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.4170544147491455
Epoch: 6, Steps: 13 | Train Loss: 0.546 Vali Loss: 0.518 Vali Acc: 0.746 Test Loss: 0.518 Test Acc: 0.746
Validation loss decreased (-0.731702 --> -0.746336).  Saving model ...
Epoch: 7 cost time: 2.4422378540039062
Epoch: 7, Steps: 13 | Train Loss: 0.483 Vali Loss: 0.653 Vali Acc: 0.722 Test Loss: 0.653 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.515855312347412
Epoch: 8, Steps: 13 | Train Loss: 0.454 Vali Loss: 0.725 Vali Acc: 0.732 Test Loss: 0.725 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.160245418548584
Epoch: 9, Steps: 13 | Train Loss: 0.758 Vali Loss: 1.218 Vali Acc: 0.376 Test Loss: 1.218 Test Acc: 0.376
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.2897119522094727
Epoch: 10, Steps: 13 | Train Loss: 1.259 Vali Loss: 0.779 Vali Acc: 0.737 Test Loss: 0.779 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.1557774543762207
Epoch: 11, Steps: 13 | Train Loss: 0.868 Vali Loss: 1.127 Vali Acc: 0.722 Test Loss: 1.127 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.3618202209472656
Epoch: 12, Steps: 13 | Train Loss: 0.638 Vali Loss: 0.560 Vali Acc: 0.712 Test Loss: 0.560 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.948528289794922
Epoch: 13, Steps: 13 | Train Loss: 0.983 Vali Loss: 1.378 Vali Acc: 0.712 Test Loss: 1.378 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.057307720184326
Epoch: 14, Steps: 13 | Train Loss: 0.626 Vali Loss: 0.560 Vali Acc: 0.727 Test Loss: 0.560 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.9553487300872803
Epoch: 15, Steps: 13 | Train Loss: 0.527 Vali Loss: 1.578 Vali Acc: 0.722 Test Loss: 1.578 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.1449265480041504
Epoch: 16, Steps: 13 | Train Loss: 0.454 Vali Loss: 0.921 Vali Acc: 0.741 Test Loss: 0.921 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 310662
model size : 1.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.305022478103638
Epoch: 1, Steps: 13 | Train Loss: 0.829 Vali Loss: 0.815 Vali Acc: 0.283 Test Loss: 0.815 Test Acc: 0.283
Validation loss decreased (inf --> -0.282919).  Saving model ...
Epoch: 2 cost time: 3.1509289741516113
Epoch: 2, Steps: 13 | Train Loss: 0.686 Vali Loss: 0.579 Vali Acc: 0.717 Test Loss: 0.579 Test Acc: 0.717
Validation loss decreased (-0.282919 --> -0.717067).  Saving model ...
Epoch: 3 cost time: 2.7681326866149902
Epoch: 3, Steps: 13 | Train Loss: 0.580 Vali Loss: 0.574 Vali Acc: 0.737 Test Loss: 0.574 Test Acc: 0.737
Validation loss decreased (-0.717067 --> -0.736580).  Saving model ...
Epoch: 4 cost time: 2.3317410945892334
Epoch: 4, Steps: 13 | Train Loss: 0.614 Vali Loss: 0.675 Vali Acc: 0.722 Test Loss: 0.675 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.6272528171539307
Epoch: 5, Steps: 13 | Train Loss: 0.637 Vali Loss: 0.561 Vali Acc: 0.737 Test Loss: 0.561 Test Acc: 0.737
Validation loss decreased (-0.736580 --> -0.736580).  Saving model ...
Epoch: 6 cost time: 1.8606698513031006
Epoch: 6, Steps: 13 | Train Loss: 0.662 Vali Loss: 0.610 Vali Acc: 0.683 Test Loss: 0.610 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.4467830657958984
Epoch: 7, Steps: 13 | Train Loss: 0.611 Vali Loss: 0.958 Vali Acc: 0.717 Test Loss: 0.958 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.3270344734191895
Epoch: 8, Steps: 13 | Train Loss: 0.481 Vali Loss: 0.721 Vali Acc: 0.722 Test Loss: 0.721 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.5566346645355225
Epoch: 9, Steps: 13 | Train Loss: 0.479 Vali Loss: 0.765 Vali Acc: 0.727 Test Loss: 0.765 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.1031806468963623
Epoch: 10, Steps: 13 | Train Loss: 0.626 Vali Loss: 0.565 Vali Acc: 0.707 Test Loss: 0.565 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.5357091426849365
Epoch: 11, Steps: 13 | Train Loss: 0.452 Vali Loss: 0.577 Vali Acc: 0.678 Test Loss: 0.577 Test Acc: 0.678
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.8541302680969238
Epoch: 12, Steps: 13 | Train Loss: 0.350 Vali Loss: 0.724 Vali Acc: 0.737 Test Loss: 0.724 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.3432679176330566
Epoch: 13, Steps: 13 | Train Loss: 0.352 Vali Loss: 0.868 Vali Acc: 0.507 Test Loss: 0.868 Test Acc: 0.507
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.7273778915405273
Epoch: 14, Steps: 13 | Train Loss: 0.365 Vali Loss: 0.541 Vali Acc: 0.722 Test Loss: 0.541 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.668063163757324
Epoch: 15, Steps: 13 | Train Loss: 0.260 Vali Loss: 0.893 Vali Acc: 0.522 Test Loss: 0.893 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 309030
model size : 1.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.5565245151519775
Epoch: 1, Steps: 13 | Train Loss: 0.655 Vali Loss: 0.637 Vali Acc: 0.722 Test Loss: 0.637 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.864164352416992
Epoch: 2, Steps: 13 | Train Loss: 0.655 Vali Loss: 0.571 Vali Acc: 0.717 Test Loss: 0.571 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.861281394958496
Epoch: 3, Steps: 13 | Train Loss: 0.763 Vali Loss: 0.546 Vali Acc: 0.737 Test Loss: 0.546 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736580).  Saving model ...
Epoch: 4 cost time: 2.6277740001678467
Epoch: 4, Steps: 13 | Train Loss: 0.633 Vali Loss: 0.542 Vali Acc: 0.746 Test Loss: 0.542 Test Acc: 0.746
Validation loss decreased (-0.736580 --> -0.746336).  Saving model ...
Epoch: 5 cost time: 2.480487585067749
Epoch: 5, Steps: 13 | Train Loss: 0.555 Vali Loss: 0.554 Vali Acc: 0.751 Test Loss: 0.554 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751214).  Saving model ...
Epoch: 6 cost time: 2.6825006008148193
Epoch: 6, Steps: 13 | Train Loss: 0.519 Vali Loss: 0.538 Vali Acc: 0.741 Test Loss: 0.538 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.997589111328125
Epoch: 7, Steps: 13 | Train Loss: 0.926 Vali Loss: 1.042 Vali Acc: 0.722 Test Loss: 1.042 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.6728339195251465
Epoch: 8, Steps: 13 | Train Loss: 0.740 Vali Loss: 0.887 Vali Acc: 0.449 Test Loss: 0.887 Test Acc: 0.449
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.5277206897735596
Epoch: 9, Steps: 13 | Train Loss: 0.829 Vali Loss: 0.829 Vali Acc: 0.727 Test Loss: 0.829 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.5521950721740723
Epoch: 10, Steps: 13 | Train Loss: 0.907 Vali Loss: 1.270 Vali Acc: 0.722 Test Loss: 1.270 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.584496021270752
Epoch: 11, Steps: 13 | Train Loss: 0.594 Vali Loss: 1.745 Vali Acc: 0.341 Test Loss: 1.745 Test Acc: 0.341
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.913163900375366
Epoch: 12, Steps: 13 | Train Loss: 0.975 Vali Loss: 0.563 Vali Acc: 0.771 Test Loss: 0.563 Test Acc: 0.771
Validation loss decreased (-0.751214 --> -0.770726).  Saving model ...
Epoch: 13 cost time: 2.4102156162261963
Epoch: 13, Steps: 13 | Train Loss: 0.494 Vali Loss: 1.041 Vali Acc: 0.722 Test Loss: 1.041 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.6591856479644775
Epoch: 14, Steps: 13 | Train Loss: 0.513 Vali Loss: 0.561 Vali Acc: 0.761 Test Loss: 0.561 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.669551372528076
Epoch: 15, Steps: 13 | Train Loss: 0.535 Vali Loss: 0.964 Vali Acc: 0.507 Test Loss: 0.964 Test Acc: 0.507
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.718040943145752
Epoch: 16, Steps: 13 | Train Loss: 0.475 Vali Loss: 0.610 Vali Acc: 0.693 Test Loss: 0.610 Test Acc: 0.693
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.682224750518799
Epoch: 17, Steps: 13 | Train Loss: 0.290 Vali Loss: 0.737 Vali Acc: 0.600 Test Loss: 0.737 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.809089422225952
Epoch: 18, Steps: 13 | Train Loss: 0.719 Vali Loss: 0.865 Vali Acc: 0.756 Test Loss: 0.865 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.7783355712890625
Epoch: 19, Steps: 13 | Train Loss: 0.530 Vali Loss: 0.675 Vali Acc: 0.741 Test Loss: 0.675 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.4078729152679443
Epoch: 20, Steps: 13 | Train Loss: 0.292 Vali Loss: 0.677 Vali Acc: 0.737 Test Loss: 0.677 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.703202247619629
Epoch: 21, Steps: 13 | Train Loss: 0.494 Vali Loss: 0.970 Vali Acc: 0.756 Test Loss: 0.970 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.288522958755493
Epoch: 22, Steps: 13 | Train Loss: 0.242 Vali Loss: 0.972 Vali Acc: 0.741 Test Loss: 0.972 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 307398
model size : 1.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.580365896224976
Epoch: 1, Steps: 13 | Train Loss: 0.644 Vali Loss: 0.580 Vali Acc: 0.717 Test Loss: 0.580 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 2.663742780685425
Epoch: 2, Steps: 13 | Train Loss: 0.723 Vali Loss: 0.834 Vali Acc: 0.293 Test Loss: 0.834 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.5924072265625
Epoch: 3, Steps: 13 | Train Loss: 0.607 Vali Loss: 0.597 Vali Acc: 0.722 Test Loss: 0.597 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721945).  Saving model ...
Epoch: 4 cost time: 2.6980323791503906
Epoch: 4, Steps: 13 | Train Loss: 0.526 Vali Loss: 0.538 Vali Acc: 0.727 Test Loss: 0.538 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726824).  Saving model ...
Epoch: 5 cost time: 2.5093770027160645
Epoch: 5, Steps: 13 | Train Loss: 0.562 Vali Loss: 0.918 Vali Acc: 0.722 Test Loss: 0.918 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.554704189300537
Epoch: 6, Steps: 13 | Train Loss: 0.700 Vali Loss: 0.531 Vali Acc: 0.737 Test Loss: 0.531 Test Acc: 0.737
Validation loss decreased (-0.726824 --> -0.736580).  Saving model ...
Epoch: 7 cost time: 2.7398407459259033
Epoch: 7, Steps: 13 | Train Loss: 1.129 Vali Loss: 0.970 Vali Acc: 0.405 Test Loss: 0.970 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.3156914710998535
Epoch: 8, Steps: 13 | Train Loss: 0.938 Vali Loss: 0.699 Vali Acc: 0.605 Test Loss: 0.699 Test Acc: 0.605
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.494960069656372
Epoch: 9, Steps: 13 | Train Loss: 0.481 Vali Loss: 0.562 Vali Acc: 0.688 Test Loss: 0.562 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.2522614002227783
Epoch: 10, Steps: 13 | Train Loss: 0.443 Vali Loss: 0.638 Vali Acc: 0.624 Test Loss: 0.638 Test Acc: 0.624
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.394153356552124
Epoch: 11, Steps: 13 | Train Loss: 0.434 Vali Loss: 1.112 Vali Acc: 0.410 Test Loss: 1.112 Test Acc: 0.410
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.7302520275115967
Epoch: 12, Steps: 13 | Train Loss: 0.616 Vali Loss: 0.548 Vali Acc: 0.732 Test Loss: 0.548 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.34641695022583
Epoch: 13, Steps: 13 | Train Loss: 0.323 Vali Loss: 0.554 Vali Acc: 0.737 Test Loss: 0.554 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.1676580905914307
Epoch: 14, Steps: 13 | Train Loss: 0.636 Vali Loss: 0.629 Vali Acc: 0.746 Test Loss: 0.629 Test Acc: 0.746
Validation loss decreased (-0.736580 --> -0.746335).  Saving model ...
Epoch: 15 cost time: 2.154585123062134
Epoch: 15, Steps: 13 | Train Loss: 0.834 Vali Loss: 4.026 Vali Acc: 0.283 Test Loss: 4.026 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.4765310287475586
Epoch: 16, Steps: 13 | Train Loss: 0.762 Vali Loss: 1.542 Vali Acc: 0.429 Test Loss: 1.542 Test Acc: 0.429
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.956912040710449
Epoch: 17, Steps: 13 | Train Loss: 0.588 Vali Loss: 0.977 Vali Acc: 0.737 Test Loss: 0.977 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.6770737171173096
Epoch: 18, Steps: 13 | Train Loss: 1.300 Vali Loss: 1.403 Vali Acc: 0.727 Test Loss: 1.403 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.506514310836792
Epoch: 19, Steps: 13 | Train Loss: 0.448 Vali Loss: 0.663 Vali Acc: 0.712 Test Loss: 0.663 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.315565347671509
Epoch: 20, Steps: 13 | Train Loss: 1.186 Vali Loss: 1.047 Vali Acc: 0.741 Test Loss: 1.047 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.106699228286743
Epoch: 21, Steps: 13 | Train Loss: 0.257 Vali Loss: 1.432 Vali Acc: 0.737 Test Loss: 1.432 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.6318345069885254
Epoch: 22, Steps: 13 | Train Loss: 0.536 Vali Loss: 1.038 Vali Acc: 0.585 Test Loss: 1.038 Test Acc: 0.585
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.4250800609588623
Epoch: 23, Steps: 13 | Train Loss: 0.194 Vali Loss: 1.081 Vali Acc: 0.571 Test Loss: 1.081 Test Acc: 0.571
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.165314197540283
Epoch: 24, Steps: 13 | Train Loss: 0.470 Vali Loss: 0.781 Vali Acc: 0.668 Test Loss: 0.781 Test Acc: 0.668
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 305766
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.7146570682525635
Epoch: 1, Steps: 13 | Train Loss: 0.829 Vali Loss: 0.669 Vali Acc: 0.698 Test Loss: 0.669 Test Acc: 0.698
Validation loss decreased (inf --> -0.697554).  Saving model ...
Epoch: 2 cost time: 2.216623306274414
Epoch: 2, Steps: 13 | Train Loss: 0.663 Vali Loss: 0.880 Vali Acc: 0.722 Test Loss: 0.880 Test Acc: 0.722
Validation loss decreased (-0.697554 --> -0.721942).  Saving model ...
Epoch: 3 cost time: 1.867919683456421
Epoch: 3, Steps: 13 | Train Loss: 0.691 Vali Loss: 0.586 Vali Acc: 0.722 Test Loss: 0.586 Test Acc: 0.722
Validation loss decreased (-0.721942 --> -0.721945).  Saving model ...
Epoch: 4 cost time: 1.9892668724060059
Epoch: 4, Steps: 13 | Train Loss: 0.608 Vali Loss: 0.836 Vali Acc: 0.346 Test Loss: 0.836 Test Acc: 0.346
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.123131275177002
Epoch: 5, Steps: 13 | Train Loss: 0.792 Vali Loss: 0.574 Vali Acc: 0.737 Test Loss: 0.574 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736580).  Saving model ...
Epoch: 6 cost time: 1.7770373821258545
Epoch: 6, Steps: 13 | Train Loss: 1.368 Vali Loss: 0.688 Vali Acc: 0.590 Test Loss: 0.688 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.5366594791412354
Epoch: 7, Steps: 13 | Train Loss: 0.696 Vali Loss: 0.527 Vali Acc: 0.741 Test Loss: 0.527 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741458).  Saving model ...
Epoch: 8 cost time: 2.7308826446533203
Epoch: 8, Steps: 13 | Train Loss: 0.820 Vali Loss: 0.718 Vali Acc: 0.727 Test Loss: 0.718 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.7608373165130615
Epoch: 9, Steps: 13 | Train Loss: 0.579 Vali Loss: 0.673 Vali Acc: 0.624 Test Loss: 0.673 Test Acc: 0.624
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.048776388168335
Epoch: 10, Steps: 13 | Train Loss: 0.418 Vali Loss: 0.603 Vali Acc: 0.727 Test Loss: 0.603 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.411165714263916
Epoch: 11, Steps: 13 | Train Loss: 0.424 Vali Loss: 0.617 Vali Acc: 0.727 Test Loss: 0.617 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.2853574752807617
Epoch: 12, Steps: 13 | Train Loss: 0.536 Vali Loss: 1.212 Vali Acc: 0.722 Test Loss: 1.212 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.654543161392212
Epoch: 13, Steps: 13 | Train Loss: 1.197 Vali Loss: 1.300 Vali Acc: 0.415 Test Loss: 1.300 Test Acc: 0.415
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.4471428394317627
Epoch: 14, Steps: 13 | Train Loss: 1.025 Vali Loss: 0.726 Vali Acc: 0.615 Test Loss: 0.726 Test Acc: 0.615
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.831266164779663
Epoch: 15, Steps: 13 | Train Loss: 0.338 Vali Loss: 1.157 Vali Acc: 0.444 Test Loss: 1.157 Test Acc: 0.444
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.2491419315338135
Epoch: 16, Steps: 13 | Train Loss: 1.059 Vali Loss: 0.780 Vali Acc: 0.576 Test Loss: 0.780 Test Acc: 0.576
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.186852216720581
Epoch: 17, Steps: 13 | Train Loss: 0.452 Vali Loss: 0.910 Vali Acc: 0.737 Test Loss: 0.910 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 269062
model size : 1.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.815500259399414
Epoch: 1, Steps: 13 | Train Loss: 0.640 Vali Loss: 0.658 Vali Acc: 0.722 Test Loss: 0.658 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.5584988594055176
Epoch: 2, Steps: 13 | Train Loss: 0.630 Vali Loss: 0.565 Vali Acc: 0.712 Test Loss: 0.565 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.7014307975769043
Epoch: 3, Steps: 13 | Train Loss: 0.645 Vali Loss: 0.544 Vali Acc: 0.732 Test Loss: 0.544 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 4 cost time: 2.6639034748077393
Epoch: 4, Steps: 13 | Train Loss: 0.588 Vali Loss: 0.699 Vali Acc: 0.571 Test Loss: 0.699 Test Acc: 0.571
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0757153034210205
Epoch: 5, Steps: 13 | Train Loss: 0.579 Vali Loss: 0.632 Vali Acc: 0.654 Test Loss: 0.632 Test Acc: 0.654
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.5725016593933105
Epoch: 6, Steps: 13 | Train Loss: 0.531 Vali Loss: 0.520 Vali Acc: 0.746 Test Loss: 0.520 Test Acc: 0.746
Validation loss decreased (-0.731702 --> -0.746336).  Saving model ...
Epoch: 7 cost time: 2.6389777660369873
Epoch: 7, Steps: 13 | Train Loss: 0.441 Vali Loss: 0.520 Vali Acc: 0.756 Test Loss: 0.520 Test Acc: 0.756
Validation loss decreased (-0.746336 --> -0.756092).  Saving model ...
Epoch: 8 cost time: 1.7987971305847168
Epoch: 8, Steps: 13 | Train Loss: 0.426 Vali Loss: 1.039 Vali Acc: 0.361 Test Loss: 1.039 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.547697067260742
Epoch: 9, Steps: 13 | Train Loss: 0.499 Vali Loss: 0.612 Vali Acc: 0.659 Test Loss: 0.612 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.415398120880127
Epoch: 10, Steps: 13 | Train Loss: 0.383 Vali Loss: 0.700 Vali Acc: 0.737 Test Loss: 0.700 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.57576060295105
Epoch: 11, Steps: 13 | Train Loss: 0.535 Vali Loss: 1.321 Vali Acc: 0.376 Test Loss: 1.321 Test Acc: 0.376
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.8138015270233154
Epoch: 12, Steps: 13 | Train Loss: 1.183 Vali Loss: 1.487 Vali Acc: 0.361 Test Loss: 1.487 Test Acc: 0.361
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.0928127765655518
Epoch: 13, Steps: 13 | Train Loss: 0.670 Vali Loss: 0.739 Vali Acc: 0.737 Test Loss: 0.739 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.7145185470581055
Epoch: 14, Steps: 13 | Train Loss: 0.312 Vali Loss: 0.653 Vali Acc: 0.654 Test Loss: 0.653 Test Acc: 0.654
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.8667829036712646
Epoch: 15, Steps: 13 | Train Loss: 0.318 Vali Loss: 0.589 Vali Acc: 0.717 Test Loss: 0.589 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.15120267868042
Epoch: 16, Steps: 13 | Train Loss: 0.626 Vali Loss: 0.632 Vali Acc: 0.727 Test Loss: 0.632 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.922612428665161
Epoch: 17, Steps: 13 | Train Loss: 0.235 Vali Loss: 0.622 Vali Acc: 0.702 Test Loss: 0.622 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 267430
model size : 1.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.028742551803589
Epoch: 1, Steps: 13 | Train Loss: 0.745 Vali Loss: 0.830 Vali Acc: 0.283 Test Loss: 0.830 Test Acc: 0.283
Validation loss decreased (inf --> -0.282919).  Saving model ...
Epoch: 2 cost time: 2.982574462890625
Epoch: 2, Steps: 13 | Train Loss: 0.699 Vali Loss: 0.558 Vali Acc: 0.722 Test Loss: 0.558 Test Acc: 0.722
Validation loss decreased (-0.282919 --> -0.721946).  Saving model ...
Epoch: 3 cost time: 3.032440662384033
Epoch: 3, Steps: 13 | Train Loss: 0.701 Vali Loss: 0.759 Vali Acc: 0.722 Test Loss: 0.759 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.0460383892059326
Epoch: 4, Steps: 13 | Train Loss: 0.723 Vali Loss: 1.085 Vali Acc: 0.307 Test Loss: 1.085 Test Acc: 0.307
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7698595523834229
Epoch: 5, Steps: 13 | Train Loss: 0.628 Vali Loss: 0.529 Vali Acc: 0.737 Test Loss: 0.529 Test Acc: 0.737
Validation loss decreased (-0.721946 --> -0.736580).  Saving model ...
Epoch: 6 cost time: 2.0187830924987793
Epoch: 6, Steps: 13 | Train Loss: 0.512 Vali Loss: 0.539 Vali Acc: 0.732 Test Loss: 0.539 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0108094215393066
Epoch: 7, Steps: 13 | Train Loss: 0.417 Vali Loss: 0.512 Vali Acc: 0.756 Test Loss: 0.512 Test Acc: 0.756
Validation loss decreased (-0.736580 --> -0.756092).  Saving model ...
Epoch: 8 cost time: 2.314662456512451
Epoch: 8, Steps: 13 | Train Loss: 0.912 Vali Loss: 1.511 Vali Acc: 0.312 Test Loss: 1.511 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.001566171646118
Epoch: 9, Steps: 13 | Train Loss: 0.611 Vali Loss: 0.551 Vali Acc: 0.746 Test Loss: 0.551 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.2312204837799072
Epoch: 10, Steps: 13 | Train Loss: 0.474 Vali Loss: 1.172 Vali Acc: 0.722 Test Loss: 1.172 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.335676670074463
Epoch: 11, Steps: 13 | Train Loss: 0.414 Vali Loss: 0.630 Vali Acc: 0.751 Test Loss: 0.630 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.5579614639282227
Epoch: 12, Steps: 13 | Train Loss: 0.847 Vali Loss: 1.246 Vali Acc: 0.722 Test Loss: 1.246 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.655529499053955
Epoch: 13, Steps: 13 | Train Loss: 1.580 Vali Loss: 0.565 Vali Acc: 0.751 Test Loss: 0.565 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.3665289878845215
Epoch: 14, Steps: 13 | Train Loss: 1.008 Vali Loss: 0.824 Vali Acc: 0.576 Test Loss: 0.824 Test Acc: 0.576
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.211271286010742
Epoch: 15, Steps: 13 | Train Loss: 0.393 Vali Loss: 1.222 Vali Acc: 0.420 Test Loss: 1.222 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.6606078147888184
Epoch: 16, Steps: 13 | Train Loss: 0.546 Vali Loss: 1.417 Vali Acc: 0.722 Test Loss: 1.417 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.9722959995269775
Epoch: 17, Steps: 13 | Train Loss: 0.567 Vali Loss: 0.948 Vali Acc: 0.571 Test Loss: 0.948 Test Acc: 0.571
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 265798
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.102704048156738
Epoch: 1, Steps: 13 | Train Loss: 0.735 Vali Loss: 0.593 Vali Acc: 0.717 Test Loss: 0.593 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.9118397235870361
Epoch: 2, Steps: 13 | Train Loss: 0.822 Vali Loss: 0.687 Vali Acc: 0.717 Test Loss: 0.687 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9643514156341553
Epoch: 3, Steps: 13 | Train Loss: 0.884 Vali Loss: 0.596 Vali Acc: 0.707 Test Loss: 0.596 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.374852180480957
Epoch: 4, Steps: 13 | Train Loss: 0.585 Vali Loss: 0.587 Vali Acc: 0.732 Test Loss: 0.587 Test Acc: 0.732
Validation loss decreased (-0.717067 --> -0.731701).  Saving model ...
Epoch: 5 cost time: 2.5071399211883545
Epoch: 5, Steps: 13 | Train Loss: 0.478 Vali Loss: 0.534 Vali Acc: 0.746 Test Loss: 0.534 Test Acc: 0.746
Validation loss decreased (-0.731701 --> -0.746336).  Saving model ...
Epoch: 6 cost time: 2.494269847869873
Epoch: 6, Steps: 13 | Train Loss: 0.462 Vali Loss: 0.701 Vali Acc: 0.717 Test Loss: 0.701 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7855465412139893
Epoch: 7, Steps: 13 | Train Loss: 0.562 Vali Loss: 0.700 Vali Acc: 0.605 Test Loss: 0.700 Test Acc: 0.605
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.922426462173462
Epoch: 8, Steps: 13 | Train Loss: 0.502 Vali Loss: 0.973 Vali Acc: 0.717 Test Loss: 0.973 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.740368127822876
Epoch: 9, Steps: 13 | Train Loss: 1.019 Vali Loss: 0.770 Vali Acc: 0.722 Test Loss: 0.770 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.4565091133117676
Epoch: 10, Steps: 13 | Train Loss: 0.635 Vali Loss: 0.595 Vali Acc: 0.751 Test Loss: 0.595 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751214).  Saving model ...
Epoch: 11 cost time: 2.3823800086975098
Epoch: 11, Steps: 13 | Train Loss: 0.631 Vali Loss: 0.770 Vali Acc: 0.580 Test Loss: 0.770 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.4538145065307617
Epoch: 12, Steps: 13 | Train Loss: 0.527 Vali Loss: 1.205 Vali Acc: 0.722 Test Loss: 1.205 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.8201160430908203
Epoch: 13, Steps: 13 | Train Loss: 0.587 Vali Loss: 1.889 Vali Acc: 0.327 Test Loss: 1.889 Test Acc: 0.327
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.6560370922088623
Epoch: 14, Steps: 13 | Train Loss: 0.670 Vali Loss: 1.199 Vali Acc: 0.727 Test Loss: 1.199 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.264726400375366
Epoch: 15, Steps: 13 | Train Loss: 0.376 Vali Loss: 0.806 Vali Acc: 0.737 Test Loss: 0.806 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.242408514022827
Epoch: 16, Steps: 13 | Train Loss: 0.517 Vali Loss: 0.869 Vali Acc: 0.727 Test Loss: 0.869 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.75302791595459
Epoch: 17, Steps: 13 | Train Loss: 0.381 Vali Loss: 0.582 Vali Acc: 0.737 Test Loss: 0.582 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.6804633140563965
Epoch: 18, Steps: 13 | Train Loss: 0.517 Vali Loss: 0.706 Vali Acc: 0.761 Test Loss: 0.706 Test Acc: 0.761
Validation loss decreased (-0.751214 --> -0.760969).  Saving model ...
Epoch: 19 cost time: 2.3417842388153076
Epoch: 19, Steps: 13 | Train Loss: 0.327 Vali Loss: 0.732 Vali Acc: 0.761 Test Loss: 0.732 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.5199460983276367
Epoch: 20, Steps: 13 | Train Loss: 0.305 Vali Loss: 0.695 Vali Acc: 0.688 Test Loss: 0.695 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.4122941493988037
Epoch: 21, Steps: 13 | Train Loss: 0.497 Vali Loss: 1.077 Vali Acc: 0.517 Test Loss: 1.077 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.8625235557556152
Epoch: 22, Steps: 13 | Train Loss: 0.227 Vali Loss: 1.277 Vali Acc: 0.727 Test Loss: 1.277 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.237053632736206
Epoch: 23, Steps: 13 | Train Loss: 0.207 Vali Loss: 0.844 Vali Acc: 0.761 Test Loss: 0.844 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.788841962814331
Epoch: 24, Steps: 13 | Train Loss: 0.336 Vali Loss: 0.826 Vali Acc: 0.746 Test Loss: 0.826 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.8938829898834229
Epoch: 25, Steps: 13 | Train Loss: 0.232 Vali Loss: 0.790 Vali Acc: 0.673 Test Loss: 0.790 Test Acc: 0.673
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.467052459716797
Epoch: 26, Steps: 13 | Train Loss: 0.125 Vali Loss: 0.827 Vali Acc: 0.727 Test Loss: 0.827 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.4308173656463623
Epoch: 27, Steps: 13 | Train Loss: 0.082 Vali Loss: 1.013 Vali Acc: 0.615 Test Loss: 1.013 Test Acc: 0.615
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.3051586151123047
Epoch: 28, Steps: 13 | Train Loss: 0.169 Vali Loss: 1.090 Vali Acc: 0.595 Test Loss: 1.090 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 264166
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.3029351234436035
Epoch: 1, Steps: 13 | Train Loss: 1.204 Vali Loss: 2.413 Vali Acc: 0.278 Test Loss: 2.413 Test Acc: 0.278
Validation loss decreased (inf --> -0.278025).  Saving model ...
Epoch: 2 cost time: 3.6007704734802246
Epoch: 2, Steps: 13 | Train Loss: 3.466 Vali Loss: 2.660 Vali Acc: 0.322 Test Loss: 2.660 Test Acc: 0.322
Validation loss decreased (-0.278025 --> -0.321925).  Saving model ...
Epoch: 3 cost time: 3.591460704803467
Epoch: 3, Steps: 13 | Train Loss: 2.451 Vali Loss: 4.573 Vali Acc: 0.722 Test Loss: 4.573 Test Acc: 0.722
Validation loss decreased (-0.321925 --> -0.721905).  Saving model ...
Epoch: 4 cost time: 4.018213272094727
Epoch: 4, Steps: 13 | Train Loss: 7.631 Vali Loss: 1.865 Vali Acc: 0.727 Test Loss: 1.865 Test Acc: 0.727
Validation loss decreased (-0.721905 --> -0.726811).  Saving model ...
Epoch: 5 cost time: 3.8936727046966553
Epoch: 5, Steps: 13 | Train Loss: 5.214 Vali Loss: 5.270 Vali Acc: 0.712 Test Loss: 5.270 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.990204095840454
Epoch: 6, Steps: 13 | Train Loss: 5.887 Vali Loss: 6.971 Vali Acc: 0.361 Test Loss: 6.971 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.82889723777771
Epoch: 7, Steps: 13 | Train Loss: 2.280 Vali Loss: 1.152 Vali Acc: 0.727 Test Loss: 1.152 Test Acc: 0.727
Validation loss decreased (-0.726811 --> -0.726818).  Saving model ...
Epoch: 8 cost time: 3.597804307937622
Epoch: 8, Steps: 13 | Train Loss: 2.935 Vali Loss: 5.099 Vali Acc: 0.722 Test Loss: 5.099 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.2584617137908936
Epoch: 9, Steps: 13 | Train Loss: 7.181 Vali Loss: 12.335 Vali Acc: 0.293 Test Loss: 12.335 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.6447677612304688
Epoch: 10, Steps: 13 | Train Loss: 6.610 Vali Loss: 8.299 Vali Acc: 0.317 Test Loss: 8.299 Test Acc: 0.317
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.225956201553345
Epoch: 11, Steps: 13 | Train Loss: 4.313 Vali Loss: 3.851 Vali Acc: 0.498 Test Loss: 3.851 Test Acc: 0.498
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.6150667667388916
Epoch: 12, Steps: 13 | Train Loss: 3.684 Vali Loss: 8.487 Vali Acc: 0.732 Test Loss: 8.487 Test Acc: 0.732
Validation loss decreased (-0.726818 --> -0.731622).  Saving model ...
Epoch: 13 cost time: 3.9034810066223145
Epoch: 13, Steps: 13 | Train Loss: 4.744 Vali Loss: 6.083 Vali Acc: 0.737 Test Loss: 6.083 Test Acc: 0.737
Validation loss decreased (-0.731622 --> -0.736525).  Saving model ...
Epoch: 14 cost time: 3.3219847679138184
Epoch: 14, Steps: 13 | Train Loss: 4.571 Vali Loss: 13.713 Vali Acc: 0.717 Test Loss: 13.713 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.130708932876587
Epoch: 15, Steps: 13 | Train Loss: 6.462 Vali Loss: 5.173 Vali Acc: 0.737 Test Loss: 5.173 Test Acc: 0.737
Validation loss decreased (-0.736525 --> -0.736534).  Saving model ...
Epoch: 16 cost time: 3.6282763481140137
Epoch: 16, Steps: 13 | Train Loss: 2.328 Vali Loss: 3.924 Vali Acc: 0.751 Test Loss: 3.924 Test Acc: 0.751
Validation loss decreased (-0.736534 --> -0.751180).  Saving model ...
Epoch: 17 cost time: 4.154052495956421
Epoch: 17, Steps: 13 | Train Loss: 4.276 Vali Loss: 39.994 Vali Acc: 0.288 Test Loss: 39.994 Test Acc: 0.288
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.6319000720977783
Epoch: 18, Steps: 13 | Train Loss: 6.255 Vali Loss: 5.853 Vali Acc: 0.776 Test Loss: 5.853 Test Acc: 0.776
Validation loss decreased (-0.751180 --> -0.775551).  Saving model ...
Epoch: 19 cost time: 3.5040061473846436
Epoch: 19, Steps: 13 | Train Loss: 0.688 Vali Loss: 6.066 Vali Acc: 0.512 Test Loss: 6.066 Test Acc: 0.512
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.414549350738525
Epoch: 20, Steps: 13 | Train Loss: 0.294 Vali Loss: 4.761 Vali Acc: 0.605 Test Loss: 4.761 Test Acc: 0.605
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.0436131954193115
Epoch: 21, Steps: 13 | Train Loss: 0.685 Vali Loss: 4.850 Vali Acc: 0.644 Test Loss: 4.850 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.922492742538452
Epoch: 22, Steps: 13 | Train Loss: 0.200 Vali Loss: 5.497 Vali Acc: 0.717 Test Loss: 5.497 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.5120627880096436
Epoch: 23, Steps: 13 | Train Loss: 0.409 Vali Loss: 4.892 Vali Acc: 0.673 Test Loss: 4.892 Test Acc: 0.673
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.6539385318756104
Epoch: 24, Steps: 13 | Train Loss: 0.306 Vali Loss: 5.466 Vali Acc: 0.590 Test Loss: 5.466 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.5947816371917725
Epoch: 25, Steps: 13 | Train Loss: 0.770 Vali Loss: 5.626 Vali Acc: 0.659 Test Loss: 5.626 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.131051540374756
Epoch: 26, Steps: 13 | Train Loss: 0.449 Vali Loss: 10.403 Vali Acc: 0.741 Test Loss: 10.403 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.7130916118621826
Epoch: 27, Steps: 13 | Train Loss: 1.823 Vali Loss: 9.238 Vali Acc: 0.761 Test Loss: 9.238 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 4.0829973220825195
Epoch: 28, Steps: 13 | Train Loss: 2.071 Vali Loss: 17.026 Vali Acc: 0.737 Test Loss: 17.026 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 6381082
model size : 29.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.625807762145996
Epoch: 1, Steps: 13 | Train Loss: 0.778 Vali Loss: 1.167 Vali Acc: 0.712 Test Loss: 1.167 Test Acc: 0.712
Validation loss decreased (inf --> -0.712183).  Saving model ...
Epoch: 2 cost time: 3.8307416439056396
Epoch: 2, Steps: 13 | Train Loss: 4.507 Vali Loss: 2.192 Vali Acc: 0.707 Test Loss: 2.192 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.034428119659424
Epoch: 3, Steps: 13 | Train Loss: 5.698 Vali Loss: 4.885 Vali Acc: 0.322 Test Loss: 4.885 Test Acc: 0.322
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.8436763286590576
Epoch: 4, Steps: 13 | Train Loss: 2.374 Vali Loss: 1.066 Vali Acc: 0.585 Test Loss: 1.066 Test Acc: 0.585
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.2255144119262695
Epoch: 5, Steps: 13 | Train Loss: 3.088 Vali Loss: 0.720 Vali Acc: 0.663 Test Loss: 0.720 Test Acc: 0.663
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.471067428588867
Epoch: 6, Steps: 13 | Train Loss: 3.528 Vali Loss: 11.581 Vali Acc: 0.288 Test Loss: 11.581 Test Acc: 0.288
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.879638195037842
Epoch: 7, Steps: 13 | Train Loss: 2.228 Vali Loss: 1.298 Vali Acc: 0.541 Test Loss: 1.298 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.410611867904663
Epoch: 8, Steps: 13 | Train Loss: 7.547 Vali Loss: 1.166 Vali Acc: 0.727 Test Loss: 1.166 Test Acc: 0.727
Validation loss decreased (-0.712183 --> -0.726818).  Saving model ...
Epoch: 9 cost time: 3.187474489212036
Epoch: 9, Steps: 13 | Train Loss: 18.605 Vali Loss: 6.341 Vali Acc: 0.717 Test Loss: 6.341 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.2338602542877197
Epoch: 10, Steps: 13 | Train Loss: 4.406 Vali Loss: 8.613 Vali Acc: 0.712 Test Loss: 8.613 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.695073127746582
Epoch: 11, Steps: 13 | Train Loss: 5.402 Vali Loss: 9.762 Vali Acc: 0.717 Test Loss: 9.762 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.16379714012146
Epoch: 12, Steps: 13 | Train Loss: 5.311 Vali Loss: 2.463 Vali Acc: 0.707 Test Loss: 2.463 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.6449134349823
Epoch: 13, Steps: 13 | Train Loss: 5.901 Vali Loss: 2.964 Vali Acc: 0.634 Test Loss: 2.964 Test Acc: 0.634
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.130014657974243
Epoch: 14, Steps: 13 | Train Loss: 23.326 Vali Loss: 17.249 Vali Acc: 0.346 Test Loss: 17.249 Test Acc: 0.346
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.819554328918457
Epoch: 15, Steps: 13 | Train Loss: 9.699 Vali Loss: 6.682 Vali Acc: 0.546 Test Loss: 6.682 Test Acc: 0.546
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.865410089492798
Epoch: 16, Steps: 13 | Train Loss: 7.095 Vali Loss: 17.498 Vali Acc: 0.722 Test Loss: 17.498 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.096944808959961
Epoch: 17, Steps: 13 | Train Loss: 8.452 Vali Loss: 17.136 Vali Acc: 0.420 Test Loss: 17.136 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.6157710552215576
Epoch: 18, Steps: 13 | Train Loss: 3.514 Vali Loss: 5.819 Vali Acc: 0.639 Test Loss: 5.819 Test Acc: 0.639
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7268292682926829
model parameter : 6372378
model size : 29.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.528546571731567
Epoch: 1, Steps: 13 | Train Loss: 1.264 Vali Loss: 5.858 Vali Acc: 0.278 Test Loss: 5.858 Test Acc: 0.278
Validation loss decreased (inf --> -0.277990).  Saving model ...
Epoch: 2 cost time: 3.2798495292663574
Epoch: 2, Steps: 13 | Train Loss: 5.542 Vali Loss: 3.549 Vali Acc: 0.722 Test Loss: 3.549 Test Acc: 0.722
Validation loss decreased (-0.277990 --> -0.721916).  Saving model ...
Epoch: 3 cost time: 3.3219969272613525
Epoch: 3, Steps: 13 | Train Loss: 3.193 Vali Loss: 1.573 Vali Acc: 0.400 Test Loss: 1.573 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.2592661380767822
Epoch: 4, Steps: 13 | Train Loss: 7.174 Vali Loss: 2.170 Vali Acc: 0.454 Test Loss: 2.170 Test Acc: 0.454
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.3703513145446777
Epoch: 5, Steps: 13 | Train Loss: 2.459 Vali Loss: 5.445 Vali Acc: 0.317 Test Loss: 5.445 Test Acc: 0.317
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.6185801029205322
Epoch: 6, Steps: 13 | Train Loss: 2.804 Vali Loss: 2.911 Vali Acc: 0.722 Test Loss: 2.911 Test Acc: 0.722
Validation loss decreased (-0.721916 --> -0.721922).  Saving model ...
Epoch: 7 cost time: 3.582777261734009
Epoch: 7, Steps: 13 | Train Loss: 1.987 Vali Loss: 4.285 Vali Acc: 0.327 Test Loss: 4.285 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.370939016342163
Epoch: 8, Steps: 13 | Train Loss: 2.343 Vali Loss: 6.462 Vali Acc: 0.717 Test Loss: 6.462 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.503993511199951
Epoch: 9, Steps: 13 | Train Loss: 6.378 Vali Loss: 3.333 Vali Acc: 0.737 Test Loss: 3.333 Test Acc: 0.737
Validation loss decreased (-0.721922 --> -0.736552).  Saving model ...
Epoch: 10 cost time: 3.8135199546813965
Epoch: 10, Steps: 13 | Train Loss: 2.999 Vali Loss: 11.417 Vali Acc: 0.302 Test Loss: 11.417 Test Acc: 0.302
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.936715841293335
Epoch: 11, Steps: 13 | Train Loss: 11.967 Vali Loss: 5.330 Vali Acc: 0.741 Test Loss: 5.330 Test Acc: 0.741
Validation loss decreased (-0.736552 --> -0.741410).  Saving model ...
Epoch: 12 cost time: 3.8192431926727295
Epoch: 12, Steps: 13 | Train Loss: 2.526 Vali Loss: 13.652 Vali Acc: 0.327 Test Loss: 13.652 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.897329807281494
Epoch: 13, Steps: 13 | Train Loss: 5.352 Vali Loss: 3.752 Vali Acc: 0.756 Test Loss: 3.752 Test Acc: 0.756
Validation loss decreased (-0.741410 --> -0.756060).  Saving model ...
Epoch: 14 cost time: 3.854888916015625
Epoch: 14, Steps: 13 | Train Loss: 1.292 Vali Loss: 2.751 Vali Acc: 0.732 Test Loss: 2.751 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.8020076751708984
Epoch: 15, Steps: 13 | Train Loss: 1.529 Vali Loss: 2.745 Vali Acc: 0.654 Test Loss: 2.745 Test Acc: 0.654
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.87321138381958
Epoch: 16, Steps: 13 | Train Loss: 3.808 Vali Loss: 5.463 Vali Acc: 0.746 Test Loss: 5.463 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.597456693649292
Epoch: 17, Steps: 13 | Train Loss: 2.754 Vali Loss: 31.266 Vali Acc: 0.293 Test Loss: 31.266 Test Acc: 0.293
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.8747637271881104
Epoch: 18, Steps: 13 | Train Loss: 5.517 Vali Loss: 13.110 Vali Acc: 0.410 Test Loss: 13.110 Test Acc: 0.410
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.040937423706055
Epoch: 19, Steps: 13 | Train Loss: 12.005 Vali Loss: 20.638 Vali Acc: 0.722 Test Loss: 20.638 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.326267719268799
Epoch: 20, Steps: 13 | Train Loss: 3.928 Vali Loss: 5.334 Vali Acc: 0.785 Test Loss: 5.334 Test Acc: 0.785
Validation loss decreased (-0.756060 --> -0.785313).  Saving model ...
Epoch: 21 cost time: 3.2498905658721924
Epoch: 21, Steps: 13 | Train Loss: 0.896 Vali Loss: 8.792 Vali Acc: 0.732 Test Loss: 8.792 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.572550058364868
Epoch: 22, Steps: 13 | Train Loss: 8.062 Vali Loss: 10.153 Vali Acc: 0.512 Test Loss: 10.153 Test Acc: 0.512
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.001927614212036
Epoch: 23, Steps: 13 | Train Loss: 3.602 Vali Loss: 12.554 Vali Acc: 0.537 Test Loss: 12.554 Test Acc: 0.537
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.318800210952759
Epoch: 24, Steps: 13 | Train Loss: 2.812 Vali Loss: 7.187 Vali Acc: 0.688 Test Loss: 7.187 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.064931869506836
Epoch: 25, Steps: 13 | Train Loss: 7.251 Vali Loss: 7.866 Vali Acc: 0.722 Test Loss: 7.866 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.3538222312927246
Epoch: 26, Steps: 13 | Train Loss: 1.498 Vali Loss: 13.554 Vali Acc: 0.741 Test Loss: 13.554 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.533022403717041
Epoch: 27, Steps: 13 | Train Loss: 0.836 Vali Loss: 7.529 Vali Acc: 0.712 Test Loss: 7.529 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.8417274951934814
Epoch: 28, Steps: 13 | Train Loss: 2.718 Vali Loss: 18.845 Vali Acc: 0.439 Test Loss: 18.845 Test Acc: 0.439
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.332007646560669
Epoch: 29, Steps: 13 | Train Loss: 5.115 Vali Loss: 29.575 Vali Acc: 0.717 Test Loss: 29.575 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.0447187423706055
Epoch: 30, Steps: 13 | Train Loss: 5.464 Vali Loss: 18.581 Vali Acc: 0.527 Test Loss: 18.581 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7853658536585366
model parameter : 6363674
model size : 29.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.673913955688477
Epoch: 1, Steps: 13 | Train Loss: 1.854 Vali Loss: 0.553 Vali Acc: 0.741 Test Loss: 0.553 Test Acc: 0.741
Validation loss decreased (inf --> -0.741458).  Saving model ...
Epoch: 2 cost time: 3.484236001968384
Epoch: 2, Steps: 13 | Train Loss: 4.585 Vali Loss: 0.839 Vali Acc: 0.644 Test Loss: 0.839 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.109218120574951
Epoch: 3, Steps: 13 | Train Loss: 1.888 Vali Loss: 2.252 Vali Acc: 0.717 Test Loss: 2.252 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.9601874351501465
Epoch: 4, Steps: 13 | Train Loss: 3.864 Vali Loss: 9.895 Vali Acc: 0.288 Test Loss: 9.895 Test Acc: 0.288
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.8365297317504883
Epoch: 5, Steps: 13 | Train Loss: 9.278 Vali Loss: 8.448 Vali Acc: 0.717 Test Loss: 8.448 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.3369662761688232
Epoch: 6, Steps: 13 | Train Loss: 7.054 Vali Loss: 9.737 Vali Acc: 0.317 Test Loss: 9.737 Test Acc: 0.317
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.577052116394043
Epoch: 7, Steps: 13 | Train Loss: 4.806 Vali Loss: 1.685 Vali Acc: 0.610 Test Loss: 1.685 Test Acc: 0.610
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.049037218093872
Epoch: 8, Steps: 13 | Train Loss: 4.783 Vali Loss: 2.281 Vali Acc: 0.659 Test Loss: 2.281 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.2065982818603516
Epoch: 9, Steps: 13 | Train Loss: 5.016 Vali Loss: 7.650 Vali Acc: 0.722 Test Loss: 7.650 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.804598808288574
Epoch: 10, Steps: 13 | Train Loss: 5.333 Vali Loss: 9.068 Vali Acc: 0.722 Test Loss: 9.068 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.793769598007202
Epoch: 11, Steps: 13 | Train Loss: 3.865 Vali Loss: 2.715 Vali Acc: 0.751 Test Loss: 2.715 Test Acc: 0.751
Validation loss decreased (-0.741458 --> -0.751192).  Saving model ...
Epoch: 12 cost time: 3.3233962059020996
Epoch: 12, Steps: 13 | Train Loss: 4.265 Vali Loss: 2.864 Vali Acc: 0.746 Test Loss: 2.864 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.9665122032165527
Epoch: 13, Steps: 13 | Train Loss: 12.776 Vali Loss: 7.560 Vali Acc: 0.732 Test Loss: 7.560 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.520068883895874
Epoch: 14, Steps: 13 | Train Loss: 10.705 Vali Loss: 12.067 Vali Acc: 0.332 Test Loss: 12.067 Test Acc: 0.332
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.1613264083862305
Epoch: 15, Steps: 13 | Train Loss: 8.339 Vali Loss: 5.795 Vali Acc: 0.517 Test Loss: 5.795 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.461085557937622
Epoch: 16, Steps: 13 | Train Loss: 9.020 Vali Loss: 13.590 Vali Acc: 0.732 Test Loss: 13.590 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.6418862342834473
Epoch: 17, Steps: 13 | Train Loss: 6.389 Vali Loss: 12.404 Vali Acc: 0.424 Test Loss: 12.404 Test Acc: 0.424
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.414715528488159
Epoch: 18, Steps: 13 | Train Loss: 4.585 Vali Loss: 31.494 Vali Acc: 0.288 Test Loss: 31.494 Test Acc: 0.288
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.547306537628174
Epoch: 19, Steps: 13 | Train Loss: 4.989 Vali Loss: 10.547 Vali Acc: 0.415 Test Loss: 10.547 Test Acc: 0.415
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.703153610229492
Epoch: 20, Steps: 13 | Train Loss: 1.475 Vali Loss: 4.810 Vali Acc: 0.707 Test Loss: 4.810 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.1717162132263184
Epoch: 21, Steps: 13 | Train Loss: 4.566 Vali Loss: 5.655 Vali Acc: 0.639 Test Loss: 5.655 Test Acc: 0.639
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 6354970
model size : 29.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.802327871322632
Epoch: 1, Steps: 13 | Train Loss: 0.975 Vali Loss: 1.164 Vali Acc: 0.293 Test Loss: 1.164 Test Acc: 0.293
Validation loss decreased (inf --> -0.292671).  Saving model ...
Epoch: 2 cost time: 2.851226568222046
Epoch: 2, Steps: 13 | Train Loss: 3.287 Vali Loss: 6.076 Vali Acc: 0.288 Test Loss: 6.076 Test Acc: 0.288
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.8784680366516113
Epoch: 3, Steps: 13 | Train Loss: 4.359 Vali Loss: 3.559 Vali Acc: 0.302 Test Loss: 3.559 Test Acc: 0.302
Validation loss decreased (-0.292671 --> -0.302403).  Saving model ...
Epoch: 4 cost time: 2.893070697784424
Epoch: 4, Steps: 13 | Train Loss: 2.685 Vali Loss: 0.634 Vali Acc: 0.707 Test Loss: 0.634 Test Acc: 0.707
Validation loss decreased (-0.302403 --> -0.707311).  Saving model ...
Epoch: 5 cost time: 3.3739542961120605
Epoch: 5, Steps: 13 | Train Loss: 7.012 Vali Loss: 10.980 Vali Acc: 0.288 Test Loss: 10.980 Test Acc: 0.288
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.2675092220306396
Epoch: 6, Steps: 13 | Train Loss: 9.184 Vali Loss: 1.994 Vali Acc: 0.556 Test Loss: 1.994 Test Acc: 0.556
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.3144853115081787
Epoch: 7, Steps: 13 | Train Loss: 5.003 Vali Loss: 5.282 Vali Acc: 0.346 Test Loss: 5.282 Test Acc: 0.346
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.492927312850952
Epoch: 8, Steps: 13 | Train Loss: 3.497 Vali Loss: 1.917 Vali Acc: 0.610 Test Loss: 1.917 Test Acc: 0.610
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.0104572772979736
Epoch: 9, Steps: 13 | Train Loss: 2.680 Vali Loss: 6.547 Vali Acc: 0.322 Test Loss: 6.547 Test Acc: 0.322
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.5211844444274902
Epoch: 10, Steps: 13 | Train Loss: 2.677 Vali Loss: 4.465 Vali Acc: 0.727 Test Loss: 4.465 Test Acc: 0.727
Validation loss decreased (-0.707311 --> -0.726785).  Saving model ...
Epoch: 11 cost time: 3.536823034286499
Epoch: 11, Steps: 13 | Train Loss: 2.994 Vali Loss: 5.321 Vali Acc: 0.380 Test Loss: 5.321 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.714816093444824
Epoch: 12, Steps: 13 | Train Loss: 1.107 Vali Loss: 3.167 Vali Acc: 0.756 Test Loss: 3.167 Test Acc: 0.756
Validation loss decreased (-0.726785 --> -0.756066).  Saving model ...
Epoch: 13 cost time: 3.0626349449157715
Epoch: 13, Steps: 13 | Train Loss: 4.592 Vali Loss: 5.590 Vali Acc: 0.444 Test Loss: 5.590 Test Acc: 0.444
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.374760866165161
Epoch: 14, Steps: 13 | Train Loss: 2.555 Vali Loss: 2.939 Vali Acc: 0.737 Test Loss: 2.939 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.6618666648864746
Epoch: 15, Steps: 13 | Train Loss: 2.166 Vali Loss: 35.704 Vali Acc: 0.278 Test Loss: 35.704 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.1084723472595215
Epoch: 16, Steps: 13 | Train Loss: 14.581 Vali Loss: 15.637 Vali Acc: 0.722 Test Loss: 15.637 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.9750730991363525
Epoch: 17, Steps: 13 | Train Loss: 2.073 Vali Loss: 4.326 Vali Acc: 0.556 Test Loss: 4.326 Test Acc: 0.556
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.9883110523223877
Epoch: 18, Steps: 13 | Train Loss: 10.369 Vali Loss: 25.895 Vali Acc: 0.293 Test Loss: 25.895 Test Acc: 0.293
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.253817558288574
Epoch: 19, Steps: 13 | Train Loss: 2.267 Vali Loss: 3.629 Vali Acc: 0.663 Test Loss: 3.629 Test Acc: 0.663
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.1873040199279785
Epoch: 20, Steps: 13 | Train Loss: 3.175 Vali Loss: 18.990 Vali Acc: 0.712 Test Loss: 18.990 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.155487060546875
Epoch: 21, Steps: 13 | Train Loss: 5.906 Vali Loss: 12.557 Vali Acc: 0.737 Test Loss: 12.557 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.348001718521118
Epoch: 22, Steps: 13 | Train Loss: 15.979 Vali Loss: 22.902 Vali Acc: 0.390 Test Loss: 22.902 Test Acc: 0.390
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 5593114
model size : 26.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.435726881027222
Epoch: 1, Steps: 13 | Train Loss: 0.830 Vali Loss: 5.688 Vali Acc: 0.278 Test Loss: 5.688 Test Acc: 0.278
Validation loss decreased (inf --> -0.277992).  Saving model ...
Epoch: 2 cost time: 3.064936876296997
Epoch: 2, Steps: 13 | Train Loss: 2.864 Vali Loss: 1.213 Vali Acc: 0.722 Test Loss: 1.213 Test Acc: 0.722
Validation loss decreased (-0.277992 --> -0.721939).  Saving model ...
Epoch: 3 cost time: 3.0648744106292725
Epoch: 3, Steps: 13 | Train Loss: 2.918 Vali Loss: 5.884 Vali Acc: 0.278 Test Loss: 5.884 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.1998958587646484
Epoch: 4, Steps: 13 | Train Loss: 4.664 Vali Loss: 3.485 Vali Acc: 0.717 Test Loss: 3.485 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.4855868816375732
Epoch: 5, Steps: 13 | Train Loss: 2.865 Vali Loss: 13.220 Vali Acc: 0.278 Test Loss: 13.220 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.3118717670440674
Epoch: 6, Steps: 13 | Train Loss: 4.598 Vali Loss: 12.230 Vali Acc: 0.293 Test Loss: 12.230 Test Acc: 0.293
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.408599615097046
Epoch: 7, Steps: 13 | Train Loss: 8.932 Vali Loss: 1.201 Vali Acc: 0.717 Test Loss: 1.201 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.5361623764038086
Epoch: 8, Steps: 13 | Train Loss: 5.380 Vali Loss: 1.865 Vali Acc: 0.659 Test Loss: 1.865 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.416034698486328
Epoch: 9, Steps: 13 | Train Loss: 4.680 Vali Loss: 16.693 Vali Acc: 0.283 Test Loss: 16.693 Test Acc: 0.283
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.4585299491882324
Epoch: 10, Steps: 13 | Train Loss: 4.497 Vali Loss: 1.626 Vali Acc: 0.673 Test Loss: 1.626 Test Acc: 0.673
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.62540864944458
Epoch: 11, Steps: 13 | Train Loss: 2.221 Vali Loss: 3.165 Vali Acc: 0.727 Test Loss: 3.165 Test Acc: 0.727
Validation loss decreased (-0.721939 --> -0.726798).  Saving model ...
Epoch: 12 cost time: 3.3517956733703613
Epoch: 12, Steps: 13 | Train Loss: 4.521 Vali Loss: 4.516 Vali Acc: 0.737 Test Loss: 4.516 Test Acc: 0.737
Validation loss decreased (-0.726798 --> -0.736540).  Saving model ...
Epoch: 13 cost time: 3.6714210510253906
Epoch: 13, Steps: 13 | Train Loss: 3.192 Vali Loss: 14.083 Vali Acc: 0.302 Test Loss: 14.083 Test Acc: 0.302
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.4368398189544678
Epoch: 14, Steps: 13 | Train Loss: 7.225 Vali Loss: 10.298 Vali Acc: 0.385 Test Loss: 10.298 Test Acc: 0.385
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.696174144744873
Epoch: 15, Steps: 13 | Train Loss: 1.754 Vali Loss: 19.613 Vali Acc: 0.317 Test Loss: 19.613 Test Acc: 0.317
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.6052701473236084
Epoch: 16, Steps: 13 | Train Loss: 4.935 Vali Loss: 6.987 Vali Acc: 0.502 Test Loss: 6.987 Test Acc: 0.502
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.549635887145996
Epoch: 17, Steps: 13 | Train Loss: 7.199 Vali Loss: 51.984 Vali Acc: 0.278 Test Loss: 51.984 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.4587135314941406
Epoch: 18, Steps: 13 | Train Loss: 8.228 Vali Loss: 6.424 Vali Acc: 0.722 Test Loss: 6.424 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.5859570503234863
Epoch: 19, Steps: 13 | Train Loss: 1.291 Vali Loss: 26.792 Vali Acc: 0.302 Test Loss: 26.792 Test Acc: 0.302
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.8652584552764893
Epoch: 20, Steps: 13 | Train Loss: 4.407 Vali Loss: 22.888 Vali Acc: 0.298 Test Loss: 22.888 Test Acc: 0.298
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.942274570465088
Epoch: 21, Steps: 13 | Train Loss: 12.041 Vali Loss: 9.246 Vali Acc: 0.766 Test Loss: 9.246 Test Acc: 0.766
Validation loss decreased (-0.736540 --> -0.765761).  Saving model ...
Epoch: 22 cost time: 3.163254976272583
Epoch: 22, Steps: 13 | Train Loss: 1.542 Vali Loss: 22.470 Vali Acc: 0.722 Test Loss: 22.470 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.637727737426758
Epoch: 23, Steps: 13 | Train Loss: 6.583 Vali Loss: 21.888 Vali Acc: 0.390 Test Loss: 21.888 Test Acc: 0.390
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.5252742767333984
Epoch: 24, Steps: 13 | Train Loss: 2.417 Vali Loss: 11.980 Vali Acc: 0.561 Test Loss: 11.980 Test Acc: 0.561
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.787930965423584
Epoch: 25, Steps: 13 | Train Loss: 7.114 Vali Loss: 14.575 Vali Acc: 0.741 Test Loss: 14.575 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.6688318252563477
Epoch: 26, Steps: 13 | Train Loss: 1.584 Vali Loss: 8.437 Vali Acc: 0.683 Test Loss: 8.437 Test Acc: 0.683
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.3656296730041504
Epoch: 27, Steps: 13 | Train Loss: 1.745 Vali Loss: 29.082 Vali Acc: 0.722 Test Loss: 29.082 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.64314341545105
Epoch: 28, Steps: 13 | Train Loss: 3.501 Vali Loss: 7.958 Vali Acc: 0.722 Test Loss: 7.958 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.2384068965911865
Epoch: 29, Steps: 13 | Train Loss: 0.717 Vali Loss: 11.333 Vali Acc: 0.561 Test Loss: 11.333 Test Acc: 0.561
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.809358596801758
Epoch: 30, Steps: 13 | Train Loss: 1.136 Vali Loss: 16.020 Vali Acc: 0.756 Test Loss: 16.020 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.8979220390319824
Epoch: 31, Steps: 13 | Train Loss: 1.220 Vali Loss: 11.538 Vali Acc: 0.732 Test Loss: 11.538 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 5584410
model size : 26.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.892675876617432
Epoch: 1, Steps: 13 | Train Loss: 1.447 Vali Loss: 8.513 Vali Acc: 0.278 Test Loss: 8.513 Test Acc: 0.278
Validation loss decreased (inf --> -0.277964).  Saving model ...
Epoch: 2 cost time: 3.2353925704956055
Epoch: 2, Steps: 13 | Train Loss: 3.305 Vali Loss: 10.210 Vali Acc: 0.283 Test Loss: 10.210 Test Acc: 0.283
Validation loss decreased (-0.277964 --> -0.282825).  Saving model ...
Epoch: 3 cost time: 3.285017490386963
Epoch: 3, Steps: 13 | Train Loss: 3.480 Vali Loss: 2.527 Vali Acc: 0.722 Test Loss: 2.527 Test Acc: 0.722
Validation loss decreased (-0.282825 --> -0.721926).  Saving model ...
Epoch: 4 cost time: 3.395232915878296
Epoch: 4, Steps: 13 | Train Loss: 2.215 Vali Loss: 2.435 Vali Acc: 0.722 Test Loss: 2.435 Test Acc: 0.722
Validation loss decreased (-0.721926 --> -0.721927).  Saving model ...
Epoch: 5 cost time: 3.0318291187286377
Epoch: 5, Steps: 13 | Train Loss: 1.555 Vali Loss: 4.961 Vali Acc: 0.307 Test Loss: 4.961 Test Acc: 0.307
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.4387192726135254
Epoch: 6, Steps: 13 | Train Loss: 8.319 Vali Loss: 5.594 Vali Acc: 0.722 Test Loss: 5.594 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.5545365810394287
Epoch: 7, Steps: 13 | Train Loss: 6.964 Vali Loss: 16.923 Vali Acc: 0.278 Test Loss: 16.923 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.530827760696411
Epoch: 8, Steps: 13 | Train Loss: 6.971 Vali Loss: 3.967 Vali Acc: 0.732 Test Loss: 3.967 Test Acc: 0.732
Validation loss decreased (-0.721927 --> -0.731668).  Saving model ...
Epoch: 9 cost time: 3.6917014122009277
Epoch: 9, Steps: 13 | Train Loss: 3.767 Vali Loss: 1.741 Vali Acc: 0.537 Test Loss: 1.741 Test Acc: 0.537
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.5079500675201416
Epoch: 10, Steps: 13 | Train Loss: 3.080 Vali Loss: 1.758 Vali Acc: 0.732 Test Loss: 1.758 Test Acc: 0.732
Validation loss decreased (-0.731668 --> -0.731690).  Saving model ...
Epoch: 11 cost time: 3.442769765853882
Epoch: 11, Steps: 13 | Train Loss: 2.721 Vali Loss: 9.701 Vali Acc: 0.722 Test Loss: 9.701 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.1573691368103027
Epoch: 12, Steps: 13 | Train Loss: 9.487 Vali Loss: 6.690 Vali Acc: 0.727 Test Loss: 6.690 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.6055541038513184
Epoch: 13, Steps: 13 | Train Loss: 5.102 Vali Loss: 1.861 Vali Acc: 0.673 Test Loss: 1.861 Test Acc: 0.673
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.107088565826416
Epoch: 14, Steps: 13 | Train Loss: 4.109 Vali Loss: 8.569 Vali Acc: 0.341 Test Loss: 8.569 Test Acc: 0.341
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.0047733783721924
Epoch: 15, Steps: 13 | Train Loss: 4.819 Vali Loss: 4.046 Vali Acc: 0.532 Test Loss: 4.046 Test Acc: 0.532
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.3630943298339844
Epoch: 16, Steps: 13 | Train Loss: 2.105 Vali Loss: 9.801 Vali Acc: 0.361 Test Loss: 9.801 Test Acc: 0.361
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.128948450088501
Epoch: 17, Steps: 13 | Train Loss: 4.827 Vali Loss: 5.508 Vali Acc: 0.746 Test Loss: 5.508 Test Acc: 0.746
Validation loss decreased (-0.731690 --> -0.746286).  Saving model ...
Epoch: 18 cost time: 3.296750783920288
Epoch: 18, Steps: 13 | Train Loss: 1.154 Vali Loss: 2.848 Vali Acc: 0.683 Test Loss: 2.848 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.4452314376831055
Epoch: 19, Steps: 13 | Train Loss: 4.118 Vali Loss: 12.912 Vali Acc: 0.371 Test Loss: 12.912 Test Acc: 0.371
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.6440248489379883
Epoch: 20, Steps: 13 | Train Loss: 2.959 Vali Loss: 5.582 Vali Acc: 0.761 Test Loss: 5.582 Test Acc: 0.761
Validation loss decreased (-0.746286 --> -0.760920).  Saving model ...
Epoch: 21 cost time: 3.078589677810669
Epoch: 21, Steps: 13 | Train Loss: 0.504 Vali Loss: 10.486 Vali Acc: 0.434 Test Loss: 10.486 Test Acc: 0.434
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.3439133167266846
Epoch: 22, Steps: 13 | Train Loss: 2.575 Vali Loss: 11.443 Vali Acc: 0.439 Test Loss: 11.443 Test Acc: 0.439
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.682380199432373
Epoch: 23, Steps: 13 | Train Loss: 0.353 Vali Loss: 8.207 Vali Acc: 0.766 Test Loss: 8.207 Test Acc: 0.766
Validation loss decreased (-0.760920 --> -0.765772).  Saving model ...
Epoch: 24 cost time: 3.3148837089538574
Epoch: 24, Steps: 13 | Train Loss: 0.478 Vali Loss: 5.108 Vali Acc: 0.668 Test Loss: 5.108 Test Acc: 0.668
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.1667580604553223
Epoch: 25, Steps: 13 | Train Loss: 0.367 Vali Loss: 6.128 Vali Acc: 0.590 Test Loss: 6.128 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.225522994995117
Epoch: 26, Steps: 13 | Train Loss: 2.547 Vali Loss: 12.890 Vali Acc: 0.737 Test Loss: 12.890 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.5185513496398926
Epoch: 27, Steps: 13 | Train Loss: 6.183 Vali Loss: 9.930 Vali Acc: 0.751 Test Loss: 9.930 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.498246192932129
Epoch: 28, Steps: 13 | Train Loss: 1.162 Vali Loss: 14.744 Vali Acc: 0.737 Test Loss: 14.744 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.1223912239074707
Epoch: 29, Steps: 13 | Train Loss: 1.015 Vali Loss: 6.968 Vali Acc: 0.659 Test Loss: 6.968 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.1743664741516113
Epoch: 30, Steps: 13 | Train Loss: 0.373 Vali Loss: 11.053 Vali Acc: 0.761 Test Loss: 11.053 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 3.182896375656128
Epoch: 31, Steps: 13 | Train Loss: 2.804 Vali Loss: 10.598 Vali Acc: 0.722 Test Loss: 10.598 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.97253680229187
Epoch: 32, Steps: 13 | Train Loss: 0.747 Vali Loss: 11.080 Vali Acc: 0.717 Test Loss: 11.080 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.9560420513153076
Epoch: 33, Steps: 13 | Train Loss: 1.428 Vali Loss: 13.405 Vali Acc: 0.761 Test Loss: 13.405 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 5575706
model size : 26.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.935110092163086
Epoch: 1, Steps: 13 | Train Loss: 1.376 Vali Loss: 8.552 Vali Acc: 0.278 Test Loss: 8.552 Test Acc: 0.278
Validation loss decreased (inf --> -0.277963).  Saving model ...
Epoch: 2 cost time: 2.844841480255127
Epoch: 2, Steps: 13 | Train Loss: 2.248 Vali Loss: 7.858 Vali Acc: 0.288 Test Loss: 7.858 Test Acc: 0.288
Validation loss decreased (-0.277963 --> -0.287726).  Saving model ...
Epoch: 3 cost time: 3.032921075820923
Epoch: 3, Steps: 13 | Train Loss: 5.392 Vali Loss: 1.013 Vali Acc: 0.766 Test Loss: 1.013 Test Acc: 0.766
Validation loss decreased (-0.287726 --> -0.765844).  Saving model ...
Epoch: 4 cost time: 3.2676844596862793
Epoch: 4, Steps: 13 | Train Loss: 12.805 Vali Loss: 28.562 Vali Acc: 0.278 Test Loss: 28.562 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.3004984855651855
Epoch: 5, Steps: 13 | Train Loss: 6.377 Vali Loss: 13.502 Vali Acc: 0.288 Test Loss: 13.502 Test Acc: 0.288
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.9545161724090576
Epoch: 6, Steps: 13 | Train Loss: 6.341 Vali Loss: 6.730 Vali Acc: 0.337 Test Loss: 6.730 Test Acc: 0.337
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.806199550628662
Epoch: 7, Steps: 13 | Train Loss: 9.065 Vali Loss: 7.995 Vali Acc: 0.727 Test Loss: 7.995 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.185969114303589
Epoch: 8, Steps: 13 | Train Loss: 8.811 Vali Loss: 10.887 Vali Acc: 0.356 Test Loss: 10.887 Test Acc: 0.356
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.3489253520965576
Epoch: 9, Steps: 13 | Train Loss: 2.397 Vali Loss: 2.245 Vali Acc: 0.766 Test Loss: 2.245 Test Acc: 0.766
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.509874105453491
Epoch: 10, Steps: 13 | Train Loss: 1.939 Vali Loss: 6.857 Vali Acc: 0.722 Test Loss: 6.857 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.327970504760742
Epoch: 11, Steps: 13 | Train Loss: 1.756 Vali Loss: 4.295 Vali Acc: 0.727 Test Loss: 4.295 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.5826358795166016
Epoch: 12, Steps: 13 | Train Loss: 1.528 Vali Loss: 2.747 Vali Acc: 0.741 Test Loss: 2.747 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.8171064853668213
Epoch: 13, Steps: 13 | Train Loss: 0.550 Vali Loss: 8.930 Vali Acc: 0.312 Test Loss: 8.930 Test Acc: 0.312
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 5567002
model size : 26.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.909543752670288
Epoch: 1, Steps: 13 | Train Loss: 1.028 Vali Loss: 0.967 Vali Acc: 0.722 Test Loss: 0.967 Test Acc: 0.722
Validation loss decreased (inf --> -0.721942).  Saving model ...
Epoch: 2 cost time: 2.3113205432891846
Epoch: 2, Steps: 13 | Train Loss: 1.447 Vali Loss: 0.707 Vali Acc: 0.659 Test Loss: 0.707 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2276580333709717
Epoch: 3, Steps: 13 | Train Loss: 5.182 Vali Loss: 22.744 Vali Acc: 0.278 Test Loss: 22.744 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.715049982070923
Epoch: 4, Steps: 13 | Train Loss: 8.631 Vali Loss: 6.456 Vali Acc: 0.717 Test Loss: 6.456 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.4825661182403564
Epoch: 5, Steps: 13 | Train Loss: 8.551 Vali Loss: 14.766 Vali Acc: 0.278 Test Loss: 14.766 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.157942295074463
Epoch: 6, Steps: 13 | Train Loss: 9.281 Vali Loss: 5.199 Vali Acc: 0.717 Test Loss: 5.199 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.2256927490234375
Epoch: 7, Steps: 13 | Train Loss: 6.066 Vali Loss: 4.532 Vali Acc: 0.732 Test Loss: 4.532 Test Acc: 0.732
Validation loss decreased (-0.721942 --> -0.731662).  Saving model ...
Epoch: 8 cost time: 3.097219228744507
Epoch: 8, Steps: 13 | Train Loss: 2.432 Vali Loss: 7.097 Vali Acc: 0.366 Test Loss: 7.097 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.3529841899871826
Epoch: 9, Steps: 13 | Train Loss: 2.377 Vali Loss: 1.448 Vali Acc: 0.717 Test Loss: 1.448 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.0074498653411865
Epoch: 10, Steps: 13 | Train Loss: 6.673 Vali Loss: 4.192 Vali Acc: 0.400 Test Loss: 4.192 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.3475089073181152
Epoch: 11, Steps: 13 | Train Loss: 4.304 Vali Loss: 3.527 Vali Acc: 0.722 Test Loss: 3.527 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.553753614425659
Epoch: 12, Steps: 13 | Train Loss: 3.942 Vali Loss: 24.658 Vali Acc: 0.288 Test Loss: 24.658 Test Acc: 0.288
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.514831304550171
Epoch: 13, Steps: 13 | Train Loss: 11.346 Vali Loss: 11.155 Vali Acc: 0.722 Test Loss: 11.155 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.3351340293884277
Epoch: 14, Steps: 13 | Train Loss: 3.013 Vali Loss: 4.192 Vali Acc: 0.517 Test Loss: 4.192 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.828343391418457
Epoch: 15, Steps: 13 | Train Loss: 1.699 Vali Loss: 6.990 Vali Acc: 0.737 Test Loss: 6.990 Test Acc: 0.737
Validation loss decreased (-0.731662 --> -0.736515).  Saving model ...
Epoch: 16 cost time: 3.836110830307007
Epoch: 16, Steps: 13 | Train Loss: 9.145 Vali Loss: 6.664 Vali Acc: 0.454 Test Loss: 6.664 Test Acc: 0.454
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.7863705158233643
Epoch: 17, Steps: 13 | Train Loss: 8.103 Vali Loss: 3.306 Vali Acc: 0.702 Test Loss: 3.306 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.0032522678375244
Epoch: 18, Steps: 13 | Train Loss: 13.733 Vali Loss: 39.574 Vali Acc: 0.298 Test Loss: 39.574 Test Acc: 0.298
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.810034990310669
Epoch: 19, Steps: 13 | Train Loss: 9.320 Vali Loss: 7.785 Vali Acc: 0.502 Test Loss: 7.785 Test Acc: 0.502
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.431245803833008
Epoch: 20, Steps: 13 | Train Loss: 5.603 Vali Loss: 4.790 Vali Acc: 0.722 Test Loss: 4.790 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.80268931388855
Epoch: 21, Steps: 13 | Train Loss: 21.138 Vali Loss: 54.777 Vali Acc: 0.293 Test Loss: 54.777 Test Acc: 0.293
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.7704994678497314
Epoch: 22, Steps: 13 | Train Loss: 15.508 Vali Loss: 20.310 Vali Acc: 0.737 Test Loss: 20.310 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.569490671157837
Epoch: 23, Steps: 13 | Train Loss: 3.352 Vali Loss: 10.819 Vali Acc: 0.741 Test Loss: 10.819 Test Acc: 0.741
Validation loss decreased (-0.736515 --> -0.741355).  Saving model ...
Epoch: 24 cost time: 3.5053601264953613
Epoch: 24, Steps: 13 | Train Loss: 3.911 Vali Loss: 14.782 Vali Acc: 0.732 Test Loss: 14.782 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.3746492862701416
Epoch: 25, Steps: 13 | Train Loss: 13.467 Vali Loss: 6.833 Vali Acc: 0.654 Test Loss: 6.833 Test Acc: 0.654
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.375251293182373
Epoch: 26, Steps: 13 | Train Loss: 0.798 Vali Loss: 10.088 Vali Acc: 0.771 Test Loss: 10.088 Test Acc: 0.771
Validation loss decreased (-0.741355 --> -0.770631).  Saving model ...
Epoch: 27 cost time: 3.272414207458496
Epoch: 27, Steps: 13 | Train Loss: 0.607 Vali Loss: 14.337 Vali Acc: 0.732 Test Loss: 14.337 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.573160171508789
Epoch: 28, Steps: 13 | Train Loss: 0.585 Vali Loss: 8.405 Vali Acc: 0.741 Test Loss: 8.405 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.510272741317749
Epoch: 29, Steps: 13 | Train Loss: 0.725 Vali Loss: 14.521 Vali Acc: 0.732 Test Loss: 14.521 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.2747528553009033
Epoch: 30, Steps: 13 | Train Loss: 0.508 Vali Loss: 7.805 Vali Acc: 0.673 Test Loss: 7.805 Test Acc: 0.673
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.684847831726074
Epoch: 31, Steps: 13 | Train Loss: 1.374 Vali Loss: 12.868 Vali Acc: 0.532 Test Loss: 12.868 Test Acc: 0.532
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.753746271133423
Epoch: 32, Steps: 13 | Train Loss: 0.290 Vali Loss: 9.012 Vali Acc: 0.659 Test Loss: 9.012 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 3.47121262550354
Epoch: 33, Steps: 13 | Train Loss: 4.403 Vali Loss: 16.216 Vali Acc: 0.522 Test Loss: 16.216 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 3.9161715507507324
Epoch: 34, Steps: 13 | Train Loss: 4.668 Vali Loss: 11.419 Vali Acc: 0.698 Test Loss: 11.419 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 3.3243918418884277
Epoch: 35, Steps: 13 | Train Loss: 1.828 Vali Loss: 21.008 Vali Acc: 0.493 Test Loss: 21.008 Test Acc: 0.493
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 3.2978808879852295
Epoch: 36, Steps: 13 | Train Loss: 4.470 Vali Loss: 39.445 Vali Acc: 0.722 Test Loss: 39.445 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 5199130
model size : 24.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.122197866439819
Epoch: 1, Steps: 13 | Train Loss: 2.417 Vali Loss: 0.688 Vali Acc: 0.737 Test Loss: 0.688 Test Acc: 0.737
Validation loss decreased (inf --> -0.736578).  Saving model ...
Epoch: 2 cost time: 3.0667104721069336
Epoch: 2, Steps: 13 | Train Loss: 3.799 Vali Loss: 8.228 Vali Acc: 0.722 Test Loss: 8.228 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.3976516723632812
Epoch: 3, Steps: 13 | Train Loss: 11.315 Vali Loss: 0.579 Vali Acc: 0.712 Test Loss: 0.579 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.730720281600952
Epoch: 4, Steps: 13 | Train Loss: 3.516 Vali Loss: 9.612 Vali Acc: 0.278 Test Loss: 9.612 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.733823299407959
Epoch: 5, Steps: 13 | Train Loss: 4.123 Vali Loss: 0.964 Vali Acc: 0.693 Test Loss: 0.964 Test Acc: 0.693
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.7552547454833984
Epoch: 6, Steps: 13 | Train Loss: 1.860 Vali Loss: 1.582 Vali Acc: 0.732 Test Loss: 1.582 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.446288585662842
Epoch: 7, Steps: 13 | Train Loss: 2.291 Vali Loss: 0.999 Vali Acc: 0.698 Test Loss: 0.999 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.924072742462158
Epoch: 8, Steps: 13 | Train Loss: 16.642 Vali Loss: 40.899 Vali Acc: 0.283 Test Loss: 40.899 Test Acc: 0.283
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.227121114730835
Epoch: 9, Steps: 13 | Train Loss: 6.159 Vali Loss: 2.053 Vali Acc: 0.737 Test Loss: 2.053 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.2532198429107666
Epoch: 10, Steps: 13 | Train Loss: 3.658 Vali Loss: 10.782 Vali Acc: 0.317 Test Loss: 10.782 Test Acc: 0.317
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.210850715637207
Epoch: 11, Steps: 13 | Train Loss: 4.047 Vali Loss: 2.232 Vali Acc: 0.732 Test Loss: 2.232 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 5190426
model size : 24.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.184903860092163
Epoch: 1, Steps: 13 | Train Loss: 2.147 Vali Loss: 4.554 Vali Acc: 0.278 Test Loss: 4.554 Test Acc: 0.278
Validation loss decreased (inf --> -0.278003).  Saving model ...
Epoch: 2 cost time: 3.3456227779388428
Epoch: 2, Steps: 13 | Train Loss: 3.591 Vali Loss: 2.383 Vali Acc: 0.722 Test Loss: 2.383 Test Acc: 0.722
Validation loss decreased (-0.278003 --> -0.721927).  Saving model ...
Epoch: 3 cost time: 3.2543952465057373
Epoch: 3, Steps: 13 | Train Loss: 2.482 Vali Loss: 1.532 Vali Acc: 0.741 Test Loss: 1.532 Test Acc: 0.741
Validation loss decreased (-0.721927 --> -0.741448).  Saving model ...
Epoch: 4 cost time: 2.859987735748291
Epoch: 4, Steps: 13 | Train Loss: 7.506 Vali Loss: 1.032 Vali Acc: 0.751 Test Loss: 1.032 Test Acc: 0.751
Validation loss decreased (-0.741448 --> -0.751209).  Saving model ...
Epoch: 5 cost time: 3.258496046066284
Epoch: 5, Steps: 13 | Train Loss: 3.602 Vali Loss: 2.106 Vali Acc: 0.722 Test Loss: 2.106 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.1186070442199707
Epoch: 6, Steps: 13 | Train Loss: 7.787 Vali Loss: 4.254 Vali Acc: 0.322 Test Loss: 4.254 Test Acc: 0.322
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.4589810371398926
Epoch: 7, Steps: 13 | Train Loss: 5.470 Vali Loss: 4.618 Vali Acc: 0.356 Test Loss: 4.618 Test Acc: 0.356
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.4095427989959717
Epoch: 8, Steps: 13 | Train Loss: 7.735 Vali Loss: 10.047 Vali Acc: 0.312 Test Loss: 10.047 Test Acc: 0.312
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.433988332748413
Epoch: 9, Steps: 13 | Train Loss: 6.442 Vali Loss: 3.226 Vali Acc: 0.751 Test Loss: 3.226 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.490178108215332
Epoch: 10, Steps: 13 | Train Loss: 2.626 Vali Loss: 3.669 Vali Acc: 0.737 Test Loss: 3.669 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.17840313911438
Epoch: 11, Steps: 13 | Train Loss: 1.666 Vali Loss: 4.424 Vali Acc: 0.727 Test Loss: 4.424 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.365445137023926
Epoch: 12, Steps: 13 | Train Loss: 8.042 Vali Loss: 6.439 Vali Acc: 0.732 Test Loss: 6.439 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.349745273590088
Epoch: 13, Steps: 13 | Train Loss: 3.035 Vali Loss: 2.453 Vali Acc: 0.727 Test Loss: 2.453 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.357682943344116
Epoch: 14, Steps: 13 | Train Loss: 3.116 Vali Loss: 6.371 Vali Acc: 0.732 Test Loss: 6.371 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 5181722
model size : 24.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.4169230461120605
Epoch: 1, Steps: 13 | Train Loss: 2.245 Vali Loss: 8.087 Vali Acc: 0.278 Test Loss: 8.087 Test Acc: 0.278
Validation loss decreased (inf --> -0.277968).  Saving model ...
Epoch: 2 cost time: 3.061577081680298
Epoch: 2, Steps: 13 | Train Loss: 4.069 Vali Loss: 1.053 Vali Acc: 0.498 Test Loss: 1.053 Test Acc: 0.498
Validation loss decreased (-0.277968 --> -0.497550).  Saving model ...
Epoch: 3 cost time: 3.2657337188720703
Epoch: 3, Steps: 13 | Train Loss: 2.688 Vali Loss: 4.302 Vali Acc: 0.722 Test Loss: 4.302 Test Acc: 0.722
Validation loss decreased (-0.497550 --> -0.721908).  Saving model ...
Epoch: 4 cost time: 3.7883381843566895
Epoch: 4, Steps: 13 | Train Loss: 6.574 Vali Loss: 3.000 Vali Acc: 0.366 Test Loss: 3.000 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.9858617782592773
Epoch: 5, Steps: 13 | Train Loss: 3.891 Vali Loss: 7.420 Vali Acc: 0.722 Test Loss: 7.420 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.638747453689575
Epoch: 6, Steps: 13 | Train Loss: 1.429 Vali Loss: 1.775 Vali Acc: 0.478 Test Loss: 1.775 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.800945997238159
Epoch: 7, Steps: 13 | Train Loss: 3.576 Vali Loss: 5.595 Vali Acc: 0.293 Test Loss: 5.595 Test Acc: 0.293
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.2730212211608887
Epoch: 8, Steps: 13 | Train Loss: 4.061 Vali Loss: 6.697 Vali Acc: 0.322 Test Loss: 6.697 Test Acc: 0.322
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.170610189437866
Epoch: 9, Steps: 13 | Train Loss: 6.068 Vali Loss: 10.081 Vali Acc: 0.322 Test Loss: 10.081 Test Acc: 0.322
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.1118130683898926
Epoch: 10, Steps: 13 | Train Loss: 3.832 Vali Loss: 7.760 Vali Acc: 0.712 Test Loss: 7.760 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.9369382858276367
Epoch: 11, Steps: 13 | Train Loss: 19.003 Vali Loss: 10.112 Vali Acc: 0.717 Test Loss: 10.112 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.230649709701538
Epoch: 12, Steps: 13 | Train Loss: 5.672 Vali Loss: 3.843 Vali Acc: 0.654 Test Loss: 3.843 Test Acc: 0.654
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.0795581340789795
Epoch: 13, Steps: 13 | Train Loss: 1.946 Vali Loss: 2.602 Vali Acc: 0.668 Test Loss: 2.602 Test Acc: 0.668
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 5173018
model size : 24.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.474886894226074
Epoch: 1, Steps: 13 | Train Loss: 1.023 Vali Loss: 1.726 Vali Acc: 0.722 Test Loss: 1.726 Test Acc: 0.722
Validation loss decreased (inf --> -0.721934).  Saving model ...
Epoch: 2 cost time: 2.955838203430176
Epoch: 2, Steps: 13 | Train Loss: 1.788 Vali Loss: 1.126 Vali Acc: 0.732 Test Loss: 1.126 Test Acc: 0.732
Validation loss decreased (-0.721934 --> -0.731696).  Saving model ...
Epoch: 3 cost time: 3.323134422302246
Epoch: 3, Steps: 13 | Train Loss: 5.771 Vali Loss: 5.444 Vali Acc: 0.722 Test Loss: 5.444 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.9760844707489014
Epoch: 4, Steps: 13 | Train Loss: 3.406 Vali Loss: 1.204 Vali Acc: 0.722 Test Loss: 1.204 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.0714499950408936
Epoch: 5, Steps: 13 | Train Loss: 2.423 Vali Loss: 3.350 Vali Acc: 0.722 Test Loss: 3.350 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.6440834999084473
Epoch: 6, Steps: 13 | Train Loss: 1.954 Vali Loss: 3.988 Vali Acc: 0.722 Test Loss: 3.988 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.761294364929199
Epoch: 7, Steps: 13 | Train Loss: 5.458 Vali Loss: 3.416 Vali Acc: 0.732 Test Loss: 3.416 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.6683361530303955
Epoch: 8, Steps: 13 | Train Loss: 4.096 Vali Loss: 3.450 Vali Acc: 0.732 Test Loss: 3.450 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.675431728363037
Epoch: 9, Steps: 13 | Train Loss: 10.671 Vali Loss: 2.143 Vali Acc: 0.756 Test Loss: 2.143 Test Acc: 0.756
Validation loss decreased (-0.731696 --> -0.756076).  Saving model ...
Epoch: 10 cost time: 3.1264419555664062
Epoch: 10, Steps: 13 | Train Loss: 2.295 Vali Loss: 2.799 Vali Acc: 0.502 Test Loss: 2.799 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.870245933532715
Epoch: 11, Steps: 13 | Train Loss: 1.884 Vali Loss: 2.497 Vali Acc: 0.585 Test Loss: 2.497 Test Acc: 0.585
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.584371566772461
Epoch: 12, Steps: 13 | Train Loss: 8.451 Vali Loss: 6.065 Vali Acc: 0.488 Test Loss: 6.065 Test Acc: 0.488
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.7269186973571777
Epoch: 13, Steps: 13 | Train Loss: 7.564 Vali Loss: 4.356 Vali Acc: 0.522 Test Loss: 4.356 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.5420010089874268
Epoch: 14, Steps: 13 | Train Loss: 6.287 Vali Loss: 25.038 Vali Acc: 0.288 Test Loss: 25.038 Test Acc: 0.288
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.5926947593688965
Epoch: 15, Steps: 13 | Train Loss: 23.046 Vali Loss: 16.573 Vali Acc: 0.712 Test Loss: 16.573 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.458146810531616
Epoch: 16, Steps: 13 | Train Loss: 21.410 Vali Loss: 5.140 Vali Acc: 0.761 Test Loss: 5.140 Test Acc: 0.761
Validation loss decreased (-0.756076 --> -0.760924).  Saving model ...
Epoch: 17 cost time: 3.1640894412994385
Epoch: 17, Steps: 13 | Train Loss: 20.094 Vali Loss: 39.892 Vali Acc: 0.312 Test Loss: 39.892 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.5043623447418213
Epoch: 18, Steps: 13 | Train Loss: 10.449 Vali Loss: 12.962 Vali Acc: 0.473 Test Loss: 12.962 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.5350253582000732
Epoch: 19, Steps: 13 | Train Loss: 5.128 Vali Loss: 4.754 Vali Acc: 0.629 Test Loss: 4.754 Test Acc: 0.629
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.3713502883911133
Epoch: 20, Steps: 13 | Train Loss: 0.805 Vali Loss: 10.227 Vali Acc: 0.449 Test Loss: 10.227 Test Acc: 0.449
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.6920623779296875
Epoch: 21, Steps: 13 | Train Loss: 1.582 Vali Loss: 4.670 Vali Acc: 0.712 Test Loss: 4.670 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.0469298362731934
Epoch: 22, Steps: 13 | Train Loss: 1.765 Vali Loss: 6.995 Vali Acc: 0.756 Test Loss: 6.995 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.2644033432006836
Epoch: 23, Steps: 13 | Train Loss: 0.799 Vali Loss: 9.302 Vali Acc: 0.737 Test Loss: 9.302 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.1793837547302246
Epoch: 24, Steps: 13 | Train Loss: 12.962 Vali Loss: 30.274 Vali Acc: 0.322 Test Loss: 30.274 Test Acc: 0.322
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.7560970783233643
Epoch: 25, Steps: 13 | Train Loss: 3.465 Vali Loss: 9.042 Vali Acc: 0.556 Test Loss: 9.042 Test Acc: 0.556
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.376134157180786
Epoch: 26, Steps: 13 | Train Loss: 0.891 Vali Loss: 6.043 Vali Acc: 0.610 Test Loss: 6.043 Test Acc: 0.610
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 5002138
model size : 24.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.784034729003906
Epoch: 1, Steps: 13 | Train Loss: 0.764 Vali Loss: 0.984 Vali Acc: 0.722 Test Loss: 0.984 Test Acc: 0.722
Validation loss decreased (inf --> -0.721941).  Saving model ...
Epoch: 2 cost time: 2.483328104019165
Epoch: 2, Steps: 13 | Train Loss: 1.152 Vali Loss: 1.453 Vali Acc: 0.722 Test Loss: 1.453 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.0501115322113037
Epoch: 3, Steps: 13 | Train Loss: 1.172 Vali Loss: 0.791 Vali Acc: 0.732 Test Loss: 0.791 Test Acc: 0.732
Validation loss decreased (-0.721941 --> -0.731699).  Saving model ...
Epoch: 4 cost time: 3.2072269916534424
Epoch: 4, Steps: 13 | Train Loss: 5.432 Vali Loss: 21.992 Vali Acc: 0.278 Test Loss: 21.992 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.3646345138549805
Epoch: 5, Steps: 13 | Train Loss: 4.056 Vali Loss: 3.296 Vali Acc: 0.722 Test Loss: 3.296 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.5971791744232178
Epoch: 6, Steps: 13 | Train Loss: 4.886 Vali Loss: 24.009 Vali Acc: 0.278 Test Loss: 24.009 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.6639926433563232
Epoch: 7, Steps: 13 | Train Loss: 10.996 Vali Loss: 5.733 Vali Acc: 0.717 Test Loss: 5.733 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.4636178016662598
Epoch: 8, Steps: 13 | Train Loss: 7.312 Vali Loss: 2.471 Vali Acc: 0.756 Test Loss: 2.471 Test Acc: 0.756
Validation loss decreased (-0.731699 --> -0.756073).  Saving model ...
Epoch: 9 cost time: 3.1511571407318115
Epoch: 9, Steps: 13 | Train Loss: 2.113 Vali Loss: 6.429 Vali Acc: 0.722 Test Loss: 6.429 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.5457346439361572
Epoch: 10, Steps: 13 | Train Loss: 4.602 Vali Loss: 6.480 Vali Acc: 0.727 Test Loss: 6.480 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.320413112640381
Epoch: 11, Steps: 13 | Train Loss: 11.157 Vali Loss: 51.452 Vali Acc: 0.278 Test Loss: 51.452 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.7520275115966797
Epoch: 12, Steps: 13 | Train Loss: 22.767 Vali Loss: 11.292 Vali Acc: 0.722 Test Loss: 11.292 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.0666377544403076
Epoch: 13, Steps: 13 | Train Loss: 13.631 Vali Loss: 10.002 Vali Acc: 0.400 Test Loss: 10.002 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.135579824447632
Epoch: 14, Steps: 13 | Train Loss: 8.314 Vali Loss: 11.664 Vali Acc: 0.732 Test Loss: 11.664 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.0369675159454346
Epoch: 15, Steps: 13 | Train Loss: 8.688 Vali Loss: 7.594 Vali Acc: 0.732 Test Loss: 7.594 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.1713333129882812
Epoch: 16, Steps: 13 | Train Loss: 9.649 Vali Loss: 16.572 Vali Acc: 0.390 Test Loss: 16.572 Test Acc: 0.390
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.9844164848327637
Epoch: 17, Steps: 13 | Train Loss: 4.969 Vali Loss: 6.068 Vali Acc: 0.551 Test Loss: 6.068 Test Acc: 0.551
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.277554750442505
Epoch: 18, Steps: 13 | Train Loss: 1.509 Vali Loss: 6.359 Vali Acc: 0.444 Test Loss: 6.359 Test Acc: 0.444
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 4993434
model size : 24.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.864488840103149
Epoch: 1, Steps: 13 | Train Loss: 1.319 Vali Loss: 2.531 Vali Acc: 0.288 Test Loss: 2.531 Test Acc: 0.288
Validation loss decreased (inf --> -0.287780).  Saving model ...
Epoch: 2 cost time: 3.1401736736297607
Epoch: 2, Steps: 13 | Train Loss: 2.932 Vali Loss: 0.744 Vali Acc: 0.732 Test Loss: 0.744 Test Acc: 0.732
Validation loss decreased (-0.287780 --> -0.731700).  Saving model ...
Epoch: 3 cost time: 2.87800669670105
Epoch: 3, Steps: 13 | Train Loss: 2.617 Vali Loss: 5.416 Vali Acc: 0.712 Test Loss: 5.416 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.809459924697876
Epoch: 4, Steps: 13 | Train Loss: 2.096 Vali Loss: 5.297 Vali Acc: 0.307 Test Loss: 5.297 Test Acc: 0.307
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.920870542526245
Epoch: 5, Steps: 13 | Train Loss: 2.947 Vali Loss: 22.364 Vali Acc: 0.288 Test Loss: 22.364 Test Acc: 0.288
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.1560754776000977
Epoch: 6, Steps: 13 | Train Loss: 7.400 Vali Loss: 14.904 Vali Acc: 0.278 Test Loss: 14.904 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.938483238220215
Epoch: 7, Steps: 13 | Train Loss: 5.641 Vali Loss: 11.082 Vali Acc: 0.298 Test Loss: 11.082 Test Acc: 0.298
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.164001703262329
Epoch: 8, Steps: 13 | Train Loss: 10.789 Vali Loss: 6.540 Vali Acc: 0.722 Test Loss: 6.540 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.734894275665283
Epoch: 9, Steps: 13 | Train Loss: 14.119 Vali Loss: 7.505 Vali Acc: 0.317 Test Loss: 7.505 Test Acc: 0.317
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.3969671726226807
Epoch: 10, Steps: 13 | Train Loss: 8.317 Vali Loss: 5.611 Vali Acc: 0.449 Test Loss: 5.611 Test Acc: 0.449
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.0579123497009277
Epoch: 11, Steps: 13 | Train Loss: 5.280 Vali Loss: 12.074 Vali Acc: 0.327 Test Loss: 12.074 Test Acc: 0.327
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.3857686519622803
Epoch: 12, Steps: 13 | Train Loss: 4.494 Vali Loss: 15.828 Vali Acc: 0.317 Test Loss: 15.828 Test Acc: 0.317
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7317073170731707
model parameter : 4984730
model size : 23.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.196904897689819
Epoch: 1, Steps: 13 | Train Loss: 2.260 Vali Loss: 0.604 Vali Acc: 0.722 Test Loss: 0.604 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 3.071154832839966
Epoch: 2, Steps: 13 | Train Loss: 1.309 Vali Loss: 0.932 Vali Acc: 0.722 Test Loss: 0.932 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.9946787357330322
Epoch: 3, Steps: 13 | Train Loss: 1.632 Vali Loss: 2.079 Vali Acc: 0.722 Test Loss: 2.079 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.074321985244751
Epoch: 4, Steps: 13 | Train Loss: 2.004 Vali Loss: 2.140 Vali Acc: 0.722 Test Loss: 2.140 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.174288034439087
Epoch: 5, Steps: 13 | Train Loss: 4.073 Vali Loss: 10.399 Vali Acc: 0.283 Test Loss: 10.399 Test Acc: 0.283
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.156623601913452
Epoch: 6, Steps: 13 | Train Loss: 4.305 Vali Loss: 3.262 Vali Acc: 0.473 Test Loss: 3.262 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.8536198139190674
Epoch: 7, Steps: 13 | Train Loss: 3.606 Vali Loss: 2.863 Vali Acc: 0.459 Test Loss: 2.863 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.0031230449676514
Epoch: 8, Steps: 13 | Train Loss: 2.175 Vali Loss: 1.414 Vali Acc: 0.737 Test Loss: 1.414 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736571).  Saving model ...
Epoch: 9 cost time: 3.2590129375457764
Epoch: 9, Steps: 13 | Train Loss: 4.402 Vali Loss: 3.743 Vali Acc: 0.722 Test Loss: 3.743 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.38790225982666
Epoch: 10, Steps: 13 | Train Loss: 2.370 Vali Loss: 5.564 Vali Acc: 0.722 Test Loss: 5.564 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.2226691246032715
Epoch: 11, Steps: 13 | Train Loss: 10.700 Vali Loss: 1.827 Vali Acc: 0.659 Test Loss: 1.827 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.5540261268615723
Epoch: 12, Steps: 13 | Train Loss: 3.378 Vali Loss: 3.582 Vali Acc: 0.478 Test Loss: 3.582 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.6299362182617188
Epoch: 13, Steps: 13 | Train Loss: 1.374 Vali Loss: 2.154 Vali Acc: 0.659 Test Loss: 2.154 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.3984196186065674
Epoch: 14, Steps: 13 | Train Loss: 5.789 Vali Loss: 14.410 Vali Acc: 0.722 Test Loss: 14.410 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.4232590198516846
Epoch: 15, Steps: 13 | Train Loss: 15.920 Vali Loss: 31.713 Vali Acc: 0.278 Test Loss: 31.713 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.181600570678711
Epoch: 16, Steps: 13 | Train Loss: 11.534 Vali Loss: 11.393 Vali Acc: 0.717 Test Loss: 11.393 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.021761417388916
Epoch: 17, Steps: 13 | Train Loss: 9.907 Vali Loss: 5.620 Vali Acc: 0.741 Test Loss: 5.620 Test Acc: 0.741
Validation loss decreased (-0.736571 --> -0.741407).  Saving model ...
Epoch: 18 cost time: 3.30812406539917
Epoch: 18, Steps: 13 | Train Loss: 6.609 Vali Loss: 25.550 Vali Acc: 0.722 Test Loss: 25.550 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.394289255142212
Epoch: 19, Steps: 13 | Train Loss: 17.613 Vali Loss: 5.812 Vali Acc: 0.751 Test Loss: 5.812 Test Acc: 0.751
Validation loss decreased (-0.741407 --> -0.751161).  Saving model ...
Epoch: 20 cost time: 3.8829479217529297
Epoch: 20, Steps: 13 | Train Loss: 13.917 Vali Loss: 6.327 Vali Acc: 0.585 Test Loss: 6.327 Test Acc: 0.585
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.471851348876953
Epoch: 21, Steps: 13 | Train Loss: 10.831 Vali Loss: 15.012 Vali Acc: 0.732 Test Loss: 15.012 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.3897624015808105
Epoch: 22, Steps: 13 | Train Loss: 3.951 Vali Loss: 7.047 Vali Acc: 0.693 Test Loss: 7.047 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.6785740852355957
Epoch: 23, Steps: 13 | Train Loss: 3.029 Vali Loss: 6.439 Vali Acc: 0.698 Test Loss: 6.439 Test Acc: 0.698
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.2727997303009033
Epoch: 24, Steps: 13 | Train Loss: 0.768 Vali Loss: 7.074 Vali Acc: 0.732 Test Loss: 7.074 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.6455698013305664
Epoch: 25, Steps: 13 | Train Loss: 0.543 Vali Loss: 6.043 Vali Acc: 0.571 Test Loss: 6.043 Test Acc: 0.571
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.3188207149505615
Epoch: 26, Steps: 13 | Train Loss: 0.308 Vali Loss: 4.405 Vali Acc: 0.707 Test Loss: 4.405 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.551790714263916
Epoch: 27, Steps: 13 | Train Loss: 0.514 Vali Loss: 4.927 Vali Acc: 0.605 Test Loss: 4.927 Test Acc: 0.605
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.376286506652832
Epoch: 28, Steps: 13 | Train Loss: 1.235 Vali Loss: 5.346 Vali Acc: 0.727 Test Loss: 5.346 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.084547996520996
Epoch: 29, Steps: 13 | Train Loss: 2.868 Vali Loss: 13.677 Vali Acc: 0.741 Test Loss: 13.677 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 4976026
model size : 23.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.538209438323975
Epoch: 1, Steps: 13 | Train Loss: 0.794 Vali Loss: 1.477 Vali Acc: 0.717 Test Loss: 1.477 Test Acc: 0.717
Validation loss decreased (inf --> -0.717058).  Saving model ...
Epoch: 2 cost time: 3.3347673416137695
Epoch: 2, Steps: 13 | Train Loss: 1.664 Vali Loss: 0.859 Vali Acc: 0.727 Test Loss: 0.859 Test Acc: 0.727
Validation loss decreased (-0.717058 --> -0.726821).  Saving model ...
Epoch: 3 cost time: 3.134486198425293
Epoch: 3, Steps: 13 | Train Loss: 1.666 Vali Loss: 0.613 Vali Acc: 0.683 Test Loss: 0.613 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.727252244949341
Epoch: 4, Steps: 13 | Train Loss: 0.951 Vali Loss: 1.902 Vali Acc: 0.722 Test Loss: 1.902 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.253164052963257
Epoch: 5, Steps: 13 | Train Loss: 1.976 Vali Loss: 2.564 Vali Acc: 0.722 Test Loss: 2.564 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.0236053466796875
Epoch: 6, Steps: 13 | Train Loss: 2.468 Vali Loss: 0.638 Vali Acc: 0.756 Test Loss: 0.638 Test Acc: 0.756
Validation loss decreased (-0.726821 --> -0.756091).  Saving model ...
Epoch: 7 cost time: 2.8100104331970215
Epoch: 7, Steps: 13 | Train Loss: 0.544 Vali Loss: 1.849 Vali Acc: 0.722 Test Loss: 1.849 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.7068240642547607
Epoch: 8, Steps: 13 | Train Loss: 5.727 Vali Loss: 1.004 Vali Acc: 0.746 Test Loss: 1.004 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.8801305294036865
Epoch: 9, Steps: 13 | Train Loss: 1.631 Vali Loss: 2.951 Vali Acc: 0.722 Test Loss: 2.951 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.8961069583892822
Epoch: 10, Steps: 13 | Train Loss: 4.674 Vali Loss: 1.845 Vali Acc: 0.483 Test Loss: 1.845 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.9580321311950684
Epoch: 11, Steps: 13 | Train Loss: 2.649 Vali Loss: 1.022 Vali Acc: 0.722 Test Loss: 1.022 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.0826029777526855
Epoch: 12, Steps: 13 | Train Loss: 1.481 Vali Loss: 4.484 Vali Acc: 0.727 Test Loss: 4.484 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.9849045276641846
Epoch: 13, Steps: 13 | Train Loss: 7.640 Vali Loss: 3.703 Vali Acc: 0.400 Test Loss: 3.703 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.834108591079712
Epoch: 14, Steps: 13 | Train Loss: 2.337 Vali Loss: 2.210 Vali Acc: 0.761 Test Loss: 2.210 Test Acc: 0.761
Validation loss decreased (-0.756091 --> -0.760954).  Saving model ...
Epoch: 15 cost time: 2.8205368518829346
Epoch: 15, Steps: 13 | Train Loss: 1.460 Vali Loss: 2.501 Vali Acc: 0.746 Test Loss: 2.501 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.8835017681121826
Epoch: 16, Steps: 13 | Train Loss: 1.619 Vali Loss: 3.215 Vali Acc: 0.507 Test Loss: 3.215 Test Acc: 0.507
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.9260826110839844
Epoch: 17, Steps: 13 | Train Loss: 1.514 Vali Loss: 5.695 Vali Acc: 0.439 Test Loss: 5.695 Test Acc: 0.439
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.7127442359924316
Epoch: 18, Steps: 13 | Train Loss: 1.086 Vali Loss: 2.352 Vali Acc: 0.693 Test Loss: 2.352 Test Acc: 0.693
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.8919718265533447
Epoch: 19, Steps: 13 | Train Loss: 1.214 Vali Loss: 3.066 Vali Acc: 0.756 Test Loss: 3.066 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.931990385055542
Epoch: 20, Steps: 13 | Train Loss: 2.928 Vali Loss: 8.990 Vali Acc: 0.444 Test Loss: 8.990 Test Acc: 0.444
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.670657157897949
Epoch: 21, Steps: 13 | Train Loss: 1.646 Vali Loss: 12.845 Vali Acc: 0.376 Test Loss: 12.845 Test Acc: 0.376
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.8914711475372314
Epoch: 22, Steps: 13 | Train Loss: 11.276 Vali Loss: 27.428 Vali Acc: 0.293 Test Loss: 27.428 Test Acc: 0.293
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.038827419281006
Epoch: 23, Steps: 13 | Train Loss: 4.710 Vali Loss: 4.098 Vali Acc: 0.673 Test Loss: 4.098 Test Acc: 0.673
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.992525100708008
Epoch: 24, Steps: 13 | Train Loss: 3.389 Vali Loss: 9.285 Vali Acc: 0.478 Test Loss: 9.285 Test Acc: 0.478
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 2405658
model size : 11.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.957526206970215
Epoch: 1, Steps: 13 | Train Loss: 1.624 Vali Loss: 1.485 Vali Acc: 0.712 Test Loss: 1.485 Test Acc: 0.712
Validation loss decreased (inf --> -0.712180).  Saving model ...
Epoch: 2 cost time: 2.5388712882995605
Epoch: 2, Steps: 13 | Train Loss: 1.652 Vali Loss: 0.683 Vali Acc: 0.624 Test Loss: 0.683 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.8628108501434326
Epoch: 3, Steps: 13 | Train Loss: 1.119 Vali Loss: 0.529 Vali Acc: 0.737 Test Loss: 0.529 Test Acc: 0.737
Validation loss decreased (-0.712180 --> -0.736580).  Saving model ...
Epoch: 4 cost time: 2.3282265663146973
Epoch: 4, Steps: 13 | Train Loss: 3.034 Vali Loss: 6.185 Vali Acc: 0.288 Test Loss: 6.185 Test Acc: 0.288
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.2623300552368164
Epoch: 5, Steps: 13 | Train Loss: 3.999 Vali Loss: 5.257 Vali Acc: 0.722 Test Loss: 5.257 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.3556833267211914
Epoch: 6, Steps: 13 | Train Loss: 4.506 Vali Loss: 0.953 Vali Acc: 0.624 Test Loss: 0.953 Test Acc: 0.624
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.5897598266601562
Epoch: 7, Steps: 13 | Train Loss: 8.135 Vali Loss: 5.445 Vali Acc: 0.722 Test Loss: 5.445 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.1950488090515137
Epoch: 8, Steps: 13 | Train Loss: 2.662 Vali Loss: 1.360 Vali Acc: 0.776 Test Loss: 1.360 Test Acc: 0.776
Validation loss decreased (-0.736580 --> -0.775596).  Saving model ...
Epoch: 9 cost time: 2.4479780197143555
Epoch: 9, Steps: 13 | Train Loss: 1.739 Vali Loss: 2.022 Vali Acc: 0.546 Test Loss: 2.022 Test Acc: 0.546
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.9620718955993652
Epoch: 10, Steps: 13 | Train Loss: 3.135 Vali Loss: 5.442 Vali Acc: 0.356 Test Loss: 5.442 Test Acc: 0.356
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.6324145793914795
Epoch: 11, Steps: 13 | Train Loss: 2.387 Vali Loss: 4.090 Vali Acc: 0.727 Test Loss: 4.090 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.0212881565093994
Epoch: 12, Steps: 13 | Train Loss: 1.175 Vali Loss: 1.152 Vali Acc: 0.620 Test Loss: 1.152 Test Acc: 0.620
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.0791611671447754
Epoch: 13, Steps: 13 | Train Loss: 1.540 Vali Loss: 1.318 Vali Acc: 0.585 Test Loss: 1.318 Test Acc: 0.585
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.7529115676879883
Epoch: 14, Steps: 13 | Train Loss: 1.942 Vali Loss: 5.166 Vali Acc: 0.727 Test Loss: 5.166 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.6766042709350586
Epoch: 15, Steps: 13 | Train Loss: 0.761 Vali Loss: 1.984 Vali Acc: 0.751 Test Loss: 1.984 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.8244271278381348
Epoch: 16, Steps: 13 | Train Loss: 0.474 Vali Loss: 1.592 Vali Acc: 0.717 Test Loss: 1.592 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.707988977432251
Epoch: 17, Steps: 13 | Train Loss: 3.996 Vali Loss: 7.211 Vali Acc: 0.727 Test Loss: 7.211 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.6294920444488525
Epoch: 18, Steps: 13 | Train Loss: 2.005 Vali Loss: 3.309 Vali Acc: 0.766 Test Loss: 3.309 Test Acc: 0.766
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 2401306
model size : 11.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.720341205596924
Epoch: 1, Steps: 13 | Train Loss: 0.933 Vali Loss: 1.451 Vali Acc: 0.712 Test Loss: 1.451 Test Acc: 0.712
Validation loss decreased (inf --> -0.712181).  Saving model ...
Epoch: 2 cost time: 2.5776519775390625
Epoch: 2, Steps: 13 | Train Loss: 1.029 Vali Loss: 0.908 Vali Acc: 0.376 Test Loss: 0.908 Test Acc: 0.376
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.975553512573242
Epoch: 3, Steps: 13 | Train Loss: 2.846 Vali Loss: 0.525 Vali Acc: 0.746 Test Loss: 0.525 Test Acc: 0.746
Validation loss decreased (-0.712181 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 3.188077688217163
Epoch: 4, Steps: 13 | Train Loss: 1.919 Vali Loss: 0.740 Vali Acc: 0.629 Test Loss: 0.740 Test Acc: 0.629
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.9626612663269043
Epoch: 5, Steps: 13 | Train Loss: 1.397 Vali Loss: 0.681 Vali Acc: 0.741 Test Loss: 0.681 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.221745491027832
Epoch: 6, Steps: 13 | Train Loss: 5.255 Vali Loss: 2.123 Vali Acc: 0.712 Test Loss: 2.123 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.053083658218384
Epoch: 7, Steps: 13 | Train Loss: 0.876 Vali Loss: 2.315 Vali Acc: 0.722 Test Loss: 2.315 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.894685745239258
Epoch: 8, Steps: 13 | Train Loss: 4.147 Vali Loss: 1.856 Vali Acc: 0.732 Test Loss: 1.856 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.0531182289123535
Epoch: 9, Steps: 13 | Train Loss: 2.138 Vali Loss: 4.702 Vali Acc: 0.717 Test Loss: 4.702 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.9092273712158203
Epoch: 10, Steps: 13 | Train Loss: 5.627 Vali Loss: 21.090 Vali Acc: 0.278 Test Loss: 21.090 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.616730213165283
Epoch: 11, Steps: 13 | Train Loss: 9.191 Vali Loss: 1.806 Vali Acc: 0.737 Test Loss: 1.806 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.9645440578460693
Epoch: 12, Steps: 13 | Train Loss: 7.156 Vali Loss: 2.918 Vali Acc: 0.751 Test Loss: 2.918 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751190).  Saving model ...
Epoch: 13 cost time: 3.0846381187438965
Epoch: 13, Steps: 13 | Train Loss: 1.934 Vali Loss: 2.968 Vali Acc: 0.737 Test Loss: 2.968 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.734539747238159
Epoch: 14, Steps: 13 | Train Loss: 4.057 Vali Loss: 6.763 Vali Acc: 0.722 Test Loss: 6.763 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.635829448699951
Epoch: 15, Steps: 13 | Train Loss: 10.790 Vali Loss: 26.929 Vali Acc: 0.278 Test Loss: 26.929 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.890427827835083
Epoch: 16, Steps: 13 | Train Loss: 11.522 Vali Loss: 2.309 Vali Acc: 0.702 Test Loss: 2.309 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.649012804031372
Epoch: 17, Steps: 13 | Train Loss: 1.169 Vali Loss: 10.100 Vali Acc: 0.341 Test Loss: 10.100 Test Acc: 0.341
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.9885363578796387
Epoch: 18, Steps: 13 | Train Loss: 3.453 Vali Loss: 2.357 Vali Acc: 0.727 Test Loss: 2.357 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.9727776050567627
Epoch: 19, Steps: 13 | Train Loss: 0.804 Vali Loss: 4.065 Vali Acc: 0.756 Test Loss: 4.065 Test Acc: 0.756
Validation loss decreased (-0.751190 --> -0.756057).  Saving model ...
Epoch: 20 cost time: 2.382473945617676
Epoch: 20, Steps: 13 | Train Loss: 5.528 Vali Loss: 3.014 Vali Acc: 0.732 Test Loss: 3.014 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.097163200378418
Epoch: 21, Steps: 13 | Train Loss: 4.361 Vali Loss: 10.873 Vali Acc: 0.351 Test Loss: 10.873 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.8935656547546387
Epoch: 22, Steps: 13 | Train Loss: 3.754 Vali Loss: 6.132 Vali Acc: 0.766 Test Loss: 6.132 Test Acc: 0.766
Validation loss decreased (-0.756057 --> -0.765792).  Saving model ...
Epoch: 23 cost time: 2.9089906215667725
Epoch: 23, Steps: 13 | Train Loss: 2.056 Vali Loss: 4.301 Vali Acc: 0.722 Test Loss: 4.301 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.7094504833221436
Epoch: 24, Steps: 13 | Train Loss: 0.486 Vali Loss: 4.036 Vali Acc: 0.702 Test Loss: 4.036 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.908057928085327
Epoch: 25, Steps: 13 | Train Loss: 0.710 Vali Loss: 3.760 Vali Acc: 0.673 Test Loss: 3.760 Test Acc: 0.673
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.6801955699920654
Epoch: 26, Steps: 13 | Train Loss: 0.100 Vali Loss: 3.972 Vali Acc: 0.712 Test Loss: 3.972 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.819892168045044
Epoch: 27, Steps: 13 | Train Loss: 0.502 Vali Loss: 3.789 Vali Acc: 0.702 Test Loss: 3.789 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.838444471359253
Epoch: 28, Steps: 13 | Train Loss: 0.421 Vali Loss: 11.507 Vali Acc: 0.727 Test Loss: 11.507 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.8443968296051025
Epoch: 29, Steps: 13 | Train Loss: 1.468 Vali Loss: 16.154 Vali Acc: 0.371 Test Loss: 16.154 Test Acc: 0.371
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.8258843421936035
Epoch: 30, Steps: 13 | Train Loss: 2.015 Vali Loss: 13.438 Vali Acc: 0.732 Test Loss: 13.438 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.830634593963623
Epoch: 31, Steps: 13 | Train Loss: 2.025 Vali Loss: 5.838 Vali Acc: 0.663 Test Loss: 5.838 Test Acc: 0.663
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.4840619564056396
Epoch: 32, Steps: 13 | Train Loss: 0.393 Vali Loss: 6.814 Vali Acc: 0.732 Test Loss: 6.814 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 2396954
model size : 11.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.5704286098480225
Epoch: 1, Steps: 13 | Train Loss: 1.222 Vali Loss: 2.445 Vali Acc: 0.722 Test Loss: 2.445 Test Acc: 0.722
Validation loss decreased (inf --> -0.721927).  Saving model ...
Epoch: 2 cost time: 3.2287538051605225
Epoch: 2, Steps: 13 | Train Loss: 2.699 Vali Loss: 5.595 Vali Acc: 0.278 Test Loss: 5.595 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.5522000789642334
Epoch: 3, Steps: 13 | Train Loss: 3.025 Vali Loss: 1.741 Vali Acc: 0.717 Test Loss: 1.741 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.3781607151031494
Epoch: 4, Steps: 13 | Train Loss: 3.420 Vali Loss: 6.423 Vali Acc: 0.278 Test Loss: 6.423 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.1038050651550293
Epoch: 5, Steps: 13 | Train Loss: 2.364 Vali Loss: 1.404 Vali Acc: 0.737 Test Loss: 1.404 Test Acc: 0.737
Validation loss decreased (-0.721927 --> -0.736571).  Saving model ...
Epoch: 6 cost time: 2.7309114933013916
Epoch: 6, Steps: 13 | Train Loss: 1.030 Vali Loss: 0.595 Vali Acc: 0.737 Test Loss: 0.595 Test Acc: 0.737
Validation loss decreased (-0.736571 --> -0.736579).  Saving model ...
Epoch: 7 cost time: 2.927255153656006
Epoch: 7, Steps: 13 | Train Loss: 2.376 Vali Loss: 1.180 Vali Acc: 0.722 Test Loss: 1.180 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.551063299179077
Epoch: 8, Steps: 13 | Train Loss: 2.706 Vali Loss: 0.811 Vali Acc: 0.595 Test Loss: 0.811 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.472437620162964
Epoch: 9, Steps: 13 | Train Loss: 8.312 Vali Loss: 7.907 Vali Acc: 0.717 Test Loss: 7.907 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.7905941009521484
Epoch: 10, Steps: 13 | Train Loss: 8.233 Vali Loss: 6.716 Vali Acc: 0.302 Test Loss: 6.716 Test Acc: 0.302
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.4703571796417236
Epoch: 11, Steps: 13 | Train Loss: 3.802 Vali Loss: 1.088 Vali Acc: 0.717 Test Loss: 1.088 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.6673166751861572
Epoch: 12, Steps: 13 | Train Loss: 3.946 Vali Loss: 1.769 Vali Acc: 0.566 Test Loss: 1.769 Test Acc: 0.566
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.771047830581665
Epoch: 13, Steps: 13 | Train Loss: 2.187 Vali Loss: 5.369 Vali Acc: 0.341 Test Loss: 5.369 Test Acc: 0.341
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.659623861312866
Epoch: 14, Steps: 13 | Train Loss: 1.237 Vali Loss: 3.369 Vali Acc: 0.732 Test Loss: 3.369 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.9222326278686523
Epoch: 15, Steps: 13 | Train Loss: 4.551 Vali Loss: 4.083 Vali Acc: 0.737 Test Loss: 4.083 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.7045490741729736
Epoch: 16, Steps: 13 | Train Loss: 1.466 Vali Loss: 1.852 Vali Acc: 0.741 Test Loss: 1.852 Test Acc: 0.741
Validation loss decreased (-0.736579 --> -0.741445).  Saving model ...
Epoch: 17 cost time: 2.0987138748168945
Epoch: 17, Steps: 13 | Train Loss: 1.183 Vali Loss: 15.977 Vali Acc: 0.288 Test Loss: 15.977 Test Acc: 0.288
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.384077310562134
Epoch: 18, Steps: 13 | Train Loss: 6.423 Vali Loss: 2.079 Vali Acc: 0.654 Test Loss: 2.079 Test Acc: 0.654
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.5532734394073486
Epoch: 19, Steps: 13 | Train Loss: 2.321 Vali Loss: 4.754 Vali Acc: 0.463 Test Loss: 4.754 Test Acc: 0.463
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.7098214626312256
Epoch: 20, Steps: 13 | Train Loss: 1.208 Vali Loss: 2.635 Vali Acc: 0.639 Test Loss: 2.635 Test Acc: 0.639
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.487178087234497
Epoch: 21, Steps: 13 | Train Loss: 1.186 Vali Loss: 14.498 Vali Acc: 0.298 Test Loss: 14.498 Test Acc: 0.298
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.364079713821411
Epoch: 22, Steps: 13 | Train Loss: 1.636 Vali Loss: 3.779 Vali Acc: 0.751 Test Loss: 3.779 Test Acc: 0.751
Validation loss decreased (-0.741445 --> -0.751182).  Saving model ...
Epoch: 23 cost time: 2.482858657836914
Epoch: 23, Steps: 13 | Train Loss: 0.494 Vali Loss: 12.751 Vali Acc: 0.332 Test Loss: 12.751 Test Acc: 0.332
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.7902116775512695
Epoch: 24, Steps: 13 | Train Loss: 1.488 Vali Loss: 8.667 Vali Acc: 0.454 Test Loss: 8.667 Test Acc: 0.454
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.8669848442077637
Epoch: 25, Steps: 13 | Train Loss: 1.719 Vali Loss: 3.390 Vali Acc: 0.702 Test Loss: 3.390 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.1467459201812744
Epoch: 26, Steps: 13 | Train Loss: 0.084 Vali Loss: 4.135 Vali Acc: 0.741 Test Loss: 4.135 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.577110528945923
Epoch: 27, Steps: 13 | Train Loss: 0.194 Vali Loss: 4.556 Vali Acc: 0.751 Test Loss: 4.556 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.7303476333618164
Epoch: 28, Steps: 13 | Train Loss: 0.222 Vali Loss: 7.927 Vali Acc: 0.722 Test Loss: 7.927 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.8308424949645996
Epoch: 29, Steps: 13 | Train Loss: 0.513 Vali Loss: 8.132 Vali Acc: 0.741 Test Loss: 8.132 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.9102044105529785
Epoch: 30, Steps: 13 | Train Loss: 0.341 Vali Loss: 4.093 Vali Acc: 0.698 Test Loss: 4.093 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.9636194705963135
Epoch: 31, Steps: 13 | Train Loss: 0.302 Vali Loss: 4.842 Vali Acc: 0.732 Test Loss: 4.842 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 3.014981746673584
Epoch: 32, Steps: 13 | Train Loss: 0.673 Vali Loss: 4.891 Vali Acc: 0.668 Test Loss: 4.891 Test Acc: 0.668
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 2392602
model size : 11.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.2440690994262695
Epoch: 1, Steps: 13 | Train Loss: 1.557 Vali Loss: 1.372 Vali Acc: 0.712 Test Loss: 1.372 Test Acc: 0.712
Validation loss decreased (inf --> -0.712181).  Saving model ...
Epoch: 2 cost time: 2.6570212841033936
Epoch: 2, Steps: 13 | Train Loss: 1.564 Vali Loss: 3.376 Vali Acc: 0.278 Test Loss: 3.376 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.4627630710601807
Epoch: 3, Steps: 13 | Train Loss: 1.490 Vali Loss: 2.378 Vali Acc: 0.722 Test Loss: 2.378 Test Acc: 0.722
Validation loss decreased (-0.712181 --> -0.721927).  Saving model ...
Epoch: 4 cost time: 2.701023578643799
Epoch: 4, Steps: 13 | Train Loss: 1.925 Vali Loss: 1.288 Vali Acc: 0.717 Test Loss: 1.288 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.0807101726531982
Epoch: 5, Steps: 13 | Train Loss: 2.921 Vali Loss: 2.619 Vali Acc: 0.307 Test Loss: 2.619 Test Acc: 0.307
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.860060214996338
Epoch: 6, Steps: 13 | Train Loss: 4.184 Vali Loss: 1.509 Vali Acc: 0.737 Test Loss: 1.509 Test Acc: 0.737
Validation loss decreased (-0.721927 --> -0.736570).  Saving model ...
Epoch: 7 cost time: 2.9493982791900635
Epoch: 7, Steps: 13 | Train Loss: 4.358 Vali Loss: 0.902 Vali Acc: 0.746 Test Loss: 0.902 Test Acc: 0.746
Validation loss decreased (-0.736570 --> -0.746332).  Saving model ...
Epoch: 8 cost time: 3.096620559692383
Epoch: 8, Steps: 13 | Train Loss: 4.401 Vali Loss: 6.294 Vali Acc: 0.298 Test Loss: 6.294 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.8470852375030518
Epoch: 9, Steps: 13 | Train Loss: 2.507 Vali Loss: 10.217 Vali Acc: 0.288 Test Loss: 10.217 Test Acc: 0.288
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.8961877822875977
Epoch: 10, Steps: 13 | Train Loss: 3.030 Vali Loss: 13.230 Vali Acc: 0.278 Test Loss: 13.230 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.236565351486206
Epoch: 11, Steps: 13 | Train Loss: 10.879 Vali Loss: 2.713 Vali Acc: 0.741 Test Loss: 2.713 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.4739890098571777
Epoch: 12, Steps: 13 | Train Loss: 3.128 Vali Loss: 5.005 Vali Acc: 0.390 Test Loss: 5.005 Test Acc: 0.390
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.8982536792755127
Epoch: 13, Steps: 13 | Train Loss: 0.923 Vali Loss: 1.992 Vali Acc: 0.532 Test Loss: 1.992 Test Acc: 0.532
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.0798494815826416
Epoch: 14, Steps: 13 | Train Loss: 0.674 Vali Loss: 2.265 Vali Acc: 0.507 Test Loss: 2.265 Test Acc: 0.507
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.9995241165161133
Epoch: 15, Steps: 13 | Train Loss: 0.779 Vali Loss: 2.618 Vali Acc: 0.478 Test Loss: 2.618 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.766934871673584
Epoch: 16, Steps: 13 | Train Loss: 5.019 Vali Loss: 1.596 Vali Acc: 0.663 Test Loss: 1.596 Test Acc: 0.663
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.269690752029419
Epoch: 17, Steps: 13 | Train Loss: 3.404 Vali Loss: 8.253 Vali Acc: 0.717 Test Loss: 8.253 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 2010906
model size : 10.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.917828321456909
Epoch: 1, Steps: 13 | Train Loss: 1.098 Vali Loss: 1.229 Vali Acc: 0.283 Test Loss: 1.229 Test Acc: 0.283
Validation loss decreased (inf --> -0.282915).  Saving model ...
Epoch: 2 cost time: 2.9267690181732178
Epoch: 2, Steps: 13 | Train Loss: 1.185 Vali Loss: 0.565 Vali Acc: 0.741 Test Loss: 0.565 Test Acc: 0.741
Validation loss decreased (-0.282915 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 2.9451563358306885
Epoch: 3, Steps: 13 | Train Loss: 1.007 Vali Loss: 0.564 Vali Acc: 0.737 Test Loss: 0.564 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.945341110229492
Epoch: 4, Steps: 13 | Train Loss: 4.192 Vali Loss: 5.946 Vali Acc: 0.722 Test Loss: 5.946 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.2533228397369385
Epoch: 5, Steps: 13 | Train Loss: 6.585 Vali Loss: 1.081 Vali Acc: 0.761 Test Loss: 1.081 Test Acc: 0.761
Validation loss decreased (-0.741458 --> -0.760965).  Saving model ...
Epoch: 6 cost time: 2.629171133041382
Epoch: 6, Steps: 13 | Train Loss: 7.552 Vali Loss: 15.278 Vali Acc: 0.278 Test Loss: 15.278 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.0072171688079834
Epoch: 7, Steps: 13 | Train Loss: 5.544 Vali Loss: 5.917 Vali Acc: 0.712 Test Loss: 5.917 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.3697659969329834
Epoch: 8, Steps: 13 | Train Loss: 3.911 Vali Loss: 6.370 Vali Acc: 0.327 Test Loss: 6.370 Test Acc: 0.327
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.4038333892822266
Epoch: 9, Steps: 13 | Train Loss: 1.705 Vali Loss: 1.056 Vali Acc: 0.610 Test Loss: 1.056 Test Acc: 0.610
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.634929895401001
Epoch: 10, Steps: 13 | Train Loss: 2.393 Vali Loss: 0.985 Vali Acc: 0.737 Test Loss: 0.985 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.3809332847595215
Epoch: 11, Steps: 13 | Train Loss: 2.154 Vali Loss: 8.953 Vali Acc: 0.283 Test Loss: 8.953 Test Acc: 0.283
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.7308971881866455
Epoch: 12, Steps: 13 | Train Loss: 2.580 Vali Loss: 1.180 Vali Acc: 0.644 Test Loss: 1.180 Test Acc: 0.644
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.4810516834259033
Epoch: 13, Steps: 13 | Train Loss: 1.206 Vali Loss: 2.806 Vali Acc: 0.732 Test Loss: 2.806 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.3279061317443848
Epoch: 14, Steps: 13 | Train Loss: 1.718 Vali Loss: 4.994 Vali Acc: 0.722 Test Loss: 4.994 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.8882546424865723
Epoch: 15, Steps: 13 | Train Loss: 1.602 Vali Loss: 1.179 Vali Acc: 0.712 Test Loss: 1.179 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 2006554
model size : 10.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.148953437805176
Epoch: 1, Steps: 13 | Train Loss: 0.798 Vali Loss: 2.354 Vali Acc: 0.278 Test Loss: 2.354 Test Acc: 0.278
Validation loss decreased (inf --> -0.278025).  Saving model ...
Epoch: 2 cost time: 2.338334798812866
Epoch: 2, Steps: 13 | Train Loss: 1.240 Vali Loss: 1.677 Vali Acc: 0.283 Test Loss: 1.677 Test Acc: 0.283
Validation loss decreased (-0.278025 --> -0.282910).  Saving model ...
Epoch: 3 cost time: 2.9286394119262695
Epoch: 3, Steps: 13 | Train Loss: 0.833 Vali Loss: 1.590 Vali Acc: 0.722 Test Loss: 1.590 Test Acc: 0.722
Validation loss decreased (-0.282910 --> -0.721935).  Saving model ...
Epoch: 4 cost time: 2.7220146656036377
Epoch: 4, Steps: 13 | Train Loss: 0.920 Vali Loss: 1.137 Vali Acc: 0.395 Test Loss: 1.137 Test Acc: 0.395
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5013856887817383
Epoch: 5, Steps: 13 | Train Loss: 1.470 Vali Loss: 2.939 Vali Acc: 0.722 Test Loss: 2.939 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.7681751251220703
Epoch: 6, Steps: 13 | Train Loss: 1.857 Vali Loss: 2.147 Vali Acc: 0.722 Test Loss: 2.147 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.526804208755493
Epoch: 7, Steps: 13 | Train Loss: 1.612 Vali Loss: 4.895 Vali Acc: 0.278 Test Loss: 4.895 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.539243459701538
Epoch: 8, Steps: 13 | Train Loss: 1.856 Vali Loss: 3.517 Vali Acc: 0.307 Test Loss: 3.517 Test Acc: 0.307
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.6040191650390625
Epoch: 9, Steps: 13 | Train Loss: 2.190 Vali Loss: 4.655 Vali Acc: 0.722 Test Loss: 4.655 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.5244081020355225
Epoch: 10, Steps: 13 | Train Loss: 2.491 Vali Loss: 8.530 Vali Acc: 0.278 Test Loss: 8.530 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.9359283447265625
Epoch: 11, Steps: 13 | Train Loss: 6.620 Vali Loss: 6.540 Vali Acc: 0.722 Test Loss: 6.540 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.559669017791748
Epoch: 12, Steps: 13 | Train Loss: 4.487 Vali Loss: 5.485 Vali Acc: 0.332 Test Loss: 5.485 Test Acc: 0.332
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.7292802333831787
Epoch: 13, Steps: 13 | Train Loss: 3.874 Vali Loss: 3.684 Vali Acc: 0.727 Test Loss: 3.684 Test Acc: 0.727
Validation loss decreased (-0.721935 --> -0.726792).  Saving model ...
Epoch: 14 cost time: 2.029054641723633
Epoch: 14, Steps: 13 | Train Loss: 3.220 Vali Loss: 7.461 Vali Acc: 0.317 Test Loss: 7.461 Test Acc: 0.317
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.7021427154541016
Epoch: 15, Steps: 13 | Train Loss: 1.690 Vali Loss: 7.303 Vali Acc: 0.722 Test Loss: 7.303 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.5748708248138428
Epoch: 16, Steps: 13 | Train Loss: 3.902 Vali Loss: 23.416 Vali Acc: 0.278 Test Loss: 23.416 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.2868432998657227
Epoch: 17, Steps: 13 | Train Loss: 2.917 Vali Loss: 2.878 Vali Acc: 0.512 Test Loss: 2.878 Test Acc: 0.512
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.920599937438965
Epoch: 18, Steps: 13 | Train Loss: 0.753 Vali Loss: 2.617 Vali Acc: 0.756 Test Loss: 2.617 Test Acc: 0.756
Validation loss decreased (-0.726792 --> -0.756071).  Saving model ...
Epoch: 19 cost time: 2.358499765396118
Epoch: 19, Steps: 13 | Train Loss: 2.728 Vali Loss: 15.244 Vali Acc: 0.293 Test Loss: 15.244 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.455608367919922
Epoch: 20, Steps: 13 | Train Loss: 3.529 Vali Loss: 16.198 Vali Acc: 0.288 Test Loss: 16.198 Test Acc: 0.288
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.3649563789367676
Epoch: 21, Steps: 13 | Train Loss: 1.758 Vali Loss: 3.340 Vali Acc: 0.751 Test Loss: 3.340 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.540384292602539
Epoch: 22, Steps: 13 | Train Loss: 1.077 Vali Loss: 4.538 Vali Acc: 0.751 Test Loss: 4.538 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.433919668197632
Epoch: 23, Steps: 13 | Train Loss: 3.180 Vali Loss: 4.141 Vali Acc: 0.756 Test Loss: 4.141 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.7600691318511963
Epoch: 24, Steps: 13 | Train Loss: 2.804 Vali Loss: 19.946 Vali Acc: 0.298 Test Loss: 19.946 Test Acc: 0.298
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.9721872806549072
Epoch: 25, Steps: 13 | Train Loss: 1.816 Vali Loss: 3.620 Vali Acc: 0.639 Test Loss: 3.620 Test Acc: 0.639
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.4396731853485107
Epoch: 26, Steps: 13 | Train Loss: 0.254 Vali Loss: 4.822 Vali Acc: 0.761 Test Loss: 4.822 Test Acc: 0.761
Validation loss decreased (-0.756071 --> -0.760927).  Saving model ...
Epoch: 27 cost time: 2.4142372608184814
Epoch: 27, Steps: 13 | Train Loss: 0.621 Vali Loss: 3.865 Vali Acc: 0.644 Test Loss: 3.865 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.5293219089508057
Epoch: 28, Steps: 13 | Train Loss: 0.302 Vali Loss: 3.791 Vali Acc: 0.717 Test Loss: 3.791 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.6425108909606934
Epoch: 29, Steps: 13 | Train Loss: 0.177 Vali Loss: 6.464 Vali Acc: 0.746 Test Loss: 6.464 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.351503610610962
Epoch: 30, Steps: 13 | Train Loss: 0.183 Vali Loss: 6.987 Vali Acc: 0.746 Test Loss: 6.987 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.667388677597046
Epoch: 31, Steps: 13 | Train Loss: 0.472 Vali Loss: 5.851 Vali Acc: 0.751 Test Loss: 5.851 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.8088769912719727
Epoch: 32, Steps: 13 | Train Loss: 1.610 Vali Loss: 7.190 Vali Acc: 0.507 Test Loss: 7.190 Test Acc: 0.507
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.6676857471466064
Epoch: 33, Steps: 13 | Train Loss: 1.558 Vali Loss: 5.621 Vali Acc: 0.585 Test Loss: 5.621 Test Acc: 0.585
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 2.411118984222412
Epoch: 34, Steps: 13 | Train Loss: 0.100 Vali Loss: 4.993 Vali Acc: 0.654 Test Loss: 4.993 Test Acc: 0.654
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 2.946992874145508
Epoch: 35, Steps: 13 | Train Loss: 0.734 Vali Loss: 9.348 Vali Acc: 0.488 Test Loss: 9.348 Test Acc: 0.488
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 2.365840196609497
Epoch: 36, Steps: 13 | Train Loss: 0.671 Vali Loss: 6.650 Vali Acc: 0.732 Test Loss: 6.650 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 2002202
model size : 10.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.242079734802246
Epoch: 1, Steps: 13 | Train Loss: 0.806 Vali Loss: 3.125 Vali Acc: 0.278 Test Loss: 3.125 Test Acc: 0.278
Validation loss decreased (inf --> -0.278018).  Saving model ...
Epoch: 2 cost time: 2.344635248184204
Epoch: 2, Steps: 13 | Train Loss: 2.149 Vali Loss: 4.073 Vali Acc: 0.278 Test Loss: 4.073 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.698594331741333
Epoch: 3, Steps: 13 | Train Loss: 5.146 Vali Loss: 3.791 Vali Acc: 0.722 Test Loss: 3.791 Test Acc: 0.722
Validation loss decreased (-0.278018 --> -0.721913).  Saving model ...
Epoch: 4 cost time: 2.6223862171173096
Epoch: 4, Steps: 13 | Train Loss: 6.077 Vali Loss: 1.808 Vali Acc: 0.717 Test Loss: 1.808 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2147412300109863
Epoch: 5, Steps: 13 | Train Loss: 6.234 Vali Loss: 10.525 Vali Acc: 0.278 Test Loss: 10.525 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.282799482345581
Epoch: 6, Steps: 13 | Train Loss: 2.029 Vali Loss: 3.823 Vali Acc: 0.346 Test Loss: 3.823 Test Acc: 0.346
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.556567907333374
Epoch: 7, Steps: 13 | Train Loss: 1.246 Vali Loss: 0.863 Vali Acc: 0.741 Test Loss: 0.863 Test Acc: 0.741
Validation loss decreased (-0.721913 --> -0.741455).  Saving model ...
Epoch: 8 cost time: 2.4180667400360107
Epoch: 8, Steps: 13 | Train Loss: 3.031 Vali Loss: 5.898 Vali Acc: 0.722 Test Loss: 5.898 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.2116808891296387
Epoch: 9, Steps: 13 | Train Loss: 8.743 Vali Loss: 22.859 Vali Acc: 0.278 Test Loss: 22.859 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.013120412826538
Epoch: 10, Steps: 13 | Train Loss: 10.406 Vali Loss: 1.841 Vali Acc: 0.624 Test Loss: 1.841 Test Acc: 0.624
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.5484249591827393
Epoch: 11, Steps: 13 | Train Loss: 8.866 Vali Loss: 8.078 Vali Acc: 0.722 Test Loss: 8.078 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.1843791007995605
Epoch: 12, Steps: 13 | Train Loss: 1.410 Vali Loss: 2.191 Vali Acc: 0.527 Test Loss: 2.191 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.1417603492736816
Epoch: 13, Steps: 13 | Train Loss: 0.816 Vali Loss: 1.306 Vali Acc: 0.605 Test Loss: 1.306 Test Acc: 0.605
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.6754164695739746
Epoch: 14, Steps: 13 | Train Loss: 0.746 Vali Loss: 2.004 Vali Acc: 0.746 Test Loss: 2.004 Test Acc: 0.746
Validation loss decreased (-0.741455 --> -0.746321).  Saving model ...
Epoch: 15 cost time: 2.689406156539917
Epoch: 15, Steps: 13 | Train Loss: 1.818 Vali Loss: 5.848 Vali Acc: 0.722 Test Loss: 5.848 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.0204203128814697
Epoch: 16, Steps: 13 | Train Loss: 1.613 Vali Loss: 1.515 Vali Acc: 0.668 Test Loss: 1.515 Test Acc: 0.668
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.3865396976470947
Epoch: 17, Steps: 13 | Train Loss: 0.437 Vali Loss: 5.130 Vali Acc: 0.366 Test Loss: 5.130 Test Acc: 0.366
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.378822088241577
Epoch: 18, Steps: 13 | Train Loss: 6.186 Vali Loss: 1.638 Vali Acc: 0.663 Test Loss: 1.638 Test Acc: 0.663
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.298959732055664
Epoch: 19, Steps: 13 | Train Loss: 5.308 Vali Loss: 4.088 Vali Acc: 0.741 Test Loss: 4.088 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.305375099182129
Epoch: 20, Steps: 13 | Train Loss: 0.650 Vali Loss: 4.923 Vali Acc: 0.732 Test Loss: 4.923 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.2473018169403076
Epoch: 21, Steps: 13 | Train Loss: 0.610 Vali Loss: 2.048 Vali Acc: 0.634 Test Loss: 2.048 Test Acc: 0.634
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.3971636295318604
Epoch: 22, Steps: 13 | Train Loss: 1.222 Vali Loss: 6.384 Vali Acc: 0.405 Test Loss: 6.384 Test Acc: 0.405
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.4344656467437744
Epoch: 23, Steps: 13 | Train Loss: 0.771 Vali Loss: 9.549 Vali Acc: 0.356 Test Loss: 9.549 Test Acc: 0.356
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.3299379348754883
Epoch: 24, Steps: 13 | Train Loss: 0.851 Vali Loss: 7.966 Vali Acc: 0.385 Test Loss: 7.966 Test Acc: 0.385
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 1997850
model size : 10.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.79944634437561
Epoch: 1, Steps: 13 | Train Loss: 1.386 Vali Loss: 0.568 Vali Acc: 0.722 Test Loss: 0.568 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 3.637686014175415
Epoch: 2, Steps: 13 | Train Loss: 1.414 Vali Loss: 0.605 Vali Acc: 0.727 Test Loss: 0.605 Test Acc: 0.727
Validation loss decreased (-0.721946 --> -0.726823).  Saving model ...
Epoch: 3 cost time: 2.9256019592285156
Epoch: 3, Steps: 13 | Train Loss: 0.632 Vali Loss: 1.004 Vali Acc: 0.380 Test Loss: 1.004 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.0152854919433594
Epoch: 4, Steps: 13 | Train Loss: 2.154 Vali Loss: 1.659 Vali Acc: 0.712 Test Loss: 1.659 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.3282504081726074
Epoch: 5, Steps: 13 | Train Loss: 1.514 Vali Loss: 3.926 Vali Acc: 0.717 Test Loss: 3.926 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.439887523651123
Epoch: 6, Steps: 13 | Train Loss: 1.581 Vali Loss: 3.555 Vali Acc: 0.722 Test Loss: 3.555 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.5952765941619873
Epoch: 7, Steps: 13 | Train Loss: 2.091 Vali Loss: 3.314 Vali Acc: 0.312 Test Loss: 3.314 Test Acc: 0.312
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.8212835788726807
Epoch: 8, Steps: 13 | Train Loss: 1.853 Vali Loss: 9.884 Vali Acc: 0.283 Test Loss: 9.884 Test Acc: 0.283
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.5949370861053467
Epoch: 9, Steps: 13 | Train Loss: 4.672 Vali Loss: 0.931 Vali Acc: 0.741 Test Loss: 0.931 Test Acc: 0.741
Validation loss decreased (-0.726823 --> -0.741454).  Saving model ...
Epoch: 10 cost time: 2.6557774543762207
Epoch: 10, Steps: 13 | Train Loss: 1.236 Vali Loss: 3.206 Vali Acc: 0.722 Test Loss: 3.206 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.8602020740509033
Epoch: 11, Steps: 13 | Train Loss: 4.335 Vali Loss: 1.967 Vali Acc: 0.732 Test Loss: 1.967 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.5579299926757812
Epoch: 12, Steps: 13 | Train Loss: 2.341 Vali Loss: 7.007 Vali Acc: 0.722 Test Loss: 7.007 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.7932939529418945
Epoch: 13, Steps: 13 | Train Loss: 8.415 Vali Loss: 10.172 Vali Acc: 0.712 Test Loss: 10.172 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.619680404663086
Epoch: 14, Steps: 13 | Train Loss: 3.499 Vali Loss: 4.130 Vali Acc: 0.737 Test Loss: 4.130 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.661747932434082
Epoch: 15, Steps: 13 | Train Loss: 4.509 Vali Loss: 3.484 Vali Acc: 0.517 Test Loss: 3.484 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.6104736328125
Epoch: 16, Steps: 13 | Train Loss: 1.480 Vali Loss: 1.883 Vali Acc: 0.668 Test Loss: 1.883 Test Acc: 0.668
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.5195624828338623
Epoch: 17, Steps: 13 | Train Loss: 4.894 Vali Loss: 10.643 Vali Acc: 0.317 Test Loss: 10.643 Test Acc: 0.317
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.7223682403564453
Epoch: 18, Steps: 13 | Train Loss: 3.073 Vali Loss: 2.017 Vali Acc: 0.712 Test Loss: 2.017 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.7453649044036865
Epoch: 19, Steps: 13 | Train Loss: 1.800 Vali Loss: 7.920 Vali Acc: 0.722 Test Loss: 7.920 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 1813530
model size : 9.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.437821865081787
Epoch: 1, Steps: 13 | Train Loss: 0.857 Vali Loss: 1.209 Vali Acc: 0.722 Test Loss: 1.209 Test Acc: 0.722
Validation loss decreased (inf --> -0.721939).  Saving model ...
Epoch: 2 cost time: 2.336299180984497
Epoch: 2, Steps: 13 | Train Loss: 2.819 Vali Loss: 0.966 Vali Acc: 0.722 Test Loss: 0.966 Test Acc: 0.722
Validation loss decreased (-0.721939 --> -0.721942).  Saving model ...
Epoch: 3 cost time: 2.5075621604919434
Epoch: 3, Steps: 13 | Train Loss: 2.326 Vali Loss: 4.549 Vali Acc: 0.278 Test Loss: 4.549 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.083253860473633
Epoch: 4, Steps: 13 | Train Loss: 1.386 Vali Loss: 1.018 Vali Acc: 0.454 Test Loss: 1.018 Test Acc: 0.454
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.540585994720459
Epoch: 5, Steps: 13 | Train Loss: 0.829 Vali Loss: 2.184 Vali Acc: 0.722 Test Loss: 2.184 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.2879724502563477
Epoch: 6, Steps: 13 | Train Loss: 1.043 Vali Loss: 1.126 Vali Acc: 0.746 Test Loss: 1.126 Test Acc: 0.746
Validation loss decreased (-0.721942 --> -0.746330).  Saving model ...
Epoch: 7 cost time: 2.34011173248291
Epoch: 7, Steps: 13 | Train Loss: 3.887 Vali Loss: 6.962 Vali Acc: 0.722 Test Loss: 6.962 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.7549712657928467
Epoch: 8, Steps: 13 | Train Loss: 7.643 Vali Loss: 2.787 Vali Acc: 0.327 Test Loss: 2.787 Test Acc: 0.327
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.4332382678985596
Epoch: 9, Steps: 13 | Train Loss: 3.937 Vali Loss: 1.027 Vali Acc: 0.649 Test Loss: 1.027 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.27852201461792
Epoch: 10, Steps: 13 | Train Loss: 0.723 Vali Loss: 5.357 Vali Acc: 0.722 Test Loss: 5.357 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.060655355453491
Epoch: 11, Steps: 13 | Train Loss: 2.331 Vali Loss: 3.096 Vali Acc: 0.722 Test Loss: 3.096 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.8179757595062256
Epoch: 12, Steps: 13 | Train Loss: 2.326 Vali Loss: 2.437 Vali Acc: 0.366 Test Loss: 2.437 Test Acc: 0.366
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.6862611770629883
Epoch: 13, Steps: 13 | Train Loss: 5.260 Vali Loss: 1.168 Vali Acc: 0.659 Test Loss: 1.168 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.6212544441223145
Epoch: 14, Steps: 13 | Train Loss: 0.785 Vali Loss: 3.673 Vali Acc: 0.732 Test Loss: 3.673 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.7391304969787598
Epoch: 15, Steps: 13 | Train Loss: 2.121 Vali Loss: 4.250 Vali Acc: 0.722 Test Loss: 4.250 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.494258165359497
Epoch: 16, Steps: 13 | Train Loss: 2.088 Vali Loss: 1.979 Vali Acc: 0.737 Test Loss: 1.979 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 1809178
model size : 9.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.192466735839844
Epoch: 1, Steps: 13 | Train Loss: 1.309 Vali Loss: 0.569 Vali Acc: 0.712 Test Loss: 0.569 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 2.4892964363098145
Epoch: 2, Steps: 13 | Train Loss: 0.705 Vali Loss: 0.560 Vali Acc: 0.722 Test Loss: 0.560 Test Acc: 0.722
Validation loss decreased (-0.712189 --> -0.721946).  Saving model ...
Epoch: 3 cost time: 2.6205668449401855
Epoch: 3, Steps: 13 | Train Loss: 0.742 Vali Loss: 1.099 Vali Acc: 0.727 Test Loss: 1.099 Test Acc: 0.727
Validation loss decreased (-0.721946 --> -0.726818).  Saving model ...
Epoch: 4 cost time: 2.437441110610962
Epoch: 4, Steps: 13 | Train Loss: 0.951 Vali Loss: 5.419 Vali Acc: 0.278 Test Loss: 5.419 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.993168354034424
Epoch: 5, Steps: 13 | Train Loss: 2.185 Vali Loss: 2.089 Vali Acc: 0.307 Test Loss: 2.089 Test Acc: 0.307
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.5551819801330566
Epoch: 6, Steps: 13 | Train Loss: 0.873 Vali Loss: 2.331 Vali Acc: 0.722 Test Loss: 2.331 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.6653501987457275
Epoch: 7, Steps: 13 | Train Loss: 4.941 Vali Loss: 22.138 Vali Acc: 0.283 Test Loss: 22.138 Test Acc: 0.283
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.670558452606201
Epoch: 8, Steps: 13 | Train Loss: 10.746 Vali Loss: 3.590 Vali Acc: 0.712 Test Loss: 3.590 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.6820337772369385
Epoch: 9, Steps: 13 | Train Loss: 8.493 Vali Loss: 7.649 Vali Acc: 0.717 Test Loss: 7.649 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.3744843006134033
Epoch: 10, Steps: 13 | Train Loss: 7.090 Vali Loss: 12.123 Vali Acc: 0.278 Test Loss: 12.123 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.5476415157318115
Epoch: 11, Steps: 13 | Train Loss: 3.393 Vali Loss: 0.953 Vali Acc: 0.702 Test Loss: 0.953 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.7429964542388916
Epoch: 12, Steps: 13 | Train Loss: 6.183 Vali Loss: 6.046 Vali Acc: 0.317 Test Loss: 6.046 Test Acc: 0.317
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.618518590927124
Epoch: 13, Steps: 13 | Train Loss: 1.173 Vali Loss: 3.522 Vali Acc: 0.732 Test Loss: 3.522 Test Acc: 0.732
Validation loss decreased (-0.726818 --> -0.731672).  Saving model ...
Epoch: 14 cost time: 2.6685409545898438
Epoch: 14, Steps: 13 | Train Loss: 5.412 Vali Loss: 1.715 Vali Acc: 0.537 Test Loss: 1.715 Test Acc: 0.537
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.6736948490142822
Epoch: 15, Steps: 13 | Train Loss: 4.310 Vali Loss: 3.318 Vali Acc: 0.449 Test Loss: 3.318 Test Acc: 0.449
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.7997679710388184
Epoch: 16, Steps: 13 | Train Loss: 3.183 Vali Loss: 1.730 Vali Acc: 0.751 Test Loss: 1.730 Test Acc: 0.751
Validation loss decreased (-0.731672 --> -0.751202).  Saving model ...
Epoch: 17 cost time: 2.625002145767212
Epoch: 17, Steps: 13 | Train Loss: 2.700 Vali Loss: 9.137 Vali Acc: 0.722 Test Loss: 9.137 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.464824676513672
Epoch: 18, Steps: 13 | Train Loss: 7.356 Vali Loss: 4.182 Vali Acc: 0.517 Test Loss: 4.182 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.5929722785949707
Epoch: 19, Steps: 13 | Train Loss: 5.861 Vali Loss: 7.421 Vali Acc: 0.722 Test Loss: 7.421 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.012460947036743
Epoch: 20, Steps: 13 | Train Loss: 3.424 Vali Loss: 9.857 Vali Acc: 0.405 Test Loss: 9.857 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.2663960456848145
Epoch: 21, Steps: 13 | Train Loss: 1.552 Vali Loss: 6.734 Vali Acc: 0.449 Test Loss: 6.734 Test Acc: 0.449
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.1567115783691406
Epoch: 22, Steps: 13 | Train Loss: 0.914 Vali Loss: 2.506 Vali Acc: 0.624 Test Loss: 2.506 Test Acc: 0.624
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.3370301723480225
Epoch: 23, Steps: 13 | Train Loss: 1.620 Vali Loss: 3.595 Vali Acc: 0.746 Test Loss: 3.595 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.3440380096435547
Epoch: 24, Steps: 13 | Train Loss: 2.041 Vali Loss: 3.658 Vali Acc: 0.756 Test Loss: 3.658 Test Acc: 0.756
Validation loss decreased (-0.751202 --> -0.756061).  Saving model ...
Epoch: 25 cost time: 2.069803476333618
Epoch: 25, Steps: 13 | Train Loss: 0.798 Vali Loss: 3.865 Vali Acc: 0.561 Test Loss: 3.865 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.3075718879699707
Epoch: 26, Steps: 13 | Train Loss: 1.795 Vali Loss: 3.201 Vali Acc: 0.717 Test Loss: 3.201 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.1503233909606934
Epoch: 27, Steps: 13 | Train Loss: 0.837 Vali Loss: 5.408 Vali Acc: 0.761 Test Loss: 5.408 Test Acc: 0.761
Validation loss decreased (-0.756061 --> -0.760922).  Saving model ...
Epoch: 28 cost time: 2.531512498855591
Epoch: 28, Steps: 13 | Train Loss: 1.424 Vali Loss: 4.254 Vali Acc: 0.751 Test Loss: 4.254 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.6174569129943848
Epoch: 29, Steps: 13 | Train Loss: 1.720 Vali Loss: 4.806 Vali Acc: 0.693 Test Loss: 4.806 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.888638973236084
Epoch: 30, Steps: 13 | Train Loss: 0.378 Vali Loss: 6.712 Vali Acc: 0.751 Test Loss: 6.712 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.533231735229492
Epoch: 31, Steps: 13 | Train Loss: 1.556 Vali Loss: 5.991 Vali Acc: 0.756 Test Loss: 5.991 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.3172760009765625
Epoch: 32, Steps: 13 | Train Loss: 0.478 Vali Loss: 4.988 Vali Acc: 0.727 Test Loss: 4.988 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.48880934715271
Epoch: 33, Steps: 13 | Train Loss: 0.595 Vali Loss: 7.075 Vali Acc: 0.761 Test Loss: 7.075 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.424137592315674
Epoch: 34, Steps: 13 | Train Loss: 0.987 Vali Loss: 15.245 Vali Acc: 0.410 Test Loss: 15.245 Test Acc: 0.410
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 2.399747133255005
Epoch: 35, Steps: 13 | Train Loss: 1.382 Vali Loss: 8.653 Vali Acc: 0.741 Test Loss: 8.653 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 2.7190308570861816
Epoch: 36, Steps: 13 | Train Loss: 1.107 Vali Loss: 5.841 Vali Acc: 0.712 Test Loss: 5.841 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 2.4906296730041504
Epoch: 37, Steps: 13 | Train Loss: 0.148 Vali Loss: 6.273 Vali Acc: 0.722 Test Loss: 6.273 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 1804826
model size : 9.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.292529582977295
Epoch: 1, Steps: 13 | Train Loss: 1.237 Vali Loss: 0.951 Vali Acc: 0.717 Test Loss: 0.951 Test Acc: 0.717
Validation loss decreased (inf --> -0.717064).  Saving model ...
Epoch: 2 cost time: 2.744609832763672
Epoch: 2, Steps: 13 | Train Loss: 1.318 Vali Loss: 0.924 Vali Acc: 0.712 Test Loss: 0.924 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.3745172023773193
Epoch: 3, Steps: 13 | Train Loss: 1.090 Vali Loss: 1.098 Vali Acc: 0.327 Test Loss: 1.098 Test Acc: 0.327
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.0969228744506836
Epoch: 4, Steps: 13 | Train Loss: 1.493 Vali Loss: 1.170 Vali Acc: 0.722 Test Loss: 1.170 Test Acc: 0.722
Validation loss decreased (-0.717064 --> -0.721940).  Saving model ...
Epoch: 5 cost time: 2.6244606971740723
Epoch: 5, Steps: 13 | Train Loss: 5.364 Vali Loss: 2.609 Vali Acc: 0.722 Test Loss: 2.609 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.7282822132110596
Epoch: 6, Steps: 13 | Train Loss: 3.440 Vali Loss: 5.596 Vali Acc: 0.278 Test Loss: 5.596 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.50368332862854
Epoch: 7, Steps: 13 | Train Loss: 2.126 Vali Loss: 5.881 Vali Acc: 0.293 Test Loss: 5.881 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.268395185470581
Epoch: 8, Steps: 13 | Train Loss: 2.095 Vali Loss: 0.727 Vali Acc: 0.688 Test Loss: 0.727 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.3773839473724365
Epoch: 9, Steps: 13 | Train Loss: 5.184 Vali Loss: 9.963 Vali Acc: 0.278 Test Loss: 9.963 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.544187307357788
Epoch: 10, Steps: 13 | Train Loss: 1.527 Vali Loss: 2.024 Vali Acc: 0.483 Test Loss: 2.024 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.685412883758545
Epoch: 11, Steps: 13 | Train Loss: 0.642 Vali Loss: 3.285 Vali Acc: 0.727 Test Loss: 3.285 Test Acc: 0.727
Validation loss decreased (-0.721940 --> -0.726796).  Saving model ...
Epoch: 12 cost time: 2.1712646484375
Epoch: 12, Steps: 13 | Train Loss: 5.343 Vali Loss: 27.042 Vali Acc: 0.278 Test Loss: 27.042 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.453765630722046
Epoch: 13, Steps: 13 | Train Loss: 13.245 Vali Loss: 4.913 Vali Acc: 0.351 Test Loss: 4.913 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.547179937362671
Epoch: 14, Steps: 13 | Train Loss: 7.885 Vali Loss: 11.980 Vali Acc: 0.712 Test Loss: 11.980 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.4577438831329346
Epoch: 15, Steps: 13 | Train Loss: 5.684 Vali Loss: 4.255 Vali Acc: 0.756 Test Loss: 4.255 Test Acc: 0.756
Validation loss decreased (-0.726796 --> -0.756055).  Saving model ...
Epoch: 16 cost time: 2.6879305839538574
Epoch: 16, Steps: 13 | Train Loss: 8.884 Vali Loss: 7.081 Vali Acc: 0.722 Test Loss: 7.081 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.442286729812622
Epoch: 17, Steps: 13 | Train Loss: 3.094 Vali Loss: 3.714 Vali Acc: 0.756 Test Loss: 3.714 Test Acc: 0.756
Validation loss decreased (-0.756055 --> -0.756060).  Saving model ...
Epoch: 18 cost time: 2.5343668460845947
Epoch: 18, Steps: 13 | Train Loss: 2.364 Vali Loss: 8.603 Vali Acc: 0.371 Test Loss: 8.603 Test Acc: 0.371
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.912930488586426
Epoch: 19, Steps: 13 | Train Loss: 6.755 Vali Loss: 10.939 Vali Acc: 0.722 Test Loss: 10.939 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.196725368499756
Epoch: 20, Steps: 13 | Train Loss: 2.127 Vali Loss: 5.544 Vali Acc: 0.737 Test Loss: 5.544 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.600343942642212
Epoch: 21, Steps: 13 | Train Loss: 2.398 Vali Loss: 3.847 Vali Acc: 0.522 Test Loss: 3.847 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.1542811393737793
Epoch: 22, Steps: 13 | Train Loss: 1.694 Vali Loss: 3.751 Vali Acc: 0.551 Test Loss: 3.751 Test Acc: 0.551
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.3410515785217285
Epoch: 23, Steps: 13 | Train Loss: 1.629 Vali Loss: 8.370 Vali Acc: 0.400 Test Loss: 8.370 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.0512871742248535
Epoch: 24, Steps: 13 | Train Loss: 6.979 Vali Loss: 14.639 Vali Acc: 0.717 Test Loss: 14.639 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.5305051803588867
Epoch: 25, Steps: 13 | Train Loss: 4.202 Vali Loss: 6.985 Vali Acc: 0.488 Test Loss: 6.985 Test Acc: 0.488
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.5774848461151123
Epoch: 26, Steps: 13 | Train Loss: 0.602 Vali Loss: 3.835 Vali Acc: 0.615 Test Loss: 3.835 Test Acc: 0.615
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.3967459201812744
Epoch: 27, Steps: 13 | Train Loss: 0.462 Vali Loss: 3.714 Vali Acc: 0.693 Test Loss: 3.714 Test Acc: 0.693
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 1800474
model size : 9.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.136373043060303
Epoch: 1, Steps: 13 | Train Loss: 0.869 Vali Loss: 0.575 Vali Acc: 0.722 Test Loss: 0.575 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.677506685256958
Epoch: 2, Steps: 13 | Train Loss: 0.569 Vali Loss: 1.318 Vali Acc: 0.293 Test Loss: 1.318 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.86376953125
Epoch: 3, Steps: 13 | Train Loss: 0.669 Vali Loss: 2.386 Vali Acc: 0.288 Test Loss: 2.386 Test Acc: 0.288
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.0262722969055176
Epoch: 4, Steps: 13 | Train Loss: 1.032 Vali Loss: 0.986 Vali Acc: 0.732 Test Loss: 0.986 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731697).  Saving model ...
Epoch: 5 cost time: 2.0134074687957764
Epoch: 5, Steps: 13 | Train Loss: 2.202 Vali Loss: 8.109 Vali Acc: 0.283 Test Loss: 8.109 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.705976963043213
Epoch: 6, Steps: 13 | Train Loss: 2.647 Vali Loss: 0.636 Vali Acc: 0.698 Test Loss: 0.636 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.7596399784088135
Epoch: 7, Steps: 13 | Train Loss: 1.944 Vali Loss: 2.769 Vali Acc: 0.717 Test Loss: 2.769 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.611052989959717
Epoch: 8, Steps: 13 | Train Loss: 1.148 Vali Loss: 3.134 Vali Acc: 0.722 Test Loss: 3.134 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.6361026763916016
Epoch: 9, Steps: 13 | Train Loss: 4.363 Vali Loss: 7.009 Vali Acc: 0.298 Test Loss: 7.009 Test Acc: 0.298
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.6221883296966553
Epoch: 10, Steps: 13 | Train Loss: 4.962 Vali Loss: 1.042 Vali Acc: 0.683 Test Loss: 1.042 Test Acc: 0.683
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.708167314529419
Epoch: 11, Steps: 13 | Train Loss: 9.564 Vali Loss: 3.215 Vali Acc: 0.732 Test Loss: 3.215 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.650385618209839
Epoch: 12, Steps: 13 | Train Loss: 5.224 Vali Loss: 2.426 Vali Acc: 0.546 Test Loss: 2.426 Test Acc: 0.546
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.7887959480285645
Epoch: 13, Steps: 13 | Train Loss: 2.583 Vali Loss: 1.420 Vali Acc: 0.722 Test Loss: 1.420 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.851283073425293
Epoch: 14, Steps: 13 | Train Loss: 1.908 Vali Loss: 1.558 Vali Acc: 0.751 Test Loss: 1.558 Test Acc: 0.751
Validation loss decreased (-0.731697 --> -0.751204).  Saving model ...
Epoch: 15 cost time: 2.5841290950775146
Epoch: 15, Steps: 13 | Train Loss: 2.577 Vali Loss: 1.363 Vali Acc: 0.712 Test Loss: 1.363 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.2961246967315674
Epoch: 16, Steps: 13 | Train Loss: 3.958 Vali Loss: 4.648 Vali Acc: 0.737 Test Loss: 4.648 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.5661349296569824
Epoch: 17, Steps: 13 | Train Loss: 3.281 Vali Loss: 12.096 Vali Acc: 0.717 Test Loss: 12.096 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.7241010665893555
Epoch: 18, Steps: 13 | Train Loss: 8.174 Vali Loss: 9.971 Vali Acc: 0.346 Test Loss: 9.971 Test Acc: 0.346
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.2853574752807617
Epoch: 19, Steps: 13 | Train Loss: 5.248 Vali Loss: 2.390 Vali Acc: 0.683 Test Loss: 2.390 Test Acc: 0.683
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.7822351455688477
Epoch: 20, Steps: 13 | Train Loss: 2.686 Vali Loss: 4.664 Vali Acc: 0.463 Test Loss: 4.664 Test Acc: 0.463
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.500074863433838
Epoch: 21, Steps: 13 | Train Loss: 1.402 Vali Loss: 4.114 Vali Acc: 0.478 Test Loss: 4.114 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.320725679397583
Epoch: 22, Steps: 13 | Train Loss: 1.358 Vali Loss: 2.622 Vali Acc: 0.722 Test Loss: 2.622 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.5292985439300537
Epoch: 23, Steps: 13 | Train Loss: 2.206 Vali Loss: 2.508 Vali Acc: 0.663 Test Loss: 2.508 Test Acc: 0.663
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.05810546875
Epoch: 24, Steps: 13 | Train Loss: 0.483 Vali Loss: 4.825 Vali Acc: 0.741 Test Loss: 4.825 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 1714842
model size : 9.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.530666351318359
Epoch: 1, Steps: 13 | Train Loss: 1.248 Vali Loss: 1.275 Vali Acc: 0.288 Test Loss: 1.275 Test Acc: 0.288
Validation loss decreased (inf --> -0.287792).  Saving model ...
Epoch: 2 cost time: 3.0020651817321777
Epoch: 2, Steps: 13 | Train Loss: 1.363 Vali Loss: 1.440 Vali Acc: 0.722 Test Loss: 1.440 Test Acc: 0.722
Validation loss decreased (-0.287792 --> -0.721937).  Saving model ...
Epoch: 3 cost time: 2.66412091255188
Epoch: 3, Steps: 13 | Train Loss: 1.591 Vali Loss: 2.816 Vali Acc: 0.712 Test Loss: 2.816 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.610994815826416
Epoch: 4, Steps: 13 | Train Loss: 0.839 Vali Loss: 2.213 Vali Acc: 0.327 Test Loss: 2.213 Test Acc: 0.327
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.8494575023651123
Epoch: 5, Steps: 13 | Train Loss: 2.054 Vali Loss: 0.569 Vali Acc: 0.737 Test Loss: 0.569 Test Acc: 0.737
Validation loss decreased (-0.721937 --> -0.736580).  Saving model ...
Epoch: 6 cost time: 2.5455574989318848
Epoch: 6, Steps: 13 | Train Loss: 2.472 Vali Loss: 7.788 Vali Acc: 0.283 Test Loss: 7.788 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.5185000896453857
Epoch: 7, Steps: 13 | Train Loss: 2.659 Vali Loss: 2.363 Vali Acc: 0.722 Test Loss: 2.363 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.1537487506866455
Epoch: 8, Steps: 13 | Train Loss: 1.826 Vali Loss: 1.875 Vali Acc: 0.727 Test Loss: 1.875 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.429680585861206
Epoch: 9, Steps: 13 | Train Loss: 5.617 Vali Loss: 1.047 Vali Acc: 0.746 Test Loss: 1.047 Test Acc: 0.746
Validation loss decreased (-0.736580 --> -0.746331).  Saving model ...
Epoch: 10 cost time: 2.218651533126831
Epoch: 10, Steps: 13 | Train Loss: 1.195 Vali Loss: 6.429 Vali Acc: 0.722 Test Loss: 6.429 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.2035582065582275
Epoch: 11, Steps: 13 | Train Loss: 7.503 Vali Loss: 1.355 Vali Acc: 0.556 Test Loss: 1.355 Test Acc: 0.556
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.3353986740112305
Epoch: 12, Steps: 13 | Train Loss: 9.743 Vali Loss: 22.052 Vali Acc: 0.278 Test Loss: 22.052 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.297213554382324
Epoch: 13, Steps: 13 | Train Loss: 3.529 Vali Loss: 1.342 Vali Acc: 0.678 Test Loss: 1.342 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.8523499965667725
Epoch: 14, Steps: 13 | Train Loss: 1.091 Vali Loss: 2.925 Vali Acc: 0.737 Test Loss: 2.925 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.5356719493865967
Epoch: 15, Steps: 13 | Train Loss: 0.740 Vali Loss: 4.422 Vali Acc: 0.727 Test Loss: 4.422 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.8221628665924072
Epoch: 16, Steps: 13 | Train Loss: 2.731 Vali Loss: 3.986 Vali Acc: 0.732 Test Loss: 3.986 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.7333240509033203
Epoch: 17, Steps: 13 | Train Loss: 1.352 Vali Loss: 4.530 Vali Acc: 0.415 Test Loss: 4.530 Test Acc: 0.415
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.3197875022888184
Epoch: 18, Steps: 13 | Train Loss: 1.098 Vali Loss: 8.963 Vali Acc: 0.327 Test Loss: 8.963 Test Acc: 0.327
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.596691608428955
Epoch: 19, Steps: 13 | Train Loss: 6.749 Vali Loss: 1.669 Vali Acc: 0.629 Test Loss: 1.669 Test Acc: 0.629
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 1710490
model size : 9.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.6039276123046875
Epoch: 1, Steps: 13 | Train Loss: 0.983 Vali Loss: 1.717 Vali Acc: 0.712 Test Loss: 1.717 Test Acc: 0.712
Validation loss decreased (inf --> -0.712178).  Saving model ...
Epoch: 2 cost time: 2.3994343280792236
Epoch: 2, Steps: 13 | Train Loss: 2.593 Vali Loss: 0.843 Vali Acc: 0.712 Test Loss: 0.843 Test Acc: 0.712
Validation loss decreased (-0.712178 --> -0.712187).  Saving model ...
Epoch: 3 cost time: 2.6626131534576416
Epoch: 3, Steps: 13 | Train Loss: 0.880 Vali Loss: 1.389 Vali Acc: 0.717 Test Loss: 1.389 Test Acc: 0.717
Validation loss decreased (-0.712187 --> -0.717059).  Saving model ...
Epoch: 4 cost time: 2.778085231781006
Epoch: 4, Steps: 13 | Train Loss: 0.893 Vali Loss: 0.999 Vali Acc: 0.415 Test Loss: 0.999 Test Acc: 0.415
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.8833742141723633
Epoch: 5, Steps: 13 | Train Loss: 0.733 Vali Loss: 0.678 Vali Acc: 0.683 Test Loss: 0.678 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.4749302864074707
Epoch: 6, Steps: 13 | Train Loss: 1.920 Vali Loss: 0.706 Vali Acc: 0.654 Test Loss: 0.706 Test Acc: 0.654
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.7500672340393066
Epoch: 7, Steps: 13 | Train Loss: 1.323 Vali Loss: 3.032 Vali Acc: 0.307 Test Loss: 3.032 Test Acc: 0.307
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.4931485652923584
Epoch: 8, Steps: 13 | Train Loss: 1.209 Vali Loss: 6.622 Vali Acc: 0.293 Test Loss: 6.622 Test Acc: 0.293
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.6874372959136963
Epoch: 9, Steps: 13 | Train Loss: 3.542 Vali Loss: 4.586 Vali Acc: 0.327 Test Loss: 4.586 Test Acc: 0.327
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.735774517059326
Epoch: 10, Steps: 13 | Train Loss: 2.060 Vali Loss: 1.230 Vali Acc: 0.732 Test Loss: 1.230 Test Acc: 0.732
Validation loss decreased (-0.717059 --> -0.731695).  Saving model ...
Epoch: 11 cost time: 2.6922852993011475
Epoch: 11, Steps: 13 | Train Loss: 2.754 Vali Loss: 1.938 Vali Acc: 0.459 Test Loss: 1.938 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.605526924133301
Epoch: 12, Steps: 13 | Train Loss: 0.522 Vali Loss: 1.877 Vali Acc: 0.746 Test Loss: 1.877 Test Acc: 0.746
Validation loss decreased (-0.731695 --> -0.746323).  Saving model ...
Epoch: 13 cost time: 3.27549147605896
Epoch: 13, Steps: 13 | Train Loss: 1.199 Vali Loss: 2.436 Vali Acc: 0.410 Test Loss: 2.436 Test Acc: 0.410
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.865267753601074
Epoch: 14, Steps: 13 | Train Loss: 3.680 Vali Loss: 8.257 Vali Acc: 0.722 Test Loss: 8.257 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.6821482181549072
Epoch: 15, Steps: 13 | Train Loss: 2.774 Vali Loss: 5.785 Vali Acc: 0.366 Test Loss: 5.785 Test Acc: 0.366
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.8476791381835938
Epoch: 16, Steps: 13 | Train Loss: 3.169 Vali Loss: 3.173 Vali Acc: 0.741 Test Loss: 3.173 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.5667150020599365
Epoch: 17, Steps: 13 | Train Loss: 2.828 Vali Loss: 8.658 Vali Acc: 0.307 Test Loss: 8.658 Test Acc: 0.307
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.653017044067383
Epoch: 18, Steps: 13 | Train Loss: 6.458 Vali Loss: 3.428 Vali Acc: 0.741 Test Loss: 3.428 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.4668707847595215
Epoch: 19, Steps: 13 | Train Loss: 0.896 Vali Loss: 3.389 Vali Acc: 0.478 Test Loss: 3.389 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.3231723308563232
Epoch: 20, Steps: 13 | Train Loss: 3.095 Vali Loss: 6.607 Vali Acc: 0.371 Test Loss: 6.607 Test Acc: 0.371
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.8803999423980713
Epoch: 21, Steps: 13 | Train Loss: 3.088 Vali Loss: 6.912 Vali Acc: 0.337 Test Loss: 6.912 Test Acc: 0.337
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.6787922382354736
Epoch: 22, Steps: 13 | Train Loss: 0.892 Vali Loss: 1.998 Vali Acc: 0.693 Test Loss: 1.998 Test Acc: 0.693
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 1706138
model size : 9.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.585193395614624
Epoch: 1, Steps: 13 | Train Loss: 0.815 Vali Loss: 0.570 Vali Acc: 0.722 Test Loss: 0.570 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 2.3460795879364014
Epoch: 2, Steps: 13 | Train Loss: 3.579 Vali Loss: 5.223 Vali Acc: 0.283 Test Loss: 5.223 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.923326015472412
Epoch: 3, Steps: 13 | Train Loss: 1.360 Vali Loss: 0.738 Vali Acc: 0.732 Test Loss: 0.738 Test Acc: 0.732
Validation loss decreased (-0.721946 --> -0.731700).  Saving model ...
Epoch: 4 cost time: 2.118576765060425
Epoch: 4, Steps: 13 | Train Loss: 1.156 Vali Loss: 1.702 Vali Acc: 0.722 Test Loss: 1.702 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5994772911071777
Epoch: 5, Steps: 13 | Train Loss: 2.715 Vali Loss: 1.884 Vali Acc: 0.717 Test Loss: 1.884 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.495600461959839
Epoch: 6, Steps: 13 | Train Loss: 2.914 Vali Loss: 3.706 Vali Acc: 0.722 Test Loss: 3.706 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.214604139328003
Epoch: 7, Steps: 13 | Train Loss: 2.550 Vali Loss: 0.777 Vali Acc: 0.741 Test Loss: 0.777 Test Acc: 0.741
Validation loss decreased (-0.731700 --> -0.741456).  Saving model ...
Epoch: 8 cost time: 2.73635196685791
Epoch: 8, Steps: 13 | Train Loss: 4.878 Vali Loss: 1.903 Vali Acc: 0.385 Test Loss: 1.903 Test Acc: 0.385
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.501155376434326
Epoch: 9, Steps: 13 | Train Loss: 1.186 Vali Loss: 2.526 Vali Acc: 0.727 Test Loss: 2.526 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.6612606048583984
Epoch: 10, Steps: 13 | Train Loss: 0.923 Vali Loss: 1.729 Vali Acc: 0.732 Test Loss: 1.729 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.634547710418701
Epoch: 11, Steps: 13 | Train Loss: 2.145 Vali Loss: 6.905 Vali Acc: 0.298 Test Loss: 6.905 Test Acc: 0.298
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.2091729640960693
Epoch: 12, Steps: 13 | Train Loss: 5.833 Vali Loss: 0.849 Vali Acc: 0.712 Test Loss: 0.849 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.1707427501678467
Epoch: 13, Steps: 13 | Train Loss: 8.473 Vali Loss: 3.317 Vali Acc: 0.732 Test Loss: 3.317 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.2925264835357666
Epoch: 14, Steps: 13 | Train Loss: 4.671 Vali Loss: 9.064 Vali Acc: 0.317 Test Loss: 9.064 Test Acc: 0.317
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.9995386600494385
Epoch: 15, Steps: 13 | Train Loss: 1.590 Vali Loss: 1.413 Vali Acc: 0.746 Test Loss: 1.413 Test Acc: 0.746
Validation loss decreased (-0.741456 --> -0.746327).  Saving model ...
Epoch: 16 cost time: 2.543476104736328
Epoch: 16, Steps: 13 | Train Loss: 0.766 Vali Loss: 4.887 Vali Acc: 0.332 Test Loss: 4.887 Test Acc: 0.332
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.4069337844848633
Epoch: 17, Steps: 13 | Train Loss: 3.799 Vali Loss: 8.288 Vali Acc: 0.722 Test Loss: 8.288 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.6465036869049072
Epoch: 18, Steps: 13 | Train Loss: 10.048 Vali Loss: 29.404 Vali Acc: 0.283 Test Loss: 29.404 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.399083375930786
Epoch: 19, Steps: 13 | Train Loss: 9.858 Vali Loss: 7.530 Vali Acc: 0.380 Test Loss: 7.530 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.0034661293029785
Epoch: 20, Steps: 13 | Train Loss: 5.565 Vali Loss: 2.380 Vali Acc: 0.727 Test Loss: 2.380 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.9357054233551025
Epoch: 21, Steps: 13 | Train Loss: 5.654 Vali Loss: 2.747 Vali Acc: 0.702 Test Loss: 2.747 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.079998254776001
Epoch: 22, Steps: 13 | Train Loss: 3.111 Vali Loss: 3.839 Vali Acc: 0.756 Test Loss: 3.839 Test Acc: 0.756
Validation loss decreased (-0.746327 --> -0.756059).  Saving model ...
Epoch: 23 cost time: 2.590894937515259
Epoch: 23, Steps: 13 | Train Loss: 3.553 Vali Loss: 4.964 Vali Acc: 0.737 Test Loss: 4.964 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.1385982036590576
Epoch: 24, Steps: 13 | Train Loss: 1.340 Vali Loss: 8.550 Vali Acc: 0.722 Test Loss: 8.550 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.8342583179473877
Epoch: 25, Steps: 13 | Train Loss: 4.985 Vali Loss: 2.722 Vali Acc: 0.654 Test Loss: 2.722 Test Acc: 0.654
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.2148900032043457
Epoch: 26, Steps: 13 | Train Loss: 1.314 Vali Loss: 4.608 Vali Acc: 0.751 Test Loss: 4.608 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.3251302242279053
Epoch: 27, Steps: 13 | Train Loss: 0.591 Vali Loss: 8.487 Vali Acc: 0.717 Test Loss: 8.487 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.7559714317321777
Epoch: 28, Steps: 13 | Train Loss: 5.841 Vali Loss: 14.844 Vali Acc: 0.351 Test Loss: 14.844 Test Acc: 0.351
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.6744706630706787
Epoch: 29, Steps: 13 | Train Loss: 5.465 Vali Loss: 11.150 Vali Acc: 0.722 Test Loss: 11.150 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.4764299392700195
Epoch: 30, Steps: 13 | Train Loss: 2.110 Vali Loss: 4.700 Vali Acc: 0.766 Test Loss: 4.700 Test Acc: 0.766
Validation loss decreased (-0.756059 --> -0.765807).  Saving model ...
Epoch: 31 cost time: 2.626614809036255
Epoch: 31, Steps: 13 | Train Loss: 1.855 Vali Loss: 9.372 Vali Acc: 0.439 Test Loss: 9.372 Test Acc: 0.439
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.613964557647705
Epoch: 32, Steps: 13 | Train Loss: 1.342 Vali Loss: 7.866 Vali Acc: 0.746 Test Loss: 7.866 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.311438798904419
Epoch: 33, Steps: 13 | Train Loss: 0.202 Vali Loss: 6.009 Vali Acc: 0.761 Test Loss: 6.009 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.5871427059173584
Epoch: 34, Steps: 13 | Train Loss: 0.214 Vali Loss: 5.820 Vali Acc: 0.576 Test Loss: 5.820 Test Acc: 0.576
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 2.0205705165863037
Epoch: 35, Steps: 13 | Train Loss: 0.397 Vali Loss: 5.213 Vali Acc: 0.712 Test Loss: 5.213 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 2.480282783508301
Epoch: 36, Steps: 13 | Train Loss: 0.457 Vali Loss: 8.583 Vali Acc: 0.756 Test Loss: 8.583 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.8542311191558838
Epoch: 37, Steps: 13 | Train Loss: 0.427 Vali Loss: 11.075 Vali Acc: 0.737 Test Loss: 11.075 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 2.0896875858306885
Epoch: 38, Steps: 13 | Train Loss: 0.600 Vali Loss: 8.677 Vali Acc: 0.771 Test Loss: 8.677 Test Acc: 0.771
Validation loss decreased (-0.765807 --> -0.770645).  Saving model ...
Epoch: 39 cost time: 2.295193910598755
Epoch: 39, Steps: 13 | Train Loss: 0.116 Vali Loss: 8.549 Vali Acc: 0.766 Test Loss: 8.549 Test Acc: 0.766
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.921154499053955
Epoch: 40, Steps: 13 | Train Loss: 0.324 Vali Loss: 5.787 Vali Acc: 0.683 Test Loss: 5.787 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.7888004779815674
Epoch: 41, Steps: 13 | Train Loss: 0.340 Vali Loss: 6.582 Vali Acc: 0.673 Test Loss: 6.582 Test Acc: 0.673
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.8972852230072021
Epoch: 42, Steps: 13 | Train Loss: 0.033 Vali Loss: 8.378 Vali Acc: 0.741 Test Loss: 8.378 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 2.1219921112060547
Epoch: 43, Steps: 13 | Train Loss: 0.462 Vali Loss: 7.760 Vali Acc: 0.668 Test Loss: 7.760 Test Acc: 0.668
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 2.126514196395874
Epoch: 44, Steps: 13 | Train Loss: 0.185 Vali Loss: 9.068 Vali Acc: 0.746 Test Loss: 9.068 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.8173282146453857
Epoch: 45, Steps: 13 | Train Loss: 0.132 Vali Loss: 7.967 Vali Acc: 0.698 Test Loss: 7.967 Test Acc: 0.698
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 2.3503623008728027
Epoch: 46, Steps: 13 | Train Loss: 0.068 Vali Loss: 8.493 Vali Acc: 0.741 Test Loss: 8.493 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 2.3254873752593994
Epoch: 47, Steps: 13 | Train Loss: 1.709 Vali Loss: 16.434 Vali Acc: 0.439 Test Loss: 16.434 Test Acc: 0.439
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 2.5197935104370117
Epoch: 48, Steps: 13 | Train Loss: 0.643 Vali Loss: 9.988 Vali Acc: 0.766 Test Loss: 9.988 Test Acc: 0.766
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 1701786
model size : 9.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.600559711456299
Epoch: 1, Steps: 13 | Train Loss: 0.761 Vali Loss: 0.655 Vali Acc: 0.707 Test Loss: 0.655 Test Acc: 0.707
Validation loss decreased (inf --> -0.707311).  Saving model ...
Epoch: 2 cost time: 2.513077974319458
Epoch: 2, Steps: 13 | Train Loss: 0.886 Vali Loss: 0.800 Vali Acc: 0.346 Test Loss: 0.800 Test Acc: 0.346
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.420497417449951
Epoch: 3, Steps: 13 | Train Loss: 0.881 Vali Loss: 1.308 Vali Acc: 0.722 Test Loss: 1.308 Test Acc: 0.722
Validation loss decreased (-0.707311 --> -0.721938).  Saving model ...
Epoch: 4 cost time: 2.4430432319641113
Epoch: 4, Steps: 13 | Train Loss: 1.024 Vali Loss: 0.538 Vali Acc: 0.761 Test Loss: 0.538 Test Acc: 0.761
Validation loss decreased (-0.721938 --> -0.760970).  Saving model ...
Epoch: 5 cost time: 2.327791452407837
Epoch: 5, Steps: 13 | Train Loss: 2.652 Vali Loss: 1.666 Vali Acc: 0.722 Test Loss: 1.666 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1298229694366455
Epoch: 6, Steps: 13 | Train Loss: 1.263 Vali Loss: 1.372 Vali Acc: 0.722 Test Loss: 1.372 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.0923805236816406
Epoch: 7, Steps: 13 | Train Loss: 1.178 Vali Loss: 2.589 Vali Acc: 0.722 Test Loss: 2.589 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.1131751537323
Epoch: 8, Steps: 13 | Train Loss: 0.820 Vali Loss: 0.987 Vali Acc: 0.732 Test Loss: 0.987 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.4855172634124756
Epoch: 9, Steps: 13 | Train Loss: 0.442 Vali Loss: 0.862 Vali Acc: 0.732 Test Loss: 0.862 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.267500400543213
Epoch: 10, Steps: 13 | Train Loss: 1.955 Vali Loss: 9.071 Vali Acc: 0.283 Test Loss: 9.071 Test Acc: 0.283
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.0557496547698975
Epoch: 11, Steps: 13 | Train Loss: 1.527 Vali Loss: 0.843 Vali Acc: 0.610 Test Loss: 0.843 Test Acc: 0.610
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.4140923023223877
Epoch: 12, Steps: 13 | Train Loss: 1.140 Vali Loss: 1.117 Vali Acc: 0.732 Test Loss: 1.117 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.838045120239258
Epoch: 13, Steps: 13 | Train Loss: 2.450 Vali Loss: 1.790 Vali Acc: 0.449 Test Loss: 1.790 Test Acc: 0.449
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.5497987270355225
Epoch: 14, Steps: 13 | Train Loss: 3.293 Vali Loss: 4.359 Vali Acc: 0.722 Test Loss: 4.359 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 1007770
model size : 5.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.187469959259033
Epoch: 1, Steps: 13 | Train Loss: 0.697 Vali Loss: 0.695 Vali Acc: 0.722 Test Loss: 0.695 Test Acc: 0.722
Validation loss decreased (inf --> -0.721944).  Saving model ...
Epoch: 2 cost time: 2.5493457317352295
Epoch: 2, Steps: 13 | Train Loss: 0.895 Vali Loss: 2.413 Vali Acc: 0.283 Test Loss: 2.413 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.298577070236206
Epoch: 3, Steps: 13 | Train Loss: 2.129 Vali Loss: 2.225 Vali Acc: 0.722 Test Loss: 2.225 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.5793869495391846
Epoch: 4, Steps: 13 | Train Loss: 2.660 Vali Loss: 1.077 Vali Acc: 0.722 Test Loss: 1.077 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.612605571746826
Epoch: 5, Steps: 13 | Train Loss: 1.826 Vali Loss: 0.624 Vali Acc: 0.698 Test Loss: 0.624 Test Acc: 0.698
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.298419713973999
Epoch: 6, Steps: 13 | Train Loss: 1.115 Vali Loss: 1.231 Vali Acc: 0.727 Test Loss: 1.231 Test Acc: 0.727
Validation loss decreased (-0.721944 --> -0.726817).  Saving model ...
Epoch: 7 cost time: 2.309905529022217
Epoch: 7, Steps: 13 | Train Loss: 0.742 Vali Loss: 0.554 Vali Acc: 0.712 Test Loss: 0.554 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.3630239963531494
Epoch: 8, Steps: 13 | Train Loss: 3.223 Vali Loss: 5.987 Vali Acc: 0.722 Test Loss: 5.987 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.108628749847412
Epoch: 9, Steps: 13 | Train Loss: 3.046 Vali Loss: 4.682 Vali Acc: 0.298 Test Loss: 4.682 Test Acc: 0.298
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.351083278656006
Epoch: 10, Steps: 13 | Train Loss: 1.516 Vali Loss: 3.437 Vali Acc: 0.322 Test Loss: 3.437 Test Acc: 0.322
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.812493324279785
Epoch: 11, Steps: 13 | Train Loss: 0.801 Vali Loss: 0.797 Vali Acc: 0.732 Test Loss: 0.797 Test Acc: 0.732
Validation loss decreased (-0.726817 --> -0.731699).  Saving model ...
Epoch: 12 cost time: 2.369018316268921
Epoch: 12, Steps: 13 | Train Loss: 0.233 Vali Loss: 2.166 Vali Acc: 0.722 Test Loss: 2.166 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.679541826248169
Epoch: 13, Steps: 13 | Train Loss: 2.533 Vali Loss: 1.964 Vali Acc: 0.356 Test Loss: 1.964 Test Acc: 0.356
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.5073256492614746
Epoch: 14, Steps: 13 | Train Loss: 1.078 Vali Loss: 1.081 Vali Acc: 0.751 Test Loss: 1.081 Test Acc: 0.751
Validation loss decreased (-0.731699 --> -0.751209).  Saving model ...
Epoch: 15 cost time: 2.2029314041137695
Epoch: 15, Steps: 13 | Train Loss: 1.224 Vali Loss: 3.100 Vali Acc: 0.727 Test Loss: 3.100 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.358382225036621
Epoch: 16, Steps: 13 | Train Loss: 0.436 Vali Loss: 0.941 Vali Acc: 0.678 Test Loss: 0.941 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.406430721282959
Epoch: 17, Steps: 13 | Train Loss: 1.151 Vali Loss: 1.947 Vali Acc: 0.732 Test Loss: 1.947 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.9766452312469482
Epoch: 18, Steps: 13 | Train Loss: 0.207 Vali Loss: 1.081 Vali Acc: 0.737 Test Loss: 1.081 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.38788104057312
Epoch: 19, Steps: 13 | Train Loss: 0.785 Vali Loss: 4.175 Vali Acc: 0.727 Test Loss: 4.175 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.8202497959136963
Epoch: 20, Steps: 13 | Train Loss: 3.941 Vali Loss: 4.073 Vali Acc: 0.429 Test Loss: 4.073 Test Acc: 0.429
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.521900177001953
Epoch: 21, Steps: 13 | Train Loss: 2.430 Vali Loss: 3.428 Vali Acc: 0.732 Test Loss: 3.428 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.421015977859497
Epoch: 22, Steps: 13 | Train Loss: 0.772 Vali Loss: 2.737 Vali Acc: 0.761 Test Loss: 2.737 Test Acc: 0.761
Validation loss decreased (-0.751209 --> -0.760948).  Saving model ...
Epoch: 23 cost time: 2.3296163082122803
Epoch: 23, Steps: 13 | Train Loss: 0.248 Vali Loss: 2.124 Vali Acc: 0.722 Test Loss: 2.124 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.511371374130249
Epoch: 24, Steps: 13 | Train Loss: 0.486 Vali Loss: 2.410 Vali Acc: 0.766 Test Loss: 2.410 Test Acc: 0.766
Validation loss decreased (-0.760948 --> -0.765830).  Saving model ...
Epoch: 25 cost time: 2.476086139678955
Epoch: 25, Steps: 13 | Train Loss: 1.817 Vali Loss: 1.833 Vali Acc: 0.673 Test Loss: 1.833 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.649425983428955
Epoch: 26, Steps: 13 | Train Loss: 0.474 Vali Loss: 8.678 Vali Acc: 0.332 Test Loss: 8.678 Test Acc: 0.332
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.568662405014038
Epoch: 27, Steps: 13 | Train Loss: 2.006 Vali Loss: 1.915 Vali Acc: 0.678 Test Loss: 1.915 Test Acc: 0.678
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.7356607913970947
Epoch: 28, Steps: 13 | Train Loss: 0.173 Vali Loss: 3.825 Vali Acc: 0.746 Test Loss: 3.825 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.5262200832366943
Epoch: 29, Steps: 13 | Train Loss: 0.305 Vali Loss: 3.786 Vali Acc: 0.766 Test Loss: 3.786 Test Acc: 0.766
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.7519896030426025
Epoch: 30, Steps: 13 | Train Loss: 0.137 Vali Loss: 2.509 Vali Acc: 0.590 Test Loss: 2.509 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.2953670024871826
Epoch: 31, Steps: 13 | Train Loss: 0.019 Vali Loss: 2.312 Vali Acc: 0.712 Test Loss: 2.312 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.3593719005584717
Epoch: 32, Steps: 13 | Train Loss: 0.286 Vali Loss: 2.283 Vali Acc: 0.698 Test Loss: 2.283 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.5588531494140625
Epoch: 33, Steps: 13 | Train Loss: 0.033 Vali Loss: 2.339 Vali Acc: 0.707 Test Loss: 2.339 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.367644786834717
Epoch: 34, Steps: 13 | Train Loss: 0.769 Vali Loss: 2.382 Vali Acc: 0.712 Test Loss: 2.382 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 1005594
model size : 5.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.9005160331726074
Epoch: 1, Steps: 13 | Train Loss: 0.675 Vali Loss: 0.882 Vali Acc: 0.722 Test Loss: 0.882 Test Acc: 0.722
Validation loss decreased (inf --> -0.721942).  Saving model ...
Epoch: 2 cost time: 2.1827361583709717
Epoch: 2, Steps: 13 | Train Loss: 0.761 Vali Loss: 1.063 Vali Acc: 0.712 Test Loss: 1.063 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.299083948135376
Epoch: 3, Steps: 13 | Train Loss: 0.737 Vali Loss: 0.872 Vali Acc: 0.722 Test Loss: 0.872 Test Acc: 0.722
Validation loss decreased (-0.721942 --> -0.721942).  Saving model ...
Epoch: 4 cost time: 1.9502537250518799
Epoch: 4, Steps: 13 | Train Loss: 0.937 Vali Loss: 0.877 Vali Acc: 0.420 Test Loss: 0.877 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5042178630828857
Epoch: 5, Steps: 13 | Train Loss: 0.719 Vali Loss: 2.518 Vali Acc: 0.288 Test Loss: 2.518 Test Acc: 0.288
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.6883606910705566
Epoch: 6, Steps: 13 | Train Loss: 0.861 Vali Loss: 0.714 Vali Acc: 0.737 Test Loss: 0.714 Test Acc: 0.737
Validation loss decreased (-0.721942 --> -0.736578).  Saving model ...
Epoch: 7 cost time: 2.602902412414551
Epoch: 7, Steps: 13 | Train Loss: 0.493 Vali Loss: 3.280 Vali Acc: 0.293 Test Loss: 3.280 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.3929455280303955
Epoch: 8, Steps: 13 | Train Loss: 0.884 Vali Loss: 1.750 Vali Acc: 0.722 Test Loss: 1.750 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.439695358276367
Epoch: 9, Steps: 13 | Train Loss: 1.404 Vali Loss: 1.365 Vali Acc: 0.727 Test Loss: 1.365 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.046881675720215
Epoch: 10, Steps: 13 | Train Loss: 0.862 Vali Loss: 0.710 Vali Acc: 0.741 Test Loss: 0.710 Test Acc: 0.741
Validation loss decreased (-0.736578 --> -0.741456).  Saving model ...
Epoch: 11 cost time: 2.3786280155181885
Epoch: 11, Steps: 13 | Train Loss: 3.885 Vali Loss: 8.598 Vali Acc: 0.288 Test Loss: 8.598 Test Acc: 0.288
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.471379041671753
Epoch: 12, Steps: 13 | Train Loss: 3.632 Vali Loss: 4.841 Vali Acc: 0.717 Test Loss: 4.841 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.1005496978759766
Epoch: 13, Steps: 13 | Train Loss: 1.159 Vali Loss: 2.093 Vali Acc: 0.737 Test Loss: 2.093 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.364344358444214
Epoch: 14, Steps: 13 | Train Loss: 0.916 Vali Loss: 1.195 Vali Acc: 0.546 Test Loss: 1.195 Test Acc: 0.546
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.5083565711975098
Epoch: 15, Steps: 13 | Train Loss: 0.708 Vali Loss: 1.648 Vali Acc: 0.532 Test Loss: 1.648 Test Acc: 0.532
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.4977478981018066
Epoch: 16, Steps: 13 | Train Loss: 0.531 Vali Loss: 1.052 Vali Acc: 0.698 Test Loss: 1.052 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.3839123249053955
Epoch: 17, Steps: 13 | Train Loss: 0.459 Vali Loss: 1.014 Vali Acc: 0.717 Test Loss: 1.014 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.3725881576538086
Epoch: 18, Steps: 13 | Train Loss: 2.039 Vali Loss: 7.547 Vali Acc: 0.298 Test Loss: 7.547 Test Acc: 0.298
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.51263427734375
Epoch: 19, Steps: 13 | Train Loss: 6.202 Vali Loss: 22.583 Vali Acc: 0.283 Test Loss: 22.583 Test Acc: 0.283
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.0625782012939453
Epoch: 20, Steps: 13 | Train Loss: 5.249 Vali Loss: 2.392 Vali Acc: 0.766 Test Loss: 2.392 Test Acc: 0.766
Validation loss decreased (-0.741456 --> -0.765830).  Saving model ...
Epoch: 21 cost time: 2.3843307495117188
Epoch: 21, Steps: 13 | Train Loss: 1.305 Vali Loss: 2.458 Vali Acc: 0.756 Test Loss: 2.458 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.391488552093506
Epoch: 22, Steps: 13 | Train Loss: 2.002 Vali Loss: 2.374 Vali Acc: 0.756 Test Loss: 2.374 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.9687795639038086
Epoch: 23, Steps: 13 | Train Loss: 0.404 Vali Loss: 1.714 Vali Acc: 0.654 Test Loss: 1.714 Test Acc: 0.654
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.34635853767395
Epoch: 24, Steps: 13 | Train Loss: 0.148 Vali Loss: 2.354 Vali Acc: 0.527 Test Loss: 2.354 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.0184075832366943
Epoch: 25, Steps: 13 | Train Loss: 0.150 Vali Loss: 2.704 Vali Acc: 0.751 Test Loss: 2.704 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.3690407276153564
Epoch: 26, Steps: 13 | Train Loss: 0.102 Vali Loss: 2.152 Vali Acc: 0.741 Test Loss: 2.152 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.3197333812713623
Epoch: 27, Steps: 13 | Train Loss: 0.733 Vali Loss: 3.589 Vali Acc: 0.737 Test Loss: 3.589 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.4997050762176514
Epoch: 28, Steps: 13 | Train Loss: 0.195 Vali Loss: 2.282 Vali Acc: 0.639 Test Loss: 2.282 Test Acc: 0.639
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.1691203117370605
Epoch: 29, Steps: 13 | Train Loss: 0.090 Vali Loss: 2.560 Vali Acc: 0.561 Test Loss: 2.560 Test Acc: 0.561
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.9489834308624268
Epoch: 30, Steps: 13 | Train Loss: 0.160 Vali Loss: 2.459 Vali Acc: 0.654 Test Loss: 2.459 Test Acc: 0.654
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 1003418
model size : 5.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.1920082569122314
Epoch: 1, Steps: 13 | Train Loss: 0.694 Vali Loss: 0.655 Vali Acc: 0.712 Test Loss: 0.655 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 1.8435134887695312
Epoch: 2, Steps: 13 | Train Loss: 0.649 Vali Loss: 1.010 Vali Acc: 0.722 Test Loss: 1.010 Test Acc: 0.722
Validation loss decreased (-0.712189 --> -0.721941).  Saving model ...
Epoch: 3 cost time: 1.8352406024932861
Epoch: 3, Steps: 13 | Train Loss: 0.676 Vali Loss: 1.336 Vali Acc: 0.298 Test Loss: 1.336 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9050500392913818
Epoch: 4, Steps: 13 | Train Loss: 1.834 Vali Loss: 1.526 Vali Acc: 0.712 Test Loss: 1.526 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9009921550750732
Epoch: 5, Steps: 13 | Train Loss: 2.960 Vali Loss: 4.657 Vali Acc: 0.283 Test Loss: 4.657 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.2086148262023926
Epoch: 6, Steps: 13 | Train Loss: 1.701 Vali Loss: 1.855 Vali Acc: 0.722 Test Loss: 1.855 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.9981088638305664
Epoch: 7, Steps: 13 | Train Loss: 2.182 Vali Loss: 1.298 Vali Acc: 0.400 Test Loss: 1.298 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.715742826461792
Epoch: 8, Steps: 13 | Train Loss: 0.569 Vali Loss: 0.705 Vali Acc: 0.746 Test Loss: 0.705 Test Acc: 0.746
Validation loss decreased (-0.721941 --> -0.746334).  Saving model ...
Epoch: 9 cost time: 1.9834678173065186
Epoch: 9, Steps: 13 | Train Loss: 0.834 Vali Loss: 1.264 Vali Acc: 0.727 Test Loss: 1.264 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.192533493041992
Epoch: 10, Steps: 13 | Train Loss: 1.064 Vali Loss: 0.894 Vali Acc: 0.620 Test Loss: 0.894 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.3838205337524414
Epoch: 11, Steps: 13 | Train Loss: 1.216 Vali Loss: 3.939 Vali Acc: 0.302 Test Loss: 3.939 Test Acc: 0.302
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.4029808044433594
Epoch: 12, Steps: 13 | Train Loss: 1.085 Vali Loss: 0.754 Vali Acc: 0.707 Test Loss: 0.754 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.367017984390259
Epoch: 13, Steps: 13 | Train Loss: 0.591 Vali Loss: 0.760 Vali Acc: 0.702 Test Loss: 0.760 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.272026538848877
Epoch: 14, Steps: 13 | Train Loss: 4.696 Vali Loss: 11.464 Vali Acc: 0.278 Test Loss: 11.464 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.1033921241760254
Epoch: 15, Steps: 13 | Train Loss: 4.175 Vali Loss: 5.584 Vali Acc: 0.717 Test Loss: 5.584 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.475935220718384
Epoch: 16, Steps: 13 | Train Loss: 3.036 Vali Loss: 5.723 Vali Acc: 0.376 Test Loss: 5.723 Test Acc: 0.376
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.3465158939361572
Epoch: 17, Steps: 13 | Train Loss: 0.648 Vali Loss: 1.647 Vali Acc: 0.537 Test Loss: 1.647 Test Acc: 0.537
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.966801404953003
Epoch: 18, Steps: 13 | Train Loss: 0.839 Vali Loss: 2.117 Vali Acc: 0.746 Test Loss: 2.117 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 1001242
model size : 5.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.9163215160369873
Epoch: 1, Steps: 13 | Train Loss: 0.958 Vali Loss: 0.620 Vali Acc: 0.712 Test Loss: 0.620 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 2.5386509895324707
Epoch: 2, Steps: 13 | Train Loss: 1.464 Vali Loss: 1.367 Vali Acc: 0.722 Test Loss: 1.367 Test Acc: 0.722
Validation loss decreased (-0.712189 --> -0.721938).  Saving model ...
Epoch: 3 cost time: 2.6113150119781494
Epoch: 3, Steps: 13 | Train Loss: 1.205 Vali Loss: 0.679 Vali Acc: 0.727 Test Loss: 0.679 Test Acc: 0.727
Validation loss decreased (-0.721938 --> -0.726822).  Saving model ...
Epoch: 4 cost time: 2.3712692260742188
Epoch: 4, Steps: 13 | Train Loss: 0.731 Vali Loss: 0.665 Vali Acc: 0.732 Test Loss: 0.665 Test Acc: 0.732
Validation loss decreased (-0.726822 --> -0.731701).  Saving model ...
Epoch: 5 cost time: 2.49658203125
Epoch: 5, Steps: 13 | Train Loss: 0.670 Vali Loss: 0.704 Vali Acc: 0.741 Test Loss: 0.704 Test Acc: 0.741
Validation loss decreased (-0.731701 --> -0.741456).  Saving model ...
Epoch: 6 cost time: 2.61796498298645
Epoch: 6, Steps: 13 | Train Loss: 1.861 Vali Loss: 1.259 Vali Acc: 0.722 Test Loss: 1.259 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.7603797912597656
Epoch: 7, Steps: 13 | Train Loss: 1.931 Vali Loss: 5.782 Vali Acc: 0.278 Test Loss: 5.782 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.208411455154419
Epoch: 8, Steps: 13 | Train Loss: 2.198 Vali Loss: 3.480 Vali Acc: 0.722 Test Loss: 3.480 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.4400370121002197
Epoch: 9, Steps: 13 | Train Loss: 1.211 Vali Loss: 4.375 Vali Acc: 0.302 Test Loss: 4.375 Test Acc: 0.302
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.464923620223999
Epoch: 10, Steps: 13 | Train Loss: 0.923 Vali Loss: 2.135 Vali Acc: 0.356 Test Loss: 2.135 Test Acc: 0.356
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.1190383434295654
Epoch: 11, Steps: 13 | Train Loss: 1.713 Vali Loss: 1.246 Vali Acc: 0.741 Test Loss: 1.246 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.5381276607513428
Epoch: 12, Steps: 13 | Train Loss: 2.245 Vali Loss: 4.678 Vali Acc: 0.302 Test Loss: 4.678 Test Acc: 0.302
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.2890336513519287
Epoch: 13, Steps: 13 | Train Loss: 2.738 Vali Loss: 2.984 Vali Acc: 0.380 Test Loss: 2.984 Test Acc: 0.380
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.3637940883636475
Epoch: 14, Steps: 13 | Train Loss: 2.023 Vali Loss: 0.855 Vali Acc: 0.732 Test Loss: 0.855 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.2531704902648926
Epoch: 15, Steps: 13 | Train Loss: 1.648 Vali Loss: 6.695 Vali Acc: 0.722 Test Loss: 6.695 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 809626
model size : 4.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.637544393539429
Epoch: 1, Steps: 13 | Train Loss: 1.043 Vali Loss: 0.822 Vali Acc: 0.712 Test Loss: 0.822 Test Acc: 0.712
Validation loss decreased (inf --> -0.712187).  Saving model ...
Epoch: 2 cost time: 2.4671783447265625
Epoch: 2, Steps: 13 | Train Loss: 1.200 Vali Loss: 1.722 Vali Acc: 0.278 Test Loss: 1.722 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.1790342330932617
Epoch: 3, Steps: 13 | Train Loss: 0.876 Vali Loss: 1.622 Vali Acc: 0.722 Test Loss: 1.622 Test Acc: 0.722
Validation loss decreased (-0.712187 --> -0.721935).  Saving model ...
Epoch: 4 cost time: 1.860236406326294
Epoch: 4, Steps: 13 | Train Loss: 0.840 Vali Loss: 0.678 Vali Acc: 0.727 Test Loss: 0.678 Test Acc: 0.727
Validation loss decreased (-0.721935 --> -0.726822).  Saving model ...
Epoch: 5 cost time: 1.9270594120025635
Epoch: 5, Steps: 13 | Train Loss: 0.575 Vali Loss: 0.814 Vali Acc: 0.727 Test Loss: 0.814 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.2466723918914795
Epoch: 6, Steps: 13 | Train Loss: 0.603 Vali Loss: 0.865 Vali Acc: 0.732 Test Loss: 0.865 Test Acc: 0.732
Validation loss decreased (-0.726822 --> -0.731699).  Saving model ...
Epoch: 7 cost time: 2.3048508167266846
Epoch: 7, Steps: 13 | Train Loss: 0.845 Vali Loss: 0.863 Vali Acc: 0.566 Test Loss: 0.863 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.270045280456543
Epoch: 8, Steps: 13 | Train Loss: 1.155 Vali Loss: 2.284 Vali Acc: 0.722 Test Loss: 2.284 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.716855049133301
Epoch: 9, Steps: 13 | Train Loss: 2.193 Vali Loss: 0.879 Vali Acc: 0.766 Test Loss: 0.879 Test Acc: 0.766
Validation loss decreased (-0.731699 --> -0.765845).  Saving model ...
Epoch: 10 cost time: 2.842163562774658
Epoch: 10, Steps: 13 | Train Loss: 0.692 Vali Loss: 1.882 Vali Acc: 0.727 Test Loss: 1.882 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.807612180709839
Epoch: 11, Steps: 13 | Train Loss: 1.238 Vali Loss: 5.095 Vali Acc: 0.278 Test Loss: 5.095 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.8600006103515625
Epoch: 12, Steps: 13 | Train Loss: 1.481 Vali Loss: 0.735 Vali Acc: 0.707 Test Loss: 0.735 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.6952707767486572
Epoch: 13, Steps: 13 | Train Loss: 1.372 Vali Loss: 2.190 Vali Acc: 0.727 Test Loss: 2.190 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.6208620071411133
Epoch: 14, Steps: 13 | Train Loss: 2.334 Vali Loss: 3.029 Vali Acc: 0.727 Test Loss: 3.029 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.2002322673797607
Epoch: 15, Steps: 13 | Train Loss: 2.173 Vali Loss: 7.891 Vali Acc: 0.288 Test Loss: 7.891 Test Acc: 0.288
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.227022409439087
Epoch: 16, Steps: 13 | Train Loss: 1.464 Vali Loss: 1.840 Vali Acc: 0.493 Test Loss: 1.840 Test Acc: 0.493
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.4552407264709473
Epoch: 17, Steps: 13 | Train Loss: 1.651 Vali Loss: 3.197 Vali Acc: 0.405 Test Loss: 3.197 Test Acc: 0.405
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.269670248031616
Epoch: 18, Steps: 13 | Train Loss: 0.463 Vali Loss: 1.616 Vali Acc: 0.751 Test Loss: 1.616 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.2832190990448
Epoch: 19, Steps: 13 | Train Loss: 0.320 Vali Loss: 1.232 Vali Acc: 0.585 Test Loss: 1.232 Test Acc: 0.585
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 807450
model size : 4.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.10826849937439
Epoch: 1, Steps: 13 | Train Loss: 0.977 Vali Loss: 0.697 Vali Acc: 0.722 Test Loss: 0.697 Test Acc: 0.722
Validation loss decreased (inf --> -0.721944).  Saving model ...
Epoch: 2 cost time: 2.2535932064056396
Epoch: 2, Steps: 13 | Train Loss: 0.644 Vali Loss: 1.122 Vali Acc: 0.722 Test Loss: 1.122 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2209055423736572
Epoch: 3, Steps: 13 | Train Loss: 0.922 Vali Loss: 1.239 Vali Acc: 0.722 Test Loss: 1.239 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.64605450630188
Epoch: 4, Steps: 13 | Train Loss: 0.792 Vali Loss: 1.122 Vali Acc: 0.722 Test Loss: 1.122 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.096346616744995
Epoch: 5, Steps: 13 | Train Loss: 0.820 Vali Loss: 2.773 Vali Acc: 0.288 Test Loss: 2.773 Test Acc: 0.288
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.1773312091827393
Epoch: 6, Steps: 13 | Train Loss: 1.403 Vali Loss: 1.105 Vali Acc: 0.415 Test Loss: 1.105 Test Acc: 0.415
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.292928457260132
Epoch: 7, Steps: 13 | Train Loss: 0.625 Vali Loss: 0.684 Vali Acc: 0.624 Test Loss: 0.684 Test Acc: 0.624
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.7838311195373535
Epoch: 8, Steps: 13 | Train Loss: 0.546 Vali Loss: 1.153 Vali Acc: 0.727 Test Loss: 1.153 Test Acc: 0.727
Validation loss decreased (-0.721944 --> -0.726818).  Saving model ...
Epoch: 9 cost time: 2.4382293224334717
Epoch: 9, Steps: 13 | Train Loss: 1.321 Vali Loss: 2.048 Vali Acc: 0.337 Test Loss: 2.048 Test Acc: 0.337
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.4983785152435303
Epoch: 10, Steps: 13 | Train Loss: 1.215 Vali Loss: 1.847 Vali Acc: 0.405 Test Loss: 1.847 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.98935604095459
Epoch: 11, Steps: 13 | Train Loss: 1.038 Vali Loss: 0.964 Vali Acc: 0.590 Test Loss: 0.964 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.5232789516448975
Epoch: 12, Steps: 13 | Train Loss: 0.862 Vali Loss: 2.124 Vali Acc: 0.727 Test Loss: 2.124 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.3846750259399414
Epoch: 13, Steps: 13 | Train Loss: 0.931 Vali Loss: 2.178 Vali Acc: 0.722 Test Loss: 2.178 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.395486354827881
Epoch: 14, Steps: 13 | Train Loss: 0.782 Vali Loss: 0.870 Vali Acc: 0.727 Test Loss: 0.870 Test Acc: 0.727
Validation loss decreased (-0.726818 --> -0.726821).  Saving model ...
Epoch: 15 cost time: 2.4174013137817383
Epoch: 15, Steps: 13 | Train Loss: 2.839 Vali Loss: 2.490 Vali Acc: 0.722 Test Loss: 2.490 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.3779592514038086
Epoch: 16, Steps: 13 | Train Loss: 0.516 Vali Loss: 1.014 Vali Acc: 0.654 Test Loss: 1.014 Test Acc: 0.654
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.064211130142212
Epoch: 17, Steps: 13 | Train Loss: 3.317 Vali Loss: 4.536 Vali Acc: 0.722 Test Loss: 4.536 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.0722384452819824
Epoch: 18, Steps: 13 | Train Loss: 4.056 Vali Loss: 9.544 Vali Acc: 0.302 Test Loss: 9.544 Test Acc: 0.302
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.1251158714294434
Epoch: 19, Steps: 13 | Train Loss: 1.647 Vali Loss: 2.042 Vali Acc: 0.766 Test Loss: 2.042 Test Acc: 0.766
Validation loss decreased (-0.726821 --> -0.765833).  Saving model ...
Epoch: 20 cost time: 2.016040563583374
Epoch: 20, Steps: 13 | Train Loss: 0.737 Vali Loss: 1.473 Vali Acc: 0.659 Test Loss: 1.473 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.3372344970703125
Epoch: 21, Steps: 13 | Train Loss: 0.532 Vali Loss: 4.315 Vali Acc: 0.400 Test Loss: 4.315 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.1241612434387207
Epoch: 22, Steps: 13 | Train Loss: 0.762 Vali Loss: 2.541 Vali Acc: 0.541 Test Loss: 2.541 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.9916906356811523
Epoch: 23, Steps: 13 | Train Loss: 0.467 Vali Loss: 1.552 Vali Acc: 0.693 Test Loss: 1.552 Test Acc: 0.693
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.2916324138641357
Epoch: 24, Steps: 13 | Train Loss: 0.304 Vali Loss: 1.914 Vali Acc: 0.761 Test Loss: 1.914 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.9726154804229736
Epoch: 25, Steps: 13 | Train Loss: 0.417 Vali Loss: 2.040 Vali Acc: 0.751 Test Loss: 2.040 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.3335726261138916
Epoch: 26, Steps: 13 | Train Loss: 2.002 Vali Loss: 5.703 Vali Acc: 0.732 Test Loss: 5.703 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.1343088150024414
Epoch: 27, Steps: 13 | Train Loss: 1.166 Vali Loss: 6.658 Vali Acc: 0.405 Test Loss: 6.658 Test Acc: 0.405
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.4502928256988525
Epoch: 28, Steps: 13 | Train Loss: 1.076 Vali Loss: 4.180 Vali Acc: 0.766 Test Loss: 4.180 Test Acc: 0.766
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.10579252243042
Epoch: 29, Steps: 13 | Train Loss: 1.524 Vali Loss: 2.475 Vali Acc: 0.693 Test Loss: 2.475 Test Acc: 0.693
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 805274
model size : 4.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.994029998779297
Epoch: 1, Steps: 13 | Train Loss: 0.714 Vali Loss: 0.583 Vali Acc: 0.722 Test Loss: 0.583 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.1893324851989746
Epoch: 2, Steps: 13 | Train Loss: 0.802 Vali Loss: 0.879 Vali Acc: 0.722 Test Loss: 0.879 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9592273235321045
Epoch: 3, Steps: 13 | Train Loss: 1.335 Vali Loss: 1.207 Vali Acc: 0.717 Test Loss: 1.207 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.05602765083313
Epoch: 4, Steps: 13 | Train Loss: 1.525 Vali Loss: 2.809 Vali Acc: 0.278 Test Loss: 2.809 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.241732597351074
Epoch: 5, Steps: 13 | Train Loss: 1.143 Vali Loss: 0.624 Vali Acc: 0.673 Test Loss: 0.624 Test Acc: 0.673
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.2353014945983887
Epoch: 6, Steps: 13 | Train Loss: 0.625 Vali Loss: 1.485 Vali Acc: 0.346 Test Loss: 1.485 Test Acc: 0.346
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.077726364135742
Epoch: 7, Steps: 13 | Train Loss: 0.622 Vali Loss: 1.106 Vali Acc: 0.722 Test Loss: 1.106 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.408308744430542
Epoch: 8, Steps: 13 | Train Loss: 0.925 Vali Loss: 1.025 Vali Acc: 0.444 Test Loss: 1.025 Test Acc: 0.444
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.239640235900879
Epoch: 9, Steps: 13 | Train Loss: 2.476 Vali Loss: 0.689 Vali Acc: 0.673 Test Loss: 0.689 Test Acc: 0.673
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.0998947620391846
Epoch: 10, Steps: 13 | Train Loss: 0.617 Vali Loss: 2.475 Vali Acc: 0.722 Test Loss: 2.475 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.1828079223632812
Epoch: 11, Steps: 13 | Train Loss: 1.197 Vali Loss: 1.556 Vali Acc: 0.727 Test Loss: 1.556 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726814).  Saving model ...
Epoch: 12 cost time: 2.1148104667663574
Epoch: 12, Steps: 13 | Train Loss: 0.913 Vali Loss: 0.751 Vali Acc: 0.717 Test Loss: 0.751 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9362611770629883
Epoch: 13, Steps: 13 | Train Loss: 0.580 Vali Loss: 1.939 Vali Acc: 0.371 Test Loss: 1.939 Test Acc: 0.371
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.2314579486846924
Epoch: 14, Steps: 13 | Train Loss: 1.008 Vali Loss: 1.562 Vali Acc: 0.727 Test Loss: 1.562 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.3884103298187256
Epoch: 15, Steps: 13 | Train Loss: 3.499 Vali Loss: 1.910 Vali Acc: 0.732 Test Loss: 1.910 Test Acc: 0.732
Validation loss decreased (-0.726814 --> -0.731688).  Saving model ...
Epoch: 16 cost time: 1.5846223831176758
Epoch: 16, Steps: 13 | Train Loss: 1.974 Vali Loss: 5.236 Vali Acc: 0.302 Test Loss: 5.236 Test Acc: 0.302
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9695255756378174
Epoch: 17, Steps: 13 | Train Loss: 0.907 Vali Loss: 1.338 Vali Acc: 0.771 Test Loss: 1.338 Test Acc: 0.771
Validation loss decreased (-0.731688 --> -0.770718).  Saving model ...
Epoch: 18 cost time: 2.1692416667938232
Epoch: 18, Steps: 13 | Train Loss: 1.419 Vali Loss: 1.493 Vali Acc: 0.556 Test Loss: 1.493 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.9424066543579102
Epoch: 19, Steps: 13 | Train Loss: 3.074 Vali Loss: 1.102 Vali Acc: 0.698 Test Loss: 1.102 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.0110116004943848
Epoch: 20, Steps: 13 | Train Loss: 2.730 Vali Loss: 1.934 Vali Acc: 0.766 Test Loss: 1.934 Test Acc: 0.766
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.2201013565063477
Epoch: 21, Steps: 13 | Train Loss: 0.692 Vali Loss: 1.280 Vali Acc: 0.649 Test Loss: 1.280 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.9979619979858398
Epoch: 22, Steps: 13 | Train Loss: 2.766 Vali Loss: 6.796 Vali Acc: 0.327 Test Loss: 6.796 Test Acc: 0.327
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.005479335784912
Epoch: 23, Steps: 13 | Train Loss: 1.131 Vali Loss: 5.761 Vali Acc: 0.376 Test Loss: 5.761 Test Acc: 0.376
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.104865789413452
Epoch: 24, Steps: 13 | Train Loss: 1.207 Vali Loss: 1.645 Vali Acc: 0.722 Test Loss: 1.645 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.2490038871765137
Epoch: 25, Steps: 13 | Train Loss: 0.277 Vali Loss: 1.679 Vali Acc: 0.712 Test Loss: 1.679 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.9649133682250977
Epoch: 26, Steps: 13 | Train Loss: 0.206 Vali Loss: 1.911 Vali Acc: 0.727 Test Loss: 1.911 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.8250279426574707
Epoch: 27, Steps: 13 | Train Loss: 0.090 Vali Loss: 1.667 Vali Acc: 0.707 Test Loss: 1.667 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 803098
model size : 4.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.386179208755493
Epoch: 1, Steps: 13 | Train Loss: 0.889 Vali Loss: 2.049 Vali Acc: 0.288 Test Loss: 2.049 Test Acc: 0.288
Validation loss decreased (inf --> -0.287784).  Saving model ...
Epoch: 2 cost time: 2.2668654918670654
Epoch: 2, Steps: 13 | Train Loss: 1.371 Vali Loss: 1.402 Vali Acc: 0.722 Test Loss: 1.402 Test Acc: 0.722
Validation loss decreased (-0.287784 --> -0.721937).  Saving model ...
Epoch: 3 cost time: 2.0196826457977295
Epoch: 3, Steps: 13 | Train Loss: 1.567 Vali Loss: 0.553 Vali Acc: 0.756 Test Loss: 0.553 Test Acc: 0.756
Validation loss decreased (-0.721937 --> -0.756092).  Saving model ...
Epoch: 4 cost time: 2.23471736907959
Epoch: 4, Steps: 13 | Train Loss: 0.952 Vali Loss: 0.930 Vali Acc: 0.717 Test Loss: 0.930 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2109968662261963
Epoch: 5, Steps: 13 | Train Loss: 0.511 Vali Loss: 1.298 Vali Acc: 0.722 Test Loss: 1.298 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.507836103439331
Epoch: 6, Steps: 13 | Train Loss: 0.954 Vali Loss: 0.604 Vali Acc: 0.702 Test Loss: 0.604 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.1430022716522217
Epoch: 7, Steps: 13 | Train Loss: 0.657 Vali Loss: 1.393 Vali Acc: 0.722 Test Loss: 1.393 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.420222759246826
Epoch: 8, Steps: 13 | Train Loss: 0.677 Vali Loss: 0.776 Vali Acc: 0.727 Test Loss: 0.776 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.2885730266571045
Epoch: 9, Steps: 13 | Train Loss: 0.535 Vali Loss: 0.589 Vali Acc: 0.746 Test Loss: 0.589 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.2405643463134766
Epoch: 10, Steps: 13 | Train Loss: 0.285 Vali Loss: 0.606 Vali Acc: 0.722 Test Loss: 0.606 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.3590123653411865
Epoch: 11, Steps: 13 | Train Loss: 1.326 Vali Loss: 9.600 Vali Acc: 0.288 Test Loss: 9.600 Test Acc: 0.288
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.6397769451141357
Epoch: 12, Steps: 13 | Train Loss: 1.684 Vali Loss: 0.845 Vali Acc: 0.741 Test Loss: 0.845 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.158792495727539
Epoch: 13, Steps: 13 | Train Loss: 1.590 Vali Loss: 0.713 Vali Acc: 0.693 Test Loss: 0.713 Test Acc: 0.693
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 710554
model size : 4.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.852823257446289
Epoch: 1, Steps: 13 | Train Loss: 0.815 Vali Loss: 1.578 Vali Acc: 0.278 Test Loss: 1.578 Test Acc: 0.278
Validation loss decreased (inf --> -0.278033).  Saving model ...
Epoch: 2 cost time: 2.3298234939575195
Epoch: 2, Steps: 13 | Train Loss: 1.349 Vali Loss: 2.029 Vali Acc: 0.717 Test Loss: 2.029 Test Acc: 0.717
Validation loss decreased (-0.278033 --> -0.717053).  Saving model ...
Epoch: 3 cost time: 2.2215147018432617
Epoch: 3, Steps: 13 | Train Loss: 1.008 Vali Loss: 1.500 Vali Acc: 0.293 Test Loss: 1.500 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0275206565856934
Epoch: 4, Steps: 13 | Train Loss: 1.467 Vali Loss: 3.207 Vali Acc: 0.722 Test Loss: 3.207 Test Acc: 0.722
Validation loss decreased (-0.717053 --> -0.721919).  Saving model ...
Epoch: 5 cost time: 2.0307953357696533
Epoch: 5, Steps: 13 | Train Loss: 2.753 Vali Loss: 6.144 Vali Acc: 0.283 Test Loss: 6.144 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.2909841537475586
Epoch: 6, Steps: 13 | Train Loss: 4.184 Vali Loss: 0.588 Vali Acc: 0.707 Test Loss: 0.588 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8884871006011963
Epoch: 7, Steps: 13 | Train Loss: 2.456 Vali Loss: 2.600 Vali Acc: 0.722 Test Loss: 2.600 Test Acc: 0.722
Validation loss decreased (-0.721919 --> -0.721925).  Saving model ...
Epoch: 8 cost time: 1.9095206260681152
Epoch: 8, Steps: 13 | Train Loss: 3.538 Vali Loss: 0.759 Vali Acc: 0.624 Test Loss: 0.759 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.2266147136688232
Epoch: 9, Steps: 13 | Train Loss: 1.227 Vali Loss: 1.356 Vali Acc: 0.732 Test Loss: 1.356 Test Acc: 0.732
Validation loss decreased (-0.721925 --> -0.731694).  Saving model ...
Epoch: 10 cost time: 2.1150527000427246
Epoch: 10, Steps: 13 | Train Loss: 0.964 Vali Loss: 0.716 Vali Acc: 0.761 Test Loss: 0.716 Test Acc: 0.761
Validation loss decreased (-0.731694 --> -0.760968).  Saving model ...
Epoch: 11 cost time: 2.1110188961029053
Epoch: 11, Steps: 13 | Train Loss: 1.390 Vali Loss: 2.078 Vali Acc: 0.727 Test Loss: 2.078 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.0393404960632324
Epoch: 12, Steps: 13 | Train Loss: 2.130 Vali Loss: 4.682 Vali Acc: 0.317 Test Loss: 4.682 Test Acc: 0.317
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.1337356567382812
Epoch: 13, Steps: 13 | Train Loss: 2.422 Vali Loss: 1.806 Vali Acc: 0.727 Test Loss: 1.806 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.0039479732513428
Epoch: 14, Steps: 13 | Train Loss: 1.821 Vali Loss: 5.476 Vali Acc: 0.722 Test Loss: 5.476 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.9222748279571533
Epoch: 15, Steps: 13 | Train Loss: 5.356 Vali Loss: 2.507 Vali Acc: 0.380 Test Loss: 2.507 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.0204825401306152
Epoch: 16, Steps: 13 | Train Loss: 1.030 Vali Loss: 1.538 Vali Acc: 0.522 Test Loss: 1.538 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.066485643386841
Epoch: 17, Steps: 13 | Train Loss: 0.716 Vali Loss: 1.147 Vali Acc: 0.746 Test Loss: 1.147 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.0824177265167236
Epoch: 18, Steps: 13 | Train Loss: 1.239 Vali Loss: 1.048 Vali Acc: 0.737 Test Loss: 1.048 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.971717357635498
Epoch: 19, Steps: 13 | Train Loss: 0.345 Vali Loss: 1.098 Vali Acc: 0.659 Test Loss: 1.098 Test Acc: 0.659
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.401733636856079
Epoch: 20, Steps: 13 | Train Loss: 5.372 Vali Loss: 12.480 Vali Acc: 0.283 Test Loss: 12.480 Test Acc: 0.283
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 708378
model size : 3.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.8656978607177734
Epoch: 1, Steps: 13 | Train Loss: 0.767 Vali Loss: 0.601 Vali Acc: 0.737 Test Loss: 0.601 Test Acc: 0.737
Validation loss decreased (inf --> -0.736579).  Saving model ...
Epoch: 2 cost time: 2.280299425125122
Epoch: 2, Steps: 13 | Train Loss: 0.758 Vali Loss: 0.542 Vali Acc: 0.761 Test Loss: 0.542 Test Acc: 0.761
Validation loss decreased (-0.736579 --> -0.760970).  Saving model ...
Epoch: 3 cost time: 2.3187472820281982
Epoch: 3, Steps: 13 | Train Loss: 0.746 Vali Loss: 2.631 Vali Acc: 0.283 Test Loss: 2.631 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8462672233581543
Epoch: 4, Steps: 13 | Train Loss: 1.451 Vali Loss: 0.596 Vali Acc: 0.741 Test Loss: 0.596 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7411572933197021
Epoch: 5, Steps: 13 | Train Loss: 1.267 Vali Loss: 1.908 Vali Acc: 0.717 Test Loss: 1.908 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.697638750076294
Epoch: 6, Steps: 13 | Train Loss: 2.737 Vali Loss: 8.649 Vali Acc: 0.288 Test Loss: 8.649 Test Acc: 0.288
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.1348040103912354
Epoch: 7, Steps: 13 | Train Loss: 3.421 Vali Loss: 1.563 Vali Acc: 0.722 Test Loss: 1.563 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.2265689373016357
Epoch: 8, Steps: 13 | Train Loss: 0.707 Vali Loss: 0.546 Vali Acc: 0.717 Test Loss: 0.546 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.184723377227783
Epoch: 9, Steps: 13 | Train Loss: 0.509 Vali Loss: 0.684 Vali Acc: 0.634 Test Loss: 0.684 Test Acc: 0.634
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.051988363265991
Epoch: 10, Steps: 13 | Train Loss: 0.561 Vali Loss: 0.746 Vali Acc: 0.629 Test Loss: 0.746 Test Acc: 0.629
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.168818950653076
Epoch: 11, Steps: 13 | Train Loss: 1.228 Vali Loss: 9.159 Vali Acc: 0.283 Test Loss: 9.159 Test Acc: 0.283
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.8824818134307861
Epoch: 12, Steps: 13 | Train Loss: 3.312 Vali Loss: 4.822 Vali Acc: 0.722 Test Loss: 4.822 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 706202
model size : 3.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.8792219161987305
Epoch: 1, Steps: 13 | Train Loss: 0.719 Vali Loss: 0.928 Vali Acc: 0.712 Test Loss: 0.928 Test Acc: 0.712
Validation loss decreased (inf --> -0.712186).  Saving model ...
Epoch: 2 cost time: 2.0240705013275146
Epoch: 2, Steps: 13 | Train Loss: 0.948 Vali Loss: 0.937 Vali Acc: 0.312 Test Loss: 0.937 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.096297264099121
Epoch: 3, Steps: 13 | Train Loss: 1.136 Vali Loss: 1.455 Vali Acc: 0.288 Test Loss: 1.455 Test Acc: 0.288
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.170100212097168
Epoch: 4, Steps: 13 | Train Loss: 0.881 Vali Loss: 0.517 Vali Acc: 0.751 Test Loss: 0.517 Test Acc: 0.751
Validation loss decreased (-0.712186 --> -0.751214).  Saving model ...
Epoch: 5 cost time: 2.429226875305176
Epoch: 5, Steps: 13 | Train Loss: 1.560 Vali Loss: 1.840 Vali Acc: 0.707 Test Loss: 1.840 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.3352763652801514
Epoch: 6, Steps: 13 | Train Loss: 0.810 Vali Loss: 1.876 Vali Acc: 0.722 Test Loss: 1.876 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.404534339904785
Epoch: 7, Steps: 13 | Train Loss: 2.398 Vali Loss: 0.689 Vali Acc: 0.746 Test Loss: 0.689 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.9819226264953613
Epoch: 8, Steps: 13 | Train Loss: 0.686 Vali Loss: 4.533 Vali Acc: 0.293 Test Loss: 4.533 Test Acc: 0.293
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.1561508178710938
Epoch: 9, Steps: 13 | Train Loss: 1.156 Vali Loss: 1.952 Vali Acc: 0.366 Test Loss: 1.952 Test Acc: 0.366
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.019998550415039
Epoch: 10, Steps: 13 | Train Loss: 1.384 Vali Loss: 0.699 Vali Acc: 0.654 Test Loss: 0.699 Test Acc: 0.654
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.956310749053955
Epoch: 11, Steps: 13 | Train Loss: 1.314 Vali Loss: 1.626 Vali Acc: 0.722 Test Loss: 1.626 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.2708208560943604
Epoch: 12, Steps: 13 | Train Loss: 3.796 Vali Loss: 14.954 Vali Acc: 0.278 Test Loss: 14.954 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.9716782569885254
Epoch: 13, Steps: 13 | Train Loss: 3.024 Vali Loss: 2.335 Vali Acc: 0.405 Test Loss: 2.335 Test Acc: 0.405
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.83260178565979
Epoch: 14, Steps: 13 | Train Loss: 1.088 Vali Loss: 2.004 Vali Acc: 0.478 Test Loss: 2.004 Test Acc: 0.478
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 704026
model size : 3.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.220107555389404
Epoch: 1, Steps: 13 | Train Loss: 0.907 Vali Loss: 1.970 Vali Acc: 0.283 Test Loss: 1.970 Test Acc: 0.283
Validation loss decreased (inf --> -0.282907).  Saving model ...
Epoch: 2 cost time: 2.051776647567749
Epoch: 2, Steps: 13 | Train Loss: 1.655 Vali Loss: 1.603 Vali Acc: 0.722 Test Loss: 1.603 Test Acc: 0.722
Validation loss decreased (-0.282907 --> -0.721935).  Saving model ...
Epoch: 3 cost time: 2.261343240737915
Epoch: 3, Steps: 13 | Train Loss: 0.979 Vali Loss: 1.950 Vali Acc: 0.283 Test Loss: 1.950 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6746726036071777
Epoch: 4, Steps: 13 | Train Loss: 0.929 Vali Loss: 2.204 Vali Acc: 0.288 Test Loss: 2.204 Test Acc: 0.288
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.735339879989624
Epoch: 5, Steps: 13 | Train Loss: 1.339 Vali Loss: 1.147 Vali Acc: 0.395 Test Loss: 1.147 Test Acc: 0.395
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.272885322570801
Epoch: 6, Steps: 13 | Train Loss: 1.088 Vali Loss: 1.401 Vali Acc: 0.717 Test Loss: 1.401 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.238309860229492
Epoch: 7, Steps: 13 | Train Loss: 0.920 Vali Loss: 1.919 Vali Acc: 0.717 Test Loss: 1.919 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.179102659225464
Epoch: 8, Steps: 13 | Train Loss: 1.147 Vali Loss: 1.246 Vali Acc: 0.737 Test Loss: 1.246 Test Acc: 0.737
Validation loss decreased (-0.721935 --> -0.736573).  Saving model ...
Epoch: 9 cost time: 2.243985652923584
Epoch: 9, Steps: 13 | Train Loss: 1.875 Vali Loss: 3.979 Vali Acc: 0.722 Test Loss: 3.979 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1733205318450928
Epoch: 10, Steps: 13 | Train Loss: 1.275 Vali Loss: 0.622 Vali Acc: 0.741 Test Loss: 0.622 Test Acc: 0.741
Validation loss decreased (-0.736573 --> -0.741457).  Saving model ...
Epoch: 11 cost time: 2.1774611473083496
Epoch: 11, Steps: 13 | Train Loss: 1.443 Vali Loss: 0.831 Vali Acc: 0.746 Test Loss: 0.831 Test Acc: 0.746
Validation loss decreased (-0.741457 --> -0.746333).  Saving model ...
Epoch: 12 cost time: 2.244384288787842
Epoch: 12, Steps: 13 | Train Loss: 0.940 Vali Loss: 1.753 Vali Acc: 0.727 Test Loss: 1.753 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.153989315032959
Epoch: 13, Steps: 13 | Train Loss: 1.061 Vali Loss: 1.036 Vali Acc: 0.751 Test Loss: 1.036 Test Acc: 0.751
Validation loss decreased (-0.746333 --> -0.751209).  Saving model ...
Epoch: 14 cost time: 2.126398801803589
Epoch: 14, Steps: 13 | Train Loss: 1.046 Vali Loss: 0.644 Vali Acc: 0.702 Test Loss: 0.644 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.1279969215393066
Epoch: 15, Steps: 13 | Train Loss: 0.974 Vali Loss: 6.883 Vali Acc: 0.288 Test Loss: 6.883 Test Acc: 0.288
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.130204439163208
Epoch: 16, Steps: 13 | Train Loss: 3.485 Vali Loss: 4.253 Vali Acc: 0.722 Test Loss: 4.253 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.035635471343994
Epoch: 17, Steps: 13 | Train Loss: 2.491 Vali Loss: 3.320 Vali Acc: 0.361 Test Loss: 3.320 Test Acc: 0.361
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.0035009384155273
Epoch: 18, Steps: 13 | Train Loss: 1.843 Vali Loss: 2.442 Vali Acc: 0.463 Test Loss: 2.442 Test Acc: 0.463
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.297356367111206
Epoch: 19, Steps: 13 | Train Loss: 0.638 Vali Loss: 1.791 Vali Acc: 0.746 Test Loss: 1.791 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.174804449081421
Epoch: 20, Steps: 13 | Train Loss: 1.140 Vali Loss: 0.938 Vali Acc: 0.712 Test Loss: 0.938 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.3119168281555176
Epoch: 21, Steps: 13 | Train Loss: 0.205 Vali Loss: 0.966 Vali Acc: 0.683 Test Loss: 0.966 Test Acc: 0.683
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.540890693664551
Epoch: 22, Steps: 13 | Train Loss: 1.045 Vali Loss: 1.889 Vali Acc: 0.746 Test Loss: 1.889 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.169053554534912
Epoch: 23, Steps: 13 | Train Loss: 2.214 Vali Loss: 6.135 Vali Acc: 0.327 Test Loss: 6.135 Test Acc: 0.327
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 661018
model size : 3.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.002832889556885
Epoch: 1, Steps: 13 | Train Loss: 0.762 Vali Loss: 0.559 Vali Acc: 0.722 Test Loss: 0.559 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 2.2747364044189453
Epoch: 2, Steps: 13 | Train Loss: 1.127 Vali Loss: 1.810 Vali Acc: 0.722 Test Loss: 1.810 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.608447313308716
Epoch: 3, Steps: 13 | Train Loss: 1.483 Vali Loss: 2.965 Vali Acc: 0.283 Test Loss: 2.965 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.529951572418213
Epoch: 4, Steps: 13 | Train Loss: 1.515 Vali Loss: 1.049 Vali Acc: 0.717 Test Loss: 1.049 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.3719141483306885
Epoch: 5, Steps: 13 | Train Loss: 0.922 Vali Loss: 0.958 Vali Acc: 0.722 Test Loss: 0.958 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.314822196960449
Epoch: 6, Steps: 13 | Train Loss: 0.520 Vali Loss: 2.978 Vali Acc: 0.293 Test Loss: 2.978 Test Acc: 0.293
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.4795777797698975
Epoch: 7, Steps: 13 | Train Loss: 1.130 Vali Loss: 1.404 Vali Acc: 0.346 Test Loss: 1.404 Test Acc: 0.346
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.9375255107879639
Epoch: 8, Steps: 13 | Train Loss: 0.739 Vali Loss: 3.035 Vali Acc: 0.722 Test Loss: 3.035 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.212116241455078
Epoch: 9, Steps: 13 | Train Loss: 2.642 Vali Loss: 6.234 Vali Acc: 0.288 Test Loss: 6.234 Test Acc: 0.288
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.143564462661743
Epoch: 10, Steps: 13 | Train Loss: 2.309 Vali Loss: 0.727 Vali Acc: 0.741 Test Loss: 0.727 Test Acc: 0.741
Validation loss decreased (-0.721946 --> -0.741456).  Saving model ...
Epoch: 11 cost time: 1.8581674098968506
Epoch: 11, Steps: 13 | Train Loss: 0.942 Vali Loss: 0.841 Vali Acc: 0.746 Test Loss: 0.841 Test Acc: 0.746
Validation loss decreased (-0.741456 --> -0.746333).  Saving model ...
Epoch: 12 cost time: 2.3746588230133057
Epoch: 12, Steps: 13 | Train Loss: 0.865 Vali Loss: 1.554 Vali Acc: 0.463 Test Loss: 1.554 Test Acc: 0.463
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.103748083114624
Epoch: 13, Steps: 13 | Train Loss: 1.462 Vali Loss: 0.758 Vali Acc: 0.717 Test Loss: 0.758 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.0481090545654297
Epoch: 14, Steps: 13 | Train Loss: 0.308 Vali Loss: 1.043 Vali Acc: 0.746 Test Loss: 1.043 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.358208179473877
Epoch: 15, Steps: 13 | Train Loss: 0.835 Vali Loss: 0.742 Vali Acc: 0.727 Test Loss: 0.742 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.935612678527832
Epoch: 16, Steps: 13 | Train Loss: 2.570 Vali Loss: 4.515 Vali Acc: 0.722 Test Loss: 4.515 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.205322265625
Epoch: 17, Steps: 13 | Train Loss: 2.842 Vali Loss: 7.232 Vali Acc: 0.288 Test Loss: 7.232 Test Acc: 0.288
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.3019540309906006
Epoch: 18, Steps: 13 | Train Loss: 2.030 Vali Loss: 4.833 Vali Acc: 0.717 Test Loss: 4.833 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.2862136363983154
Epoch: 19, Steps: 13 | Train Loss: 1.849 Vali Loss: 3.462 Vali Acc: 0.722 Test Loss: 3.462 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.40451979637146
Epoch: 20, Steps: 13 | Train Loss: 1.559 Vali Loss: 5.036 Vali Acc: 0.346 Test Loss: 5.036 Test Acc: 0.346
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.554072380065918
Epoch: 21, Steps: 13 | Train Loss: 1.248 Vali Loss: 1.077 Vali Acc: 0.707 Test Loss: 1.077 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 658842
model size : 3.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.9037492275238037
Epoch: 1, Steps: 13 | Train Loss: 0.639 Vali Loss: 1.378 Vali Acc: 0.722 Test Loss: 1.378 Test Acc: 0.722
Validation loss decreased (inf --> -0.721937).  Saving model ...
Epoch: 2 cost time: 2.1574032306671143
Epoch: 2, Steps: 13 | Train Loss: 1.343 Vali Loss: 0.633 Vali Acc: 0.629 Test Loss: 0.633 Test Acc: 0.629
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.089440107345581
Epoch: 3, Steps: 13 | Train Loss: 0.710 Vali Loss: 0.669 Vali Acc: 0.732 Test Loss: 0.669 Test Acc: 0.732
Validation loss decreased (-0.721937 --> -0.731701).  Saving model ...
Epoch: 4 cost time: 2.0316312313079834
Epoch: 4, Steps: 13 | Train Loss: 0.877 Vali Loss: 0.710 Vali Acc: 0.732 Test Loss: 0.710 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9900050163269043
Epoch: 5, Steps: 13 | Train Loss: 0.952 Vali Loss: 0.840 Vali Acc: 0.502 Test Loss: 0.840 Test Acc: 0.502
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.3764193058013916
Epoch: 6, Steps: 13 | Train Loss: 0.865 Vali Loss: 1.384 Vali Acc: 0.351 Test Loss: 1.384 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.0586562156677246
Epoch: 7, Steps: 13 | Train Loss: 0.747 Vali Loss: 0.580 Vali Acc: 0.771 Test Loss: 0.580 Test Acc: 0.771
Validation loss decreased (-0.731701 --> -0.770726).  Saving model ...
Epoch: 8 cost time: 2.25426983833313
Epoch: 8, Steps: 13 | Train Loss: 0.616 Vali Loss: 2.052 Vali Acc: 0.322 Test Loss: 2.052 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7171919345855713
Epoch: 9, Steps: 13 | Train Loss: 2.682 Vali Loss: 0.715 Vali Acc: 0.615 Test Loss: 0.715 Test Acc: 0.615
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.9158391952514648
Epoch: 10, Steps: 13 | Train Loss: 1.669 Vali Loss: 2.731 Vali Acc: 0.717 Test Loss: 2.731 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.8415162563323975
Epoch: 11, Steps: 13 | Train Loss: 0.844 Vali Loss: 3.622 Vali Acc: 0.317 Test Loss: 3.622 Test Acc: 0.317
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.731468915939331
Epoch: 12, Steps: 13 | Train Loss: 2.551 Vali Loss: 3.174 Vali Acc: 0.722 Test Loss: 3.174 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.2268729209899902
Epoch: 13, Steps: 13 | Train Loss: 1.984 Vali Loss: 0.883 Vali Acc: 0.771 Test Loss: 0.883 Test Acc: 0.771
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.0217552185058594
Epoch: 14, Steps: 13 | Train Loss: 2.244 Vali Loss: 2.147 Vali Acc: 0.463 Test Loss: 2.147 Test Acc: 0.463
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.0388903617858887
Epoch: 15, Steps: 13 | Train Loss: 3.995 Vali Loss: 1.086 Vali Acc: 0.649 Test Loss: 1.086 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.1147077083587646
Epoch: 16, Steps: 13 | Train Loss: 2.276 Vali Loss: 1.527 Vali Acc: 0.605 Test Loss: 1.527 Test Acc: 0.605
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.912745475769043
Epoch: 17, Steps: 13 | Train Loss: 1.014 Vali Loss: 3.148 Vali Acc: 0.395 Test Loss: 3.148 Test Acc: 0.395
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 656666
model size : 3.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.506513595581055
Epoch: 1, Steps: 13 | Train Loss: 0.853 Vali Loss: 0.830 Vali Acc: 0.712 Test Loss: 0.830 Test Acc: 0.712
Validation loss decreased (inf --> -0.712187).  Saving model ...
Epoch: 2 cost time: 1.8785145282745361
Epoch: 2, Steps: 13 | Train Loss: 1.040 Vali Loss: 0.704 Vali Acc: 0.722 Test Loss: 0.704 Test Acc: 0.722
Validation loss decreased (-0.712187 --> -0.721944).  Saving model ...
Epoch: 3 cost time: 2.3030447959899902
Epoch: 3, Steps: 13 | Train Loss: 1.155 Vali Loss: 3.766 Vali Acc: 0.283 Test Loss: 3.766 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8802995681762695
Epoch: 4, Steps: 13 | Train Loss: 0.719 Vali Loss: 1.071 Vali Acc: 0.722 Test Loss: 1.071 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9344909191131592
Epoch: 5, Steps: 13 | Train Loss: 1.057 Vali Loss: 1.864 Vali Acc: 0.717 Test Loss: 1.864 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.3072428703308105
Epoch: 6, Steps: 13 | Train Loss: 0.879 Vali Loss: 2.431 Vali Acc: 0.717 Test Loss: 2.431 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.6927924156188965
Epoch: 7, Steps: 13 | Train Loss: 2.068 Vali Loss: 0.756 Vali Acc: 0.737 Test Loss: 0.756 Test Acc: 0.737
Validation loss decreased (-0.721944 --> -0.736578).  Saving model ...
Epoch: 8 cost time: 1.7331054210662842
Epoch: 8, Steps: 13 | Train Loss: 2.069 Vali Loss: 1.295 Vali Acc: 0.727 Test Loss: 1.295 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9639396667480469
Epoch: 9, Steps: 13 | Train Loss: 2.585 Vali Loss: 5.494 Vali Acc: 0.283 Test Loss: 5.494 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.771643877029419
Epoch: 10, Steps: 13 | Train Loss: 1.582 Vali Loss: 1.330 Vali Acc: 0.468 Test Loss: 1.330 Test Acc: 0.468
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.6491165161132812
Epoch: 11, Steps: 13 | Train Loss: 1.057 Vali Loss: 0.795 Vali Acc: 0.639 Test Loss: 0.795 Test Acc: 0.639
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.6213278770446777
Epoch: 12, Steps: 13 | Train Loss: 1.062 Vali Loss: 1.075 Vali Acc: 0.746 Test Loss: 1.075 Test Acc: 0.746
Validation loss decreased (-0.736578 --> -0.746331).  Saving model ...
Epoch: 13 cost time: 1.564631462097168
Epoch: 13, Steps: 13 | Train Loss: 3.985 Vali Loss: 5.027 Vali Acc: 0.722 Test Loss: 5.027 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6975839138031006
Epoch: 14, Steps: 13 | Train Loss: 3.943 Vali Loss: 2.472 Vali Acc: 0.420 Test Loss: 2.472 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.251904249191284
Epoch: 15, Steps: 13 | Train Loss: 1.747 Vali Loss: 0.865 Vali Acc: 0.717 Test Loss: 0.865 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.119903326034546
Epoch: 16, Steps: 13 | Train Loss: 0.653 Vali Loss: 2.485 Vali Acc: 0.727 Test Loss: 2.485 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.3537919521331787
Epoch: 17, Steps: 13 | Train Loss: 1.050 Vali Loss: 4.229 Vali Acc: 0.307 Test Loss: 4.229 Test Acc: 0.307
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.2472991943359375
Epoch: 18, Steps: 13 | Train Loss: 1.193 Vali Loss: 1.002 Vali Acc: 0.654 Test Loss: 1.002 Test Acc: 0.654
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.8754494190216064
Epoch: 19, Steps: 13 | Train Loss: 0.486 Vali Loss: 2.452 Vali Acc: 0.434 Test Loss: 2.452 Test Acc: 0.434
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.9671039581298828
Epoch: 20, Steps: 13 | Train Loss: 1.068 Vali Loss: 2.688 Vali Acc: 0.424 Test Loss: 2.688 Test Acc: 0.424
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.8587641716003418
Epoch: 21, Steps: 13 | Train Loss: 0.831 Vali Loss: 1.065 Vali Acc: 0.693 Test Loss: 1.065 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.7870125770568848
Epoch: 22, Steps: 13 | Train Loss: 0.159 Vali Loss: 1.173 Vali Acc: 0.722 Test Loss: 1.173 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 654490
model size : 3.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.7192466259002686
Epoch: 1, Steps: 13 | Train Loss: 0.744 Vali Loss: 0.591 Vali Acc: 0.722 Test Loss: 0.591 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.9908792972564697
Epoch: 2, Steps: 13 | Train Loss: 0.663 Vali Loss: 0.555 Vali Acc: 0.717 Test Loss: 0.555 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0838570594787598
Epoch: 3, Steps: 13 | Train Loss: 0.580 Vali Loss: 0.552 Vali Acc: 0.732 Test Loss: 0.552 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 4 cost time: 1.975693702697754
Epoch: 4, Steps: 13 | Train Loss: 0.560 Vali Loss: 0.581 Vali Acc: 0.727 Test Loss: 0.581 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8369195461273193
Epoch: 5, Steps: 13 | Train Loss: 0.537 Vali Loss: 0.613 Vali Acc: 0.727 Test Loss: 0.613 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.2815616130828857
Epoch: 6, Steps: 13 | Train Loss: 0.434 Vali Loss: 0.558 Vali Acc: 0.727 Test Loss: 0.558 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.10868239402771
Epoch: 7, Steps: 13 | Train Loss: 0.599 Vali Loss: 1.090 Vali Acc: 0.351 Test Loss: 1.090 Test Acc: 0.351
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.1718783378601074
Epoch: 8, Steps: 13 | Train Loss: 0.552 Vali Loss: 0.753 Vali Acc: 0.571 Test Loss: 0.753 Test Acc: 0.571
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.001309394836426
Epoch: 9, Steps: 13 | Train Loss: 1.331 Vali Loss: 3.715 Vali Acc: 0.712 Test Loss: 3.715 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.234773874282837
Epoch: 10, Steps: 13 | Train Loss: 3.066 Vali Loss: 2.663 Vali Acc: 0.712 Test Loss: 2.663 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.9383485317230225
Epoch: 11, Steps: 13 | Train Loss: 1.075 Vali Loss: 0.836 Vali Acc: 0.610 Test Loss: 0.836 Test Acc: 0.610
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.112328290939331
Epoch: 12, Steps: 13 | Train Loss: 0.925 Vali Loss: 0.882 Vali Acc: 0.595 Test Loss: 0.882 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.2658770084381104
Epoch: 13, Steps: 13 | Train Loss: 0.644 Vali Loss: 3.012 Vali Acc: 0.302 Test Loss: 3.012 Test Acc: 0.302
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7317073170731707
model parameter : 456282
model size : 2.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.4952762126922607
Epoch: 1, Steps: 13 | Train Loss: 0.648 Vali Loss: 0.634 Vali Acc: 0.746 Test Loss: 0.634 Test Acc: 0.746
Validation loss decreased (inf --> -0.746335).  Saving model ...
Epoch: 2 cost time: 1.9683194160461426
Epoch: 2, Steps: 13 | Train Loss: 0.611 Vali Loss: 0.802 Vali Acc: 0.337 Test Loss: 0.802 Test Acc: 0.337
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8215160369873047
Epoch: 3, Steps: 13 | Train Loss: 0.665 Vali Loss: 0.648 Vali Acc: 0.717 Test Loss: 0.648 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8944039344787598
Epoch: 4, Steps: 13 | Train Loss: 0.773 Vali Loss: 0.554 Vali Acc: 0.737 Test Loss: 0.554 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8962407112121582
Epoch: 5, Steps: 13 | Train Loss: 0.973 Vali Loss: 0.698 Vali Acc: 0.610 Test Loss: 0.698 Test Acc: 0.610
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.550689697265625
Epoch: 6, Steps: 13 | Train Loss: 0.573 Vali Loss: 0.882 Vali Acc: 0.449 Test Loss: 0.882 Test Acc: 0.449
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.4952888488769531
Epoch: 7, Steps: 13 | Train Loss: 0.607 Vali Loss: 0.530 Vali Acc: 0.741 Test Loss: 0.530 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.9633808135986328
Epoch: 8, Steps: 13 | Train Loss: 0.701 Vali Loss: 1.592 Vali Acc: 0.722 Test Loss: 1.592 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.1218910217285156
Epoch: 9, Steps: 13 | Train Loss: 2.159 Vali Loss: 1.352 Vali Acc: 0.712 Test Loss: 1.352 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.9509210586547852
Epoch: 10, Steps: 13 | Train Loss: 1.001 Vali Loss: 0.863 Vali Acc: 0.727 Test Loss: 0.863 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.9721689224243164
Epoch: 11, Steps: 13 | Train Loss: 0.623 Vali Loss: 1.809 Vali Acc: 0.337 Test Loss: 1.809 Test Acc: 0.337
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 455194
model size : 2.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.844872236251831
Epoch: 1, Steps: 13 | Train Loss: 0.867 Vali Loss: 0.916 Vali Acc: 0.722 Test Loss: 0.916 Test Acc: 0.722
Validation loss decreased (inf --> -0.721942).  Saving model ...
Epoch: 2 cost time: 2.1329848766326904
Epoch: 2, Steps: 13 | Train Loss: 0.723 Vali Loss: 0.565 Vali Acc: 0.727 Test Loss: 0.565 Test Acc: 0.727
Validation loss decreased (-0.721942 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 1.9677016735076904
Epoch: 3, Steps: 13 | Train Loss: 0.893 Vali Loss: 0.813 Vali Acc: 0.395 Test Loss: 0.813 Test Acc: 0.395
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7945783138275146
Epoch: 4, Steps: 13 | Train Loss: 0.943 Vali Loss: 0.647 Vali Acc: 0.654 Test Loss: 0.647 Test Acc: 0.654
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.1132607460021973
Epoch: 5, Steps: 13 | Train Loss: 0.550 Vali Loss: 0.968 Vali Acc: 0.717 Test Loss: 0.968 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.1100897789001465
Epoch: 6, Steps: 13 | Train Loss: 0.483 Vali Loss: 0.701 Vali Acc: 0.580 Test Loss: 0.701 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.8644204139709473
Epoch: 7, Steps: 13 | Train Loss: 0.524 Vali Loss: 1.256 Vali Acc: 0.351 Test Loss: 1.256 Test Acc: 0.351
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.9809701442718506
Epoch: 8, Steps: 13 | Train Loss: 0.588 Vali Loss: 0.705 Vali Acc: 0.590 Test Loss: 0.705 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.981013536453247
Epoch: 9, Steps: 13 | Train Loss: 0.400 Vali Loss: 0.679 Vali Acc: 0.741 Test Loss: 0.679 Test Acc: 0.741
Validation loss decreased (-0.726824 --> -0.741457).  Saving model ...
Epoch: 10 cost time: 2.2056143283843994
Epoch: 10, Steps: 13 | Train Loss: 0.694 Vali Loss: 2.647 Vali Acc: 0.722 Test Loss: 2.647 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.1948726177215576
Epoch: 11, Steps: 13 | Train Loss: 2.307 Vali Loss: 0.795 Vali Acc: 0.746 Test Loss: 0.795 Test Acc: 0.746
Validation loss decreased (-0.741457 --> -0.746334).  Saving model ...
Epoch: 12 cost time: 2.171119213104248
Epoch: 12, Steps: 13 | Train Loss: 1.956 Vali Loss: 4.167 Vali Acc: 0.293 Test Loss: 4.167 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.3255414962768555
Epoch: 13, Steps: 13 | Train Loss: 0.693 Vali Loss: 1.148 Vali Acc: 0.737 Test Loss: 1.148 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8416574001312256
Epoch: 14, Steps: 13 | Train Loss: 0.373 Vali Loss: 1.306 Vali Acc: 0.722 Test Loss: 1.306 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.105919122695923
Epoch: 15, Steps: 13 | Train Loss: 0.661 Vali Loss: 1.752 Vali Acc: 0.727 Test Loss: 1.752 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.9912290573120117
Epoch: 16, Steps: 13 | Train Loss: 1.330 Vali Loss: 3.776 Vali Acc: 0.327 Test Loss: 3.776 Test Acc: 0.327
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.199408531188965
Epoch: 17, Steps: 13 | Train Loss: 0.641 Vali Loss: 2.036 Vali Acc: 0.415 Test Loss: 2.036 Test Acc: 0.415
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.1251540184020996
Epoch: 18, Steps: 13 | Train Loss: 0.422 Vali Loss: 0.838 Vali Acc: 0.717 Test Loss: 0.838 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.184913396835327
Epoch: 19, Steps: 13 | Train Loss: 0.137 Vali Loss: 1.111 Vali Acc: 0.761 Test Loss: 1.111 Test Acc: 0.761
Validation loss decreased (-0.746334 --> -0.760964).  Saving model ...
Epoch: 20 cost time: 1.865978717803955
Epoch: 20, Steps: 13 | Train Loss: 0.112 Vali Loss: 2.115 Vali Acc: 0.434 Test Loss: 2.115 Test Acc: 0.434
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.0259246826171875
Epoch: 21, Steps: 13 | Train Loss: 0.285 Vali Loss: 0.965 Vali Acc: 0.659 Test Loss: 0.965 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.8733811378479004
Epoch: 22, Steps: 13 | Train Loss: 0.305 Vali Loss: 1.117 Vali Acc: 0.746 Test Loss: 1.117 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.8657495975494385
Epoch: 23, Steps: 13 | Train Loss: 0.117 Vali Loss: 1.834 Vali Acc: 0.537 Test Loss: 1.834 Test Acc: 0.537
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.8503975868225098
Epoch: 24, Steps: 13 | Train Loss: 0.148 Vali Loss: 1.171 Vali Acc: 0.751 Test Loss: 1.171 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.8902795314788818
Epoch: 25, Steps: 13 | Train Loss: 0.046 Vali Loss: 1.101 Vali Acc: 0.702 Test Loss: 1.101 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.256070613861084
Epoch: 26, Steps: 13 | Train Loss: 0.031 Vali Loss: 1.315 Vali Acc: 0.756 Test Loss: 1.315 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.9730958938598633
Epoch: 27, Steps: 13 | Train Loss: 0.035 Vali Loss: 1.234 Vali Acc: 0.698 Test Loss: 1.234 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.8135437965393066
Epoch: 28, Steps: 13 | Train Loss: 0.035 Vali Loss: 1.215 Vali Acc: 0.707 Test Loss: 1.215 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.7929117679595947
Epoch: 29, Steps: 13 | Train Loss: 0.260 Vali Loss: 1.231 Vali Acc: 0.683 Test Loss: 1.231 Test Acc: 0.683
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 454106
model size : 2.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.785876750946045
Epoch: 1, Steps: 13 | Train Loss: 0.618 Vali Loss: 0.848 Vali Acc: 0.717 Test Loss: 0.848 Test Acc: 0.717
Validation loss decreased (inf --> -0.717065).  Saving model ...
Epoch: 2 cost time: 2.0879299640655518
Epoch: 2, Steps: 13 | Train Loss: 0.624 Vali Loss: 2.558 Vali Acc: 0.278 Test Loss: 2.558 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.1578803062438965
Epoch: 3, Steps: 13 | Train Loss: 1.745 Vali Loss: 1.304 Vali Acc: 0.293 Test Loss: 1.304 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9905149936676025
Epoch: 4, Steps: 13 | Train Loss: 0.948 Vali Loss: 0.528 Vali Acc: 0.746 Test Loss: 0.528 Test Acc: 0.746
Validation loss decreased (-0.717065 --> -0.746336).  Saving model ...
Epoch: 5 cost time: 1.9670486450195312
Epoch: 5, Steps: 13 | Train Loss: 0.792 Vali Loss: 0.613 Vali Acc: 0.654 Test Loss: 0.613 Test Acc: 0.654
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8839325904846191
Epoch: 6, Steps: 13 | Train Loss: 0.918 Vali Loss: 1.018 Vali Acc: 0.400 Test Loss: 1.018 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.9049463272094727
Epoch: 7, Steps: 13 | Train Loss: 1.047 Vali Loss: 1.286 Vali Acc: 0.717 Test Loss: 1.286 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.9961988925933838
Epoch: 8, Steps: 13 | Train Loss: 1.180 Vali Loss: 5.480 Vali Acc: 0.278 Test Loss: 5.480 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.7200181484222412
Epoch: 9, Steps: 13 | Train Loss: 1.030 Vali Loss: 1.026 Vali Acc: 0.439 Test Loss: 1.026 Test Acc: 0.439
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.261763334274292
Epoch: 10, Steps: 13 | Train Loss: 0.398 Vali Loss: 0.919 Vali Acc: 0.498 Test Loss: 0.919 Test Acc: 0.498
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.9924027919769287
Epoch: 11, Steps: 13 | Train Loss: 0.869 Vali Loss: 1.673 Vali Acc: 0.722 Test Loss: 1.673 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.018650531768799
Epoch: 12, Steps: 13 | Train Loss: 1.029 Vali Loss: 0.614 Vali Acc: 0.702 Test Loss: 0.614 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.9518392086029053
Epoch: 13, Steps: 13 | Train Loss: 0.316 Vali Loss: 0.961 Vali Acc: 0.727 Test Loss: 0.961 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.7961080074310303
Epoch: 14, Steps: 13 | Train Loss: 0.448 Vali Loss: 4.862 Vali Acc: 0.283 Test Loss: 4.862 Test Acc: 0.283
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 453018
model size : 2.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.7744252681732178
Epoch: 1, Steps: 13 | Train Loss: 0.723 Vali Loss: 0.575 Vali Acc: 0.722 Test Loss: 0.575 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.792719841003418
Epoch: 2, Steps: 13 | Train Loss: 0.685 Vali Loss: 0.588 Vali Acc: 0.737 Test Loss: 0.588 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736579).  Saving model ...
Epoch: 3 cost time: 1.6161222457885742
Epoch: 3, Steps: 13 | Train Loss: 0.533 Vali Loss: 1.041 Vali Acc: 0.288 Test Loss: 1.041 Test Acc: 0.288
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7108783721923828
Epoch: 4, Steps: 13 | Train Loss: 1.008 Vali Loss: 1.871 Vali Acc: 0.722 Test Loss: 1.871 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7341251373291016
Epoch: 5, Steps: 13 | Train Loss: 1.331 Vali Loss: 0.544 Vali Acc: 0.751 Test Loss: 0.544 Test Acc: 0.751
Validation loss decreased (-0.736579 --> -0.751214).  Saving model ...
Epoch: 6 cost time: 2.0743775367736816
Epoch: 6, Steps: 13 | Train Loss: 2.127 Vali Loss: 0.774 Vali Acc: 0.541 Test Loss: 0.774 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6660678386688232
Epoch: 7, Steps: 13 | Train Loss: 1.327 Vali Loss: 0.596 Vali Acc: 0.751 Test Loss: 0.596 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.741182565689087
Epoch: 8, Steps: 13 | Train Loss: 0.662 Vali Loss: 0.621 Vali Acc: 0.737 Test Loss: 0.621 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7940168380737305
Epoch: 9, Steps: 13 | Train Loss: 0.617 Vali Loss: 2.097 Vali Acc: 0.317 Test Loss: 2.097 Test Acc: 0.317
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.8553667068481445
Epoch: 10, Steps: 13 | Train Loss: 0.914 Vali Loss: 0.790 Vali Acc: 0.741 Test Loss: 0.790 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.577650785446167
Epoch: 11, Steps: 13 | Train Loss: 0.451 Vali Loss: 1.703 Vali Acc: 0.722 Test Loss: 1.703 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.667691707611084
Epoch: 12, Steps: 13 | Train Loss: 1.106 Vali Loss: 0.645 Vali Acc: 0.751 Test Loss: 0.645 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.6824908256530762
Epoch: 13, Steps: 13 | Train Loss: 1.421 Vali Loss: 2.652 Vali Acc: 0.298 Test Loss: 2.652 Test Acc: 0.298
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.6325721740722656
Epoch: 14, Steps: 13 | Train Loss: 0.716 Vali Loss: 0.567 Vali Acc: 0.702 Test Loss: 0.567 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.9925923347473145
Epoch: 15, Steps: 13 | Train Loss: 1.085 Vali Loss: 1.649 Vali Acc: 0.415 Test Loss: 1.649 Test Acc: 0.415
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 356442
model size : 2.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.110358476638794
Epoch: 1, Steps: 13 | Train Loss: 0.740 Vali Loss: 0.995 Vali Acc: 0.722 Test Loss: 0.995 Test Acc: 0.722
Validation loss decreased (inf --> -0.721941).  Saving model ...
Epoch: 2 cost time: 1.586963176727295
Epoch: 2, Steps: 13 | Train Loss: 1.226 Vali Loss: 0.688 Vali Acc: 0.722 Test Loss: 0.688 Test Acc: 0.722
Validation loss decreased (-0.721941 --> -0.721944).  Saving model ...
Epoch: 3 cost time: 1.9044380187988281
Epoch: 3, Steps: 13 | Train Loss: 0.752 Vali Loss: 0.821 Vali Acc: 0.712 Test Loss: 0.821 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9332919120788574
Epoch: 4, Steps: 13 | Train Loss: 0.578 Vali Loss: 0.651 Vali Acc: 0.629 Test Loss: 0.651 Test Acc: 0.629
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7720210552215576
Epoch: 5, Steps: 13 | Train Loss: 0.500 Vali Loss: 1.217 Vali Acc: 0.722 Test Loss: 1.217 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.9374666213989258
Epoch: 6, Steps: 13 | Train Loss: 1.121 Vali Loss: 2.362 Vali Acc: 0.283 Test Loss: 2.362 Test Acc: 0.283
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.873079538345337
Epoch: 7, Steps: 13 | Train Loss: 1.151 Vali Loss: 1.531 Vali Acc: 0.712 Test Loss: 1.531 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.601536750793457
Epoch: 8, Steps: 13 | Train Loss: 0.535 Vali Loss: 0.847 Vali Acc: 0.541 Test Loss: 0.847 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.735497236251831
Epoch: 9, Steps: 13 | Train Loss: 0.553 Vali Loss: 1.796 Vali Acc: 0.302 Test Loss: 1.796 Test Acc: 0.302
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.888169527053833
Epoch: 10, Steps: 13 | Train Loss: 1.477 Vali Loss: 0.920 Vali Acc: 0.727 Test Loss: 0.920 Test Acc: 0.727
Validation loss decreased (-0.721944 --> -0.726820).  Saving model ...
Epoch: 11 cost time: 2.0730738639831543
Epoch: 11, Steps: 13 | Train Loss: 0.959 Vali Loss: 1.705 Vali Acc: 0.351 Test Loss: 1.705 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6700398921966553
Epoch: 12, Steps: 13 | Train Loss: 1.022 Vali Loss: 1.693 Vali Acc: 0.722 Test Loss: 1.693 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8332669734954834
Epoch: 13, Steps: 13 | Train Loss: 0.965 Vali Loss: 0.633 Vali Acc: 0.727 Test Loss: 0.633 Test Acc: 0.727
Validation loss decreased (-0.726820 --> -0.726823).  Saving model ...
Epoch: 14 cost time: 2.0805797576904297
Epoch: 14, Steps: 13 | Train Loss: 0.724 Vali Loss: 0.893 Vali Acc: 0.551 Test Loss: 0.893 Test Acc: 0.551
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.784656047821045
Epoch: 15, Steps: 13 | Train Loss: 1.053 Vali Loss: 0.630 Vali Acc: 0.722 Test Loss: 0.630 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.628788709640503
Epoch: 16, Steps: 13 | Train Loss: 1.838 Vali Loss: 5.273 Vali Acc: 0.293 Test Loss: 5.273 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.592900276184082
Epoch: 17, Steps: 13 | Train Loss: 1.949 Vali Loss: 3.073 Vali Acc: 0.712 Test Loss: 3.073 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.8932974338531494
Epoch: 18, Steps: 13 | Train Loss: 0.866 Vali Loss: 1.020 Vali Acc: 0.620 Test Loss: 1.020 Test Acc: 0.620
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.246633768081665
Epoch: 19, Steps: 13 | Train Loss: 0.287 Vali Loss: 1.401 Vali Acc: 0.746 Test Loss: 1.401 Test Acc: 0.746
Validation loss decreased (-0.726823 --> -0.746327).  Saving model ...
Epoch: 20 cost time: 1.7327752113342285
Epoch: 20, Steps: 13 | Train Loss: 0.504 Vali Loss: 1.113 Vali Acc: 0.576 Test Loss: 1.113 Test Acc: 0.576
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.046996831893921
Epoch: 21, Steps: 13 | Train Loss: 0.179 Vali Loss: 1.526 Vali Acc: 0.741 Test Loss: 1.526 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.7611973285675049
Epoch: 22, Steps: 13 | Train Loss: 0.748 Vali Loss: 2.872 Vali Acc: 0.712 Test Loss: 2.872 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.7938477993011475
Epoch: 23, Steps: 13 | Train Loss: 0.791 Vali Loss: 1.712 Vali Acc: 0.493 Test Loss: 1.712 Test Acc: 0.493
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.968996524810791
Epoch: 24, Steps: 13 | Train Loss: 0.240 Vali Loss: 1.204 Vali Acc: 0.776 Test Loss: 1.204 Test Acc: 0.776
Validation loss decreased (-0.746327 --> -0.775598).  Saving model ...
Epoch: 25 cost time: 1.7966892719268799
Epoch: 25, Steps: 13 | Train Loss: 0.927 Vali Loss: 2.030 Vali Acc: 0.522 Test Loss: 2.030 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.0091543197631836
Epoch: 26, Steps: 13 | Train Loss: 0.295 Vali Loss: 4.460 Vali Acc: 0.337 Test Loss: 4.460 Test Acc: 0.337
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.9994699954986572
Epoch: 27, Steps: 13 | Train Loss: 1.855 Vali Loss: 1.744 Vali Acc: 0.537 Test Loss: 1.744 Test Acc: 0.537
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.1274807453155518
Epoch: 28, Steps: 13 | Train Loss: 0.173 Vali Loss: 2.104 Vali Acc: 0.532 Test Loss: 2.104 Test Acc: 0.532
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.6631200313568115
Epoch: 29, Steps: 13 | Train Loss: 0.246 Vali Loss: 1.802 Vali Acc: 0.571 Test Loss: 1.802 Test Acc: 0.571
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.0451319217681885
Epoch: 30, Steps: 13 | Train Loss: 0.110 Vali Loss: 1.546 Vali Acc: 0.576 Test Loss: 1.546 Test Acc: 0.576
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.7716476917266846
Epoch: 31, Steps: 13 | Train Loss: 0.070 Vali Loss: 2.137 Vali Acc: 0.527 Test Loss: 2.137 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.9110097885131836
Epoch: 32, Steps: 13 | Train Loss: 0.092 Vali Loss: 1.584 Vali Acc: 0.590 Test Loss: 1.584 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.8268241882324219
Epoch: 33, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.436 Vali Acc: 0.707 Test Loss: 1.436 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.756058692932129
Epoch: 34, Steps: 13 | Train Loss: 0.028 Vali Loss: 2.097 Vali Acc: 0.761 Test Loss: 2.097 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 355354
model size : 2.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.8671927452087402
Epoch: 1, Steps: 13 | Train Loss: 0.674 Vali Loss: 0.585 Vali Acc: 0.722 Test Loss: 0.585 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.9109406471252441
Epoch: 2, Steps: 13 | Train Loss: 0.621 Vali Loss: 0.598 Vali Acc: 0.766 Test Loss: 0.598 Test Acc: 0.766
Validation loss decreased (-0.721945 --> -0.765848).  Saving model ...
Epoch: 3 cost time: 1.4685587882995605
Epoch: 3, Steps: 13 | Train Loss: 0.575 Vali Loss: 1.331 Vali Acc: 0.278 Test Loss: 1.331 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6019752025604248
Epoch: 4, Steps: 13 | Train Loss: 1.130 Vali Loss: 0.986 Vali Acc: 0.717 Test Loss: 0.986 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.870957374572754
Epoch: 5, Steps: 13 | Train Loss: 1.505 Vali Loss: 1.541 Vali Acc: 0.717 Test Loss: 1.541 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7227630615234375
Epoch: 6, Steps: 13 | Train Loss: 1.364 Vali Loss: 2.060 Vali Acc: 0.283 Test Loss: 2.060 Test Acc: 0.283
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.8492040634155273
Epoch: 7, Steps: 13 | Train Loss: 0.843 Vali Loss: 0.685 Vali Acc: 0.727 Test Loss: 0.685 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.4496469497680664
Epoch: 8, Steps: 13 | Train Loss: 0.441 Vali Loss: 0.540 Vali Acc: 0.702 Test Loss: 0.540 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.7883477210998535
Epoch: 9, Steps: 13 | Train Loss: 0.454 Vali Loss: 0.895 Vali Acc: 0.449 Test Loss: 0.895 Test Acc: 0.449
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.0270237922668457
Epoch: 10, Steps: 13 | Train Loss: 0.589 Vali Loss: 1.312 Vali Acc: 0.722 Test Loss: 1.312 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.7180426120758057
Epoch: 11, Steps: 13 | Train Loss: 1.482 Vali Loss: 0.568 Vali Acc: 0.737 Test Loss: 0.568 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.8398792743682861
Epoch: 12, Steps: 13 | Train Loss: 1.866 Vali Loss: 2.633 Vali Acc: 0.717 Test Loss: 2.633 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 354266
model size : 2.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.532465696334839
Epoch: 1, Steps: 13 | Train Loss: 0.679 Vali Loss: 0.618 Vali Acc: 0.722 Test Loss: 0.618 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.708299160003662
Epoch: 2, Steps: 13 | Train Loss: 0.612 Vali Loss: 0.639 Vali Acc: 0.693 Test Loss: 0.639 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9089992046356201
Epoch: 3, Steps: 13 | Train Loss: 0.723 Vali Loss: 0.868 Vali Acc: 0.717 Test Loss: 0.868 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7866127490997314
Epoch: 4, Steps: 13 | Train Loss: 0.626 Vali Loss: 0.774 Vali Acc: 0.717 Test Loss: 0.774 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.614715576171875
Epoch: 5, Steps: 13 | Train Loss: 0.500 Vali Loss: 0.547 Vali Acc: 0.737 Test Loss: 0.547 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736580).  Saving model ...
Epoch: 6 cost time: 1.8312301635742188
Epoch: 6, Steps: 13 | Train Loss: 0.430 Vali Loss: 0.630 Vali Acc: 0.727 Test Loss: 0.630 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8780853748321533
Epoch: 7, Steps: 13 | Train Loss: 1.115 Vali Loss: 4.566 Vali Acc: 0.288 Test Loss: 4.566 Test Acc: 0.288
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8623931407928467
Epoch: 8, Steps: 13 | Train Loss: 1.416 Vali Loss: 0.536 Vali Acc: 0.751 Test Loss: 0.536 Test Acc: 0.751
Validation loss decreased (-0.736580 --> -0.751214).  Saving model ...
Epoch: 9 cost time: 1.7255644798278809
Epoch: 9, Steps: 13 | Train Loss: 0.841 Vali Loss: 0.539 Vali Acc: 0.756 Test Loss: 0.539 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756092).  Saving model ...
Epoch: 10 cost time: 1.9812092781066895
Epoch: 10, Steps: 13 | Train Loss: 2.024 Vali Loss: 0.800 Vali Acc: 0.746 Test Loss: 0.800 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9661235809326172
Epoch: 11, Steps: 13 | Train Loss: 0.643 Vali Loss: 0.558 Vali Acc: 0.732 Test Loss: 0.558 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.893310546875
Epoch: 12, Steps: 13 | Train Loss: 0.301 Vali Loss: 0.593 Vali Acc: 0.707 Test Loss: 0.593 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.676771879196167
Epoch: 13, Steps: 13 | Train Loss: 1.060 Vali Loss: 0.663 Vali Acc: 0.751 Test Loss: 0.663 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.8405828475952148
Epoch: 14, Steps: 13 | Train Loss: 1.105 Vali Loss: 2.116 Vali Acc: 0.722 Test Loss: 2.116 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.9339039325714111
Epoch: 15, Steps: 13 | Train Loss: 2.416 Vali Loss: 1.412 Vali Acc: 0.737 Test Loss: 1.412 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.7670860290527344
Epoch: 16, Steps: 13 | Train Loss: 0.378 Vali Loss: 1.553 Vali Acc: 0.463 Test Loss: 1.553 Test Acc: 0.463
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.880037784576416
Epoch: 17, Steps: 13 | Train Loss: 0.521 Vali Loss: 0.716 Vali Acc: 0.678 Test Loss: 0.716 Test Acc: 0.678
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.8114068508148193
Epoch: 18, Steps: 13 | Train Loss: 0.887 Vali Loss: 2.110 Vali Acc: 0.727 Test Loss: 2.110 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.5936050415039062
Epoch: 19, Steps: 13 | Train Loss: 0.880 Vali Loss: 0.866 Vali Acc: 0.727 Test Loss: 0.866 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 353178
model size : 2.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.7344508171081543
Epoch: 1, Steps: 13 | Train Loss: 0.674 Vali Loss: 0.610 Vali Acc: 0.712 Test Loss: 0.610 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 1.6517574787139893
Epoch: 2, Steps: 13 | Train Loss: 0.826 Vali Loss: 0.563 Vali Acc: 0.712 Test Loss: 0.563 Test Acc: 0.712
Validation loss decreased (-0.712189 --> -0.712189).  Saving model ...
Epoch: 3 cost time: 1.6570138931274414
Epoch: 3, Steps: 13 | Train Loss: 1.539 Vali Loss: 1.095 Vali Acc: 0.283 Test Loss: 1.095 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7611076831817627
Epoch: 4, Steps: 13 | Train Loss: 1.249 Vali Loss: 0.600 Vali Acc: 0.722 Test Loss: 0.600 Test Acc: 0.722
Validation loss decreased (-0.712189 --> -0.721945).  Saving model ...
Epoch: 5 cost time: 1.5435030460357666
Epoch: 5, Steps: 13 | Train Loss: 0.607 Vali Loss: 0.551 Vali Acc: 0.732 Test Loss: 0.551 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 6 cost time: 1.6974315643310547
Epoch: 6, Steps: 13 | Train Loss: 0.913 Vali Loss: 1.628 Vali Acc: 0.722 Test Loss: 1.628 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8557164669036865
Epoch: 7, Steps: 13 | Train Loss: 0.708 Vali Loss: 0.739 Vali Acc: 0.722 Test Loss: 0.739 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8069353103637695
Epoch: 8, Steps: 13 | Train Loss: 0.778 Vali Loss: 1.051 Vali Acc: 0.712 Test Loss: 1.051 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.883565902709961
Epoch: 9, Steps: 13 | Train Loss: 1.104 Vali Loss: 1.959 Vali Acc: 0.312 Test Loss: 1.959 Test Acc: 0.312
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.837090015411377
Epoch: 10, Steps: 13 | Train Loss: 0.605 Vali Loss: 1.024 Vali Acc: 0.493 Test Loss: 1.024 Test Acc: 0.493
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.887995958328247
Epoch: 11, Steps: 13 | Train Loss: 0.703 Vali Loss: 0.837 Vali Acc: 0.566 Test Loss: 0.837 Test Acc: 0.566
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.642944097518921
Epoch: 12, Steps: 13 | Train Loss: 0.465 Vali Loss: 0.651 Vali Acc: 0.756 Test Loss: 0.651 Test Acc: 0.756
Validation loss decreased (-0.731702 --> -0.756091).  Saving model ...
Epoch: 13 cost time: 1.629101276397705
Epoch: 13, Steps: 13 | Train Loss: 0.653 Vali Loss: 3.102 Vali Acc: 0.722 Test Loss: 3.102 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7605657577514648
Epoch: 14, Steps: 13 | Train Loss: 2.392 Vali Loss: 0.650 Vali Acc: 0.702 Test Loss: 0.650 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6452968120574951
Epoch: 15, Steps: 13 | Train Loss: 0.381 Vali Loss: 0.640 Vali Acc: 0.751 Test Loss: 0.640 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.8520126342773438
Epoch: 16, Steps: 13 | Train Loss: 1.107 Vali Loss: 1.790 Vali Acc: 0.722 Test Loss: 1.790 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.7915093898773193
Epoch: 17, Steps: 13 | Train Loss: 1.135 Vali Loss: 1.602 Vali Acc: 0.468 Test Loss: 1.602 Test Acc: 0.468
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.943556308746338
Epoch: 18, Steps: 13 | Train Loss: 0.239 Vali Loss: 1.440 Vali Acc: 0.434 Test Loss: 1.440 Test Acc: 0.434
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.938523769378662
Epoch: 19, Steps: 13 | Train Loss: 0.398 Vali Loss: 1.753 Vali Acc: 0.722 Test Loss: 1.753 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.8146929740905762
Epoch: 20, Steps: 13 | Train Loss: 1.334 Vali Loss: 5.176 Vali Acc: 0.288 Test Loss: 5.176 Test Acc: 0.288
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.801680088043213
Epoch: 21, Steps: 13 | Train Loss: 0.990 Vali Loss: 0.727 Vali Acc: 0.663 Test Loss: 0.727 Test Acc: 0.663
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.905776023864746
Epoch: 22, Steps: 13 | Train Loss: 0.786 Vali Loss: 5.092 Vali Acc: 0.298 Test Loss: 5.092 Test Acc: 0.298
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 306522
model size : 1.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.250884532928467
Epoch: 1, Steps: 13 | Train Loss: 0.912 Vali Loss: 0.654 Vali Acc: 0.727 Test Loss: 0.654 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 1.6687026023864746
Epoch: 2, Steps: 13 | Train Loss: 0.810 Vali Loss: 1.000 Vali Acc: 0.283 Test Loss: 1.000 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.296170473098755
Epoch: 3, Steps: 13 | Train Loss: 1.073 Vali Loss: 0.594 Vali Acc: 0.737 Test Loss: 0.594 Test Acc: 0.737
Validation loss decreased (-0.726823 --> -0.736579).  Saving model ...
Epoch: 4 cost time: 1.8625986576080322
Epoch: 4, Steps: 13 | Train Loss: 0.699 Vali Loss: 1.026 Vali Acc: 0.722 Test Loss: 1.026 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.232353687286377
Epoch: 5, Steps: 13 | Train Loss: 1.130 Vali Loss: 1.478 Vali Acc: 0.283 Test Loss: 1.478 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6217870712280273
Epoch: 6, Steps: 13 | Train Loss: 0.770 Vali Loss: 1.370 Vali Acc: 0.722 Test Loss: 1.370 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.4229755401611328
Epoch: 7, Steps: 13 | Train Loss: 2.058 Vali Loss: 1.212 Vali Acc: 0.707 Test Loss: 1.212 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.3255717754364014
Epoch: 8, Steps: 13 | Train Loss: 1.883 Vali Loss: 3.484 Vali Acc: 0.278 Test Loss: 3.484 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.5595588684082031
Epoch: 9, Steps: 13 | Train Loss: 1.664 Vali Loss: 0.679 Vali Acc: 0.737 Test Loss: 0.679 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.1042237281799316
Epoch: 10, Steps: 13 | Train Loss: 0.386 Vali Loss: 0.699 Vali Acc: 0.737 Test Loss: 0.699 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.628704309463501
Epoch: 11, Steps: 13 | Train Loss: 0.403 Vali Loss: 0.612 Vali Acc: 0.668 Test Loss: 0.612 Test Acc: 0.668
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.5477838516235352
Epoch: 12, Steps: 13 | Train Loss: 0.382 Vali Loss: 0.584 Vali Acc: 0.698 Test Loss: 0.584 Test Acc: 0.698
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.5663113594055176
Epoch: 13, Steps: 13 | Train Loss: 0.352 Vali Loss: 0.970 Vali Acc: 0.732 Test Loss: 0.970 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 305434
model size : 1.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.932152509689331
Epoch: 1, Steps: 13 | Train Loss: 0.678 Vali Loss: 1.197 Vali Acc: 0.278 Test Loss: 1.197 Test Acc: 0.278
Validation loss decreased (inf --> -0.278037).  Saving model ...
Epoch: 2 cost time: 1.9002366065979004
Epoch: 2, Steps: 13 | Train Loss: 0.699 Vali Loss: 1.208 Vali Acc: 0.722 Test Loss: 1.208 Test Acc: 0.722
Validation loss decreased (-0.278037 --> -0.721939).  Saving model ...
Epoch: 3 cost time: 1.8950109481811523
Epoch: 3, Steps: 13 | Train Loss: 0.828 Vali Loss: 0.542 Vali Acc: 0.741 Test Loss: 0.542 Test Acc: 0.741
Validation loss decreased (-0.721939 --> -0.741458).  Saving model ...
Epoch: 4 cost time: 1.7368011474609375
Epoch: 4, Steps: 13 | Train Loss: 0.515 Vali Loss: 1.135 Vali Acc: 0.322 Test Loss: 1.135 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2123196125030518
Epoch: 5, Steps: 13 | Train Loss: 1.012 Vali Loss: 1.386 Vali Acc: 0.717 Test Loss: 1.386 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.2717862129211426
Epoch: 6, Steps: 13 | Train Loss: 1.176 Vali Loss: 2.130 Vali Acc: 0.278 Test Loss: 2.130 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.003227472305298
Epoch: 7, Steps: 13 | Train Loss: 1.037 Vali Loss: 0.987 Vali Acc: 0.712 Test Loss: 0.987 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.9065618515014648
Epoch: 8, Steps: 13 | Train Loss: 0.707 Vali Loss: 0.801 Vali Acc: 0.722 Test Loss: 0.801 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.58882474899292
Epoch: 9, Steps: 13 | Train Loss: 0.759 Vali Loss: 0.771 Vali Acc: 0.722 Test Loss: 0.771 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.0321412086486816
Epoch: 10, Steps: 13 | Train Loss: 0.516 Vali Loss: 1.034 Vali Acc: 0.439 Test Loss: 1.034 Test Acc: 0.439
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.8622033596038818
Epoch: 11, Steps: 13 | Train Loss: 0.597 Vali Loss: 0.609 Vali Acc: 0.673 Test Loss: 0.609 Test Acc: 0.673
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.9789071083068848
Epoch: 12, Steps: 13 | Train Loss: 1.115 Vali Loss: 3.480 Vali Acc: 0.288 Test Loss: 3.480 Test Acc: 0.288
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.031569719314575
Epoch: 13, Steps: 13 | Train Loss: 1.844 Vali Loss: 2.125 Vali Acc: 0.717 Test Loss: 2.125 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 304346
model size : 1.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.386213541030884
Epoch: 1, Steps: 13 | Train Loss: 0.749 Vali Loss: 0.718 Vali Acc: 0.337 Test Loss: 0.718 Test Acc: 0.337
Validation loss decreased (inf --> -0.336578).  Saving model ...
Epoch: 2 cost time: 1.8233652114868164
Epoch: 2, Steps: 13 | Train Loss: 0.753 Vali Loss: 1.168 Vali Acc: 0.278 Test Loss: 1.168 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.52744722366333
Epoch: 3, Steps: 13 | Train Loss: 0.752 Vali Loss: 0.790 Vali Acc: 0.712 Test Loss: 0.790 Test Acc: 0.712
Validation loss decreased (-0.336578 --> -0.712187).  Saving model ...
Epoch: 4 cost time: 1.8325557708740234
Epoch: 4, Steps: 13 | Train Loss: 1.228 Vali Loss: 3.281 Vali Acc: 0.278 Test Loss: 3.281 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.662792444229126
Epoch: 5, Steps: 13 | Train Loss: 1.963 Vali Loss: 0.880 Vali Acc: 0.717 Test Loss: 0.880 Test Acc: 0.717
Validation loss decreased (-0.712187 --> -0.717064).  Saving model ...
Epoch: 6 cost time: 1.6665995121002197
Epoch: 6, Steps: 13 | Train Loss: 1.516 Vali Loss: 1.567 Vali Acc: 0.722 Test Loss: 1.567 Test Acc: 0.722
Validation loss decreased (-0.717064 --> -0.721936).  Saving model ...
Epoch: 7 cost time: 1.4628379344940186
Epoch: 7, Steps: 13 | Train Loss: 1.504 Vali Loss: 2.682 Vali Acc: 0.288 Test Loss: 2.682 Test Acc: 0.288
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4852604866027832
Epoch: 8, Steps: 13 | Train Loss: 1.377 Vali Loss: 0.701 Vali Acc: 0.756 Test Loss: 0.701 Test Acc: 0.756
Validation loss decreased (-0.721936 --> -0.756091).  Saving model ...
Epoch: 9 cost time: 1.687506914138794
Epoch: 9, Steps: 13 | Train Loss: 1.766 Vali Loss: 1.539 Vali Acc: 0.712 Test Loss: 1.539 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6236236095428467
Epoch: 10, Steps: 13 | Train Loss: 1.576 Vali Loss: 1.303 Vali Acc: 0.463 Test Loss: 1.303 Test Acc: 0.463
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5788753032684326
Epoch: 11, Steps: 13 | Train Loss: 1.027 Vali Loss: 0.888 Vali Acc: 0.576 Test Loss: 0.888 Test Acc: 0.576
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.9380357265472412
Epoch: 12, Steps: 13 | Train Loss: 0.473 Vali Loss: 0.705 Vali Acc: 0.737 Test Loss: 0.705 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.8205640316009521
Epoch: 13, Steps: 13 | Train Loss: 0.336 Vali Loss: 0.631 Vali Acc: 0.737 Test Loss: 0.631 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.82368803024292
Epoch: 14, Steps: 13 | Train Loss: 0.375 Vali Loss: 0.597 Vali Acc: 0.737 Test Loss: 0.597 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.518209457397461
Epoch: 15, Steps: 13 | Train Loss: 0.714 Vali Loss: 0.851 Vali Acc: 0.737 Test Loss: 0.851 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.033552885055542
Epoch: 16, Steps: 13 | Train Loss: 0.937 Vali Loss: 2.618 Vali Acc: 0.722 Test Loss: 2.618 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.6947433948516846
Epoch: 17, Steps: 13 | Train Loss: 0.772 Vali Loss: 3.252 Vali Acc: 0.712 Test Loss: 3.252 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.775254249572754
Epoch: 18, Steps: 13 | Train Loss: 2.514 Vali Loss: 0.809 Vali Acc: 0.737 Test Loss: 0.809 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 303258
model size : 1.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.2085728645324707
Epoch: 1, Steps: 13 | Train Loss: 0.936 Vali Loss: 1.001 Vali Acc: 0.722 Test Loss: 1.001 Test Acc: 0.722
Validation loss decreased (inf --> -0.721941).  Saving model ...
Epoch: 2 cost time: 1.5847420692443848
Epoch: 2, Steps: 13 | Train Loss: 0.729 Vali Loss: 1.310 Vali Acc: 0.278 Test Loss: 1.310 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.626460313796997
Epoch: 3, Steps: 13 | Train Loss: 0.873 Vali Loss: 0.956 Vali Acc: 0.717 Test Loss: 0.956 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8176844120025635
Epoch: 4, Steps: 13 | Train Loss: 0.821 Vali Loss: 0.530 Vali Acc: 0.741 Test Loss: 0.530 Test Acc: 0.741
Validation loss decreased (-0.721941 --> -0.741458).  Saving model ...
Epoch: 5 cost time: 1.9591319561004639
Epoch: 5, Steps: 13 | Train Loss: 0.780 Vali Loss: 1.488 Vali Acc: 0.722 Test Loss: 1.488 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8775537014007568
Epoch: 6, Steps: 13 | Train Loss: 1.106 Vali Loss: 4.312 Vali Acc: 0.278 Test Loss: 4.312 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.875891923904419
Epoch: 7, Steps: 13 | Train Loss: 2.199 Vali Loss: 0.895 Vali Acc: 0.483 Test Loss: 0.895 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.8511080741882324
Epoch: 8, Steps: 13 | Train Loss: 1.619 Vali Loss: 1.658 Vali Acc: 0.712 Test Loss: 1.658 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.65169095993042
Epoch: 9, Steps: 13 | Train Loss: 1.328 Vali Loss: 1.357 Vali Acc: 0.390 Test Loss: 1.357 Test Acc: 0.390
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.7709081172943115
Epoch: 10, Steps: 13 | Train Loss: 0.707 Vali Loss: 1.147 Vali Acc: 0.722 Test Loss: 1.147 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.6349763870239258
Epoch: 11, Steps: 13 | Train Loss: 0.531 Vali Loss: 0.551 Vali Acc: 0.746 Test Loss: 0.551 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746336).  Saving model ...
Epoch: 12 cost time: 1.5863275527954102
Epoch: 12, Steps: 13 | Train Loss: 1.152 Vali Loss: 1.288 Vali Acc: 0.727 Test Loss: 1.288 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8035953044891357
Epoch: 13, Steps: 13 | Train Loss: 1.306 Vali Loss: 2.654 Vali Acc: 0.298 Test Loss: 2.654 Test Acc: 0.298
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.9116032123565674
Epoch: 14, Steps: 13 | Train Loss: 1.046 Vali Loss: 0.953 Vali Acc: 0.732 Test Loss: 0.953 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.845613718032837
Epoch: 15, Steps: 13 | Train Loss: 1.311 Vali Loss: 1.325 Vali Acc: 0.732 Test Loss: 1.325 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.7269530296325684
Epoch: 16, Steps: 13 | Train Loss: 1.075 Vali Loss: 2.011 Vali Acc: 0.376 Test Loss: 2.011 Test Acc: 0.376
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.5975513458251953
Epoch: 17, Steps: 13 | Train Loss: 0.966 Vali Loss: 1.952 Vali Acc: 0.722 Test Loss: 1.952 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.5924222469329834
Epoch: 18, Steps: 13 | Train Loss: 0.906 Vali Loss: 0.712 Vali Acc: 0.727 Test Loss: 0.712 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.8261380195617676
Epoch: 19, Steps: 13 | Train Loss: 1.112 Vali Loss: 1.193 Vali Acc: 0.546 Test Loss: 1.193 Test Acc: 0.546
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.8647706508636475
Epoch: 20, Steps: 13 | Train Loss: 0.445 Vali Loss: 1.125 Vali Acc: 0.546 Test Loss: 1.125 Test Acc: 0.546
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.929189682006836
Epoch: 21, Steps: 13 | Train Loss: 0.310 Vali Loss: 1.049 Vali Acc: 0.766 Test Loss: 1.049 Test Acc: 0.766
Validation loss decreased (-0.746336 --> -0.765843).  Saving model ...
Epoch: 22 cost time: 1.7722923755645752
Epoch: 22, Steps: 13 | Train Loss: 0.310 Vali Loss: 1.721 Vali Acc: 0.449 Test Loss: 1.721 Test Acc: 0.449
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.8860087394714355
Epoch: 23, Steps: 13 | Train Loss: 0.261 Vali Loss: 2.730 Vali Acc: 0.727 Test Loss: 2.730 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.018486261367798
Epoch: 24, Steps: 13 | Train Loss: 0.411 Vali Loss: 1.651 Vali Acc: 0.746 Test Loss: 1.651 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.794722557067871
Epoch: 25, Steps: 13 | Train Loss: 0.276 Vali Loss: 1.807 Vali Acc: 0.732 Test Loss: 1.807 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.078477144241333
Epoch: 26, Steps: 13 | Train Loss: 0.339 Vali Loss: 1.904 Vali Acc: 0.737 Test Loss: 1.904 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.9395883083343506
Epoch: 27, Steps: 13 | Train Loss: 0.121 Vali Loss: 0.924 Vali Acc: 0.668 Test Loss: 0.924 Test Acc: 0.668
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.7854506969451904
Epoch: 28, Steps: 13 | Train Loss: 0.189 Vali Loss: 0.935 Vali Acc: 0.693 Test Loss: 0.935 Test Acc: 0.693
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.9338092803955078
Epoch: 29, Steps: 13 | Train Loss: 0.282 Vali Loss: 1.326 Vali Acc: 0.585 Test Loss: 1.326 Test Acc: 0.585
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.902052879333496
Epoch: 30, Steps: 13 | Train Loss: 0.320 Vali Loss: 2.426 Vali Acc: 0.463 Test Loss: 2.426 Test Acc: 0.463
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.0138988494873047
Epoch: 31, Steps: 13 | Train Loss: 0.330 Vali Loss: 4.932 Vali Acc: 0.351 Test Loss: 4.932 Test Acc: 0.351
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 281562
model size : 1.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.3128511905670166
Epoch: 1, Steps: 13 | Train Loss: 0.663 Vali Loss: 0.593 Vali Acc: 0.707 Test Loss: 0.593 Test Acc: 0.707
Validation loss decreased (inf --> -0.707311).  Saving model ...
Epoch: 2 cost time: 1.7249462604522705
Epoch: 2, Steps: 13 | Train Loss: 0.886 Vali Loss: 1.579 Vali Acc: 0.283 Test Loss: 1.579 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7372212409973145
Epoch: 3, Steps: 13 | Train Loss: 1.327 Vali Loss: 1.015 Vali Acc: 0.722 Test Loss: 1.015 Test Acc: 0.722
Validation loss decreased (-0.707311 --> -0.721941).  Saving model ...
Epoch: 4 cost time: 1.8063592910766602
Epoch: 4, Steps: 13 | Train Loss: 1.154 Vali Loss: 2.703 Vali Acc: 0.722 Test Loss: 2.703 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0061838626861572
Epoch: 5, Steps: 13 | Train Loss: 2.843 Vali Loss: 1.763 Vali Acc: 0.722 Test Loss: 1.763 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5914437770843506
Epoch: 6, Steps: 13 | Train Loss: 1.234 Vali Loss: 0.898 Vali Acc: 0.405 Test Loss: 0.898 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.9969377517700195
Epoch: 7, Steps: 13 | Train Loss: 1.035 Vali Loss: 0.937 Vali Acc: 0.449 Test Loss: 0.937 Test Acc: 0.449
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.7065927982330322
Epoch: 8, Steps: 13 | Train Loss: 0.809 Vali Loss: 1.088 Vali Acc: 0.385 Test Loss: 1.088 Test Acc: 0.385
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.8260409832000732
Epoch: 9, Steps: 13 | Train Loss: 1.265 Vali Loss: 2.731 Vali Acc: 0.722 Test Loss: 2.731 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.717261791229248
Epoch: 10, Steps: 13 | Train Loss: 0.941 Vali Loss: 0.657 Vali Acc: 0.732 Test Loss: 0.657 Test Acc: 0.732
Validation loss decreased (-0.721941 --> -0.731701).  Saving model ...
Epoch: 11 cost time: 1.4938859939575195
Epoch: 11, Steps: 13 | Train Loss: 0.403 Vali Loss: 0.780 Vali Acc: 0.732 Test Loss: 0.780 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7880730628967285
Epoch: 12, Steps: 13 | Train Loss: 0.753 Vali Loss: 0.623 Vali Acc: 0.668 Test Loss: 0.623 Test Acc: 0.668
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.480964183807373
Epoch: 13, Steps: 13 | Train Loss: 0.896 Vali Loss: 0.760 Vali Acc: 0.732 Test Loss: 0.760 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.059933662414551
Epoch: 14, Steps: 13 | Train Loss: 0.782 Vali Loss: 2.874 Vali Acc: 0.307 Test Loss: 2.874 Test Acc: 0.307
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.411785364151001
Epoch: 15, Steps: 13 | Train Loss: 0.833 Vali Loss: 0.683 Vali Acc: 0.746 Test Loss: 0.683 Test Acc: 0.746
Validation loss decreased (-0.731701 --> -0.746335).  Saving model ...
Epoch: 16 cost time: 1.8844594955444336
Epoch: 16, Steps: 13 | Train Loss: 1.117 Vali Loss: 1.864 Vali Acc: 0.722 Test Loss: 1.864 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7043733596801758
Epoch: 17, Steps: 13 | Train Loss: 0.503 Vali Loss: 0.955 Vali Acc: 0.737 Test Loss: 0.955 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4319427013397217
Epoch: 18, Steps: 13 | Train Loss: 0.506 Vali Loss: 0.966 Vali Acc: 0.527 Test Loss: 0.966 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3834049701690674
Epoch: 19, Steps: 13 | Train Loss: 0.460 Vali Loss: 3.816 Vali Acc: 0.307 Test Loss: 3.816 Test Acc: 0.307
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.5732324123382568
Epoch: 20, Steps: 13 | Train Loss: 2.931 Vali Loss: 1.131 Vali Acc: 0.741 Test Loss: 1.131 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.5255260467529297
Epoch: 21, Steps: 13 | Train Loss: 0.569 Vali Loss: 1.114 Vali Acc: 0.746 Test Loss: 1.114 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.3272018432617188
Epoch: 22, Steps: 13 | Train Loss: 1.236 Vali Loss: 4.843 Vali Acc: 0.307 Test Loss: 4.843 Test Acc: 0.307
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.5542609691619873
Epoch: 23, Steps: 13 | Train Loss: 3.095 Vali Loss: 3.969 Vali Acc: 0.361 Test Loss: 3.969 Test Acc: 0.361
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.7001242637634277
Epoch: 24, Steps: 13 | Train Loss: 1.063 Vali Loss: 1.424 Vali Acc: 0.751 Test Loss: 1.424 Test Acc: 0.751
Validation loss decreased (-0.746335 --> -0.751205).  Saving model ...
Epoch: 25 cost time: 2.2650015354156494
Epoch: 25, Steps: 13 | Train Loss: 1.476 Vali Loss: 8.279 Vali Acc: 0.298 Test Loss: 8.279 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.508458137512207
Epoch: 26, Steps: 13 | Train Loss: 2.240 Vali Loss: 3.066 Vali Acc: 0.727 Test Loss: 3.066 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.6606011390686035
Epoch: 27, Steps: 13 | Train Loss: 0.942 Vali Loss: 2.083 Vali Acc: 0.737 Test Loss: 2.083 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.85013747215271
Epoch: 28, Steps: 13 | Train Loss: 0.295 Vali Loss: 1.883 Vali Acc: 0.741 Test Loss: 1.883 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.7418324947357178
Epoch: 29, Steps: 13 | Train Loss: 0.176 Vali Loss: 1.070 Vali Acc: 0.659 Test Loss: 1.070 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.849581241607666
Epoch: 30, Steps: 13 | Train Loss: 0.179 Vali Loss: 1.442 Vali Acc: 0.761 Test Loss: 1.442 Test Acc: 0.761
Validation loss decreased (-0.751205 --> -0.760961).  Saving model ...
Epoch: 31 cost time: 1.568411111831665
Epoch: 31, Steps: 13 | Train Loss: 0.082 Vali Loss: 1.258 Vali Acc: 0.727 Test Loss: 1.258 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.7652311325073242
Epoch: 32, Steps: 13 | Train Loss: 0.346 Vali Loss: 2.496 Vali Acc: 0.737 Test Loss: 2.496 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.9417295455932617
Epoch: 33, Steps: 13 | Train Loss: 0.323 Vali Loss: 1.497 Vali Acc: 0.756 Test Loss: 1.497 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.0146892070770264
Epoch: 34, Steps: 13 | Train Loss: 0.105 Vali Loss: 1.390 Vali Acc: 0.600 Test Loss: 1.390 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.8310012817382812
Epoch: 35, Steps: 13 | Train Loss: 0.056 Vali Loss: 2.072 Vali Acc: 0.756 Test Loss: 2.072 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.6970891952514648
Epoch: 36, Steps: 13 | Train Loss: 0.170 Vali Loss: 1.451 Vali Acc: 0.639 Test Loss: 1.451 Test Acc: 0.639
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.8600037097930908
Epoch: 37, Steps: 13 | Train Loss: 0.212 Vali Loss: 1.837 Vali Acc: 0.571 Test Loss: 1.837 Test Acc: 0.571
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.491194486618042
Epoch: 38, Steps: 13 | Train Loss: 0.225 Vali Loss: 1.763 Vali Acc: 0.600 Test Loss: 1.763 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.7675371170043945
Epoch: 39, Steps: 13 | Train Loss: 0.246 Vali Loss: 3.869 Vali Acc: 0.727 Test Loss: 3.869 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.7157564163208008
Epoch: 40, Steps: 13 | Train Loss: 0.290 Vali Loss: 1.518 Vali Acc: 0.668 Test Loss: 1.518 Test Acc: 0.668
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 280474
model size : 1.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.159649133682251
Epoch: 1, Steps: 13 | Train Loss: 0.667 Vali Loss: 0.607 Vali Acc: 0.712 Test Loss: 0.607 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 1.6052815914154053
Epoch: 2, Steps: 13 | Train Loss: 0.782 Vali Loss: 0.876 Vali Acc: 0.717 Test Loss: 0.876 Test Acc: 0.717
Validation loss decreased (-0.712189 --> -0.717064).  Saving model ...
Epoch: 3 cost time: 1.8391079902648926
Epoch: 3, Steps: 13 | Train Loss: 0.566 Vali Loss: 0.682 Vali Acc: 0.712 Test Loss: 0.682 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7446887493133545
Epoch: 4, Steps: 13 | Train Loss: 0.937 Vali Loss: 2.609 Vali Acc: 0.278 Test Loss: 2.609 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4351801872253418
Epoch: 5, Steps: 13 | Train Loss: 1.365 Vali Loss: 0.860 Vali Acc: 0.717 Test Loss: 0.860 Test Acc: 0.717
Validation loss decreased (-0.717064 --> -0.717065).  Saving model ...
Epoch: 6 cost time: 1.879324197769165
Epoch: 6, Steps: 13 | Train Loss: 0.711 Vali Loss: 0.564 Vali Acc: 0.741 Test Loss: 0.564 Test Acc: 0.741
Validation loss decreased (-0.717065 --> -0.741458).  Saving model ...
Epoch: 7 cost time: 1.597156047821045
Epoch: 7, Steps: 13 | Train Loss: 0.636 Vali Loss: 3.003 Vali Acc: 0.293 Test Loss: 3.003 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0430965423583984
Epoch: 8, Steps: 13 | Train Loss: 1.153 Vali Loss: 1.834 Vali Acc: 0.722 Test Loss: 1.834 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8207228183746338
Epoch: 9, Steps: 13 | Train Loss: 0.509 Vali Loss: 1.678 Vali Acc: 0.722 Test Loss: 1.678 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5700793266296387
Epoch: 10, Steps: 13 | Train Loss: 0.512 Vali Loss: 0.542 Vali Acc: 0.751 Test Loss: 0.542 Test Acc: 0.751
Validation loss decreased (-0.741458 --> -0.751214).  Saving model ...
Epoch: 11 cost time: 1.3222880363464355
Epoch: 11, Steps: 13 | Train Loss: 0.423 Vali Loss: 0.556 Vali Acc: 0.732 Test Loss: 0.556 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6613447666168213
Epoch: 12, Steps: 13 | Train Loss: 0.862 Vali Loss: 2.643 Vali Acc: 0.722 Test Loss: 2.643 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4273333549499512
Epoch: 13, Steps: 13 | Train Loss: 0.493 Vali Loss: 1.040 Vali Acc: 0.732 Test Loss: 1.040 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.624103307723999
Epoch: 14, Steps: 13 | Train Loss: 0.451 Vali Loss: 1.604 Vali Acc: 0.722 Test Loss: 1.604 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.4063827991485596
Epoch: 15, Steps: 13 | Train Loss: 0.895 Vali Loss: 2.249 Vali Acc: 0.712 Test Loss: 2.249 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.6616673469543457
Epoch: 16, Steps: 13 | Train Loss: 1.137 Vali Loss: 1.862 Vali Acc: 0.395 Test Loss: 1.862 Test Acc: 0.395
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.0031354427337646
Epoch: 17, Steps: 13 | Train Loss: 0.480 Vali Loss: 1.336 Vali Acc: 0.737 Test Loss: 1.336 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.764667272567749
Epoch: 18, Steps: 13 | Train Loss: 0.472 Vali Loss: 1.756 Vali Acc: 0.732 Test Loss: 1.756 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.7510075569152832
Epoch: 19, Steps: 13 | Train Loss: 0.979 Vali Loss: 3.682 Vali Acc: 0.312 Test Loss: 3.682 Test Acc: 0.312
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.5442228317260742
Epoch: 20, Steps: 13 | Train Loss: 1.104 Vali Loss: 2.623 Vali Acc: 0.717 Test Loss: 2.623 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 279386
model size : 1.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.9417507648468018
Epoch: 1, Steps: 13 | Train Loss: 0.687 Vali Loss: 0.584 Vali Acc: 0.707 Test Loss: 0.584 Test Acc: 0.707
Validation loss decreased (inf --> -0.707311).  Saving model ...
Epoch: 2 cost time: 1.6216950416564941
Epoch: 2, Steps: 13 | Train Loss: 0.690 Vali Loss: 0.586 Vali Acc: 0.717 Test Loss: 0.586 Test Acc: 0.717
Validation loss decreased (-0.707311 --> -0.717067).  Saving model ...
Epoch: 3 cost time: 1.7398982048034668
Epoch: 3, Steps: 13 | Train Loss: 0.618 Vali Loss: 1.373 Vali Acc: 0.717 Test Loss: 1.373 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.896599292755127
Epoch: 4, Steps: 13 | Train Loss: 0.891 Vali Loss: 0.807 Vali Acc: 0.395 Test Loss: 0.807 Test Acc: 0.395
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.593219518661499
Epoch: 5, Steps: 13 | Train Loss: 0.545 Vali Loss: 1.371 Vali Acc: 0.288 Test Loss: 1.371 Test Acc: 0.288
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7601499557495117
Epoch: 6, Steps: 13 | Train Loss: 0.828 Vali Loss: 0.594 Vali Acc: 0.698 Test Loss: 0.594 Test Acc: 0.698
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.6217896938323975
Epoch: 7, Steps: 13 | Train Loss: 0.382 Vali Loss: 2.141 Vali Acc: 0.288 Test Loss: 2.141 Test Acc: 0.288
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.735929250717163
Epoch: 8, Steps: 13 | Train Loss: 1.035 Vali Loss: 1.574 Vali Acc: 0.722 Test Loss: 1.574 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721935).  Saving model ...
Epoch: 9 cost time: 1.5511491298675537
Epoch: 9, Steps: 13 | Train Loss: 0.777 Vali Loss: 1.868 Vali Acc: 0.302 Test Loss: 1.868 Test Acc: 0.302
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8974945545196533
Epoch: 10, Steps: 13 | Train Loss: 1.746 Vali Loss: 2.233 Vali Acc: 0.712 Test Loss: 2.233 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8578808307647705
Epoch: 11, Steps: 13 | Train Loss: 1.197 Vali Loss: 0.668 Vali Acc: 0.741 Test Loss: 0.668 Test Acc: 0.741
Validation loss decreased (-0.721935 --> -0.741457).  Saving model ...
Epoch: 12 cost time: 1.8070321083068848
Epoch: 12, Steps: 13 | Train Loss: 0.433 Vali Loss: 1.898 Vali Acc: 0.327 Test Loss: 1.898 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7634241580963135
Epoch: 13, Steps: 13 | Train Loss: 0.391 Vali Loss: 1.160 Vali Acc: 0.717 Test Loss: 1.160 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7949936389923096
Epoch: 14, Steps: 13 | Train Loss: 1.276 Vali Loss: 1.035 Vali Acc: 0.507 Test Loss: 1.035 Test Acc: 0.507
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.7780039310455322
Epoch: 15, Steps: 13 | Train Loss: 0.400 Vali Loss: 0.679 Vali Acc: 0.644 Test Loss: 0.679 Test Acc: 0.644
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.9372131824493408
Epoch: 16, Steps: 13 | Train Loss: 0.472 Vali Loss: 0.621 Vali Acc: 0.688 Test Loss: 0.621 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.54190993309021
Epoch: 17, Steps: 13 | Train Loss: 0.351 Vali Loss: 1.179 Vali Acc: 0.483 Test Loss: 1.179 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.7188141345977783
Epoch: 18, Steps: 13 | Train Loss: 0.380 Vali Loss: 3.224 Vali Acc: 0.298 Test Loss: 3.224 Test Acc: 0.298
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.882760763168335
Epoch: 19, Steps: 13 | Train Loss: 0.822 Vali Loss: 0.893 Vali Acc: 0.761 Test Loss: 0.893 Test Acc: 0.761
Validation loss decreased (-0.741457 --> -0.760967).  Saving model ...
Epoch: 20 cost time: 1.6761629581451416
Epoch: 20, Steps: 13 | Train Loss: 1.142 Vali Loss: 1.903 Vali Acc: 0.722 Test Loss: 1.903 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6629071235656738
Epoch: 21, Steps: 13 | Train Loss: 0.505 Vali Loss: 1.018 Vali Acc: 0.756 Test Loss: 1.018 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.9537394046783447
Epoch: 22, Steps: 13 | Train Loss: 0.258 Vali Loss: 0.954 Vali Acc: 0.639 Test Loss: 0.954 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.031303882598877
Epoch: 23, Steps: 13 | Train Loss: 0.454 Vali Loss: 1.446 Vali Acc: 0.517 Test Loss: 1.446 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.13390851020813
Epoch: 24, Steps: 13 | Train Loss: 0.239 Vali Loss: 0.807 Vali Acc: 0.707 Test Loss: 0.807 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.5288128852844238
Epoch: 25, Steps: 13 | Train Loss: 0.344 Vali Loss: 0.919 Vali Acc: 0.620 Test Loss: 0.919 Test Acc: 0.620
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.7795538902282715
Epoch: 26, Steps: 13 | Train Loss: 0.391 Vali Loss: 1.424 Vali Acc: 0.556 Test Loss: 1.424 Test Acc: 0.556
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.648552656173706
Epoch: 27, Steps: 13 | Train Loss: 0.157 Vali Loss: 1.932 Vali Acc: 0.741 Test Loss: 1.932 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.5955121517181396
Epoch: 28, Steps: 13 | Train Loss: 0.599 Vali Loss: 1.081 Vali Acc: 0.590 Test Loss: 1.081 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.7002661228179932
Epoch: 29, Steps: 13 | Train Loss: 0.320 Vali Loss: 1.677 Vali Acc: 0.537 Test Loss: 1.677 Test Acc: 0.537
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_Crossformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 278298
model size : 1.74MB
